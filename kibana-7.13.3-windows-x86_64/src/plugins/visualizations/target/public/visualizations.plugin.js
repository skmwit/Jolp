!function(modules){function webpackJsonpCallback(data){for(var moduleId,chunkId,chunkIds=data[0],moreModules=data[1],i=0,resolves=[];i<chunkIds.length;i++)chunkId=chunkIds[i],Object.prototype.hasOwnProperty.call(installedChunks,chunkId)&&installedChunks[chunkId]&&resolves.push(installedChunks[chunkId][0]),installedChunks[chunkId]=0;for(moduleId in moreModules)Object.prototype.hasOwnProperty.call(moreModules,moduleId)&&(modules[moduleId]=moreModules[moduleId]);for(parentJsonpFunction&&parentJsonpFunction(data);resolves.length;)resolves.shift()()}var installedModules={},installedChunks={0:0};function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}__webpack_require__.e=function(chunkId){var promises=[],installedChunkData=installedChunks[chunkId];if(0!==installedChunkData)if(installedChunkData)promises.push(installedChunkData[2]);else{var promise=new Promise((function(resolve,reject){installedChunkData=installedChunks[chunkId]=[resolve,reject]}));promises.push(installedChunkData[2]=promise);var onScriptComplete,script=document.createElement("script");script.charset="utf-8",script.timeout=120,__webpack_require__.nc&&script.setAttribute("nonce",__webpack_require__.nc),script.src=function(chunkId){return __webpack_require__.p+"visualizations.chunk."+chunkId+".js"}(chunkId);var error=new Error;onScriptComplete=function(event){script.onerror=script.onload=null,clearTimeout(timeout);var chunk=installedChunks[chunkId];if(0!==chunk){if(chunk){var errorType=event&&("load"===event.type?"missing":event.type),realSrc=event&&event.target&&event.target.src;error.message="Loading chunk "+chunkId+" failed.\n("+errorType+": "+realSrc+")",error.name="ChunkLoadError",error.type=errorType,error.request=realSrc,chunk[1](error)}installedChunks[chunkId]=void 0}};var timeout=setTimeout((function(){onScriptComplete({type:"timeout",target:script})}),12e4);script.onerror=script.onload=onScriptComplete,document.head.appendChild(script)}return Promise.all(promises)},__webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{enumerable:!0,get:getter})},__webpack_require__.r=function(exports){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(exports,"__esModule",{value:!0})},__webpack_require__.t=function(value,mode){if(1&mode&&(value=__webpack_require__(value)),8&mode)return value;if(4&mode&&"object"==typeof value&&value&&value.__esModule)return value;var ns=Object.create(null);if(__webpack_require__.r(ns),Object.defineProperty(ns,"default",{enumerable:!0,value:value}),2&mode&&"string"!=typeof value)for(var key in value)__webpack_require__.d(ns,key,function(key){return value[key]}.bind(null,key));return ns},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function(){return module.default}:function(){return module};return __webpack_require__.d(getter,"a",getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p="",__webpack_require__.oe=function(err){throw console.error(err),err};var jsonpArray=window.visualizations_bundle_jsonpfunction=window.visualizations_bundle_jsonpfunction||[],oldJsonpFunction=jsonpArray.push.bind(jsonpArray);jsonpArray.push=webpackJsonpCallback,jsonpArray=jsonpArray.slice();for(var i=0;i<jsonpArray.length;i++)webpackJsonpCallback(jsonpArray[i]);var parentJsonpFunction=oldJsonpFunction;__webpack_require__(__webpack_require__.s=29)}([function(module,exports){module.exports=__kbnSharedDeps__.Lodash},function(module,exports){module.exports=__kbnSharedDeps__.React},function(module,exports){module.exports=__kbnSharedDeps__.KbnI18n},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/kibanaUtils/public");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/data/public");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,exports){module.exports=__kbnSharedDeps__.ElasticEui},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/embeddable/public");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"c",(function(){return visTypeAliasRegistry}));let registry=[];const discardOnRegister=[],visTypeAliasRegistry={get:()=>[...registry],add:newVisTypeAlias=>{if(registry.find(visTypeAlias=>visTypeAlias.name===newVisTypeAlias.name))throw new Error(newVisTypeAlias.name+" already registered");discardOnRegister.some(aliasName=>aliasName===newVisTypeAlias.name)||registry.push(newVisTypeAlias)},remove:visTypeAliasName=>{registry.find(visTypeAlias=>visTypeAlias.name===visTypeAliasName)?registry=registry.filter(visTypeAlias=>visTypeAlias.name!==visTypeAliasName):discardOnRegister.push(visTypeAliasName)}}},function(module,exports){module.exports=__kbnSharedDeps__.SaferLodashSet},function(module,exports){module.exports=__kbnSharedDeps__.KbnI18nReact},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return VISUALIZE_ENABLE_LABS_SETTING}));const VISUALIZE_ENABLE_LABS_SETTING="visualize:enableLabs"},function(module,exports){module.exports=__kbnSharedDeps__.ReactDom},function(module,__webpack_exports__,__webpack_require__){"use strict";var _types__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(24);__webpack_require__.o(_types__WEBPACK_IMPORTED_MODULE_0__,"SavedVisState")&&__webpack_require__.d(__webpack_exports__,"SavedVisState",(function(){return _types__WEBPACK_IMPORTED_MODULE_0__.SavedVisState})),__webpack_require__.o(_types__WEBPACK_IMPORTED_MODULE_0__,"VisParams")&&__webpack_require__.d(__webpack_exports__,"VisParams",(function(){return _types__WEBPACK_IMPORTED_MODULE_0__.VisParams}))},function(module,exports,__webpack_require__){"use strict";var memo,isOldIE=function(){return void 0===memo&&(memo=Boolean(window&&document&&document.all&&!window.atob)),memo},getTarget=function(){var memo={};return function(target){if(void 0===memo[target]){var styleTarget=document.querySelector(target);if(window.HTMLIFrameElement&&styleTarget instanceof window.HTMLIFrameElement)try{styleTarget=styleTarget.contentDocument.head}catch(e){styleTarget=null}memo[target]=styleTarget}return memo[target]}}(),stylesInDom=[];function getIndexByIdentifier(identifier){for(var result=-1,i=0;i<stylesInDom.length;i++)if(stylesInDom[i].identifier===identifier){result=i;break}return result}function modulesToDom(list,options){for(var idCountMap={},identifiers=[],i=0;i<list.length;i++){var item=list[i],id=options.base?item[0]+options.base:item[0],count=idCountMap[id]||0,identifier="".concat(id," ").concat(count);idCountMap[id]=count+1;var index=getIndexByIdentifier(identifier),obj={css:item[1],media:item[2],sourceMap:item[3]};-1!==index?(stylesInDom[index].references++,stylesInDom[index].updater(obj)):stylesInDom.push({identifier:identifier,updater:addStyle(obj,options),references:1}),identifiers.push(identifier)}return identifiers}function insertStyleElement(options){var style=document.createElement("style"),attributes=options.attributes||{};if(void 0===attributes.nonce){var nonce=__webpack_require__.nc;nonce&&(attributes.nonce=nonce)}if(Object.keys(attributes).forEach((function(key){style.setAttribute(key,attributes[key])})),"function"==typeof options.insert)options.insert(style);else{var target=getTarget(options.insert||"head");if(!target)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");target.appendChild(style)}return style}var textStore,replaceText=(textStore=[],function(index,replacement){return textStore[index]=replacement,textStore.filter(Boolean).join("\n")});function applyToSingletonTag(style,index,remove,obj){var css=remove?"":obj.media?"@media ".concat(obj.media," {").concat(obj.css,"}"):obj.css;if(style.styleSheet)style.styleSheet.cssText=replaceText(index,css);else{var cssNode=document.createTextNode(css),childNodes=style.childNodes;childNodes[index]&&style.removeChild(childNodes[index]),childNodes.length?style.insertBefore(cssNode,childNodes[index]):style.appendChild(cssNode)}}function applyToTag(style,options,obj){var css=obj.css,media=obj.media,sourceMap=obj.sourceMap;if(media?style.setAttribute("media",media):style.removeAttribute("media"),sourceMap&&btoa&&(css+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))))," */")),style.styleSheet)style.styleSheet.cssText=css;else{for(;style.firstChild;)style.removeChild(style.firstChild);style.appendChild(document.createTextNode(css))}}var singleton=null,singletonCounter=0;function addStyle(obj,options){var style,update,remove;if(options.singleton){var styleIndex=singletonCounter++;style=singleton||(singleton=insertStyleElement(options)),update=applyToSingletonTag.bind(null,style,styleIndex,!1),remove=applyToSingletonTag.bind(null,style,styleIndex,!0)}else style=insertStyleElement(options),update=applyToTag.bind(null,style,options),remove=function(){!function(style){if(null===style.parentNode)return!1;style.parentNode.removeChild(style)}(style)};return update(obj),function(newObj){if(newObj){if(newObj.css===obj.css&&newObj.media===obj.media&&newObj.sourceMap===obj.sourceMap)return;update(obj=newObj)}else remove()}}module.exports=function(list,options){(options=options||{}).singleton||"boolean"==typeof options.singleton||(options.singleton=isOldIE());var lastIdentifiers=modulesToDom(list=list||[],options);return function(newList){if(newList=newList||[],"[object Array]"===Object.prototype.toString.call(newList)){for(var i=0;i<lastIdentifiers.length;i++){var index=getIndexByIdentifier(lastIdentifiers[i]);stylesInDom[index].references--}for(var newLastIdentifiers=modulesToDom(newList,options),_i=0;_i<lastIdentifiers.length;_i++){var _index=getIndexByIdentifier(lastIdentifiers[_i]);0===stylesInDom[_index].references&&(stylesInDom[_index].updater(),stylesInDom.splice(_index,1))}lastIdentifiers=newLastIdentifiers}}}},function(module,exports,__webpack_require__){"use strict";module.exports=function(useSourceMap){var list=[];return list.toString=function(){return this.map((function(item){var content=function(item,useSourceMap){var content=item[1]||"",cssMapping=item[3];if(!cssMapping)return content;if(useSourceMap&&"function"==typeof btoa){var sourceMapping=(sourceMap=cssMapping,base64=btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))),data="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(base64),"/*# ".concat(data," */")),sourceURLs=cssMapping.sources.map((function(source){return"/*# sourceURL=".concat(cssMapping.sourceRoot||"").concat(source," */")}));return[content].concat(sourceURLs).concat([sourceMapping]).join("\n")}var sourceMap,base64,data;return[content].join("\n")}(item,useSourceMap);return item[2]?"@media ".concat(item[2]," {").concat(content,"}"):content})).join("")},list.i=function(modules,mediaQuery,dedupe){"string"==typeof modules&&(modules=[[null,modules,""]]);var alreadyImportedModules={};if(dedupe)for(var i=0;i<this.length;i++){var id=this[i][0];null!=id&&(alreadyImportedModules[id]=!0)}for(var _i=0;_i<modules.length;_i++){var item=[].concat(modules[_i]);dedupe&&alreadyImportedModules[item[0]]||(mediaQuery&&(item[2]?item[2]="".concat(mediaQuery," and ").concat(item[2]):item[2]=mediaQuery),list.push(item))}},list}},function(module,__webpack_exports__,__webpack_require__){"use strict";var _types_service__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(16);__webpack_require__.d(__webpack_exports__,"a",(function(){return _types_service__WEBPACK_IMPORTED_MODULE_0__.a}));__webpack_require__(19);var _types__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(18);__webpack_require__.d(__webpack_exports__,"b",(function(){return _types__WEBPACK_IMPORTED_MODULE_2__.a}));__webpack_require__(17)},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return TypesService}));var _vis_type_alias_registry__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(7),_base_vis_type__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(17);function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class TypesService{constructor(){_defineProperty(this,"types",{}),_defineProperty(this,"unregisteredHiddenTypes",[])}registerVisualization(visDefinition){if(this.unregisteredHiddenTypes.includes(visDefinition.name)&&(visDefinition.hidden=!0),this.types[visDefinition.name])throw new Error("type already exists!");this.types[visDefinition.name]=visDefinition}setup(){return{createBaseVisualization:config=>{const vis=new _base_vis_type__WEBPACK_IMPORTED_MODULE_1__.a(config);this.registerVisualization(vis)},registerAlias:_vis_type_alias_registry__WEBPACK_IMPORTED_MODULE_0__.c.add,hideTypes:typeNames=>{typeNames.forEach(name=>{this.types[name]?this.types[name].hidden=!0:this.unregisteredHiddenTypes.push(name)})}}}start(){return{get:visualization=>this.types[visualization],all:()=>[...Object.values(this.types)],getAliases:_vis_type_alias_registry__WEBPACK_IMPORTED_MODULE_0__.c.get,unRegisterAlias:_vis_type_alias_registry__WEBPACK_IMPORTED_MODULE_0__.c.remove,getByGroup:group=>Object.values(this.types).filter(type=>type.group===group)}}stop(){}}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return BaseVisType}));var lodash__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0),_types__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(18),_schemas__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(19);function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}const defaultOptions={showTimePicker:!0,showQueryBar:!0,showFilterBar:!0,showIndexSelection:!0,hierarchicalData:!1};class BaseVisType{constructor(opts){var _opts$description,_opts$note,_opts$stage,_opts$group,_opts$titleInWizard,_opts$hidden,_opts$requiresSearch,_opts$hierarchicalDat,_this$editorConfig$sc,_this$editorConfig;if(_defineProperty(this,"name",void 0),_defineProperty(this,"title",void 0),_defineProperty(this,"description",void 0),_defineProperty(this,"note",void 0),_defineProperty(this,"getSupportedTriggers",void 0),_defineProperty(this,"icon",void 0),_defineProperty(this,"image",void 0),_defineProperty(this,"stage",void 0),_defineProperty(this,"group",void 0),_defineProperty(this,"titleInWizard",void 0),_defineProperty(this,"options",void 0),_defineProperty(this,"visConfig",void 0),_defineProperty(this,"editorConfig",void 0),_defineProperty(this,"hidden",void 0),_defineProperty(this,"requiresSearch",void 0),_defineProperty(this,"hierarchicalData",void 0),_defineProperty(this,"setup",void 0),_defineProperty(this,"getUsedIndexPattern",void 0),_defineProperty(this,"inspectorAdapters",void 0),_defineProperty(this,"toExpressionAst",void 0),_defineProperty(this,"getInfoMessage",void 0),_defineProperty(this,"schemas",void 0),!opts.icon&&!opts.image)throw new Error("vis_type must define its icon or image");this.name=opts.name,this.description=null!==(_opts$description=opts.description)&&void 0!==_opts$description?_opts$description:"",this.note=null!==(_opts$note=opts.note)&&void 0!==_opts$note?_opts$note:"",this.getSupportedTriggers=opts.getSupportedTriggers,this.title=opts.title,this.icon=opts.icon,this.image=opts.image,this.visConfig=Object(lodash__WEBPACK_IMPORTED_MODULE_0__.defaultsDeep)({},opts.visConfig,{defaults:{}}),this.editorConfig=Object(lodash__WEBPACK_IMPORTED_MODULE_0__.defaultsDeep)({},opts.editorConfig,{collections:{}}),this.options=Object(lodash__WEBPACK_IMPORTED_MODULE_0__.defaultsDeep)({},opts.options,defaultOptions),this.stage=null!==(_opts$stage=opts.stage)&&void 0!==_opts$stage?_opts$stage:"production",this.group=null!==(_opts$group=opts.group)&&void 0!==_opts$group?_opts$group:_types__WEBPACK_IMPORTED_MODULE_1__.a.AGGBASED,this.titleInWizard=null!==(_opts$titleInWizard=opts.titleInWizard)&&void 0!==_opts$titleInWizard?_opts$titleInWizard:"",this.hidden=null!==(_opts$hidden=opts.hidden)&&void 0!==_opts$hidden&&_opts$hidden,this.requiresSearch=null!==(_opts$requiresSearch=opts.requiresSearch)&&void 0!==_opts$requiresSearch&&_opts$requiresSearch,this.setup=opts.setup,this.hierarchicalData=null!==(_opts$hierarchicalDat=opts.hierarchicalData)&&void 0!==_opts$hierarchicalDat&&_opts$hierarchicalDat,this.getUsedIndexPattern=opts.getUsedIndexPattern,this.inspectorAdapters=opts.inspectorAdapters,this.toExpressionAst=opts.toExpressionAst,this.getInfoMessage=opts.getInfoMessage,this.schemas=new _schemas__WEBPACK_IMPORTED_MODULE_2__.a(null!==(_this$editorConfig$sc=null===(_this$editorConfig=this.editorConfig)||void 0===_this$editorConfig?void 0:_this$editorConfig.schemas)&&void 0!==_this$editorConfig$sc?_this$editorConfig$sc:[])}}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return VisGroups}));__webpack_require__(4);let VisGroups;!function(VisGroups){VisGroups.PROMOTED="promoted",VisGroups.TOOLS="tools",VisGroups.AGGBASED="aggbased"}(VisGroups||(VisGroups={}))},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return Schemas}));var lodash__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0),lodash__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_0__),_data_public__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(4);let _AggGroupNames$Bucket,_AggGroupNames$Metric;function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}_AggGroupNames$Bucket=_data_public__WEBPACK_IMPORTED_MODULE_1__.AggGroupNames.Buckets,_AggGroupNames$Metric=_data_public__WEBPACK_IMPORTED_MODULE_1__.AggGroupNames.Metrics;class Schemas{constructor(schemas){_defineProperty(this,"all",[]),_defineProperty(this,_AggGroupNames$Bucket,[]),_defineProperty(this,_AggGroupNames$Metric,[]),lodash__WEBPACK_IMPORTED_MODULE_0___default()(schemas||[]).chain().map(schema=>{if(!schema.name)throw new Error("all schema must have a unique name");return"split"===schema.name&&(schema.params=[{name:"row",default:!0}]),Object(lodash__WEBPACK_IMPORTED_MODULE_0__.defaults)(schema,{min:0,max:1/0,group:_data_public__WEBPACK_IMPORTED_MODULE_1__.AggGroupNames.Buckets,title:schema.name,aggFilter:"*",params:[]}),schema}).tap(fullSchemas=>{this.all=fullSchemas}).groupBy("group").forOwn((group,groupName)=>{this[groupName]=group}).commit()}}},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/savedObjects/public");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/discover/public");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/expressions/public");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/data/common");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,exports){},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/uiActions/public");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,exports){module.exports=__kbnSharedDeps__.RxjsOperators},function(module,exports,__webpack_require__){"use strict";var ReflectOwnKeys,R="object"==typeof Reflect?Reflect:null,ReflectApply=R&&"function"==typeof R.apply?R.apply:function(target,receiver,args){return Function.prototype.apply.call(target,receiver,args)};ReflectOwnKeys=R&&"function"==typeof R.ownKeys?R.ownKeys:Object.getOwnPropertySymbols?function(target){return Object.getOwnPropertyNames(target).concat(Object.getOwnPropertySymbols(target))}:function(target){return Object.getOwnPropertyNames(target)};var NumberIsNaN=Number.isNaN||function(value){return value!=value};function EventEmitter(){EventEmitter.init.call(this)}module.exports=EventEmitter,EventEmitter.EventEmitter=EventEmitter,EventEmitter.prototype._events=void 0,EventEmitter.prototype._eventsCount=0,EventEmitter.prototype._maxListeners=void 0;var defaultMaxListeners=10;function $getMaxListeners(that){return void 0===that._maxListeners?EventEmitter.defaultMaxListeners:that._maxListeners}function _addListener(target,type,listener,prepend){var m,events,existing,warning;if("function"!=typeof listener)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof listener);if(void 0===(events=target._events)?(events=target._events=Object.create(null),target._eventsCount=0):(void 0!==events.newListener&&(target.emit("newListener",type,listener.listener?listener.listener:listener),events=target._events),existing=events[type]),void 0===existing)existing=events[type]=listener,++target._eventsCount;else if("function"==typeof existing?existing=events[type]=prepend?[listener,existing]:[existing,listener]:prepend?existing.unshift(listener):existing.push(listener),(m=$getMaxListeners(target))>0&&existing.length>m&&!existing.warned){existing.warned=!0;var w=new Error("Possible EventEmitter memory leak detected. "+existing.length+" "+String(type)+" listeners added. Use emitter.setMaxListeners() to increase limit");w.name="MaxListenersExceededWarning",w.emitter=target,w.type=type,w.count=existing.length,warning=w,console&&console.warn&&console.warn(warning)}return target}function onceWrapper(){for(var args=[],i=0;i<arguments.length;i++)args.push(arguments[i]);this.fired||(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,ReflectApply(this.listener,this.target,args))}function _onceWrap(target,type,listener){var state={fired:!1,wrapFn:void 0,target:target,type:type,listener:listener},wrapped=onceWrapper.bind(state);return wrapped.listener=listener,state.wrapFn=wrapped,wrapped}function _listeners(target,type,unwrap){var events=target._events;if(void 0===events)return[];var evlistener=events[type];return void 0===evlistener?[]:"function"==typeof evlistener?unwrap?[evlistener.listener||evlistener]:[evlistener]:unwrap?function(arr){for(var ret=new Array(arr.length),i=0;i<ret.length;++i)ret[i]=arr[i].listener||arr[i];return ret}(evlistener):arrayClone(evlistener,evlistener.length)}function listenerCount(type){var events=this._events;if(void 0!==events){var evlistener=events[type];if("function"==typeof evlistener)return 1;if(void 0!==evlistener)return evlistener.length}return 0}function arrayClone(arr,n){for(var copy=new Array(n),i=0;i<n;++i)copy[i]=arr[i];return copy}Object.defineProperty(EventEmitter,"defaultMaxListeners",{enumerable:!0,get:function(){return defaultMaxListeners},set:function(arg){if("number"!=typeof arg||arg<0||NumberIsNaN(arg))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+arg+".");defaultMaxListeners=arg}}),EventEmitter.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},EventEmitter.prototype.setMaxListeners=function(n){if("number"!=typeof n||n<0||NumberIsNaN(n))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+n+".");return this._maxListeners=n,this},EventEmitter.prototype.getMaxListeners=function(){return $getMaxListeners(this)},EventEmitter.prototype.emit=function(type){for(var args=[],i=1;i<arguments.length;i++)args.push(arguments[i]);var doError="error"===type,events=this._events;if(void 0!==events)doError=doError&&void 0===events.error;else if(!doError)return!1;if(doError){var er;if(args.length>0&&(er=args[0]),er instanceof Error)throw er;var err=new Error("Unhandled error."+(er?" ("+er.message+")":""));throw err.context=er,err}var handler=events[type];if(void 0===handler)return!1;if("function"==typeof handler)ReflectApply(handler,this,args);else{var len=handler.length,listeners=arrayClone(handler,len);for(i=0;i<len;++i)ReflectApply(listeners[i],this,args)}return!0},EventEmitter.prototype.addListener=function(type,listener){return _addListener(this,type,listener,!1)},EventEmitter.prototype.on=EventEmitter.prototype.addListener,EventEmitter.prototype.prependListener=function(type,listener){return _addListener(this,type,listener,!0)},EventEmitter.prototype.once=function(type,listener){if("function"!=typeof listener)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof listener);return this.on(type,_onceWrap(this,type,listener)),this},EventEmitter.prototype.prependOnceListener=function(type,listener){if("function"!=typeof listener)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof listener);return this.prependListener(type,_onceWrap(this,type,listener)),this},EventEmitter.prototype.removeListener=function(type,listener){var list,events,position,i,originalListener;if("function"!=typeof listener)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof listener);if(void 0===(events=this._events))return this;if(void 0===(list=events[type]))return this;if(list===listener||list.listener===listener)0==--this._eventsCount?this._events=Object.create(null):(delete events[type],events.removeListener&&this.emit("removeListener",type,list.listener||listener));else if("function"!=typeof list){for(position=-1,i=list.length-1;i>=0;i--)if(list[i]===listener||list[i].listener===listener){originalListener=list[i].listener,position=i;break}if(position<0)return this;0===position?list.shift():function(list,index){for(;index+1<list.length;index++)list[index]=list[index+1];list.pop()}(list,position),1===list.length&&(events[type]=list[0]),void 0!==events.removeListener&&this.emit("removeListener",type,originalListener||listener)}return this},EventEmitter.prototype.off=EventEmitter.prototype.removeListener,EventEmitter.prototype.removeAllListeners=function(type){var listeners,events,i;if(void 0===(events=this._events))return this;if(void 0===events.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==events[type]&&(0==--this._eventsCount?this._events=Object.create(null):delete events[type]),this;if(0===arguments.length){var key,keys=Object.keys(events);for(i=0;i<keys.length;++i)"removeListener"!==(key=keys[i])&&this.removeAllListeners(key);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(listeners=events[type]))this.removeListener(type,listeners);else if(void 0!==listeners)for(i=listeners.length-1;i>=0;i--)this.removeListener(type,listeners[i]);return this},EventEmitter.prototype.listeners=function(type){return _listeners(this,type,!0)},EventEmitter.prototype.rawListeners=function(type){return _listeners(this,type,!1)},EventEmitter.listenerCount=function(emitter,type){return"function"==typeof emitter.listenerCount?emitter.listenerCount(type):listenerCount.call(emitter,type)},EventEmitter.prototype.listenerCount=listenerCount,EventEmitter.prototype.eventNames=function(){return this._eventsCount>0?ReflectOwnKeys(this._events):[]}},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_RESULT__;
/*!
  Copyright (c) 2017 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/!function(){"use strict";var hasOwn={}.hasOwnProperty;function classNames(){for(var classes=[],i=0;i<arguments.length;i++){var arg=arguments[i];if(arg){var argType=typeof arg;if("string"===argType||"number"===argType)classes.push(arg);else if(Array.isArray(arg)&&arg.length){var inner=classNames.apply(null,arg);inner&&classes.push(inner)}else if("object"===argType)for(var key in arg)hasOwn.call(arg,key)&&arg[key]&&classes.push(key)}}return classes.join(" ")}module.exports?(classNames.default=classNames,module.exports=classNames):void 0===(__WEBPACK_AMD_DEFINE_RESULT__=function(){return classNames}.apply(exports,[]))||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)}()},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__(30);__kbnBundles__.define("plugin/visualizations/public",__webpack_require__,40)},function(module,exports,__webpack_require__){__webpack_require__.p=window.__kbnPublicPath__.visualizations},function(module,exports,__webpack_require__){switch(window.__kbnThemeTag__){case"v7dark":return __webpack_require__(32);case"v7light":return __webpack_require__(34);case"v8dark":return __webpack_require__(36);case"v8light":return __webpack_require__(38)}},function(module,exports,__webpack_require__){var api=__webpack_require__(13),content=__webpack_require__(33);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){(exports=__webpack_require__(14)(!1)).push([module.i,".embPanel .visualization{scrollbar-width:thin}.embPanel .visualization::-webkit-scrollbar{width:16px;height:16px}.embPanel .visualization::-webkit-scrollbar-thumb{background-color:rgba(152,162,179,0.5);border:6px solid rgba(0,0,0,0);background-clip:content-box}.embPanel .visualization::-webkit-scrollbar-corner,.embPanel .visualization::-webkit-scrollbar-track{background-color:rgba(0,0,0,0)}.embPanel .visLegend__toggle{border-bottom-right-radius:0;border-top-left-radius:0;opacity:0}.embPanel .visLegend__toggle:focus{opacity:1}.embPanel_optionsMenuPopover[class*='-isOpen'] .visLegend__toggle,.embPanel:hover .visLegend__toggle{opacity:1}.embPanel--editing .visLegend__toggle{opacity:1}.visualize{display:flex;flex:1 1 100%;overflow:hidden}.visualization{display:flex;flex-direction:column;width:100%;height:100%;overflow:auto;position:relative;padding:8px;flex:1 1 100%}.visChart{display:flex;flex:1 1 auto;min-height:0;min-width:0}.visChart--vertical{flex-direction:column}.visChart__spinner,.visError{display:flex;flex:1 1 auto;justify-content:center;align-items:center;text-align:center}\n",""]),module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(13),content=__webpack_require__(35);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){(exports=__webpack_require__(14)(!1)).push([module.i,".embPanel .visualization{scrollbar-width:thin}.embPanel .visualization::-webkit-scrollbar{width:16px;height:16px}.embPanel .visualization::-webkit-scrollbar-thumb{background-color:rgba(105,112,125,0.5);border:6px solid rgba(0,0,0,0);background-clip:content-box}.embPanel .visualization::-webkit-scrollbar-corner,.embPanel .visualization::-webkit-scrollbar-track{background-color:rgba(0,0,0,0)}.embPanel .visLegend__toggle{border-bottom-right-radius:0;border-top-left-radius:0;opacity:0}.embPanel .visLegend__toggle:focus{opacity:1}.embPanel_optionsMenuPopover[class*='-isOpen'] .visLegend__toggle,.embPanel:hover .visLegend__toggle{opacity:1}.embPanel--editing .visLegend__toggle{opacity:1}.visualize{display:flex;flex:1 1 100%;overflow:hidden}.visualization{display:flex;flex-direction:column;width:100%;height:100%;overflow:auto;position:relative;padding:8px;flex:1 1 100%}.visChart{display:flex;flex:1 1 auto;min-height:0;min-width:0}.visChart--vertical{flex-direction:column}.visChart__spinner,.visError{display:flex;flex:1 1 auto;justify-content:center;align-items:center;text-align:center}\n",""]),module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(13),content=__webpack_require__(37);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){(exports=__webpack_require__(14)(!1)).push([module.i,".embPanel .visualization{scrollbar-width:thin}.embPanel .visualization::-webkit-scrollbar{width:16px;height:16px}.embPanel .visualization::-webkit-scrollbar-thumb{background-color:rgba(152,162,179,0.5);border:6px solid rgba(0,0,0,0);background-clip:content-box}.embPanel .visualization::-webkit-scrollbar-corner,.embPanel .visualization::-webkit-scrollbar-track{background-color:rgba(0,0,0,0)}.embPanel .visLegend__toggle{border-bottom-right-radius:0;border-top-left-radius:0;opacity:0}.embPanel .visLegend__toggle:focus{opacity:1}.embPanel_optionsMenuPopover[class*='-isOpen'] .visLegend__toggle,.embPanel:hover .visLegend__toggle{opacity:1}.embPanel--editing .visLegend__toggle{opacity:1}.visualize{display:flex;flex:1 1 100%;overflow:hidden}.visualization{display:flex;flex-direction:column;width:100%;height:100%;overflow:auto;position:relative;padding:8px;flex:1 1 100%}.visChart{display:flex;flex:1 1 auto;min-height:0;min-width:0}.visChart--vertical{flex-direction:column}.visChart__spinner,.visError{display:flex;flex:1 1 auto;justify-content:center;align-items:center;text-align:center}\n",""]),module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(13),content=__webpack_require__(39);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){(exports=__webpack_require__(14)(!1)).push([module.i,".embPanel .visualization{scrollbar-width:thin}.embPanel .visualization::-webkit-scrollbar{width:16px;height:16px}.embPanel .visualization::-webkit-scrollbar-thumb{background-color:rgba(105,112,125,0.5);border:6px solid rgba(0,0,0,0);background-clip:content-box}.embPanel .visualization::-webkit-scrollbar-corner,.embPanel .visualization::-webkit-scrollbar-track{background-color:rgba(0,0,0,0)}.embPanel .visLegend__toggle{border-bottom-right-radius:0;border-top-left-radius:0;opacity:0}.embPanel .visLegend__toggle:focus{opacity:1}.embPanel_optionsMenuPopover[class*='-isOpen'] .visLegend__toggle,.embPanel:hover .visLegend__toggle{opacity:1}.embPanel--editing .visLegend__toggle{opacity:1}.visualize{display:flex;flex:1 1 100%;overflow:hidden}.visualization{display:flex;flex-direction:column;width:100%;height:100%;overflow:auto;position:relative;padding:8px;flex:1 1 100%}.visChart{display:flex;flex:1 1 auto;min-height:0;min-width:0}.visChart--vertical{flex-direction:column}.visChart__spinner,.visError{display:flex;flex:1 1 auto;justify-content:center;align-items:center;text-align:center}\n",""]),module.exports=exports},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"plugin",(function(){return public_plugin})),__webpack_require__.d(__webpack_exports__,"Vis",(function(){return vis_Vis})),__webpack_require__.d(__webpack_exports__,"TypesService",(function(){return types_service.a})),__webpack_require__.d(__webpack_exports__,"VISUALIZE_EMBEDDABLE_TYPE",(function(){return VISUALIZE_EMBEDDABLE_TYPE})),__webpack_require__.d(__webpack_exports__,"VIS_EVENT_TO_TRIGGER",(function(){return VIS_EVENT_TO_TRIGGER})),__webpack_require__.d(__webpack_exports__,"VisualizationContainer",(function(){return VisualizationContainer})),__webpack_require__.d(__webpack_exports__,"getVisSchemas",(function(){return getVisSchemas})),__webpack_require__.d(__webpack_exports__,"VisualizationsSetup",(function(){})),__webpack_require__.d(__webpack_exports__,"VisualizationsStart",(function(){})),__webpack_require__.d(__webpack_exports__,"VisGroups",(function(){return vis_types.b})),__webpack_require__.d(__webpack_exports__,"SerializedVis",(function(){})),__webpack_require__.d(__webpack_exports__,"SerializedVisData",(function(){})),__webpack_require__.d(__webpack_exports__,"VisData",(function(){})),__webpack_require__.d(__webpack_exports__,"VisualizeInput",(function(){})),__webpack_require__.d(__webpack_exports__,"SchemaConfig",(function(){})),__webpack_require__.d(__webpack_exports__,"updateOldState",(function(){return updateOldState})),__webpack_require__.d(__webpack_exports__,"PersistedState",(function(){return persisted_state_PersistedState})),__webpack_require__.d(__webpack_exports__,"ISavedVis",(function(){})),__webpack_require__.d(__webpack_exports__,"VisSavedObject",(function(){})),__webpack_require__.d(__webpack_exports__,"VisToExpressionAst",(function(){})),__webpack_require__.d(__webpack_exports__,"VisToExpressionAstParams",(function(){})),__webpack_require__.d(__webpack_exports__,"VisEditorOptionsProps",(function(){})),__webpack_require__.d(__webpack_exports__,"VisualizationListItem",(function(){return vis_type_alias_registry.VisualizationListItem})),__webpack_require__.d(__webpack_exports__,"VisualizationStage",(function(){return vis_type_alias_registry.VisualizationStage})),__webpack_require__.d(__webpack_exports__,"VISUALIZE_ENABLE_LABS_SETTING",(function(){return constants.a})),__webpack_require__.d(__webpack_exports__,"SavedVisState",(function(){return common.SavedVisState})),__webpack_require__.d(__webpack_exports__,"VisParams",(function(){return common.VisParams})),__webpack_require__.d(__webpack_exports__,"ExpressionValueVisDimension",(function(){}));__webpack_require__(31);var vis_types=__webpack_require__(15),public_=__webpack_require__(3);const[getUISettings,setUISettings]=Object(public_.createGetterSetter)("UISettings"),[getCapabilities,setCapabilities]=Object(public_.createGetterSetter)("Capabilities"),[getHttp,setHttp]=Object(public_.createGetterSetter)("Http"),[getApplication,setApplication]=Object(public_.createGetterSetter)("Application"),[getEmbeddable,setEmbeddable]=Object(public_.createGetterSetter)("Embeddable"),[getSavedObjects,setSavedObjects]=Object(public_.createGetterSetter)("SavedObjects"),[getTypes,setTypes]=Object(public_.createGetterSetter)("Types"),[getDocLinks,setDocLinks]=Object(public_.createGetterSetter)("DocLinks"),[getTimeFilter,setTimeFilter]=Object(public_.createGetterSetter)("TimeFilter"),[getSearch,setSearch]=Object(public_.createGetterSetter)("Search"),[getUsageCollector,setUsageCollector]=Object(public_.createGetterSetter)("UsageCollection"),[getExpressions,setExpressions]=Object(public_.createGetterSetter)("Expressions"),[getUiActions,setUiActions]=Object(public_.createGetterSetter)("UiActions"),[getSavedVisualizationsLoader,setSavedVisualizationsLoader]=Object(public_.createGetterSetter)("SavedVisualisationsLoader"),[getAggs,setAggs]=Object(public_.createGetterSetter)("AggConfigs"),[getOverlays,setOverlays]=Object(public_.createGetterSetter)("Overlays"),[getChrome,setChrome]=Object(public_.createGetterSetter)("Chrome"),[getSavedSearchLoader,setSavedSearchLoader]=Object(public_.createGetterSetter)("savedSearchLoader");var external_kbnSharedDeps_React_=__webpack_require__(1),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),external_kbnSharedDeps_ReactDom_=__webpack_require__(11),external_kbnSharedDeps_ReactDom_default=__webpack_require__.n(external_kbnSharedDeps_ReactDom_),embeddable_public_=__webpack_require__(6),external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(9),external_kbnSharedDeps_ElasticEui_=__webpack_require__(5);function DisabledLabVisualization({title:title}){const advancedSettingsLink=getDocLinks().links.management.visualizationSettings;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.I18nProvider,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiEmptyPrompt,{titleSize:"xs",title:external_kbnSharedDeps_React_default.a.createElement("h6",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"visualizations.disabledLabVisualizationTitle",defaultMessage:"{title} is a lab visualization.",values:{title:title}})),iconType:"beaker",body:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"visualizations.disabledLabVisualizationMessage",defaultMessage:"Please turn on lab-mode in the advanced settings to see lab visualizations."}),actions:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{target:"_blank",external:!0,href:advancedSettingsLink},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"visualizations.disabledLabVisualizationLink",defaultMessage:"Read documentation"}))}))}const VISUALIZE_EMBEDDABLE_TYPE="visualization";function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class disabled_lab_embeddable_DisabledLabEmbeddable extends embeddable_public_.Embeddable{constructor(title,initialInput){super(initialInput,{title:title}),this.title=title,_defineProperty(this,"domNode",void 0),_defineProperty(this,"type",VISUALIZE_EMBEDDABLE_TYPE)}reload(){}render(domNode){this.title&&(this.domNode=domNode,external_kbnSharedDeps_ReactDom_default.a.render(external_kbnSharedDeps_React_default.a.createElement(DisabledLabVisualization,{title:this.title}),domNode))}destroy(){this.domNode&&external_kbnSharedDeps_ReactDom_default.a.unmountComponentAtNode(this.domNode)}}var external_kbnSharedDeps_Lodash_=__webpack_require__(0),external_kbnSharedDeps_Lodash_default=__webpack_require__.n(external_kbnSharedDeps_Lodash_),external_kbnSharedDeps_KbnI18n_=__webpack_require__(2),data_public_=__webpack_require__(4),uiActions_public_=__webpack_require__(25);const VIS_EVENT_TO_TRIGGER={applyFilter:data_public_.APPLY_FILTER_TRIGGER,brush:embeddable_public_.SELECT_RANGE_TRIGGER,filter:embeddable_public_.VALUE_CLICK_TRIGGER,tableRowContextMenuClick:uiActions_public_.ROW_CLICK_TRIGGER};var expressions_public_=__webpack_require__(22),common_=__webpack_require__(23);function visualize_embeddable_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class visualize_embeddable_VisualizeEmbeddable extends embeddable_public_.Embeddable{constructor(timefilter,{vis:vis,editPath:editPath,editUrl:editUrl,indexPatterns:indexPatterns,deps:deps,capabilities:capabilities},initialInput,attributeService,savedVisualizationsLoader,parent){if(super(initialInput,{defaultTitle:vis.title,editPath:editPath,editApp:"visualize",editUrl:editUrl,indexPatterns:indexPatterns,visTypeName:vis.type.name},parent),visualize_embeddable_defineProperty(this,"handler",void 0),visualize_embeddable_defineProperty(this,"timefilter",void 0),visualize_embeddable_defineProperty(this,"timeRange",void 0),visualize_embeddable_defineProperty(this,"query",void 0),visualize_embeddable_defineProperty(this,"filters",void 0),visualize_embeddable_defineProperty(this,"searchSessionId",void 0),visualize_embeddable_defineProperty(this,"syncColors",void 0),visualize_embeddable_defineProperty(this,"visCustomizations",void 0),visualize_embeddable_defineProperty(this,"subscriptions",[]),visualize_embeddable_defineProperty(this,"expression",void 0),visualize_embeddable_defineProperty(this,"vis",void 0),visualize_embeddable_defineProperty(this,"domNode",void 0),visualize_embeddable_defineProperty(this,"type",VISUALIZE_EMBEDDABLE_TYPE),visualize_embeddable_defineProperty(this,"abortController",void 0),visualize_embeddable_defineProperty(this,"deps",void 0),visualize_embeddable_defineProperty(this,"inspectorAdapters",void 0),visualize_embeddable_defineProperty(this,"attributeService",void 0),visualize_embeddable_defineProperty(this,"savedVisualizationsLoader",void 0),visualize_embeddable_defineProperty(this,"getInspectorAdapters",()=>{if(this.handler&&(!this.inspectorAdapters||Object.keys(this.inspectorAdapters).length))return this.handler.inspect()}),visualize_embeddable_defineProperty(this,"openInspector",()=>{if(!this.handler)return;const adapters=this.handler.inspect();return adapters?this.deps.start().plugins.inspector.open(adapters,{title:this.getTitle()}):void 0}),visualize_embeddable_defineProperty(this,"hasInspector",()=>Boolean(this.getInspectorAdapters())),visualize_embeddable_defineProperty(this,"onContainerLoading",()=>{this.renderComplete.dispatchInProgress(),this.updateOutput({loading:!0,error:void 0})}),visualize_embeddable_defineProperty(this,"onContainerRender",()=>{this.renderComplete.dispatchComplete(),this.updateOutput({loading:!1,error:void 0})}),visualize_embeddable_defineProperty(this,"onContainerError",error=>{this.abortController&&this.abortController.abort(),this.renderComplete.dispatchError(),this.updateOutput({loading:!1,error:error})}),visualize_embeddable_defineProperty(this,"reload",async()=>{await this.handleVisUpdate()}),visualize_embeddable_defineProperty(this,"handleVisUpdate",async()=>{this.handleChanges(),await this.updateHandler()}),visualize_embeddable_defineProperty(this,"uiStateChangeHandler",()=>{this.updateInput({...this.vis.uiState.toJSON()})}),visualize_embeddable_defineProperty(this,"inputIsRefType",input=>{if(!this.attributeService)throw new Error("AttributeService must be defined for getInputAsRefType");return this.attributeService.inputIsRefType(input)}),visualize_embeddable_defineProperty(this,"getInputAsValueType",async()=>{const input={savedVis:this.vis.serialize()};return this.getTitle()&&(input.savedVis.title=this.getTitle()),delete input.savedVis.id,new Promise(resolve=>{resolve({...input})})}),visualize_embeddable_defineProperty(this,"getInputAsRefType",async()=>{var _this$savedVisualizat;const savedVis=await(null===(_this$savedVisualizat=this.savedVisualizationsLoader)||void 0===_this$savedVisualizat?void 0:_this$savedVisualizat.get({}));if(!savedVis)throw new Error("Error creating a saved vis object");if(!this.attributeService)throw new Error("AttributeService must be defined for getInputAsRefType");const saveModalTitle=this.getTitle()?this.getTitle():external_kbnSharedDeps_KbnI18n_.i18n.translate("visualizations.embeddable.placeholderTitle",{defaultMessage:"Placeholder Title"}),attributes={savedVis:savedVis,vis:this.vis,title:this.vis.title};return this.attributeService.getInputAsRefType({id:this.id,attributes:attributes},{showSaveModal:!0,saveModalTitle:saveModalTitle})}),this.deps=deps,this.timefilter=timefilter,this.syncColors=this.input.syncColors,this.vis=vis,this.vis.uiState.on("change",this.uiStateChangeHandler),this.vis.uiState.on("reload",this.reload),this.attributeService=attributeService,this.savedVisualizationsLoader=savedVisualizationsLoader,this.attributeService){const isByValue=!this.inputIsRefType(initialInput),editable=capabilities.visualizeSave||isByValue&&capabilities.dashboardSave;this.updateOutput({...this.getOutput(),editable:editable})}this.subscriptions.push(this.getUpdated$().subscribe(value=>{this.handleChanges()&&this.handler&&this.updateHandler()}));const inspectorAdapters=this.vis.type.inspectorAdapters;inspectorAdapters&&(this.inspectorAdapters="function"==typeof inspectorAdapters?inspectorAdapters():inspectorAdapters)}getDescription(){return this.vis.description}transferCustomizationsToUiState(){const visCustomizations={vis:this.input.vis,table:this.input.table};var o;visCustomizations.vis||visCustomizations.table?external_kbnSharedDeps_Lodash_default.a.isEqual(visCustomizations,this.visCustomizations)||(this.visCustomizations=visCustomizations,this.vis.uiState.off("change",this.uiStateChangeHandler),this.vis.uiState.clearAllKeys(),visCustomizations.vis&&(this.vis.uiState.set("vis",visCustomizations.vis),(o=visCustomizations,Object.keys(o)).forEach(key=>{this.vis.uiState.set(key,visCustomizations[key])})),visCustomizations.table&&this.vis.uiState.set("table",visCustomizations.table),this.vis.uiState.on("change",this.uiStateChangeHandler)):this.parent&&this.vis.uiState.clearAllKeys()}handleChanges(){this.transferCustomizationsToUiState();let dirty=!1;return external_kbnSharedDeps_Lodash_default.a.isEqual(this.input.timeRange,this.timeRange)||(this.timeRange=external_kbnSharedDeps_Lodash_default.a.cloneDeep(this.input.timeRange),dirty=!0),data_public_.esFilters.onlyDisabledFiltersChanged(this.input.filters,this.filters)||(this.filters=this.input.filters,dirty=!0),external_kbnSharedDeps_Lodash_default.a.isEqual(this.input.query,this.query)||(this.query=this.input.query,dirty=!0),this.searchSessionId!==this.input.searchSessionId&&(this.searchSessionId=this.input.searchSessionId,dirty=!0),this.syncColors!==this.input.syncColors&&(this.syncColors=this.input.syncColors,dirty=!0),this.vis.description&&this.domNode&&this.domNode.setAttribute("data-description",this.vis.description),dirty}async render(domNode){this.timeRange=external_kbnSharedDeps_Lodash_default.a.cloneDeep(this.input.timeRange),this.transferCustomizationsToUiState();const div=document.createElement("div");div.className="visualize panel-content panel-content--fullWidth",domNode.appendChild(div),this.domNode=div,super.render(this.domNode);const expressions=getExpressions();this.handler=new expressions.ExpressionLoader(this.domNode,void 0,{onRenderError:(element,error)=>{this.onContainerError(error)}}),this.subscriptions.push(this.handler.events$.subscribe(async event=>{if("bounds"!==event.name){if(!this.input.disableTriggers){const triggerId=Object(external_kbnSharedDeps_Lodash_.get)(VIS_EVENT_TO_TRIGGER,event.name,VIS_EVENT_TO_TRIGGER.filter);let context;var _this$vis$data$indexP,_this$vis$data$indexP2;if(triggerId===VIS_EVENT_TO_TRIGGER.applyFilter)context={embeddable:this,timeFieldName:null===(_this$vis$data$indexP=this.vis.data.indexPattern)||void 0===_this$vis$data$indexP?void 0:_this$vis$data$indexP.timeFieldName,...event.data};else context={embeddable:this,data:{timeFieldName:null===(_this$vis$data$indexP2=this.vis.data.indexPattern)||void 0===_this$vis$data$indexP2?void 0:_this$vis$data$indexP2.timeFieldName,...event.data}};getUiActions().getTrigger(triggerId).exec(context)}}else{const agg=this.vis.data.aggs.aggs.find(a=>"geohash_grid"===Object(external_kbnSharedDeps_Lodash_.get)(a,"type.dslName"));(agg&&agg.params.precision!==event.data.precision||agg&&!external_kbnSharedDeps_Lodash_default.a.isEqual(agg.params.boundingBox,event.data.boundingBox))&&(agg.params.boundingBox=event.data.boundingBox,agg.params.precision=event.data.precision,this.reload())}})),this.vis.description&&div.setAttribute("data-description",this.vis.description),div.setAttribute("data-test-subj","visualizationLoader"),div.setAttribute("data-shared-item",""),this.subscriptions.push(this.handler.loading$.subscribe(this.onContainerLoading)),this.subscriptions.push(this.handler.render$.subscribe(this.onContainerRender)),this.updateHandler()}destroy(){super.destroy(),this.subscriptions.forEach(s=>s.unsubscribe()),this.vis.uiState.off("change",this.uiStateChangeHandler),this.vis.uiState.off("reload",this.reload),this.handler&&(this.handler.destroy(),this.handler.getElement().remove())}async updateHandler(){const expressionParams={searchContext:{timeRange:this.timeRange,query:this.input.query,filters:this.input.filters},searchSessionId:this.input.searchSessionId,syncColors:this.input.syncColors,uiState:this.vis.uiState,inspectorAdapters:this.inspectorAdapters};this.abortController&&this.abortController.abort(),this.abortController=new AbortController;const abortController=this.abortController;this.expression=await(async(vis,params)=>{const{savedSearchId:savedSearchId,searchSource:searchSource}=vis.data,query=null==searchSource?void 0:searchSource.getField("query");let filters=null==searchSource?void 0:searchSource.getField("filter");"function"==typeof filters&&(filters=filters());const kibana=Object(expressions_public_.buildExpressionFunction)("kibana",{}),kibanaContext=Object(expressions_public_.buildExpressionFunction)("kibana_context",{q:query&&Object(common_.queryToAst)(query),filters:filters&&Object(common_.filtersToAst)(filters),savedSearchId:savedSearchId}),expression=Object(expressions_public_.buildExpression)([kibana,kibanaContext]).toAst();if(!vis.type.toExpressionAst)throw new Error("Visualization type definition should have toExpressionAst function defined");const visExpressionAst=await vis.type.toExpressionAst(vis,params);return expression.chain.push(...visExpressionAst.chain),expression})(this.vis,{timefilter:this.timefilter,timeRange:this.timeRange,abortSignal:this.abortController.signal}),this.handler&&!abortController.signal.aborted&&await this.handler.update(this.expression,expressionParams)}supportedTriggers(){var _this$vis$type$getSup,_this$vis$type$getSup2,_this$vis$type;return null!==(_this$vis$type$getSup=null===(_this$vis$type$getSup2=(_this$vis$type=this.vis.type).getSupportedTriggers)||void 0===_this$vis$type$getSup2?void 0:_this$vis$type$getSup2.call(_this$vis$type))&&void 0!==_this$vis$type$getSup?_this$vis$type$getSup:[]}}var external_kbnSharedDeps_RxjsOperators_=__webpack_require__(26),events=__webpack_require__(27),external_kbnSharedDeps_SaferLodashSet_=__webpack_require__(8);function persisted_state_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function prepSetParams(key,value,path){return void 0===value&&(Object(external_kbnSharedDeps_Lodash_.isPlainObject)(key)||path.length>0)&&(value=key,key=void 0),{value:Object(external_kbnSharedDeps_Lodash_.cloneDeep)(value),key:key}}class persisted_state_PersistedState extends events.EventEmitter{constructor(value,path){if(super(),persisted_state_defineProperty(this,"_path",void 0),persisted_state_defineProperty(this,"_initialized",void 0),persisted_state_defineProperty(this,"_changedState",void 0),persisted_state_defineProperty(this,"_defaultState",void 0),persisted_state_defineProperty(this,"_mergedState",void 0),this._path=this.setPath(path),!this._path.length&&value&&!Object(external_kbnSharedDeps_Lodash_.isPlainObject)(value))throw new Error("State value must be a plain object");value=value||this.getDefault(),this.set(value),this._initialized=!0}get(key,defaultValue){return this.hasPath()||void 0!==key?Object(external_kbnSharedDeps_Lodash_.cloneDeep)(Object(external_kbnSharedDeps_Lodash_.get)(this._mergedState,this.getIndex(key||""),defaultValue)):this._mergedState}set(key,value){const params=prepSetParams(key,value,this._path),val=this.setValue(params.key,params.value);return this.emit("set"),val}setSilent(key,value){const params=prepSetParams(key,value,this._path);if(params.key||params.value)return this.setValue(params.key,params.value,!0)}clearAllKeys(){Object.getOwnPropertyNames(this._changedState).forEach(key=>{this.set(key,null)})}reset(path){const keyPath=this.getIndex(path),origValue=Object(external_kbnSharedDeps_Lodash_.get)(this._defaultState,keyPath),currentValue=Object(external_kbnSharedDeps_Lodash_.get)(this._mergedState,keyPath);void 0===origValue?this.cleanPath(path,this._mergedState):Object(external_kbnSharedDeps_SaferLodashSet_.set)(this._mergedState,keyPath,origValue),this.cleanPath(path,this._changedState),Object(external_kbnSharedDeps_Lodash_.isEqual)(currentValue,origValue)||this.emit("change")}getChanges(){return Object(external_kbnSharedDeps_Lodash_.cloneDeep)(this._changedState)}toJSON(){return this.get()}toString(){return JSON.stringify(this.toJSON())}fromString(input){return this.set(JSON.parse(input))}getIndex(key){return void 0===key?this._path:[...this._path||[],...Object(external_kbnSharedDeps_Lodash_.toPath)(key)]}getPartialIndex(key){return this.getIndex(key).slice(this._path.length)}cleanPath(path,stateTree){const partialPath=this.getPartialIndex(path);let remove=!0;if(Array.isArray(partialPath))for(;partialPath.length>0;){const lastKey=partialPath.splice(partialPath.length-1,1)[0],statePath=[...this._path,partialPath],stateVal=statePath.length>0?Object(external_kbnSharedDeps_Lodash_.get)(stateTree,statePath):stateTree;if(!Object(external_kbnSharedDeps_Lodash_.isPlainObject)(stateVal))return;remove&&delete stateVal[lastKey],Object.keys(stateVal).length>0&&(remove=!1)}}getDefault(){return this.hasPath()?void 0:{}}setPath(path){return Array.isArray(path)?path:Object(external_kbnSharedDeps_Lodash_.isString)(path)?[...this.getIndex(path)]:[]}hasPath(){return this._path.length>0}setValue(key,value,silent=!1){const self=this;let stateChanged=!1;const initialState=!this._initialized,keyPath=this.getIndex(key),hasKeyPath=keyPath.length>0;if(initialState&&(this._changedState={},this.hasPath()||void 0!==key?this._defaultState=Object(external_kbnSharedDeps_SaferLodashSet_.set)({},keyPath,value):this._defaultState=value),!initialState)if(this.hasPath()||void 0!==key){const curVal=hasKeyPath?this.get(keyPath):this._mergedState;stateChanged=!Object(external_kbnSharedDeps_Lodash_.isEqual)(curVal,value),Array.isArray(Object(external_kbnSharedDeps_Lodash_.get)(this._mergedState,keyPath))&&(hasKeyPath?Object(external_kbnSharedDeps_SaferLodashSet_.set)(this._mergedState,keyPath,void 0):this._mergedState=void 0),hasKeyPath?Object(external_kbnSharedDeps_SaferLodashSet_.set)(this._changedState,keyPath,value):this._changedState=Object(external_kbnSharedDeps_Lodash_.isPlainObject)(value)?value:{}}else stateChanged=!Object(external_kbnSharedDeps_Lodash_.isEqual)(this._changedState,value),this._changedState=value,this._mergedState=Object(external_kbnSharedDeps_Lodash_.cloneDeep)(value);const targetObj=this._mergedState||Object(external_kbnSharedDeps_Lodash_.cloneDeep)(this._defaultState),sourceObj=Object(external_kbnSharedDeps_Lodash_.merge)({},this._changedState);return this._mergedState=Object(external_kbnSharedDeps_Lodash_.mergeWith)(targetObj,sourceObj,(function(targetValue,sourceValue,mergeKey){if(!initialState&&Object(external_kbnSharedDeps_Lodash_.isEqual)(keyPath,self.getIndex(mergeKey)))return void 0===sourceValue?targetValue:sourceValue})),Object(external_kbnSharedDeps_Lodash_.isEqual)(this._mergedState,this._defaultState)&&(this._changedState={}),!silent&&stateChanged&&this.emit("change",key),this}}function vis_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class vis_Vis{constructor(visType,visState={}){vis_defineProperty(this,"type",void 0),vis_defineProperty(this,"id",void 0),vis_defineProperty(this,"title",""),vis_defineProperty(this,"description",""),vis_defineProperty(this,"params",void 0),vis_defineProperty(this,"data",{}),vis_defineProperty(this,"uiState",void 0),this.type=this.getType(visType),this.params=this.getParams(visState.params),this.uiState=new persisted_state_PersistedState(visState.uiState),this.id=visState.id}getType(visType){const type=getTypes().get(visType);if(!type){const errorMessage=external_kbnSharedDeps_KbnI18n_.i18n.translate("visualizations.visualizationTypeInvalidMessage",{defaultMessage:'Invalid visualization type "{visType}"',values:{visType:visType}});throw new Error(errorMessage)}return type}getParams(params){var _this$type$visConfig$,_this$type$visConfig;return Object(external_kbnSharedDeps_Lodash_.defaults)({},Object(external_kbnSharedDeps_Lodash_.cloneDeep)(null!=params?params:{}),Object(external_kbnSharedDeps_Lodash_.cloneDeep)(null!==(_this$type$visConfig$=null===(_this$type$visConfig=this.type.visConfig)||void 0===_this$type$visConfig?void 0:_this$type$visConfig.defaults)&&void 0!==_this$type$visConfig$?_this$type$visConfig$:{}))}async setState(state){let typeChanged=!1;if(state.type&&this.type.name!==state.type&&(this.type=this.getType(state.type),typeChanged=!0),void 0!==state.title&&(this.title=state.title),void 0!==state.description&&(this.description=state.description),(state.params||typeChanged)&&(this.params=this.getParams(state.params)),state.data&&state.data.searchSource&&(this.data.searchSource=await getSearch().searchSource.create(state.data.searchSource),this.data.indexPattern=this.data.searchSource.getField("index")),state.data&&state.data.savedSearchId&&(this.data.savedSearchId=state.data.savedSearchId,this.data.searchSource&&(this.data.searchSource=await(async(inputSearchSource,savedSearchId)=>{const searchSource=inputSearchSource.createCopy();if(savedSearchId){const savedSearch=await getSavedSearchLoader().get(savedSearchId);searchSource.setParent(savedSearch.searchSource)}return searchSource.setField("size",0),searchSource})(this.data.searchSource,this.data.savedSearchId),this.data.indexPattern=this.data.searchSource.getField("index"))),state.data&&(state.data.aggs||!this.data.aggs)){const aggs=state.data.aggs?Object(external_kbnSharedDeps_Lodash_.cloneDeep)(state.data.aggs):[],configStates=this.initializeDefaultsFromSchemas(aggs,this.type.schemas.all||[]);if(!this.data.indexPattern){if(aggs.length){const errorMessage=external_kbnSharedDeps_KbnI18n_.i18n.translate("visualizations.initializeWithoutIndexPatternErrorMessage",{defaultMessage:"Trying to initialize aggs without index pattern"});throw new Error(errorMessage)}return}this.data.aggs=getAggs().createAggConfigs(this.data.indexPattern,configStates)}}clone(){const{data:data,...restOfSerialized}=this.serialize(),vis=new vis_Vis(this.type.name,restOfSerialized);vis.setState({...restOfSerialized,data:{}});const aggs=this.data.indexPattern?getAggs().createAggConfigs(this.data.indexPattern,data.aggs):void 0;return vis.data={...this.data,aggs:aggs},vis}serialize(){const aggs=this.data.aggs?this.data.aggs.aggs.map(agg=>agg.toJSON()):[];return{id:this.id,title:this.title,description:this.description,type:this.type.name,params:Object(external_kbnSharedDeps_Lodash_.cloneDeep)(this.params),uiState:this.uiState.toJSON(),data:{aggs:aggs,searchSource:this.data.searchSource?this.data.searchSource.getSerializedFields():{},savedSearchId:this.data.savedSearchId}}}isHierarchical(){return Object(external_kbnSharedDeps_Lodash_.isFunction)(this.type.hierarchicalData)?!!this.type.hierarchicalData(this):!!this.type.hierarchicalData}initializeDefaultsFromSchemas(configStates,schemas){const newConfigs=[...configStates];return schemas.filter(schema=>Array.isArray(schema.defaults)&&schema.defaults.length>0).filter(schema=>!configStates.find(agg=>agg.schema&&agg.schema===schema.name)).forEach(schema=>{schema.defaults.slice(0,schema.max).forEach(d=>newConfigs.push(d))}),newConfigs}}const NewVisModal=Object(external_kbnSharedDeps_React_.lazy)(()=>__webpack_require__.e(1).then(__webpack_require__.bind(null,60)));function showNewVisModal({editorParams:editorParams=[],onClose:onClose,originatingApp:originatingApp,outsideVisualizeApp:outsideVisualizeApp,showAggsSelection:showAggsSelection,selectedVisType:selectedVisType}={}){const container=document.createElement("div");let isClosed=!1;const handleClose=()=>{isClosed||(external_kbnSharedDeps_ReactDom_default.a.unmountComponentAtNode(container),document.body.removeChild(container),onClose&&onClose(),isClosed=!0)};document.body.appendChild(container);const element=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.I18nProvider,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Suspense,{fallback:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPortal,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiProgress,{size:"xs",position:"fixed"}))},external_kbnSharedDeps_React_default.a.createElement(NewVisModal,{isOpen:!0,onClose:handleClose,originatingApp:originatingApp,stateTransfer:getEmbeddable().getStateTransfer(),outsideVisualizeApp:outsideVisualizeApp,editorParams:editorParams,visTypesRegistry:getTypes(),addBasePath:getHttp().basePath.prepend,uiSettings:getUISettings(),savedObjects:getSavedObjects(),usageCollection:getUsageCollector(),application:getApplication(),docLinks:getDocLinks(),showAggsSelection:showAggsSelection,selectedVisType:selectedVisType})));return external_kbnSharedDeps_ReactDom_default.a.render(element,container),()=>handleClose()}const updateOldState=visState=>{if(!visState)return visState;const newState=external_kbnSharedDeps_Lodash_default.a.cloneDeep(visState);return function(visState){visState.aggs&&visState.aggs.forEach(agg=>{"terms"===agg.type&&agg.params&&"_term"===agg.params.orderBy&&(agg.params.orderBy="_key")})}(newState),function(visState){"boolean"==typeof external_kbnSharedDeps_Lodash_default.a.get(visState,"params.showMeticsAtAllLevels")&&(visState.params.showMetricsAtAllLevels=visState.params.showMeticsAtAllLevels,delete visState.params.showMeticsAtAllLevels)}(newState),function(visState){visState.aggs&&visState.aggs.forEach(agg=>{"date_histogram"===agg.type&&agg.params&&"auto"!==agg.params.interval&&void 0===agg.params.scaleMetricValues&&(agg.params.scaleMetricValues=!0)})}(newState),visState.params&&["line","area","histogram"].includes(visState.params.type)&&function(visState){if(visState.params.seriesParams)return;const isUserDefinedYAxis=visState.params.setYExtents,defaultYExtents=visState.params.defaultYExtents,mode=["stacked","overlap"].includes(visState.params.mode)?"normal":visState.params.mode||"normal";visState.params.valueAxes&&visState.params.valueAxes.length||(visState.params.valueAxes=[{id:"ValueAxis-1",name:"LeftAxis-1",type:"value",position:"left",show:!0,style:{},scale:{type:"linear",mode:"normal"},labels:{show:!0,rotate:0,filter:!1,truncate:100},title:{text:"Count"}}]),visState.params.valueAxes[0].scale={...visState.params.valueAxes[0].scale,type:visState.params.scale||"linear",setYExtents:visState.params.setYExtents||!1,defaultYExtents:visState.params.defaultYExtents||!1,boundsMargin:defaultYExtents?visState.params.boundsMargin:0,min:isUserDefinedYAxis?visState.params.yAxis.min:void 0,max:isUserDefinedYAxis?visState.params.yAxis.max:void 0,mode:mode};const interpolate=visState.params.smoothLines?"cardinal":visState.params.interpolate,stacked=["stacked","percentage","wiggle","silhouette"].includes(visState.params.mode);visState.params.seriesParams=[{show:!0,type:visState.params.type||"line",mode:stacked?"stacked":"normal",interpolate:interpolate,drawLinesBetweenPoints:visState.params.drawLinesBetweenPoints,showCircles:visState.params.showCircles,radiusRatio:visState.params.radiusRatio,data:{label:"Count",id:"1"},lineWidth:2,valueAxis:"ValueAxis-1"}]}(newState),"gauge"===visState.type&&visState.fontSize&&(delete newState.fontSize,Object(external_kbnSharedDeps_SaferLodashSet_.set)(newState,"gauge.style.fontSize",visState.fontSize)),["gauge","metric"].includes(visState.type)&&"Metric"===external_kbnSharedDeps_Lodash_default.a.get(visState.params,"gauge.gaugeType",null)?(newState.type="metric",newState.params.addLegend=!1,newState.params.type="metric",newState.params.metric=newState.params.gauge,delete newState.params.gauge,delete newState.params.metric.gaugeType,delete newState.params.metric.gaugeStyle,delete newState.params.metric.backStyle,delete newState.params.metric.scale,delete newState.params.metric.type,delete newState.params.metric.orientation,delete newState.params.metric.verticalSplit,delete newState.params.metric.autoExtend,newState.params.metric.metricColorMode=newState.params.metric.gaugeColorMode,delete newState.params.metric.gaugeColorMode):"metric"===visState.type&&"Metric"!==external_kbnSharedDeps_Lodash_default.a.get(visState.params,"gauge.gaugeType","Metric")&&(newState.type="gauge",newState.params.type="gauge"),function(visState){const hasOverwriteColorParam=void 0!==external_kbnSharedDeps_Lodash_default.a.get(visState,"params.valueAxes[0].labels.overwriteColor");if("heatmap"===visState.type&&visState.params&&!hasOverwriteColorParam){const showLabels=external_kbnSharedDeps_Lodash_default.a.get(visState,"params.valueAxes[0].labels.show",!1),color=external_kbnSharedDeps_Lodash_default.a.get(visState,"params.valueAxes[0].labels.color","#555");Object(external_kbnSharedDeps_SaferLodashSet_.set)(visState,"params.valueAxes[0].labels.overwriteColor",showLabels&&"#555"!==color)}}(newState),newState},isControlsVis=visType=>"input_control_vis"===visType,extractControlsReferences=(visType,visParams,references=[],prefix="control")=>{var _visParams$controls;isControlsVis(visType)&&(null!==(_visParams$controls=null==visParams?void 0:visParams.controls)&&void 0!==_visParams$controls?_visParams$controls:[]).forEach((control,i)=>{control.indexPattern&&(control.indexPatternRefName=`${prefix}_${i}_index_pattern`,references.push({name:control.indexPatternRefName,type:"index-pattern",id:control.indexPattern}),delete control.indexPattern)})},injectControlsReferences=(visType,visParams,references)=>{var _visParams$controls2;isControlsVis(visType)&&(null!==(_visParams$controls2=visParams.controls)&&void 0!==_visParams$controls2?_visParams$controls2:[]).forEach(control=>{if(!control.indexPatternRefName)return;const reference=references.find(ref=>ref.name===control.indexPatternRefName);if(!reference)throw new Error(`Could not find index pattern reference "${control.indexPatternRefName}"`);control.indexPattern=reference.id,delete control.indexPatternRefName})},isMetricsVis=visType=>"metrics"===visType,doForExtractedIndices=(action,visParams)=>{action(visParams,"index_pattern"),visParams.series.forEach(series=>{series.override_index_pattern&&action(series,"series_index_pattern")}),visParams.annotations&&visParams.annotations.forEach(annotation=>{action(annotation,"index_pattern")})},extractTimeSeriesReferences=(visType,visParams,references=[],prefix="metrics")=>{let i=0;isMetricsVis(visType)&&doForExtractedIndices((object,key)=>{if(object[key]&&object[key].id){const name=`${prefix}_${i++}_index_pattern`;object[key+"_ref_name"]=name,references.push({name:name,type:"index_pattern",id:object[key].id}),delete object[key]}},visParams)},injectTimeSeriesReferences=(visType,visParams,references)=>{isMetricsVis(visType)&&doForExtractedIndices((object,key)=>{const refKey=key+"_ref_name";if(object[refKey]){const refValue=references.find(ref=>ref.name===object[refKey]);refValue&&(object[key]={id:refValue.id}),delete object[refKey]}},visParams)};function extractReferences({attributes:attributes,references:references=[]}){const updatedAttributes={...attributes},updatedReferences=[...references];if(updatedAttributes.searchSourceFields){const[searchSource,searchSourceReferences]=Object(data_public_.extractSearchSourceReferences)(updatedAttributes.searchSourceFields);updatedAttributes.searchSourceFields=searchSource,searchSourceReferences.forEach(r=>updatedReferences.push(r))}if(updatedAttributes.savedSearchId&&(updatedReferences.push({name:"search_0",type:"search",id:String(updatedAttributes.savedSearchId)}),delete updatedAttributes.savedSearchId,updatedAttributes.savedSearchRefName="search_0"),updatedAttributes.visState){const visState=JSON.parse(String(updatedAttributes.visState));visState.type&&visState.params&&(extractControlsReferences(visState.type,visState.params,updatedReferences),extractTimeSeriesReferences(visState.type,visState.params,updatedReferences)),updatedAttributes.visState=JSON.stringify(visState)}return{references:updatedReferences,attributes:updatedAttributes}}function injectReferences(savedObject,references){var _savedObject$visState;if(savedObject.searchSourceFields&&(savedObject.searchSourceFields=Object(data_public_.injectSearchSourceReferences)(savedObject.searchSourceFields,references)),savedObject.savedSearchRefName){const savedSearchReference=references.find(reference=>reference.name===savedObject.savedSearchRefName);if(!savedSearchReference)throw new Error(`Could not find saved search reference "${savedObject.savedSearchRefName}"`);savedObject.savedSearchId=savedSearchReference.id,delete savedObject.savedSearchRefName}const{type:type,params:params}=null!==(_savedObject$visState=savedObject.visState)&&void 0!==_savedObject$visState?_savedObject$visState:{};type&&params&&(injectControlsReferences(type,params,references),injectTimeSeriesReferences(type,params,references))}var discover_public_=__webpack_require__(21);function _saved_vis_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}const convertToSerializedVis=savedVis=>{const{id:id,title:title,description:description,visState:visState,uiStateJSON:uiStateJSON,searchSourceFields:searchSourceFields}=savedVis,aggs=searchSourceFields&&searchSourceFields.index?visState.aggs||[]:visState.aggs;return{id:id,title:title,type:visState.type,description:description,params:visState.params,uiState:JSON.parse(uiStateJSON||"{}"),data:{aggs:aggs,searchSource:searchSourceFields,savedSearchId:savedVis.savedSearchId}}},convertFromSerializedVis=vis=>({id:vis.id,title:vis.title,description:vis.description,visState:{title:vis.title,type:vis.type,aggs:vis.data.aggs,params:vis.params},uiStateJSON:JSON.stringify(vis.uiState),searchSourceFields:vis.data.searchSource,savedSearchId:vis.data.savedSearchId});var constants=__webpack_require__(10);const createVisEmbeddableFromObject=deps=>async(vis,input,savedVisualizationsLoader,attributeService,parent)=>{const savedVisualizations=getSavedVisualizationsLoader();try{var _getCapabilities$dash;const visId=vis.id,editPath=visId?savedVisualizations.urlFor(visId):"#/edit_by_value",editUrl=visId?getHttp().basePath.prepend("/app/visualize"+savedVisualizations.urlFor(visId)):"";if(!getUISettings().get(constants.a)&&"experimental"===vis.type.stage)return new disabled_lab_embeddable_DisabledLabEmbeddable(vis.title,input);let indexPatterns=[];vis.type.getUsedIndexPattern?indexPatterns=await vis.type.getUsedIndexPattern(vis.params):vis.data.indexPattern&&(indexPatterns=[vis.data.indexPattern]);const capabilities={visualizeSave:Boolean(getCapabilities().visualize.save),dashboardSave:Boolean(null===(_getCapabilities$dash=getCapabilities().dashboard)||void 0===_getCapabilities$dash?void 0:_getCapabilities$dash.showWriteControls)};return new visualize_embeddable_VisualizeEmbeddable(getTimeFilter(),{vis:vis,indexPatterns:indexPatterns,editPath:editPath,editUrl:editUrl,deps:deps,capabilities:capabilities},input,attributeService,savedVisualizationsLoader,parent)}catch(e){return console.error(e),new embeddable_public_.ErrorEmbeddable(e,input,parent)}};var savedObjects_public_=__webpack_require__(20);function visualize_embeddable_factory_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class visualize_embeddable_factory_VisualizeEmbeddableFactory{constructor(deps){this.deps=deps,visualize_embeddable_factory_defineProperty(this,"type",VISUALIZE_EMBEDDABLE_TYPE),visualize_embeddable_factory_defineProperty(this,"attributeService",void 0),visualize_embeddable_factory_defineProperty(this,"savedObjectMetaData",{name:external_kbnSharedDeps_KbnI18n_.i18n.translate("visualizations.savedObjectName",{defaultMessage:"Visualization"}),includeFields:["visState"],type:"visualization",getIconForSavedObject:savedObject=>{var _getTypes$get;return(null===(_getTypes$get=getTypes().get(JSON.parse(savedObject.attributes.visState).type))||void 0===_getTypes$get?void 0:_getTypes$get.icon)||"visualizeApp"},getTooltipForSavedObject:savedObject=>{var _getTypes$get2;return`${savedObject.attributes.title} (${null===(_getTypes$get2=getTypes().get(JSON.parse(savedObject.attributes.visState).type))||void 0===_getTypes$get2?void 0:_getTypes$get2.title})`},showSavedObject:savedObject=>{const typeName=JSON.parse(savedObject.attributes.visState).type,visType=getTypes().get(typeName);return!!visType&&(!!getUISettings().get(constants.a)||"experimental"!==visType.stage)}})}async isEditable(){return getCapabilities().visualize.save}getDisplayName(){return external_kbnSharedDeps_KbnI18n_.i18n.translate("visualizations.displayName",{defaultMessage:"Visualization"})}async getCurrentAppId(){return await this.deps.start().core.application.currentAppId$.pipe(Object(external_kbnSharedDeps_RxjsOperators_.first)()).toPromise()}async getAttributeService(){return this.attributeService||(this.attributeService=await this.deps.start().plugins.embeddable.getAttributeService(this.type,{saveMethod:this.saveMethod.bind(this),checkForDuplicateTitle:this.checkTitle.bind(this)})),this.attributeService}async createFromSavedObject(savedObjectId,input,parent){const savedVisualizations=getSavedVisualizationsLoader();try{const savedObject=await savedVisualizations.get(savedObjectId),visState=convertToSerializedVis(savedObject),vis=new vis_Vis(savedObject.visState.type,visState);return await vis.setState(visState),createVisEmbeddableFromObject(this.deps)(vis,input,savedVisualizations,await this.getAttributeService(),parent)}catch(e){return console.error(e),new embeddable_public_.ErrorEmbeddable(e,input,parent)}}async create(input,parent){if(input.savedVis){const visState=input.savedVis,vis=new vis_Vis(visState.type,visState);await vis.setState(visState);const savedVisualizations=getSavedVisualizationsLoader();return createVisEmbeddableFromObject(this.deps)(vis,input,savedVisualizations,await this.getAttributeService(),parent)}showNewVisModal({originatingApp:await this.getCurrentAppId(),outsideVisualizeApp:!0})}async saveMethod(attributes){try{var _visObj$data$searchSo;const{title:title,savedVis:savedVis}=attributes,visObj=attributes.vis;if(!savedVis)throw new Error("No Saved Vis");const saveOptions={confirmOverwrite:!1,returnToOrigin:!0,isTitleDuplicateConfirmed:!0};savedVis.title=title,savedVis.copyOnSave=!1,savedVis.description="",savedVis.searchSourceFields=null==visObj||null===(_visObj$data$searchSo=visObj.data.searchSource)||void 0===_visObj$data$searchSo?void 0:_visObj$data$searchSo.getSerializedFields();const serializedVis=visObj.serialize(),{params:params,data:data}=serializedVis;savedVis.visState={title:title,type:serializedVis.type,params:params,aggs:data.aggs},visObj&&(savedVis.uiStateJSON=null==visObj?void 0:visObj.uiState.toString());const id=await savedVis.save(saveOptions);if(!id||""===id)throw new Error(external_kbnSharedDeps_KbnI18n_.i18n.translate("visualizations.savingVisualizationFailed.errorMsg",{defaultMessage:"Saving a visualization failed"}));return{id:id}}catch(error){throw error}}async checkTitle(props){const savedObjectsClient=await this.deps.start().core.savedObjects.client,overlays=await this.deps.start().core.overlays;return Object(savedObjects_public_.checkForDuplicateTitle)({title:props.newTitle,copyOnSave:!1,lastSavedTitle:"",getEsType:()=>this.type,getDisplayName:this.getDisplayName||(()=>this.type)},props.isTitleDuplicateConfirmed,props.onTitleDuplicate,{savedObjectsClient:savedObjectsClient,overlays:overlays})}inject(_state,references){var _state$savedVis;const state=_state,{type:type,params:params}=null!==(_state$savedVis=state.savedVis)&&void 0!==_state$savedVis?_state$savedVis:{};return type&&params&&(injectControlsReferences(type,params,references),injectTimeSeriesReferences(type,params,references)),_state}extract(_state){var _state$savedVis2,_state$savedVis3,_state$savedVis4;const state=_state,references=[];if(null!==(_state$savedVis2=state.savedVis)&&void 0!==_state$savedVis2&&_state$savedVis2.data.searchSource){const[,searchSourceReferences]=Object(data_public_.extractSearchSourceReferences)(state.savedVis.data.searchSource);references.push(...searchSourceReferences)}null!==(_state$savedVis3=state.savedVis)&&void 0!==_state$savedVis3&&_state$savedVis3.data.savedSearchId&&references.push({name:"search_0",type:"search",id:String(state.savedVis.data.savedSearchId)});const{type:type,params:params}=null!==(_state$savedVis4=state.savedVis)&&void 0!==_state$savedVis4?_state$savedVis4:{};return type&&params&&(extractControlsReferences(type,params,references,"control_"+state.id),extractTimeSeriesReferences(type,params,references,"metrics_"+state.id)),{state:_state,references:references}}}const range=()=>({name:"range",help:external_kbnSharedDeps_KbnI18n_.i18n.translate("visualizations.function.range.help",{defaultMessage:"Generates range object"}),type:"range",args:{from:{types:["number"],help:external_kbnSharedDeps_KbnI18n_.i18n.translate("visualizations.function.range.from.help",{defaultMessage:"Start of range"}),required:!0},to:{types:["number"],help:external_kbnSharedDeps_KbnI18n_.i18n.translate("visualizations.function.range.to.help",{defaultMessage:"End of range"}),required:!0}},fn:(context,args)=>({type:"range",from:args.from,to:args.to})}),visDimension=()=>({name:"visdimension",help:external_kbnSharedDeps_KbnI18n_.i18n.translate("visualizations.function.visDimension.help",{defaultMessage:"Generates visConfig dimension object"}),type:"vis_dimension",inputTypes:["datatable"],args:{accessor:{types:["string","number"],aliases:["_"],help:external_kbnSharedDeps_KbnI18n_.i18n.translate("visualizations.function.visDimension.accessor.help",{defaultMessage:"Column in your dataset to use (either column index or column name)"})},format:{types:["string"],default:"string",help:external_kbnSharedDeps_KbnI18n_.i18n.translate("visualizations.function.visDimension.format.help",{defaultMessage:"Format"})},formatParams:{types:["string"],default:'"{}"',help:external_kbnSharedDeps_KbnI18n_.i18n.translate("visualizations.function.visDimension.formatParams.help",{defaultMessage:"Format params"})}},fn:(input,args)=>{const accessor="number"==typeof args.accessor?args.accessor:input.columns.find(c=>c.id===args.accessor);if(void 0===accessor)throw new Error(external_kbnSharedDeps_KbnI18n_.i18n.translate("visualizations.function.visDimension.error.accessor",{defaultMessage:"Column name provided is invalid"}));return{type:"vis_dimension",accessor:accessor,format:{id:args.format,params:JSON.parse(args.formatParams)}}}});function createSavedVisLoader(services){const{savedObjectsClient:savedObjectsClient,visualizationTypes:visualizationTypes}=services;class SavedObjectLoaderVisualize extends savedObjects_public_.SavedObjectLoader{constructor(...args){var obj,key,value;super(...args),value=(source,id,references=[])=>{const visTypes=visualizationTypes;source.id=id,source.references=references,source.url=this.urlFor(id);let typeName=source.typeName;if(source.visState)try{typeName=JSON.parse(String(source.visState)).type}catch(e){}return typeName&&visTypes.get(typeName)?(source.type=visTypes.get(typeName),source.savedObjectType="visualization",source.icon=source.type.icon,source.image=source.type.image,source.typeTitle=source.type.title,source.editUrl="/edit/"+id,source):(source.error="Unknown visualization type",source)},(key="mapHitSource")in(obj=this)?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value}urlFor(id){return"#/edit/"+encodeURIComponent(id)}findListItems(search="",sizeOrOptions=100){const{size:size=100,references:references}="number"==typeof sizeOrOptions?{size:sizeOrOptions}:sizeOrOptions;return async function({visTypes:visTypes,search:search,size:size,savedObjectsClient:savedObjectsClient,mapSavedObjectApiHits:mapSavedObjectApiHits,references:references}){const extensions=visTypes.map(v=>{var _v$appExtensions;return null===(_v$appExtensions=v.appExtensions)||void 0===_v$appExtensions?void 0:_v$appExtensions.visualizations}).filter(Boolean),extensionByType=extensions.reduce((acc,m)=>m.docTypes.reduce((_acc,type)=>(acc[type]=m,acc),acc),{}),searchOption=(field,...defaults)=>external_kbnSharedDeps_Lodash_default()(extensions).map(field).concat(defaults).compact().flatten().uniq().value(),searchOptions={type:searchOption("docTypes","visualization"),searchFields:searchOption("searchFields","title^3","description"),search:search?search+"*":void 0,perPage:size,page:1,defaultSearchOperator:"AND",hasReference:references},{total:total,savedObjects:savedObjects}=await savedObjectsClient.find(searchOptions);return{total:total,hits:savedObjects.map(savedObject=>{const config=extensionByType[savedObject.type];return config?{...config.toListItem(savedObject),references:savedObject.references}:mapSavedObjectApiHits(savedObject)})}}({search:search,size:size,references:references,mapSavedObjectApiHits:this.mapSavedObjectApiHits.bind(this),savedObjectsClient:savedObjectsClient,visTypes:visualizationTypes.getAliases()})}}return new SavedObjectLoaderVisualize(function(services){const savedSearch=Object(discover_public_.createSavedSearchesLoader)(services);class SavedVis extends services.savedObjects.SavedObjectClass{constructor(opts={}){"object"!=typeof opts&&(opts={id:opts});const visState=opts.type?{type:opts.type}:null;super({type:SavedVis.type,mapping:SavedVis.mapping,extractReferences:extractReferences,injectReferences:injectReferences,id:opts.id||"",indexPattern:opts.indexPattern,defaults:{title:"",visState:visState,uiStateJSON:"{}",description:"",savedSearchId:opts.savedSearchId,version:1},afterESResp:async savedObject=>{var _savedVis$searchSourc;const savedVis=savedObject;return savedVis.visState=await updateOldState(savedVis.visState),null!==(_savedVis$searchSourc=savedVis.searchSourceFields)&&void 0!==_savedVis$searchSourc&&_savedVis$searchSourc.index&&await services.indexPatterns.get(savedVis.searchSourceFields.index),savedVis.savedSearchId&&await savedSearch.get(savedVis.savedSearchId),savedVis}}),this.showInRecentlyAccessed=!0,this.getFullPath=()=>"/app/visualize#/edit/"+this.id}}return _saved_vis_defineProperty(SavedVis,"type","visualization"),_saved_vis_defineProperty(SavedVis,"mapping",{title:"text",visState:"json",uiStateJSON:"text",description:"text",savedSearchId:"keyword",version:"integer"}),_saved_vis_defineProperty(SavedVis,"fieldOrder",["title","description"]),SavedVis}(services),savedObjectsClient)}function plugin_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class plugin_VisualizationsPlugin{constructor(initializerContext){plugin_defineProperty(this,"types",new vis_types.a),plugin_defineProperty(this,"getStartServicesOrDie",void 0)}setup(core,{expressions:expressions,embeddable:embeddable,usageCollection:usageCollection,data:data}){const start=this.getStartServicesOrDie=Object(public_.createStartServicesGetter)(core.getStartServices);setUISettings(core.uiSettings),setUsageCollector(usageCollection),expressions.registerFunction(range),expressions.registerFunction(visDimension);const embeddableFactory=new visualize_embeddable_factory_VisualizeEmbeddableFactory({start:start});return embeddable.registerEmbeddableFactory(VISUALIZE_EMBEDDABLE_TYPE,embeddableFactory),{...this.types.setup()}}start(core,{data:data,expressions:expressions,uiActions:uiActions,embeddable:embeddable,savedObjects:savedObjects}){const types=this.types.start();setTypes(types),setEmbeddable(embeddable),setApplication(core.application),setCapabilities(core.application.capabilities),setHttp(core.http),setSavedObjects(core.savedObjects),setDocLinks(core.docLinks),setSearch(data.search),setExpressions(expressions),setUiActions(uiActions),setTimeFilter(data.query.timefilter.timefilter),setAggs(data.search.aggs),setOverlays(core.overlays),setChrome(core.chrome);const savedVisualizationsLoader=createSavedVisLoader({savedObjectsClient:core.savedObjects.client,indexPatterns:data.indexPatterns,savedObjects:savedObjects,visualizationTypes:types});setSavedVisualizationsLoader(savedVisualizationsLoader);const savedSearchLoader=Object(discover_public_.createSavedSearchesLoader)({savedObjectsClient:core.savedObjects.client,savedObjects:savedObjects});return setSavedSearchLoader(savedSearchLoader),{...types,showNewVisModal:showNewVisModal,createVis:async(visType,visState)=>{const vis=new vis_Vis(visType);return await vis.setState(visState),vis},convertToSerializedVis:convertToSerializedVis,convertFromSerializedVis:convertFromSerializedVis,savedVisualizationsLoader:savedVisualizationsLoader,__LEGACY:{createVisEmbeddableFromObject:createVisEmbeddableFromObject({start:this.getStartServicesOrDie})}}}stop(){this.types.stop()}}var types_service=__webpack_require__(16),classnames=__webpack_require__(28),classnames_default=__webpack_require__.n(classnames);class visualization_noresults_VisualizationNoResults extends external_kbnSharedDeps_React_default.a.Component{render(){return external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":"visNoResult",className:"visError"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiEmptyPrompt,{iconType:"visualizeApp",iconColor:"default","data-test-subj":"visualization-error",body:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs"},external_kbnSharedDeps_KbnI18n_.i18n.translate("visualizations.noResultsFoundTitle",{defaultMessage:"No results found"}))}))}componentDidMount(){this.afterRender()}componentDidUpdate(){this.afterRender()}afterRender(){this.props.onInit&&this.props.onInit()}}class visualization_error_VisualizationError extends external_kbnSharedDeps_React_default.a.Component{render(){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiEmptyPrompt,{iconType:"alert",iconColor:"danger","data-test-subj":"visualization-error",body:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs"},"string"==typeof this.props.error?this.props.error:this.props.error.message)})}componentDidMount(){this.afterRender()}componentDidUpdate(){this.afterRender()}afterRender(){this.props.onInit&&this.props.onInit()}}const VisualizationContainer=({"data-test-subj":dataTestSubj="",className:className,children:children,handlers:handlers,showNoResult:showNoResult=!1,error:error})=>{const classes=classnames_default()("visualization",className),fallBack=external_kbnSharedDeps_React_default.a.createElement("div",{className:"visChart__spinner"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingChart,{mono:!0,size:"l"}));return external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":dataTestSubj,className:classes},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Suspense,{fallback:fallBack},error?external_kbnSharedDeps_React_default.a.createElement(visualization_error_VisualizationError,{onInit:()=>handlers.done(),error:error}):showNoResult?external_kbnSharedDeps_React_default.a.createElement(visualization_noresults_VisualizationNoResults,{onInit:()=>handlers.done()}):children))},{isDateHistogramBucketAggConfig:isDateHistogramBucketAggConfig}=data_public_.search.aggs,getVisSchemas=(vis,{timeRange:timeRange,timefilter:timefilter})=>{const createSchemaConfig=(accessor,agg)=>{if(isDateHistogramBucketAggConfig(agg)){agg.params.timeRange=timeRange;const bounds=agg.params.timeRange&&agg.fieldIsTimeField()?timefilter.calculateBounds(agg.params.timeRange):void 0;agg.buckets.setBounds(bounds),agg.buckets.setInterval(agg.params.interval)}const formatAgg=["derivative","moving_avg","serial_diff","cumulative_sum","sum_bucket","avg_bucket","min_bucket","max_bucket"].includes(agg.type.name)?agg.params.customMetric||agg.aggConfigs.getRequestAggById(agg.params.metricAgg):agg,params={};"geohash_grid"===agg.type.name&&(params.precision=agg.params.precision,params.useGeocentroid=agg.params.useGeocentroid);const label=agg.makeLabel&&agg.makeLabel();return{accessor:accessor,format:formatAgg.toSerializedFieldFormat(),params:params,label:label,aggType:agg.type.name}};let cnt=0;const schemas={metric:[]};if(!vis.data.aggs)return schemas;const responseAggs=vis.data.aggs.getResponseAggs().filter(agg=>agg.enabled),isHierarchical=vis.isHierarchical(),metrics=responseAggs.filter(agg=>"metrics"===agg.type.type);return responseAggs.forEach(agg=>{let skipMetrics=!1,schemaName=agg.schema;if(!schemaName){if("geo_centroid"!==agg.type.name)return void cnt++;schemaName="geo_centroid"}"split"===schemaName&&(schemaName="split_"+(vis.params.row?"row":"column"),skipMetrics=responseAggs.length-metrics.length>1),schemas[schemaName]||(schemas[schemaName]=[]),isHierarchical&&"metrics"===agg.type.type||schemas[schemaName].push(createSchemaConfig(cnt++,agg)),!isHierarchical||"metrics"===agg.type.type&&metrics.length!==responseAggs.length||metrics.forEach(metric=>{const schemaConfig=createSchemaConfig(cnt++,metric);skipMetrics||schemas.metric.push(schemaConfig)})}),schemas};var common=__webpack_require__(12),vis_type_alias_registry=__webpack_require__(7);function public_plugin(initializerContext){return new plugin_VisualizationsPlugin(initializerContext)}},function(module,exports){module.exports=__kbnSharedDeps__.KbnAnalytics}]);