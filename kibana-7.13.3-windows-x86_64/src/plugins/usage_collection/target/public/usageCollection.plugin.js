!function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}__webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{enumerable:!0,get:getter})},__webpack_require__.r=function(exports){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(exports,"__esModule",{value:!0})},__webpack_require__.t=function(value,mode){if(1&mode&&(value=__webpack_require__(value)),8&mode)return value;if(4&mode&&"object"==typeof value&&value&&value.__esModule)return value;var ns=Object.create(null);if(__webpack_require__.r(ns),Object.defineProperty(ns,"default",{enumerable:!0,value:value}),2&mode&&"string"!=typeof value)for(var key in value)__webpack_require__.d(ns,key,function(key){return value[key]}.bind(null,key));return ns},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function(){return module.default}:function(){return module};return __webpack_require__.d(getter,"a",getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=6)}([function(module,exports){module.exports=__kbnSharedDeps__.React},function(module,exports){module.exports=__kbnSharedDeps__.KbnAnalytics},function(module,exports){module.exports=__kbnSharedDeps__.RxjsOperators},function(module,exports){module.exports=__kbnSharedDeps__.ReactDom},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/kibanaUtils/public");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,exports){module.exports=__kbnSharedDeps__.Rxjs},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__(7);__kbnBundles__.define("plugin/usageCollection/public",__webpack_require__,8)},function(module,exports,__webpack_require__){__webpack_require__.p=window.__kbnPublicPath__.usageCollection},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"METRIC_TYPE",(function(){return external_kbnSharedDeps_KbnAnalytics_.METRIC_TYPE})),__webpack_require__.d(__webpack_exports__,"TrackApplicationView",(function(){return TrackApplicationView})),__webpack_require__.d(__webpack_exports__,"plugin",(function(){return public_plugin}));var external_kbnSharedDeps_KbnAnalytics_=__webpack_require__(1),external_kbnSharedDeps_React_=__webpack_require__(0),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),public_=__webpack_require__(4);var external_kbnSharedDeps_Rxjs_=__webpack_require__(5),external_kbnSharedDeps_RxjsOperators_=__webpack_require__(2);const DO_NOT_REPORT=["kibana"];var external_kbnSharedDeps_ReactDom_=__webpack_require__(3),external_kbnSharedDeps_ReactDom_default=__webpack_require__.n(external_kbnSharedDeps_ReactDom_);class track_application_view_component_TrackApplicationViewComponent extends external_kbnSharedDeps_React_.Component{constructor(...args){var obj,key,value;super(...args),value=()=>{const{applicationUsageTracker:applicationUsageTracker,viewId:viewId}=this.props;null==applicationUsageTracker||applicationUsageTracker.updateViewClickCounter(viewId)},(key="onClick")in(obj=this)?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value}componentDidMount(){const{applicationUsageTracker:applicationUsageTracker,viewId:viewId}=this.props;var _ReactDOM$findDOMNode,_ReactDOM$findDOMNode2;applicationUsageTracker&&(applicationUsageTracker.trackApplicationViewUsage(viewId),null===(_ReactDOM$findDOMNode=external_kbnSharedDeps_ReactDom_default.a.findDOMNode(this))||void 0===_ReactDOM$findDOMNode||null===(_ReactDOM$findDOMNode2=_ReactDOM$findDOMNode.parentNode)||void 0===_ReactDOM$findDOMNode2||_ReactDOM$findDOMNode2.addEventListener("click",this.onClick))}componentWillUnmount(){const{applicationUsageTracker:applicationUsageTracker,viewId:viewId}=this.props;var _ReactDOM$findDOMNode3,_ReactDOM$findDOMNode4;applicationUsageTracker&&(applicationUsageTracker.flushTrackedView(viewId),null===(_ReactDOM$findDOMNode3=external_kbnSharedDeps_ReactDom_default.a.findDOMNode(this))||void 0===_ReactDOM$findDOMNode3||null===(_ReactDOM$findDOMNode4=_ReactDOM$findDOMNode3.parentNode)||void 0===_ReactDOM$findDOMNode4||_ReactDOM$findDOMNode4.removeEventListener("click",this.onClick))}render(){return this.props.children}}const ApplicationUsageContext=Object(external_kbnSharedDeps_React_.createContext)(void 0),TrackApplicationView=props=>external_kbnSharedDeps_React_default.a.createElement(ApplicationUsageContext.Consumer,null,value=>{const propsWithTracker={...props,applicationUsageTracker:value};return external_kbnSharedDeps_React_default.a.createElement(track_application_view_component_TrackApplicationViewComponent,propsWithTracker)});function plugin_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class plugin_UsageCollectionPlugin{constructor(initializerContext){plugin_defineProperty(this,"applicationUsageTracker",void 0),plugin_defineProperty(this,"subscriptions",[]),plugin_defineProperty(this,"reporter",void 0),plugin_defineProperty(this,"config",void 0),this.config=initializerContext.config.get()}setup({http:http}){const localStorage=new public_.Storage(window.localStorage),debug=this.config.uiCounters.debug;this.reporter=function(config){const{localStorage:localStorage,debug:debug,fetch:fetch}=config;return new external_kbnSharedDeps_KbnAnalytics_.Reporter({debug:debug,storage:localStorage,async http(report){const response=await fetch.post("/api/ui_counters/_report",{body:JSON.stringify({report:report}),asSystemRequest:!0});if("ok"!==response.status)throw Error("Unable to store report.");return response}})}({localStorage:localStorage,debug:debug,fetch:http}),this.applicationUsageTracker=new external_kbnSharedDeps_KbnAnalytics_.ApplicationUsageTracker(this.reporter);const applicationUsageTracker=this.getPublicApplicationUsageTracker();return{components:{ApplicationUsageTrackingProvider:props=>external_kbnSharedDeps_React_default.a.createElement(ApplicationUsageContext.Provider,{value:applicationUsageTracker},props.children)},reportUiCounter:this.reporter.reportUiCounter}}start({http:http,application:application}){if(!this.reporter||!this.applicationUsageTracker)throw new Error("Usage collection reporter not set up correctly");var currentAppId$,applicationUsageTracker;return this.config.uiCounters.enabled&&!function(http){const{anonymousPaths:anonymousPaths}=http;return anonymousPaths.isAnonymous(window.location.pathname)}(http)&&(this.reporter.start(),this.applicationUsageTracker.start(),this.subscriptions=(currentAppId$=application.currentAppId$,applicationUsageTracker=this.applicationUsageTracker,[Object(external_kbnSharedDeps_Rxjs_.fromEvent)(window,"click").subscribe(()=>{applicationUsageTracker.updateViewClickCounter("main")}),currentAppId$.pipe(Object(external_kbnSharedDeps_RxjsOperators_.filter)(appId=>"string"==typeof appId&&!DO_NOT_REPORT.includes(appId)),Object(external_kbnSharedDeps_RxjsOperators_.distinctUntilChanged)()).subscribe(appId=>{appId&&(applicationUsageTracker.setCurrentAppId(appId),applicationUsageTracker.trackApplicationViewUsage("main"))})])),this.reporter.reportUserAgent("kibana"),{reportUiCounter:this.reporter.reportUiCounter}}stop(){this.applicationUsageTracker&&(this.applicationUsageTracker.stop(),this.subscriptions.forEach(subscription=>subscription.unsubscribe()))}getPublicApplicationUsageTracker(){return{trackApplicationViewUsage:this.applicationUsageTracker.trackApplicationViewUsage.bind(this.applicationUsageTracker),flushTrackedView:this.applicationUsageTracker.flushTrackedView.bind(this.applicationUsageTracker),updateViewClickCounter:this.applicationUsageTracker.updateViewClickCounter.bind(this.applicationUsageTracker)}}}function public_plugin(initializerContext){return new plugin_UsageCollectionPlugin(initializerContext)}}]);