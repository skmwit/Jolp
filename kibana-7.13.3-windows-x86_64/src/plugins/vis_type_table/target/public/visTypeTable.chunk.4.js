(window.visTypeTable_bundle_jsonpfunction=window.visTypeTable_bundle_jsonpfunction||[]).push([[4],{24:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return VIS_TYPE_TABLE})),__webpack_require__.d(__webpack_exports__,"a",(function(){return AggTypes}));const VIS_TYPE_TABLE="table";let AggTypes;!function(AggTypes){AggTypes.SUM="sum",AggTypes.AVG="avg",AggTypes.MIN="min",AggTypes.MAX="max",AggTypes.COUNT="count"}(AggTypes||(AggTypes={}))},25:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return TableOptions}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(5),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),_elastic_eui__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(8);const TableOptionsComponent=Object(react__WEBPACK_IMPORTED_MODULE_0__.lazy)(()=>__webpack_require__.e(5).then(__webpack_require__.bind(null,27))),TableOptions=props=>react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0__.Suspense,{fallback:react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__.EuiLoadingSpinner,null)},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(TableOptionsComponent,props))},54:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"registerLegacyVis",(function(){return registerLegacyVis}));var external_kbnSharedDeps_KbnAnalytics_=__webpack_require__(17),external_kbnSharedDeps_KbnI18n_=__webpack_require__(6),services=__webpack_require__(0);var common=__webpack_require__(24);const createTableVisLegacyFn=()=>({name:"kibana_table",type:"render",inputTypes:["datatable"],help:external_kbnSharedDeps_KbnI18n_.i18n.translate("visTypeTable.function.help",{defaultMessage:"Table visualization"}),args:{visConfig:{types:["string","null"],default:'"{}"',help:""}},fn(input,args){const visConfig=args.visConfig&&JSON.parse(args.visConfig);return{type:"render",as:"table_vis",value:{visData:function(table,dimensions){const converted={tables:[]},split=dimensions.splitColumn||dimensions.splitRow;if(split){converted.direction=dimensions.splitRow?"row":"column";const splitColumnIndex=split[0].accessor,splitColumnFormatter=Object(services.a)().deserialize(split[0].format),splitColumn=table.columns[splitColumnIndex],splitMap={};let splitIndex=0;table.rows.forEach((row,rowIndex)=>{const splitValue=row[splitColumn.id];if(!splitMap.hasOwnProperty(splitValue)){splitMap[splitValue]=splitIndex++;const tableGroup={$parent:converted,title:`${splitColumnFormatter.convert(splitValue)}: ${splitColumn.name}`,name:splitColumn.name,key:splitValue,column:splitColumnIndex,row:rowIndex,table:table,tables:[]};tableGroup.tables.push({$parent:tableGroup,columns:table.columns,rows:[]}),converted.tables.push(tableGroup)}const tableIndex=splitMap[splitValue];converted.tables[tableIndex].tables[0].rows.push(row)})}else converted.tables.push({columns:table.columns,rows:table.rows});return converted}(input,visConfig.dimensions),visType:common.b,visConfig:visConfig}}}}),tableVisRegistry=new Map;var public_=__webpack_require__(10),table_vis_options_lazy=__webpack_require__(25),visualizations_public_=__webpack_require__(9),expressions_public_=__webpack_require__(12);const buildTableVisConfig=(schemas,visParams)=>{const metrics=schemas.metric,buckets=schemas.bucket||[],visConfig={dimensions:{metrics:metrics,buckets:buckets,splitRow:schemas.split_row,splitColumn:schemas.split_column}};if(visParams.showPartialRows&&!visParams.showMetricsAtAllLevels){const metricsPerBucket=metrics.length/buckets.length;visConfig.dimensions.metrics.splice(0,metricsPerBucket*buckets.length-metricsPerBucket)}return visConfig},tableVisLegacyTypeDefinition={name:common.b,title:external_kbnSharedDeps_KbnI18n_.i18n.translate("visTypeTable.tableVisTitle",{defaultMessage:"Data table"}),icon:"visTable",description:external_kbnSharedDeps_KbnI18n_.i18n.translate("visTypeTable.tableVisDescription",{defaultMessage:"Display data in rows and columns."}),getSupportedTriggers:()=>[visualizations_public_.VIS_EVENT_TO_TRIGGER.filter],visConfig:{defaults:{perPage:10,showPartialRows:!1,showMetricsAtAllLevels:!1,sort:{columnIndex:null,direction:null},showTotal:!1,totalFunc:"sum",percentageCol:""}},editorConfig:{optionsTemplate:table_vis_options_lazy.a,schemas:[{group:public_.AggGroupNames.Metrics,name:"metric",title:external_kbnSharedDeps_KbnI18n_.i18n.translate("visTypeTable.tableVisEditorConfig.schemas.metricTitle",{defaultMessage:"Metric"}),aggFilter:["!geo_centroid","!geo_bounds","!filtered_metric","!single_percentile"],aggSettings:{top_hits:{allowStrings:!0}},min:1,defaults:[{type:"count",schema:"metric"}]},{group:public_.AggGroupNames.Buckets,name:"bucket",title:external_kbnSharedDeps_KbnI18n_.i18n.translate("visTypeTable.tableVisEditorConfig.schemas.bucketTitle",{defaultMessage:"Split rows"}),aggFilter:["!filter"]},{group:public_.AggGroupNames.Buckets,name:"split",title:external_kbnSharedDeps_KbnI18n_.i18n.translate("visTypeTable.tableVisEditorConfig.schemas.splitTitle",{defaultMessage:"Split table"}),min:0,max:1,aggFilter:["!filter"]}]},toExpressionAst:(vis,params)=>{const esaggs=Object(expressions_public_.buildExpressionFunction)("esaggs",{index:Object(expressions_public_.buildExpression)([Object(expressions_public_.buildExpressionFunction)("indexPatternLoad",{id:vis.data.indexPattern.id})]),metricsAtAllLevels:vis.isHierarchical(),partialRows:vis.params.showPartialRows,aggs:vis.data.aggs.aggs.map(agg=>Object(expressions_public_.buildExpression)(agg.toExpressionAst()))}),schemas=Object(visualizations_public_.getVisSchemas)(vis,params),visConfig={...vis.params,...buildTableVisConfig(schemas,vis.params),title:vis.title},table=Object(expressions_public_.buildExpressionFunction)("kibana_table",{visConfig:JSON.stringify(visConfig)});return Object(expressions_public_.buildExpression)([esaggs,table]).toAst()},hierarchicalData:vis=>vis.params.showPartialRows||vis.params.showMetricsAtAllLevels,requiresSearch:!0},registerLegacyVis=(core,{expressions:expressions,visualizations:visualizations,usageCollection:usageCollection},context)=>{null==usageCollection||usageCollection.reportUiCounter("vis_type_table",external_kbnSharedDeps_KbnAnalytics_.METRIC_TYPE.LOADED,"legacyVisEnabled"),expressions.registerFunction(createTableVisLegacyFn),expressions.registerRenderer(((core,context)=>({name:"table_vis",reuseDomNode:!0,render:async(domNode,config,handlers)=>{let registeredController=tableVisRegistry.get(domNode);if(!registeredController){const{getTableVisualizationControllerClass:getTableVisualizationControllerClass}=await __webpack_require__.e(1).then(__webpack_require__.bind(null,53)),Controller=getTableVisualizationControllerClass(core,context);registeredController=new Controller(domNode),tableVisRegistry.set(domNode,registeredController),handlers.onDestroy(()=>{var _registeredController;null===(_registeredController=registeredController)||void 0===_registeredController||_registeredController.destroy(),tableVisRegistry.delete(domNode)})}await registeredController.render(config.visData,config.visConfig,handlers),handlers.done()}}))(core,context)),visualizations.createBaseVisualization(tableVisLegacyTypeDefinition)}}}]);