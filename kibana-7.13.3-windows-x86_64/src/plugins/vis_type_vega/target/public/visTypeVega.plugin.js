!function(modules){function webpackJsonpCallback(data){for(var moduleId,chunkId,chunkIds=data[0],moreModules=data[1],i=0,resolves=[];i<chunkIds.length;i++)chunkId=chunkIds[i],Object.prototype.hasOwnProperty.call(installedChunks,chunkId)&&installedChunks[chunkId]&&resolves.push(installedChunks[chunkId][0]),installedChunks[chunkId]=0;for(moduleId in moreModules)Object.prototype.hasOwnProperty.call(moreModules,moduleId)&&(modules[moduleId]=moreModules[moduleId]);for(parentJsonpFunction&&parentJsonpFunction(data);resolves.length;)resolves.shift()()}var installedModules={},installedChunks={1:0};function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}__webpack_require__.e=function(chunkId){var promises=[],installedChunkData=installedChunks[chunkId];if(0!==installedChunkData)if(installedChunkData)promises.push(installedChunkData[2]);else{var promise=new Promise((function(resolve,reject){installedChunkData=installedChunks[chunkId]=[resolve,reject]}));promises.push(installedChunkData[2]=promise);var onScriptComplete,script=document.createElement("script");script.charset="utf-8",script.timeout=120,__webpack_require__.nc&&script.setAttribute("nonce",__webpack_require__.nc),script.src=function(chunkId){return __webpack_require__.p+"visTypeVega.chunk."+chunkId+".js"}(chunkId);var error=new Error;onScriptComplete=function(event){script.onerror=script.onload=null,clearTimeout(timeout);var chunk=installedChunks[chunkId];if(0!==chunk){if(chunk){var errorType=event&&("load"===event.type?"missing":event.type),realSrc=event&&event.target&&event.target.src;error.message="Loading chunk "+chunkId+" failed.\n("+errorType+": "+realSrc+")",error.name="ChunkLoadError",error.type=errorType,error.request=realSrc,chunk[1](error)}installedChunks[chunkId]=void 0}};var timeout=setTimeout((function(){onScriptComplete({type:"timeout",target:script})}),12e4);script.onerror=script.onload=onScriptComplete,document.head.appendChild(script)}return Promise.all(promises)},__webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{enumerable:!0,get:getter})},__webpack_require__.r=function(exports){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(exports,"__esModule",{value:!0})},__webpack_require__.t=function(value,mode){if(1&mode&&(value=__webpack_require__(value)),8&mode)return value;if(4&mode&&"object"==typeof value&&value&&value.__esModule)return value;var ns=Object.create(null);if(__webpack_require__.r(ns),Object.defineProperty(ns,"default",{enumerable:!0,value:value}),2&mode&&"string"!=typeof value)for(var key in value)__webpack_require__.d(ns,key,function(key){return value[key]}.bind(null,key));return ns},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function(){return module.default}:function(){return module};return __webpack_require__.d(getter,"a",getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p="",__webpack_require__.oe=function(err){throw console.error(err),err};var jsonpArray=window.visTypeVega_bundle_jsonpfunction=window.visTypeVega_bundle_jsonpfunction||[],oldJsonpFunction=jsonpArray.push.bind(jsonpArray);jsonpArray.push=webpackJsonpCallback,jsonpArray=jsonpArray.slice();for(var i=0;i<jsonpArray.length;i++)webpackJsonpCallback(jsonpArray[i]);var parentJsonpFunction=oldJsonpFunction;__webpack_require__(__webpack_require__.s=23)}([function(module,exports){module.exports=__kbnSharedDeps__.React},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return getData})),__webpack_require__.d(__webpack_exports__,"h",(function(){return setData})),__webpack_require__.d(__webpack_exports__,"f",(function(){return getNotifications})),__webpack_require__.d(__webpack_exports__,"m",(function(){return setNotifications})),__webpack_require__.d(__webpack_exports__,"g",(function(){return getUISettings})),__webpack_require__.d(__webpack_exports__,"n",(function(){return setUISettings})),__webpack_require__.d(__webpack_exports__,"d",(function(){return getInjectedMetadata})),__webpack_require__.d(__webpack_exports__,"j",(function(){return setInjectedMetadata})),__webpack_require__.d(__webpack_exports__,"e",(function(){return getMapServiceSettings})),__webpack_require__.d(__webpack_exports__,"l",(function(){return setMapServiceSettings})),__webpack_require__.d(__webpack_exports__,"k",(function(){return setInjectedVars})),__webpack_require__.d(__webpack_exports__,"c",(function(){return getEnableExternalUrls})),__webpack_require__.d(__webpack_exports__,"b",(function(){return getDocLinks})),__webpack_require__.d(__webpack_exports__,"i",(function(){return setDocLinks}));var _kibana_utils_public__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(5);const[getData,setData]=Object(_kibana_utils_public__WEBPACK_IMPORTED_MODULE_0__.createGetterSetter)("Data"),[getNotifications,setNotifications]=Object(_kibana_utils_public__WEBPACK_IMPORTED_MODULE_0__.createGetterSetter)("Notifications"),[getUISettings,setUISettings]=Object(_kibana_utils_public__WEBPACK_IMPORTED_MODULE_0__.createGetterSetter)("UISettings"),[getInjectedMetadata,setInjectedMetadata]=Object(_kibana_utils_public__WEBPACK_IMPORTED_MODULE_0__.createGetterSetter)("InjectedMetadata"),[getMapServiceSettings,setMapServiceSettings]=Object(_kibana_utils_public__WEBPACK_IMPORTED_MODULE_0__.createGetterSetter)("MapServiceSettings"),[getInjectedVars,setInjectedVars]=Object(_kibana_utils_public__WEBPACK_IMPORTED_MODULE_0__.createGetterSetter)("InjectedVars"),getEnableExternalUrls=()=>getInjectedVars().enableExternalUrls,[getDocLinks,setDocLinks]=Object(_kibana_utils_public__WEBPACK_IMPORTED_MODULE_0__.createGetterSetter)("docLinks")},function(module,exports){module.exports=__kbnSharedDeps__.RxjsOperators},function(module,exports){module.exports=__kbnSharedDeps__.KbnI18n},function(module,exports){module.exports=__kbnSharedDeps__.Rxjs},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/kibanaUtils/public");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/data/public");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,exports){module.exports=__kbnSharedDeps__.Lodash},function(module,exports){module.exports=__kbnSharedDeps__.ElasticEui},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/visualizations/public");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,exports,__webpack_require__){"use strict";
/*!
 * Hjson v3.2.1
 * http://hjson.org
 *
 * Copyright 2014-2017 Christian Zangl, MIT license
 * Details and documentation:
 * https://github.com/hjson/hjson-js
 *
 * This code is based on the the JSON version by Douglas Crockford:
 * https://github.com/douglascrockford/JSON-js (json_parse.js, json2.js)
 */var common=__webpack_require__(11),version=__webpack_require__(26),parse=__webpack_require__(27),stringify=__webpack_require__(28),comments=__webpack_require__(29),dsf=__webpack_require__(12);module.exports={parse:parse,stringify:stringify,endOfLine:function(){return common.EOL},setEndOfLine:function(eol){"\n"!==eol&&"\r\n"!==eol||(common.EOL=eol)},version:version,rt:{parse:function(text,options){return(options=options||{}).keepWsc=!0,parse(text,options)},stringify:function(value,options){return(options=options||{}).keepWsc=!0,stringify(value,options)}},comments:comments,dsf:dsf.std}},function(module,exports,__webpack_require__){"use strict";var os=__webpack_require__(25);module.exports={EOL:os.EOL||"\n",tryParseNumber:function(text,stopAtNext){var number,ch,string="",leadingZeros=0,testLeading=!0,at=0;function next(){return ch=text.charAt(at),at++,ch}for(next(),"-"===ch&&(string="-",next());ch>="0"&&ch<="9";)testLeading&&("0"==ch?leadingZeros++:testLeading=!1),string+=ch,next();if(testLeading&&leadingZeros--,"."===ch)for(string+=".";next()&&ch>="0"&&ch<="9";)string+=ch;if("e"===ch||"E"===ch)for(string+=ch,next(),"-"!==ch&&"+"!==ch||(string+=ch,next());ch>="0"&&ch<="9";)string+=ch,next();for(;ch&&ch<=" ";)next();return stopAtNext&&(","!==ch&&"}"!==ch&&"]"!==ch&&"#"!==ch&&("/"!==ch||"/"!==text[at]&&"*"!==text[at])||(ch=0)),number=+string,ch||leadingZeros||!isFinite(number)?void 0:number},createComment:function(value,comment){return Object.defineProperty&&Object.defineProperty(value,"__COMMENTS__",{enumerable:!1,writable:!0}),value.__COMMENTS__=comment||{}},removeComment:function(value){Object.defineProperty(value,"__COMMENTS__",{value:void 0})},getComment:function(value){return value.__COMMENTS__},forceComment:function(text){if(!text)return"";var str,i,j,len,a=text.split("\n");for(j=0;j<a.length;j++)for(len=(str=a[j]).length,i=0;i<len;i++){var c=str[i];if("#"===c)break;if("/"===c&&("/"===str[i+1]||"*"===str[i+1])){"*"===str[i+1]&&(j=a.length);break}if(c>" "){a[j]="# "+str;break}}return a.join("\n")}}},function(module,exports,__webpack_require__){"use strict";function runDsf(dsf,value){if(dsf)for(var i=0;i<dsf.length;i++){var res=dsf[i](value);if(void 0!==res)return res}}function nopDsf(){}function isInvalidDsfChar(c){return"{"===c||"}"===c||"["===c||"]"===c||","===c}function math(){return{name:"math",parse:function(value){switch(value){case"+inf":case"inf":case"+Inf":case"Inf":return 1/0;case"-inf":case"-Inf":return-1/0;case"nan":case"NaN":return NaN}},stringify:function(value){if("number"==typeof value)return 1/value==-1/0?"-0":value===1/0?"Inf":value===-1/0?"-Inf":isNaN(value)?"NaN":void 0}}}function hex(opt){var out=opt&&opt.out;return{name:"hex",parse:function(value){if(/^0x[0-9A-Fa-f]+$/.test(value))return parseInt(value,16)},stringify:function(value){if(out&&Number.isInteger(value))return"0x"+value.toString(16)}}}function date(){return{name:"date",parse:function(value){if(/^\d{4}-\d{2}-\d{2}$/.test(value)||/^\d{4}-\d{2}-\d{2}T\d{2}\:\d{2}\:\d{2}(?:.\d+)(?:Z|[+-]\d{2}:\d{2})$/.test(value)){var dt=Date.parse(value);if(!isNaN(dt))return new Date(dt)}},stringify:function(value){if("[object Date]"===Object.prototype.toString.call(value)){var dt=value.toISOString();return-1!==dt.indexOf("T00:00:00.000Z",dt.length-14)?dt.substr(0,10):dt}}}}math.description="support for Inf/inf, -Inf/-inf, Nan/naN and -0",hex.description="parse hexadecimal numbers prefixed with 0x",date.description="support ISO dates",module.exports={loadDsf:function(col,type){if("[object Array]"!==Object.prototype.toString.apply(col)){if(col)throw new Error("dsf option must contain an array!");return nopDsf}if(0===col.length)return nopDsf;var dsf=[];function isFunction(f){return"[object Function]"==={}.toString.call(f)}return col.forEach((function(x){if(!x.name||!isFunction(x.parse)||!isFunction(x.stringify))throw new Error("extension does not match the DSF interface");dsf.push((function(){try{if("parse"==type)return x.parse.apply(null,arguments);if("stringify"==type){var res=x.stringify.apply(null,arguments);if(void 0!==res&&("string"!=typeof res||0===res.length||'"'===res[0]||[].some.call(res,(function(c){return isInvalidDsfChar(c)}))))throw new Error("value may not be empty, start with a quote or contain a punctuator character except colon: "+res);return res}throw new Error("Invalid type")}catch(e){throw new Error("DSF-"+x.name+" failed; "+e.message)}}))})),runDsf.bind(null,dsf)},std:{math:math,hex:hex,date:date}}},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/expressions/public");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,exports){module.exports=__kbnSharedDeps__.ReactDom},function(module,exports){module.exports=__kbnSharedDeps__.KbnI18nReact},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"e",(function(){return vegaLayerId})),__webpack_require__.d(__webpack_exports__,"d",(function(){return userConfiguredLayerId})),__webpack_require__.d(__webpack_exports__,"b",(function(){return defaultMapConfig})),__webpack_require__.d(__webpack_exports__,"a",(function(){return defaultMabBoxStyle})),__webpack_require__.d(__webpack_exports__,"c",(function(){return defaultProjection}));var _maps_ems_public__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(22);const vegaLayerId="vega",userConfiguredLayerId=_maps_ems_public__WEBPACK_IMPORTED_MODULE_0__.TMS_IN_YML_ID,defaultMapConfig={maxZoom:20,minZoom:0,tileSize:256},defaultMabBoxStyle={version:8,sources:{},layers:[]},defaultProjection={name:"projection",type:"mercator",scale:{signal:"512*pow(2,zoom)/2/PI"},rotate:[{signal:"-longitude"},0,0],center:[0,{signal:"latitude"}],translate:[{signal:"width/2"},{signal:"height/2"}],fit:!1}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return extractIndexPatternsFromSpec}));var lodash__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(7),_services__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1);const extractIndexPatternsFromSpec=async spec=>{const{indexPatterns:indexPatterns}=Object(_services__WEBPACK_IMPORTED_MODULE_1__.a)();let data=[];return Array.isArray(spec.data)?data=spec.data:spec.data&&(data=[spec.data]),Object(lodash__WEBPACK_IMPORTED_MODULE_0__.flatten)(await Promise.all(data.reduce((accumulator,currentValue)=>{var _currentValue$url;return null!==(_currentValue$url=currentValue.url)&&void 0!==_currentValue$url&&_currentValue$url.index&&accumulator.push(indexPatterns.find(currentValue.url.index)),accumulator},[])))}},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/kibanaReact/public");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return MapServiceSettings})),__webpack_require__.d(__webpack_exports__,"b",(function(){return getAttributionsForTmsService}));var _kbn_i18n__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(3),_services__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1),_constants__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(16);function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class MapServiceSettings{constructor(config,appVersion){this.config=config,this.appVersion=appVersion,_defineProperty(this,"emsClient",void 0),_defineProperty(this,"isDarkMode",!1)}isInitialized(){return Boolean(this.emsClient)}hasUserConfiguredTmsLayer(){return config=this.config,Boolean(null===(_config$tilemap=config.tilemap)||void 0===_config$tilemap?void 0:_config$tilemap.url);var config,_config$tilemap}defaultTmsLayer(){const{dark:dark,desaturated:desaturated}=this.config.emsTileLayerId;return this.hasUserConfiguredTmsLayer()?_constants__WEBPACK_IMPORTED_MODULE_2__.d:this.isDarkMode?dark:desaturated}async initialize(){this.isDarkMode=Object(_services__WEBPACK_IMPORTED_MODULE_1__.g)().get("theme:darkMode"),this.emsClient=await(async config=>new((await __webpack_require__.e(2).then(__webpack_require__.bind(null,36))).EMSClient)({language:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.getLocale(),appName:"kibana",fetchFunction:(input,init)=>fetch(input,init),...config}))({appVersion:this.appVersion,fileApiUrl:this.config.emsFileApiUrl,tileApiUrl:this.config.emsTileApiUrl,landingPageUrl:this.config.emsLandingPageUrl})}async getTmsService(tmsTileLayer){var _this$emsClient;return this.isInitialized()||await this.initialize(),null===(_this$emsClient=this.emsClient)||void 0===_this$emsClient?void 0:_this$emsClient.findTMSServiceById(tmsTileLayer)}}function getAttributionsForTmsService(tmsService){return tmsService.getAttributions().map(({label:label,url:url})=>{const anchorTag=document.createElement("a");return anchorTag.textContent=label,anchorTag.setAttribute("rel","noreferrer noopener"),anchorTag.setAttribute("href",url),anchorTag.outerHTML})}},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/visDefaultEditor/public");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/inspector/public");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/mapsEms/public");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__(24);__kbnBundles__.define("plugin/visTypeVega/public",__webpack_require__,30)},function(module,exports,__webpack_require__){__webpack_require__.p=window.__kbnPublicPath__.visTypeVega},function(module,exports){exports.endianness=function(){return"LE"},exports.hostname=function(){return"undefined"!=typeof location?location.hostname:""},exports.loadavg=function(){return[]},exports.uptime=function(){return 0},exports.freemem=function(){return Number.MAX_VALUE},exports.totalmem=function(){return Number.MAX_VALUE},exports.cpus=function(){return[]},exports.type=function(){return"Browser"},exports.release=function(){return"undefined"!=typeof navigator?navigator.appVersion:""},exports.networkInterfaces=exports.getNetworkInterfaces=function(){return{}},exports.arch=function(){return"javascript"},exports.platform=function(){return"browser"},exports.tmpdir=exports.tmpDir=function(){return"/tmp"},exports.EOL="\n",exports.homedir=function(){return"/"}},function(module,exports){module.exports="3.2.1"},function(module,exports,__webpack_require__){"use strict";module.exports=function(source,opt){var text,at,ch,keepComments,runDsf,common=__webpack_require__(11),dsf=__webpack_require__(12),escapee={'"':'"',"'":"'","\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"};function resetAt(){at=0,ch=" "}function isPunctuatorChar(c){return"{"===c||"}"===c||"["===c||"]"===c||","===c||":"===c}function error(m){var i,col=0,line=1;for(i=at-1;i>0&&"\n"!==text[i];i--,col++);for(;i>0;i--)"\n"===text[i]&&line++;throw new Error(m+" at line "+line+","+col+" >>>"+text.substr(at-col,20)+" ...")}function next(){return ch=text.charAt(at),at++,ch}function peek(offs){return text.charAt(at+offs)}function string(allowML){for(var string="",exitCh=ch;next();){if(ch===exitCh)return next(),allowML&&"'"===exitCh&&"'"===ch&&0===string.length?(next(),mlString()):string;if("\\"===ch)if(next(),"u"===ch){for(var uffff=0,i=0;i<4;i++){next();var hex,c=ch.charCodeAt(0);ch>="0"&&ch<="9"?hex=c-48:ch>="a"&&ch<="f"?hex=c-97+10:ch>="A"&&ch<="F"?hex=c-65+10:error("Bad \\u char "+ch),uffff=16*uffff+hex}string+=String.fromCharCode(uffff)}else{if("string"!=typeof escapee[ch])break;string+=escapee[ch]}else"\n"===ch||"\r"===ch?error("Bad string containing newline"):string+=ch}error("Bad string")}function mlString(){for(var string="",triple=0,indent=0;;){var c=peek(-indent-5);if(!c||"\n"===c)break;indent++}function skipIndent(){for(var skip=indent;ch&&ch<=" "&&"\n"!==ch&&skip-- >0;)next()}for(;ch&&ch<=" "&&"\n"!==ch;)next();for("\n"===ch&&(next(),skipIndent());;){if(ch){if("'"===ch){if(triple++,next(),3===triple)return"\n"===string.slice(-1)&&(string=string.slice(0,-1)),string;continue}for(;triple>0;)string+="'",triple--}else error("Bad multiline string");"\n"===ch?(string+="\n",next(),skipIndent()):("\r"!==ch&&(string+=ch),next())}}function keyname(){if('"'===ch||"'"===ch)return string(!1);for(var name="",start=at,space=-1;;){if(":"===ch)return name?space>=0&&space!==name.length&&(at=start+space,error("Found whitespace in your key name (use quotes to include)")):error("Found ':' but no key name (for an empty key name use quotes)"),name;ch<=" "?ch?space<0&&(space=name.length):error("Found EOF while looking for a key name (check your syntax)"):isPunctuatorChar(ch)?error("Found '"+ch+"' where a key name was expected (check your syntax or use quotes if the key name includes {}[],: or whitespace)"):name+=ch,next()}}function white(){for(;ch;){for(;ch&&ch<=" ";)next();if("#"===ch||"/"===ch&&"/"===peek(0))for(;ch&&"\n"!==ch;)next();else{if("/"!==ch||"*"!==peek(0))break;for(next(),next();ch&&("*"!==ch||"/"!==peek(0));)next();ch&&(next(),next())}}}function getComment(cAt,first){var i;for(cAt--,i=at-2;i>cAt&&text[i]<=" "&&"\n"!==text[i];i--);"\n"===text[i]&&i--,"\r"===text[i]&&i--;var res=text.substr(cAt,i-cAt+1);for(i=0;i<res.length;i++)if(res[i]>" "){var j=res.indexOf("\n");if(j>=0){var c=[res.substr(0,j),res.substr(j+1)];return first&&0===c[0].trim().length&&c.shift(),c}return[res]}return[]}function errorClosingHint(value){function report(ch){var possibleErr=function search(value,ch){var i,k,length,res;switch(typeof value){case"string":value.indexOf(ch)>=0&&(res=value);break;case"object":if("[object Array]"===Object.prototype.toString.apply(value))for(i=0,length=value.length;i<length;i++)res=search(value[i],ch)||res;else for(k in value)Object.prototype.hasOwnProperty.call(value,k)&&(res=search(value[k],ch)||res)}return res}(value,ch);return possibleErr?"found '"+ch+"' in a string value, your mistake could be with:\n  > "+possibleErr+"\n  (unquoted strings contain everything up to the next line!)":""}return report("}")||report("]")}function array(){var comments,cAt,nextComment,array=[];try{if(keepComments&&(comments=common.createComment(array,{a:[]})),next(),cAt=at,white(),comments&&(nextComment=getComment(cAt,!0).join("\n")),"]"===ch)return next(),comments&&(comments.e=[nextComment]),array;for(;ch;){if(array.push(value()),cAt=at,white(),","===ch&&(next(),cAt=at,white()),comments){var c=getComment(cAt);comments.a.push([nextComment||"",c[0]||""]),nextComment=c[1]}if("]"===ch)return next(),comments&&(comments.a[comments.a.length-1][1]+=nextComment||""),array;white()}error("End of input while parsing an array (missing ']')")}catch(e){throw e.hint=e.hint||errorClosingHint(array),e}}function object(withoutBraces){var comments,cAt,nextComment,key="",object={};try{if(keepComments&&(comments=common.createComment(object,{c:{},o:[]})),withoutBraces?cAt=1:(next(),cAt=at),white(),comments&&(nextComment=getComment(cAt,!0).join("\n")),"}"===ch&&!withoutBraces)return comments&&(comments.e=[nextComment]),next(),object;for(;ch;){if(key=keyname(),white(),":"!==ch&&error("Expected ':' instead of '"+ch+"'"),next(),object[key]=value(),cAt=at,white(),","===ch&&(next(),cAt=at,white()),comments){var c=getComment(cAt);comments.c[key]=[nextComment||"",c[0]||""],nextComment=c[1],comments.o.push(key)}if("}"===ch&&!withoutBraces)return next(),comments&&(comments.c[key][1]+=nextComment||""),object;white()}if(withoutBraces)return object;error("End of input while parsing an object (missing '}')")}catch(e){throw e.hint=e.hint||errorClosingHint(object),e}}function value(){switch(white(),ch){case"{":return object();case"[":return array();case"'":case'"':return string(!0);default:return function(){var value=ch;for(isPunctuatorChar(ch)&&error("Found a punctuator character '"+ch+"' when expecting a quoteless string (check your syntax)");;){next();var isEol="\r"===ch||"\n"===ch||""===ch;if(isEol||","===ch||"}"===ch||"]"===ch||"#"===ch||"/"===ch&&("/"===peek(0)||"*"===peek(0))){var chf=value[0];switch(chf){case"f":if("false"===value.trim())return!1;break;case"n":if("null"===value.trim())return null;break;case"t":if("true"===value.trim())return!0;break;default:if("-"===chf||chf>="0"&&chf<="9"){var n=common.tryParseNumber(value);if(void 0!==n)return n}}if(isEol){value=value.trim();var dsfValue=runDsf(value);return void 0!==dsfValue?dsfValue:value}}value+=ch}}()}}function checkTrailing(v,c){var cAt=at;if(white(),ch&&error("Syntax error, found trailing characters"),keepComments){var b=c.join("\n"),a=getComment(cAt).join("\n");if(a||b)common.createComment(v,common.getComment(v)).r=[b,a]}return v}if("string"!=typeof source)throw new Error("source is not a string");var dsfDef=null,legacyRoot=!0;return opt&&"object"==typeof opt&&(keepComments=opt.keepWsc,dsfDef=opt.dsf,legacyRoot=!1!==opt.legacyRoot),runDsf=dsf.loadDsf(dsfDef,"parse"),text=source,resetAt(),legacyRoot?function(){white();var c=keepComments?getComment(1):null;switch(ch){case"{":return checkTrailing(object(),c);case"[":return checkTrailing(array(),c)}try{return checkTrailing(object(!0),c)}catch(e){resetAt();try{return checkTrailing(value(),c)}catch(e2){throw e}}}():function(){white();var c=keepComments?getComment(1):null;switch(ch){case"{":return checkTrailing(object(),c);case"[":return checkTrailing(array(),c);default:return checkTrailing(value(),c)}}()}},function(module,exports,__webpack_require__){"use strict";module.exports=function(data,opt){var runDsf,common=__webpack_require__(11),dsf=__webpack_require__(12),plainToken={obj:["{","}"],arr:["[","]"],key:["",""],qkey:['"','"'],col:[":",""],com:[",",""],str:["",""],qstr:['"','"'],mstr:["'''","'''"],num:["",""],lit:["",""],dsf:["",""],esc:["\\",""],uni:["\\u",""],rem:["",""]},eol=common.EOL,indent="  ",keepComments=!1,bracesSameLine=!1,quoteKeys=!1,quoteStrings=!1,condense=0,multiline=1,separator="",dsfDef=null,sortProps=!1,token=plainToken;if(opt&&"object"==typeof opt){opt.quotes="always"===opt.quotes?"strings":opt.quotes,"\n"!==opt.eol&&"\r\n"!==opt.eol||(eol=opt.eol),keepComments=opt.keepWsc,condense=opt.condense||0,bracesSameLine=opt.bracesSameLine,quoteKeys="all"===opt.quotes||"keys"===opt.quotes,quoteStrings="all"===opt.quotes||"strings"===opt.quotes||!0===opt.separator,multiline=quoteStrings||"off"==opt.multiline?0:"no-tabs"==opt.multiline?2:1,separator=!0===opt.separator?token.com[0]:"",dsfDef=opt.dsf,sortProps=opt.sortProps,"number"==typeof opt.space?indent=new Array(opt.space+1).join(" "):"string"==typeof opt.space&&(indent=opt.space),!0===opt.colors&&(token={obj:["[37m{[0m","[37m}[0m"],arr:["[37m[[0m","[37m][0m"],key:["[33m","[0m"],qkey:['[33m"','"[0m'],col:["[37m:[0m",""],com:["[37m,[0m",""],str:["[37;1m","[0m"],qstr:['[37;1m"','"[0m'],mstr:["[37;1m'''","'''[0m"],num:["[36;1m","[0m"],lit:["[36m","[0m"],dsf:["[37m","[0m"],esc:["[31m\\","[0m"],uni:["[31m\\u","[0m"],rem:["[35m","[0m"]});var i,ckeys=Object.keys(plainToken);for(i=ckeys.length-1;i>=0;i--){var k=ckeys[i];token[k].push(plainToken[k][0].length,plainToken[k][1].length)}}var commonRange="-­؀-؄܏឴឵‌-‏\u2028- ⁠-⁯\ufeff￰-￿",needsEscape=new RegExp('[\\\\\\"\0-'+commonRange+"]","g"),needsQuotes=new RegExp("^\\s|^\"|^'|^#|^\\/\\*|^\\/\\/|^\\{|^\\}|^\\[|^\\]|^:|^,|\\s$|[\0-"+commonRange+"]","g"),needsEscapeML=new RegExp("'''|^[\\s]+$|[\0-"+(2===multiline?"\t":"\b")+"\v\f-"+commonRange+"]","g"),startsWithKeyword=new RegExp("^(true|false|null)\\s*((,|\\]|\\}|#|//|/\\*).*)?$"),meta={"\b":"b","\t":"t","\n":"n","\f":"f","\r":"r",'"':'"',"\\":"\\"},needsEscapeName=/[,\{\[\}\]\s:#"']|\/\/|\/\*/,gap="",wrapLen=0;function wrap(tk,v){return wrapLen+=tk[0].length+tk[1].length-tk[2]-tk[3],tk[0]+v+tk[1]}function quoteReplace(string){return string.replace(needsEscape,(function(a){var c=meta[a];return"string"==typeof c?wrap(token.esc,c):wrap(token.uni,("0000"+a.charCodeAt(0).toString(16)).slice(-4))}))}function quote(string,gap,hasComment,isRootObject){return string?(needsQuotes.lastIndex=0,startsWithKeyword.lastIndex=0,quoteStrings||hasComment||needsQuotes.test(string)||void 0!==common.tryParseNumber(string,!0)||startsWithKeyword.test(string)?(needsEscape.lastIndex=0,needsEscapeML.lastIndex=0,needsEscape.test(string)?needsEscapeML.test(string)||isRootObject||!multiline?wrap(token.qstr,quoteReplace(string)):function(string,gap){var i,a=string.replace(/\r/g,"").split("\n");if(gap+=indent,1===a.length)return wrap(token.mstr,a[0]);var res=eol+gap+token.mstr[0];for(i=0;i<a.length;i++)res+=eol,a[i]&&(res+=gap+a[i]);return res+eol+gap+token.mstr[1]}(string,gap):wrap(token.qstr,string)):wrap(token.str,string)):wrap(token.qstr,"")}function quoteKey(name){return name?quoteKeys||needsEscapeName.test(name)?(needsEscape.lastIndex=0,wrap(token.qkey,needsEscape.test(name)?quoteReplace(name):name)):wrap(token.key,name):'""'}runDsf=dsf.loadDsf(dsfDef,"stringify");var res="",comments=keepComments?comments=(common.getComment(data)||{}).r:null;return comments&&comments[0]&&(res=comments[0]+"\n"),res+=function str(value,hasComment,noIndent,isRootObject){function startsWithNL(str){return str&&"\n"===str["\r"===str[0]?1:0]}function commentOnThisLine(str){return str&&!startsWithNL(str)}function makeComment(str,prefix,trim){if(!str)return"";var i,len=(str=common.forceComment(str)).length;for(i=0;i<len&&str[i]<=" ";i++);return trim&&i>0&&(str=str.substr(i)),i<len?prefix+wrap(token.rem,str):str}var dsfValue=runDsf(value);if(void 0!==dsfValue)return wrap(token.dsf,dsfValue);switch(typeof value){case"string":return quote(value,gap,hasComment,isRootObject);case"number":return isFinite(value)?wrap(token.num,String(value)):wrap(token.lit,"null");case"boolean":return wrap(token.lit,String(value));case"object":if(!value)return wrap(token.lit,"null");var comments;keepComments&&(comments=common.getComment(value));var setsep,i,length,k,v,vs,c,ca,res,cres,isArray="[object Array]"===Object.prototype.toString.apply(value),mind=gap,eolMind=eol+mind,eolGap=eol+(gap+=indent),prefix=noIndent||bracesSameLine?"":eolMind,partial=[],cpartial=condense?[]:null,saveQuoteStrings=quoteStrings,saveMultiline=multiline,iseparator=separator?"":token.com[0],cwrapLen=0;if(isArray){for(i=0,length=value.length;i<length;i++){if(setsep=i<length-1,comments?(ca=commentOnThisLine((c=comments.a[i]||[])[1]),partial.push(makeComment(c[0],"\n")+eolGap),cpartial&&(c[0]||c[1]||ca)&&(cpartial=null)):partial.push(eolGap),wrapLen=0,v=value[i],partial.push(str(v,!!comments&&ca,!0)+(setsep?separator:"")),cpartial){switch(typeof v){case"string":wrapLen=0,quoteStrings=!0,multiline=0,cpartial.push(str(v,!1,!0)+(setsep?token.com[0]:"")),quoteStrings=saveQuoteStrings,multiline=saveMultiline;break;case"object":if(v){cpartial=null;break}default:cpartial.push(partial[partial.length-1]+(setsep?iseparator:""))}setsep&&(wrapLen+=token.com[0].length-token.com[2]),cwrapLen+=wrapLen}comments&&c[1]&&partial.push(makeComment(c[1],ca?" ":"\n",ca))}0===length?comments&&comments.e&&partial.push(makeComment(comments.e[0],"\n")+eolMind):partial.push(eolMind),0===partial.length?res=wrap(token.arr,""):(res=prefix+wrap(token.arr,partial.join("")),cpartial&&(cres=cpartial.join(" ")).length-cwrapLen<=condense&&(res=wrap(token.arr,cres)))}else{var commentKeys=comments?comments.o.slice():[],objectKeys=[];for(k in value)Object.prototype.hasOwnProperty.call(value,k)&&commentKeys.indexOf(k)<0&&objectKeys.push(k);sortProps&&objectKeys.sort();var keys=commentKeys.concat(objectKeys);for(i=0,length=keys.length;i<length;i++)if(setsep=i<length-1,k=keys[i],comments?(ca=commentOnThisLine((c=comments.c[k]||[])[1]),partial.push(makeComment(c[0],"\n")+eolGap),cpartial&&(c[0]||c[1]||ca)&&(cpartial=null)):partial.push(eolGap),wrapLen=0,vs=str(v=value[k],comments&&ca),partial.push(quoteKey(k)+token.col[0]+(startsWithNL(vs)?"":" ")+vs+(setsep?separator:"")),comments&&c[1]&&partial.push(makeComment(c[1],ca?" ":"\n",ca)),cpartial){switch(typeof v){case"string":wrapLen=0,quoteStrings=!0,multiline=0,vs=str(v,!1),quoteStrings=saveQuoteStrings,multiline=saveMultiline,cpartial.push(quoteKey(k)+token.col[0]+" "+vs+(setsep?token.com[0]:""));break;case"object":if(v){cpartial=null;break}default:cpartial.push(partial[partial.length-1]+(setsep?iseparator:""))}wrapLen+=token.col[0].length-token.col[2],setsep&&(wrapLen+=token.com[0].length-token.com[2]),cwrapLen+=wrapLen}0===length?comments&&comments.e&&partial.push(makeComment(comments.e[0],"\n")+eolMind):partial.push(eolMind),0===partial.length?res=wrap(token.obj,""):(res=prefix+wrap(token.obj,partial.join("")),cpartial&&(cres=cpartial.join(" ")).length-cwrapLen<=condense&&(res=wrap(token.obj,cres)))}return gap=mind,res}}(data,null,!0,!0),comments&&(res+=comments[1]||""),res}},function(module,exports,__webpack_require__){"use strict";var common=__webpack_require__(11);function makeComment(b,a,x){var c;return b&&(c={b:b}),a&&((c=c||{}).a=a),x&&((c=c||{}).x=x),c}function saveComment(res,key,item,col){var c=makeComment(item?item[0]:void 0,item?item[1]:void 0,col);return c&&(res[key]=c),c}function droppedComment(path,c){var res=makeComment(c.b,c.a);return res.path=path,res}function dropAll(comments,dropped,path){if(comments){var i,length;if(comments.a)for(i=0,length=comments.a.length;i<length;i++){var kpath=path.slice().concat([i]),c=comments.a[i];c&&(dropped.push(droppedComment(kpath,c)),dropAll(c.x,dropped,kpath))}else comments.o&&comments.o.forEach((function(key){var kpath=path.slice().concat([key]),c=comments.s[key];c&&(dropped.push(droppedComment(kpath,c)),dropAll(c.x,dropped,kpath))}));comments.e&&dropped.push(droppedComment(path,comments.e))}}function rootComment(value,setText,header){var comment=common.createComment(value,common.getComment(value));return comment.r||(comment.r=["",""]),(setText||""===setText)&&(comment.r[header]=common.forceComment(setText)),comment.r[header]||""}module.exports={extract:function(value){return function extractComments(value,root){if(null!==value&&"object"==typeof value){var i,length,any,res,comments=common.getComment(value);if(comments&&common.removeComment(value),"[object Array]"===Object.prototype.toString.apply(value)){for(res={a:{}},i=0,length=value.length;i<length;i++)saveComment(res.a,i,comments.a[i],extractComments(value[i]))&&(any=!0);!any&&comments.e&&(res.e=makeComment(comments.e[0],comments.e[1]),any=!0)}else{res={s:{}};var keys,currentKeys=Object.keys(value);for(comments&&comments.o?(keys=[],comments.o.concat(currentKeys).forEach((function(key){Object.prototype.hasOwnProperty.call(value,key)&&keys.indexOf(key)<0&&keys.push(key)}))):keys=currentKeys,res.o=keys,i=0,length=keys.length;i<length;i++){var key=keys[i];saveComment(res.s,key,comments.c[key],extractComments(value[key]))&&(any=!0)}!any&&comments.e&&(res.e=makeComment(comments.e[0],comments.e[1]),any=!0)}return root&&comments&&comments.r&&(res.r=makeComment(comments.r[0],comments.r[1])),any?res:void 0}}(value,!0)},merge:function(comments,value){var dropped=[];if(function merge(comments,value,dropped,path){if(!comments)return;if(null===value||"object"!=typeof value)return void dropAll(comments,dropped,path);var i,setComments=common.createComment(value);0===path.length&&comments.r&&(setComments.r=[comments.r.b,comments.r.a]);if("[object Array]"===Object.prototype.toString.apply(value)){setComments.a=[];var a=comments.a||{};for(var key in a)if(a.hasOwnProperty(key)){i=parseInt(key);var c=comments.a[key];if(c){var kpath=path.slice().concat([i]);i<value.length?(setComments.a[i]=[c.b,c.a],merge(c.x,value[i],dropped,kpath)):(dropped.push(droppedComment(kpath,c)),dropAll(c.x,dropped,kpath))}}0===i&&comments.e&&(setComments.e=[comments.e.b,comments.e.a])}else setComments.c={},setComments.o=[],(comments.o||[]).forEach((function(key){var kpath=path.slice().concat([key]),c=comments.s[key];Object.prototype.hasOwnProperty.call(value,key)?(setComments.o.push(key),c&&(setComments.c[key]=[c.b,c.a],merge(c.x,value[key],dropped,kpath))):c&&(dropped.push(droppedComment(kpath,c)),dropAll(c.x,dropped,kpath))})),comments.e&&(setComments.e=[comments.e.b,comments.e.a])}(comments,value,dropped,[]),dropped.length>0){var text=rootComment(value,null,1);text+="\n# Orphaned comments:\n",dropped.forEach((function(c){text+=("# "+c.path.join("/")+": "+function(){var res="";return[].forEach.call(arguments,(function(c){c&&""!==c.trim()&&(res&&(res+="; "),res+=c.trim())})),res}(c.b,c.a,c.e)).replace("\n","\\n ")+"\n"})),rootComment(value,text,1)}},header:function(value,setText){return rootComment(value,setText,0)},footer:function(value,setText){return rootComment(value,setText,1)}}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"plugin",(function(){return public_plugin}));var services=__webpack_require__(1),external_kbnSharedDeps_Lodash_=__webpack_require__(7),external_kbnSharedDeps_KbnI18n_=__webpack_require__(3),public_=__webpack_require__(6),external_kbnSharedDeps_Rxjs_=__webpack_require__(4),external_kbnSharedDeps_RxjsOperators_=__webpack_require__(2);class search_api_SearchAPI{constructor(dependencies,abortSignal,inspectorAdapters,searchSessionId){this.dependencies=dependencies,this.abortSignal=abortSignal,this.inspectorAdapters=inspectorAdapters,this.searchSessionId=searchSessionId}search(searchRequests){const{search:search}=this.dependencies,requestResponders={};return Object(external_kbnSharedDeps_Rxjs_.combineLatest)(searchRequests.map(request=>{const requestId=request.name,params=Object(public_.getSearchParamsFromRequest)(request,{getConfig:this.dependencies.uiSettings.get.bind(this.dependencies.uiSettings)});return this.inspectorAdapters&&(requestResponders[requestId]=this.inspectorAdapters.requests.start(requestId,{...request,searchSessionId:this.searchSessionId}),requestResponders[requestId].json(params.body)),search.search({params:params},{abortSignal:this.abortSignal,sessionId:this.searchSessionId}).pipe(Object(external_kbnSharedDeps_RxjsOperators_.tap)(data=>this.inspectSearchResult(data,requestResponders[requestId])),Object(external_kbnSharedDeps_RxjsOperators_.map)(data=>({name:requestId,rawResponse:data.rawResponse})))}))}resetSearchStats(){this.inspectorAdapters&&this.inspectorAdapters.requests.reset()}inspectSearchResult(response,requestResponder){requestResponder&&requestResponder.stats(public_.search.getResponseInspectorStats(response.rawResponse)).ok({json:response.rawResponse})}}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class TimeCache{constructor(timefilter,maxAge){_defineProperty(this,"_timefilter",void 0),_defineProperty(this,"_maxAge",void 0),_defineProperty(this,"_cachedBounds",void 0),_defineProperty(this,"_cacheTS",void 0),_defineProperty(this,"_timeRange",void 0),this._timefilter=timefilter,this._maxAge=maxAge,this._cacheTS=0}_now(){return Date.now()}getTimeBounds(){const ts=this._now();let bounds=null;if(this._cachedBounds){const diff=ts-this._cacheTS;if(diff<40)return this._cachedBounds;if(diff<this._maxAge&&(bounds=this._getBounds(),Math.abs(bounds.min-this._cachedBounds.min)<this._maxAge&&Math.abs(bounds.max-this._cachedBounds.max)<this._maxAge))return this._cachedBounds}return this._cacheTS=ts,this._cachedBounds=bounds||this._getBounds(),this._cachedBounds}setTimeRange(timeRange){this._timeRange=timeRange}_getBounds(){const bounds=this._timefilter.calculateBounds(this._timeRange);return{min:bounds.min.valueOf(),max:bounds.max.valueOf()}}}const createVegaFn=dependencies=>({name:"vega",type:"render",inputTypes:["kibana_context","null"],help:external_kbnSharedDeps_KbnI18n_.i18n.translate("visTypeVega.function.help",{defaultMessage:"Vega visualization"}),args:{spec:{types:["string"],default:"",help:""}},async fn(input,args,context){const vegaRequestHandler=function({plugins:{data:data},core:{uiSettings:uiSettings},getServiceSettings:getServiceSettings},context={}){let searchAPI;const{timefilter:timefilter}=data.query.timefilter,timeCache=new TimeCache(timefilter,3e3);return async function({timeRange:timeRange,filters:filters,query:query,visParams:visParams,searchSessionId:searchSessionId}){searchAPI||(searchAPI=new search_api_SearchAPI({uiSettings:uiSettings,search:Object(services.a)().search,injectedMetadata:Object(services.d)()},context.abortSignal,context.inspectorAdapters,searchSessionId)),timeCache.setTimeRange(timeRange);const esQueryConfigs=public_.esQuery.getEsQueryConfig(uiSettings),filtersDsl=public_.esQuery.buildEsQuery(void 0,query,filters,esQueryConfigs),{VegaParser:VegaParser}=await Promise.all([__webpack_require__.e(0),__webpack_require__.e(7)]).then(__webpack_require__.bind(null,217)),vp=new VegaParser(visParams.spec,searchAPI,timeCache,filtersDsl,getServiceSettings);return await vp.parseAsync()}}(dependencies,context);return{type:"render",as:"vega_vis",value:{visData:await vegaRequestHandler({timeRange:Object(external_kbnSharedDeps_Lodash_.get)(input,"timeRange"),query:Object(external_kbnSharedDeps_Lodash_.get)(input,"query"),filters:Object(external_kbnSharedDeps_Lodash_.get)(input,"filters"),visParams:{spec:args.spec},searchSessionId:context.getSearchSessionId()}),visType:"vega",visConfig:{spec:args.spec}}}}});var hjson=__webpack_require__(10),visDefaultEditor_public_=__webpack_require__(20),visualizations_public_=__webpack_require__(9);var extract_index_pattern=__webpack_require__(17),external_kbnSharedDeps_React_=__webpack_require__(0),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),external_kbnSharedDeps_ElasticEui_=__webpack_require__(8),kibanaReact_public_=__webpack_require__(18),inspector_public_=__webpack_require__(21);const vegaAdapterSignalLabel=external_kbnSharedDeps_KbnI18n_.i18n.translate("visTypeVega.inspector.vegaAdapter.signal",{defaultMessage:"Signal"}),vegaAdapterValueLabel=external_kbnSharedDeps_KbnI18n_.i18n.translate("visTypeVega.inspector.vegaAdapter.value",{defaultMessage:"Value"}),getVegaRuntimeScope=debugValues=>debugValues.view._runtime,serializeColumns=(item,columns)=>columns.reduce((row,column)=>{try{const cell=item[column];row[column]="object"==typeof cell?JSON.stringify(cell):""+cell}catch(e){row[column]="(..)"}return row},{});class vega_adapter_VegaAdapter{constructor(){var obj,key,value;obj=this,key="debugValuesSubject",value=new external_kbnSharedDeps_Rxjs_.ReplaySubject,key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value}bindInspectValues(debugValues){this.debugValuesSubject.next(debugValues)}getDataSetsSubscription(){return this.debugValuesSubject.pipe(Object(external_kbnSharedDeps_RxjsOperators_.filter)(debugValues=>Boolean(debugValues)),Object(external_kbnSharedDeps_RxjsOperators_.map)(debugValues=>{const runtimeScope=getVegaRuntimeScope(debugValues);return Object.keys(runtimeScope.data||[]).reduce((acc,key)=>{const value=runtimeScope.data[key].values.value;if(value&&value[0]){const columns=Object.keys(value[0]);acc.push({id:key,columns:columns.map(column=>({id:column,schema:"json"})),data:value.map(item=>serializeColumns(item,columns))})}return acc},[])}))}getSignalsSetsSubscription(){const signalsListener=this.debugValuesSubject.pipe(Object(external_kbnSharedDeps_RxjsOperators_.filter)(debugValues=>Boolean(debugValues)),Object(external_kbnSharedDeps_RxjsOperators_.switchMap)(debugValues=>{const runtimeScope=getVegaRuntimeScope(debugValues);return Object(external_kbnSharedDeps_Rxjs_.merge)(...Object.keys(runtimeScope.signals).map(key=>Object(external_kbnSharedDeps_Rxjs_.fromEventPattern)(handler=>debugValues.view.addSignalListener(key,handler),handler=>debugValues.view.removeSignalListener(key,handler)))).pipe(Object(external_kbnSharedDeps_RxjsOperators_.debounce)(val=>Object(external_kbnSharedDeps_Rxjs_.timer)(350)),Object(external_kbnSharedDeps_RxjsOperators_.map)(()=>debugValues))}));return Object(external_kbnSharedDeps_Rxjs_.merge)(this.debugValuesSubject,signalsListener).pipe(Object(external_kbnSharedDeps_RxjsOperators_.filter)(debugValues=>Boolean(debugValues)),Object(external_kbnSharedDeps_RxjsOperators_.map)(debugValues=>{const runtimeScope=getVegaRuntimeScope(debugValues);return{columns:[{id:vegaAdapterSignalLabel,schema:"text"},{id:vegaAdapterValueLabel,schema:"json"}],data:Object.keys(runtimeScope.signals).map(key=>serializeColumns({[vegaAdapterSignalLabel]:key,[vegaAdapterValueLabel]:runtimeScope.signals[key].value},[vegaAdapterSignalLabel,vegaAdapterValueLabel]))}}))}getSpecSubscription(){return this.debugValuesSubject.pipe(Object(external_kbnSharedDeps_RxjsOperators_.filter)(debugValues=>Boolean(debugValues)),Object(external_kbnSharedDeps_RxjsOperators_.map)(debugValues=>JSON.stringify(debugValues.spec,null,2)))}}const VegaDataInspector=Object(external_kbnSharedDeps_React_.lazy)(()=>__webpack_require__.e(6).then(__webpack_require__.bind(null,216))),vegaDebugLabel=external_kbnSharedDeps_KbnI18n_.i18n.translate("visTypeVega.inspector.vegaDebugLabel",{defaultMessage:"Vega debug"}),createInspectorAdapters=()=>({requests:new inspector_public_.RequestAdapter,vega:new vega_adapter_VegaAdapter});var expressions_public_=__webpack_require__(13);const toExpressionAst=vis=>{const vega=Object(expressions_public_.buildExpressionFunction)("vega",{spec:vis.params.spec});return Object(expressions_public_.buildExpression)([vega]).toAst()};var external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(15);function ExperimentalMapLayerInfo(){const title=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"visTypeVega.mapView.experimentalMapLayerInfo",defaultMessage:"Map layer is experimental and is not subject to the support SLA of official GA features. For feedback, please create an issue in {githubLink}.",values:{githubLink:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{external:!0,href:"https://github.com/elastic/kibana/issues/new/choose",target:"_blank"},"GitHub")}});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{className:"hide-for-sharing","data-test-subj":"experimentalMapLayerInfo",size:"s",title:title,iconType:"beaker"})}const getInfoMessage=vis=>{if(vis.params.spec)try{var _spec$config,_spec$config$kibana;if("map"===(null===(_spec$config=Object(hjson.parse)(vis.params.spec,{legacyRoot:!1,keepWsc:!0}).config)||void 0===_spec$config||null===(_spec$config$kibana=_spec$config.kibana)||void 0===_spec$config$kibana?void 0:_spec$config$kibana.type))return external_kbnSharedDeps_React_default.a.createElement(ExperimentalMapLayerInfo,null)}catch(e){}return null},VegaVisEditor=Object(external_kbnSharedDeps_React_.lazy)(()=>__webpack_require__.e(4).then(__webpack_require__.bind(null,219))),VegaVisEditorComponent=props=>external_kbnSharedDeps_React_default.a.createElement(VegaVisEditor,props);var external_kbnSharedDeps_ReactDom_=__webpack_require__(14);const VegaVisComponent=Object(external_kbnSharedDeps_React_.lazy)(()=>__webpack_require__.e(5).then(__webpack_require__.bind(null,218)));var map_service_settings=__webpack_require__(19);class plugin_VegaPlugin{constructor(initializerContext){var obj,key,value;value=void 0,(key="initializerContext")in(obj=this)?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,this.initializerContext=initializerContext}setup(core,{inspector:inspector,data:data,expressions:expressions,visualizations:visualizations,mapsEms:mapsEms}){Object(services.k)({enableExternalUrls:this.initializerContext.config.get().enableExternalUrls,emsTileLayerId:core.injectedMetadata.getInjectedVar("emsTileLayerId",!0)}),Object(services.n)(core.uiSettings),Object(services.l)(new map_service_settings.a(mapsEms.config,this.initializerContext.env.packageInfo.version));const visualizationDependencies={core:core,plugins:{data:data},getServiceSettings:mapsEms.getServiceSettings};var dependencies,deps;inspector.registerView((dependencies={uiSettings:core.uiSettings},{title:vegaDebugLabel,shouldShow:adapters=>Boolean(adapters.vega),component:props=>external_kbnSharedDeps_React_default.a.createElement(kibanaReact_public_.KibanaContextProvider,{services:dependencies},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Suspense,{fallback:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingSpinner,null)},external_kbnSharedDeps_React_default.a.createElement(VegaDataInspector,props)))})),expressions.registerFunction(()=>createVegaFn(visualizationDependencies)),expressions.registerRenderer((deps=visualizationDependencies,{name:"vega_vis",reuseDomNode:!0,render:(domNode,{visData:visData},handlers)=>{handlers.onDestroy(()=>{Object(external_kbnSharedDeps_ReactDom_.unmountComponentAtNode)(domNode)}),Object(external_kbnSharedDeps_ReactDom_.render)(external_kbnSharedDeps_React_default.a.createElement(visualizations_public_.VisualizationContainer,{handlers:handlers},external_kbnSharedDeps_React_default.a.createElement(VegaVisComponent,{deps:deps,fireEvent:handlers.event,renderComplete:handlers.done,visData:visData})),domNode)}})),visualizations.createBaseVisualization({name:"vega",title:"Vega",getInfoMessage:getInfoMessage,description:external_kbnSharedDeps_KbnI18n_.i18n.translate("visTypeVega.type.vegaDescription",{defaultMessage:"Use Vega to create new types of visualizations.",description:"Vega and Vega-Lite are product names and should not be translated"}),note:external_kbnSharedDeps_KbnI18n_.i18n.translate("visTypeVega.type.vegaNote",{defaultMessage:"Requires knowledge of Vega syntax."}),icon:"visVega",group:visualizations_public_.VisGroups.PROMOTED,titleInWizard:external_kbnSharedDeps_KbnI18n_.i18n.translate("visTypeVega.type.vegaTitleInWizard",{defaultMessage:"Custom visualization"}),visConfig:{defaults:{spec:'{\n/*\n\nWelcome to Vega visualizations.  Here you can design your own dataviz from scratch using a declarative language called Vega, or its simpler form Vega-Lite.  In Vega, you have the full control of what data is loaded, even from multiple sources, how that data is transformed, and what visual elements are used to show it.  Use help icon to view Vega examples, tutorials, and other docs.  Use the wrench icon to reformat this text, or to remove comments.\n\nThis example graph shows the document count in all indexes in the current time range.  You might need to adjust the time filter in the upper right corner.\n*/\n\n  $schema: https://vega.github.io/schema/vega-lite/v5.json\n  title: Event counts from all indexes\n\n  // Define the data source\n  data: {\n    url: {\n/*\nAn object instead of a string for the "url" param is treated as an Elasticsearch query. Anything inside this object is not part of the Vega language, but only understood by Kibana and Elasticsearch server. This query counts the number of documents per time interval, assuming you have a @timestamp field in your data.\n\nKibana has a special handling for the fields surrounded by "%".  They are processed before the the query is sent to Elasticsearch. This way the query becomes context aware, and can use the time range and the dashboard filters.\n*/\n\n      // Apply dashboard context filters when set\n      %context%: true\n      // Filter the time picker (upper right corner) with this field\n      %timefield%: @timestamp\n\n/*\nSee .search() documentation for :  https://www.elastic.co/guide/en/elasticsearch/client/javascript-api/current/api-reference.html#api-search\n*/\n\n      // Which index to search\n      index: _all\n      // Aggregate data by the time field into time buckets, counting the number of documents in each bucket.\n      body: {\n        aggs: {\n          time_buckets: {\n            date_histogram: {\n              // Use date histogram aggregation on @timestamp field\n              field: @timestamp\n              // The interval value will depend on the daterange picker (true), or use an integer to set an approximate bucket count\n              interval: {%autointerval%: true}\n              // Make sure we get an entire range, even if it has no data\n              extended_bounds: {\n                // Use the current time range\'s start and end\n                min: {%timefilter%: "min"}\n                max: {%timefilter%: "max"}\n              }\n              // Use this for linear (e.g. line, area) graphs.  Without it, empty buckets will not show up\n              min_doc_count: 0\n            }\n          }\n        }\n        // Speed up the response by only including aggregation results\n        size: 0\n      }\n    }\n/*\nElasticsearch will return results in this format:\n\naggregations: {\n  time_buckets: {\n    buckets: [\n      {\n        key_as_string: 2015-11-30T22:00:00.000Z\n        key: 1448920800000\n        doc_count: 0\n      },\n      {\n        key_as_string: 2015-11-30T23:00:00.000Z\n        key: 1448924400000\n        doc_count: 0\n      }\n      ...\n    ]\n  }\n}\n\nFor our graph, we only need the list of bucket values.  Use the format.property to discard everything else.\n*/\n    format: {property: "aggregations.time_buckets.buckets"}\n  }\n\n  // "mark" is the graphics element used to show our data.  Other mark values are: area, bar, circle, line, point, rect, rule, square, text, and tick.  See https://vega.github.io/vega-lite/docs/mark.html\n  mark: line\n\n  // "encoding" tells the "mark" what data to use and in what way.  See https://vega.github.io/vega-lite/docs/encoding.html\n  encoding: {\n    x: {\n      // The "key" value is the timestamp in milliseconds.  Use it for X axis.\n      field: key\n      type: temporal\n      axis: {title: false} // Customize X axis format\n    }\n    y: {\n      // The "doc_count" is the count per bucket.  Use it for Y axis.\n      field: doc_count\n      type: quantitative\n      axis: {title: "Document count"}\n    }\n  }\n}\n'}},editorConfig:{optionsTemplate:VegaVisEditorComponent,enableAutoApply:!0,defaultSize:visDefaultEditor_public_.DefaultEditorSize.MEDIUM},toExpressionAst:toExpressionAst,options:{showIndexSelection:!1,showQueryBar:!0,showFilterBar:!0},getSupportedTriggers:()=>[visualizations_public_.VIS_EVENT_TO_TRIGGER.applyFilter],getUsedIndexPattern:async visParams=>{try{const spec=Object(hjson.parse)(visParams.spec,{legacyRoot:!1,keepWsc:!0});return Object(extract_index_pattern.a)(spec)}catch(e){}return[]},inspectorAdapters:createInspectorAdapters,requiresSearch:!0})}start(core,{data:data}){Object(services.m)(core.notifications),Object(services.h)(data),Object(services.j)(core.injectedMetadata),Object(services.i)(core.docLinks)}}function public_plugin(initializerContext){return new plugin_VegaPlugin(initializerContext)}},function(module,exports){module.exports=__kbnSharedDeps__.Moment},function(module,exports){module.exports=__kbnSharedDeps__.Jquery},function(module,exports){module.exports=__kbnSharedDeps__.Theme},function(module,exports){module.exports=__kbnSharedDeps__.TsLib},function(module,exports){module.exports=__kbnSharedDeps__.KbnMonaco}]);