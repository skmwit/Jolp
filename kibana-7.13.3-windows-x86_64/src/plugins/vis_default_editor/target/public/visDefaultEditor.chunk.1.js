(window.visDefaultEditor_bundle_jsonpfunction=window.visDefaultEditor_bundle_jsonpfunction||[]).push([[1],Array(19).concat([function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var useEffectOnce_1=__webpack_require__(15).__importDefault(__webpack_require__(23));exports.default=function(fn){useEffectOnce_1.default((function(){fn()}))}},function(module,exports,__webpack_require__){"use strict";var memo,isOldIE=function(){return void 0===memo&&(memo=Boolean(window&&document&&document.all&&!window.atob)),memo},getTarget=function(){var memo={};return function(target){if(void 0===memo[target]){var styleTarget=document.querySelector(target);if(window.HTMLIFrameElement&&styleTarget instanceof window.HTMLIFrameElement)try{styleTarget=styleTarget.contentDocument.head}catch(e){styleTarget=null}memo[target]=styleTarget}return memo[target]}}(),stylesInDom=[];function getIndexByIdentifier(identifier){for(var result=-1,i=0;i<stylesInDom.length;i++)if(stylesInDom[i].identifier===identifier){result=i;break}return result}function modulesToDom(list,options){for(var idCountMap={},identifiers=[],i=0;i<list.length;i++){var item=list[i],id=options.base?item[0]+options.base:item[0],count=idCountMap[id]||0,identifier="".concat(id," ").concat(count);idCountMap[id]=count+1;var index=getIndexByIdentifier(identifier),obj={css:item[1],media:item[2],sourceMap:item[3]};-1!==index?(stylesInDom[index].references++,stylesInDom[index].updater(obj)):stylesInDom.push({identifier:identifier,updater:addStyle(obj,options),references:1}),identifiers.push(identifier)}return identifiers}function insertStyleElement(options){var style=document.createElement("style"),attributes=options.attributes||{};if(void 0===attributes.nonce){var nonce=__webpack_require__.nc;nonce&&(attributes.nonce=nonce)}if(Object.keys(attributes).forEach((function(key){style.setAttribute(key,attributes[key])})),"function"==typeof options.insert)options.insert(style);else{var target=getTarget(options.insert||"head");if(!target)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");target.appendChild(style)}return style}var textStore,replaceText=(textStore=[],function(index,replacement){return textStore[index]=replacement,textStore.filter(Boolean).join("\n")});function applyToSingletonTag(style,index,remove,obj){var css=remove?"":obj.media?"@media ".concat(obj.media," {").concat(obj.css,"}"):obj.css;if(style.styleSheet)style.styleSheet.cssText=replaceText(index,css);else{var cssNode=document.createTextNode(css),childNodes=style.childNodes;childNodes[index]&&style.removeChild(childNodes[index]),childNodes.length?style.insertBefore(cssNode,childNodes[index]):style.appendChild(cssNode)}}function applyToTag(style,options,obj){var css=obj.css,media=obj.media,sourceMap=obj.sourceMap;if(media?style.setAttribute("media",media):style.removeAttribute("media"),sourceMap&&btoa&&(css+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))))," */")),style.styleSheet)style.styleSheet.cssText=css;else{for(;style.firstChild;)style.removeChild(style.firstChild);style.appendChild(document.createTextNode(css))}}var singleton=null,singletonCounter=0;function addStyle(obj,options){var style,update,remove;if(options.singleton){var styleIndex=singletonCounter++;style=singleton||(singleton=insertStyleElement(options)),update=applyToSingletonTag.bind(null,style,styleIndex,!1),remove=applyToSingletonTag.bind(null,style,styleIndex,!0)}else style=insertStyleElement(options),update=applyToTag.bind(null,style,options),remove=function(){!function(style){if(null===style.parentNode)return!1;style.parentNode.removeChild(style)}(style)};return update(obj),function(newObj){if(newObj){if(newObj.css===obj.css&&newObj.media===obj.media&&newObj.sourceMap===obj.sourceMap)return;update(obj=newObj)}else remove()}}module.exports=function(list,options){(options=options||{}).singleton||"boolean"==typeof options.singleton||(options.singleton=isOldIE());var lastIdentifiers=modulesToDom(list=list||[],options);return function(newList){if(newList=newList||[],"[object Array]"===Object.prototype.toString.call(newList)){for(var i=0;i<lastIdentifiers.length;i++){var index=getIndexByIdentifier(lastIdentifiers[i]);stylesInDom[index].references--}for(var newLastIdentifiers=modulesToDom(newList,options),_i=0;_i<lastIdentifiers.length;_i++){var _index=getIndexByIdentifier(lastIdentifiers[_i]);0===stylesInDom[_index].references&&(stylesInDom[_index].updater(),stylesInDom.splice(_index,1))}lastIdentifiers=newLastIdentifiers}}}},function(module,exports,__webpack_require__){"use strict";module.exports=function(useSourceMap){var list=[];return list.toString=function(){return this.map((function(item){var content=function(item,useSourceMap){var content=item[1]||"",cssMapping=item[3];if(!cssMapping)return content;if(useSourceMap&&"function"==typeof btoa){var sourceMapping=(sourceMap=cssMapping,base64=btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))),data="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(base64),"/*# ".concat(data," */")),sourceURLs=cssMapping.sources.map((function(source){return"/*# sourceURL=".concat(cssMapping.sourceRoot||"").concat(source," */")}));return[content].concat(sourceURLs).concat([sourceMapping]).join("\n")}var sourceMap,base64,data;return[content].join("\n")}(item,useSourceMap);return item[2]?"@media ".concat(item[2]," {").concat(content,"}"):content})).join("")},list.i=function(modules,mediaQuery,dedupe){"string"==typeof modules&&(modules=[[null,modules,""]]);var alreadyImportedModules={};if(dedupe)for(var i=0;i<this.length;i++){var id=this[i][0];null!=id&&(alreadyImportedModules[id]=!0)}for(var _i=0;_i<modules.length;_i++){var item=[].concat(modules[_i]);dedupe&&alreadyImportedModules[item[0]]||(mediaQuery&&(item[2]?item[2]="".concat(mediaQuery," and ").concat(item[2]):item[2]=mediaQuery),list.push(item))}},list}},function(module,exports,__webpack_require__){ace.define("ace/mode/json_highlight_rules",["require","exports","module","ace/lib/oop","ace/mode/text_highlight_rules"],(function(acequire,exports,module){"use strict";var oop=acequire("../lib/oop"),TextHighlightRules=acequire("./text_highlight_rules").TextHighlightRules,JsonHighlightRules=function(){this.$rules={start:[{token:"variable",regex:'["](?:(?:\\\\.)|(?:[^"\\\\]))*?["]\\s*(?=:)'},{token:"string",regex:'"',next:"string"},{token:"constant.numeric",regex:"0[xX][0-9a-fA-F]+\\b"},{token:"constant.numeric",regex:"[+-]?\\d+(?:(?:\\.\\d*)?(?:[eE][+-]?\\d+)?)?\\b"},{token:"constant.language.boolean",regex:"(?:true|false)\\b"},{token:"text",regex:"['](?:(?:\\\\.)|(?:[^'\\\\]))*?[']"},{token:"comment",regex:"\\/\\/.*$"},{token:"comment.start",regex:"\\/\\*",next:"comment"},{token:"paren.lparen",regex:"[[({]"},{token:"paren.rparen",regex:"[\\])}]"},{token:"text",regex:"\\s+"}],string:[{token:"constant.language.escape",regex:/\\(?:x[0-9a-fA-F]{2}|u[0-9a-fA-F]{4}|["\\\/bfnrt])/},{token:"string",regex:'"|$',next:"start"},{defaultToken:"string"}],comment:[{token:"comment.end",regex:"\\*\\/",next:"start"},{defaultToken:"comment"}]}};oop.inherits(JsonHighlightRules,TextHighlightRules),exports.JsonHighlightRules=JsonHighlightRules})),ace.define("ace/mode/matching_brace_outdent",["require","exports","module","ace/range"],(function(acequire,exports,module){"use strict";var Range=acequire("../range").Range,MatchingBraceOutdent=function(){};(function(){this.checkOutdent=function(line,input){return!!/^\s+$/.test(line)&&/^\s*\}/.test(input)},this.autoOutdent=function(doc,row){var match=doc.getLine(row).match(/^(\s*\})/);if(!match)return 0;var column=match[1].length,openBracePos=doc.findMatchingBracket({row:row,column:column});if(!openBracePos||openBracePos.row==row)return 0;var indent=this.$getIndent(doc.getLine(openBracePos.row));doc.replace(new Range(row,0,row,column-1),indent)},this.$getIndent=function(line){return line.match(/^\s*/)[0]}}).call(MatchingBraceOutdent.prototype),exports.MatchingBraceOutdent=MatchingBraceOutdent})),ace.define("ace/mode/folding/cstyle",["require","exports","module","ace/lib/oop","ace/range","ace/mode/folding/fold_mode"],(function(acequire,exports,module){"use strict";var oop=acequire("../../lib/oop"),Range=acequire("../../range").Range,BaseFoldMode=acequire("./fold_mode").FoldMode,FoldMode=exports.FoldMode=function(commentRegex){commentRegex&&(this.foldingStartMarker=new RegExp(this.foldingStartMarker.source.replace(/\|[^|]*?$/,"|"+commentRegex.start)),this.foldingStopMarker=new RegExp(this.foldingStopMarker.source.replace(/\|[^|]*?$/,"|"+commentRegex.end)))};oop.inherits(FoldMode,BaseFoldMode),function(){this.foldingStartMarker=/([\{\[\(])[^\}\]\)]*$|^\s*(\/\*)/,this.foldingStopMarker=/^[^\[\{\(]*([\}\]\)])|^[\s\*]*(\*\/)/,this.singleLineBlockCommentRe=/^\s*(\/\*).*\*\/\s*$/,this.tripleStarBlockCommentRe=/^\s*(\/\*\*\*).*\*\/\s*$/,this.startRegionRe=/^\s*(\/\*|\/\/)#?region\b/,this._getFoldWidgetBase=this.getFoldWidget,this.getFoldWidget=function(session,foldStyle,row){var line=session.getLine(row);if(this.singleLineBlockCommentRe.test(line)&&!this.startRegionRe.test(line)&&!this.tripleStarBlockCommentRe.test(line))return"";var fw=this._getFoldWidgetBase(session,foldStyle,row);return!fw&&this.startRegionRe.test(line)?"start":fw},this.getFoldWidgetRange=function(session,foldStyle,row,forceMultiline){var match,line=session.getLine(row);if(this.startRegionRe.test(line))return this.getCommentRegionBlock(session,line,row);if(match=line.match(this.foldingStartMarker)){var i=match.index;if(match[1])return this.openingBracketBlock(session,match[1],row,i);var range=session.getCommentFoldRange(row,i+match[0].length,1);return range&&!range.isMultiLine()&&(forceMultiline?range=this.getSectionRange(session,row):"all"!=foldStyle&&(range=null)),range}if("markbegin"!==foldStyle&&(match=line.match(this.foldingStopMarker))){i=match.index+match[0].length;return match[1]?this.closingBracketBlock(session,match[1],row,i):session.getCommentFoldRange(row,i,-1)}},this.getSectionRange=function(session,row){for(var line=session.getLine(row),startIndent=line.search(/\S/),startRow=row,startColumn=line.length,endRow=row+=1,maxRow=session.getLength();++row<maxRow;){var indent=(line=session.getLine(row)).search(/\S/);if(-1!==indent){if(startIndent>indent)break;var subRange=this.getFoldWidgetRange(session,"all",row);if(subRange){if(subRange.start.row<=startRow)break;if(subRange.isMultiLine())row=subRange.end.row;else if(startIndent==indent)break}endRow=row}}return new Range(startRow,startColumn,endRow,session.getLine(endRow).length)},this.getCommentRegionBlock=function(session,line,row){for(var startColumn=line.search(/\s*$/),maxRow=session.getLength(),startRow=row,re=/^\s*(?:\/\*|\/\/|--)#?(end)?region\b/,depth=1;++row<maxRow;){line=session.getLine(row);var m=re.exec(line);if(m&&(m[1]?depth--:depth++,!depth))break}if(row>startRow)return new Range(startRow,startColumn,row,line.length)}}.call(FoldMode.prototype)})),ace.define("ace/mode/json",["require","exports","module","ace/lib/oop","ace/mode/text","ace/mode/json_highlight_rules","ace/mode/matching_brace_outdent","ace/mode/behaviour/cstyle","ace/mode/folding/cstyle","ace/worker/worker_client"],(function(acequire,exports,module){"use strict";var oop=acequire("../lib/oop"),TextMode=acequire("./text").Mode,HighlightRules=acequire("./json_highlight_rules").JsonHighlightRules,MatchingBraceOutdent=acequire("./matching_brace_outdent").MatchingBraceOutdent,CstyleBehaviour=acequire("./behaviour/cstyle").CstyleBehaviour,CStyleFoldMode=acequire("./folding/cstyle").FoldMode,WorkerClient=acequire("../worker/worker_client").WorkerClient,Mode=function(){this.HighlightRules=HighlightRules,this.$outdent=new MatchingBraceOutdent,this.$behaviour=new CstyleBehaviour,this.foldingRules=new CStyleFoldMode};oop.inherits(Mode,TextMode),function(){this.getNextLineIndent=function(state,line,tab){var indent=this.$getIndent(line);"start"==state&&(line.match(/^.*[\{\(\[]\s*$/)&&(indent+=tab));return indent},this.checkOutdent=function(state,line,input){return this.$outdent.checkOutdent(line,input)},this.autoOutdent=function(state,doc,row){this.$outdent.autoOutdent(doc,row)},this.createWorker=function(session){var worker=new WorkerClient(["ace"],__webpack_require__(33),"JsonWorker");return worker.attachToDocument(session.getDocument()),worker.on("annotate",(function(e){session.setAnnotations(e.data)})),worker.on("terminate",(function(){session.clearAnnotations()})),worker},this.$id="ace/mode/json"}.call(Mode.prototype),exports.Mode=Mode}))},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var react_1=__webpack_require__(0);exports.default=function(effect){react_1.useEffect(effect,[])}},function(module,exports,__webpack_require__){switch(window.__kbnThemeTag__){case"v7dark":return __webpack_require__(25);case"v7light":return __webpack_require__(27);case"v8dark":return __webpack_require__(29);case"v8light":return __webpack_require__(31)}},function(module,exports,__webpack_require__){var api=__webpack_require__(20),content=__webpack_require__(26);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){(exports=__webpack_require__(21)(!1)).push([module.i,".visEditor--default{flex:1 1 auto;display:flex}.visEditor__collapsibleSidebar{flex-grow:1}.visEditor__collapsibleSidebar-isClosed{min-width:0;width:32px !important}.visEditor__collapsibleSidebar-isClosed .visEditorSidebar{display:none;padding-left:0}.visEditor__collapsibleSidebarButton{position:absolute;right:4px;top:8px}.visEditor__resizer-isHidden{display:none}.visEditor__visualization__wrapper-expanded{width:100% !important}.visEditor__visualization{display:flex;flex:1 1 auto;overflow:hidden}.visEditor__canvas{background-color:#1D1E24;display:flex;flex-direction:row;overflow:auto;flex-shrink:1;flex-basis:100%}.visEditor__canvas.embedded{flex-shrink:1;flex-basis:100%}.visEditor__canvas .visChart{position:relative}@media only screen and (max-width: 574px){.visEditor--default{flex-direction:column}.visEditor__collapsibleSidebar{width:100% !important;flex-grow:0}.visEditor__collapsibleSidebar-isClosed{height:40px !important}.visEditor__resizer{display:none}.visEditor__visualization__wrapper{width:100% !important;flex:1;display:flex;flex-direction:column}}@media only screen and (min-width: 575px) and (max-width: 767px){.visEditor--default{flex-direction:column}.visEditor__collapsibleSidebar{width:100% !important;flex-grow:0}.visEditor__collapsibleSidebar-isClosed{height:40px !important}.visEditor__resizer{display:none}.visEditor__visualization__wrapper{width:100% !important;flex:1;display:flex;flex-direction:column}}@media only screen and (min-width: 768px) and (max-width: 991px){.visEditor--default{flex-direction:column}.visEditor__collapsibleSidebar{width:100% !important;flex-grow:0}.visEditor__collapsibleSidebar-isClosed{height:40px !important}.visEditor__resizer{display:none}.visEditor__visualization__wrapper{width:100% !important;flex:1;display:flex;flex-direction:column}}.visEditorSidebar{height:100%;padding-left:8px}@media only screen and (max-width: 574px){.visEditorSidebar{padding-left:0}}@media only screen and (min-width: 575px) and (max-width: 767px){.visEditorSidebar{padding-left:0}}@media only screen and (min-width: 768px) and (max-width: 991px){.visEditorSidebar{padding-left:0}}.visEditorSidebar__form{flex:1 1 auto;display:flex;flex-direction:column;max-width:100%}.visEditorSidebar__form>*{flex-shrink:0}.visEditorSidebar__config{padding:8px}.visEditorSidebar__config>*{flex-grow:0}@media only screen and (min-width: 992px) and (max-width: 1199px){.visEditorSidebar__config{flex:1 1 1px;display:flex;flex-direction:column;scrollbar-width:thin;overflow:auto}.visEditorSidebar__config>*{flex-shrink:0}.visEditorSidebar__config::-webkit-scrollbar{width:16px;height:16px}.visEditorSidebar__config::-webkit-scrollbar-thumb{background-color:rgba(152,162,179,0.5);border:6px solid rgba(0,0,0,0);background-clip:content-box}.visEditorSidebar__config::-webkit-scrollbar-corner,.visEditorSidebar__config::-webkit-scrollbar-track{background-color:rgba(0,0,0,0)}}@media only screen and (min-width: 1200px){.visEditorSidebar__config{flex:1 1 1px;display:flex;flex-direction:column;scrollbar-width:thin;overflow:auto}.visEditorSidebar__config>*{flex-shrink:0}.visEditorSidebar__config::-webkit-scrollbar{width:16px;height:16px}.visEditorSidebar__config::-webkit-scrollbar-thumb{background-color:rgba(152,162,179,0.5);border:6px solid rgba(0,0,0,0);background-clip:content-box}.visEditorSidebar__config::-webkit-scrollbar-corner,.visEditorSidebar__config::-webkit-scrollbar-track{background-color:rgba(0,0,0,0)}}.visEditorSidebar__config-isHidden{display:none}.visEditorSidebar__titleContainer{padding:8px 32px 8px 8px}.visEditorSidebar__indexPatternPlaceholder{min-height:40px;border-bottom:1px solid #343741}.visEditorSidebar__nav,.visEditorSidebar__linkedSearch{flex-grow:0}.visEditorSidebar__section{background-color:#1D1E24;padding:8px;border-radius:4px}.visEditorSidebar__section+.visEditorSidebar__section{margin-top:8px}.visEditorSidebar__collapsible{background-color:#25262E}.visEditorSidebar__collapsible--marginBottom{margin-bottom:12px}.visEditorSidebar__formRow{display:flex;align-items:center;margin-top:12px}.visEditorSidebar__formLabel{display:flex;align-items:center;flex:1 1 40%;padding-right:4px}.visEditorSidebar__formControl{display:flex;align-items:center;flex:1 1 60%}.visEditorSidebar__aggGroupAccordionButtonContent{font-size:14px}.visEditorSidebar__aggGroupAccordionButtonContent span{color:#98A2B3}.visEditorSidebar__controls{border-top:1px solid #343741;padding:8px;display:flex;justify-content:flex-end;align-items:center}.visEditorSidebar__controls .visEditorSidebar__autoApplyButton{margin-left:12px}.visEditorAgg__subAgg{border:2px solid #343741;border-radius:4px;background-color:transparent;padding:8px}.visEditorAgg__subAgg+.visEditorAggParam__string{margin-top:16px}.visEditorAggParam--half{margin:16px 0;display:inline-block;width:calc(50% - 4px)}.visEditorAggParam--half-size{margin-left:8px}\n",""]),module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(20),content=__webpack_require__(28);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){(exports=__webpack_require__(21)(!1)).push([module.i,".visEditor--default{flex:1 1 auto;display:flex}.visEditor__collapsibleSidebar{flex-grow:1}.visEditor__collapsibleSidebar-isClosed{min-width:0;width:32px !important}.visEditor__collapsibleSidebar-isClosed .visEditorSidebar{display:none;padding-left:0}.visEditor__collapsibleSidebarButton{position:absolute;right:4px;top:8px}.visEditor__resizer-isHidden{display:none}.visEditor__visualization__wrapper-expanded{width:100% !important}.visEditor__visualization{display:flex;flex:1 1 auto;overflow:hidden}.visEditor__canvas{background-color:#fff;display:flex;flex-direction:row;overflow:auto;flex-shrink:1;flex-basis:100%}.visEditor__canvas.embedded{flex-shrink:1;flex-basis:100%}.visEditor__canvas .visChart{position:relative}@media only screen and (max-width: 574px){.visEditor--default{flex-direction:column}.visEditor__collapsibleSidebar{width:100% !important;flex-grow:0}.visEditor__collapsibleSidebar-isClosed{height:40px !important}.visEditor__resizer{display:none}.visEditor__visualization__wrapper{width:100% !important;flex:1;display:flex;flex-direction:column}}@media only screen and (min-width: 575px) and (max-width: 767px){.visEditor--default{flex-direction:column}.visEditor__collapsibleSidebar{width:100% !important;flex-grow:0}.visEditor__collapsibleSidebar-isClosed{height:40px !important}.visEditor__resizer{display:none}.visEditor__visualization__wrapper{width:100% !important;flex:1;display:flex;flex-direction:column}}@media only screen and (min-width: 768px) and (max-width: 991px){.visEditor--default{flex-direction:column}.visEditor__collapsibleSidebar{width:100% !important;flex-grow:0}.visEditor__collapsibleSidebar-isClosed{height:40px !important}.visEditor__resizer{display:none}.visEditor__visualization__wrapper{width:100% !important;flex:1;display:flex;flex-direction:column}}.visEditorSidebar{height:100%;padding-left:8px}@media only screen and (max-width: 574px){.visEditorSidebar{padding-left:0}}@media only screen and (min-width: 575px) and (max-width: 767px){.visEditorSidebar{padding-left:0}}@media only screen and (min-width: 768px) and (max-width: 991px){.visEditorSidebar{padding-left:0}}.visEditorSidebar__form{flex:1 1 auto;display:flex;flex-direction:column;max-width:100%}.visEditorSidebar__form>*{flex-shrink:0}.visEditorSidebar__config{padding:8px}.visEditorSidebar__config>*{flex-grow:0}@media only screen and (min-width: 992px) and (max-width: 1199px){.visEditorSidebar__config{flex:1 1 1px;display:flex;flex-direction:column;scrollbar-width:thin;overflow:auto}.visEditorSidebar__config>*{flex-shrink:0}.visEditorSidebar__config::-webkit-scrollbar{width:16px;height:16px}.visEditorSidebar__config::-webkit-scrollbar-thumb{background-color:rgba(105,112,125,0.5);border:6px solid rgba(0,0,0,0);background-clip:content-box}.visEditorSidebar__config::-webkit-scrollbar-corner,.visEditorSidebar__config::-webkit-scrollbar-track{background-color:rgba(0,0,0,0)}}@media only screen and (min-width: 1200px){.visEditorSidebar__config{flex:1 1 1px;display:flex;flex-direction:column;scrollbar-width:thin;overflow:auto}.visEditorSidebar__config>*{flex-shrink:0}.visEditorSidebar__config::-webkit-scrollbar{width:16px;height:16px}.visEditorSidebar__config::-webkit-scrollbar-thumb{background-color:rgba(105,112,125,0.5);border:6px solid rgba(0,0,0,0);background-clip:content-box}.visEditorSidebar__config::-webkit-scrollbar-corner,.visEditorSidebar__config::-webkit-scrollbar-track{background-color:rgba(0,0,0,0)}}.visEditorSidebar__config-isHidden{display:none}.visEditorSidebar__titleContainer{padding:8px 32px 8px 8px}.visEditorSidebar__indexPatternPlaceholder{min-height:40px;border-bottom:1px solid #D3DAE6}.visEditorSidebar__nav,.visEditorSidebar__linkedSearch{flex-grow:0}.visEditorSidebar__section{background-color:#fff;padding:8px;border-radius:4px}.visEditorSidebar__section+.visEditorSidebar__section{margin-top:8px}.visEditorSidebar__collapsible{background-color:#fafbfd}.visEditorSidebar__collapsible--marginBottom{margin-bottom:12px}.visEditorSidebar__formRow{display:flex;align-items:center;margin-top:12px}.visEditorSidebar__formLabel{display:flex;align-items:center;flex:1 1 40%;padding-right:4px}.visEditorSidebar__formControl{display:flex;align-items:center;flex:1 1 60%}.visEditorSidebar__aggGroupAccordionButtonContent{font-size:14px}.visEditorSidebar__aggGroupAccordionButtonContent span{color:#69707D}.visEditorSidebar__controls{border-top:1px solid #D3DAE6;padding:8px;display:flex;justify-content:flex-end;align-items:center}.visEditorSidebar__controls .visEditorSidebar__autoApplyButton{margin-left:12px}.visEditorAgg__subAgg{border:2px solid #D3DAE6;border-radius:4px;background-color:transparent;padding:8px}.visEditorAgg__subAgg+.visEditorAggParam__string{margin-top:16px}.visEditorAggParam--half{margin:16px 0;display:inline-block;width:calc(50% - 4px)}.visEditorAggParam--half-size{margin-left:8px}\n",""]),module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(20),content=__webpack_require__(30);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){(exports=__webpack_require__(21)(!1)).push([module.i,".visEditor--default{flex:1 1 auto;display:flex}.visEditor__collapsibleSidebar{flex-grow:1}.visEditor__collapsibleSidebar-isClosed{min-width:0;width:32px !important}.visEditor__collapsibleSidebar-isClosed .visEditorSidebar{display:none;padding-left:0}.visEditor__collapsibleSidebarButton{position:absolute;right:4px;top:8px}.visEditor__resizer-isHidden{display:none}.visEditor__visualization__wrapper-expanded{width:100% !important}.visEditor__visualization{display:flex;flex:1 1 auto;overflow:hidden}.visEditor__canvas{background-color:#1D1E24;display:flex;flex-direction:row;overflow:auto;flex-shrink:1;flex-basis:100%}.visEditor__canvas.embedded{flex-shrink:1;flex-basis:100%}.visEditor__canvas .visChart{position:relative}@media only screen and (max-width: 574px){.visEditor--default{flex-direction:column}.visEditor__collapsibleSidebar{width:100% !important;flex-grow:0}.visEditor__collapsibleSidebar-isClosed{height:40px !important}.visEditor__resizer{display:none}.visEditor__visualization__wrapper{width:100% !important;flex:1;display:flex;flex-direction:column}}@media only screen and (min-width: 575px) and (max-width: 767px){.visEditor--default{flex-direction:column}.visEditor__collapsibleSidebar{width:100% !important;flex-grow:0}.visEditor__collapsibleSidebar-isClosed{height:40px !important}.visEditor__resizer{display:none}.visEditor__visualization__wrapper{width:100% !important;flex:1;display:flex;flex-direction:column}}@media only screen and (min-width: 768px) and (max-width: 991px){.visEditor--default{flex-direction:column}.visEditor__collapsibleSidebar{width:100% !important;flex-grow:0}.visEditor__collapsibleSidebar-isClosed{height:40px !important}.visEditor__resizer{display:none}.visEditor__visualization__wrapper{width:100% !important;flex:1;display:flex;flex-direction:column}}.visEditorSidebar{height:100%;padding-left:8px}@media only screen and (max-width: 574px){.visEditorSidebar{padding-left:0}}@media only screen and (min-width: 575px) and (max-width: 767px){.visEditorSidebar{padding-left:0}}@media only screen and (min-width: 768px) and (max-width: 991px){.visEditorSidebar{padding-left:0}}.visEditorSidebar__form{flex:1 1 auto;display:flex;flex-direction:column;max-width:100%}.visEditorSidebar__form>*{flex-shrink:0}.visEditorSidebar__config{padding:8px}.visEditorSidebar__config>*{flex-grow:0}@media only screen and (min-width: 992px) and (max-width: 1199px){.visEditorSidebar__config{flex:1 1 1px;display:flex;flex-direction:column;scrollbar-width:thin;overflow:auto}.visEditorSidebar__config>*{flex-shrink:0}.visEditorSidebar__config::-webkit-scrollbar{width:16px;height:16px}.visEditorSidebar__config::-webkit-scrollbar-thumb{background-color:rgba(152,162,179,0.5);border:6px solid rgba(0,0,0,0);background-clip:content-box}.visEditorSidebar__config::-webkit-scrollbar-corner,.visEditorSidebar__config::-webkit-scrollbar-track{background-color:rgba(0,0,0,0)}}@media only screen and (min-width: 1200px){.visEditorSidebar__config{flex:1 1 1px;display:flex;flex-direction:column;scrollbar-width:thin;overflow:auto}.visEditorSidebar__config>*{flex-shrink:0}.visEditorSidebar__config::-webkit-scrollbar{width:16px;height:16px}.visEditorSidebar__config::-webkit-scrollbar-thumb{background-color:rgba(152,162,179,0.5);border:6px solid rgba(0,0,0,0);background-clip:content-box}.visEditorSidebar__config::-webkit-scrollbar-corner,.visEditorSidebar__config::-webkit-scrollbar-track{background-color:rgba(0,0,0,0)}}.visEditorSidebar__config-isHidden{display:none}.visEditorSidebar__titleContainer{padding:8px 32px 8px 8px}.visEditorSidebar__indexPatternPlaceholder{min-height:40px;border-bottom:1px solid #343741}.visEditorSidebar__nav,.visEditorSidebar__linkedSearch{flex-grow:0}.visEditorSidebar__section{background-color:#1D1E24;padding:8px;border-radius:6px}.visEditorSidebar__section+.visEditorSidebar__section{margin-top:8px}.visEditorSidebar__collapsible{background-color:#25262E}.visEditorSidebar__collapsible--marginBottom{margin-bottom:12px}.visEditorSidebar__formRow{display:flex;align-items:center;margin-top:12px}.visEditorSidebar__formLabel{display:flex;align-items:center;flex:1 1 40%;padding-right:4px}.visEditorSidebar__formControl{display:flex;align-items:center;flex:1 1 60%}.visEditorSidebar__aggGroupAccordionButtonContent{font-size:14px}.visEditorSidebar__aggGroupAccordionButtonContent span{color:#98A2B3}.visEditorSidebar__controls{border-top:1px solid #343741;padding:8px;display:flex;justify-content:flex-end;align-items:center}.visEditorSidebar__controls .visEditorSidebar__autoApplyButton{margin-left:12px}.visEditorAgg__subAgg{border:2px solid #343741;border-radius:6px;background-color:transparent;padding:8px}.visEditorAgg__subAgg+.visEditorAggParam__string{margin-top:16px}.visEditorAggParam--half{margin:16px 0;display:inline-block;width:calc(50% - 4px)}.visEditorAggParam--half-size{margin-left:8px}\n",""]),module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(20),content=__webpack_require__(32);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){(exports=__webpack_require__(21)(!1)).push([module.i,".visEditor--default{flex:1 1 auto;display:flex}.visEditor__collapsibleSidebar{flex-grow:1}.visEditor__collapsibleSidebar-isClosed{min-width:0;width:32px !important}.visEditor__collapsibleSidebar-isClosed .visEditorSidebar{display:none;padding-left:0}.visEditor__collapsibleSidebarButton{position:absolute;right:4px;top:8px}.visEditor__resizer-isHidden{display:none}.visEditor__visualization__wrapper-expanded{width:100% !important}.visEditor__visualization{display:flex;flex:1 1 auto;overflow:hidden}.visEditor__canvas{background-color:#fff;display:flex;flex-direction:row;overflow:auto;flex-shrink:1;flex-basis:100%}.visEditor__canvas.embedded{flex-shrink:1;flex-basis:100%}.visEditor__canvas .visChart{position:relative}@media only screen and (max-width: 574px){.visEditor--default{flex-direction:column}.visEditor__collapsibleSidebar{width:100% !important;flex-grow:0}.visEditor__collapsibleSidebar-isClosed{height:40px !important}.visEditor__resizer{display:none}.visEditor__visualization__wrapper{width:100% !important;flex:1;display:flex;flex-direction:column}}@media only screen and (min-width: 575px) and (max-width: 767px){.visEditor--default{flex-direction:column}.visEditor__collapsibleSidebar{width:100% !important;flex-grow:0}.visEditor__collapsibleSidebar-isClosed{height:40px !important}.visEditor__resizer{display:none}.visEditor__visualization__wrapper{width:100% !important;flex:1;display:flex;flex-direction:column}}@media only screen and (min-width: 768px) and (max-width: 991px){.visEditor--default{flex-direction:column}.visEditor__collapsibleSidebar{width:100% !important;flex-grow:0}.visEditor__collapsibleSidebar-isClosed{height:40px !important}.visEditor__resizer{display:none}.visEditor__visualization__wrapper{width:100% !important;flex:1;display:flex;flex-direction:column}}.visEditorSidebar{height:100%;padding-left:8px}@media only screen and (max-width: 574px){.visEditorSidebar{padding-left:0}}@media only screen and (min-width: 575px) and (max-width: 767px){.visEditorSidebar{padding-left:0}}@media only screen and (min-width: 768px) and (max-width: 991px){.visEditorSidebar{padding-left:0}}.visEditorSidebar__form{flex:1 1 auto;display:flex;flex-direction:column;max-width:100%}.visEditorSidebar__form>*{flex-shrink:0}.visEditorSidebar__config{padding:8px}.visEditorSidebar__config>*{flex-grow:0}@media only screen and (min-width: 992px) and (max-width: 1199px){.visEditorSidebar__config{flex:1 1 1px;display:flex;flex-direction:column;scrollbar-width:thin;overflow:auto}.visEditorSidebar__config>*{flex-shrink:0}.visEditorSidebar__config::-webkit-scrollbar{width:16px;height:16px}.visEditorSidebar__config::-webkit-scrollbar-thumb{background-color:rgba(105,112,125,0.5);border:6px solid rgba(0,0,0,0);background-clip:content-box}.visEditorSidebar__config::-webkit-scrollbar-corner,.visEditorSidebar__config::-webkit-scrollbar-track{background-color:rgba(0,0,0,0)}}@media only screen and (min-width: 1200px){.visEditorSidebar__config{flex:1 1 1px;display:flex;flex-direction:column;scrollbar-width:thin;overflow:auto}.visEditorSidebar__config>*{flex-shrink:0}.visEditorSidebar__config::-webkit-scrollbar{width:16px;height:16px}.visEditorSidebar__config::-webkit-scrollbar-thumb{background-color:rgba(105,112,125,0.5);border:6px solid rgba(0,0,0,0);background-clip:content-box}.visEditorSidebar__config::-webkit-scrollbar-corner,.visEditorSidebar__config::-webkit-scrollbar-track{background-color:rgba(0,0,0,0)}}.visEditorSidebar__config-isHidden{display:none}.visEditorSidebar__titleContainer{padding:8px 32px 8px 8px}.visEditorSidebar__indexPatternPlaceholder{min-height:40px;border-bottom:1px solid #D3DAE6}.visEditorSidebar__nav,.visEditorSidebar__linkedSearch{flex-grow:0}.visEditorSidebar__section{background-color:#fff;padding:8px;border-radius:6px}.visEditorSidebar__section+.visEditorSidebar__section{margin-top:8px}.visEditorSidebar__collapsible{background-color:#fafbfd}.visEditorSidebar__collapsible--marginBottom{margin-bottom:12px}.visEditorSidebar__formRow{display:flex;align-items:center;margin-top:12px}.visEditorSidebar__formLabel{display:flex;align-items:center;flex:1 1 40%;padding-right:4px}.visEditorSidebar__formControl{display:flex;align-items:center;flex:1 1 60%}.visEditorSidebar__aggGroupAccordionButtonContent{font-size:14px}.visEditorSidebar__aggGroupAccordionButtonContent span{color:#69707D}.visEditorSidebar__controls{border-top:1px solid #D3DAE6;padding:8px;display:flex;justify-content:flex-end;align-items:center}.visEditorSidebar__controls .visEditorSidebar__autoApplyButton{margin-left:12px}.visEditorAgg__subAgg{border:2px solid #D3DAE6;border-radius:6px;background-color:transparent;padding:8px}.visEditorAgg__subAgg+.visEditorAggParam__string{margin-top:16px}.visEditorAggParam--half{margin:16px 0;display:inline-block;width:calc(50% - 4px)}.visEditorAggParam--half-size{margin-left:8px}\n",""]),module.exports=exports},function(module,exports){module.exports.id="ace/mode/json_worker",module.exports.src='"no use strict";!function(window){function resolveModuleId(id,paths){for(var testPath=id,tail="";testPath;){var alias=paths[testPath];if("string"==typeof alias)return alias+tail;if(alias)return alias.location.replace(/\\/*$/,"/")+(tail||alias.main||alias.name);if(alias===!1)return"";var i=testPath.lastIndexOf("/");if(-1===i)break;tail=testPath.substr(i)+tail,testPath=testPath.slice(0,i)}return id}if(!(void 0!==window.window&&window.document||window.acequire&&window.define)){window.console||(window.console=function(){var msgs=Array.prototype.slice.call(arguments,0);postMessage({type:"log",data:msgs})},window.console.error=window.console.warn=window.console.log=window.console.trace=window.console),window.window=window,window.ace=window,window.onerror=function(message,file,line,col,err){postMessage({type:"error",data:{message:message,data:err.data,file:file,line:line,col:col,stack:err.stack}})},window.normalizeModule=function(parentId,moduleName){if(-1!==moduleName.indexOf("!")){var chunks=moduleName.split("!");return window.normalizeModule(parentId,chunks[0])+"!"+window.normalizeModule(parentId,chunks[1])}if("."==moduleName.charAt(0)){var base=parentId.split("/").slice(0,-1).join("/");for(moduleName=(base?base+"/":"")+moduleName;-1!==moduleName.indexOf(".")&&previous!=moduleName;){var previous=moduleName;moduleName=moduleName.replace(/^\\.\\//,"").replace(/\\/\\.\\//,"/").replace(/[^\\/]+\\/\\.\\.\\//,"")}}return moduleName},window.acequire=function acequire(parentId,id){if(id||(id=parentId,parentId=null),!id.charAt)throw Error("worker.js acequire() accepts only (parentId, id) as arguments");id=window.normalizeModule(parentId,id);var module=window.acequire.modules[id];if(module)return module.initialized||(module.initialized=!0,module.exports=module.factory().exports),module.exports;if(!window.acequire.tlns)return console.log("unable to load "+id);var path=resolveModuleId(id,window.acequire.tlns);return".js"!=path.slice(-3)&&(path+=".js"),window.acequire.id=id,window.acequire.modules[id]={},importScripts(path),window.acequire(parentId,id)},window.acequire.modules={},window.acequire.tlns={},window.define=function(id,deps,factory){if(2==arguments.length?(factory=deps,"string"!=typeof id&&(deps=id,id=window.acequire.id)):1==arguments.length&&(factory=id,deps=[],id=window.acequire.id),"function"!=typeof factory)return window.acequire.modules[id]={exports:factory,initialized:!0},void 0;deps.length||(deps=["require","exports","module"]);var req=function(childId){return window.acequire(id,childId)};window.acequire.modules[id]={exports:{},factory:function(){var module=this,returnExports=factory.apply(this,deps.map(function(dep){switch(dep){case"require":return req;case"exports":return module.exports;case"module":return module;default:return req(dep)}}));return returnExports&&(module.exports=returnExports),module}}},window.define.amd={},acequire.tlns={},window.initBaseUrls=function(topLevelNamespaces){for(var i in topLevelNamespaces)acequire.tlns[i]=topLevelNamespaces[i]},window.initSender=function(){var EventEmitter=window.acequire("ace/lib/event_emitter").EventEmitter,oop=window.acequire("ace/lib/oop"),Sender=function(){};return function(){oop.implement(this,EventEmitter),this.callback=function(data,callbackId){postMessage({type:"call",id:callbackId,data:data})},this.emit=function(name,data){postMessage({type:"event",name:name,data:data})}}.call(Sender.prototype),new Sender};var main=window.main=null,sender=window.sender=null;window.onmessage=function(e){var msg=e.data;if(msg.event&&sender)sender._signal(msg.event,msg.data);else if(msg.command)if(main[msg.command])main[msg.command].apply(main,msg.args);else{if(!window[msg.command])throw Error("Unknown command:"+msg.command);window[msg.command].apply(window,msg.args)}else if(msg.init){window.initBaseUrls(msg.tlns),acequire("ace/lib/es5-shim"),sender=window.sender=window.initSender();var clazz=acequire(msg.module)[msg.classname];main=window.main=new clazz(sender)}}}}(this),ace.define("ace/lib/oop",["require","exports","module"],function(acequire,exports){"use strict";exports.inherits=function(ctor,superCtor){ctor.super_=superCtor,ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:!1,writable:!0,configurable:!0}})},exports.mixin=function(obj,mixin){for(var key in mixin)obj[key]=mixin[key];return obj},exports.implement=function(proto,mixin){exports.mixin(proto,mixin)}}),ace.define("ace/range",["require","exports","module"],function(acequire,exports){"use strict";var comparePoints=function(p1,p2){return p1.row-p2.row||p1.column-p2.column},Range=function(startRow,startColumn,endRow,endColumn){this.start={row:startRow,column:startColumn},this.end={row:endRow,column:endColumn}};(function(){this.isEqual=function(range){return this.start.row===range.start.row&&this.end.row===range.end.row&&this.start.column===range.start.column&&this.end.column===range.end.column},this.toString=function(){return"Range: ["+this.start.row+"/"+this.start.column+"] -> ["+this.end.row+"/"+this.end.column+"]"},this.contains=function(row,column){return 0==this.compare(row,column)},this.compareRange=function(range){var cmp,end=range.end,start=range.start;return cmp=this.compare(end.row,end.column),1==cmp?(cmp=this.compare(start.row,start.column),1==cmp?2:0==cmp?1:0):-1==cmp?-2:(cmp=this.compare(start.row,start.column),-1==cmp?-1:1==cmp?42:0)},this.comparePoint=function(p){return this.compare(p.row,p.column)},this.containsRange=function(range){return 0==this.comparePoint(range.start)&&0==this.comparePoint(range.end)},this.intersects=function(range){var cmp=this.compareRange(range);return-1==cmp||0==cmp||1==cmp},this.isEnd=function(row,column){return this.end.row==row&&this.end.column==column},this.isStart=function(row,column){return this.start.row==row&&this.start.column==column},this.setStart=function(row,column){"object"==typeof row?(this.start.column=row.column,this.start.row=row.row):(this.start.row=row,this.start.column=column)},this.setEnd=function(row,column){"object"==typeof row?(this.end.column=row.column,this.end.row=row.row):(this.end.row=row,this.end.column=column)},this.inside=function(row,column){return 0==this.compare(row,column)?this.isEnd(row,column)||this.isStart(row,column)?!1:!0:!1},this.insideStart=function(row,column){return 0==this.compare(row,column)?this.isEnd(row,column)?!1:!0:!1},this.insideEnd=function(row,column){return 0==this.compare(row,column)?this.isStart(row,column)?!1:!0:!1},this.compare=function(row,column){return this.isMultiLine()||row!==this.start.row?this.start.row>row?-1:row>this.end.row?1:this.start.row===row?column>=this.start.column?0:-1:this.end.row===row?this.end.column>=column?0:1:0:this.start.column>column?-1:column>this.end.column?1:0},this.compareStart=function(row,column){return this.start.row==row&&this.start.column==column?-1:this.compare(row,column)},this.compareEnd=function(row,column){return this.end.row==row&&this.end.column==column?1:this.compare(row,column)},this.compareInside=function(row,column){return this.end.row==row&&this.end.column==column?1:this.start.row==row&&this.start.column==column?-1:this.compare(row,column)},this.clipRows=function(firstRow,lastRow){if(this.end.row>lastRow)var end={row:lastRow+1,column:0};else if(firstRow>this.end.row)var end={row:firstRow,column:0};if(this.start.row>lastRow)var start={row:lastRow+1,column:0};else if(firstRow>this.start.row)var start={row:firstRow,column:0};return Range.fromPoints(start||this.start,end||this.end)},this.extend=function(row,column){var cmp=this.compare(row,column);if(0==cmp)return this;if(-1==cmp)var start={row:row,column:column};else var end={row:row,column:column};return Range.fromPoints(start||this.start,end||this.end)},this.isEmpty=function(){return this.start.row===this.end.row&&this.start.column===this.end.column},this.isMultiLine=function(){return this.start.row!==this.end.row},this.clone=function(){return Range.fromPoints(this.start,this.end)},this.collapseRows=function(){return 0==this.end.column?new Range(this.start.row,0,Math.max(this.start.row,this.end.row-1),0):new Range(this.start.row,0,this.end.row,0)},this.toScreenRange=function(session){var screenPosStart=session.documentToScreenPosition(this.start),screenPosEnd=session.documentToScreenPosition(this.end);return new Range(screenPosStart.row,screenPosStart.column,screenPosEnd.row,screenPosEnd.column)},this.moveBy=function(row,column){this.start.row+=row,this.start.column+=column,this.end.row+=row,this.end.column+=column}}).call(Range.prototype),Range.fromPoints=function(start,end){return new Range(start.row,start.column,end.row,end.column)},Range.comparePoints=comparePoints,Range.comparePoints=function(p1,p2){return p1.row-p2.row||p1.column-p2.column},exports.Range=Range}),ace.define("ace/apply_delta",["require","exports","module"],function(acequire,exports){"use strict";exports.applyDelta=function(docLines,delta){var row=delta.start.row,startColumn=delta.start.column,line=docLines[row]||"";switch(delta.action){case"insert":var lines=delta.lines;if(1===lines.length)docLines[row]=line.substring(0,startColumn)+delta.lines[0]+line.substring(startColumn);else{var args=[row,1].concat(delta.lines);docLines.splice.apply(docLines,args),docLines[row]=line.substring(0,startColumn)+docLines[row],docLines[row+delta.lines.length-1]+=line.substring(startColumn)}break;case"remove":var endColumn=delta.end.column,endRow=delta.end.row;row===endRow?docLines[row]=line.substring(0,startColumn)+line.substring(endColumn):docLines.splice(row,endRow-row+1,line.substring(0,startColumn)+docLines[endRow].substring(endColumn))}}}),ace.define("ace/lib/event_emitter",["require","exports","module"],function(acequire,exports){"use strict";var EventEmitter={},stopPropagation=function(){this.propagationStopped=!0},preventDefault=function(){this.defaultPrevented=!0};EventEmitter._emit=EventEmitter._dispatchEvent=function(eventName,e){this._eventRegistry||(this._eventRegistry={}),this._defaultHandlers||(this._defaultHandlers={});var listeners=this._eventRegistry[eventName]||[],defaultHandler=this._defaultHandlers[eventName];if(listeners.length||defaultHandler){"object"==typeof e&&e||(e={}),e.type||(e.type=eventName),e.stopPropagation||(e.stopPropagation=stopPropagation),e.preventDefault||(e.preventDefault=preventDefault),listeners=listeners.slice();for(var i=0;listeners.length>i&&(listeners[i](e,this),!e.propagationStopped);i++);return defaultHandler&&!e.defaultPrevented?defaultHandler(e,this):void 0}},EventEmitter._signal=function(eventName,e){var listeners=(this._eventRegistry||{})[eventName];if(listeners){listeners=listeners.slice();for(var i=0;listeners.length>i;i++)listeners[i](e,this)}},EventEmitter.once=function(eventName,callback){var _self=this;callback&&this.addEventListener(eventName,function newCallback(){_self.removeEventListener(eventName,newCallback),callback.apply(null,arguments)})},EventEmitter.setDefaultHandler=function(eventName,callback){var handlers=this._defaultHandlers;if(handlers||(handlers=this._defaultHandlers={_disabled_:{}}),handlers[eventName]){var old=handlers[eventName],disabled=handlers._disabled_[eventName];disabled||(handlers._disabled_[eventName]=disabled=[]),disabled.push(old);var i=disabled.indexOf(callback);-1!=i&&disabled.splice(i,1)}handlers[eventName]=callback},EventEmitter.removeDefaultHandler=function(eventName,callback){var handlers=this._defaultHandlers;if(handlers){var disabled=handlers._disabled_[eventName];if(handlers[eventName]==callback)handlers[eventName],disabled&&this.setDefaultHandler(eventName,disabled.pop());else if(disabled){var i=disabled.indexOf(callback);-1!=i&&disabled.splice(i,1)}}},EventEmitter.on=EventEmitter.addEventListener=function(eventName,callback,capturing){this._eventRegistry=this._eventRegistry||{};var listeners=this._eventRegistry[eventName];return listeners||(listeners=this._eventRegistry[eventName]=[]),-1==listeners.indexOf(callback)&&listeners[capturing?"unshift":"push"](callback),callback},EventEmitter.off=EventEmitter.removeListener=EventEmitter.removeEventListener=function(eventName,callback){this._eventRegistry=this._eventRegistry||{};var listeners=this._eventRegistry[eventName];if(listeners){var index=listeners.indexOf(callback);-1!==index&&listeners.splice(index,1)}},EventEmitter.removeAllListeners=function(eventName){this._eventRegistry&&(this._eventRegistry[eventName]=[])},exports.EventEmitter=EventEmitter}),ace.define("ace/anchor",["require","exports","module","ace/lib/oop","ace/lib/event_emitter"],function(acequire,exports){"use strict";var oop=acequire("./lib/oop"),EventEmitter=acequire("./lib/event_emitter").EventEmitter,Anchor=exports.Anchor=function(doc,row,column){this.$onChange=this.onChange.bind(this),this.attach(doc),column===void 0?this.setPosition(row.row,row.column):this.setPosition(row,column)};(function(){function $pointsInOrder(point1,point2,equalPointsInOrder){var bColIsAfter=equalPointsInOrder?point1.column<=point2.column:point1.column<point2.column;return point1.row<point2.row||point1.row==point2.row&&bColIsAfter}function $getTransformedPoint(delta,point,moveIfEqual){var deltaIsInsert="insert"==delta.action,deltaRowShift=(deltaIsInsert?1:-1)*(delta.end.row-delta.start.row),deltaColShift=(deltaIsInsert?1:-1)*(delta.end.column-delta.start.column),deltaStart=delta.start,deltaEnd=deltaIsInsert?deltaStart:delta.end;return $pointsInOrder(point,deltaStart,moveIfEqual)?{row:point.row,column:point.column}:$pointsInOrder(deltaEnd,point,!moveIfEqual)?{row:point.row+deltaRowShift,column:point.column+(point.row==deltaEnd.row?deltaColShift:0)}:{row:deltaStart.row,column:deltaStart.column}}oop.implement(this,EventEmitter),this.getPosition=function(){return this.$clipPositionToDocument(this.row,this.column)},this.getDocument=function(){return this.document},this.$insertRight=!1,this.onChange=function(delta){if(!(delta.start.row==delta.end.row&&delta.start.row!=this.row||delta.start.row>this.row)){var point=$getTransformedPoint(delta,{row:this.row,column:this.column},this.$insertRight);this.setPosition(point.row,point.column,!0)}},this.setPosition=function(row,column,noClip){var pos;if(pos=noClip?{row:row,column:column}:this.$clipPositionToDocument(row,column),this.row!=pos.row||this.column!=pos.column){var old={row:this.row,column:this.column};this.row=pos.row,this.column=pos.column,this._signal("change",{old:old,value:pos})}},this.detach=function(){this.document.removeEventListener("change",this.$onChange)},this.attach=function(doc){this.document=doc||this.document,this.document.on("change",this.$onChange)},this.$clipPositionToDocument=function(row,column){var pos={};return row>=this.document.getLength()?(pos.row=Math.max(0,this.document.getLength()-1),pos.column=this.document.getLine(pos.row).length):0>row?(pos.row=0,pos.column=0):(pos.row=row,pos.column=Math.min(this.document.getLine(pos.row).length,Math.max(0,column))),0>column&&(pos.column=0),pos}}).call(Anchor.prototype)}),ace.define("ace/document",["require","exports","module","ace/lib/oop","ace/apply_delta","ace/lib/event_emitter","ace/range","ace/anchor"],function(acequire,exports){"use strict";var oop=acequire("./lib/oop"),applyDelta=acequire("./apply_delta").applyDelta,EventEmitter=acequire("./lib/event_emitter").EventEmitter,Range=acequire("./range").Range,Anchor=acequire("./anchor").Anchor,Document=function(textOrLines){this.$lines=[""],0===textOrLines.length?this.$lines=[""]:Array.isArray(textOrLines)?this.insertMergedLines({row:0,column:0},textOrLines):this.insert({row:0,column:0},textOrLines)};(function(){oop.implement(this,EventEmitter),this.setValue=function(text){var len=this.getLength()-1;this.remove(new Range(0,0,len,this.getLine(len).length)),this.insert({row:0,column:0},text)},this.getValue=function(){return this.getAllLines().join(this.getNewLineCharacter())},this.createAnchor=function(row,column){return new Anchor(this,row,column)},this.$split=0==="aaa".split(/a/).length?function(text){return text.replace(/\\r\\n|\\r/g,"\\n").split("\\n")}:function(text){return text.split(/\\r\\n|\\r|\\n/)},this.$detectNewLine=function(text){var match=text.match(/^.*?(\\r\\n|\\r|\\n)/m);this.$autoNewLine=match?match[1]:"\\n",this._signal("changeNewLineMode")},this.getNewLineCharacter=function(){switch(this.$newLineMode){case"windows":return"\\r\\n";case"unix":return"\\n";default:return this.$autoNewLine||"\\n"}},this.$autoNewLine="",this.$newLineMode="auto",this.setNewLineMode=function(newLineMode){this.$newLineMode!==newLineMode&&(this.$newLineMode=newLineMode,this._signal("changeNewLineMode"))},this.getNewLineMode=function(){return this.$newLineMode},this.isNewLine=function(text){return"\\r\\n"==text||"\\r"==text||"\\n"==text},this.getLine=function(row){return this.$lines[row]||""},this.getLines=function(firstRow,lastRow){return this.$lines.slice(firstRow,lastRow+1)},this.getAllLines=function(){return this.getLines(0,this.getLength())},this.getLength=function(){return this.$lines.length},this.getTextRange=function(range){return this.getLinesForRange(range).join(this.getNewLineCharacter())},this.getLinesForRange=function(range){var lines;if(range.start.row===range.end.row)lines=[this.getLine(range.start.row).substring(range.start.column,range.end.column)];else{lines=this.getLines(range.start.row,range.end.row),lines[0]=(lines[0]||"").substring(range.start.column);var l=lines.length-1;range.end.row-range.start.row==l&&(lines[l]=lines[l].substring(0,range.end.column))}return lines},this.insertLines=function(row,lines){return console.warn("Use of document.insertLines is deprecated. Use the insertFullLines method instead."),this.insertFullLines(row,lines)},this.removeLines=function(firstRow,lastRow){return console.warn("Use of document.removeLines is deprecated. Use the removeFullLines method instead."),this.removeFullLines(firstRow,lastRow)},this.insertNewLine=function(position){return console.warn("Use of document.insertNewLine is deprecated. Use insertMergedLines(position, [\'\', \'\']) instead."),this.insertMergedLines(position,["",""])},this.insert=function(position,text){return 1>=this.getLength()&&this.$detectNewLine(text),this.insertMergedLines(position,this.$split(text))},this.insertInLine=function(position,text){var start=this.clippedPos(position.row,position.column),end=this.pos(position.row,position.column+text.length);return this.applyDelta({start:start,end:end,action:"insert",lines:[text]},!0),this.clonePos(end)},this.clippedPos=function(row,column){var length=this.getLength();void 0===row?row=length:0>row?row=0:row>=length&&(row=length-1,column=void 0);var line=this.getLine(row);return void 0==column&&(column=line.length),column=Math.min(Math.max(column,0),line.length),{row:row,column:column}},this.clonePos=function(pos){return{row:pos.row,column:pos.column}},this.pos=function(row,column){return{row:row,column:column}},this.$clipPosition=function(position){var length=this.getLength();return position.row>=length?(position.row=Math.max(0,length-1),position.column=this.getLine(length-1).length):(position.row=Math.max(0,position.row),position.column=Math.min(Math.max(position.column,0),this.getLine(position.row).length)),position},this.insertFullLines=function(row,lines){row=Math.min(Math.max(row,0),this.getLength());var column=0;this.getLength()>row?(lines=lines.concat([""]),column=0):(lines=[""].concat(lines),row--,column=this.$lines[row].length),this.insertMergedLines({row:row,column:column},lines)},this.insertMergedLines=function(position,lines){var start=this.clippedPos(position.row,position.column),end={row:start.row+lines.length-1,column:(1==lines.length?start.column:0)+lines[lines.length-1].length};return this.applyDelta({start:start,end:end,action:"insert",lines:lines}),this.clonePos(end)},this.remove=function(range){var start=this.clippedPos(range.start.row,range.start.column),end=this.clippedPos(range.end.row,range.end.column);return this.applyDelta({start:start,end:end,action:"remove",lines:this.getLinesForRange({start:start,end:end})}),this.clonePos(start)},this.removeInLine=function(row,startColumn,endColumn){var start=this.clippedPos(row,startColumn),end=this.clippedPos(row,endColumn);return this.applyDelta({start:start,end:end,action:"remove",lines:this.getLinesForRange({start:start,end:end})},!0),this.clonePos(start)},this.removeFullLines=function(firstRow,lastRow){firstRow=Math.min(Math.max(0,firstRow),this.getLength()-1),lastRow=Math.min(Math.max(0,lastRow),this.getLength()-1);var deleteFirstNewLine=lastRow==this.getLength()-1&&firstRow>0,deleteLastNewLine=this.getLength()-1>lastRow,startRow=deleteFirstNewLine?firstRow-1:firstRow,startCol=deleteFirstNewLine?this.getLine(startRow).length:0,endRow=deleteLastNewLine?lastRow+1:lastRow,endCol=deleteLastNewLine?0:this.getLine(endRow).length,range=new Range(startRow,startCol,endRow,endCol),deletedLines=this.$lines.slice(firstRow,lastRow+1);return this.applyDelta({start:range.start,end:range.end,action:"remove",lines:this.getLinesForRange(range)}),deletedLines},this.removeNewLine=function(row){this.getLength()-1>row&&row>=0&&this.applyDelta({start:this.pos(row,this.getLine(row).length),end:this.pos(row+1,0),action:"remove",lines:["",""]})},this.replace=function(range,text){if(range instanceof Range||(range=Range.fromPoints(range.start,range.end)),0===text.length&&range.isEmpty())return range.start;if(text==this.getTextRange(range))return range.end;this.remove(range);var end;return end=text?this.insert(range.start,text):range.start},this.applyDeltas=function(deltas){for(var i=0;deltas.length>i;i++)this.applyDelta(deltas[i])},this.revertDeltas=function(deltas){for(var i=deltas.length-1;i>=0;i--)this.revertDelta(deltas[i])},this.applyDelta=function(delta,doNotValidate){var isInsert="insert"==delta.action;(isInsert?1>=delta.lines.length&&!delta.lines[0]:!Range.comparePoints(delta.start,delta.end))||(isInsert&&delta.lines.length>2e4&&this.$splitAndapplyLargeDelta(delta,2e4),applyDelta(this.$lines,delta,doNotValidate),this._signal("change",delta))},this.$splitAndapplyLargeDelta=function(delta,MAX){for(var lines=delta.lines,l=lines.length,row=delta.start.row,column=delta.start.column,from=0,to=0;;){from=to,to+=MAX-1;var chunk=lines.slice(from,to);if(to>l){delta.lines=chunk,delta.start.row=row+from,delta.start.column=column;break}chunk.push(""),this.applyDelta({start:this.pos(row+from,column),end:this.pos(row+to,column=0),action:delta.action,lines:chunk},!0)}},this.revertDelta=function(delta){this.applyDelta({start:this.clonePos(delta.start),end:this.clonePos(delta.end),action:"insert"==delta.action?"remove":"insert",lines:delta.lines.slice()})},this.indexToPosition=function(index,startRow){for(var lines=this.$lines||this.getAllLines(),newlineLength=this.getNewLineCharacter().length,i=startRow||0,l=lines.length;l>i;i++)if(index-=lines[i].length+newlineLength,0>index)return{row:i,column:index+lines[i].length+newlineLength};return{row:l-1,column:lines[l-1].length}},this.positionToIndex=function(pos,startRow){for(var lines=this.$lines||this.getAllLines(),newlineLength=this.getNewLineCharacter().length,index=0,row=Math.min(pos.row,lines.length),i=startRow||0;row>i;++i)index+=lines[i].length+newlineLength;return index+pos.column}}).call(Document.prototype),exports.Document=Document}),ace.define("ace/lib/lang",["require","exports","module"],function(acequire,exports){"use strict";exports.last=function(a){return a[a.length-1]},exports.stringReverse=function(string){return string.split("").reverse().join("")},exports.stringRepeat=function(string,count){for(var result="";count>0;)1&count&&(result+=string),(count>>=1)&&(string+=string);return result};var trimBeginRegexp=/^\\s\\s*/,trimEndRegexp=/\\s\\s*$/;exports.stringTrimLeft=function(string){return string.replace(trimBeginRegexp,"")},exports.stringTrimRight=function(string){return string.replace(trimEndRegexp,"")},exports.copyObject=function(obj){var copy={};for(var key in obj)copy[key]=obj[key];return copy},exports.copyArray=function(array){for(var copy=[],i=0,l=array.length;l>i;i++)copy[i]=array[i]&&"object"==typeof array[i]?this.copyObject(array[i]):array[i];return copy},exports.deepCopy=function deepCopy(obj){if("object"!=typeof obj||!obj)return obj;var copy;if(Array.isArray(obj)){copy=[];for(var key=0;obj.length>key;key++)copy[key]=deepCopy(obj[key]);return copy}if("[object Object]"!==Object.prototype.toString.call(obj))return obj;copy={};for(var key in obj)copy[key]=deepCopy(obj[key]);return copy},exports.arrayToMap=function(arr){for(var map={},i=0;arr.length>i;i++)map[arr[i]]=1;return map},exports.createMap=function(props){var map=Object.create(null);for(var i in props)map[i]=props[i];return map},exports.arrayRemove=function(array,value){for(var i=0;array.length>=i;i++)value===array[i]&&array.splice(i,1)},exports.escapeRegExp=function(str){return str.replace(/([.*+?^${}()|[\\]\\/\\\\])/g,"\\\\$1")},exports.escapeHTML=function(str){return str.replace(/&/g,"&#38;").replace(/"/g,"&#34;").replace(/\'/g,"&#39;").replace(/</g,"&#60;")},exports.getMatchOffsets=function(string,regExp){var matches=[];return string.replace(regExp,function(str){matches.push({offset:arguments[arguments.length-2],length:str.length})}),matches},exports.deferredCall=function(fcn){var timer=null,callback=function(){timer=null,fcn()},deferred=function(timeout){return deferred.cancel(),timer=setTimeout(callback,timeout||0),deferred};return deferred.schedule=deferred,deferred.call=function(){return this.cancel(),fcn(),deferred},deferred.cancel=function(){return clearTimeout(timer),timer=null,deferred},deferred.isPending=function(){return timer},deferred},exports.delayedCall=function(fcn,defaultTimeout){var timer=null,callback=function(){timer=null,fcn()},_self=function(timeout){null==timer&&(timer=setTimeout(callback,timeout||defaultTimeout))};return _self.delay=function(timeout){timer&&clearTimeout(timer),timer=setTimeout(callback,timeout||defaultTimeout)},_self.schedule=_self,_self.call=function(){this.cancel(),fcn()},_self.cancel=function(){timer&&clearTimeout(timer),timer=null},_self.isPending=function(){return timer},_self}}),ace.define("ace/worker/mirror",["require","exports","module","ace/range","ace/document","ace/lib/lang"],function(acequire,exports){"use strict";acequire("../range").Range;var Document=acequire("../document").Document,lang=acequire("../lib/lang"),Mirror=exports.Mirror=function(sender){this.sender=sender;var doc=this.doc=new Document(""),deferredUpdate=this.deferredUpdate=lang.delayedCall(this.onUpdate.bind(this)),_self=this;sender.on("change",function(e){var data=e.data;if(data[0].start)doc.applyDeltas(data);else for(var i=0;data.length>i;i+=2){if(Array.isArray(data[i+1]))var d={action:"insert",start:data[i],lines:data[i+1]};else var d={action:"remove",start:data[i],end:data[i+1]};doc.applyDelta(d,!0)}return _self.$timeout?deferredUpdate.schedule(_self.$timeout):(_self.onUpdate(),void 0)})};(function(){this.$timeout=500,this.setTimeout=function(timeout){this.$timeout=timeout},this.setValue=function(value){this.doc.setValue(value),this.deferredUpdate.schedule(this.$timeout)},this.getValue=function(callbackId){this.sender.callback(this.doc.getValue(),callbackId)},this.onUpdate=function(){},this.isPending=function(){return this.deferredUpdate.isPending()}}).call(Mirror.prototype)}),ace.define("ace/mode/json/json_parse",["require","exports","module"],function(){"use strict";var at,ch,text,value,escapee={\'"\':\'"\',"\\\\":"\\\\","/":"/",b:"\\b",f:"\\f",n:"\\n",r:"\\r",t:"\t"},error=function(m){throw{name:"SyntaxError",message:m,at:at,text:text}},next=function(c){return c&&c!==ch&&error("Expected \'"+c+"\' instead of \'"+ch+"\'"),ch=text.charAt(at),at+=1,ch},number=function(){var number,string="";for("-"===ch&&(string="-",next("-"));ch>="0"&&"9">=ch;)string+=ch,next();if("."===ch)for(string+=".";next()&&ch>="0"&&"9">=ch;)string+=ch;if("e"===ch||"E"===ch)for(string+=ch,next(),("-"===ch||"+"===ch)&&(string+=ch,next());ch>="0"&&"9">=ch;)string+=ch,next();return number=+string,isNaN(number)?(error("Bad number"),void 0):number},string=function(){var hex,i,uffff,string="";if(\'"\'===ch)for(;next();){if(\'"\'===ch)return next(),string;if("\\\\"===ch)if(next(),"u"===ch){for(uffff=0,i=0;4>i&&(hex=parseInt(next(),16),isFinite(hex));i+=1)uffff=16*uffff+hex;string+=String.fromCharCode(uffff)}else{if("string"!=typeof escapee[ch])break;string+=escapee[ch]}else string+=ch}error("Bad string")},white=function(){for(;ch&&" ">=ch;)next()},word=function(){switch(ch){case"t":return next("t"),next("r"),next("u"),next("e"),!0;case"f":return next("f"),next("a"),next("l"),next("s"),next("e"),!1;case"n":return next("n"),next("u"),next("l"),next("l"),null}error("Unexpected \'"+ch+"\'")},array=function(){var array=[];if("["===ch){if(next("["),white(),"]"===ch)return next("]"),array;for(;ch;){if(array.push(value()),white(),"]"===ch)return next("]"),array;next(","),white()}}error("Bad array")},object=function(){var key,object={};if("{"===ch){if(next("{"),white(),"}"===ch)return next("}"),object;for(;ch;){if(key=string(),white(),next(":"),Object.hasOwnProperty.call(object,key)&&error(\'Duplicate key "\'+key+\'"\'),object[key]=value(),white(),"}"===ch)return next("}"),object;next(","),white()}}error("Bad object")};return value=function(){switch(white(),ch){case"{":return object();case"[":return array();case\'"\':return string();case"-":return number();default:return ch>="0"&&"9">=ch?number():word()}},function(source,reviver){var result;return text=source,at=0,ch=" ",result=value(),white(),ch&&error("Syntax error"),"function"==typeof reviver?function walk(holder,key){var k,v,value=holder[key];if(value&&"object"==typeof value)for(k in value)Object.hasOwnProperty.call(value,k)&&(v=walk(value,k),void 0!==v?value[k]=v:delete value[k]);return reviver.call(holder,key,value)}({"":result},""):result}}),ace.define("ace/mode/json_worker",["require","exports","module","ace/lib/oop","ace/worker/mirror","ace/mode/json/json_parse"],function(acequire,exports){"use strict";var oop=acequire("../lib/oop"),Mirror=acequire("../worker/mirror").Mirror,parse=acequire("./json/json_parse"),JsonWorker=exports.JsonWorker=function(sender){Mirror.call(this,sender),this.setTimeout(200)};oop.inherits(JsonWorker,Mirror),function(){this.onUpdate=function(){var value=this.doc.getValue(),errors=[];try{value&&parse(value)}catch(e){var pos=this.doc.indexToPosition(e.at-1);errors.push({row:pos.row,column:pos.column,text:e.message,type:"error"})}this.sender.emit("annotate",errors)}}.call(JsonWorker.prototype)}),ace.define("ace/lib/es5-shim",["require","exports","module"],function(){function Empty(){}function doesDefinePropertyWork(object){try{return Object.defineProperty(object,"sentinel",{}),"sentinel"in object}catch(exception){}}function toInteger(n){return n=+n,n!==n?n=0:0!==n&&n!==1/0&&n!==-(1/0)&&(n=(n>0||-1)*Math.floor(Math.abs(n))),n}Function.prototype.bind||(Function.prototype.bind=function(that){var target=this;if("function"!=typeof target)throw new TypeError("Function.prototype.bind called on incompatible "+target);var args=slice.call(arguments,1),bound=function(){if(this instanceof bound){var result=target.apply(this,args.concat(slice.call(arguments)));return Object(result)===result?result:this}return target.apply(that,args.concat(slice.call(arguments)))};return target.prototype&&(Empty.prototype=target.prototype,bound.prototype=new Empty,Empty.prototype=null),bound});var defineGetter,defineSetter,lookupGetter,lookupSetter,supportsAccessors,call=Function.prototype.call,prototypeOfArray=Array.prototype,prototypeOfObject=Object.prototype,slice=prototypeOfArray.slice,_toString=call.bind(prototypeOfObject.toString),owns=call.bind(prototypeOfObject.hasOwnProperty);if((supportsAccessors=owns(prototypeOfObject,"__defineGetter__"))&&(defineGetter=call.bind(prototypeOfObject.__defineGetter__),defineSetter=call.bind(prototypeOfObject.__defineSetter__),lookupGetter=call.bind(prototypeOfObject.__lookupGetter__),lookupSetter=call.bind(prototypeOfObject.__lookupSetter__)),2!=[1,2].splice(0).length)if(function(){function makeArray(l){var a=Array(l+2);return a[0]=a[1]=0,a}var lengthBefore,array=[];return array.splice.apply(array,makeArray(20)),array.splice.apply(array,makeArray(26)),lengthBefore=array.length,array.splice(5,0,"XXX"),lengthBefore+1==array.length,lengthBefore+1==array.length?!0:void 0\n}()){var array_splice=Array.prototype.splice;Array.prototype.splice=function(start,deleteCount){return arguments.length?array_splice.apply(this,[void 0===start?0:start,void 0===deleteCount?this.length-start:deleteCount].concat(slice.call(arguments,2))):[]}}else Array.prototype.splice=function(pos,removeCount){var length=this.length;pos>0?pos>length&&(pos=length):void 0==pos?pos=0:0>pos&&(pos=Math.max(length+pos,0)),length>pos+removeCount||(removeCount=length-pos);var removed=this.slice(pos,pos+removeCount),insert=slice.call(arguments,2),add=insert.length;if(pos===length)add&&this.push.apply(this,insert);else{var remove=Math.min(removeCount,length-pos),tailOldPos=pos+remove,tailNewPos=tailOldPos+add-remove,tailCount=length-tailOldPos,lengthAfterRemove=length-remove;if(tailOldPos>tailNewPos)for(var i=0;tailCount>i;++i)this[tailNewPos+i]=this[tailOldPos+i];else if(tailNewPos>tailOldPos)for(i=tailCount;i--;)this[tailNewPos+i]=this[tailOldPos+i];if(add&&pos===lengthAfterRemove)this.length=lengthAfterRemove,this.push.apply(this,insert);else for(this.length=lengthAfterRemove+add,i=0;add>i;++i)this[pos+i]=insert[i]}return removed};Array.isArray||(Array.isArray=function(obj){return"[object Array]"==_toString(obj)});var boxedString=Object("a"),splitString="a"!=boxedString[0]||!(0 in boxedString);if(Array.prototype.forEach||(Array.prototype.forEach=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,thisp=arguments[1],i=-1,length=self.length>>>0;if("[object Function]"!=_toString(fun))throw new TypeError;for(;length>++i;)i in self&&fun.call(thisp,self[i],i,object)}),Array.prototype.map||(Array.prototype.map=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0,result=Array(length),thisp=arguments[1];if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");for(var i=0;length>i;i++)i in self&&(result[i]=fun.call(thisp,self[i],i,object));return result}),Array.prototype.filter||(Array.prototype.filter=function(fun){var value,object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0,result=[],thisp=arguments[1];if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");for(var i=0;length>i;i++)i in self&&(value=self[i],fun.call(thisp,value,i,object)&&result.push(value));return result}),Array.prototype.every||(Array.prototype.every=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0,thisp=arguments[1];if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");for(var i=0;length>i;i++)if(i in self&&!fun.call(thisp,self[i],i,object))return!1;return!0}),Array.prototype.some||(Array.prototype.some=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0,thisp=arguments[1];if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");for(var i=0;length>i;i++)if(i in self&&fun.call(thisp,self[i],i,object))return!0;return!1}),Array.prototype.reduce||(Array.prototype.reduce=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0;if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");if(!length&&1==arguments.length)throw new TypeError("reduce of empty array with no initial value");var result,i=0;if(arguments.length>=2)result=arguments[1];else for(;;){if(i in self){result=self[i++];break}if(++i>=length)throw new TypeError("reduce of empty array with no initial value")}for(;length>i;i++)i in self&&(result=fun.call(void 0,result,self[i],i,object));return result}),Array.prototype.reduceRight||(Array.prototype.reduceRight=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0;if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");if(!length&&1==arguments.length)throw new TypeError("reduceRight of empty array with no initial value");var result,i=length-1;if(arguments.length>=2)result=arguments[1];else for(;;){if(i in self){result=self[i--];break}if(0>--i)throw new TypeError("reduceRight of empty array with no initial value")}do i in this&&(result=fun.call(void 0,result,self[i],i,object));while(i--);return result}),Array.prototype.indexOf&&-1==[0,1].indexOf(1,2)||(Array.prototype.indexOf=function(sought){var self=splitString&&"[object String]"==_toString(this)?this.split(""):toObject(this),length=self.length>>>0;if(!length)return-1;var i=0;for(arguments.length>1&&(i=toInteger(arguments[1])),i=i>=0?i:Math.max(0,length+i);length>i;i++)if(i in self&&self[i]===sought)return i;return-1}),Array.prototype.lastIndexOf&&-1==[0,1].lastIndexOf(0,-3)||(Array.prototype.lastIndexOf=function(sought){var self=splitString&&"[object String]"==_toString(this)?this.split(""):toObject(this),length=self.length>>>0;if(!length)return-1;var i=length-1;for(arguments.length>1&&(i=Math.min(i,toInteger(arguments[1]))),i=i>=0?i:length-Math.abs(i);i>=0;i--)if(i in self&&sought===self[i])return i;return-1}),Object.getPrototypeOf||(Object.getPrototypeOf=function(object){return object.__proto__||(object.constructor?object.constructor.prototype:prototypeOfObject)}),!Object.getOwnPropertyDescriptor){var ERR_NON_OBJECT="Object.getOwnPropertyDescriptor called on a non-object: ";Object.getOwnPropertyDescriptor=function(object,property){if("object"!=typeof object&&"function"!=typeof object||null===object)throw new TypeError(ERR_NON_OBJECT+object);if(owns(object,property)){var descriptor,getter,setter;if(descriptor={enumerable:!0,configurable:!0},supportsAccessors){var prototype=object.__proto__;object.__proto__=prototypeOfObject;var getter=lookupGetter(object,property),setter=lookupSetter(object,property);if(object.__proto__=prototype,getter||setter)return getter&&(descriptor.get=getter),setter&&(descriptor.set=setter),descriptor}return descriptor.value=object[property],descriptor}}}if(Object.getOwnPropertyNames||(Object.getOwnPropertyNames=function(object){return Object.keys(object)}),!Object.create){var createEmpty;createEmpty=null===Object.prototype.__proto__?function(){return{__proto__:null}}:function(){var empty={};for(var i in empty)empty[i]=null;return empty.constructor=empty.hasOwnProperty=empty.propertyIsEnumerable=empty.isPrototypeOf=empty.toLocaleString=empty.toString=empty.valueOf=empty.__proto__=null,empty},Object.create=function(prototype,properties){var object;if(null===prototype)object=createEmpty();else{if("object"!=typeof prototype)throw new TypeError("typeof prototype["+typeof prototype+"] != \'object\'");var Type=function(){};Type.prototype=prototype,object=new Type,object.__proto__=prototype}return void 0!==properties&&Object.defineProperties(object,properties),object}}if(Object.defineProperty){var definePropertyWorksOnObject=doesDefinePropertyWork({}),definePropertyWorksOnDom="undefined"==typeof document||doesDefinePropertyWork(document.createElement("div"));if(!definePropertyWorksOnObject||!definePropertyWorksOnDom)var definePropertyFallback=Object.defineProperty}if(!Object.defineProperty||definePropertyFallback){var ERR_NON_OBJECT_DESCRIPTOR="Property description must be an object: ",ERR_NON_OBJECT_TARGET="Object.defineProperty called on non-object: ",ERR_ACCESSORS_NOT_SUPPORTED="getters & setters can not be defined on this javascript engine";Object.defineProperty=function(object,property,descriptor){if("object"!=typeof object&&"function"!=typeof object||null===object)throw new TypeError(ERR_NON_OBJECT_TARGET+object);if("object"!=typeof descriptor&&"function"!=typeof descriptor||null===descriptor)throw new TypeError(ERR_NON_OBJECT_DESCRIPTOR+descriptor);if(definePropertyFallback)try{return definePropertyFallback.call(Object,object,property,descriptor)}catch(exception){}if(owns(descriptor,"value"))if(supportsAccessors&&(lookupGetter(object,property)||lookupSetter(object,property))){var prototype=object.__proto__;object.__proto__=prototypeOfObject,delete object[property],object[property]=descriptor.value,object.__proto__=prototype}else object[property]=descriptor.value;else{if(!supportsAccessors)throw new TypeError(ERR_ACCESSORS_NOT_SUPPORTED);owns(descriptor,"get")&&defineGetter(object,property,descriptor.get),owns(descriptor,"set")&&defineSetter(object,property,descriptor.set)}return object}}Object.defineProperties||(Object.defineProperties=function(object,properties){for(var property in properties)owns(properties,property)&&Object.defineProperty(object,property,properties[property]);return object}),Object.seal||(Object.seal=function(object){return object}),Object.freeze||(Object.freeze=function(object){return object});try{Object.freeze(function(){})}catch(exception){Object.freeze=function(freezeObject){return function(object){return"function"==typeof object?object:freezeObject(object)}}(Object.freeze)}if(Object.preventExtensions||(Object.preventExtensions=function(object){return object}),Object.isSealed||(Object.isSealed=function(){return!1}),Object.isFrozen||(Object.isFrozen=function(){return!1}),Object.isExtensible||(Object.isExtensible=function(object){if(Object(object)===object)throw new TypeError;for(var name="";owns(object,name);)name+="?";object[name]=!0;var returnValue=owns(object,name);return delete object[name],returnValue}),!Object.keys){var hasDontEnumBug=!0,dontEnums=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],dontEnumsLength=dontEnums.length;for(var key in{toString:null})hasDontEnumBug=!1;Object.keys=function(object){if("object"!=typeof object&&"function"!=typeof object||null===object)throw new TypeError("Object.keys called on a non-object");var keys=[];for(var name in object)owns(object,name)&&keys.push(name);if(hasDontEnumBug)for(var i=0,ii=dontEnumsLength;ii>i;i++){var dontEnum=dontEnums[i];owns(object,dontEnum)&&keys.push(dontEnum)}return keys}}Date.now||(Date.now=function(){return(new Date).getTime()});var ws="\t\\n\v\\f\\r   ᠎             　\\u2028\\u2029\ufeff";if(!String.prototype.trim||ws.trim()){ws="["+ws+"]";var trimBeginRegexp=RegExp("^"+ws+ws+"*"),trimEndRegexp=RegExp(ws+ws+"*$");String.prototype.trim=function(){return(this+"").replace(trimBeginRegexp,"").replace(trimEndRegexp,"")}}var toObject=function(o){if(null==o)throw new TypeError("can\'t convert "+o+" to object");return Object(o)}});'},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var tslib_1=__webpack_require__(15),react_1=__webpack_require__(0),useTimeoutFn_1=tslib_1.__importDefault(__webpack_require__(35));exports.default=function(fn,ms,deps){void 0===ms&&(ms=0),void 0===deps&&(deps=[]);var _a=useTimeoutFn_1.default(fn,ms),isReady=_a[0],cancel=_a[1],reset=_a[2];return react_1.useEffect(reset,deps),[isReady,cancel]}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var react_1=__webpack_require__(0);exports.default=function(fn,ms){void 0===ms&&(ms=0);var ready=react_1.useRef(!1),timeout=react_1.useRef(),callback=react_1.useRef(fn),isReady=react_1.useCallback((function(){return ready.current}),[]),set=react_1.useCallback((function(){ready.current=!1,timeout.current&&clearTimeout(timeout.current),timeout.current=setTimeout((function(){ready.current=!0,callback.current()}),ms)}),[ms]),clear=react_1.useCallback((function(){ready.current=null,timeout.current&&clearTimeout(timeout.current)}),[]);return react_1.useEffect((function(){callback.current=fn}),[fn]),react_1.useEffect((function(){return set(),clear}),[ms]),[isReady,clear,set]}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.parse=exports.unitsAsc=exports.unitsDesc=exports.units=exports.unitsMap=void 0;const moment_1=__webpack_require__(15).__importDefault(__webpack_require__(17));exports.unitsMap={ms:{weight:1,type:"fixed",base:1},s:{weight:2,type:"fixed",base:1e3},m:{weight:3,type:"mixed",base:6e4},h:{weight:4,type:"mixed",base:36e5},d:{weight:5,type:"mixed",base:864e5},w:{weight:6,type:"calendar",base:NaN},M:{weight:7,type:"calendar",base:NaN},y:{weight:9,type:"calendar",base:NaN}},exports.units=Object.keys(exports.unitsMap).sort((a,b)=>exports.unitsMap[b].weight-exports.unitsMap[a].weight),exports.unitsDesc=[...exports.units],exports.unitsAsc=[...exports.units].reverse();const isDate=d=>"[object Date]"===Object.prototype.toString.call(d);function parse(input,options={}){const text=input,{roundUp:roundUp=!1,momentInstance:momentInstance=moment_1.default,forceNow:forceNow}=options;if(!text)return;if(momentInstance.isMoment(text))return text;if(isDate(text))return momentInstance(text);if(void 0!==forceNow&&(!isDate(d=forceNow)||isNaN(d.valueOf())))throw new Error("forceNow must be a valid Date");var d;let time,index,parseString,mathString="";return"now"===text.substring(0,3)?(time=momentInstance(forceNow),mathString=text.substring("now".length)):(index=text.indexOf("||"),-1===index?(parseString=text,mathString=""):(parseString=text.substring(0,index),mathString=text.substring(index+2)),time=momentInstance(parseString)),mathString.length?function(mathString,time,roundUp){const dateTime=time,len=mathString.length;let i=0;for(;i<len;){const c=mathString.charAt(i++);let type,num,unit;if("/"===c)type=0;else if("+"===c)type=1;else{if("-"!==c)return;type=2}if(isNaN(mathString.charAt(i)))num=1;else if(2===mathString.length)num=mathString.charAt(i);else{const numFrom=i;for(;!isNaN(mathString.charAt(i));)if(i++,i>=len)return;num=parseInt(mathString.substring(numFrom,i),10)}if(0===type&&1!==num)return;unit=mathString.charAt(i++);for(let j=i;j<len;j++){const unitChar=mathString.charAt(i);if(!/[a-z]/i.test(unitChar))break;unit+=unitChar,i++}if(-1===exports.units.indexOf(unit))return;0===type?roundUp?dateTime.endOf(unit):dateTime.startOf(unit):1===type?dateTime.add(num,unit):2===type&&dateTime.subtract(num,unit)}return dateTime}(mathString,time,roundUp):time}exports.parse=parse,exports.default={parse:parse,unitsMap:Object.freeze(exports.unitsMap),units:Object.freeze(exports.units),unitsAsc:Object.freeze(exports.unitsAsc),unitsDesc:Object.freeze(exports.unitsDesc)}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var tslib_1=__webpack_require__(15),react_1=__webpack_require__(0),useEffectOnce_1=tslib_1.__importDefault(__webpack_require__(23));exports.default=function(fn){var fnRef=react_1.useRef(fn);fnRef.current=fn,useEffectOnce_1.default((function(){return function(){return fnRef.current()}}))}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"default",(function(){return DefaultEditor}));__webpack_require__(24),__webpack_require__(22);var external_kbnSharedDeps_React_=__webpack_require__(0),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),external_kbnSharedDeps_ElasticEui_=__webpack_require__(1),public_=__webpack_require__(8),kibanaUtils_public_=__webpack_require__(16),external_kbnSharedDeps_Lodash_=__webpack_require__(4),external_kbnSharedDeps_KbnI18n_=__webpack_require__(2);function DefaultEditorNavBar({setSelectedTab:setSelectedTab,optionTabs:optionTabs}){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTabs,{className:"visEditorSidebar__nav",size:"s"},optionTabs.map(({name:name,title:title,isSelected:isSelected=!1})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTab,{key:name,isSelected:isSelected,"data-test-subj":"visEditorTab__"+name,onClick:()=>setSelectedTab(name)},title)))}var external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(3),useDebounce=__webpack_require__(34),useDebounce_default=__webpack_require__.n(useDebounce),data_public_=__webpack_require__(7);let EditorStateActionTypes;!function(EditorStateActionTypes){EditorStateActionTypes.ADD_NEW_AGG="ADD_NEW_AGG",EditorStateActionTypes.DISCARD_CHANGES="DISCARD_CHANGES",EditorStateActionTypes.CHANGE_AGG_TYPE="CHANGE_AGG_TYPE",EditorStateActionTypes.SET_AGG_PARAM_VALUE="SET_AGG_PARAM_VALUE",EditorStateActionTypes.SET_STATE_PARAM_VALUE="SET_STATE_PARAM_VALUE",EditorStateActionTypes.TOGGLE_ENABLED_AGG="TOGGLE_ENABLED_AGG",EditorStateActionTypes.REMOVE_AGG="REMOVE_AGG",EditorStateActionTypes.REORDER_AGGS="REORDER_AGGS",EditorStateActionTypes.UPDATE_STATE_PARAMS="UPDATE_STATE_PARAMS"}(EditorStateActionTypes||(EditorStateActionTypes={}));const getSchemaByName=(schemas,schemaName)=>schemas.find(s=>s.name===schemaName)||{},isAggRemovable=(agg,group,schemas)=>{const schema=getSchemaByName(schemas,agg.schema);return group.reduce((count,aggregation)=>aggregation.schema===agg.schema?++count:count,0)>schema.min},getEnabledMetricAggsCount=group=>group.reduce((count,aggregation)=>"metric"===aggregation.schema&&aggregation.enabled?++count:count,0),calcAggIsTooLow=(agg,aggIndex,group,schemas)=>{if(!getSchemaByName(schemas,agg.schema).mustBeFirst)return!1;const firstDifferentSchema=Object(external_kbnSharedDeps_Lodash_.findIndex)(group,aggr=>aggr.schema!==agg.schema);return-1!==firstDifferentSchema&&aggIndex>firstDifferentSchema};function initEditorState(vis){return{...vis.clone()}}const initialFormState={validity:{},touched:!1,invalid:!1};const discardChanges=vis=>({type:EditorStateActionTypes.DISCARD_CHANGES,payload:vis});function useEditorReducer(vis,eventEmitter){const{services:services}=Object(public_.useKibana)(),[state,dispatch]=Object(external_kbnSharedDeps_React_.useReducer)((({aggs:{createAggConfigs:createAggConfigs}})=>(state,action)=>{switch(action.type){case EditorStateActionTypes.ADD_NEW_AGG:{const{schema:schema}=action.payload,defaultConfig=!state.data.aggs.aggs.find(agg=>agg.schema===schema.name)&&schema.defaults?schema.defaults.slice(0,schema.max):{schema:schema.name},aggConfig=state.data.aggs.createAggConfig(defaultConfig,{addToAggConfigs:!1});aggConfig.brandNew=!0;const newAggs=[...state.data.aggs.aggs,aggConfig];return{...state,data:{...state.data,aggs:createAggConfigs(state.data.indexPattern,newAggs)}}}case EditorStateActionTypes.DISCARD_CHANGES:return initEditorState(action.payload);case EditorStateActionTypes.CHANGE_AGG_TYPE:{const{aggId:aggId,value:value}=action.payload,newAggs=state.data.aggs.aggs.map(agg=>agg.id===aggId?(agg.type=value,agg.toJSON()):agg);return{...state,data:{...state.data,aggs:createAggConfigs(state.data.indexPattern,newAggs)}}}case EditorStateActionTypes.SET_AGG_PARAM_VALUE:{const{aggId:aggId,paramName:paramName,value:value}=action.payload,newAggs=state.data.aggs.aggs.map(agg=>{if(agg.id===aggId){const parsedAgg=agg.toJSON();return{...parsedAgg,params:{...parsedAgg.params,[paramName]:value}}}return agg});return{...state,data:{...state.data,aggs:createAggConfigs(state.data.indexPattern,newAggs)}}}case EditorStateActionTypes.SET_STATE_PARAM_VALUE:{const{paramName:paramName,value:value}=action.payload;return{...state,params:{...state.params,[paramName]:value}}}case EditorStateActionTypes.REMOVE_AGG:{let isMetric=!1;const newAggs=state.data.aggs.aggs.filter(({id:id,schema:schema})=>{if(id===action.payload.aggId){const schemaDef=action.payload.schemas.find(s=>s.name===schema);return schemaDef&&schemaDef.group===data_public_.AggGroupNames.Metrics&&(isMetric=!0),!1}return!0});if(isMetric&&0===getEnabledMetricAggsCount(newAggs)){const aggToEnable=newAggs.find(agg=>"metric"===agg.schema);aggToEnable&&(aggToEnable.enabled=!0)}return{...state,data:{...state.data,aggs:createAggConfigs(state.data.indexPattern,newAggs)}}}case EditorStateActionTypes.REORDER_AGGS:{const{sourceAgg:sourceAgg,destinationAgg:destinationAgg}=action.payload,destinationIndex=state.data.aggs.aggs.indexOf(destinationAgg),newAggs=[...state.data.aggs.aggs];return newAggs.splice(destinationIndex,0,newAggs.splice(state.data.aggs.aggs.indexOf(sourceAgg),1)[0]),{...state,data:{...state.data,aggs:createAggConfigs(state.data.indexPattern,newAggs)}}}case EditorStateActionTypes.TOGGLE_ENABLED_AGG:{const{aggId:aggId,enabled:enabled}=action.payload,newAggs=state.data.aggs.aggs.map(agg=>{if(agg.id===aggId){return{...agg.toJSON(),enabled:enabled}}return agg});return{...state,data:{...state.data,aggs:createAggConfigs(state.data.indexPattern,newAggs)}}}case EditorStateActionTypes.UPDATE_STATE_PARAMS:{const{params:params}=action.payload;return{...state,params:Object(external_kbnSharedDeps_Lodash_.cloneDeep)(params)}}}})(services.data.search),vis,initEditorState);return[state,Object(external_kbnSharedDeps_React_.useCallback)(action=>{dispatch(action),eventEmitter.emit("dirtyStateChange",{isDirty:action.type!==EditorStateActionTypes.DISCARD_CHANGES})},[eventEmitter])]}function DefaultEditorControls({applyChanges:applyChanges,isDirty:isDirty,isInvalid:isInvalid,isTouched:isTouched,dispatch:dispatch,vis:vis}){const{enableAutoApply:enableAutoApply}=vis.type.editorConfig,[autoApplyEnabled,setAutoApplyEnabled]=Object(external_kbnSharedDeps_React_.useState)(!1),toggleAutoApply=Object(external_kbnSharedDeps_React_.useCallback)(nextAutoApplyEnabled=>setAutoApplyEnabled(nextAutoApplyEnabled),[]),onClickDiscard=Object(external_kbnSharedDeps_React_.useCallback)(()=>dispatch(discardChanges(vis)),[dispatch,vis]);return useDebounce_default()(()=>{autoApplyEnabled&&isDirty&&applyChanges()},300,[isDirty,autoApplyEnabled,applyChanges]),external_kbnSharedDeps_React_default.a.createElement("div",{className:"visEditorSidebar__controls"},!autoApplyEnabled&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceBetween",gutterSize:"none",responsive:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{"data-test-subj":"visualizeEditorResetButton",disabled:!isDirty,iconType:"cross",onClick:onClickDiscard,size:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"visDefaultEditor.sidebar.discardChangesButtonLabel",defaultMessage:"Discard"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},isInvalid&&isTouched?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{content:external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.sidebar.errorButtonTooltip",{defaultMessage:"Errors in the highlighted fields need to be resolved."})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{color:"danger",iconType:"alert",size:"s",disabled:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"visDefaultEditor.sidebar.updateChartButtonLabel",defaultMessage:"Update"}))):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{"data-test-subj":"visualizeEditorRenderButton",disabled:!isDirty,fill:!0,iconType:"play",onClick:applyChanges,size:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"visDefaultEditor.sidebar.updateChartButtonLabel",defaultMessage:"Update"})))),enableAutoApply&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{title:autoApplyEnabled?external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.sidebar.autoApplyChangesOnLabel",{defaultMessage:"Auto apply is on"}):external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.sidebar.autoApplyChangesOffLabel",{defaultMessage:"Auto apply is off"}),content:external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.sidebar.autoApplyChangesTooltip",{defaultMessage:"Auto updates the visualization on every change."})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{className:"visEditorSidebar__autoApplyButton","data-test-subj":"visualizeEditorAutoButton",iconType:"refresh",color:autoApplyEnabled?"primary":"text",fill:!0,onClick:()=>toggleAutoApply(!autoApplyEnabled),size:"s",minWidth:80,"aria-label":autoApplyEnabled?external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.sidebar.autoApplyChangesLabelOn",{defaultMessage:"Auto apply is on"}):external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.sidebar.autoApplyChangesLabelOff",{defaultMessage:"Auto apply is off"})},autoApplyEnabled?external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.sidebar.autoApplyChangesOn",{defaultMessage:"On"}):external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.sidebar.autoApplyChangesOff",{defaultMessage:"Off"}))))}function LinkedSearch({savedSearch:savedSearch,eventEmitter:eventEmitter}){const[showPopover,setShowPopover]=Object(external_kbnSharedDeps_React_.useState)(!1),{services:{application:application}}=Object(public_.useKibana)(),closePopover=Object(external_kbnSharedDeps_React_.useCallback)(()=>setShowPopover(!1),[]),onClickButtonLink=Object(external_kbnSharedDeps_React_.useCallback)(()=>setShowPopover(v=>!v),[]),onClickUnlikFromSavedSearch=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setShowPopover(!1),eventEmitter.emit("unlinkFromSavedSearch")},[eventEmitter]),onClickViewInDiscover=Object(external_kbnSharedDeps_React_.useCallback)(()=>{application.navigateToApp("discover",{path:"#/view/"+savedSearch.id})},[application,savedSearch.id]),linkButtonAriaLabel=external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.sidebar.savedSearch.linkButtonAriaLabel",{defaultMessage:"Link to saved search. Click to learn more or break link."});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",className:"visEditorSidebar__titleContainer visEditorSidebar__linkedSearch",gutterSize:"xs",responsive:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{type:"search"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,className:"eui-textTruncate"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"xs",className:"eui-textTruncate"},external_kbnSharedDeps_React_default.a.createElement("h2",{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.sidebar.savedSearch.titleAriaLabel",{defaultMessage:"Saved search: {title}",values:{title:savedSearch.title}})},savedSearch.title))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopover,{anchorPosition:"downRight",button:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{content:linkButtonAriaLabel},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{"aria-label":linkButtonAriaLabel,"data-test-subj":"showUnlinkSavedSearchPopover",iconType:"link",onClick:onClickButtonLink})),isOpen:showPopover,closePopover:closePopover,panelPaddingSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopoverTitle,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"visDefaultEditor.sidebar.savedSearch.popoverTitle",defaultMessage:"Linked to saved search"})),external_kbnSharedDeps_React_default.a.createElement("div",{style:{width:260}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"s"},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{"data-test-subj":"viewSavedSearch",flush:"left",onClick:onClickViewInDiscover,size:"xs"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"visDefaultEditor.sidebar.savedSearch.goToDiscoverButtonText",defaultMessage:"View this search in Discover"}))),external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"visDefaultEditor.sidebar.savedSearch.popoverHelpText",defaultMessage:"Subsequent modifications to this saved search are reflected in the visualization. To disable automatic updates, remove the link."})),external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{color:"danger","data-test-subj":"unlinkSavedSearch",fullWidth:!0,onClick:onClickUnlikFromSavedSearch,size:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"visDefaultEditor.sidebar.savedSearch.unlinkSavedSearchButtonText",defaultMessage:"Remove link to saved search"}))))))))}function SidebarTitle({savedSearch:savedSearch,vis:vis,isLinkedSearch:isLinkedSearch,eventEmitter:eventEmitter}){return isLinkedSearch&&savedSearch?external_kbnSharedDeps_React_default.a.createElement(LinkedSearch,{savedSearch:savedSearch,eventEmitter:eventEmitter}):vis.type.options.showIndexSelection?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"xs",className:"visEditorSidebar__titleContainer eui-textTruncate"},external_kbnSharedDeps_React_default.a.createElement("h2",{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.sidebar.indexPatternAriaLabel",{defaultMessage:"Index pattern: {title}",values:{title:vis.data.indexPattern.title}})},vis.data.indexPattern.title)):external_kbnSharedDeps_React_default.a.createElement("div",{className:"visEditorSidebar__indexPatternPlaceholder"})}var useUnmount=__webpack_require__(37),useUnmount_default=__webpack_require__.n(useUnmount);let AGG_TYPE_ACTION_KEYS,AGG_PARAMS_ACTION_KEYS;function aggTypeReducer(state,action){switch(action.type){case AGG_TYPE_ACTION_KEYS.TOUCHED:return{...state,touched:action.payload};case AGG_TYPE_ACTION_KEYS.VALID:return{...state,valid:action.payload};default:throw new Error}}function aggParamsReducer(state,{type:type,paramName:paramName="",payload:payload}){const targetParam=state[paramName]||{valid:!0,touched:!1};switch(type){case AGG_PARAMS_ACTION_KEYS.TOUCHED:return{...state,[paramName]:{...targetParam,touched:payload}};case AGG_PARAMS_ACTION_KEYS.VALID:return{...state,[paramName]:{...targetParam,valid:payload}};case AGG_PARAMS_ACTION_KEYS.RESET:return{};default:throw new Error}}function initAggParamsState(params){return params.reduce((stateObj,param)=>(stateObj[param.aggParam.name]={valid:!0,touched:!1},stateObj),{})}function DefaultEditorAggSelect({aggError:aggError,id:id,indexPattern:indexPattern,value:value,setValue:setValue,aggTypeOptions:aggTypeOptions,showValidation:showValidation,isSubAggregation:isSubAggregation,onChangeAggType:onChangeAggType}){const[isDirty,setIsDirty]=Object(external_kbnSharedDeps_React_.useState)(!1),{services:services}=Object(public_.useKibana)(),selectedOptions=value?[{label:value.title,target:value}]:[],label=isSubAggregation?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"visDefaultEditor.aggSelect.subAggregationLabel",defaultMessage:"Sub aggregation"}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"visDefaultEditor.aggSelect.aggregationLabel",defaultMessage:"Aggregation"});let aggHelpLink;Object(external_kbnSharedDeps_Lodash_.has)(value,"name")&&(aggHelpLink=services.docLinks.links.aggs[value.name]);const helpLink=value&&aggHelpLink&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{href:aggHelpLink,target:"_blank",rel:"noopener"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"visDefaultEditor.aggSelect.helpLinkLabel",defaultMessage:"{aggTitle} help",values:{aggTitle:value?value.title:""}}))),errors=aggError?[aggError]:[];aggTypeOptions.length||errors.push(external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.aggSelect.noCompatibleAggsDescription",{defaultMessage:"The index pattern {indexPatternTitle} does not have any aggregatable fields.",values:{indexPatternTitle:indexPattern&&indexPattern.title}}));const isValid=!!value&&!errors.length&&!isDirty,onChange=Object(external_kbnSharedDeps_React_.useCallback)(options=>{const selectedOption=Object(external_kbnSharedDeps_Lodash_.get)(options,"0.target");selectedOption&&setValue(selectedOption)},[setValue]),onSearchChange=Object(external_kbnSharedDeps_React_.useCallback)(searchValue=>setIsDirty(Boolean(searchValue)),[]),setTouched=Object(external_kbnSharedDeps_React_.useCallback)(()=>onChangeAggType({type:AGG_TYPE_ACTION_KEYS.TOUCHED,payload:!0}),[onChangeAggType]),setValidity=Object(external_kbnSharedDeps_React_.useCallback)(valid=>onChangeAggType({type:AGG_TYPE_ACTION_KEYS.VALID,payload:valid}),[onChangeAggType]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{setValidity(isValid)},[isValid,setValidity]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{errors.length&&setTouched()},[errors.length,setTouched]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:label,labelAppend:helpLink,error:errors,isInvalid:!!showValidation&&!isValid,fullWidth:!0,display:"rowCompressed"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiComboBox,{placeholder:external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.aggSelect.selectAggPlaceholder",{defaultMessage:"Select an aggregation"}),id:"visDefaultEditorAggSelect"+id,isDisabled:!aggTypeOptions.length,options:aggTypeOptions,selectedOptions:selectedOptions,singleSelection:{asPlainText:!0},onBlur:setTouched,onChange:onChange,onSearchChange:onSearchChange,"data-test-subj":"defaultEditorAggSelect",isClearable:!1,isInvalid:!!showValidation&&!isValid,fullWidth:!0,sortMatchesBy:"startsWith",compressed:!0}))}function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function DefaultEditorAggParam(props){const{agg:agg,aggParam:aggParam,paramEditor:ParamEditor,setAggParamValue:setAggParamValue,onChangeParamsState:onChangeParamsState,...rest}=props,setValidity=Object(external_kbnSharedDeps_React_.useCallback)(valid=>{onChangeParamsState({type:AGG_PARAMS_ACTION_KEYS.VALID,paramName:aggParam.name,payload:valid})},[onChangeParamsState,aggParam.name]),setTouched=Object(external_kbnSharedDeps_React_.useCallback)((isTouched=!0)=>{onChangeParamsState({type:AGG_PARAMS_ACTION_KEYS.TOUCHED,paramName:aggParam.name,payload:isTouched})},[onChangeParamsState,aggParam.name]),setValue=Object(external_kbnSharedDeps_React_.useCallback)(value=>{props.value!==value&&setAggParamValue(agg.id,aggParam.name,value)},[setAggParamValue,agg.id,aggParam.name,props.value]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{aggParam.shouldShow&&!aggParam.shouldShow(agg)&&setValidity(!0)},[agg,agg.params.field,aggParam,setValidity]),aggParam.shouldShow&&!aggParam.shouldShow(agg)?null:external_kbnSharedDeps_React_default.a.createElement(ParamEditor,_extends({agg:agg,aggParam:aggParam,setValidity:setValidity,setTouched:setTouched,setValue:setValue},rest))}!function(AGG_TYPE_ACTION_KEYS){AGG_TYPE_ACTION_KEYS.TOUCHED="aggTypeTouched",AGG_TYPE_ACTION_KEYS.VALID="aggTypeValid"}(AGG_TYPE_ACTION_KEYS||(AGG_TYPE_ACTION_KEYS={})),function(AGG_PARAMS_ACTION_KEYS){AGG_PARAMS_ACTION_KEYS.TOUCHED="aggParamsTouched",AGG_PARAMS_ACTION_KEYS.VALID="aggParamsValid",AGG_PARAMS_ACTION_KEYS.RESET="aggParamsReset"}(AGG_PARAMS_ACTION_KEYS||(AGG_PARAMS_ACTION_KEYS={}));const{propFilter:propFilter}=data_public_.search.aggs,filterByName=propFilter("name"),agg_type_filters_filters=[(aggType,indexPattern,aggConfig,aggFilter)=>0!==filterByName([aggType],aggFilter).length,(aggType,indexPattern,aggConfig,aggFilter)=>{const aggRestrictions=indexPattern.getAggregationRestrictions();if(!aggRestrictions)return!0;const aggName=aggType.name;return"count"===aggName||!!aggRestrictions&&Object.keys(aggRestrictions).includes(aggName)||!1}];const agg_type_field_filters_filters=[(field,aggConfig)=>{const aggRestrictions=aggConfig.getIndexPattern().getAggregationRestrictions();if(!aggRestrictions)return!0;const aggFields=aggRestrictions[aggConfig.type&&aggConfig.type.name];return!!aggFields&&!!aggFields[field.name]}];var utils=__webpack_require__(11);var target=__webpack_require__(36),target_default=__webpack_require__.n(target),useMount=__webpack_require__(19),useMount_default=__webpack_require__.n(useMount);const generateId=Object(external_kbnSharedDeps_ElasticEui_.htmlIdGenerator)(),validateDateMath=(value="")=>{if(!value)return!0;const moment=target_default.a.parse(value);return moment&&moment.isValid()};function SwitchParamEditor({value:value=!1,setValue:setValue,dataTestSubj:dataTestSubj,displayToolTip:displayToolTip,displayLabel:displayLabel,disabled:disabled}){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{fullWidth:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{content:displayToolTip,delay:"long",position:"right"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSwitch,{compressed:!0,label:displayLabel,checked:value,disabled:disabled,"data-test-subj":dataTestSubj,onChange:ev=>setValue(ev.target.checked)})))}function drop_partials_extends(){return(drop_partials_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}var controls_utils=__webpack_require__(9);const field_label=external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.field.fieldLabel",{defaultMessage:"Field"});function FieldParamEditor({agg:agg,aggParam:aggParam,customError:customError,customLabel:customLabel,indexedFields:indexedFields=[],showValidation:showValidation,value:value,setTouched:setTouched,setValidity:setValidity,setValue:setValue}){const[isDirty,setIsDirty]=Object(external_kbnSharedDeps_React_.useState)(!1),selectedOptions=value?[{label:value.displayName,target:value,key:value.name}]:[],errors=customError?[customError]:[];let showErrorMessageImmediately=!1;indexedFields.length||errors.push(external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.field.noCompatibleFieldsDescription",{defaultMessage:"The index pattern {indexPatternTitle} does not contain any of the following compatible field types: {fieldTypes}",values:{indexPatternTitle:agg.getIndexPattern&&agg.getIndexPattern().title,fieldTypes:getFieldTypesString(agg)}})),value&&value.type===data_public_.KBN_FIELD_TYPES.MISSING?(errors.push(external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.field.fieldIsNotExists",{defaultMessage:'The field "{fieldParameter}" associated with this object no longer exists in the index pattern. Please use another field.',values:{fieldParameter:value.name}})),showErrorMessageImmediately=!0):value&&!getFieldTypes(agg).find(type=>type===value.type||"*"===type)&&(errors.push(external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.field.invalidFieldForAggregation",{defaultMessage:'Saved field "{fieldParameter}" of index pattern "{indexPatternTitle}" is invalid for use with this aggregation. Please select a new field.',values:{fieldParameter:null==value?void 0:value.name,indexPatternTitle:agg.getIndexPattern&&agg.getIndexPattern().title}})),showErrorMessageImmediately=!0);const isValid=!!value&&!errors.length&&!isDirty,showErrorMessage=(showValidation||!indexedFields.length||showErrorMessageImmediately)&&!isValid;Object(controls_utils.g)(setValidity,isValid),useMount_default()(()=>{if(1!==indexedFields.length)return;const indexedField=indexedFields[0];"options"in indexedField?1===indexedField.options.length&&setValue(indexedField.options[0].target):setValue(indexedField.target)});const onSearchChange=Object(external_kbnSharedDeps_React_.useCallback)(searchValue=>setIsDirty(Boolean(searchValue)),[]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:customLabel||field_label,isInvalid:showErrorMessage,fullWidth:!0,error:errors,display:"rowCompressed"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiComboBox,{compressed:!0,placeholder:external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.field.selectFieldPlaceholder",{defaultMessage:"Select a field"}),options:indexedFields,isDisabled:!indexedFields.length,selectedOptions:selectedOptions,singleSelection:{asPlainText:!0},isClearable:!1,isInvalid:showErrorMessage,onChange:options=>{const selectedOption=Object(external_kbnSharedDeps_Lodash_.get)(options,"0.target");aggParam.required&&!selectedOption||setValue(selectedOption),aggParam.onChange&&aggParam.onChange(agg)},onBlur:setTouched,onSearchChange:onSearchChange,sortMatchesBy:"startsWith","data-test-subj":"visDefaultEditorField",fullWidth:!0}))}function getFieldTypesString(agg){return Object(controls_utils.a)(getFieldTypes(agg),{inclusive:!1})}function getFieldTypes(agg){const param=Object(external_kbnSharedDeps_Lodash_.get)(agg,"type.params",[]).find(p=>"field"===p.name)||{};return Object(controls_utils.c)(param.filterFieldTypes||[])}function FilterRow({id:id,arrayIndex:arrayIndex,customLabel:customLabel,value:value,autoFocus:autoFocus,disableRemove:disableRemove,dataTestSubj:dataTestSubj,agg:agg,onChangeValue:onChangeValue,onRemoveFilter:onRemoveFilter}){const{services:services}=Object(public_.useKibana)(),[showCustomLabel,setShowCustomLabel]=Object(external_kbnSharedDeps_React_.useState)(!1),filterLabel=external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.filters.filterLabel",{defaultMessage:"Filter {index}",values:{index:arrayIndex+1}}),FilterControl=external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{iconType:"tag","aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.filters.toggleFilterButtonAriaLabel",{defaultMessage:"Toggle filter label"}),"aria-expanded":showCustomLabel,"aria-controls":"visEditorFilterLabel"+arrayIndex,onClick:()=>setShowCustomLabel(!showCustomLabel)}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{iconType:"trash",color:"danger",disabled:disableRemove,"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.filters.removeFilterButtonAriaLabel",{defaultMessage:"Remove this filter"}),onClick:()=>onRemoveFilter(id)}));return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiForm,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:`${filterLabel}${customLabel?" - "+customLabel:""}`,labelAppend:FilterControl,fullWidth:!0},external_kbnSharedDeps_React_default.a.createElement(data_public_.QueryStringInput,{query:value,indexPatterns:[agg.getIndexPattern()],onChange:query=>onChangeValue(id,query,customLabel),onBlur:()=>{value.query.length>0&&services.data.query.addToQueryLog(services.appName,value)},disableAutoFocus:!autoFocus,dataTestSubj:dataTestSubj,bubbleSubmitEvent:!0,languageSwitcherPopoverAnchorPosition:"leftDown",size:"s"})),showCustomLabel?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{id:"visEditorFilterLabel"+arrayIndex,label:external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.filters.definiteFilterLabel",{defaultMessage:"Filter {index} label",description:"'Filter {index}' represents the name of the filter as a noun, similar to 'label for filter 1'.",values:{index:arrayIndex+1}}),fullWidth:!0,display:"rowCompressed"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldText,{value:customLabel,placeholder:external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.filters.labelPlaceholder",{defaultMessage:"Label"}),onChange:ev=>onChangeValue(id,value,ev.target.value),fullWidth:!0,compressed:!0})):null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}))}const filters_generateId=Object(external_kbnSharedDeps_ElasticEui_.htmlIdGenerator)();function has_extended_bounds_extends(){return(has_extended_bounds_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const{isType:isType}=data_public_.search.aggs;function StringParamEditor({agg:agg,aggParam:aggParam,showValidation:showValidation,value:value,setValidity:setValidity,setValue:setValue,setTouched:setTouched}){const isValid=!aggParam.required||!!value;Object(external_kbnSharedDeps_React_.useEffect)(()=>{setValidity(isValid)},[isValid,setValidity]);const onChange=Object(external_kbnSharedDeps_React_.useCallback)(ev=>setValue(ev.target.value),[setValue]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{className:"visEditorAggParam__string",label:aggParam.displayName||aggParam.name,fullWidth:!0,display:"rowCompressed",isInvalid:!!showValidation&&!isValid},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldText,{value:value||"","data-test-subj":`visEditorStringInput${agg.id}${aggParam.name}`,onChange:onChange,fullWidth:!0,compressed:!0,onBlur:setTouched,isInvalid:!!showValidation&&!isValid}))}const _RE_NUMBER="(\\-?(?:\\d+(?:\\.\\d+)?|Infinity))",RANGE_RE=new RegExp("^\\s*([\\[|\\(])\\s*"+_RE_NUMBER+"\\s*,\\s*"+_RE_NUMBER+"\\s*([\\]|\\)])\\s*$");class NumberListRange{constructor(minInclusive,min,max,maxInclusive){this.minInclusive=minInclusive,this.min=min,this.max=max,this.maxInclusive=maxInclusive}within(n){return!(this.min===n&&!this.minInclusive||this.min>n)&&!(this.max===n&&!this.maxInclusive||this.max<n)}}function parseRange(input){const match=String(input).match(RANGE_RE);if(!match)throw new TypeError("expected input to be in interval notation e.g., (100, 200]");const args=["["===match[1],parseFloat(match[2]),parseFloat(match[3]),"]"===match[4]];args[1]>args[2]&&args.reverse();const[minInclusive,min,max,maxInclusive]=args;return new NumberListRange(minInclusive,min,max,maxInclusive)}const defaultRange=parseRange("[0,Infinity)"),utils_generateId=Object(external_kbnSharedDeps_ElasticEui_.htmlIdGenerator)(),defaultModel={value:0,id:utils_generateId(),isInvalid:!1};function parse(value){const parsedValue=parseFloat(value);return isNaN(parsedValue)?"":parsedValue}function getRange(range){try{return range?parseRange(range):defaultRange}catch(e){throw new TypeError("Unable to parse range: "+e.message)}}function getNextModel(list,range){const lastValue=Object(external_kbnSharedDeps_Lodash_.last)(list).value;let next=Number(lastValue)?Number(lastValue)+1:1;return next>=range.max&&(next=range.max-1),{id:utils_generateId(),value:next,isInvalid:!1}}function getInitModelList(list){return list.length?list.map(num=>({value:void 0===num?"":num,id:utils_generateId(),isInvalid:!1})):[defaultModel]}function getValidatedModels(numberList,modelList,numberRange,validateAscendingOrder=!1,disallowDuplicates=!1){return numberList.length?numberList.map((number,index)=>{const model=modelList[index]||{id:utils_generateId()},newValue=void 0===number?"":number,valueResult=numberRange?function(value,numberRange){const result={isInvalid:!1};return""===value?(result.isInvalid=!0,result.error=""):numberRange.within(value)||(result.isInvalid=!0,result.error=external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.numberList.invalidRangeErrorMessage",{defaultMessage:"The value should be in the range of {min} to {max}.",values:{min:numberRange.min,max:numberRange.max}})),result}(newValue,numberRange):{isInvalid:!1},ascendingResult=validateAscendingOrder?function(inputValue,index,list){const result={isInvalidOrder:!1},previousModel=list[index-1];return void 0!==previousModel&&void 0!==inputValue&&inputValue<=previousModel&&(result.isInvalidOrder=!0,result.error=external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.numberList.invalidAscOrderErrorMessage",{defaultMessage:"Value is not in ascending order."})),result}(newValue,index,numberList):{isInvalidOrder:!1},duplicationResult=disallowDuplicates?function(inputValue,index,list){const result={isDuplicate:!1};return""!==inputValue&&list.indexOf(inputValue)!==index&&(result.isDuplicate=!0,result.error=external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.numberList.duplicateValueErrorMessage",{defaultMessage:"Duplicate value."})),result}(newValue,index,numberList):{isDuplicate:!1},allErrors=[valueResult.error,ascendingResult.error,duplicationResult.error].filter(Boolean).join(" ");return{...model,value:newValue,isInvalid:valueResult.isInvalid||ascendingResult.isInvalidOrder||duplicationResult.isDuplicate,error:""===allErrors?void 0:allErrors}}):[defaultModel]}function NumberRow({autoFocus:autoFocus,disableDelete:disableDelete,model:model,isInvalid:isInvalid,labelledbyId:labelledbyId,range:range,onBlur:onBlur,onDelete:onDelete,onChange:onChange}){const deleteBtnAriaLabel=external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.numberList.removeUnitButtonAriaLabel",{defaultMessage:"Remove the rank value of {value}",values:{value:model.value}}),onValueChanged=Object(external_kbnSharedDeps_React_.useCallback)(event=>onChange({value:event.target.value,id:model.id}),[onChange,model.id]),onDeleteFn=Object(external_kbnSharedDeps_React_.useCallback)(()=>onDelete(model.id),[onDelete,model.id]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{responsive:!1,alignItems:"center",gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldNumber,{"aria-labelledby":labelledbyId,autoFocus:autoFocus,compressed:!0,isInvalid:isInvalid,placeholder:external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.numberList.enterValuePlaceholder",{defaultMessage:"Enter a value"}),onChange:onValueChanged,value:model.value,fullWidth:!0,min:range.min,max:range.max,onBlur:onBlur})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{"aria-label":deleteBtnAriaLabel,title:deleteBtnAriaLabel,color:"danger",iconType:"trash",onClick:onDeleteFn,disabled:disableDelete})))}const simple_number_list_generateId=Object(external_kbnSharedDeps_ElasticEui_.htmlIdGenerator)();function SimpleNumberList({agg:agg,aggParam:aggParam,value:value,setValue:setValue,setTouched:setTouched}){const[numbers,setNumbers]=Object(external_kbnSharedDeps_React_.useState)(getInitModelList(value&&Object(external_kbnSharedDeps_Lodash_.isArray)(value)?value:[""])),numberRange=Object(external_kbnSharedDeps_React_.useMemo)(()=>getRange("[-Infinity,Infinity]"),[]);Object(external_kbnSharedDeps_React_.useEffect)(()=>{!Object(external_kbnSharedDeps_Lodash_.isArray)(value)||value.length===numbers.length&&value.every((numberValue,index)=>numberValue===numbers[index].value)||setNumbers(value.map(numberValue=>({id:simple_number_list_generateId(),value:numberValue,isInvalid:!1})))},[numbers,value]);const onUpdate=Object(external_kbnSharedDeps_React_.useCallback)(numberList=>{setNumbers(numberList),setValue(numberList.map(({value:numberValue})=>numberValue))},[setValue]),onChangeValue=Object(external_kbnSharedDeps_React_.useCallback)(numberField=>{onUpdate(numbers.map(number=>number.id===numberField.id?{id:numberField.id,value:parse(numberField.value),isInvalid:!1}:number))},[numbers,onUpdate]),onAdd=Object(external_kbnSharedDeps_React_.useCallback)(()=>{const newArray=[...numbers,{id:simple_number_list_generateId(),value:"",isInvalid:!1}];onUpdate(newArray)},[numbers,onUpdate]),onDelete=Object(external_kbnSharedDeps_React_.useCallback)(id=>onUpdate(numbers.filter(number=>number.id!==id)),[numbers,onUpdate]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{id:`${aggParam.name}-${agg.id}}`,label:aggParam.displayName||aggParam.name,fullWidth:!0,display:"rowCompressed"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,numbers.map((number,arrayIndex)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,{key:number.id},external_kbnSharedDeps_React_default.a.createElement(NumberRow,{isInvalid:number.isInvalid,disableDelete:1===numbers.length,model:number,labelledbyId:`${aggParam.name}-${agg.id}-legend`,range:numberRange,onDelete:onDelete,onChange:onChangeValue,onBlur:setTouched,autoFocus:1!==numbers.length&&arrayIndex===numbers.length-1}),numbers.length-1!==arrayIndex&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{iconType:"plusInCircleFilled",onClick:onAdd,size:"xs"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"visDefaultEditor.controls.includeExclude.addUnitButtonLabel",defaultMessage:"Add value"})))))}function include_exclude_extends(){return(include_exclude_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const{isNumberType:isNumberType}=data_public_.search.aggs;function IncludeExcludeParamEditor(props){const{agg:agg,value:value,setValue:setValue}=props,isAggOfNumberType=isNumberType(agg);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{if(isAggOfNumberType&&!Array.isArray(value)&&void 0!==value){const numberArray=value.split("|").map(item=>parseFloat(item)).filter(number=>Number.isFinite(number));setValue(numberArray.length?numberArray:[""])}else!isAggOfNumberType&&Array.isArray(value)&&void 0!==value&&setValue(value.filter(item=>""!==item).join("|"))},[isAggOfNumberType,setValue,value]),isAggOfNumberType?external_kbnSharedDeps_React_default.a.createElement(SimpleNumberList,include_exclude_extends({},props,{value:value})):external_kbnSharedDeps_React_default.a.createElement(StringParamEditor,include_exclude_extends({},props,{value:value}))}const input_list_generateId=Object(external_kbnSharedDeps_ElasticEui_.htmlIdGenerator)();function InputList({config:config,list:list,onChange:onChange,setValidity:setValidity}){const{defaultValue:defaultValue,getModelValue:getModelValue,modelNames:modelNames,onChangeFn:onChangeFn,validateClass:validateClass}=config,[models,setModels]=Object(external_kbnSharedDeps_React_.useState)(()=>list.map(item=>({id:input_list_generateId(),...getModelValue(item)}))),hasInvalidValues=models.some(config.hasInvalidValuesFn),updateValues=Object(external_kbnSharedDeps_React_.useCallback)(modelList=>{setModels(modelList),onChange(modelList.map(onChangeFn))},[onChangeFn,onChange]),onChangeValue=Object(external_kbnSharedDeps_React_.useCallback)((index,value,modelName)=>{const{model:model,isInvalid:isInvalid}=((inputValue,InputObject)=>{const result={model:inputValue||"",isInvalid:!1};if(!inputValue)return result.isInvalid=!1,result;try{return result.model=new InputObject(inputValue).toString(),result.isInvalid=!1,result}catch(e){return result.isInvalid=!0,result}})(value,validateClass);updateValues(models.map((range,arrayIndex)=>arrayIndex===index?{...range,[modelName]:{value:value,model:model,isInvalid:isInvalid}}:range))},[models,updateValues,validateClass]),onDelete=Object(external_kbnSharedDeps_React_.useCallback)(id=>updateValues(models.filter(model=>model.id!==id)),[models,updateValues]),onAdd=Object(external_kbnSharedDeps_React_.useCallback)(()=>updateValues([...models,{id:input_list_generateId(),...getModelValue()}]),[getModelValue,models,updateValues]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{list.length||updateValues([{id:input_list_generateId(),...defaultValue}])},[defaultValue,list.length,updateValues]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{setValidity(!hasInvalidValues)},[hasInvalidValues,setValidity]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{(list.length!==models.length||list.some((item,index)=>{const model=Object(external_kbnSharedDeps_Lodash_.mapValues)(Object(external_kbnSharedDeps_Lodash_.pick)(models[index],modelNames),"model");return!Object(external_kbnSharedDeps_Lodash_.isEqual)(item,Object(external_kbnSharedDeps_Lodash_.omitBy)(model,external_kbnSharedDeps_Lodash_.isEmpty))}))&&setModels(list.map(item=>({id:input_list_generateId(),...getModelValue(item)})))},[getModelValue,list,modelNames,models]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,models.map((item,index)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,{key:item.id},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"xs",alignItems:"center",responsive:!1},config.renderInputRow(item,index,onChangeValue),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{"aria-label":config.getRemoveBtnAriaLabel(item),title:config.getRemoveBtnAriaLabel(item),disabled:1===models.length,color:"danger",iconType:"trash",onClick:()=>onDelete(item.id)}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"xs"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{iconType:"plusInCircleFilled",onClick:onAdd,size:"xs"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"visDefaultEditor.controls.ipRanges.addRangeButtonLabel",defaultMessage:"Add range"}))))}function from_to_list_extends(){return(from_to_list_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const defaultConfig={defaultValue:{from:{value:"0.0.0.0",model:"0.0.0.0",isInvalid:!1},to:{value:"255.255.255.255",model:"255.255.255.255",isInvalid:!1}},validateClass:data_public_.search.aggs.Ipv4Address,getModelValue:(item={})=>({from:{value:item.from||"",model:item.from||"",isInvalid:!1},to:{value:item.to||"",model:item.to||"",isInvalid:!1}}),getRemoveBtnAriaLabel:item=>external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.ipRanges.removeRangeAriaLabel",{defaultMessage:"Remove the range of {from} to {to}",values:{from:item.from.value||"*",to:item.to.value||"*"}}),onChangeFn:({from:from,to:to})=>{const result={};return from.model&&(result.from=from.model),to.model&&(result.to=to.model),result},hasInvalidValuesFn:({from:from,to:to})=>from.isInvalid||to.isInvalid,modelNames:["from","to"]};function FromToList({showValidation:showValidation,onBlur:onBlur,...rest}){const renderInputRow=Object(external_kbnSharedDeps_React_.useCallback)((item,index,onChangeValue)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldText,{"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.ipRanges.ipRangeFromAriaLabel",{defaultMessage:"IP range from: {value}",values:{value:item.from.value||"*"}}),compressed:!0,isInvalid:!!showValidation&&item.from.isInvalid,placeholder:"*",onChange:ev=>{onChangeValue(index,ev.target.value,"from")},value:item.from.value,onBlur:onBlur})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{type:"sortRight",color:"subdued"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldText,{"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.ipRanges.ipRangeToAriaLabel",{defaultMessage:"IP range to: {value}",values:{value:item.to.value||"*"}}),compressed:!0,isInvalid:!!showValidation&&item.to.isInvalid,placeholder:"*",onChange:ev=>{onChangeValue(index,ev.target.value,"to")},value:item.to.value,onBlur:onBlur}))),[onBlur,showValidation]),fromToListConfig={...defaultConfig,renderInputRow:renderInputRow};return external_kbnSharedDeps_React_default.a.createElement(InputList,from_to_list_extends({config:fromToListConfig},rest))}function mask_list_extends(){return(mask_list_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const mask_list_defaultConfig={defaultValue:{mask:{model:"0.0.0.0/1",value:"0.0.0.0/1",isInvalid:!1}},validateClass:data_public_.search.aggs.CidrMask,getModelValue:(item={})=>({mask:{model:item.mask||"",value:item.mask||"",isInvalid:!1}}),getRemoveBtnAriaLabel:item=>item.mask.value?external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.ipRanges.removeCidrMaskButtonAriaLabel",{defaultMessage:"Remove the CIDR mask value of {mask}",values:{mask:item.mask.value}}):external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.ipRanges.removeEmptyCidrMaskButtonAriaLabel",{defaultMessage:"Remove the CIDR mask default value"}),onChangeFn:({mask:mask})=>mask.model?{mask:mask.model}:{},hasInvalidValuesFn:({mask:mask})=>mask.isInvalid,modelNames:"mask"};function MaskList({showValidation:showValidation,onBlur:onBlur,...rest}){const renderInputRow=Object(external_kbnSharedDeps_React_.useCallback)(({mask:mask},index,onChangeValue)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldText,{"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.ipRanges.cidrMaskAriaLabel",{defaultMessage:"CIDR mask: {mask}",values:{mask:mask.value||"*"}}),compressed:!0,fullWidth:!0,isInvalid:!!showValidation&&mask.isInvalid,placeholder:"*",onChange:ev=>{onChangeValue(index,ev.target.value,"mask")},value:mask.value,onBlur:onBlur})),[onBlur,showValidation]),maskListConfig={...mask_list_defaultConfig,renderInputRow:renderInputRow};return external_kbnSharedDeps_React_default.a.createElement(InputList,mask_list_extends({config:maskListConfig},rest))}var IpRangeTypes;function is_filtered_by_collar_extends(){return(is_filtered_by_collar_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}!function(IpRangeTypes){IpRangeTypes.MASK="mask",IpRangeTypes.FROM_TO="fromTo"}(IpRangeTypes||(IpRangeTypes={}));const metric_agg_aggFilter=["!top_hits","!percentiles","!percentile_ranks","!median","!std_dev"],DEFAULT_OPTIONS=[{text:"",value:"EMPTY_VALUE",hidden:!0}];function min_doc_count_extends(){return(min_doc_count_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function missing_bucket_extends(){return(missing_bucket_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const number_interval_label=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"visDefaultEditor.controls.numberInterval.minimumIntervalLabel",defaultMessage:"Minimum interval"})," ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIconTip,{position:"right",content:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"visDefaultEditor.controls.numberInterval.minimumIntervalTooltip",defaultMessage:"Interval will be automatically scaled in the event that the provided value creates more buckets than specified by Advanced Setting's {histogramMaxBars}",values:{histogramMaxBars:data_public_.UI_SETTINGS.HISTOGRAM_MAX_BARS}}),type:"questionInCircle"})),selectIntervalPlaceholder=external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.numberInterval.selectIntervalPlaceholder",{defaultMessage:"Enter an interval"}),autoIntervalIsUsedPlaceholder=external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.numberInterval.autoInteralIsUsed",{defaultMessage:"Auto interval is used"}),useAutoIntervalLabel=external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.useAutoInterval",{defaultMessage:"Use auto interval"});const{termsAggFilter:termsAggFilter}=data_public_.search.aggs,order_by_DEFAULT_OPTIONS=[{text:external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.orderAgg.alphabeticalLabel",{defaultMessage:"Alphabetical"}),value:"_key"}],isCompatibleAgg=Object(controls_utils.b)(termsAggFilter);function other_bucket_extends(){return(other_bucket_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function NumberList({labelledbyId:labelledbyId,numberArray:numberArray,range:range,showValidation:showValidation,unitName:unitName,validateAscendingOrder:validateAscendingOrder=!1,disallowDuplicates:disallowDuplicates=!1,onChange:onChange,setTouched:setTouched,setValidity:setValidity}){const numberRange=Object(external_kbnSharedDeps_React_.useMemo)(()=>getRange(range),[range]),[models,setModels]=Object(external_kbnSharedDeps_React_.useState)(getInitModelList(numberArray));Object(external_kbnSharedDeps_React_.useEffect)(()=>{setModels(state=>getValidatedModels(numberArray,state,numberRange,validateAscendingOrder,disallowDuplicates))},[numberArray,numberRange,validateAscendingOrder,disallowDuplicates]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{numberArray.length||onChange([models[0].value])},[models,numberArray.length,onChange]);const isValid=!models.find(({isInvalid:isInvalid})=>isInvalid);Object(controls_utils.g)(setValidity,isValid);const onUpdate=Object(external_kbnSharedDeps_React_.useCallback)(modelList=>{setModels(modelList),onChange(modelList.map(({value:value})=>""===value?void 0:value))},[onChange]),onChangeValue=Object(external_kbnSharedDeps_React_.useCallback)(({id:id,value:value})=>{const parsedValue=parse(value);onUpdate(models.map(model=>model.id===id?{id:id,value:parsedValue,isInvalid:!1}:model))},[models,onUpdate]),onAdd=Object(external_kbnSharedDeps_React_.useCallback)(()=>{const newArray=[...models,getNextModel(models,numberRange)];onUpdate(newArray)},[models,numberRange,onUpdate]),onDelete=Object(external_kbnSharedDeps_React_.useCallback)(id=>{const newArray=models.filter(model=>model.id!==id);onUpdate(newArray)},[models,onUpdate]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,models.map((model,arrayIndex)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,{key:model.id},external_kbnSharedDeps_React_default.a.createElement(NumberRow,{isInvalid:!!showValidation&&model.isInvalid,disableDelete:1===models.length,model:model,labelledbyId:labelledbyId,range:numberRange,onDelete:onDelete,onChange:onChangeValue,onBlur:setTouched,autoFocus:1!==models.length&&arrayIndex===models.length-1}),showValidation&&model.isInvalid&&model.error&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormErrorText,null,model.error),models.length-1!==arrayIndex&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{iconType:"plusInCircleFilled",onClick:onAdd,size:"xs"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"visDefaultEditor.controls.numberList.addUnitButtonLabel",defaultMessage:"Add {unitName}",values:{unitName:unitName}}))))}var controls_ranges=__webpack_require__(5);var external_kbnSharedDeps_KbnMonaco_=__webpack_require__(18);function scale_metrics_extends(){return(scale_metrics_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function SizeParamEditor({disabled:disabled,iconTip:iconTip,value:value,setValue:setValue,showValidation:showValidation,setValidity:setValidity,setTouched:setTouched}){const label=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"visDefaultEditor.controls.sizeLabel",defaultMessage:"Size"}),iconTip),isValid=disabled||Number(value)>0;return Object(external_kbnSharedDeps_React_.useEffect)(()=>{setValidity(isValid)},[isValid,setValidity]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:label,fullWidth:!0,isInvalid:!!showValidation&&!isValid,display:"rowCompressed"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldNumber,{value:Object(external_kbnSharedDeps_Lodash_.isUndefined)(value)?"":value,onChange:ev=>setValue(""===ev.target.value?"":parseFloat(ev.target.value)),fullWidth:!0,compressed:!0,isInvalid:!!showValidation&&!isValid,onBlur:setTouched,min:1,disabled:disabled,"data-test-subj":"sizeParamEditor"}))}function SubMetricParamEditor({agg:agg,aggParam:aggParam,formIsTouched:formIsTouched,metricAggs:metricAggs,state:state,setValue:setValue,setValidity:setValidity,setTouched:setTouched,schemas:schemas}){const metricTitle=external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.metrics.metricTitle",{defaultMessage:"Metric"}),bucketTitle=external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.metrics.bucketTitle",{defaultMessage:"Bucket"}),type=aggParam.name,isCustomMetric="customMetric"===type,aggTitle=isCustomMetric?metricTitle:bucketTitle,aggGroup=isCustomMetric?data_public_.AggGroupNames.Metrics:data_public_.AggGroupNames.Buckets;useMount_default()(()=>{agg.params[type]?setValue(agg.params[type]):setValue(aggParam.makeAgg(agg))});const{onAggTypeChange:onAggTypeChange,setAggParamValue:setAggParamValue}=Object(controls_utils.f)(agg,aggParam,agg.params[type],setValue);return agg.params[type]?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormLabel,null,aggTitle),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(DefaultEditorAggParams,{agg:agg.params[type],allowedAggs:aggParam.allowedAggs,groupName:aggGroup,className:"visEditorAgg__subAgg",formIsTouched:formIsTouched,indexPattern:agg.getIndexPattern(),metricAggs:metricAggs,state:state,setAggParamValue:setAggParamValue,onAggTypeChange:onAggTypeChange,setValidity:setValidity,setTouched:setTouched,schemas:schemas,hideCustomLabel:!isCustomMetric})):null}const{parseEsInterval:parseEsInterval,InvalidEsCalendarIntervalError:InvalidEsCalendarIntervalError}=data_public_.search.aggs;function isValidCalendarInterval(interval){if("0ms"===interval)return{isValidCalendarValue:!0};try{return parseEsInterval(interval),{isValidCalendarValue:!0}}catch(e){return e instanceof InvalidEsCalendarIntervalError?{isValidCalendarValue:!1,error:e.message}:{isValidCalendarValue:!0}}}const errorMessage=external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.timeInterval.invalidFormatErrorMessage",{defaultMessage:"Invalid interval format."});const tooManyBucketsTooltip=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"visDefaultEditor.controls.timeInterval.createsTooManyBucketsTooltip",defaultMessage:"This interval creates too many buckets to show in the selected time range, so it has been scaled up."}),tooLargeBucketsTooltip=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"visDefaultEditor.controls.timeInterval.createsTooLargeBucketsTooltip",defaultMessage:"This interval creates buckets that are too large to show in the selected time range, so it has been scaled down."}),selectOptionHelpText=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"visDefaultEditor.controls.timeInterval.selectOptionHelpText",defaultMessage:"Select an option or create a custom value. Examples: 30s, 20m, 24h, 2d, 1w, 1M"});function getCompatibleAggs(agg){const{options:options=[]}=agg.getAggParams().find(({name:name})=>"aggregate"===name);return options.filter(option=>option.isCompatible(agg))}function top_field_extends(){return(top_field_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function top_size_extends(){return(top_size_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function top_sort_field_extends(){return(top_sort_field_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function OrderParamEditor({aggParam:aggParam,value:value,showValidation:showValidation,setValue:setValue,setValidity:setValidity,setTouched:setTouched}){const label=external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.orderLabel",{defaultMessage:"Order"}),isValid=!!value;return Object(external_kbnSharedDeps_React_.useEffect)(()=>{setValidity(isValid)},[isValid,setValidity]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:label,fullWidth:!0,isInvalid:!!showValidation&&!isValid,display:"rowCompressed"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSelect,{options:aggParam.options,value:value&&value.value,onChange:ev=>setValue(aggParam.options.find(opt=>opt.value===ev.target.value)),fullWidth:!0,compressed:!0,isInvalid:!!showValidation&&!isValid,onBlur:setTouched}))}const autoPlaceholder=external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.maxBars.autoPlaceholder",{defaultMessage:"Auto"}),max_bars_label=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"visDefaultEditor.controls.maxBars.maxBarsLabel",defaultMessage:"Max bars"})," ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIconTip,{position:"right",content:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"visDefaultEditor.controls.maxBars.maxBarsHelpText",defaultMessage:"Intervals will be selected automatically based on the available data. The maximum number of bars can never be greater than the Advanced Setting's {histogramMaxBars}",values:{histogramMaxBars:data_public_.UI_SETTINGS.HISTOGRAM_MAX_BARS}}),type:"questionInCircle"}));const{siblingPipelineType:siblingPipelineType,parentPipelineType:parentPipelineType}=data_public_.search.aggs,buckets={[data_public_.BUCKET_TYPES.DATE_HISTOGRAM]:{scaleMetricValues:function(props){return external_kbnSharedDeps_React_default.a.createElement(SwitchParamEditor,scale_metrics_extends({dataTestSubj:"scaleMetricsSwitch",displayLabel:external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.scaleMetricsLabel",{defaultMessage:"Scale metric values (deprecated)"}),displayToolTip:external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.scaleMetricsTooltip",{defaultMessage:"If you select a manual minimum interval and a larger interval will be used, enabling this will cause count and sum metrics to be scaled to the manual selected interval."})},props))},interval:function({agg:agg,aggParam:aggParam,editorConfig:editorConfig,value:value,setValue:setValue,showValidation:showValidation,setTouched:setTouched,setValidity:setValidity}){const timeBase=Object(external_kbnSharedDeps_Lodash_.get)(editorConfig,"interval.timeBase"),options=timeBase?[]:(aggParam.options||[]).reduce((filtered,option)=>(option.enabled&&!option.enabled(agg)||filtered.push({label:option.display,key:option.val}),filtered),[]);let definedOption,selectedOptions=[];value&&(definedOption=Object(external_kbnSharedDeps_Lodash_.find)(options,{key:value}),selectedOptions=definedOption?[definedOption]:"auto"===value?[]:[{label:value,key:"custom"}]);const{isValid:isValid,error:error,interval:interval}=function(agg,value,definedOption,timeBase){var _agg$buckets2,_agg$buckets;if(definedOption)return{isValid:!0,interval:null===(_agg$buckets=agg.buckets)||void 0===_agg$buckets?void 0:_agg$buckets.getInterval()};if(!value||"auto"===value&&!definedOption)return{isValid:!1};if(!timeBase){const{isValidCalendarValue:isValidCalendarValue,error:error}=isValidCalendarInterval(value);if(!isValidCalendarValue)return{isValid:!1,error:error}}const isValid=data_public_.search.aggs.isValidInterval(value,timeBase);if(!isValid)return{isValid:!1,error:errorMessage};const interval=null===(_agg$buckets2=agg.buckets)||void 0===_agg$buckets2?void 0:_agg$buckets2.getInterval(),{isValidCalendarValue:isValidCalendarValue,error:error}=isValidCalendarInterval(interval.expression);return isValidCalendarValue?{isValid:isValid,interval:interval}:{isValid:!1,error:error}}(agg,value,definedOption,timeBase),scaledHelpText=interval&&interval.scaled?external_kbnSharedDeps_React_default.a.createElement("strong",{"data-test-subj":"currentlyScaledText",className:"eui-displayBlock"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"visDefaultEditor.controls.timeInterval.scaledHelpText",defaultMessage:"Currently scaled to {bucketDescription}",values:{bucketDescription:Object(external_kbnSharedDeps_Lodash_.get)(interval,"description")||""}})," ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIconTip,{position:"right",type:"questionInCircle",content:interval.scale<=1?tooManyBucketsTooltip:tooLargeBucketsTooltip})):null,helpText=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,scaledHelpText,Object(external_kbnSharedDeps_Lodash_.get)(editorConfig,"interval.help")||selectOptionHelpText);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{setValidity(isValid)},[isValid,setValidity]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{display:"rowCompressed",error:error,fullWidth:!0,helpText:helpText,isInvalid:showValidation&&!isValid,label:external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.timeInterval.minimumIntervalLabel",{defaultMessage:"Minimum interval"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiComboBox,{compressed:!0,fullWidth:!0,"data-test-subj":"visEditorInterval",isInvalid:showValidation&&!isValid,noSuggestions:!!timeBase,onChange:opts=>{const selectedOpt=Object(external_kbnSharedDeps_Lodash_.get)(opts,"0");setValue(selectedOpt?selectedOpt.key:"")},onCreateOption:customValue=>setValue(customValue.trim()),options:options,selectedOptions:selectedOptions,singleSelection:{asPlainText:!0},placeholder:external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.timeInterval.selectIntervalPlaceholder",{defaultMessage:"Select an interval"}),onBlur:setTouched}))},drop_partials:function(props){return external_kbnSharedDeps_React_default.a.createElement(SwitchParamEditor,drop_partials_extends({dataTestSubj:"dropPartialBucketsCheckbox",displayLabel:external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.dropPartialBucketsLabel",{defaultMessage:"Drop partial buckets"}),displayToolTip:external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.dropPartialBucketsTooltip",{defaultMessage:"Remove buckets that span time outside the time range so the histogram doesn't start and end with incomplete buckets."})},props))}},[data_public_.BUCKET_TYPES.DATE_RANGE]:{ranges:function({value:value=[],setValue:setValue,setValidity:setValidity}){const{services:services}=Object(public_.useKibana)(),[ranges,setRanges]=Object(external_kbnSharedDeps_React_.useState)(()=>value.map(range=>({...range,id:generateId()}))),hasInvalidRange=value.some(({from:from,to:to})=>!from&&!to||!validateDateMath(from)||!validateDateMath(to)),updateRanges=Object(external_kbnSharedDeps_React_.useCallback)(rangeValues=>{setValue(rangeValues.map(range=>Object(external_kbnSharedDeps_Lodash_.omit)(range,"id"))),setRanges(rangeValues)},[setValue]),onAddRange=Object(external_kbnSharedDeps_React_.useCallback)(()=>updateRanges([...ranges,{id:generateId()}]),[ranges,updateRanges]);useMount_default()(()=>{value.length||onAddRange()}),Object(external_kbnSharedDeps_React_.useEffect)(()=>{(value.length!==ranges.length||value.some((range,index)=>!Object(external_kbnSharedDeps_Lodash_.isEqual)(range,Object(external_kbnSharedDeps_Lodash_.omit)(ranges[index],"id"))))&&setRanges(value.map(range=>({...range,id:generateId()})))},[ranges,value]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{setValidity(!hasInvalidRange)},[hasInvalidRange,setValidity]);const onChangeRange=(id,key,newValue)=>updateRanges(ranges.map(range=>range.id===id?{...range,[key]:""===newValue?void 0:newValue}:range));return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{display:"rowCompressed",fullWidth:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{href:services.docLinks.links.date.dateMath,target:"_blank"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"visDefaultEditor.controls.dateRanges.acceptedDateFormatsLinkText",defaultMessage:"Acceptable date formats"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),ranges.map(({from:from,to:to,id:id},index)=>{const deleteBtnTitle=external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.dateRanges.removeRangeButtonAriaLabel",{defaultMessage:"Remove the range of {from} to {to}",values:{from:from||"−∞",to:to||"+∞"}}),areBothEmpty=!from&&!to;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,{key:id},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{responsive:!1,gutterSize:"s",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldText,{"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.dateRanges.fromColumnLabel",{defaultMessage:"From",description:"Beginning of a date range, e.g. *From* 2018-02-26 To 2018-02-28"}),compressed:!0,fullWidth:!0,isInvalid:areBothEmpty||!validateDateMath(from),placeholder:"−∞",value:from||"",onChange:ev=>onChangeRange(id,"from",ev.target.value),"data-test-subj":`visEditorDateRange${index}__from`})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{type:"sortRight",color:"subdued"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldText,{"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.dateRanges.toColumnLabel",{defaultMessage:"To",description:"End of a date range, e.g. From 2018-02-26 *To* 2018-02-28"}),"data-test-subj":`visEditorDateRange${index}__to`,compressed:!0,fullWidth:!0,isInvalid:areBothEmpty||!validateDateMath(to),placeholder:"+∞",value:to||"",onChange:ev=>onChangeRange(id,"to",ev.target.value)})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{title:deleteBtnTitle,"aria-label":deleteBtnTitle,disabled:1===value.length,color:"danger",iconType:"trash",onClick:()=>(id=>updateRanges(ranges.filter(range=>range.id!==id)))(id)}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"xs"}))}),hasInvalidRange&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormErrorText,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"visDefaultEditor.controls.dateRanges.errorMessage",defaultMessage:"Each range should have at least one valid date."})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{iconType:"plusInCircleFilled",onClick:onAddRange,size:"xs","data-test-subj":"visEditorAddDateRange"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"visDefaultEditor.controls.dateRanges.addRangeButtonLabel",defaultMessage:"Add range"})))))}},[data_public_.BUCKET_TYPES.FILTERS]:{filters:function({agg:agg,value:value=[],setValue:setValue}){const[filters,setFilters]=Object(external_kbnSharedDeps_React_.useState)(()=>value.map(filter=>({...filter,id:filters_generateId()})));useMount_default()(()=>{setValue(filters.map(filter=>Object(external_kbnSharedDeps_Lodash_.omit)({...filter,input:filter.input},"id")))}),Object(external_kbnSharedDeps_React_.useEffect)(()=>{(value.length!==filters.length||value.some((filter,index)=>!Object(external_kbnSharedDeps_Lodash_.isEqual)(filter,Object(external_kbnSharedDeps_Lodash_.omit)(filters[index],"id"))))&&setFilters(value.map(filter=>({...filter,id:filters_generateId()})))},[filters,value]);const updateFilters=updatedFilters=>{setValue(updatedFilters.map(filter=>Object(external_kbnSharedDeps_Lodash_.omit)(filter,"id"))),setFilters(updatedFilters)},{services:services}=Object(public_.useKibana)(),onRemoveFilter=id=>updateFilters(filters.filter(filter=>filter.id!==id)),onChangeValue=(id,query,label)=>updateFilters(filters.map(filter=>filter.id===id?{...filter,input:query,label:label}:filter));return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),filters.map(({input:input,label:label,id:id},arrayIndex)=>external_kbnSharedDeps_React_default.a.createElement(FilterRow,{key:id,id:id,arrayIndex:arrayIndex,customLabel:label,value:input,autoFocus:arrayIndex===filters.length-1,disableRemove:0===arrayIndex&&1===filters.length,dataTestSubj:`visEditorFilterInput_${agg.id}_${arrayIndex}`,agg:agg,onChangeValue:onChangeValue,onRemoveFilter:onRemoveFilter})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{iconType:"plusInCircle",fill:!0,fullWidth:!0,onClick:()=>updateFilters([...filters,{input:services.data.query.queryString.getDefaultQuery(),label:"",id:filters_generateId()}]),size:"s","data-test-subj":"visEditorAddFilterButton"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"visDefaultEditor.controls.filters.addFilterButtonLabel",defaultMessage:"Add filter"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}))}},[data_public_.BUCKET_TYPES.GEOHASH_GRID]:{autoPrecision:function({value:value=!1,setValue:setValue}){const label=external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.changePrecisionLabel",{defaultMessage:"Change precision on map zoom"});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{display:"rowCompressed"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSwitch,{compressed:!0,label:label,checked:value,onChange:ev=>setValue(ev.target.checked)}))},precision:function({agg:agg,value:value,setValue:setValue}){const{services:services}=Object(public_.useKibana)(),label=external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.precisionLabel",{defaultMessage:"Precision"});return agg.params.autoPrecision?null:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:label,display:"rowCompressed"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiRange,{min:1,max:services.uiSettings.get("visualization:tileMap:maxPrecision"),value:value||"",onChange:ev=>setValue(Number(ev.currentTarget.value)),"data-test-subj":"visEditorMapPrecision"+agg.id,showValue:!0,compressed:!0}))},useGeocentroid:function({value:value=!1,setValue:setValue}){const label=external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.placeMarkersOffGridLabel",{defaultMessage:"Place markers off grid (use geocentroid)"});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{display:"rowCompressed"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSwitch,{compressed:!0,label:label,checked:value,onChange:ev=>setValue(ev.target.checked)}))},isFilteredByCollar:function(props){return external_kbnSharedDeps_React_default.a.createElement(SwitchParamEditor,is_filtered_by_collar_extends({displayLabel:external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.onlyRequestDataAroundMapExtentLabel",{defaultMessage:"Only request data around map extent"}),displayToolTip:external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.onlyRequestDataAroundMapExtentTooltip",{defaultMessage:"Apply geo_bounding_box filter aggregation to narrow the subject area to the map view box with collar"}),dataTestSubj:"isFilteredByCollarCheckbox"},props))}},[data_public_.BUCKET_TYPES.HISTOGRAM]:{interval:function({agg:agg,editorConfig:editorConfig,showValidation:showValidation,value:value,setTouched:setTouched,setValidity:setValidity,setValue:setValue}){const field=agg.getField(),fieldSupportsAuto=!field||"number"===field.type,isAutoChecked=fieldSupportsAuto&&(value=>"auto"===value)(value),base=Object(external_kbnSharedDeps_Lodash_.get)(editorConfig,"interval.base"),min=base||0,isValid=""!==value&&void 0!==value&&(isAutoChecked||Number(value)>=min);Object(external_kbnSharedDeps_React_.useEffect)(()=>{setValidity(isValid)},[isValid,setValidity]);const onChange=Object(external_kbnSharedDeps_React_.useCallback)(({target:target})=>setValue(isNaN(target.valueAsNumber)?"":target.valueAsNumber),[setValue]),onAutoSwitchChange=Object(external_kbnSharedDeps_React_.useCallback)(e=>{const isAutoSwitchChecked=e.target.checked;setValue(isAutoSwitchChecked?"auto":"")},[setValue]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{display:"rowCompressed",label:number_interval_label,fullWidth:!0,isInvalid:showValidation&&!isValid,helpText:Object(external_kbnSharedDeps_Lodash_.get)(editorConfig,"interval.help")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s",responsive:!1,direction:"column"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSwitch,{label:useAutoIntervalLabel,onChange:onAutoSwitchChange,checked:isAutoChecked,compressed:!0,disabled:!fieldSupportsAuto,"data-test-subj":"visEditorIntervalSwitch"+agg.id})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldNumber,{value:isAutoChecked?"":value,min:min,step:base||"any","data-test-subj":"visEditorInterval"+agg.id,isInvalid:showValidation&&!isValid,onChange:onChange,onBlur:setTouched,disabled:isAutoChecked,fullWidth:!0,compressed:!0,placeholder:isAutoChecked?autoIntervalIsUsedPlaceholder:selectIntervalPlaceholder}))))},maxBars:function({disabled:disabled,iconTip:iconTip,value:value,setValue:setValue,showValidation:showValidation,setValidity:setValidity,setTouched:setTouched}){var _services$uiSettings;const{services:services}=Object(public_.useKibana)(),uiSettingMaxBars=null===(_services$uiSettings=services.uiSettings)||void 0===_services$uiSettings?void 0:_services$uiSettings.get(data_public_.UI_SETTINGS.HISTOGRAM_MAX_BARS),isValid=disabled||void 0===value||""===value||Number(value)>0||value<uiSettingMaxBars;Object(external_kbnSharedDeps_React_.useEffect)(()=>{setValidity(isValid)},[isValid,setValidity]);const onChange=Object(external_kbnSharedDeps_React_.useCallback)(ev=>setValue(""===ev.target.value?"":parseFloat(ev.target.value)),[setValue]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:max_bars_label,fullWidth:!0,isInvalid:!!showValidation&&!isValid,display:"rowCompressed"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldNumber,{value:value||"",placeholder:autoPlaceholder,onChange:onChange,min:1,fullWidth:!0,compressed:!0,max:uiSettingMaxBars,isInvalid:!!showValidation&&!isValid,onBlur:setTouched,disabled:disabled,"data-test-subj":"maxBarsParamEditor"}))},min_doc_count:function(props){return external_kbnSharedDeps_React_default.a.createElement(SwitchParamEditor,min_doc_count_extends({displayLabel:external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.showEmptyBucketsLabel",{defaultMessage:"Show empty buckets"}),displayToolTip:external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.showEmptyBucketsTooltip",{defaultMessage:"Show all buckets, not only the buckets with results"})},props))},has_extended_bounds:function(props){const{agg:agg,setValue:setValue,value:value}=props,minDocCount=Object(external_kbnSharedDeps_React_.useRef)(agg.params.min_doc_count);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{minDocCount.current!==agg.params.min_doc_count&&(minDocCount.current=agg.params.min_doc_count,setValue(value&&agg.params.min_doc_count))},[agg.params.min_doc_count,setValue,value]),external_kbnSharedDeps_React_default.a.createElement(SwitchParamEditor,has_extended_bounds_extends({},props,{displayLabel:external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.extendedBoundsLabel",{defaultMessage:"Extend bounds"}),displayToolTip:external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.extendedBoundsTooltip",{defaultMessage:"Min and Max do not filter the results, but rather extend the bounds of the result set."}),disabled:!props.agg.params.min_doc_count||!(isType("number")(props.agg)||isType("date")(props.agg))}))},extended_bounds:function({value:value={},setValue:setValue,setValidity:setValidity,showValidation:showValidation,setTouched:setTouched}){const minLabel=external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.extendedBounds.minLabel",{defaultMessage:"Min"}),maxLabel=external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.extendedBounds.maxLabel",{defaultMessage:"Max"}),isValid=function({min:min,max:max}){return""!==min&&""!==max&&max>=min}(value);let error;isValid||(error=external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.extendedBounds.errorMessage",{defaultMessage:"Min should be less than or equal to Max."})),Object(controls_utils.g)(setValidity,isValid);const handleChange=(ev,name)=>{setValue({...value,[name]:""===ev.target.value?"":parseFloat(ev.target.value)})};return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{fullWidth:!0,isInvalid:!!showValidation&&!isValid,error:error},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s",responsive:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldNumber,{value:Object(external_kbnSharedDeps_Lodash_.isUndefined)(value.min)?"":value.min,onChange:ev=>handleChange(ev,"min"),onBlur:setTouched,fullWidth:!0,isInvalid:!!showValidation&&!isValid,"aria-label":minLabel,prepend:minLabel,compressed:!0})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldNumber,{value:Object(external_kbnSharedDeps_Lodash_.isUndefined)(value.max)?"":value.max,onChange:ev=>handleChange(ev,"max"),onBlur:setTouched,fullWidth:!0,isInvalid:!!showValidation&&!isValid,"aria-label":maxLabel,prepend:maxLabel,compressed:!0}))))}},[data_public_.BUCKET_TYPES.IP_RANGE]:{ipRangeType:function({agg:agg,value:value,setValue:setValue}){const options=[{id:"visEditorIpRangeFromToLabel"+agg.id,label:external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.ipRanges.fromToButtonLabel",{defaultMessage:"From/to"})},{id:"visEditorIpRangeCidrLabel"+agg.id,label:external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.ipRanges.cidrMasksButtonLabel",{defaultMessage:"CIDR masks"})}];return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonGroup,{isFullWidth:!0,onChange:optionId=>{setValue(optionId===options[0].id?IpRangeTypes.FROM_TO:IpRangeTypes.MASK)},idSelected:value===IpRangeTypes.FROM_TO?options[0].id:options[1].id,options:options,legend:external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.ipRangesAriaLabel",{defaultMessage:"IP ranges"})}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}))},ranges:function({agg:agg,value:value={fromTo:[],mask:[]},setTouched:setTouched,setValue:setValue,setValidity:setValidity,showValidation:showValidation}){const handleMaskListChange=Object(external_kbnSharedDeps_React_.useCallback)(items=>setValue({...value,[IpRangeTypes.MASK]:items}),[setValue,value]),handleFromToListChange=Object(external_kbnSharedDeps_React_.useCallback)(items=>setValue({...value,[IpRangeTypes.FROM_TO]:items}),[setValue,value]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{fullWidth:!0,id:"visEditorIpRange"+agg.id,display:"rowCompressed"},agg.params.ipRangeType===IpRangeTypes.MASK?external_kbnSharedDeps_React_default.a.createElement(MaskList,{list:value.mask,showValidation:showValidation,onBlur:setTouched,onChange:handleMaskListChange,setValidity:setValidity}):external_kbnSharedDeps_React_default.a.createElement(FromToList,{list:value.fromTo,showValidation:showValidation,onBlur:setTouched,onChange:handleFromToListChange,setValidity:setValidity}))}},[data_public_.BUCKET_TYPES.RANGE]:{ranges:props=>external_kbnSharedDeps_React_default.a.createElement(controls_ranges.b,{value:props.value,setValue:props.setValue})},[data_public_.BUCKET_TYPES.SIGNIFICANT_TERMS]:{size:SizeParamEditor},[data_public_.BUCKET_TYPES.TERMS]:{include:IncludeExcludeParamEditor,exclude:IncludeExcludeParamEditor,orderBy:function({agg:agg,value:value,showValidation:showValidation,setValue:setValue,setValidity:setValidity,setTouched:setTouched,metricAggs:metricAggs}){const label=external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.orderAgg.orderByLabel",{defaultMessage:"Order by"}),isValid=!!value;Object(controls_utils.g)(setValidity,isValid),useMount_default()(()=>{if(!value){let respAgg={id:"_key"};metricAggs&&(respAgg=metricAggs.filter(isCompatibleAgg)[0]||respAgg),setValue(respAgg.id)}}),Object(controls_utils.e)(setValue,termsAggFilter,metricAggs,value,"_key");const options=Object(controls_utils.d)(termsAggFilter,metricAggs,order_by_DEFAULT_OPTIONS);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:label,fullWidth:!0,isInvalid:showValidation&&!isValid,display:"rowCompressed"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSelect,{options:options,value:value,onChange:ev=>setValue(ev.target.value),fullWidth:!0,compressed:!0,isInvalid:showValidation&&!isValid,onBlur:setTouched,"data-test-subj":"visEditorOrderBy"+agg.id}))},orderAgg:function({agg:agg,aggParam:aggParam,formIsTouched:formIsTouched,value:value,metricAggs:metricAggs,state:state,setValue:setValue,setValidity:setValidity,setTouched:setTouched,schemas:schemas}){const orderBy=agg.params.orderBy;Object(external_kbnSharedDeps_React_.useEffect)(()=>{"custom"!==orderBy||value||setValue(aggParam.makeAgg(agg)),"custom"!==orderBy&&value&&setValue(void 0)},[agg,aggParam,orderBy,setValue,value]);const{onAggTypeChange:onAggTypeChange,setAggParamValue:setAggParamValue}=Object(controls_utils.f)(agg,aggParam,value,setValue);return agg.params.orderAgg?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(DefaultEditorAggParams,{agg:value,allowedAggs:aggParam.allowedAggs,hideCustomLabel:!0,groupName:data_public_.AggGroupNames.Metrics,className:"visEditorAgg__subAgg",formIsTouched:formIsTouched,indexPattern:agg.getIndexPattern(),metricAggs:metricAggs,state:state,setAggParamValue:setAggParamValue,onAggTypeChange:onAggTypeChange,setValidity:setValidity,setTouched:setTouched,schemas:schemas})):null},order:Object(controls_utils.h)(OrderParamEditor),size:Object(controls_utils.h)(SizeParamEditor),otherBucket:function(props){return external_kbnSharedDeps_React_default.a.createElement(SwitchParamEditor,other_bucket_extends({dataTestSubj:"otherBucketSwitch",displayLabel:external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.otherBucket.groupValuesLabel",{defaultMessage:"Group other values in separate bucket"}),displayToolTip:external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.otherBucket.groupValuesTooltip",{defaultMessage:"Values not in the top N are grouped in this bucket. To include documents with missing values, enable 'Show missing values'."})},props))},missingBucket:function(props){const fieldTypeIsNotString=!data_public_.search.aggs.isStringType(props.agg),{setValue:setValue}=props;return Object(external_kbnSharedDeps_React_.useEffect)(()=>{fieldTypeIsNotString&&setValue(!1)},[fieldTypeIsNotString,setValue]),external_kbnSharedDeps_React_default.a.createElement(SwitchParamEditor,missing_bucket_extends({},props,{dataTestSubj:"missingBucketSwitch",displayLabel:external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.otherBucket.showMissingValuesLabel",{defaultMessage:"Show missing values"}),displayToolTip:external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.otherBucket.showMissingValuesTooltip",{defaultMessage:'Only works for fields of type "string". When enabled, include documents with missing values in the search. If this bucket is in the top N, it appears in the chart. If not in the top N, and you enable "Group other values in separate bucket", Elasticsearch adds the missing values to the "other" bucket.'}),disabled:fieldTypeIsNotString}))}}},metrics={[data_public_.METRIC_TYPES.TOP_HITS]:{field:function(props){const compatibleAggs=getCompatibleAggs(props.agg);let customError;return props.value&&!compatibleAggs.length&&(customError=external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.aggregateWith.noAggsErrorTooltip",{defaultMessage:"The chosen field has no compatible aggregations."})),external_kbnSharedDeps_React_default.a.createElement(FieldParamEditor,top_field_extends({},props,{customError:customError}))},aggregate:Object(controls_utils.h)((function({agg:agg,aggParam:aggParam,value:value,showValidation:showValidation,setValue:setValue,setValidity:setValidity,setTouched:setTouched}){const isFirstRun=Object(external_kbnSharedDeps_React_.useRef)(!0),fieldType=agg.params.field&&agg.params.field.type,emptyValue={text:"",value:"EMPTY_VALUE",disabled:!0,hidden:!0},filteredOptions=getCompatibleAggs(agg).map(({text:text,value:val})=>({text:text,value:val})).sort((a,b)=>a.text.toLowerCase().localeCompare(b.text.toLowerCase())),options=[emptyValue,...filteredOptions],disabled=fieldType&&!filteredOptions.length,isValid=disabled||!!value,label=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"visDefaultEditor.controls.aggregateWithLabel",defaultMessage:"Aggregate with"})," ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIconTip,{position:"right",type:"questionInCircle",content:external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.aggregateWithTooltip",{defaultMessage:"Choose a strategy for combining multiple hits or a multi-valued field into a single metric."})}));return Object(external_kbnSharedDeps_React_.useEffect)(()=>{setValidity(isValid)},[isValid,setValidity]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{if(isFirstRun.current)isFirstRun.current=!1;else{if(value){if(aggParam.options.find(opt=>opt.value===value.value))return;setValue()}1===filteredOptions.length&&setValue(aggParam.options.find(opt=>opt.value===filteredOptions[0].value))}},[aggParam.options,fieldType,filteredOptions,setValue,value]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:label,fullWidth:!0,isInvalid:!!showValidation&&!isValid,display:"rowCompressed"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSelect,{options:options,value:value?value.value:emptyValue.value,onChange:event=>{event.target.value===emptyValue.value?setValue():setValue(aggParam.options.find(opt=>opt.value===event.target.value))},fullWidth:!0,compressed:!0,isInvalid:!!showValidation&&!isValid,disabled:disabled,onBlur:setTouched,"data-test-subj":"visDefaultEditorAggregateWith"}))})),size:Object(controls_utils.h)((function(props){const iconTip=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null," ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIconTip,{position:"right",content:external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.sizeTooltip",{defaultMessage:"Request top-K hits. Multiple hits will be combined via 'aggregate with'."}),type:"questionInCircle"})),disabled=props.agg.params.field&&props.agg.params.field.type&&!getCompatibleAggs(props.agg).length;return external_kbnSharedDeps_React_default.a.createElement(SizeParamEditor,top_size_extends({},props,{iconTip:iconTip,disabled:disabled}))})),sortField:function(props){const customLabel=external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.sortOnLabel",{defaultMessage:"Sort on"});return external_kbnSharedDeps_React_default.a.createElement(FieldParamEditor,top_sort_field_extends({},props,{customLabel:customLabel}))},sortOrder:OrderParamEditor},[data_public_.METRIC_TYPES.PERCENTILES]:{percents:function({agg:agg,showValidation:showValidation,value:value=[],setTouched:setTouched,setValidity:setValidity,setValue:setValue}){const label=external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.percentiles.percentsLabel",{defaultMessage:"Percents"}),[isValid,setIsValid]=Object(external_kbnSharedDeps_React_.useState)(!0),setModelValidity=Object(external_kbnSharedDeps_React_.useCallback)(isListValid=>{setIsValid(isListValid),setValidity(isListValid)},[setValidity]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:label,labelType:"legend",fullWidth:!0,id:"visEditorPercentileLabel"+agg.id,isInvalid:!!showValidation&&!isValid,display:"rowCompressed"},external_kbnSharedDeps_React_default.a.createElement(NumberList,{labelledbyId:`visEditorPercentileLabel${agg.id}-legend`,numberArray:value,range:"[0,100]",disallowDuplicates:!0,unitName:external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.percentileRanks.percentUnitNameText",{defaultMessage:"percent"}),showValidation:showValidation,onChange:setValue,setTouched:setTouched,setValidity:setModelValidity}))}},[data_public_.METRIC_TYPES.PERCENTILE_RANKS]:{values:function({agg:agg,showValidation:showValidation,value:value=[],setTouched:setTouched,setValidity:setValidity,setValue:setValue}){const label=external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.percentileRanks.valuesLabel",{defaultMessage:"Values"}),[isValid,setIsValid]=Object(external_kbnSharedDeps_React_.useState)(!0),setModelValidity=Object(external_kbnSharedDeps_React_.useCallback)(isListValid=>{setIsValid(isListValid),setValidity(isListValid)},[setValidity]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:label,labelType:"legend",fullWidth:!0,id:"visEditorPercentileRanksLabel"+agg.id,isInvalid:!!showValidation&&!isValid,display:"rowCompressed","data-test-subj":"visEditorPercentileRanks"},external_kbnSharedDeps_React_default.a.createElement(NumberList,{labelledbyId:`visEditorPercentileRanksLabel${agg.id}-legend`,numberArray:value,range:"[-Infinity,Infinity]",unitName:external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.percentileRanks.valueUnitNameText",{defaultMessage:"value"}),validateAscendingOrder:!0,showValidation:showValidation,onChange:setValue,setTouched:setTouched,setValidity:setModelValidity}))}}},aggParamsMap={common:{string:StringParamEditor,json:function({showValidation:showValidation,value:value="",setValidity:setValidity,setValue:setValue,setTouched:setTouched}){const[isFieldValid,setFieldValidity]=Object(external_kbnSharedDeps_React_.useState)(!0),editorTooltipText=Object(external_kbnSharedDeps_React_.useMemo)(()=>external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.jsonInputTooltip",{defaultMessage:"Any JSON formatted properties you add here will be merged with the elasticsearch aggregation definition for this section. For example 'shard_size' on a terms aggregation."}),[]),jsonEditorLabelText=Object(external_kbnSharedDeps_React_.useMemo)(()=>external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.jsonInputLabel",{defaultMessage:"JSON input"}),[]),label=Object(external_kbnSharedDeps_React_.useMemo)(()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,jsonEditorLabelText," ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIconTip,{position:"right",content:editorTooltipText,type:"questionInCircle"})),[jsonEditorLabelText,editorTooltipText]),onChange=Object(external_kbnSharedDeps_React_.useCallback)(newValue=>{setValue(newValue);let isJsonValid=!0;try{newValue&&JSON.parse(newValue)}catch(e){isJsonValid=!1}setFieldValidity(isJsonValid),setValidity(isJsonValid)},[setValidity,setFieldValidity,setValue]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:label,isInvalid:!!showValidation&&!isFieldValid,fullWidth:!0,display:"rowCompressed",onBlur:setTouched},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(public_.CodeEditor,{"aria-label":jsonEditorLabelText,"aria-describedby":"jsonEditorDescription",languageId:external_kbnSharedDeps_KbnMonaco_.XJsonLang.ID,languageConfiguration:{autoClosingPairs:[{open:"{",close:"}"}]},width:"100%",height:"250px",value:value,onChange:onChange,options:{renderValidationDecorations:value?"on":"off",lineNumbers:"on",fontSize:14,minimap:{enabled:!1},scrollBeyondLastLine:!1,folding:!0,wordWrap:"on",wrappingIndent:"indent",automaticLayout:!0}}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiScreenReaderOnly,null,external_kbnSharedDeps_React_default.a.createElement("p",{id:"jsonEditorDescription"},editorTooltipText))))},field:FieldParamEditor},[siblingPipelineType]:{customBucket:SubMetricParamEditor,customMetric:SubMetricParamEditor},[parentPipelineType]:{metricAgg:function({agg:agg,value:value,showValidation:showValidation,setValue:setValue,setValidity:setValidity,setTouched:setTouched,metricAggs:metricAggs=[]}){const label=external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.metricLabel",{defaultMessage:"Metric"}),isValid=!!value;Object(controls_utils.g)(setValidity,isValid),Object(controls_utils.e)(setValue,metric_agg_aggFilter,metricAggs,value);const filteredMetrics=Object(external_kbnSharedDeps_React_.useMemo)(()=>metricAggs.filter(respAgg=>respAgg.type.name!==agg.type.name),[metricAggs,agg.type.name]),options=Object(controls_utils.d)(metric_agg_aggFilter,filteredMetrics,DEFAULT_OPTIONS),onChange=Object(external_kbnSharedDeps_React_.useCallback)(ev=>setValue(ev.target.value),[setValue]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:label,fullWidth:!0,isInvalid:showValidation&&!isValid,display:"rowCompressed"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSelect,{compressed:!0,fullWidth:!0,options:options,value:value||"EMPTY_VALUE",onChange:onChange,isInvalid:showValidation&&!isValid,onBlur:setTouched,"data-test-subj":"visEditorSubAggMetric"+agg.id}))},customMetric:function({agg:agg,aggParam:aggParam,formIsTouched:formIsTouched,metricAggs:metricAggs,state:state,setValue:setValue,setValidity:setValidity,setTouched:setTouched,schemas:schemas}){Object(external_kbnSharedDeps_React_.useEffect)(()=>{"custom"!==agg.params.metricAgg?setValue(void 0):agg.params.customMetric||setValue(aggParam.makeAgg(agg))},[metricAggs,agg,setValue,aggParam]);const{onAggTypeChange:onAggTypeChange,setAggParamValue:setAggParamValue}=Object(controls_utils.f)(agg,aggParam,agg.params.customMetric,setValue);return"custom"===agg.params.metricAgg&&agg.params.customMetric?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(DefaultEditorAggParams,{agg:agg.params.customMetric,allowedAggs:aggParam.allowedAggs,groupName:data_public_.AggGroupNames.Metrics,className:"visEditorAgg__subAgg",formIsTouched:formIsTouched,indexPattern:agg.getIndexPattern(),metricAggs:metricAggs,state:state,setAggParamValue:setAggParamValue,onAggTypeChange:onAggTypeChange,setValidity:setValidity,setTouched:setTouched,schemas:schemas,hideCustomLabel:!0})):null}},[data_public_.AggGroupNames.Buckets]:buckets,[data_public_.AggGroupNames.Metrics]:metrics};function getAggParamsToRender({agg:agg,editorConfig:editorConfig,metricAggs:metricAggs,state:state,schemas:schemas,hideCustomLabel:hideCustomLabel}){const params={basic:[],advanced:[]},paramsToRender=agg.type&&agg.type.params.filter(param=>!Object(external_kbnSharedDeps_Lodash_.get)(editorConfig,[param.name,"hidden"],!1))||[],schema=getSchemaByName(schemas,agg.schema);return paramsToRender.forEach((param,index)=>{let fields,indexedFields=[];if(hideCustomLabel&&"customLabel"===param.name)return;if("field"===param.type){let availableFields=param.getAvailableFields(agg);if("top_hits"===agg.type.name&&"field"===param.name){Object(external_kbnSharedDeps_Lodash_.get)(schema,`aggSettings[${agg.type.name}].allowStrings`,!1)||(availableFields=availableFields.filter(field=>"number"===field.type))}if(fields=function(fields,aggConfig){return fields.filter(field=>agg_type_field_filters_filters.every(filter=>filter(field,aggConfig)))}(availableFields,agg),indexedFields=Object(utils.a)(fields,"type","displayName","name"),fields&&!indexedFields.length&&index>0)return}const type=param.advanced?"advanced":"basic";let paramEditor;if(agg.type.subtype&&aggParamsMap[agg.type.subtype])paramEditor=Object(external_kbnSharedDeps_Lodash_.get)(aggParamsMap,[agg.type.subtype,param.name]);else{const aggType=agg.type.type,aggName=agg.type.name,aggParams=Object(external_kbnSharedDeps_Lodash_.get)(aggParamsMap,[aggType,aggName],{});paramEditor=Object(external_kbnSharedDeps_Lodash_.get)(aggParams,param.name)}paramEditor||(paramEditor=Object(external_kbnSharedDeps_Lodash_.get)(aggParamsMap,["common",param.type])),paramEditor&&params[type].push({agg:agg,aggParam:param,editorConfig:editorConfig,indexedFields:indexedFields,paramEditor:paramEditor,metricAggs:metricAggs,state:state,value:agg.params[param.name],schemas:schemas,hideCustomLabel:hideCustomLabel})}),params}function getAggTypeOptions(aggTypes,agg,indexPattern,groupName,allowedAggs){const aggTypeOptions=function(aggTypes,indexPattern,aggConfig,aggFilter){return aggTypes.filter(aggType=>agg_type_filters_filters.every(filter=>filter(aggType,indexPattern,aggConfig,aggFilter)))}(aggTypes[groupName],indexPattern,agg,allowedAggs);return Object(utils.a)(aggTypeOptions,"subtype","title")}function buildAggDescription(agg){let description="";if(agg.type&&agg.type.makeLabel)try{description=agg.type.makeLabel(agg)}catch(e){}return description}function agg_params_extends(){return(agg_params_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function DefaultEditorAggParams({agg:agg,aggError:aggError,aggIndex:aggIndex=0,aggIsTooLow:aggIsTooLow=!1,className:className,disabledParams:disabledParams,groupName:groupName,formIsTouched:formIsTouched,indexPattern:indexPattern,metricAggs:metricAggs,state:state,setAggParamValue:setAggParamValue,onAggTypeChange:onAggTypeChange,setTouched:setTouched,setValidity:setValidity,schemas:schemas,allowedAggs:allowedAggs=[],hideCustomLabel:hideCustomLabel=!1}){var _agg$type,_agg$params,_agg$params$field;const schema=Object(external_kbnSharedDeps_React_.useMemo)(()=>getSchemaByName(schemas,agg.schema),[agg.schema,schemas]),aggFilter=Object(external_kbnSharedDeps_React_.useMemo)(()=>[...allowedAggs,...schema.aggFilter||[]],[allowedAggs,schema.aggFilter]),{services:services}=Object(public_.useKibana)(),aggTypes=Object(external_kbnSharedDeps_React_.useMemo)(()=>services.data.search.aggs.types.getAll(),[services.data.search.aggs.types]),groupedAggTypeOptions=Object(external_kbnSharedDeps_React_.useMemo)(()=>getAggTypeOptions(aggTypes,agg,indexPattern,groupName,aggFilter),[aggTypes,agg,indexPattern,groupName,aggFilter]),error=aggIsTooLow?external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.aggParams.errors.aggWrongRunOrderErrorMessage",{defaultMessage:'"{schema}" aggs must run before all other buckets!',values:{schema:schema.title}}):"",aggTypeName=null===(_agg$type=agg.type)||void 0===_agg$type?void 0:_agg$type.name,fieldName=null===(_agg$params=agg.params)||void 0===_agg$params||null===(_agg$params$field=_agg$params.field)||void 0===_agg$params$field?void 0:_agg$params$field.name,editorConfig=Object(external_kbnSharedDeps_React_.useMemo)(()=>function(indexPattern,aggTypeName,fieldName){const aggRestrictions=indexPattern.getAggregationRestrictions();if(!aggRestrictions||!aggTypeName||!fieldName)return{};if("terms"===aggTypeName)return{otherBucket:{hidden:!0},missingBucket:{hidden:!0}};const fieldAgg=aggRestrictions[aggTypeName]&&aggRestrictions[aggTypeName][fieldName];if(!fieldAgg)return{};if("histogram"===aggTypeName){const interval=fieldAgg.interval;return interval?{intervalBase:{fixedValue:interval},interval:{base:interval,help:external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.editorConfig.histogram.interval.helpText",{defaultMessage:"Must be a multiple of configuration interval: {interval}",values:{interval:interval}})}}:{}}if("date_histogram"===aggTypeName){const interval=fieldAgg.calendar_interval||fieldAgg.fixed_interval;return{useNormalizedEsInterval:{fixedValue:!1},interval:{default:interval,timeBase:interval,help:external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.editorConfig.dateHistogram.customInterval.helpText",{defaultMessage:"Must be a multiple of configuration interval: {interval}",values:{interval:interval}})}}}return{}}(indexPattern,aggTypeName,fieldName),[indexPattern,aggTypeName,fieldName]),params=Object(external_kbnSharedDeps_React_.useMemo)(()=>getAggParamsToRender({agg:agg,editorConfig:editorConfig,metricAggs:metricAggs,state:state,schemas:schemas,hideCustomLabel:hideCustomLabel}),[agg,editorConfig,metricAggs,state,schemas,hideCustomLabel]),allParams=[...params.basic,...params.advanced],[paramsState,onChangeParamsState]=Object(external_kbnSharedDeps_React_.useReducer)(aggParamsReducer,allParams,initAggParamsState),[aggType,onChangeAggType]=Object(external_kbnSharedDeps_React_.useReducer)(aggTypeReducer,{touched:!1,valid:!0}),isFormValid=!error&&aggType.valid&&Object.entries(paramsState).every(([,paramState])=>paramState.valid),isAllInvalidParamsTouched=!!error||function(aggType,aggTypeState,aggParams){if(!aggType)return aggTypeState.touched;const invalidParams=Object.values(aggParams).filter(param=>!param.valid);return!Object(external_kbnSharedDeps_Lodash_.isEmpty)(invalidParams)&&invalidParams.every(param=>param.touched)}(agg.type,aggType,paramsState),onAggSelect=Object(external_kbnSharedDeps_React_.useCallback)(value=>{agg.type!==value&&(onAggTypeChange(agg.id,value),onChangeParamsState({type:AGG_PARAMS_ACTION_KEYS.RESET}))},[onAggTypeChange,agg]);return useUnmount_default()(()=>setValidity(!0)),Object(external_kbnSharedDeps_React_.useEffect)(()=>{Object.entries(editorConfig).forEach(([param,paramConfig])=>{const paramOptions=agg.type.params.find(paramOption=>paramOption.name===param),hasFixedValue=paramConfig.hasOwnProperty("fixedValue"),hasDefault=paramConfig.hasOwnProperty("default");if(hasFixedValue||hasDefault){let newValue,property="fixedValue",typedParamConfig=paramConfig;hasDefault&&(property="default",typedParamConfig=paramConfig),newValue=paramOptions&&paramOptions.deserialize?paramOptions.deserialize(typedParamConfig[property]):typedParamConfig[property],agg.params[param]!==newValue&&setAggParamValue(agg.id,param,newValue)}})},[editorConfig]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{setTouched(!1)},[agg.type,setTouched]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{setValidity(isFormValid)},[isFormValid,agg.type,setValidity]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{setTouched(isAllInvalidParamsTouched)},[isAllInvalidParamsTouched,setTouched]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiForm,{className:className,isInvalid:!!error,error:error,"data-test-subj":"visAggEditorParams"},external_kbnSharedDeps_React_default.a.createElement(DefaultEditorAggSelect,{aggError:aggError,id:agg.id,indexPattern:indexPattern,value:agg.type,aggTypeOptions:groupedAggTypeOptions,isSubAggregation:aggIndex>=1&&groupName===data_public_.AggGroupNames.Buckets,showValidation:formIsTouched||aggType.touched,setValue:onAggSelect,onChangeAggType:onChangeAggType}),params.basic.map(param=>{const model=paramsState[param.aggParam.name]||{touched:!1,valid:!0};return external_kbnSharedDeps_React_default.a.createElement(DefaultEditorAggParam,agg_params_extends({key:`${param.aggParam.name}${agg.type?agg.type.name:""}`,disabled:disabledParams&&disabledParams.includes(param.aggParam.name),formIsTouched:formIsTouched,showValidation:formIsTouched||model.touched,setAggParamValue:setAggParamValue,onChangeParamsState:onChangeParamsState},param))}),params.advanced.length?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiAccordion,{id:"advancedAccordion","data-test-subj":"advancedParams-"+agg.id,buttonContent:external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.advancedToggle.advancedLinkLabel",{defaultMessage:"Advanced"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),params.advanced.map(param=>{const model=paramsState[param.aggParam.name]||{touched:!1,valid:!0};return external_kbnSharedDeps_React_default.a.createElement(DefaultEditorAggParam,agg_params_extends({key:`${param.aggParam.name}${agg.type?agg.type.name:""}`,disabled:disabledParams&&disabledParams.includes(param.aggParam.name),formIsTouched:formIsTouched,showValidation:formIsTouched||model.touched,setAggParamValue:setAggParamValue,onChangeParamsState:onChangeParamsState},param))}))):null)}let AGGS_ACTION_KEYS;function aggGroupReducer(state,action){const aggState=state[action.aggId]||{touched:!1,valid:!0};switch(action.type){case AGGS_ACTION_KEYS.TOUCHED:return{...state,[action.aggId]:{...aggState,touched:action.payload}};case AGGS_ACTION_KEYS.VALID:return{...state,[action.aggId]:{...aggState,valid:action.payload}};default:throw new Error}}function initAggsState(group){return group.reduce((state,agg)=>(state[agg.id]={touched:!1,valid:!0},state),{})}!function(AGGS_ACTION_KEYS){AGGS_ACTION_KEYS.TOUCHED="aggsTouched",AGGS_ACTION_KEYS.VALID="aggsValid"}(AGGS_ACTION_KEYS||(AGGS_ACTION_KEYS={}));const PARAMS_NAME="row",PARAMS_ROWS="visEditorSplitBy__true",PARAMS_COLUMNS="visEditorSplitBy__false";function RowsOrColumnsControl({editorStateParams:editorStateParams,setStateParamValue:setStateParamValue}){void 0===editorStateParams.row&&setStateParamValue(PARAMS_NAME,!0);const idSelected="visEditorSplitBy__"+editorStateParams.row,options=[{id:PARAMS_ROWS,label:external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.rowsLabel",{defaultMessage:"Rows"}),"data-test-subj":"visEditorSplitBy-Rows"},{id:PARAMS_COLUMNS,label:external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.columnsLabel",{defaultMessage:"Columns"}),"data-test-subj":"visEditorSplitBy-Columns"}],onChange=Object(external_kbnSharedDeps_React_.useCallback)(optionId=>setStateParamValue(PARAMS_NAME,optionId===PARAMS_ROWS),[setStateParamValue]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{display:"rowCompressed",fullWidth:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonGroup,{"data-test-subj":"visEditorSplitBy",legend:external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.splitByLegend",{defaultMessage:"Split chart by rows or columns."}),options:options,isFullWidth:!0,idSelected:idSelected,onChange:onChange})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}))}function RadiusRatioOptionControl({editorStateParams:editorStateParams,setStateParamValue:setStateParamValue}){const label=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"visDefaultEditor.controls.dotSizeRatioLabel",defaultMessage:"Dot size ratio"})," ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIconTip,{content:external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.controls.dotSizeRatioHelpText",{defaultMessage:"Change the ratio of the radius of the smallest point to the largest point."}),position:"right"}));useMount_default()(()=>{editorStateParams.radiusRatio||setStateParamValue("radiusRatio",50)});const onChange=Object(external_kbnSharedDeps_React_.useCallback)(e=>setStateParamValue("radiusRatio",parseFloat(e.currentTarget.value)),[setStateParamValue]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{fullWidth:!0,label:label,display:"rowCompressed"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiRange,{compressed:!0,fullWidth:!0,min:1,max:100,value:editorStateParams.radiusRatio||50,onChange:onChange,showRange:!0,showValue:!0,valueAppend:"%"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}))}function DefaultEditorAgg({agg:agg,aggIndex:aggIndex,aggIsTooLow:aggIsTooLow,dragHandleProps:dragHandleProps,formIsTouched:formIsTouched,groupName:groupName,isDisabled:isDisabled,isDraggable:isDraggable,isLastBucket:isLastBucket,isRemovable:isRemovable,metricAggs:metricAggs,lastParentPipelineAggTitle:lastParentPipelineAggTitle,state:state,setAggParamValue:setAggParamValue,setStateParamValue:setStateParamValue,onAggTypeChange:onAggTypeChange,onToggleEnableAgg:onToggleEnableAgg,removeAgg:removeAgg,setAggsState:setAggsState,schemas:schemas,timeRange:timeRange}){var _agg$type;const[isEditorOpen,setIsEditorOpen]=Object(external_kbnSharedDeps_React_.useState)(agg.brandNew),[validState,setValidState]=Object(external_kbnSharedDeps_React_.useState)(!0),showDescription=!isEditorOpen&&validState,showError=!isEditorOpen&&!validState,aggName=null===(_agg$type=agg.type)||void 0===_agg$type?void 0:_agg$type.name,schemaTitle=getSchemaByName(schemas,agg.schema).title;let disabledParams,aggError;const isLastBucketAgg=isLastBucket&&lastParentPipelineAggTitle&&agg.type;let SchemaComponent;"split"===agg.schema&&(SchemaComponent=RowsOrColumnsControl),"radius"===agg.schema&&(SchemaComponent=RadiusRatioOptionControl),isLastBucketAgg&&(["date_histogram","histogram"].includes(aggName)?disabledParams=["min_doc_count"]:aggError=external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.metrics.wrongLastBucketTypeErrorMessage",{defaultMessage:'Last bucket aggregation must be "Date Histogram" or "Histogram" when using "{type}" metric aggregation.',values:{type:lastParentPipelineAggTitle},description:"Date Histogram and Histogram should not be translated"}));const[aggDescription,setAggDescription]=Object(external_kbnSharedDeps_React_.useState)(buildAggDescription(agg));Object(external_kbnSharedDeps_React_.useEffect)(()=>{timeRange&&"date_histogram"===aggName&&agg.aggConfigs.setTimeRange(timeRange),setAggDescription(buildAggDescription(agg))},[agg,aggName,timeRange]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{isLastBucketAgg&&["date_histogram","histogram"].includes(aggName)&&setAggParamValue(agg.id,"min_doc_count","histogram"===aggName||0)},[aggName,isLastBucketAgg,agg.id,setAggParamValue]);const setTouched=Object(external_kbnSharedDeps_React_.useCallback)(touched=>{setAggsState({type:AGGS_ACTION_KEYS.TOUCHED,payload:touched,aggId:agg.id})},[agg.id,setAggsState]),setValidity=Object(external_kbnSharedDeps_React_.useCallback)(isValid=>{setAggsState({type:AGGS_ACTION_KEYS.VALID,payload:isValid,aggId:agg.id}),setValidState(isValid)},[agg.id,setAggsState]),onToggle=Object(external_kbnSharedDeps_React_.useCallback)(isOpen=>{setIsEditorOpen(isOpen),isOpen||setTouched(!0)},[setTouched]),buttonContent=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,schemaTitle||agg.schema," ",showDescription&&external_kbnSharedDeps_React_default.a.createElement("span",null,aggDescription));return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiAccordion,{id:"visEditorAggAccordion"+agg.id,initialIsOpen:isEditorOpen,buttonContent:buttonContent,buttonClassName:"eui-textTruncate",buttonContentClassName:"visEditorSidebar__aggGroupAccordionButtonContent eui-textTruncate",className:"visEditorSidebar__section visEditorSidebar__collapsible visEditorSidebar__collapsible--marginBottom","aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.agg.toggleEditorButtonAriaLabel",{defaultMessage:"Toggle {schema} editor",values:{schema:schemaTitle||agg.schema}}),"data-test-subj":"visEditorAggAccordion"+agg.id,extraAction:(()=>{var _agg$type2,_agg$type2$title;const actionIcons=[],aggTitle=null===(_agg$type2=agg.type)||void 0===_agg$type2||null===(_agg$type2$title=_agg$type2.title)||void 0===_agg$type2$title?void 0:_agg$type2$title.toLowerCase();return showError&&actionIcons.push({id:"hasErrors",color:"danger",type:"alert",tooltip:external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.agg.errorsAriaLabel",{defaultMessage:"{schemaTitle} {aggTitle} aggregation has errors",values:{aggTitle:aggTitle,schemaTitle:schemaTitle}}),dataTestSubj:"hasErrorsAggregationIcon"}),agg.enabled&&isRemovable&&actionIcons.push({id:"disableAggregation",color:"text",disabled:isDisabled,type:"eye",onClick:()=>onToggleEnableAgg(agg.id,!1),tooltip:external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.agg.disableAggButtonTooltip",{defaultMessage:"Disable {schemaTitle} {aggTitle} aggregation",values:{aggTitle:aggTitle,schemaTitle:schemaTitle}}),dataTestSubj:"toggleDisableAggregationBtn disable"}),agg.enabled||actionIcons.push({id:"enableAggregation",color:"text",type:"eyeClosed",onClick:()=>onToggleEnableAgg(agg.id,!0),tooltip:external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.agg.enableAggButtonTooltip",{defaultMessage:"Enable {schemaTitle} {aggTitle} aggregation",values:{aggTitle:aggTitle,schemaTitle:schemaTitle}}),dataTestSubj:"toggleDisableAggregationBtn enable"}),isDraggable&&actionIcons.push({id:"dragHandle",type:"grab",tooltip:external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.agg.modifyPriorityButtonTooltip",{defaultMessage:"Modify priority of {schemaTitle} {aggTitle} by dragging",values:{aggTitle:aggTitle,schemaTitle:schemaTitle}}),dataTestSubj:"dragHandleBtn"}),isRemovable&&actionIcons.push({id:"removeDimension",color:"danger",type:"cross",onClick:()=>removeAgg(agg.id),tooltip:external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.agg.removeDimensionButtonTooltip",{defaultMessage:"Remove {schemaTitle} {aggTitle} aggregation",values:{aggTitle:aggTitle,schemaTitle:schemaTitle}}),dataTestSubj:"removeDimensionBtn"}),external_kbnSharedDeps_React_default.a.createElement("div",dragHandleProps,actionIcons.map(icon=>"dragHandle"===icon.id?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIconTip,{key:icon.id,type:icon.type,content:icon.tooltip,iconProps:{"aria-label":icon.tooltip,"data-test-subj":icon.dataTestSubj},position:"bottom"}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{key:icon.id,position:"bottom",content:icon.tooltip},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{disabled:icon.disabled,iconType:icon.type,color:icon.color,onClick:icon.onClick,"aria-label":icon.tooltip,"data-test-subj":icon.dataTestSubj}))))})(),onToggle:onToggle},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),SchemaComponent&&external_kbnSharedDeps_React_default.a.createElement(SchemaComponent,{agg:agg,editorStateParams:state.params,setAggParamValue:setAggParamValue,setStateParamValue:setStateParamValue}),external_kbnSharedDeps_React_default.a.createElement(DefaultEditorAggParams,{agg:agg,aggError:aggError,aggIndex:aggIndex,aggIsTooLow:aggIsTooLow,disabledParams:disabledParams,formIsTouched:formIsTouched,groupName:groupName,indexPattern:agg.getIndexPattern(),metricAggs:metricAggs,state:state,setAggParamValue:setAggParamValue,onAggTypeChange:onAggTypeChange,setTouched:setTouched,setValidity:setValidity,schemas:schemas})))}function DefaultEditorAggAdd({group:group=[],groupName:groupName,schemas:schemas,addSchema:addSchema,stats:stats}){const[isPopoverOpen,setIsPopoverOpen]=Object(external_kbnSharedDeps_React_.useState)(!1),groupNameLabel=groupName===data_public_.AggGroupNames.Buckets?external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.aggAdd.bucketLabel",{defaultMessage:"bucket"}):external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.aggAdd.metricLabel",{defaultMessage:"metric"}),addButton=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{size:"xs",iconType:"plusInCircleFilled","data-test-subj":"visEditorAdd_"+groupName,onClick:()=>setIsPopoverOpen(!isPopoverOpen),"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.aggAdd.addGroupButtonLabel",{defaultMessage:"Add {groupNameLabel}",values:{groupNameLabel:groupNameLabel}})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"visDefaultEditor.aggAdd.addButtonLabel",defaultMessage:"Add"})),isSchemaDisabled=(schema,maxedCount)=>{var _schema$disabled;return null!==(_schema$disabled=schema.disabled)&&void 0!==_schema$disabled?_schema$disabled:maxedCount},maxTooltipText=external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.aggAdd.maxBuckets",{defaultMessage:"Max {groupNameLabel} count reached",values:{groupNameLabel:groupNameLabel}});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"center",responsive:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopover,{id:"addGroupButtonPopover_"+groupName,button:addButton,isOpen:isPopoverOpen,panelPaddingSize:"none",repositionOnScroll:!0,closePopover:()=>setIsPopoverOpen(!1)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopoverTitle,null,(groupName!==data_public_.AggGroupNames.Buckets||!stats.count)&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"visDefaultEditor.aggAdd.addGroupButtonLabel",defaultMessage:"Add {groupNameLabel}",values:{groupNameLabel:groupNameLabel}}),groupName===data_public_.AggGroupNames.Buckets&&stats.count>0&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"visDefaultEditor.aggAdd.addSubGroupButtonLabel",defaultMessage:"Add sub-{groupNameLabel}",values:{groupNameLabel:groupNameLabel}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenuPanel,{items:schemas.map(schema=>{var _schema$tooltip;const maxedCount=(schema=>group.filter(agg=>agg.schema===schema.name).length>=schema.max)(schema);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenuItem,{key:`${schema.name}_${schema.title}`,"data-test-subj":`visEditorAdd_${groupName}_${schema.title}`,disabled:isPopoverOpen&&isSchemaDisabled(schema,maxedCount),onClick:()=>(schema=>{setIsPopoverOpen(!1),addSchema(schema)})(schema),toolTipContent:null!==(_schema$tooltip=schema.tooltip)&&void 0!==_schema$tooltip?_schema$tooltip:maxedCount?maxTooltipText:void 0},schema.title)})}))))}function DefaultEditorAggGroup({formIsTouched:formIsTouched,groupName:groupName,lastParentPipelineAggTitle:lastParentPipelineAggTitle,metricAggs:metricAggs,state:state,schemas:schemas=[],addSchema:addSchema,setAggParamValue:setAggParamValue,setStateParamValue:setStateParamValue,onAggTypeChange:onAggTypeChange,onToggleEnableAgg:onToggleEnableAgg,removeAgg:removeAgg,reorderAggs:reorderAggs,setTouched:setTouched,setValidity:setValidity,timeRange:timeRange}){const groupNameLabel=data_public_.AggGroupLabels[groupName],schemaNames=schemas.map(s=>s.name),group=Object(external_kbnSharedDeps_React_.useMemo)(()=>state.data.aggs.aggs.filter(agg=>agg.schema&&schemaNames.includes(agg.schema))||[],[state.data.aggs,schemaNames]),stats={max:0,count:group.length};schemas.forEach(schema=>{stats.max+=schema.max});const[aggsState,setAggsState]=Object(external_kbnSharedDeps_React_.useReducer)(aggGroupReducer,group,initAggsState),bucketsError=lastParentPipelineAggTitle&&groupName===data_public_.AggGroupNames.Buckets&&!group.length?external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.buckets.mustHaveBucketErrorMessage",{defaultMessage:'Add a bucket with "Date Histogram" or "Histogram" aggregation.',description:"Date Histogram and Histogram should not be translated"}):void 0,isGroupValid=!bucketsError&&Object.values(aggsState).every(item=>item.valid),isAllAggsTouched=function(aggsState){const invalidAggs=Object.values(aggsState).filter(agg=>!agg.valid);return!Object(external_kbnSharedDeps_Lodash_.isEmpty)(invalidAggs)&&invalidAggs.every(agg=>agg.touched)}(aggsState),isMetricAggregationDisabled=Object(external_kbnSharedDeps_React_.useMemo)(()=>groupName===data_public_.AggGroupNames.Metrics&&1===getEnabledMetricAggsCount(group),[groupName,group]);Object(external_kbnSharedDeps_React_.useEffect)(()=>{setTouched(isAllAggsTouched)},[isAllAggsTouched,setTouched]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{formIsTouched&&!isAllAggsTouched&&Object.keys(aggsState).map(([aggId])=>{setAggsState({type:AGGS_ACTION_KEYS.TOUCHED,payload:!0,aggId:aggId})})},[formIsTouched]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{setValidity("aggGroup__"+groupName,isGroupValid)},[groupName,isGroupValid,setValidity]);const onDragEnd=Object(external_kbnSharedDeps_React_.useCallback)(({source:source,destination:destination})=>{source&&destination&&reorderAggs(group[source.index],group[destination.index])},[reorderAggs,group]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDragDropContext,{onDragEnd:onDragEnd},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPanel,{"data-test-subj":groupName+"AggGroup",paddingSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("h3",null,groupNameLabel)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),bucketsError&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormErrorText,{"data-test-subj":"bucketsError"},bucketsError),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDroppable,{droppableId:"agg_group_dnd_"+groupName},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,group.map((agg,index)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDraggable,{key:agg.id,index:index,draggableId:`agg_group_dnd_${groupName}_${agg.id}`,customDragHandle:!0},provided=>external_kbnSharedDeps_React_default.a.createElement(DefaultEditorAgg,{agg:agg,aggIndex:index,aggIsTooLow:calcAggIsTooLow(agg,index,group,schemas),dragHandleProps:provided.dragHandleProps||null,formIsTouched:!!aggsState[agg.id]&&aggsState[agg.id].touched,groupName:groupName,isDraggable:stats.count>1,isLastBucket:groupName===data_public_.AggGroupNames.Buckets&&index===group.length-1,isRemovable:isAggRemovable(agg,group,schemas),isDisabled:"metric"===agg.schema&&isMetricAggregationDisabled,lastParentPipelineAggTitle:lastParentPipelineAggTitle,metricAggs:metricAggs,state:state,setAggParamValue:setAggParamValue,setStateParamValue:setStateParamValue,onAggTypeChange:onAggTypeChange,onToggleEnableAgg:onToggleEnableAgg,removeAgg:removeAgg,setAggsState:setAggsState,schemas:schemas,timeRange:timeRange}))))),stats.max>stats.count&&external_kbnSharedDeps_React_default.a.createElement(DefaultEditorAggAdd,{group:group,groupName:groupName,schemas:schemas,stats:stats,addSchema:addSchema})))}function data_tab_extends(){return(data_tab_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function DefaultEditorDataTab({dispatch:dispatch,formIsTouched:formIsTouched,metricAggs:metricAggs,schemas:schemas,state:state,setTouched:setTouched,setValidity:setValidity,setStateValue:setStateValue,timeRange:timeRange}){const lastParentPipelineAgg=Object(external_kbnSharedDeps_React_.useMemo)(()=>Object(external_kbnSharedDeps_Lodash_.findLast)(metricAggs,({type:type})=>type.subtype===data_public_.search.aggs.parentPipelineType),[metricAggs]),lastParentPipelineAggTitle=lastParentPipelineAgg&&lastParentPipelineAgg.type.title,addSchema=Object(external_kbnSharedDeps_React_.useCallback)(schema=>dispatch((schema=>({type:EditorStateActionTypes.ADD_NEW_AGG,payload:{schema:schema}}))(schema)),[dispatch]),onAggRemove=Object(external_kbnSharedDeps_React_.useCallback)(aggId=>dispatch(((aggId,schemas)=>({type:EditorStateActionTypes.REMOVE_AGG,payload:{aggId:aggId,schemas:schemas}}))(aggId,schemas.all||[])),[dispatch,schemas]),onReorderAggs=Object(external_kbnSharedDeps_React_.useCallback)((...props)=>dispatch(((sourceAgg,destinationAgg)=>({type:EditorStateActionTypes.REORDER_AGGS,payload:{sourceAgg:sourceAgg,destinationAgg:destinationAgg}}))(...props)),[dispatch]),onAggParamValueChange=Object(external_kbnSharedDeps_React_.useCallback)((...props)=>dispatch(((aggId,paramName,value)=>({type:EditorStateActionTypes.SET_AGG_PARAM_VALUE,payload:{aggId:aggId,paramName:paramName,value:value}}))(...props)),[dispatch]),onAggTypeChange=Object(external_kbnSharedDeps_React_.useCallback)((...props)=>dispatch(((aggId,value)=>({type:EditorStateActionTypes.CHANGE_AGG_TYPE,payload:{aggId:aggId,value:value}}))(...props)),[dispatch]),onToggleEnableAgg=Object(external_kbnSharedDeps_React_.useCallback)((...props)=>dispatch(((aggId,enabled)=>({type:EditorStateActionTypes.TOGGLE_ENABLED_AGG,payload:{aggId:aggId,enabled:enabled}}))(...props)),[dispatch]),commonProps={addSchema:addSchema,formIsTouched:formIsTouched,lastParentPipelineAggTitle:lastParentPipelineAggTitle,metricAggs:metricAggs,state:state,reorderAggs:onReorderAggs,setAggParamValue:onAggParamValueChange,setStateParamValue:setStateValue,onAggTypeChange:onAggTypeChange,onToggleEnableAgg:onToggleEnableAgg,setValidity:setValidity,setTouched:setTouched,removeAgg:onAggRemove};return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(DefaultEditorAggGroup,data_tab_extends({groupName:data_public_.AggGroupNames.Metrics,schemas:schemas.metrics},commonProps)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(DefaultEditorAggGroup,data_tab_extends({groupName:data_public_.AggGroupNames.Buckets,schemas:schemas.buckets,timeRange:timeRange},commonProps)))}function sidebar_extends(){return(sidebar_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function DefaultEditorSideBarComponent({embeddableHandler:embeddableHandler,isCollapsed:isCollapsed,onClickCollapse:onClickCollapse,uiState:uiState,vis:vis,isLinkedSearch:isLinkedSearch,eventEmitter:eventEmitter,savedSearch:savedSearch,timeRange:timeRange}){const[isDirty,setDirty]=Object(external_kbnSharedDeps_React_.useState)(!1),[state,dispatch]=useEditorReducer(vis,eventEmitter),{formState:formState,setTouched:setTouched,setValidity:setValidity,resetValidity:resetValidity}=function(){const[formState,setFormState]=Object(external_kbnSharedDeps_React_.useState)(initialFormState),setValidity=Object(external_kbnSharedDeps_React_.useCallback)((modelName,value)=>{setFormState(model=>{const validity={...model.validity,[modelName]:value};return{...model,validity:validity,invalid:Object.values(validity).some(valid=>!valid)}})},[]),resetValidity=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setFormState(initialFormState)},[]);return{formState:formState,setValidity:setValidity,setTouched:Object(external_kbnSharedDeps_React_.useCallback)(touched=>{setFormState(model=>({...model,touched:touched}))},[]),resetValidity:resetValidity}}(),[optionTabs,setSelectedTab]=(({type:visType})=>{const[optionTabs,setOptionTabs]=Object(external_kbnSharedDeps_React_.useState)(()=>{var _visType$schemas$buck,_visType$schemas$metr;const tabs=[...null!==(_visType$schemas$buck=visType.schemas.buckets)&&void 0!==_visType$schemas$buck&&_visType$schemas$buck.length||null!==(_visType$schemas$metr=visType.schemas.metrics)&&void 0!==_visType$schemas$metr&&_visType$schemas$metr.length?[{name:"data",title:external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.sidebar.tabs.dataLabel",{defaultMessage:"Data"}),editor:DefaultEditorDataTab}]:[],...!visType.editorConfig.optionTabs&&visType.editorConfig.optionsTemplate?[{name:"options",title:external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.sidebar.tabs.optionsLabel",{defaultMessage:"Options"}),editor:visType.editorConfig.optionsTemplate}]:visType.editorConfig.optionTabs];return tabs[0].isSelected=!0,tabs});return[optionTabs,Object(external_kbnSharedDeps_React_.useCallback)(name=>{setOptionTabs(tabs=>tabs.map(tab=>({...tab,isSelected:tab.name===name})))},[])]})(vis),responseAggs=Object(external_kbnSharedDeps_React_.useMemo)(()=>state.data.aggs?state.data.aggs.getResponseAggs():[],[state.data.aggs]),metricSchemas=(vis.type.schemas.metrics||[]).map(s=>s.name),metricAggs=Object(external_kbnSharedDeps_React_.useMemo)(()=>responseAggs.filter(agg=>agg.schema&&metricSchemas.includes(agg.schema)),[responseAggs,metricSchemas]),hasHistogramAgg=Object(external_kbnSharedDeps_React_.useMemo)(()=>responseAggs.some(agg=>"histogram"===agg.type.name),[responseAggs]),setStateValidity=Object(external_kbnSharedDeps_React_.useCallback)(value=>{setValidity("visOptions",value)},[setValidity]),setStateValue=Object(external_kbnSharedDeps_React_.useCallback)((paramName,value)=>{!Object(external_kbnSharedDeps_Lodash_.isEqual)(state.params[paramName],value)&&dispatch(((paramName,value)=>({type:EditorStateActionTypes.SET_STATE_PARAM_VALUE,payload:{paramName:paramName,value:value}}))(paramName,value))},[dispatch,state.params]),applyChanges=Object(external_kbnSharedDeps_React_.useCallback)(()=>{!formState.invalid&&isDirty?(vis.setState({...vis.serialize(),params:state.params,data:{aggs:state.data.aggs?state.data.aggs.aggs.map(agg=>agg.toJSON()):[]}}),embeddableHandler.reload(),eventEmitter.emit("dirtyStateChange",{isDirty:!1}),setTouched(!1)):setTouched(!0)},[vis,state,formState.invalid,setTouched,isDirty,eventEmitter,embeddableHandler]),onSubmit=Object(external_kbnSharedDeps_React_.useCallback)(event=>{event.ctrlKey&&event.key===external_kbnSharedDeps_ElasticEui_.keys.ENTER&&(event.preventDefault(),event.stopPropagation(),applyChanges())},[applyChanges]);Object(external_kbnSharedDeps_React_.useEffect)(()=>{const changeHandler=({isDirty:dirty})=>{setDirty(dirty),dirty||resetValidity()};return eventEmitter.on("dirtyStateChange",changeHandler),()=>{eventEmitter.off("dirtyStateChange",changeHandler)}},[resetValidity,eventEmitter]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{const resetHandler=()=>dispatch(discardChanges(vis));return eventEmitter.on("updateEditor",resetHandler),()=>{eventEmitter.off("updateEditor",resetHandler)}},[dispatch,vis,eventEmitter]);const dataTabProps={dispatch:dispatch,formIsTouched:formState.touched,metricAggs:metricAggs,state:state,schemas:vis.type.schemas,setValidity:setValidity,setTouched:setTouched,setStateValue:setStateValue},optionTabProps={aggs:state.data.aggs,hasHistogramAgg:hasHistogramAgg,stateParams:state.params,vis:vis,uiState:uiState,setValue:setStateValue,setValidity:setStateValidity,setTouched:setTouched};return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{className:"visEditorSidebar",direction:"column",justifyContent:"spaceBetween",gutterSize:"none",responsive:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement("form",{className:"visEditorSidebar__form",name:"visualizeEditor",onKeyDownCapture:onSubmit},vis.type.requiresSearch&&external_kbnSharedDeps_React_default.a.createElement(SidebarTitle,{isLinkedSearch:isLinkedSearch,savedSearch:savedSearch,vis:vis,eventEmitter:eventEmitter}),optionTabs.length>1&&external_kbnSharedDeps_React_default.a.createElement(DefaultEditorNavBar,{optionTabs:optionTabs,setSelectedTab:setSelectedTab}),optionTabs.map(({editor:Editor,name:name,isSelected:isSelected=!1})=>external_kbnSharedDeps_React_default.a.createElement("div",{key:name,className:"visEditorSidebar__config "+(isSelected?"":"visEditorSidebar__config-isHidden")},external_kbnSharedDeps_React_default.a.createElement(Editor,sidebar_extends({isTabSelected:isSelected},"data"===name?dataTabProps:optionTabProps,{timeRange:timeRange})))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(DefaultEditorControls,{applyChanges:applyChanges,dispatch:dispatch,isDirty:isDirty,isTouched:formState.touched,isInvalid:formState.invalid,vis:vis}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{"aria-expanded":!isCollapsed,"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("visDefaultEditor.sidebar.collapseButtonAriaLabel",{defaultMessage:"Toggle sidebar"}),className:"visEditor__collapsibleSidebarButton","data-test-subj":"collapseSideBarButton",color:"text",iconType:isCollapsed?"menuLeft":"menuRight",onClick:onClickCollapse}))}const DefaultEditorSideBar=Object(external_kbnSharedDeps_React_.memo)(DefaultEditorSideBarComponent);var editor_size=__webpack_require__(10);const localStorage=new kibanaUtils_public_.Storage(window.localStorage);function DefaultEditor({core:core,data:data,vis:vis,uiState:uiState,timeRange:timeRange,filters:filters,query:query,embeddableHandler:embeddableHandler,eventEmitter:eventEmitter,linked:linked,savedSearch:savedSearch}){const visRef=Object(external_kbnSharedDeps_React_.useRef)(null),[isCollapsed,setIsCollapsed]=Object(external_kbnSharedDeps_React_.useState)(!1),onClickCollapse=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setIsCollapsed(value=>!value)},[]),onEditorMouseLeave=Object(external_kbnSharedDeps_React_.useCallback)(()=>{},[]);Object(external_kbnSharedDeps_React_.useEffect)(()=>{if(visRef.current)return embeddableHandler.render(visRef.current),setTimeout(()=>{eventEmitter.emit("embeddableRendered")}),()=>embeddableHandler.destroy()},[embeddableHandler,eventEmitter]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{embeddableHandler.updateInput({timeRange:timeRange,filters:filters,query:query})},[embeddableHandler,timeRange,filters,query]);const editorInitialWidth=Object(editor_size.b)(vis.type.editorConfig.defaultSize);return external_kbnSharedDeps_React_default.a.createElement(core.i18n.Context,null,external_kbnSharedDeps_React_default.a.createElement(public_.KibanaContextProvider,{services:{appName:"vis_default_editor",storage:localStorage,data:data,...core}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiResizableContainer,{className:"visEditor--default",onMouseLeave:onEditorMouseLeave},(EuiResizablePanel,EuiResizableButton)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(EuiResizablePanel,{className:"visEditor__visualization",initialSize:100-editorInitialWidth,minSize:"25%",paddingSize:"none",wrapperProps:{className:"visEditor__visualization__wrapper "+(isCollapsed?"visEditor__visualization__wrapper-expanded":"")}},external_kbnSharedDeps_React_default.a.createElement("div",{className:"visEditor__canvas",ref:visRef,"data-shared-items-container":!0})),external_kbnSharedDeps_React_default.a.createElement(EuiResizableButton,{className:"visEditor__resizer "+(isCollapsed?"visEditor__resizer-isHidden":"")}),external_kbnSharedDeps_React_default.a.createElement(EuiResizablePanel,{initialSize:editorInitialWidth,minSize:isCollapsed?"0":"350px",paddingSize:"none",wrapperProps:{className:"visEditor__collapsibleSidebar "+(isCollapsed?"visEditor__collapsibleSidebar-isClosed":"")}},external_kbnSharedDeps_React_default.a.createElement(DefaultEditorSideBar,{embeddableHandler:embeddableHandler,isCollapsed:isCollapsed,onClickCollapse:onClickCollapse,vis:vis,uiState:uiState,isLinkedSearch:linked,savedSearch:savedSearch,timeRange:timeRange,eventEmitter:eventEmitter}))))))}}])]);