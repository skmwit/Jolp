(window.discover_bundle_jsonpfunction=window.discover_bundle_jsonpfunction||[]).push([[7],{237:function(module,exports,__webpack_require__){__webpack_require__(238),module.exports="ngRoute"},238:function(module,exports){
/**
 * @license AngularJS v1.8.0
 * (c) 2010-2020 Google, Inc. http://angularjs.org
 * License: MIT
 */
!function(window,angular){"use strict";function routeToRegExp(path,opts){var keys=[],pattern=path.replace(/([().])/g,"\\$1").replace(/(\/)?:(\w+)(\*\?|[?*])?/g,(function(_,slash,key,option){var optional="?"===option||"*?"===option,star="*"===option||"*?"===option;return keys.push({name:key,optional:optional}),slash=slash||"",(optional?"(?:"+slash:slash+"(?:")+(star?"(.+?)":"([^/]+)")+(optional?"?)?":")")})).replace(/([/$*])/g,"\\$1");return opts.ignoreTrailingSlashes&&(pattern=pattern.replace(/\/+$/,"")+"/*"),{keys:keys,regexp:new RegExp("^"+pattern+"(?:[?#]|$)",opts.caseInsensitiveMatch?"i":"")}}var isArray,isObject,isDefined,noop,isEagerInstantiationEnabled,ngRouteModule=angular.module("ngRoute",[]).info({angularVersion:"1.8.0"}).provider("$route",(function(){function inherit(parent,extra){return angular.extend(Object.create(parent),extra)}isArray=angular.isArray,isObject=angular.isObject,isDefined=angular.isDefined,noop=angular.noop;var routes={};this.when=function(path,route){var routeCopy=function(src,dst){if(isArray(src)){dst=dst||[];for(var i=0,ii=src.length;i<ii;i++)dst[i]=src[i]}else if(isObject(src))for(var key in dst=dst||{},src)"$"===key.charAt(0)&&"$"===key.charAt(1)||(dst[key]=src[key]);return dst||src}(route);if(angular.isUndefined(routeCopy.reloadOnUrl)&&(routeCopy.reloadOnUrl=!0),angular.isUndefined(routeCopy.reloadOnSearch)&&(routeCopy.reloadOnSearch=!0),angular.isUndefined(routeCopy.caseInsensitiveMatch)&&(routeCopy.caseInsensitiveMatch=this.caseInsensitiveMatch),routes[path]=angular.extend(routeCopy,{originalPath:path},path&&routeToRegExp(path,routeCopy)),path){var redirectPath="/"===path[path.length-1]?path.substr(0,path.length-1):path+"/";routes[redirectPath]=angular.extend({originalPath:path,redirectTo:path},routeToRegExp(redirectPath,routeCopy))}return this},this.caseInsensitiveMatch=!1,this.otherwise=function(params){return"string"==typeof params&&(params={redirectTo:params}),this.when(null,params),this},isEagerInstantiationEnabled=!0,this.eagerInstantiationEnabled=function(enabled){return isDefined(enabled)?(isEagerInstantiationEnabled=enabled,this):isEagerInstantiationEnabled},this.$get=["$rootScope","$location","$routeParams","$q","$injector","$templateRequest","$sce","$browser",function($rootScope,$location,$routeParams,$q,$injector,$templateRequest,$sce,$browser){var preparedRoute,preparedRouteIsUpdateOnly,forceReload=!1,$route={routes:routes,reload:function(){forceReload=!0;var fakeLocationEvent={defaultPrevented:!1,preventDefault:function(){this.defaultPrevented=!0,forceReload=!1}};$rootScope.$evalAsync((function(){prepareRoute(fakeLocationEvent),fakeLocationEvent.defaultPrevented||commitRoute()}))},updateParams:function(newParams){if(!this.current||!this.current.$$route)throw $routeMinErr("norout","Tried updating route with no current route");newParams=angular.extend({},this.current.params,newParams),$location.path(interpolate(this.current.$$route.originalPath,newParams)),$location.search(newParams)}};return $rootScope.$on("$locationChangeStart",prepareRoute),$rootScope.$on("$locationChangeSuccess",commitRoute),$route;function prepareRoute($locationEvent){var params,match,newRoute,oldRoute,lastRoute=$route.current;angular.forEach(routes,(function(route,path){!match&&(params=function(on,route){var keys=route.keys,params={};if(!route.regexp)return null;var m=route.regexp.exec(on);if(!m)return null;for(var i=1,len=m.length;i<len;++i){var key=keys[i-1],val=m[i];key&&val&&(params[key.name]=val)}return params}($location.path(),route))&&((match=inherit(route,{params:angular.extend({},$location.search(),params),pathParams:params})).$$route=route)})),preparedRoute=match||routes.null&&inherit(routes.null,{params:{},pathParams:{}}),newRoute=preparedRoute,oldRoute=lastRoute,(preparedRouteIsUpdateOnly=!forceReload&&newRoute&&oldRoute&&newRoute.$$route===oldRoute.$$route&&(!newRoute.reloadOnUrl||!newRoute.reloadOnSearch&&angular.equals(newRoute.pathParams,oldRoute.pathParams)))||!lastRoute&&!preparedRoute||$rootScope.$broadcast("$routeChangeStart",preparedRoute,lastRoute).defaultPrevented&&$locationEvent&&$locationEvent.preventDefault()}function commitRoute(){var lastRoute=$route.current,nextRoute=preparedRoute;if(preparedRouteIsUpdateOnly)lastRoute.params=nextRoute.params,angular.copy(lastRoute.params,$routeParams),$rootScope.$broadcast("$routeUpdate",lastRoute);else if(nextRoute||lastRoute){forceReload=!1,$route.current=nextRoute;var nextRoutePromise=$q.resolve(nextRoute);$browser.$$incOutstandingRequestCount("$route"),nextRoutePromise.then(getRedirectionData).then(handlePossibleRedirection).then((function(keepProcessingRoute){return keepProcessingRoute&&nextRoutePromise.then(resolveLocals).then((function(locals){nextRoute===$route.current&&(nextRoute&&(nextRoute.locals=locals,angular.copy(nextRoute.params,$routeParams)),$rootScope.$broadcast("$routeChangeSuccess",nextRoute,lastRoute))}))})).catch((function(error){nextRoute===$route.current&&$rootScope.$broadcast("$routeChangeError",nextRoute,lastRoute,error)})).finally((function(){$browser.$$completeOutstandingRequest(noop,"$route")}))}}function getRedirectionData(route){var data={route:route,hasRedirection:!1};if(route)if(route.redirectTo)if(angular.isString(route.redirectTo))data.path=interpolate(route.redirectTo,route.params),data.search=route.params,data.hasRedirection=!0;else{var oldPath=$location.path(),oldSearch=$location.search(),newUrl=route.redirectTo(route.pathParams,oldPath,oldSearch);angular.isDefined(newUrl)&&(data.url=newUrl,data.hasRedirection=!0)}else if(route.resolveRedirectTo)return $q.resolve($injector.invoke(route.resolveRedirectTo)).then((function(newUrl){return angular.isDefined(newUrl)&&(data.url=newUrl,data.hasRedirection=!0),data}));return data}function handlePossibleRedirection(data){var keepProcessingRoute=!0;if(data.route!==$route.current)keepProcessingRoute=!1;else if(data.hasRedirection){var oldUrl=$location.url(),newUrl=data.url;newUrl?$location.url(newUrl).replace():newUrl=$location.path(data.path).search(data.search).replace().url(),newUrl!==oldUrl&&(keepProcessingRoute=!1)}return keepProcessingRoute}function resolveLocals(route){if(route){var locals=angular.extend({},route.resolve);angular.forEach(locals,(function(value,key){locals[key]=angular.isString(value)?$injector.get(value):$injector.invoke(value,null,null,key)}));var template=function(route){var template,templateUrl;angular.isDefined(template=route.template)?angular.isFunction(template)&&(template=template(route.params)):angular.isDefined(templateUrl=route.templateUrl)&&(angular.isFunction(templateUrl)&&(templateUrl=templateUrl(route.params)),angular.isDefined(templateUrl)&&(route.loadedTemplateUrl=$sce.valueOf(templateUrl),template=$templateRequest(templateUrl)));return template}(route);return angular.isDefined(template)&&(locals.$template=template),$q.all(locals)}}function interpolate(string,params){var result=[];return angular.forEach((string||"").split(":"),(function(segment,i){if(0===i)result.push(segment);else{var segmentMatch=segment.match(/(\w+)(?:[?*])?(.*)/),key=segmentMatch[1];result.push(params[key]),result.push(segmentMatch[2]||""),delete params[key]}})),result.join("")}}]})).run(instantiateRoute),$routeMinErr=angular.$$minErr("ngRoute");function instantiateRoute($injector){isEagerInstantiationEnabled&&$injector.get("$route")}function ngViewFactory($route,$anchorScroll,$animate){return{restrict:"ECA",terminal:!0,priority:400,transclude:"element",link:function(scope,$element,attr,ctrl,$transclude){var currentScope,currentElement,previousLeaveAnimation,autoScrollExp=attr.autoscroll,onloadExp=attr.onload||"";function cleanupLastView(){previousLeaveAnimation&&($animate.cancel(previousLeaveAnimation),previousLeaveAnimation=null),currentScope&&(currentScope.$destroy(),currentScope=null),currentElement&&((previousLeaveAnimation=$animate.leave(currentElement)).done((function(response){!1!==response&&(previousLeaveAnimation=null)})),currentElement=null)}function update(){var locals=$route.current&&$route.current.locals,template=locals&&locals.$template;if(angular.isDefined(template)){var newScope=scope.$new(),current=$route.current,clone=$transclude(newScope,(function(clone){$animate.enter(clone,null,currentElement||$element).done((function(response){!1===response||!angular.isDefined(autoScrollExp)||autoScrollExp&&!scope.$eval(autoScrollExp)||$anchorScroll()})),cleanupLastView()}));currentElement=clone,(currentScope=current.scope=newScope).$emit("$viewContentLoaded"),currentScope.$eval(onloadExp)}else cleanupLastView()}scope.$on("$routeChangeSuccess",update),update()}}}function ngViewFillContentFactory($compile,$controller,$route){return{restrict:"ECA",priority:-400,link:function(scope,$element){var current=$route.current,locals=current.locals;$element.html(locals.$template);var link=$compile($element.contents());if(current.controller){locals.$scope=scope;var controller=$controller(current.controller,locals);current.controllerAs&&(scope[current.controllerAs]=controller),$element.data("$ngControllerController",controller),$element.children().data("$ngControllerController",controller)}scope[current.resolveAs||"$resolve"]=locals,link(scope)}}}instantiateRoute.$inject=["$injector"],ngRouteModule.provider("$routeParams",(function(){this.$get=function(){return{}}})),ngRouteModule.directive("ngView",ngViewFactory),ngRouteModule.directive("ngView",ngViewFillContentFactory),ngViewFactory.$inject=["$route","$anchorScroll","$animate"],ngViewFillContentFactory.$inject=["$compile","$controller","$route"]}(window,window.angular)},239:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__(97),__webpack_require__(237);var external_kbnSharedDeps_Lodash_=__webpack_require__(20),external_kbnSharedDeps_Lodash_default=__webpack_require__.n(external_kbnSharedDeps_Lodash_),external_kbnSharedDeps_Rxjs_=__webpack_require__(23),external_kbnSharedDeps_RxjsOperators_=__webpack_require__(15),external_kbnSharedDeps_KbnI18n_=__webpack_require__(1),public_=__webpack_require__(5),data_public_=__webpack_require__(4);var url_generator=__webpack_require__(7),helpers=__webpack_require__(71);function getState({getStateDefaults:getStateDefaults,storeInSessionStorage:storeInSessionStorage=!1,history:history,toasts:toasts,uiSettings:uiSettings}){const defaultAppState=getStateDefaults?getStateDefaults():{},stateStorage=Object(public_.createKbnUrlStateStorage)({useHash:storeInSessionStorage,history:history,...toasts&&Object(public_.withNotifyOnErrors)(toasts)}),appStateFromUrl=stateStorage.get("_a");var query;appStateFromUrl&&appStateFromUrl.query&&!appStateFromUrl.query.language&&(appStateFromUrl.query=(query=appStateFromUrl.query,Object(external_kbnSharedDeps_Lodash_.has)(query,"language")?query:{query:query,language:"lucene"})),null!=appStateFromUrl&&appStateFromUrl.sort&&!appStateFromUrl.sort.length&&delete appStateFromUrl.sort;let previousAppState,initialAppState=Object(helpers.d)({...defaultAppState,...appStateFromUrl},uiSettings);const appStateContainer=Object(public_.createStateContainer)(initialAppState),appStateContainerModified={...appStateContainer,set:value=>{value&&(previousAppState=appStateContainer.getState(),appStateContainer.set(value))}},{start:start,stop:stop}=Object(public_.syncState)({storageKey:"_a",stateContainer:appStateContainerModified,stateStorage:stateStorage});return{kbnUrlStateStorage:stateStorage,appStateContainer:appStateContainerModified,startSync:start,stopSync:stop,setAppState:newPartial=>setState(appStateContainerModified,newPartial),replaceUrlAppState:async(newPartial={})=>{const state={...appStateContainer.getState(),...newPartial};await stateStorage.set("_a",state,{replace:!0})},resetInitialAppState:()=>{initialAppState=appStateContainer.getState()},resetAppState:()=>{const defaultState=getStateDefaults?getStateDefaults():{};setState(appStateContainerModified,defaultState)},getPreviousAppState:()=>previousAppState,flushToUrl:()=>stateStorage.kbnUrlControls.flush(),isAppStateDirty:()=>!isEqualState(initialAppState,appStateContainer.getState())}}function setState(stateContainer,newState){const oldState=stateContainer.getState(),mergedState={...oldState,...newState};isEqualState(oldState,mergedState)||stateContainer.set(mergedState)}function splitState(state={}){const{filters:filters=[],...statePartial}=state;return{filters:filters,state:statePartial}}function isEqualState(stateA,stateB){if(!stateA&&!stateB)return!0;if(!stateA||!stateB)return!1;const{filters:stateAFilters=[],...stateAPartial}=stateA,{filters:stateBFilters=[],...stateBPartial}=stateB;return Object(external_kbnSharedDeps_Lodash_.isEqual)(stateAPartial,stateBPartial)&&(filtersB=stateBFilters,!(filtersA=stateAFilters)&&!filtersB||!(!filtersA||!filtersB)&&data_public_.esFilters.compareFilters(filtersA,filtersB,data_public_.esFilters.COMPARE_ALL_OPTIONS));var filtersA,filtersB}function createUrlGeneratorState({appStateContainer:appStateContainer,data:data,getSavedSearchId:getSavedSearchId,shouldRestoreSearchSession:shouldRestoreSearchSession}){const appState=appStateContainer.get();return{filters:data.query.filterManager.getFilters(),indexPatternId:appState.index,query:appState.query,savedSearchId:getSavedSearchId(),timeRange:shouldRestoreSearchSession?data.query.timefilter.timefilter.getAbsoluteTime():data.query.timefilter.timefilter.getTime(),searchSessionId:shouldRestoreSearchSession?data.search.session.getSessionId():void 0,columns:appState.columns,sort:appState.sort,savedQuery:appState.savedQuery,interval:appState.interval,useHash:!1}}var inspector_public_=__webpack_require__(56),doc_table=__webpack_require__(68),kibana_services=__webpack_require__(3);const discoverResponseHandler=(response,dimensions)=>{let converted=function convertTableGroup(tableGroup,convertTable){const tables=tableGroup.tables;if(!tables.length)return;const firstChild=tables[0];if(firstChild.columns){const chart=convertTable(firstChild);return tableGroup.$parent&&(chart.label=tableGroup.title),chart}const out={};let outList;return tables.forEach((function(table){if(!outList){const direction="row"===tableGroup.direction?"rows":"columns";outList=out[direction]=[]}let output;(output=convertTableGroup(table,convertTable))&&outList.push(output)})),out}(function(table,dimensions){const converted={tables:[]},split=dimensions.splitColumn||dimensions.splitRow;if(split){converted.direction=dimensions.splitRow?"row":"column";const splitColumnIndex=split[0].accessor,splitColumnFormatter=Object(kibana_services.f)().data.fieldFormats.deserialize(split[0].format),splitColumn=table.columns[splitColumnIndex],splitMap={};let splitIndex=0;table.rows.forEach((row,rowIndex)=>{const splitValue=row[splitColumn.id];if(!splitMap.hasOwnProperty(splitValue)){splitMap[splitValue]=splitIndex++;const tableGroup={$parent:converted,title:`${splitColumnFormatter.convert(splitValue)}: ${splitColumn.name}`,name:splitColumn.name,key:splitValue,column:splitColumnIndex,row:rowIndex,table:table,tables:[]};tableGroup.tables.push({$parent:tableGroup,columns:table.columns,rows:[]}),converted.tables.push(tableGroup)}const tableIndex=splitMap[splitValue];converted.tables[tableIndex].tables[0].rows.push(row)})}else converted.tables.push({columns:table.columns,rows:table.rows});return converted}(response,dimensions),table=>Object(helpers.a)(table,dimensions));return converted||(converted={rows:[]}),converted.hits=response.rows.length,converted};var breadcrumbs=__webpack_require__(70),common=__webpack_require__(66),get_default_sort=__webpack_require__(92);function get_state_defaults_getStateDefaults({config:config,data:data,indexPattern:indexPattern,savedSearch:savedSearch,searchSource:searchSource}){const query=searchSource.getField("query")||data.query.queryString.getDefaultQuery(),sort=Object(doc_table.b)(savedSearch.sort,indexPattern),columns=function(savedSearch,config){return savedSearch.columns&&savedSearch.columns.length>0?[...savedSearch.columns]:[...config.get(common.d)]}(savedSearch,config),defaultState={query:query,sort:sort.length?sort:Object(get_default_sort.a)(indexPattern,config.get(common.m,"desc")),columns:columns,index:indexPattern.id,interval:"auto",filters:Object(external_kbnSharedDeps_Lodash_.cloneDeep)(searchSource.getOwnField("filter"))};return savedSearch.grid&&(defaultState.grid=savedSearch.grid),savedSearch.hideChart&&(defaultState.hideChart=savedSearch.hideChart),defaultState}const fetchStatuses={UNINITIALIZED:"uninitialized",LOADING:"loading",COMPLETE:"complete",ERROR:"error"},resultStatuses_UNINITIALIZED="uninitialized",resultStatuses_LOADING="loading",resultStatuses_READY="ready",resultStatuses_NO_RESULTS="none";function getResultState(fetchStatus,rows){if(fetchStatus===fetchStatuses.UNINITIALIZED)return resultStatuses_UNINITIALIZED;const rowsEmpty=!Array.isArray(rows)||0===rows.length;return rowsEmpty&&fetchStatus===fetchStatuses.LOADING?resultStatuses_LOADING:rowsEmpty?resultStatuses_NO_RESULTS:resultStatuses_READY}var target=__webpack_require__(94),target_default=__webpack_require__.n(target);var kibanaLegacy_public_=__webpack_require__(13);function findIndexPatternById(indexPatterns,id){if(Array.isArray(indexPatterns)&&id)return indexPatterns.find(o=>o.id===id)}function getIndexPatternId(id="",indexPatterns=[],defaultIndex=""){return id&&findIndexPatternById(indexPatterns,id)?id:function(indexPatterns,defaultIndex=""){var _indexPatterns$;return defaultIndex&&findIndexPatternById(indexPatterns,defaultIndex)?defaultIndex:indexPatterns&&null!==(_indexPatterns$=indexPatterns[0])&&void 0!==_indexPatterns$&&_indexPatterns$.id?indexPatterns[0].id:""}(indexPatterns,defaultIndex)}async function loadIndexPattern(id,indexPatterns,config){const indexPatternList=await indexPatterns.getCache(),actualId=getIndexPatternId(id,indexPatternList,config.get("defaultIndex"));return{list:indexPatternList||[],loaded:await indexPatterns.get(actualId),stateVal:id,stateValFound:!!id&&actualId===id}}var update_search_source=__webpack_require__(101);function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class discover_search_session_DiscoverSearchSessionManager{constructor(deps){this.deps=deps,_defineProperty(this,"newSearchSessionIdFromURL$",Object(public_.createQueryParamObservable)(this.deps.history,url_generator.d).pipe(Object(external_kbnSharedDeps_RxjsOperators_.filter)(searchSessionId=>!searchSessionId||!this.deps.session.isCurrentSession(searchSessionId)))),_defineProperty(this,"getSearchSessionIdFromURL",()=>Object(public_.getQueryParams)(this.deps.history.location)[url_generator.d])}getNextSearchSessionId(){var _searchSessionIdFromU;let searchSessionIdFromURL=this.getSearchSessionIdFromURL();return searchSessionIdFromURL&&(this.deps.session.isRestore()&&this.deps.session.isCurrentSession(searchSessionIdFromURL)?(this.removeSearchSessionIdFromURL({replace:!0}),searchSessionIdFromURL=void 0):this.deps.session.restore(searchSessionIdFromURL)),null!==(_searchSessionIdFromU=searchSessionIdFromURL)&&void 0!==_searchSessionIdFromU?_searchSessionIdFromU:this.deps.session.start()}removeSearchSessionIdFromURL({replace:replace=!0}={replace:!0}){this.hasSearchSessionIdInURL()&&Object(public_.removeQueryParam)(this.deps.history,url_generator.d,replace)}hasSearchSessionIdInURL(){return!!this.getSearchSessionIdFromURL()}}var external_kbnSharedDeps_Moment_=__webpack_require__(50),external_kbnSharedDeps_Moment_default=__webpack_require__.n(external_kbnSharedDeps_Moment_);const services=Object(kibana_services.f)(),{core:core,capabilities:capabilities,chrome:chrome,data:discover_data,history:getHistory,filterManager:discover_filterManager,timefilter:timefilter,toastNotifications:discover_toastNotifications,uiSettings:discover_config}=Object(kibana_services.f)(),app=Object(kibana_services.a)();function discoverController($route,$scope){const{isDefault:isDefaultType}=data_public_.indexPatterns,subscriptions=new external_kbnSharedDeps_Rxjs_.Subscription,refetch$=new external_kbnSharedDeps_Rxjs_.Subject;let isChangingIndexPattern=!1;const savedSearch=$route.current.locals.savedObjects.savedSearch,persistentSearchSource=savedSearch.searchSource;$scope.indexPattern=function(ip,searchSource,toastNotifications){const{loaded:loadedIndexPattern,stateVal:stateVal,stateValFound:stateValFound}=ip,ownIndexPattern=searchSource.getOwnField("index");if(ownIndexPattern&&!stateVal)return ownIndexPattern;if(stateVal&&!stateValFound){const warningTitle=external_kbnSharedDeps_KbnI18n_.i18n.translate("discover.valueIsNotConfiguredIndexPatternIDWarningTitle",{defaultMessage:"{stateVal} is not a configured index pattern ID",values:{stateVal:`"${stateVal}"`}});if(ownIndexPattern)return toastNotifications.addWarning({title:warningTitle,text:external_kbnSharedDeps_KbnI18n_.i18n.translate("discover.showingSavedIndexPatternWarningDescription",{defaultMessage:'Showing the saved index pattern: "{ownIndexPatternTitle}" ({ownIndexPatternId})',values:{ownIndexPatternTitle:ownIndexPattern.title,ownIndexPatternId:ownIndexPattern.id}})}),ownIndexPattern;toastNotifications.addWarning({title:warningTitle,text:external_kbnSharedDeps_KbnI18n_.i18n.translate("discover.showingDefaultIndexPatternWarningDescription",{defaultMessage:'Showing the default index pattern: "{loadedIndexPatternTitle}" ({loadedIndexPatternId})',values:{loadedIndexPatternTitle:loadedIndexPattern.title,loadedIndexPatternId:loadedIndexPattern.id}})})}return loadedIndexPattern}($route.current.locals.savedObjects.ip,persistentSearchSource,discover_toastNotifications),$scope.useNewFieldsApi=!discover_config.get(common.k),$scope.fetchCounter=0;const getTimeField=()=>isDefaultType($scope.indexPattern)?$scope.indexPattern.timeFieldName:void 0,history=getHistory(),searchSessionManager=new discover_search_session_DiscoverSearchSessionManager({history:history,session:discover_data.search.session}),stateContainer=getState({getStateDefaults:()=>get_state_defaults_getStateDefaults({config:discover_config,data:discover_data,indexPattern:$scope.indexPattern,savedSearch:savedSearch,searchSource:persistentSearchSource}),storeInSessionStorage:discover_config.get("state:storeInSessionStorage"),history:history,toasts:core.notifications.toasts,uiSettings:discover_config}),{appStateContainer:appStateContainer,startSync:startStateSync,stopSync:stopStateSync,setAppState:setAppState,replaceUrlAppState:replaceUrlAppState,kbnUrlStateStorage:kbnUrlStateStorage,getPreviousAppState:getPreviousAppState}=stateContainer;appStateContainer.getState().index!==$scope.indexPattern.id&&setAppState({index:$scope.indexPattern.id}),$scope.state={...appStateContainer.getState()};const{stop:stopSyncingGlobalStateWithUrl}=Object(data_public_.syncQueryStateWithUrl)(discover_data.query,kbnUrlStateStorage);discover_filterManager.setAppFilters(external_kbnSharedDeps_Lodash_default.a.cloneDeep(appStateContainer.getState().filters)),discover_data.query.queryString.setQuery(appStateContainer.getState().query);const stopSyncingQueryAppStateWithStateContainer=Object(data_public_.connectToQueryState)(discover_data.query,appStateContainer,{filters:data_public_.esFilters.FilterStateStore.APP_STATE,query:!0}),showUnmappedFields=$scope.useNewFieldsApi,appStateUnsubscribe=appStateContainer.subscribe(async newState=>{const{state:newStatePartial}=splitState(newState),{state:oldStatePartial}=splitState(getPreviousAppState());external_kbnSharedDeps_Lodash_default.a.isEqual(newStatePartial,oldStatePartial)||$scope.$evalAsync(async()=>{if(newStatePartial.index&&oldStatePartial.index!==newStatePartial.index)return isChangingIndexPattern=!0,void $route.reload();$scope.state={...newState};const changes=["interval","sort"].filter(prop=>!external_kbnSharedDeps_Lodash_default.a.isEqual(newStatePartial[prop],oldStatePartial[prop]));oldStatePartial.hideChart&&!newStatePartial.hideChart&&changes.push(!0),changes.length&&refetch$.next()})}),unlistenHistoryBasePath=history.listen(({pathname:pathname,search:search,hash:hash})=>{search||hash||"/"!==pathname||$route.reload()});discover_data.search.session.enableStorage(function(deps){const getSavedSearchId=()=>deps.getSavedSearch().id;return{getName:async()=>{const savedSearch=deps.getSavedSearch();return savedSearch.id&&savedSearch.title||external_kbnSharedDeps_KbnI18n_.i18n.translate("discover.discoverDefaultSearchSessionName",{defaultMessage:"Discover"})},getUrlGeneratorData:async()=>({urlGeneratorId:url_generator.a,initialState:createUrlGeneratorState({...deps,getSavedSearchId:getSavedSearchId,shouldRestoreSearchSession:!1}),restoreState:createUrlGeneratorState({...deps,getSavedSearchId:getSavedSearchId,shouldRestoreSearchSession:!0})})}}({appStateContainer:appStateContainer,data:discover_data,getSavedSearch:()=>savedSearch}),{isDisabled:()=>capabilities.discover.storeSearchSession?{disabled:!1}:{disabled:!0,reasonText:data_public_.noSearchSessionStorageCapabilityMessage}}),$scope.opts={sampleSize:discover_config.get(common.j),timefield:getTimeField(),savedSearch:savedSearch,services:services,indexPatternList:$route.current.locals.savedObjects.ip.list,config:discover_config,setHeaderActionMenu:Object(kibana_services.c)(),filterManager:discover_filterManager,setAppState:setAppState,data:discover_data,stateContainer:stateContainer,searchSessionManager:searchSessionManager,refetch$:refetch$};const inspectorAdapters=$scope.opts.inspectorAdapters={requests:new inspector_public_.RequestAdapter},shouldSearchOnPageLoad=()=>discover_config.get(common.l)||void 0!==savedSearch.id||!1===timefilter.getRefreshInterval().pause||searchSessionManager.hasSearchSessionIdInURL();let abortController;$scope.fetchStatus=fetchStatuses.UNINITIALIZED,$scope.resultState=shouldSearchOnPageLoad()?"loading":"uninitialized",$scope.$on("$destroy",()=>{abortController&&abortController.abort(),savedSearch.destroy(),subscriptions.unsubscribe(),isChangingIndexPattern||discover_data.search.session.clear(),appStateUnsubscribe(),stopStateSync(),stopSyncingGlobalStateWithUrl(),stopSyncingQueryAppStateWithStateContainer(),unlistenHistoryBasePath()}),$scope.opts.getFieldCounts=async()=>$scope.fetchStatus===fetchStatuses.COMPLETE?$scope.fieldCounts:await new Promise(resolve=>{const unwatch=$scope.$watch("fetchStatus",newValue=>{newValue===fetchStatuses.COMPLETE&&(unwatch(),resolve($scope.fieldCounts))})}),$scope.opts.navigateTo=path=>{$scope.$evalAsync(()=>{history.push(path)})},persistentSearchSource.setField("index",$scope.indexPattern);const volatileSearchSource=savedSearch.searchSource.create();function onResults(resp){if(getTimeField()&&!$scope.state.hideChart){const tabifiedData=Object(kibana_services.s)($scope.opts.chartAggConfigs,resp);$scope.volatileSearchSource.rawResponse=resp;const dimensions=function(aggs,data){const[metric,agg]=aggs.aggs,{from:from,to:to}=data.query.timefilter.timefilter.getTime();agg.params.timeRange={from:target_default.a.parse(from),to:target_default.a.parse(to,{roundUp:!0})};const bounds=agg.params.timeRange?data.query.timefilter.timefilter.calculateBounds(agg.params.timeRange):null,buckets=data_public_.search.aggs.isDateHistogramBucketAggConfig(agg)?agg.buckets:void 0;if(!buckets)return;buckets.setBounds(bounds);const{esUnit:esUnit,esValue:esValue}=buckets.getInterval();return{x:{accessor:0,label:agg.makeLabel(),format:agg.toSerializedFieldFormat(),params:{date:!0,interval:external_kbnSharedDeps_Moment_default.a.duration(esValue,esUnit),intervalESValue:esValue,intervalESUnit:esUnit,format:buckets.getScaledDateFormat(),bounds:buckets.getBounds()}},y:{accessor:1,format:metric.toSerializedFieldFormat(),label:metric.makeLabel()}}}($scope.opts.chartAggConfigs,discover_data);dimensions&&($scope.histogramData=discoverResponseHandler(tabifiedData,dimensions))}$scope.hits=resp.hits.total,$scope.rows=resp.hits.hits,$scope.fieldCounts=function(counts={},rows,indexPattern){for(const hit of rows){const fields=Object.keys(indexPattern.flattenHit(hit));for(const fieldName of fields)counts[fieldName]=(counts[fieldName]||0)+1}return counts}($scope.fieldCounts||{},resp.hits.hits,$scope.indexPattern),$scope.fetchStatus=fetchStatuses.COMPLETE}let autoRefreshDoneCb;isDefaultType($scope.indexPattern)&&volatileSearchSource.setField("filter",()=>timefilter.createFilter($scope.indexPattern)),volatileSearchSource.setParent(persistentSearchSource),$scope.volatileSearchSource=volatileSearchSource,$scope.state.index=$scope.indexPattern.id,$scope.state.sort=Object(doc_table.b)($scope.state.sort,$scope.indexPattern),$scope.opts.fetch=$scope.fetch=async function(){$scope.fetchCounter++,$scope.fetchError=void 0,function({from:from,to:to},toastNotifications){const fromMoment=target_default.a.parse(from),toMoment=target_default.a.parse(to);return!!(fromMoment&&toMoment&&fromMoment.isValid()&&toMoment.isValid())||(toastNotifications.addDanger({title:external_kbnSharedDeps_KbnI18n_.i18n.translate("discover.notifications.invalidTimeRangeTitle",{defaultMessage:"Invalid time range"}),text:external_kbnSharedDeps_KbnI18n_.i18n.translate("discover.notifications.invalidTimeRangeText",{defaultMessage:"The provided time range is invalid. (from: '{from}', to: '{to}')",values:{from:from,to:to}})}),!1)}(timefilter.getTime(),discover_toastNotifications)||($scope.resultState="none"),abortController&&abortController.abort(),abortController=new AbortController;const searchSessionId=searchSessionManager.getNextSearchSessionId();return(()=>{const{indexPattern:indexPattern,useNewFieldsApi:useNewFieldsApi}=$scope,{columns:columns,sort:sort}=$scope.state;Object(update_search_source.a)({persistentSearchSource:persistentSearchSource,volatileSearchSource:$scope.volatileSearchSource,indexPattern:indexPattern,services:services,sort:sort,columns:columns,useNewFieldsApi:useNewFieldsApi,showUnmappedFields:showUnmappedFields})})(),$scope.opts.chartAggConfigs=function(enabled,searchSource,histogramInterval,indexPattern,data){if(!enabled)return void(searchSource.getField("aggs")&&searchSource.removeField("aggs"));const visStateAggs=[{type:"count",schema:"metric"},{type:"date_histogram",schema:"segment",params:{field:indexPattern.timeFieldName,interval:histogramInterval,timeRange:data.query.timefilter.timefilter.getTime()}}],chartAggConfigs=data.search.aggs.createAggConfigs(indexPattern,visStateAggs);return searchSource.setField("aggs",(function(){return chartAggConfigs.toDsl()})),chartAggConfigs}(getTimeField()&&!$scope.state.hideChart,volatileSearchSource,$scope.state.interval,$scope.indexPattern,discover_data),$scope.fetchStatus=fetchStatuses.LOADING,$scope.resultState=getResultState($scope.fetchStatus,$scope.rows),inspectorAdapters.requests.reset(),$scope.volatileSearchSource.fetch$({abortSignal:abortController.signal,sessionId:searchSessionId,inspector:{adapter:inspectorAdapters.requests,title:external_kbnSharedDeps_KbnI18n_.i18n.translate("discover.inspectorRequestDataTitle",{defaultMessage:"data"}),description:external_kbnSharedDeps_KbnI18n_.i18n.translate("discover.inspectorRequestDescription",{defaultMessage:"This request queries Elasticsearch to fetch the data for the search."})}}).toPromise().then(onResults).catch(error=>{error instanceof Error&&"AbortError"===error.name||($scope.fetchStatus=fetchStatuses.NO_RESULTS,$scope.fetchError=error,discover_data.search.showError(error))}).finally(()=>{$scope.resultState=getResultState($scope.fetchStatus,$scope.rows),$scope.$apply()})},$scope.refreshAppState=async()=>{$scope.hits=[],$scope.rows=[],$scope.fieldCounts={},await refetch$.next()},$scope.resetQuery=function(){history.push($route.current.params.id?"/view/"+encodeURIComponent($route.current.params.id):"/"),$route.reload()},$scope.newQuery=function(){history.push("/")},$scope.unmappedFieldsConfig={showUnmappedFields:showUnmappedFields};const fetch$=Object(external_kbnSharedDeps_Rxjs_.merge)(refetch$,discover_filterManager.getFetches$(),timefilter.getFetch$(),timefilter.getAutoRefreshFetch$().pipe(Object(external_kbnSharedDeps_RxjsOperators_.tap)(done=>{autoRefreshDoneCb=done}),Object(external_kbnSharedDeps_RxjsOperators_.filter)(()=>$scope.fetchStatus!==fetchStatuses.LOADING)),discover_data.query.queryString.getUpdates$(),searchSessionManager.newSearchSessionIdFromURL$).pipe(Object(external_kbnSharedDeps_RxjsOperators_.debounceTime)(100));subscriptions.add(Object(kibana_services.q)($scope,fetch$,{next:async()=>{try{await $scope.fetch()}finally{var _autoRefreshDoneCb;null===(_autoRefreshDoneCb=autoRefreshDoneCb)||void 0===_autoRefreshDoneCb||_autoRefreshDoneCb(),autoRefreshDoneCb=void 0}}},error=>Object(kibanaLegacy_public_.addFatalError)(core.fatalErrors,error))),replaceUrlAppState().then(()=>{startStateSync(),shouldSearchOnPageLoad()&&refetch$.next()})}app.config($routeProvider=>{const discoverRoute={...{requireDefaultIndex:!0,requireUICapability:"discover.show",k7Breadcrumbs:($route,$injector)=>$injector.invoke($route.current.params.id?breadcrumbs.b:breadcrumbs.a),badge:()=>{if(!capabilities.discover.save)return{text:external_kbnSharedDeps_KbnI18n_.i18n.translate("discover.badge.readOnly.text",{defaultMessage:"Read only"}),tooltip:external_kbnSharedDeps_KbnI18n_.i18n.translate("discover.badge.readOnly.tooltip",{defaultMessage:"Unable to save searches"}),iconType:"glasses"}}},template:'<discover-app>\n  <discover\n    fetch="fetch"\n    fetch-counter="fetchCounter"\n    fetch-error="fetchError"\n    field-counts="fieldCounts"\n    histogram-data="histogramData"\n    hits="hits"\n    index-pattern="indexPattern"\n    opts="opts"\n    reset-query="resetQuery"\n    result-state="resultState"\n    rows="rows"\n    search-source="volatileSearchSource"\n    state="state"\n    top-nav-menu="topNavMenu"\n    use-new-fields-api="useNewFieldsApi"\n    unmapped-fields-config="unmappedFieldsConfig"\n    refresh-app-state="refreshAppState"\n  >\n  </discover>\n</discover-app>\n',reloadOnSearch:!1,resolve:{savedObjects:function($route,Promise){const history=getHistory(),savedSearchId=$route.current.params.id;return discover_data.indexPatterns.ensureDefaultIndexPattern(history).then(()=>{const{appStateContainer:appStateContainer}=getState({history:history,uiSettings:discover_config}),{index:index}=appStateContainer.getState();return Promise.props({ip:loadIndexPattern(index,discover_data.indexPatterns,discover_config),savedSearch:Object(kibana_services.f)().getSavedSearchById(savedSearchId).then(savedSearch=>(savedSearchId&&chrome.recentlyAccessed.add(savedSearch.getFullPath(),savedSearch.title,savedSearchId),savedSearch)).catch(Object(kibana_services.i)({history:history,navigateToApp:core.application.navigateToApp,mapping:{search:"/","index-pattern":{app:"management",path:"kibana/objects/savedSearches/"+$route.current.params.id}},toastNotifications:discover_toastNotifications,onBeforeRedirect(){Object(kibana_services.h)().setTrackedUrl("/")}}))})})}}};$routeProvider.when("/view/:id?",discoverRoute),$routeProvider.when("/",discoverRoute)}),app.directive("discoverApp",(function(){return{restrict:"E",controllerAs:"discoverApp",controller:discoverController}}));var external_kbnSharedDeps_React_=__webpack_require__(0),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(6),external_kbnSharedDeps_ElasticEui_=__webpack_require__(2);let ElasticRequestState;function buildSearchBody(id,indexPattern,useNewFieldsApi){var _request$body;const computedFields=indexPattern.getComputedFields(),runtimeFields=computedFields.runtimeFields,request={body:{query:{ids:{values:[id]}},stored_fields:computedFields.storedFields,script_fields:computedFields.scriptFields}};if(request.body)return useNewFieldsApi?(request.body.fields=[{field:"*",include_unmapped:"true"}],request.body.runtime_mappings=runtimeFields||{}):request.body._source=!0,request.body.fields=[...(null===(_request$body=request.body)||void 0===_request$body?void 0:_request$body.fields)||[],...computedFields.docvalueFields||[]],request}!function(ElasticRequestState){ElasticRequestState[ElasticRequestState.Loading=0]="Loading",ElasticRequestState[ElasticRequestState.NotFound=1]="NotFound",ElasticRequestState[ElasticRequestState.Found=2]="Found",ElasticRequestState[ElasticRequestState.Error=3]="Error",ElasticRequestState[ElasticRequestState.NotFoundIndexPattern=4]="NotFoundIndexPattern"}(ElasticRequestState||(ElasticRequestState={}));var doc_viewer=__webpack_require__(96);function Doc(props){const[reqState,hit,indexPattern]=function({id:id,index:index,indexPatternId:indexPatternId,indexPatternService:indexPatternService}){const[indexPattern,setIndexPattern]=Object(external_kbnSharedDeps_React_.useState)(null),[status,setStatus]=Object(external_kbnSharedDeps_React_.useState)(ElasticRequestState.Loading),[hit,setHit]=Object(external_kbnSharedDeps_React_.useState)(null),{data:data,uiSettings:uiSettings}=Object(external_kbnSharedDeps_React_.useMemo)(()=>Object(kibana_services.f)(),[]),useNewFieldsApi=Object(external_kbnSharedDeps_React_.useMemo)(()=>!uiSettings.get(common.k),[uiSettings]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{!async function(){try{var _buildSearchBody,_hits$hits;const indexPatternEntity=await indexPatternService.get(indexPatternId);setIndexPattern(indexPatternEntity);const{rawResponse:rawResponse}=await data.search.search({params:{index:index,body:null===(_buildSearchBody=buildSearchBody(id,indexPatternEntity,useNewFieldsApi))||void 0===_buildSearchBody?void 0:_buildSearchBody.body}}).toPromise(),hits=rawResponse.hits;null!=hits&&null!==(_hits$hits=hits.hits)&&void 0!==_hits$hits&&_hits$hits[0]?(setStatus(ElasticRequestState.Found),setHit(hits.hits[0])):setStatus(ElasticRequestState.NotFound)}catch(err){err.savedObjectId?setStatus(ElasticRequestState.NotFoundIndexPattern):404===err.status?setStatus(ElasticRequestState.NotFound):setStatus(ElasticRequestState.Error)}}()},[id,index,indexPatternId,indexPatternService,data.search,useNewFieldsApi]),[status,hit,indexPattern]}(props),indexExistsLink=Object(kibana_services.f)().docLinks.links.apis.indexExists;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.I18nProvider,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPage,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageContent,null,reqState===ElasticRequestState.NotFoundIndexPattern&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{color:"danger","data-test-subj":"doc-msg-notFoundIndexPattern",iconType:"alert",title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"discover.doc.failedToLocateIndexPattern",defaultMessage:"No index pattern matches ID {indexPatternId}.",values:{indexPatternId:props.indexPatternId}})}),reqState===ElasticRequestState.NotFound&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{color:"danger","data-test-subj":"doc-msg-notFound",iconType:"alert",title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"discover.doc.failedToLocateDocumentDescription",defaultMessage:"Cannot find document"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"discover.doc.couldNotFindDocumentsDescription",defaultMessage:"No documents match that ID."})),reqState===ElasticRequestState.Error&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{color:"danger","data-test-subj":"doc-msg-error",iconType:"alert",title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"discover.doc.failedToExecuteQueryDescription",defaultMessage:"Cannot run search"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"discover.doc.somethingWentWrongDescription",defaultMessage:"{indexName} is missing.",values:{indexName:props.index}})," ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{href:indexExistsLink,target:"_blank"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"discover.doc.somethingWentWrongDescriptionAddon",defaultMessage:"Please ensure the index exists."}))),reqState===ElasticRequestState.Loading&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{"data-test-subj":"doc-msg-loading"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingSpinner,{size:"m"})," ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"discover.doc.loadingDescription",defaultMessage:"Loading…"})),reqState===ElasticRequestState.Found&&null!==hit&&indexPattern&&external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":"doc-hit"},external_kbnSharedDeps_React_default.a.createElement(doc_viewer.a,{hit:hit,indexPattern:indexPattern})))))}const{timefilter:doc_timefilter}=Object(kibana_services.f)(),doc_app=Object(kibana_services.a)();doc_app.directive("discoverDoc",(function(reactDirective){return reactDirective(Doc,[["id",{watchDepth:"value"}],["index",{watchDepth:"value"}],["indexPatternId",{watchDepth:"reference"}],["indexPatternService",{watchDepth:"reference"}]],{restrict:"E"})})),doc_app.config($routeProvider=>{$routeProvider.when("/doc/:indexPattern/:index/:type",{redirectTo:"/doc/:indexPattern/:index"}).when("/doc/:indexPattern/:index",{controller:function($scope,$route){doc_timefilter.disableAutoRefreshSelector(),doc_timefilter.disableTimeRangeSelector(),$scope.id=$route.current.params.id,$scope.index=$route.current.params.index,$scope.indexPatternId=$route.current.params.indexPattern,$scope.indexPatternService=Object(kibana_services.f)().indexPatterns},template:'<div class="app-container">\n    <discover-doc\n      id="id"\n      index="index"\n      index-pattern-id="indexPatternId"\n      index-pattern-service="indexPatternService"\n    ></discover-doc>\n</div>\n',k7Breadcrumbs:$route=>[...Object(breadcrumbs.a)(),{text:`${$route.current.params.index}#${$route.current.params.id}`}]})});var action_bar=__webpack_require__(104);Object(kibana_services.a)().directive("contextActionBar",(function(reactDirective){return reactDirective(action_bar.a)}));var sorting=__webpack_require__(98),query_parameters=__webpack_require__(105),context_query=__webpack_require__(102);function ContextAppController($scope,Private){const{filterManager:filterManager,indexPatterns:indexPatterns,uiSettings:uiSettings,navigation:navigation}=Object(kibana_services.f)(),useNewFieldsApi=!uiSettings.get(common.k),queryParameterActions=Object(query_parameters.c)(filterManager,indexPatterns),queryActions=Private(context_query.c);this.state=function(defaultStepSize,tieBreakerField,useNewFieldsApi){return{queryParameters:Object(query_parameters.b)(defaultStepSize,tieBreakerField),rows:{all:[],anchor:null,predecessors:[],successors:[]},loadingStatus:Object(context_query.d)(),useNewFieldsApi:useNewFieldsApi}}(parseInt(uiSettings.get(common.b),10),Object(sorting.a)(this.indexPattern,uiSettings.get(common.c)),useNewFieldsApi),this.state.useNewFieldsApi=useNewFieldsApi,this.topNavMenu=navigation.ui.TopNavMenu,this.actions=external_kbnSharedDeps_Lodash_default.a.mapValues({...queryParameterActions,...queryActions},action=>(...args)=>action(this.state)(...args)),this.constants={FAILURE_REASONS:context_query.a,LOADING_STATUS:context_query.b},$scope.$watchGroup([()=>this.state.rows.predecessors,()=>this.state.rows.anchor,()=>this.state.rows.successors],newValues=>this.actions.setAllRows(...newValues)),$scope.$watchCollection(()=>({...external_kbnSharedDeps_Lodash_default.a.pick(this,query_parameters.a),indexPatternId:this.indexPattern.id}),newQueryParameters=>{const{queryParameters:queryParameters}=this.state;newQueryParameters.indexPatternId===queryParameters.indexPatternId&&newQueryParameters.anchorId===queryParameters.anchorId&&external_kbnSharedDeps_Lodash_default.a.isEqual(newQueryParameters.sort,queryParameters.sort)?newQueryParameters.predecessorCount===queryParameters.predecessorCount&&newQueryParameters.successorCount===queryParameters.successorCount&&external_kbnSharedDeps_Lodash_default.a.isEqual(newQueryParameters.filters,queryParameters.filters)||this.actions.fetchContextRowsWithNewQueryParameters(external_kbnSharedDeps_Lodash_default.a.cloneDeep(newQueryParameters)):this.actions.fetchAllRowsWithNewQueryParameters(external_kbnSharedDeps_Lodash_default.a.cloneDeep(newQueryParameters))}),$scope.$watchCollection(()=>({predecessorCount:this.state.queryParameters.predecessorCount,successorCount:this.state.queryParameters.successorCount}),newParameters=>{external_kbnSharedDeps_Lodash_default.a.assign(this,newParameters)})}Object(kibana_services.a)().directive("contextApp",(function(){return{bindToController:!0,controller:(constructor=ContextAppController,function($injector,$attrs,$element,$scope,$transclude){this.$onInit=()=>{$injector.invoke(constructor,this,{$attrs:$attrs,$element:$element,$scope:$scope,$transclude:$transclude})}}),controllerAs:"contextApp",restrict:"E",scope:{anchorId:"=",columns:"=",indexPattern:"=",filters:"=",predecessorCount:"=",successorCount:"=",sort:"="},template:'\x3c!-- Context App Legacy --\x3e\n<context-app-legacy\n  filter="contextApp.actions.addFilter"\n  hits="contextApp.state.rows.all"\n  index-pattern="contextApp.indexPattern"\n  sorting="contextApp.state.queryParameters.sort"\n  columns="contextApp.state.queryParameters.columns"\n  minimum-visible-rows="contextApp.state.rows.all.length"\n  status="contextApp.state.loadingStatus.anchor.status"\n  reason="contextApp.state.loadingStatus.anchor.reason"\n  default-step-size="contextApp.state.queryParameters.defaultStepSize"\n  predecessor-count="contextApp.state.queryParameters.predecessorCount"\n  predecessor-available="contextApp.state.rows.predecessors.length"\n  predecessor-status="contextApp.state.loadingStatus.predecessors.status"\n  on-change-predecessor-count="contextApp.actions.fetchGivenPredecessorRows"\n  successor-count="contextApp.state.queryParameters.successorCount"\n  successor-available="contextApp.state.rows.successors.length"\n  successor-status="contextApp.state.loadingStatus.successors.status"\n  on-change-successor-count="contextApp.actions.fetchGivenSuccessorRows"\n  use-new-fields-api="contextApp.state.useNewFieldsApi"\n  top-nav-menu="contextApp.topNavMenu"\n></context-app-legacy>\n'};var constructor}));function context_state_getState({defaultStepSize:defaultStepSize,timeFieldName:timeFieldName,storeInSessionStorage:storeInSessionStorage=!1,history:history,toasts:toasts,uiSettings:uiSettings}){const stateStorage=Object(public_.createKbnUrlStateStorage)({useHash:storeInSessionStorage,history:history,...toasts&&Object(public_.withNotifyOnErrors)(toasts)}),globalStateInitial=stateStorage.get("_g"),globalStateContainer=Object(public_.createStateContainer)(globalStateInitial),appStateInitial=function(defaultSize,timeFieldName,urlState,uiSettings){const defaultState={columns:["_source"],filters:[],predecessorCount:parseInt(defaultSize,10),sort:[timeFieldName,"desc"],successorCount:parseInt(defaultSize,10)};if("object"!=typeof urlState)return defaultState;return Object(helpers.d)({...defaultState,...urlState},uiSettings)}(defaultStepSize,timeFieldName,stateStorage.get("_a"),uiSettings),appStateContainer=Object(public_.createStateContainer)(appStateInitial),{start:start,stop:stop}=Object(public_.syncStates)([{storageKey:"_g",stateContainer:{...globalStateContainer,set:value=>{value&&globalStateContainer.set(value)}},stateStorage:stateStorage},{storageKey:"_a",stateContainer:{...appStateContainer,set:value=>{value&&appStateContainer.set(value)}},stateStorage:stateStorage}]);return{globalState:globalStateContainer,appState:appStateContainer,startSync:start,stopSync:stop,setAppState:newState=>{const oldState=appStateContainer.getState(),mergedState={...oldState,...newState};(function(stateA,stateB){if(!stateA&&!stateB)return!0;if(!stateA||!stateB)return!1;const{filters:stateAFilters=[],...stateAPartial}=stateA,{filters:stateBFilters=[],...stateBPartial}=stateB;return external_kbnSharedDeps_Lodash_default.a.isEqual(stateAPartial,stateBPartial)&&data_public_.esFilters.compareFilters(stateAFilters,stateBFilters,data_public_.esFilters.COMPARE_ALL_OPTIONS)})(oldState,mergedState)||appStateContainer.set(mergedState)},getFilters:()=>[...context_state_getFilters(globalStateContainer.getState()),...context_state_getFilters(appStateContainer.getState())],setFilters:filterManager=>{const globalFilters=filterManager.getGlobalFilters();!context_state_isEqualFilters(globalFilters,context_state_getFilters(globalStateContainer.getState()))&&globalStateContainer.set({filters:globalFilters});const appFilters=filterManager.getAppFilters();!context_state_isEqualFilters(appFilters,context_state_getFilters(appStateContainer.getState()))&&appStateContainer.set({...appStateContainer.getState(),filters:appFilters})},flushToUrl:replace=>stateStorage.kbnUrlControls.flush(replace)}}function context_state_isEqualFilters(filtersA,filtersB){return!filtersA&&!filtersB||!(!filtersA||!filtersB)&&data_public_.esFilters.compareFilters(filtersA,filtersB,data_public_.esFilters.COMPARE_ALL_OPTIONS)}function context_state_getFilters(state){return state&&Array.isArray(state.filters)?state.filters:[]}const k7Breadcrumbs=$route=>{const{indexPattern:indexPattern}=$route.current.locals,{id:id}=$route.current.params;return[...Object(breadcrumbs.a)(),{text:external_kbnSharedDeps_KbnI18n_.i18n.translate("discover.context.breadcrumb",{defaultMessage:"Context of {indexPatternTitle}#{docId}",values:{indexPatternTitle:indexPattern.title,docId:id}})}]};function ContextAppRouteController($routeParams,$scope,$route){const filterManager=Object(kibana_services.f)().filterManager,indexPattern=$route.current.locals.indexPattern.ip,{startSync:startStateSync,stopSync:stopStateSync,appState:appState,getFilters:getFilters,setFilters:setFilters,setAppState:setAppState,flushToUrl:flushToUrl}=context_state_getState({defaultStepSize:Object(kibana_services.f)().uiSettings.get(common.a),timeFieldName:indexPattern.timeFieldName,storeInSessionStorage:Object(kibana_services.f)().uiSettings.get("state:storeInSessionStorage"),history:Object(kibana_services.f)().history(),toasts:Object(kibana_services.f)().core.notifications.toasts,uiSettings:Object(kibana_services.f)().core.uiSettings});this.state={...appState.getState()},this.anchorId=$routeParams.id,this.indexPattern=indexPattern,filterManager.setFilters(external_kbnSharedDeps_Lodash_default.a.cloneDeep(getFilters())),startStateSync(),$scope.$watchGroup(["contextAppRoute.state.columns","contextAppRoute.state.predecessorCount","contextAppRoute.state.successorCount"],newValues=>{const[columns,predecessorCount,successorCount]=newValues;Array.isArray(columns)&&predecessorCount>=0&&successorCount>=0&&(setAppState({columns:columns,predecessorCount:predecessorCount,successorCount:successorCount}),flushToUrl(!0))});const filterObservable=filterManager.getUpdates$().subscribe(()=>{setFilters(filterManager),$route.reload()});$scope.$on("$destroy",()=>{stopStateSync(),filterObservable.unsubscribe()})}Object(kibana_services.a)().config($routeProvider=>{$routeProvider.when("/context/:indexPatternId/:id*",{controller:ContextAppRouteController,k7Breadcrumbs:k7Breadcrumbs,controllerAs:"contextAppRoute",resolve:{indexPattern:($route,Promise)=>{const indexPattern=Object(kibana_services.f)().indexPatterns.get($route.current.params.indexPatternId);return Promise.props({ip:indexPattern})}},template:'<context-app\n  anchor-id="contextAppRoute.anchorId"\n  columns="contextAppRoute.state.columns"\n  index-pattern="contextAppRoute.indexPattern"\n  filters="contextAppRoute.filters"\n  predecessor-count="contextAppRoute.state.predecessorCount"\n  successor-count="contextAppRoute.state.successorCount"\n  sort="contextAppRoute.state.sort"\n></context-app>\n'})});__webpack_require__(99);Object(kibana_services.a)().config($routeProvider=>{$routeProvider.otherwise({resolveRedirectTo:$rootScope=>{const path=window.location.hash.substr(1);return Object(kibana_services.h)().restorePreviousUrl(),$rootScope.$applyAsync(()=>{const{urlForwarding:urlForwarding}=Object(kibana_services.f)(),{navigated:navigated}=urlForwarding.navigateToLegacyKibanaUrl(path);navigated||urlForwarding.navigateToDefaultApp()}),new Promise(()=>{})}})});__webpack_require__(103)}}]);