(window.data_bundle_jsonpfunction=window.data_bundle_jsonpfunction||[]).push([[10],{175:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var external_kbnSharedDeps_React_=__webpack_require__(3),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(16),external_kbnSharedDeps_ElasticEui_=__webpack_require__(11),external_kbnSharedDeps_KbnI18n_=__webpack_require__(0);function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class data_table_DataTableFormat extends external_kbnSharedDeps_React_.Component{constructor(...args){super(...args),_defineProperty(this,"csvSeparator",this.props.uiSettings.get("csv:separator",",")),_defineProperty(this,"quoteValues",this.props.uiSettings.get("csv:quoteValues",!0)),_defineProperty(this,"state",{})}static renderCell({table:table,columnIndex:columnIndex,rowIndex:rowIndex,formattedValue:formattedValue,uiActions:uiActions,isFilterable:isFilterable}){const column=table.columns[columnIndex];return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{responsive:!1,gutterSize:"s",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},formattedValue),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{responsive:!1,gutterSize:"none",alignItems:"center"},isFilterable&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{position:"bottom",content:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"data.inspector.table.filterForValueButtonTooltip",defaultMessage:"Filter for value"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{iconType:"plusInCircle",color:"text","aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("data.inspector.table.filterForValueButtonAriaLabel",{defaultMessage:"Filter for value"}),"data-test-subj":"filterForInspectorCellValue",className:"insDataTableFormat__filter",onClick:()=>{const value=table.rows[rowIndex][column.id],eventData={table:table,column:columnIndex,row:rowIndex,value:value};uiActions.executeTriggerActions("VALUE_CLICK_TRIGGER",{data:{data:[eventData]}})}})),isFilterable&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{position:"bottom",content:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"data.inspector.table.filterOutValueButtonTooltip",defaultMessage:"Filter out value"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{iconType:"minusInCircle",color:"text","aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("data.inspector.table.filterOutValueButtonAriaLabel",{defaultMessage:"Filter out value"}),"data-test-subj":"filterOutInspectorCellValue",className:"insDataTableFormat__filter",onClick:()=>{const value=table.rows[rowIndex][column.id],eventData={table:table,column:columnIndex,row:rowIndex,value:value};uiActions.executeTriggerActions("VALUE_CLICK_TRIGGER",{data:{data:[eventData],negate:!0}})}}))))))}static getDerivedStateFromProps({data:data,uiActions:uiActions,fieldFormats:fieldFormats,isFilterable:isFilterable}){if(!data)return{columns:null,rows:null};return{columns:data.columns.map((dataColumn,index)=>{const formatParams={id:"string",...dataColumn.meta.params},fieldFormatter=fieldFormats.deserialize(formatParams),filterable=isFilterable(dataColumn);return{name:dataColumn.name,field:dataColumn.id,sortable:!0,render:value=>{const formattedValue=fieldFormatter.convert(value),rowIndex=data.rows.findIndex(row=>row[dataColumn.id]===value)||0;return data_table_DataTableFormat.renderCell({table:data,columnIndex:index,rowIndex:rowIndex,formattedValue:formattedValue,uiActions:uiActions,isFilterable:filterable})}}}),rows:data.rows}}render(){const{columns:columns,rows:rows}=this.state;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiInMemoryTable,{className:"insDataTableFormat__table","data-test-subj":"inspectorTable",columns:columns,items:rows,sorting:!0,pagination:{pageSizeOptions:[10,20,50],initialPageSize:20}})}}function data_table_selector_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class data_table_selector_TableSelector extends external_kbnSharedDeps_React_.Component{constructor(...args){super(...args),data_table_selector_defineProperty(this,"state",{isPopoverOpen:!1}),data_table_selector_defineProperty(this,"togglePopover",()=>{this.setState(prevState=>({isPopoverOpen:!prevState.isPopoverOpen}))}),data_table_selector_defineProperty(this,"closePopover",()=>{this.setState({isPopoverOpen:!1})}),data_table_selector_defineProperty(this,"renderTableDropdownItem",(table,index)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenuItem,{key:index,icon:table===this.props.selectedTable?"check":"empty",onClick:()=>{this.props.onTableChanged(table),this.closePopover()},"data-test-subj":"inspectorTableChooser"+index},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"data.inspector.table.tableLabel",defaultMessage:"Table {index}",values:{index:index+1}})))}render(){const currentIndex=this.props.tables.findIndex(table=>table===this.props.selectedTable);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",gutterSize:"xs"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement("strong",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"data.inspector.table.tableSelectorLabel",defaultMessage:"Selected:"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopover,{id:"inspectorTableChooser",button:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{iconType:"arrowDown",iconSide:"right",size:"s",onClick:this.togglePopover,"data-test-subj":"inspectorTableChooser"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"data.inspector.table.tableLabel",defaultMessage:"Table {index}",values:{index:currentIndex+1}})),isOpen:this.state.isPopoverOpen,closePopover:this.closePopover,panelPaddingSize:"none",anchorPosition:"downLeft",repositionOnScroll:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenuPanel,{items:this.props.tables.map(this.renderTableDropdownItem),"data-test-subj":"inspectorTableChooserMenuPanel"}))))}}var common=__webpack_require__(1),public_=__webpack_require__(165);function download_options_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class download_options_DataDownloadOptions extends external_kbnSharedDeps_React_.Component{constructor(...args){super(...args),download_options_defineProperty(this,"state",{isPopoverOpen:!1}),download_options_defineProperty(this,"onTogglePopover",()=>{this.setState(state=>({isPopoverOpen:!state.isPopoverOpen}))}),download_options_defineProperty(this,"closePopover",()=>{this.setState({isPopoverOpen:!1})}),download_options_defineProperty(this,"exportCsv",(isFormatted=!0)=>{let filename=this.props.title;filename&&0!==filename.length||(filename=external_kbnSharedDeps_KbnI18n_.i18n.translate("data.inspector.table.downloadOptionsUnsavedFilename",{defaultMessage:"unsaved"}));const content=this.props.datatables.reduce((memo,datatable,i)=>{if(datatable){const postFix=this.props.datatables.length>1?"-"+(i+1):"";memo[`${filename}${postFix}.csv`]={content:Object(common.datatableToCSV)(datatable,{csvSeparator:this.props.uiSettings.get("csv:separator",","),quoteValues:this.props.uiSettings.get("csv:quoteValues",!0),raw:!isFormatted,formatFactory:this.props.fieldFormats.deserialize}),type:common.CSV_MIME_TYPE}}return memo},{});content&&Object(public_.downloadMultipleAs)(content)}),download_options_defineProperty(this,"exportFormattedCsv",()=>{this.exportCsv(!0)}),download_options_defineProperty(this,"exportFormattedAsRawCsv",()=>{this.exportCsv(!1)})}renderFormattedDownloads(){const button=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{iconType:"arrowDown",iconSide:"right",size:"s",onClick:this.onTogglePopover},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"data.inspector.table.downloadCSVToggleButtonLabel",defaultMessage:"Download CSV"})),items=[external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenuItem,{key:"csv",onClick:this.exportFormattedCsv,toolTipContent:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"data.inspector.table.formattedCSVButtonTooltip",defaultMessage:"Download the data in table format"}),toolTipPosition:"left"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"data.inspector.table.formattedCSVButtonLabel",defaultMessage:"Formatted CSV"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenuItem,{key:"rawCsv",onClick:this.exportFormattedAsRawCsv,toolTipContent:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"data.inspector.table.rawCSVButtonTooltip",defaultMessage:"Download the data as provided, for example, dates as timestamps"}),toolTipPosition:"left"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"data.inspector.table.rawCSVButtonLabel",defaultMessage:"Raw CSV"}))];return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopover,{id:"inspectorDownloadData",button:button,isOpen:this.state.isPopoverOpen,closePopover:this.closePopover,panelPaddingSize:"none",repositionOnScroll:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenuPanel,{className:"eui-textNoWrap",items:items}))}render(){return this.renderFormattedDownloads()}}function data_view_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class data_view_DataViewComponent extends external_kbnSharedDeps_React_.Component{constructor(...args){super(...args),data_view_defineProperty(this,"state",{}),data_view_defineProperty(this,"onUpdateData",tables=>{const keys=Object.keys(tables),datatable=keys.length?tables[keys[0]]:void 0;datatable&&this.setState({datatable:datatable})}),data_view_defineProperty(this,"selectTable",datatable=>{datatable!==this.state.datatable&&this.setState({datatable:datatable})})}static getDerivedStateFromProps(nextProps,state){if(state&&nextProps.adapters===state.adapters)return null;const{tables:tables}=nextProps.adapters.tables,keys=Object.keys(tables),datatable=keys.length?tables[keys[0]]:void 0;return{adapters:nextProps.adapters,datatable:datatable}}componentDidMount(){this.props.adapters.tables.on("change",this.onUpdateData)}componentWillUnmount(){this.props.adapters.tables.removeListener("change",this.onUpdateData)}static renderNoData(){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiEmptyPrompt,{title:external_kbnSharedDeps_React_default.a.createElement("h2",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"data.inspector.table.noDataAvailableTitle",defaultMessage:"No data available"})),body:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"data.inspector.table.noDataAvailableDescription",defaultMessage:"The element did not provide any data."})))})}render(){var _this$props$options;if(!this.state.datatable)return data_view_DataViewComponent.renderNoData();const datatables=Object.values(this.state.adapters.tables.tables);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!0},datatables.length>1?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("p",{role:"status","aria-live":"polite","aria-atomic":"true"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{"data-test-subj":"inspectorDataViewSelectorLabel",id:"data.inspector.table.tablesDescription",defaultMessage:"There are {tablesCount, plural, one {# table} other {# tables} } in total",values:{tablesCount:datatables.length}}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(data_table_selector_TableSelector,{tables:datatables,selectedTable:this.state.datatable,onTableChanged:this.selectTable})):null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(download_options_DataDownloadOptions,{title:(null===(_this$props$options=this.props.options)||void 0===_this$props$options?void 0:_this$props$options.fileName)||this.props.title,uiSettings:this.props.uiSettings,datatables:datatables,fieldFormats:this.props.fieldFormats}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(data_table_DataTableFormat,{data:this.state.datatable,uiSettings:this.props.uiSettings,fieldFormats:this.props.fieldFormats,uiActions:this.props.uiActions,isFilterable:this.props.isFilterable}))}}__webpack_exports__.default=data_view_DataViewComponent}}]);