(window.data_bundle_jsonpfunction=window.data_bundle_jsonpfunction||[]).push([[7],{172:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"default",(function(){return IndexPatternSelect}));var lodash__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2),lodash__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_0__),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(3),react__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__),_elastic_eui__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(11);function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class IndexPatternSelect extends react__WEBPACK_IMPORTED_MODULE_1__.Component{constructor(props){super(props),_defineProperty(this,"isMounted",!1),_defineProperty(this,"state",void 0),_defineProperty(this,"fetchSelectedIndexPattern",async indexPatternId=>{if(!indexPatternId)return void this.setState({selectedIndexPattern:void 0});let indexPatternTitle;try{indexPatternTitle=(await this.props.indexPatternService.get(indexPatternId)).title}catch(err){return}this.isMounted&&this.setState({selectedIndexPattern:{value:indexPatternId,label:indexPatternTitle}})}),_defineProperty(this,"debouncedFetch",lodash__WEBPACK_IMPORTED_MODULE_0___default.a.debounce(async searchValue=>{const idsAndTitles=await this.props.indexPatternService.getIdsWithTitle();if(!this.isMounted||searchValue!==this.state.searchValue)return;const options=[];for(let i=0;i<idsAndTitles.length;i++)idsAndTitles[i].title.toLowerCase().includes(searchValue.toLowerCase())&&options.push({label:idsAndTitles[i].title,value:idsAndTitles[i].id});this.setState({isLoading:!1,options:options}),this.props.onNoIndexPatterns&&""===searchValue&&0===options.length&&this.props.onNoIndexPatterns()},300)),_defineProperty(this,"fetchOptions",(searchValue="")=>{this.setState({isLoading:!0,searchValue:searchValue},this.debouncedFetch.bind(null,searchValue))}),_defineProperty(this,"onChange",selectedOptions=>{this.props.onChange(lodash__WEBPACK_IMPORTED_MODULE_0___default.a.get(selectedOptions,"0.value"))}),this.state={isLoading:!1,options:[],selectedIndexPattern:void 0,searchValue:void 0}}componentWillUnmount(){this.isMounted=!1,this.debouncedFetch.cancel()}componentDidMount(){this.isMounted=!0,this.fetchOptions(""),this.fetchSelectedIndexPattern(this.props.indexPatternId)}UNSAFE_componentWillReceiveProps(nextProps){nextProps.indexPatternId!==this.props.indexPatternId&&this.fetchSelectedIndexPattern(nextProps.indexPatternId)}render(){const{onChange:onChange,indexPatternId:indexPatternId,placeholder:placeholder,onNoIndexPatterns:onNoIndexPatterns,indexPatternService:indexPatternService,...rest}=this.props;return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_2__.EuiComboBox,_extends({},rest,{placeholder:placeholder,singleSelection:!0,isLoading:this.state.isLoading,onSearchChange:this.fetchOptions,options:this.state.options,selectedOptions:this.state.selectedIndexPattern?[this.state.selectedIndexPattern]:[],onChange:this.onChange}))}}}}]);