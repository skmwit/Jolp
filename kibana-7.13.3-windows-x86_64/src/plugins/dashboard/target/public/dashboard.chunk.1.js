(window.dashboard_bundle_jsonpfunction=window.dashboard_bundle_jsonpfunction||[]).push([[1],{129:function(module,exports){},130:function(module,exports){},131:function(module,exports,__webpack_require__){switch(window.__kbnThemeTag__){case"v7dark":return __webpack_require__(132);case"v7light":return __webpack_require__(134);case"v8dark":return __webpack_require__(136);case"v8light":return __webpack_require__(138)}},132:function(module,exports,__webpack_require__){var api=__webpack_require__(45),content=__webpack_require__(133);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},133:function(module,exports,__webpack_require__){(exports=__webpack_require__(46)(!1)).push([module.i,".react-grid-layout .gs-w{z-index:auto}.dshLayout--viewing .react-resizable-handle{display:none}.dshLayout--editing .react-resizable-handle{width:24px;height:24px;z-index:1000;right:0;bottom:0;padding-right:8px;padding-bottom:8px}.dshLayout-isMaximizedPanel{height:100% !important;width:100%;position:absolute !important}.dshDashboardGrid__item--hidden{display:none}.dshDashboardGrid__item--expanded{height:100% !important;width:100% !important;top:0 !important;left:0 !important}.react-grid-item{transition:none}.react-grid-item>.react-resizable-handle{background-image:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='6' height='6' viewBox='0 0 6 6'%3E%3Cpolygon fill='rgb%28152, 162, 179%29' points='6 6 0 6 0 4.2 4 4.2 4.2 4.2 4.2 0 6 0' /%3E%3C/svg%3E%0A\")}.react-grid-item>.react-resizable-handle::after{border:none !important}.react-grid-item>.react-resizable-handle:hover,.react-grid-item>.react-resizable-handle:focus{background-color:rgba(255,206,122,0.3)}.react-grid-item.resizing,.react-grid-item.react-draggable-dragging{z-index:2000 !important}.react-grid-item.react-draggable-dragging{transition:box-shadow 150ms cubic-bezier(0.694, 0.0482, 0.335, 1);box-shadow:0 40px 64px 0 rgba(0,0,0,0.1),0 24px 32px 0 rgba(0,0,0,0.1),0 16px 16px 0 rgba(0,0,0,0.1),0 8px 8px 0 rgba(0,0,0,0.1),0 4px 4px 0 rgba(0,0,0,0.1),0 2px 2px 0 rgba(0,0,0,0.1);border-radius:4px}.react-grid-item.react-grid-placeholder{border-radius:4px;background:#FFCE7A}@media only screen and (max-width: 574px){.dshLayout--viewing .react-grid-item{position:static !important;width:calc(100% - 16px) !important;margin:8px}.dshLayout--viewing.dshLayout-withoutMargins .react-grid-item{width:100% !important;margin:0}}@media only screen and (min-width: 575px) and (max-width: 767px){.dshLayout--viewing .react-grid-item{position:static !important;width:calc(100% - 16px) !important;margin:8px}.dshLayout--viewing.dshLayout-withoutMargins .react-grid-item{width:100% !important;margin:0}}.dshLayout-withoutMargins .embPanel,.dshDashboardGrid__item--expanded .embPanel{box-shadow:none;border-radius:0}.dshLayout-withoutMargins:not(.dshLayout--editing) .embPanel,.dshDashboardGrid__item--expanded .embPanel{border-color:transparent}.dshDashboardViewport{width:100%}.dshDashboardViewport-withMargins{width:100%}.dshAppContainer{display:flex;flex-direction:column;flex:1}.dashboardViewport{flex:1;display:flex;flex-direction:column}.dshStartScreen{text-align:center}.dshStartScreen__pageContent{padding:40px}.dshStartScreen__panelDesc{max-width:260px;margin:0 auto}.dshEmptyWidget{background-color:#25262E;border:1px solid #343741;border-style:dashed;border-radius:4px;padding:80px;max-width:400px;margin-left:8px;text-align:center}.dshUnsavedListingItem{margin-top:12px}.dshUnsavedListingItem__icon{margin-right:12px}.dshUnsavedListingItem__title{margin-bottom:0 !important}.dshUnsavedListingItem__loading{color:#7a7f89 !important}.dshUnsavedListingItem__actions{margin-left:28px}@media only screen and (max-width: 574px){.dshUnsavedListingItem{margin-top:16px}.dshUnsavedListingItem__heading{margin-bottom:4px}.dshUnsavedListingItem__actions{flex-direction:column}}@media only screen and (min-width: 575px) and (max-width: 767px){.dshUnsavedListingItem{margin-top:16px}.dshUnsavedListingItem__heading{margin-bottom:4px}.dshUnsavedListingItem__actions{flex-direction:column}}.dshSolutionToolbar__editorContextMenu--dark .euiIcon path{fill:#fff}.dshSolutionToolbar__editorContextMenu--light .euiIcon path{fill:#000}\n",""]),module.exports=exports},134:function(module,exports,__webpack_require__){var api=__webpack_require__(45),content=__webpack_require__(135);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},135:function(module,exports,__webpack_require__){(exports=__webpack_require__(46)(!1)).push([module.i,".react-grid-layout .gs-w{z-index:auto}.dshLayout--viewing .react-resizable-handle{display:none}.dshLayout--editing .react-resizable-handle{width:24px;height:24px;z-index:1000;right:0;bottom:0;padding-right:8px;padding-bottom:8px}.dshLayout-isMaximizedPanel{height:100% !important;width:100%;position:absolute !important}.dshDashboardGrid__item--hidden{display:none}.dshDashboardGrid__item--expanded{height:100% !important;width:100% !important;top:0 !important;left:0 !important}.react-grid-item{transition:none}.react-grid-item>.react-resizable-handle{background-image:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='6' height='6' viewBox='0 0 6 6'%3E%3Cpolygon fill='rgb%28105, 112, 125%29' points='6 6 0 6 0 4.2 4 4.2 4.2 4.2 4.2 0 6 0' /%3E%3C/svg%3E%0A\")}.react-grid-item>.react-resizable-handle::after{border:none !important}.react-grid-item>.react-resizable-handle:hover,.react-grid-item>.react-resizable-handle:focus{background-color:rgba(245,167,0,0.1)}.react-grid-item.resizing,.react-grid-item.react-draggable-dragging{z-index:2000 !important}.react-grid-item.react-draggable-dragging{transition:box-shadow 150ms cubic-bezier(0.694, 0.0482, 0.335, 1);box-shadow:0 40px 64px 0 rgba(65,78,101,0.1),0 24px 32px 0 rgba(65,78,101,0.1),0 16px 16px 0 rgba(65,78,101,0.1),0 8px 8px 0 rgba(65,78,101,0.1),0 4px 4px 0 rgba(65,78,101,0.1),0 2px 2px 0 rgba(65,78,101,0.1);border-radius:4px}.react-grid-item.react-grid-placeholder{border-radius:4px;background:#F5A700}@media only screen and (max-width: 574px){.dshLayout--viewing .react-grid-item{position:static !important;width:calc(100% - 16px) !important;margin:8px}.dshLayout--viewing.dshLayout-withoutMargins .react-grid-item{width:100% !important;margin:0}}@media only screen and (min-width: 575px) and (max-width: 767px){.dshLayout--viewing .react-grid-item{position:static !important;width:calc(100% - 16px) !important;margin:8px}.dshLayout--viewing.dshLayout-withoutMargins .react-grid-item{width:100% !important;margin:0}}.dshLayout-withoutMargins .embPanel,.dshDashboardGrid__item--expanded .embPanel{box-shadow:none;border-radius:0}.dshLayout-withoutMargins:not(.dshLayout--editing) .embPanel,.dshDashboardGrid__item--expanded .embPanel{border-color:transparent}.dshDashboardViewport{width:100%}.dshDashboardViewport-withMargins{width:100%}.dshAppContainer{display:flex;flex-direction:column;flex:1}.dashboardViewport{flex:1;display:flex;flex-direction:column}.dshStartScreen{text-align:center}.dshStartScreen__pageContent{padding:40px}.dshStartScreen__panelDesc{max-width:260px;margin:0 auto}.dshEmptyWidget{background-color:#F5F7FA;border:1px solid #D3DAE6;border-style:dashed;border-radius:4px;padding:80px;max-width:400px;margin-left:8px;text-align:center}.dshUnsavedListingItem{margin-top:12px}.dshUnsavedListingItem__icon{margin-right:12px}.dshUnsavedListingItem__title{margin-bottom:0 !important}.dshUnsavedListingItem__loading{color:#6a717d !important}.dshUnsavedListingItem__actions{margin-left:28px}@media only screen and (max-width: 574px){.dshUnsavedListingItem{margin-top:16px}.dshUnsavedListingItem__heading{margin-bottom:4px}.dshUnsavedListingItem__actions{flex-direction:column}}@media only screen and (min-width: 575px) and (max-width: 767px){.dshUnsavedListingItem{margin-top:16px}.dshUnsavedListingItem__heading{margin-bottom:4px}.dshUnsavedListingItem__actions{flex-direction:column}}.dshSolutionToolbar__editorContextMenu--dark .euiIcon path{fill:#fff}.dshSolutionToolbar__editorContextMenu--light .euiIcon path{fill:#000}\n",""]),module.exports=exports},136:function(module,exports,__webpack_require__){var api=__webpack_require__(45),content=__webpack_require__(137);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},137:function(module,exports,__webpack_require__){(exports=__webpack_require__(46)(!1)).push([module.i,".react-grid-layout .gs-w{z-index:auto}.dshLayout--viewing .react-resizable-handle{display:none}.dshLayout--editing .react-resizable-handle{width:24px;height:24px;z-index:1000;right:0;bottom:0;padding-right:8px;padding-bottom:8px}.dshLayout-isMaximizedPanel{height:100% !important;width:100%;position:absolute !important}.dshDashboardGrid__item--hidden{display:none}.dshDashboardGrid__item--expanded{height:100% !important;width:100% !important;top:0 !important;left:0 !important}.react-grid-item{transition:none}.react-grid-item>.react-resizable-handle{background-image:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='6' height='6' viewBox='0 0 6 6'%3E%3Cpolygon fill='rgb%28152, 162, 179%29' points='6 6 0 6 0 4.2 4 4.2 4.2 4.2 4.2 0 6 0' /%3E%3C/svg%3E%0A\")}.react-grid-item>.react-resizable-handle::after{border:none !important}.react-grid-item>.react-resizable-handle:hover,.react-grid-item>.react-resizable-handle:focus{background-color:rgba(243,211,113,0.3)}.react-grid-item.resizing,.react-grid-item.react-draggable-dragging{z-index:2000 !important}.react-grid-item.react-draggable-dragging{transition:box-shadow 150ms cubic-bezier(0.694, 0.0482, 0.335, 1);box-shadow:0 2.7px 9px rgba(0,0,0,0.325),0 9.4px 24px rgba(0,0,0,0.225),0 21.8px 43px rgba(0,0,0,0.2);border-radius:6px}.react-grid-item.react-grid-placeholder{border-radius:6px;background:#F3D371}@media only screen and (max-width: 574px){.dshLayout--viewing .react-grid-item{position:static !important;width:calc(100% - 16px) !important;margin:8px}.dshLayout--viewing.dshLayout-withoutMargins .react-grid-item{width:100% !important;margin:0}}@media only screen and (min-width: 575px) and (max-width: 767px){.dshLayout--viewing .react-grid-item{position:static !important;width:calc(100% - 16px) !important;margin:8px}.dshLayout--viewing.dshLayout-withoutMargins .react-grid-item{width:100% !important;margin:0}}.dshLayout-withoutMargins .embPanel,.dshDashboardGrid__item--expanded .embPanel{box-shadow:none;border-radius:0}.dshLayout-withoutMargins:not(.dshLayout--editing) .embPanel,.dshDashboardGrid__item--expanded .embPanel{border-color:transparent}.dshDashboardViewport{width:100%}.dshDashboardViewport-withMargins{width:100%}.dshAppContainer{display:flex;flex-direction:column;flex:1}.dashboardViewport{flex:1;display:flex;flex-direction:column}.dshStartScreen{text-align:center}.dshStartScreen__pageContent{padding:40px}.dshStartScreen__panelDesc{max-width:260px;margin:0 auto}.dshEmptyWidget{background-color:#25262E;border:1px solid #343741;border-style:dashed;border-radius:6px;padding:80px;max-width:400px;margin-left:8px;text-align:center}.dshUnsavedListingItem{margin-top:12px}.dshUnsavedListingItem__icon{margin-right:12px}.dshUnsavedListingItem__title{margin-bottom:0 !important}.dshUnsavedListingItem__loading{color:#7a7f89 !important}.dshUnsavedListingItem__actions{margin-left:28px}@media only screen and (max-width: 574px){.dshUnsavedListingItem{margin-top:16px}.dshUnsavedListingItem__heading{margin-bottom:4px}.dshUnsavedListingItem__actions{flex-direction:column}}@media only screen and (min-width: 575px) and (max-width: 767px){.dshUnsavedListingItem{margin-top:16px}.dshUnsavedListingItem__heading{margin-bottom:4px}.dshUnsavedListingItem__actions{flex-direction:column}}.dshSolutionToolbar__editorContextMenu--dark .euiIcon path{fill:#fff}.dshSolutionToolbar__editorContextMenu--light .euiIcon path{fill:#000}\n",""]),module.exports=exports},138:function(module,exports,__webpack_require__){var api=__webpack_require__(45),content=__webpack_require__(139);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},139:function(module,exports,__webpack_require__){(exports=__webpack_require__(46)(!1)).push([module.i,".react-grid-layout .gs-w{z-index:auto}.dshLayout--viewing .react-resizable-handle{display:none}.dshLayout--editing .react-resizable-handle{width:24px;height:24px;z-index:1000;right:0;bottom:0;padding-right:8px;padding-bottom:8px}.dshLayout-isMaximizedPanel{height:100% !important;width:100%;position:absolute !important}.dshDashboardGrid__item--hidden{display:none}.dshDashboardGrid__item--expanded{height:100% !important;width:100% !important;top:0 !important;left:0 !important}.react-grid-item{transition:none}.react-grid-item>.react-resizable-handle{background-image:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='6' height='6' viewBox='0 0 6 6'%3E%3Cpolygon fill='rgb%28105, 112, 125%29' points='6 6 0 6 0 4.2 4 4.2 4.2 4.2 4.2 0 6 0' /%3E%3C/svg%3E%0A\")}.react-grid-item>.react-resizable-handle::after{border:none !important}.react-grid-item>.react-resizable-handle:hover,.react-grid-item>.react-resizable-handle:focus{background-color:rgba(254,197,20,0.1)}.react-grid-item.resizing,.react-grid-item.react-draggable-dragging{z-index:2000 !important}.react-grid-item.react-draggable-dragging{transition:box-shadow 150ms cubic-bezier(0.694, 0.0482, 0.335, 1);box-shadow:0 2.7px 9px rgba(0,0,0,0.13),0 9.4px 24px rgba(0,0,0,0.09),0 21.8px 43px rgba(0,0,0,0.08);border-radius:6px}.react-grid-item.react-grid-placeholder{border-radius:6px;background:#FEC514}@media only screen and (max-width: 574px){.dshLayout--viewing .react-grid-item{position:static !important;width:calc(100% - 16px) !important;margin:8px}.dshLayout--viewing.dshLayout-withoutMargins .react-grid-item{width:100% !important;margin:0}}@media only screen and (min-width: 575px) and (max-width: 767px){.dshLayout--viewing .react-grid-item{position:static !important;width:calc(100% - 16px) !important;margin:8px}.dshLayout--viewing.dshLayout-withoutMargins .react-grid-item{width:100% !important;margin:0}}.dshLayout-withoutMargins .embPanel,.dshDashboardGrid__item--expanded .embPanel{box-shadow:none;border-radius:0}.dshLayout-withoutMargins:not(.dshLayout--editing) .embPanel,.dshDashboardGrid__item--expanded .embPanel{border-color:transparent}.dshDashboardViewport{width:100%}.dshDashboardViewport-withMargins{width:100%}.dshAppContainer{display:flex;flex-direction:column;flex:1}.dashboardViewport{flex:1;display:flex;flex-direction:column}.dshStartScreen{text-align:center}.dshStartScreen__pageContent{padding:40px}.dshStartScreen__panelDesc{max-width:260px;margin:0 auto}.dshEmptyWidget{background-color:#F5F7FA;border:1px solid #D3DAE6;border-style:dashed;border-radius:6px;padding:80px;max-width:400px;margin-left:8px;text-align:center}.dshUnsavedListingItem{margin-top:12px}.dshUnsavedListingItem__icon{margin-right:12px}.dshUnsavedListingItem__title{margin-bottom:0 !important}.dshUnsavedListingItem__loading{color:#69707D !important}.dshUnsavedListingItem__actions{margin-left:28px}@media only screen and (max-width: 574px){.dshUnsavedListingItem{margin-top:16px}.dshUnsavedListingItem__heading{margin-bottom:4px}.dshUnsavedListingItem__actions{flex-direction:column}}@media only screen and (min-width: 575px) and (max-width: 767px){.dshUnsavedListingItem{margin-top:16px}.dshUnsavedListingItem__heading{margin-bottom:4px}.dshUnsavedListingItem__actions{flex-direction:column}}.dshSolutionToolbar__editorContextMenu--dark .euiIcon path{fill:#fff}.dshSolutionToolbar__editorContextMenu--light .euiIcon path{fill:#000}\n",""]),module.exports=exports},140:function(module,exports,__webpack_require__){"use strict";const strictUriEncode=__webpack_require__(141),decodeComponent=__webpack_require__(142),splitOnFirst=__webpack_require__(143);function validateArrayFormatSeparator(value){if("string"!=typeof value||1!==value.length)throw new TypeError("arrayFormatSeparator must be single character string")}function encode(value,options){return options.encode?options.strict?strictUriEncode(value):encodeURIComponent(value):value}function decode(value,options){return options.decode?decodeComponent(value):value}function removeHash(input){const hashStart=input.indexOf("#");return-1!==hashStart&&(input=input.slice(0,hashStart)),input}function extract(input){const queryStart=(input=removeHash(input)).indexOf("?");return-1===queryStart?"":input.slice(queryStart+1)}function parseValue(value,options){return options.parseNumbers&&!Number.isNaN(Number(value))&&"string"==typeof value&&""!==value.trim()?value=Number(value):!options.parseBooleans||null===value||"true"!==value.toLowerCase()&&"false"!==value.toLowerCase()||(value="true"===value.toLowerCase()),value}function parse(input,options){validateArrayFormatSeparator((options=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},options)).arrayFormatSeparator);const formatter=function(options){let result;switch(options.arrayFormat){case"index":return(key,value,accumulator)=>{result=/\[(\d*)\]$/.exec(key),key=key.replace(/\[\d*\]$/,""),result?(void 0===accumulator[key]&&(accumulator[key]={}),accumulator[key][result[1]]=value):accumulator[key]=value};case"bracket":return(key,value,accumulator)=>{result=/(\[\])$/.exec(key),key=key.replace(/\[\]$/,""),result?void 0!==accumulator[key]?accumulator[key]=[].concat(accumulator[key],value):accumulator[key]=[value]:accumulator[key]=value};case"comma":case"separator":return(key,value,accumulator)=>{const newValue="string"==typeof value&&value.split("").indexOf(options.arrayFormatSeparator)>-1?value.split(options.arrayFormatSeparator).map(item=>decode(item,options)):null===value?value:decode(value,options);accumulator[key]=newValue};default:return(key,value,accumulator)=>{void 0!==accumulator[key]?accumulator[key]=[].concat(accumulator[key],value):accumulator[key]=value}}}(options),ret=Object.create(null);if("string"!=typeof input)return ret;if(!(input=input.trim().replace(/^[?#&]/,"")))return ret;for(const param of input.split("&")){let[key,value]=splitOnFirst(options.decode?param.replace(/\+/g," "):param,"=");value=void 0===value?null:["comma","separator"].includes(options.arrayFormat)?value:decode(value,options),formatter(decode(key,options),value,ret)}for(const key of Object.keys(ret)){const value=ret[key];if("object"==typeof value&&null!==value)for(const k of Object.keys(value))value[k]=parseValue(value[k],options);else ret[key]=parseValue(value,options)}return!1===options.sort?ret:(!0===options.sort?Object.keys(ret).sort():Object.keys(ret).sort(options.sort)).reduce((result,key)=>{const value=ret[key];return Boolean(value)&&"object"==typeof value&&!Array.isArray(value)?result[key]=function keysSorter(input){return Array.isArray(input)?input.sort():"object"==typeof input?keysSorter(Object.keys(input)).sort((a,b)=>Number(a)-Number(b)).map(key=>input[key]):input}(value):result[key]=value,result},Object.create(null))}exports.extract=extract,exports.parse=parse,exports.stringify=(object,options)=>{if(!object)return"";validateArrayFormatSeparator((options=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},options)).arrayFormatSeparator);const shouldFilter=key=>options.skipNull&&null==object[key]||options.skipEmptyString&&""===object[key],formatter=function(options){switch(options.arrayFormat){case"index":return key=>(result,value)=>{const index=result.length;return void 0===value||options.skipNull&&null===value||options.skipEmptyString&&""===value?result:null===value?[...result,[encode(key,options),"[",index,"]"].join("")]:[...result,[encode(key,options),"[",encode(index,options),"]=",encode(value,options)].join("")]};case"bracket":return key=>(result,value)=>void 0===value||options.skipNull&&null===value||options.skipEmptyString&&""===value?result:null===value?[...result,[encode(key,options),"[]"].join("")]:[...result,[encode(key,options),"[]=",encode(value,options)].join("")];case"comma":case"separator":return key=>(result,value)=>null==value||0===value.length?result:0===result.length?[[encode(key,options),"=",encode(value,options)].join("")]:[[result,encode(value,options)].join(options.arrayFormatSeparator)];default:return key=>(result,value)=>void 0===value||options.skipNull&&null===value||options.skipEmptyString&&""===value?result:null===value?[...result,encode(key,options)]:[...result,[encode(key,options),"=",encode(value,options)].join("")]}}(options),objectCopy={};for(const key of Object.keys(object))shouldFilter(key)||(objectCopy[key]=object[key]);const keys=Object.keys(objectCopy);return!1!==options.sort&&keys.sort(options.sort),keys.map(key=>{const value=object[key];return void 0===value?"":null===value?encode(key,options):Array.isArray(value)?value.reduce(formatter(key),[]).join("&"):encode(key,options)+"="+encode(value,options)}).filter(x=>x.length>0).join("&")},exports.parseUrl=(input,options)=>{options=Object.assign({decode:!0},options);const[url,hash]=splitOnFirst(input,"#");return Object.assign({url:url.split("?")[0]||"",query:parse(extract(input),options)},options&&options.parseFragmentIdentifier&&hash?{fragmentIdentifier:decode(hash,options)}:{})},exports.stringifyUrl=(input,options)=>{options=Object.assign({encode:!0,strict:!0},options);const url=removeHash(input.url).split("?")[0]||"",queryFromUrl=exports.extract(input.url),parsedQueryFromUrl=exports.parse(queryFromUrl,{sort:!1}),query=Object.assign(parsedQueryFromUrl,input.query);let queryString=exports.stringify(query,options);queryString&&(queryString="?"+queryString);let hash=function(url){let hash="";const hashStart=url.indexOf("#");return-1!==hashStart&&(hash=url.slice(hashStart)),hash}(input.url);return input.fragmentIdentifier&&(hash="#"+encode(input.fragmentIdentifier,options)),`${url}${queryString}${hash}`}},141:function(module,exports,__webpack_require__){"use strict";module.exports=str=>encodeURIComponent(str).replace(/[!'()*]/g,x=>"%"+x.charCodeAt(0).toString(16).toUpperCase())},142:function(module,exports,__webpack_require__){"use strict";var singleMatcher=new RegExp("%[a-f0-9]{2}","gi"),multiMatcher=new RegExp("(%[a-f0-9]{2})+","gi");function decodeComponents(components,split){try{return decodeURIComponent(components.join(""))}catch(err){}if(1===components.length)return components;split=split||1;var left=components.slice(0,split),right=components.slice(split);return Array.prototype.concat.call([],decodeComponents(left),decodeComponents(right))}function decode(input){try{return decodeURIComponent(input)}catch(err){for(var tokens=input.match(singleMatcher),i=1;i<tokens.length;i++)tokens=(input=decodeComponents(tokens,i).join("")).match(singleMatcher);return input}}module.exports=function(encodedURI){if("string"!=typeof encodedURI)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof encodedURI+"`");try{return encodedURI=encodedURI.replace(/\+/g," "),decodeURIComponent(encodedURI)}catch(err){return function(input){for(var replaceMap={"%FE%FF":"��","%FF%FE":"��"},match=multiMatcher.exec(input);match;){try{replaceMap[match[0]]=decodeURIComponent(match[0])}catch(err){var result=decode(match[0]);result!==match[0]&&(replaceMap[match[0]]=result)}match=multiMatcher.exec(input)}replaceMap["%C2"]="�";for(var entries=Object.keys(replaceMap),i=0;i<entries.length;i++){var key=entries[i];input=input.replace(new RegExp(key,"g"),replaceMap[key])}return input}(encodedURI)}}},143:function(module,exports,__webpack_require__){"use strict";module.exports=(string,separator)=>{if("string"!=typeof string||"string"!=typeof separator)throw new TypeError("Expected the arguments to be of type `string`");if(""===separator)return[string];const separatorIndex=string.indexOf(separator);return-1===separatorIndex?[string]:[string.slice(0,separatorIndex),string.slice(separatorIndex+separator.length)]}},144:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var tslib_1=__webpack_require__(128),react_1=__webpack_require__(0),useEffectOnce_1=tslib_1.__importDefault(__webpack_require__(145));exports.default=function(fn){var fnRef=react_1.useRef(fn);fnRef.current=fn,useEffectOnce_1.default((function(){return function(){return fnRef.current()}}))}},145:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var react_1=__webpack_require__(0);exports.default=function(effect){react_1.useEffect(effect,[])}},146:function(module,exports,__webpack_require__){"use strict";module.exports=function equal(a,b){if(a===b)return!0;if(a&&b&&"object"==typeof a&&"object"==typeof b){if(a.constructor!==b.constructor)return!1;var length,i,keys;if(Array.isArray(a)){if((length=a.length)!=b.length)return!1;for(i=length;0!=i--;)if(!equal(a[i],b[i]))return!1;return!0}if(a.constructor===RegExp)return a.source===b.source&&a.flags===b.flags;if(a.valueOf!==Object.prototype.valueOf)return a.valueOf()===b.valueOf();if(a.toString!==Object.prototype.toString)return a.toString()===b.toString();if((length=(keys=Object.keys(a)).length)!==Object.keys(b).length)return!1;for(i=length;0!=i--;)if(!Object.prototype.hasOwnProperty.call(b,keys[i]))return!1;for(i=length;0!=i--;){var key=keys[i];if(!equal(a[key],b[key]))return!1}return!0}return a!=a&&b!=b}},147:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"dashboardUrlParams",(function(){return dashboardUrlParams})),__webpack_require__.d(__webpack_exports__,"mountApp",(function(){return mountApp}));__webpack_require__(131);var external_kbnSharedDeps_React_=__webpack_require__(0),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(18),query_string=__webpack_require__(140),external_kbnSharedDeps_ReactDom_=__webpack_require__(14),external_kbnSharedDeps_ReactDom_default=__webpack_require__.n(external_kbnSharedDeps_ReactDom_),external_kbnSharedDeps_ReactRouterDom_=__webpack_require__(123),external_kbnSharedDeps_RxjsOperators_=__webpack_require__(36),external_kbnSharedDeps_ElasticEui_=__webpack_require__(4),external_kbnSharedDeps_Lodash_=__webpack_require__(10),external_kbnSharedDeps_Lodash_default=__webpack_require__.n(external_kbnSharedDeps_Lodash_),services_data=__webpack_require__(21),external_kbnSharedDeps_Moment_=__webpack_require__(124),external_kbnSharedDeps_Moment_default=__webpack_require__.n(external_kbnSharedDeps_Moment_);class filter_utils_FilterUtils{static convertTimeToUTCString(time){return external_kbnSharedDeps_Moment_default()(time).isValid()?external_kbnSharedDeps_Moment_default()(time).utc().format("YYYY-MM-DDTHH:mm:ss.SSS[Z]"):time}static areTimesEqual(timeA,timeB){return this.convertTimeToUTCString(timeA)===this.convertTimeToUTCString(timeB)}static cleanFiltersForComparison(filters){return external_kbnSharedDeps_Lodash_default.a.map(filters,filter=>{const f=external_kbnSharedDeps_Lodash_default.a.omit(filter,["$$hashKey","$state"]);return f.meta?external_kbnSharedDeps_Lodash_default.a.omit(f.meta,["value"]):f})}}function saveDashboard(toJson,timeFilter,dashboardStateManager,saveOptions){const savedDashboard=dashboardStateManager.savedDashboard;return function(savedDashboard,appState,timeFilter,hasTaggingCapabilities,toJson){savedDashboard.title=appState.title,savedDashboard.description=appState.description,savedDashboard.timeRestore=appState.timeRestore,savedDashboard.panelsJSON=toJson(appState.panels),savedDashboard.optionsJSON=toJson(appState.options),hasTaggingCapabilities(savedDashboard)&&savedDashboard.setTags(appState.tags),savedDashboard.timeFrom=savedDashboard.timeRestore?filter_utils_FilterUtils.convertTimeToUTCString(timeFilter.getTime().from):void 0,savedDashboard.timeTo=savedDashboard.timeRestore?filter_utils_FilterUtils.convertTimeToUTCString(timeFilter.getTime().to):void 0;const timeRestoreObj=external_kbnSharedDeps_Lodash_default.a.pick(timeFilter.getRefreshInterval(),["display","pause","section","value"]);savedDashboard.refreshInterval=savedDashboard.timeRestore?timeRestoreObj:void 0;const unpinnedFilters=savedDashboard.getFilters().filter(filter=>!services_data.esFilters.isFilterPinned(filter));savedDashboard.searchSource.setField("filter",unpinnedFilters)}(savedDashboard,dashboardStateManager.appState,timeFilter,dashboardStateManager.hasTaggingCapabilities,toJson),savedDashboard.save(saveOptions).then(id=>(id&&(dashboardStateManager.lastSavedDashboardFilters=dashboardStateManager.getFilterState()),id))}function getAppStateDefaults(viewMode,savedDashboard,hasTaggingCapabilities){return{fullScreenMode:!1,title:savedDashboard.title,description:savedDashboard.description||"",tags:hasTaggingCapabilities(savedDashboard)?savedDashboard.getTags():[],timeRestore:savedDashboard.timeRestore,panels:savedDashboard.panelsJSON?JSON.parse(savedDashboard.panelsJSON):[],options:savedDashboard.optionsJSON?JSON.parse(savedDashboard.optionsJSON):{},query:savedDashboard.getQuery(),filters:savedDashboard.getFilters(),viewMode:viewMode}}var satisfies=__webpack_require__(48),satisfies_default=__webpack_require__.n(satisfies),external_kbnSharedDeps_KbnI18n_=__webpack_require__(1),external_kbnSharedDeps_KbnAnalytics_=__webpack_require__(122),uuid=(__webpack_require__(130),__webpack_require__(129),__webpack_require__(30),__webpack_require__(28)),uuid_default=__webpack_require__.n(uuid);function migratePanelsTo730(panels,version,useMargins,uiState){return panels.map(panel=>function(panel){return void 0!==panel.row}(panel)?function(panel,version,useMargins,uiState){if(void 0===panel.col||void 0===panel.row)throw new Error(external_kbnSharedDeps_KbnI18n_.i18n.translate("dashboard.panel.unableToMigratePanelDataForSixOneZeroErrorMessage",{defaultMessage:'Unable to migrate panel data for "6.1.0" backwards compatibility, panel does not contain expected col and/or row fields'}));const embeddableConfig=uiState&&uiState["P-"+panel.panelIndex]||{};(panel.columns||panel.sort)&&(embeddableConfig.columns=panel.columns,embeddableConfig.sort=panel.sort);const heightScaleFactor=useMargins?4:5,{columns:columns,sort:sort,row:row,col:col,size_x:sizeX,size_y:sizeY,...rest}=panel,panelIndex=panel.panelIndex?panel.panelIndex.toString():uuid_default.a.v4();return{...rest,version:version,panelIndex:panelIndex,gridData:{x:4*(col-1),y:(row-1)*heightScaleFactor,w:sizeX?4*sizeX:24,h:sizeY?sizeY*heightScaleFactor:15,i:panelIndex},embeddableConfig:embeddableConfig}}(panel,version,useMargins,uiState):function(panel){return satisfies_default()(panel.version,"6.1.x")}(panel)?function(panel,version,useMargins,uiState){["w","x","h","y"].forEach(key=>{if(void 0===panel.gridData[key])throw new Error(external_kbnSharedDeps_KbnI18n_.i18n.translate("dashboard.panel.unableToMigratePanelDataForSixThreeZeroErrorMessage",{defaultMessage:'Unable to migrate panel data for "6.3.0" backwards compatibility, panel does not contain expected field: {key}',values:{key:key}}))});const embeddableConfig=uiState&&uiState["P-"+panel.panelIndex]||{};(panel.columns||panel.sort)&&(embeddableConfig.columns=panel.columns,embeddableConfig.sort=panel.sort);const heightScaleFactor=useMargins?4:5,{columns:columns,sort:sort,...rest}=panel;return{...rest,version:version,panelIndex:panel.panelIndex?panel.panelIndex.toString():uuid_default.a.v4(),gridData:{w:4*panel.gridData.w,h:panel.gridData.h*heightScaleFactor,x:4*panel.gridData.x,y:panel.gridData.y*heightScaleFactor,i:panel.gridData.i},embeddableConfig:embeddableConfig}}(panel,version,useMargins,uiState):function(panel){return satisfies_default()(panel.version,"6.2.x")}(panel)?function(panel,version,useMargins){const embeddableConfig=panel.embeddableConfig||{};(panel.columns||panel.sort)&&(embeddableConfig.columns=panel.columns,embeddableConfig.sort=panel.sort);const heightScaleFactor=useMargins?4:5,{columns:columns,sort:sort,...rest}=panel;return{...rest,version:version,panelIndex:panel.panelIndex?panel.panelIndex.toString():uuid_default.a.v4(),gridData:{w:4*panel.gridData.w,h:panel.gridData.h*heightScaleFactor,x:4*panel.gridData.x,y:panel.gridData.y*heightScaleFactor,i:panel.gridData.i},embeddableConfig:embeddableConfig}}(panel,version,useMargins):function(panel){return satisfies_default()(panel.version,"6.3.x")}(panel)?function(panel,version){const embeddableConfig=panel.embeddableConfig||{};(panel.columns||panel.sort)&&(embeddableConfig.columns=panel.columns,embeddableConfig.sort=panel.sort);const{columns:columns,sort:sort,...rest}=panel;return{...rest,version:version,panelIndex:panel.panelIndex?panel.panelIndex.toString():uuid_default.a.v4(),embeddableConfig:embeddableConfig}}(panel,version):function(panel){return satisfies_default()(panel.version,">6.3")&&satisfies_default()(panel.version,"<7.3")}(panel)?function(panel,version){const panelIndex=panel.panelIndex?panel.panelIndex.toString():uuid_default.a.v4();return{...panel,version:version,panelIndex:panelIndex}}(panel,version):panel)}function migrateAppState(appState,kibanaVersion,usageCollection){if(!appState.panels)throw new Error(external_kbnSharedDeps_KbnI18n_.i18n.translate("dashboard.panel.invalidData",{defaultMessage:"Invalid data in url"}));return appState.panels.some(panel=>{if(void 0===panel.version)return!0;const version=panel.version;return usageCollection&&usageCollection.reportUiCounter("DashboardPanelVersionInUrl",external_kbnSharedDeps_KbnAnalytics_.METRIC_TYPE.LOADED,""+version),satisfies_default()(version,"<7.3")})&&(appState.panels=migratePanelsTo730(appState.panels,kibanaVersion,appState.useMargins,appState.uiState),delete appState.uiState),appState}var url_generator=__webpack_require__(15);function getUrlGeneratorState({data:data,getAppState:getAppState,getDashboardId:getDashboardId,shouldRestoreSearchSession:shouldRestoreSearchSession}){const appState=getAppState();return{dashboardId:getDashboardId(),timeRange:shouldRestoreSearchSession?data.query.timefilter.timefilter.getAbsoluteTime():data.query.timefilter.timefilter.getTime(),filters:data.query.filterManager.getFilters(),query:data.query.queryString.formatQuery(appState.query),savedQuery:appState.savedQuery,useHash:!1,preserveSavedFilters:!1,viewMode:appState.viewMode,panels:getDashboardId()?void 0:appState.panels,searchSessionId:shouldRestoreSearchSession?data.search.session.getSessionId():void 0,refreshInterval:shouldRestoreSearchSession?{pause:!0,value:0}:void 0}}var external_kbnSharedDeps_SaferLodashSet_=__webpack_require__(125),kibana_utils=__webpack_require__(44),dashboard_strings=__webpack_require__(2);class dashboard_panel_storage_DashboardPanelStorage{constructor(toasts,activeSpaceId){var obj,key,value;this.toasts=toasts,this.activeSpaceId=activeSpaceId,value=void 0,(key="sessionStorage")in(obj=this)?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,this.sessionStorage=new kibana_utils.a(sessionStorage)}clearPanels(id="unsavedDashboard"){try{const sessionStorage=this.sessionStorage.get("dashboardStateManagerPanels"),sessionStorageForSpace=(null==sessionStorage?void 0:sessionStorage[this.activeSpaceId])||{};sessionStorageForSpace[id]&&(delete sessionStorageForSpace[id],this.sessionStorage.set("dashboardStateManagerPanels",sessionStorage))}catch(e){this.toasts.addDanger({title:dashboard_strings.x.getPanelsClearError(e.message),"data-test-subj":"dashboardPanelsClearFailure"})}}getPanels(id="unsavedDashboard"){try{var _this$sessionStorage$,_this$sessionStorage$2;return null===(_this$sessionStorage$=this.sessionStorage.get("dashboardStateManagerPanels"))||void 0===_this$sessionStorage$||null===(_this$sessionStorage$2=_this$sessionStorage$[this.activeSpaceId])||void 0===_this$sessionStorage$2?void 0:_this$sessionStorage$2[id]}catch(e){this.toasts.addDanger({title:dashboard_strings.x.getPanelsGetError(e.message),"data-test-subj":"dashboardPanelsGetFailure"})}}setPanels(id="unsavedDashboard",newPanels){try{const sessionStoragePanels=this.sessionStorage.get("dashboardStateManagerPanels")||{};Object(external_kbnSharedDeps_SaferLodashSet_.set)(sessionStoragePanels,[this.activeSpaceId,id],newPanels),this.sessionStorage.set("dashboardStateManagerPanels",sessionStoragePanels)}catch(e){this.toasts.addDanger({title:dashboard_strings.x.getPanelsSetError(e.message),"data-test-subj":"dashboardPanelsSetFailure"})}}getDashboardIdsWithUnsavedChanges(){try{var _this$sessionStorage$3;return Object.keys((null===(_this$sessionStorage$3=this.sessionStorage.get("dashboardStateManagerPanels"))||void 0===_this$sessionStorage$3?void 0:_this$sessionStorage$3[this.activeSpaceId])||{})}catch(e){return this.toasts.addDanger({title:dashboard_strings.x.getPanelsGetError(e.message),"data-test-subj":"dashboardPanelsGetFailure"}),[]}}dashboardHasUnsavedEdits(id="unsavedDashboard"){return-1!==this.getDashboardIdsWithUnsavedChanges().indexOf(id)}}var kibana_react=__webpack_require__(9);const DashboardUnsavedItem=({id:id,title:title,onOpenClick:onOpenClick,onDiscardClick:onDiscardClick})=>external_kbnSharedDeps_React_default.a.createElement("div",{className:"dshUnsavedListingItem"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",gutterSize:"none",className:"dshUnsavedListingItem__heading",responsive:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{color:"text",className:"dshUnsavedListingItem__icon",type:title?"dashboardApp":"clock"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"xxs"},external_kbnSharedDeps_React_default.a.createElement("h4",{className:"dshUnsavedListingItem__title "+(title?"":"dshUnsavedListingItem__loading")},title||dashboard_strings.m.getLoadingTitle())))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"flexStart",gutterSize:"none",className:"dshUnsavedListingItem__actions",responsive:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{flush:"left",size:"s",color:"primary",disabled:!title,onClick:onOpenClick,"data-test-subj":title?"edit-unsaved-"+title.split(" ").join("-"):void 0,"aria-label":dashboard_strings.m.getEditAriaLabel(null!=title?title:id)},dashboard_strings.m.getEditTitle())),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{flush:"left",size:"s",color:"danger",disabled:!title,onClick:onDiscardClick,"data-test-subj":title?"discard-unsaved-"+title.split(" ").join("-"):void 0,"aria-label":dashboard_strings.m.getDiscardAriaLabel(null!=title?title:id)},dashboard_strings.m.getDiscardTitle())))),DashboardUnsavedListing=({redirectTo:redirectTo,unsavedDashboardIds:unsavedDashboardIds,refreshUnsavedDashboards:refreshUnsavedDashboards})=>{const{services:{dashboardPanelStorage:dashboardPanelStorage,savedDashboards:savedDashboards,core:{overlays:overlays}}}=Object(kibana_react.g)(),[items,setItems]=Object(external_kbnSharedDeps_React_.useState)({}),onOpen=Object(external_kbnSharedDeps_React_.useCallback)(id=>{redirectTo({destination:"dashboard",id:id,editMode:!0})},[redirectTo]),onDiscard=Object(external_kbnSharedDeps_React_.useCallback)(id=>{((overlays,discardCallback)=>{overlays.openConfirm(dashboard_strings.n.getDiscardSubtitle(),{confirmButtonText:dashboard_strings.n.getDiscardConfirmButtonText(),cancelButtonText:dashboard_strings.n.getDiscardCancelButtonText(),buttonColor:"danger",defaultFocusedButton:external_kbnSharedDeps_ElasticEui_.EUI_MODAL_CANCEL_BUTTON,title:dashboard_strings.n.getDiscardTitle()}).then(isConfirmed=>{isConfirmed&&discardCallback()})})(overlays,()=>{dashboardPanelStorage.clearPanels(id),refreshUnsavedDashboards()})},[overlays,refreshUnsavedDashboards,dashboardPanelStorage]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{if(0===(null==unsavedDashboardIds?void 0:unsavedDashboardIds.length))return;let canceled=!1;const dashPromises=unsavedDashboardIds.filter(id=>"unsavedDashboard"!==id).map(dashboardId=>savedDashboards.get(dashboardId).catch(()=>dashboardId));return Promise.all(dashPromises).then(dashboards=>{if(canceled)return;let hasError=!1;const newItems=dashboards.reduce((map,dashboard)=>"string"==typeof dashboard?(hasError=!0,dashboardPanelStorage.clearPanels(dashboard),map):{...map,[dashboard.id||"unsavedDashboard"]:dashboard},{});hasError?refreshUnsavedDashboards():setItems(newItems)}),()=>{canceled=!0}},[savedDashboards,dashboardPanelStorage,refreshUnsavedDashboards,unsavedDashboardIds]),0===unsavedDashboardIds.length?null:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{heading:"h3",title:dashboard_strings.m.getUnsavedChangesTitle(unsavedDashboardIds.length>1)},unsavedDashboardIds.map(dashboardId=>{var _items$dashboardId;const title="unsavedDashboard"===dashboardId?Object(dashboard_strings.u)():null===(_items$dashboardId=items[dashboardId])||void 0===_items$dashboardId?void 0:_items$dashboardId.title,redirectId="unsavedDashboard"===dashboardId?void 0:dashboardId;return external_kbnSharedDeps_React_default.a.createElement(DashboardUnsavedItem,{key:dashboardId,id:dashboardId,title:title,onOpenClick:()=>onOpen(redirectId),onDiscardClick:()=>onDiscard(redirectId)})})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}))};var public_=__webpack_require__(6),dashboard_constants=__webpack_require__(7);const getDashboardListItemLink=(application,kbnUrlStateStorage,useHash,id,timeRestore)=>{let url=application.getUrlForApp(dashboard_constants.a.DASHBOARDS_ID,{path:"#"+Object(dashboard_constants.b)(id)});const globalStateInUrl=kbnUrlStateStorage.get(url_generator.c)||{};return timeRestore&&(delete globalStateInUrl.time,delete globalStateInUrl.refreshInterval),url=Object(public_.setStateToKbnUrl)(url_generator.c,globalStateInUrl,{useHash:useHash},url),url};function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const DashboardListing=({title:title,redirectTo:redirectTo,initialFilter:initialFilter,kbnUrlStateStorage:kbnUrlStateStorage})=>{const{services:{core:core,data:data,savedObjects:savedObjects,savedDashboards:savedDashboards,savedObjectsClient:savedObjectsClient,savedObjectsTagging:savedObjectsTagging,dashboardCapabilities:dashboardCapabilities,dashboardPanelStorage:dashboardPanelStorage,chrome:{setBreadcrumbs:setBreadcrumbs}}}=Object(kibana_react.g)(),[unsavedDashboardIds,setUnsavedDashboardIds]=Object(external_kbnSharedDeps_React_.useState)(dashboardPanelStorage.getDashboardIdsWithUnsavedChanges());Object(external_kbnSharedDeps_React_.useEffect)(()=>{setBreadcrumbs([{text:Object(dashboard_strings.q)()}])},[setBreadcrumbs]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{const{stop:stopSyncingQueryServiceStateWithUrl}=Object(services_data.syncQueryStateWithUrl)(data.query,kbnUrlStateStorage);return title&&async function(title,savedObjectsClient){const matchingDashboards=(await savedObjectsClient.find({search:`"${title}"`,searchFields:["title"],type:"dashboard"})).savedObjects.filter(dashboard=>dashboard.attributes.title.toLowerCase()===title.toLowerCase());if(1===matchingDashboards.length)return{id:matchingDashboards[0].id}}(title,savedObjectsClient).then(result=>{result&&redirectTo({destination:"dashboard",id:result.id,useReplace:!0})}),()=>{stopSyncingQueryServiceStateWithUrl()}},[title,savedObjectsClient,redirectTo,data.query,kbnUrlStateStorage]);const hideWriteControls=dashboardCapabilities.hideWriteControls,listingLimit=savedObjects.settings.getListingLimit(),defaultFilter=title?`"${title}"`:"",tableColumns=Object(external_kbnSharedDeps_React_.useMemo)(()=>getTableColumns(core.application,kbnUrlStateStorage,core.uiSettings.get("state:storeInSessionStorage"),savedObjectsTagging),[core.application,core.uiSettings,kbnUrlStateStorage,savedObjectsTagging]),createItem=Object(external_kbnSharedDeps_React_.useCallback)(()=>{dashboardPanelStorage.dashboardHasUnsavedEdits()?((overlays,startBlankCallback,contineCallback)=>{const titleId="confirmDiscardOrKeepTitle",session=overlays.openModal(Object(kibana_react.f)(external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFocusTrap,{clickOutsideDisables:!0,initialFocus:".dashboardCreateConfirmContinueButton"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiOutsideClickDetector,{onOutsideClick:()=>session.close()},external_kbnSharedDeps_React_default.a.createElement("div",{role:"dialog","aria-modal":"true","aria-labelledby":titleId,"aria-describedby":"confirmDiscardOrKeepDescription"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalHeader,{"data-test-subj":"dashboardCreateConfirm"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalHeaderTitle,null,external_kbnSharedDeps_React_default.a.createElement("h2",{id:titleId},dashboard_strings.a.getCreateTitle()))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalBody,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement("p",{id:"confirmDiscardOrKeepDescription"},dashboard_strings.a.getCreateSubtitle()))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalFooter,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{"data-test-subj":"dashboardCreateConfirmCancel",onClick:()=>session.close()},dashboard_strings.a.getCancelButtonText()),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{color:"danger","data-test-subj":"dashboardCreateConfirmStartOver",onClick:()=>{startBlankCallback(),session.close()}},dashboard_strings.a.getStartOverButtonText()),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{fill:!0,"data-test-subj":"dashboardCreateConfirmContinue",className:"dashboardCreateConfirmContinueButton",onClick:()=>{contineCallback(),session.close()}},dashboard_strings.a.getContinueButtonText())))))),{"data-test-subj":"dashboardCreateConfirmModal"})})(core.overlays,()=>{dashboardPanelStorage.clearPanels(),redirectTo({destination:"dashboard"})},()=>redirectTo({destination:"dashboard"})):redirectTo({destination:"dashboard"})},[dashboardPanelStorage,redirectTo,core.overlays]),noItemsFragment=Object(external_kbnSharedDeps_React_.useMemo)(()=>getNoItemsMessage(hideWriteControls,core.application,createItem),[createItem,core.application,hideWriteControls]),fetchItems=Object(external_kbnSharedDeps_React_.useCallback)(filter=>{let references,searchTerm=filter;if(savedObjectsTagging){const parsed=savedObjectsTagging.ui.parseSearchQuery(filter,{useName:!0});searchTerm=parsed.searchTerm,references=parsed.tagReferences}return savedDashboards.find(searchTerm,{size:listingLimit,hasReference:references})},[listingLimit,savedDashboards,savedObjectsTagging]),deleteItems=Object(external_kbnSharedDeps_React_.useCallback)(dashboards=>(dashboards.map(d=>dashboardPanelStorage.clearPanels(d.id)),setUnsavedDashboardIds(dashboardPanelStorage.getDashboardIdsWithUnsavedChanges()),savedDashboards.delete(dashboards.map(d=>d.id))),[savedDashboards,dashboardPanelStorage]),editItem=Object(external_kbnSharedDeps_React_.useCallback)(({id:id})=>redirectTo({destination:"dashboard",id:id,editMode:!0}),[redirectTo]),searchFilters=Object(external_kbnSharedDeps_React_.useMemo)(()=>savedObjectsTagging?[savedObjectsTagging.ui.getSearchBarFilter({useName:!0})]:[],[savedObjectsTagging]),{getEntityName:getEntityName,getTableCaption:getTableCaption,getTableListTitle:getTableListTitle,getEntityNamePlural:getEntityNamePlural}=dashboard_strings.i;return external_kbnSharedDeps_React_default.a.createElement(kibana_react.c,_extends({createItem:hideWriteControls?void 0:createItem,deleteItems:hideWriteControls?void 0:deleteItems,initialPageSize:savedObjects.settings.getPerPage(),editItem:hideWriteControls?void 0:editItem,initialFilter:null!=initialFilter?initialFilter:defaultFilter,toastNotifications:core.notifications.toasts,headingId:"dashboardListingHeading",findItems:fetchItems,rowHeader:"title",entityNamePlural:getEntityNamePlural(),tableListTitle:getTableListTitle(),tableCaption:getTableCaption(),entityName:getEntityName()},{noItemsFragment:noItemsFragment,searchFilters:searchFilters,listingLimit:listingLimit,tableColumns:tableColumns}),external_kbnSharedDeps_React_default.a.createElement(DashboardUnsavedListing,{redirectTo:redirectTo,unsavedDashboardIds:unsavedDashboardIds,refreshUnsavedDashboards:()=>setUnsavedDashboardIds(dashboardPanelStorage.getDashboardIdsWithUnsavedChanges())}))},getTableColumns=(application,kbnUrlStateStorage,useHash,savedObjectsTagging)=>[{field:"title",name:dashboard_strings.i.getTitleColumnName(),sortable:!0,render:(field,record)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{href:getDashboardListItemLink(application,kbnUrlStateStorage,useHash,record.id,record.timeRestore),"data-test-subj":"dashboardListingTitleLink-"+record.title.split(" ").join("-")},field)},{field:"description",name:dashboard_strings.i.getDescriptionColumnName(),render:(field,record)=>external_kbnSharedDeps_React_default.a.createElement("span",null,record.description),sortable:!0},...savedObjectsTagging?[savedObjectsTagging.ui.getTableColumnDefinition()]:[]],getNoItemsMessage=(hideWriteControls,application,createItem)=>hideWriteControls?external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiEmptyPrompt,{iconType:"dashboardApp",title:external_kbnSharedDeps_React_default.a.createElement("h1",{id:"dashboardListingHeading"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"dashboard.listing.noItemsMessage",defaultMessage:"Looks like you don't have any dashboards."}))})):external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiEmptyPrompt,{iconType:"dashboardApp",title:external_kbnSharedDeps_React_default.a.createElement("h1",{id:"dashboardListingHeading"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"dashboard.listing.createNewDashboard.title",defaultMessage:"Create your first dashboard"})),body:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"dashboard.listing.createNewDashboard.combineDataViewFromKibanaAppDescription",defaultMessage:"You can combine data views from any Kibana app into one dashboard and see everything in one place."})),external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"dashboard.listing.createNewDashboard.newToKibanaDescription",defaultMessage:"New to Kibana? {sampleDataInstallLink} to take a test drive.",values:{sampleDataInstallLink:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{onClick:()=>application.navigateToApp("home",{path:"#/tutorial_directory/sampleData"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"dashboard.listing.createNewDashboard.sampleDataInstallLinkText",defaultMessage:"Install some sample data"}))}}))),actions:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{onClick:createItem,fill:!0,iconType:"plusInCircle","data-test-subj":"createDashboardPromptButton"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"dashboard.listing.createNewDashboard.createButtonLabel",defaultMessage:"Create new dashboard"}))}));var external_kbnSharedDeps_Rxjs_=__webpack_require__(47),kibanaReact_public_=__webpack_require__(12),external_kbnSharedDeps_Angular_=__webpack_require__(126),external_kbnSharedDeps_Angular_default=__webpack_require__.n(external_kbnSharedDeps_Angular_),useUnmount=__webpack_require__(144),useUnmount_default=__webpack_require__.n(useUnmount),presentationUtil_public_=__webpack_require__(31),services_embeddable=__webpack_require__(3),saved_objects=__webpack_require__(25);const TopNavIds_SHARE="share",TopNavIds_OPTIONS="options",TopNavIds_QUICK_SAVE="quickSave",TopNavIds_SAVE="save",TopNavIds_EXIT_EDIT_MODE="exitEditMode",TopNavIds_ENTER_EDIT_MODE="enterEditMode",TopNavIds_CLONE="clone",TopNavIds_FULL_SCREEN="fullScreenMode";function getTopNavConfig(dashboardMode,actions,options){switch(dashboardMode){case services_embeddable.ViewMode.VIEW:return options.hideWriteControls?[getFullScreenConfig(actions[TopNavIds_FULL_SCREEN]),getShareConfig(actions[TopNavIds_SHARE])]:[getFullScreenConfig(actions[TopNavIds_FULL_SCREEN]),getShareConfig(actions[TopNavIds_SHARE]),(action=actions[TopNavIds_CLONE],{id:"clone",label:external_kbnSharedDeps_KbnI18n_.i18n.translate("dashboard.topNave.cloneButtonAriaLabel",{defaultMessage:"clone"}),description:external_kbnSharedDeps_KbnI18n_.i18n.translate("dashboard.topNave.cloneConfigDescription",{defaultMessage:"Create a copy of your dashboard"}),testId:"dashboardClone",run:action}),getEditConfig(actions[TopNavIds_ENTER_EDIT_MODE])];case services_embeddable.ViewMode.EDIT:const disableButton=options.isSaveInProgress,navItems=[getOptionsConfig(actions[TopNavIds_OPTIONS],disableButton),getShareConfig(actions[TopNavIds_SHARE],disableButton)];return options.isNewDashboard?(navItems.push(getViewConfig(actions[TopNavIds_EXIT_EDIT_MODE],!0)),navItems.push(getSaveConfig(actions[TopNavIds_SAVE],options.isNewDashboard,disableButton))):(navItems.push(getSaveConfig(actions[TopNavIds_SAVE],options.isNewDashboard,disableButton)),navItems.push(getViewConfig(actions[TopNavIds_EXIT_EDIT_MODE],disableButton)),navItems.push(function(action,isLoading,isDirty){return{isLoading:isLoading,disableButton:!isDirty,id:"quick-save",iconType:"save",emphasize:!0,label:getSaveButtonLabel(),description:external_kbnSharedDeps_KbnI18n_.i18n.translate("dashboard.topNave.saveConfigDescription",{defaultMessage:"Quick save your dashboard without any prompts"}),testId:"dashboardQuickSaveMenuItem",run:action}}(actions[TopNavIds_QUICK_SAVE],disableButton,options.isDirty))),navItems;default:return[]}var action}function getSaveButtonLabel(){return external_kbnSharedDeps_KbnI18n_.i18n.translate("dashboard.topNave.saveButtonAriaLabel",{defaultMessage:"save"})}function getFullScreenConfig(action){return{id:"full-screen",label:external_kbnSharedDeps_KbnI18n_.i18n.translate("dashboard.topNave.fullScreenButtonAriaLabel",{defaultMessage:"full screen"}),description:external_kbnSharedDeps_KbnI18n_.i18n.translate("dashboard.topNave.fullScreenConfigDescription",{defaultMessage:"Full Screen Mode"}),testId:"dashboardFullScreenMode",run:action}}function getEditConfig(action){return{emphasize:!0,id:"edit",iconType:"pencil",label:external_kbnSharedDeps_KbnI18n_.i18n.translate("dashboard.topNave.editButtonAriaLabel",{defaultMessage:"edit"}),description:external_kbnSharedDeps_KbnI18n_.i18n.translate("dashboard.topNave.editConfigDescription",{defaultMessage:"Switch to edit mode"}),testId:"dashboardEditMode",className:"eui-hideFor--s eui-hideFor--xs",run:action}}function getSaveConfig(action,isNewDashboard=!1,disableButton){return{disableButton:disableButton,id:"save",label:isNewDashboard?getSaveButtonLabel():external_kbnSharedDeps_KbnI18n_.i18n.translate("dashboard.topNave.saveAsButtonAriaLabel",{defaultMessage:"save as"}),iconType:isNewDashboard?"save":void 0,description:external_kbnSharedDeps_KbnI18n_.i18n.translate("dashboard.topNave.saveAsConfigDescription",{defaultMessage:"Save as a new dashboard"}),testId:"dashboardSaveMenuItem",run:action,emphasize:isNewDashboard}}function getViewConfig(action,disableButton){return{disableButton:disableButton,id:"cancel",label:external_kbnSharedDeps_KbnI18n_.i18n.translate("dashboard.topNave.cancelButtonAriaLabel",{defaultMessage:"Switch to view mode"}),description:external_kbnSharedDeps_KbnI18n_.i18n.translate("dashboard.topNave.viewConfigDescription",{defaultMessage:"Switch to view-only mode"}),testId:"dashboardViewOnlyMode",run:action}}function getShareConfig(action,disableButton){return{id:"share",label:external_kbnSharedDeps_KbnI18n_.i18n.translate("dashboard.topNave.shareButtonAriaLabel",{defaultMessage:"share"}),description:external_kbnSharedDeps_KbnI18n_.i18n.translate("dashboard.topNave.shareConfigDescription",{defaultMessage:"Share Dashboard"}),testId:"shareTopNavButton",run:null!=action?action:()=>{},disableButton:!action||disableButton}}function getOptionsConfig(action,disableButton){return{disableButton:disableButton,id:"options",label:external_kbnSharedDeps_KbnI18n_.i18n.translate("dashboard.topNave.optionsButtonAriaLabel",{defaultMessage:"options"}),description:external_kbnSharedDeps_KbnI18n_.i18n.translate("dashboard.topNave.optionsConfigDescription",{defaultMessage:"Options"}),testId:"dashboardOptionsButton",run:action}}function save_modal_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class save_modal_DashboardSaveModal extends external_kbnSharedDeps_React_default.a.Component{constructor(props){var _this$props$tags;super(props),save_modal_defineProperty(this,"state",{description:this.props.description,timeRestore:this.props.timeRestore,tags:null!==(_this$props$tags=this.props.tags)&&void 0!==_this$props$tags?_this$props$tags:[]}),save_modal_defineProperty(this,"saveDashboard",({newTitle:newTitle,newCopyOnSave:newCopyOnSave,isTitleDuplicateConfirmed:isTitleDuplicateConfirmed,onTitleDuplicate:onTitleDuplicate})=>{this.props.onSave({newTitle:newTitle,newDescription:this.state.description,newCopyOnSave:newCopyOnSave,newTimeRestore:this.state.timeRestore,isTitleDuplicateConfirmed:isTitleDuplicateConfirmed,onTitleDuplicate:onTitleDuplicate,newTags:this.state.tags})}),save_modal_defineProperty(this,"onDescriptionChange",event=>{this.setState({description:event.target.value})}),save_modal_defineProperty(this,"onTimeRestoreChange",event=>{this.setState({timeRestore:event.target.checked})})}renderDashboardSaveOptions(){const{savedObjectsTagging:savedObjectsTagging}=this.props,tagSelector=savedObjectsTagging?external_kbnSharedDeps_React_default.a.createElement(savedObjectsTagging.ui.components.SavedObjectSaveModalTagSelector,{initialSelection:this.state.tags,onTagsSelected:tags=>{this.setState({tags:tags})}}):void 0;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"dashboard.topNav.saveModal.descriptionFormRowLabel",defaultMessage:"Description"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTextArea,{"data-test-subj":"dashboardDescription",value:this.state.description,onChange:this.onDescriptionChange})),tagSelector,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{helpText:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"dashboard.topNav.saveModal.storeTimeWithDashboardFormRowHelpText",defaultMessage:"This changes the time filter to the currently selected time each time this dashboard is loaded."})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSwitch,{"data-test-subj":"storeTimeWithDashboard",checked:this.state.timeRestore,onChange:this.onTimeRestoreChange,label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"dashboard.topNav.saveModal.storeTimeWithDashboardFormRowLabel",defaultMessage:"Store time with dashboard"})})))}render(){return external_kbnSharedDeps_React_default.a.createElement(saved_objects.b,{onSave:this.saveDashboard,onClose:this.props.onClose,title:this.props.title,showCopyOnSave:this.props.showCopyOnSave,initialCopyOnSave:this.props.showCopyOnSave,objectType:"dashboard",options:this.renderDashboardSaveOptions(),showDescription:!1})}}function clone_modal_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class clone_modal_DashboardCloneModal extends external_kbnSharedDeps_React_default.a.Component{constructor(props){super(props),clone_modal_defineProperty(this,"isMounted",!1),clone_modal_defineProperty(this,"onTitleDuplicate",()=>{this.setState({isTitleDuplicateConfirmed:!0,hasTitleDuplicate:!0})}),clone_modal_defineProperty(this,"cloneDashboard",async()=>{this.setState({isLoading:!0}),await this.props.onClone(this.state.newDashboardName,this.state.isTitleDuplicateConfirmed,this.onTitleDuplicate),this.isMounted&&this.setState({isLoading:!1})}),clone_modal_defineProperty(this,"onInputChange",event=>{this.setState({newDashboardName:event.target.value,isTitleDuplicateConfirmed:!1,hasTitleDuplicate:!1})}),clone_modal_defineProperty(this,"renderDuplicateTitleCallout",()=>{if(this.state.hasTitleDuplicate)return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{size:"s",title:external_kbnSharedDeps_KbnI18n_.i18n.translate("dashboard.topNav.cloneModal.dashboardExistsTitle",{defaultMessage:"A dashboard with the title {newDashboardName} already exists.",values:{newDashboardName:`'${this.state.newDashboardName}'`}}),color:"warning","data-test-subj":"titleDupicateWarnMsg"},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"dashboard.topNav.cloneModal.dashboardExistsDescription",defaultMessage:"Click {confirmClone} to clone the dashboard with the duplicate title.",values:{confirmClone:external_kbnSharedDeps_React_default.a.createElement("strong",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"dashboard.topNav.cloneModal.confirmCloneDescription",defaultMessage:"Confirm Clone"}))}}))))}),this.state={newDashboardName:props.title,isTitleDuplicateConfirmed:!1,hasTitleDuplicate:!1,isLoading:!1}}componentDidMount(){this.isMounted=!0}componentWillUnmount(){this.isMounted=!1}render(){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModal,{"data-test-subj":"dashboardCloneModal",className:"dshCloneModal",onClose:this.props.onClose},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalHeader,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalHeaderTitle,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"dashboard.topNav.cloneModal.cloneDashboardModalHeaderTitle",defaultMessage:"Clone dashboard"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalBody,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"dashboard.topNav.cloneModal.enterNewNameForDashboardDescription",defaultMessage:"Please enter a new name for your dashboard."}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldText,{autoFocus:!0,"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("dashboard.cloneModal.cloneDashboardTitleAriaLabel",{defaultMessage:"Cloned Dashboard Title"}),"data-test-subj":"clonedDashboardTitle",value:this.state.newDashboardName,onChange:this.onInputChange,isInvalid:this.state.hasTitleDuplicate}),this.renderDuplicateTitleCallout()),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalFooter,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{"data-test-subj":"cloneCancelButton",onClick:this.props.onClose},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"dashboard.topNav.cloneModal.cancelButtonLabel",defaultMessage:"Cancel"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{fill:!0,"data-test-subj":"cloneConfirmButton",onClick:this.cloneDashboard,isLoading:this.state.isLoading},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"dashboard.topNav.cloneModal.confirmButtonLabel",defaultMessage:"Confirm Clone"}))))}}function options_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class options_OptionsMenu extends external_kbnSharedDeps_React_.Component{constructor(props){super(props),options_defineProperty(this,"state",{useMargins:this.props.useMargins,hidePanelTitles:this.props.hidePanelTitles,syncColors:this.props.syncColors}),options_defineProperty(this,"handleUseMarginsChange",evt=>{const isChecked=evt.target.checked;this.props.onUseMarginsChange(isChecked),this.setState({useMargins:isChecked})}),options_defineProperty(this,"handleHidePanelTitlesChange",evt=>{const isChecked=!evt.target.checked;this.props.onHidePanelTitlesChange(isChecked),this.setState({hidePanelTitles:isChecked})}),options_defineProperty(this,"handleSyncColorsChange",evt=>{const isChecked=evt.target.checked;this.props.onSyncColorsChange(isChecked),this.setState({syncColors:isChecked})})}render(){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiForm,{"data-test-subj":"dashboardOptionsMenu"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSwitch,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("dashboard.topNav.options.useMarginsBetweenPanelsSwitchLabel",{defaultMessage:"Use margins between panels"}),checked:this.state.useMargins,onChange:this.handleUseMarginsChange,"data-test-subj":"dashboardMarginsCheckbox"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSwitch,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("dashboard.topNav.options.hideAllPanelTitlesSwitchLabel",{defaultMessage:"Show panel titles"}),checked:!this.state.hidePanelTitles,onChange:this.handleHidePanelTitlesChange,"data-test-subj":"dashboardPanelTitlesCheckbox"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSwitch,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("dashboard.topNav.options.syncColorsBetweenPanelsSwitchLabel",{defaultMessage:"Sync color palettes across panels"}),checked:this.state.syncColors,onChange:this.handleSyncColorsChange,"data-test-subj":"dashboardSyncColorsCheckbox"})))}}let isOpen=!1;const show_options_popover_container=document.createElement("div"),onClose=()=>{external_kbnSharedDeps_ReactDom_default.a.unmountComponentAtNode(show_options_popover_container),isOpen=!1};const showPublicUrlSwitch=anonymousUserCapabilities=>{if(!anonymousUserCapabilities.dashboard)return!1;return!!anonymousUserCapabilities.dashboard.show};var visualizations_public_=__webpack_require__(127);const EditorMenu=({dashboardContainer:dashboardContainer,createNewVisType:createNewVisType})=>{const{core:core,embeddable:embeddable,visualizations:visualizations,usageCollection:usageCollection,uiSettings:uiSettings}=Object(kibana_react.g)().services,IS_DARK_THEME=uiSettings.get("theme:darkMode"),trackUiMetric=null==usageCollection?void 0:usageCollection.reportUiCounter.bind(usageCollection,dashboard_constants.a.DASHBOARDS_ID),createNewAggsBasedVis=Object(external_kbnSharedDeps_React_.useCallback)(visType=>()=>visualizations.showNewVisModal({originatingApp:dashboard_constants.a.DASHBOARDS_ID,outsideVisualizeApp:!0,showAggsSelection:!0,selectedVisType:visType}),[visualizations]),getVisTypesByGroup=group=>visualizations.getByGroup(group).sort(({name:a},{name:b})=>a<b?-1:a>b?1:0).filter(({hidden:hidden})=>!hidden),promotedVisTypes=getVisTypesByGroup(visualizations_public_.VisGroups.PROMOTED),aggsBasedVisTypes=getVisTypesByGroup(visualizations_public_.VisGroups.AGGBASED),toolVisTypes=getVisTypesByGroup(visualizations_public_.VisGroups.TOOLS),visTypeAliases=visualizations.getAliases().sort(({promotion:a=!1},{promotion:b=!1})=>a===b?0:a?-1:1),factories=embeddable?Array.from(embeddable.getEmbeddableFactories()).filter(({type:type,isEditable:isEditable,canCreateNew:canCreateNew,isContainerType:isContainerType})=>isEditable()&&!isContainerType&&canCreateNew()&&"visualization"!==type):[],factoryGroupMap={},ungroupedFactories=[];let panelCount=2;factories.forEach((factory,index)=>{const{grouping:grouping}=factory;grouping?grouping.forEach(group=>{factoryGroupMap[group.id]?factoryGroupMap[group.id].factories.push(factory):(factoryGroupMap[group.id]={id:group.id,appName:group.getDisplayName?group.getDisplayName({embeddable:embeddable}):group.id,icon:group.getIconType?group.getIconType({embeddable:embeddable}):"empty",factories:[factory],panelId:panelCount},panelCount++)}):ungroupedFactories.push(factory)});const getVisTypeMenuItem=visType=>{const{name:name,title:title,titleInWizard:titleInWizard,description:description,icon:icon="empty",group:group}=visType;return{name:titleInWizard||title,icon:icon,onClick:group===visualizations_public_.VisGroups.AGGBASED?createNewAggsBasedVis(visType):createNewVisType(visType),"data-test-subj":"visType-"+name,toolTipContent:description}},getEmbeddableFactoryMenuItem=factory=>{const icon=null!=factory&&factory.getIconType?factory.getIconType():"empty",toolTipContent=null!=factory&&factory.getDescription?factory.getDescription():void 0;return{name:factory.getDisplayName(),icon:icon,toolTipContent:toolTipContent,onClick:async()=>{let newEmbeddable;if(trackUiMetric&&trackUiMetric(external_kbnSharedDeps_KbnAnalytics_.METRIC_TYPE.CLICK,factory.type),factory.getExplicitInput){const explicitInput=await factory.getExplicitInput();newEmbeddable=await dashboardContainer.addNewEmbeddable(factory.type,explicitInput)}else newEmbeddable=await factory.create({},dashboardContainer);newEmbeddable&&core.notifications.toasts.addSuccess({title:dashboard_strings.k.getSuccessMessage(`'${newEmbeddable.getInput().title}'`||""),"data-test-subj":"addEmbeddableToDashboardSuccess"})},"data-test-subj":"createNew-"+factory.type}},aggsPanelTitle=external_kbnSharedDeps_KbnI18n_.i18n.translate("dashboard.editorMenu.aggBasedGroupTitle",{defaultMessage:"Aggregation based"}),editorMenuPanels=[{id:0,items:[...visTypeAliases.map(visTypeAlias=>{const{name:name,title:title,description:description,icon:icon="empty"}=visTypeAlias;return{name:title,icon:icon,onClick:createNewVisType(visTypeAlias),"data-test-subj":"visType-"+name,toolTipContent:description}}),...Object.values(factoryGroupMap).map(({id:id,appName:appName,icon:icon,panelId:panelId})=>({name:appName,icon:icon,panel:panelId,"data-test-subj":`dashboardEditorMenu-${id}Group`})),...ungroupedFactories.map(getEmbeddableFactoryMenuItem),...promotedVisTypes.map(getVisTypeMenuItem),{name:aggsPanelTitle,icon:"visualizeApp",panel:1,"data-test-subj":"dashboardEditorAggBasedMenuItem"},...toolVisTypes.map(getVisTypeMenuItem)]},{id:1,title:aggsPanelTitle,items:aggsBasedVisTypes.map(getVisTypeMenuItem)},...Object.values(factoryGroupMap).map(({appName:appName,panelId:panelId,factories:groupFactories})=>({id:panelId,title:appName,items:groupFactories.map(getEmbeddableFactoryMenuItem)}))];return external_kbnSharedDeps_React_default.a.createElement(presentationUtil_public_.SolutionToolbarPopover,{ownFocus:!0,label:external_kbnSharedDeps_KbnI18n_.i18n.translate("dashboard.solutionToolbar.editorMenuButtonLabel",{defaultMessage:"All types"}),iconType:"arrowDown",iconSide:"right",panelPaddingSize:"none","data-test-subj":"dashboardEditorMenuButton"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenu,{initialPanelId:0,panels:editorMenuPanels,className:"dshSolutionToolbar__editorContextMenu "+(IS_DARK_THEME?"dshSolutionToolbar__editorContextMenu--dark":"dshSolutionToolbar__editorContextMenu--light"),"data-test-subj":"dashboardEditorContextMenu"}))};function DashboardTopNav({dashboardStateManager:dashboardStateManager,clearUnsavedChanges:clearUnsavedChanges,dashboardContainer:dashboardContainer,lastDashboardId:lastDashboardId,unsavedChanges:unsavedChanges,savedDashboard:savedDashboard,onQuerySubmit:onQuerySubmit,embedSettings:embedSettings,indexPatterns:indexPatterns,redirectTo:redirectTo,timefilter:timefilter,viewMode:viewMode}){const{core:core,data:data,share:share,chrome:chrome,embeddable:embeddable,navigation:navigation,uiSettings:uiSettings,setHeaderActionMenu:setHeaderActionMenu,savedObjectsTagging:savedObjectsTagging,dashboardCapabilities:dashboardCapabilities,dashboardPanelStorage:dashboardPanelStorage,allowByValueEmbeddables:allowByValueEmbeddables,visualizations:visualizations,usageCollection:usageCollection}=Object(kibana_react.g)().services,[state,setState]=Object(external_kbnSharedDeps_React_.useState)({chromeIsVisible:!1}),[isSaveInProgress,setIsSaveInProgress]=Object(external_kbnSharedDeps_React_.useState)(!1),lensAlias=visualizations.getAliases().find(({name:name})=>"lens"===name),stateTransferService=embeddable.getStateTransfer(),IS_DARK_THEME=uiSettings.get("theme:darkMode"),trackUiMetric=null==usageCollection?void 0:usageCollection.reportUiCounter.bind(usageCollection,dashboard_constants.a.DASHBOARDS_ID);Object(external_kbnSharedDeps_React_.useEffect)(()=>{const visibleSubscription=chrome.getIsVisible$().subscribe(chromeIsVisible=>{setState(s=>({...s,chromeIsVisible:chromeIsVisible}))}),{id:id,title:title,getFullEditPath:getFullEditPath}=savedDashboard;return(id||allowByValueEmbeddables)&&chrome.recentlyAccessed.add(getFullEditPath(dashboardStateManager.getIsEditMode()),title||Object(dashboard_strings.u)(),id||"unsavedDashboard"),()=>{visibleSubscription.unsubscribe()}},[chrome,allowByValueEmbeddables,dashboardStateManager,savedDashboard]);const addFromLibrary=Object(external_kbnSharedDeps_React_.useCallback)(()=>{Object(services_embeddable.isErrorEmbeddable)(dashboardContainer)||setState(s=>({...s,addPanelOverlay:Object(services_embeddable.openAddPanelFlyout)({embeddable:dashboardContainer,getAllFactories:embeddable.getEmbeddableFactories,getFactory:embeddable.getEmbeddableFactory,notifications:core.notifications,overlays:core.overlays,SavedObjectFinder:Object(saved_objects.c)(core.savedObjects,uiSettings)})}))},[embeddable.getEmbeddableFactories,embeddable.getEmbeddableFactory,dashboardContainer,core.notifications,core.savedObjects,core.overlays,uiSettings]),createNewVisType=Object(external_kbnSharedDeps_React_.useCallback)(visType=>()=>{let path="",appId="";visType?(trackUiMetric&&trackUiMetric(external_kbnSharedDeps_KbnAnalytics_.METRIC_TYPE.CLICK,visType.name),"aliasPath"in visType?(appId=visType.aliasApp,path=visType.aliasPath):(appId="visualize",path="#/create?type="+encodeURIComponent(visType.name))):(appId="visualize",path="#/create?"),stateTransferService.navigateToEditor(appId,{path:path,state:{originatingApp:dashboard_constants.a.DASHBOARDS_ID}})},[trackUiMetric,stateTransferService]),clearAddPanel=Object(external_kbnSharedDeps_React_.useCallback)(()=>{state.addPanelOverlay&&(state.addPanelOverlay.close(),setState(s=>({...s,addPanelOverlay:void 0})))},[state.addPanelOverlay]),onChangeViewMode=Object(external_kbnSharedDeps_React_.useCallback)(newMode=>{clearAddPanel();function switchViewMode(){if(dashboardStateManager.switchViewMode(newMode),null!=savedDashboard&&savedDashboard.id&&allowByValueEmbeddables){const{getFullEditPath:getFullEditPath,title:title,id:id}=savedDashboard;chrome.recentlyAccessed.add(getFullEditPath(newMode===services_embeddable.ViewMode.EDIT),title,id)}}newMode===dashboardStateManager.getViewMode()||newMode!==services_embeddable.ViewMode.VIEW||!dashboardStateManager.getIsDirty(timefilter)?switchViewMode():(overlays=>{const titleId="confirmDiscardOrKeepTitle";return new Promise(resolve=>{const session=overlays.openModal(Object(kibana_react.f)(external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFocusTrap,{clickOutsideDisables:!0,initialFocus:".discardConfirmKeepButton"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiOutsideClickDetector,{onOutsideClick:()=>session.close()},external_kbnSharedDeps_React_default.a.createElement("div",{role:"dialog","aria-modal":"true","aria-labelledby":titleId,"aria-describedby":"confirmDiscardOrKeepDescription"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalHeader,{"data-test-subj":"dashboardDiscardConfirm"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalHeaderTitle,null,external_kbnSharedDeps_React_default.a.createElement("h2",{id:titleId},dashboard_strings.w.getLeaveEditModeTitle()))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalBody,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement("p",{id:"confirmDiscardOrKeepDescription"},dashboard_strings.w.getLeaveEditModeSubtitle()))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalFooter,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{"data-test-subj":"dashboardDiscardConfirmCancel",onClick:()=>session.close()},dashboard_strings.w.getLeaveEditModeCancelButtonText()),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{color:"danger","data-test-subj":"dashboardDiscardConfirmDiscard",onClick:()=>{session.close(),resolve("discard")}},dashboard_strings.w.getLeaveEditModeDiscardButtonText()),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{fill:!0,"data-test-subj":"dashboardDiscardConfirmKeep",className:"discardConfirmKeepButton",onClick:()=>{session.close(),resolve("keep")}},dashboard_strings.w.getLeaveEditModeKeepChangesText())))))),{"data-test-subj":"dashboardDiscardConfirmModal",maxWidth:550})})})(core.overlays).then(selection=>{"discard"===selection&&(dashboardStateManager.resetState(),dashboardStateManager.clearUnsavedPanels(),dashboardStateManager.getIsTimeSavedWithDashboard()&&(dashboardStateManager.syncTimefilterWithDashboardTime(timefilter),dashboardStateManager.syncTimefilterWithDashboardRefreshInterval(timefilter)),dashboardStateManager.switchViewMode(services_embeddable.ViewMode.VIEW)),"cancel"!==selection&&switchViewMode()})},[timefilter,core.overlays,clearAddPanel,savedDashboard,dashboardStateManager,allowByValueEmbeddables,chrome.recentlyAccessed]),save=Object(external_kbnSharedDeps_React_.useCallback)(async saveOptions=>(setIsSaveInProgress(!0),saveDashboard(external_kbnSharedDeps_Angular_default.a.toJson,timefilter,dashboardStateManager,saveOptions).then((function(id){return id&&(core.notifications.toasts.addSuccess({title:external_kbnSharedDeps_KbnI18n_.i18n.translate("dashboard.dashboardWasSavedSuccessMessage",{defaultMessage:"Dashboard '{dashTitle}' was saved",values:{dashTitle:dashboardStateManager.savedDashboard.title}}),"data-test-subj":"saveDashboardSuccess"}),dashboardPanelStorage.clearPanels(lastDashboardId),id!==lastDashboardId?redirectTo({id:id,destination:"dashboard",useReplace:!0}):(dashboardStateManager.resetState(),chrome.docTitle.change(dashboardStateManager.savedDashboard.lastSavedTitle))),setIsSaveInProgress(!1),{id:id}})).catch(error=>{var _core$notifications;return null===(_core$notifications=core.notifications)||void 0===_core$notifications||_core$notifications.toasts.addDanger({title:external_kbnSharedDeps_KbnI18n_.i18n.translate("dashboard.dashboardWasNotSavedDangerMessage",{defaultMessage:"Dashboard '{dashTitle}' was not saved. Error: {errorMessage}",values:{dashTitle:dashboardStateManager.savedDashboard.title,errorMessage:error.message}}),"data-test-subj":"saveDashboardFailure"}),{error:error}})),[core.notifications.toasts,dashboardStateManager,dashboardPanelStorage,lastDashboardId,chrome.docTitle,redirectTo,timefilter]),runSave=Object(external_kbnSharedDeps_React_.useCallback)(async()=>{const currentTitle=dashboardStateManager.getTitle(),currentDescription=dashboardStateManager.getDescription(),currentTimeRestore=dashboardStateManager.getTimeRestore();let currentTags=[];if(savedObjectsTagging){const dashboard=dashboardStateManager.savedDashboard;savedObjectsTagging.ui.hasTagDecoration(dashboard)&&(currentTags=dashboard.getTags())}const dashboardSaveModal=external_kbnSharedDeps_React_default.a.createElement(save_modal_DashboardSaveModal,{onSave:({newTitle:newTitle,newDescription:newDescription,newCopyOnSave:newCopyOnSave,newTimeRestore:newTimeRestore,onTitleDuplicate:onTitleDuplicate,isTitleDuplicateConfirmed:isTitleDuplicateConfirmed,newTags:newTags})=>{dashboardStateManager.setTitle(newTitle),dashboardStateManager.setDescription(newDescription),dashboardStateManager.savedDashboard.copyOnSave=newCopyOnSave,dashboardStateManager.setTimeRestore(newTimeRestore),savedObjectsTagging&&newTags&&dashboardStateManager.setTags(newTags);return save({confirmOverwrite:!1,isTitleDuplicateConfirmed:isTitleDuplicateConfirmed,onTitleDuplicate:onTitleDuplicate}).then(response=>(response.id||(dashboardStateManager.setTitle(currentTitle),dashboardStateManager.setDescription(currentDescription),dashboardStateManager.setTimeRestore(currentTimeRestore),savedObjectsTagging&&dashboardStateManager.setTags(currentTags)),response))},onClose:()=>{},title:currentTitle,description:currentDescription,tags:currentTags,savedObjectsTagging:savedObjectsTagging,timeRestore:currentTimeRestore,showCopyOnSave:!!lastDashboardId});clearAddPanel(),Object(saved_objects.d)(dashboardSaveModal,core.i18n.Context)},[save,clearAddPanel,lastDashboardId,core.i18n.Context,savedObjectsTagging,dashboardStateManager]),runQuickSave=Object(external_kbnSharedDeps_React_.useCallback)(async()=>{const currentTitle=dashboardStateManager.getTitle(),currentDescription=dashboardStateManager.getDescription(),currentTimeRestore=dashboardStateManager.getTimeRestore();let currentTags=[];if(savedObjectsTagging){const dashboard=dashboardStateManager.savedDashboard;savedObjectsTagging.ui.hasTagDecoration(dashboard)&&(currentTags=dashboard.getTags())}setIsSaveInProgress(!0),save({}).then(response=>(response.id?clearUnsavedChanges():(dashboardStateManager.setTitle(currentTitle),dashboardStateManager.setDescription(currentDescription),dashboardStateManager.setTimeRestore(currentTimeRestore),savedObjectsTagging&&dashboardStateManager.setTags(currentTags)),setIsSaveInProgress(!1),response))},[save,savedObjectsTagging,dashboardStateManager,clearUnsavedChanges]),runClone=Object(external_kbnSharedDeps_React_.useCallback)(()=>{const currentTitle=dashboardStateManager.getTitle();!function(onClone,title){const container=document.createElement("div"),closeModal=()=>{external_kbnSharedDeps_ReactDom_default.a.unmountComponentAtNode(container),document.body.removeChild(container)};document.body.appendChild(container);const element=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.I18nProvider,null,external_kbnSharedDeps_React_default.a.createElement(clone_modal_DashboardCloneModal,{onClone:async(newTitle,isTitleDuplicateConfirmed,onTitleDuplicate)=>{onClone(newTitle,isTitleDuplicateConfirmed,onTitleDuplicate).then(response=>{(response.error||response.id)&&closeModal()})},onClose:closeModal,title:external_kbnSharedDeps_KbnI18n_.i18n.translate("dashboard.topNav.showCloneModal.dashboardCopyTitle",{defaultMessage:"{title} Copy",values:{title:title}})}));external_kbnSharedDeps_ReactDom_default.a.render(element,container)}(async(newTitle,isTitleDuplicateConfirmed,onTitleDuplicate)=>{dashboardStateManager.savedDashboard.copyOnSave=!0,dashboardStateManager.setTitle(newTitle);return save({confirmOverwrite:!1,isTitleDuplicateConfirmed:isTitleDuplicateConfirmed,onTitleDuplicate:onTitleDuplicate}).then(response=>(response.error&&dashboardStateManager.setTitle(currentTitle),response))},currentTitle)},[dashboardStateManager,save]),dashboardTopNavActions=Object(external_kbnSharedDeps_React_.useMemo)(()=>{const actions={[TopNavIds_FULL_SCREEN]:()=>{dashboardStateManager.setFullScreenMode(!0)},[TopNavIds_EXIT_EDIT_MODE]:()=>onChangeViewMode(services_embeddable.ViewMode.VIEW),[TopNavIds_ENTER_EDIT_MODE]:()=>onChangeViewMode(services_embeddable.ViewMode.EDIT),[TopNavIds_SAVE]:runSave,[TopNavIds_QUICK_SAVE]:runQuickSave,[TopNavIds_CLONE]:runClone,[TopNavIds_OPTIONS]:anchorElement=>{!function({anchorElement:anchorElement,useMargins:useMargins,onUseMarginsChange:onUseMarginsChange,hidePanelTitles:hidePanelTitles,onHidePanelTitlesChange:onHidePanelTitlesChange,syncColors:syncColors,onSyncColorsChange:onSyncColorsChange}){if(isOpen)return void onClose();isOpen=!0,document.body.appendChild(show_options_popover_container);const element=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.I18nProvider,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiWrappingPopover,{id:"popover",button:anchorElement,isOpen:!0,closePopover:onClose},external_kbnSharedDeps_React_default.a.createElement(options_OptionsMenu,{useMargins:useMargins,onUseMarginsChange:onUseMarginsChange,hidePanelTitles:hidePanelTitles,onHidePanelTitlesChange:onHidePanelTitlesChange,syncColors:syncColors,onSyncColorsChange:onSyncColorsChange})));external_kbnSharedDeps_ReactDom_default.a.render(element,show_options_popover_container)}({anchorElement:anchorElement,useMargins:dashboardStateManager.getUseMargins(),onUseMarginsChange:isChecked=>{dashboardStateManager.setUseMargins(isChecked)},syncColors:dashboardStateManager.getSyncColors(),onSyncColorsChange:isChecked=>{dashboardStateManager.setSyncColors(isChecked)},hidePanelTitles:dashboardStateManager.getHidePanelTitles(),onHidePanelTitlesChange:isChecked=>{dashboardStateManager.setHidePanelTitles(isChecked)}})}};return share&&(actions[TopNavIds_SHARE]=anchorElement=>function({share:share,anchorElement:anchorElement,savedDashboard:savedDashboard,dashboardCapabilities:dashboardCapabilities,dashboardStateManager:dashboardStateManager}){share.toggleShareContextMenu({anchorElement:anchorElement,allowEmbed:!0,allowShortUrl:dashboardCapabilities.createShortUrl,shareableUrl:Object(kibana_utils.f)("_a",dashboardStateManager.getAppState(),{useHash:!1,storeInHashQuery:!0},Object(kibana_utils.h)(window.location.href)),objectId:savedDashboard.id,objectType:"dashboard",sharingData:{title:savedDashboard.title},isDirty:dashboardStateManager.getIsDirty(),embedUrlParamExtensions:[{paramName:"embed",component:({setParamValue:setParamValue})=>{const[urlParamsSelectedMap,seturlParamsSelectedMap]=Object(external_kbnSharedDeps_React_.useState)({showFilterBar:!0}),checkboxes=[{id:dashboardUrlParams.showTopMenu,label:dashboard_strings.y.getTopMenuCheckbox()},{id:dashboardUrlParams.showQueryInput,label:dashboard_strings.y.getQueryCheckbox()},{id:dashboardUrlParams.showTimeFilter,label:dashboard_strings.y.getTimeFilterCheckbox()},{id:"showFilterBar",label:dashboard_strings.y.getFilterBarCheckbox()}];return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCheckboxGroup,{options:checkboxes,idToSelectedMap:urlParamsSelectedMap,onChange:param=>{const newSelectedMap={...urlParamsSelectedMap,[param]:!urlParamsSelectedMap[param]},urlParamValues={[dashboardUrlParams.showTopMenu]:newSelectedMap[dashboardUrlParams.showTopMenu],[dashboardUrlParams.showQueryInput]:newSelectedMap[dashboardUrlParams.showQueryInput],[dashboardUrlParams.showTimeFilter]:newSelectedMap[dashboardUrlParams.showTimeFilter],[dashboardUrlParams.hideFilterBar]:!newSelectedMap.showFilterBar};seturlParamsSelectedMap(newSelectedMap),setParamValue(urlParamValues)},legend:{children:dashboard_strings.y.getCheckboxLegend()},"data-test-subj":"embedUrlParamExtension"})}}],showPublicUrlSwitch:showPublicUrlSwitch})}({share:share,anchorElement:anchorElement,savedDashboard:savedDashboard,dashboardStateManager:dashboardStateManager,dashboardCapabilities:dashboardCapabilities})),actions},[dashboardCapabilities,dashboardStateManager,onChangeViewMode,savedDashboard,runClone,runSave,runQuickSave,share]);useUnmount_default()(()=>{clearAddPanel()});const{TopNavMenu:TopNavMenu}=navigation.ui,quickButtons=["markdown","maps"].map(visTypeName=>{const visType=visualizations.get(visTypeName)||visualizations.getAliases().find(({name:name})=>name===visTypeName);if(visType){if("aliasPath"in visType){const{name:name,icon:icon,title:title}=visType;return{iconType:icon,createType:title,onClick:createNewVisType(visType),"data-test-subj":"dashboardQuickButton"+name,isDarkModeEnabled:IS_DARK_THEME}}{const{name:name,icon:icon,title:title,titleInWizard:titleInWizard}=visType;return{iconType:icon,createType:titleInWizard||title,onClick:createNewVisType(visType),"data-test-subj":"dashboardQuickButton"+name,isDarkModeEnabled:IS_DARK_THEME}}}}).filter(button=>button);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(TopNavMenu,(()=>{const shouldShowNavBarComponent=forceShow=>(forceShow||state.chromeIsVisible)&&!dashboardStateManager.getFullScreenMode(),isFullScreenMode=dashboardStateManager.getFullScreenMode(),screenTitle=dashboardStateManager.getTitle(),showTopNavMenu=shouldShowNavBarComponent(Boolean(null==embedSettings?void 0:embedSettings.forceShowTopNavMenu)),showQueryInput=shouldShowNavBarComponent(Boolean(null==embedSettings?void 0:embedSettings.forceShowQueryInput)),showDatePicker=shouldShowNavBarComponent(Boolean(null==embedSettings?void 0:embedSettings.forceShowDatePicker)),showQueryBar=showQueryInput||showDatePicker,showFilterBar=!Boolean(null==embedSettings?void 0:embedSettings.forceHideFilterBar)&&(data.query.filterManager.getFilters().length>0||!dashboardStateManager.getFullScreenMode());const showSearchBar=showQueryBar||showFilterBar,topNav=getTopNavConfig(viewMode,dashboardTopNavActions,{hideWriteControls:dashboardCapabilities.hideWriteControls,isNewDashboard:!savedDashboard.id,isDirty:dashboardStateManager.getIsDirty(timefilter),isSaveInProgress:isSaveInProgress});return{badges:unsavedChanges?[{"data-test-subj":"dashboardUnsavedChangesBadge",badgeText:dashboard_strings.z.getUnsavedChangedBadgeText(),color:"secondary"}]:void 0,appName:"dashboard",config:showTopNavMenu?topNav:void 0,className:isFullScreenMode?"kbnTopNavMenu-isFullScreen":void 0,screenTitle:screenTitle,showTopNavMenu:showTopNavMenu,showSearchBar:showSearchBar,showQueryBar:showQueryBar,showQueryInput:showQueryInput,showDatePicker:showDatePicker,showFilterBar:showFilterBar,setMenuMountPoint:embedSettings?void 0:setHeaderActionMenu,indexPatterns:indexPatterns,showSaveQuery:dashboardCapabilities.saveQuery,useDefaultBehaviors:!0,onQuerySubmit:onQuerySubmit,onSavedQueryUpdated:savedQuery=>{const allFilters=data.query.filterManager.getFilters();data.query.filterManager.setFilters(allFilters),dashboardStateManager.applyFilters(savedQuery.attributes.query,allFilters),savedQuery.attributes.timefilter&&(timefilter.setTime({from:savedQuery.attributes.timefilter.from,to:savedQuery.attributes.timefilter.to}),savedQuery.attributes.timefilter.refreshInterval&&timefilter.setRefreshInterval(savedQuery.attributes.timefilter.refreshInterval)),setState(s=>({...s,savedQuery:savedQuery}))},savedQuery:state.savedQuery,savedQueryId:dashboardStateManager.getSavedQueryId(),onSavedQueryIdChange:newId=>dashboardStateManager.setSavedQueryId(newId)}})()),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHorizontalRule,{margin:"none"}),viewMode!==services_embeddable.ViewMode.VIEW?external_kbnSharedDeps_React_default.a.createElement(presentationUtil_public_.SolutionToolbar,{isDarkModeEnabled:IS_DARK_THEME},{primaryActionButton:external_kbnSharedDeps_React_default.a.createElement(presentationUtil_public_.PrimaryActionButton,{isDarkModeEnabled:IS_DARK_THEME,label:external_kbnSharedDeps_KbnI18n_.i18n.translate("dashboard.solutionToolbar.addPanelButtonLabel",{defaultMessage:"Create visualization"}),onClick:createNewVisType(lensAlias),iconType:"lensApp","data-test-subj":"dashboardAddNewPanelButton"}),quickButtonGroup:external_kbnSharedDeps_React_default.a.createElement(presentationUtil_public_.QuickButtonGroup,{buttons:quickButtons}),addFromLibraryButton:external_kbnSharedDeps_React_default.a.createElement(presentationUtil_public_.AddFromLibraryButton,{onClick:addFromLibrary,"data-test-subj":"dashboardAddPanelButton"}),extraButtons:[external_kbnSharedDeps_React_default.a.createElement(EditorMenu,{createNewVisType:createNewVisType,dashboardContainer:dashboardContainer})]}):null)}var fast_deep_equal=__webpack_require__(146),fast_deep_equal_default=__webpack_require__.n(fast_deep_equal),embeddable_saved_object_converters=__webpack_require__(42);const getDashboardContainerInput=({query:query,searchSessionId:searchSessionId,incomingEmbeddable:incomingEmbeddable,isEmbeddedExternally:isEmbeddedExternally,lastReloadRequestTime:lastReloadRequestTime,dashboardStateManager:dashboardStateManager,dashboardCapabilities:dashboardCapabilities})=>{const embeddablesMap={};if(dashboardStateManager.getPanels().forEach(panel=>{embeddablesMap[panel.panelIndex]=Object(embeddable_saved_object_converters.b)(panel)}),null!=incomingEmbeddable&&incomingEmbeddable.embeddableId&&embeddablesMap[incomingEmbeddable.embeddableId]){const originalPanelState=embeddablesMap[incomingEmbeddable.embeddableId];embeddablesMap[incomingEmbeddable.embeddableId]={gridData:originalPanelState.gridData,type:incomingEmbeddable.type,explicitInput:{...originalPanelState.explicitInput,...incomingEmbeddable.input,id:incomingEmbeddable.embeddableId}}}return{refreshConfig:query.timefilter.timefilter.getRefreshInterval(),hidePanelTitles:dashboardStateManager.getHidePanelTitles(),isFullScreenMode:dashboardStateManager.getFullScreenMode(),expandedPanelId:dashboardStateManager.getExpandedPanelId(),description:dashboardStateManager.getDescription(),id:dashboardStateManager.savedDashboard.id||"",useMargins:dashboardStateManager.getUseMargins(),syncColors:dashboardStateManager.getSyncColors(),viewMode:dashboardStateManager.getViewMode(),filters:query.filterManager.getFilters(),query:dashboardStateManager.getQuery(),title:dashboardStateManager.getTitle(),panels:embeddablesMap,lastReloadRequestTime:lastReloadRequestTime,dashboardCapabilities:dashboardCapabilities,isEmbeddedExternally:isEmbeddedExternally,searchSessionId:searchSessionId,timeRange:{...external_kbnSharedDeps_Lodash_default.a.cloneDeep(query.timefilter.timefilter.getTime())}}},getSearchSessionIdFromURL=history=>Object(kibana_utils.e)(history.location)[dashboard_constants.a.SEARCH_SESSION_ID];var public_0=__webpack_require__(33);var public_application_0=__webpack_require__(5);function migrateLegacyQuery(query){return Object(external_kbnSharedDeps_Lodash_.has)(query,"language")?query:{query:query,language:"lucene"}}function dashboard_state_manager_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class dashboard_state_manager_DashboardStateManager{get appState(){return this.stateContainer.get()}get appState$(){return this.stateContainer.state$}constructor({toasts:toasts,history:history,kibanaVersion:kibanaVersion,savedDashboard:savedDashboard,usageCollection:usageCollection,hideWriteControls:hideWriteControls,kbnUrlStateStorage:kbnUrlStateStorage,hasPendingEmbeddable:hasPendingEmbeddable,dashboardPanelStorage:dashboardPanelStorage,hasTaggingCapabilities:hasTaggingCapabilities,allowByValueEmbeddables:allowByValueEmbeddables}){dashboard_state_manager_defineProperty(this,"savedDashboard",void 0),dashboard_state_manager_defineProperty(this,"lastSavedDashboardFilters",void 0),dashboard_state_manager_defineProperty(this,"stateDefaults",void 0),dashboard_state_manager_defineProperty(this,"toasts",void 0),dashboard_state_manager_defineProperty(this,"hideWriteControls",void 0),dashboard_state_manager_defineProperty(this,"kibanaVersion",void 0),dashboard_state_manager_defineProperty(this,"isDirty",void 0),dashboard_state_manager_defineProperty(this,"changeListeners",void 0),dashboard_state_manager_defineProperty(this,"hasShownMigrationToast",!1),dashboard_state_manager_defineProperty(this,"stateContainer",void 0),dashboard_state_manager_defineProperty(this,"stateContainerChangeSub",void 0),dashboard_state_manager_defineProperty(this,"dashboardPanelStorage",void 0),dashboard_state_manager_defineProperty(this,"kbnUrlStateStorage",void 0),dashboard_state_manager_defineProperty(this,"stateSyncRef",void 0),dashboard_state_manager_defineProperty(this,"allowByValueEmbeddables",void 0),dashboard_state_manager_defineProperty(this,"usageCollection",void 0),dashboard_state_manager_defineProperty(this,"hasTaggingCapabilities",void 0),dashboard_state_manager_defineProperty(this,"hasPendingEmbeddable",void 0),this.toasts=toasts,this.kibanaVersion=kibanaVersion,this.savedDashboard=savedDashboard,this.hideWriteControls=hideWriteControls,this.usageCollection=usageCollection,this.hasTaggingCapabilities=hasTaggingCapabilities,this.allowByValueEmbeddables=allowByValueEmbeddables,this.hasPendingEmbeddable=hasPendingEmbeddable,this.dashboardPanelStorage=dashboardPanelStorage,this.kbnUrlStateStorage=kbnUrlStateStorage;const viewMode=this.getInitialViewMode();this.stateDefaults=migrateAppState(getAppStateDefaults(viewMode,this.savedDashboard,this.hasTaggingCapabilities),kibanaVersion,usageCollection);const initialUrlState=this.kbnUrlStateStorage.get(url_generator.d),initialState=migrateAppState({...this.stateDefaults,...this.getUnsavedPanelState(),...initialUrlState},kibanaVersion,usageCollection);this.isDirty=!1,null!=initialUrlState&&initialUrlState.panels&&!external_kbnSharedDeps_Lodash_default.a.isEqual(initialUrlState.panels,this.stateDefaults.panels)&&(this.isDirty=!0,this.setUnsavedPanels(initialState.panels)),this.stateContainer=Object(kibana_utils.d)(initialState,{set:state=>(prop,value)=>({...state,[prop]:value}),setOption:state=>(option,value)=>({...state,options:{...state.options,[option]:value}})}),this.lastSavedDashboardFilters=this.getFilterState(),this.changeListeners=[],this.stateContainerChangeSub=this.stateContainer.state$.subscribe(()=>{this.isDirty=this.checkIsDirty(),this.changeListeners.forEach(listener=>listener({dirty:this.isDirty}))}),this.stateSyncRef=Object(kibana_utils.g)({storageKey:url_generator.d,stateContainer:{...this.stateContainer,get:()=>this.toUrlState(this.stateContainer.get()),set:stateFromUrl=>{if(stateFromUrl){if(function(url){var _url$match;const[,dashboardId]=null!==(_url$match=url.match(/view\/(.*?)(\/|\?|$)/))&&void 0!==_url$match?_url$match:[void 0,void 0];return null!=dashboardId?dashboardId:void 0}(history.location.pathname)!==this.savedDashboard.id)return;this.appState.viewMode!==stateFromUrl.viewMode&&this.switchViewMode(stateFromUrl.viewMode),this.stateContainer.set({...this.stateDefaults,...this.getUnsavedPanelState(),...stateFromUrl})}}},stateStorage:this.kbnUrlStateStorage})}startStateSyncing(){this.saveState({replace:!0}),this.stateSyncRef.start()}registerChangeListener(callback){this.changeListeners.push(callback)}handleDashboardContainerChanges(dashboardContainer){let dirty=!1,dirtyBecauseOfInitialStateMigration=!1;const savedDashboardPanelMap={},input=dashboardContainer.getInput();this.getPanels().forEach(savedDashboardPanel=>{void 0!==input.panels[savedDashboardPanel.panelIndex]?savedDashboardPanelMap[savedDashboardPanel.panelIndex]=savedDashboardPanel:dirty=!0});const convertedPanelStateMap={};let expandedPanelValid=!1;Object.values(input.panels).forEach(panelState=>{if(void 0===savedDashboardPanelMap[panelState.explicitInput.id]&&(dirty=!0),panelState.explicitInput.id===input.expandedPanelId&&(expandedPanelValid=!0),convertedPanelStateMap[panelState.explicitInput.id]=Object(embeddable_saved_object_converters.a)(panelState,this.kibanaVersion),!external_kbnSharedDeps_Lodash_default.a.isEqual(convertedPanelStateMap[panelState.explicitInput.id],savedDashboardPanelMap[panelState.explicitInput.id])){var _savedDashboardPanelM,_convertedPanelStateM;dirty=!0;const oldVersion=null===(_savedDashboardPanelM=savedDashboardPanelMap[panelState.explicitInput.id])||void 0===_savedDashboardPanelM?void 0:_savedDashboardPanelM.version,newVersion=null===(_convertedPanelStateM=convertedPanelStateMap[panelState.explicitInput.id])||void 0===_convertedPanelStateM?void 0:_convertedPanelStateM.version;oldVersion&&newVersion&&oldVersion!==newVersion&&(dirtyBecauseOfInitialStateMigration=!0)}}),dirty&&(this.stateContainer.transitions.set("panels",Object.values(convertedPanelStateMap)),dirtyBecauseOfInitialStateMigration&&(this.getIsEditMode()&&!this.hasShownMigrationToast&&(this.toasts.addSuccess(Object(dashboard_strings.t)()),this.hasShownMigrationToast=!0),this.saveState({replace:!0})),!this.isDirty&&this.getIsEditMode()?this.clearUnsavedPanels():this.setUnsavedPanels(this.getPanels())),input.isFullScreenMode!==this.getFullScreenMode()&&this.setFullScreenMode(input.isFullScreenMode),expandedPanelValid&&input.expandedPanelId!==this.getExpandedPanelId()?this.setExpandedPanelId(input.expandedPanelId):!expandedPanelValid&&this.getExpandedPanelId()&&this.setExpandedPanelId(void 0),external_kbnSharedDeps_Lodash_default.a.isEqual(input.query,this.getQuery())||this.setQuery(input.query),this.changeListeners.forEach(listener=>listener({dirty:dirty}))}getFullScreenMode(){return this.appState.fullScreenMode}setFullScreenMode(fullScreenMode){this.stateContainer.transitions.set("fullScreenMode",fullScreenMode)}getExpandedPanelId(){return this.appState.expandedPanelId}setExpandedPanelId(expandedPanelId){this.stateContainer.transitions.set("expandedPanelId",expandedPanelId)}setFilters(filters){this.stateContainer.transitions.set("filters",filters)}resetState(){this.savedDashboard.title=this.savedDashboard.lastSavedTitle;const currentViewMode=this.stateContainer.get().viewMode;this.stateDefaults=migrateAppState(getAppStateDefaults(currentViewMode,this.savedDashboard,this.hasTaggingCapabilities),this.kibanaVersion,this.usageCollection),this.stateDefaults.query=this.lastSavedDashboardFilters.query,this.stateDefaults.filters=[...this.getLastSavedFilterBars()],this.isDirty=!1,this.stateContainer.set(this.stateDefaults)}getFilterState(){return{timeTo:this.savedDashboard.timeTo,timeFrom:this.savedDashboard.timeFrom,filterBars:this.savedDashboard.getFilters(),query:this.savedDashboard.getQuery()}}getTitle(){return this.appState.title}isSaved(){return!!this.savedDashboard.id}isNew(){return!this.isSaved()}getDescription(){return this.appState.description}getTags(){return this.appState.tags}setDescription(description){this.stateContainer.transitions.set("description",description)}setTitle(title){this.savedDashboard.title=title,this.stateContainer.transitions.set("title",title)}setTags(tags){this.stateContainer.transitions.set("tags",tags)}getAppState(){return this.stateContainer.get()}getQuery(){return migrateLegacyQuery(this.stateContainer.get().query)}getSavedQueryId(){return this.stateContainer.get().savedQuery}setSavedQueryId(id){this.stateContainer.transitions.set("savedQuery",id)}getUseMargins(){return void 0!==this.appState.options.useMargins&&this.appState.options.useMargins}setUseMargins(useMargins){this.stateContainer.transitions.setOption("useMargins",useMargins)}getSyncColors(){return void 0===this.appState.options.syncColors||this.appState.options.syncColors}setSyncColors(syncColors){this.stateContainer.transitions.setOption("syncColors",syncColors)}getHidePanelTitles(){return this.appState.options.hidePanelTitles}setHidePanelTitles(hidePanelTitles){this.stateContainer.transitions.setOption("hidePanelTitles",hidePanelTitles)}getTimeRestore(){return this.appState.timeRestore}setTimeRestore(timeRestore){this.stateContainer.transitions.set("timeRestore",timeRestore)}getIsTimeSavedWithDashboard(){return this.savedDashboard.timeRestore}getLastSavedFilterBars(){return this.lastSavedDashboardFilters.filterBars}getLastSavedQuery(){return this.lastSavedDashboardFilters.query}getQueryChanged(){const currentQuery=this.appState.query,lastSavedQuery=this.getLastSavedQuery(),query=migrateLegacyQuery(currentQuery);return external_kbnSharedDeps_Lodash_default.a.isString(lastSavedQuery)&&external_kbnSharedDeps_Lodash_default.a.isPlainObject(currentQuery)&&external_kbnSharedDeps_Lodash_default.a.has(currentQuery,"query")?lastSavedQuery!==query.query:!external_kbnSharedDeps_Lodash_default.a.isEqual(currentQuery,lastSavedQuery)}getFilterBarChanged(){return!external_kbnSharedDeps_Lodash_default.a.isEqual(filter_utils_FilterUtils.cleanFiltersForComparison(this.appState.filters),filter_utils_FilterUtils.cleanFiltersForComparison(this.getLastSavedFilterBars()))}getTimeChanged(timeFilter){return!filter_utils_FilterUtils.areTimesEqual(this.lastSavedDashboardFilters.timeFrom,timeFilter.getTime().from)||!filter_utils_FilterUtils.areTimesEqual(this.lastSavedDashboardFilters.timeTo,timeFilter.getTime().to)}getViewMode(){return this.hideWriteControls?services_embeddable.ViewMode.VIEW:this.stateContainer?this.appState.viewMode:this.getInitialViewMode()}getIsViewMode(){return this.getViewMode()===services_embeddable.ViewMode.VIEW}getIsEditMode(){return this.getViewMode()===services_embeddable.ViewMode.EDIT}getIsDirty(timeFilter){const hasTimeFilterChanged=!!timeFilter&&this.getFiltersChanged(timeFilter);return this.hasUnsavedPanelState()||this.getIsEditMode()&&(this.isDirty||hasTimeFilterChanged)}getPanels(){return this.appState.panels}updatePanel(panelIndex,panelAttributes){const foundPanel=this.getPanels().find(panel=>panel.panelIndex===panelIndex);return Object.assign(foundPanel,panelAttributes),foundPanel}getChangedFilterTypes(timeFilter){const changedFilters=[];return this.getFilterBarChanged()&&changedFilters.push("filter"),this.getQueryChanged()&&changedFilters.push("query"),this.savedDashboard.timeRestore&&this.getTimeChanged(timeFilter)&&changedFilters.push("time range"),changedFilters}getFiltersChanged(timeFilter){return this.getChangedFilterTypes(timeFilter).length>0}syncTimefilterWithDashboardTime(timeFilter){if(!this.getIsTimeSavedWithDashboard())throw new Error(external_kbnSharedDeps_KbnI18n_.i18n.translate("dashboard.stateManager.timeNotSavedWithDashboardErrorMessage",{defaultMessage:"The time is not saved with this dashboard so should not be synced."}));this.savedDashboard.timeFrom&&this.savedDashboard.timeTo&&timeFilter.setTime({from:this.savedDashboard.timeFrom,to:this.savedDashboard.timeTo})}syncTimefilterWithDashboardRefreshInterval(timeFilter){if(!this.getIsTimeSavedWithDashboard())throw new Error(external_kbnSharedDeps_KbnI18n_.i18n.translate("dashboard.stateManager.timeNotSavedWithDashboardErrorMessage",{defaultMessage:"The time is not saved with this dashboard so should not be synced."}));this.savedDashboard.refreshInterval&&timeFilter.setRefreshInterval(this.savedDashboard.refreshInterval)}saveState({replace:replace}){return this.kbnUrlStateStorage.set(url_generator.d,this.toUrlState(this.stateContainer.get())),!!this.kbnUrlStateStorage.kbnUrlControls.flush(replace)}setQuery(query){this.stateContainer.transitions.set("query",query)}applyFilters(query,filters){this.savedDashboard.searchSource.setField("query",query),this.savedDashboard.searchSource.setField("filter",filters),this.stateContainer.transitions.set("query",query)}switchViewMode(newMode){this.stateContainer.transitions.set("viewMode",newMode),this.restorePanels()}destroy(){this.stateContainerChangeSub.unsubscribe(),this.savedDashboard.destroy(),this.stateSyncRef&&this.stateSyncRef.stop()}restorePanels(){var _unsavedState$panels;const unsavedState=this.getUnsavedPanelState();unsavedState&&0!==(null===(_unsavedState$panels=unsavedState.panels)||void 0===_unsavedState$panels?void 0:_unsavedState$panels.length)&&this.stateContainer.set(migrateAppState({...this.stateDefaults,...unsavedState,...this.kbnUrlStateStorage.get(url_generator.d),viewMode:this.getViewMode()},this.kibanaVersion,this.usageCollection))}clearUnsavedPanels(){var _this$savedDashboard;this.allowByValueEmbeddables&&this.dashboardPanelStorage&&this.dashboardPanelStorage.clearPanels(null===(_this$savedDashboard=this.savedDashboard)||void 0===_this$savedDashboard?void 0:_this$savedDashboard.id)}hasUnsavedPanelState(){var _this$dashboardPanelS,_this$savedDashboard2;const panels=null===(_this$dashboardPanelS=this.dashboardPanelStorage)||void 0===_this$dashboardPanelS?void 0:_this$dashboardPanelS.getPanels(null===(_this$savedDashboard2=this.savedDashboard)||void 0===_this$savedDashboard2?void 0:_this$savedDashboard2.id);return void 0!==panels&&panels.length>0}getUnsavedPanelState(){var _this$savedDashboard3;if(!this.allowByValueEmbeddables||this.getIsViewMode()||!this.dashboardPanelStorage)return{};const panels=this.dashboardPanelStorage.getPanels(null===(_this$savedDashboard3=this.savedDashboard)||void 0===_this$savedDashboard3?void 0:_this$savedDashboard3.id);return panels?{panels:panels}:{}}setUnsavedPanels(newPanels){var _this$savedDashboard4;this.allowByValueEmbeddables&&!this.getIsViewMode()&&this.getIsDirty()&&this.dashboardPanelStorage&&this.dashboardPanelStorage.setPanels(null===(_this$savedDashboard4=this.savedDashboard)||void 0===_this$savedDashboard4?void 0:_this$savedDashboard4.id,newPanels)}toUrlState(state){if(this.getIsEditMode()&&!this.allowByValueEmbeddables)return state;const{panels:panels,...stateWithoutPanels}=state;return stateWithoutPanels}getInitialViewMode(){var _this$kbnUrlStateStor;if(this.hideWriteControls)return services_embeddable.ViewMode.VIEW;const viewModeFromUrl=null===(_this$kbnUrlStateStor=this.kbnUrlStateStorage.get(url_generator.d))||void 0===_this$kbnUrlStateStor?void 0:_this$kbnUrlStateStor.viewMode;return viewModeFromUrl||(!this.savedDashboard.id||this.hasPendingEmbeddable()?services_embeddable.ViewMode.EDIT:services_embeddable.ViewMode.VIEW)}checkIsDirty(){const propsToIgnore=["viewMode","filters","query"],initial=external_kbnSharedDeps_Lodash_default.a.omit(this.stateDefaults,propsToIgnore),current=external_kbnSharedDeps_Lodash_default.a.omit(this.stateContainer.get(),propsToIgnore);return!external_kbnSharedDeps_Lodash_default.a.isEqual(initial,current)}}function defaultTaggingGuard(_obj){return!1}const useDashboardStateManager=(savedDashboard,history,getIncomingEmbeddable)=>{const{data:dataPlugin,core:core,uiSettings:uiSettings,usageCollection:usageCollection,initializerContext:initializerContext,savedObjectsTagging:savedObjectsTagging,dashboardCapabilities:dashboardCapabilities,dashboardPanelStorage:dashboardPanelStorage,allowByValueEmbeddables:allowByValueEmbeddables}=Object(kibana_react.g)().services,{query:queryService}=dataPlugin,{session:searchSession}=dataPlugin.search,{filterManager:filterManager,queryString:queryStringManager}=queryService,{timefilter:timefilter}=queryService.timefilter,{toasts:toasts}=core.notifications,{hideWriteControls:hideWriteControls}=dashboardCapabilities,{version:kibanaVersion}=initializerContext.env.packageInfo,[dashboardStateManager,setDashboardStateManager]=Object(external_kbnSharedDeps_React_.useState)(null),[viewMode,setViewMode]=Object(external_kbnSharedDeps_React_.useState)(null),hasTaggingCapabilities=(null==savedObjectsTagging?void 0:savedObjectsTagging.ui.hasTagDecoration)||defaultTaggingGuard;return Object(external_kbnSharedDeps_React_.useEffect)(()=>{if(!savedDashboard)return;const kbnUrlStateStorage=Object(kibana_utils.b)({history:history,useHash:uiSettings.get("state:storeInSessionStorage"),...Object(kibana_utils.i)(toasts)}),stateManager=new dashboard_state_manager_DashboardStateManager({hasPendingEmbeddable:()=>Boolean(getIncomingEmbeddable()),toasts:core.notifications.toasts,hasTaggingCapabilities:hasTaggingCapabilities,dashboardPanelStorage:dashboardPanelStorage,hideWriteControls:hideWriteControls,history:history,kbnUrlStateStorage:kbnUrlStateStorage,kibanaVersion:kibanaVersion,savedDashboard:savedDashboard,usageCollection:usageCollection,allowByValueEmbeddables:allowByValueEmbeddables});filterManager.setAppFilters(external_kbnSharedDeps_Lodash_default.a.cloneDeep(stateManager.appState.filters)),queryStringManager.setQuery(migrateLegacyQuery(stateManager.appState.query));const stopSyncingAppFilters=Object(services_data.connectToQueryState)(queryService,{set:({filters:filters,query:query})=>{stateManager.setFilters(filters||[]),stateManager.setQuery(query||queryStringManager.getDefaultQuery())},get:()=>({filters:stateManager.appState.filters,query:stateManager.getQuery()}),state$:stateManager.appState$.pipe(Object(external_kbnSharedDeps_RxjsOperators_.map)(appState=>({filters:appState.filters,query:queryStringManager.formatQuery(appState.query)})))},{filters:services_data.esFilters.FilterStateStore.APP_STATE,query:!0});if(stateManager.applyFilters(stateManager.getQuery()||queryStringManager.getDefaultQuery(),filterManager.getFilters()),stateManager.getIsTimeSavedWithDashboard()){const initialGlobalStateInUrl=kbnUrlStateStorage.get("_g");null!=initialGlobalStateInUrl&&initialGlobalStateInUrl.time||stateManager.syncTimefilterWithDashboardTime(timefilter),null!=initialGlobalStateInUrl&&initialGlobalStateInUrl.refreshInterval||stateManager.syncTimefilterWithDashboardRefreshInterval(timefilter)}const{stop:stopSyncingQueryServiceStateWithUrl}=Object(services_data.syncQueryStateWithUrl)(queryService,kbnUrlStateStorage);stateManager.startStateSyncing();const dashboardTitle=Object(dashboard_strings.s)(stateManager.getTitle(),stateManager.getViewMode(),stateManager.isNew());var deps;return searchSession.enableStorage((deps={data:dataPlugin,getDashboardTitle:()=>dashboardTitle,getDashboardId:()=>(null==savedDashboard?void 0:savedDashboard.id)||"",getAppState:()=>stateManager.getAppState()},{getName:async()=>deps.getDashboardTitle(),getUrlGeneratorData:async()=>({urlGeneratorId:url_generator.a,initialState:getUrlGeneratorState({...deps,shouldRestoreSearchSession:!1}),restoreState:getUrlGeneratorState({...deps,shouldRestoreSearchSession:!0})})}),{isDisabled:()=>dashboardCapabilities.storeSearchSession?{disabled:!1}:{disabled:!0,reasonText:services_data.noSearchSessionStorageCapabilityMessage}}),setDashboardStateManager(stateManager),setViewMode(stateManager.getViewMode()),()=>{null==stateManager||stateManager.destroy(),setDashboardStateManager(null),stopSyncingAppFilters(),stopSyncingQueryServiceStateWithUrl()}},[dataPlugin,filterManager,hasTaggingCapabilities,initializerContext.config,dashboardPanelStorage,getIncomingEmbeddable,hideWriteControls,history,kibanaVersion,queryService,queryStringManager,savedDashboard,searchSession,timefilter,toasts,uiSettings,usageCollection,allowByValueEmbeddables,core.notifications.toasts,dashboardCapabilities.storeSearchSession]),{dashboardStateManager:dashboardStateManager,viewMode:viewMode,setViewMode:setViewMode}};function dashboard_app_extends(){return(dashboard_app_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function DashboardApp({savedDashboardId:savedDashboardId,embedSettings:embedSettings,redirectTo:redirectTo,history:history}){const{data:data,core:core,onAppLeave:onAppLeave,uiSettings:uiSettings,embeddable:embeddable,dashboardCapabilities:dashboardCapabilities,indexPatterns:indexPatternService}=Object(kibanaReact_public_.useKibana)().services,triggerRefresh$=Object(external_kbnSharedDeps_React_.useMemo)(()=>new external_kbnSharedDeps_Rxjs_.Subject,[]),[indexPatterns,setIndexPatterns]=Object(external_kbnSharedDeps_React_.useState)([]),savedDashboard=((savedDashboardId,history)=>{const{data:data,core:core,chrome:chrome,savedDashboards:savedDashboards}=Object(kibana_react.g)().services,[savedDashboard,setSavedDashboard]=Object(external_kbnSharedDeps_React_.useState)(null),{indexPatterns:indexPatterns}=data,{recentlyAccessed:recentlyAccessedPaths,docTitle:docTitle}=chrome,{toasts:toasts}=core.notifications;return Object(external_kbnSharedDeps_React_.useEffect)(()=>(async function(){if("create"===savedDashboardId)return history.replace({...history.location,pathname:public_0.DashboardConstants.CREATE_NEW_DASHBOARD_URL}),void toasts.addWarning(Object(dashboard_strings.p)());await indexPatterns.ensureDefaultIndexPattern();try{const dashboard=await savedDashboards.get(savedDashboardId);docTitle.change(dashboard.title||Object(dashboard_strings.u)()),setSavedDashboard(dashboard)}catch(error){toasts.addDanger(error.message),history.push(public_0.DashboardConstants.LANDING_PAGE_PATH)}}(),()=>setSavedDashboard(null)),[toasts,docTitle,history,indexPatterns,recentlyAccessedPaths,savedDashboardId,savedDashboards]),savedDashboard})(savedDashboardId,history),getIncomingEmbeddable=Object(external_kbnSharedDeps_React_.useCallback)(removeAfterFetch=>embeddable.getStateTransfer().getIncomingEmbeddablePackage(dashboard_constants.a.DASHBOARDS_ID,removeAfterFetch),[embeddable]),{dashboardStateManager:dashboardStateManager,viewMode:viewMode,setViewMode:setViewMode}=useDashboardStateManager(savedDashboard,history,getIncomingEmbeddable),[unsavedChanges,setUnsavedChanges]=Object(external_kbnSharedDeps_React_.useState)(!1),dashboardContainer=(({history:history,timeFilter:timeFilter,setUnsavedChanges:setUnsavedChanges,getIncomingEmbeddable:getIncomingEmbeddable,dashboardStateManager:dashboardStateManager,isEmbeddedExternally:isEmbeddedExternally})=>{const{dashboardCapabilities:dashboardCapabilities,data:data,embeddable:embeddable,scopedHistory:scopedHistory}=Object(kibana_react.g)().services,{query:query}=data,{session:searchSession}=data.search,[dashboardContainer,setDashboardContainer]=Object(external_kbnSharedDeps_React_.useState)(null);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{if(!dashboardStateManager)return;const dashboardFactory=embeddable.getEmbeddableFactory(public_application_0.DASHBOARD_CONTAINER_TYPE);if(!dashboardFactory)throw new services_embeddable.EmbeddableFactoryNotFoundError("dashboard app requires dashboard embeddable factory");const searchSessionIdFromURL=getSearchSessionIdFromURL(history);searchSessionIdFromURL&&searchSession.restore(searchSessionIdFromURL);const incomingEmbeddable=getIncomingEmbeddable(!0);let pendingContainer,canceled=!1;return async function(){if(pendingContainer=await dashboardFactory.create(getDashboardContainerInput({isEmbeddedExternally:Boolean(isEmbeddedExternally),dashboardCapabilities:dashboardCapabilities,dashboardStateManager:dashboardStateManager,incomingEmbeddable:incomingEmbeddable,query:query,searchSessionId:null!=searchSessionIdFromURL?searchSessionIdFromURL:searchSession.start()})),canceled)try{var _pendingContainer;null===(_pendingContainer=pendingContainer)||void 0===_pendingContainer||_pendingContainer.destroy(),pendingContainer=null}catch(e){console.warn(e)}else pendingContainer&&!Object(services_embeddable.isErrorEmbeddable)(pendingContainer)&&(pendingContainer.switchViewMode=newViewMode=>dashboardStateManager.switchViewMode(newViewMode),incomingEmbeddable&&(null==incomingEmbeddable||!incomingEmbeddable.embeddableId||incomingEmbeddable.embeddableId&&!pendingContainer.getInput().panels[incomingEmbeddable.embeddableId])&&pendingContainer.addNewEmbeddable(incomingEmbeddable.type,incomingEmbeddable.input),setDashboardContainer(pendingContainer),null==setUnsavedChanges||setUnsavedChanges(dashboardStateManager.getIsDirty(data.query.timefilter.timefilter)))}(),()=>{canceled=!0;try{var _pendingContainer2;null===(_pendingContainer2=pendingContainer)||void 0===_pendingContainer2||_pendingContainer2.destroy()}catch(e){console.warn(e)}setDashboardContainer(null)}},[data.query.timefilter.timefilter,dashboardCapabilities,dashboardStateManager,getIncomingEmbeddable,isEmbeddedExternally,setUnsavedChanges,searchSession,scopedHistory,timeFilter,embeddable,history,query]),dashboardContainer})({timeFilter:data.query.timefilter.timefilter,dashboardStateManager:dashboardStateManager,getIncomingEmbeddable:getIncomingEmbeddable,setUnsavedChanges:setUnsavedChanges,history:history}),searchSessionIdQuery$=Object(external_kbnSharedDeps_React_.useMemo)(()=>Object(public_.createQueryParamObservable)(history,dashboard_constants.a.SEARCH_SESSION_ID),[history]),refreshDashboardContainer=Object(external_kbnSharedDeps_React_.useCallback)(force=>{if(!dashboardContainer||!dashboardStateManager)return;const changes=(({dashboardContainer:dashboardContainer,appStateDashboardInput:appStateDashboardInput})=>{if(!dashboardContainer||Object(services_embeddable.isErrorEmbeddable)(dashboardContainer))return appStateDashboardInput;const containerInput=dashboardContainer.getInput(),differences={};return services_data.esFilters.compareFilters(containerInput.filters,appStateDashboardInput.filters,services_data.esFilters.COMPARE_ALL_OPTIONS)||(differences.filters=appStateDashboardInput.filters),Object.keys(external_kbnSharedDeps_Lodash_default.a.omit(containerInput,["filters","searchSessionId","lastReloadRequestTime","switchViewMode"])).forEach(key=>{const containerValue=containerInput[key],appStateValue=appStateDashboardInput[key];external_kbnSharedDeps_Lodash_default.a.isEqual(containerValue,appStateValue)||(differences[key]=appStateValue)}),appStateDashboardInput.lastReloadRequestTime&&containerInput.lastReloadRequestTime!==appStateDashboardInput.lastReloadRequestTime&&(differences.lastReloadRequestTime=appStateDashboardInput.lastReloadRequestTime),0===Object.values(differences).length?void 0:external_kbnSharedDeps_Lodash_default.a.cloneDeep(differences)})({dashboardContainer:dashboardContainer,appStateDashboardInput:getDashboardContainerInput({isEmbeddedExternally:Boolean(embedSettings),dashboardStateManager:dashboardStateManager,lastReloadRequestTime:force?Date.now():void 0,dashboardCapabilities:dashboardCapabilities,query:data.query})});if(changes){const noRefetchKeys=["viewMode","title","description","expandedPanelId","useMargins","isEmbeddedExternally","isFullScreenMode"],shouldRefetch=Object.keys(changes).some(changeKey=>!noRefetchKeys.includes(changeKey)),newSearchSessionId=(()=>{var _searchSessionIdFromU;if(!shouldRefetch)return;let searchSessionIdFromURL=getSearchSessionIdFromURL(history);return searchSessionIdFromURL&&(data.search.session.isRestore()&&data.search.session.isCurrentSession(searchSessionIdFromURL)?(dashboardStateManager.kbnUrlStateStorage.kbnUrlControls.updateAsync(nextUrl=>nextUrl.includes(dashboard_constants.a.SEARCH_SESSION_ID)?Object(public_.replaceUrlHashQuery)(nextUrl,query=>(delete query[dashboard_constants.a.SEARCH_SESSION_ID],query)):nextUrl),searchSessionIdFromURL=void 0):data.search.session.restore(searchSessionIdFromURL)),null!==(_searchSessionIdFromU=searchSessionIdFromURL)&&void 0!==_searchSessionIdFromU?_searchSessionIdFromU:data.search.session.start()})();changes.viewMode&&setViewMode(changes.viewMode),dashboardContainer.updateInput({...changes,...newSearchSessionId&&{searchSessionId:newSearchSessionId}})}},[history,data.query,setViewMode,embedSettings,dashboardContainer,data.search.session,dashboardCapabilities,dashboardStateManager]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{if(!dashboardStateManager||!dashboardContainer)return;const timeFilter=data.query.timefilter.timefilter,subscriptions=new external_kbnSharedDeps_Rxjs_.Subscription;subscriptions.add((({dashboardContainer:dashboardContainer,dashboardStateManager:dashboardStateManager,filterManager:filterManager})=>dashboardContainer.getInput$().subscribe(()=>{services_data.esFilters.compareFilters(dashboardContainer.getInput().filters,filterManager.getFilters(),services_data.esFilters.COMPARE_ALL_OPTIONS)||(filterManager.addFilters(external_kbnSharedDeps_Lodash_default.a.cloneDeep(dashboardContainer.getInput().filters)),dashboardStateManager.applyFilters(dashboardStateManager.getQuery(),dashboardContainer.getInput().filters)),dashboardStateManager.handleDashboardContainerChanges(dashboardContainer)}))({dashboardContainer:dashboardContainer,dashboardStateManager:dashboardStateManager,filterManager:data.query.filterManager})),subscriptions.add((({dashboardContainer:dashboardContainer,indexPatterns:indexPatterns,onUpdateIndexPatterns:onUpdateIndexPatterns})=>{const updateIndexPatternsOperator=Object(external_kbnSharedDeps_Rxjs_.pipe)(Object(external_kbnSharedDeps_RxjsOperators_.filter)(container=>!!container&&!Object(services_embeddable.isErrorEmbeddable)(container)),Object(external_kbnSharedDeps_RxjsOperators_.map)(container=>{let panelIndexPatterns=[];return Object.values(container.getChildIds()).forEach(id=>{const embeddableInstance=container.getChild(id);if(Object(services_embeddable.isErrorEmbeddable)(embeddableInstance))return;const embeddableIndexPatterns=embeddableInstance.getOutput().indexPatterns;embeddableIndexPatterns&&panelIndexPatterns.push(...embeddableIndexPatterns)}),panelIndexPatterns=Object(external_kbnSharedDeps_Lodash_.uniqBy)(panelIndexPatterns,"id"),panelIndexPatterns}),Object(external_kbnSharedDeps_RxjsOperators_.distinctUntilChanged)((a,b)=>fast_deep_equal_default()(a.map(ip=>ip&&ip.id),b.map(ip=>ip&&ip.id))),Object(external_kbnSharedDeps_RxjsOperators_.switchMap)(panelIndexPatterns=>new external_kbnSharedDeps_Rxjs_.Observable(observer=>{if(panelIndexPatterns&&panelIndexPatterns.length>0){if(observer.closed)return;onUpdateIndexPatterns(panelIndexPatterns),observer.complete()}else indexPatterns.getDefault().then(defaultIndexPattern=>{observer.closed||(onUpdateIndexPatterns([defaultIndexPattern]),observer.complete())})})));return Object(external_kbnSharedDeps_Rxjs_.merge)(dashboardContainer.getOutput$(),dashboardContainer.getOutput$().pipe(Object(external_kbnSharedDeps_RxjsOperators_.map)(()=>dashboardContainer.getChildIds()),Object(external_kbnSharedDeps_RxjsOperators_.distinctUntilChanged)(fast_deep_equal_default.a),Object(external_kbnSharedDeps_RxjsOperators_.switchMap)(newChildIds=>Object(external_kbnSharedDeps_Rxjs_.merge)(...newChildIds.map(childId=>dashboardContainer.getChild(childId).getOutput$()))))).pipe(Object(external_kbnSharedDeps_RxjsOperators_.mapTo)(dashboardContainer),Object(external_kbnSharedDeps_RxjsOperators_.startWith)(dashboardContainer),updateIndexPatternsOperator).subscribe()})({dashboardContainer:dashboardContainer,indexPatterns:indexPatternService,onUpdateIndexPatterns:newIndexPatterns=>setIndexPatterns(newIndexPatterns)})),subscriptions.add((({query:query,dashboardStateManager:dashboardStateManager})=>Object(external_kbnSharedDeps_Rxjs_.merge)(query.filterManager.getUpdates$(),query.queryString.getUpdates$()).pipe(Object(external_kbnSharedDeps_RxjsOperators_.debounceTime)(100)).subscribe(()=>{dashboardStateManager.applyFilters(query.queryString.getQuery(),query.filterManager.getFilters())}))({query:data.query,dashboardStateManager:dashboardStateManager})),subscriptions.add(Object(external_kbnSharedDeps_Rxjs_.merge)(timeFilter.getRefreshIntervalUpdate$(),timeFilter.getTimeUpdate$()).subscribe(()=>triggerRefresh$.next())),subscriptions.add(searchSessionIdQuery$.subscribe(()=>{triggerRefresh$.next({force:!0})})),subscriptions.add(data.query.timefilter.timefilter.getAutoRefreshFetch$().pipe(Object(external_kbnSharedDeps_RxjsOperators_.tap)(()=>{triggerRefresh$.next({force:!0})}),Object(external_kbnSharedDeps_RxjsOperators_.switchMap)(done=>Object(services_data.waitUntilNextSessionCompletes$)(data.search.session).pipe(Object(external_kbnSharedDeps_RxjsOperators_.finalize)(done)))).subscribe()),dashboardStateManager.registerChangeListener(()=>{setUnsavedChanges(dashboardStateManager.getIsDirty(data.query.timefilter.timefilter)),triggerRefresh$.next()});let forceRefresh=!1;return subscriptions.add(triggerRefresh$.pipe(Object(external_kbnSharedDeps_RxjsOperators_.tap)(trigger=>{var _trigger$force;forceRefresh=forceRefresh||null!==(_trigger$force=null==trigger?void 0:trigger.force)&&void 0!==_trigger$force&&_trigger$force}),Object(external_kbnSharedDeps_RxjsOperators_.debounceTime)(50)).subscribe(()=>{refreshDashboardContainer(forceRefresh),forceRefresh=!1})),()=>{subscriptions.unsubscribe()}},[core.http,uiSettings,data.query,dashboardContainer,data.search.session,indexPatternService,dashboardStateManager,searchSessionIdQuery$,triggerRefresh$,refreshDashboardContainer]),((dashboardStateManager,redirectTo)=>{const{data:data,core:core,chrome:chrome}=Object(kibana_react.g)().services,{setBreadcrumbs:setBreadcrumbs}=chrome,{timefilter:timefilter}=data.query.timefilter,{openConfirm:openConfirm}=core.overlays;Object(external_kbnSharedDeps_React_.useEffect)(()=>{dashboardStateManager&&setBreadcrumbs([{text:Object(dashboard_strings.q)(),"data-test-subj":"dashboardListingBreadcrumb",onClick:()=>{redirectTo({destination:"listing"})}},{text:Object(dashboard_strings.s)(dashboardStateManager.getTitle(),dashboardStateManager.getViewMode(),dashboardStateManager.isNew())}])},[dashboardStateManager,timefilter,openConfirm,redirectTo,setBreadcrumbs])})(dashboardStateManager,redirectTo),Object(external_kbnSharedDeps_React_.useEffect)(()=>{if(dashboardStateManager&&dashboardContainer)return onAppLeave(actions=>null!=dashboardStateManager&&dashboardStateManager.getIsDirty()&&!embeddable.getStateTransfer().isTransferInProgress?actions.confirm(dashboard_strings.v.getLeaveSubtitle(),dashboard_strings.v.getLeaveTitle()):actions.default()),()=>{onAppLeave(actions=>actions.default())}},[dashboardStateManager,dashboardContainer,onAppLeave,embeddable]),Object(external_kbnSharedDeps_React_.useEffect)(()=>()=>{data.search.session.clear()},[data.search.session]),external_kbnSharedDeps_React_default.a.createElement("div",{className:"app-container dshAppContainer"},savedDashboard&&dashboardStateManager&&dashboardContainer&&viewMode&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(DashboardTopNav,dashboard_app_extends({redirectTo:redirectTo,embedSettings:embedSettings,indexPatterns:indexPatterns,savedDashboard:savedDashboard,unsavedChanges:unsavedChanges,dashboardContainer:dashboardContainer,dashboardStateManager:dashboardStateManager},{viewMode:viewMode,lastDashboardId:savedDashboardId,clearUnsavedChanges:()=>setUnsavedChanges(!1),timefilter:data.query.timefilter.timefilter,onQuerySubmit:(_payload,isUpdate)=>{!1===isUpdate&&triggerRefresh$.next({force:!0})}})),external_kbnSharedDeps_React_default.a.createElement("div",{className:"dashboardViewport"},external_kbnSharedDeps_React_default.a.createElement(services_embeddable.EmbeddableRenderer,{embeddable:dashboardContainer}))))}let bannerId;const DashboardNoMatch=({history:history})=>{const{services:services}=Object(kibana_react.g)();return Object(external_kbnSharedDeps_React_.useEffect)(()=>{services.restorePreviousUrl();const{navigated:navigated}=services.urlForwarding.navigateToLegacyKibanaUrl(history.location.pathname);if(!navigated){const bannerMessage=external_kbnSharedDeps_KbnI18n_.i18n.translate("dashboard.noMatchRoute.bannerTitleText",{defaultMessage:"Page not found"});bannerId=services.core.overlays.banners.replace(bannerId,Object(kibana_react.f)(external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{color:"warning",iconType:"iInCircle",title:bannerMessage},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"dashboard.noMatchRoute.bannerText",defaultMessage:"Dashboard application doesn't recognize this route: {route}.",values:{route:history.location.pathname}}))))),setTimeout(()=>{bannerId&&services.core.overlays.banners.remove(bannerId)},15e3),history.replace(public_0.DashboardConstants.LANDING_PAGE_PATH)}},[services,history]),null},dashboardUrlParams={showTopMenu:"show-top-menu",showQueryInput:"show-query-input",showTimeFilter:"show-time-filter",hideFilterBar:"hide-filter-bar"};async function mountApp({core:core,element:element,onAppLeave:onAppLeave,appUnMounted:appUnMounted,scopedHistory:scopedHistory,usageCollection:usageCollection,initializerContext:initializerContext,restorePreviousUrl:restorePreviousUrl,setHeaderActionMenu:setHeaderActionMenu}){var _pluginsStart$spacesO,_await$spacesApi$getA,_coreStart$applicatio,_coreStart$applicatio2;const[coreStart,pluginsStart,dashboardStart]=await core.getStartServices(),{navigation:navigation,savedObjects:savedObjects,urlForwarding:urlForwarding,data:dataStart,share:shareStart,embeddable:embeddableStart,kibanaLegacy:{dashboardConfig:dashboardConfig},savedObjectsTaggingOss:savedObjectsTaggingOss,visualizations:visualizations}=pluginsStart,spacesApi=null!==(_pluginsStart$spacesO=pluginsStart.spacesOss)&&void 0!==_pluginsStart$spacesO&&_pluginsStart$spacesO.isSpacesAvailable?pluginsStart.spacesOss:void 0,activeSpaceId=spacesApi&&(null===(_await$spacesApi$getA=await spacesApi.getActiveSpace$().pipe(Object(external_kbnSharedDeps_RxjsOperators_.first)()).toPromise())||void 0===_await$spacesApi$getA?void 0:_await$spacesApi$getA.id);let globalEmbedSettings;const dashboardServices={navigation:navigation,onAppLeave:onAppLeave,savedObjects:savedObjects,urlForwarding:urlForwarding,usageCollection:usageCollection,core:coreStart,data:dataStart,share:shareStart,initializerContext:initializerContext,restorePreviousUrl:restorePreviousUrl,setHeaderActionMenu:setHeaderActionMenu,chrome:coreStart.chrome,embeddable:embeddableStart,uiSettings:coreStart.uiSettings,scopedHistory:()=>scopedHistory,indexPatterns:dataStart.indexPatterns,savedQueryService:dataStart.query.savedQueries,savedObjectsClient:coreStart.savedObjects.client,dashboardPanelStorage:new dashboard_panel_storage_DashboardPanelStorage(core.notifications.toasts,activeSpaceId||"default"),savedDashboards:dashboardStart.getSavedDashboardLoader(),savedObjectsTagging:null==savedObjectsTaggingOss?void 0:savedObjectsTaggingOss.getTaggingApi(),allowByValueEmbeddables:initializerContext.config.get().allowByValueEmbeddables,dashboardCapabilities:{hideWriteControls:dashboardConfig.getHideWriteControls(),show:Boolean(coreStart.application.capabilities.dashboard.show),saveQuery:Boolean(coreStart.application.capabilities.dashboard.saveQuery),createNew:Boolean(coreStart.application.capabilities.dashboard.createNew),mapsCapabilities:{save:Boolean(null===(_coreStart$applicatio=coreStart.application.capabilities.maps)||void 0===_coreStart$applicatio?void 0:_coreStart$applicatio.save)},createShortUrl:Boolean(coreStart.application.capabilities.dashboard.createShortUrl),visualizeCapabilities:{save:Boolean(null===(_coreStart$applicatio2=coreStart.application.capabilities.visualize)||void 0===_coreStart$applicatio2?void 0:_coreStart$applicatio2.save)},storeSearchSession:Boolean(coreStart.application.capabilities.dashboard.storeSearchSession)},visualizations:visualizations},redirect=(routeProps,redirectTo)=>{const historyFunction=redirectTo.useReplace?routeProps.history.replace:routeProps.history.push;let destination;destination="dashboard"===redirectTo.destination?redirectTo.id?Object(dashboard_constants.b)(redirectTo.id,redirectTo.editMode):dashboard_constants.a.CREATE_NEW_DASHBOARD_URL:Object(dashboard_constants.c)(redirectTo.filter),historyFunction(destination)};await dataStart.indexPatterns.clearCache();const unlistenParentHistory=scopedHistory.listen(()=>{window.dispatchEvent(new HashChangeEvent("hashchange"))}),app=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.I18nProvider,null,external_kbnSharedDeps_React_default.a.createElement(kibana_react.b,{services:dashboardServices},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.HashRouter,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Switch,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:[dashboard_constants.a.CREATE_NEW_DASHBOARD_URL,dashboard_constants.a.VIEW_DASHBOARD_URL+"/:id"],render:routeProps=>{const routeParams=Object(query_string.parse)(routeProps.history.location.search);return routeParams.embed&&!globalEmbedSettings&&(globalEmbedSettings=(routeParams=>({forceShowTopNavMenu:Boolean(routeParams[dashboardUrlParams.showTopMenu]),forceShowQueryInput:Boolean(routeParams[dashboardUrlParams.showQueryInput]),forceShowDatePicker:Boolean(routeParams[dashboardUrlParams.showTimeFilter]),forceHideFilterBar:Boolean(routeParams[dashboardUrlParams.hideFilterBar])}))(routeParams)),external_kbnSharedDeps_React_default.a.createElement(DashboardApp,{history:routeProps.history,embedSettings:globalEmbedSettings,savedDashboardId:routeProps.match.params.id,redirectTo:props=>redirect(routeProps,props)})}}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{exact:!0,path:dashboard_constants.a.LANDING_PAGE_PATH,render:routeProps=>{coreStart.chrome.docTitle.change(Object(dashboard_strings.r)());const routeParams=Object(query_string.parse)(routeProps.history.location.search),title=routeParams.title||void 0,filter=routeParams.filter||void 0;return external_kbnSharedDeps_React_default.a.createElement(DashboardListing,{initialFilter:filter,title:title,kbnUrlStateStorage:(history=routeProps.history,Object(kibana_utils.b)({history:history,useHash:coreStart.uiSettings.get("state:storeInSessionStorage"),...Object(kibana_utils.i)(core.notifications.toasts)})),redirectTo:props=>redirect(routeProps,props)});var history}}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{exact:!0,path:"/"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Redirect,{to:dashboard_constants.a.LANDING_PAGE_PATH})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{render:routeProps=>external_kbnSharedDeps_React_default.a.createElement(DashboardNoMatch,{history:routeProps.history})})))));var chrome,docLinks;return chrome=dashboardServices.chrome,docLinks=coreStart.docLinks,chrome.setHelpExtension({appName:external_kbnSharedDeps_KbnI18n_.i18n.translate("dashboard.helpMenu.appName",{defaultMessage:"Dashboards"}),links:[{linkType:"documentation",href:""+docLinks.links.dashboard.guide}]}),dashboardServices.dashboardCapabilities.hideWriteControls&&coreStart.chrome.setBadge({text:dashboard_strings.j.getText(),tooltip:dashboard_strings.j.getTooltip(),iconType:"glasses"}),Object(external_kbnSharedDeps_ReactDom_.render)(app,element),()=>{dataStart.search.session.clear(),unlistenParentHistory(),Object(external_kbnSharedDeps_ReactDom_.unmountComponentAtNode)(element),appUnMounted()}}}}]);