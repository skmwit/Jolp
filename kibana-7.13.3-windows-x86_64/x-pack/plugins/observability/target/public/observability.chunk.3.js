/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.observability_bundle_jsonpfunction=window.observability_bundle_jsonpfunction||[]).push([[3],{46:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"default",(function(){return CoreVitals}));var external_kbnSharedDeps_React_=__webpack_require__(0),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),external_kbnSharedDeps_ElasticEui_=__webpack_require__(1),external_kbnSharedDeps_KbnI18n_=__webpack_require__(3);const NO_DATA=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.observability.ux.coreVitals.noData",{defaultMessage:"No data is available."}),LCP_LABEL=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.observability.ux.coreVitals.lcp",{defaultMessage:"Largest contentful paint"}),FID_LABEL=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.observability.ux.coreVitals.fip",{defaultMessage:"First input delay"}),CLS_LABEL=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.observability.ux.coreVitals.cls",{defaultMessage:"Cumulative layout shift"}),CV_POOR_LABEL=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.observability.ux.coreVitals.poor",{defaultMessage:"a poor"}),CV_GOOD_LABEL=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.observability.ux.coreVitals.good",{defaultMessage:"a good"}),CV_AVERAGE_LABEL=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.observability.ux.coreVitals.average",{defaultMessage:"an average"}),LEGEND_POOR_LABEL=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.observability.ux.coreVitals.legends.poor",{defaultMessage:"Poor"}),LEGEND_GOOD_LABEL=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.observability.ux.coreVitals.legends.good",{defaultMessage:"Good"}),LEGEND_NEEDS_IMPROVEMENT_LABEL=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.observability.ux.coreVitals.legends.needsImprovement",{defaultMessage:"Needs improvement"}),MORE_LABEL=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.observability.ux.coreVitals.more",{defaultMessage:"more"}),LESS_LABEL=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.observability.ux.coreVitals.less",{defaultMessage:"less"}),IS_LABEL=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.observability.ux.coreVitals.is",{defaultMessage:"is"}),TAKES_LABEL=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.observability.ux.coreVitals.takes",{defaultMessage:"takes"}),LCP_HELP_LABEL=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.observability.ux.coreVitals.lcp.help",{defaultMessage:"Largest contentful paint measures loading performance. To provide a good user experience, LCP should occur within 2.5 seconds of when the page first starts loading."}),FID_HELP_LABEL=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.observability.ux.coreVitals.fid.help",{defaultMessage:"First input delay measures interactivity. To provide a good user experience, pages should have a FID of less than 100 milliseconds."}),CLS_HELP_LABEL=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.observability.ux.coreVitals.cls.help",{defaultMessage:"Cumulative Layout Shift (CLS): measures visual stability. To provide a good user experience, pages should maintain a CLS of less than 0.1."});var external_kbnSharedDeps_StyledComponents_=__webpack_require__(5),external_kbnSharedDeps_StyledComponents_default=__webpack_require__.n(external_kbnSharedDeps_StyledComponents_),external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(39),external_kbnSharedDeps_Theme_euiLightVars_=__webpack_require__(49),external_kbnSharedDeps_Theme_euiLightVars_default=__webpack_require__.n(external_kbnSharedDeps_Theme_euiLightVars_),external_kbnSharedDeps_Theme_euiDarkVars_=__webpack_require__(50),external_kbnSharedDeps_Theme_euiDarkVars_default=__webpack_require__.n(external_kbnSharedDeps_Theme_euiDarkVars_),public_=__webpack_require__(12);const PaletteLegend=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiHealth).withConfig({displayName:"PaletteLegend",componentId:"r7v41l-0"})(["&:hover{cursor:pointer;text-decoration:underline;}"]),StyledSpan=external_kbnSharedDeps_StyledComponents_default.a.span.withConfig({displayName:"StyledSpan",componentId:"r7v41l-1"})(["&:hover{background-color:",";}"],props=>props.darkMode?external_kbnSharedDeps_Theme_euiDarkVars_default.a.euiColorLightestShade:external_kbnSharedDeps_Theme_euiLightVars_default.a.euiColorLightestShade);function PaletteLegends({ranks:ranks,title:title,onItemHover:onItemHover,thresholds:thresholds,isCls:isCls}){const[darkMode]=Object(public_.useUiSetting$)("theme:darkMode"),palette=Object(external_kbnSharedDeps_ElasticEui_.euiPaletteForStatus)(3),labels=[LEGEND_GOOD_LABEL,LEGEND_NEEDS_IMPROVEMENT_LABEL,LEGEND_POOR_LABEL];return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{responsive:!1,gutterSize:"s"},palette.map((color,ind)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{key:ind,grow:!1,onMouseEnter:()=>{onItemHover(ind)},onMouseLeave:()=>{onItemHover(null)}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{content:getCoreVitalTooltipMessage(thresholds,ind,title,ranks[ind],isCls),position:"bottom"},external_kbnSharedDeps_React_default.a.createElement(StyledSpan,{darkMode:darkMode},external_kbnSharedDeps_React_default.a.createElement(PaletteLegend,{color:color},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.observability.ux.coreVitals.paletteLegend.rankPercentage",defaultMessage:"{labelsInd} ({ranksInd}%)",values:{labelsInd:labels[ind],ranksInd:null==ranks?void 0:ranks[ind]}}))))))))}const ColoredSpan=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"ColoredSpan",componentId:"tpi8wf-0"})(["height:16px;width:100%;cursor:pointer;"]);function ColorPaletteFlexItem({hexCode:hexCode,inFocus:inFocus,percentage:percentage,tooltip:tooltip,position:position}){const spanStyle=((position,inFocus,hexCode,percentage)=>{let first=0===position||100===percentage,last=2===position||100===percentage;100===percentage&&(first=!0,last=!0);const spanStyle={backgroundColor:hexCode,opacity:inFocus?.3:1};let borderRadius="";return first&&(borderRadius="4px 0 0 4px"),last&&(borderRadius="0 4px 4px 0"),first&&last&&(borderRadius="4px"),spanStyle.borderRadius=borderRadius,spanStyle})(position,inFocus,hexCode,percentage);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{key:hexCode,grow:!1,style:{width:percentage+"%"}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{content:tooltip},external_kbnSharedDeps_React_default.a.createElement(ColoredSpan,{style:spanStyle})))}function getCoreVitalTooltipMessage(thresholds,position,title,percentage,isCls){const good=0===position,bad=2===position,average=!good&&!bad;return external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.observability.ux.dashboard.webVitals.palette.tooltip",{defaultMessage:"{percentage} % of users have {exp} experience because the {title} {isOrTakes} {moreOrLess} than {value}{averageMessage}.",values:{percentage:percentage,isOrTakes:isCls?IS_LABEL:TAKES_LABEL,title:null==title?void 0:title.toLowerCase(),exp:good?CV_GOOD_LABEL:bad?CV_POOR_LABEL:CV_AVERAGE_LABEL,moreOrLess:bad||average?MORE_LABEL:LESS_LABEL,value:good||average?thresholds.good:thresholds.bad,averageMessage:average?external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.observability.ux.coreVitals.averageMessage",{defaultMessage:" and less than {bad}",values:{bad:thresholds.bad}}):""}})}function CoreVitalItem({loading:loading,title:title,value:value,thresholds:thresholds,ranks:ranks=[100,0,0],isCls:isCls,helpLabel:helpLabel}){const palette=Object(external_kbnSharedDeps_ElasticEui_.euiPaletteForStatus)(3),[inFocusInd,setInFocusInd]=Object(external_kbnSharedDeps_React_.useState)(null),biggestValIndex=ranks.indexOf(Math.max(...ranks));return value||loading?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiStat,{"aria-label":`${title} ${value}`,titleSize:"s",title:null!=value?value:"",description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,title,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIconTip,{content:helpLabel,type:"questionInCircle"})),titleColor:palette[biggestValIndex],isLoading:loading}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"none",alignItems:"flexStart",style:{maxWidth:350},responsive:!1},palette.map((hexCode,ind)=>external_kbnSharedDeps_React_default.a.createElement(ColorPaletteFlexItem,{hexCode:hexCode,key:hexCode,position:ind,inFocus:inFocusInd!==ind&&null!==inFocusInd,percentage:ranks[ind],tooltip:getCoreVitalTooltipMessage(thresholds,ind,title,ranks[ind],isCls)}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(PaletteLegends,{ranks:ranks,thresholds:thresholds,title:title,onItemHover:ind=>{setInFocusInd(ind)},isCls:isCls})):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCard,{title:title,isDisabled:!0,description:NO_DATA})}const CORE_WEB_VITALS=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.observability.ux.coreWebVitals",{defaultMessage:"Core web vitals"}),BROWSER_CORE_WEB_VITALS=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.observability.ux.coreWebVitals.browser.support",{defaultMessage:"browser support for core web vitals"});function WebCoreVitalsTitle({loading:loading,coreVitalPages:coreVitalPages,totalPageViews:totalPageViews=0,displayTrafficMetric:displayTrafficMetric}){const[isPopoverOpen,setIsPopoverOpen]=Object(external_kbnSharedDeps_React_.useState)(!1),[isBrowserPopoverOpen,setIsBrowserPopoverOpen]=Object(external_kbnSharedDeps_React_.useState)(!1);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"none"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("h3",null,CORE_WEB_VITALS,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopover,{isOpen:isPopoverOpen,button:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{onClick:()=>setIsPopoverOpen(!0),color:"text",iconType:"questionInCircle"}),closePopover:()=>setIsPopoverOpen(!1)},external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.observability.ux.dashboard.webCoreVitals.help",defaultMessage:"Learn more about"})," ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{href:"https://web.dev/vitals/",external:!0,target:"_blank"},CORE_WEB_VITALS))))))),displayTrafficMetric&&totalPageViews>0&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},loading?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingSpinner,null):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.observability.ux.dashboard.webCoreVitals.traffic",defaultMessage:"{trafficPerc} of the traffic represented",values:{trafficPerc:external_kbnSharedDeps_React_default.a.createElement("strong",null," ",((coreVitalPages||0)/totalPageViews*100).toFixed(0),"%")}}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopover,{isOpen:isBrowserPopoverOpen,button:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{onClick:()=>setIsBrowserPopoverOpen(!0),color:"text",iconType:"questionInCircle"}),closePopover:()=>setIsBrowserPopoverOpen(!1)},external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.observability.ux.dashboard.webCoreVitals.browser.help",defaultMessage:"Learn more about"})," ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{href:"https://github.com/GoogleChrome/web-vitals#browser-support",external:!0,target:"_blank"},BROWSER_CORE_WEB_VITALS)))))))}const SERVICE_LABEL=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.observability.ux.coreWebVitals.service",{defaultMessage:"Service"}),SERVICE_LABEL_HELP=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.observability.ux.service.help",{defaultMessage:"The RUM service with the most traffic is selected"});function ServiceName({name:name}){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"s"},SERVICE_LABEL,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIconTip,{color:"text","aria-label":SERVICE_LABEL_HELP,type:"questionInCircle",content:SERVICE_LABEL_HELP})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"s"},external_kbnSharedDeps_React_default.a.createElement("h3",null,name)))}function formatToMilliseconds(value){return null==value?null:function(value,fromUnit="MicroSec"){const valueInMs=Number(null!=value?value:0)/("MicroSec"===fromUnit?1e3:1);return valueInMs<1e3?valueInMs.toFixed(0)+" ms":(valueInMs/1e3).toFixed(2)+" s"}(value,"ms")}const CoreVitalsThresholds={LCP:{good:"2.5s",bad:"4.0s"},FID:{good:"100ms",bad:"300ms"},CLS:{good:"0.1",bad:"0.25"}};function CoreVitals({data:data,loading:loading,displayServiceName:displayServiceName,serviceName:serviceName,totalPageViews:totalPageViews,displayTrafficMetric:displayTrafficMetric=!1}){var _cls$toFixed;const{lcp:lcp,lcpRanks:lcpRanks,fid:fid,fidRanks:fidRanks,cls:cls,clsRanks:clsRanks,coreVitalPages:coreVitalPages}=data||{};return external_kbnSharedDeps_React_.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_.createElement(WebCoreVitalsTitle,{loading:loading,coreVitalPages:coreVitalPages,totalPageViews:totalPageViews,displayTrafficMetric:displayTrafficMetric}),external_kbnSharedDeps_React_.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),displayServiceName&&external_kbnSharedDeps_React_.createElement(ServiceName,{name:serviceName}),external_kbnSharedDeps_React_.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"xl",justifyContent:"spaceBetween",wrap:!0},external_kbnSharedDeps_React_.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{style:{flexBasis:380}},external_kbnSharedDeps_React_.createElement(CoreVitalItem,{title:LCP_LABEL,value:formatToMilliseconds(lcp),ranks:lcpRanks,loading:loading,thresholds:CoreVitalsThresholds.LCP,helpLabel:LCP_HELP_LABEL})),external_kbnSharedDeps_React_.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{style:{flexBasis:380}},external_kbnSharedDeps_React_.createElement(CoreVitalItem,{title:FID_LABEL,value:formatToMilliseconds(fid),ranks:fidRanks,loading:loading,thresholds:CoreVitalsThresholds.FID,helpLabel:FID_HELP_LABEL})),external_kbnSharedDeps_React_.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{style:{flexBasis:380}},external_kbnSharedDeps_React_.createElement(CoreVitalItem,{title:CLS_LABEL,value:null!==(_cls$toFixed=null==cls?void 0:cls.toFixed(3))&&void 0!==_cls$toFixed?_cls$toFixed:null,ranks:clsRanks,loading:loading,thresholds:CoreVitalsThresholds.CLS,isCls:!0,helpLabel:CLS_HELP_LABEL}))))}}}]);