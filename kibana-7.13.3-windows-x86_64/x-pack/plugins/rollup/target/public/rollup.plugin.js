/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */!function(modules){function webpackJsonpCallback(data){for(var moduleId,chunkId,chunkIds=data[0],moreModules=data[1],i=0,resolves=[];i<chunkIds.length;i++)chunkId=chunkIds[i],Object.prototype.hasOwnProperty.call(installedChunks,chunkId)&&installedChunks[chunkId]&&resolves.push(installedChunks[chunkId][0]),installedChunks[chunkId]=0;for(moduleId in moreModules)Object.prototype.hasOwnProperty.call(moreModules,moduleId)&&(modules[moduleId]=moreModules[moduleId]);for(parentJsonpFunction&&parentJsonpFunction(data);resolves.length;)resolves.shift()()}var installedModules={},installedChunks={0:0};function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}__webpack_require__.e=function(chunkId){var promises=[],installedChunkData=installedChunks[chunkId];if(0!==installedChunkData)if(installedChunkData)promises.push(installedChunkData[2]);else{var promise=new Promise((function(resolve,reject){installedChunkData=installedChunks[chunkId]=[resolve,reject]}));promises.push(installedChunkData[2]=promise);var onScriptComplete,script=document.createElement("script");script.charset="utf-8",script.timeout=120,__webpack_require__.nc&&script.setAttribute("nonce",__webpack_require__.nc),script.src=function(chunkId){return __webpack_require__.p+"rollup.chunk."+chunkId+".js"}(chunkId);var error=new Error;onScriptComplete=function(event){script.onerror=script.onload=null,clearTimeout(timeout);var chunk=installedChunks[chunkId];if(0!==chunk){if(chunk){var errorType=event&&("load"===event.type?"missing":event.type),realSrc=event&&event.target&&event.target.src;error.message="Loading chunk "+chunkId+" failed.\n("+errorType+": "+realSrc+")",error.name="ChunkLoadError",error.type=errorType,error.request=realSrc,chunk[1](error)}installedChunks[chunkId]=void 0}};var timeout=setTimeout((function(){onScriptComplete({type:"timeout",target:script})}),12e4);script.onerror=script.onload=onScriptComplete,document.head.appendChild(script)}return Promise.all(promises)},__webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{enumerable:!0,get:getter})},__webpack_require__.r=function(exports){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(exports,"__esModule",{value:!0})},__webpack_require__.t=function(value,mode){if(1&mode&&(value=__webpack_require__(value)),8&mode)return value;if(4&mode&&"object"==typeof value&&value&&value.__esModule)return value;var ns=Object.create(null);if(__webpack_require__.r(ns),Object.defineProperty(ns,"default",{enumerable:!0,value:value}),2&mode&&"string"!=typeof value)for(var key in value)__webpack_require__.d(ns,key,function(key){return value[key]}.bind(null,key));return ns},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function(){return module.default}:function(){return module};return __webpack_require__.d(getter,"a",getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p="",__webpack_require__.oe=function(err){throw console.error(err),err};var jsonpArray=window.rollup_bundle_jsonpfunction=window.rollup_bundle_jsonpfunction||[],oldJsonpFunction=jsonpArray.push.bind(jsonpArray);jsonpArray.push=webpackJsonpCallback,jsonpArray=jsonpArray.slice();for(var i=0;i<jsonpArray.length;i++)webpackJsonpCallback(jsonpArray[i]);var parentJsonpFunction=oldJsonpFunction;__webpack_require__(__webpack_require__.s=12)}([function(module,exports){module.exports=__kbnSharedDeps__.KbnI18n},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return getNotifications})),__webpack_require__.d(__webpack_exports__,"d",(function(){return setNotifications})),__webpack_require__.d(__webpack_exports__,"a",(function(){return getFatalErrors})),__webpack_require__.d(__webpack_exports__,"c",(function(){return setFatalErrors})),__webpack_require__.d(__webpack_exports__,"e",(function(){return setUiStatsReporter})),__webpack_require__.d(__webpack_exports__,"f",(function(){return trackUiMetric}));var _src_plugins_kibana_utils_common__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(10);let notifications=null,fatalErrors=null;function getNotifications(){if(!notifications)throw new Error("Rollup notifications is not defined");return notifications}function setNotifications(newNotifications){notifications=newNotifications}function getFatalErrors(){if(!fatalErrors)throw new Error("Rollup fatalErrors is not defined");return fatalErrors}function setFatalErrors(newFatalErrors){fatalErrors=newFatalErrors}const[getUiStatsReporter,setUiStatsReporter]=Object(_src_plugins_kibana_utils_common__WEBPACK_IMPORTED_MODULE_0__.createGetterSetter)("uiMetric");function trackUiMetric(type,eventNames,count){getUiStatsReporter()(type,eventNames,count)}setUiStatsReporter(()=>{})},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return CONFIG_ROLLUPS})),__webpack_require__.d(__webpack_exports__,"c",(function(){return UIM_APP_NAME})),__webpack_require__.d(__webpack_exports__,"b",(function(){return UIM_APP_LOAD})),__webpack_require__.d(__webpack_exports__,"i",(function(){return UIM_JOB_CREATE})),__webpack_require__.d(__webpack_exports__,"j",(function(){return UIM_JOB_DELETE})),__webpack_require__.d(__webpack_exports__,"k",(function(){return UIM_JOB_DELETE_MANY})),__webpack_require__.d(__webpack_exports__,"l",(function(){return UIM_JOB_START})),__webpack_require__.d(__webpack_exports__,"m",(function(){return UIM_JOB_START_MANY})),__webpack_require__.d(__webpack_exports__,"n",(function(){return UIM_JOB_STOP})),__webpack_require__.d(__webpack_exports__,"o",(function(){return UIM_JOB_STOP_MANY})),__webpack_require__.d(__webpack_exports__,"p",(function(){return UIM_SHOW_DETAILS_CLICK})),__webpack_require__.d(__webpack_exports__,"g",(function(){return UIM_DETAIL_PANEL_SUMMARY_TAB_CLICK})),__webpack_require__.d(__webpack_exports__,"h",(function(){return UIM_DETAIL_PANEL_TERMS_TAB_CLICK})),__webpack_require__.d(__webpack_exports__,"d",(function(){return UIM_DETAIL_PANEL_HISTOGRAM_TAB_CLICK})),__webpack_require__.d(__webpack_exports__,"f",(function(){return UIM_DETAIL_PANEL_METRICS_TAB_CLICK})),__webpack_require__.d(__webpack_exports__,"e",(function(){return UIM_DETAIL_PANEL_JSON_TAB_CLICK}));const UIM_APP_NAME="rollup_jobs",UIM_APP_LOAD="app_load",UIM_JOB_CREATE="job_create",UIM_JOB_DELETE="job_delete",UIM_JOB_DELETE_MANY="job_delete_many",UIM_JOB_START="job_start",UIM_JOB_START_MANY="job_start_many",UIM_JOB_STOP="job_stop",UIM_JOB_STOP_MANY="job_stop_many",UIM_SHOW_DETAILS_CLICK="show_details_click",UIM_DETAIL_PANEL_SUMMARY_TAB_CLICK="detail_panel_summary_tab_click",UIM_DETAIL_PANEL_TERMS_TAB_CLICK="detail_panel_terms_tab_click",UIM_DETAIL_PANEL_HISTOGRAM_TAB_CLICK="detail_panel_histogram_tab_click",UIM_DETAIL_PANEL_METRICS_TAB_CLICK="detail_panel_metrics_tab_click",UIM_DETAIL_PANEL_JSON_TAB_CLICK="detail_panel_json_tab_click",CONFIG_ROLLUPS="rollups:enableIndexPatterns"},function(module,exports){module.exports=__kbnSharedDeps__.React},function(module,exports){module.exports=__kbnSharedDeps__.Lodash},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/indexPatternManagement/public");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"c",(function(){return createJob})),__webpack_require__.d(__webpack_exports__,"e",(function(){return deleteJobs})),__webpack_require__.d(__webpack_exports__,"v",(function(){return loadJobs})),__webpack_require__.d(__webpack_exports__,"F",(function(){return startJobs})),__webpack_require__.d(__webpack_exports__,"G",(function(){return stopJobs})),__webpack_require__.d(__webpack_exports__,"H",(function(){return validateIndexPattern})),__webpack_require__.d(__webpack_exports__,"C",(function(){return showApiError})),__webpack_require__.d(__webpack_exports__,"D",(function(){return showApiWarning})),__webpack_require__.d(__webpack_exports__,"u",(function(){return listBreadcrumb})),__webpack_require__.d(__webpack_exports__,"b",(function(){return createBreadcrumb})),__webpack_require__.d(__webpack_exports__,"z",(function(){return setEsBaseAndXPackBase})),__webpack_require__.d(__webpack_exports__,"o",(function(){return getLogisticalDetailsUrl})),__webpack_require__.d(__webpack_exports__,"m",(function(){return getDateHistogramDetailsUrl})),__webpack_require__.d(__webpack_exports__,"l",(function(){return getDateHistogramAggregationUrl})),__webpack_require__.d(__webpack_exports__,"s",(function(){return getTermsDetailsUrl})),__webpack_require__.d(__webpack_exports__,"n",(function(){return getHistogramDetailsUrl})),__webpack_require__.d(__webpack_exports__,"p",(function(){return getMetricsDetailsUrl})),__webpack_require__.d(__webpack_exports__,"k",(function(){return getCronUrl})),__webpack_require__.d(__webpack_exports__,"h",(function(){return filterItems})),__webpack_require__.d(__webpack_exports__,"i",(function(){return flattenPanelTree})),__webpack_require__.d(__webpack_exports__,"j",(function(){return formatFields})),__webpack_require__.d(__webpack_exports__,"A",(function(){return setHttp})),__webpack_require__.d(__webpack_exports__,"y",(function(){return serializeJob})),__webpack_require__.d(__webpack_exports__,"f",(function(){return deserializeJob})),__webpack_require__.d(__webpack_exports__,"g",(function(){return deserializeJobs})),__webpack_require__.d(__webpack_exports__,"d",(function(){return createNoticeableDelay})),__webpack_require__.d(__webpack_exports__,"B",(function(){return setUserHasLeftApp})),__webpack_require__.d(__webpack_exports__,"t",(function(){return getUserHasLeftApp})),__webpack_require__.d(__webpack_exports__,"w",(function(){return registerRouter})),__webpack_require__.d(__webpack_exports__,"q",(function(){return getRouter})),__webpack_require__.d(__webpack_exports__,"r",(function(){return getRouterLinkProps})),__webpack_require__.d(__webpack_exports__,"E",(function(){return sortTable})),__webpack_require__.d(__webpack_exports__,"x",(function(){return retypeMetrics})),__webpack_require__.d(__webpack_exports__,"a",(function(){return external_kbnSharedDeps_KbnAnalytics_.METRIC_TYPE}));var common=__webpack_require__(2);let _http=null;function setHttp(http){_http=http}function getHttp(){if(!_http)throw new Error("Rollup http is not defined");return _http}var external_kbnSharedDeps_KbnAnalytics_=__webpack_require__(7),kibana_services=__webpack_require__(1);function trackUserRequest(request,actionType){return request.then(response=>(Object(kibana_services.f)(external_kbnSharedDeps_KbnAnalytics_.METRIC_TYPE.LOADED,actionType),response))}async function loadJobs({asSystemRequest:asSystemRequest}={}){const fetchOptions={asSystemRequest:asSystemRequest},{jobs:jobs}=await getHttp().get("/api/rollup/jobs",fetchOptions);return jobs}async function startJobs(jobIds){const body={jobIds:jobIds},request=getHttp().post("/api/rollup/start",{body:JSON.stringify(body)}),actionType=jobIds.length>1?common.m:common.l;return await trackUserRequest(request,actionType)}async function stopJobs(jobIds){const body={jobIds:jobIds},request=getHttp().post("/api/rollup/stop",{body:JSON.stringify(body)}),actionType=jobIds.length>1?common.o:common.n;return await trackUserRequest(request,actionType)}async function deleteJobs(jobIds){const body={jobIds:jobIds},request=getHttp().post("/api/rollup/delete",{body:JSON.stringify(body)}),actionType=jobIds.length>1?common.k:common.j;return await trackUserRequest(request,actionType)}async function createJob(job){const body={job:job},request=getHttp().put("/api/rollup/create",{body:JSON.stringify(body)});return await trackUserRequest(request,common.i)}async function validateIndexPattern(indexPattern){return await getHttp().get("/api/rollup/index_pattern_validity/"+indexPattern)}function createToastConfig(error,errorTitle){if(error&&error.body){const{error:errorString,statusCode:statusCode,message:message}=error.body;return{title:errorTitle,text:`${statusCode}: ${errorString}. ${message}`}}}function showApiWarning(error,errorTitle){const toastConfig=createToastConfig(error,errorTitle);return toastConfig?Object(kibana_services.b)().toasts.addWarning(toastConfig):Object(kibana_services.a)().add(error,errorTitle)}function showApiError(error,errorTitle){const toastConfig=createToastConfig(error,errorTitle);if(toastConfig)return Object(kibana_services.b)().toasts.addDanger(toastConfig);Object(kibana_services.a)().add(error,errorTitle)}var external_kbnSharedDeps_KbnI18n_=__webpack_require__(0);const listBreadcrumb={text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.rollupJobs.listBreadcrumbTitle",{defaultMessage:"Rollups Jobs"}),href:"/"},createBreadcrumb={text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.rollupJobs.createBreadcrumbTitle",{defaultMessage:"Create"})};let esBase="";function setEsBaseAndXPackBase(elasticWebsiteUrl,docLinksVersion){esBase=`${elasticWebsiteUrl}guide/en/elasticsearch/reference/${docLinksVersion}`}const getLogisticalDetailsUrl=()=>esBase+"/rollup-job-config.html#_logistical_details",getDateHistogramDetailsUrl=()=>esBase+"/rollup-job-config.html#_date_histogram_2",getTermsDetailsUrl=()=>esBase+"/rollup-job-config.html#_terms_2",getHistogramDetailsUrl=()=>esBase+"/rollup-job-config.html#_histogram_2",getMetricsDetailsUrl=()=>esBase+"/rollup-job-config.html#rollup-metrics-config",getDateHistogramAggregationUrl=()=>esBase+"/search-aggregations-bucket-datehistogram-aggregation.html",getCronUrl=()=>esBase+"/trigger-schedule.html#_cron_expressions",filterItems=(fields,filter="",items=[])=>{const normalizedFilter=filter.toLowerCase();return items.filter(item=>-1!==(fields||Object.keys(item)).findIndex(field=>String(item[field]).toLowerCase().includes(normalizedFilter)))},flattenPanelTree=(tree,array=[])=>(array.push(tree),tree.items&&tree.items.forEach(item=>{item.panel&&(flattenPanelTree(item.panel,array),item.panel=item.panel.id)}),array);function formatFields(fieldNames,type){return fieldNames.map(fieldName=>({name:fieldName,type:type}))}function serializeJob(jobConfig){const{id:id,indexPattern:indexPattern,rollupIndex:rollupIndex,rollupCron:rollupCron,dateHistogramInterval:dateHistogramInterval,rollupDelay:rollupDelay,rollupPageSize:rollupPageSize,dateHistogramTimeZone:dateHistogramTimeZone,dateHistogramField:dateHistogramField,metrics:metrics,terms:terms,histogram:histogram,histogramInterval:histogramInterval}=jobConfig,serializedJob={id:id,index_pattern:indexPattern,rollup_index:rollupIndex,cron:rollupCron,page_size:rollupPageSize,groups:{date_histogram:(object={interval:dateHistogramInterval,delay:rollupDelay,time_zone:dateHistogramTimeZone,field:dateHistogramField},Object.keys(object).forEach(key=>{null!=object[key]&&""!==object[key].trim()||delete object[key]}),object)}};var object;return terms.length&&(serializedJob.groups.terms={fields:terms.map(({name:name})=>name)}),histogram.length&&(serializedJob.groups.histogram={interval:histogramInterval,fields:histogram.map(({name:name})=>name)}),metrics.length&&(serializedJob.metrics=[],metrics.forEach(({name:name,types:types})=>{types.length&&serializedJob.metrics.push({field:name,metrics:types})})),serializedJob}function deserializeJob(job){const{config:{id:id,index_pattern:indexPattern,rollup_index:rollupIndex,cron:rollupCron,metrics:metrics,groups:{date_histogram:{interval:interval,fixed_interval:fixedInterval,calendar_interval:calendarInterval,delay:rollupDelay,time_zone:dateHistogramTimeZone,field:dateHistogramField},terms:terms,histogram:histogram}},status:{job_state:status},stats:{documents_processed:documentsProcessed,pages_processed:pagesProcessed,rollups_indexed:rollupsIndexed,trigger_count:triggerCount}}=job,deserializedJob={id:id,indexPattern:indexPattern,rollupIndex:rollupIndex,rollupCron:rollupCron,dateHistogramInterval:interval||fixedInterval||calendarInterval,rollupDelay:rollupDelay,dateHistogramTimeZone:dateHistogramTimeZone,dateHistogramField:dateHistogramField,status:status,metrics:[],terms:[],histogram:[],documentsProcessed:documentsProcessed,pagesProcessed:pagesProcessed,rollupsIndexed:rollupsIndexed,triggerCount:triggerCount,json:job};return metrics&&metrics.forEach(({field:field,metrics:metrics})=>{deserializedJob.metrics.push({name:field,types:metrics})}),terms&&(deserializedJob.terms=terms.fields.map(name=>({name:name}))),histogram&&(deserializedJob.histogram=histogram.fields.map(name=>({name:name})),deserializedJob.histogramInterval=histogram.interval),deserializedJob}function deserializeJobs(jobs=[]){return jobs.map(deserializeJob)}function createNoticeableDelay(promise){const noticeableDelay=new Promise(resolve=>setTimeout(()=>{resolve()},300));return Promise.all([promise,noticeableDelay])}var node_modules_history=__webpack_require__(11);let _userHasLeftApp=!1;function setUserHasLeftApp(userHasLeftApp){_userHasLeftApp=userHasLeftApp}function getUserHasLeftApp(){return _userHasLeftApp}let router;function registerRouter(reactRouter){router=reactRouter}function getRouter(){return router}function getRouterLinkProps(to){const location="string"==typeof to?Object(node_modules_history.createLocation)(to,null,null,router.history.location):to;return{href:router.history.createHref(location),onClick:event=>{event.defaultPrevented||event.target.getAttribute("target")||!(event=>!!(event.metaKey||event.altKey||event.ctrlKey||event.shiftKey))(event)&&(event=>0===event.button)(event)&&(event.preventDefault(),router.history.push(location))}}}var external_kbnSharedDeps_Lodash_=__webpack_require__(4);const sorters={},sortTable=(array=[],sortField,isSortAscending)=>{const sorter=sorters[sortField]||(fieldName=sortField,item=>item[fieldName]);var fieldName;const sorted=Object(external_kbnSharedDeps_Lodash_.sortBy)(array,sorter);return isSortAscending?sorted:sorted.reverse()};function retypeMetrics({metrics:metrics,typeMaps:typeMaps}){return metrics.map(metric=>{const{name:metricName}=metric,{type:type}=typeMaps.find(type=>type.fields.some(field=>field.name===metricName));return{...metric,type:type}})}},function(module,exports){module.exports=__kbnSharedDeps__.KbnAnalytics},function(module,exports){module.exports=__kbnSharedDeps__.ElasticEui},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/home/public");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/kibanaUtils/common");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,exports,__webpack_require__){"use strict";module.exports=__webpack_require__(14)},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__(13);__kbnBundles__.define("plugin/rollup/public",__webpack_require__,19)},function(module,exports,__webpack_require__){__webpack_require__.p=window.__kbnPublicPath__.rollup},function(module,exports,__webpack_require__){"use strict";function _interopDefault(n){return n&&"object"==typeof n&&"default"in n?n.default:n}Object.defineProperty(exports,"__esModule",{value:!0});var resolvePathname=_interopDefault(__webpack_require__(15)),valueEqual=_interopDefault(__webpack_require__(16));__webpack_require__(17);var invariant=_interopDefault(__webpack_require__(18));function _extends(){return(_extends=Object.assign||function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[a]=e[a])}return n}).apply(this,arguments)}function addLeadingSlash(n){return"/"===n.charAt(0)?n:"/"+n}function stripLeadingSlash(n){return"/"===n.charAt(0)?n.substr(1):n}function stripBasename(n,t){return function(n,t){return new RegExp("^"+t+"(\\/|\\?|#|$)","i").test(n)}(n,t)?n.substr(t.length):n}function stripTrailingSlash(n){return"/"===n.charAt(n.length-1)?n.slice(0,-1):n}function parsePath(n){var t=n||"/",e="",a="",o=t.indexOf("#");-1!==o&&(a=t.substr(o),t=t.substr(0,o));var r=t.indexOf("?");return-1!==r&&(e=t.substr(r),t=t.substr(0,r)),{pathname:t,search:"?"===e?"":e,hash:"#"===a?"":a}}function createPath(n){var t=n.pathname,e=n.search,a=n.hash,o=t||"/";return e&&"?"!==e&&(o+="?"===e.charAt(0)?e:"?"+e),a&&"#"!==a&&(o+="#"===a.charAt(0)?a:"#"+a),o}function createLocation(n,t,e,a){var o;"string"==typeof n?(o=parsePath(n)).state=t:(void 0===(o=_extends({},n)).pathname&&(o.pathname=""),o.search?"?"!==o.search.charAt(0)&&(o.search="?"+o.search):o.search="",o.hash?"#"!==o.hash.charAt(0)&&(o.hash="#"+o.hash):o.hash="",void 0!==t&&void 0===o.state&&(o.state=t));try{o.pathname=decodeURI(o.pathname)}catch(n){throw n instanceof URIError?new URIError('Pathname "'+o.pathname+'" could not be decoded. This is likely caused by an invalid percent-encoding.'):n}return e&&(o.key=e),a?o.pathname?"/"!==o.pathname.charAt(0)&&(o.pathname=resolvePathname(o.pathname,a.pathname)):o.pathname=a.pathname:o.pathname||(o.pathname="/"),o}function locationsAreEqual(n,t){return n.pathname===t.pathname&&n.search===t.search&&n.hash===t.hash&&n.key===t.key&&valueEqual(n.state,t.state)}function createTransitionManager(){var r=null,a=[];return{setPrompt:function(n){return r=n,function(){r===n&&(r=null)}},confirmTransitionTo:function(n,t,e,a){if(null!=r){var o="function"==typeof r?r(n,t):r;"string"==typeof o?"function"==typeof e?e(o,a):a(!0):a(!1!==o)}else a(!0)},appendListener:function(n){var t=!0;function e(){t&&n.apply(void 0,arguments)}return a.push(e),function(){t=!1,a=a.filter((function(n){return n!==e}))}},notifyListeners:function(){for(var n=arguments.length,t=new Array(n),e=0;e<n;e++)t[e]=arguments[e];a.forEach((function(n){return n.apply(void 0,t)}))}}}var canUseDOM=!("undefined"==typeof window||!window.document||!window.document.createElement);function getConfirmation(n,t){t(window.confirm(n))}function getHistoryState(){try{return window.history.state||{}}catch(n){return{}}}var HashPathCoders={hashbang:{encodePath:function(n){return"!"===n.charAt(0)?n:"!/"+stripLeadingSlash(n)},decodePath:function(n){return"!"===n.charAt(0)?n.substr(1):n}},noslash:{encodePath:stripLeadingSlash,decodePath:addLeadingSlash},slash:{encodePath:addLeadingSlash,decodePath:addLeadingSlash}};function getHashPath(){var n=window.location.href,t=n.indexOf("#");return-1===t?"":n.substring(t+1)}function replaceHashPath(n){var t=window.location.href.indexOf("#");window.location.replace(window.location.href.slice(0,0<=t?t:0)+"#"+n)}function clamp(n,t,e){return Math.min(Math.max(n,t),e)}exports.createBrowserHistory=function(n){void 0===n&&(n={}),canUseDOM||invariant(!1);var c=window.history,s=function(){var n=window.navigator.userAgent;return(-1===n.indexOf("Android 2.")&&-1===n.indexOf("Android 4.0")||-1===n.indexOf("Mobile Safari")||-1!==n.indexOf("Chrome")||-1!==n.indexOf("Windows Phone"))&&window.history&&"pushState"in window.history}(),t=!(-1===window.navigator.userAgent.indexOf("Trident")),e=n,a=e.forceRefresh,h=void 0!==a&&a,o=e.getUserConfirmation,u=void 0===o?getConfirmation:o,r=e.keyLength,i=void 0===r?6:r,f=n.basename?stripTrailingSlash(addLeadingSlash(n.basename)):"";function l(n){var t=n||{},e=t.key,a=t.state,o=window.location,r=o.pathname+o.search+o.hash;return f&&(r=stripBasename(r,f)),createLocation(r,a,e)}function d(){return Math.random().toString(36).substr(2,i)}var v=createTransitionManager();function p(n){_extends(T,n),T.length=c.length,v.notifyListeners(T.location,T.action)}function g(n){(function(n){void 0===n.state&&navigator.userAgent.indexOf("CriOS")})(n)||w(l(n.state))}function P(){w(l(getHistoryState()))}var m=!1;function w(t){m?(m=!1,p()):v.confirmTransitionTo(t,"POP",u,(function(n){n?p({action:"POP",location:t}):function(n){var t=T.location,e=H.indexOf(t.key);-1===e&&(e=0);var a=H.indexOf(n.key);-1===a&&(a=0);var o=e-a;o&&(m=!0,L(o))}(t)}))}var y=l(getHistoryState()),H=[y.key];function x(n){return f+createPath(n)}function L(n){c.go(n)}var O=0;function E(n){1===(O+=n)&&1===n?(window.addEventListener("popstate",g),t&&window.addEventListener("hashchange",P)):0===O&&(window.removeEventListener("popstate",g),t&&window.removeEventListener("hashchange",P))}var S=!1,T={length:c.length,action:"POP",location:y,createHref:x,push:function(n,t){var i=createLocation(n,t,d(),T.location);v.confirmTransitionTo(i,"PUSH",u,(function(n){if(n){var t=x(i),e=i.key,a=i.state;if(s)if(c.pushState({key:e,state:a},null,t),h)window.location.href=t;else{var o=H.indexOf(T.location.key),r=H.slice(0,-1===o?0:o+1);r.push(i.key),H=r,p({action:"PUSH",location:i})}else window.location.href=t}}))},replace:function(n,t){var r="REPLACE",i=createLocation(n,t,d(),T.location);v.confirmTransitionTo(i,r,u,(function(n){if(n){var t=x(i),e=i.key,a=i.state;if(s)if(c.replaceState({key:e,state:a},null,t),h)window.location.replace(t);else{var o=H.indexOf(T.location.key);-1!==o&&(H[o]=i.key),p({action:r,location:i})}else window.location.replace(t)}}))},go:L,goBack:function(){L(-1)},goForward:function(){L(1)},block:function(n){void 0===n&&(n=!1);var t=v.setPrompt(n);return S||(E(1),S=!0),function(){return S&&(S=!1,E(-1)),t()}},listen:function(n){var t=v.appendListener(n);return E(1),function(){E(-1),t()}}};return T},exports.createHashHistory=function(n){void 0===n&&(n={}),canUseDOM||invariant(!1);var t=window.history,e=(window.navigator.userAgent.indexOf("Firefox"),n),a=e.getUserConfirmation,i=void 0===a?getConfirmation:a,o=e.hashType,r=void 0===o?"slash":o,c=n.basename?stripTrailingSlash(addLeadingSlash(n.basename)):"",s=HashPathCoders[r],h=s.encodePath,u=s.decodePath;function f(){var n=u(getHashPath());return c&&(n=stripBasename(n,c)),createLocation(n)}var l=createTransitionManager();function d(n){_extends(E,n),E.length=t.length,l.notifyListeners(E.location,E.action)}var v=!1,p=null;function g(){var n=getHashPath(),t=h(n);if(n!==t)replaceHashPath(t);else{var e=f(),a=E.location;if(!v&&locationsAreEqual(a,e))return;if(p===createPath(e))return;p=null,function(t){v?(v=!1,d()):l.confirmTransitionTo(t,"POP",i,(function(n){n?d({action:"POP",location:t}):function(n){var t=E.location,e=y.lastIndexOf(createPath(t));-1===e&&(e=0);var a=y.lastIndexOf(createPath(n));-1===a&&(a=0);var o=e-a;o&&(v=!0,H(o))}(t)}))}(e)}}var P=getHashPath(),m=h(P);P!==m&&replaceHashPath(m);var w=f(),y=[createPath(w)];function H(n){t.go(n)}var x=0;function L(n){1===(x+=n)&&1===n?window.addEventListener("hashchange",g):0===x&&window.removeEventListener("hashchange",g)}var O=!1,E={length:t.length,action:"POP",location:w,createHref:function(n){return"#"+h(c+createPath(n))},push:function(n,t){var r=createLocation(n,void 0,void 0,E.location);l.confirmTransitionTo(r,"PUSH",i,(function(n){if(n){var t=createPath(r),e=h(c+t);if(getHashPath()!==e){p=t,function(n){window.location.hash=n}(e);var a=y.lastIndexOf(createPath(E.location)),o=y.slice(0,-1===a?0:a+1);o.push(t),y=o,d({action:"PUSH",location:r})}else d()}}))},replace:function(n,t){var o="REPLACE",r=createLocation(n,void 0,void 0,E.location);l.confirmTransitionTo(r,o,i,(function(n){if(n){var t=createPath(r),e=h(c+t);getHashPath()!==e&&(p=t,replaceHashPath(e));var a=y.indexOf(createPath(E.location));-1!==a&&(y[a]=t),d({action:o,location:r})}}))},go:H,goBack:function(){H(-1)},goForward:function(){H(1)},block:function(n){void 0===n&&(n=!1);var t=l.setPrompt(n);return O||(L(1),O=!0),function(){return O&&(O=!1,L(-1)),t()}},listen:function(n){var t=l.appendListener(n);return L(1),function(){L(-1),t()}}};return E},exports.createMemoryHistory=function(n){void 0===n&&(n={});var t=n,o=t.getUserConfirmation,e=t.initialEntries,a=void 0===e?["/"]:e,r=t.initialIndex,i=void 0===r?0:r,c=t.keyLength,s=void 0===c?6:c,h=createTransitionManager();function u(n){_extends(g,n),g.length=g.entries.length,h.notifyListeners(g.location,g.action)}function f(){return Math.random().toString(36).substr(2,s)}var l=clamp(i,0,a.length-1),d=a.map((function(n){return createLocation(n,void 0,"string"==typeof n?f():n.key||f())})),v=createPath;function p(n){var t=clamp(g.index+n,0,g.entries.length-1),e=g.entries[t];h.confirmTransitionTo(e,"POP",o,(function(n){n?u({action:"POP",location:e,index:t}):u()}))}var g={length:d.length,action:"POP",location:d[l],index:l,entries:d,createHref:v,push:function(n,t){var a=createLocation(n,t,f(),g.location);h.confirmTransitionTo(a,"PUSH",o,(function(n){if(n){var t=g.index+1,e=g.entries.slice(0);e.length>t?e.splice(t,e.length-t,a):e.push(a),u({action:"PUSH",location:a,index:t,entries:e})}}))},replace:function(n,t){var e="REPLACE",a=createLocation(n,t,f(),g.location);h.confirmTransitionTo(a,e,o,(function(n){n&&(g.entries[g.index]=a,u({action:e,location:a}))}))},go:p,goBack:function(){p(-1)},goForward:function(){p(1)},canGo:function(n){var t=g.index+n;return 0<=t&&t<g.entries.length},block:function(n){return void 0===n&&(n=!1),h.setPrompt(n)},listen:function(n){return h.appendListener(n)}};return g},exports.createLocation=createLocation,exports.locationsAreEqual=locationsAreEqual,exports.parsePath=parsePath,exports.createPath=createPath},function(module,exports,__webpack_require__){"use strict";function isAbsolute(pathname){return"/"===pathname.charAt(0)}function spliceOne(list,index){for(var i=index,k=i+1,n=list.length;k<n;i+=1,k+=1)list[i]=list[k];list.pop()}exports.__esModule=!0,exports.default=function(to){var from=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",toParts=to&&to.split("/")||[],fromParts=from&&from.split("/")||[],isToAbs=to&&isAbsolute(to),isFromAbs=from&&isAbsolute(from),mustEndAbs=isToAbs||isFromAbs;if(to&&isAbsolute(to)?fromParts=toParts:toParts.length&&(fromParts.pop(),fromParts=fromParts.concat(toParts)),!fromParts.length)return"/";var hasTrailingSlash=void 0;if(fromParts.length){var last=fromParts[fromParts.length-1];hasTrailingSlash="."===last||".."===last||""===last}else hasTrailingSlash=!1;for(var up=0,i=fromParts.length;i>=0;i--){var part=fromParts[i];"."===part?spliceOne(fromParts,i):".."===part?(spliceOne(fromParts,i),up++):up&&(spliceOne(fromParts,i),up--)}if(!mustEndAbs)for(;up--;up)fromParts.unshift("..");!mustEndAbs||""===fromParts[0]||fromParts[0]&&isAbsolute(fromParts[0])||fromParts.unshift("");var result=fromParts.join("/");return hasTrailingSlash&&"/"!==result.substr(-1)&&(result+="/"),result},module.exports=exports.default},function(module,exports,__webpack_require__){"use strict";exports.__esModule=!0;var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};exports.default=function valueEqual(a,b){if(a===b)return!0;if(null==a||null==b)return!1;if(Array.isArray(a))return Array.isArray(b)&&a.length===b.length&&a.every((function(item,index){return valueEqual(item,b[index])}));var aType=void 0===a?"undefined":_typeof(a);if(aType!==(void 0===b?"undefined":_typeof(b)))return!1;if("object"===aType){var aValue=a.valueOf(),bValue=b.valueOf();if(aValue!==a||bValue!==b)return valueEqual(aValue,bValue);var aKeys=Object.keys(a),bKeys=Object.keys(b);return aKeys.length===bKeys.length&&aKeys.every((function(key){return valueEqual(a[key],b[key])}))}return!1},module.exports=exports.default},function(module,exports,__webpack_require__){"use strict";module.exports=function(condition,message){}},function(module,exports,__webpack_require__){"use strict";module.exports=function(condition,message){if(!condition)throw new Error("Invariant failed")}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"plugin",(function(){return public_plugin}));var external_kbnSharedDeps_KbnI18n_=__webpack_require__(0),external_kbnSharedDeps_Lodash_=__webpack_require__(4);const rollupToggleExtension={matchIndex:index=>Object(external_kbnSharedDeps_Lodash_.get)(index,"isRollupIndex"),label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.rollupJobs.indexMgmtToggle.toggleLabel",{defaultMessage:"Include rollup indices"}),name:"rollupToggle"},rollupBadgeExtension={matchIndex:index=>Object(external_kbnSharedDeps_Lodash_.get)(index,"isRollupIndex"),label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.rollupJobs.indexMgmtBadge.rollupLabel",{defaultMessage:"Rollup"}),color:"secondary",filterExpression:"isRollupIndex:true"};var external_kbnSharedDeps_React_=__webpack_require__(3),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),external_kbnSharedDeps_ElasticEui_=__webpack_require__(8);const RollupPrompt=()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{color:"warning",iconType:"help",title:"Beta feature"},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.rollupJobs.editRollupIndexPattern.rollupPrompt.betaCalloutParagraph1Text",{defaultMessage:"Kibana's support for rollup index patterns is in beta. You might encounter issues using these patterns in saved searches, visualizations, and dashboards. They are not supported in some advanced features, such as Timelion, and Machine Learning."})),external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.rollupJobs.editRollupIndexPattern.rollupPrompt.betaCalloutParagraph2Text",{defaultMessage:"You can match a rollup index pattern against one rollup index and zero or more regular indices. A rollup index pattern has limited metrics, fields, intervals, and aggregations. A rollup index is limited to indices that have one job configuration, or multiple jobs with compatible configurations."})));var public_=__webpack_require__(5);function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}const rollupIndexPatternTypeName=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.rollupJobs.editRollupIndexPattern.createIndex.defaultTypeName",{defaultMessage:"rollup index pattern"}),rollupIndexPatternButtonText=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.rollupJobs.editRollupIndexPattern.createIndex.defaultButtonText",{defaultMessage:"Rollup index pattern"}),rollupIndexPatternButtonDescription=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.rollupJobs.editRollupIndexPattern.createIndex.defaultButtonDescription",{defaultMessage:"Perform limited aggregations against summarized data"}),rollupIndexPatternNoMatchError=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.rollupJobs.editRollupIndexPattern.createIndex.noMatchError",{defaultMessage:"Rollup index pattern error: must match one rollup index"}),rollupIndexPatternTooManyMatchesError=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.rollupJobs.editRollupIndexPattern.createIndex.tooManyMatchesError",{defaultMessage:"Rollup index pattern error: can only match one rollup index"}),rollupIndexPatternIndexLabel=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.rollupJobs.editRollupIndexPattern.createIndex.indexLabel",{defaultMessage:"Rollup"});class rollup_index_pattern_creation_config_RollupIndexPatternCreationConfig extends public_.IndexPatternCreationConfig{constructor(options){super({type:"rollup",name:rollupIndexPatternTypeName,showSystemIndices:!1,isBeta:!0,...options}),_defineProperty(this,"key","rollup"),_defineProperty(this,"isRollupIndex",indexName=>this.rollupIndices.includes(indexName)),_defineProperty(this,"checkIndicesForErrors",indices=>{if(this.rollupIndex=null,!indices||!indices.length)return;const rollupIndices=indices.filter(index=>this.isRollupIndex(index.name));if(!rollupIndices.length)return[rollupIndexPatternNoMatchError];if(rollupIndices.length>1)return[rollupIndexPatternTooManyMatchesError];const rollupIndexName=rollupIndices[0].name,error=this.rollupIndicesCapabilities[rollupIndexName].error;if(error){return[external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.rollupJobs.editRollupIndexPattern.createIndex.uncaughtError",{defaultMessage:"Rollup index pattern error: {error}",values:{error:error}})]}this.rollupIndex=rollupIndexName}),_defineProperty(this,"getIndexPatternMappings",()=>this.rollupIndex?{type:this.type,typeMeta:{params:{rollup_index:this.rollupIndex},aggs:this.rollupIndicesCapabilities[this.rollupIndex].aggs}}:{}),_defineProperty(this,"renderPrompt",()=>external_kbnSharedDeps_React_default.a.createElement(RollupPrompt,null)),_defineProperty(this,"getFetchForWildcardOptions",()=>({type:this.type,rollupIndex:this.rollupIndex})),this.rollupIndex=null,this.rollupJobs=[],this.rollupIndicesCapabilities={},this.rollupIndices=[]}async setRollupIndices(){try{if(!this.httpClient.anonymousPaths.isAnonymous(window.location.pathname)){const response=await this.httpClient.get("/api/rollup/indices");this.rollupIndicesCapabilities=response||{}}this.rollupIndices=Object.keys(this.rollupIndicesCapabilities)}catch(e){}}async getIndexPatternCreationOption(urlHandler){return await this.setRollupIndices(),this.rollupIndices&&this.rollupIndices.length?{text:rollupIndexPatternButtonText,description:rollupIndexPatternButtonDescription,testSubj:"createRollupIndexPatternButton",isBeta:this.isBeta,onClick:()=>{urlHandler("/create?type=rollup")}}:null}getIndexTags(indexName){return this.isRollupIndex(indexName)?[{key:this.type,name:rollupIndexPatternIndexLabel,color:"primary"}]:[]}}function rollup_index_pattern_list_config_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function isRollup(indexPattern){return"rollup"===indexPattern.type||indexPattern.get&&"rollup"===indexPattern.get("type")}class rollup_index_pattern_list_config_RollupIndexPatternListConfig extends public_.IndexPatternListConfig{constructor(...args){super(...args),rollup_index_pattern_list_config_defineProperty(this,"key","rollup"),rollup_index_pattern_list_config_defineProperty(this,"getIndexPatternTags",indexPattern=>isRollup(indexPattern)?[{key:"rollup",name:"Rollup"}]:[]),rollup_index_pattern_list_config_defineProperty(this,"getFieldInfo",(indexPattern,field)=>{if(!isRollup(indexPattern))return[];const allAggs=indexPattern.typeMeta&&indexPattern.typeMeta.aggs,fieldAggs=allAggs&&Object.keys(allAggs).filter(agg=>allAggs[agg][field]);return fieldAggs&&fieldAggs.length?["Rollup aggregations:"].concat(fieldAggs.map(aggName=>{const agg=allAggs[aggName][field];switch(aggName){case"date_histogram":return`${aggName} (interval: ${agg.interval}, ${agg.delay?`delay: ${agg.delay},`:""} ${agg.time_zone})`;case"histogram":return`${aggName} (interval: ${agg.interval})`;default:return aggName}})):[]}),rollup_index_pattern_list_config_defineProperty(this,"areScriptedFieldsEnabled",indexPattern=>!isRollup(indexPattern))}}var common=__webpack_require__(2),home_public_=__webpack_require__(9),services=__webpack_require__(6),kibana_services=__webpack_require__(1);class plugin_RollupPlugin{setup(core,{home:home,management:management,indexManagement:indexManagement,indexPatternManagement:indexPatternManagement,usageCollection:usageCollection}){Object(kibana_services.c)(core.fatalErrors),usageCollection&&Object(kibana_services.e)(usageCollection.reportUiCounter.bind(usageCollection,common.c)),indexManagement&&(indexManagement.extensionsService.addBadge(rollupBadgeExtension),indexManagement.extensionsService.addToggle(rollupToggleExtension));core.uiSettings.get(common.a)&&(indexPatternManagement.creation.addCreationConfig(rollup_index_pattern_creation_config_RollupIndexPatternCreationConfig),indexPatternManagement.list.addListConfig(rollup_index_pattern_list_config_RollupIndexPatternListConfig)),home&&home.featureCatalogue.register({id:"rollup_jobs",title:"Rollups",description:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.rollupJobs.featureCatalogueDescription",{defaultMessage:"Summarize and store historical data in a smaller index for future analysis."}),icon:"indexRollupApp",path:"/app/management/data/rollup_jobs/job_list",showOnHomePage:!1,category:home_public_.FeatureCatalogueCategory.ADMIN});const pluginName=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.rollupJobs.appTitle",{defaultMessage:"Rollup Jobs"});management.sections.section.data.registerApp({id:"rollup_jobs",title:pluginName,order:4,async mount(params){const[coreStart]=await core.getStartServices(),{chrome:{docTitle:docTitle}}=coreStart;docTitle.change(pluginName),params.setBreadcrumbs([{text:pluginName}]);const{renderApp:renderApp}=await __webpack_require__.e(1).then(__webpack_require__.bind(null,80)),unmountAppCallback=await renderApp(core,params);return()=>{docTitle.reset(),unmountAppCallback()}}})}start(core){Object(services.A)(core.http),Object(kibana_services.d)(core.notifications),Object(services.z)(core.docLinks.ELASTIC_WEBSITE_URL,core.docLinks.DOC_LINK_VERSION)}}const public_plugin=()=>new plugin_RollupPlugin},function(module,exports){module.exports=__kbnSharedDeps__.KbnI18nReact},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/data/public");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/esUiShared/public");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/kibanaReact/public");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,exports){module.exports=__kbnSharedDeps__.ReactDom},function(module,exports){module.exports=__kbnSharedDeps__.ReactRouterDom},function(module,exports){module.exports=__kbnSharedDeps__.MomentTimezone}]);