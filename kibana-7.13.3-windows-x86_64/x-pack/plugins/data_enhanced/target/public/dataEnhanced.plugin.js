/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */!function(modules){function webpackJsonpCallback(data){for(var moduleId,chunkId,chunkIds=data[0],moreModules=data[1],i=0,resolves=[];i<chunkIds.length;i++)chunkId=chunkIds[i],Object.prototype.hasOwnProperty.call(installedChunks,chunkId)&&installedChunks[chunkId]&&resolves.push(installedChunks[chunkId][0]),installedChunks[chunkId]=0;for(moduleId in moreModules)Object.prototype.hasOwnProperty.call(moreModules,moduleId)&&(modules[moduleId]=moreModules[moduleId]);for(parentJsonpFunction&&parentJsonpFunction(data);resolves.length;)resolves.shift()()}var installedModules={},installedChunks={0:0};function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}__webpack_require__.e=function(chunkId){var promises=[],installedChunkData=installedChunks[chunkId];if(0!==installedChunkData)if(installedChunkData)promises.push(installedChunkData[2]);else{var promise=new Promise((function(resolve,reject){installedChunkData=installedChunks[chunkId]=[resolve,reject]}));promises.push(installedChunkData[2]=promise);var onScriptComplete,script=document.createElement("script");script.charset="utf-8",script.timeout=120,__webpack_require__.nc&&script.setAttribute("nonce",__webpack_require__.nc),script.src=function(chunkId){return __webpack_require__.p+"dataEnhanced.chunk."+chunkId+".js"}(chunkId);var error=new Error;onScriptComplete=function(event){script.onerror=script.onload=null,clearTimeout(timeout);var chunk=installedChunks[chunkId];if(0!==chunk){if(chunk){var errorType=event&&("load"===event.type?"missing":event.type),realSrc=event&&event.target&&event.target.src;error.message="Loading chunk "+chunkId+" failed.\n("+errorType+": "+realSrc+")",error.name="ChunkLoadError",error.type=errorType,error.request=realSrc,chunk[1](error)}installedChunks[chunkId]=void 0}};var timeout=setTimeout((function(){onScriptComplete({type:"timeout",target:script})}),12e4);script.onerror=script.onload=onScriptComplete,document.head.appendChild(script)}return Promise.all(promises)},__webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{enumerable:!0,get:getter})},__webpack_require__.r=function(exports){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(exports,"__esModule",{value:!0})},__webpack_require__.t=function(value,mode){if(1&mode&&(value=__webpack_require__(value)),8&mode)return value;if(4&mode&&"object"==typeof value&&value&&value.__esModule)return value;var ns=Object.create(null);if(__webpack_require__.r(ns),Object.defineProperty(ns,"default",{enumerable:!0,value:value}),2&mode&&"string"!=typeof value)for(var key in value)__webpack_require__.d(ns,key,function(key){return value[key]}.bind(null,key));return ns},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function(){return module.default}:function(){return module};return __webpack_require__.d(getter,"a",getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p="",__webpack_require__.oe=function(err){throw console.error(err),err};var jsonpArray=window.dataEnhanced_bundle_jsonpfunction=window.dataEnhanced_bundle_jsonpfunction||[],oldJsonpFunction=jsonpArray.push.bind(jsonpArray);jsonpArray.push=webpackJsonpCallback,jsonpArray=jsonpArray.slice();for(var i=0;i<jsonpArray.length;i++)webpackJsonpCallback(jsonpArray[i]);var parentJsonpFunction=oldJsonpFunction;__webpack_require__(__webpack_require__.s=18)}([function(module,exports){module.exports=__kbnSharedDeps__.React},function(module,exports){module.exports=__kbnSharedDeps__.RxjsOperators},function(module,exports){module.exports=__kbnSharedDeps__.Rxjs},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/data/public");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return ENHANCED_ES_SEARCH_STRATEGY})),__webpack_require__.d(__webpack_exports__,"b",(function(){return EQL_SEARCH_STRATEGY})),__webpack_require__.d(__webpack_exports__,"e",(function(){return pollSearch})),__webpack_require__.d(__webpack_exports__,"d",(function(){return common_.SearchSessionStatus})),__webpack_require__.d(__webpack_exports__,"c",(function(){return common_.SEARCH_SESSIONS_TABLE_ID}));const ENHANCED_ES_SEARCH_STRATEGY="ese",EQL_SEARCH_STRATEGY="eql";var external_kbnSharedDeps_Rxjs_=__webpack_require__(2),external_kbnSharedDeps_RxjsOperators_=__webpack_require__(1),common_=__webpack_require__(5),kibanaUtils_common_=__webpack_require__(10);const pollSearch=(search,cancel,{pollInterval:pollInterval=1e3,abortSignal:abortSignal}={})=>Object(external_kbnSharedDeps_Rxjs_.defer)(()=>{if(null!=abortSignal&&abortSignal.aborted)throw new kibanaUtils_common_.AbortError;cancel&&(null==abortSignal||abortSignal.addEventListener("abort",cancel,{once:!0}));const aborted$=(abortSignal?Object(external_kbnSharedDeps_Rxjs_.fromEvent)(abortSignal,"abort"):external_kbnSharedDeps_Rxjs_.EMPTY).pipe(Object(external_kbnSharedDeps_RxjsOperators_.map)(()=>{throw new kibanaUtils_common_.AbortError}));return Object(external_kbnSharedDeps_Rxjs_.from)(search()).pipe(Object(external_kbnSharedDeps_RxjsOperators_.expand)(()=>Object(external_kbnSharedDeps_Rxjs_.timer)(pollInterval).pipe(Object(external_kbnSharedDeps_RxjsOperators_.switchMap)(search))),Object(external_kbnSharedDeps_RxjsOperators_.tap)(response=>{if(Object(common_.isErrorResponse)(response))throw response?new Error("Received partial response"):new kibanaUtils_common_.AbortError}),Object(external_kbnSharedDeps_RxjsOperators_.takeWhile)(common_.isPartialResponse,!0),Object(external_kbnSharedDeps_RxjsOperators_.takeUntil)(aborted$))})},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/data/common");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,exports){module.exports=__kbnSharedDeps__.KbnI18n},function(module,exports){module.exports=__kbnSharedDeps__.Lodash},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/kibanaReact/public");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/kibanaUtils/public");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/kibanaUtils/common");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var tslib_1=__webpack_require__(17),react_1=__webpack_require__(0),useIsomorphicLayoutEffect_1=tslib_1.__importDefault(__webpack_require__(23));exports.default=function(observable$,initialValue){var _a=react_1.useState(initialValue),value=_a[0],update=_a[1];return useIsomorphicLayoutEffect_1.default((function(){var s=observable$.subscribe(update);return function(){return s.unsubscribe()}}),[observable$]),value}},function(module,exports){module.exports=__kbnSharedDeps__.ElasticEui},function(module,exports){module.exports=__kbnSharedDeps__.Moment},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return APP})),__webpack_require__.d(__webpack_exports__,"b",(function(){return registerSearchSessionsMgmt}));var _kbn_i18n__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(6),_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(3);const APP={id:_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_1__.SEARCH_SESSIONS_MANAGEMENT_ID,getI18nName:()=>_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.data.mgmt.searchSessions.appTitle",{defaultMessage:"Search Sessions"})};function registerSearchSessionsMgmt(coreSetup,config,services){services.management.sections.section.kibana.registerApp({id:APP.id,title:APP.getI18nName(),order:1.75,mount:async params=>{const{SearchSessionsMgmtApp:MgmtApp}=await __webpack_require__.e(1).then(__webpack_require__.bind(null,27));return new MgmtApp(coreSetup,config,params,services).mountManagementSection()}})}},function(module,exports,__webpack_require__){var json="undefined"!=typeof JSON?JSON:__webpack_require__(20);module.exports=function(obj,opts){opts||(opts={}),"function"==typeof opts&&(opts={cmp:opts});var space=opts.space||"";"number"==typeof space&&(space=Array(space+1).join(" "));var f,cycles="boolean"==typeof opts.cycles&&opts.cycles,replacer=opts.replacer||function(key,value){return value},cmp=opts.cmp&&(f=opts.cmp,function(node){return function(a,b){var aobj={key:a,value:node[a]},bobj={key:b,value:node[b]};return f(aobj,bobj)}}),seen=[];return function stringify(parent,key,node,level){var indent=space?"\n"+new Array(level+1).join(space):"",colonSeparator=space?": ":":";if(node&&node.toJSON&&"function"==typeof node.toJSON&&(node=node.toJSON()),void 0!==(node=replacer.call(parent,key,node))){if("object"!=typeof node||null===node)return json.stringify(node);if(isArray(node)){for(var out=[],i=0;i<node.length;i++){var item=stringify(node,i,node[i],level+1)||json.stringify(null);out.push(indent+space+item)}return"["+out.join(",")+indent+"]"}if(-1!==seen.indexOf(node)){if(cycles)return json.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}seen.push(node);var keys=objectKeys(node).sort(cmp&&cmp(node));for(out=[],i=0;i<keys.length;i++){var value=stringify(node,key=keys[i],node[key],level+1);if(value){var keyValue=json.stringify(key)+colonSeparator+value;out.push(indent+space+keyValue)}}return seen.splice(seen.indexOf(node),1),"{"+out.join(",")+indent+"}"}}({"":obj},"",obj,0)};var isArray=Array.isArray||function(x){return"[object Array]"==={}.toString.call(x)},objectKeys=Object.keys||function(obj){var has=Object.prototype.hasOwnProperty||function(){return!0},keys=[];for(var key in obj)has.call(obj,key)&&keys.push(key);return keys}},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("entry/core/public/utils");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,exports){module.exports=__kbnSharedDeps__.TsLib},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__(19);__kbnBundles__.define("plugin/dataEnhanced/public",__webpack_require__,24)},function(module,exports,__webpack_require__){__webpack_require__.p=window.__kbnPublicPath__.dataEnhanced},function(module,exports,__webpack_require__){exports.parse=__webpack_require__(21),exports.stringify=__webpack_require__(22)},function(module,exports){var at,ch,text,value,escapee={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"},error=function(m){throw{name:"SyntaxError",message:m,at:at,text:text}},next=function(c){return c&&c!==ch&&error("Expected '"+c+"' instead of '"+ch+"'"),ch=text.charAt(at),at+=1,ch},number=function(){var number,string="";for("-"===ch&&(string="-",next("-"));ch>="0"&&ch<="9";)string+=ch,next();if("."===ch)for(string+=".";next()&&ch>="0"&&ch<="9";)string+=ch;if("e"===ch||"E"===ch)for(string+=ch,next(),"-"!==ch&&"+"!==ch||(string+=ch,next());ch>="0"&&ch<="9";)string+=ch,next();if(number=+string,isFinite(number))return number;error("Bad number")},string=function(){var hex,i,uffff,string="";if('"'===ch)for(;next();){if('"'===ch)return next(),string;if("\\"===ch)if(next(),"u"===ch){for(uffff=0,i=0;i<4&&(hex=parseInt(next(),16),isFinite(hex));i+=1)uffff=16*uffff+hex;string+=String.fromCharCode(uffff)}else{if("string"!=typeof escapee[ch])break;string+=escapee[ch]}else string+=ch}error("Bad string")},white=function(){for(;ch&&ch<=" ";)next()};value=function(){switch(white(),ch){case"{":return function(){var key,object={};if("{"===ch){if(next("{"),white(),"}"===ch)return next("}"),object;for(;ch;){if(key=string(),white(),next(":"),Object.hasOwnProperty.call(object,key)&&error('Duplicate key "'+key+'"'),object[key]=value(),white(),"}"===ch)return next("}"),object;next(","),white()}}error("Bad object")}();case"[":return function(){var array=[];if("["===ch){if(next("["),white(),"]"===ch)return next("]"),array;for(;ch;){if(array.push(value()),white(),"]"===ch)return next("]"),array;next(","),white()}}error("Bad array")}();case'"':return string();case"-":return number();default:return ch>="0"&&ch<="9"?number():function(){switch(ch){case"t":return next("t"),next("r"),next("u"),next("e"),!0;case"f":return next("f"),next("a"),next("l"),next("s"),next("e"),!1;case"n":return next("n"),next("u"),next("l"),next("l"),null}error("Unexpected '"+ch+"'")}()}},module.exports=function(source,reviver){var result;return text=source,at=0,ch=" ",result=value(),white(),ch&&error("Syntax error"),"function"==typeof reviver?function walk(holder,key){var k,v,value=holder[key];if(value&&"object"==typeof value)for(k in value)Object.prototype.hasOwnProperty.call(value,k)&&(void 0!==(v=walk(value,k))?value[k]=v:delete value[k]);return reviver.call(holder,key,value)}({"":result},""):result}},function(module,exports){var gap,indent,rep,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function quote(string){return escapable.lastIndex=0,escapable.test(string)?'"'+string.replace(escapable,(function(a){var c=meta[a];return"string"==typeof c?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}))+'"':'"'+string+'"'}module.exports=function(value,replacer,space){var i;if(gap="",indent="","number"==typeof space)for(i=0;i<space;i+=1)indent+=" ";else"string"==typeof space&&(indent=space);if(rep=replacer,replacer&&"function"!=typeof replacer&&("object"!=typeof replacer||"number"!=typeof replacer.length))throw new Error("JSON.stringify");return function str(key,holder){var i,k,v,length,partial,mind=gap,value=holder[key];switch(value&&"object"==typeof value&&"function"==typeof value.toJSON&&(value=value.toJSON(key)),"function"==typeof rep&&(value=rep.call(holder,key,value)),typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value)return"null";if(gap+=indent,partial=[],"[object Array]"===Object.prototype.toString.apply(value)){for(length=value.length,i=0;i<length;i+=1)partial[i]=str(i,value)||"null";return v=0===partial.length?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]",gap=mind,v}if(rep&&"object"==typeof rep)for(length=rep.length,i=0;i<length;i+=1)"string"==typeof(k=rep[i])&&(v=str(k,value))&&partial.push(quote(k)+(gap?": ":":")+v);else for(k in value)Object.prototype.hasOwnProperty.call(value,k)&&(v=str(k,value))&&partial.push(quote(k)+(gap?": ":":")+v);return v=0===partial.length?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}",gap=mind,v}}("",{"":value})}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var react_1=__webpack_require__(0),useIsomorphicLayoutEffect="undefined"!=typeof window?react_1.useLayoutEffect:react_1.useEffect;exports.default=useIsomorphicLayoutEffect},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"plugin",(function(){return public_plugin})),__webpack_require__.d(__webpack_exports__,"DataEnhancedSetup",(function(){})),__webpack_require__.d(__webpack_exports__,"DataEnhancedStart",(function(){})),__webpack_require__.d(__webpack_exports__,"ENHANCED_ES_SEARCH_STRATEGY",(function(){return common_search.a})),__webpack_require__.d(__webpack_exports__,"EQL_SEARCH_STRATEGY",(function(){return common_search.b}));var external_kbnSharedDeps_React_=__webpack_require__(0),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),external_kbnSharedDeps_Moment_=__webpack_require__(13),external_kbnSharedDeps_Moment_default=__webpack_require__.n(external_kbnSharedDeps_Moment_),external_kbnSharedDeps_Lodash_=__webpack_require__(7),external_kbnSharedDeps_Rxjs_=__webpack_require__(2),external_kbnSharedDeps_RxjsOperators_=__webpack_require__(1),public_=__webpack_require__(3),kibanaUtils_public_=__webpack_require__(9),common_search=__webpack_require__(4);function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class search_response_cache_SearchResponseCache{constructor(maxItems,maxCacheSizeMB){this.maxItems=maxItems,this.maxCacheSizeMB=maxCacheSizeMB,_defineProperty(this,"responseCache",void 0),_defineProperty(this,"cacheSize",0),this.responseCache=new Map}byteToMb(size){return size/1048576}deleteItem(key,clearSubs=!0){const item=this.responseCache.get(key);item&&(clearSubs&&item.subs.unsubscribe(),this.cacheSize-=item.size,this.responseCache.delete(key))}setItem(key,item){this.deleteItem(key,!1),this.cacheSize+=item.size,this.responseCache.set(key,item)}clear(){this.cacheSize=0,this.responseCache.forEach(item=>{item.subs.unsubscribe()}),this.responseCache.clear()}shrink(){for(;this.responseCache.size>this.maxItems||this.byteToMb(this.cacheSize)>this.maxCacheSizeMB;){const[key]=[...this.responseCache.keys()];this.deleteItem(key)}}has(key){return this.responseCache.has(key)}set(key,item){if(this.responseCache.has(key))throw new Error("duplicate key");const{response$:response$,searchAbortController:searchAbortController}=item,cacheItem={response$:response$,searchAbortController:searchAbortController,subs:new external_kbnSharedDeps_Rxjs_.Subscription,size:0};this.setItem(key,cacheItem),cacheItem.subs.add(response$.subscribe({next:r=>{const newSize=new Blob([JSON.stringify(r)]).size;this.byteToMb(newSize)<this.maxCacheSizeMB&&!Object(public_.isErrorResponse)(r)?(this.setItem(key,{...cacheItem,size:newSize}),this.shrink()):this.deleteItem(key)},error:e=>{this.deleteItem(key)}})),this.shrink()}get(key){const item=this.responseCache.get(key);if(item)return this.setItem(key,item),{response$:item.response$,searchAbortController:item.searchAbortController}}}var json_stable_stringify=__webpack_require__(15),json_stable_stringify_default=__webpack_require__.n(json_stable_stringify),utils_=__webpack_require__(16);function search_abort_controller_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}let AbortReason;!function(AbortReason){AbortReason.Timeout="timeout"}(AbortReason||(AbortReason={}));class search_abort_controller_SearchAbortController{constructor(timeout){search_abort_controller_defineProperty(this,"inputAbortSignals",new Array),search_abort_controller_defineProperty(this,"abortController",new AbortController),search_abort_controller_defineProperty(this,"timeoutSub",void 0),search_abort_controller_defineProperty(this,"destroyed",!1),search_abort_controller_defineProperty(this,"reason",void 0),search_abort_controller_defineProperty(this,"abortHandler",()=>{this.inputAbortSignals.every(signal=>signal.aborted)&&(this.abortController.abort(),this.cleanup())}),timeout&&(this.timeoutSub=Object(external_kbnSharedDeps_Rxjs_.timer)(timeout).subscribe(()=>{this.reason=AbortReason.Timeout,this.abortController.abort(),this.timeoutSub.unsubscribe()}))}cleanup(){var _this$timeoutSub;this.destroyed||(this.destroyed=!0,null===(_this$timeoutSub=this.timeoutSub)||void 0===_this$timeoutSub||_this$timeoutSub.unsubscribe(),this.inputAbortSignals.forEach(abortSignal=>{abortSignal.removeEventListener("abort",this.abortHandler)}))}addAbortSignal(inputSignal){this.destroyed||(this.inputAbortSignals.push(inputSignal),inputSignal.aborted?this.abortHandler():inputSignal.addEventListener("abort",this.abortHandler))}getSignal(){return this.abortController.signal}abort(){this.cleanup(),this.abortController.abort()}isTimeout(){return this.reason===AbortReason.Timeout}}function search_interceptor_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class search_interceptor_EnhancedSearchInterceptor extends public_.SearchInterceptor{constructor(deps){super(deps),search_interceptor_defineProperty(this,"uiSettingsSub",void 0),search_interceptor_defineProperty(this,"searchTimeout",void 0),search_interceptor_defineProperty(this,"responseCache",new search_response_cache_SearchResponseCache(50,10)),this.searchTimeout=deps.uiSettings.get(public_.UI_SETTINGS.SEARCH_TIMEOUT),this.uiSettingsSub=deps.uiSettings.get$(public_.UI_SETTINGS.SEARCH_TIMEOUT).subscribe(timeout=>{this.searchTimeout=timeout})}stop(){this.responseCache.clear(),this.uiSettingsSub.unsubscribe()}getTimeoutMode(){var _this$application$cap;return null!==(_this$application$cap=this.application.capabilities.advancedSettings)&&void 0!==_this$application$cap&&_this$application$cap.save?public_.TimeoutErrorMode.CHANGE:public_.TimeoutErrorMode.CONTACT}createRequestHash$(request,options){const{sessionId:sessionId,isRestore:isRestore}=options,{preference:preference,...params}=request.params||{},hashOptions={...params,sessionId:sessionId,isRestore:isRestore};return Object(external_kbnSharedDeps_Rxjs_.from)(sessionId?async function(keys){return(new utils_.Sha256).update(json_stable_stringify_default()(keys),"utf8").digest("hex")}(hashOptions):Object(external_kbnSharedDeps_Rxjs_.of)(void 0))}runSearch$({id:id,...request},options,searchAbortController){const{sessionId:sessionId,strategy:strategy}=options;let isSavedToBackground=!1;const savedToBackgroundSub=this.deps.session.isCurrentSession(sessionId)&&this.deps.session.state$.pipe(Object(external_kbnSharedDeps_RxjsOperators_.skip)(1),Object(external_kbnSharedDeps_RxjsOperators_.filter)(state=>this.deps.session.isCurrentSession(sessionId)&&state===public_.SearchSessionState.BackgroundLoading),Object(external_kbnSharedDeps_RxjsOperators_.take)(1)).subscribe(()=>{isSavedToBackground=!0}),cancel=Object(external_kbnSharedDeps_Lodash_.once)(()=>{id&&!isSavedToBackground&&this.deps.http.delete(`/internal/search/${strategy}/${id}`)});return Object(common_search.e)(()=>this.runSearch({id:id,...request},{...options,abortSignal:searchAbortController.getSignal()}),cancel,{...options,abortSignal:searchAbortController.getSignal()}).pipe(Object(external_kbnSharedDeps_RxjsOperators_.tap)(response=>id=response.id),Object(external_kbnSharedDeps_RxjsOperators_.catchError)(e=>(cancel(),Object(external_kbnSharedDeps_Rxjs_.throwError)(e))),Object(external_kbnSharedDeps_RxjsOperators_.finalize)(()=>{searchAbortController.cleanup(),savedToBackgroundSub&&savedToBackgroundSub.unsubscribe()}),Object(external_kbnSharedDeps_RxjsOperators_.shareReplay)(1))}getSearchResponse$(request,options,requestHash){var _options$abortSignal;const cached=requestHash?this.responseCache.get(requestHash):void 0,searchAbortController=(null==cached?void 0:cached.searchAbortController)||new search_abort_controller_SearchAbortController(this.searchTimeout);searchAbortController.addAbortSignal(null!==(_options$abortSignal=options.abortSignal)&&void 0!==_options$abortSignal?_options$abortSignal:(new AbortController).signal);const response$=(null==cached?void 0:cached.response$)||this.runSearch$(request,options,searchAbortController);return requestHash&&!this.responseCache.has(requestHash)&&this.responseCache.set(requestHash,{response$:response$,searchAbortController:searchAbortController}),{response$:response$,searchAbortController:searchAbortController}}search({id:id,...request},options={}){const searchOptions={strategy:common_search.a,...options},{sessionId:sessionId,abortSignal:abortSignal}=searchOptions;return this.createRequestHash$(request,searchOptions).pipe(Object(external_kbnSharedDeps_RxjsOperators_.switchMap)(requestHash=>{const{searchAbortController:searchAbortController,response$:response$}=this.getSearchResponse$(request,searchOptions,requestHash);this.pendingCount$.next(this.pendingCount$.getValue()+1);const untrackSearch=this.deps.session.isCurrentSession(sessionId)?this.deps.session.trackSearch({abort:()=>searchAbortController.abort()}):void 0,aborted$=(abortSignal?Object(external_kbnSharedDeps_Rxjs_.fromEvent)(abortSignal,"abort"):external_kbnSharedDeps_Rxjs_.EMPTY).pipe(Object(external_kbnSharedDeps_RxjsOperators_.map)(()=>{throw new kibanaUtils_public_.AbortError}));return response$.pipe(Object(external_kbnSharedDeps_RxjsOperators_.takeUntil)(aborted$),Object(external_kbnSharedDeps_RxjsOperators_.catchError)(e=>Object(external_kbnSharedDeps_Rxjs_.throwError)(this.handleSearchError(e,searchOptions,searchAbortController.isTimeout()))),Object(external_kbnSharedDeps_RxjsOperators_.finalize)(()=>{this.pendingCount$.next(this.pendingCount$.getValue()-1),untrackSearch&&this.deps.session.isCurrentSession(sessionId)&&untrackSearch()}))}))}}var sessions_mgmt=__webpack_require__(14),kibanaReact_public_=__webpack_require__(8),useObservable=__webpack_require__(11),useObservable_default=__webpack_require__.n(useObservable),external_kbnSharedDeps_KbnI18n_=__webpack_require__(6),external_kbnSharedDeps_ElasticEui_=__webpack_require__(12);function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const Fallback=()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDelayRender,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingSpinner,null)),LazySearchSessionIndicator=external_kbnSharedDeps_React_default.a.lazy(()=>__webpack_require__.e(2).then(__webpack_require__.bind(null,81))),SearchSessionIndicator=external_kbnSharedDeps_React_default.a.forwardRef((props,ref)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Suspense,{fallback:external_kbnSharedDeps_React_default.a.createElement(Fallback,null)},external_kbnSharedDeps_React_default.a.createElement(LazySearchSessionIndicator,_extends({},props,{ref:ref}))));function safeHas(storage,key){try{return Boolean(storage.get(key))}catch(e){return!0}}function safeSet(storage,key){try{storage.set(key,!0)}catch(e){return!0}}const createConnectedSearchSessionIndicator=({sessionService:sessionService,application:application,storage:storage,disableSaveAfterSessionCompletesTimeout:disableSaveAfterSessionCompletesTimeout,usageCollector:usageCollector,basePath:basePath})=>{const searchSessionsManagementUrl=basePath.prepend("/app/management/kibana/search_sessions"),debouncedSessionServiceState$=sessionService.state$.pipe(Object(external_kbnSharedDeps_RxjsOperators_.debounce)(_state=>Object(external_kbnSharedDeps_Rxjs_.timer)(_state===public_.SearchSessionState.None?50:300))),disableSaveAfterSessionCompleteTimedOut$=sessionService.state$.pipe(Object(external_kbnSharedDeps_RxjsOperators_.switchMap)(_state=>_state===public_.SearchSessionState.Completed?Object(external_kbnSharedDeps_Rxjs_.merge)(Object(external_kbnSharedDeps_Rxjs_.of)(!1),Object(external_kbnSharedDeps_Rxjs_.timer)(disableSaveAfterSessionCompletesTimeout).pipe(Object(external_kbnSharedDeps_RxjsOperators_.mapTo)(!0))):Object(external_kbnSharedDeps_Rxjs_.of)(!1)),Object(external_kbnSharedDeps_RxjsOperators_.distinctUntilChanged)(),Object(external_kbnSharedDeps_RxjsOperators_.tap)(value=>{value&&(null==usageCollector||usageCollector.trackSessionIndicatorSaveDisabled())}));return()=>{const state=useObservable_default()(debouncedSessionServiceState$,public_.SearchSessionState.None),isSaveDisabledByApp=sessionService.getSearchSessionIndicatorUiConfig().isDisabled(),disableSaveAfterSessionCompleteTimedOut=useObservable_default()(disableSaveAfterSessionCompleteTimedOut$,!1),[searchSessionIndicator,setSearchSessionIndicator]=Object(external_kbnSharedDeps_React_.useState)(null),searchSessionIndicatorRef=Object(external_kbnSharedDeps_React_.useCallback)(ref=>{null!==ref&&setSearchSessionIndicator(ref)},[]);let saveDisabled=!1,saveDisabledReasonText="",managementDisabled=!1,managementDisabledReasonText="";disableSaveAfterSessionCompleteTimedOut&&(saveDisabled=!0,saveDisabledReasonText=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.data.searchSessionIndicator.disabledDueToTimeoutMessage",{defaultMessage:"Search session results expired."})),isSaveDisabledByApp.disabled&&(saveDisabled=!0,saveDisabledReasonText=isSaveDisabledByApp.reasonText),sessionService.hasAccess()||(managementDisabled=saveDisabled=!0,managementDisabledReasonText=saveDisabledReasonText=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.data.searchSessionIndicator.disabledDueToDisabledGloballyMessage",{defaultMessage:"You don't have permissions to manage search sessions"}));const{markOpenedDone:markOpenedDone,markRestoredDone:markRestoredDone}=function(storage,searchSessionIndicatorRef,state,searchSessionsDisabled,usageCollector){const markOpenedDone=Object(external_kbnSharedDeps_React_.useCallback)(()=>{safeSet(storage,"data.searchSession.tour.takingTooLong")},[storage]),markRestoredDone=Object(external_kbnSharedDeps_React_.useCallback)(()=>{safeSet(storage,"data.searchSession.tour.restore")},[storage]),trackSessionIndicatorTourLoading=Object(external_kbnSharedDeps_React_.useCallback)(Object(external_kbnSharedDeps_Lodash_.once)(()=>null==usageCollector?void 0:usageCollector.trackSessionIndicatorTourLoading()),[usageCollector,state]),trackSessionIndicatorTourRestored=Object(external_kbnSharedDeps_React_.useCallback)(Object(external_kbnSharedDeps_Lodash_.once)(()=>null==usageCollector?void 0:usageCollector.trackSessionIndicatorTourRestored()),[usageCollector,state]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{if(searchSessionsDisabled)return;if(!searchSessionIndicatorRef)return;let timeoutHandle;return state===public_.SearchSessionState.Loading&&(safeHas(storage,"data.searchSession.tour.takingTooLong")||(timeoutHandle=window.setTimeout(()=>{trackSessionIndicatorTourLoading(),searchSessionIndicatorRef.openPopover()},1e4))),state===public_.SearchSessionState.Restored&&(safeHas(storage,"data.searchSession.tour.restore")||(trackSessionIndicatorTourRestored(),searchSessionIndicatorRef.openPopover())),()=>{clearTimeout(timeoutHandle)}},[storage,searchSessionIndicatorRef,state,searchSessionsDisabled,markOpenedDone,markRestoredDone,usageCollector,trackSessionIndicatorTourRestored,trackSessionIndicatorTourLoading]),{markOpenedDone:markOpenedDone,markRestoredDone:markRestoredDone}}(storage,searchSessionIndicator,state,saveDisabled,usageCollector),onOpened=Object(external_kbnSharedDeps_React_.useCallback)(openedState=>{markOpenedDone(),openedState===public_.SearchSessionState.Restored&&markRestoredDone()},[markOpenedDone,markRestoredDone]),onContinueInBackground=Object(external_kbnSharedDeps_React_.useCallback)(()=>{saveDisabled||(null==usageCollector||usageCollector.trackSessionSentToBackground(),sessionService.save())},[saveDisabled]),onSaveResults=Object(external_kbnSharedDeps_React_.useCallback)(()=>{saveDisabled||(null==usageCollector||usageCollector.trackSessionSavedResults(),sessionService.save())},[saveDisabled]),onCancel=Object(external_kbnSharedDeps_React_.useCallback)(()=>{null==usageCollector||usageCollector.trackSessionCancelled(),sessionService.cancel()},[]),onViewSearchSessions=Object(external_kbnSharedDeps_React_.useCallback)(()=>{null==usageCollector||usageCollector.trackViewSessionsList()},[]);Object(external_kbnSharedDeps_React_.useEffect)(()=>{state===public_.SearchSessionState.Restored&&(null==usageCollector||usageCollector.trackSessionIsRestored())},[state]);const{name:searchSessionName,startTime:startTime,completedTime:completedTime,canceledTime:canceledTime}=useObservable_default()(sessionService.sessionMeta$,{state:state}),saveSearchSessionNameFn=Object(external_kbnSharedDeps_React_.useCallback)(async newName=>{await sessionService.renameCurrentSession(newName)},[]);return sessionService.isSessionStorageReady()?external_kbnSharedDeps_React_default.a.createElement(kibanaReact_public_.RedirectAppLinks,{application:application},external_kbnSharedDeps_React_default.a.createElement(SearchSessionIndicator,{ref:searchSessionIndicatorRef,state:state,saveDisabled:saveDisabled,saveDisabledReasonText:saveDisabledReasonText,managementDisabled:managementDisabled,managementDisabledReasonText:managementDisabledReasonText,onContinueInBackground:onContinueInBackground,onSaveResults:onSaveResults,onCancel:onCancel,onOpened:onOpened,onViewSearchSessions:onViewSearchSessions,viewSearchSessionsLink:searchSessionsManagementUrl,searchSessionName:searchSessionName,saveSearchSessionNameFn:saveSearchSessionNameFn,startedTime:startTime,completedTime:completedTime,canceledTime:canceledTime})):null}};function plugin_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class plugin_DataEnhancedPlugin{constructor(initializerContext){this.initializerContext=initializerContext,plugin_defineProperty(this,"enhancedSearchInterceptor",void 0),plugin_defineProperty(this,"config",void 0),plugin_defineProperty(this,"storage",new kibanaUtils_public_.Storage(window.localStorage)),plugin_defineProperty(this,"usageCollector",void 0)}setup(core,{bfetch:bfetch,data:data,management:management}){if(this.enhancedSearchInterceptor=new search_interceptor_EnhancedSearchInterceptor({bfetch:bfetch,toasts:core.notifications.toasts,http:core.http,uiSettings:core.uiSettings,startServices:core.getStartServices(),usageCollector:data.search.usageCollector,session:data.search.session}),data.__enhance({search:{searchInterceptor:this.enhancedSearchInterceptor}}),this.config=this.initializerContext.config.get(),this.config.search.sessions.enabled){const sessionsConfig=this.config.search.sessions;Object(sessions_mgmt.b)(core,sessionsConfig,{data:data,management:management})}this.usageCollector=data.search.usageCollector}start(core,plugins){this.config.search.sessions.enabled&&core.chrome.setBreadcrumbsAppendExtension({content:Object(kibanaReact_public_.toMountPoint)(external_kbnSharedDeps_React_default.a.createElement(createConnectedSearchSessionIndicator({sessionService:plugins.data.search.session,application:core.application,basePath:core.http.basePath,storage:this.storage,disableSaveAfterSessionCompletesTimeout:external_kbnSharedDeps_Moment_default.a.duration(this.config.search.sessions.notTouchedTimeout).asMilliseconds(),usageCollector:this.usageCollector})))})}stop(){this.enhancedSearchInterceptor.stop()}}const public_plugin=initializerContext=>new plugin_DataEnhancedPlugin(initializerContext)},function(module,exports){module.exports=__kbnSharedDeps__.KbnI18nReact},function(module,exports){module.exports=__kbnSharedDeps__.ReactDom}]);