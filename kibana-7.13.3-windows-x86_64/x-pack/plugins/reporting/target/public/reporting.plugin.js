/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */!function(modules){function webpackJsonpCallback(data){for(var moduleId,chunkId,chunkIds=data[0],moreModules=data[1],i=0,resolves=[];i<chunkIds.length;i++)chunkId=chunkIds[i],Object.prototype.hasOwnProperty.call(installedChunks,chunkId)&&installedChunks[chunkId]&&resolves.push(installedChunks[chunkId][0]),installedChunks[chunkId]=0;for(moduleId in moreModules)Object.prototype.hasOwnProperty.call(moreModules,moduleId)&&(modules[moduleId]=moreModules[moduleId]);for(parentJsonpFunction&&parentJsonpFunction(data);resolves.length;)resolves.shift()()}var installedModules={},installedChunks={0:0};function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}__webpack_require__.e=function(chunkId){var promises=[],installedChunkData=installedChunks[chunkId];if(0!==installedChunkData)if(installedChunkData)promises.push(installedChunkData[2]);else{var promise=new Promise((function(resolve,reject){installedChunkData=installedChunks[chunkId]=[resolve,reject]}));promises.push(installedChunkData[2]=promise);var onScriptComplete,script=document.createElement("script");script.charset="utf-8",script.timeout=120,__webpack_require__.nc&&script.setAttribute("nonce",__webpack_require__.nc),script.src=function(chunkId){return __webpack_require__.p+"reporting.chunk."+chunkId+".js"}(chunkId);var error=new Error;onScriptComplete=function(event){script.onerror=script.onload=null,clearTimeout(timeout);var chunk=installedChunks[chunkId];if(0!==chunk){if(chunk){var errorType=event&&("load"===event.type?"missing":event.type),realSrc=event&&event.target&&event.target.src;error.message="Loading chunk "+chunkId+" failed.\n("+errorType+": "+realSrc+")",error.name="ChunkLoadError",error.type=errorType,error.request=realSrc,chunk[1](error)}installedChunks[chunkId]=void 0}};var timeout=setTimeout((function(){onScriptComplete({type:"timeout",target:script})}),12e4);script.onerror=script.onload=onScriptComplete,document.head.appendChild(script)}return Promise.all(promises)},__webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{enumerable:!0,get:getter})},__webpack_require__.r=function(exports){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(exports,"__esModule",{value:!0})},__webpack_require__.t=function(value,mode){if(1&mode&&(value=__webpack_require__(value)),8&mode)return value;if(4&mode&&"object"==typeof value&&value&&value.__esModule)return value;var ns=Object.create(null);if(__webpack_require__.r(ns),Object.defineProperty(ns,"default",{enumerable:!0,value:value}),2&mode&&"string"!=typeof value)for(var key in value)__webpack_require__.d(ns,key,function(key){return value[key]}.bind(null,key));return ns},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function(){return module.default}:function(){return module};return __webpack_require__.d(getter,"a",getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p="",__webpack_require__.oe=function(err){throw console.error(err),err};var jsonpArray=window.reporting_bundle_jsonpfunction=window.reporting_bundle_jsonpfunction||[],oldJsonpFunction=jsonpArray.push.bind(jsonpArray);jsonpArray.push=webpackJsonpCallback,jsonpArray=jsonpArray.slice();for(var i=0;i<jsonpArray.length;i++)webpackJsonpCallback(jsonpArray[i]);var parentJsonpFunction=oldJsonpFunction;__webpack_require__(__webpack_require__.s=22)}([function(module,exports){module.exports=__kbnSharedDeps__.React},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"PLUGIN_ID",(function(){return PLUGIN_ID})),__webpack_require__.d(__webpack_exports__,"BROWSER_TYPE",(function(){return BROWSER_TYPE})),__webpack_require__.d(__webpack_exports__,"JOB_COMPLETION_NOTIFICATIONS_SESSION_KEY",(function(){return JOB_COMPLETION_NOTIFICATIONS_SESSION_KEY})),__webpack_require__.d(__webpack_exports__,"CONTENT_TYPE_CSV",(function(){return CONTENT_TYPE_CSV})),__webpack_require__.d(__webpack_exports__,"CSV_REPORTING_ACTION",(function(){return CSV_REPORTING_ACTION})),__webpack_require__.d(__webpack_exports__,"CSV_BOM_CHARS",(function(){return CSV_BOM_CHARS})),__webpack_require__.d(__webpack_exports__,"CSV_FORMULA_CHARS",(function(){return CSV_FORMULA_CHARS})),__webpack_require__.d(__webpack_exports__,"ALLOWED_JOB_CONTENT_TYPES",(function(){return ALLOWED_JOB_CONTENT_TYPES})),__webpack_require__.d(__webpack_exports__,"KBN_SCREENSHOT_HEADER_BLOCK_LIST",(function(){return KBN_SCREENSHOT_HEADER_BLOCK_LIST})),__webpack_require__.d(__webpack_exports__,"KBN_SCREENSHOT_HEADER_BLOCK_LIST_STARTS_WITH_PATTERN",(function(){return KBN_SCREENSHOT_HEADER_BLOCK_LIST_STARTS_WITH_PATTERN})),__webpack_require__.d(__webpack_exports__,"UI_SETTINGS_CUSTOM_PDF_LOGO",(function(){return UI_SETTINGS_CUSTOM_PDF_LOGO})),__webpack_require__.d(__webpack_exports__,"UI_SETTINGS_CSV_SEPARATOR",(function(){return UI_SETTINGS_CSV_SEPARATOR})),__webpack_require__.d(__webpack_exports__,"UI_SETTINGS_CSV_QUOTE_VALUES",(function(){return UI_SETTINGS_CSV_QUOTE_VALUES})),__webpack_require__.d(__webpack_exports__,"UI_SETTINGS_DATEFORMAT_TZ",(function(){return UI_SETTINGS_DATEFORMAT_TZ})),__webpack_require__.d(__webpack_exports__,"LAYOUT_TYPES",(function(){return LAYOUT_TYPES})),__webpack_require__.d(__webpack_exports__,"CSV_REPORT_TYPE",(function(){return CSV_REPORT_TYPE})),__webpack_require__.d(__webpack_exports__,"CSV_JOB_TYPE",(function(){return CSV_JOB_TYPE})),__webpack_require__.d(__webpack_exports__,"PDF_REPORT_TYPE",(function(){return PDF_REPORT_TYPE})),__webpack_require__.d(__webpack_exports__,"PDF_JOB_TYPE",(function(){return PDF_JOB_TYPE})),__webpack_require__.d(__webpack_exports__,"PNG_REPORT_TYPE",(function(){return PNG_REPORT_TYPE})),__webpack_require__.d(__webpack_exports__,"PNG_JOB_TYPE",(function(){return PNG_JOB_TYPE})),__webpack_require__.d(__webpack_exports__,"CSV_SEARCHSOURCE_IMMEDIATE_TYPE",(function(){return CSV_SEARCHSOURCE_IMMEDIATE_TYPE})),__webpack_require__.d(__webpack_exports__,"CSV_REPORT_TYPE_DEPRECATED",(function(){return CSV_REPORT_TYPE_DEPRECATED})),__webpack_require__.d(__webpack_exports__,"CSV_JOB_TYPE_DEPRECATED",(function(){return CSV_JOB_TYPE_DEPRECATED})),__webpack_require__.d(__webpack_exports__,"USES_HEADLESS_JOB_TYPES",(function(){return USES_HEADLESS_JOB_TYPES})),__webpack_require__.d(__webpack_exports__,"LICENSE_TYPE_TRIAL",(function(){return LICENSE_TYPE_TRIAL})),__webpack_require__.d(__webpack_exports__,"LICENSE_TYPE_BASIC",(function(){return LICENSE_TYPE_BASIC})),__webpack_require__.d(__webpack_exports__,"LICENSE_TYPE_STANDARD",(function(){return LICENSE_TYPE_STANDARD})),__webpack_require__.d(__webpack_exports__,"LICENSE_TYPE_GOLD",(function(){return LICENSE_TYPE_GOLD})),__webpack_require__.d(__webpack_exports__,"LICENSE_TYPE_PLATINUM",(function(){return LICENSE_TYPE_PLATINUM})),__webpack_require__.d(__webpack_exports__,"LICENSE_TYPE_ENTERPRISE",(function(){return LICENSE_TYPE_ENTERPRISE})),__webpack_require__.d(__webpack_exports__,"API_BASE_URL",(function(){return API_BASE_URL})),__webpack_require__.d(__webpack_exports__,"API_BASE_GENERATE",(function(){return API_BASE_GENERATE})),__webpack_require__.d(__webpack_exports__,"API_LIST_URL",(function(){return API_LIST_URL})),__webpack_require__.d(__webpack_exports__,"API_DIAGNOSE_URL",(function(){return API_DIAGNOSE_URL})),__webpack_require__.d(__webpack_exports__,"API_BASE_URL_V1",(function(){return API_BASE_URL_V1})),__webpack_require__.d(__webpack_exports__,"API_GENERATE_IMMEDIATE",(function(){return API_GENERATE_IMMEDIATE})),__webpack_require__.d(__webpack_exports__,"REPORTING_MANAGEMENT_HOME",(function(){return REPORTING_MANAGEMENT_HOME})),__webpack_require__.d(__webpack_exports__,"JOB_STATUSES",(function(){return JOB_STATUSES}));const PLUGIN_ID="reporting",BROWSER_TYPE="chromium",JOB_COMPLETION_NOTIFICATIONS_SESSION_KEY="xpack.reporting.jobCompletionNotifications",CONTENT_TYPE_CSV="text/csv",CSV_REPORTING_ACTION="downloadCsvReport",CSV_BOM_CHARS="\ufeff",CSV_FORMULA_CHARS=["=","+","-","@"],ALLOWED_JOB_CONTENT_TYPES=["application/json","application/pdf",CONTENT_TYPE_CSV,"image/png","text/plain"],KBN_SCREENSHOT_HEADER_BLOCK_LIST=["accept-encoding","connection","content-length","content-type","host","referer","transfer-encoding","trailer","te","upgrade","keep-alive"],KBN_SCREENSHOT_HEADER_BLOCK_LIST_STARTS_WITH_PATTERN=["proxy-"],UI_SETTINGS_CUSTOM_PDF_LOGO="xpackReporting:customPdfLogo",UI_SETTINGS_CSV_SEPARATOR="csv:separator",UI_SETTINGS_CSV_QUOTE_VALUES="csv:quoteValues",UI_SETTINGS_DATEFORMAT_TZ="dateFormat:tz",LAYOUT_TYPES={PRESERVE_LAYOUT:"preserve_layout",PRINT:"print"},CSV_REPORT_TYPE="CSV",CSV_JOB_TYPE="csv_searchsource",PDF_REPORT_TYPE="printablePdf",PDF_JOB_TYPE="printable_pdf",PNG_REPORT_TYPE="PNG",PNG_JOB_TYPE="PNG",CSV_SEARCHSOURCE_IMMEDIATE_TYPE="csv_searchsource_immediate",CSV_REPORT_TYPE_DEPRECATED="CSV",CSV_JOB_TYPE_DEPRECATED="csv",USES_HEADLESS_JOB_TYPES=[PDF_JOB_TYPE,PNG_JOB_TYPE],LICENSE_TYPE_TRIAL="trial",LICENSE_TYPE_BASIC="basic",LICENSE_TYPE_STANDARD="standard",LICENSE_TYPE_GOLD="gold",LICENSE_TYPE_PLATINUM="platinum",LICENSE_TYPE_ENTERPRISE="enterprise",API_BASE_URL="/api/reporting",API_BASE_GENERATE=API_BASE_URL+"/generate",API_LIST_URL=API_BASE_URL+"/jobs",API_DIAGNOSE_URL=API_BASE_URL+"/diagnose",API_BASE_URL_V1="/api/reporting/v1",API_GENERATE_IMMEDIATE=API_BASE_URL_V1+"/generate/immediate/csv_searchsource",REPORTING_MANAGEMENT_HOME="/app/management/insightsAndAlerting/reporting";let JOB_STATUSES;!function(JOB_STATUSES){JOB_STATUSES.PENDING="pending",JOB_STATUSES.PROCESSING="processing",JOB_STATUSES.COMPLETED="completed",JOB_STATUSES.FAILED="failed",JOB_STATUSES.CANCELLED="cancelled",JOB_STATUSES.WARNINGS="completed_with_warnings"}(JOB_STATUSES||(JOB_STATUSES={}))},function(module,exports){module.exports=__kbnSharedDeps__.KbnI18nReact},function(module,exports){module.exports=__kbnSharedDeps__.ElasticEui},function(module,exports){module.exports=__kbnSharedDeps__.KbnI18n},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/kibanaReact/public");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,exports){module.exports=__kbnSharedDeps__.RxjsOperators},function(module,exports){module.exports=__kbnSharedDeps__.Rxjs},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return checkLicense}));const checkLicense=checkResults=>{switch(checkResults.state){case"valid":return{showLinks:!0,enableLinks:!0,message:""};case"invalid":return{showLinks:!1,enableLinks:!1,message:"Your license does not support Reporting. Please upgrade your license."};case"unavailable":return{showLinks:!0,enableLinks:!1,message:"You cannot use Reporting because license information is not available at this time."};case"expired":return{showLinks:!0,enableLinks:!1,message:"You cannot use Reporting because your license has expired."};default:return{showLinks:!0,enableLinks:!0,message:""}}}},function(module,exports){module.exports=__kbnSharedDeps__.MomentTimezone},function(module,exports){module.exports=__kbnSharedDeps__.Lodash},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/embeddable/public");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,exports){module.exports=__kbnSharedDeps__.RisonNode},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/discover/public");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return Poller}));var lodash__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(10),lodash__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_0__);function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class Poller{constructor(options){_defineProperty(this,"functionToPoll",void 0),_defineProperty(this,"successFunction",void 0),_defineProperty(this,"errorFunction",void 0),_defineProperty(this,"_isRunning",void 0),_defineProperty(this,"_timeoutId",void 0),_defineProperty(this,"pollFrequencyInMillis",void 0),_defineProperty(this,"trailing",void 0),_defineProperty(this,"continuePollingOnError",void 0),_defineProperty(this,"pollFrequencyErrorMultiplier",void 0),this.functionToPoll=options.functionToPoll,this.successFunction=options.successFunction||lodash__WEBPACK_IMPORTED_MODULE_0___default.a.noop,this.errorFunction=options.errorFunction||lodash__WEBPACK_IMPORTED_MODULE_0___default.a.noop,this.pollFrequencyInMillis=options.pollFrequencyInMillis,this.trailing=options.trailing||!1,this.continuePollingOnError=options.continuePollingOnError||!1,this.pollFrequencyErrorMultiplier=options.pollFrequencyErrorMultiplier||1,this._timeoutId=null,this._isRunning=!1}getPollFrequency(){return this.pollFrequencyInMillis}_poll(){return this.functionToPoll().then(this.successFunction).then(()=>{this._isRunning&&(this._timeoutId=setTimeout(this._poll.bind(this),this.pollFrequencyInMillis))}).catch(e=>{this.errorFunction(e),this._isRunning&&(this.continuePollingOnError?this._timeoutId=setTimeout(this._poll.bind(this),this.pollFrequencyInMillis*this.pollFrequencyErrorMultiplier):this.stop())})}start(){this._isRunning||(this._isRunning=!0,this.trailing?this._timeoutId=setTimeout(this._poll.bind(this),this.pollFrequencyInMillis):this._poll())}stop(){this._isRunning&&(this._isRunning=!1,this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=null)}isRunning(){return this._isRunning}}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return durationToNumber}));const durationToNumber=value=>"number"==typeof value?value:value.asMilliseconds()},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"ScreenCapturePanelContent",(function(){return ScreenCapturePanelContent}));var _elastic_eui__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(3),_kbn_i18n_react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(2),react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_2__),_reporting_panel_content__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(19);function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class ScreenCapturePanelContent extends react__WEBPACK_IMPORTED_MODULE_2__.Component{constructor(props){super(props),_defineProperty(this,"renderOptions",()=>this.state.isPreserveLayoutSupported?react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_2__.Fragment,null,react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_0__.EuiSwitch,{label:react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(_kbn_i18n_react__WEBPACK_IMPORTED_MODULE_1__.FormattedMessage,{id:"xpack.reporting.screenCapturePanelContent.optimizeForPrintingLabel",defaultMessage:"Optimize for printing"}),checked:this.state.usePrintLayout,onChange:this.handlePrintLayoutChange,"data-test-subj":"usePrintLayout"}),react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_0__.EuiSpacer,{size:"s"})):react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_2__.Fragment,null,react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_0__.EuiSpacer,{size:"s"}))),_defineProperty(this,"handlePrintLayoutChange",evt=>{this.setState({usePrintLayout:evt.target.checked})}),_defineProperty(this,"getLayout",()=>{if(this.state.usePrintLayout)return{id:"print"};const el=document.querySelector("[data-shared-items-container]"),bounds=el?el.getBoundingClientRect():{height:768,width:1024};return{id:"png"===this.props.reportType?"png":"preserve_layout",dimensions:{height:bounds.height,width:bounds.width}}}),_defineProperty(this,"getJobParams",()=>({...this.props.getJobParams(),layout:this.getLayout()}));const{objectType:objectType}=props.getJobParams(),isPreserveLayoutSupported="png"!==props.reportType&&"visualization"!==objectType;this.state={isPreserveLayoutSupported:isPreserveLayoutSupported,usePrintLayout:!1}}render(){return react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(_reporting_panel_content__WEBPACK_IMPORTED_MODULE_3__.ReportingPanelContent,{apiClient:this.props.apiClient,toasts:this.props.toasts,reportType:this.props.reportType,layoutId:this.getLayout().id,objectId:this.props.objectId,getJobParams:this.getJobParams,options:this.renderOptions(),isDirty:this.props.isDirty,onClose:this.props.onClose})}}},function(module,exports,__webpack_require__){"use strict";const strictUriEncode=__webpack_require__(24),decodeComponent=__webpack_require__(25),splitOnFirst=__webpack_require__(26);function validateArrayFormatSeparator(value){if("string"!=typeof value||1!==value.length)throw new TypeError("arrayFormatSeparator must be single character string")}function encode(value,options){return options.encode?options.strict?strictUriEncode(value):encodeURIComponent(value):value}function decode(value,options){return options.decode?decodeComponent(value):value}function removeHash(input){const hashStart=input.indexOf("#");return-1!==hashStart&&(input=input.slice(0,hashStart)),input}function extract(input){const queryStart=(input=removeHash(input)).indexOf("?");return-1===queryStart?"":input.slice(queryStart+1)}function parseValue(value,options){return options.parseNumbers&&!Number.isNaN(Number(value))&&"string"==typeof value&&""!==value.trim()?value=Number(value):!options.parseBooleans||null===value||"true"!==value.toLowerCase()&&"false"!==value.toLowerCase()||(value="true"===value.toLowerCase()),value}function parse(input,options){validateArrayFormatSeparator((options=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},options)).arrayFormatSeparator);const formatter=function(options){let result;switch(options.arrayFormat){case"index":return(key,value,accumulator)=>{result=/\[(\d*)\]$/.exec(key),key=key.replace(/\[\d*\]$/,""),result?(void 0===accumulator[key]&&(accumulator[key]={}),accumulator[key][result[1]]=value):accumulator[key]=value};case"bracket":return(key,value,accumulator)=>{result=/(\[\])$/.exec(key),key=key.replace(/\[\]$/,""),result?void 0!==accumulator[key]?accumulator[key]=[].concat(accumulator[key],value):accumulator[key]=[value]:accumulator[key]=value};case"comma":case"separator":return(key,value,accumulator)=>{const newValue="string"==typeof value&&value.split("").indexOf(options.arrayFormatSeparator)>-1?value.split(options.arrayFormatSeparator).map(item=>decode(item,options)):null===value?value:decode(value,options);accumulator[key]=newValue};default:return(key,value,accumulator)=>{void 0!==accumulator[key]?accumulator[key]=[].concat(accumulator[key],value):accumulator[key]=value}}}(options),ret=Object.create(null);if("string"!=typeof input)return ret;if(!(input=input.trim().replace(/^[?#&]/,"")))return ret;for(const param of input.split("&")){let[key,value]=splitOnFirst(options.decode?param.replace(/\+/g," "):param,"=");value=void 0===value?null:["comma","separator"].includes(options.arrayFormat)?value:decode(value,options),formatter(decode(key,options),value,ret)}for(const key of Object.keys(ret)){const value=ret[key];if("object"==typeof value&&null!==value)for(const k of Object.keys(value))value[k]=parseValue(value[k],options);else ret[key]=parseValue(value,options)}return!1===options.sort?ret:(!0===options.sort?Object.keys(ret).sort():Object.keys(ret).sort(options.sort)).reduce((result,key)=>{const value=ret[key];return Boolean(value)&&"object"==typeof value&&!Array.isArray(value)?result[key]=function keysSorter(input){return Array.isArray(input)?input.sort():"object"==typeof input?keysSorter(Object.keys(input)).sort((a,b)=>Number(a)-Number(b)).map(key=>input[key]):input}(value):result[key]=value,result},Object.create(null))}exports.extract=extract,exports.parse=parse,exports.stringify=(object,options)=>{if(!object)return"";validateArrayFormatSeparator((options=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},options)).arrayFormatSeparator);const shouldFilter=key=>options.skipNull&&null==object[key]||options.skipEmptyString&&""===object[key],formatter=function(options){switch(options.arrayFormat){case"index":return key=>(result,value)=>{const index=result.length;return void 0===value||options.skipNull&&null===value||options.skipEmptyString&&""===value?result:null===value?[...result,[encode(key,options),"[",index,"]"].join("")]:[...result,[encode(key,options),"[",encode(index,options),"]=",encode(value,options)].join("")]};case"bracket":return key=>(result,value)=>void 0===value||options.skipNull&&null===value||options.skipEmptyString&&""===value?result:null===value?[...result,[encode(key,options),"[]"].join("")]:[...result,[encode(key,options),"[]=",encode(value,options)].join("")];case"comma":case"separator":return key=>(result,value)=>null==value||0===value.length?result:0===result.length?[[encode(key,options),"=",encode(value,options)].join("")]:[[result,encode(value,options)].join(options.arrayFormatSeparator)];default:return key=>(result,value)=>void 0===value||options.skipNull&&null===value||options.skipEmptyString&&""===value?result:null===value?[...result,encode(key,options)]:[...result,[encode(key,options),"=",encode(value,options)].join("")]}}(options),objectCopy={};for(const key of Object.keys(object))shouldFilter(key)||(objectCopy[key]=object[key]);const keys=Object.keys(objectCopy);return!1!==options.sort&&keys.sort(options.sort),keys.map(key=>{const value=object[key];return void 0===value?"":null===value?encode(key,options):Array.isArray(value)?value.reduce(formatter(key),[]).join("&"):encode(key,options)+"="+encode(value,options)}).filter(x=>x.length>0).join("&")},exports.parseUrl=(input,options)=>{options=Object.assign({decode:!0},options);const[url,hash]=splitOnFirst(input,"#");return Object.assign({url:url.split("?")[0]||"",query:parse(extract(input),options)},options&&options.parseFragmentIdentifier&&hash?{fragmentIdentifier:decode(hash,options)}:{})},exports.stringifyUrl=(input,options)=>{options=Object.assign({encode:!0,strict:!0},options);const url=removeHash(input.url).split("?")[0]||"",queryFromUrl=exports.extract(input.url),parsedQueryFromUrl=exports.parse(queryFromUrl,{sort:!1}),query=Object.assign(parsedQueryFromUrl,input.query);let queryString=exports.stringify(query,options);queryString&&(queryString="?"+queryString);let hash=function(url){let hash="";const hashStart=url.indexOf("#");return-1!==hashStart&&(hash=url.slice(hashStart)),hash}(input.url);return input.fragmentIdentifier&&(hash="#"+encode(input.fragmentIdentifier,options)),`${url}${queryString}${hash}`}},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/home/public");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"ReportingPanelContent",(function(){return ReportingPanelContent}));var _elastic_eui__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(3),_kbn_i18n_react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(2),react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_2__),url__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(20),url__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(url__WEBPACK_IMPORTED_MODULE_3__),_src_plugins_kibana_react_public__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(5),_common_constants__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(1);function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class ReportingPanelContentUi extends react__WEBPACK_IMPORTED_MODULE_2__.Component{constructor(_props){super(_props),_defineProperty(this,"mounted",void 0),_defineProperty(this,"getAbsoluteReportGenerationUrl",props=>{const relativePath=this.props.apiClient.getReportingJobPath(props.reportType,props.getJobParams());return url__WEBPACK_IMPORTED_MODULE_3___default.a.resolve(window.location.href,relativePath)}),_defineProperty(this,"renderGenerateReportButton",isDisabled=>react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_0__.EuiButton,{disabled:isDisabled,fullWidth:!0,fill:!0,onClick:this.createReportingJob,"data-test-subj":"generateReportButton",size:"s"},react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(_kbn_i18n_react__WEBPACK_IMPORTED_MODULE_1__.FormattedMessage,{id:"xpack.reporting.panelContent.generateButtonLabel",defaultMessage:"Generate {reportingType}",values:{reportingType:this.prettyPrintReportingType()}}))),_defineProperty(this,"prettyPrintReportingType",()=>{switch(this.props.reportType){case _common_constants__WEBPACK_IMPORTED_MODULE_5__.PDF_REPORT_TYPE:return"PDF";case"csv_searchsource":return _common_constants__WEBPACK_IMPORTED_MODULE_5__.CSV_REPORT_TYPE;case"png":return _common_constants__WEBPACK_IMPORTED_MODULE_5__.PNG_REPORT_TYPE;default:return this.props.reportType}}),_defineProperty(this,"markAsStale",()=>{this.mounted&&this.setState({isStale:!0})}),_defineProperty(this,"isNotSaved",()=>void 0===this.props.objectId||""===this.props.objectId),_defineProperty(this,"setAbsoluteReportGenerationUrl",()=>{if(!this.mounted)return;const absoluteUrl=this.getAbsoluteReportGenerationUrl(this.props);this.setState({absoluteUrl:absoluteUrl})}),_defineProperty(this,"createReportingJob",()=>{const{intl:intl}=this.props;return this.props.apiClient.createReportingJob(this.props.reportType,this.props.getJobParams()).then(()=>{this.props.toasts.addSuccess({title:intl.formatMessage({id:"xpack.reporting.panelContent.successfullyQueuedReportNotificationTitle",defaultMessage:"Queued report for {objectType}"},{objectType:this.state.objectType}),text:Object(_src_plugins_kibana_react_public__WEBPACK_IMPORTED_MODULE_4__.toMountPoint)(react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(_kbn_i18n_react__WEBPACK_IMPORTED_MODULE_1__.FormattedMessage,{id:"xpack.reporting.panelContent.successfullyQueuedReportNotificationDescription",defaultMessage:"Track its progress in {path}",values:{path:react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("a",{href:this.props.apiClient.getManagementLink()},react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(_kbn_i18n_react__WEBPACK_IMPORTED_MODULE_1__.FormattedMessage,{id:"xpack.reporting.publicNotifier.reportLink.reportingSectionUrlLinkLabel",defaultMessage:"Stack Management > Alerts and Insights > Reporting"}))}})),"data-test-subj":"queueReportSuccess"}),this.props.onClose&&this.props.onClose()}).catch(error=>{var _error$res;if("not exportable"===error.message)return this.props.toasts.addWarning({title:intl.formatMessage({id:"xpack.reporting.panelContent.whatCanBeExportedWarningTitle",defaultMessage:"Only saved {objectType} can be exported"},{objectType:this.state.objectType}),text:Object(_src_plugins_kibana_react_public__WEBPACK_IMPORTED_MODULE_4__.toMountPoint)(react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(_kbn_i18n_react__WEBPACK_IMPORTED_MODULE_1__.FormattedMessage,{id:"xpack.reporting.panelContent.whatCanBeExportedWarningDescription",defaultMessage:"Please save your work first"}))});const defaultMessage=403===(null==error||null===(_error$res=error.res)||void 0===_error$res?void 0:_error$res.status)?react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(_kbn_i18n_react__WEBPACK_IMPORTED_MODULE_1__.FormattedMessage,{id:"xpack.reporting.panelContent.noPermissionToGenerateReportDescription",defaultMessage:"You don't have permission to generate this report."}):react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(_kbn_i18n_react__WEBPACK_IMPORTED_MODULE_1__.FormattedMessage,{id:"xpack.reporting.panelContent.notification.cantReachServerDescription",defaultMessage:"Can't reach the server. Please try again."});this.props.toasts.addDanger({title:intl.formatMessage({id:"xpack.reporting.panelContent.notification.reportingErrorTitle",defaultMessage:"Reporting error"}),text:Object(_src_plugins_kibana_react_public__WEBPACK_IMPORTED_MODULE_4__.toMountPoint)(error.message||defaultMessage),"data-test-subj":"queueReportError"})})});const{objectType:objectType}=_props.getJobParams();this.state={isStale:!1,absoluteUrl:this.getAbsoluteReportGenerationUrl(_props),layoutId:"",objectType:objectType}}componentDidUpdate(prevProps,prevState){this.props.layoutId&&this.props.layoutId!==prevState.layoutId&&this.setState({...prevState,absoluteUrl:this.getAbsoluteReportGenerationUrl(this.props),layoutId:this.props.layoutId})}componentWillUnmount(){window.removeEventListener("hashchange",this.markAsStale),window.removeEventListener("resize",this.setAbsoluteReportGenerationUrl),this.mounted=!1}componentDidMount(){this.mounted=!0,window.addEventListener("hashchange",this.markAsStale,!1),window.addEventListener("resize",this.setAbsoluteReportGenerationUrl)}render(){if(this.isNotSaved()||this.props.isDirty||this.state.isStale)return react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_0__.EuiForm,{className:"kbnShareContextMenu__finalPanel","data-test-subj":"shareReportingForm"},react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_0__.EuiFormRow,{helpText:react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(_kbn_i18n_react__WEBPACK_IMPORTED_MODULE_1__.FormattedMessage,{id:"xpack.reporting.panelContent.saveWorkDescription",defaultMessage:"Please save your work before generating a report."})},this.renderGenerateReportButton(!0)));const reportMsg=react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(_kbn_i18n_react__WEBPACK_IMPORTED_MODULE_1__.FormattedMessage,{id:"xpack.reporting.panelContent.generationTimeDescription",defaultMessage:"{reportingType}s can take a minute or two to generate based upon the size of your {objectType}.",description:"Here 'reportingType' can be 'PDF' or 'CSV'",values:{reportingType:this.prettyPrintReportingType(),objectType:this.state.objectType}});return react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_0__.EuiForm,{className:"kbnShareContextMenu__finalPanel","data-test-subj":"shareReportingForm"},react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_0__.EuiText,{size:"s"},react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("p",null,reportMsg)),react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_0__.EuiSpacer,{size:"s"}),this.props.options,this.renderGenerateReportButton(!1),react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_0__.EuiSpacer,{size:"s"}),react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_0__.EuiText,{size:"s"},react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("p",null,react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(_kbn_i18n_react__WEBPACK_IMPORTED_MODULE_1__.FormattedMessage,{id:"xpack.reporting.panelContent.howToCallGenerationDescription",defaultMessage:"Alternatively, copy this POST URL to call generation from outside Kibana or from Watcher."}))),react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_0__.EuiSpacer,{size:"s"}),react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_0__.EuiCopy,{textToCopy:this.state.absoluteUrl,anchorClassName:"eui-displayBlock"},copy=>react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_0__.EuiButton,{fullWidth:!0,onClick:copy,size:"s"},react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(_kbn_i18n_react__WEBPACK_IMPORTED_MODULE_1__.FormattedMessage,{id:"xpack.reporting.panelContent.copyUrlButtonLabel",defaultMessage:"Copy POST URL"}))))}}const ReportingPanelContent=Object(_kbn_i18n_react__WEBPACK_IMPORTED_MODULE_1__.injectI18n)(ReportingPanelContentUi)},function(module,exports,__webpack_require__){"use strict";var punycode=__webpack_require__(27),util=__webpack_require__(30);function Url(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}exports.parse=urlParse,exports.resolve=function(source,relative){return urlParse(source,!1,!0).resolve(relative)},exports.resolveObject=function(source,relative){return source?urlParse(source,!1,!0).resolveObject(relative):relative},exports.format=function(obj){util.isString(obj)&&(obj=urlParse(obj));return obj instanceof Url?obj.format():Url.prototype.format.call(obj)},exports.Url=Url;var protocolPattern=/^([a-z0-9.+-]+:)/i,portPattern=/:[0-9]*$/,simplePathPattern=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,unwise=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),autoEscape=["'"].concat(unwise),nonHostChars=["%","/","?",";","#"].concat(autoEscape),hostEndingChars=["/","?","#"],hostnamePartPattern=/^[+a-z0-9A-Z_-]{0,63}$/,hostnamePartStart=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,unsafeProtocol={javascript:!0,"javascript:":!0},hostlessProtocol={javascript:!0,"javascript:":!0},slashedProtocol={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},querystring=__webpack_require__(31);function urlParse(url,parseQueryString,slashesDenoteHost){if(url&&util.isObject(url)&&url instanceof Url)return url;var u=new Url;return u.parse(url,parseQueryString,slashesDenoteHost),u}Url.prototype.parse=function(url,parseQueryString,slashesDenoteHost){if(!util.isString(url))throw new TypeError("Parameter 'url' must be a string, not "+typeof url);var queryIndex=url.indexOf("?"),splitter=-1!==queryIndex&&queryIndex<url.indexOf("#")?"?":"#",uSplit=url.split(splitter);uSplit[0]=uSplit[0].replace(/\\/g,"/");var rest=url=uSplit.join(splitter);if(rest=rest.trim(),!slashesDenoteHost&&1===url.split("#").length){var simplePath=simplePathPattern.exec(rest);if(simplePath)return this.path=rest,this.href=rest,this.pathname=simplePath[1],simplePath[2]?(this.search=simplePath[2],this.query=parseQueryString?querystring.parse(this.search.substr(1)):this.search.substr(1)):parseQueryString&&(this.search="",this.query={}),this}var proto=protocolPattern.exec(rest);if(proto){var lowerProto=(proto=proto[0]).toLowerCase();this.protocol=lowerProto,rest=rest.substr(proto.length)}if(slashesDenoteHost||proto||rest.match(/^\/\/[^@\/]+@[^@\/]+/)){var slashes="//"===rest.substr(0,2);!slashes||proto&&hostlessProtocol[proto]||(rest=rest.substr(2),this.slashes=!0)}if(!hostlessProtocol[proto]&&(slashes||proto&&!slashedProtocol[proto])){for(var auth,atSign,hostEnd=-1,i=0;i<hostEndingChars.length;i++){-1!==(hec=rest.indexOf(hostEndingChars[i]))&&(-1===hostEnd||hec<hostEnd)&&(hostEnd=hec)}-1!==(atSign=-1===hostEnd?rest.lastIndexOf("@"):rest.lastIndexOf("@",hostEnd))&&(auth=rest.slice(0,atSign),rest=rest.slice(atSign+1),this.auth=decodeURIComponent(auth)),hostEnd=-1;for(i=0;i<nonHostChars.length;i++){var hec;-1!==(hec=rest.indexOf(nonHostChars[i]))&&(-1===hostEnd||hec<hostEnd)&&(hostEnd=hec)}-1===hostEnd&&(hostEnd=rest.length),this.host=rest.slice(0,hostEnd),rest=rest.slice(hostEnd),this.parseHost(),this.hostname=this.hostname||"";var ipv6Hostname="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!ipv6Hostname)for(var hostparts=this.hostname.split(/\./),l=(i=0,hostparts.length);i<l;i++){var part=hostparts[i];if(part&&!part.match(hostnamePartPattern)){for(var newpart="",j=0,k=part.length;j<k;j++)part.charCodeAt(j)>127?newpart+="x":newpart+=part[j];if(!newpart.match(hostnamePartPattern)){var validParts=hostparts.slice(0,i),notHost=hostparts.slice(i+1),bit=part.match(hostnamePartStart);bit&&(validParts.push(bit[1]),notHost.unshift(bit[2])),notHost.length&&(rest="/"+notHost.join(".")+rest),this.hostname=validParts.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),ipv6Hostname||(this.hostname=punycode.toASCII(this.hostname));var p=this.port?":"+this.port:"",h=this.hostname||"";this.host=h+p,this.href+=this.host,ipv6Hostname&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==rest[0]&&(rest="/"+rest))}if(!unsafeProtocol[lowerProto])for(i=0,l=autoEscape.length;i<l;i++){var ae=autoEscape[i];if(-1!==rest.indexOf(ae)){var esc=encodeURIComponent(ae);esc===ae&&(esc=escape(ae)),rest=rest.split(ae).join(esc)}}var hash=rest.indexOf("#");-1!==hash&&(this.hash=rest.substr(hash),rest=rest.slice(0,hash));var qm=rest.indexOf("?");if(-1!==qm?(this.search=rest.substr(qm),this.query=rest.substr(qm+1),parseQueryString&&(this.query=querystring.parse(this.query)),rest=rest.slice(0,qm)):parseQueryString&&(this.search="",this.query={}),rest&&(this.pathname=rest),slashedProtocol[lowerProto]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){p=this.pathname||"";var s=this.search||"";this.path=p+s}return this.href=this.format(),this},Url.prototype.format=function(){var auth=this.auth||"";auth&&(auth=(auth=encodeURIComponent(auth)).replace(/%3A/i,":"),auth+="@");var protocol=this.protocol||"",pathname=this.pathname||"",hash=this.hash||"",host=!1,query="";this.host?host=auth+this.host:this.hostname&&(host=auth+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(host+=":"+this.port)),this.query&&util.isObject(this.query)&&Object.keys(this.query).length&&(query=querystring.stringify(this.query));var search=this.search||query&&"?"+query||"";return protocol&&":"!==protocol.substr(-1)&&(protocol+=":"),this.slashes||(!protocol||slashedProtocol[protocol])&&!1!==host?(host="//"+(host||""),pathname&&"/"!==pathname.charAt(0)&&(pathname="/"+pathname)):host||(host=""),hash&&"#"!==hash.charAt(0)&&(hash="#"+hash),search&&"?"!==search.charAt(0)&&(search="?"+search),protocol+host+(pathname=pathname.replace(/[?#]/g,(function(match){return encodeURIComponent(match)})))+(search=search.replace("#","%23"))+hash},Url.prototype.resolve=function(relative){return this.resolveObject(urlParse(relative,!1,!0)).format()},Url.prototype.resolveObject=function(relative){if(util.isString(relative)){var rel=new Url;rel.parse(relative,!1,!0),relative=rel}for(var result=new Url,tkeys=Object.keys(this),tk=0;tk<tkeys.length;tk++){var tkey=tkeys[tk];result[tkey]=this[tkey]}if(result.hash=relative.hash,""===relative.href)return result.href=result.format(),result;if(relative.slashes&&!relative.protocol){for(var rkeys=Object.keys(relative),rk=0;rk<rkeys.length;rk++){var rkey=rkeys[rk];"protocol"!==rkey&&(result[rkey]=relative[rkey])}return slashedProtocol[result.protocol]&&result.hostname&&!result.pathname&&(result.path=result.pathname="/"),result.href=result.format(),result}if(relative.protocol&&relative.protocol!==result.protocol){if(!slashedProtocol[relative.protocol]){for(var keys=Object.keys(relative),v=0;v<keys.length;v++){var k=keys[v];result[k]=relative[k]}return result.href=result.format(),result}if(result.protocol=relative.protocol,relative.host||hostlessProtocol[relative.protocol])result.pathname=relative.pathname;else{for(var relPath=(relative.pathname||"").split("/");relPath.length&&!(relative.host=relPath.shift()););relative.host||(relative.host=""),relative.hostname||(relative.hostname=""),""!==relPath[0]&&relPath.unshift(""),relPath.length<2&&relPath.unshift(""),result.pathname=relPath.join("/")}if(result.search=relative.search,result.query=relative.query,result.host=relative.host||"",result.auth=relative.auth,result.hostname=relative.hostname||relative.host,result.port=relative.port,result.pathname||result.search){var p=result.pathname||"",s=result.search||"";result.path=p+s}return result.slashes=result.slashes||relative.slashes,result.href=result.format(),result}var isSourceAbs=result.pathname&&"/"===result.pathname.charAt(0),isRelAbs=relative.host||relative.pathname&&"/"===relative.pathname.charAt(0),mustEndAbs=isRelAbs||isSourceAbs||result.host&&relative.pathname,removeAllDots=mustEndAbs,srcPath=result.pathname&&result.pathname.split("/")||[],psychotic=(relPath=relative.pathname&&relative.pathname.split("/")||[],result.protocol&&!slashedProtocol[result.protocol]);if(psychotic&&(result.hostname="",result.port=null,result.host&&(""===srcPath[0]?srcPath[0]=result.host:srcPath.unshift(result.host)),result.host="",relative.protocol&&(relative.hostname=null,relative.port=null,relative.host&&(""===relPath[0]?relPath[0]=relative.host:relPath.unshift(relative.host)),relative.host=null),mustEndAbs=mustEndAbs&&(""===relPath[0]||""===srcPath[0])),isRelAbs)result.host=relative.host||""===relative.host?relative.host:result.host,result.hostname=relative.hostname||""===relative.hostname?relative.hostname:result.hostname,result.search=relative.search,result.query=relative.query,srcPath=relPath;else if(relPath.length)srcPath||(srcPath=[]),srcPath.pop(),srcPath=srcPath.concat(relPath),result.search=relative.search,result.query=relative.query;else if(!util.isNullOrUndefined(relative.search)){if(psychotic)result.hostname=result.host=srcPath.shift(),(authInHost=!!(result.host&&result.host.indexOf("@")>0)&&result.host.split("@"))&&(result.auth=authInHost.shift(),result.host=result.hostname=authInHost.shift());return result.search=relative.search,result.query=relative.query,util.isNull(result.pathname)&&util.isNull(result.search)||(result.path=(result.pathname?result.pathname:"")+(result.search?result.search:"")),result.href=result.format(),result}if(!srcPath.length)return result.pathname=null,result.search?result.path="/"+result.search:result.path=null,result.href=result.format(),result;for(var last=srcPath.slice(-1)[0],hasTrailingSlash=(result.host||relative.host||srcPath.length>1)&&("."===last||".."===last)||""===last,up=0,i=srcPath.length;i>=0;i--)"."===(last=srcPath[i])?srcPath.splice(i,1):".."===last?(srcPath.splice(i,1),up++):up&&(srcPath.splice(i,1),up--);if(!mustEndAbs&&!removeAllDots)for(;up--;up)srcPath.unshift("..");!mustEndAbs||""===srcPath[0]||srcPath[0]&&"/"===srcPath[0].charAt(0)||srcPath.unshift(""),hasTrailingSlash&&"/"!==srcPath.join("/").substr(-1)&&srcPath.push("");var authInHost,isAbsolute=""===srcPath[0]||srcPath[0]&&"/"===srcPath[0].charAt(0);psychotic&&(result.hostname=result.host=isAbsolute?"":srcPath.length?srcPath.shift():"",(authInHost=!!(result.host&&result.host.indexOf("@")>0)&&result.host.split("@"))&&(result.auth=authInHost.shift(),result.host=result.hostname=authInHost.shift()));return(mustEndAbs=mustEndAbs||result.host&&srcPath.length)&&!isAbsolute&&srcPath.unshift(""),srcPath.length?result.pathname=srcPath.join("/"):(result.pathname=null,result.path=null),util.isNull(result.pathname)&&util.isNull(result.search)||(result.path=(result.pathname?result.pathname:"")+(result.search?result.search:"")),result.auth=relative.auth||result.auth,result.slashes=result.slashes||relative.slashes,result.href=result.format(),result},Url.prototype.parseHost=function(){var host=this.host,port=portPattern.exec(host);port&&(":"!==(port=port[0])&&(this.port=port.substr(1)),host=host.substr(0,host.length-port.length)),host&&(this.hostname=host)}},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/uiActions/public");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__(23);__kbnBundles__.define("plugin/reporting/public",__webpack_require__,34)},function(module,exports,__webpack_require__){__webpack_require__.p=window.__kbnPublicPath__.reporting},function(module,exports,__webpack_require__){"use strict";module.exports=str=>encodeURIComponent(str).replace(/[!'()*]/g,x=>"%"+x.charCodeAt(0).toString(16).toUpperCase())},function(module,exports,__webpack_require__){"use strict";var singleMatcher=new RegExp("%[a-f0-9]{2}","gi"),multiMatcher=new RegExp("(%[a-f0-9]{2})+","gi");function decodeComponents(components,split){try{return decodeURIComponent(components.join(""))}catch(err){}if(1===components.length)return components;split=split||1;var left=components.slice(0,split),right=components.slice(split);return Array.prototype.concat.call([],decodeComponents(left),decodeComponents(right))}function decode(input){try{return decodeURIComponent(input)}catch(err){for(var tokens=input.match(singleMatcher),i=1;i<tokens.length;i++)tokens=(input=decodeComponents(tokens,i).join("")).match(singleMatcher);return input}}module.exports=function(encodedURI){if("string"!=typeof encodedURI)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof encodedURI+"`");try{return encodedURI=encodedURI.replace(/\+/g," "),decodeURIComponent(encodedURI)}catch(err){return function(input){for(var replaceMap={"%FE%FF":"��","%FF%FE":"��"},match=multiMatcher.exec(input);match;){try{replaceMap[match[0]]=decodeURIComponent(match[0])}catch(err){var result=decode(match[0]);result!==match[0]&&(replaceMap[match[0]]=result)}match=multiMatcher.exec(input)}replaceMap["%C2"]="�";for(var entries=Object.keys(replaceMap),i=0;i<entries.length;i++){var key=entries[i];input=input.replace(new RegExp(key,"g"),replaceMap[key])}return input}(encodedURI)}}},function(module,exports,__webpack_require__){"use strict";module.exports=(string,separator)=>{if("string"!=typeof string||"string"!=typeof separator)throw new TypeError("Expected the arguments to be of type `string`");if(""===separator)return[string];const separatorIndex=string.indexOf(separator);return-1===separatorIndex?[string]:[string.slice(0,separatorIndex),string.slice(separatorIndex+separator.length)]}},function(module,exports,__webpack_require__){(function(module,global){var __WEBPACK_AMD_DEFINE_RESULT__;/*! https://mths.be/punycode v1.4.1 by @mathias */!function(root){exports&&exports.nodeType,module&&module.nodeType;var freeGlobal="object"==typeof global&&global;freeGlobal.global!==freeGlobal&&freeGlobal.window!==freeGlobal&&freeGlobal.self;var punycode,maxInt=2147483647,regexPunycode=/^xn--/,regexNonASCII=/[^\x20-\x7E]/,regexSeparators=/[\x2E\u3002\uFF0E\uFF61]/g,errors={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},floor=Math.floor,stringFromCharCode=String.fromCharCode;function error(type){throw new RangeError(errors[type])}function map(array,fn){for(var length=array.length,result=[];length--;)result[length]=fn(array[length]);return result}function mapDomain(string,fn){var parts=string.split("@"),result="";return parts.length>1&&(result=parts[0]+"@",string=parts[1]),result+map((string=string.replace(regexSeparators,".")).split("."),fn).join(".")}function ucs2decode(string){for(var value,extra,output=[],counter=0,length=string.length;counter<length;)(value=string.charCodeAt(counter++))>=55296&&value<=56319&&counter<length?56320==(64512&(extra=string.charCodeAt(counter++)))?output.push(((1023&value)<<10)+(1023&extra)+65536):(output.push(value),counter--):output.push(value);return output}function ucs2encode(array){return map(array,(function(value){var output="";return value>65535&&(output+=stringFromCharCode((value-=65536)>>>10&1023|55296),value=56320|1023&value),output+=stringFromCharCode(value)})).join("")}function digitToBasic(digit,flag){return digit+22+75*(digit<26)-((0!=flag)<<5)}function adapt(delta,numPoints,firstTime){var k=0;for(delta=firstTime?floor(delta/700):delta>>1,delta+=floor(delta/numPoints);delta>455;k+=36)delta=floor(delta/35);return floor(k+36*delta/(delta+38))}function decode(input){var out,basic,j,index,oldi,w,k,digit,t,baseMinusT,codePoint,output=[],inputLength=input.length,i=0,n=128,bias=72;for((basic=input.lastIndexOf("-"))<0&&(basic=0),j=0;j<basic;++j)input.charCodeAt(j)>=128&&error("not-basic"),output.push(input.charCodeAt(j));for(index=basic>0?basic+1:0;index<inputLength;){for(oldi=i,w=1,k=36;index>=inputLength&&error("invalid-input"),((digit=(codePoint=input.charCodeAt(index++))-48<10?codePoint-22:codePoint-65<26?codePoint-65:codePoint-97<26?codePoint-97:36)>=36||digit>floor((maxInt-i)/w))&&error("overflow"),i+=digit*w,!(digit<(t=k<=bias?1:k>=bias+26?26:k-bias));k+=36)w>floor(maxInt/(baseMinusT=36-t))&&error("overflow"),w*=baseMinusT;bias=adapt(i-oldi,out=output.length+1,0==oldi),floor(i/out)>maxInt-n&&error("overflow"),n+=floor(i/out),i%=out,output.splice(i++,0,n)}return ucs2encode(output)}function encode(input){var n,delta,handledCPCount,basicLength,bias,j,m,q,k,t,currentValue,inputLength,handledCPCountPlusOne,baseMinusT,qMinusT,output=[];for(inputLength=(input=ucs2decode(input)).length,n=128,delta=0,bias=72,j=0;j<inputLength;++j)(currentValue=input[j])<128&&output.push(stringFromCharCode(currentValue));for(handledCPCount=basicLength=output.length,basicLength&&output.push("-");handledCPCount<inputLength;){for(m=maxInt,j=0;j<inputLength;++j)(currentValue=input[j])>=n&&currentValue<m&&(m=currentValue);for(m-n>floor((maxInt-delta)/(handledCPCountPlusOne=handledCPCount+1))&&error("overflow"),delta+=(m-n)*handledCPCountPlusOne,n=m,j=0;j<inputLength;++j)if((currentValue=input[j])<n&&++delta>maxInt&&error("overflow"),currentValue==n){for(q=delta,k=36;!(q<(t=k<=bias?1:k>=bias+26?26:k-bias));k+=36)qMinusT=q-t,baseMinusT=36-t,output.push(stringFromCharCode(digitToBasic(t+qMinusT%baseMinusT,0))),q=floor(qMinusT/baseMinusT);output.push(stringFromCharCode(digitToBasic(q,0))),bias=adapt(delta,handledCPCountPlusOne,handledCPCount==basicLength),delta=0,++handledCPCount}++delta,++n}return output.join("")}punycode={version:"1.4.1",ucs2:{decode:ucs2decode,encode:ucs2encode},decode:decode,encode:encode,toASCII:function(input){return mapDomain(input,(function(string){return regexNonASCII.test(string)?"xn--"+encode(string):string}))},toUnicode:function(input){return mapDomain(input,(function(string){return regexPunycode.test(string)?decode(string.slice(4).toLowerCase()):string}))}},void 0===(__WEBPACK_AMD_DEFINE_RESULT__=function(){return punycode}.call(exports,__webpack_require__,exports,module))||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)}()}).call(this,__webpack_require__(28)(module),__webpack_require__(29))},function(module,exports){module.exports=function(module){return module.webpackPolyfill||(module.deprecate=function(){},module.paths=[],module.children||(module.children=[]),Object.defineProperty(module,"loaded",{enumerable:!0,get:function(){return module.l}}),Object.defineProperty(module,"id",{enumerable:!0,get:function(){return module.i}}),module.webpackPolyfill=1),module}},function(module,exports){var g;g=function(){return this}();try{g=g||new Function("return this")()}catch(e){"object"==typeof window&&(g=window)}module.exports=g},function(module,exports,__webpack_require__){"use strict";module.exports={isString:function(arg){return"string"==typeof arg},isObject:function(arg){return"object"==typeof arg&&null!==arg},isNull:function(arg){return null===arg},isNullOrUndefined:function(arg){return null==arg}}},function(module,exports,__webpack_require__){"use strict";exports.decode=exports.parse=__webpack_require__(32),exports.encode=exports.stringify=__webpack_require__(33)},function(module,exports,__webpack_require__){"use strict";function hasOwnProperty(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}module.exports=function(qs,sep,eq,options){sep=sep||"&",eq=eq||"=";var obj={};if("string"!=typeof qs||0===qs.length)return obj;var regexp=/\+/g;qs=qs.split(sep);var maxKeys=1e3;options&&"number"==typeof options.maxKeys&&(maxKeys=options.maxKeys);var len=qs.length;maxKeys>0&&len>maxKeys&&(len=maxKeys);for(var i=0;i<len;++i){var kstr,vstr,k,v,x=qs[i].replace(regexp,"%20"),idx=x.indexOf(eq);idx>=0?(kstr=x.substr(0,idx),vstr=x.substr(idx+1)):(kstr=x,vstr=""),k=decodeURIComponent(kstr),v=decodeURIComponent(vstr),hasOwnProperty(obj,k)?isArray(obj[k])?obj[k].push(v):obj[k]=[obj[k],v]:obj[k]=v}return obj};var isArray=Array.isArray||function(xs){return"[object Array]"===Object.prototype.toString.call(xs)}},function(module,exports,__webpack_require__){"use strict";var stringifyPrimitive=function(v){switch(typeof v){case"string":return v;case"boolean":return v?"true":"false";case"number":return isFinite(v)?v:"";default:return""}};module.exports=function(obj,sep,eq,name){return sep=sep||"&",eq=eq||"=",null===obj&&(obj=void 0),"object"==typeof obj?map(objectKeys(obj),(function(k){var ks=encodeURIComponent(stringifyPrimitive(k))+eq;return isArray(obj[k])?map(obj[k],(function(v){return ks+encodeURIComponent(stringifyPrimitive(v))})).join(sep):ks+encodeURIComponent(stringifyPrimitive(obj[k]))})).join(sep):name?encodeURIComponent(stringifyPrimitive(name))+eq+encodeURIComponent(stringifyPrimitive(obj)):""};var isArray=Array.isArray||function(xs){return"[object Array]"===Object.prototype.toString.call(xs)};function map(xs,f){if(xs.map)return xs.map(f);for(var res=[],i=0;i<xs.length;i++)res.push(f(xs[i],i));return res}var objectKeys=Object.keys||function(obj){var res=[];for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&res.push(key);return res}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"constants",(function(){return constants})),__webpack_require__.d(__webpack_exports__,"getDefaultLayoutSelectors",(function(){return getDefaultLayoutSelectors})),__webpack_require__.d(__webpack_exports__,"ReportingAPIClient",(function(){return reporting_api_client_ReportingAPIClient})),__webpack_require__.d(__webpack_exports__,"Plugin",(function(){return plugin_ReportingPublicPlugin})),__webpack_require__.d(__webpack_exports__,"jobCompletionNotifications",(function(){return job_completion_notifications_namespaceObject})),__webpack_require__.d(__webpack_exports__,"plugin",(function(){return public_plugin}));var job_completion_notifications_namespaceObject={};__webpack_require__.r(job_completion_notifications_namespaceObject),__webpack_require__.d(job_completion_notifications_namespaceObject,"add",(function(){return add})),__webpack_require__.d(job_completion_notifications_namespaceObject,"remove",(function(){return remove}));var constants=__webpack_require__(1);const set=jobs=>{sessionStorage.setItem(constants.JOB_COMPLETION_NOTIFICATIONS_SESSION_KEY,JSON.stringify(jobs))},getAll=()=>{const sessionValue=sessionStorage.getItem(constants.JOB_COMPLETION_NOTIFICATIONS_SESSION_KEY);return sessionValue?JSON.parse(sessionValue):[]},add=jobId=>{const jobs=getAll();jobs.push(jobId),set(jobs)},remove=jobId=>{const jobs=getAll(),index=jobs.indexOf(jobId);if(!index)throw new Error("Unable to find job to remove it");jobs.splice(index,1),set(jobs)};var query_string=__webpack_require__(17),external_kbnSharedDeps_RisonNode_=__webpack_require__(12),external_kbnSharedDeps_RisonNode_default=__webpack_require__.n(external_kbnSharedDeps_RisonNode_);function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class reporting_api_client_ReportingAPIClient{constructor(http){_defineProperty(this,"http",void 0),_defineProperty(this,"list",(page=0,jobIds=[])=>{const query={page:page};return jobIds.length>0&&(query.ids=jobIds.slice(0,10).join(",")),this.http.get(constants.API_LIST_URL+"/list",{query:query,asSystemRequest:!0})}),_defineProperty(this,"findForJobIds",jobIds=>this.http.fetch(constants.API_LIST_URL+"/list",{query:{page:0,ids:jobIds.join(",")},method:"GET"})),_defineProperty(this,"getReportingJobPath",(exportType,jobParams)=>{const params=Object(query_string.stringify)({jobParams:external_kbnSharedDeps_RisonNode_default.a.encode(jobParams)});return`${this.http.basePath.prepend(constants.API_BASE_GENERATE)}/${exportType}?${params}`}),_defineProperty(this,"createReportingJob",async(exportType,jobParams)=>{const jobParamsRison=external_kbnSharedDeps_RisonNode_default.a.encode(jobParams),resp=await this.http.post(`${constants.API_BASE_GENERATE}/${exportType}`,{method:"POST",body:JSON.stringify({jobParams:jobParamsRison})});return add(resp.job.id),resp}),_defineProperty(this,"getManagementLink",()=>this.http.basePath.prepend(constants.REPORTING_MANAGEMENT_HOME)),_defineProperty(this,"getDownloadLink",jobId=>this.http.basePath.prepend(`${constants.API_LIST_URL}/download/${jobId}`)),_defineProperty(this,"getServerBasePath",()=>this.http.basePath.serverBasePath),_defineProperty(this,"verifyConfig",()=>this.http.post(constants.API_BASE_URL+"/diagnose/config",{asSystemRequest:!0})),_defineProperty(this,"verifyBrowser",()=>this.http.post(constants.API_BASE_URL+"/diagnose/browser",{asSystemRequest:!0})),_defineProperty(this,"verifyScreenCapture",()=>this.http.post(constants.API_BASE_URL+"/diagnose/screenshot",{asSystemRequest:!0})),this.http=http}getReportURL(jobId){return`${this.http.basePath.prepend(constants.API_LIST_URL)}/download/${jobId}`}downloadReport(jobId){const location=this.getReportURL(jobId);window.open(location)}async deleteReport(jobId){return await this.http.delete(`${constants.API_LIST_URL}/delete/${jobId}`,{asSystemRequest:!0})}total(){return this.http.get(constants.API_LIST_URL+"/count",{asSystemRequest:!0})}getContent(jobId){return this.http.get(`${constants.API_LIST_URL}/output/${jobId}`,{asSystemRequest:!0})}getInfo(jobId){return this.http.get(`${constants.API_LIST_URL}/info/${jobId}`,{asSystemRequest:!0})}}var external_kbnSharedDeps_KbnI18n_=__webpack_require__(4),external_kbnSharedDeps_Rxjs_=__webpack_require__(7),external_kbnSharedDeps_RxjsOperators_=__webpack_require__(6),public_=__webpack_require__(11),home_public_=__webpack_require__(18);__webpack_require__(10);__webpack_require__(14);const getDefaultLayoutSelectors=()=>({screenshot:"[data-shared-items-container]",renderComplete:"[data-shared-item]",itemsCountAttribute:"data-shared-items-count",timefilterDurationAttribute:"data-shared-timefilter-duration"});var schema_utils=__webpack_require__(15),external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(2),external_kbnSharedDeps_React_=__webpack_require__(0),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),kibanaReact_public_=__webpack_require__(5),external_kbnSharedDeps_ElasticEui_=__webpack_require__(3);const DownloadButton=({getUrl:getUrl,job:job})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{size:"s","data-test-subj":"downloadCompletedReportButton",href:getUrl(job.id),target:"_blank"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.reporting.publicNotifier.downloadReportButtonLabel",defaultMessage:"Download report"})),ReportLink=({getUrl:getUrl})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.reporting.publicNotifier.reportLink.pickItUpFromPathDescription",defaultMessage:"Pick it up from {path}.",values:{path:external_kbnSharedDeps_React_default.a.createElement("a",{href:getUrl()},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.reporting.publicNotifier.reportLink.reportingSectionUrlLinkLabel",defaultMessage:"Stack Management > Alerts and Insights > Reporting"}))}}),getSuccessToast=(job,getReportLink,getDownloadLink)=>({title:Object(kibanaReact_public_.toMountPoint)(external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.reporting.publicNotifier.successfullyCreatedReportNotificationTitle",defaultMessage:"Created report for {reportObjectType} '{reportObjectTitle}'",values:{reportObjectType:job.jobtype,reportObjectTitle:job.title}})),color:"success",text:Object(kibanaReact_public_.toMountPoint)(external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(ReportLink,{getUrl:getReportLink})),external_kbnSharedDeps_React_default.a.createElement(DownloadButton,{getUrl:getDownloadLink,job:job}))),"data-test-subj":"completeReportSuccess"}),getFailureToast=(errorText,job,getManagmenetLink)=>({title:Object(kibanaReact_public_.toMountPoint)(external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.reporting.publicNotifier.error.couldNotCreateReportTitle",defaultMessage:"Could not create report for {reportObjectType} '{reportObjectTitle}'.",values:{reportObjectType:job.jobtype,reportObjectTitle:job.title}})),text:Object(kibanaReact_public_.toMountPoint)(external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{size:"m",title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.reporting.publicNotifier.error.calloutTitle",{defaultMessage:"The reporting job failed"}),color:"danger",iconType:"alert"},errorText),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.reporting.publicNotifier.error.checkManagement",defaultMessage:"More information is available at {path}.",values:{path:external_kbnSharedDeps_React_default.a.createElement("a",{href:getManagmenetLink()},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.reporting.publicNotifier.error.reportingSectionUrlLinkLabel",defaultMessage:"Management > Kibana > Reporting"}))}})))),iconType:void 0,"data-test-subj":"completeReportFailure"}),getWarningFormulasToast=(job,getReportLink,getDownloadLink)=>({title:Object(kibanaReact_public_.toMountPoint)(external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.reporting.publicNotifier.csvContainsFormulas.formulaReportTitle",defaultMessage:"Report may contain formulas {reportObjectType} '{reportObjectTitle}'",values:{reportObjectType:job.jobtype,reportObjectTitle:job.title}})),text:Object(kibanaReact_public_.toMountPoint)(external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.reporting.publicNotifier.csvContainsFormulas.formulaReportMessage",defaultMessage:"The report contains characters which spreadsheet applications can interpret as formulas."})),external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(ReportLink,{getUrl:getReportLink})),external_kbnSharedDeps_React_default.a.createElement(DownloadButton,{getUrl:getDownloadLink,job:job}))),"data-test-subj":"completeReportCsvFormulasWarning"}),getWarningMaxSizeToast=(job,getReportLink,getDownloadLink)=>({title:Object(kibanaReact_public_.toMountPoint)(external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.reporting.publicNotifier.maxSizeReached.partialReportTitle",defaultMessage:"Created partial report for {reportObjectType} '{reportObjectTitle}'",values:{reportObjectType:job.jobtype,reportObjectTitle:job.title}})),text:Object(kibanaReact_public_.toMountPoint)(external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.reporting.publicNotifier.maxSizeReached.partialReportDescription",defaultMessage:"The report reached the max size and contains partial data."})),external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(ReportLink,{getUrl:getReportLink})),external_kbnSharedDeps_React_default.a.createElement(DownloadButton,{getUrl:getDownloadLink,job:job}))),"data-test-subj":"completeReportMaxSizeWarning"}),getGeneralErrorToast=(errorText,err)=>({text:Object(kibanaReact_public_.toMountPoint)(external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:errorText,color:"danger",iconType:"alert"},err.toString()),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.reporting.publicNotifier.error.tryRefresh",defaultMessage:"Try refreshing the page."}))),iconType:void 0});var screen_capture_panel_content=__webpack_require__(16);function getReportStatus(src){var _src$_source$output,_src$_source$output2;return{id:src._id,status:src._source.status,title:src._source.payload.title,jobtype:src._source.jobtype,maxSizeReached:null===(_src$_source$output=src._source.output)||void 0===_src$_source$output?void 0:_src$_source$output.max_size_reached,csvContainsFormulas:null===(_src$_source$output2=src._source.output)||void 0===_src$_source$output2?void 0:_src$_source$output2.csv_contains_formulas}}class stream_handler_ReportingNotifierStreamHandler{constructor(notifications,apiClient){this.notifications=notifications,this.apiClient=apiClient}showNotifications({completed:completedJobs,failed:failedJobs}){return external_kbnSharedDeps_Rxjs_.from((async()=>{for(const job of completedJobs)job.csvContainsFormulas?this.notifications.toasts.addWarning(getWarningFormulasToast(job,this.apiClient.getManagementLink,this.apiClient.getDownloadLink)):job.maxSizeReached?this.notifications.toasts.addWarning(getWarningMaxSizeToast(job,this.apiClient.getManagementLink,this.apiClient.getDownloadLink)):this.notifications.toasts.addSuccess(getSuccessToast(job,this.apiClient.getManagementLink,this.apiClient.getDownloadLink));for(const job of failedJobs){const{content:content}=await this.apiClient.getContent(job.id);this.notifications.toasts.addDanger(getFailureToast(content,job,this.apiClient.getManagementLink))}return{completed:completedJobs,failed:failedJobs}})())}findChangedStatusJobs(storedJobs){return external_kbnSharedDeps_Rxjs_.from(this.apiClient.findForJobIds(storedJobs)).pipe(Object(external_kbnSharedDeps_RxjsOperators_.map)(jobs=>{const completedJobs=[],failedJobs=[],pending=[];for(const job of jobs){const{_id:jobId,_source:{status:jobStatus}}=job;storedJobs.includes(jobId)&&(jobStatus===constants.JOB_STATUSES.COMPLETED||jobStatus===constants.JOB_STATUSES.WARNINGS?completedJobs.push(getReportStatus(job)):jobStatus===constants.JOB_STATUSES.FAILED?failedJobs.push(getReportStatus(job)):pending.push(jobId))}var jobIds;return jobIds=pending,sessionStorage.setItem(constants.JOB_COMPLETION_NOTIFICATIONS_SESSION_KEY,JSON.stringify(jobIds)),{completed:completedJobs,failed:failedJobs}}),Object(external_kbnSharedDeps_RxjsOperators_.catchError)(err=>(this.notifications.toasts.addDanger(getGeneralErrorToast(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.reporting.publicNotifier.httpErrorMessage",{defaultMessage:"Could not check Reporting job status!"}),err)),window.console.error(err),external_kbnSharedDeps_Rxjs_.of({completed:[],failed:[]}))))}}var external_kbnSharedDeps_MomentTimezone_=__webpack_require__(9),external_kbnSharedDeps_MomentTimezone_default=__webpack_require__.n(external_kbnSharedDeps_MomentTimezone_),discover_public_=__webpack_require__(13),uiActions_public_=__webpack_require__(21),license_check=__webpack_require__(8);function get_csv_panel_action_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class get_csv_panel_action_GetCsvReportPanelAction{constructor(core,license$){get_csv_panel_action_defineProperty(this,"isDownloading",void 0),get_csv_panel_action_defineProperty(this,"type",""),get_csv_panel_action_defineProperty(this,"id",constants.CSV_REPORTING_ACTION),get_csv_panel_action_defineProperty(this,"canDownloadCSV",!1),get_csv_panel_action_defineProperty(this,"core",void 0),get_csv_panel_action_defineProperty(this,"isCompatible",async context=>{if(!this.canDownloadCSV)return!1;const{embeddable:embeddable}=context;return embeddable.getInput().viewMode!==public_.ViewMode.EDIT&&"search"===embeddable.type}),get_csv_panel_action_defineProperty(this,"execute",async context=>{const{embeddable:embeddable}=context;if(!function(embeddable){return embeddable.type===discover_public_.SEARCH_EMBEDDABLE_TYPE}(embeddable))throw new uiActions_public_.IncompatibleActionError;if(this.isDownloading)return;const savedSearch=embeddable.getSavedSearch(),{columns:columns,searchSource:searchSource}=await this.getSearchSource(savedSearch,embeddable),kibanaTimezone=this.core.uiSettings.get("dateFormat:tz"),immediateJobParams={searchSource:searchSource,columns:columns,browserTimezone:"Browser"===kibanaTimezone?external_kbnSharedDeps_MomentTimezone_default.a.tz.guess():kibanaTimezone,title:savedSearch.title},body=JSON.stringify(immediateJobParams);this.isDownloading=!0,this.core.notifications.toasts.addSuccess({title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.reporting.dashboard.csvDownloadStartedTitle",{defaultMessage:"CSV Download Started"}),text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.reporting.dashboard.csvDownloadStartedMessage",{defaultMessage:"Your CSV will download momentarily."}),"data-test-subj":"csvDownloadStarted"}),await this.core.http.post(""+constants.API_GENERATE_IMMEDIATE,{body:body}).then(rawResponse=>{this.isDownloading=!1;const download=savedSearch.title+".csv",blob=new Blob([rawResponse],{type:"text/csv;charset=utf-8;"});if(window.navigator.msSaveOrOpenBlob)return window.navigator.msSaveOrOpenBlob(blob,download);const a=window.document.createElement("a"),downloadObject=window.URL.createObjectURL(blob);a.href=downloadObject,a.download=download,document.body.appendChild(a),a.click(),window.URL.revokeObjectURL(downloadObject),document.body.removeChild(a)}).catch(this.onGenerationFail.bind(this))}),this.isDownloading=!1,this.core=core,license$.subscribe(license=>{const results=license.check("reporting","basic"),{showLinks:showLinks}=Object(license_check.a)(results);this.canDownloadCSV=showLinks})}getIconType(){return"document"}getDisplayName(){return external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.reporting.dashboard.downloadCsvPanelTitle",{defaultMessage:"Download CSV"})}async getSearchSource(savedSearch,embeddable){const{getSharingData:getSharingData}=await Object(discover_public_.loadSharingDataHelpers)();return await getSharingData(savedSearch.searchSource,savedSearch,this.core.uiSettings)}onGenerationFail(error){this.isDownloading=!1,this.core.notifications.toasts.addDanger({title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.reporting.dashboard.failedCsvDownloadTitle",{defaultMessage:"CSV download failed"}),text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.reporting.dashboard.failedCsvDownloadMessage",{defaultMessage:"We couldn't generate your CSV at this time."}),"data-test-subj":"downloadCsvFail"})}}const PanelSpinner=props=>external_kbnSharedDeps_React_.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),external_kbnSharedDeps_React_.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceAround"},external_kbnSharedDeps_React_.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingSpinner,{size:"l"}))),external_kbnSharedDeps_React_.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null)),LazyComponent=Object(external_kbnSharedDeps_React_.lazy)(()=>Promise.resolve().then(__webpack_require__.bind(null,19)).then(({ReportingPanelContent:ReportingPanelContent})=>({default:ReportingPanelContent}))),ReportingPanelContent=props=>external_kbnSharedDeps_React_.createElement(external_kbnSharedDeps_React_.Suspense,{fallback:external_kbnSharedDeps_React_.createElement(PanelSpinner,null)},external_kbnSharedDeps_React_.createElement(LazyComponent,props)),screen_capture_panel_content_lazy_LazyComponent=Object(external_kbnSharedDeps_React_.lazy)(()=>Promise.resolve().then(__webpack_require__.bind(null,16)).then(({ScreenCapturePanelContent:ScreenCapturePanelContent})=>({default:ScreenCapturePanelContent}))),ScreenCapturePanelContent=props=>external_kbnSharedDeps_React_.createElement(external_kbnSharedDeps_React_.Suspense,{fallback:external_kbnSharedDeps_React_.createElement(PanelSpinner,null)},external_kbnSharedDeps_React_.createElement(screen_capture_panel_content_lazy_LazyComponent,props));function plugin_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class plugin_ReportingPublicPlugin{constructor(initializerContext){plugin_defineProperty(this,"contract",{components:{ScreenCapturePanel:screen_capture_panel_content.ScreenCapturePanelContent},getDefaultLayoutSelectors:getDefaultLayoutSelectors,ReportingAPIClient:reporting_api_client_ReportingAPIClient}),plugin_defineProperty(this,"stop$",new external_kbnSharedDeps_Rxjs_.ReplaySubject(1)),plugin_defineProperty(this,"title",external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.reporting.management.reportingTitle",{defaultMessage:"Reporting"})),plugin_defineProperty(this,"breadcrumbText",external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.reporting.breadcrumb",{defaultMessage:"Reporting"})),plugin_defineProperty(this,"config",void 0),this.config=initializerContext.config.get()}setup(core,{home:home,management:management,licensing:licensing,uiActions:uiActions,share:share}){const{http:http,notifications:{toasts:toasts},getStartServices:getStartServices,uiSettings:uiSettings}=core,{license$:license$}=licensing,apiClient=new reporting_api_client_ReportingAPIClient(http),action=new get_csv_panel_action_GetCsvReportPanelAction(core,license$);return home.featureCatalogue.register({id:"reporting",title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.reporting.registerFeature.reportingTitle",{defaultMessage:"Reporting"}),description:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.reporting.registerFeature.reportingDescription",{defaultMessage:"Manage your reports generated from Discover, Visualize, and Dashboard."}),icon:"reportingApp",path:"/app/management/insightsAndAlerting/reporting",showOnHomePage:!1,category:home_public_.FeatureCatalogueCategory.ADMIN}),management.sections.section.insightsAndAlerting.registerApp({id:"reporting",title:this.title,order:1,mount:async params=>{params.setBreadcrumbs([{text:this.breadcrumbText}]);const[[start],{mountManagementSection:mountManagementSection}]=await Promise.all([getStartServices(),__webpack_require__.e(1).then(__webpack_require__.bind(null,37))]);return await mountManagementSection(core,start,license$,this.config.poll,apiClient,params)}}),uiActions.addTriggerAction(public_.CONTEXT_MENU_TRIGGER,action),share.register((({apiClient:apiClient,toasts:toasts,license$:license$,uiSettings:uiSettings})=>{let toolTipContent="",disabled=!0,hasCSVReporting=!1;license$.subscribe(license=>{const{enableLinks:enableLinks,showLinks:showLinks,message:message}=Object(license_check.a)(license.check("reporting","basic"));toolTipContent=message,hasCSVReporting=showLinks,disabled=!enableLinks});const browserTimezone="Browser"===uiSettings.get("dateFormat:tz")?external_kbnSharedDeps_MomentTimezone_default.a.tz.guess():uiSettings.get("dateFormat:tz");return{id:"csvReports",getShareMenuItems:({objectType:objectType,objectId:objectId,sharingData:sharingData,onClose:onClose,isDirty:isDirty})=>{if("search"!==objectType)return[];const jobParams={browserTimezone:browserTimezone,title:sharingData.title,objectType:objectType,searchSource:sharingData.searchSource,columns:sharingData.columns},getJobParams=()=>jobParams,shareActions=[];if(hasCSVReporting){const panelTitle=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.reporting.shareContextMenu.csvReportsButtonLabel",{defaultMessage:"CSV Reports"});shareActions.push({shareMenuItem:{name:panelTitle,icon:"document",toolTipContent:toolTipContent,disabled:disabled,"data-test-subj":"csvReportMenuItem",sortOrder:1},panel:{id:"csvReportingPanel",title:panelTitle,content:external_kbnSharedDeps_React_default.a.createElement(ReportingPanelContent,{apiClient:apiClient,toasts:toasts,reportType:constants.CSV_JOB_TYPE,layoutId:void 0,objectId:objectId,getJobParams:getJobParams,isDirty:isDirty,onClose:onClose})}})}return shareActions}}})({apiClient:apiClient,toasts:toasts,license$:license$,uiSettings:uiSettings})),share.register((({apiClient:apiClient,toasts:toasts,license$:license$,uiSettings:uiSettings})=>{let toolTipContent="",disabled=!0,hasPDFPNGReporting=!1;license$.subscribe(license=>{const{enableLinks:enableLinks,showLinks:showLinks,message:message}=Object(license_check.a)(license.check("reporting","gold"));toolTipContent=message,hasPDFPNGReporting=showLinks,disabled=!enableLinks});const browserTimezone="Browser"===uiSettings.get("dateFormat:tz")?external_kbnSharedDeps_MomentTimezone_default.a.tz.guess():uiSettings.get("dateFormat:tz");return{id:"screenCaptureReports",getShareMenuItems:({objectType:objectType,objectId:objectId,sharingData:sharingData,isDirty:isDirty,onClose:onClose,shareableUrl:shareableUrl})=>{if(!["dashboard","visualization"].includes(objectType))return[];const getPdfJobParams=()=>{const relativeUrl=shareableUrl.replace(window.location.origin+apiClient.getServerBasePath(),"");return{objectType:objectType,browserTimezone:browserTimezone,relativeUrls:[relativeUrl],layout:sharingData.layout,title:sharingData.title}},getPngJobParams=()=>{const relativeUrl=shareableUrl.replace(window.location.origin+apiClient.getServerBasePath(),"");return{objectType:objectType,browserTimezone:browserTimezone,relativeUrl:relativeUrl,layout:sharingData.layout,title:sharingData.title}},shareActions=[];if(hasPDFPNGReporting){const pngPanelTitle=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.reporting.shareContextMenu.pngReportsButtonLabel",{defaultMessage:"PNG Reports"}),pdfPanelTitle=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.reporting.shareContextMenu.pdfReportsButtonLabel",{defaultMessage:"PDF Reports"});shareActions.push({shareMenuItem:{name:pngPanelTitle,icon:"document",toolTipContent:toolTipContent,disabled:disabled,"data-test-subj":"pngReportMenuItem",sortOrder:10},panel:{id:"reportingPngPanel",title:pngPanelTitle,content:external_kbnSharedDeps_React_default.a.createElement(ScreenCapturePanelContent,{apiClient:apiClient,toasts:toasts,reportType:"png",objectId:objectId,getJobParams:getPngJobParams,isDirty:isDirty,onClose:onClose})}}),shareActions.push({shareMenuItem:{name:pdfPanelTitle,icon:"document",toolTipContent:toolTipContent,disabled:disabled,"data-test-subj":"pdfReportMenuItem",sortOrder:10},panel:{id:"reportingPdfPanel",title:pdfPanelTitle,content:external_kbnSharedDeps_React_default.a.createElement(ScreenCapturePanelContent,{apiClient:apiClient,toasts:toasts,reportType:"printablePdf",objectId:objectId,getJobParams:getPdfJobParams,isDirty:isDirty,onClose:onClose})}})}return shareActions}}})({apiClient:apiClient,toasts:toasts,license$:license$,uiSettings:uiSettings})),this.contract}start(core){const{http:http,notifications:notifications}=core,apiClient=new reporting_api_client_ReportingAPIClient(http),streamHandler=new stream_handler_ReportingNotifierStreamHandler(notifications,apiClient),interval=Object(schema_utils.a)(this.config.poll.jobsRefresh.interval);return external_kbnSharedDeps_Rxjs_.timer(0,interval).pipe(Object(external_kbnSharedDeps_RxjsOperators_.takeUntil)(this.stop$),Object(external_kbnSharedDeps_RxjsOperators_.map)(()=>function(){const sessionValue=sessionStorage.getItem(constants.JOB_COMPLETION_NOTIFICATIONS_SESSION_KEY);return sessionValue?JSON.parse(sessionValue):[]}()),Object(external_kbnSharedDeps_RxjsOperators_.filter)(storedJobs=>storedJobs.length>0),Object(external_kbnSharedDeps_RxjsOperators_.mergeMap)(storedJobs=>streamHandler.findChangedStatusJobs(storedJobs)),Object(external_kbnSharedDeps_RxjsOperators_.mergeMap)(({completed:completed,failed:failed})=>streamHandler.showNotifications({completed:completed,failed:failed})),Object(external_kbnSharedDeps_RxjsOperators_.catchError)(err=>function(notifications,err){return notifications.toasts.addDanger(getGeneralErrorToast(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.reporting.publicNotifier.pollingErrorMessage",{defaultMessage:"Reporting notifier error!"}),err)),window.console.error(err),external_kbnSharedDeps_Rxjs_.of({completed:[],failed:[]})}(notifications,err))).subscribe(),this.contract}stop(){this.stop$.next()}}function public_plugin(initializerContext){return new plugin_ReportingPublicPlugin(initializerContext)}},function(module,exports){module.exports=__kbnSharedDeps__.ReactDom},function(module,exports){module.exports=__kbnSharedDeps__.Moment}]);