/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.apm_bundle_jsonpfunction=window.apm_bundle_jsonpfunction||[]).push([[9],{1246:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_RESULT__;
/*!
  Copyright (c) 2017 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/!function(){"use strict";var hasOwn={}.hasOwnProperty;function classNames(){for(var classes=[],i=0;i<arguments.length;i++){var arg=arguments[i];if(arg){var argType=typeof arg;if("string"===argType||"number"===argType)classes.push(arg);else if(Array.isArray(arg)&&arg.length){var inner=classNames.apply(null,arg);inner&&classes.push(inner)}else if("object"===argType)for(var key in arg)hasOwn.call(arg,key)&&arg[key]&&classes.push(key)}}return classes.join(" ")}module.exports?(classNames.default=classNames,module.exports=classNames):void 0===(__WEBPACK_AMD_DEFINE_RESULT__=function(){return classNames}.apply(exports,[]))||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)}()},1247:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var react_1=__webpack_require__(2),defaultTarget=__webpack_require__(254).isClient?window:null,isListenerType1=function(target){return!!target.addEventListener},isListenerType2=function(target){return!!target.on};exports.default=function(name,handler,target,options){void 0===target&&(target=defaultTarget),react_1.useEffect((function(){if(handler&&target)return isListenerType1(target)?target.addEventListener(name,handler,options):isListenerType2(target)&&target.on(name,handler,options),function(){isListenerType1(target)?target.removeEventListener(name,handler,options):isListenerType2(target)&&target.off(name,handler,options)}}),[name,handler,target,JSON.stringify(options)])}},1253:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"rumRoutes",(function(){return rumRoutes})),__webpack_require__.d(__webpack_exports__,"CsmAppRoot",(function(){return CsmAppRoot})),__webpack_require__.d(__webpack_exports__,"renderApp",(function(){return renderApp}));var external_kbnSharedDeps_Theme_euiDarkVars_=__webpack_require__(31),external_kbnSharedDeps_Theme_euiDarkVars_default=__webpack_require__.n(external_kbnSharedDeps_Theme_euiDarkVars_),external_kbnSharedDeps_Theme_euiLightVars_=__webpack_require__(26),external_kbnSharedDeps_Theme_euiLightVars_default=__webpack_require__.n(external_kbnSharedDeps_Theme_euiLightVars_),external_kbnSharedDeps_React_=__webpack_require__(2),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),external_kbnSharedDeps_ReactDom_=__webpack_require__(34),external_kbnSharedDeps_ReactDom_default=__webpack_require__.n(external_kbnSharedDeps_ReactDom_),external_kbnSharedDeps_ReactRouterDom_=__webpack_require__(16),external_kbnSharedDeps_StyledComponents_=__webpack_require__(20),external_kbnSharedDeps_StyledComponents_default=__webpack_require__.n(external_kbnSharedDeps_StyledComponents_),common_=__webpack_require__(18),public_=__webpack_require__(21),route_config=__webpack_require__(767),ScrollToTopOnPathChange=__webpack_require__(764),external_kbnSharedDeps_ElasticEui_=__webpack_require__(15),external_kbnSharedDeps_KbnI18n_=__webpack_require__(0),observability_public_=__webpack_require__(6),variables=__webpack_require__(9);const BadgeText=common_.euiStyled.div`
  display: inline-block;
  ${Object(variables.truncate)(Object(variables.px)(8*variables.unit))};
  vertical-align: middle;
`,removeFilterLabel=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.uifilter.badge.removeFilter",{defaultMessage:"Remove filter"});function FilterBadgeList({onRemove:onRemove,value:value,name:name}){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGrid,{gutterSize:"s",id:"local-filter-values-"+name},value.map(val=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{key:val,grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBadge,{color:"hollow",onClick:()=>{onRemove(val)},onClickAriaLabel:removeFilterLabel,iconOnClick:()=>{onRemove(val)},iconOnClickAriaLabel:removeFilterLabel,iconType:"cross",iconSide:"right"},external_kbnSharedDeps_React_default.a.createElement(BadgeText,null,val)))))}const Button=Object(common_.euiStyled)(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty).attrs(()=>({contentProps:{className:"alignLeft"},color:"text"}))`
  width: 100%;

  .alignLeft {
    justify-content: flex-start;
    padding-left: 0;
  }
`;function FilterTitleButton(props){return external_kbnSharedDeps_React_default.a.createElement(Button,props,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"xxxs",textTransform:"uppercase"},external_kbnSharedDeps_React_default.a.createElement("h4",null,props.children)))}const Popover=Object(common_.euiStyled)(external_kbnSharedDeps_ElasticEui_.EuiPopover).attrs(()=>({anchorClassName:"anchor"}))`
  .anchor {
    display: block;
  }
`,SelectContainer=common_.euiStyled.div`
  width: ${Object(variables.px)(16*variables.unit)};
`,Counter=common_.euiStyled.div`
  border-radius: ${({theme:theme})=>theme.eui.euiBorderRadius};
  background: ${({theme:theme})=>theme.eui.euiColorLightShade};
  padding: 0 ${({theme:theme})=>theme.eui.paddingSizes.xs};
`,ApplyButton=Object(common_.euiStyled)(external_kbnSharedDeps_ElasticEui_.EuiButton)`
  align-self: flex-end;
`,FlexItem=Object(common_.euiStyled)(external_kbnSharedDeps_ElasticEui_.EuiFlexItem)`
  flex-basis: auto !important;
`;function Filter({name:name,title:title,options:options,onChange:onChange,value:value,showCount:showCount}){const[showPopover,setShowPopover]=Object(external_kbnSharedDeps_React_.useState)(!1),toggleShowPopover=()=>setShowPopover(show=>!show),button=external_kbnSharedDeps_React_default.a.createElement(FilterTitleButton,{onClick:toggleShowPopover},title),items=Object(external_kbnSharedDeps_React_.useMemo)(()=>options.map(option=>({label:option.name,append:showCount?external_kbnSharedDeps_React_default.a.createElement(Counter,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs"},option.count)):null,checked:value.includes(option.name)?"on":void 0})),[value,options,showCount]),[visibleOptions,setVisibleOptions]=Object(external_kbnSharedDeps_React_.useState)(items);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{setVisibleOptions(items)},[items]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(Popover,{id:"local-filter-"+name,closePopover:toggleShowPopover,button:button,isOpen:showPopover,panelPaddingSize:"s",anchorPosition:"downLeft"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSelectable,{onChange:selectedOptions=>{setVisibleOptions(selectedOptions)},options:visibleOptions,searchable:!0},(list,search)=>external_kbnSharedDeps_React_default.a.createElement(SelectContainer,{id:"local-filter-popover-"+name},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"column",gutterSize:"none"},external_kbnSharedDeps_React_default.a.createElement(FlexItem,{grow:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"xxxs",textTransform:"uppercase"},external_kbnSharedDeps_React_default.a.createElement("h4",null,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.applyFilter",{defaultMessage:"Apply {title} filter",values:{title:title}}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHorizontalRule,{margin:"none"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),search,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),list,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"})),external_kbnSharedDeps_React_default.a.createElement(FlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(ApplyButton,{"data-cy":"applyFilter",color:"primary",fill:!0,onClick:()=>{const newValue=visibleOptions.filter(option=>"on"===option.checked).map(option=>option.label);setShowPopover(!1),onChange(newValue)},size:"s"},external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.applyOptions",{defaultMessage:"Apply options"}))))))),value.length?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(FilterBadgeList,{name:name,onRemove:val=>{onChange(value.filter(v=>val!==v))},value:value}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"})):null)}var external_kbnSharedDeps_Lodash_=__webpack_require__(17),pick_keys=__webpack_require__(108),local_ui_filters_config=__webpack_require__(240),url_helpers=__webpack_require__(48),helpers=__webpack_require__(92),use_url_params=__webpack_require__(42),use_fetcher=__webpack_require__(43);function useLocalUIFilters({filterNames:filterNames,params:params,shouldFetch:shouldFetch}){var _data$localUiFilters;const history=Object(external_kbnSharedDeps_ReactRouterDom_.useHistory)(),{uiFilters:uiFilters,urlParams:urlParams}=Object(use_url_params.a)(),values=Object(pick_keys.a)(uiFilters,...filterNames),{data:data,status:status}=Object(use_fetcher.b)(callApmApi=>{if(shouldFetch&&urlParams.start&&urlParams.end)return callApmApi({endpoint:"GET /api/apm/rum/local_filters",params:{query:{uiFilters:JSON.stringify(uiFilters),start:urlParams.start,end:urlParams.end,filterNames:JSON.stringify(filterNames),...params}}})},[uiFilters,urlParams.start,urlParams.end,filterNames,params,shouldFetch]);return{filters:(null!==(_data$localUiFilters=null==data?void 0:data.localUiFilters)&&void 0!==_data$localUiFilters?_data$localUiFilters:(filterNames=>filterNames.map(filterName=>({options:[],...local_ui_filters_config.b[filterName]})))(filterNames)).map(filter=>({...filter,value:values[filter.name]||[]})),status:status,setFilterValue:(name,value)=>{const search=Object(external_kbnSharedDeps_Lodash_.omit)(Object(url_helpers.e)(history.location.search),name);history.push({...history.location,search:Object(url_helpers.b)(Object(helpers.b)({...search,[name]:value.length?value.join(","):void 0}))})},clearValues:()=>{const search=Object(external_kbnSharedDeps_Lodash_.omit)(Object(url_helpers.e)(history.location.search),filterNames);history.push({...history.location,search:Object(url_helpers.b)(search)})}}}var use_break_points=__webpack_require__(94);function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const ButtonWrapper=common_.euiStyled.div`
  display: inline-block;
`;function LocalUIFilters({params:params,filterNames:filterNames,children:children,showCount:showCount=!0,shouldFetch:shouldFetch=!0}){const{filters:filters,setFilterValue:setFilterValue,clearValues:clearValues}=useLocalUIFilters({filterNames:filterNames,params:params,shouldFetch:shouldFetch}),hasValues=filters.some(filter=>filter.value.length>0),{isSmall:isSmall}=Object(use_break_points.a)(),title=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"s"},external_kbnSharedDeps_React_default.a.createElement("h3",null,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.localFiltersTitle",{defaultMessage:"Filters"}))),content=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,children,filters.map(filter=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,{key:filter.name},external_kbnSharedDeps_React_default.a.createElement(Filter,_extends({},filter,{onChange:value=>{setFilterValue(filter.name,value)},showCount:showCount})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHorizontalRule,{margin:"none"}))),hasValues?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(ButtonWrapper,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{size:"xs",iconType:"cross",flush:"left",onClick:clearValues,"data-cy":"clearFilters"},external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.clearFilters",{defaultMessage:"Clear filters"})))):null);return isSmall?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiAccordion,{id:"uxFilterAccordion",buttonContent:title},content):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,title,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),content)}const I18LABELS={dataMissing:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.rum.dashboard.dataMissing",{defaultMessage:"N/A"}),totalPageLoad:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.rum.dashboard.totalPageLoad",{defaultMessage:"Total"}),backEnd:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.rum.dashboard.backend",{defaultMessage:"Backend"}),frontEnd:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.rum.dashboard.frontend",{defaultMessage:"Frontend"}),pageViews:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.rum.dashboard.pageViews",{defaultMessage:"Total page views"}),percPageLoaded:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.rum.dashboard.pagesLoaded.label",{defaultMessage:"Pages loaded"}),pageLoadTime:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.rum.dashboard.pageLoadTime.label",{defaultMessage:"Page load time (seconds)"}),pageLoadTimes:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.rum.dashboard.pageLoadTimes.label",{defaultMessage:"Page load times"}),pageLoadDuration:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.rum.dashboard.pageLoadDuration.label",{defaultMessage:"Page load duration"}),pageLoad:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.rum.dashboard.pageLoad.label",{defaultMessage:"Page load"}),pageLoadDistribution:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.rum.dashboard.pageLoadDistribution.label",{defaultMessage:"Page load distribution"}),jsErrors:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.rum.dashboard.impactfulMetrics.jsErrors",{defaultMessage:"JavaScript errors"}),highTrafficPages:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.rum.dashboard.impactfulMetrics.highTrafficPages",{defaultMessage:"High traffic pages"}),resetZoom:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.rum.dashboard.resetZoom.label",{defaultMessage:"Reset zoom"}),overall:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.rum.dashboard.overall.label",{defaultMessage:"Overall"}),selectBreakdown:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.rum.filterGroup.selectBreakdown",{defaultMessage:"Select breakdown"}),breakdown:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.rum.filterGroup.breakdown",{defaultMessage:"Breakdown"}),seconds:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.rum.filterGroup.seconds",{defaultMessage:"seconds"}),coreWebVitals:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.rum.filterGroup.coreWebVitals",{defaultMessage:"Core web vitals"}),browser:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.rum.visitorBreakdown.browser",{defaultMessage:"Browser"}),operatingSystem:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.rum.visitorBreakdown.operatingSystem",{defaultMessage:"Operating system"}),metrics:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.ux.metrics",{defaultMessage:"Metrics"}),median:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.ux.median",{defaultMessage:"median"}),avgPageLoadDuration:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.rum.visitorBreakdownMap.avgPageLoadDuration",{defaultMessage:"Average page load duration"}),pageLoadDurationByRegion:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.rum.visitorBreakdownMap.pageLoadDurationByRegion",{defaultMessage:"Page load duration by region (avg.)"}),searchByUrl:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.rum.filters.searchByUrl",{defaultMessage:"Search by URL"}),getSearchResultsLabel:total=>external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.rum.filters.searchResults",{defaultMessage:"{total} Search results",values:{total:total}}),topPages:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.rum.filters.topPages",{defaultMessage:"Top pages"}),select:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.rum.filters.select",{defaultMessage:"Select"}),url:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.rum.filters.url",{defaultMessage:"Url"}),loadingResults:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.rum.filters.url.loadingResults",{defaultMessage:"Loading results"}),noResults:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.rum.filters.url.noResults",{defaultMessage:"No results available"}),totalErrors:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.rum.jsErrors.totalErrors",{defaultMessage:"Total errors"}),errorRate:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.rum.jsErrors.errorRate",{defaultMessage:"Error rate"}),errorMessage:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.rum.jsErrors.errorMessage",{defaultMessage:"Error message"}),impactedPageLoads:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.rum.jsErrors.impactedPageLoads",{defaultMessage:"Impacted page loads"}),percentile:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.ux.percentile.label",{defaultMessage:"Percentile"}),percentile50thMedian:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.ux.percentile.50thMedian",{defaultMessage:"50th (Median)"}),percentile75th:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.ux.percentile.75th",{defaultMessage:"75th"}),percentile90th:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.ux.percentile.90th",{defaultMessage:"90th"}),percentile95th:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.ux.percentile.95th",{defaultMessage:"95th"}),percentile99th:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.ux.percentile.99th",{defaultMessage:"99th"}),noData:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.ux.visitorBreakdown.noData",{defaultMessage:"No data."}),totalPageLoadTooltip:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.rum.dashboard.tooltips.totalPageLoad",{defaultMessage:"Total represents the full page load duration"}),frontEndTooltip:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.rum.dashboard.tooltips.frontEnd",{defaultMessage:"Frontend time represents the total page load duration minus the backend time"}),backEndTooltip:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.rum.dashboard.tooltips.backEnd",{defaultMessage:"Backend time represents time to first byte (TTFB), which is when the first response packet is received after the request has been made"})},VisitorBreakdownLabel=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.rum.visitorBreakdown",{defaultMessage:"Visitor breakdown"});var external_kbnSharedDeps_ElasticNumeral_=__webpack_require__(23),external_kbnSharedDeps_ElasticNumeral_default=__webpack_require__.n(external_kbnSharedDeps_ElasticNumeral_);const DATA_UNDEFINED_LABEL=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.rum.coreVitals.dataUndefined",{defaultMessage:"N/A"}),FCP_LABEL=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.rum.coreVitals.fcp",{defaultMessage:"First contentful paint"}),FCP_TOOLTIP=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.rum.coreVitals.fcpTooltip",{defaultMessage:"First contentful paint (FCP) focusses on the initial rendering and measures the time from when the page starts loading to when any part of the page’s content is displayed on the screen."}),TBT_LABEL=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.rum.coreVitals.tbt",{defaultMessage:"Total blocking time"}),TBT_TOOLTIP=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.rum.coreVitals.tbtTooltip",{defaultMessage:"Total blocking time (TBT) is the sum of the blocking time (duration above 50 ms) for each long task that occurs between the First contentful paint and the time when the transaction is completed."}),NO_OF_LONG_TASK=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.rum.uxMetrics.noOfLongTasks",{defaultMessage:"No. of long tasks"}),NO_OF_LONG_TASK_TOOLTIP=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.rum.uxMetrics.noOfLongTasksTooltip",{defaultMessage:"The number of long tasks, a long task is defined as any user activity or browser task that monopolizes the UI thread for extended periods (greater than 50 milliseconds) and blocks other critical tasks (frame rate or input latency) from being executed."}),LONGEST_LONG_TASK=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.rum.uxMetrics.longestLongTasks",{defaultMessage:"Longest long task duration"}),LONGEST_LONG_TASK_TOOLTIP=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.rum.uxMetrics.longestLongTasksTooltip",{defaultMessage:"The duration of the longest long task, a long task is defined as any user activity or browser task that monopolizes the UI thread for extended periods (greater than 50 milliseconds) and blocks other critical tasks (frame rate or input latency) from being executed."}),SUM_LONG_TASKS=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.rum.uxMetrics.sumLongTasks",{defaultMessage:"Total long tasks duration"}),SUM_LONG_TASKS_TOOLTIP=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.rum.uxMetrics.sumLongTasksTooltip",{defaultMessage:"The total duration of long tasks, a long task is defined as any user activity or browser task that monopolizes the UI thread for extended periods (greater than 50 milliseconds) and blocks other critical tasks (frame rate or input latency) from being executed."}),getPercentileLabel=value=>50===value?I18LABELS.median:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.ux.percentiles.label",{defaultMessage:"{value}th Perc.",values:{value:value}});function useUxQuery(){const{urlParams:urlParams,uiFilters:uiFilters}=Object(use_url_params.a)(),{start:start,end:end,searchTerm:searchTerm,percentile:percentile}=urlParams;return Object(external_kbnSharedDeps_React_.useMemo)(()=>{const{serviceName:serviceName}=uiFilters;return start&&end&&serviceName&&percentile?{start:start,end:end,percentile:String(percentile),urlQuery:searchTerm||void 0,uiFilters:JSON.stringify(uiFilters)}:null},[start,end,searchTerm,percentile,uiFilters])}function formatToSec(value,fromUnit="MicroSec"){const valueInMs=Number(null!=value?value:0)/("MicroSec"===fromUnit?1e3:1);return valueInMs<1e3?valueInMs.toFixed(0)+" ms":(valueInMs/1e3).toFixed(2)+" s"}const KeyUXMetrics_STAT_STYLE={width:"200px"};function formatTitle(unit,value){return null==value?DATA_UNDEFINED_LABEL:formatToSec(value,unit)}function KeyUXMetrics({data:data,loading:loading}){const uxQuery=useUxQuery(),{data:longTaskData,status:status}=Object(use_fetcher.b)(callApmApi=>uxQuery?callApmApi({endpoint:"GET /api/apm/rum-client/long-task-metrics",params:{query:{...uxQuery}}}):Promise.resolve(null),[uxQuery]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{wrap:!0,responsive:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,style:KeyUXMetrics_STAT_STYLE},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiStat,{titleSize:"s",title:formatTitle("ms",null==data?void 0:data.fcp),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,FCP_LABEL,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIconTip,{content:FCP_TOOLTIP,type:"questionInCircle"})),isLoading:loading})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,style:KeyUXMetrics_STAT_STYLE},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiStat,{titleSize:"s",title:formatTitle("ms",null==data?void 0:data.tbt),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,TBT_LABEL,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIconTip,{content:TBT_TOOLTIP,type:"questionInCircle"})),isLoading:loading})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,style:KeyUXMetrics_STAT_STYLE},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiStat,{titleSize:"s",title:void 0!==(null==longTaskData?void 0:longTaskData.noOfLongTasks)?external_kbnSharedDeps_ElasticNumeral_default()(null==longTaskData?void 0:longTaskData.noOfLongTasks).format("0,0"):DATA_UNDEFINED_LABEL,description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,NO_OF_LONG_TASK,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIconTip,{content:NO_OF_LONG_TASK_TOOLTIP,type:"questionInCircle"})),isLoading:"success"!==status})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,style:KeyUXMetrics_STAT_STYLE},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiStat,{titleSize:"s",title:formatTitle("ms",null==longTaskData?void 0:longTaskData.longestLongTask),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,LONGEST_LONG_TASK,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIconTip,{content:LONGEST_LONG_TASK_TOOLTIP,type:"questionInCircle"})),isLoading:"success"!==status})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,style:KeyUXMetrics_STAT_STYLE},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiStat,{titleSize:"s",title:formatTitle("ms",null==longTaskData?void 0:longTaskData.sumOfLongTasks),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,SUM_LONG_TASKS,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIconTip,{content:SUM_LONG_TASKS_TOOLTIP,type:"questionInCircle"})),isLoading:"success"!==status})))}const defaultContext={sharedData:{totalPageViews:0},setSharedData:d=>{throw new Error("setSharedData was not initialized, set it when you invoke the context")}},CsmSharedContext=Object(external_kbnSharedDeps_React_.createContext)(defaultContext);function CsmSharedContextProvider({children:children}){const[newData,setNewData]=Object(external_kbnSharedDeps_React_.useState)({totalPageViews:0}),setSharedData=external_kbnSharedDeps_React_default.a.useCallback(data=>{setNewData(data)},[]),value=Object(external_kbnSharedDeps_React_.useMemo)(()=>({sharedData:newData,setSharedData:setSharedData}),[newData,setSharedData]);return external_kbnSharedDeps_React_default.a.createElement(CsmSharedContext.Provider,{value:value,children:children})}function UXMetrics(){const{urlParams:{percentile:percentile}}=Object(use_url_params.a)(),uxQuery=useUxQuery(),{data:data,status:status}=Object(use_fetcher.b)(callApmApi=>uxQuery?callApmApi({endpoint:"GET /api/apm/rum-client/web-core-vitals",params:{query:uxQuery}}):Promise.resolve(null),[uxQuery]),{sharedData:{totalPageViews:totalPageViews}}=Object(external_kbnSharedDeps_React_.useContext)(CsmSharedContext),CoreVitals=Object(external_kbnSharedDeps_React_.useMemo)(()=>Object(observability_public_.getCoreVitalsComponent)({data:data,totalPageViews:totalPageViews,loading:"success"!==status,displayTrafficMetric:!0}),[status]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPanel,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceBetween",wrap:!0,responsive:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:1,"data-cy":"client-metrics"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("h3",null,I18LABELS.metrics," (",getPercentileLabel(percentile),")")),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(KeyUXMetrics,{data:data,loading:"success"!==status}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHorizontalRule,{margin:"xs"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceBetween",wrap:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:1,"data-cy":"client-metrics"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),CoreVitals)))}var external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(24),ErrorDetailLink=__webpack_require__(163);function JSErrors(){var _data$totalErrors,_data$items,_data$totalErrorGroup;const{urlParams:urlParams,uiFilters:uiFilters}=Object(use_url_params.a)(),{start:start,end:end,serviceName:serviceName,searchTerm:searchTerm}=urlParams,[pagination,setPagination]=Object(external_kbnSharedDeps_React_.useState)({pageIndex:0,pageSize:5}),{data:data,status:status}=Object(use_fetcher.b)(callApmApi=>start&&end&&serviceName?callApmApi({endpoint:"GET /api/apm/rum-client/js-errors",params:{query:{start:start,end:end,urlQuery:searchTerm||void 0,uiFilters:JSON.stringify(uiFilters),pageSize:String(pagination.pageSize),pageIndex:String(pagination.pageIndex)}}}):Promise.resolve(null),[start,end,serviceName,uiFilters,pagination,searchTerm]),{sharedData:{totalPageViews:totalPageViews}}=Object(external_kbnSharedDeps_React_.useContext)(CsmSharedContext),cols=[{field:"errorMessage",name:I18LABELS.errorMessage,render:(errorMessage,item)=>external_kbnSharedDeps_React_default.a.createElement(ErrorDetailLink.a,{serviceName:serviceName,errorGroupId:item.errorGroupId},errorMessage)},{name:I18LABELS.impactedPageLoads,field:"count",align:"right",render:count=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.apm.ux.jsErrors.percent",defaultMessage:"{pageLoadPercent} %",values:{pageLoadPercent:(count/totalPageViews*100).toFixed(1)}})}],totalErrors=null!==(_data$totalErrors=null==data?void 0:data.totalErrors)&&void 0!==_data$totalErrors?_data$totalErrors:0;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("h3",null,I18LABELS.jsErrors)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiStat,{"data-test-subj":"uxJsErrorsTotal",titleSize:"s",title:totalErrors<1e3?totalErrors:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{content:totalErrors},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_ElasticNumeral_default()(totalErrors).format("0 a"))),description:I18LABELS.totalErrors,isLoading:"success"!==status}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBasicTable,{"data-test-subj":"uxJsErrorTable",loading:"success"!==status,responsive:!1,compressed:!0,columns:cols,items:null!==(_data$items=null==data?void 0:data.items)&&void 0!==_data$items?_data$items:[],onChange:({page:page})=>{setPagination({pageIndex:page.index,pageSize:page.size})},pagination:{...pagination,totalItemCount:null!==(_data$totalErrorGroup=null==data?void 0:data.totalErrorGroups)&&void 0!==_data$totalErrorGroup?_data$totalErrorGroup:0}}))}function ImpactfulMetrics(){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPanel,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{wrap:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{style:{flexBasis:650}},external_kbnSharedDeps_React_default.a.createElement(JSErrors,null))))}var elasticsearch_fieldnames=__webpack_require__(55);function BreakdownFilter({selectedBreakdown:selectedBreakdown,onBreakdownChange:onBreakdownChange,dataTestSubj:dataTestSubj}){var _selectedBreakdown$fi;const items=[{name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.csm.breakDownFilter.noBreakdown",{defaultMessage:"No breakdown"}),fieldName:"noBreakdown",type:"category"},{name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.csm.breakdownFilter.browser",{defaultMessage:"Browser"}),fieldName:elasticsearch_fieldnames.L,type:"category"},{name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.csm.breakdownFilter.os",{defaultMessage:"OS"}),fieldName:elasticsearch_fieldnames.M,type:"category"},{name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.csm.breakdownFilter.device",{defaultMessage:"Device"}),fieldName:elasticsearch_fieldnames.K,type:"category"},{name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.csm.breakdownFilter.location",{defaultMessage:"Location"}),fieldName:elasticsearch_fieldnames.b,type:"category"}],options=items.map(({name:name,fieldName:fieldName})=>({inputDisplay:"noBreakdown"===fieldName?name:external_kbnSharedDeps_React_default.a.createElement("strong",null,name),value:fieldName,dropdownDisplay:name}));return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSuperSelect,{fullWidth:!0,compressed:!0,options:options,valueOfSelected:null!==(_selectedBreakdown$fi=null==selectedBreakdown?void 0:selectedBreakdown.fieldName)&&void 0!==_selectedBreakdown$fi?_selectedBreakdown$fi:"noBreakdown",onChange:value=>(value=>{onBreakdownChange("noBreakdown"===value?null:items.find(({fieldName:fieldName})=>fieldName===value))})(value),"data-test-subj":dataTestSubj})}var external_kbnSharedDeps_ElasticCharts_=__webpack_require__(19),external_kbnSharedDeps_ElasticEuiChartsTheme_=__webpack_require__(30);function PercentileAnnotations({percentiles:percentiles}){var _generateAnnotationDa;const dataValues=null!==(values=percentiles,_generateAnnotationDa=Object.entries(null!=values?values:{}).map(value=>({dataValue:value[1],details:""+(+value[0]).toFixed(0)})))&&void 0!==_generateAnnotationDa?_generateAnnotationDa:[];var values;const style={line:{strokeWidth:1,stroke:external_kbnSharedDeps_Theme_euiLightVars_default.a.euiColorSecondary,opacity:1}};function PercentileTooltip({annotation:annotation}){return external_kbnSharedDeps_React_.createElement("span",{"data-cy":"percentileTooltipTitle"},annotation.details,"th Percentile")}return external_kbnSharedDeps_React_.createElement(external_kbnSharedDeps_React_.Fragment,null,dataValues.map((annotation,index)=>external_kbnSharedDeps_React_.createElement(external_kbnSharedDeps_ElasticCharts_.LineAnnotation,{id:index+"annotation_"+annotation.dataValue,key:index+"percentile_"+annotation.dataValue,domainType:external_kbnSharedDeps_ElasticCharts_.AnnotationDomainType.XDomain,dataValues:[annotation],style:style,hideTooltips:!0,markerPosition:external_kbnSharedDeps_ElasticCharts_.Position.Top,marker:external_kbnSharedDeps_React_.createElement("span",{"data-cy":"percentile-markers"},external_kbnSharedDeps_React_.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{title:external_kbnSharedDeps_React_.createElement(PercentileTooltip,{annotation:annotation}),content:external_kbnSharedDeps_React_.createElement("span",null,"Pages loaded: ",Math.round(annotation.dataValue))},external_kbnSharedDeps_React_.createElement(external_kbnSharedDeps_React_.Fragment,null,annotation.details,"th")))})))}function ChartWrapper_extends(){return(ChartWrapper_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function ChartWrapper({loading:loading=!1,height:height="100%",maxWidth:maxWidth,children:children,...rest}){const opacity=!0===loading?.3:1;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiErrorBoundary,null,external_kbnSharedDeps_React_default.a.createElement("div",ChartWrapper_extends({style:{height:height,opacity:opacity,transition:"opacity 0.2s",...maxWidth?{maxWidth:maxWidth}:{}}},rest),children),!0===loading&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceAround",alignItems:"center",style:{height:height,marginTop:"-"+height,marginBottom:0,...maxWidth?{maxWidth:maxWidth}:{}}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingChart,{size:"xl"}))))}function BreakdownSeries({field:field,value:value,percentileRange:percentileRange,onLoadingChange:onLoadingChange}){const[darkMode]=Object(public_.useUiSetting$)("theme:darkMode"),euiChartTheme=darkMode?external_kbnSharedDeps_ElasticEuiChartsTheme_.EUI_CHARTS_THEME_DARK:external_kbnSharedDeps_ElasticEuiChartsTheme_.EUI_CHARTS_THEME_LIGHT,{breakdowns:breakdowns,status:status}=(({percentileRange:percentileRange,field:field,value:value})=>{var _data$pageLoadDistBre;const{urlParams:urlParams,uiFilters:uiFilters}=Object(use_url_params.a)(),{start:start,end:end,searchTerm:searchTerm}=urlParams,{min:minP,max:maxP}=null!=percentileRange?percentileRange:{},{data:data,status:status}=Object(use_fetcher.b)(callApmApi=>{if(start&&end&&field&&value)return callApmApi({endpoint:"GET /api/apm/rum-client/page-load-distribution/breakdown",params:{query:{start:start,end:end,breakdown:value,uiFilters:JSON.stringify(uiFilters),urlQuery:searchTerm,...minP&&maxP?{minPercentile:String(minP),maxPercentile:String(maxP)}:{}}}})},[end,start,uiFilters,field,value,minP,maxP,searchTerm]);return{breakdowns:null!==(_data$pageLoadDistBre=null==data?void 0:data.pageLoadDistBreakdown)&&void 0!==_data$pageLoadDistBre?_data$pageLoadDistBre:[],status:status}})({field:field,value:value,percentileRange:percentileRange});return Object(external_kbnSharedDeps_React_.useEffect)(()=>{onLoadingChange("success"!==status)},[status,onLoadingChange]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,breakdowns.map(({data:seriesData,name:name},sortIndex)=>{var _euiChartTheme$theme$,_euiChartTheme$theme$2;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_.LineSeries,{id:`${field}-${value}-${name}`,key:`${field}-${value}-${name}`,name:name,xScaleType:external_kbnSharedDeps_ElasticCharts_.ScaleType.Linear,yScaleType:external_kbnSharedDeps_ElasticCharts_.ScaleType.Linear,curve:external_kbnSharedDeps_ElasticCharts_.CurveType.CURVE_CATMULL_ROM,data:null!=seriesData?seriesData:[],lineSeriesStyle:{point:{visible:!1}},fit:external_kbnSharedDeps_ElasticCharts_.Fit.Linear,color:null===(_euiChartTheme$theme$=euiChartTheme.theme.colors)||void 0===_euiChartTheme$theme$||null===(_euiChartTheme$theme$2=_euiChartTheme$theme$.vizColors)||void 0===_euiChartTheme$theme$2?void 0:_euiChartTheme$theme$2[0===sortIndex?0:sortIndex+1],tickFormat:d=>external_kbnSharedDeps_ElasticNumeral_default()(d).format("0.0")+" %"})}))}const PageLoadChart=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticCharts_.Chart).withConfig({displayName:"PageLoadChart",componentId:"h0xeca-0"})([".echAnnotation{pointer-events:initial;}"]);function PageLoadDistChart({onPercentileChange:onPercentileChange,data:data,breakdown:breakdown,loading:loading,percentileRange:percentileRange}){var _data$pageLoadDistrib,_euiChartTheme$theme$,_euiChartTheme$theme$2;const[breakdownLoading,setBreakdownLoading]=Object(external_kbnSharedDeps_React_.useState)(!1),tooltipProps={headerFormatter:tooltip=>external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement("p",null,tooltip.value," ",I18LABELS.seconds))},[darkMode]=Object(public_.useUiSetting$)("theme:darkMode"),euiChartTheme=darkMode?external_kbnSharedDeps_ElasticEuiChartsTheme_.EUI_CHARTS_THEME_DARK:external_kbnSharedDeps_ElasticEuiChartsTheme_.EUI_CHARTS_THEME_LIGHT;return external_kbnSharedDeps_React_default.a.createElement(ChartWrapper,{loading:loading||breakdownLoading,height:"250px"},(!loading||data)&&external_kbnSharedDeps_React_default.a.createElement(PageLoadChart,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_.Settings,{baseTheme:darkMode?external_kbnSharedDeps_ElasticCharts_.DARK_THEME:external_kbnSharedDeps_ElasticCharts_.LIGHT_THEME,theme:euiChartTheme.theme,onBrushEnd:({x:x})=>{if(!x)return;const[minX,maxX]=x;onPercentileChange(minX,maxX)},tooltip:tooltipProps,showLegend:!0}),external_kbnSharedDeps_React_default.a.createElement(PercentileAnnotations,{percentiles:null==data?void 0:data.percentiles}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_.Axis,{id:"bottom",title:I18LABELS.pageLoadTime,position:external_kbnSharedDeps_ElasticCharts_.Position.Bottom}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_.Axis,{id:"left",title:I18LABELS.percPageLoaded,position:external_kbnSharedDeps_ElasticCharts_.Position.Left,labelFormat:d=>d+" %"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_.LineSeries,{sortIndex:0,fit:external_kbnSharedDeps_ElasticCharts_.Fit.Linear,id:"PagesPercentage",name:I18LABELS.overall,xScaleType:external_kbnSharedDeps_ElasticCharts_.ScaleType.Linear,yScaleType:external_kbnSharedDeps_ElasticCharts_.ScaleType.Linear,data:null!==(_data$pageLoadDistrib=null==data?void 0:data.pageLoadDistribution)&&void 0!==_data$pageLoadDistrib?_data$pageLoadDistrib:[],curve:external_kbnSharedDeps_ElasticCharts_.CurveType.CURVE_CATMULL_ROM,lineSeriesStyle:{point:{visible:!1},line:{strokeWidth:3}},color:null===(_euiChartTheme$theme$=euiChartTheme.theme.colors)||void 0===_euiChartTheme$theme$||null===(_euiChartTheme$theme$2=_euiChartTheme$theme$.vizColors)||void 0===_euiChartTheme$theme$2?void 0:_euiChartTheme$theme$2[1],tickFormat:d=>external_kbnSharedDeps_ElasticNumeral_default()(d).format("0.0")+" %"}),breakdown&&external_kbnSharedDeps_React_default.a.createElement(BreakdownSeries,{key:`${breakdown.type}-${breakdown.name}`,field:breakdown.type,value:breakdown.name,percentileRange:percentileRange,onLoadingChange:bLoading=>{setBreakdownLoading(bLoading)}})))}function ResetPercentileZoom({percentileRange:percentileRange,setPercentileRange:setPercentileRange}){const onClick=()=>{setPercentileRange({min:null,max:null})};return null===percentileRange.min&&null===percentileRange.max?null:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiShowFor,{sizes:["xs"]},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{iconType:"inspect",size:"s","aria-label":I18LABELS.resetZoom,onClick:onClick})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHideFor,{sizes:["xs"]},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{iconType:"inspect",size:"s",onClick:onClick},I18LABELS.resetZoom)))}function PageLoadDistribution(){var _data$pageLoadDistrib,_data$pageLoadDistrib2;const{services:{http:http}}=Object(public_.useKibana)(),{urlParams:urlParams,uiFilters:uiFilters}=Object(use_url_params.a)(),{start:start,end:end,rangeFrom:rangeFrom,rangeTo:rangeTo,searchTerm:searchTerm}=urlParams,{serviceName:serviceName}=uiFilters,[percentileRange,setPercentileRange]=Object(external_kbnSharedDeps_React_.useState)({min:null,max:null}),[breakdown,setBreakdown]=Object(external_kbnSharedDeps_React_.useState)(null),{data:data,status:status}=Object(use_fetcher.b)(callApmApi=>start&&end&&serviceName?callApmApi({endpoint:"GET /api/apm/rum-client/page-load-distribution",params:{query:{start:start,end:end,uiFilters:JSON.stringify(uiFilters),urlQuery:searchTerm,...percentileRange.min&&percentileRange.max?{minPercentile:String(percentileRange.min),maxPercentile:String(percentileRange.max)}:{}}}}):Promise.resolve(null),[end,start,uiFilters,percentileRange.min,percentileRange.max,searchTerm,serviceName]);Object(observability_public_.createExploratoryViewUrl)({[serviceName+"-page-views"]:{dataType:"ux",reportType:"pld",time:{from:rangeFrom,to:rangeTo},reportDefinitions:{"service.name":serviceName},...breakdown?{breakdown:breakdown.fieldName}:{}}},null==http?void 0:http.basePath.get());return external_kbnSharedDeps_React_default.a.createElement("div",{"data-cy":"pageLoadDist"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{responsive:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("h3",null,I18LABELS.pageLoadDistribution))),external_kbnSharedDeps_React_default.a.createElement(ResetPercentileZoom,{percentileRange:percentileRange,setPercentileRange:setPercentileRange}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,style:{width:170}},external_kbnSharedDeps_React_default.a.createElement(BreakdownFilter,{selectedBreakdown:breakdown,onBreakdownChange:setBreakdown,dataTestSubj:"pldBreakdownFilter"})),!1),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(PageLoadDistChart,{data:null==data?void 0:data.pageLoadDistribution,onPercentileChange:(min,max)=>{setPercentileRange({min:min,max:max})},loading:"success"!==status,breakdown:breakdown,percentileRange:{max:percentileRange.max||(null==data||null===(_data$pageLoadDistrib=data.pageLoadDistribution)||void 0===_data$pageLoadDistrib?void 0:_data$pageLoadDistrib.maxDuration),min:percentileRange.min||(null==data||null===(_data$pageLoadDistrib2=data.pageLoadDistribution)||void 0===_data$pageLoadDistrib2?void 0:_data$pageLoadDistrib2.minDuration)}}))}var external_kbnSharedDeps_Moment_=__webpack_require__(22),external_kbnSharedDeps_Moment_default=__webpack_require__.n(external_kbnSharedDeps_Moment_);function PageViewsChart({data:data,loading:loading}){var _data$topItems,_data$topItems2,_data$items,_euiChartTheme$theme$,_euiChartTheme$theme$2;const history=Object(external_kbnSharedDeps_ReactRouterDom_.useHistory)(),{urlParams:urlParams}=Object(use_url_params.a)(),{start:start,end:end}=urlParams,diffInDays=external_kbnSharedDeps_Moment_default()(new Date(end)).diff(external_kbnSharedDeps_Moment_default()(new Date(start)),"day"),formatter=Object(external_kbnSharedDeps_ElasticCharts_.timeFormatter)(Object(external_kbnSharedDeps_ElasticCharts_.niceTimeFormatByDay)(diffInDays>1?2:1)),hasBreakdowns=!(null==data||null===(_data$topItems=data.topItems)||void 0===_data$topItems||!_data$topItems.length),breakdownAccessors=null!=data&&null!==(_data$topItems2=data.topItems)&&void 0!==_data$topItems2&&_data$topItems2.length?null==data?void 0:data.topItems:["y"],[darkMode]=Object(public_.useUiSetting$)("theme:darkMode"),euiChartTheme=darkMode?external_kbnSharedDeps_ElasticEuiChartsTheme_.EUI_CHARTS_THEME_DARK:external_kbnSharedDeps_ElasticEuiChartsTheme_.EUI_CHARTS_THEME_LIGHT;return external_kbnSharedDeps_React_default.a.createElement(ChartWrapper,{loading:loading,height:"250px"},(!loading||data)&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_.Chart,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_.Settings,{baseTheme:darkMode?external_kbnSharedDeps_ElasticCharts_.DARK_THEME:external_kbnSharedDeps_ElasticCharts_.LIGHT_THEME,theme:euiChartTheme.theme,showLegend:!0,onBrushEnd:({x:x})=>{if(!x)return;const[minX,maxX]=x,rangeFrom=external_kbnSharedDeps_Moment_default()(minX).toISOString(),rangeTo=external_kbnSharedDeps_Moment_default()(maxX).toISOString();history.push({...history.location,search:Object(url_helpers.b)({...Object(url_helpers.e)(history.location.search),rangeFrom:rangeFrom,rangeTo:rangeTo})})},xDomain:{min:new Date(start).valueOf(),max:new Date(end).valueOf()}}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_.Axis,{id:"date_time",position:external_kbnSharedDeps_ElasticCharts_.Position.Bottom,tickFormat:formatter}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_.Axis,{id:"page_views",title:I18LABELS.pageViews,position:external_kbnSharedDeps_ElasticCharts_.Position.Left,tickFormat:d=>external_kbnSharedDeps_ElasticNumeral_default()(d).format("0"),labelFormat:d=>external_kbnSharedDeps_ElasticNumeral_default()(d).format("0a")}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_.BarSeries,{id:I18LABELS.pageViews,xScaleType:external_kbnSharedDeps_ElasticCharts_.ScaleType.Time,yScaleType:external_kbnSharedDeps_ElasticCharts_.ScaleType.Linear,xAccessor:"x",yAccessors:Array.from(breakdownAccessors),stackAccessors:["x"],data:null!==(_data$items=null==data?void 0:data.items)&&void 0!==_data$items?_data$items:[],name:({yAccessor:yAccessor})=>"y"===yAccessor?I18LABELS.overall:yAccessor,color:hasBreakdowns||null===(_euiChartTheme$theme$=euiChartTheme.theme.colors)||void 0===_euiChartTheme$theme$||null===(_euiChartTheme$theme$2=_euiChartTheme$theme$.vizColors)||void 0===_euiChartTheme$theme$2?void 0:_euiChartTheme$theme$2[1]})))}function PageViewsTrend(){const{services:{http:http}}=Object(public_.useKibana)(),{urlParams:urlParams,uiFilters:uiFilters}=Object(use_url_params.a)(),{serviceName:serviceName}=uiFilters,{start:start,end:end,searchTerm:searchTerm,rangeTo:rangeTo,rangeFrom:rangeFrom}=urlParams,[breakdown,setBreakdown]=Object(external_kbnSharedDeps_React_.useState)(null),{data:data,status:status}=Object(use_fetcher.b)(callApmApi=>start&&end&&serviceName?callApmApi({endpoint:"GET /api/apm/rum-client/page-view-trends",params:{query:{start:start,end:end,uiFilters:JSON.stringify(uiFilters),urlQuery:searchTerm,...breakdown?{breakdowns:JSON.stringify(breakdown)}:{}}}}):Promise.resolve(void 0),[start,end,serviceName,uiFilters,searchTerm,breakdown]);Object(observability_public_.createExploratoryViewUrl)({[serviceName+"-page-views"]:{dataType:"ux",reportType:"kpi",time:{from:rangeFrom,to:rangeTo},reportDefinitions:{"service.name":serviceName},...breakdown?{breakdown:breakdown.fieldName}:{}}},null==http?void 0:http.basePath.get());return external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{responsive:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("h3",null,I18LABELS.pageViews))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,style:{width:170}},external_kbnSharedDeps_React_default.a.createElement(BreakdownFilter,{selectedBreakdown:breakdown,onBreakdownChange:setBreakdown,dataTestSubj:"pvBreakdownFilter"})),!1),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(PageViewsChart,{data:data,loading:"success"!==status}))}function PageLoadAndViews(){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s",wrap:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{style:{flexBasis:650}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPanel,null,external_kbnSharedDeps_React_default.a.createElement(PageLoadDistribution,null))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{style:{flexBasis:650}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPanel,null,external_kbnSharedDeps_React_default.a.createElement(PageViewsTrend,null))))}const StyleChart=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"StyleChart",componentId:"sc-1d1m9rm-0"})(["height:100%;"]),theme={legend:{verticalWidth:100}};function VisitorBreakdownChart({loading:loading,options:options}){const[darkMode]=Object(public_.useUiSetting$)("theme:darkMode"),euiChartTheme=darkMode?external_kbnSharedDeps_ElasticEuiChartsTheme_.EUI_CHARTS_THEME_DARK:external_kbnSharedDeps_ElasticEuiChartsTheme_.EUI_CHARTS_THEME_LIGHT;return external_kbnSharedDeps_React_default.a.createElement(ChartWrapper,{loading:loading,height:"245px",maxWidth:"430px"},external_kbnSharedDeps_React_default.a.createElement(StyleChart,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_.Chart,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_.Settings,{showLegend:!0,baseTheme:darkMode?external_kbnSharedDeps_ElasticCharts_.DARK_THEME:external_kbnSharedDeps_ElasticCharts_.LIGHT_THEME,theme:theme}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_.Partition,{id:"spec_1",data:null!=options&&options.length?options:[{count:1,name:I18LABELS.noData}],valueAccessor:d=>d.count,valueGetter:"percent",percentFormatter:d=>Math.round(100*(d+Number.EPSILON))/100+"%",layers:[{groupByRollup:d=>d.name,shape:{fillColor:d=>{var _euiChartTheme$theme$,_euiChartTheme$theme$2;return null===(_euiChartTheme$theme$=euiChartTheme.theme.colors)||void 0===_euiChartTheme$theme$||null===(_euiChartTheme$theme$2=_euiChartTheme$theme$.vizColors)||void 0===_euiChartTheme$theme$2?void 0:_euiChartTheme$theme$2[d.sortIndex]}}}],config:{partitionLayout:external_kbnSharedDeps_ElasticCharts_.PartitionLayout.sunburst,linkLabel:{maximumSection:1/0,maxCount:0},margin:{top:0,bottom:0,left:0,right:0},outerSizeRatio:1,circlePadding:4,clockwiseSectors:!1}}))))}function VisitorBreakdown(){const{urlParams:urlParams,uiFilters:uiFilters}=Object(use_url_params.a)(),{start:start,end:end,searchTerm:searchTerm}=urlParams,{data:data,status:status}=Object(use_fetcher.b)(callApmApi=>{const{serviceName:serviceName}=uiFilters;return start&&end&&serviceName?callApmApi({endpoint:"GET /api/apm/rum-client/visitor-breakdown",params:{query:{start:start,end:end,uiFilters:JSON.stringify(uiFilters),urlQuery:searchTerm}}}):Promise.resolve(null)},[end,start,uiFilters,searchTerm]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"s"},external_kbnSharedDeps_React_default.a.createElement("h3",null,VisitorBreakdownLabel)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{style:{height:"calc(100% - 32px)"}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("h4",null,I18LABELS.browser)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(VisitorBreakdownChart,{options:null==data?void 0:data.browsers,loading:"success"!==status})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("h4",null,I18LABELS.operatingSystem)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(VisitorBreakdownChart,{options:null==data?void 0:data.os,loading:"success"!==status}))))}var uuid=__webpack_require__(165),uuid_default=__webpack_require__.n(uuid),constants_=__webpack_require__(36),embeddable_public_=__webpack_require__(41),apmOss_public_=__webpack_require__(32),transaction_types=__webpack_require__(77);const ES_TERM_SOURCE_COUNTRY={type:constants_.SOURCE_TYPES.ES_TERM_SOURCE,id:"3657625d-17b0-41ef-99ba-3a2b2938655c",indexPatternTitle:"apm-*",term:"client.geo.country_iso_code",metrics:[{type:constants_.AGG_TYPE.AVG,field:"transaction.duration.us",label:"Page load duration"}],indexPatternId:apmOss_public_.APM_STATIC_INDEX_PATTERN_ID,applyGlobalQuery:!0,applyGlobalTime:!0},ES_TERM_SOURCE_REGION={type:constants_.SOURCE_TYPES.ES_TERM_SOURCE,id:"e62a1b9c-d7ff-4fd4-a0f6-0fdc44bb9e41",indexPatternTitle:"apm-*",term:"client.geo.region_iso_code",metrics:[{type:constants_.AGG_TYPE.AVG,field:"transaction.duration.us"}],whereQuery:{query:'transaction.type : "page-load"',language:"kuery"},indexPatternId:apmOss_public_.APM_STATIC_INDEX_PATTERN_ID,applyGlobalQuery:!0,applyGlobalTime:!0},getWhereQuery=serviceName=>({query:`${elasticsearch_fieldnames.I} : "${transaction_types.a}" and ${elasticsearch_fieldnames.u} : "${serviceName}"`,language:"kuery"});var use_apm_plugin_context=__webpack_require__(45);const DescriptionItem=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiDescriptionListDescription).withConfig({displayName:"DescriptionItem",componentId:"sc-2807r4-0"})(["&&&{width:25%;}"]),TitleItem=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiDescriptionListTitle).withConfig({displayName:"TitleItem",componentId:"sc-2807r4-1"})(["&&&{width:75%;}"]);function MapToolTipComponent({closeTooltip:closeTooltip,features:features=[],loadFeatureProperties:loadFeatureProperties}){var _features$;const{id:featureId,layerId:layerId}=null!==(_features$=features[0])&&void 0!==_features$?_features$:{},[regionName,setRegionName]=Object(external_kbnSharedDeps_React_.useState)(featureId),[pageLoadDuration,setPageLoadDuration]=Object(external_kbnSharedDeps_React_.useState)("");return Object(external_kbnSharedDeps_React_.useEffect)(()=>{(async()=>{if(loadFeatureProperties){(await loadFeatureProperties({layerId:layerId,featureId:featureId})).forEach(item=>{"name"!==item.getPropertyKey()&&"region_name"!==item.getPropertyKey()||setRegionName(item.getRawValue()),"__kbnjoin__avg_of_transaction.duration.us__e62a1b9c-d7ff-4fd4-a0f6-0fdc44bb9e41"!==item.getPropertyKey()&&"__kbnjoin__avg_of_transaction.duration.us__3657625d-17b0-41ef-99ba-3a2b2938655c"!==item.getPropertyKey()||setPageLoadDuration((val=>{const valInMs=val/1e3;return valInMs>1e3?(valInMs/1e3).toFixed(2)+" sec":(valInMs/1e3).toFixed(0)+" ms"})(+item.getRawValue()))})}})()}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiOutsideClickDetector,{onOutsideClick:()=>{null!=closeTooltip&&closeTooltip()}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopoverTitle,null,regionName),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionList,{type:"column",textStyle:"reverse",compressed:!0,style:{width:300}},external_kbnSharedDeps_React_default.a.createElement(TitleItem,{className:"eui-textNoWrap"},I18LABELS.avgPageLoadDuration),external_kbnSharedDeps_React_default.a.createElement(DescriptionItem,null,pageLoadDuration))))}const MapToolTip=external_kbnSharedDeps_React_default.a.memo(MapToolTipComponent),getMultiMatchFilter=(field,values)=>({meta:{index:apmOss_public_.APM_STATIC_INDEX_PATTERN_ID,type:"phrases",key:field,value:values.join(", "),params:values,alias:null,negate:!1,disabled:!1},query:{bool:{should:values.map(value=>({match_phrase:{[field]:value}})),minimum_should_match:1}}}),useMapFilters=()=>{const{urlParams:urlParams,uiFilters:uiFilters}=Object(use_url_params.a)(),{serviceName:serviceName,searchTerm:searchTerm}=urlParams,{browser:browser,device:device,os:os,location:location,transactionUrl:transactionUrl}=uiFilters,existFilter={meta:{index:apmOss_public_.APM_STATIC_INDEX_PATTERN_ID,alias:null,negate:!1,disabled:!1,type:"exists",key:"transaction.marks.navigationTiming.fetchStart",value:"exists"},exists:{field:"transaction.marks.navigationTiming.fetchStart"}};return Object(external_kbnSharedDeps_React_.useMemo)(()=>{const filters=[existFilter];var field,value;return serviceName&&filters.push((field=elasticsearch_fieldnames.u,value=serviceName,{meta:{index:apmOss_public_.APM_STATIC_INDEX_PATTERN_ID,alias:null,negate:!1,disabled:!1,type:"phrase",key:field,params:{query:value}},query:{term:{[field]:value}}})),browser&&filters.push(getMultiMatchFilter(elasticsearch_fieldnames.L,browser)),device&&filters.push(getMultiMatchFilter(elasticsearch_fieldnames.K,device)),os&&filters.push(getMultiMatchFilter(elasticsearch_fieldnames.M,os)),location&&filters.push(getMultiMatchFilter(elasticsearch_fieldnames.b,location)),transactionUrl&&filters.push(getMultiMatchFilter(elasticsearch_fieldnames.J,transactionUrl)),searchTerm&&filters.push(((field,value)=>({meta:{index:apmOss_public_.APM_STATIC_INDEX_PATTERN_ID,alias:null,negate:!1,disabled:!1,type:"term",key:field,params:{query:value}},query:{wildcard:{[field]:{value:`*${value}*`}}}}))(elasticsearch_fieldnames.J,searchTerm)),filters},[serviceName,browser,device,os,location,searchTerm])};function EmbeddedMap_extends(){return(EmbeddedMap_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const EmbeddedPanel=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"EmbeddedPanel",componentId:"fmxjbq-0"})(["z-index:auto;flex:1;display:flex;flex-direction:column;height:100%;position:relative;.embPanel__content{display:flex;flex:1 1 100%;z-index:1;min-height:0;}&&& .mapboxgl-canvas{animation:none !important;}"]);function EmbeddedMapComponent(){const{urlParams:urlParams}=Object(use_url_params.a)(),apmPluginContext=Object(use_apm_plugin_context.a)(),{start:start,end:end,serviceName:serviceName}=urlParams,mapFilters=useMapFilters(),layerList=function(){const{urlParams:urlParams}=Object(use_url_params.a)(),{serviceName:serviceName}=urlParams;ES_TERM_SOURCE_COUNTRY.whereQuery=getWhereQuery(serviceName);const getLayerStyle=fieldName=>({type:"VECTOR",properties:{icon:{type:constants_.STYLE_TYPE.STATIC,options:{value:"marker"}},fillColor:{type:constants_.STYLE_TYPE.DYNAMIC,options:{color:"Blue to Red",colorCategory:"palette_0",fieldMetaOptions:{isEnabled:!0,sigma:3},type:constants_.COLOR_MAP_TYPE.ORDINAL,field:{name:fieldName,origin:constants_.FIELD_ORIGIN.JOIN},useCustomColorRamp:!1}},lineColor:{type:constants_.STYLE_TYPE.DYNAMIC,options:{color:"#3d3d3d",fieldMetaOptions:{isEnabled:!0}}},lineWidth:{type:constants_.STYLE_TYPE.STATIC,options:{size:1}},iconSize:{type:constants_.STYLE_TYPE.STATIC,options:{size:6}},iconOrientation:{type:constants_.STYLE_TYPE.STATIC,options:{orientation:0}},labelText:{type:constants_.STYLE_TYPE.STATIC,options:{value:""}},labelColor:{type:constants_.STYLE_TYPE.STATIC,options:{color:"#000000"}},labelSize:{type:constants_.STYLE_TYPE.STATIC,options:{size:14}},labelBorderColor:{type:constants_.STYLE_TYPE.STATIC,options:{color:"#FFFFFF"}},symbolizeAs:{options:{value:constants_.SYMBOLIZE_AS_TYPES.CIRCLE}},labelBorderSize:{options:{size:constants_.LABEL_BORDER_SIZES.SMALL}}},isTimeAware:!0}),pageLoadDurationByCountryLayer={joins:[{leftField:"iso2",right:ES_TERM_SOURCE_COUNTRY}],sourceDescriptor:{type:"EMS_FILE",id:"world_countries",tooltipProperties:["name"]},style:getLayerStyle("__kbnjoin__avg_of_transaction.duration.us__3657625d-17b0-41ef-99ba-3a2b2938655c"),id:"e8d1d974-eed8-462f-be2c-f0004b7619b2",label:null,minZoom:0,maxZoom:24,alpha:.75,visible:!0,type:"VECTOR"};return ES_TERM_SOURCE_REGION.whereQuery=getWhereQuery(serviceName),[pageLoadDurationByCountryLayer,{joins:[{leftField:"region_iso_code",right:ES_TERM_SOURCE_REGION}],sourceDescriptor:{type:"EMS_FILE",id:"administrative_regions_lvl2",tooltipProperties:["region_iso_code","region_name"]},style:getLayerStyle("__kbnjoin__avg_of_transaction.duration.us__e62a1b9c-d7ff-4fd4-a0f6-0fdc44bb9e41"),id:"0e936d41-8765-41c9-97f0-05e166391366",label:null,minZoom:3,maxZoom:24,alpha:.75,visible:!0,type:"VECTOR"}]}(),[embeddable,setEmbeddable]=Object(external_kbnSharedDeps_React_.useState)(),embeddableRoot=Object(external_kbnSharedDeps_React_.useRef)(null),{services:{embeddable:embeddablePlugin}}=Object(public_.useKibana)();if(!embeddablePlugin)throw new Error("Embeddable start plugin not found");const factory=embeddablePlugin.getEmbeddableFactory(constants_.MAP_SAVED_OBJECT_TYPE),input={attributes:{title:""},id:uuid_default.a.v4(),filters:mapFilters,refreshConfig:{value:0,pause:!1},viewMode:embeddable_public_.ViewMode.VIEW,isLayerTOCOpen:!1,query:{query:'transaction.type : "page-load"',language:"kuery"},...start&&{timeRange:{from:new Date(start).toISOString(),to:new Date(end).toISOString()}},hideFilterActions:!0};function renderTooltipContent({addFilters:addFilters,closeTooltip:closeTooltip,features:features,isLocked:isLocked,getLayerName:getLayerName,loadFeatureProperties:loadFeatureProperties,loadFeatureGeometry:loadFeatureGeometry}){const props={addFilters:addFilters,closeTooltip:closeTooltip,isLocked:isLocked,getLayerName:getLayerName,loadFeatureProperties:loadFeatureProperties,loadFeatureGeometry:loadFeatureGeometry};return external_kbnSharedDeps_React_default.a.createElement(MapToolTip,EmbeddedMap_extends({},props,{features:features}))}return Object(external_kbnSharedDeps_React_.useEffect)(()=>{null!=embeddable&&serviceName&&embeddable.updateInput({filters:mapFilters})},[mapFilters]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{if(null!=embeddable&&null!=start&&null!=end){const timeRange={from:new Date(start).toISOString(),to:new Date(end).toISOString()};embeddable.updateInput({timeRange:timeRange})}},[start,end]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{!async function(){if(!factory)throw new Error("Map embeddable not found.");const embeddableObject=await factory.create({...input,title:"Visitors by region"});if(embeddableObject&&!Object(embeddable_public_.isErrorEmbeddable)(embeddableObject)){embeddableObject.setRenderTooltipContent(renderTooltipContent);const basemapLayerDescriptor=apmPluginContext.plugins.maps?await apmPluginContext.plugins.maps.createLayerDescriptors.createBasemapLayerDescriptor():null;basemapLayerDescriptor&&layerList.unshift(basemapLayerDescriptor),await embeddableObject.setLayerList(layerList)}setEmbeddable(embeddableObject)}()},[]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{embeddableRoot.current&&embeddable&&serviceName&&embeddable.render(embeddableRoot.current)},[embeddable,embeddableRoot,serviceName]),external_kbnSharedDeps_React_default.a.createElement(EmbeddedPanel,null,external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":"xpack.apm.regionMap.embeddedPanel",className:"embPanel__content",ref:embeddableRoot}))}EmbeddedMapComponent.displayName="EmbeddedMap";const EmbeddedMap=external_kbnSharedDeps_React_default.a.memo(EmbeddedMapComponent);function VisitorBreakdownMap(){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("h3",null,I18LABELS.pageLoadDurationByRegion)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement("div",{style:{height:400}},external_kbnSharedDeps_React_default.a.createElement(EmbeddedMap,null)))}function VisitorBreakdownsPanel(){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s",wrap:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{style:{flexBasis:650}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPanel,null,external_kbnSharedDeps_React_default.a.createElement(VisitorBreakdownMap,null))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{style:{flexBasis:650}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPanel,null,external_kbnSharedDeps_React_default.a.createElement(VisitorBreakdown,null))))}const ClFlexGroup=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup).withConfig({displayName:"ClFlexGroup",componentId:"sc-1fsyoq8-0"})(["flex-direction:row;@media only screen and (max-width:768px){flex-direction:row;justify-content:space-between;}"]);function Metrics_formatTitle(unit,value){return void 0===value?I18LABELS.dataMissing:formatToSec(value,unit)}function PageViewsTotalTitle({pageViews:pageViews}){return void 0===pageViews?external_kbnSharedDeps_React_.createElement(external_kbnSharedDeps_React_.Fragment,null,I18LABELS.dataMissing):pageViews<1e4?external_kbnSharedDeps_React_.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_ElasticNumeral_default()(pageViews).format("0,0")):external_kbnSharedDeps_React_.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{content:external_kbnSharedDeps_ElasticNumeral_default()(pageViews).format("0,0")},external_kbnSharedDeps_React_.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_ElasticNumeral_default()(pageViews).format("0 a")))}function Metrics(){var _data$totalPageLoadDu,_data$backEnd,_data$frontEnd,_data$pageViews2;const uxQuery=useUxQuery(),{data:data,status:status}=Object(use_fetcher.b)(callApmApi=>uxQuery?callApmApi({endpoint:"GET /api/apm/rum/client-metrics",params:{query:{...uxQuery}}}):Promise.resolve(null),[uxQuery]),{setSharedData:setSharedData}=Object(external_kbnSharedDeps_React_.useContext)(CsmSharedContext);Object(external_kbnSharedDeps_React_.useEffect)(()=>{var _data$pageViews$value,_data$pageViews;setSharedData({totalPageViews:null!==(_data$pageViews$value=null==data||null===(_data$pageViews=data.pageViews)||void 0===_data$pageViews?void 0:_data$pageViews.value)&&void 0!==_data$pageViews$value?_data$pageViews$value:0})},[data,setSharedData]);const STAT_STYLE={minWidth:"150px",maxWidth:"250px"};return external_kbnSharedDeps_React_.createElement(ClFlexGroup,{wrap:!0,responsive:!1},external_kbnSharedDeps_React_.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{style:STAT_STYLE},external_kbnSharedDeps_React_.createElement(external_kbnSharedDeps_ElasticEui_.EuiStat,{titleSize:"l",title:Metrics_formatTitle("ms",null==data||null===(_data$totalPageLoadDu=data.totalPageLoadDuration)||void 0===_data$totalPageLoadDu?void 0:_data$totalPageLoadDu.value),description:external_kbnSharedDeps_React_.createElement(external_kbnSharedDeps_React_.Fragment,null,I18LABELS.totalPageLoad,external_kbnSharedDeps_React_.createElement(external_kbnSharedDeps_ElasticEui_.EuiIconTip,{content:I18LABELS.totalPageLoadTooltip,type:"questionInCircle"})),isLoading:"success"!==status})),external_kbnSharedDeps_React_.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{style:STAT_STYLE},external_kbnSharedDeps_React_.createElement(external_kbnSharedDeps_ElasticEui_.EuiStat,{titleSize:"l",title:Metrics_formatTitle("ms",null==data||null===(_data$backEnd=data.backEnd)||void 0===_data$backEnd?void 0:_data$backEnd.value),description:external_kbnSharedDeps_React_.createElement(external_kbnSharedDeps_React_.Fragment,null,I18LABELS.backEnd,external_kbnSharedDeps_React_.createElement(external_kbnSharedDeps_ElasticEui_.EuiIconTip,{content:I18LABELS.backEndTooltip,type:"questionInCircle"})),isLoading:"success"!==status})),external_kbnSharedDeps_React_.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{style:STAT_STYLE},external_kbnSharedDeps_React_.createElement(external_kbnSharedDeps_ElasticEui_.EuiStat,{titleSize:"l",title:Metrics_formatTitle("ms",null==data||null===(_data$frontEnd=data.frontEnd)||void 0===_data$frontEnd?void 0:_data$frontEnd.value),description:external_kbnSharedDeps_React_.createElement(external_kbnSharedDeps_React_.Fragment,null,I18LABELS.frontEnd,external_kbnSharedDeps_React_.createElement(external_kbnSharedDeps_ElasticEui_.EuiIconTip,{content:I18LABELS.frontEndTooltip,type:"questionInCircle"})),isLoading:"success"!==status})),external_kbnSharedDeps_React_.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{style:STAT_STYLE},external_kbnSharedDeps_React_.createElement(external_kbnSharedDeps_ElasticEui_.EuiStat,{titleSize:"l",title:external_kbnSharedDeps_React_.createElement(PageViewsTotalTitle,{pageViews:null==data||null===(_data$pageViews2=data.pageViews)||void 0===_data$pageViews2?void 0:_data$pageViews2.value}),description:I18LABELS.pageViews,isLoading:"success"!==status})))}function ClientMetrics(){const{urlParams:{percentile:percentile}}=Object(use_url_params.a)();return external_kbnSharedDeps_React_.createElement(external_kbnSharedDeps_ElasticEui_.EuiPanel,null,external_kbnSharedDeps_React_.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceBetween"},external_kbnSharedDeps_React_.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:1,"data-cy":"client-metrics"},external_kbnSharedDeps_React_.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"xs"},external_kbnSharedDeps_React_.createElement("h3",null,I18LABELS.pageLoad," (",getPercentileLabel(percentile),")")),external_kbnSharedDeps_React_.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_.createElement(Metrics,null))))}function RumDashboard(){const{isSmall:isSmall}=Object(use_break_points.a)();return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:isSmall?"row":"column",gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(ClientMetrics,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(UXMetrics,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(PageLoadAndViews,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(VisitorBreakdownsPanel,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(ImpactfulMetrics,null)))}var useDebounce=__webpack_require__(255),useDebounce_default=__webpack_require__.n(useDebounce),useEvent=__webpack_require__(1247),useEvent_default=__webpack_require__.n(useEvent),classnames=__webpack_require__(1246),classnames_default=__webpack_require__.n(classnames);const StyledSpan=external_kbnSharedDeps_StyledComponents_default.a.span.withConfig({displayName:"StyledSpan",componentId:"ywvq47-0"})(["color:",";font-weight:500;:not(:last-of-type)::after{content:'•';margin:0 4px;}"],external_kbnSharedDeps_Theme_euiLightVars_default.a.euiColorSecondaryText),StyledListSpan=external_kbnSharedDeps_StyledComponents_default.a.span.withConfig({displayName:"StyledListSpan",componentId:"ywvq47-1"})(["display:block;margin-top:4px;font-size:12px;"]);function selectableRenderOptions(option,searchValue){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHighlight,{className:"euiSelectableTemplateSitewide__listItemTitle",search:searchValue},option.label),function(meta){if(!meta||meta.length<1)return;return external_kbnSharedDeps_React_default.a.createElement(StyledListSpan,null,meta.map(item=>external_kbnSharedDeps_React_default.a.createElement(StyledSpan,{key:item},item)))}(option.meta))}const StyledRow=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"StyledRow",componentId:"sc-1uwqtk-0"})(["text-align:center;padding:8px 0px;background-color:",";border-bottom:1px solid ",";"],props=>props.darkMode?external_kbnSharedDeps_Theme_euiDarkVars_default.a.euiPageBackgroundColor:external_kbnSharedDeps_Theme_euiLightVars_default.a.euiPageBackgroundColor,props=>props.darkMode?external_kbnSharedDeps_Theme_euiDarkVars_default.a.euiColorLightestShade:external_kbnSharedDeps_Theme_euiLightVars_default.a.euiColorLightestShade);function SelectableUrlList({data:data,loading:loading,onInputChange:onInputChange,onTermChange:onTermChange,onChange:onChange,searchValue:searchValue,onClose:onClose,popoverIsOpen:popoverIsOpen,setPopoverIsOpen:setPopoverIsOpen,initialValue:initialValue}){var _data$items,_data$total;const[darkMode]=Object(public_.useUiSetting$)("theme:darkMode"),[searchRef,setSearchRef]=Object(external_kbnSharedDeps_React_.useState)(null),titleRef=Object(external_kbnSharedDeps_React_.useRef)(null);useEvent_default()("keydown",evt=>{"enter"===evt.key.toLowerCase()&&(onTermChange(),setPopoverIsOpen(!1),searchRef&&searchRef.blur())},searchRef);const formattedOptions=(null!==(_data$items=data.items)&&void 0!==_data$items?_data$items:[]).map(item=>({title:item.label,...item,className:classnames_default()("euiSelectableTemplateSitewide__listItem",item.className)}));const closePopover=()=>{setPopoverIsOpen(!1),onClose(),searchRef&&searchRef.blur()};Object(external_kbnSharedDeps_React_.useEffect)(()=>{searchRef&&initialValue&&(searchRef.value=initialValue)},[searchRef]);const loadingMessage=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSelectableMessage,{style:{minHeight:300}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingSpinner,{size:"l"}),external_kbnSharedDeps_React_default.a.createElement("br",null),external_kbnSharedDeps_React_default.a.createElement("p",null,I18LABELS.loadingResults)),emptyMessage=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSelectableMessage,{style:{minHeight:300}},external_kbnSharedDeps_React_default.a.createElement("p",null,I18LABELS.noResults)),titleText=searchValue?I18LABELS.getSearchResultsLabel(null!==(_data$total=null==data?void 0:data.total)&&void 0!==_data$total?_data$total:0):I18LABELS.topPages;function PopOverTitle(){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopoverTitle,{paddingSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{ref:titleRef,gutterSize:"xs"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{style:{justifyContent:"center"}},loading?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingSpinner,null):titleText),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{color:"text",onClick:()=>closePopover(),"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.csm.search.url.close",{defaultMessage:"Close"}),iconType:"cross"}))))}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSelectable,{searchable:!0,onChange:onChange,isLoading:loading,options:formattedOptions,renderOption:selectableRenderOptions,singleSelection:!1,searchProps:{isClearable:!0,onClick:e=>{setPopoverIsOpen(!0)},onInput:e=>{onInputChange(e),setPopoverIsOpen(!0)},inputRef:setSearchRef,placeholder:I18LABELS.searchByUrl},listProps:{rowHeight:68,showIcons:!0,onFocusBadge:!1},loadingMessage:loadingMessage,emptyMessage:emptyMessage,noMatchesMessage:emptyMessage},(list,search)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiOutsideClickDetector,{onOutsideClick:()=>closePopover()},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopover,{panelPaddingSize:"none",isOpen:popoverIsOpen,display:"block",button:search,closePopover:closePopover,style:{minWidth:200}},external_kbnSharedDeps_React_default.a.createElement("div",{style:{width:600,maxWidth:"100%"}},external_kbnSharedDeps_React_default.a.createElement(PopOverTitle,null),searchValue&&external_kbnSharedDeps_React_default.a.createElement(StyledRow,{darkMode:darkMode},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.apm.ux.url.hitEnter.include",defaultMessage:"Hit {icon} or click apply to include all urls matching {searchValue}",values:{searchValue:external_kbnSharedDeps_React_default.a.createElement("strong",null,searchValue),icon:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBadge,{color:"hollow"},"Enter ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{type:"returnKey"}))}}))),list,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopoverFooter,{paddingSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{style:{justifyContent:"flex-end"}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{fill:!0,size:"s",onClick:()=>{onTermChange(),closePopover()}},external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.apply.label",{defaultMessage:"Apply"})))))))))}function URLSearch({onChange:onFilterChange}){var _data$items,_data$total;const history=Object(external_kbnSharedDeps_ReactRouterDom_.useHistory)(),{uiFilters:uiFilters,urlParams:urlParams}=Object(use_url_params.a)(),{searchTerm:searchTerm,percentile:percentile}=urlParams,[popoverIsOpen,setPopoverIsOpen]=Object(external_kbnSharedDeps_React_.useState)(!1),[searchValue,setSearchValue]=Object(external_kbnSharedDeps_React_.useState)(null!=searchTerm?searchTerm:""),[debouncedValue,setDebouncedValue]=Object(external_kbnSharedDeps_React_.useState)(null!=searchTerm?searchTerm:"");useDebounce_default()(()=>{setSearchValue(debouncedValue)},250,[debouncedValue]);const updateSearchTerm=Object(external_kbnSharedDeps_React_.useCallback)(searchTermN=>{const newQuery={...Object(url_helpers.e)(history.location.search),searchTerm:searchTermN||void 0};searchTermN||delete newQuery.searchTerm;const newLocation={...history.location,search:Object(url_helpers.b)(newQuery)};history.push(newLocation)},[history]),[checkedUrls,setCheckedUrls]=Object(external_kbnSharedDeps_React_.useState)([]),uxQuery=useUxQuery(),{data:data,status:status}=Object(use_fetcher.b)(callApmApi=>{if(uxQuery&&popoverIsOpen){const{transactionUrl:transactionUrl,...restFilters}=uiFilters;return callApmApi({endpoint:"GET /api/apm/rum-client/url-search",params:{query:{...uxQuery,uiFilters:JSON.stringify(restFilters),urlQuery:searchValue}}})}return Promise.resolve(null)},[uxQuery,searchValue,popoverIsOpen]);Object(external_kbnSharedDeps_React_.useEffect)(()=>{setCheckedUrls(uiFilters.transactionUrl||[])},[uiFilters]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{searchTerm&&""===searchValue&&updateSearchTerm("")},[searchValue,updateSearchTerm,searchTerm]);const percTitle=getPercentileLabel(percentile),items=(null!==(_data$items=null==data?void 0:data.items)&&void 0!==_data$items?_data$items:[]).map(item=>({label:item.url,key:item.url,meta:[I18LABELS.pageViews+": "+item.count,I18LABELS.pageLoadDuration+": "+formatToSec(item.pld)+` (${percTitle})`],url:item.url,checked:null!=checkedUrls&&checkedUrls.includes(item.url)?"on":void 0})),isLoading="success"!==status;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"xxxs",textTransform:"uppercase"},external_kbnSharedDeps_React_default.a.createElement("h4",null,I18LABELS.url)),external_kbnSharedDeps_React_default.a.createElement(SelectableUrlList,{initialValue:searchTerm,loading:isLoading,onInputChange:e=>{setDebouncedValue(e.currentTarget.value)},onTermChange:()=>{updateSearchTerm(searchValue)},data:{items:items,total:null!==(_data$total=null==data?void 0:data.total)&&void 0!==_data$total?_data$total:0},onChange:updatedOptions=>{const clickedItems=updatedOptions.filter(option=>"on"===option.checked);setCheckedUrls(clickedItems.map(item=>item.url))},onClose:()=>{(uiFilters.transactionUrl||checkedUrls.length>0)&&onFilterChange(checkedUrls)},searchValue:searchValue,popoverIsOpen:popoverIsOpen,setPopoverIsOpen:setPopoverIsOpen}))}const UrlList_BadgeText=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"BadgeText",componentId:"go8jvw-0"})(["display:inline-block;",";vertical-align:middle;"],Object(variables.truncate)(Object(variables.px)(12*variables.unit))),UrlList_removeFilterLabel=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.uifilter.badge.removeFilter",{defaultMessage:"Remove filter"});function UrlList({onRemove:onRemove,value:value}){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGrid,{gutterSize:"s"},value.map(val=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{key:val,grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBadge,{color:"hollow",onClick:()=>{onRemove(val)},onClickAriaLabel:UrlList_removeFilterLabel,iconOnClick:()=>{onRemove(val)},iconOnClickAriaLabel:UrlList_removeFilterLabel,iconType:"cross",iconSide:"right"},external_kbnSharedDeps_React_default.a.createElement(UrlList_BadgeText,null,(val=>{const urlLength=val.length;if(urlLength<30)return val;const urlObj=new URL(val);if("/"===urlObj.pathname)return val;const domainVal=urlObj.hostname,extraLength=urlLength-30,extraDomain=domainVal.substring(0,extraLength);return urlObj.pathname.length+7>30?val.replace(domainVal,".."):val.replace(extraDomain,"..")})(val))))))}function URLFilter(){const history=Object(external_kbnSharedDeps_ReactRouterDom_.useHistory)(),setFilterValue=(name,value)=>{const search=Object(external_kbnSharedDeps_Lodash_.omit)(Object(url_helpers.e)(history.location.search),name);history.push({...history.location,search:Object(url_helpers.b)(Object(helpers.b)({...search,[name]:value.length?value.join(","):void 0}))})},{uiFilters:uiFilters}=Object(use_url_params.a)(),{transactionUrl:transactionUrl}=uiFilters,filterValue=null!=transactionUrl?transactionUrl:[];return external_kbnSharedDeps_React_default.a.createElement("span",{"data-cy":"csmUrlFilter"},external_kbnSharedDeps_React_default.a.createElement(URLSearch,{onChange:value=>{setFilterValue("transactionUrl",value)}}),filterValue.length>0&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(UrlList,{onRemove:val=>{setFilterValue("transactionUrl",filterValue.filter(v=>val!==v))},value:filterValue})))}function RumDashboard_extends(){return(RumDashboard_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function RumOverview(){Object(observability_public_.useTrackPageview)({app:"ux",path:"home"}),Object(observability_public_.useTrackPageview)({app:"ux",path:"home",delay:15e3});const localUIFiltersConfig=Object(external_kbnSharedDeps_React_.useMemo)(()=>({filterNames:["location","device","os","browser"]}),[]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:1},external_kbnSharedDeps_React_default.a.createElement(LocalUIFilters,RumDashboard_extends({},localUIFiltersConfig,{showCount:!0}),external_kbnSharedDeps_React_default.a.createElement(URLFilter,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:7},external_kbnSharedDeps_React_default.a.createElement(RumDashboard,null))))}var EnvironmentFilter=__webpack_require__(252);function ServiceNameFilter({loading:loading,serviceNames:serviceNames}){const history=Object(external_kbnSharedDeps_ReactRouterDom_.useHistory)(),{urlParams:{serviceName:selectedServiceName}}=Object(use_url_params.a)(),options=serviceNames.map(type=>({text:type,value:type})),updateServiceName=Object(external_kbnSharedDeps_React_.useCallback)((serviceN,replaceHistory)=>{const newLocation={...history.location,search:Object(url_helpers.b)({...Object(url_helpers.e)(history.location.search),serviceName:serviceN})};replaceHistory?history.replace(newLocation):history.push(newLocation)},[history]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{(null==serviceNames?void 0:serviceNames.length)>0&&(selectedServiceName||updateServiceName(serviceNames[0],!0),selectedServiceName&&!serviceNames.includes(selectedServiceName)&&updateServiceName(serviceNames[0],!0)),selectedServiceName&&0===serviceNames.length&&!loading&&updateServiceName("")},[serviceNames,selectedServiceName,updateServiceName,loading]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSelect,{prepend:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.ux.localFilters.titles.webApplication",{defaultMessage:"Web application"}),isLoading:loading,"data-cy":"serviceNameFilter",options:options,value:selectedServiceName,onChange:event=>{updateServiceName(event.target.value)}}))}var agent_name=__webpack_require__(62);function UserPercentile(){const history=Object(external_kbnSharedDeps_ReactRouterDom_.useHistory)(),{urlParams:{percentile:percentile}}=Object(use_url_params.a)(),updatePercentile=Object(external_kbnSharedDeps_React_.useCallback)((percentileN,replaceHistory)=>{const newLocation={...history.location,search:Object(url_helpers.b)({...Object(url_helpers.e)(history.location.search),percentile:percentileN})};replaceHistory?history.replace(newLocation):history.push(newLocation)},[history]);Object(external_kbnSharedDeps_React_.useEffect)(()=>{percentile||updatePercentile(50,!0)});const options=[{value:"50",text:I18LABELS.percentile50thMedian,"data-test-subj":"p50Percentile"},{value:"75",text:I18LABELS.percentile75th,"data-test-subj":"p75Percentile"},{value:"90",text:I18LABELS.percentile90th,"data-test-subj":"p90Percentile"},{value:"95",text:I18LABELS.percentile95th,"data-test-subj":"p95Percentile"},{value:"99",text:I18LABELS.percentile99th,"data-test-subj":"p99Percentile"}];return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSelect,{prepend:I18LABELS.percentile,"data-test-subj":"uxPercentileSelect",style:{width:150},options:options,onChange:evt=>{return val=evt.target.value,void updatePercentile(Number(val));var val}})}function MainFilters(){var _data$rumServices;const{urlParams:{start:start,end:end}}=Object(use_url_params.a)(),{data:data,status:status}=Object(use_fetcher.b)(callApmApi=>{if(start&&end)return callApmApi({endpoint:"GET /api/apm/rum-client/services",params:{query:{start:start,end:end,uiFilters:JSON.stringify({agentName:agent_name.b})}}})},[start,end]),rumServiceNames=null!==(_data$rumServices=null==data?void 0:data.rumServices)&&void 0!==_data$rumServices?_data$rumServices:[],{isSmall:isSmall}=Object(use_break_points.a)(),envStyle=isSmall?{}:{maxWidth:200};return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(ServiceNameFilter,{loading:"success"!==status,serviceNames:rumServiceNames})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,style:envStyle},external_kbnSharedDeps_React_default.a.createElement(EnvironmentFilter.a,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(UserPercentile,null)))}var DatePicker=__webpack_require__(179);const UX_LABEL=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.ux.title",{defaultMessage:"User Experience"});function RumHome(){return external_kbnSharedDeps_React_default.a.createElement(CsmSharedContextProvider,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{wrap:!0,justifyContent:"flexEnd",responsive:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,null,external_kbnSharedDeps_React_default.a.createElement("h1",{className:"eui-textNoWrap"},UX_LABEL))),external_kbnSharedDeps_React_default.a.createElement(MainFilters,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(DatePicker.a,null))),external_kbnSharedDeps_React_default.a.createElement(RumOverview,null))}var apm_plugin_context=__webpack_require__(176),url_params_context=__webpack_require__(239),use_breadcrumbs=__webpack_require__(765),createCallApmApi=__webpack_require__(61),index_pattern=__webpack_require__(766);const ANALYZE_DATA=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.analyzeDataButtonLabel",{defaultMessage:"Analyze data"}),ANALYZE_MESSAGE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.apm.analyzeDataButtonLabel.message",{defaultMessage:"EXPERIMENTAL - Analyze Data allows you to select and filter result data in any dimension and look for the cause or impact of performance problems."});function UXActionMenu({appMountParameters:appMountParameters}){const{services:{http:http}}=Object(public_.useKibana)(),{urlParams:urlParams}=Object(use_url_params.a)(),{rangeTo:rangeTo,rangeFrom:rangeFrom}=urlParams,uxExploratoryViewLink=Object(observability_public_.createExploratoryViewUrl)({"ux-series":{dataType:"ux",time:{from:rangeFrom,to:rangeTo}}},null==http?void 0:http.basePath.get());return external_kbnSharedDeps_React_default.a.createElement(observability_public_.HeaderMenuPortal,{setHeaderActionMenu:appMountParameters.setHeaderActionMenu},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"flexEnd",responsive:!1,style:{paddingRight:20}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{position:"top",content:external_kbnSharedDeps_React_default.a.createElement("p",null,ANALYZE_MESSAGE)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{href:uxExploratoryViewLink,color:"primary",iconType:"visBarVerticalStacked"},ANALYZE_DATA)))))}const CsmMainContainer=common_.euiStyled.div`
  padding: ${Object(variables.px)(variables.units.plus)};
  height: 100%;
`,rumRoutes=[{exact:!0,path:"/",render:Object(route_config.a)("/ux"),breadcrumb:UX_LABEL}];function CsmApp(){const[darkMode]=Object(public_.useUiSetting$)("theme:darkMode");return Object(use_breadcrumbs.a)(rumRoutes),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_StyledComponents_.ThemeProvider,{theme:outerTheme=>({...outerTheme,eui:darkMode?external_kbnSharedDeps_Theme_euiDarkVars_default.a:external_kbnSharedDeps_Theme_euiLightVars_default.a,darkMode:darkMode})},external_kbnSharedDeps_React_default.a.createElement(CsmMainContainer,{"data-test-subj":"csmMainContainer",role:"main"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{component:ScrollToTopOnPathChange.a}),external_kbnSharedDeps_React_default.a.createElement(RumHome,null)))}function CsmAppRoot({appMountParameters:appMountParameters,core:core,deps:deps,config:config,corePlugins:{embeddable:embeddable,maps:maps},apmRuleRegistry:apmRuleRegistry}){const{history:history}=appMountParameters,i18nCore=core.i18n,plugins={...deps,maps:maps},apmPluginContextValue={appMountParameters:appMountParameters,config:config,core:core,plugins:plugins,apmRuleRegistry:apmRuleRegistry};return external_kbnSharedDeps_React_default.a.createElement(public_.RedirectAppLinks,{application:core.application},external_kbnSharedDeps_React_default.a.createElement(apm_plugin_context.a.Provider,{value:apmPluginContextValue},external_kbnSharedDeps_React_default.a.createElement(public_.KibanaContextProvider,{services:{...core,...plugins,embeddable:embeddable}},external_kbnSharedDeps_React_default.a.createElement(i18nCore.Context,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Router,{history:history},external_kbnSharedDeps_React_default.a.createElement(url_params_context.b,null,external_kbnSharedDeps_React_default.a.createElement(CsmApp,null),external_kbnSharedDeps_React_default.a.createElement(UXActionMenu,{appMountParameters:appMountParameters})))))))}const renderApp=({core:core,deps:deps,appMountParameters:appMountParameters,config:config,corePlugins:corePlugins,apmRuleRegistry:apmRuleRegistry})=>{const{element:element}=appMountParameters;return Object(createCallApmApi.b)(core),Object(index_pattern.a)().catch(e=>{console.log("Error creating static index pattern",e)}),external_kbnSharedDeps_ReactDom_default.a.render(external_kbnSharedDeps_React_default.a.createElement(CsmAppRoot,{appMountParameters:appMountParameters,core:core,deps:deps,config:config,corePlugins:corePlugins,apmRuleRegistry:apmRuleRegistry}),element),()=>{external_kbnSharedDeps_ReactDom_default.a.unmountComponentAtNode(element)}}}}]);