/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[10],{1025:function(module,exports,__webpack_require__){var baseIsEqual=__webpack_require__(458);module.exports=function(value,other){return baseIsEqual(value,other)}},1026:function(module,exports){module.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOCIgaGVpZ2h0PSI4IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMSAwSDB2OGg4VjdIMVYweiIgZmlsbD0iI0QzREFFNiIvPjwvc3ZnPg=="},1027:function(module,exports,__webpack_require__){"use strict";function _toConsumableArray(arr){return function(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var xtend=__webpack_require__(217),unified=__webpack_require__(1028),parse=__webpack_require__(1040),PropTypes=__webpack_require__(400),addListMetadata=__webpack_require__(1096),naiveHtml=__webpack_require__(1098),disallowNode=__webpack_require__(1099),astToReact=__webpack_require__(1100),wrapTableRows=__webpack_require__(1101),getDefinitions=__webpack_require__(1102),uriTransformer=__webpack_require__(1103),defaultRenderers=__webpack_require__(1104),symbols=__webpack_require__(1105),allTypes=Object.keys(defaultRenderers),ReactMarkdown=function(props){var src=props.source||props.children||"",parserOptions=props.parserOptions;if(props.allowedTypes&&props.disallowedTypes)throw new Error("Only one of `allowedTypes` and `disallowedTypes` should be defined");var renderers=xtend(defaultRenderers,props.renderers),parser=[[parse,parserOptions]].concat(props.plugins||[]).reduce(applyParserPlugin,unified()),rawAst=parser.parse(src),renderProps=xtend(props,{renderers:renderers,definitions:getDefinitions(rawAst)}),astPlugins=function(props){var plugins=[wrapTableRows,addListMetadata()],disallowedTypes=props.disallowedTypes;props.allowedTypes&&(disallowedTypes=allTypes.filter((function(type){return"root"!==type&&-1===props.allowedTypes.indexOf(type)})));var removalMethod=props.unwrapDisallowed?"unwrap":"remove";disallowedTypes&&disallowedTypes.length>0&&plugins.push(disallowNode.ofType(disallowedTypes,removalMethod));props.allowNode&&plugins.push(disallowNode.ifNotMatch(props.allowNode,removalMethod));var renderHtml=!props.escapeHtml&&!props.skipHtml,hasHtmlParser=(props.astPlugins||[]).some((function(item){return(Array.isArray(item)?item[0]:item).identity===symbols.HtmlParser}));renderHtml&&!hasHtmlParser&&plugins.push(naiveHtml);return props.astPlugins?plugins.concat(props.astPlugins):plugins}(props),transformedAst=parser.runSync(rawAst),ast=astPlugins.reduce((function(node,plugin){return plugin(node,renderProps)}),transformedAst);return astToReact(ast,renderProps)};function applyParserPlugin(parser,plugin){return Array.isArray(plugin)?parser.use.apply(parser,_toConsumableArray(plugin)):parser.use(plugin)}ReactMarkdown.defaultProps={renderers:{},escapeHtml:!0,skipHtml:!1,sourcePos:!1,rawSourcePos:!1,transformLinkUri:uriTransformer,astPlugins:[],plugins:[],parserOptions:{}},ReactMarkdown.propTypes={className:PropTypes.string,source:PropTypes.string,children:PropTypes.string,sourcePos:PropTypes.bool,rawSourcePos:PropTypes.bool,escapeHtml:PropTypes.bool,skipHtml:PropTypes.bool,allowNode:PropTypes.func,allowedTypes:PropTypes.arrayOf(PropTypes.oneOf(allTypes)),disallowedTypes:PropTypes.arrayOf(PropTypes.oneOf(allTypes)),transformLinkUri:PropTypes.oneOfType([PropTypes.func,PropTypes.bool]),linkTarget:PropTypes.oneOfType([PropTypes.func,PropTypes.string]),transformImageUri:PropTypes.func,astPlugins:PropTypes.arrayOf(PropTypes.func),unwrapDisallowed:PropTypes.bool,renderers:PropTypes.object,plugins:PropTypes.array,parserOptions:PropTypes.object},ReactMarkdown.types=allTypes,ReactMarkdown.renderers=defaultRenderers,ReactMarkdown.uriTransformer=uriTransformer,module.exports=ReactMarkdown},1028:function(module,exports,__webpack_require__){"use strict";var extend=__webpack_require__(1029),bail=__webpack_require__(1030),vfile=__webpack_require__(1031),trough=__webpack_require__(1036),string=__webpack_require__(1037),func=__webpack_require__(1038),plain=__webpack_require__(1039);module.exports=function unified(){var attachers=[],transformers=trough(),namespace={},frozen=!1,freezeIndex=-1;return processor.data=function(key,value){if(string(key))return 2===arguments.length?(assertUnfrozen("data",frozen),namespace[key]=value,processor):own.call(namespace,key)&&namespace[key]||null;if(key)return assertUnfrozen("data",frozen),namespace=key,processor;return namespace},processor.freeze=freeze,processor.attachers=attachers,processor.use=function(value){var settings;if(assertUnfrozen("use",frozen),null==value);else if(func(value))addPlugin.apply(null,arguments);else{if("object"!=typeof value)throw new Error("Expected usable value, not `"+value+"`");"length"in value?addList(value):addPreset(value)}settings&&(namespace.settings=extend(namespace.settings||{},settings));return processor;function addPreset(result){addList(result.plugins),result.settings&&(settings=extend(settings||{},result.settings))}function add(value){if(func(value))addPlugin(value);else{if("object"!=typeof value)throw new Error("Expected usable value, not `"+value+"`");"length"in value?addPlugin.apply(null,value):addPreset(value)}}function addList(plugins){var length,index;if(null==plugins);else{if("object"!=typeof plugins||!("length"in plugins))throw new Error("Expected a list of plugins, not `"+plugins+"`");for(length=plugins.length,index=-1;++index<length;)add(plugins[index])}}function addPlugin(plugin,value){var entry=find(plugin);entry?(plain(entry[1])&&plain(value)&&(value=extend(entry[1],value)),entry[1]=value):attachers.push(slice.call(arguments))}},processor.parse=function(doc){var Parser,file=vfile(doc);if(freeze(),assertParser("parse",Parser=processor.Parser),newable(Parser))return new Parser(String(file),file).parse();return Parser(String(file),file)},processor.stringify=function(node,doc){var Compiler,file=vfile(doc);if(freeze(),assertCompiler("stringify",Compiler=processor.Compiler),assertNode(node),newable(Compiler))return new Compiler(node,file).compile();return Compiler(node,file)},processor.run=run,processor.runSync=function(node,file){var result,complete=!1;return run(node,file,(function(err,tree){complete=!0,bail(err),result=tree})),assertDone("runSync","run",complete),result},processor.process=process,processor.processSync=function(doc){var file,complete=!1;return freeze(),assertParser("processSync",processor.Parser),assertCompiler("processSync",processor.Compiler),process(file=vfile(doc),(function(err){complete=!0,bail(err)})),assertDone("processSync","process",complete),file},processor;function processor(){for(var destination=unified(),length=attachers.length,index=-1;++index<length;)destination.use.apply(null,attachers[index]);return destination.data(extend(!0,{},namespace)),destination}function freeze(){var values,plugin,options,transformer;if(frozen)return processor;for(;++freezeIndex<attachers.length;)plugin=(values=attachers[freezeIndex])[0],null,!1!==(options=values[1])&&(!0===options&&(values[1]=void 0),transformer=plugin.apply(processor,values.slice(1)),func(transformer)&&transformers.use(transformer));return frozen=!0,freezeIndex=1/0,processor}function find(plugin){for(var entry,length=attachers.length,index=-1;++index<length;)if((entry=attachers[index])[0]===plugin)return entry}function run(node,file,cb){if(assertNode(node),freeze(),!cb&&func(file)&&(cb=file,file=null),!cb)return new Promise(executor);function executor(resolve,reject){transformers.run(node,vfile(file),(function(err,tree,file){tree=tree||node,err?reject(err):resolve?resolve(tree):cb(null,tree,file)}))}executor(null,cb)}function process(doc,cb){if(freeze(),assertParser("process",processor.Parser),assertCompiler("process",processor.Compiler),!cb)return new Promise(executor);function executor(resolve,reject){var file=vfile(doc);pipeline.run(processor,{file:file},(function(err){err?reject(err):resolve?resolve(file):cb(null,file)}))}executor(null,cb)}}().freeze();var slice=[].slice,own={}.hasOwnProperty,pipeline=trough().use((function(p,ctx){ctx.tree=p.parse(ctx.file)})).use((function(p,ctx,next){p.run(ctx.tree,ctx.file,(function(err,tree,file){err?next(err):(ctx.tree=tree,ctx.file=file,next())}))})).use((function(p,ctx){ctx.file.contents=p.stringify(ctx.tree,ctx.file)}));function newable(value){return func(value)&&function(value){var key;for(key in value)return!0;return!1}(value.prototype)}function assertParser(name,Parser){if(!func(Parser))throw new Error("Cannot `"+name+"` without `Parser`")}function assertCompiler(name,Compiler){if(!func(Compiler))throw new Error("Cannot `"+name+"` without `Compiler`")}function assertUnfrozen(name,frozen){if(frozen)throw new Error("Cannot invoke `"+name+"` on a frozen processor.\nCreate a new processor first, by invoking it: use `processor()` instead of `processor`.")}function assertNode(node){if(!node||!string(node.type))throw new Error("Expected node, got `"+node+"`")}function assertDone(name,asyncName,complete){if(!complete)throw new Error("`"+name+"` finished async. Use `"+asyncName+"` instead")}},1029:function(module,exports,__webpack_require__){"use strict";var hasOwn=Object.prototype.hasOwnProperty,toStr=Object.prototype.toString,defineProperty=Object.defineProperty,gOPD=Object.getOwnPropertyDescriptor,isArray=function(arr){return"function"==typeof Array.isArray?Array.isArray(arr):"[object Array]"===toStr.call(arr)},isPlainObject=function(obj){if(!obj||"[object Object]"!==toStr.call(obj))return!1;var key,hasOwnConstructor=hasOwn.call(obj,"constructor"),hasIsPrototypeOf=obj.constructor&&obj.constructor.prototype&&hasOwn.call(obj.constructor.prototype,"isPrototypeOf");if(obj.constructor&&!hasOwnConstructor&&!hasIsPrototypeOf)return!1;for(key in obj);return void 0===key||hasOwn.call(obj,key)},setProperty=function(target,options){defineProperty&&"__proto__"===options.name?defineProperty(target,options.name,{enumerable:!0,configurable:!0,value:options.newValue,writable:!0}):target[options.name]=options.newValue},getProperty=function(obj,name){if("__proto__"===name){if(!hasOwn.call(obj,name))return;if(gOPD)return gOPD(obj,name).value}return obj[name]};module.exports=function extend(){var options,name,src,copy,copyIsArray,clone,target=arguments[0],i=1,length=arguments.length,deep=!1;for("boolean"==typeof target&&(deep=target,target=arguments[1]||{},i=2),(null==target||"object"!=typeof target&&"function"!=typeof target)&&(target={});i<length;++i)if(null!=(options=arguments[i]))for(name in options)src=getProperty(target,name),target!==(copy=getProperty(options,name))&&(deep&&copy&&(isPlainObject(copy)||(copyIsArray=isArray(copy)))?(copyIsArray?(copyIsArray=!1,clone=src&&isArray(src)?src:[]):clone=src&&isPlainObject(src)?src:{},setProperty(target,{name:name,newValue:extend(deep,clone,copy)})):void 0!==copy&&setProperty(target,{name:name,newValue:copy}));return target}},1030:function(module,exports,__webpack_require__){"use strict";module.exports=function(err){if(err)throw err}},1031:function(module,exports,__webpack_require__){"use strict";var VMessage=__webpack_require__(1032),VFile=__webpack_require__(1034);module.exports=VFile;var proto=VFile.prototype;function message(reason,position,origin){var filePath=this.path,message=new VMessage(reason,position,origin);return filePath&&(message.name=filePath+":"+message.name,message.file=filePath),message.fatal=!1,this.messages.push(message),message}proto.message=message,proto.info=function(){var message=this.message.apply(this,arguments);return message.fatal=null,message},proto.fail=function(){var message=this.message.apply(this,arguments);throw message.fatal=!0,message},proto.warn=message},1032:function(module,exports,__webpack_require__){"use strict";var stringify=__webpack_require__(1033);function VMessagePrototype(){}module.exports=VMessage,VMessagePrototype.prototype=Error.prototype,VMessage.prototype=new VMessagePrototype;var proto=VMessage.prototype;function VMessage(reason,position,origin){var parts,range,location;"string"==typeof position&&(origin=position,position=null),parts=function(origin){var index,result=[null,null];"string"==typeof origin&&(-1===(index=origin.indexOf(":"))?result[1]=origin:(result[0]=origin.slice(0,index),result[1]=origin.slice(index+1)));return result}(origin),range=stringify(position)||"1:1",location={start:{line:null,column:null},end:{line:null,column:null}},position&&position.position&&(position=position.position),position&&(position.start?(location=position,position=position.start):location.start=position),reason.stack&&(this.stack=reason.stack,reason=reason.message),this.message=reason,this.name=range,this.reason=reason,this.line=position?position.line:null,this.column=position?position.column:null,this.location=location,this.source=parts[0],this.ruleId=parts[1]}proto.file="",proto.name="",proto.reason="",proto.message="",proto.stack="",proto.fatal=null,proto.column=null,proto.line=null},1033:function(module,exports,__webpack_require__){"use strict";var own={}.hasOwnProperty;function position(pos){return pos&&"object"==typeof pos||(pos={}),index(pos.line)+":"+index(pos.column)}function location(loc){return loc&&"object"==typeof loc||(loc={}),position(loc.start)+"-"+position(loc.end)}function index(value){return value&&"number"==typeof value?value:1}module.exports=function(value){if(!value||"object"!=typeof value)return null;if(own.call(value,"position")||own.call(value,"type"))return location(value.position);if(own.call(value,"start")||own.call(value,"end"))return location(value);if(own.call(value,"line")||own.call(value,"column"))return position(value);return null}},1034:function(module,exports,__webpack_require__){"use strict";(function(process){var path=__webpack_require__(480),replace=__webpack_require__(1035),buffer=__webpack_require__(691);module.exports=VFile;var own={}.hasOwnProperty,proto=VFile.prototype;proto.toString=function(encoding){var value=this.contents||"";return buffer(value)?value.toString(encoding):String(value)};var order=["history","path","basename","stem","extname","dirname"];function VFile(options){var prop,index,length;if(options){if("string"==typeof options||buffer(options))options={contents:options};else if("message"in options&&"messages"in options)return options}else options={};if(!(this instanceof VFile))return new VFile(options);for(this.data={},this.messages=[],this.history=[],this.cwd=process.cwd(),index=-1,length=order.length;++index<length;)prop=order[index],own.call(options,prop)&&(this[prop]=options[prop]);for(prop in options)-1===order.indexOf(prop)&&(this[prop]=options[prop])}function assertPart(part,name){if(-1!==part.indexOf(path.sep))throw new Error("`"+name+"` cannot be a path: did not expect `"+path.sep+"`")}function assertNonEmpty(part,name){if(!part)throw new Error("`"+name+"` cannot be empty")}function assertPath(path,name){if(!path)throw new Error("Setting `"+name+"` requires `path` to be set too")}Object.defineProperty(proto,"path",{get:function(){return this.history[this.history.length-1]},set:function(path){assertNonEmpty(path,"path"),path!==this.path&&this.history.push(path)}}),Object.defineProperty(proto,"dirname",{get:function(){return"string"==typeof this.path?path.dirname(this.path):void 0},set:function(dirname){assertPath(this.path,"dirname"),this.path=path.join(dirname||"",this.basename)}}),Object.defineProperty(proto,"basename",{get:function(){return"string"==typeof this.path?path.basename(this.path):void 0},set:function(basename){assertNonEmpty(basename,"basename"),assertPart(basename,"basename"),this.path=path.join(this.dirname||"",basename)}}),Object.defineProperty(proto,"extname",{get:function(){return"string"==typeof this.path?path.extname(this.path):void 0},set:function(extname){var ext=extname||"";if(assertPart(ext,"extname"),assertPath(this.path,"extname"),ext){if("."!==ext.charAt(0))throw new Error("`extname` must start with `.`");if(-1!==ext.indexOf(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=replace(this.path,ext)}}),Object.defineProperty(proto,"stem",{get:function(){return"string"==typeof this.path?path.basename(this.path,this.extname):void 0},set:function(stem){assertNonEmpty(stem,"stem"),assertPart(stem,"stem"),this.path=path.join(this.dirname||"",stem+(this.extname||""))}})}).call(this,__webpack_require__(698))},1035:function(module,exports,__webpack_require__){"use strict";var path=__webpack_require__(480);module.exports=function(npath,ext){if("string"!=typeof npath)return npath;if(0===npath.length)return npath;var nFileName=path.basename(npath,path.extname(npath))+ext;return path.join(path.dirname(npath),nFileName)}},1036:function(module,exports,__webpack_require__){"use strict";module.exports=function(){var fns=[],middleware={};return middleware.run=function(){var index=-1,input=slice.call(arguments,0,-1),done=arguments[arguments.length-1];if("function"!=typeof done)throw new Error("Expected function as last argument, not "+done);function next(err){var fn=fns[++index],params=slice.call(arguments,0),values=params.slice(1),length=input.length,pos=-1;if(err)done(err);else{for(;++pos<length;)null!==values[pos]&&void 0!==values[pos]||(values[pos]=input[pos]);input=values,fn?wrap(fn,next).apply(null,input):done.apply(null,[null].concat(input))}}next.apply(null,[null].concat(input))},middleware.use=function(fn){if("function"!=typeof fn)throw new Error("Expected `fn` to be a function, not "+fn);return fns.push(fn),middleware},middleware};var slice=[].slice;function wrap(fn,next){var invoked;return function(){var result,params=slice.call(arguments,0),callback=fn.length>params.length;callback&&params.push(done);try{result=fn.apply(null,params)}catch(err){if(callback&&invoked)throw err;return done(err)}callback||(result&&"function"==typeof result.then?result.then(then,done):result instanceof Error?done(result):then(result))};function done(){invoked||(invoked=!0,next.apply(null,arguments))}function then(value){done(null,value)}}},1037:function(module,exports){var toString=Object.prototype.toString;module.exports=function(obj){return"[object String]"===toString.call(obj)}},1038:function(module,exports){module.exports=function(fn){return"[object Function]"===Object.prototype.toString.call(fn)}},1039:function(module,exports,__webpack_require__){"use strict";var toString=Object.prototype.toString;module.exports=function(x){var prototype;return"[object Object]"===toString.call(x)&&(null===(prototype=Object.getPrototypeOf(x))||prototype===Object.getPrototypeOf({}))}},1040:function(module,exports,__webpack_require__){"use strict";var unherit=__webpack_require__(1041),xtend=__webpack_require__(217),Parser=__webpack_require__(1043);function parse(options){var Local=unherit(Parser);Local.prototype.options=xtend(Local.prototype.options,this.data("settings"),options),this.Parser=Local}module.exports=parse,parse.Parser=Parser},1041:function(module,exports,__webpack_require__){"use strict";
/**
 * @author Titus Wormer
 * @copyright 2015 Titus Wormer
 * @license MIT
 * @module unherit
 * @fileoverview Create a custom constructor which can be modified
 *   without affecting the original class.
 */var xtend=__webpack_require__(217),inherits=__webpack_require__(1042);module.exports=function(Super){var result,key,value;for(key in inherits(Of,Super),inherits(From,Of),result=Of.prototype)(value=result[key])&&"object"==typeof value&&(result[key]="concat"in value?value.concat():xtend(value));return Of;function From(parameters){return Super.apply(this,parameters)}function Of(){return this instanceof Of?Super.apply(this,arguments):new From(arguments)}}},1042:function(module,exports){"function"==typeof Object.create?module.exports=function(ctor,superCtor){superCtor&&(ctor.super_=superCtor,ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:!1,writable:!0,configurable:!0}}))}:module.exports=function(ctor,superCtor){if(superCtor){ctor.super_=superCtor;var TempCtor=function(){};TempCtor.prototype=superCtor.prototype,ctor.prototype=new TempCtor,ctor.prototype.constructor=ctor}}},1043:function(module,exports,__webpack_require__){"use strict";var xtend=__webpack_require__(217),toggle=__webpack_require__(1044),vfileLocation=__webpack_require__(1045),unescape=__webpack_require__(1046),decode=__webpack_require__(1047),tokenizer=__webpack_require__(1053);function Parser(doc,file){this.file=file,this.offset={},this.options=xtend(this.options),this.setOptions({}),this.inList=!1,this.inBlock=!1,this.inLink=!1,this.atStart=!0,this.toOffset=vfileLocation(file).toOffset,this.unescape=unescape(this,"escape"),this.decode=decode(this)}module.exports=Parser;var proto=Parser.prototype;function keys(value){var key,result=[];for(key in value)result.push(key);return result}proto.setOptions=__webpack_require__(1054),proto.parse=__webpack_require__(1057),proto.options=__webpack_require__(700),proto.exitStart=toggle("atStart",!0),proto.enterList=toggle("inList",!1),proto.enterLink=toggle("inLink",!1),proto.enterBlock=toggle("inBlock",!1),proto.interruptParagraph=[["thematicBreak"],["atxHeading"],["fencedCode"],["blockquote"],["html"],["setextHeading",{commonmark:!1}],["definition",{commonmark:!1}],["footnote",{commonmark:!1}]],proto.interruptList=[["atxHeading",{pedantic:!1}],["fencedCode",{pedantic:!1}],["thematicBreak",{pedantic:!1}],["definition",{commonmark:!1}],["footnote",{commonmark:!1}]],proto.interruptBlockquote=[["indentedCode",{commonmark:!0}],["fencedCode",{commonmark:!0}],["atxHeading",{commonmark:!0}],["setextHeading",{commonmark:!0}],["thematicBreak",{commonmark:!0}],["html",{commonmark:!0}],["list",{commonmark:!0}],["definition",{commonmark:!1}],["footnote",{commonmark:!1}]],proto.blockTokenizers={newline:__webpack_require__(1061),indentedCode:__webpack_require__(1062),fencedCode:__webpack_require__(1063),blockquote:__webpack_require__(1064),atxHeading:__webpack_require__(1065),thematicBreak:__webpack_require__(1066),list:__webpack_require__(1067),setextHeading:__webpack_require__(1069),html:__webpack_require__(1070),footnote:__webpack_require__(1071),definition:__webpack_require__(1073),table:__webpack_require__(1074),paragraph:__webpack_require__(1075)},proto.inlineTokenizers={escape:__webpack_require__(1076),autoLink:__webpack_require__(1078),url:__webpack_require__(1079),html:__webpack_require__(1081),link:__webpack_require__(1082),reference:__webpack_require__(1083),strong:__webpack_require__(1084),emphasis:__webpack_require__(1086),deletion:__webpack_require__(1089),code:__webpack_require__(1091),break:__webpack_require__(1093),text:__webpack_require__(1095)},proto.blockMethods=keys(proto.blockTokenizers),proto.inlineMethods=keys(proto.inlineTokenizers),proto.tokenizeBlock=tokenizer("block"),proto.tokenizeInline=tokenizer("inline"),proto.tokenizeFactory=tokenizer},1044:function(module,exports,__webpack_require__){"use strict";
/**
 * @author Titus Wormer
 * @copyright 2016 Titus Wormer
 * @license MIT
 * @module state-toggle
 * @fileoverview Enter/exit a state.
 */module.exports=function(key,state,ctx){return function(){var context=ctx||this,current=context[key];return context[key]=!state,function(){context[key]=current}}}},1045:function(module,exports,__webpack_require__){"use strict";function offsetToPositionFactory(indices){return function(offset){var index=-1,length=indices.length;if(offset<0)return{};for(;++index<length;)if(indices[index]>offset)return{line:index+1,column:offset-(indices[index-1]||0)+1,offset:offset};return{}}}function positionToOffsetFactory(indices){return function(position){var line=position&&position.line,column=position&&position.column;if(!isNaN(line)&&!isNaN(column)&&line-1 in indices)return(indices[line-2]||0)+column-1||0;return-1}}module.exports=function(file){var contents=function(value){var result=[],index=value.indexOf("\n");for(;-1!==index;)result.push(index+1),index=value.indexOf("\n",index+1);return result.push(value.length+1),result}(String(file));return{toPosition:offsetToPositionFactory(contents),toOffset:positionToOffsetFactory(contents)}}},1046:function(module,exports,__webpack_require__){"use strict";module.exports=function(ctx,key){return function(value){var character,prev=0,index=value.indexOf("\\"),escape=ctx[key],queue=[];for(;-1!==index;)queue.push(value.slice(prev,index)),prev=index+1,(character=value.charAt(prev))&&-1!==escape.indexOf(character)||queue.push("\\"),index=value.indexOf("\\",prev);return queue.push(value.slice(prev)),queue.join("")}}},1047:function(module,exports,__webpack_require__){"use strict";var xtend=__webpack_require__(217),entities=__webpack_require__(481);module.exports=function(ctx){return decoder.raw=function(value,position,options){return entities(value,xtend(options,{position:normalize(position),warning:handleWarning}))},decoder;function normalize(position){for(var offsets=ctx.offset,line=position.line,result=[];++line&&line in offsets;)result.push((offsets[line]||0)+1);return{start:position,indent:result}}function handleWarning(reason,position,code){3!==code&&ctx.file.message(reason,position)}function decoder(value,position,handler){entities(value,{position:normalize(position),warning:handleWarning,text:handler,reference:handler,textContext:ctx,referenceContext:ctx})}}},1048:function(module){module.exports=JSON.parse('{"AElig":"Æ","AMP":"&","Aacute":"Á","Acirc":"Â","Agrave":"À","Aring":"Å","Atilde":"Ã","Auml":"Ä","COPY":"©","Ccedil":"Ç","ETH":"Ð","Eacute":"É","Ecirc":"Ê","Egrave":"È","Euml":"Ë","GT":">","Iacute":"Í","Icirc":"Î","Igrave":"Ì","Iuml":"Ï","LT":"<","Ntilde":"Ñ","Oacute":"Ó","Ocirc":"Ô","Ograve":"Ò","Oslash":"Ø","Otilde":"Õ","Ouml":"Ö","QUOT":"\\"","REG":"®","THORN":"Þ","Uacute":"Ú","Ucirc":"Û","Ugrave":"Ù","Uuml":"Ü","Yacute":"Ý","aacute":"á","acirc":"â","acute":"´","aelig":"æ","agrave":"à","amp":"&","aring":"å","atilde":"ã","auml":"ä","brvbar":"¦","ccedil":"ç","cedil":"¸","cent":"¢","copy":"©","curren":"¤","deg":"°","divide":"÷","eacute":"é","ecirc":"ê","egrave":"è","eth":"ð","euml":"ë","frac12":"½","frac14":"¼","frac34":"¾","gt":">","iacute":"í","icirc":"î","iexcl":"¡","igrave":"ì","iquest":"¿","iuml":"ï","laquo":"«","lt":"<","macr":"¯","micro":"µ","middot":"·","nbsp":" ","not":"¬","ntilde":"ñ","oacute":"ó","ocirc":"ô","ograve":"ò","ordf":"ª","ordm":"º","oslash":"ø","otilde":"õ","ouml":"ö","para":"¶","plusmn":"±","pound":"£","quot":"\\"","raquo":"»","reg":"®","sect":"§","shy":"­","sup1":"¹","sup2":"²","sup3":"³","szlig":"ß","thorn":"þ","times":"×","uacute":"ú","ucirc":"û","ugrave":"ù","uml":"¨","uuml":"ü","yacute":"ý","yen":"¥","yuml":"ÿ"}')},1049:function(module){module.exports=JSON.parse('{"0":"�","128":"€","130":"‚","131":"ƒ","132":"„","133":"…","134":"†","135":"‡","136":"ˆ","137":"‰","138":"Š","139":"‹","140":"Œ","142":"Ž","145":"‘","146":"’","147":"“","148":"”","149":"•","150":"–","151":"—","152":"˜","153":"™","154":"š","155":"›","156":"œ","158":"ž","159":"Ÿ"}')},1050:function(module,exports,__webpack_require__){"use strict";module.exports=function(character){var code="string"==typeof character?character.charCodeAt(0):character;return code>=97&&code<=102||code>=65&&code<=70||code>=48&&code<=57}},1051:function(module,exports,__webpack_require__){"use strict";var alphabetical=__webpack_require__(699),decimal=__webpack_require__(385);module.exports=function(character){return alphabetical(character)||decimal(character)}},1052:function(module,exports,__webpack_require__){"use strict";var el;module.exports=function(characters){var char,entity="&"+characters+";";if((el=el||document.createElement("i")).innerHTML=entity,";"===(char=el.textContent).slice(-1)&&"semi"!==characters)return!1;return char!==entity&&char}},1053:function(module,exports,__webpack_require__){"use strict";module.exports=function(type){return function(value,location){var index,length,method,name,matched,valueLength,self=this,offset=self.offset,tokens=[],methods=self[type+"Methods"],tokenizers=self[type+"Tokenizers"],line=location.line,column=location.column;if(!value)return tokens;eat.now=now,eat.file=self.file,updatePosition("");for(;value;){for(index=-1,length=methods.length,matched=!1;++index<length&&(name=methods[index],!(method=tokenizers[name])||method.onlyAtStart&&!self.atStart||method.notInList&&self.inList||method.notInBlock&&self.inBlock||method.notInLink&&self.inLink||(valueLength=value.length,method.apply(self,[eat,value]),!(matched=valueLength!==value.length))););matched||self.file.fail(new Error("Infinite loop"),eat.now())}return self.eof=now(),tokens;function updatePosition(subvalue){for(var lastIndex=-1,index=subvalue.indexOf("\n");-1!==index;)line++,lastIndex=index,index=subvalue.indexOf("\n",index+1);-1===lastIndex?column+=subvalue.length:column=subvalue.length-lastIndex,line in offset&&(-1!==lastIndex?column+=offset[line]:column<=offset[line]&&(column=offset[line]+1))}function now(){var pos={line:line,column:column};return pos.offset=self.toOffset(pos),pos}function Position(start){this.start=start,this.end=now()}function eat(subvalue){var before,indent=function(){var indentation=[],pos=line+1;return function(){for(var last=line+1;pos<last;)indentation.push((offset[pos]||0)+1),pos++;return indentation}}(),pos=(before=now(),function(node,indent){var prev=node.position,start=prev?prev.start:before,combined=[],n=prev&&prev.end.line,l=before.line;if(node.position=new Position(start),prev&&indent&&prev.indent){if(combined=prev.indent,n<l){for(;++n<l;)combined.push((offset[n]||0)+1);combined.push(before.column)}indent=combined.concat(indent)}return node.position.indent=indent||[],node}),current=now();return function(subvalue){value.substring(0,subvalue.length)!==subvalue&&self.file.fail(new Error("Incorrectly eaten value: please report this warning on http://git.io/vg5Ft"),now())}(subvalue),apply.reset=reset,reset.test=test,apply.test=test,value=value.substring(subvalue.length),updatePosition(subvalue),indent=indent(),apply;function apply(node,parent){return pos(function(node,parent){var children=parent?parent.children:tokens,prev=children[children.length-1];return prev&&node.type===prev.type&&node.type in MERGEABLE_NODES&&mergeable(prev)&&mergeable(node)&&(node=MERGEABLE_NODES[node.type].call(self,prev,node)),node!==prev&&children.push(node),self.atStart&&0!==tokens.length&&self.exitStart(),node}(pos(node),parent),indent)}function reset(){var node=apply.apply(null,arguments);return line=current.line,column=current.column,value=subvalue+value,node}function test(){var result=pos({});return line=current.line,column=current.column,value=subvalue+value,result.position}}}};var MERGEABLE_NODES={text:function(prev,node){return prev.value+=node.value,prev},blockquote:function(prev,node){if(this.options.commonmark)return node;return prev.children=prev.children.concat(node.children),prev}};function mergeable(node){var start,end;return"text"!==node.type||!node.position||(start=node.position.start,end=node.position.end,start.line!==end.line||end.column-start.column===node.value.length)}},1054:function(module,exports,__webpack_require__){"use strict";var xtend=__webpack_require__(217),escapes=__webpack_require__(1055),defaults=__webpack_require__(700);module.exports=function(options){var key,value,current=this.options;if(null==options)options={};else{if("object"!=typeof options)throw new Error("Invalid value `"+options+"` for setting `options`");options=xtend(options)}for(key in defaults){if(null==(value=options[key])&&(value=current[key]),"blocks"!==key&&"boolean"!=typeof value||"blocks"===key&&"object"!=typeof value)throw new Error("Invalid value `"+value+"` for setting `options."+key+"`");options[key]=value}return this.options=options,this.escape=escapes(options),this}},1055:function(module,exports,__webpack_require__){"use strict";module.exports=escapes;var defaults=["\\","`","*","{","}","[","]","(",")","#","+","-",".","!","_",">"],gfm=defaults.concat(["~","|"]),commonmark=gfm.concat(["\n",'"',"$","%","&","'",",","/",":",";","<","=","?","@","^"]);function escapes(options){var settings=options||{};return settings.commonmark?commonmark:settings.gfm?gfm:defaults}escapes.default=defaults,escapes.gfm=gfm,escapes.commonmark=commonmark},1056:function(module){module.exports=JSON.parse('["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","iframe","legend","li","link","main","menu","menuitem","meta","nav","noframes","ol","optgroup","option","p","param","pre","section","source","title","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"]')},1057:function(module,exports,__webpack_require__){"use strict";var xtend=__webpack_require__(217),removePosition=__webpack_require__(1058);module.exports=function(){var node,value=String(this.file),start={line:1,column:1,offset:0},content=xtend(start);65279===(value=value.replace(EXPRESSION_LINE_BREAKS,"\n")).charCodeAt(0)&&(value=value.slice(1),content.column++,content.offset++);node={type:"root",children:this.tokenizeBlock(value,content),position:{start:start,end:this.eof||xtend(start)}},this.options.position||removePosition(node,!0);return node};var EXPRESSION_LINE_BREAKS=/\r\n|\r/g},1058:function(module,exports,__webpack_require__){"use strict";var visit=__webpack_require__(386);function hard(node){delete node.position}function soft(node){node.position=void 0}module.exports=function(node,force){return visit(node,force?hard:soft),node}},1059:function(module,exports,__webpack_require__){"use strict";module.exports=visitParents;var convert=__webpack_require__(1060);function visitParents(tree,test,visitor,reverse){var is;function one(node,index,parents){var subresult,result=[];return(test&&!is(node,index,parents[parents.length-1]||null)||!1!==(result=toResult(visitor(node,parents)))[0])&&node.children&&"skip"!==result[0]&&!1===(subresult=toResult(function(children,parents){var result,step=reverse?-1:1,index=(reverse?children.length:-1)+step;for(;index>-1&&index<children.length;){if(!1===(result=one(children[index],index,parents))[0])return result;index="number"==typeof result[1]?result[1]:index+step}}(node.children,parents.concat(node))))[0]?subresult:result}"function"==typeof test&&"function"!=typeof visitor&&(reverse=visitor,visitor=test,test=null),is=convert(test),one(tree,null,[])}function toResult(value){return null!==value&&"object"==typeof value&&"length"in value?value:"number"==typeof value?[!0,value]:[value]}visitParents.CONTINUE=!0,visitParents.SKIP="skip",visitParents.EXIT=!1},1060:function(module,exports,__webpack_require__){"use strict";function convert(test){if("string"==typeof test)return function(test){return function(node){return Boolean(node&&node.type===test)}}(test);if(null==test)return ok;if("object"==typeof test)return("length"in test?anyFactory:matchesFactory)(test);if("function"==typeof test)return test;throw new Error("Expected function, string, or object as test")}function matchesFactory(test){return function(node){var key;for(key in test)if(node[key]!==test[key])return!1;return!0}}function anyFactory(tests){var checks=function(tests){for(var results=[],length=tests.length,index=-1;++index<length;)results[index]=convert(tests[index]);return results}(tests),length=checks.length;return function(){var index=-1;for(;++index<length;)if(checks[index].apply(this,arguments))return!0;return!1}}function ok(){return!0}module.exports=convert},1061:function(module,exports,__webpack_require__){"use strict";var whitespace=__webpack_require__(177);module.exports=function(eat,value,silent){var length,subvalue,queue,index,character=value.charAt(0);if("\n"!==character)return;if(silent)return!0;index=1,length=value.length,subvalue=character,queue="";for(;index<length&&(character=value.charAt(index),whitespace(character));)queue+=character,"\n"===character&&(subvalue+=queue,queue=""),index++;eat(subvalue)}},1062:function(module,exports,__webpack_require__){"use strict";var repeat=__webpack_require__(482),trim=__webpack_require__(483);module.exports=function(eat,value,silent){var character,blankQueue,indent,index=-1,length=value.length,subvalue="",content="",subvalueQueue="",contentQueue="";for(;++index<length;)if(character=value.charAt(index),indent)if(indent=!1,subvalue+=subvalueQueue,content+=contentQueue,subvalueQueue="",contentQueue="","\n"===character)subvalueQueue=character,contentQueue=character;else for(subvalue+=character,content+=character;++index<length;){if(!(character=value.charAt(index))||"\n"===character){contentQueue=character,subvalueQueue=character;break}subvalue+=character,content+=character}else if(" "===character&&value.charAt(index+1)===character&&value.charAt(index+2)===character&&value.charAt(index+3)===character)subvalueQueue+=CODE_INDENT,index+=3,indent=!0;else if("\t"===character)subvalueQueue+=character,indent=!0;else{for(blankQueue="";"\t"===character||" "===character;)blankQueue+=character,character=value.charAt(++index);if("\n"!==character)break;subvalueQueue+=blankQueue+character,contentQueue+=character}if(content)return!!silent||eat(subvalue)({type:"code",lang:null,value:trim(content)})};var CODE_INDENT=repeat(" ",4)},1063:function(module,exports,__webpack_require__){"use strict";var trim=__webpack_require__(483);module.exports=function(eat,value,silent){var fenceCount,marker,character,flag,queue,content,exdentedContent,closing,exdentedClosing,indent,now,settings=this.options,length=value.length+1,index=0,subvalue="";if(!settings.gfm)return;for(;index<length&&(" "===(character=value.charAt(index))||"\t"===character);)subvalue+=character,index++;if(indent=index,"~"!==(character=value.charAt(index))&&"`"!==character)return;index++,marker=character,fenceCount=1,subvalue+=character;for(;index<length&&(character=value.charAt(index))===marker;)subvalue+=character,fenceCount++,index++;if(fenceCount<3)return;for(;index<length&&(" "===(character=value.charAt(index))||"\t"===character);)subvalue+=character,index++;flag="",queue="";for(;index<length&&"\n"!==(character=value.charAt(index))&&"~"!==character&&"`"!==character;)" "===character||"\t"===character?queue+=character:(flag+=queue+character,queue=""),index++;if((character=value.charAt(index))&&"\n"!==character)return;if(silent)return!0;(now=eat.now()).column+=subvalue.length,now.offset+=subvalue.length,subvalue+=flag,flag=this.decode.raw(this.unescape(flag),now),queue&&(subvalue+=queue);queue="",closing="",exdentedClosing="",content="",exdentedContent="";for(;index<length;)if(character=value.charAt(index),content+=closing,exdentedContent+=exdentedClosing,closing="",exdentedClosing="","\n"===character){for(content?(closing+=character,exdentedClosing+=character):subvalue+=character,queue="",index++;index<length&&" "===(character=value.charAt(index));)queue+=character,index++;if(closing+=queue,exdentedClosing+=queue.slice(indent),!(queue.length>=4)){for(queue="";index<length&&(character=value.charAt(index))===marker;)queue+=character,index++;if(closing+=queue,exdentedClosing+=queue,!(queue.length<fenceCount)){for(queue="";index<length&&(" "===(character=value.charAt(index))||"\t"===character);)closing+=character,exdentedClosing+=character,index++;if(!character||"\n"===character)break}}}else content+=character,exdentedClosing+=character,index++;return eat(subvalue+=content+closing)({type:"code",lang:flag||null,value:trim(exdentedContent)})}},1064:function(module,exports,__webpack_require__){"use strict";var trim=__webpack_require__(282),interrupt=__webpack_require__(484);module.exports=function(eat,value,silent){var add,character,rest,nextIndex,content,line,startIndex,prefixed,exit,offsets=this.offset,tokenizers=this.blockTokenizers,interruptors=this.interruptBlockquote,now=eat.now(),currentLine=now.line,length=value.length,values=[],contents=[],indents=[],index=0;for(;index<length&&(" "===(character=value.charAt(index))||"\t"===character);)index++;if(">"!==value.charAt(index))return;if(silent)return!0;index=0;for(;index<length;){for(nextIndex=value.indexOf("\n",index),startIndex=index,prefixed=!1,-1===nextIndex&&(nextIndex=length);index<length&&(" "===(character=value.charAt(index))||"\t"===character);)index++;if(">"===value.charAt(index)?(index++,prefixed=!0," "===value.charAt(index)&&index++):index=startIndex,content=value.slice(index,nextIndex),!prefixed&&!trim(content)){index=startIndex;break}if(!prefixed&&(rest=value.slice(index),interrupt(interruptors,tokenizers,this,[eat,rest,!0])))break;line=startIndex===index?content:value.slice(startIndex,nextIndex),indents.push(index-startIndex),values.push(line),contents.push(content),index=nextIndex+1}index=-1,length=indents.length,add=eat(values.join("\n"));for(;++index<length;)offsets[currentLine]=(offsets[currentLine]||0)+indents[index],currentLine++;return exit=this.enterBlock(),contents=this.tokenizeBlock(contents.join("\n"),now),exit(),add({type:"blockquote",children:contents})}},1065:function(module,exports,__webpack_require__){"use strict";module.exports=function(eat,value,silent){var character,queue,depth,settings=this.options,length=value.length+1,index=-1,now=eat.now(),subvalue="",content="";for(;++index<length;){if(" "!==(character=value.charAt(index))&&"\t"!==character){index--;break}subvalue+=character}depth=0;for(;++index<=length;){if("#"!==(character=value.charAt(index))){index--;break}subvalue+=character,depth++}if(depth>6)return;if(!depth||!settings.pedantic&&"#"===value.charAt(index+1))return;length=value.length+1,queue="";for(;++index<length;){if(" "!==(character=value.charAt(index))&&"\t"!==character){index--;break}queue+=character}if(!settings.pedantic&&0===queue.length&&character&&"\n"!==character)return;if(silent)return!0;subvalue+=queue,queue="",content="";for(;++index<length&&(character=value.charAt(index))&&"\n"!==character;)if(" "===character||"\t"===character||"#"===character){for(;" "===character||"\t"===character;)queue+=character,character=value.charAt(++index);for(;"#"===character;)queue+=character,character=value.charAt(++index);for(;" "===character||"\t"===character;)queue+=character,character=value.charAt(++index);index--}else content+=queue+character,queue="";return now.column+=subvalue.length,now.offset+=subvalue.length,eat(subvalue+=content+queue)({type:"heading",depth:depth,children:this.tokenizeInline(content,now)})}},1066:function(module,exports,__webpack_require__){"use strict";module.exports=function(eat,value,silent){var character,marker,markerCount,queue,index=-1,length=value.length+1,subvalue="";for(;++index<length&&("\t"===(character=value.charAt(index))||" "===character);)subvalue+=character;if("*"!==character&&"-"!==character&&"_"!==character)return;marker=character,subvalue+=character,markerCount=1,queue="";for(;++index<length;)if((character=value.charAt(index))===marker)markerCount++,subvalue+=queue+marker,queue="";else{if(" "!==character)return markerCount>=3&&(!character||"\n"===character)?(subvalue+=queue,!!silent||eat(subvalue)({type:"thematicBreak"})):void 0;queue+=character}}},1067:function(module,exports,__webpack_require__){"use strict";var trim=__webpack_require__(282),repeat=__webpack_require__(482),decimal=__webpack_require__(385),getIndent=__webpack_require__(701),removeIndent=__webpack_require__(1068),interrupt=__webpack_require__(484);module.exports=function(eat,value,silent){var markers,queue,ordered,character,marker,nextIndex,startIndex,prefixed,currentMarker,content,line,prevEmpty,empty,items,allLines,emptyLines,item,enterTop,exitBlockquote,isLoose,node,now,end,indented,commonmark=this.options.commonmark,pedantic=this.options.pedantic,tokenizers=this.blockTokenizers,interuptors=this.interruptList,index=0,length=value.length,start=null,size=0;for(;index<length;){if("\t"===(character=value.charAt(index)))size+=4-size%4;else{if(" "!==character)break;size++}index++}if(size>=4)return;if(character=value.charAt(index),markers=commonmark?LIST_ORDERED_COMMONMARK_MARKERS:LIST_ORDERED_MARKERS,!0===LIST_UNORDERED_MARKERS[character])marker=character,ordered=!1;else{for(ordered=!0,queue="";index<length&&(character=value.charAt(index),decimal(character));)queue+=character,index++;if(character=value.charAt(index),!queue||!0!==markers[character])return;start=parseInt(queue,10),marker=character}if(" "!==(character=value.charAt(++index))&&"\t"!==character)return;if(silent)return!0;index=0,items=[],allLines=[],emptyLines=[];for(;index<length;){for(nextIndex=value.indexOf("\n",index),startIndex=index,prefixed=!1,indented=!1,-1===nextIndex&&(nextIndex=length),end=index+4,size=0;index<length;){if("\t"===(character=value.charAt(index)))size+=4-size%4;else{if(" "!==character)break;size++}index++}if(size>=4&&(indented=!0),item&&size>=item.indent&&(indented=!0),character=value.charAt(index),currentMarker=null,!indented){if(!0===LIST_UNORDERED_MARKERS[character])currentMarker=character,index++,size++;else{for(queue="";index<length&&(character=value.charAt(index),decimal(character));)queue+=character,index++;character=value.charAt(index),index++,queue&&!0===markers[character]&&(currentMarker=character,size+=queue.length+1)}if(currentMarker)if("\t"===(character=value.charAt(index)))size+=4-size%4,index++;else if(" "===character){for(end=index+4;index<end&&" "===value.charAt(index);)index++,size++;index===end&&" "===value.charAt(index)&&(index-=3,size-=3)}else"\n"!==character&&""!==character&&(currentMarker=null)}if(currentMarker){if(!pedantic&&marker!==currentMarker)break;prefixed=!0}else commonmark||indented||" "!==value.charAt(startIndex)?commonmark&&item&&(indented=size>=item.indent||size>4):indented=!0,prefixed=!1,index=startIndex;if(line=value.slice(startIndex,nextIndex),content=startIndex===index?line:value.slice(index,nextIndex),("*"===currentMarker||"_"===currentMarker||"-"===currentMarker)&&tokenizers.thematicBreak.call(this,eat,line,!0))break;if(prevEmpty=empty,empty=!trim(content).length,indented&&item)item.value=item.value.concat(emptyLines,line),allLines=allLines.concat(emptyLines,line),emptyLines=[];else if(prefixed)0!==emptyLines.length&&(item.value.push(""),item.trail=emptyLines.concat()),item={value:[line],indent:size,trail:[]},items.push(item),allLines=allLines.concat(emptyLines,line),emptyLines=[];else if(empty){if(prevEmpty)break;emptyLines.push(line)}else{if(prevEmpty)break;if(interrupt(interuptors,tokenizers,this,[eat,line,!0]))break;item.value=item.value.concat(emptyLines,line),allLines=allLines.concat(emptyLines,line),emptyLines=[]}index=nextIndex+1}node=eat(allLines.join("\n")).reset({type:"list",ordered:ordered,start:start,loose:null,children:[]}),enterTop=this.enterList(),exitBlockquote=this.enterBlock(),isLoose=!1,index=-1,length=items.length;for(;++index<length;)item=items[index].value.join("\n"),now=eat.now(),(item=eat(item)(listItem(this,item,now),node)).loose&&(isLoose=!0),item=items[index].trail.join("\n"),index!==length-1&&(item+="\n"),eat(item);return enterTop(),exitBlockquote(),node.loose=isLoose,node};var EXPRESSION_LOOSE_LIST_ITEM=/\n\n(?!\s*$)/,EXPRESSION_TASK_ITEM=/^\[([ \t]|x|X)][ \t]/,EXPRESSION_BULLET=/^([ \t]*)([*+-]|\d+[.)])( {1,4}(?! )| |\t|$|(?=\n))([^\n]*)/,EXPRESSION_PEDANTIC_BULLET=/^([ \t]*)([*+-]|\d+[.)])([ \t]+)/,EXPRESSION_INITIAL_INDENT=/^( {1,4}|\t)?/gm,LIST_UNORDERED_MARKERS={"*":!0,"+":!0,"-":!0},LIST_ORDERED_MARKERS={".":!0},LIST_ORDERED_COMMONMARK_MARKERS={};function listItem(ctx,value,position){var task,indent,offsets=ctx.offset,fn=ctx.options.pedantic?pedanticListItem:normalListItem,checked=null;return value=fn.apply(null,arguments),ctx.options.gfm&&(task=value.match(EXPRESSION_TASK_ITEM))&&(indent=task[0].length,checked="x"===task[1].toLowerCase(),offsets[position.line]+=indent,value=value.slice(indent)),{type:"listItem",loose:EXPRESSION_LOOSE_LIST_ITEM.test(value)||"\n"===value.charAt(value.length-1),checked:checked,children:ctx.tokenizeBlock(value,position)}}function pedanticListItem(ctx,value,position){var offsets=ctx.offset,line=position.line;return value=value.replace(EXPRESSION_PEDANTIC_BULLET,replacer),line=position.line,value.replace(EXPRESSION_INITIAL_INDENT,replacer);function replacer($0){return offsets[line]=(offsets[line]||0)+$0.length,line++,""}}function normalListItem(ctx,value,position){var max,bullet,rest,lines,trimmedLines,index,length,offsets=ctx.offset,line=position.line;for(lines=(value=value.replace(EXPRESSION_BULLET,(function($0,$1,$2,$3,$4){bullet=$1+$2+$3,rest=$4,Number($2)<10&&bullet.length%2==1&&($2=" "+$2);return(max=$1+repeat(" ",$2.length)+$3)+rest}))).split("\n"),(trimmedLines=removeIndent(value,getIndent(max).indent).split("\n"))[0]=rest,offsets[line]=(offsets[line]||0)+bullet.length,line++,index=0,length=lines.length;++index<length;)offsets[line]=(offsets[line]||0)+lines[index].length-trimmedLines[index].length,line++;return trimmedLines.join("\n")}LIST_ORDERED_COMMONMARK_MARKERS["."]=!0,LIST_ORDERED_COMMONMARK_MARKERS[")"]=!0},1068:function(module,exports,__webpack_require__){"use strict";var trim=__webpack_require__(282),repeat=__webpack_require__(482),getIndent=__webpack_require__(701);module.exports=function(value,maximum){var index,indentation,stops,padding,values=value.split("\n"),position=values.length+1,minIndent=1/0,matrix=[];values.unshift(repeat(" ",maximum)+"!");for(;position--;)if(indentation=getIndent(values[position]),matrix[position]=indentation.stops,0!==trim(values[position]).length){if(!indentation.indent){minIndent=1/0;break}indentation.indent>0&&indentation.indent<minIndent&&(minIndent=indentation.indent)}if(minIndent!==1/0)for(position=values.length;position--;){for(stops=matrix[position],index=minIndent;index&&!(index in stops);)index--;padding=0!==trim(values[position]).length&&minIndent&&index!==minIndent?"\t":"",values[position]=padding+values[position].slice(index in stops?stops[index]+1:0)}return values.shift(),values.join("\n")}},1069:function(module,exports,__webpack_require__){"use strict";module.exports=function(eat,value,silent){var content,queue,character,marker,depth,now=eat.now(),length=value.length,index=-1,subvalue="";for(;++index<length;){if(" "!==(character=value.charAt(index))||index>=3){index--;break}subvalue+=character}content="",queue="";for(;++index<length;){if("\n"===(character=value.charAt(index))){index--;break}" "===character||"\t"===character?queue+=character:(content+=queue+character,queue="")}if(now.column+=subvalue.length,now.offset+=subvalue.length,subvalue+=content+queue,character=value.charAt(++index),marker=value.charAt(++index),"\n"!==character||!SETEXT_MARKERS[marker])return;subvalue+=character,queue=marker,depth=SETEXT_MARKERS[marker];for(;++index<length;){if((character=value.charAt(index))!==marker){if("\n"!==character)return;index--;break}queue+=character}if(silent)return!0;return eat(subvalue+queue)({type:"heading",depth:depth,children:this.tokenizeInline(content,now)})};var SETEXT_MARKERS={};SETEXT_MARKERS["="]=1,SETEXT_MARKERS["-"]=2},1070:function(module,exports,__webpack_require__){"use strict";var openCloseTag=__webpack_require__(702).openCloseTag;module.exports=function(eat,value,silent){var next,line,offset,character,count,sequence,subvalue,blocks=this.options.blocks,length=value.length,index=0,sequences=[[/^<(script|pre|style)(?=(\s|>|$))/i,/<\/(script|pre|style)>/i,!0],[/^<!--/,/-->/,!0],[/^<\?/,/\?>/,!0],[/^<![A-Za-z]/,/>/,!0],[/^<!\[CDATA\[/,/\]\]>/,!0],[new RegExp("^</?("+blocks.join("|")+")(?=(\\s|/?>|$))","i"),/^$/,!0],[new RegExp(openCloseTag.source+"\\s*$"),/^$/,!1]];for(;index<length&&("\t"===(character=value.charAt(index))||" "===character);)index++;if("<"!==value.charAt(index))return;next=-1===(next=value.indexOf("\n",index+1))?length:next,line=value.slice(index,next),offset=-1,count=sequences.length;for(;++offset<count;)if(sequences[offset][0].test(line)){sequence=sequences[offset];break}if(!sequence)return;if(silent)return sequence[2];if(index=next,!sequence[1].test(line))for(;index<length;){if(next=-1===(next=value.indexOf("\n",index+1))?length:next,line=value.slice(index+1,next),sequence[1].test(line)){line&&(index=next);break}index=next}return subvalue=value.slice(0,index),eat(subvalue)({type:"html",value:subvalue})}},1071:function(module,exports,__webpack_require__){"use strict";var whitespace=__webpack_require__(177),normalize=__webpack_require__(485);module.exports=footnoteDefinition,footnoteDefinition.notInList=!0,footnoteDefinition.notInBlock=!0;var EXPRESSION_INITIAL_TAB=/^( {4}|\t)?/gm;function footnoteDefinition(eat,value,silent){var index,length,subvalue,now,currentLine,content,queue,subqueue,character,identifier,add,exit,offsets=this.offset;if(this.options.footnotes){for(index=0,length=value.length,subvalue="",now=eat.now(),currentLine=now.line;index<length&&(character=value.charAt(index),whitespace(character));)subvalue+=character,index++;if("["===value.charAt(index)&&"^"===value.charAt(index+1)){for(index=(subvalue+="[^").length,queue="";index<length&&"]"!==(character=value.charAt(index));)"\\"===character&&(queue+=character,index++,character=value.charAt(index)),queue+=character,index++;if(queue&&"]"===value.charAt(index)&&":"===value.charAt(index+1)){if(silent)return!0;for(identifier=normalize(queue),index=(subvalue+=queue+"]:").length;index<length&&("\t"===(character=value.charAt(index))||" "===character);)subvalue+=character,index++;for(now.column+=subvalue.length,now.offset+=subvalue.length,queue="",content="",subqueue="";index<length;){if("\n"===(character=value.charAt(index))){for(subqueue=character,index++;index<length&&"\n"===(character=value.charAt(index));)subqueue+=character,index++;for(queue+=subqueue,subqueue="";index<length&&" "===(character=value.charAt(index));)subqueue+=character,index++;if(0===subqueue.length)break;queue+=subqueue}queue&&(content+=queue,queue=""),content+=character,index++}return subvalue+=content,content=content.replace(EXPRESSION_INITIAL_TAB,(function(line){return offsets[currentLine]=(offsets[currentLine]||0)+line.length,currentLine++,""})),add=eat(subvalue),exit=this.enterBlock(),content=this.tokenizeBlock(content,now),exit(),add({type:"footnoteDefinition",identifier:identifier,children:content})}}}}},1072:function(module,exports,__webpack_require__){"use strict";module.exports=function(value){return String(value).replace(/\s+/g," ")}},1073:function(module,exports,__webpack_require__){"use strict";var whitespace=__webpack_require__(177),normalize=__webpack_require__(485);module.exports=definition,definition.notInList=!0,definition.notInBlock=!0;function definition(eat,value,silent){for(var beforeURL,beforeTitle,queue,character,test,identifier,url,title,commonmark=this.options.commonmark,index=0,length=value.length,subvalue="";index<length&&(" "===(character=value.charAt(index))||"\t"===character);)subvalue+=character,index++;if("["===(character=value.charAt(index))){for(index++,subvalue+=character,queue="";index<length&&"]"!==(character=value.charAt(index));)"\\"===character&&(queue+=character,index++,character=value.charAt(index)),queue+=character,index++;if(queue&&"]"===value.charAt(index)&&":"===value.charAt(index+1)){for(identifier=queue,index=(subvalue+=queue+"]:").length,queue="";index<length&&("\t"===(character=value.charAt(index))||" "===character||"\n"===character);)subvalue+=character,index++;if(queue="",beforeURL=subvalue,"<"===(character=value.charAt(index))){for(index++;index<length&&isEnclosedURLCharacter(character=value.charAt(index));)queue+=character,index++;if((character=value.charAt(index))===isEnclosedURLCharacter.delimiter)subvalue+="<"+queue+character,index++;else{if(commonmark)return;index-=queue.length+1,queue=""}}if(!queue){for(;index<length&&isUnclosedURLCharacter(character=value.charAt(index));)queue+=character,index++;subvalue+=queue}if(queue){for(url=queue,queue="";index<length&&("\t"===(character=value.charAt(index))||" "===character||"\n"===character);)queue+=character,index++;if(test=null,'"'===(character=value.charAt(index))?test='"':"'"===character?test="'":"("===character&&(test=")"),test){if(!queue)return;for(index=(subvalue+=queue+character).length,queue="";index<length&&(character=value.charAt(index))!==test;){if("\n"===character){if(index++,"\n"===(character=value.charAt(index))||character===test)return;queue+="\n"}queue+=character,index++}if((character=value.charAt(index))!==test)return;beforeTitle=subvalue,subvalue+=queue+character,index++,title=queue,queue=""}else queue="",index=subvalue.length;for(;index<length&&("\t"===(character=value.charAt(index))||" "===character);)subvalue+=character,index++;return(character=value.charAt(index))&&"\n"!==character?void 0:!!silent||(beforeURL=eat(beforeURL).test().end,url=this.decode.raw(this.unescape(url),beforeURL,{nonTerminated:!1}),title&&(beforeTitle=eat(beforeTitle).test().end,title=this.decode.raw(this.unescape(title),beforeTitle)),eat(subvalue)({type:"definition",identifier:normalize(identifier),title:title||null,url:url}))}}}}function isEnclosedURLCharacter(character){return">"!==character&&"["!==character&&"]"!==character}function isUnclosedURLCharacter(character){return"["!==character&&"]"!==character&&!whitespace(character)}isEnclosedURLCharacter.delimiter=">"},1074:function(module,exports,__webpack_require__){"use strict";var whitespace=__webpack_require__(177);module.exports=function(eat,value,silent){var index,alignments,alignment,subvalue,row,length,lines,queue,character,hasDash,align,cell,preamble,count,opening,now,position,lineCount,line,rows,table,lineIndex,pipeIndex,first;if(!this.options.gfm)return;index=0,lineCount=0,length=value.length+1,lines=[];for(;index<length;){if(lineIndex=value.indexOf("\n",index),pipeIndex=value.indexOf("|",index+1),-1===lineIndex&&(lineIndex=value.length),-1===pipeIndex||pipeIndex>lineIndex){if(lineCount<2)return;break}lines.push(value.slice(index,lineIndex)),lineCount++,index=lineIndex+1}subvalue=lines.join("\n"),alignments=lines.splice(1,1)[0]||[],index=0,length=alignments.length,lineCount--,alignment=!1,align=[];for(;index<length;){if("|"===(character=alignments.charAt(index))){if(hasDash=null,!1===alignment){if(!1===first)return}else align.push(alignment),alignment=!1;first=!1}else if("-"===character)hasDash=!0,alignment=alignment||null;else if(":"===character)alignment="left"===alignment?"center":hasDash&&null===alignment?"right":"left";else if(!whitespace(character))return;index++}!1!==alignment&&align.push(alignment);if(align.length<1)return;if(silent)return!0;position=-1,rows=[],table=eat(subvalue).reset({type:"table",align:align,children:rows});for(;++position<lineCount;){for(line=lines[position],row={type:"tableRow",children:[]},position&&eat("\n"),eat(line).reset(row,table),length=line.length+1,index=0,queue="",cell="",preamble=!0,count=null,opening=null;index<length;)if("\t"!==(character=line.charAt(index))&&" "!==character){if(""===character||"|"===character)if(preamble)eat(character);else{if(character&&opening){queue+=character,index++;continue}!cell&&!character||preamble||(subvalue=cell,queue.length>1&&(character?(subvalue+=queue.slice(0,queue.length-1),queue=queue.charAt(queue.length-1)):(subvalue+=queue,queue="")),now=eat.now(),eat(subvalue)({type:"tableCell",children:this.tokenizeInline(cell,now)},row)),eat(queue+character),queue="",cell=""}else if(queue&&(cell+=queue,queue=""),cell+=character,"\\"===character&&index!==length-2&&(cell+=line.charAt(index+1),index++),"`"===character){for(count=1;line.charAt(index+1)===character;)cell+=character,index++,count++;opening?count>=opening&&(opening=0):opening=count}preamble=!1,index++}else cell?queue+=character:eat(character),index++;position||eat("\n"+alignments)}return table}},1075:function(module,exports,__webpack_require__){"use strict";var trim=__webpack_require__(282),decimal=__webpack_require__(385),trimTrailingLines=__webpack_require__(483),interrupt=__webpack_require__(484);module.exports=function(eat,value,silent){var position,subvalue,character,size,now,settings=this.options,commonmark=settings.commonmark,gfm=settings.gfm,tokenizers=this.blockTokenizers,interruptors=this.interruptParagraph,index=value.indexOf("\n"),length=value.length;for(;index<length;){if(-1===index){index=length;break}if("\n"===value.charAt(index+1))break;if(commonmark){for(size=0,position=index+1;position<length;){if("\t"===(character=value.charAt(position))){size=4;break}if(" "!==character)break;size++,position++}if(size>=4){index=value.indexOf("\n",index+1);continue}}if(subvalue=value.slice(index+1),interrupt(interruptors,tokenizers,this,[eat,subvalue,!0]))break;if(tokenizers.list.call(this,eat,subvalue,!0)&&(this.inList||commonmark||gfm&&!decimal(trim.left(subvalue).charAt(0))))break;if(position=index,-1!==(index=value.indexOf("\n",index+1))&&""===trim(value.slice(position,index))){index=position;break}}if(subvalue=value.slice(0,index),""===trim(subvalue))return eat(subvalue),null;if(silent)return!0;return now=eat.now(),subvalue=trimTrailingLines(subvalue),eat(subvalue)({type:"paragraph",children:this.tokenizeInline(subvalue,now)})}},1076:function(module,exports,__webpack_require__){"use strict";var locate=__webpack_require__(1077);function escape(eat,value,silent){var character,node;if("\\"===value.charAt(0)&&(character=value.charAt(1),-1!==this.escape.indexOf(character)))return!!silent||(node="\n"===character?{type:"break"}:{type:"text",value:character},eat("\\"+character)(node))}module.exports=escape,escape.locator=locate},1077:function(module,exports,__webpack_require__){"use strict";module.exports=function(value,fromIndex){return value.indexOf("\\",fromIndex)}},1078:function(module,exports,__webpack_require__){"use strict";var whitespace=__webpack_require__(177),decode=__webpack_require__(481),locate=__webpack_require__(703);module.exports=autoLink,autoLink.locator=locate,autoLink.notInLink=!0;var MAILTO_LENGTH="mailto:".length;function autoLink(eat,value,silent){var subvalue,length,index,queue,character,hasAtCharacter,link,now,content,tokenizers,exit;if("<"===value.charAt(0)){for(this,subvalue="",length=value.length,index=0,queue="",hasAtCharacter=!1,link="",index++,subvalue="<";index<length&&(character=value.charAt(index),!(whitespace(character)||">"===character||"@"===character||":"===character&&"/"===value.charAt(index+1)));)queue+=character,index++;if(queue){if(link+=queue,queue="",link+=character=value.charAt(index),index++,"@"===character)hasAtCharacter=!0;else{if(":"!==character||"/"!==value.charAt(index+1))return;link+="/",index++}for(;index<length&&(character=value.charAt(index),!whitespace(character)&&">"!==character);)queue+=character,index++;if(character=value.charAt(index),queue&&">"===character)return!!silent||(content=link+=queue,subvalue+=link+character,(now=eat.now()).column++,now.offset++,hasAtCharacter&&("mailto:"===link.slice(0,MAILTO_LENGTH).toLowerCase()?(content=content.substr(MAILTO_LENGTH),now.column+=MAILTO_LENGTH,now.offset+=MAILTO_LENGTH):link="mailto:"+link),tokenizers=this.inlineTokenizers,this.inlineTokenizers={text:tokenizers.text},exit=this.enterLink(),content=this.tokenizeInline(content,now),this.inlineTokenizers=tokenizers,exit(),eat(subvalue)({type:"link",title:null,url:decode(link,{nonTerminated:!1}),children:content}))}}}},1079:function(module,exports,__webpack_require__){"use strict";var decode=__webpack_require__(481),whitespace=__webpack_require__(177),locate=__webpack_require__(1080);module.exports=url,url.locator=locate,url.notInLink=!0;var PROTOCOLS=["http://","https://","mailto:"],PROTOCOLS_LENGTH=PROTOCOLS.length;function url(eat,value,silent){var subvalue,content,character,index,position,protocol,match,length,queue,parenCount,nextCharacter,exit;if(this.options.gfm){for(subvalue="",index=-1,length=PROTOCOLS_LENGTH;++index<length;)if(protocol=PROTOCOLS[index],(match=value.slice(0,protocol.length)).toLowerCase()===protocol){subvalue=match;break}if(subvalue){for(index=subvalue.length,length=value.length,queue="",parenCount=0;index<length&&(character=value.charAt(index),!whitespace(character)&&"<"!==character)&&("."!==character&&","!==character&&":"!==character&&";"!==character&&'"'!==character&&"'"!==character&&")"!==character&&"]"!==character||(nextCharacter=value.charAt(index+1))&&!whitespace(nextCharacter))&&("("!==character&&"["!==character||parenCount++,")"!==character&&"]"!==character||!(--parenCount<0));)queue+=character,index++;if(queue){if(content=subvalue+=queue,"mailto:"===protocol){if(-1===(position=queue.indexOf("@"))||position===length-1)return;content=content.substr("mailto:".length)}return!!silent||(exit=this.enterLink(),content=this.tokenizeInline(content,eat.now()),exit(),eat(subvalue)({type:"link",title:null,url:decode(subvalue,{nonTerminated:!1}),children:content}))}}}}},1080:function(module,exports,__webpack_require__){"use strict";module.exports=function(value,fromIndex){var position,length=PROTOCOLS.length,index=-1,min=-1;if(!this.options.gfm)return-1;for(;++index<length;)-1!==(position=value.indexOf(PROTOCOLS[index],fromIndex))&&(position<min||-1===min)&&(min=position);return min};var PROTOCOLS=["https://","http://","mailto:"]},1081:function(module,exports,__webpack_require__){"use strict";var alphabetical=__webpack_require__(699),locate=__webpack_require__(703),tag=__webpack_require__(702).tag;module.exports=inlineHTML,inlineHTML.locator=locate;var EXPRESSION_HTML_LINK_OPEN=/^<a /i,EXPRESSION_HTML_LINK_CLOSE=/^<\/a>/i;function inlineHTML(eat,value,silent){var character,subvalue,length=value.length;if(!("<"!==value.charAt(0)||length<3)&&(character=value.charAt(1),(alphabetical(character)||"?"===character||"!"===character||"/"===character)&&(subvalue=value.match(tag))))return!!silent||(subvalue=subvalue[0],!this.inLink&&EXPRESSION_HTML_LINK_OPEN.test(subvalue)?this.inLink=!0:this.inLink&&EXPRESSION_HTML_LINK_CLOSE.test(subvalue)&&(this.inLink=!1),eat(subvalue)({type:"html",value:subvalue}))}},1082:function(module,exports,__webpack_require__){"use strict";var whitespace=__webpack_require__(177),locate=__webpack_require__(704);module.exports=link,link.locator=locate;var own={}.hasOwnProperty,LINK_MARKERS={'"':'"',"'":"'"},COMMONMARK_LINK_MARKERS={};function link(eat,value,silent){var closed,count,opening,beforeURL,beforeTitle,subqueue,hasMarker,markers,isImage,content,marker,length,title,depth,queue,url,now,exit,node,subvalue="",index=0,character=value.charAt(0),pedantic=this.options.pedantic,commonmark=this.options.commonmark,gfm=this.options.gfm;if("!"===character&&(isImage=!0,subvalue=character,character=value.charAt(++index)),"["===character&&(isImage||!this.inLink)){for(subvalue+=character,queue="",index++,length=value.length,depth=0,(now=eat.now()).column+=index,now.offset+=index;index<length;){if(subqueue=character=value.charAt(index),"`"===character){for(count=1;"`"===value.charAt(index+1);)subqueue+=character,index++,count++;opening?count>=opening&&(opening=0):opening=count}else if("\\"===character)index++,subqueue+=value.charAt(index);else if(opening&&!gfm||"["!==character){if((!opening||gfm)&&"]"===character){if(!depth){if(!pedantic)for(;index<length&&(character=value.charAt(index+1),whitespace(character));)subqueue+=character,index++;if("("!==value.charAt(index+1))return;subqueue+="(",closed=!0,index++;break}depth--}}else depth++;queue+=subqueue,subqueue="",index++}if(closed){for(content=queue,subvalue+=queue+subqueue,index++;index<length&&(character=value.charAt(index),whitespace(character));)subvalue+=character,index++;if(character=value.charAt(index),markers=commonmark?COMMONMARK_LINK_MARKERS:LINK_MARKERS,queue="",beforeURL=subvalue,"<"===character){for(index++,beforeURL+="<";index<length&&">"!==(character=value.charAt(index));){if(commonmark&&"\n"===character)return;queue+=character,index++}if(">"!==value.charAt(index))return;subvalue+="<"+queue+">",url=queue,index++}else{for(character=null,subqueue="";index<length&&(character=value.charAt(index),!subqueue||!own.call(markers,character));){if(whitespace(character)){if(!pedantic)break;subqueue+=character}else{if("("===character)depth++;else if(")"===character){if(0===depth)break;depth--}queue+=subqueue,subqueue="","\\"===character&&(queue+="\\",character=value.charAt(++index)),queue+=character}index++}url=queue,index=(subvalue+=queue).length}for(queue="";index<length&&(character=value.charAt(index),whitespace(character));)queue+=character,index++;if(character=value.charAt(index),subvalue+=queue,queue&&own.call(markers,character))if(index++,subvalue+=character,queue="",marker=markers[character],beforeTitle=subvalue,commonmark){for(;index<length&&(character=value.charAt(index))!==marker;)"\\"===character&&(queue+="\\",character=value.charAt(++index)),index++,queue+=character;if((character=value.charAt(index))!==marker)return;for(title=queue,subvalue+=queue+character,index++;index<length&&(character=value.charAt(index),whitespace(character));)subvalue+=character,index++}else for(subqueue="";index<length;){if((character=value.charAt(index))===marker)hasMarker&&(queue+=marker+subqueue,subqueue=""),hasMarker=!0;else if(hasMarker){if(")"===character){subvalue+=queue+marker+subqueue,title=queue;break}whitespace(character)?subqueue+=character:(queue+=marker+subqueue+character,subqueue="",hasMarker=!1)}else queue+=character;index++}if(")"===value.charAt(index))return!!silent||(subvalue+=")",url=this.decode.raw(this.unescape(url),eat(beforeURL).test().end,{nonTerminated:!1}),title&&(beforeTitle=eat(beforeTitle).test().end,title=this.decode.raw(this.unescape(title),beforeTitle)),node={type:isImage?"image":"link",title:title||null,url:url},isImage?node.alt=this.decode.raw(this.unescape(content),now)||null:(exit=this.enterLink(),node.children=this.tokenizeInline(content,now),exit()),eat(subvalue)(node))}}}COMMONMARK_LINK_MARKERS['"']='"',COMMONMARK_LINK_MARKERS["'"]="'",COMMONMARK_LINK_MARKERS["("]=")"},1083:function(module,exports,__webpack_require__){"use strict";var whitespace=__webpack_require__(177),locate=__webpack_require__(704),normalize=__webpack_require__(485);module.exports=reference,reference.locator=locate;function reference(eat,value,silent){var content,identifier,now,node,exit,queue,bracketed,depth,character=value.charAt(0),index=0,length=value.length,subvalue="",intro="",type="link",referenceType="shortcut";if("!"===character&&(type="image",intro=character,character=value.charAt(++index)),"["===character){if(index++,intro+=character,queue="",this.options.footnotes&&"^"===value.charAt(index)){if("image"===type)return;intro+="^",index++,type="footnote"}for(depth=0;index<length;){if("["===(character=value.charAt(index)))bracketed=!0,depth++;else if("]"===character){if(!depth)break;depth--}"\\"===character&&(queue+="\\",character=value.charAt(++index)),queue+=character,index++}if(subvalue=queue,content=queue,"]"===(character=value.charAt(index))){for(index++,subvalue+=character,queue="";index<length&&(character=value.charAt(index),whitespace(character));)queue+=character,index++;if(character=value.charAt(index),"footnote"!==type&&"["===character){for(identifier="",queue+=character,index++;index<length&&"["!==(character=value.charAt(index))&&"]"!==character;)"\\"===character&&(identifier+="\\",character=value.charAt(++index)),identifier+=character,index++;"]"===(character=value.charAt(index))?(referenceType=identifier?"full":"collapsed",queue+=identifier+character,index++):identifier="",subvalue+=queue,queue=""}else{if(!content)return;identifier=content}if("full"===referenceType||!bracketed)return subvalue=intro+subvalue,"link"===type&&this.inLink?null:!!silent||("footnote"===type&&-1!==content.indexOf(" ")?eat(subvalue)({type:"footnote",children:this.tokenizeInline(content,eat.now())}):((now=eat.now()).column+=intro.length,now.offset+=intro.length,node={type:type+"Reference",identifier:normalize(identifier="full"===referenceType?identifier:content)},"link"!==type&&"image"!==type||(node.referenceType=referenceType),"link"===type?(exit=this.enterLink(),node.children=this.tokenizeInline(content,now),exit()):"image"===type&&(node.alt=this.decode.raw(this.unescape(content),now)||null),eat(subvalue)(node)))}}}},1084:function(module,exports,__webpack_require__){"use strict";var trim=__webpack_require__(282),whitespace=__webpack_require__(177),locate=__webpack_require__(1085);module.exports=strong,strong.locator=locate;function strong(eat,value,silent){var now,pedantic,marker,queue,subvalue,length,prev,index=0,character=value.charAt(index);if(!("*"!==character&&"_"!==character||value.charAt(++index)!==character||(pedantic=this.options.pedantic,subvalue=(marker=character)+marker,length=value.length,index++,queue="",character="",pedantic&&whitespace(value.charAt(index)))))for(;index<length;){if(prev=character,!((character=value.charAt(index))!==marker||value.charAt(index+1)!==marker||pedantic&&whitespace(prev))&&(character=value.charAt(index+2))!==marker){if(!trim(queue))return;return!!silent||((now=eat.now()).column+=2,now.offset+=2,eat(subvalue+queue+subvalue)({type:"strong",children:this.tokenizeInline(queue,now)}))}pedantic||"\\"!==character||(queue+=character,character=value.charAt(++index)),queue+=character,index++}}},1085:function(module,exports,__webpack_require__){"use strict";module.exports=function(value,fromIndex){var asterisk=value.indexOf("**",fromIndex),underscore=value.indexOf("__",fromIndex);if(-1===underscore)return asterisk;if(-1===asterisk)return underscore;return underscore<asterisk?underscore:asterisk}},1086:function(module,exports,__webpack_require__){"use strict";var trim=__webpack_require__(282),word=__webpack_require__(1087),whitespace=__webpack_require__(177),locate=__webpack_require__(1088);module.exports=emphasis,emphasis.locator=locate;function emphasis(eat,value,silent){var now,pedantic,marker,queue,subvalue,length,prev,index=0,character=value.charAt(index);if(!("*"!==character&&"_"!==character||(pedantic=this.options.pedantic,subvalue=character,marker=character,length=value.length,index++,queue="",character="",pedantic&&whitespace(value.charAt(index)))))for(;index<length;){if(prev=character,!((character=value.charAt(index))!==marker||pedantic&&whitespace(prev))){if((character=value.charAt(++index))!==marker){if(!trim(queue)||prev===marker)return;if(!pedantic&&"_"===marker&&word(character)){queue+=marker;continue}return!!silent||((now=eat.now()).column++,now.offset++,eat(subvalue+queue+marker)({type:"emphasis",children:this.tokenizeInline(queue,now)}))}queue+=marker}pedantic||"\\"!==character||(queue+=character,character=value.charAt(++index)),queue+=character,index++}}},1087:function(module,exports,__webpack_require__){"use strict";module.exports=function(character){return re.test("number"==typeof character?fromCode(character):character.charAt(0))};var fromCode=String.fromCharCode,re=/\w/},1088:function(module,exports,__webpack_require__){"use strict";module.exports=function(value,fromIndex){var asterisk=value.indexOf("*",fromIndex),underscore=value.indexOf("_",fromIndex);if(-1===underscore)return asterisk;if(-1===asterisk)return underscore;return underscore<asterisk?underscore:asterisk}},1089:function(module,exports,__webpack_require__){"use strict";var whitespace=__webpack_require__(177),locate=__webpack_require__(1090);module.exports=strikethrough,strikethrough.locator=locate;function strikethrough(eat,value,silent){var index,length,now,character="",previous="",preceding="",subvalue="";if(this.options.gfm&&"~"===value.charAt(0)&&"~"===value.charAt(1)&&!whitespace(value.charAt(2)))for(index=1,length=value.length,(now=eat.now()).column+=2,now.offset+=2;++index<length;){if(!("~"!==(character=value.charAt(index))||"~"!==previous||preceding&&whitespace(preceding)))return!!silent||eat("~~"+subvalue+"~~")({type:"delete",children:this.tokenizeInline(subvalue,now)});subvalue+=previous,preceding=previous,previous=character}}},1090:function(module,exports,__webpack_require__){"use strict";module.exports=function(value,fromIndex){return value.indexOf("~~",fromIndex)}},1091:function(module,exports,__webpack_require__){"use strict";var whitespace=__webpack_require__(177),locate=__webpack_require__(1092);module.exports=inlineCode,inlineCode.locator=locate;function inlineCode(eat,value,silent){for(var contentQueue,subqueue,count,openingCount,subvalue,character,found,next,length=value.length,index=0,queue="",tickQueue="";index<length&&"`"===value.charAt(index);)queue+="`",index++;if(queue){for(subvalue=queue,openingCount=index,queue="",next=value.charAt(index),count=0;index<length;){if(character=next,next=value.charAt(index+1),"`"===character?(count++,tickQueue+=character):(count=0,queue+=character),count&&"`"!==next){if(count===openingCount){subvalue+=queue+tickQueue,found=!0;break}queue+=tickQueue,tickQueue=""}index++}if(!found){if(openingCount%2!=0)return;queue=""}if(silent)return!0;for(contentQueue="",subqueue="",length=queue.length,index=-1;++index<length;)character=queue.charAt(index),whitespace(character)?subqueue+=character:(subqueue&&(contentQueue&&(contentQueue+=subqueue),subqueue=""),contentQueue+=character);return eat(subvalue)({type:"inlineCode",value:contentQueue})}}},1092:function(module,exports,__webpack_require__){"use strict";module.exports=function(value,fromIndex){return value.indexOf("`",fromIndex)}},1093:function(module,exports,__webpack_require__){"use strict";var locate=__webpack_require__(1094);module.exports=hardBreak,hardBreak.locator=locate;function hardBreak(eat,value,silent){for(var character,length=value.length,index=-1,queue="";++index<length;){if("\n"===(character=value.charAt(index))){if(index<2)return;return!!silent||eat(queue+=character)({type:"break"})}if(" "!==character)return;queue+=character}}},1094:function(module,exports,__webpack_require__){"use strict";module.exports=function(value,fromIndex){var index=value.indexOf("\n",fromIndex);for(;index>fromIndex&&" "===value.charAt(index-1);)index--;return index}},1095:function(module,exports,__webpack_require__){"use strict";module.exports=function(eat,value,silent){var methods,tokenizers,index,length,subvalue,position,tokenizer,name,min,now;if(silent)return!0;methods=this.inlineMethods,length=methods.length,tokenizers=this.inlineTokenizers,index=-1,min=value.length;for(;++index<length;)"text"!==(name=methods[index])&&tokenizers[name]&&((tokenizer=tokenizers[name].locator)||eat.file.fail("Missing locator: `"+name+"`"),-1!==(position=tokenizer.call(this,value,1))&&position<min&&(min=position));subvalue=value.slice(0,min),now=eat.now(),this.decode(subvalue,now,(function(content,position,source){eat(source||content)({type:"text",value:content})}))}},1096:function(module,exports,__webpack_require__){var visitWithParents=__webpack_require__(1097);module.exports=function(){return function(ast){return visitWithParents(ast,"list",(function(listNode,parents){var i,n,depth=0;for(i=0,n=parents.length;i<n;i++)"list"===parents[i].type&&(depth+=1);for(i=0,n=listNode.children.length;i<n;i++){var child=listNode.children[i];child.index=i,child.ordered=listNode.ordered}listNode.depth=depth})),ast}}},1097:function(module,exports,__webpack_require__){"use strict";module.exports=function(tree,type,visitor){var stack=[];"function"==typeof type&&(visitor=type,type=null);function one(node){var result;return type&&node.type!==type||(result=visitor(node,stack.concat())),node.children&&!1!==result?function(children,parent){var child,length=children.length,index=-1;stack.push(parent);for(;++index<length;)if((child=children[index])&&!1===one(child))return!1;return stack.pop(),!0}(node.children,node):result}one(tree)}},1098:function(module,exports,__webpack_require__){"use strict";var visit=__webpack_require__(386),selfClosingRe=/^<(area|base|br|col|embed|hr|img|input|keygen|link|meta|param|source|track|wbr)\s*\/?>$/i,simpleTagRe=/^<(\/?)([a-z]+)\s*>$/;module.exports=function(tree){var open,currentParent;return visit(tree,"html",(function(node,index,parent){currentParent!==parent&&(open=[],currentParent=parent);var selfClosing=function(node){var match=node.value.match(selfClosingRe);return!!match&&match[1]}(node);if(selfClosing)return parent.children.splice(index,1,{type:"virtualHtml",tag:selfClosing,position:node.position}),!0;var current=function(node,parent){var match=node.value.match(simpleTagRe);return!!match&&{tag:match[2],opening:!match[1],node:node}}(node);if(!current)return!0;var matching=function(open,matchingTag){var i=open.length;for(;i--;)if(open[i].tag===matchingTag)return open.splice(i,1)[0];return!1}(open,current.tag);return matching?parent.children.splice(index,0,function(fromNode,toNode,parent){var fromIndex=parent.children.indexOf(fromNode.node),toIndex=parent.children.indexOf(toNode.node),children=parent.children.splice(fromIndex,toIndex-fromIndex+1).slice(1,-1);return{type:"virtualHtml",children:children,tag:fromNode.tag,position:{start:fromNode.node.position.start,end:toNode.node.position.end,indent:[]}}}(current,matching,parent)):current.opening||open.push(current),!0}),!0),tree}},1099:function(module,exports,__webpack_require__){"use strict";var visit=__webpack_require__(386);function untangle(node,index,parent,mode){if("remove"===mode)parent.children.splice(index,1);else if("unwrap"===mode){var args=[index,1];node.children&&(args=args.concat(node.children)),Array.prototype.splice.apply(parent.children,args)}}exports.ofType=function(types,mode){return function(node){return types.forEach((function(type){return visit(node,type,disallow,!0)})),node};function disallow(node,index,parent){parent&&untangle(node,index,parent,mode)}},exports.ifNotMatch=function(allowNode,mode){return function(node){return visit(node,disallow,!0),node};function disallow(node,index,parent){parent&&!allowNode(node,index,parent)&&untangle(node,index,parent,mode)}}},1100:function(module,exports,__webpack_require__){"use strict";var React=__webpack_require__(6),xtend=__webpack_require__(217),ReactIs=__webpack_require__(403),defaultNodePosition={start:{line:1,column:1,offset:0},end:{line:1,column:1,offset:0}};function astToReact(node,options){var parent=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},index=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,renderer=options.renderers[node.type];void 0===node.position&&(node.position=parent.node&&parent.node.position||defaultNodePosition);var pos=node.position.start,key=[node.type,pos.line,pos.column,index].join("-");if(!ReactIs.isValidElementType(renderer))throw new Error("Renderer for type `".concat(node.type,"` not defined or is not renderable"));var nodeProps=getNodeProps(node,key,options,renderer,parent,index);return React.createElement(renderer,nodeProps,nodeProps.children||resolveChildren()||void 0);function resolveChildren(){return node.children&&node.children.map((function(childNode,i){return astToReact(childNode,options,{node:node,props:nodeProps},i)}))}}function getNodeProps(node,key,opts,renderer,parent,index){var pos,props={key:key},isTagRenderer="string"==typeof renderer;opts.sourcePos&&node.position&&(props["data-sourcepos"]=[(pos=node.position).start.line,":",pos.start.column,"-",pos.end.line,":",pos.end.column].map(String).join("")),opts.rawSourcePos&&!isTagRenderer&&(props.sourcePosition=node.position),opts.includeNodeIndex&&parent.node&&parent.node.children&&!isTagRenderer&&(props.index=parent.node.children.indexOf(node),props.parentChildCount=parent.node.children.length);var ref=null!==node.identifier&&void 0!==node.identifier?opts.definitions[node.identifier]||{}:null;switch(node.type){case"root":assignDefined(props,{className:opts.className});break;case"text":props.nodeKey=key,props.children=node.value;break;case"heading":props.level=node.depth;break;case"list":props.start=node.start,props.ordered=node.ordered,props.tight=!node.loose,props.depth=node.depth;break;case"listItem":props.checked=node.checked,props.tight=!node.loose,props.ordered=node.ordered,props.index=node.index,props.children=function(node,parent){if(node.loose)return node.children;if(parent.node&&node.index>0&&parent.node.children[node.index-1].loose)return node.children;return function(node){return node.children.reduce((function(array,child){return array.concat("paragraph"===child.type?child.children||[]:[child])}),[])}(node)}(node,parent).map((function(childNode,i){return astToReact(childNode,opts,{node:node,props:props},i)}));break;case"definition":assignDefined(props,{identifier:node.identifier,title:node.title,url:node.url});break;case"code":assignDefined(props,{language:node.lang&&node.lang.split(/\s/,1)[0]});break;case"inlineCode":props.children=node.value,props.inline=!0;break;case"link":assignDefined(props,{title:node.title||void 0,target:"function"==typeof opts.linkTarget?opts.linkTarget(node.url,node.children,node.title):opts.linkTarget,href:opts.transformLinkUri?opts.transformLinkUri(node.url,node.children,node.title):node.url});break;case"image":assignDefined(props,{alt:node.alt||void 0,title:node.title||void 0,src:opts.transformImageUri?opts.transformImageUri(node.url,node.children,node.title,node.alt):node.url});break;case"linkReference":assignDefined(props,xtend(ref,{href:opts.transformLinkUri?opts.transformLinkUri(ref.href):ref.href}));break;case"imageReference":assignDefined(props,{src:opts.transformImageUri&&ref.href?opts.transformImageUri(ref.href,node.children,ref.title,node.alt):ref.href,title:ref.title||void 0,alt:node.alt||void 0});break;case"table":case"tableHead":case"tableBody":props.columnAlignment=node.align;break;case"tableRow":props.isHeader="tableHead"===parent.node.type,props.columnAlignment=parent.props.columnAlignment;break;case"tableCell":assignDefined(props,{isHeader:parent.props.isHeader,align:parent.props.columnAlignment[index]});break;case"virtualHtml":props.tag=node.tag;break;case"html":props.isBlock=node.position.start.line!==node.position.end.line,props.escapeHtml=opts.escapeHtml,props.skipHtml=opts.skipHtml;break;case"parsedHtml":var parsedChildren;node.children&&(parsedChildren=node.children.map((function(child,i){return astToReact(child,opts,{node:node,props:props},i)}))),props.escapeHtml=opts.escapeHtml,props.skipHtml=opts.skipHtml,props.element=function(node,parsedChildren){var el=node.element;if(Array.isArray(el)){var Fragment=React.Fragment||"div";return React.createElement(Fragment,null,el)}if(el.props.children||parsedChildren){var children=React.Children.toArray(el.props.children).concat(parsedChildren);return React.cloneElement(el,null,children)}return React.cloneElement(el,null)}(node,parsedChildren);break;default:assignDefined(props,xtend(node,{type:void 0,position:void 0,children:void 0}))}return!isTagRenderer&&node.value&&(props.value=node.value),props}function assignDefined(target,attrs){for(var key in attrs)void 0!==attrs[key]&&(target[key]=attrs[key])}module.exports=astToReact},1101:function(module,exports,__webpack_require__){"use strict";var visit=__webpack_require__(386);function wrap(table){var children=table.children;table.children=[{type:"tableHead",align:table.align,children:[children[0]],position:children[0].position}],children.length>1&&table.children.push({type:"tableBody",align:table.align,children:children.slice(1),position:{start:children[1].position.start,end:children[children.length-1].position.end}})}module.exports=function(node){return visit(node,"table",wrap),node}},1102:function(module,exports,__webpack_require__){"use strict";module.exports=function getDefinitions(node){var defs=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(node.children||[]).reduce((function(definitions,child){return"definition"===child.type&&(definitions[child.identifier]={href:child.url,title:child.title}),getDefinitions(child,definitions)}),defs)}},1103:function(module,exports,__webpack_require__){"use strict";var protocols=["http","https","mailto","tel"];module.exports=function(uri){var url=(uri||"").trim(),first=url.charAt(0);if("#"===first||"/"===first)return url;var colon=url.indexOf(":");if(-1===colon)return url;for(var length=protocols.length,index=-1;++index<length;){var protocol=protocols[index];if(colon===protocol.length&&url.slice(0,protocol.length).toLowerCase()===protocol)return url}return-1!==(index=url.indexOf("?"))&&colon>index||-1!==(index=url.indexOf("#"))&&colon>index?url:"javascript:void(0)"}},1104:function(module,exports,__webpack_require__){"use strict";var xtend=__webpack_require__(217),React=__webpack_require__(6),supportsStringRender=parseInt((React.version||"16").slice(0,2),10)>=16,createElement=React.createElement;function SimpleRenderer(tag,props){return createElement(tag,getCoreProps(props),props.children)}function getCoreProps(props){return props["data-sourcepos"]?{"data-sourcepos":props["data-sourcepos"]}:{}}module.exports={break:"br",paragraph:"p",emphasis:"em",strong:"strong",thematicBreak:"hr",blockquote:"blockquote",delete:"del",link:"a",image:"img",linkReference:"a",imageReference:"img",table:SimpleRenderer.bind(null,"table"),tableHead:SimpleRenderer.bind(null,"thead"),tableBody:SimpleRenderer.bind(null,"tbody"),tableRow:SimpleRenderer.bind(null,"tr"),tableCell:function(props){var style=props.align?{textAlign:props.align}:void 0,coreProps=getCoreProps(props);return createElement(props.isHeader?"th":"td",style?xtend({style:style},coreProps):coreProps,props.children)},root:function(props){var useFragment=!props.className,root=useFragment&&React.Fragment||"div";return createElement(root,useFragment?null:props,props.children)},text:function(props){return supportsStringRender?props.children:createElement("span",null,props.children)},list:function(props){var attrs=getCoreProps(props);null!==props.start&&1!==props.start&&void 0!==props.start&&(attrs.start=props.start.toString());return createElement(props.ordered?"ol":"ul",attrs,props.children)},listItem:function(props){var checkbox=null;if(null!==props.checked&&void 0!==props.checked){var checked=props.checked;checkbox=createElement("input",{type:"checkbox",checked:checked,readOnly:!0})}return createElement("li",getCoreProps(props),checkbox,props.children)},definition:function(){return null},heading:function(props){return createElement("h".concat(props.level),getCoreProps(props),props.children)},inlineCode:function(props){return createElement("code",getCoreProps(props),props.children)},code:function(props){var className=props.language&&"language-".concat(props.language),code=createElement("code",className?{className:className}:null,props.value);return createElement("pre",getCoreProps(props),code)},html:function(props){if(props.skipHtml)return null;var tag=props.isBlock?"div":"span";if(props.escapeHtml){var comp=React.Fragment||tag;return createElement(comp,null,props.value)}var nodeProps={dangerouslySetInnerHTML:{__html:props.value}};return createElement(tag,nodeProps)},virtualHtml:function(props){return createElement(props.tag,getCoreProps(props),props.children)},parsedHtml:function(props){return props["data-sourcepos"]?React.cloneElement(props.element,{"data-sourcepos":props["data-sourcepos"]}):props.element}}},1105:function(module,exports,__webpack_require__){"use strict";exports.HtmlParser="undefined"==typeof Symbol?"__RMD_HTML_PARSER__":Symbol("__RMD_HTML_PARSER__")},1106:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__,factory;
/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */factory=function(mustache){var objectToString=Object.prototype.toString,isArray=Array.isArray||function(object){return"[object Array]"===objectToString.call(object)};function isFunction(object){return"function"==typeof object}function escapeRegExp(string){return string.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function hasProperty(obj,propName){return null!=obj&&"object"==typeof obj&&propName in obj}var regExpTest=RegExp.prototype.test,nonSpaceRe=/\S/;function isWhitespace(string){return!function(re,string){return regExpTest.call(re,string)}(nonSpaceRe,string)}var entityMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},whiteRe=/\s*/,spaceRe=/\s+/,equalsRe=/\s*=/,curlyRe=/\s*\}/,tagRe=/#|\^|\/|>|\{|&|=|!/;function Scanner(string){this.string=string,this.tail=string,this.pos=0}function Context(view,parentContext){this.view=view,this.cache={".":this.view},this.parent=parentContext}function Writer(){this.cache={}}Scanner.prototype.eos=function(){return""===this.tail},Scanner.prototype.scan=function(re){var match=this.tail.match(re);if(!match||0!==match.index)return"";var string=match[0];return this.tail=this.tail.substring(string.length),this.pos+=string.length,string},Scanner.prototype.scanUntil=function(re){var match,index=this.tail.search(re);switch(index){case-1:match=this.tail,this.tail="";break;case 0:match="";break;default:match=this.tail.substring(0,index),this.tail=this.tail.substring(index)}return this.pos+=match.length,match},Context.prototype.push=function(view){return new Context(view,this)},Context.prototype.lookup=function(name){var value,cache=this.cache;if(cache.hasOwnProperty(name))value=cache[name];else{for(var names,index,context=this,lookupHit=!1;context;){if(name.indexOf(".")>0)for(value=context.view,names=name.split("."),index=0;null!=value&&index<names.length;)index===names.length-1&&(lookupHit=hasProperty(value,names[index])),value=value[names[index++]];else value=context.view[name],lookupHit=hasProperty(context.view,name);if(lookupHit)break;context=context.parent}cache[name]=value}return isFunction(value)&&(value=value.call(this.view)),value},Writer.prototype.clearCache=function(){this.cache={}},Writer.prototype.parse=function(template,tags){var cache=this.cache,tokens=cache[template];return null==tokens&&(tokens=cache[template]=function(template,tags){if(!template)return[];var openingTagRe,closingTagRe,closingCurlyRe,sections=[],tokens=[],spaces=[],hasTag=!1,nonSpace=!1;function stripSpace(){if(hasTag&&!nonSpace)for(;spaces.length;)delete tokens[spaces.pop()];else spaces=[];hasTag=!1,nonSpace=!1}function compileTags(tagsToCompile){if("string"==typeof tagsToCompile&&(tagsToCompile=tagsToCompile.split(spaceRe,2)),!isArray(tagsToCompile)||2!==tagsToCompile.length)throw new Error("Invalid tags: "+tagsToCompile);openingTagRe=new RegExp(escapeRegExp(tagsToCompile[0])+"\\s*"),closingTagRe=new RegExp("\\s*"+escapeRegExp(tagsToCompile[1])),closingCurlyRe=new RegExp("\\s*"+escapeRegExp("}"+tagsToCompile[1]))}compileTags(tags||mustache.tags);for(var start,type,value,chr,token,openSection,scanner=new Scanner(template);!scanner.eos();){if(start=scanner.pos,value=scanner.scanUntil(openingTagRe))for(var i=0,valueLength=value.length;i<valueLength;++i)isWhitespace(chr=value.charAt(i))?spaces.push(tokens.length):nonSpace=!0,tokens.push(["text",chr,start,start+1]),start+=1,"\n"===chr&&stripSpace();if(!scanner.scan(openingTagRe))break;if(hasTag=!0,type=scanner.scan(tagRe)||"name",scanner.scan(whiteRe),"="===type?(value=scanner.scanUntil(equalsRe),scanner.scan(equalsRe),scanner.scanUntil(closingTagRe)):"{"===type?(value=scanner.scanUntil(closingCurlyRe),scanner.scan(curlyRe),scanner.scanUntil(closingTagRe),type="&"):value=scanner.scanUntil(closingTagRe),!scanner.scan(closingTagRe))throw new Error("Unclosed tag at "+scanner.pos);if(token=[type,value,start,scanner.pos],tokens.push(token),"#"===type||"^"===type)sections.push(token);else if("/"===type){if(!(openSection=sections.pop()))throw new Error('Unopened section "'+value+'" at '+start);if(openSection[1]!==value)throw new Error('Unclosed section "'+openSection[1]+'" at '+start)}else"name"===type||"{"===type||"&"===type?nonSpace=!0:"="===type&&compileTags(value)}if(openSection=sections.pop())throw new Error('Unclosed section "'+openSection[1]+'" at '+scanner.pos);return function(tokens){for(var token,nestedTokens=[],collector=nestedTokens,sections=[],i=0,numTokens=tokens.length;i<numTokens;++i)switch((token=tokens[i])[0]){case"#":case"^":collector.push(token),sections.push(token),collector=token[4]=[];break;case"/":sections.pop()[5]=token[2],collector=sections.length>0?sections[sections.length-1][4]:nestedTokens;break;default:collector.push(token)}return nestedTokens}(function(tokens){for(var token,lastToken,squashedTokens=[],i=0,numTokens=tokens.length;i<numTokens;++i)(token=tokens[i])&&("text"===token[0]&&lastToken&&"text"===lastToken[0]?(lastToken[1]+=token[1],lastToken[3]=token[3]):(squashedTokens.push(token),lastToken=token));return squashedTokens}(tokens))}(template,tags)),tokens},Writer.prototype.render=function(template,view,partials){var tokens=this.parse(template),context=view instanceof Context?view:new Context(view);return this.renderTokens(tokens,context,partials,template)},Writer.prototype.renderTokens=function(tokens,context,partials,originalTemplate){for(var token,symbol,value,buffer="",i=0,numTokens=tokens.length;i<numTokens;++i)value=void 0,"#"===(symbol=(token=tokens[i])[0])?value=this.renderSection(token,context,partials,originalTemplate):"^"===symbol?value=this.renderInverted(token,context,partials,originalTemplate):">"===symbol?value=this.renderPartial(token,context,partials,originalTemplate):"&"===symbol?value=this.unescapedValue(token,context):"name"===symbol?value=this.escapedValue(token,context):"text"===symbol&&(value=this.rawValue(token)),void 0!==value&&(buffer+=value);return buffer},Writer.prototype.renderSection=function(token,context,partials,originalTemplate){var self=this,buffer="",value=context.lookup(token[1]);if(value){if(isArray(value))for(var j=0,valueLength=value.length;j<valueLength;++j)buffer+=this.renderTokens(token[4],context.push(value[j]),partials,originalTemplate);else if("object"==typeof value||"string"==typeof value||"number"==typeof value)buffer+=this.renderTokens(token[4],context.push(value),partials,originalTemplate);else if(isFunction(value)){if("string"!=typeof originalTemplate)throw new Error("Cannot use higher-order sections without the original template");null!=(value=value.call(context.view,originalTemplate.slice(token[3],token[5]),(function(template){return self.render(template,context,partials)})))&&(buffer+=value)}else buffer+=this.renderTokens(token[4],context,partials,originalTemplate);return buffer}},Writer.prototype.renderInverted=function(token,context,partials,originalTemplate){var value=context.lookup(token[1]);if(!value||isArray(value)&&0===value.length)return this.renderTokens(token[4],context,partials,originalTemplate)},Writer.prototype.renderPartial=function(token,context,partials){if(partials){var value=isFunction(partials)?partials(token[1]):partials[token[1]];return null!=value?this.renderTokens(this.parse(value),context,partials,value):void 0}},Writer.prototype.unescapedValue=function(token,context){var value=context.lookup(token[1]);if(null!=value)return value},Writer.prototype.escapedValue=function(token,context){var value=context.lookup(token[1]);if(null!=value)return mustache.escape(value)},Writer.prototype.rawValue=function(token){return token[1]},mustache.name="mustache.js",mustache.version="2.3.2",mustache.tags=["{{","}}"];var defaultWriter=new Writer;return mustache.clearCache=function(){return defaultWriter.clearCache()},mustache.parse=function(template,tags){return defaultWriter.parse(template,tags)},mustache.render=function(template,view,partials){if("string"!=typeof template)throw new TypeError('Invalid template! Template should be a "string" but "'+(isArray(obj=template)?"array":typeof obj)+'" was given as the first argument for mustache#render(template, view, partials)');var obj;return defaultWriter.render(template,view,partials)},mustache.to_html=function(template,view,partials,send){var result=mustache.render(template,view,partials);if(!isFunction(send))return result;send(result)},mustache.escape=function(string){return String(string).replace(/[&<>"'`=\/]/g,(function(s){return entityMap[s]}))},mustache.Scanner=Scanner,mustache.Context=Context,mustache.Writer=Writer,mustache},exports&&"string"!=typeof exports.nodeName?factory(exports):(__WEBPACK_AMD_DEFINE_ARRAY__=[exports],void 0===(__WEBPACK_AMD_DEFINE_RESULT__="function"==typeof(__WEBPACK_AMD_DEFINE_FACTORY__=factory)?__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__):__WEBPACK_AMD_DEFINE_FACTORY__)||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))},1107:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var tslib_1=__webpack_require__(62),react_1=__webpack_require__(6);exports.default=function(initialMap){void 0===initialMap&&(initialMap={});var _a=react_1.useState(initialMap),map=_a[0],set=_a[1],stableActions=react_1.useMemo((function(){return{set:function(key,entry){set((function(prevMap){var _a;return tslib_1.__assign(tslib_1.__assign({},prevMap),((_a={})[key]=entry,_a))}))},setAll:function(newMap){set(newMap)},remove:function(key){set((function(prevMap){var _a=prevMap,_b=key;_a[_b];return tslib_1.__rest(_a,["symbol"==typeof _b?_b:_b+""])}))},reset:function(){return set(initialMap)}}}),[set]),utils=tslib_1.__assign({get:react_1.useCallback((function(key){return map[key]}),[map])},stableActions);return[map,utils]}},1108:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var react_1=__webpack_require__(6);exports.default=function(effect){react_1.useEffect(effect,[])}},1109:function(module,exports,__webpack_require__){module.exports=minimatch,minimatch.Minimatch=Minimatch;var path={sep:"/"};try{path=__webpack_require__(480)}catch(er){}var GLOBSTAR=minimatch.GLOBSTAR=Minimatch.GLOBSTAR={},expand=__webpack_require__(1110),plTypes={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},reSpecials="().*{}+?[]^$\\!".split("").reduce((function(set,c){return set[c]=!0,set}),{});var slashSplit=/\/+/;function ext(a,b){a=a||{},b=b||{};var t={};return Object.keys(b).forEach((function(k){t[k]=b[k]})),Object.keys(a).forEach((function(k){t[k]=a[k]})),t}function minimatch(p,pattern,options){if("string"!=typeof pattern)throw new TypeError("glob pattern string required");return options||(options={}),!(!options.nocomment&&"#"===pattern.charAt(0))&&(""===pattern.trim()?""===p:new Minimatch(pattern,options).match(p))}function Minimatch(pattern,options){if(!(this instanceof Minimatch))return new Minimatch(pattern,options);if("string"!=typeof pattern)throw new TypeError("glob pattern string required");options||(options={}),pattern=pattern.trim(),"/"!==path.sep&&(pattern=pattern.split(path.sep).join("/")),this.options=options,this.set=[],this.pattern=pattern,this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.make()}function braceExpand(pattern,options){if(options||(options=this instanceof Minimatch?this.options:{}),void 0===(pattern=void 0===pattern?this.pattern:pattern))throw new TypeError("undefined pattern");return options.nobrace||!pattern.match(/\{.*\}/)?[pattern]:expand(pattern)}minimatch.filter=function(pattern,options){return options=options||{},function(p,i,list){return minimatch(p,pattern,options)}},minimatch.defaults=function(def){if(!def||!Object.keys(def).length)return minimatch;var orig=minimatch,m=function(p,pattern,options){return orig.minimatch(p,pattern,ext(def,options))};return m.Minimatch=function(pattern,options){return new orig.Minimatch(pattern,ext(def,options))},m},Minimatch.defaults=function(def){return def&&Object.keys(def).length?minimatch.defaults(def).Minimatch:Minimatch},Minimatch.prototype.debug=function(){},Minimatch.prototype.make=function(){if(this._made)return;var pattern=this.pattern,options=this.options;if(!options.nocomment&&"#"===pattern.charAt(0))return void(this.comment=!0);if(!pattern)return void(this.empty=!0);this.parseNegate();var set=this.globSet=this.braceExpand();options.debug&&(this.debug=console.error);this.debug(this.pattern,set),set=this.globParts=set.map((function(s){return s.split(slashSplit)})),this.debug(this.pattern,set),set=set.map((function(s,si,set){return s.map(this.parse,this)}),this),this.debug(this.pattern,set),set=set.filter((function(s){return-1===s.indexOf(!1)})),this.debug(this.pattern,set),this.set=set},Minimatch.prototype.parseNegate=function(){var pattern=this.pattern,negate=!1,options=this.options,negateOffset=0;if(options.nonegate)return;for(var i=0,l=pattern.length;i<l&&"!"===pattern.charAt(i);i++)negate=!negate,negateOffset++;negateOffset&&(this.pattern=pattern.substr(negateOffset));this.negate=negate},minimatch.braceExpand=function(pattern,options){return braceExpand(pattern,options)},Minimatch.prototype.braceExpand=braceExpand,Minimatch.prototype.parse=function(pattern,isSub){if(pattern.length>65536)throw new TypeError("pattern is too long");var options=this.options;if(!options.noglobstar&&"**"===pattern)return GLOBSTAR;if(""===pattern)return"";var stateChar,re="",hasMagic=!!options.nocase,escaping=!1,patternListStack=[],negativeLists=[],inClass=!1,reClassStart=-1,classStart=-1,patternStart="."===pattern.charAt(0)?"":options.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",self=this;function clearStateChar(){if(stateChar){switch(stateChar){case"*":re+="[^/]*?",hasMagic=!0;break;case"?":re+="[^/]",hasMagic=!0;break;default:re+="\\"+stateChar}self.debug("clearStateChar %j %j",stateChar,re),stateChar=!1}}for(var c,i=0,len=pattern.length;i<len&&(c=pattern.charAt(i));i++)if(this.debug("%s\t%s %s %j",pattern,i,re,c),escaping&&reSpecials[c])re+="\\"+c,escaping=!1;else switch(c){case"/":return!1;case"\\":clearStateChar(),escaping=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s\t%s %s %j <-- stateChar",pattern,i,re,c),inClass){this.debug("  in class"),"!"===c&&i===classStart+1&&(c="^"),re+=c;continue}self.debug("call clearStateChar %j",stateChar),clearStateChar(),stateChar=c,options.noext&&clearStateChar();continue;case"(":if(inClass){re+="(";continue}if(!stateChar){re+="\\(";continue}patternListStack.push({type:stateChar,start:i-1,reStart:re.length,open:plTypes[stateChar].open,close:plTypes[stateChar].close}),re+="!"===stateChar?"(?:(?!(?:":"(?:",this.debug("plType %j %j",stateChar,re),stateChar=!1;continue;case")":if(inClass||!patternListStack.length){re+="\\)";continue}clearStateChar(),hasMagic=!0;var pl=patternListStack.pop();re+=pl.close,"!"===pl.type&&negativeLists.push(pl),pl.reEnd=re.length;continue;case"|":if(inClass||!patternListStack.length||escaping){re+="\\|",escaping=!1;continue}clearStateChar(),re+="|";continue;case"[":if(clearStateChar(),inClass){re+="\\"+c;continue}inClass=!0,classStart=i,reClassStart=re.length,re+=c;continue;case"]":if(i===classStart+1||!inClass){re+="\\"+c,escaping=!1;continue}if(inClass){var cs=pattern.substring(classStart+1,i);try{RegExp("["+cs+"]")}catch(er){var sp=this.parse(cs,SUBPARSE);re=re.substr(0,reClassStart)+"\\["+sp[0]+"\\]",hasMagic=hasMagic||sp[1],inClass=!1;continue}}hasMagic=!0,inClass=!1,re+=c;continue;default:clearStateChar(),escaping?escaping=!1:!reSpecials[c]||"^"===c&&inClass||(re+="\\"),re+=c}inClass&&(cs=pattern.substr(classStart+1),sp=this.parse(cs,SUBPARSE),re=re.substr(0,reClassStart)+"\\["+sp[0],hasMagic=hasMagic||sp[1]);for(pl=patternListStack.pop();pl;pl=patternListStack.pop()){var tail=re.slice(pl.reStart+pl.open.length);this.debug("setting tail",re,pl),tail=tail.replace(/((?:\\{2}){0,64})(\\?)\|/g,(function(_,$1,$2){return $2||($2="\\"),$1+$1+$2+"|"})),this.debug("tail=%j\n   %s",tail,tail,pl,re);var t="*"===pl.type?"[^/]*?":"?"===pl.type?"[^/]":"\\"+pl.type;hasMagic=!0,re=re.slice(0,pl.reStart)+t+"\\("+tail}clearStateChar(),escaping&&(re+="\\\\");var addPatternStart=!1;switch(re.charAt(0)){case".":case"[":case"(":addPatternStart=!0}for(var n=negativeLists.length-1;n>-1;n--){var nl=negativeLists[n],nlBefore=re.slice(0,nl.reStart),nlFirst=re.slice(nl.reStart,nl.reEnd-8),nlLast=re.slice(nl.reEnd-8,nl.reEnd),nlAfter=re.slice(nl.reEnd);nlLast+=nlAfter;var openParensBefore=nlBefore.split("(").length-1,cleanAfter=nlAfter;for(i=0;i<openParensBefore;i++)cleanAfter=cleanAfter.replace(/\)[+*?]?/,"");var dollar="";""===(nlAfter=cleanAfter)&&isSub!==SUBPARSE&&(dollar="$"),re=nlBefore+nlFirst+nlAfter+dollar+nlLast}""!==re&&hasMagic&&(re="(?=.)"+re);addPatternStart&&(re=patternStart+re);if(isSub===SUBPARSE)return[re,hasMagic];if(!hasMagic)return function(s){return s.replace(/\\(.)/g,"$1")}(pattern);var flags=options.nocase?"i":"";try{var regExp=new RegExp("^"+re+"$",flags)}catch(er){return new RegExp("$.")}return regExp._glob=pattern,regExp._src=re,regExp};var SUBPARSE={};minimatch.makeRe=function(pattern,options){return new Minimatch(pattern,options||{}).makeRe()},Minimatch.prototype.makeRe=function(){if(this.regexp||!1===this.regexp)return this.regexp;var set=this.set;if(!set.length)return this.regexp=!1,this.regexp;var options=this.options,twoStar=options.noglobstar?"[^/]*?":options.dot?"(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?":"(?:(?!(?:\\/|^)\\.).)*?",flags=options.nocase?"i":"",re=set.map((function(pattern){return pattern.map((function(p){return p===GLOBSTAR?twoStar:"string"==typeof p?function(s){return s.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}(p):p._src})).join("\\/")})).join("|");re="^(?:"+re+")$",this.negate&&(re="^(?!"+re+").*$");try{this.regexp=new RegExp(re,flags)}catch(ex){this.regexp=!1}return this.regexp},minimatch.match=function(list,pattern,options){var mm=new Minimatch(pattern,options=options||{});return list=list.filter((function(f){return mm.match(f)})),mm.options.nonull&&!list.length&&list.push(pattern),list},Minimatch.prototype.match=function(f,partial){if(this.debug("match",f,this.pattern),this.comment)return!1;if(this.empty)return""===f;if("/"===f&&partial)return!0;var options=this.options;"/"!==path.sep&&(f=f.split(path.sep).join("/"));f=f.split(slashSplit),this.debug(this.pattern,"split",f);var filename,i,set=this.set;for(this.debug(this.pattern,"set",set),i=f.length-1;i>=0&&!(filename=f[i]);i--);for(i=0;i<set.length;i++){var pattern=set[i],file=f;if(options.matchBase&&1===pattern.length&&(file=[filename]),this.matchOne(file,pattern,partial))return!!options.flipNegate||!this.negate}return!options.flipNegate&&this.negate},Minimatch.prototype.matchOne=function(file,pattern,partial){var options=this.options;this.debug("matchOne",{this:this,file:file,pattern:pattern}),this.debug("matchOne",file.length,pattern.length);for(var fi=0,pi=0,fl=file.length,pl=pattern.length;fi<fl&&pi<pl;fi++,pi++){this.debug("matchOne loop");var hit,p=pattern[pi],f=file[fi];if(this.debug(pattern,p,f),!1===p)return!1;if(p===GLOBSTAR){this.debug("GLOBSTAR",[pattern,p,f]);var fr=fi,pr=pi+1;if(pr===pl){for(this.debug("** at the end");fi<fl;fi++)if("."===file[fi]||".."===file[fi]||!options.dot&&"."===file[fi].charAt(0))return!1;return!0}for(;fr<fl;){var swallowee=file[fr];if(this.debug("\nglobstar while",file,fr,pattern,pr,swallowee),this.matchOne(file.slice(fr),pattern.slice(pr),partial))return this.debug("globstar found match!",fr,fl,swallowee),!0;if("."===swallowee||".."===swallowee||!options.dot&&"."===swallowee.charAt(0)){this.debug("dot detected!",file,fr,pattern,pr);break}this.debug("globstar swallow a segment, and continue"),fr++}return!(!partial||(this.debug("\n>>> no match, partial?",file,fr,pattern,pr),fr!==fl))}if("string"==typeof p?(hit=options.nocase?f.toLowerCase()===p.toLowerCase():f===p,this.debug("string match",p,f,hit)):(hit=f.match(p),this.debug("pattern match",p,f,hit)),!hit)return!1}if(fi===fl&&pi===pl)return!0;if(fi===fl)return partial;if(pi===pl)return fi===fl-1&&""===file[fi];throw new Error("wtf?")}},1110:function(module,exports,__webpack_require__){var concatMap=__webpack_require__(1111),balanced=__webpack_require__(1112);module.exports=function(str){if(!str)return[];"{}"===str.substr(0,2)&&(str="\\{\\}"+str.substr(2));return function expand(str,isTop){var expansions=[],m=balanced("{","}",str);if(!m||/\$$/.test(m.pre))return[str];var n,isNumericSequence=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(m.body),isAlphaSequence=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(m.body),isSequence=isNumericSequence||isAlphaSequence,isOptions=m.body.indexOf(",")>=0;if(!isSequence&&!isOptions)return m.post.match(/,.*\}/)?(str=m.pre+"{"+m.body+escClose+m.post,expand(str)):[str];if(isSequence)n=m.body.split(/\.\./);else{if(1===(n=function parseCommaParts(str){if(!str)return[""];var parts=[],m=balanced("{","}",str);if(!m)return str.split(",");var pre=m.pre,body=m.body,post=m.post,p=pre.split(",");p[p.length-1]+="{"+body+"}";var postParts=parseCommaParts(post);post.length&&(p[p.length-1]+=postParts.shift(),p.push.apply(p,postParts));return parts.push.apply(parts,p),parts}(m.body)).length)if(1===(n=expand(n[0],!1).map(embrace)).length)return(post=m.post.length?expand(m.post,!1):[""]).map((function(p){return m.pre+n[0]+p}))}var N,pre=m.pre,post=m.post.length?expand(m.post,!1):[""];if(isSequence){var x=numeric(n[0]),y=numeric(n[1]),width=Math.max(n[0].length,n[1].length),incr=3==n.length?Math.abs(numeric(n[2])):1,test=lte;y<x&&(incr*=-1,test=gte);var pad=n.some(isPadded);N=[];for(var i=x;test(i,y);i+=incr){var c;if(isAlphaSequence)"\\"===(c=String.fromCharCode(i))&&(c="");else if(c=String(i),pad){var need=width-c.length;if(need>0){var z=new Array(need+1).join("0");c=i<0?"-"+z+c.slice(1):z+c}}N.push(c)}}else N=concatMap(n,(function(el){return expand(el,!1)}));for(var j=0;j<N.length;j++)for(var k=0;k<post.length;k++){var expansion=pre+N[j]+post[k];(!isTop||isSequence||expansion)&&expansions.push(expansion)}return expansions}(function(str){return str.split("\\\\").join(escSlash).split("\\{").join(escOpen).split("\\}").join(escClose).split("\\,").join(escComma).split("\\.").join(escPeriod)}(str),!0).map(unescapeBraces)};var escSlash="\0SLASH"+Math.random()+"\0",escOpen="\0OPEN"+Math.random()+"\0",escClose="\0CLOSE"+Math.random()+"\0",escComma="\0COMMA"+Math.random()+"\0",escPeriod="\0PERIOD"+Math.random()+"\0";function numeric(str){return parseInt(str,10)==str?parseInt(str,10):str.charCodeAt(0)}function unescapeBraces(str){return str.split(escSlash).join("\\").split(escOpen).join("{").split(escClose).join("}").split(escComma).join(",").split(escPeriod).join(".")}function embrace(str){return"{"+str+"}"}function isPadded(el){return/^-?0\d/.test(el)}function lte(i,y){return i<=y}function gte(i,y){return i>=y}},1111:function(module,exports){module.exports=function(xs,fn){for(var res=[],i=0;i<xs.length;i++){var x=fn(xs[i],i);isArray(x)?res.push.apply(res,x):res.push(x)}return res};var isArray=Array.isArray||function(xs){return"[object Array]"===Object.prototype.toString.call(xs)}},1112:function(module,exports,__webpack_require__){"use strict";function balanced(a,b,str){a instanceof RegExp&&(a=maybeMatch(a,str)),b instanceof RegExp&&(b=maybeMatch(b,str));var r=range(a,b,str);return r&&{start:r[0],end:r[1],pre:str.slice(0,r[0]),body:str.slice(r[0]+a.length,r[1]),post:str.slice(r[1]+b.length)}}function maybeMatch(reg,str){var m=str.match(reg);return m?m[0]:null}function range(a,b,str){var begs,beg,left,right,result,ai=str.indexOf(a),bi=str.indexOf(b,ai+1),i=ai;if(ai>=0&&bi>0){for(begs=[],left=str.length;i>=0&&!result;)i==ai?(begs.push(i),ai=str.indexOf(a,i+1)):1==begs.length?result=[begs.pop(),bi]:((beg=begs.pop())<left&&(left=beg,right=bi),bi=str.indexOf(b,i+1)),i=ai<bi&&ai>=0?ai:bi;begs.length&&(result=[left,right])}return result}module.exports=balanced,balanced.range=range},1120:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"subPluginClasses",(function(){return subPluginClasses}));var local_storage=__webpack_require__(341),types_timeline=__webpack_require__(111),external_kbnSharedDeps_React_=__webpack_require__(6),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),external_kbnSharedDeps_ReactRouterDom_=__webpack_require__(77),external_kbnSharedDeps_ElasticEui_=__webpack_require__(74),external_kbnSharedDeps_StyledComponents_=__webpack_require__(75),external_kbnSharedDeps_StyledComponents_default=__webpack_require__.n(external_kbnSharedDeps_StyledComponents_),api=__webpack_require__(160),use_app_toasts=__webpack_require__(115),transforms=__webpack_require__(308),translations=__webpack_require__(212);var lib=__webpack_require__(0),schemas=__webpack_require__(26),types=__webpack_require__(488);const types_action=lib.exact(lib.type({group:lib.string,id:lib.string,action_type_id:lib.string,params:lib.record(lib.string,lib.any)})),MetaRule=lib.intersection([lib.type({from:lib.string}),lib.partial({throttle:lib.string,kibana_siem_app_url:lib.string})]),StatusTypes=lib.union([lib.literal("succeeded"),lib.literal("failed"),lib.literal("going to run"),lib.literal("partial failure"),lib.literal("warning")]),RuleSchema=lib.intersection([lib.type({author:schemas.b,created_at:lib.string,created_by:lib.string,description:lib.string,enabled:lib.boolean,false_positives:lib.array(lib.string),from:lib.string,id:lib.string,interval:lib.string,immutable:lib.boolean,name:lib.string,max_signals:lib.number,references:lib.array(lib.string),risk_score:lib.number,risk_score_mapping:schemas.i,rule_id:lib.string,severity:lib.string,severity_mapping:schemas.l,tags:lib.array(lib.string),type:schemas.t,to:lib.string,threat:schemas.p,updated_at:lib.string,updated_by:lib.string,actions:lib.array(types_action),throttle:lib.union([lib.string,lib.null])}),lib.partial({building_block_type:schemas.c,anomaly_threshold:lib.number,filters:lib.array(lib.unknown),index:lib.array(lib.string),language:lib.string,license:schemas.f,last_failure_at:lib.string,last_failure_message:lib.string,last_success_message:lib.string,last_success_at:lib.string,meta:MetaRule,machine_learning_job_id:lib.array(lib.string),output_index:lib.string,query:lib.string,rule_name_override:schemas.k,saved_id:lib.string,status:StatusTypes,status_date:lib.string,threshold:schemas.q,threat_query:types.i,threat_filters:types.d,threat_index:types.e,threat_indicator_path:types.f,threat_mapping:types.h,threat_language:types.g,timeline_id:lib.string,timeline_title:lib.string,timestamp_override:schemas.s,note:lib.string,exceptions_list:types.b,version:lib.number})]),useRule=(lib.array(RuleSchema),id=>{const[rule,setRule]=Object(external_kbnSharedDeps_React_.useState)(null),[loading,setLoading]=Object(external_kbnSharedDeps_React_.useState)(!0),{addError:addError}=Object(use_app_toasts.a)();return Object(external_kbnSharedDeps_React_.useEffect)(()=>{let isSubscribed=!0;const abortCtrl=new AbortController;return null!=id&&(async idToFetch=>{try{setLoading(!0);const ruleResponse=Object(transforms.a)(await Object(api.g)({id:idToFetch,signal:abortCtrl.signal}));isSubscribed&&setRule(ruleResponse)}catch(error){isSubscribed&&(setRule(null),addError(error,{title:translations.h}))}isSubscribed&&setLoading(!1)})(id),()=>{isSubscribed=!1,abortCtrl.abort()}},[id,addError]),[loading,rule]}),initialStateDefaults={rules:[],pagination:{page:1,perPage:20,total:0},filterOptions:{filter:"",sortField:"enabled",sortOrder:"desc",tags:[],showCustomRules:!1,showElasticRules:!1},loadingRulesAction:null,loadingRuleIds:[],selectedRuleIds:[],exportRuleIds:[],lastUpdated:0,isRefreshOn:!0,isRefreshing:!1,showIdleModal:!1},useRulesTable=params=>{const{tableRef:tableRef,initialStateOverride:initialStateOverride}=params,initialState={...initialStateDefaults,lastUpdated:Date.now(),...initialStateOverride},reducer=Object(external_kbnSharedDeps_React_.useMemo)(()=>(tableRef=>(state,action)=>{switch(action.type){case"setRules":var _tableRef$current;return null!=(null==tableRef||null===(_tableRef$current=tableRef.current)||void 0===_tableRef$current?void 0:_tableRef$current.changeSelection)&&window.setTimeout(()=>{var _tableRef$current2;return null==tableRef||null===(_tableRef$current2=tableRef.current)||void 0===_tableRef$current2?void 0:_tableRef$current2.changeSelection([])},0),{...state,rules:action.rules,selectedRuleIds:[],loadingRuleIds:[],loadingRulesAction:null,pagination:{...state.pagination,...action.pagination}};case"updateRules":{const ruleIds=state.rules.map(r=>r.id),updatedRules=action.rules.reduce((rules,updatedRule)=>{let newRules=rules;return newRules=ruleIds.includes(updatedRule.id)?newRules.map(r=>updatedRule.id===r.id?updatedRule:r):[...newRules,updatedRule],newRules},state.rules),updatedRuleIds=action.rules.map(r=>r.id),newLoadingRuleIds=state.loadingRuleIds.filter(id=>!updatedRuleIds.includes(id));return{...state,rules:updatedRules,loadingRuleIds:newLoadingRuleIds,loadingRulesAction:0===newLoadingRuleIds.length?null:state.loadingRulesAction}}case"updateFilterOptions":return{...state,filterOptions:{...state.filterOptions,...action.filterOptions},pagination:{...state.pagination,...action.pagination}};case"loadingRuleIds":return{...state,loadingRuleIds:null==action.actionType?[]:[...state.loadingRuleIds,...action.ids],loadingRulesAction:action.actionType};case"selectedRuleIds":return{...state,selectedRuleIds:action.ids};case"exportRuleIds":return{...state,loadingRuleIds:action.ids,loadingRulesAction:"export",exportRuleIds:action.ids};case"setLastRefreshDate":return{...state,lastUpdated:Date.now()};case"setAutoRefreshOn":return{...state,isRefreshOn:action.on};case"setIsRefreshing":return{...state,isRefreshing:action.isRefreshing};case"setShowIdleModal":return{...state,showIdleModal:action.show,isRefreshOn:!action.show};case"failure":return{...state,rules:[]};default:return state}})(tableRef),[tableRef]),[state,dispatch]=Object(external_kbnSharedDeps_React_.useReducer)(reducer,initialState),facade=Object(external_kbnSharedDeps_React_.useRef)((dispatch=>({setRules:(newRules,newPagination)=>{dispatch({type:"setRules",rules:newRules,pagination:newPagination})},updateRules:rules=>{dispatch({type:"updateRules",rules:rules})},updateOptions:(filter,pagination)=>{dispatch({type:"updateFilterOptions",filterOptions:filter,pagination:pagination})},actionStarted:(actionType,ruleIds)=>{dispatch({type:"loadingRuleIds",actionType:actionType,ids:ruleIds})},actionStopped:()=>{dispatch({type:"loadingRuleIds",actionType:null,ids:[]})},setShowIdleModal:show=>{dispatch({type:"setShowIdleModal",show:show})},setLastRefreshDate:()=>{dispatch({type:"setLastRefreshDate"})},setAutoRefreshOn:on=>{dispatch({type:"setAutoRefreshOn",on:on})},setIsRefreshing:isRefreshing=>{dispatch({type:"setIsRefreshing",isRefreshing:isRefreshing})}}))(dispatch)),{addError:addError}=Object(use_app_toasts.a)(),reFetchRules=Object(external_kbnSharedDeps_React_.useRef)(()=>Promise.resolve()),{pagination:pagination,filterOptions:filterOptions}=state,filterTags=filterOptions.tags.sort().join();return Object(external_kbnSharedDeps_React_.useEffect)(()=>{let isSubscribed=!0;const abortCtrl=new AbortController,fetchData=async()=>{try{facade.current.actionStarted("load",[]);const fetchRulesResult=await Object(api.h)({filterOptions:filterOptions,pagination:pagination,signal:abortCtrl.signal});isSubscribed&&facade.current.setRules(fetchRulesResult.data,{page:fetchRulesResult.page,perPage:fetchRulesResult.perPage,total:fetchRulesResult.total})}catch(error){isSubscribed&&(addError(error,{title:translations.h}),facade.current.setRules([],{}))}isSubscribed&&facade.current.actionStopped()};return fetchData(),reFetchRules.current=()=>fetchData(),()=>{isSubscribed=!1,abortCtrl.abort()}},[pagination.page,pagination.perPage,filterOptions.filter,filterOptions.sortField,filterOptions.sortOrder,filterTags,filterOptions.showCustomRules,filterOptions.showElasticRules]),{state:state,dispatch:dispatch,...facade.current,reFetchRules:reFetchRules.current}};var target=__webpack_require__(42),target_default=__webpack_require__.n(target),external_kbnSharedDeps_Moment_=__webpack_require__(25),external_kbnSharedDeps_Moment_default=__webpack_require__.n(external_kbnSharedDeps_Moment_),memoize_one_cjs=__webpack_require__(204),memoize_one_cjs_default=__webpack_require__.n(memoize_one_cjs),utils=__webpack_require__(176),utility_types=__webpack_require__(194);const transformRuleToAlertAction=({group:group,id:id,action_type_id:action_type_id,params:params})=>({group:group,id:id,params:params,actionTypeId:action_type_id}),transformAlertToRuleAction=({group:group,id:id,actionTypeId:actionTypeId,params:params})=>({group:group,id:id,params:params,action_type_id:actionTypeId});var shared_imports=__webpack_require__(117),external_kbnSharedDeps_Theme_euiLightVars_=__webpack_require__(90),external_kbnSharedDeps_Theme_euiLightVars_default=__webpack_require__.n(external_kbnSharedDeps_Theme_euiLightVars_),external_kbnSharedDeps_KbnI18n_=__webpack_require__(1);const ADVANCED_SETTINGS=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.advancedSettingsButton",{defaultMessage:"Advanced settings"}),ADD_REFERENCE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.addReferenceDescription",{defaultMessage:"Add reference URL"}),ADD_FALSE_POSITIVE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.addFalsePositiveDescription",{defaultMessage:"Add false positive example"}),GLOBAL_ENDPOINT_EXCEPTION_LIST=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.endpointExceptionListLabel",{defaultMessage:"Elastic Endpoint exceptions"}),BUILDING_BLOCK=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.buildingBlockLabel",{defaultMessage:"Building block"}),LOW=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.severityOptionLowDescription",{defaultMessage:"Low"}),MEDIUM=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.severityOptionMediumDescription",{defaultMessage:"Medium"}),HIGH=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.severityOptionHighDescription",{defaultMessage:"High"}),CRITICAL=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.severityOptionCriticalDescription",{defaultMessage:"Critical"}),URL_FORMAT_INVALID=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.referencesUrlInvalidError",{defaultMessage:"Url is invalid format"}),ADD_RULE_NOTE_HELP_TEXT=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutrule.noteHelpText",{defaultMessage:"Add rule investigation guide..."}),StyledEuiHealth=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiHealth).withConfig({displayName:"StyledEuiHealth",componentId:"sc-1mv5h4i-0"})(["line-height:inherit;"]),severityOptions=[{value:"low",inputDisplay:external_kbnSharedDeps_React_default.a.createElement(StyledEuiHealth,{color:external_kbnSharedDeps_Theme_euiLightVars_default.a.euiColorVis0},LOW)},{value:"medium",inputDisplay:external_kbnSharedDeps_React_default.a.createElement(StyledEuiHealth,{color:external_kbnSharedDeps_Theme_euiLightVars_default.a.euiColorVis5},MEDIUM)},{value:"high",inputDisplay:external_kbnSharedDeps_React_default.a.createElement(StyledEuiHealth,{color:external_kbnSharedDeps_Theme_euiLightVars_default.a.euiColorVis7},HIGH)},{value:"critical",inputDisplay:external_kbnSharedDeps_React_default.a.createElement(StyledEuiHealth,{color:external_kbnSharedDeps_Theme_euiLightVars_default.a.euiColorVis9},CRITICAL)}],defaultRiskScoreBySeverity={low:21,medium:47,high:73,critical:99},getStepsData=({rule:rule,detailsView:detailsView=!1})=>{const defineRuleData=getDefineStepsData(rule);return{aboutRuleData:getAboutStepsData(rule,detailsView),modifiedAboutRuleDetailsData:getModifiedAboutDetailsData(rule),defineRuleData:defineRuleData,scheduleRuleData:getScheduleStepsData(rule),ruleActionsData:getActionsStepsData(rule)}},getActionsStepsData=rule=>{const{enabled:enabled,throttle:throttle,meta:meta,actions:actions=[]}=rule;return{actions:null==actions?void 0:actions.map(transformRuleToAlertAction),throttle:throttle,kibanaSiemAppUrl:null==meta?void 0:meta.kibana_siem_app_url,enabled:enabled}},getDefineStepsData=rule=>{var _rule$anomaly_thresho,_rule$machine_learnin,_rule$index,_rule$threat_index,_rule$threat_query,_rule$threat_language,_rule$threat_filters,_rule$threat_mapping,_rule$query,_rule$language,_rule$filters,_rule$timeline_id,_rule$timeline_title,_rule$threshold,_rule$threshold2,_rule$threshold3,_rule$threshold3$card;return{ruleType:rule.type,anomalyThreshold:null!==(_rule$anomaly_thresho=rule.anomaly_threshold)&&void 0!==_rule$anomaly_thresho?_rule$anomaly_thresho:50,machineLearningJobId:null!==(_rule$machine_learnin=rule.machine_learning_job_id)&&void 0!==_rule$machine_learnin?_rule$machine_learnin:[],index:null!==(_rule$index=rule.index)&&void 0!==_rule$index?_rule$index:[],threatIndex:null!==(_rule$threat_index=rule.threat_index)&&void 0!==_rule$threat_index?_rule$threat_index:[],threatQueryBar:{query:{query:null!==(_rule$threat_query=rule.threat_query)&&void 0!==_rule$threat_query?_rule$threat_query:"",language:null!==(_rule$threat_language=rule.threat_language)&&void 0!==_rule$threat_language?_rule$threat_language:""},filters:null!==(_rule$threat_filters=rule.threat_filters)&&void 0!==_rule$threat_filters?_rule$threat_filters:[],saved_id:void 0},threatMapping:null!==(_rule$threat_mapping=rule.threat_mapping)&&void 0!==_rule$threat_mapping?_rule$threat_mapping:[],queryBar:{query:{query:null!==(_rule$query=rule.query)&&void 0!==_rule$query?_rule$query:"",language:null!==(_rule$language=rule.language)&&void 0!==_rule$language?_rule$language:""},filters:null!==(_rule$filters=rule.filters)&&void 0!==_rule$filters?_rule$filters:[],saved_id:rule.saved_id},timeline:{id:null!==(_rule$timeline_id=rule.timeline_id)&&void 0!==_rule$timeline_id?_rule$timeline_id:null,title:null!==(_rule$timeline_title=rule.timeline_title)&&void 0!==_rule$timeline_title?_rule$timeline_title:null},threshold:{field:Object(utils.g)(null===(_rule$threshold=rule.threshold)||void 0===_rule$threshold?void 0:_rule$threshold.field),value:""+((null===(_rule$threshold2=rule.threshold)||void 0===_rule$threshold2?void 0:_rule$threshold2.value)||100),...null!==(_rule$threshold3=rule.threshold)&&void 0!==_rule$threshold3&&null!==(_rule$threshold3$card=_rule$threshold3.cardinality)&&void 0!==_rule$threshold3$card&&_rule$threshold3$card.length?{cardinality:{field:[""+rule.threshold.cardinality[0].field],value:""+rule.threshold.cardinality[0].value}}:{}}}},getScheduleStepsData=rule=>{const{interval:interval,from:from}=rule;return{interval:interval,from:getHumanizedDuration(from,interval)}},getHumanizedDuration=(from,interval)=>{var _dateMath$parse,_dateMath$parse2;const fromValue=null!==(_dateMath$parse=target_default.a.parse(from))&&void 0!==_dateMath$parse?_dateMath$parse:external_kbnSharedDeps_Moment_default()(),intervalValue=null!==(_dateMath$parse2=target_default.a.parse("now-"+interval))&&void 0!==_dateMath$parse2?_dateMath$parse2:external_kbnSharedDeps_Moment_default()(),fromDuration=external_kbnSharedDeps_Moment_default.a.duration(intervalValue.diff(fromValue)),intervalDuration=Math.floor(fromDuration.asSeconds());return 0===intervalDuration?"0s":intervalDuration%3600==0?intervalDuration/3600+"h":intervalDuration%60==0?intervalDuration/60+"m":intervalDuration+"s"},getAboutStepsData=(rule,detailsView)=>{var _exceptionsList$some;const{name:name,description:description,note:note}=determineDetailsValue(rule,detailsView),{author:author,building_block_type:buildingBlockType,exceptions_list:exceptionsList,license:license,risk_score_mapping:riskScoreMapping,rule_name_override:ruleNameOverride,severity_mapping:severityMapping,timestamp_override:timestampOverride,references:references,severity:severity,false_positives:falsePositives,risk_score:riskScore,tags:tags,threat:threat,threat_indicator_path:threatIndicatorPath}=rule;return{author:author,isAssociatedToEndpointList:null!==(_exceptionsList$some=null==exceptionsList?void 0:exceptionsList.some(({id:id})=>id===shared_imports.a))&&void 0!==_exceptionsList$some&&_exceptionsList$some,isBuildingBlock:void 0!==buildingBlockType,license:null!=license?license:"",ruleNameOverride:null!=ruleNameOverride?ruleNameOverride:"",timestampOverride:null!=timestampOverride?timestampOverride:"",name:name,description:description,note:note,references:references,severity:{value:severity,mapping:fillEmptySeverityMappings(severityMapping),isMappingChecked:severityMapping.length>0},tags:tags,riskScore:{value:riskScore,mapping:riskScoreMapping,isMappingChecked:riskScoreMapping.length>0},falsePositives:falsePositives,threat:threat,threatIndicatorPath:threatIndicatorPath}},severitySortMapping={low:0,medium:1,high:2,critical:3},fillEmptySeverityMappings=mappings=>{const missingMappings=severityOptions.flatMap(so=>null==mappings.find(mapping=>mapping.severity===so.value)?[{field:"",value:"",operator:"equals",severity:so.value}]:[]);return[...mappings,...missingMappings].sort((a,b)=>severitySortMapping[a.severity]-severitySortMapping[b.severity])},determineDetailsValue=(rule,detailsView)=>{const{name:name,description:description,note:note}=rule;return detailsView?{name:"",description:"",note:""}:{name:name,description:description,note:null!=note?note:""}},getModifiedAboutDetailsData=rule=>{var _rule$note;return{note:null!==(_rule$note=rule.note)&&void 0!==_rule$note?_rule$note:"",description:rule.description}},getPrePackagedRuleStatus=(rulesInstalled,rulesNotInstalled,rulesNotUpdated)=>null!=rulesNotInstalled&&0===rulesInstalled&&rulesNotInstalled>0&&0===rulesNotUpdated?"ruleNotInstalled":null!=rulesInstalled&&rulesInstalled>0&&0===rulesNotInstalled&&0===rulesNotUpdated?"ruleInstalled":null!=rulesInstalled&&null!=rulesNotInstalled&&rulesInstalled>0&&rulesNotInstalled>0&&0===rulesNotUpdated?"someRuleUninstall":null!=rulesInstalled&&null!=rulesNotInstalled&&null!=rulesNotUpdated&&rulesInstalled>0&&rulesNotInstalled>=0&&rulesNotUpdated>0?"ruleNeedUpdate":"unknown",getPrePackagedTimelineStatus=(timelinesInstalled,timelinesNotInstalled,timelinesNotUpdated)=>null!=timelinesNotInstalled&&0===timelinesInstalled&&timelinesNotInstalled>0&&0===timelinesNotUpdated?"timelinesNotInstalled":null!=timelinesInstalled&&timelinesInstalled>0&&0===timelinesNotInstalled&&0===timelinesNotUpdated?"timelinesInstalled":null!=timelinesInstalled&&null!=timelinesNotInstalled&&timelinesInstalled>0&&timelinesNotInstalled>0&&0===timelinesNotUpdated?"someTimelineUninstall":null!=timelinesInstalled&&null!=timelinesNotInstalled&&null!=timelinesNotUpdated&&timelinesInstalled>0&&timelinesNotInstalled>=0&&timelinesNotUpdated>0?"timelineNeedUpdate":"unknown",redirectToDetections=(isSignalIndexExists,isAuthenticated,hasEncryptionKey,needsListsConfiguration)=>!1===isSignalIndexExists||!1===isAuthenticated||!1===hasEncryptionKey||needsListsConfiguration,getRuleSpecificRuleParamKeys=ruleType=>{const queryRuleParams=["index","filters","language","query","saved_id"];switch(ruleType){case"machine_learning":return["anomaly_threshold","machine_learning_job_id"];case"threshold":return["threshold",...queryRuleParams];case"threat_match":case"query":case"saved_query":case"eql":return queryRuleParams}Object(utility_types.a)(ruleType)},getActionMessageParams=memoize_one_cjs_default()(ruleType=>{if(!ruleType)return{state:[],params:[]};return{state:[{name:"signals_count",description:"state.signals_count"}],params:[],context:[{name:"results_link",description:"context.results_link",useWithTripleBracesInTemplates:!0},{name:"alerts",description:"context.alerts"},...(ruleType=>["id","name","description","false_positives","rule_id","max_signals","risk_score","output_index","references","severity","timeline_id","timeline_title","threat","type","version",...getRuleSpecificRuleParamKeys(ruleType)].sort())(ruleType).map(param=>{const extendedParam="rule."+param;return{name:extendedParam,description:"context."+extendedParam}})]}}),helpers_userHasNoPermissions=canUserCRUD=>null!=canUserCRUD&&!canUserCRUD,MaxWidthEuiFlexItem=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexItem).withConfig({displayName:"MaxWidthEuiFlexItem",componentId:"sc-97v502-0"})(["max-width:1000px;overflow:hidden;"]),usePrePackagedRules=({canUserCRUD:canUserCRUD,hasIndexWrite:hasIndexWrite,isAuthenticated:isAuthenticated,hasEncryptionKey:hasEncryptionKey,isSignalIndexExists:isSignalIndexExists})=>{const[prepackagedDataStatus,setPrepackagedDataStatus]=Object(external_kbnSharedDeps_React_.useState)({createPrePackagedRules:null,refetchPrePackagedRulesStatus:null,rulesCustomInstalled:null,rulesInstalled:null,rulesNotInstalled:null,rulesNotUpdated:null,timelinesInstalled:null,timelinesNotInstalled:null,timelinesNotUpdated:null}),[loadingCreatePrePackagedRules,setLoadingCreatePrePackagedRules]=Object(external_kbnSharedDeps_React_.useState)(!1),[loading,setLoading]=Object(external_kbnSharedDeps_React_.useState)(!0),{addError:addError,addSuccess:addSuccess}=Object(use_app_toasts.a)();Object(external_kbnSharedDeps_React_.useEffect)(()=>{let isSubscribed=!0;const abortCtrl=new AbortController,fetchPrePackagedRules=async()=>{try{setLoading(!0);const prePackagedRuleStatusResponse=await Object(api.j)({signal:abortCtrl.signal});isSubscribed&&setPrepackagedDataStatus({createPrePackagedRules:createElasticRules,refetchPrePackagedRulesStatus:fetchPrePackagedRules,rulesCustomInstalled:prePackagedRuleStatusResponse.rules_custom_installed,rulesInstalled:prePackagedRuleStatusResponse.rules_installed,rulesNotInstalled:prePackagedRuleStatusResponse.rules_not_installed,rulesNotUpdated:prePackagedRuleStatusResponse.rules_not_updated,timelinesInstalled:prePackagedRuleStatusResponse.timelines_installed,timelinesNotInstalled:prePackagedRuleStatusResponse.timelines_not_installed,timelinesNotUpdated:prePackagedRuleStatusResponse.timelines_not_updated})}catch(error){isSubscribed&&(setPrepackagedDataStatus({createPrePackagedRules:null,refetchPrePackagedRulesStatus:null,rulesCustomInstalled:null,rulesInstalled:null,rulesNotInstalled:null,rulesNotUpdated:null,timelinesInstalled:null,timelinesNotInstalled:null,timelinesNotUpdated:null}),addError(error,{title:translations.h}))}isSubscribed&&setLoading(!1)},createElasticRules=async()=>new Promise(async resolve=>{try{if(canUserCRUD&&hasIndexWrite&&isAuthenticated&&hasEncryptionKey&&isSignalIndexExists){setLoadingCreatePrePackagedRules(!0);const result=await Object(api.a)({signal:abortCtrl.signal});if(isSubscribed){let iterationTryOfFetchingPrePackagedCount=0,timeoutId=-1;const stopTimeOut=()=>{-1!==timeoutId&&window.clearTimeout(timeoutId)},reFetch=()=>window.setTimeout(async()=>{iterationTryOfFetchingPrePackagedCount+=1;const prePackagedRuleStatusResponse=await Object(api.j)({signal:abortCtrl.signal});isSubscribed&&(0===prePackagedRuleStatusResponse.rules_not_installed&&0===prePackagedRuleStatusResponse.rules_not_updated&&0===prePackagedRuleStatusResponse.timelines_not_installed&&0===prePackagedRuleStatusResponse.timelines_not_updated||iterationTryOfFetchingPrePackagedCount>100)?(setLoadingCreatePrePackagedRules(!1),setPrepackagedDataStatus({createPrePackagedRules:createElasticRules,refetchPrePackagedRulesStatus:fetchPrePackagedRules,rulesCustomInstalled:prePackagedRuleStatusResponse.rules_custom_installed,rulesInstalled:prePackagedRuleStatusResponse.rules_installed,rulesNotInstalled:prePackagedRuleStatusResponse.rules_not_installed,rulesNotUpdated:prePackagedRuleStatusResponse.rules_not_updated,timelinesInstalled:prePackagedRuleStatusResponse.timelines_installed,timelinesNotInstalled:prePackagedRuleStatusResponse.timelines_not_installed,timelinesNotUpdated:prePackagedRuleStatusResponse.timelines_not_updated}),addSuccess((result=>{const{rules_installed:rulesInstalled,rules_updated:rulesUpdated,timelines_installed:timelinesInstalled,timelines_updated:timelinesUpdated}=result;return 0===rulesInstalled&&(timelinesInstalled>0||timelinesUpdated>0)?translations.m:(rulesInstalled>0||rulesUpdated>0)&&0===timelinesInstalled?translations.k:translations.j})(result)),stopTimeOut(),resolve(!0)):timeoutId=reFetch()},300);timeoutId=reFetch()}}else resolve(!1)}catch(error){isSubscribed&&(setLoadingCreatePrePackagedRules(!1),addError(error,{title:translations.i}),resolve(!1))}});return fetchPrePackagedRules(),()=>{isSubscribed=!1,abortCtrl.abort()}},[canUserCRUD,hasIndexWrite,isAuthenticated,hasEncryptionKey,isSignalIndexExists,addError,addSuccess]);const prePackagedRuleStatus=Object(external_kbnSharedDeps_React_.useMemo)(()=>getPrePackagedRuleStatus(prepackagedDataStatus.rulesInstalled,prepackagedDataStatus.rulesNotInstalled,prepackagedDataStatus.rulesNotUpdated),[prepackagedDataStatus.rulesInstalled,prepackagedDataStatus.rulesNotInstalled,prepackagedDataStatus.rulesNotUpdated]),prePackagedTimelineStatus=Object(external_kbnSharedDeps_React_.useMemo)(()=>getPrePackagedTimelineStatus(prepackagedDataStatus.timelinesInstalled,prepackagedDataStatus.timelinesNotInstalled,prepackagedDataStatus.timelinesNotUpdated),[prepackagedDataStatus.timelinesInstalled,prepackagedDataStatus.timelinesNotInstalled,prepackagedDataStatus.timelinesNotUpdated]),getLoadPrebuiltRulesAndTemplatesButton=Object(external_kbnSharedDeps_React_.useCallback)(({isDisabled:isDisabled,onClick:onClick,fill:fill,"data-test-subj":dataTestSubj="loadPrebuiltRulesBtn"})=>"ruleNotInstalled"!==prePackagedRuleStatus&&"timelinesNotInstalled"!==prePackagedTimelineStatus||"someRuleUninstall"===prePackagedRuleStatus?null:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{fill:fill,iconType:"indexOpen",isLoading:loadingCreatePrePackagedRules,isDisabled:isDisabled,onClick:onClick,"data-test-subj":dataTestSubj},"ruleNotInstalled"===prePackagedRuleStatus&&"timelinesNotInstalled"===prePackagedTimelineStatus&&translations.b,"ruleNotInstalled"===prePackagedRuleStatus&&"timelinesNotInstalled"!==prePackagedTimelineStatus&&translations.a,"ruleNotInstalled"!==prePackagedRuleStatus&&"timelinesNotInstalled"===prePackagedTimelineStatus&&translations.c),[loadingCreatePrePackagedRules,prePackagedRuleStatus,prePackagedTimelineStatus]),getMissingRulesOrTimelinesButtonTitle=Object(external_kbnSharedDeps_React_.useCallback)((missingRules,missingTimelines)=>missingRules>0&&0===missingTimelines?translations.d(missingRules):0===missingRules&&missingTimelines>0?translations.f(missingTimelines):missingRules>0&&missingTimelines>0?translations.e(missingRules,missingTimelines):void 0,[]),getReloadPrebuiltRulesAndTemplatesButton=Object(external_kbnSharedDeps_React_.useCallback)(({isDisabled:isDisabled,onClick:onClick,fill:fill=!1})=>{var _prepackagedDataStatu,_prepackagedDataStatu2;return"someRuleUninstall"===prePackagedRuleStatus||"someTimelineUninstall"===prePackagedTimelineStatus?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{fill:fill,iconType:"plusInCircle",isLoading:loadingCreatePrePackagedRules,isDisabled:isDisabled,onClick:onClick,"data-test-subj":"reloadPrebuiltRulesBtn"},getMissingRulesOrTimelinesButtonTitle(null!==(_prepackagedDataStatu=prepackagedDataStatus.rulesNotInstalled)&&void 0!==_prepackagedDataStatu?_prepackagedDataStatu:0,null!==(_prepackagedDataStatu2=prepackagedDataStatus.timelinesNotInstalled)&&void 0!==_prepackagedDataStatu2?_prepackagedDataStatu2:0)):null},[getMissingRulesOrTimelinesButtonTitle,loadingCreatePrePackagedRules,prePackagedRuleStatus,prePackagedTimelineStatus,prepackagedDataStatus.rulesNotInstalled,prepackagedDataStatus.timelinesNotInstalled]);return{loading:loading,loadingCreatePrePackagedRules:loadingCreatePrePackagedRules,...prepackagedDataStatus,getLoadPrebuiltRulesAndTemplatesButton:getLoadPrebuiltRulesAndTemplatesButton,getReloadPrebuiltRulesAndTemplatesButton:getReloadPrebuiltRulesAndTemplatesButton}},useRuleStatus=id=>{const[ruleStatus,setRuleStatus]=Object(external_kbnSharedDeps_React_.useState)(null),fetchRuleStatus=Object(external_kbnSharedDeps_React_.useRef)(null),[loading,setLoading]=Object(external_kbnSharedDeps_React_.useState)(!0),{addError:addError}=Object(use_app_toasts.a)();return Object(external_kbnSharedDeps_React_.useEffect)(()=>{let isSubscribed=!0;const abortCtrl=new AbortController,fetchData=async idToFetch=>{try{setLoading(!0);const ruleStatusResponse=await Object(api.k)({id:idToFetch,signal:abortCtrl.signal});isSubscribed&&setRuleStatus(ruleStatusResponse[null!=id?id:""])}catch(error){isSubscribed&&(setRuleStatus(null),addError(error,{title:translations.h}))}isSubscribed&&setLoading(!1)};return null!=id&&fetchData(id),fetchRuleStatus.current=fetchData,()=>{isSubscribed=!1,abortCtrl.abort()}},[id,addError]),[loading,ruleStatus,fetchRuleStatus.current]},useRulesStatuses=rules=>{const[rulesStatuses,setRuleStatuses]=Object(external_kbnSharedDeps_React_.useState)([]),[loading,setLoading]=Object(external_kbnSharedDeps_React_.useState)(!1),{addError:addError}=Object(use_app_toasts.a)();return Object(external_kbnSharedDeps_React_.useEffect)(()=>{let isSubscribed=!0;const abortCtrl=new AbortController;return rules.length>0&&(async ids=>{try{setLoading(!0);const ruleStatusesResponse=await Object(api.l)({ids:ids,signal:abortCtrl.signal});isSubscribed&&setRuleStatuses(rules.map(rule=>({id:rule.id,activate:rule.enabled,name:rule.name,...ruleStatusesResponse[rule.id]})))}catch(error){isSubscribed&&(setRuleStatuses([]),addError(error,{title:translations.h}))}isSubscribed&&setLoading(!1)})(rules.map(r=>r.id)),()=>{isSubscribed=!1,abortCtrl.abort()}},[rules,addError]),{loading:loading,rulesStatuses:rulesStatuses}};var lib_kibana=__webpack_require__(109),utils_api=__webpack_require__(161);const LISTS_INDEX_FETCH_FAILURE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.containers.detectionEngine.alerts.fetchListsIndex.errorDescription",{defaultMessage:"Failed to retrieve the lists index"}),LISTS_INDEX_CREATE_FAILURE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.containers.detectionEngine.alerts.createListsIndex.errorDescription",{defaultMessage:"Failed to create the lists index"}),LISTS_PRIVILEGES_READ_FAILURE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.containers.detectionEngine.alerts.readListsPrivileges.errorDescription",{defaultMessage:"Failed to retrieve lists privileges"}),use_lists_privileges_canManageIndex=indexPrivileges=>{const[indexName]=Object.keys(indexPrivileges),privileges=indexPrivileges[indexName];return null!=privileges&&privileges.manage},use_lists_privileges_canWriteIndex=indexPrivileges=>{const[indexName]=Object.keys(indexPrivileges),privileges=indexPrivileges[indexName];return null!=privileges&&(privileges.create||privileges.create_doc||privileges.index||privileges.write)},useListsConfig=()=>{const{createIndex:createIndex,indexExists:indexExists,loading:indexLoading,error:indexError}=(()=>{const[indexExists,setIndexExists]=Object(external_kbnSharedDeps_React_.useState)(null),[error,setError]=Object(external_kbnSharedDeps_React_.useState)(null),{lists:lists}=Object(lib_kibana.h)().services,http=Object(lib_kibana.g)(),{addError:addError}=Object(use_app_toasts.a)(),{loading:readLoading,start:readListIndex,...readListIndexState}=Object(shared_imports.M)(),{loading:createLoading,start:createListIndex,...createListIndexState}=Object(shared_imports.C)(),loading=readLoading||createLoading,readIndex=Object(external_kbnSharedDeps_React_.useCallback)(()=>{lists&&readListIndex({http:http})},[http,lists,readListIndex]),createIndex=Object(external_kbnSharedDeps_React_.useCallback)(()=>{lists&&createListIndex({http:http})},[createListIndex,http,lists]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{readLoading||error||null!==indexExists||readIndex()},[error,indexExists,readIndex,readLoading]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{null!=readListIndexState.result&&setIndexExists(readListIndexState.result.list_index&&readListIndexState.result.list_item_index)},[readListIndexState.result]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{null!=createListIndexState.result&&readIndex()},[createListIndexState.result,readIndex]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{const err=readListIndexState.error;null!=err&&(Object(utils_api.c)(err)&&404===err.body.status_code?setIndexExists(!1):(setError(err),addError(err,{title:LISTS_INDEX_FETCH_FAILURE})))},[addError,readListIndexState.error]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{const err=createListIndexState.error;null!=err&&(setError(err),addError(err,{title:LISTS_INDEX_CREATE_FAILURE}))},[addError,createListIndexState.error]),{createIndex:createIndex,error:error,indexExists:indexExists,loading:loading}})(),{canManageIndex:canManageIndex,canWriteIndex:canWriteIndex,loading:privilegesLoading}=(()=>{const[state,setState]=Object(external_kbnSharedDeps_React_.useState)({isAuthenticated:null,canManageIndex:null,canWriteIndex:null}),{lists:lists}=Object(lib_kibana.h)().services,http=Object(lib_kibana.g)(),{addError:addError}=Object(use_app_toasts.a)(),{loading:loading,start:readListPrivileges,...readState}=Object(shared_imports.N)(),readPrivileges=Object(external_kbnSharedDeps_React_.useCallback)(()=>{lists&&readListPrivileges({http:http})},[http,lists,readListPrivileges]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{loading||readState.error||null!==state.isAuthenticated||readPrivileges()},[loading,readState.error,readPrivileges,state.isAuthenticated]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{if(null!=readState.result)try{const{is_authenticated:isAuthenticated,lists:{index:listsPrivileges},listItems:{index:listItemsPrivileges}}=readState.result;setState({isAuthenticated:isAuthenticated,canManageIndex:use_lists_privileges_canManageIndex(listsPrivileges)&&use_lists_privileges_canManageIndex(listItemsPrivileges),canWriteIndex:use_lists_privileges_canWriteIndex(listsPrivileges)&&use_lists_privileges_canWriteIndex(listItemsPrivileges)})}catch(e){setState({isAuthenticated:null,canManageIndex:!1,canWriteIndex:!1})}},[readState.result]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{const error=readState.error;null!=error&&(setState({isAuthenticated:!1,canManageIndex:!1,canWriteIndex:!1}),addError(error,{title:LISTS_PRIVILEGES_READ_FAILURE}))},[addError,readState.error]),{loading:loading,...state}})(),{lists:lists}=Object(lib_kibana.h)().services,enabled=null!=lists,loading=indexLoading||privilegesLoading,needsIndex=!1===indexExists,needsConfiguration=!enabled||needsIndex&&(!1===canManageIndex||!0===canManageIndex&&null!=indexError);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{needsIndex&&canManageIndex&&createIndex()},[canManageIndex,createIndex,needsIndex]),{canManageIndex:canManageIndex,canWriteIndex:canWriteIndex,enabled:enabled,loading:loading,needsConfiguration:needsConfiguration}};var redirect_to_detection_engine=__webpack_require__(159),wrapper_page=__webpack_require__(145),toasters=__webpack_require__(116),spy_routes=__webpack_require__(143),user_info=__webpack_require__(179),external_kbnSharedDeps_Theme_euiDarkVars_=__webpack_require__(94),external_kbnSharedDeps_Theme_euiDarkVars_default=__webpack_require__.n(external_kbnSharedDeps_Theme_euiDarkVars_),constants=__webpack_require__(2);const RuleStatusIconStyled=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"RuleStatusIconStyled",componentId:"sc-1sbrlhw-0"})(["position:relative;svg{position:absolute;top:8px;left:9px;}"]),RuleStatusIconComponent=({name:name,type:type})=>{const theme=(()=>{const[darkMode]=Object(lib_kibana.l)(constants.q);return darkMode?external_kbnSharedDeps_Theme_euiDarkVars_default.a:external_kbnSharedDeps_Theme_euiLightVars_default.a})(),color="passive"===type?theme.euiColorLightestShade:theme.euiColorPrimary;return external_kbnSharedDeps_React_default.a.createElement(RuleStatusIconStyled,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiAvatar,{color:color,name:"valid"===type?"":name,size:"l"}),"valid"===type?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{type:"check",color:theme.euiColorEmptyShade,size:"l"}):null)},RuleStatusIcon=Object(external_kbnSharedDeps_React_.memo)(RuleStatusIconComponent),AccordionTitleComponent=({name:name,title:title,type:type})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",gutterSize:"m",responsive:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(RuleStatusIcon,{name:name,type:type})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"s",className:"euiAccordionForm__title"},external_kbnSharedDeps_React_default.a.createElement("h6",null,title)))),AccordionTitle=external_kbnSharedDeps_React_default.a.memo(AccordionTitleComponent);var isEqual=__webpack_require__(1025),isEqual_default=__webpack_require__.n(isEqual),timeline_translations=__webpack_require__(262),helpers=__webpack_require__(216),has_ml_admin_permissions=__webpack_require__(378),has_ml_license=__webpack_require__(277),use_ml_capabilities=__webpack_require__(171),external_kbnSharedDeps_LodashFp_=__webpack_require__(7),cjs=__webpack_require__(269),cjs_default=__webpack_require__.n(cjs);const getTimeTypeValue=time=>{const timeObj={unit:"",value:0},filterTimeVal=time.match(/\d+/g),filterTimeType=time.match(/[a-zA-Z]+/g);return Object(external_kbnSharedDeps_LodashFp_.isEmpty)(filterTimeVal)||null==filterTimeVal||isNaN(Number(filterTimeVal[0]))||(timeObj.value=Number(filterTimeVal[0])),!Object(external_kbnSharedDeps_LodashFp_.isEmpty)(filterTimeType)&&null!=filterTimeType&&["s","m","h"].includes(filterTimeType[0])&&(timeObj.unit=filterTimeType[0]),timeObj},stepIsValid=formData=>!(null==formData||!formData.isValid||!formData.data),filterRuleFieldsForType=(fields,type)=>{switch(type){case"machine_learning":const{index:index,queryBar:queryBar,threshold:threshold,threatIndex:threatIndex,threatQueryBar:threatQueryBar,threatMapping:threatMapping,...mlRuleFields}=fields;return mlRuleFields;case"threshold":const{anomalyThreshold:anomalyThreshold,machineLearningJobId:machineLearningJobId,threatIndex:_removedThreatIndex,threatQueryBar:_removedThreatQueryBar,threatMapping:_removedThreatMapping,...thresholdRuleFields}=fields;return thresholdRuleFields;case"threat_match":const{anomalyThreshold:_removedAnomalyThreshold,machineLearningJobId:_removedMachineLearningJobId,threshold:_removedThreshold,...threatMatchRuleFields}=fields;return threatMatchRuleFields;case"query":case"saved_query":case"eql":const{anomalyThreshold:_a,machineLearningJobId:_m,threshold:_t,threatIndex:__removedThreatIndex,threatQueryBar:__removedThreatQueryBar,threatMapping:__removedThreatMapping,...queryRuleFields}=fields;return queryRuleFields}Object(utility_types.a)(type)};function trimThreatsWithNoName(filterable){return filterable.filter(item=>"none"!==item.name)}const filterEmptyThreats=threats=>threats.filter(singleThreat=>"none"!==singleThreat.tactic.name).map(threat=>{var _threat$technique;return{...threat,technique:trimThreatsWithNoName(null!==(_threat$technique=threat.technique)&&void 0!==_threat$technique?_threat$technique:[]).map(technique=>({...technique,subtechnique:null!=technique.subtechnique?trimThreatsWithNoName(technique.subtechnique):[]}))}}),formatDefineStepData=defineStepData=>{var _ruleFields$queryBar,_ruleFields$queryBar2,_ruleFields$queryBar3,_ruleFields$queryBar4,_ruleFields$queryBar5,_ruleFields$queryBar6,_ruleFields$threshold,_ruleFields$threshold2,_parseInt,_ruleFields$threshold3,_ruleFields$threshold4,_ruleFields$threshold5,_ruleFields$queryBar7,_ruleFields$queryBar8,_ruleFields$queryBar9,_ruleFields$queryBar10,_ruleFields$queryBar11,_ruleFields$queryBar12,_ruleFields$threatQue,_ruleFields$threatQue2,_ruleFields$threatQue3,_ruleFields$threatQue4,_ruleFields$threatQue5,_ruleFields$queryBar13,_ruleFields$queryBar14,_ruleFields$queryBar15,_ruleFields$queryBar16,_ruleFields$queryBar17,_ruleFields$queryBar18,_ruleFields$queryBar19;const ruleFields=filterRuleFieldsForType(defineStepData,defineStepData.ruleType),{ruleType:ruleType,timeline:timeline}=ruleFields;var fields;return{...{type:ruleType,...null!=timeline.id&&null!=timeline.title&&{timeline_id:timeline.id,timeline_title:timeline.title}},...(fields=ruleFields,Object(external_kbnSharedDeps_LodashFp_.has)("anomalyThreshold",fields)?{anomaly_threshold:ruleFields.anomalyThreshold,machine_learning_job_id:ruleFields.machineLearningJobId}:(fields=>Object(external_kbnSharedDeps_LodashFp_.has)("threshold",fields))(ruleFields)?{index:ruleFields.index,filters:null===(_ruleFields$queryBar=ruleFields.queryBar)||void 0===_ruleFields$queryBar?void 0:_ruleFields$queryBar.filters,language:null===(_ruleFields$queryBar2=ruleFields.queryBar)||void 0===_ruleFields$queryBar2||null===(_ruleFields$queryBar3=_ruleFields$queryBar2.query)||void 0===_ruleFields$queryBar3?void 0:_ruleFields$queryBar3.language,query:null===(_ruleFields$queryBar4=ruleFields.queryBar)||void 0===_ruleFields$queryBar4||null===(_ruleFields$queryBar5=_ruleFields$queryBar4.query)||void 0===_ruleFields$queryBar5?void 0:_ruleFields$queryBar5.query,saved_id:null===(_ruleFields$queryBar6=ruleFields.queryBar)||void 0===_ruleFields$queryBar6?void 0:_ruleFields$queryBar6.saved_id,..."threshold"===ruleType&&{threshold:{field:null!==(_ruleFields$threshold=null===(_ruleFields$threshold2=ruleFields.threshold)||void 0===_ruleFields$threshold2?void 0:_ruleFields$threshold2.field)&&void 0!==_ruleFields$threshold?_ruleFields$threshold:[],value:null!==(_parseInt=parseInt(null===(_ruleFields$threshold3=ruleFields.threshold)||void 0===_ruleFields$threshold3?void 0:_ruleFields$threshold3.value,10))&&void 0!==_parseInt?_parseInt:0,cardinality:Object(external_kbnSharedDeps_LodashFp_.isEmpty)(null===(_ruleFields$threshold4=ruleFields.threshold.cardinality)||void 0===_ruleFields$threshold4?void 0:_ruleFields$threshold4.field)||null==(null===(_ruleFields$threshold5=ruleFields.threshold.cardinality)||void 0===_ruleFields$threshold5?void 0:_ruleFields$threshold5.value)?[]:[{field:ruleFields.threshold.cardinality.field[0],value:parseInt(ruleFields.threshold.cardinality.value,10)}]}}}:(fields=>Object(external_kbnSharedDeps_LodashFp_.has)("threatIndex",fields))(ruleFields)?{index:ruleFields.index,filters:null===(_ruleFields$queryBar7=ruleFields.queryBar)||void 0===_ruleFields$queryBar7?void 0:_ruleFields$queryBar7.filters,language:null===(_ruleFields$queryBar8=ruleFields.queryBar)||void 0===_ruleFields$queryBar8||null===(_ruleFields$queryBar9=_ruleFields$queryBar8.query)||void 0===_ruleFields$queryBar9?void 0:_ruleFields$queryBar9.language,query:null===(_ruleFields$queryBar10=ruleFields.queryBar)||void 0===_ruleFields$queryBar10||null===(_ruleFields$queryBar11=_ruleFields$queryBar10.query)||void 0===_ruleFields$queryBar11?void 0:_ruleFields$queryBar11.query,saved_id:null===(_ruleFields$queryBar12=ruleFields.queryBar)||void 0===_ruleFields$queryBar12?void 0:_ruleFields$queryBar12.saved_id,threat_index:ruleFields.threatIndex,threat_query:null===(_ruleFields$threatQue=ruleFields.threatQueryBar)||void 0===_ruleFields$threatQue||null===(_ruleFields$threatQue2=_ruleFields$threatQue.query)||void 0===_ruleFields$threatQue2?void 0:_ruleFields$threatQue2.query,threat_filters:null===(_ruleFields$threatQue3=ruleFields.threatQueryBar)||void 0===_ruleFields$threatQue3?void 0:_ruleFields$threatQue3.filters,threat_mapping:ruleFields.threatMapping,threat_language:null===(_ruleFields$threatQue4=ruleFields.threatQueryBar)||void 0===_ruleFields$threatQue4||null===(_ruleFields$threatQue5=_ruleFields$threatQue4.query)||void 0===_ruleFields$threatQue5?void 0:_ruleFields$threatQue5.language}:{index:ruleFields.index,filters:null===(_ruleFields$queryBar13=ruleFields.queryBar)||void 0===_ruleFields$queryBar13?void 0:_ruleFields$queryBar13.filters,language:null===(_ruleFields$queryBar14=ruleFields.queryBar)||void 0===_ruleFields$queryBar14||null===(_ruleFields$queryBar15=_ruleFields$queryBar14.query)||void 0===_ruleFields$queryBar15?void 0:_ruleFields$queryBar15.language,query:null===(_ruleFields$queryBar16=ruleFields.queryBar)||void 0===_ruleFields$queryBar16||null===(_ruleFields$queryBar17=_ruleFields$queryBar16.query)||void 0===_ruleFields$queryBar17?void 0:_ruleFields$queryBar17.query,saved_id:null===(_ruleFields$queryBar18=ruleFields.queryBar)||void 0===_ruleFields$queryBar18?void 0:_ruleFields$queryBar18.saved_id,..."query"===ruleType&&(null===(_ruleFields$queryBar19=ruleFields.queryBar)||void 0===_ruleFields$queryBar19?void 0:_ruleFields$queryBar19.saved_id)&&{type:"saved_query"}})}},formatScheduleStepData=scheduleData=>{const{...formatScheduleData}=scheduleData;if(!Object(external_kbnSharedDeps_LodashFp_.isEmpty)(formatScheduleData.interval)&&!Object(external_kbnSharedDeps_LodashFp_.isEmpty)(formatScheduleData.from)){const{unit:intervalUnit,value:intervalValue}=getTimeTypeValue(formatScheduleData.interval),{unit:fromUnit,value:fromValue}=getTimeTypeValue(formatScheduleData.from),duration=external_kbnSharedDeps_Moment_default.a.duration(intervalValue,intervalUnit);duration.add(fromValue,fromUnit),formatScheduleData.from=`now-${duration.asSeconds()}s`,formatScheduleData.to="now"}return{...formatScheduleData,meta:{from:scheduleData.from}}},formatAboutStepData=(aboutStepData,exceptionsList)=>{const{author:author,falsePositives:falsePositives,references:references,riskScore:riskScore,severity:severity,threat:threat,isAssociatedToEndpointList:isAssociatedToEndpointList,isBuildingBlock:isBuildingBlock,note:note,ruleNameOverride:ruleNameOverride,threatIndicatorPath:threatIndicatorPath,timestampOverride:timestampOverride,...rest}=aboutStepData,detectionExceptionLists=null!=exceptionsList?exceptionsList.filter(list=>"endpoint"!==list.type):[];return{author:author.filter(item=>!Object(external_kbnSharedDeps_LodashFp_.isEmpty)(item)),...isBuildingBlock?{building_block_type:"default"}:{},...isAssociatedToEndpointList?{exceptions_list:[{id:shared_imports.a,list_id:shared_imports.a,namespace_type:"agnostic",type:"endpoint"},...detectionExceptionLists]}:null!=exceptionsList?{exceptions_list:[...detectionExceptionLists]}:{},false_positives:falsePositives.filter(item=>!Object(external_kbnSharedDeps_LodashFp_.isEmpty)(item)),references:references.filter(item=>!Object(external_kbnSharedDeps_LodashFp_.isEmpty)(item)),risk_score:riskScore.value,risk_score_mapping:riskScore.isMappingChecked?riskScore.mapping.filter(m=>null!=m.field&&""!==m.field):[],rule_name_override:""!==ruleNameOverride?ruleNameOverride:void 0,severity:severity.value,severity_mapping:severity.isMappingChecked?severity.mapping.filter(m=>null!=m.field&&""!==m.field&&null!=m.value):[],threat:filterEmptyThreats(threat).map(singleThreat=>({...singleThreat,framework:"MITRE ATT&CK"})),threat_indicator_path:threatIndicatorPath,timestamp_override:""!==timestampOverride?timestampOverride:void 0,...Object(external_kbnSharedDeps_LodashFp_.isEmpty)(note)?{}:{note:note},...rest}},formatActionsStepData=actionsStepData=>{const{actions:actions=[],enabled:enabled,kibanaSiemAppUrl:kibanaSiemAppUrl,throttle:throttle=constants.Z}=actionsStepData;return{actions:actions.map(transformAlertToRuleAction),enabled:enabled,throttle:actions.length?throttle:constants.Z,meta:{kibana_siem_app_url:kibanaSiemAppUrl}}},formatRule=(defineStepData,aboutStepData,scheduleData,actionsData,rule)=>cjs_default.a.all([formatDefineStepData(defineStepData),formatAboutStepData(aboutStepData,null==rule?void 0:rule.exceptions_list),formatScheduleStepData(scheduleData),formatActionsStepData(actionsData)]);var rules_types=__webpack_require__(252),public_=__webpack_require__(81);const FIELD=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.threatMatch.fieldDescription",{defaultMessage:"Field"}),THREAT_FIELD=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.threatMatch.threatFieldDescription",{defaultMessage:"Indicator index field"}),FIELD_PLACEHOLDER=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.threatMatch.fieldPlaceholderDescription",{defaultMessage:"Search"}),MATCHES=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.threatMatch.matchesLabel",{defaultMessage:"MATCHES"}),AND=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.threatMatch.andDescription",{defaultMessage:"AND"}),OR=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.threatMatch.orDescription",{defaultMessage:"OR"}),SEVERITY=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.alerts.severityMapping.severityTitle",{defaultMessage:"Default severity"}),DEFAULT_SEVERITY=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.alerts.severityMapping.defaultSeverityTitle",{defaultMessage:"Severity"}),SOURCE_FIELD=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.alerts.severityMapping.sourceFieldTitle",{defaultMessage:"Source field"}),SOURCE_VALUE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.alerts.severityMapping.sourceValueTitle",{defaultMessage:"Source value"}),SEVERITY_MAPPING=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.alerts.severityMapping.severityMappingTitle",{defaultMessage:"Severity override"}),SEVERITY_DESCRIPTION=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.alerts.severityMapping.defaultDescriptionLabel",{defaultMessage:"Select a severity level for all alerts generated by this rule."}),SEVERITY_MAPPING_DESCRIPTION=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.alerts.severityMapping.mappingDescriptionLabel",{defaultMessage:"Use source event values to override the default severity."}),SEVERITY_MAPPING_DETAILS=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.alerts.severityMapping.mappingDetailsLabel",{defaultMessage:"For multiple matches the highest severity match will apply. If no match is found, the default severity will be used."}),RISK_SCORE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.riskScoreTitle",{defaultMessage:"Risk score"}),DEFAULT_RISK_SCORE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.defaultRiskScoreTitle",{defaultMessage:"Default risk score"}),RISK_SCORE_FIELD=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.riskScoreFieldTitle",{defaultMessage:"signal.rule.risk_score"}),translations_SOURCE_FIELD=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.sourceFieldTitle",{defaultMessage:"Source field"}),RISK_SCORE_MAPPING=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.riskScoreMappingTitle",{defaultMessage:"Risk score override"}),RISK_SCORE_DESCRIPTION=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.defaultDescriptionLabel",{defaultMessage:"Select a risk score for all alerts generated by this rule."}),RISK_SCORE_MAPPING_DESCRIPTION=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.mappingDescriptionLabel",{defaultMessage:"Use a source event value to override the default risk score."}),RISK_SCORE_MAPPING_DETAILS=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.mappingDetailsLabel",{defaultMessage:"If value is out of bounds, or field is not present, the default risk score will be used."}),tacticsOptions=[{id:"TA0009",name:"Collection",reference:"https://attack.mitre.org/tactics/TA0009",text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.collectionDescription",{defaultMessage:"Collection (TA0009)"}),value:"collection"},{id:"TA0011",name:"Command and Control",reference:"https://attack.mitre.org/tactics/TA0011",text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.commandAndControlDescription",{defaultMessage:"Command and Control (TA0011)"}),value:"commandAndControl"},{id:"TA0006",name:"Credential Access",reference:"https://attack.mitre.org/tactics/TA0006",text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.credentialAccessDescription",{defaultMessage:"Credential Access (TA0006)"}),value:"credentialAccess"},{id:"TA0005",name:"Defense Evasion",reference:"https://attack.mitre.org/tactics/TA0005",text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.defenseEvasionDescription",{defaultMessage:"Defense Evasion (TA0005)"}),value:"defenseEvasion"},{id:"TA0007",name:"Discovery",reference:"https://attack.mitre.org/tactics/TA0007",text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.discoveryDescription",{defaultMessage:"Discovery (TA0007)"}),value:"discovery"},{id:"TA0002",name:"Execution",reference:"https://attack.mitre.org/tactics/TA0002",text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.executionDescription",{defaultMessage:"Execution (TA0002)"}),value:"execution"},{id:"TA0010",name:"Exfiltration",reference:"https://attack.mitre.org/tactics/TA0010",text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.exfiltrationDescription",{defaultMessage:"Exfiltration (TA0010)"}),value:"exfiltration"},{id:"TA0040",name:"Impact",reference:"https://attack.mitre.org/tactics/TA0040",text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.impactDescription",{defaultMessage:"Impact (TA0040)"}),value:"impact"},{id:"TA0001",name:"Initial Access",reference:"https://attack.mitre.org/tactics/TA0001",text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.initialAccessDescription",{defaultMessage:"Initial Access (TA0001)"}),value:"initialAccess"},{id:"TA0008",name:"Lateral Movement",reference:"https://attack.mitre.org/tactics/TA0008",text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.lateralMovementDescription",{defaultMessage:"Lateral Movement (TA0008)"}),value:"lateralMovement"},{id:"TA0003",name:"Persistence",reference:"https://attack.mitre.org/tactics/TA0003",text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.persistenceDescription",{defaultMessage:"Persistence (TA0003)"}),value:"persistence"},{id:"TA0004",name:"Privilege Escalation",reference:"https://attack.mitre.org/tactics/TA0004",text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.privilegeEscalationDescription",{defaultMessage:"Privilege Escalation (TA0004)"}),value:"privilegeEscalation"},{id:"TA0043",name:"Reconnaissance",reference:"https://attack.mitre.org/tactics/TA0043",text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.reconnaissanceDescription",{defaultMessage:"Reconnaissance (TA0043)"}),value:"reconnaissance"},{id:"TA0042",name:"Resource Development",reference:"https://attack.mitre.org/tactics/TA0042",text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTactics.resourceDevelopmentDescription",{defaultMessage:"Resource Development (TA0042)"}),value:"resourceDevelopment"}],techniquesOptions=[{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.abuseElevationControlMechanismDescription",{defaultMessage:"Abuse Elevation Control Mechanism (T1548)"}),id:"T1548",name:"Abuse Elevation Control Mechanism",reference:"https://attack.mitre.org/techniques/T1548",tactics:"privilege-escalation,defense-evasion",value:"abuseElevationControlMechanism"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.accessTokenManipulationDescription",{defaultMessage:"Access Token Manipulation (T1134)"}),id:"T1134",name:"Access Token Manipulation",reference:"https://attack.mitre.org/techniques/T1134",tactics:"defense-evasion,privilege-escalation",value:"accessTokenManipulation"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.accountAccessRemovalDescription",{defaultMessage:"Account Access Removal (T1531)"}),id:"T1531",name:"Account Access Removal",reference:"https://attack.mitre.org/techniques/T1531",tactics:"impact",value:"accountAccessRemoval"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.accountDiscoveryDescription",{defaultMessage:"Account Discovery (T1087)"}),id:"T1087",name:"Account Discovery",reference:"https://attack.mitre.org/techniques/T1087",tactics:"discovery",value:"accountDiscovery"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.accountManipulationDescription",{defaultMessage:"Account Manipulation (T1098)"}),id:"T1098",name:"Account Manipulation",reference:"https://attack.mitre.org/techniques/T1098",tactics:"persistence",value:"accountManipulation"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.acquireInfrastructureDescription",{defaultMessage:"Acquire Infrastructure (T1583)"}),id:"T1583",name:"Acquire Infrastructure",reference:"https://attack.mitre.org/techniques/T1583",tactics:"resource-development",value:"acquireInfrastructure"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.activeScanningDescription",{defaultMessage:"Active Scanning (T1595)"}),id:"T1595",name:"Active Scanning",reference:"https://attack.mitre.org/techniques/T1595",tactics:"reconnaissance",value:"activeScanning"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.applicationLayerProtocolDescription",{defaultMessage:"Application Layer Protocol (T1071)"}),id:"T1071",name:"Application Layer Protocol",reference:"https://attack.mitre.org/techniques/T1071",tactics:"command-and-control",value:"applicationLayerProtocol"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.applicationWindowDiscoveryDescription",{defaultMessage:"Application Window Discovery (T1010)"}),id:"T1010",name:"Application Window Discovery",reference:"https://attack.mitre.org/techniques/T1010",tactics:"discovery",value:"applicationWindowDiscovery"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.archiveCollectedDataDescription",{defaultMessage:"Archive Collected Data (T1560)"}),id:"T1560",name:"Archive Collected Data",reference:"https://attack.mitre.org/techniques/T1560",tactics:"collection",value:"archiveCollectedData"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.audioCaptureDescription",{defaultMessage:"Audio Capture (T1123)"}),id:"T1123",name:"Audio Capture",reference:"https://attack.mitre.org/techniques/T1123",tactics:"collection",value:"audioCapture"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.automatedCollectionDescription",{defaultMessage:"Automated Collection (T1119)"}),id:"T1119",name:"Automated Collection",reference:"https://attack.mitre.org/techniques/T1119",tactics:"collection",value:"automatedCollection"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.automatedExfiltrationDescription",{defaultMessage:"Automated Exfiltration (T1020)"}),id:"T1020",name:"Automated Exfiltration",reference:"https://attack.mitre.org/techniques/T1020",tactics:"exfiltration",value:"automatedExfiltration"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.bitsJobsDescription",{defaultMessage:"BITS Jobs (T1197)"}),id:"T1197",name:"BITS Jobs",reference:"https://attack.mitre.org/techniques/T1197",tactics:"defense-evasion,persistence",value:"bitsJobs"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.bootOrLogonAutostartExecutionDescription",{defaultMessage:"Boot or Logon Autostart Execution (T1547)"}),id:"T1547",name:"Boot or Logon Autostart Execution",reference:"https://attack.mitre.org/techniques/T1547",tactics:"persistence,privilege-escalation",value:"bootOrLogonAutostartExecution"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.bootOrLogonInitializationScriptsDescription",{defaultMessage:"Boot or Logon Initialization Scripts (T1037)"}),id:"T1037",name:"Boot or Logon Initialization Scripts",reference:"https://attack.mitre.org/techniques/T1037",tactics:"persistence,privilege-escalation",value:"bootOrLogonInitializationScripts"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.browserBookmarkDiscoveryDescription",{defaultMessage:"Browser Bookmark Discovery (T1217)"}),id:"T1217",name:"Browser Bookmark Discovery",reference:"https://attack.mitre.org/techniques/T1217",tactics:"discovery",value:"browserBookmarkDiscovery"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.browserExtensionsDescription",{defaultMessage:"Browser Extensions (T1176)"}),id:"T1176",name:"Browser Extensions",reference:"https://attack.mitre.org/techniques/T1176",tactics:"persistence",value:"browserExtensions"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.bruteForceDescription",{defaultMessage:"Brute Force (T1110)"}),id:"T1110",name:"Brute Force",reference:"https://attack.mitre.org/techniques/T1110",tactics:"credential-access",value:"bruteForce"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.clipboardDataDescription",{defaultMessage:"Clipboard Data (T1115)"}),id:"T1115",name:"Clipboard Data",reference:"https://attack.mitre.org/techniques/T1115",tactics:"collection",value:"clipboardData"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.cloudInfrastructureDiscoveryDescription",{defaultMessage:"Cloud Infrastructure Discovery (T1580)"}),id:"T1580",name:"Cloud Infrastructure Discovery",reference:"https://attack.mitre.org/techniques/T1580",tactics:"discovery",value:"cloudInfrastructureDiscovery"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.cloudServiceDashboardDescription",{defaultMessage:"Cloud Service Dashboard (T1538)"}),id:"T1538",name:"Cloud Service Dashboard",reference:"https://attack.mitre.org/techniques/T1538",tactics:"discovery",value:"cloudServiceDashboard"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.cloudServiceDiscoveryDescription",{defaultMessage:"Cloud Service Discovery (T1526)"}),id:"T1526",name:"Cloud Service Discovery",reference:"https://attack.mitre.org/techniques/T1526",tactics:"discovery",value:"cloudServiceDiscovery"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.commandAndScriptingInterpreterDescription",{defaultMessage:"Command and Scripting Interpreter (T1059)"}),id:"T1059",name:"Command and Scripting Interpreter",reference:"https://attack.mitre.org/techniques/T1059",tactics:"execution",value:"commandAndScriptingInterpreter"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.commonlyUsedPortDescription",{defaultMessage:"Commonly Used Port (T1043)"}),id:"T1043",name:"Commonly Used Port",reference:"https://attack.mitre.org/techniques/T1043",tactics:"command-and-control",value:"commonlyUsedPort"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.communicationThroughRemovableMediaDescription",{defaultMessage:"Communication Through Removable Media (T1092)"}),id:"T1092",name:"Communication Through Removable Media",reference:"https://attack.mitre.org/techniques/T1092",tactics:"command-and-control",value:"communicationThroughRemovableMedia"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.componentObjectModelAndDistributedComDescription",{defaultMessage:"Component Object Model and Distributed COM (T1175)"}),id:"T1175",name:"Component Object Model and Distributed COM",reference:"https://attack.mitre.org/techniques/T1175",tactics:"lateral-movement,execution",value:"componentObjectModelAndDistributedCom"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.compromiseAccountsDescription",{defaultMessage:"Compromise Accounts (T1586)"}),id:"T1586",name:"Compromise Accounts",reference:"https://attack.mitre.org/techniques/T1586",tactics:"resource-development",value:"compromiseAccounts"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.compromiseClientSoftwareBinaryDescription",{defaultMessage:"Compromise Client Software Binary (T1554)"}),id:"T1554",name:"Compromise Client Software Binary",reference:"https://attack.mitre.org/techniques/T1554",tactics:"persistence",value:"compromiseClientSoftwareBinary"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.compromiseInfrastructureDescription",{defaultMessage:"Compromise Infrastructure (T1584)"}),id:"T1584",name:"Compromise Infrastructure",reference:"https://attack.mitre.org/techniques/T1584",tactics:"resource-development",value:"compromiseInfrastructure"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.createAccountDescription",{defaultMessage:"Create Account (T1136)"}),id:"T1136",name:"Create Account",reference:"https://attack.mitre.org/techniques/T1136",tactics:"persistence",value:"createAccount"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.createOrModifySystemProcessDescription",{defaultMessage:"Create or Modify System Process (T1543)"}),id:"T1543",name:"Create or Modify System Process",reference:"https://attack.mitre.org/techniques/T1543",tactics:"persistence,privilege-escalation",value:"createOrModifySystemProcess"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.credentialsFromPasswordStoresDescription",{defaultMessage:"Credentials from Password Stores (T1555)"}),id:"T1555",name:"Credentials from Password Stores",reference:"https://attack.mitre.org/techniques/T1555",tactics:"credential-access",value:"credentialsFromPasswordStores"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataDestructionDescription",{defaultMessage:"Data Destruction (T1485)"}),id:"T1485",name:"Data Destruction",reference:"https://attack.mitre.org/techniques/T1485",tactics:"impact",value:"dataDestruction"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataEncodingDescription",{defaultMessage:"Data Encoding (T1132)"}),id:"T1132",name:"Data Encoding",reference:"https://attack.mitre.org/techniques/T1132",tactics:"command-and-control",value:"dataEncoding"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataEncryptedForImpactDescription",{defaultMessage:"Data Encrypted for Impact (T1486)"}),id:"T1486",name:"Data Encrypted for Impact",reference:"https://attack.mitre.org/techniques/T1486",tactics:"impact",value:"dataEncryptedForImpact"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataManipulationDescription",{defaultMessage:"Data Manipulation (T1565)"}),id:"T1565",name:"Data Manipulation",reference:"https://attack.mitre.org/techniques/T1565",tactics:"impact",value:"dataManipulation"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataObfuscationDescription",{defaultMessage:"Data Obfuscation (T1001)"}),id:"T1001",name:"Data Obfuscation",reference:"https://attack.mitre.org/techniques/T1001",tactics:"command-and-control",value:"dataObfuscation"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataStagedDescription",{defaultMessage:"Data Staged (T1074)"}),id:"T1074",name:"Data Staged",reference:"https://attack.mitre.org/techniques/T1074",tactics:"collection",value:"dataStaged"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataTransferSizeLimitsDescription",{defaultMessage:"Data Transfer Size Limits (T1030)"}),id:"T1030",name:"Data Transfer Size Limits",reference:"https://attack.mitre.org/techniques/T1030",tactics:"exfiltration",value:"dataTransferSizeLimits"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataFromCloudStorageObjectDescription",{defaultMessage:"Data from Cloud Storage Object (T1530)"}),id:"T1530",name:"Data from Cloud Storage Object",reference:"https://attack.mitre.org/techniques/T1530",tactics:"collection",value:"dataFromCloudStorageObject"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataFromConfigurationRepositoryDescription",{defaultMessage:"Data from Configuration Repository (T1602)"}),id:"T1602",name:"Data from Configuration Repository",reference:"https://attack.mitre.org/techniques/T1602",tactics:"collection",value:"dataFromConfigurationRepository"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataFromInformationRepositoriesDescription",{defaultMessage:"Data from Information Repositories (T1213)"}),id:"T1213",name:"Data from Information Repositories",reference:"https://attack.mitre.org/techniques/T1213",tactics:"collection",value:"dataFromInformationRepositories"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataFromLocalSystemDescription",{defaultMessage:"Data from Local System (T1005)"}),id:"T1005",name:"Data from Local System",reference:"https://attack.mitre.org/techniques/T1005",tactics:"collection",value:"dataFromLocalSystem"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataFromNetworkSharedDriveDescription",{defaultMessage:"Data from Network Shared Drive (T1039)"}),id:"T1039",name:"Data from Network Shared Drive",reference:"https://attack.mitre.org/techniques/T1039",tactics:"collection",value:"dataFromNetworkSharedDrive"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dataFromRemovableMediaDescription",{defaultMessage:"Data from Removable Media (T1025)"}),id:"T1025",name:"Data from Removable Media",reference:"https://attack.mitre.org/techniques/T1025",tactics:"collection",value:"dataFromRemovableMedia"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.defacementDescription",{defaultMessage:"Defacement (T1491)"}),id:"T1491",name:"Defacement",reference:"https://attack.mitre.org/techniques/T1491",tactics:"impact",value:"defacement"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.deobfuscateDecodeFilesOrInformationDescription",{defaultMessage:"Deobfuscate/Decode Files or Information (T1140)"}),id:"T1140",name:"Deobfuscate/Decode Files or Information",reference:"https://attack.mitre.org/techniques/T1140",tactics:"defense-evasion",value:"deobfuscateDecodeFilesOrInformation"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.developCapabilitiesDescription",{defaultMessage:"Develop Capabilities (T1587)"}),id:"T1587",name:"Develop Capabilities",reference:"https://attack.mitre.org/techniques/T1587",tactics:"resource-development",value:"developCapabilities"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.directVolumeAccessDescription",{defaultMessage:"Direct Volume Access (T1006)"}),id:"T1006",name:"Direct Volume Access",reference:"https://attack.mitre.org/techniques/T1006",tactics:"defense-evasion",value:"directVolumeAccess"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.diskWipeDescription",{defaultMessage:"Disk Wipe (T1561)"}),id:"T1561",name:"Disk Wipe",reference:"https://attack.mitre.org/techniques/T1561",tactics:"impact",value:"diskWipe"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.domainTrustDiscoveryDescription",{defaultMessage:"Domain Trust Discovery (T1482)"}),id:"T1482",name:"Domain Trust Discovery",reference:"https://attack.mitre.org/techniques/T1482",tactics:"discovery",value:"domainTrustDiscovery"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.driveByCompromiseDescription",{defaultMessage:"Drive-by Compromise (T1189)"}),id:"T1189",name:"Drive-by Compromise",reference:"https://attack.mitre.org/techniques/T1189",tactics:"initial-access",value:"driveByCompromise"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.dynamicResolutionDescription",{defaultMessage:"Dynamic Resolution (T1568)"}),id:"T1568",name:"Dynamic Resolution",reference:"https://attack.mitre.org/techniques/T1568",tactics:"command-and-control",value:"dynamicResolution"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.emailCollectionDescription",{defaultMessage:"Email Collection (T1114)"}),id:"T1114",name:"Email Collection",reference:"https://attack.mitre.org/techniques/T1114",tactics:"collection",value:"emailCollection"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.encryptedChannelDescription",{defaultMessage:"Encrypted Channel (T1573)"}),id:"T1573",name:"Encrypted Channel",reference:"https://attack.mitre.org/techniques/T1573",tactics:"command-and-control",value:"encryptedChannel"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.endpointDenialOfServiceDescription",{defaultMessage:"Endpoint Denial of Service (T1499)"}),id:"T1499",name:"Endpoint Denial of Service",reference:"https://attack.mitre.org/techniques/T1499",tactics:"impact",value:"endpointDenialOfService"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.establishAccountsDescription",{defaultMessage:"Establish Accounts (T1585)"}),id:"T1585",name:"Establish Accounts",reference:"https://attack.mitre.org/techniques/T1585",tactics:"resource-development",value:"establishAccounts"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.eventTriggeredExecutionDescription",{defaultMessage:"Event Triggered Execution (T1546)"}),id:"T1546",name:"Event Triggered Execution",reference:"https://attack.mitre.org/techniques/T1546",tactics:"privilege-escalation,persistence",value:"eventTriggeredExecution"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.executionGuardrailsDescription",{defaultMessage:"Execution Guardrails (T1480)"}),id:"T1480",name:"Execution Guardrails",reference:"https://attack.mitre.org/techniques/T1480",tactics:"defense-evasion",value:"executionGuardrails"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exfiltrationOverAlternativeProtocolDescription",{defaultMessage:"Exfiltration Over Alternative Protocol (T1048)"}),id:"T1048",name:"Exfiltration Over Alternative Protocol",reference:"https://attack.mitre.org/techniques/T1048",tactics:"exfiltration",value:"exfiltrationOverAlternativeProtocol"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exfiltrationOverC2ChannelDescription",{defaultMessage:"Exfiltration Over C2 Channel (T1041)"}),id:"T1041",name:"Exfiltration Over C2 Channel",reference:"https://attack.mitre.org/techniques/T1041",tactics:"exfiltration",value:"exfiltrationOverC2Channel"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exfiltrationOverOtherNetworkMediumDescription",{defaultMessage:"Exfiltration Over Other Network Medium (T1011)"}),id:"T1011",name:"Exfiltration Over Other Network Medium",reference:"https://attack.mitre.org/techniques/T1011",tactics:"exfiltration",value:"exfiltrationOverOtherNetworkMedium"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exfiltrationOverPhysicalMediumDescription",{defaultMessage:"Exfiltration Over Physical Medium (T1052)"}),id:"T1052",name:"Exfiltration Over Physical Medium",reference:"https://attack.mitre.org/techniques/T1052",tactics:"exfiltration",value:"exfiltrationOverPhysicalMedium"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exfiltrationOverWebServiceDescription",{defaultMessage:"Exfiltration Over Web Service (T1567)"}),id:"T1567",name:"Exfiltration Over Web Service",reference:"https://attack.mitre.org/techniques/T1567",tactics:"exfiltration",value:"exfiltrationOverWebService"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exploitPublicFacingApplicationDescription",{defaultMessage:"Exploit Public-Facing Application (T1190)"}),id:"T1190",name:"Exploit Public-Facing Application",reference:"https://attack.mitre.org/techniques/T1190",tactics:"initial-access",value:"exploitPublicFacingApplication"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exploitationForClientExecutionDescription",{defaultMessage:"Exploitation for Client Execution (T1203)"}),id:"T1203",name:"Exploitation for Client Execution",reference:"https://attack.mitre.org/techniques/T1203",tactics:"execution",value:"exploitationForClientExecution"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exploitationForCredentialAccessDescription",{defaultMessage:"Exploitation for Credential Access (T1212)"}),id:"T1212",name:"Exploitation for Credential Access",reference:"https://attack.mitre.org/techniques/T1212",tactics:"credential-access",value:"exploitationForCredentialAccess"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exploitationForDefenseEvasionDescription",{defaultMessage:"Exploitation for Defense Evasion (T1211)"}),id:"T1211",name:"Exploitation for Defense Evasion",reference:"https://attack.mitre.org/techniques/T1211",tactics:"defense-evasion",value:"exploitationForDefenseEvasion"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exploitationForPrivilegeEscalationDescription",{defaultMessage:"Exploitation for Privilege Escalation (T1068)"}),id:"T1068",name:"Exploitation for Privilege Escalation",reference:"https://attack.mitre.org/techniques/T1068",tactics:"privilege-escalation",value:"exploitationForPrivilegeEscalation"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.exploitationOfRemoteServicesDescription",{defaultMessage:"Exploitation of Remote Services (T1210)"}),id:"T1210",name:"Exploitation of Remote Services",reference:"https://attack.mitre.org/techniques/T1210",tactics:"lateral-movement",value:"exploitationOfRemoteServices"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.externalRemoteServicesDescription",{defaultMessage:"External Remote Services (T1133)"}),id:"T1133",name:"External Remote Services",reference:"https://attack.mitre.org/techniques/T1133",tactics:"persistence,initial-access",value:"externalRemoteServices"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.fallbackChannelsDescription",{defaultMessage:"Fallback Channels (T1008)"}),id:"T1008",name:"Fallback Channels",reference:"https://attack.mitre.org/techniques/T1008",tactics:"command-and-control",value:"fallbackChannels"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.fileAndDirectoryDiscoveryDescription",{defaultMessage:"File and Directory Discovery (T1083)"}),id:"T1083",name:"File and Directory Discovery",reference:"https://attack.mitre.org/techniques/T1083",tactics:"discovery",value:"fileAndDirectoryDiscovery"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.fileAndDirectoryPermissionsModificationDescription",{defaultMessage:"File and Directory Permissions Modification (T1222)"}),id:"T1222",name:"File and Directory Permissions Modification",reference:"https://attack.mitre.org/techniques/T1222",tactics:"defense-evasion",value:"fileAndDirectoryPermissionsModification"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.firmwareCorruptionDescription",{defaultMessage:"Firmware Corruption (T1495)"}),id:"T1495",name:"Firmware Corruption",reference:"https://attack.mitre.org/techniques/T1495",tactics:"impact",value:"firmwareCorruption"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.forcedAuthenticationDescription",{defaultMessage:"Forced Authentication (T1187)"}),id:"T1187",name:"Forced Authentication",reference:"https://attack.mitre.org/techniques/T1187",tactics:"credential-access",value:"forcedAuthentication"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.gatherVictimHostInformationDescription",{defaultMessage:"Gather Victim Host Information (T1592)"}),id:"T1592",name:"Gather Victim Host Information",reference:"https://attack.mitre.org/techniques/T1592",tactics:"reconnaissance",value:"gatherVictimHostInformation"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.gatherVictimIdentityInformationDescription",{defaultMessage:"Gather Victim Identity Information (T1589)"}),id:"T1589",name:"Gather Victim Identity Information",reference:"https://attack.mitre.org/techniques/T1589",tactics:"reconnaissance",value:"gatherVictimIdentityInformation"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.gatherVictimNetworkInformationDescription",{defaultMessage:"Gather Victim Network Information (T1590)"}),id:"T1590",name:"Gather Victim Network Information",reference:"https://attack.mitre.org/techniques/T1590",tactics:"reconnaissance",value:"gatherVictimNetworkInformation"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.gatherVictimOrgInformationDescription",{defaultMessage:"Gather Victim Org Information (T1591)"}),id:"T1591",name:"Gather Victim Org Information",reference:"https://attack.mitre.org/techniques/T1591",tactics:"reconnaissance",value:"gatherVictimOrgInformation"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.graphicalUserInterfaceDescription",{defaultMessage:"Graphical User Interface (T1061)"}),id:"T1061",name:"Graphical User Interface",reference:"https://attack.mitre.org/techniques/T1061",tactics:"execution",value:"graphicalUserInterface"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.hardwareAdditionsDescription",{defaultMessage:"Hardware Additions (T1200)"}),id:"T1200",name:"Hardware Additions",reference:"https://attack.mitre.org/techniques/T1200",tactics:"initial-access",value:"hardwareAdditions"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.hideArtifactsDescription",{defaultMessage:"Hide Artifacts (T1564)"}),id:"T1564",name:"Hide Artifacts",reference:"https://attack.mitre.org/techniques/T1564",tactics:"defense-evasion",value:"hideArtifacts"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.hijackExecutionFlowDescription",{defaultMessage:"Hijack Execution Flow (T1574)"}),id:"T1574",name:"Hijack Execution Flow",reference:"https://attack.mitre.org/techniques/T1574",tactics:"persistence,privilege-escalation,defense-evasion",value:"hijackExecutionFlow"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.hypervisorDescription",{defaultMessage:"Hypervisor (T1062)"}),id:"T1062",name:"Hypervisor",reference:"https://attack.mitre.org/techniques/T1062",tactics:"persistence",value:"hypervisor"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.impairDefensesDescription",{defaultMessage:"Impair Defenses (T1562)"}),id:"T1562",name:"Impair Defenses",reference:"https://attack.mitre.org/techniques/T1562",tactics:"defense-evasion",value:"impairDefenses"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.implantContainerImageDescription",{defaultMessage:"Implant Container Image (T1525)"}),id:"T1525",name:"Implant Container Image",reference:"https://attack.mitre.org/techniques/T1525",tactics:"persistence",value:"implantContainerImage"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.indicatorRemovalOnHostDescription",{defaultMessage:"Indicator Removal on Host (T1070)"}),id:"T1070",name:"Indicator Removal on Host",reference:"https://attack.mitre.org/techniques/T1070",tactics:"defense-evasion",value:"indicatorRemovalOnHost"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.indirectCommandExecutionDescription",{defaultMessage:"Indirect Command Execution (T1202)"}),id:"T1202",name:"Indirect Command Execution",reference:"https://attack.mitre.org/techniques/T1202",tactics:"defense-evasion",value:"indirectCommandExecution"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.ingressToolTransferDescription",{defaultMessage:"Ingress Tool Transfer (T1105)"}),id:"T1105",name:"Ingress Tool Transfer",reference:"https://attack.mitre.org/techniques/T1105",tactics:"command-and-control",value:"ingressToolTransfer"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.inhibitSystemRecoveryDescription",{defaultMessage:"Inhibit System Recovery (T1490)"}),id:"T1490",name:"Inhibit System Recovery",reference:"https://attack.mitre.org/techniques/T1490",tactics:"impact",value:"inhibitSystemRecovery"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.inputCaptureDescription",{defaultMessage:"Input Capture (T1056)"}),id:"T1056",name:"Input Capture",reference:"https://attack.mitre.org/techniques/T1056",tactics:"collection,credential-access",value:"inputCapture"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.interProcessCommunicationDescription",{defaultMessage:"Inter-Process Communication (T1559)"}),id:"T1559",name:"Inter-Process Communication",reference:"https://attack.mitre.org/techniques/T1559",tactics:"execution",value:"interProcessCommunication"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.internalSpearphishingDescription",{defaultMessage:"Internal Spearphishing (T1534)"}),id:"T1534",name:"Internal Spearphishing",reference:"https://attack.mitre.org/techniques/T1534",tactics:"lateral-movement",value:"internalSpearphishing"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.lcMainHijackingDescription",{defaultMessage:"LC_MAIN Hijacking (T1149)"}),id:"T1149",name:"LC_MAIN Hijacking",reference:"https://attack.mitre.org/techniques/T1149",tactics:"defense-evasion",value:"lcMainHijacking"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.lateralToolTransferDescription",{defaultMessage:"Lateral Tool Transfer (T1570)"}),id:"T1570",name:"Lateral Tool Transfer",reference:"https://attack.mitre.org/techniques/T1570",tactics:"lateral-movement",value:"lateralToolTransfer"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.manInTheBrowserDescription",{defaultMessage:"Man in the Browser (T1185)"}),id:"T1185",name:"Man in the Browser",reference:"https://attack.mitre.org/techniques/T1185",tactics:"collection",value:"manInTheBrowser"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.manInTheMiddleDescription",{defaultMessage:"Man-in-the-Middle (T1557)"}),id:"T1557",name:"Man-in-the-Middle",reference:"https://attack.mitre.org/techniques/T1557",tactics:"credential-access,collection",value:"manInTheMiddle"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.masqueradingDescription",{defaultMessage:"Masquerading (T1036)"}),id:"T1036",name:"Masquerading",reference:"https://attack.mitre.org/techniques/T1036",tactics:"defense-evasion",value:"masquerading"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.modifyAuthenticationProcessDescription",{defaultMessage:"Modify Authentication Process (T1556)"}),id:"T1556",name:"Modify Authentication Process",reference:"https://attack.mitre.org/techniques/T1556",tactics:"credential-access,defense-evasion",value:"modifyAuthenticationProcess"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.modifyCloudComputeInfrastructureDescription",{defaultMessage:"Modify Cloud Compute Infrastructure (T1578)"}),id:"T1578",name:"Modify Cloud Compute Infrastructure",reference:"https://attack.mitre.org/techniques/T1578",tactics:"defense-evasion",value:"modifyCloudComputeInfrastructure"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.modifyRegistryDescription",{defaultMessage:"Modify Registry (T1112)"}),id:"T1112",name:"Modify Registry",reference:"https://attack.mitre.org/techniques/T1112",tactics:"defense-evasion",value:"modifyRegistry"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.modifySystemImageDescription",{defaultMessage:"Modify System Image (T1601)"}),id:"T1601",name:"Modify System Image",reference:"https://attack.mitre.org/techniques/T1601",tactics:"defense-evasion",value:"modifySystemImage"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.multiStageChannelsDescription",{defaultMessage:"Multi-Stage Channels (T1104)"}),id:"T1104",name:"Multi-Stage Channels",reference:"https://attack.mitre.org/techniques/T1104",tactics:"command-and-control",value:"multiStageChannels"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.multibandCommunicationDescription",{defaultMessage:"Multiband Communication (T1026)"}),id:"T1026",name:"Multiband Communication",reference:"https://attack.mitre.org/techniques/T1026",tactics:"command-and-control",value:"multibandCommunication"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.nativeApiDescription",{defaultMessage:"Native API (T1106)"}),id:"T1106",name:"Native API",reference:"https://attack.mitre.org/techniques/T1106",tactics:"execution",value:"nativeApi"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.networkBoundaryBridgingDescription",{defaultMessage:"Network Boundary Bridging (T1599)"}),id:"T1599",name:"Network Boundary Bridging",reference:"https://attack.mitre.org/techniques/T1599",tactics:"defense-evasion",value:"networkBoundaryBridging"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.networkDenialOfServiceDescription",{defaultMessage:"Network Denial of Service (T1498)"}),id:"T1498",name:"Network Denial of Service",reference:"https://attack.mitre.org/techniques/T1498",tactics:"impact",value:"networkDenialOfService"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.networkServiceScanningDescription",{defaultMessage:"Network Service Scanning (T1046)"}),id:"T1046",name:"Network Service Scanning",reference:"https://attack.mitre.org/techniques/T1046",tactics:"discovery",value:"networkServiceScanning"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.networkShareDiscoveryDescription",{defaultMessage:"Network Share Discovery (T1135)"}),id:"T1135",name:"Network Share Discovery",reference:"https://attack.mitre.org/techniques/T1135",tactics:"discovery",value:"networkShareDiscovery"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.networkSniffingDescription",{defaultMessage:"Network Sniffing (T1040)"}),id:"T1040",name:"Network Sniffing",reference:"https://attack.mitre.org/techniques/T1040",tactics:"credential-access,discovery",value:"networkSniffing"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.nonApplicationLayerProtocolDescription",{defaultMessage:"Non-Application Layer Protocol (T1095)"}),id:"T1095",name:"Non-Application Layer Protocol",reference:"https://attack.mitre.org/techniques/T1095",tactics:"command-and-control",value:"nonApplicationLayerProtocol"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.nonStandardPortDescription",{defaultMessage:"Non-Standard Port (T1571)"}),id:"T1571",name:"Non-Standard Port",reference:"https://attack.mitre.org/techniques/T1571",tactics:"command-and-control",value:"nonStandardPort"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.osCredentialDumpingDescription",{defaultMessage:"OS Credential Dumping (T1003)"}),id:"T1003",name:"OS Credential Dumping",reference:"https://attack.mitre.org/techniques/T1003",tactics:"credential-access",value:"osCredentialDumping"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.obfuscatedFilesOrInformationDescription",{defaultMessage:"Obfuscated Files or Information (T1027)"}),id:"T1027",name:"Obfuscated Files or Information",reference:"https://attack.mitre.org/techniques/T1027",tactics:"defense-evasion",value:"obfuscatedFilesOrInformation"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.obtainCapabilitiesDescription",{defaultMessage:"Obtain Capabilities (T1588)"}),id:"T1588",name:"Obtain Capabilities",reference:"https://attack.mitre.org/techniques/T1588",tactics:"resource-development",value:"obtainCapabilities"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.officeApplicationStartupDescription",{defaultMessage:"Office Application Startup (T1137)"}),id:"T1137",name:"Office Application Startup",reference:"https://attack.mitre.org/techniques/T1137",tactics:"persistence",value:"officeApplicationStartup"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.passwordPolicyDiscoveryDescription",{defaultMessage:"Password Policy Discovery (T1201)"}),id:"T1201",name:"Password Policy Discovery",reference:"https://attack.mitre.org/techniques/T1201",tactics:"discovery",value:"passwordPolicyDiscovery"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.pathInterceptionDescription",{defaultMessage:"Path Interception (T1034)"}),id:"T1034",name:"Path Interception",reference:"https://attack.mitre.org/techniques/T1034",tactics:"persistence,privilege-escalation",value:"pathInterception"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.peripheralDeviceDiscoveryDescription",{defaultMessage:"Peripheral Device Discovery (T1120)"}),id:"T1120",name:"Peripheral Device Discovery",reference:"https://attack.mitre.org/techniques/T1120",tactics:"discovery",value:"peripheralDeviceDiscovery"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.permissionGroupsDiscoveryDescription",{defaultMessage:"Permission Groups Discovery (T1069)"}),id:"T1069",name:"Permission Groups Discovery",reference:"https://attack.mitre.org/techniques/T1069",tactics:"discovery",value:"permissionGroupsDiscovery"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.phishingDescription",{defaultMessage:"Phishing (T1566)"}),id:"T1566",name:"Phishing",reference:"https://attack.mitre.org/techniques/T1566",tactics:"initial-access",value:"phishing"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.phishingForInformationDescription",{defaultMessage:"Phishing for Information (T1598)"}),id:"T1598",name:"Phishing for Information",reference:"https://attack.mitre.org/techniques/T1598",tactics:"reconnaissance",value:"phishingForInformation"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.preOsBootDescription",{defaultMessage:"Pre-OS Boot (T1542)"}),id:"T1542",name:"Pre-OS Boot",reference:"https://attack.mitre.org/techniques/T1542",tactics:"defense-evasion,persistence",value:"preOsBoot"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.processDiscoveryDescription",{defaultMessage:"Process Discovery (T1057)"}),id:"T1057",name:"Process Discovery",reference:"https://attack.mitre.org/techniques/T1057",tactics:"discovery",value:"processDiscovery"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.processInjectionDescription",{defaultMessage:"Process Injection (T1055)"}),id:"T1055",name:"Process Injection",reference:"https://attack.mitre.org/techniques/T1055",tactics:"defense-evasion,privilege-escalation",value:"processInjection"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.protocolTunnelingDescription",{defaultMessage:"Protocol Tunneling (T1572)"}),id:"T1572",name:"Protocol Tunneling",reference:"https://attack.mitre.org/techniques/T1572",tactics:"command-and-control",value:"protocolTunneling"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.proxyDescription",{defaultMessage:"Proxy (T1090)"}),id:"T1090",name:"Proxy",reference:"https://attack.mitre.org/techniques/T1090",tactics:"command-and-control",value:"proxy"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.queryRegistryDescription",{defaultMessage:"Query Registry (T1012)"}),id:"T1012",name:"Query Registry",reference:"https://attack.mitre.org/techniques/T1012",tactics:"discovery",value:"queryRegistry"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.redundantAccessDescription",{defaultMessage:"Redundant Access (T1108)"}),id:"T1108",name:"Redundant Access",reference:"https://attack.mitre.org/techniques/T1108",tactics:"defense-evasion,persistence",value:"redundantAccess"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.remoteAccessSoftwareDescription",{defaultMessage:"Remote Access Software (T1219)"}),id:"T1219",name:"Remote Access Software",reference:"https://attack.mitre.org/techniques/T1219",tactics:"command-and-control",value:"remoteAccessSoftware"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.remoteServiceSessionHijackingDescription",{defaultMessage:"Remote Service Session Hijacking (T1563)"}),id:"T1563",name:"Remote Service Session Hijacking",reference:"https://attack.mitre.org/techniques/T1563",tactics:"lateral-movement",value:"remoteServiceSessionHijacking"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.remoteServicesDescription",{defaultMessage:"Remote Services (T1021)"}),id:"T1021",name:"Remote Services",reference:"https://attack.mitre.org/techniques/T1021",tactics:"lateral-movement",value:"remoteServices"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.remoteSystemDiscoveryDescription",{defaultMessage:"Remote System Discovery (T1018)"}),id:"T1018",name:"Remote System Discovery",reference:"https://attack.mitre.org/techniques/T1018",tactics:"discovery",value:"remoteSystemDiscovery"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.replicationThroughRemovableMediaDescription",{defaultMessage:"Replication Through Removable Media (T1091)"}),id:"T1091",name:"Replication Through Removable Media",reference:"https://attack.mitre.org/techniques/T1091",tactics:"lateral-movement,initial-access",value:"replicationThroughRemovableMedia"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.resourceHijackingDescription",{defaultMessage:"Resource Hijacking (T1496)"}),id:"T1496",name:"Resource Hijacking",reference:"https://attack.mitre.org/techniques/T1496",tactics:"impact",value:"resourceHijacking"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.rogueDomainControllerDescription",{defaultMessage:"Rogue Domain Controller (T1207)"}),id:"T1207",name:"Rogue Domain Controller",reference:"https://attack.mitre.org/techniques/T1207",tactics:"defense-evasion",value:"rogueDomainController"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.rootkitDescription",{defaultMessage:"Rootkit (T1014)"}),id:"T1014",name:"Rootkit",reference:"https://attack.mitre.org/techniques/T1014",tactics:"defense-evasion",value:"rootkit"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.scheduledTaskJobDescription",{defaultMessage:"Scheduled Task/Job (T1053)"}),id:"T1053",name:"Scheduled Task/Job",reference:"https://attack.mitre.org/techniques/T1053",tactics:"execution,persistence,privilege-escalation",value:"scheduledTaskJob"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.scheduledTransferDescription",{defaultMessage:"Scheduled Transfer (T1029)"}),id:"T1029",name:"Scheduled Transfer",reference:"https://attack.mitre.org/techniques/T1029",tactics:"exfiltration",value:"scheduledTransfer"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.screenCaptureDescription",{defaultMessage:"Screen Capture (T1113)"}),id:"T1113",name:"Screen Capture",reference:"https://attack.mitre.org/techniques/T1113",tactics:"collection",value:"screenCapture"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.scriptingDescription",{defaultMessage:"Scripting (T1064)"}),id:"T1064",name:"Scripting",reference:"https://attack.mitre.org/techniques/T1064",tactics:"defense-evasion,execution",value:"scripting"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.searchClosedSourcesDescription",{defaultMessage:"Search Closed Sources (T1597)"}),id:"T1597",name:"Search Closed Sources",reference:"https://attack.mitre.org/techniques/T1597",tactics:"reconnaissance",value:"searchClosedSources"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.searchOpenTechnicalDatabasesDescription",{defaultMessage:"Search Open Technical Databases (T1596)"}),id:"T1596",name:"Search Open Technical Databases",reference:"https://attack.mitre.org/techniques/T1596",tactics:"reconnaissance",value:"searchOpenTechnicalDatabases"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.searchOpenWebsitesDomainsDescription",{defaultMessage:"Search Open Websites/Domains (T1593)"}),id:"T1593",name:"Search Open Websites/Domains",reference:"https://attack.mitre.org/techniques/T1593",tactics:"reconnaissance",value:"searchOpenWebsitesDomains"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.searchVictimOwnedWebsitesDescription",{defaultMessage:"Search Victim-Owned Websites (T1594)"}),id:"T1594",name:"Search Victim-Owned Websites",reference:"https://attack.mitre.org/techniques/T1594",tactics:"reconnaissance",value:"searchVictimOwnedWebsites"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.serverSoftwareComponentDescription",{defaultMessage:"Server Software Component (T1505)"}),id:"T1505",name:"Server Software Component",reference:"https://attack.mitre.org/techniques/T1505",tactics:"persistence",value:"serverSoftwareComponent"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.serviceStopDescription",{defaultMessage:"Service Stop (T1489)"}),id:"T1489",name:"Service Stop",reference:"https://attack.mitre.org/techniques/T1489",tactics:"impact",value:"serviceStop"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.sharedModulesDescription",{defaultMessage:"Shared Modules (T1129)"}),id:"T1129",name:"Shared Modules",reference:"https://attack.mitre.org/techniques/T1129",tactics:"execution",value:"sharedModules"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.sharedWebrootDescription",{defaultMessage:"Shared Webroot (T1051)"}),id:"T1051",name:"Shared Webroot",reference:"https://attack.mitre.org/techniques/T1051",tactics:"lateral-movement",value:"sharedWebroot"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.signedBinaryProxyExecutionDescription",{defaultMessage:"Signed Binary Proxy Execution (T1218)"}),id:"T1218",name:"Signed Binary Proxy Execution",reference:"https://attack.mitre.org/techniques/T1218",tactics:"defense-evasion",value:"signedBinaryProxyExecution"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.signedScriptProxyExecutionDescription",{defaultMessage:"Signed Script Proxy Execution (T1216)"}),id:"T1216",name:"Signed Script Proxy Execution",reference:"https://attack.mitre.org/techniques/T1216",tactics:"defense-evasion",value:"signedScriptProxyExecution"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.softwareDeploymentToolsDescription",{defaultMessage:"Software Deployment Tools (T1072)"}),id:"T1072",name:"Software Deployment Tools",reference:"https://attack.mitre.org/techniques/T1072",tactics:"execution,lateral-movement",value:"softwareDeploymentTools"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.softwareDiscoveryDescription",{defaultMessage:"Software Discovery (T1518)"}),id:"T1518",name:"Software Discovery",reference:"https://attack.mitre.org/techniques/T1518",tactics:"discovery",value:"softwareDiscovery"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.sourceDescription",{defaultMessage:"Source (T1153)"}),id:"T1153",name:"Source",reference:"https://attack.mitre.org/techniques/T1153",tactics:"execution",value:"source"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.stealApplicationAccessTokenDescription",{defaultMessage:"Steal Application Access Token (T1528)"}),id:"T1528",name:"Steal Application Access Token",reference:"https://attack.mitre.org/techniques/T1528",tactics:"credential-access",value:"stealApplicationAccessToken"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.stealWebSessionCookieDescription",{defaultMessage:"Steal Web Session Cookie (T1539)"}),id:"T1539",name:"Steal Web Session Cookie",reference:"https://attack.mitre.org/techniques/T1539",tactics:"credential-access",value:"stealWebSessionCookie"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.stealOrForgeKerberosTicketsDescription",{defaultMessage:"Steal or Forge Kerberos Tickets (T1558)"}),id:"T1558",name:"Steal or Forge Kerberos Tickets",reference:"https://attack.mitre.org/techniques/T1558",tactics:"credential-access",value:"stealOrForgeKerberosTickets"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.subvertTrustControlsDescription",{defaultMessage:"Subvert Trust Controls (T1553)"}),id:"T1553",name:"Subvert Trust Controls",reference:"https://attack.mitre.org/techniques/T1553",tactics:"defense-evasion",value:"subvertTrustControls"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.supplyChainCompromiseDescription",{defaultMessage:"Supply Chain Compromise (T1195)"}),id:"T1195",name:"Supply Chain Compromise",reference:"https://attack.mitre.org/techniques/T1195",tactics:"initial-access",value:"supplyChainCompromise"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.systemInformationDiscoveryDescription",{defaultMessage:"System Information Discovery (T1082)"}),id:"T1082",name:"System Information Discovery",reference:"https://attack.mitre.org/techniques/T1082",tactics:"discovery",value:"systemInformationDiscovery"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.systemNetworkConfigurationDiscoveryDescription",{defaultMessage:"System Network Configuration Discovery (T1016)"}),id:"T1016",name:"System Network Configuration Discovery",reference:"https://attack.mitre.org/techniques/T1016",tactics:"discovery",value:"systemNetworkConfigurationDiscovery"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.systemNetworkConnectionsDiscoveryDescription",{defaultMessage:"System Network Connections Discovery (T1049)"}),id:"T1049",name:"System Network Connections Discovery",reference:"https://attack.mitre.org/techniques/T1049",tactics:"discovery",value:"systemNetworkConnectionsDiscovery"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.systemOwnerUserDiscoveryDescription",{defaultMessage:"System Owner/User Discovery (T1033)"}),id:"T1033",name:"System Owner/User Discovery",reference:"https://attack.mitre.org/techniques/T1033",tactics:"discovery",value:"systemOwnerUserDiscovery"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.systemServiceDiscoveryDescription",{defaultMessage:"System Service Discovery (T1007)"}),id:"T1007",name:"System Service Discovery",reference:"https://attack.mitre.org/techniques/T1007",tactics:"discovery",value:"systemServiceDiscovery"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.systemServicesDescription",{defaultMessage:"System Services (T1569)"}),id:"T1569",name:"System Services",reference:"https://attack.mitre.org/techniques/T1569",tactics:"execution",value:"systemServices"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.systemShutdownRebootDescription",{defaultMessage:"System Shutdown/Reboot (T1529)"}),id:"T1529",name:"System Shutdown/Reboot",reference:"https://attack.mitre.org/techniques/T1529",tactics:"impact",value:"systemShutdownReboot"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.systemTimeDiscoveryDescription",{defaultMessage:"System Time Discovery (T1124)"}),id:"T1124",name:"System Time Discovery",reference:"https://attack.mitre.org/techniques/T1124",tactics:"discovery",value:"systemTimeDiscovery"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.taintSharedContentDescription",{defaultMessage:"Taint Shared Content (T1080)"}),id:"T1080",name:"Taint Shared Content",reference:"https://attack.mitre.org/techniques/T1080",tactics:"lateral-movement",value:"taintSharedContent"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.templateInjectionDescription",{defaultMessage:"Template Injection (T1221)"}),id:"T1221",name:"Template Injection",reference:"https://attack.mitre.org/techniques/T1221",tactics:"defense-evasion",value:"templateInjection"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.trafficSignalingDescription",{defaultMessage:"Traffic Signaling (T1205)"}),id:"T1205",name:"Traffic Signaling",reference:"https://attack.mitre.org/techniques/T1205",tactics:"defense-evasion,persistence,command-and-control",value:"trafficSignaling"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.transferDataToCloudAccountDescription",{defaultMessage:"Transfer Data to Cloud Account (T1537)"}),id:"T1537",name:"Transfer Data to Cloud Account",reference:"https://attack.mitre.org/techniques/T1537",tactics:"exfiltration",value:"transferDataToCloudAccount"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.trustedDeveloperUtilitiesProxyExecutionDescription",{defaultMessage:"Trusted Developer Utilities Proxy Execution (T1127)"}),id:"T1127",name:"Trusted Developer Utilities Proxy Execution",reference:"https://attack.mitre.org/techniques/T1127",tactics:"defense-evasion",value:"trustedDeveloperUtilitiesProxyExecution"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.trustedRelationshipDescription",{defaultMessage:"Trusted Relationship (T1199)"}),id:"T1199",name:"Trusted Relationship",reference:"https://attack.mitre.org/techniques/T1199",tactics:"initial-access",value:"trustedRelationship"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.twoFactorAuthenticationInterceptionDescription",{defaultMessage:"Two-Factor Authentication Interception (T1111)"}),id:"T1111",name:"Two-Factor Authentication Interception",reference:"https://attack.mitre.org/techniques/T1111",tactics:"credential-access",value:"twoFactorAuthenticationInterception"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.unsecuredCredentialsDescription",{defaultMessage:"Unsecured Credentials (T1552)"}),id:"T1552",name:"Unsecured Credentials",reference:"https://attack.mitre.org/techniques/T1552",tactics:"credential-access",value:"unsecuredCredentials"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.unusedUnsupportedCloudRegionsDescription",{defaultMessage:"Unused/Unsupported Cloud Regions (T1535)"}),id:"T1535",name:"Unused/Unsupported Cloud Regions",reference:"https://attack.mitre.org/techniques/T1535",tactics:"defense-evasion",value:"unusedUnsupportedCloudRegions"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.useAlternateAuthenticationMaterialDescription",{defaultMessage:"Use Alternate Authentication Material (T1550)"}),id:"T1550",name:"Use Alternate Authentication Material",reference:"https://attack.mitre.org/techniques/T1550",tactics:"defense-evasion,lateral-movement",value:"useAlternateAuthenticationMaterial"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.userExecutionDescription",{defaultMessage:"User Execution (T1204)"}),id:"T1204",name:"User Execution",reference:"https://attack.mitre.org/techniques/T1204",tactics:"execution",value:"userExecution"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.validAccountsDescription",{defaultMessage:"Valid Accounts (T1078)"}),id:"T1078",name:"Valid Accounts",reference:"https://attack.mitre.org/techniques/T1078",tactics:"defense-evasion,persistence,privilege-escalation,initial-access",value:"validAccounts"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.videoCaptureDescription",{defaultMessage:"Video Capture (T1125)"}),id:"T1125",name:"Video Capture",reference:"https://attack.mitre.org/techniques/T1125",tactics:"collection",value:"videoCapture"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.virtualizationSandboxEvasionDescription",{defaultMessage:"Virtualization/Sandbox Evasion (T1497)"}),id:"T1497",name:"Virtualization/Sandbox Evasion",reference:"https://attack.mitre.org/techniques/T1497",tactics:"defense-evasion,discovery",value:"virtualizationSandboxEvasion"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.weakenEncryptionDescription",{defaultMessage:"Weaken Encryption (T1600)"}),id:"T1600",name:"Weaken Encryption",reference:"https://attack.mitre.org/techniques/T1600",tactics:"defense-evasion",value:"weakenEncryption"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.webServiceDescription",{defaultMessage:"Web Service (T1102)"}),id:"T1102",name:"Web Service",reference:"https://attack.mitre.org/techniques/T1102",tactics:"command-and-control",value:"webService"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.windowsManagementInstrumentationDescription",{defaultMessage:"Windows Management Instrumentation (T1047)"}),id:"T1047",name:"Windows Management Instrumentation",reference:"https://attack.mitre.org/techniques/T1047",tactics:"execution",value:"windowsManagementInstrumentation"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.xslScriptProcessingDescription",{defaultMessage:"XSL Script Processing (T1220)"}),id:"T1220",name:"XSL Script Processing",reference:"https://attack.mitre.org/techniques/T1220",tactics:"defense-evasion",value:"xslScriptProcessing"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.domainPolicyModificationDescription",{defaultMessage:"Domain Policy Modification (T1484)"}),id:"T1484",name:"Domain Policy Modification",reference:"https://attack.mitre.org/techniques/T1484",tactics:"defense-evasion,privilege-escalation",value:"domainPolicyModification"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackTechniques.forgeWebCredentialsDescription",{defaultMessage:"Forge Web Credentials (T1606)"}),id:"T1606",name:"Forge Web Credentials",reference:"https://attack.mitre.org/techniques/T1606",tactics:"credential-access",value:"forgeWebCredentials"}],subtechniquesOptions=[{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.bashProfileAndBashrcT1546Description",{defaultMessage:".bash_profile and .bashrc (T1546.004)"}),id:"T1546.004",name:".bash_profile and .bashrc",reference:"https://attack.mitre.org/techniques/T1546/004",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"bashProfileAndBashrc"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.etcPasswdAndEtcShadowT1003Description",{defaultMessage:"/etc/passwd and /etc/shadow (T1003.008)"}),id:"T1003.008",name:"/etc/passwd and /etc/shadow",reference:"https://attack.mitre.org/techniques/T1003/008",tactics:"credential-access",techniqueId:"T1003",value:"etcPasswdAndEtcShadow"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.arpCachePoisoningT1557Description",{defaultMessage:"ARP Cache Poisoning (T1557.002)"}),id:"T1557.002",name:"ARP Cache Poisoning",reference:"https://attack.mitre.org/techniques/T1557/002",tactics:"credential-access,collection",techniqueId:"T1557",value:"arpCachePoisoning"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.asRepRoastingT1558Description",{defaultMessage:"AS-REP Roasting (T1558.004)"}),id:"T1558.004",name:"AS-REP Roasting",reference:"https://attack.mitre.org/techniques/T1558/004",tactics:"credential-access",techniqueId:"T1558",value:"asRepRoasting"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.accessibilityFeaturesT1546Description",{defaultMessage:"Accessibility Features (T1546.008)"}),id:"T1546.008",name:"Accessibility Features",reference:"https://attack.mitre.org/techniques/T1546/008",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"accessibilityFeatures"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.addOffice365GlobalAdministratorRoleT1098Description",{defaultMessage:"Add Office 365 Global Administrator Role (T1098.003)"}),id:"T1098.003",name:"Add Office 365 Global Administrator Role",reference:"https://attack.mitre.org/techniques/T1098/003",tactics:"persistence",techniqueId:"T1098",value:"addOffice365GlobalAdministratorRole"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.addInsT1137Description",{defaultMessage:"Add-ins (T1137.006)"}),id:"T1137.006",name:"Add-ins",reference:"https://attack.mitre.org/techniques/T1137/006",tactics:"persistence",techniqueId:"T1137",value:"addIns"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.appCertDlLsT1546Description",{defaultMessage:"AppCert DLLs (T1546.009)"}),id:"T1546.009",name:"AppCert DLLs",reference:"https://attack.mitre.org/techniques/T1546/009",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"appCertDlLs"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.appInitDlLsT1546Description",{defaultMessage:"AppInit DLLs (T1546.010)"}),id:"T1546.010",name:"AppInit DLLs",reference:"https://attack.mitre.org/techniques/T1546/010",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"appInitDlLs"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.appleScriptT1059Description",{defaultMessage:"AppleScript (T1059.002)"}),id:"T1059.002",name:"AppleScript",reference:"https://attack.mitre.org/techniques/T1059/002",tactics:"execution",techniqueId:"T1059",value:"appleScript"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.applicationAccessTokenT1550Description",{defaultMessage:"Application Access Token (T1550.001)"}),id:"T1550.001",name:"Application Access Token",reference:"https://attack.mitre.org/techniques/T1550/001",tactics:"defense-evasion,lateral-movement",techniqueId:"T1550",value:"applicationAccessToken"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.applicationExhaustionFloodT1499Description",{defaultMessage:"Application Exhaustion Flood (T1499.003)"}),id:"T1499.003",name:"Application Exhaustion Flood",reference:"https://attack.mitre.org/techniques/T1499/003",tactics:"impact",techniqueId:"T1499",value:"applicationExhaustionFlood"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.applicationShimmingT1546Description",{defaultMessage:"Application Shimming (T1546.011)"}),id:"T1546.011",name:"Application Shimming",reference:"https://attack.mitre.org/techniques/T1546/011",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"applicationShimming"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.applicationOrSystemExploitationT1499Description",{defaultMessage:"Application or System Exploitation (T1499.004)"}),id:"T1499.004",name:"Application or System Exploitation",reference:"https://attack.mitre.org/techniques/T1499/004",tactics:"impact",techniqueId:"T1499",value:"applicationOrSystemExploitation"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.archiveViaCustomMethodT1560Description",{defaultMessage:"Archive via Custom Method (T1560.003)"}),id:"T1560.003",name:"Archive via Custom Method",reference:"https://attack.mitre.org/techniques/T1560/003",tactics:"collection",techniqueId:"T1560",value:"archiveViaCustomMethod"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.archiveViaLibraryT1560Description",{defaultMessage:"Archive via Library (T1560.002)"}),id:"T1560.002",name:"Archive via Library",reference:"https://attack.mitre.org/techniques/T1560/002",tactics:"collection",techniqueId:"T1560",value:"archiveViaLibrary"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.archiveViaUtilityT1560Description",{defaultMessage:"Archive via Utility (T1560.001)"}),id:"T1560.001",name:"Archive via Utility",reference:"https://attack.mitre.org/techniques/T1560/001",tactics:"collection",techniqueId:"T1560",value:"archiveViaUtility"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.asymmetricCryptographyT1573Description",{defaultMessage:"Asymmetric Cryptography (T1573.002)"}),id:"T1573.002",name:"Asymmetric Cryptography",reference:"https://attack.mitre.org/techniques/T1573/002",tactics:"command-and-control",techniqueId:"T1573",value:"asymmetricCryptography"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.asynchronousProcedureCallT1055Description",{defaultMessage:"Asynchronous Procedure Call (T1055.004)"}),id:"T1055.004",name:"Asynchronous Procedure Call",reference:"https://attack.mitre.org/techniques/T1055/004",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1055",value:"asynchronousProcedureCall"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.atLinuxT1053Description",{defaultMessage:"At (Linux) (T1053.001)"}),id:"T1053.001",name:"At (Linux)",reference:"https://attack.mitre.org/techniques/T1053/001",tactics:"execution,persistence,privilege-escalation",techniqueId:"T1053",value:"atLinux"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.atWindowsT1053Description",{defaultMessage:"At (Windows) (T1053.002)"}),id:"T1053.002",name:"At (Windows)",reference:"https://attack.mitre.org/techniques/T1053/002",tactics:"execution,persistence,privilege-escalation",techniqueId:"T1053",value:"atWindows"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.authenticationPackageT1547Description",{defaultMessage:"Authentication Package (T1547.002)"}),id:"T1547.002",name:"Authentication Package",reference:"https://attack.mitre.org/techniques/T1547/002",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"authenticationPackage"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.bashHistoryT1552Description",{defaultMessage:"Bash History (T1552.003)"}),id:"T1552.003",name:"Bash History",reference:"https://attack.mitre.org/techniques/T1552/003",tactics:"credential-access",techniqueId:"T1552",value:"bashHistory"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.bidirectionalCommunicationT1102Description",{defaultMessage:"Bidirectional Communication (T1102.002)"}),id:"T1102.002",name:"Bidirectional Communication",reference:"https://attack.mitre.org/techniques/T1102/002",tactics:"command-and-control",techniqueId:"T1102",value:"bidirectionalCommunication"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.binaryPaddingT1027Description",{defaultMessage:"Binary Padding (T1027.001)"}),id:"T1027.001",name:"Binary Padding",reference:"https://attack.mitre.org/techniques/T1027/001",tactics:"defense-evasion",techniqueId:"T1027",value:"binaryPadding"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.bootkitT1542Description",{defaultMessage:"Bootkit (T1542.003)"}),id:"T1542.003",name:"Bootkit",reference:"https://attack.mitre.org/techniques/T1542/003",tactics:"persistence,defense-evasion",techniqueId:"T1542",value:"bootkit"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.botnetT1583Description",{defaultMessage:"Botnet (T1583.005)"}),id:"T1583.005",name:"Botnet",reference:"https://attack.mitre.org/techniques/T1583/005",tactics:"resource-development",techniqueId:"T1583",value:"botnet"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.botnetT1584Description",{defaultMessage:"Botnet (T1584.005)"}),id:"T1584.005",name:"Botnet",reference:"https://attack.mitre.org/techniques/T1584/005",tactics:"resource-development",techniqueId:"T1584",value:"botnet"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.businessRelationshipsT1591Description",{defaultMessage:"Business Relationships (T1591.002)"}),id:"T1591.002",name:"Business Relationships",reference:"https://attack.mitre.org/techniques/T1591/002",tactics:"reconnaissance",techniqueId:"T1591",value:"businessRelationships"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.bypassUserAccountControlT1548Description",{defaultMessage:"Bypass User Account Control (T1548.002)"}),id:"T1548.002",name:"Bypass User Account Control",reference:"https://attack.mitre.org/techniques/T1548/002",tactics:"privilege-escalation,defense-evasion",techniqueId:"T1548",value:"bypassUserAccountControl"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.cdNsT1596Description",{defaultMessage:"CDNs (T1596.004)"}),id:"T1596.004",name:"CDNs",reference:"https://attack.mitre.org/techniques/T1596/004",tactics:"reconnaissance",techniqueId:"T1596",value:"cdNs"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.cmstpT1218Description",{defaultMessage:"CMSTP (T1218.003)"}),id:"T1218.003",name:"CMSTP",reference:"https://attack.mitre.org/techniques/T1218/003",tactics:"defense-evasion",techniqueId:"T1218",value:"cmstp"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.corProfilerT1574Description",{defaultMessage:"COR_PROFILER (T1574.012)"}),id:"T1574.012",name:"COR_PROFILER",reference:"https://attack.mitre.org/techniques/T1574/012",tactics:"persistence,privilege-escalation,defense-evasion",techniqueId:"T1574",value:"corProfiler"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.cachedDomainCredentialsT1003Description",{defaultMessage:"Cached Domain Credentials (T1003.005)"}),id:"T1003.005",name:"Cached Domain Credentials",reference:"https://attack.mitre.org/techniques/T1003/005",tactics:"credential-access",techniqueId:"T1003",value:"cachedDomainCredentials"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.changeDefaultFileAssociationT1546Description",{defaultMessage:"Change Default File Association (T1546.001)"}),id:"T1546.001",name:"Change Default File Association",reference:"https://attack.mitre.org/techniques/T1546/001",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"changeDefaultFileAssociation"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.clearCommandHistoryT1070Description",{defaultMessage:"Clear Command History (T1070.003)"}),id:"T1070.003",name:"Clear Command History",reference:"https://attack.mitre.org/techniques/T1070/003",tactics:"defense-evasion",techniqueId:"T1070",value:"clearCommandHistory"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.clearLinuxOrMacSystemLogsT1070Description",{defaultMessage:"Clear Linux or Mac System Logs (T1070.002)"}),id:"T1070.002",name:"Clear Linux or Mac System Logs",reference:"https://attack.mitre.org/techniques/T1070/002",tactics:"defense-evasion",techniqueId:"T1070",value:"clearLinuxOrMacSystemLogs"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.clearWindowsEventLogsT1070Description",{defaultMessage:"Clear Windows Event Logs (T1070.001)"}),id:"T1070.001",name:"Clear Windows Event Logs",reference:"https://attack.mitre.org/techniques/T1070/001",tactics:"defense-evasion",techniqueId:"T1070",value:"clearWindowsEventLogs"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.clientConfigurationsT1592Description",{defaultMessage:"Client Configurations (T1592.004)"}),id:"T1592.004",name:"Client Configurations",reference:"https://attack.mitre.org/techniques/T1592/004",tactics:"reconnaissance",techniqueId:"T1592",value:"clientConfigurations"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.cloudAccountT1136Description",{defaultMessage:"Cloud Account (T1136.003)"}),id:"T1136.003",name:"Cloud Account",reference:"https://attack.mitre.org/techniques/T1136/003",tactics:"persistence",techniqueId:"T1136",value:"cloudAccount"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.cloudAccountT1087Description",{defaultMessage:"Cloud Account (T1087.004)"}),id:"T1087.004",name:"Cloud Account",reference:"https://attack.mitre.org/techniques/T1087/004",tactics:"discovery",techniqueId:"T1087",value:"cloudAccount"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.cloudAccountsT1078Description",{defaultMessage:"Cloud Accounts (T1078.004)"}),id:"T1078.004",name:"Cloud Accounts",reference:"https://attack.mitre.org/techniques/T1078/004",tactics:"defense-evasion,persistence,privilege-escalation,initial-access",techniqueId:"T1078",value:"cloudAccounts"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.cloudGroupsT1069Description",{defaultMessage:"Cloud Groups (T1069.003)"}),id:"T1069.003",name:"Cloud Groups",reference:"https://attack.mitre.org/techniques/T1069/003",tactics:"discovery",techniqueId:"T1069",value:"cloudGroups"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.cloudInstanceMetadataApiT1552Description",{defaultMessage:"Cloud Instance Metadata API (T1552.005)"}),id:"T1552.005",name:"Cloud Instance Metadata API",reference:"https://attack.mitre.org/techniques/T1552/005",tactics:"credential-access",techniqueId:"T1552",value:"cloudInstanceMetadataApi"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.codeSigningT1553Description",{defaultMessage:"Code Signing (T1553.002)"}),id:"T1553.002",name:"Code Signing",reference:"https://attack.mitre.org/techniques/T1553/002",tactics:"defense-evasion",techniqueId:"T1553",value:"codeSigning"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.codeSigningCertificatesT1587Description",{defaultMessage:"Code Signing Certificates (T1587.002)"}),id:"T1587.002",name:"Code Signing Certificates",reference:"https://attack.mitre.org/techniques/T1587/002",tactics:"resource-development",techniqueId:"T1587",value:"codeSigningCertificates"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.codeSigningCertificatesT1588Description",{defaultMessage:"Code Signing Certificates (T1588.003)"}),id:"T1588.003",name:"Code Signing Certificates",reference:"https://attack.mitre.org/techniques/T1588/003",tactics:"resource-development",techniqueId:"T1588",value:"codeSigningCertificates"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.compileAfterDeliveryT1027Description",{defaultMessage:"Compile After Delivery (T1027.004)"}),id:"T1027.004",name:"Compile After Delivery",reference:"https://attack.mitre.org/techniques/T1027/004",tactics:"defense-evasion",techniqueId:"T1027",value:"compileAfterDelivery"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.compiledHtmlFileT1218Description",{defaultMessage:"Compiled HTML File (T1218.001)"}),id:"T1218.001",name:"Compiled HTML File",reference:"https://attack.mitre.org/techniques/T1218/001",tactics:"defense-evasion",techniqueId:"T1218",value:"compiledHtmlFile"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.componentFirmwareT1542Description",{defaultMessage:"Component Firmware (T1542.002)"}),id:"T1542.002",name:"Component Firmware",reference:"https://attack.mitre.org/techniques/T1542/002",tactics:"persistence,defense-evasion",techniqueId:"T1542",value:"componentFirmware"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.componentObjectModelT1559Description",{defaultMessage:"Component Object Model (T1559.001)"}),id:"T1559.001",name:"Component Object Model",reference:"https://attack.mitre.org/techniques/T1559/001",tactics:"execution",techniqueId:"T1559",value:"componentObjectModel"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.componentObjectModelHijackingT1546Description",{defaultMessage:"Component Object Model Hijacking (T1546.015)"}),id:"T1546.015",name:"Component Object Model Hijacking",reference:"https://attack.mitre.org/techniques/T1546/015",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"componentObjectModelHijacking"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.compromiseHardwareSupplyChainT1195Description",{defaultMessage:"Compromise Hardware Supply Chain (T1195.003)"}),id:"T1195.003",name:"Compromise Hardware Supply Chain",reference:"https://attack.mitre.org/techniques/T1195/003",tactics:"initial-access",techniqueId:"T1195",value:"compromiseHardwareSupplyChain"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.compromiseSoftwareDependenciesAndDevelopmentToolsT1195Description",{defaultMessage:"Compromise Software Dependencies and Development Tools (T1195.001)"}),id:"T1195.001",name:"Compromise Software Dependencies and Development Tools",reference:"https://attack.mitre.org/techniques/T1195/001",tactics:"initial-access",techniqueId:"T1195",value:"compromiseSoftwareDependenciesAndDevelopmentTools"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.compromiseSoftwareSupplyChainT1195Description",{defaultMessage:"Compromise Software Supply Chain (T1195.002)"}),id:"T1195.002",name:"Compromise Software Supply Chain",reference:"https://attack.mitre.org/techniques/T1195/002",tactics:"initial-access",techniqueId:"T1195",value:"compromiseSoftwareSupplyChain"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.confluenceT1213Description",{defaultMessage:"Confluence (T1213.001)"}),id:"T1213.001",name:"Confluence",reference:"https://attack.mitre.org/techniques/T1213/001",tactics:"collection",techniqueId:"T1213",value:"confluence"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.controlPanelT1218Description",{defaultMessage:"Control Panel (T1218.002)"}),id:"T1218.002",name:"Control Panel",reference:"https://attack.mitre.org/techniques/T1218/002",tactics:"defense-evasion",techniqueId:"T1218",value:"controlPanel"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.createCloudInstanceT1578Description",{defaultMessage:"Create Cloud Instance (T1578.002)"}),id:"T1578.002",name:"Create Cloud Instance",reference:"https://attack.mitre.org/techniques/T1578/002",tactics:"defense-evasion",techniqueId:"T1578",value:"createCloudInstance"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.createProcessWithTokenT1134Description",{defaultMessage:"Create Process with Token (T1134.002)"}),id:"T1134.002",name:"Create Process with Token",reference:"https://attack.mitre.org/techniques/T1134/002",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1134",value:"createProcessWithToken"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.createSnapshotT1578Description",{defaultMessage:"Create Snapshot (T1578.001)"}),id:"T1578.001",name:"Create Snapshot",reference:"https://attack.mitre.org/techniques/T1578/001",tactics:"defense-evasion",techniqueId:"T1578",value:"createSnapshot"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.credentialApiHookingT1056Description",{defaultMessage:"Credential API Hooking (T1056.004)"}),id:"T1056.004",name:"Credential API Hooking",reference:"https://attack.mitre.org/techniques/T1056/004",tactics:"collection,credential-access",techniqueId:"T1056",value:"credentialApiHooking"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.credentialStuffingT1110Description",{defaultMessage:"Credential Stuffing (T1110.004)"}),id:"T1110.004",name:"Credential Stuffing",reference:"https://attack.mitre.org/techniques/T1110/004",tactics:"credential-access",techniqueId:"T1110",value:"credentialStuffing"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.credentialsT1589Description",{defaultMessage:"Credentials (T1589.001)"}),id:"T1589.001",name:"Credentials",reference:"https://attack.mitre.org/techniques/T1589/001",tactics:"reconnaissance",techniqueId:"T1589",value:"credentials"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.credentialsInFilesT1552Description",{defaultMessage:"Credentials In Files (T1552.001)"}),id:"T1552.001",name:"Credentials In Files",reference:"https://attack.mitre.org/techniques/T1552/001",tactics:"credential-access",techniqueId:"T1552",value:"credentialsInFiles"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.credentialsFromWebBrowsersT1555Description",{defaultMessage:"Credentials from Web Browsers (T1555.003)"}),id:"T1555.003",name:"Credentials from Web Browsers",reference:"https://attack.mitre.org/techniques/T1555/003",tactics:"credential-access",techniqueId:"T1555",value:"credentialsFromWebBrowsers"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.credentialsInRegistryT1552Description",{defaultMessage:"Credentials in Registry (T1552.002)"}),id:"T1552.002",name:"Credentials in Registry",reference:"https://attack.mitre.org/techniques/T1552/002",tactics:"credential-access",techniqueId:"T1552",value:"credentialsInRegistry"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.cronT1053Description",{defaultMessage:"Cron (T1053.003)"}),id:"T1053.003",name:"Cron",reference:"https://attack.mitre.org/techniques/T1053/003",tactics:"execution,persistence,privilege-escalation",techniqueId:"T1053",value:"cron"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.dcSyncT1003Description",{defaultMessage:"DCSync (T1003.006)"}),id:"T1003.006",name:"DCSync",reference:"https://attack.mitre.org/techniques/T1003/006",tactics:"credential-access",techniqueId:"T1003",value:"dcSync"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.dllSearchOrderHijackingT1574Description",{defaultMessage:"DLL Search Order Hijacking (T1574.001)"}),id:"T1574.001",name:"DLL Search Order Hijacking",reference:"https://attack.mitre.org/techniques/T1574/001",tactics:"persistence,privilege-escalation,defense-evasion",techniqueId:"T1574",value:"dllSearchOrderHijacking"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.dllSideLoadingT1574Description",{defaultMessage:"DLL Side-Loading (T1574.002)"}),id:"T1574.002",name:"DLL Side-Loading",reference:"https://attack.mitre.org/techniques/T1574/002",tactics:"persistence,privilege-escalation,defense-evasion",techniqueId:"T1574",value:"dllSideLoading"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.dnsT1071Description",{defaultMessage:"DNS (T1071.004)"}),id:"T1071.004",name:"DNS",reference:"https://attack.mitre.org/techniques/T1071/004",tactics:"command-and-control",techniqueId:"T1071",value:"dns"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.dnsT1590Description",{defaultMessage:"DNS (T1590.002)"}),id:"T1590.002",name:"DNS",reference:"https://attack.mitre.org/techniques/T1590/002",tactics:"reconnaissance",techniqueId:"T1590",value:"dns"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.dnsCalculationT1568Description",{defaultMessage:"DNS Calculation (T1568.003)"}),id:"T1568.003",name:"DNS Calculation",reference:"https://attack.mitre.org/techniques/T1568/003",tactics:"command-and-control",techniqueId:"T1568",value:"dnsCalculation"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.dnsServerT1583Description",{defaultMessage:"DNS Server (T1583.002)"}),id:"T1583.002",name:"DNS Server",reference:"https://attack.mitre.org/techniques/T1583/002",tactics:"resource-development",techniqueId:"T1583",value:"dnsServer"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.dnsServerT1584Description",{defaultMessage:"DNS Server (T1584.002)"}),id:"T1584.002",name:"DNS Server",reference:"https://attack.mitre.org/techniques/T1584/002",tactics:"resource-development",techniqueId:"T1584",value:"dnsServer"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.dnsPassiveDnsT1596Description",{defaultMessage:"DNS/Passive DNS (T1596.001)"}),id:"T1596.001",name:"DNS/Passive DNS",reference:"https://attack.mitre.org/techniques/T1596/001",tactics:"reconnaissance",techniqueId:"T1596",value:"dnsPassiveDns"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.deadDropResolverT1102Description",{defaultMessage:"Dead Drop Resolver (T1102.001)"}),id:"T1102.001",name:"Dead Drop Resolver",reference:"https://attack.mitre.org/techniques/T1102/001",tactics:"command-and-control",techniqueId:"T1102",value:"deadDropResolver"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.defaultAccountsT1078Description",{defaultMessage:"Default Accounts (T1078.001)"}),id:"T1078.001",name:"Default Accounts",reference:"https://attack.mitre.org/techniques/T1078/001",tactics:"defense-evasion,persistence,privilege-escalation,initial-access",techniqueId:"T1078",value:"defaultAccounts"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.deleteCloudInstanceT1578Description",{defaultMessage:"Delete Cloud Instance (T1578.003)"}),id:"T1578.003",name:"Delete Cloud Instance",reference:"https://attack.mitre.org/techniques/T1578/003",tactics:"defense-evasion",techniqueId:"T1578",value:"deleteCloudInstance"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.determinePhysicalLocationsT1591Description",{defaultMessage:"Determine Physical Locations (T1591.001)"}),id:"T1591.001",name:"Determine Physical Locations",reference:"https://attack.mitre.org/techniques/T1591/001",tactics:"reconnaissance",techniqueId:"T1591",value:"determinePhysicalLocations"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.digitalCertificatesT1587Description",{defaultMessage:"Digital Certificates (T1587.003)"}),id:"T1587.003",name:"Digital Certificates",reference:"https://attack.mitre.org/techniques/T1587/003",tactics:"resource-development",techniqueId:"T1587",value:"digitalCertificates"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.digitalCertificatesT1588Description",{defaultMessage:"Digital Certificates (T1588.004)"}),id:"T1588.004",name:"Digital Certificates",reference:"https://attack.mitre.org/techniques/T1588/004",tactics:"resource-development",techniqueId:"T1588",value:"digitalCertificates"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.digitalCertificatesT1596Description",{defaultMessage:"Digital Certificates (T1596.003)"}),id:"T1596.003",name:"Digital Certificates",reference:"https://attack.mitre.org/techniques/T1596/003",tactics:"reconnaissance",techniqueId:"T1596",value:"digitalCertificates"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.directNetworkFloodT1498Description",{defaultMessage:"Direct Network Flood (T1498.001)"}),id:"T1498.001",name:"Direct Network Flood",reference:"https://attack.mitre.org/techniques/T1498/001",tactics:"impact",techniqueId:"T1498",value:"directNetworkFlood"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.disableCloudLogsT1562Description",{defaultMessage:"Disable Cloud Logs (T1562.008)"}),id:"T1562.008",name:"Disable Cloud Logs",reference:"https://attack.mitre.org/techniques/T1562/008",tactics:"defense-evasion",techniqueId:"T1562",value:"disableCloudLogs"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.disableCryptoHardwareT1600Description",{defaultMessage:"Disable Crypto Hardware (T1600.002)"}),id:"T1600.002",name:"Disable Crypto Hardware",reference:"https://attack.mitre.org/techniques/T1600/002",tactics:"defense-evasion",techniqueId:"T1600",value:"disableCryptoHardware"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.disableWindowsEventLoggingT1562Description",{defaultMessage:"Disable Windows Event Logging (T1562.002)"}),id:"T1562.002",name:"Disable Windows Event Logging",reference:"https://attack.mitre.org/techniques/T1562/002",tactics:"defense-evasion",techniqueId:"T1562",value:"disableWindowsEventLogging"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.disableOrModifyCloudFirewallT1562Description",{defaultMessage:"Disable or Modify Cloud Firewall (T1562.007)"}),id:"T1562.007",name:"Disable or Modify Cloud Firewall",reference:"https://attack.mitre.org/techniques/T1562/007",tactics:"defense-evasion",techniqueId:"T1562",value:"disableOrModifyCloudFirewall"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.disableOrModifySystemFirewallT1562Description",{defaultMessage:"Disable or Modify System Firewall (T1562.004)"}),id:"T1562.004",name:"Disable or Modify System Firewall",reference:"https://attack.mitre.org/techniques/T1562/004",tactics:"defense-evasion",techniqueId:"T1562",value:"disableOrModifySystemFirewall"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.disableOrModifyToolsT1562Description",{defaultMessage:"Disable or Modify Tools (T1562.001)"}),id:"T1562.001",name:"Disable or Modify Tools",reference:"https://attack.mitre.org/techniques/T1562/001",tactics:"defense-evasion",techniqueId:"T1562",value:"disableOrModifyTools"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.diskContentWipeT1561Description",{defaultMessage:"Disk Content Wipe (T1561.001)"}),id:"T1561.001",name:"Disk Content Wipe",reference:"https://attack.mitre.org/techniques/T1561/001",tactics:"impact",techniqueId:"T1561",value:"diskContentWipe"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.diskStructureWipeT1561Description",{defaultMessage:"Disk Structure Wipe (T1561.002)"}),id:"T1561.002",name:"Disk Structure Wipe",reference:"https://attack.mitre.org/techniques/T1561/002",tactics:"impact",techniqueId:"T1561",value:"diskStructureWipe"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.distributedComponentObjectModelT1021Description",{defaultMessage:"Distributed Component Object Model (T1021.003)"}),id:"T1021.003",name:"Distributed Component Object Model",reference:"https://attack.mitre.org/techniques/T1021/003",tactics:"lateral-movement",techniqueId:"T1021",value:"distributedComponentObjectModel"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.domainAccountT1136Description",{defaultMessage:"Domain Account (T1136.002)"}),id:"T1136.002",name:"Domain Account",reference:"https://attack.mitre.org/techniques/T1136/002",tactics:"persistence",techniqueId:"T1136",value:"domainAccount"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.domainAccountT1087Description",{defaultMessage:"Domain Account (T1087.002)"}),id:"T1087.002",name:"Domain Account",reference:"https://attack.mitre.org/techniques/T1087/002",tactics:"discovery",techniqueId:"T1087",value:"domainAccount"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.domainAccountsT1078Description",{defaultMessage:"Domain Accounts (T1078.002)"}),id:"T1078.002",name:"Domain Accounts",reference:"https://attack.mitre.org/techniques/T1078/002",tactics:"defense-evasion,persistence,privilege-escalation,initial-access",techniqueId:"T1078",value:"domainAccounts"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.domainControllerAuthenticationT1556Description",{defaultMessage:"Domain Controller Authentication (T1556.001)"}),id:"T1556.001",name:"Domain Controller Authentication",reference:"https://attack.mitre.org/techniques/T1556/001",tactics:"credential-access,defense-evasion",techniqueId:"T1556",value:"domainControllerAuthentication"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.domainFrontingT1090Description",{defaultMessage:"Domain Fronting (T1090.004)"}),id:"T1090.004",name:"Domain Fronting",reference:"https://attack.mitre.org/techniques/T1090/004",tactics:"command-and-control",techniqueId:"T1090",value:"domainFronting"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.domainGenerationAlgorithmsT1568Description",{defaultMessage:"Domain Generation Algorithms (T1568.002)"}),id:"T1568.002",name:"Domain Generation Algorithms",reference:"https://attack.mitre.org/techniques/T1568/002",tactics:"command-and-control",techniqueId:"T1568",value:"domainGenerationAlgorithms"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.domainGroupsT1069Description",{defaultMessage:"Domain Groups (T1069.002)"}),id:"T1069.002",name:"Domain Groups",reference:"https://attack.mitre.org/techniques/T1069/002",tactics:"discovery",techniqueId:"T1069",value:"domainGroups"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.domainPropertiesT1590Description",{defaultMessage:"Domain Properties (T1590.001)"}),id:"T1590.001",name:"Domain Properties",reference:"https://attack.mitre.org/techniques/T1590/001",tactics:"reconnaissance",techniqueId:"T1590",value:"domainProperties"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.domainsT1583Description",{defaultMessage:"Domains (T1583.001)"}),id:"T1583.001",name:"Domains",reference:"https://attack.mitre.org/techniques/T1583/001",tactics:"resource-development",techniqueId:"T1583",value:"domains"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.domainsT1584Description",{defaultMessage:"Domains (T1584.001)"}),id:"T1584.001",name:"Domains",reference:"https://attack.mitre.org/techniques/T1584/001",tactics:"resource-development",techniqueId:"T1584",value:"domains"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.downgradeSystemImageT1601Description",{defaultMessage:"Downgrade System Image (T1601.002)"}),id:"T1601.002",name:"Downgrade System Image",reference:"https://attack.mitre.org/techniques/T1601/002",tactics:"defense-evasion",techniqueId:"T1601",value:"downgradeSystemImage"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.dylibHijackingT1574Description",{defaultMessage:"Dylib Hijacking (T1574.004)"}),id:"T1574.004",name:"Dylib Hijacking",reference:"https://attack.mitre.org/techniques/T1574/004",tactics:"persistence,privilege-escalation,defense-evasion",techniqueId:"T1574",value:"dylibHijacking"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.dynamicDataExchangeT1559Description",{defaultMessage:"Dynamic Data Exchange (T1559.002)"}),id:"T1559.002",name:"Dynamic Data Exchange",reference:"https://attack.mitre.org/techniques/T1559/002",tactics:"execution",techniqueId:"T1559",value:"dynamicDataExchange"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.dynamicLinkLibraryInjectionT1055Description",{defaultMessage:"Dynamic-link Library Injection (T1055.001)"}),id:"T1055.001",name:"Dynamic-link Library Injection",reference:"https://attack.mitre.org/techniques/T1055/001",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1055",value:"dynamicLinkLibraryInjection"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.elevatedExecutionWithPromptT1548Description",{defaultMessage:"Elevated Execution with Prompt (T1548.004)"}),id:"T1548.004",name:"Elevated Execution with Prompt",reference:"https://attack.mitre.org/techniques/T1548/004",tactics:"privilege-escalation,defense-evasion",techniqueId:"T1548",value:"elevatedExecutionWithPrompt"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.emailAccountT1087Description",{defaultMessage:"Email Account (T1087.003)"}),id:"T1087.003",name:"Email Account",reference:"https://attack.mitre.org/techniques/T1087/003",tactics:"discovery",techniqueId:"T1087",value:"emailAccount"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.emailAccountsT1585Description",{defaultMessage:"Email Accounts (T1585.002)"}),id:"T1585.002",name:"Email Accounts",reference:"https://attack.mitre.org/techniques/T1585/002",tactics:"resource-development",techniqueId:"T1585",value:"emailAccounts"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.emailAccountsT1586Description",{defaultMessage:"Email Accounts (T1586.002)"}),id:"T1586.002",name:"Email Accounts",reference:"https://attack.mitre.org/techniques/T1586/002",tactics:"resource-development",techniqueId:"T1586",value:"emailAccounts"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.emailAddressesT1589Description",{defaultMessage:"Email Addresses (T1589.002)"}),id:"T1589.002",name:"Email Addresses",reference:"https://attack.mitre.org/techniques/T1589/002",tactics:"reconnaissance",techniqueId:"T1589",value:"emailAddresses"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.emailForwardingRuleT1114Description",{defaultMessage:"Email Forwarding Rule (T1114.003)"}),id:"T1114.003",name:"Email Forwarding Rule",reference:"https://attack.mitre.org/techniques/T1114/003",tactics:"collection",techniqueId:"T1114",value:"emailForwardingRule"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.emondT1546Description",{defaultMessage:"Emond (T1546.014)"}),id:"T1546.014",name:"Emond",reference:"https://attack.mitre.org/techniques/T1546/014",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"emond"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.employeeNamesT1589Description",{defaultMessage:"Employee Names (T1589.003)"}),id:"T1589.003",name:"Employee Names",reference:"https://attack.mitre.org/techniques/T1589/003",tactics:"reconnaissance",techniqueId:"T1589",value:"employeeNames"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.environmentalKeyingT1480Description",{defaultMessage:"Environmental Keying (T1480.001)"}),id:"T1480.001",name:"Environmental Keying",reference:"https://attack.mitre.org/techniques/T1480/001",tactics:"defense-evasion",techniqueId:"T1480",value:"environmentalKeying"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.exchangeEmailDelegatePermissionsT1098Description",{defaultMessage:"Exchange Email Delegate Permissions (T1098.002)"}),id:"T1098.002",name:"Exchange Email Delegate Permissions",reference:"https://attack.mitre.org/techniques/T1098/002",tactics:"persistence",techniqueId:"T1098",value:"exchangeEmailDelegatePermissions"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.executableInstallerFilePermissionsWeaknessT1574Description",{defaultMessage:"Executable Installer File Permissions Weakness (T1574.005)"}),id:"T1574.005",name:"Executable Installer File Permissions Weakness",reference:"https://attack.mitre.org/techniques/T1574/005",tactics:"persistence,privilege-escalation,defense-evasion",techniqueId:"T1574",value:"executableInstallerFilePermissionsWeakness"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.exfiltrationOverAsymmetricEncryptedNonC2ProtocolT1048Description",{defaultMessage:"Exfiltration Over Asymmetric Encrypted Non-C2 Protocol (T1048.002)"}),id:"T1048.002",name:"Exfiltration Over Asymmetric Encrypted Non-C2 Protocol",reference:"https://attack.mitre.org/techniques/T1048/002",tactics:"exfiltration",techniqueId:"T1048",value:"exfiltrationOverAsymmetricEncryptedNonC2Protocol"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.exfiltrationOverBluetoothT1011Description",{defaultMessage:"Exfiltration Over Bluetooth (T1011.001)"}),id:"T1011.001",name:"Exfiltration Over Bluetooth",reference:"https://attack.mitre.org/techniques/T1011/001",tactics:"exfiltration",techniqueId:"T1011",value:"exfiltrationOverBluetooth"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.exfiltrationOverSymmetricEncryptedNonC2ProtocolT1048Description",{defaultMessage:"Exfiltration Over Symmetric Encrypted Non-C2 Protocol (T1048.001)"}),id:"T1048.001",name:"Exfiltration Over Symmetric Encrypted Non-C2 Protocol",reference:"https://attack.mitre.org/techniques/T1048/001",tactics:"exfiltration",techniqueId:"T1048",value:"exfiltrationOverSymmetricEncryptedNonC2Protocol"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.exfiltrationOverUnencryptedObfuscatedNonC2ProtocolT1048Description",{defaultMessage:"Exfiltration Over Unencrypted/Obfuscated Non-C2 Protocol (T1048.003)"}),id:"T1048.003",name:"Exfiltration Over Unencrypted/Obfuscated Non-C2 Protocol",reference:"https://attack.mitre.org/techniques/T1048/003",tactics:"exfiltration",techniqueId:"T1048",value:"exfiltrationOverUnencryptedObfuscatedNonC2Protocol"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.exfiltrationOverUsbT1052Description",{defaultMessage:"Exfiltration over USB (T1052.001)"}),id:"T1052.001",name:"Exfiltration over USB",reference:"https://attack.mitre.org/techniques/T1052/001",tactics:"exfiltration",techniqueId:"T1052",value:"exfiltrationOverUsb"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.exfiltrationToCloudStorageT1567Description",{defaultMessage:"Exfiltration to Cloud Storage (T1567.002)"}),id:"T1567.002",name:"Exfiltration to Cloud Storage",reference:"https://attack.mitre.org/techniques/T1567/002",tactics:"exfiltration",techniqueId:"T1567",value:"exfiltrationToCloudStorage"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.exfiltrationToCodeRepositoryT1567Description",{defaultMessage:"Exfiltration to Code Repository (T1567.001)"}),id:"T1567.001",name:"Exfiltration to Code Repository",reference:"https://attack.mitre.org/techniques/T1567/001",tactics:"exfiltration",techniqueId:"T1567",value:"exfiltrationToCodeRepository"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.exploitsT1587Description",{defaultMessage:"Exploits (T1587.004)"}),id:"T1587.004",name:"Exploits",reference:"https://attack.mitre.org/techniques/T1587/004",tactics:"resource-development",techniqueId:"T1587",value:"exploits"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.exploitsT1588Description",{defaultMessage:"Exploits (T1588.005)"}),id:"T1588.005",name:"Exploits",reference:"https://attack.mitre.org/techniques/T1588/005",tactics:"resource-development",techniqueId:"T1588",value:"exploits"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.externalDefacementT1491Description",{defaultMessage:"External Defacement (T1491.002)"}),id:"T1491.002",name:"External Defacement",reference:"https://attack.mitre.org/techniques/T1491/002",tactics:"impact",techniqueId:"T1491",value:"externalDefacement"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.externalProxyT1090Description",{defaultMessage:"External Proxy (T1090.002)"}),id:"T1090.002",name:"External Proxy",reference:"https://attack.mitre.org/techniques/T1090/002",tactics:"command-and-control",techniqueId:"T1090",value:"externalProxy"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.extraWindowMemoryInjectionT1055Description",{defaultMessage:"Extra Window Memory Injection (T1055.011)"}),id:"T1055.011",name:"Extra Window Memory Injection",reference:"https://attack.mitre.org/techniques/T1055/011",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1055",value:"extraWindowMemoryInjection"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.fastFluxDnsT1568Description",{defaultMessage:"Fast Flux DNS (T1568.001)"}),id:"T1568.001",name:"Fast Flux DNS",reference:"https://attack.mitre.org/techniques/T1568/001",tactics:"command-and-control",techniqueId:"T1568",value:"fastFluxDns"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.fileDeletionT1070Description",{defaultMessage:"File Deletion (T1070.004)"}),id:"T1070.004",name:"File Deletion",reference:"https://attack.mitre.org/techniques/T1070/004",tactics:"defense-evasion",techniqueId:"T1070",value:"fileDeletion"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.fileTransferProtocolsT1071Description",{defaultMessage:"File Transfer Protocols (T1071.002)"}),id:"T1071.002",name:"File Transfer Protocols",reference:"https://attack.mitre.org/techniques/T1071/002",tactics:"command-and-control",techniqueId:"T1071",value:"fileTransferProtocols"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.firmwareT1592Description",{defaultMessage:"Firmware (T1592.003)"}),id:"T1592.003",name:"Firmware",reference:"https://attack.mitre.org/techniques/T1592/003",tactics:"reconnaissance",techniqueId:"T1592",value:"firmware"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.guiInputCaptureT1056Description",{defaultMessage:"GUI Input Capture (T1056.002)"}),id:"T1056.002",name:"GUI Input Capture",reference:"https://attack.mitre.org/techniques/T1056/002",tactics:"collection,credential-access",techniqueId:"T1056",value:"guiInputCapture"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.gatekeeperBypassT1553Description",{defaultMessage:"Gatekeeper Bypass (T1553.001)"}),id:"T1553.001",name:"Gatekeeper Bypass",reference:"https://attack.mitre.org/techniques/T1553/001",tactics:"defense-evasion",techniqueId:"T1553",value:"gatekeeperBypass"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.goldenTicketT1558Description",{defaultMessage:"Golden Ticket (T1558.001)"}),id:"T1558.001",name:"Golden Ticket",reference:"https://attack.mitre.org/techniques/T1558/001",tactics:"credential-access",techniqueId:"T1558",value:"goldenTicket"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.groupPolicyPreferencesT1552Description",{defaultMessage:"Group Policy Preferences (T1552.006)"}),id:"T1552.006",name:"Group Policy Preferences",reference:"https://attack.mitre.org/techniques/T1552/006",tactics:"credential-access",techniqueId:"T1552",value:"groupPolicyPreferences"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.hardwareT1592Description",{defaultMessage:"Hardware (T1592.001)"}),id:"T1592.001",name:"Hardware",reference:"https://attack.mitre.org/techniques/T1592/001",tactics:"reconnaissance",techniqueId:"T1592",value:"hardware"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.hiddenFileSystemT1564Description",{defaultMessage:"Hidden File System (T1564.005)"}),id:"T1564.005",name:"Hidden File System",reference:"https://attack.mitre.org/techniques/T1564/005",tactics:"defense-evasion",techniqueId:"T1564",value:"hiddenFileSystem"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.hiddenFilesAndDirectoriesT1564Description",{defaultMessage:"Hidden Files and Directories (T1564.001)"}),id:"T1564.001",name:"Hidden Files and Directories",reference:"https://attack.mitre.org/techniques/T1564/001",tactics:"defense-evasion",techniqueId:"T1564",value:"hiddenFilesAndDirectories"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.hiddenUsersT1564Description",{defaultMessage:"Hidden Users (T1564.002)"}),id:"T1564.002",name:"Hidden Users",reference:"https://attack.mitre.org/techniques/T1564/002",tactics:"defense-evasion",techniqueId:"T1564",value:"hiddenUsers"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.hiddenWindowT1564Description",{defaultMessage:"Hidden Window (T1564.003)"}),id:"T1564.003",name:"Hidden Window",reference:"https://attack.mitre.org/techniques/T1564/003",tactics:"defense-evasion",techniqueId:"T1564",value:"hiddenWindow"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.ipAddressesT1590Description",{defaultMessage:"IP Addresses (T1590.005)"}),id:"T1590.005",name:"IP Addresses",reference:"https://attack.mitre.org/techniques/T1590/005",tactics:"reconnaissance",techniqueId:"T1590",value:"ipAddresses"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.identifyBusinessTempoT1591Description",{defaultMessage:"Identify Business Tempo (T1591.003)"}),id:"T1591.003",name:"Identify Business Tempo",reference:"https://attack.mitre.org/techniques/T1591/003",tactics:"reconnaissance",techniqueId:"T1591",value:"identifyBusinessTempo"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.identifyRolesT1591Description",{defaultMessage:"Identify Roles (T1591.004)"}),id:"T1591.004",name:"Identify Roles",reference:"https://attack.mitre.org/techniques/T1591/004",tactics:"reconnaissance",techniqueId:"T1591",value:"identifyRoles"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.imageFileExecutionOptionsInjectionT1546Description",{defaultMessage:"Image File Execution Options Injection (T1546.012)"}),id:"T1546.012",name:"Image File Execution Options Injection",reference:"https://attack.mitre.org/techniques/T1546/012",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"imageFileExecutionOptionsInjection"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.impairCommandHistoryLoggingT1562Description",{defaultMessage:"Impair Command History Logging (T1562.003)"}),id:"T1562.003",name:"Impair Command History Logging",reference:"https://attack.mitre.org/techniques/T1562/003",tactics:"defense-evasion",techniqueId:"T1562",value:"impairCommandHistoryLogging"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.indicatorBlockingT1562Description",{defaultMessage:"Indicator Blocking (T1562.006)"}),id:"T1562.006",name:"Indicator Blocking",reference:"https://attack.mitre.org/techniques/T1562/006",tactics:"defense-evasion",techniqueId:"T1562",value:"indicatorBlocking"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.indicatorRemovalFromToolsT1027Description",{defaultMessage:"Indicator Removal from Tools (T1027.005)"}),id:"T1027.005",name:"Indicator Removal from Tools",reference:"https://attack.mitre.org/techniques/T1027/005",tactics:"defense-evasion",techniqueId:"T1027",value:"indicatorRemovalFromTools"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.installRootCertificateT1553Description",{defaultMessage:"Install Root Certificate (T1553.004)"}),id:"T1553.004",name:"Install Root Certificate",reference:"https://attack.mitre.org/techniques/T1553/004",tactics:"defense-evasion",techniqueId:"T1553",value:"installRootCertificate"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.installUtilT1218Description",{defaultMessage:"InstallUtil (T1218.004)"}),id:"T1218.004",name:"InstallUtil",reference:"https://attack.mitre.org/techniques/T1218/004",tactics:"defense-evasion",techniqueId:"T1218",value:"installUtil"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.internalDefacementT1491Description",{defaultMessage:"Internal Defacement (T1491.001)"}),id:"T1491.001",name:"Internal Defacement",reference:"https://attack.mitre.org/techniques/T1491/001",tactics:"impact",techniqueId:"T1491",value:"internalDefacement"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.internalProxyT1090Description",{defaultMessage:"Internal Proxy (T1090.001)"}),id:"T1090.001",name:"Internal Proxy",reference:"https://attack.mitre.org/techniques/T1090/001",tactics:"command-and-control",techniqueId:"T1090",value:"internalProxy"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.invalidCodeSignatureT1036Description",{defaultMessage:"Invalid Code Signature (T1036.001)"}),id:"T1036.001",name:"Invalid Code Signature",reference:"https://attack.mitre.org/techniques/T1036/001",tactics:"defense-evasion",techniqueId:"T1036",value:"invalidCodeSignature"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.javaScriptJScriptT1059Description",{defaultMessage:"JavaScript/JScript (T1059.007)"}),id:"T1059.007",name:"JavaScript/JScript",reference:"https://attack.mitre.org/techniques/T1059/007",tactics:"execution",techniqueId:"T1059",value:"javaScriptJScript"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.junkDataT1001Description",{defaultMessage:"Junk Data (T1001.001)"}),id:"T1001.001",name:"Junk Data",reference:"https://attack.mitre.org/techniques/T1001/001",tactics:"command-and-control",techniqueId:"T1001",value:"junkData"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.kerberoastingT1558Description",{defaultMessage:"Kerberoasting (T1558.003)"}),id:"T1558.003",name:"Kerberoasting",reference:"https://attack.mitre.org/techniques/T1558/003",tactics:"credential-access",techniqueId:"T1558",value:"kerberoasting"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.kernelModulesAndExtensionsT1547Description",{defaultMessage:"Kernel Modules and Extensions (T1547.006)"}),id:"T1547.006",name:"Kernel Modules and Extensions",reference:"https://attack.mitre.org/techniques/T1547/006",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"kernelModulesAndExtensions"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.keychainT1555Description",{defaultMessage:"Keychain (T1555.001)"}),id:"T1555.001",name:"Keychain",reference:"https://attack.mitre.org/techniques/T1555/001",tactics:"credential-access",techniqueId:"T1555",value:"keychain"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.keyloggingT1056Description",{defaultMessage:"Keylogging (T1056.001)"}),id:"T1056.001",name:"Keylogging",reference:"https://attack.mitre.org/techniques/T1056/001",tactics:"collection,credential-access",techniqueId:"T1056",value:"keylogging"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.lcLoadDylibAdditionT1546Description",{defaultMessage:"LC_LOAD_DYLIB Addition (T1546.006)"}),id:"T1546.006",name:"LC_LOAD_DYLIB Addition",reference:"https://attack.mitre.org/techniques/T1546/006",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"lcLoadDylibAddition"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.ldPreloadT1574Description",{defaultMessage:"LD_PRELOAD (T1574.006)"}),id:"T1574.006",name:"LD_PRELOAD",reference:"https://attack.mitre.org/techniques/T1574/006",tactics:"persistence,privilege-escalation,defense-evasion",techniqueId:"T1574",value:"ldPreload"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.llmnrNbtNsPoisoningAndSmbRelayT1557Description",{defaultMessage:"LLMNR/NBT-NS Poisoning and SMB Relay (T1557.001)"}),id:"T1557.001",name:"LLMNR/NBT-NS Poisoning and SMB Relay",reference:"https://attack.mitre.org/techniques/T1557/001",tactics:"credential-access,collection",techniqueId:"T1557",value:"llmnrNbtNsPoisoningAndSmbRelay"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.lsaSecretsT1003Description",{defaultMessage:"LSA Secrets (T1003.004)"}),id:"T1003.004",name:"LSA Secrets",reference:"https://attack.mitre.org/techniques/T1003/004",tactics:"credential-access",techniqueId:"T1003",value:"lsaSecrets"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.lsassDriverT1547Description",{defaultMessage:"LSASS Driver (T1547.008)"}),id:"T1547.008",name:"LSASS Driver",reference:"https://attack.mitre.org/techniques/T1547/008",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"lsassDriver"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.lsassMemoryT1003Description",{defaultMessage:"LSASS Memory (T1003.001)"}),id:"T1003.001",name:"LSASS Memory",reference:"https://attack.mitre.org/techniques/T1003/001",tactics:"credential-access",techniqueId:"T1003",value:"lsassMemory"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.launchAgentT1543Description",{defaultMessage:"Launch Agent (T1543.001)"}),id:"T1543.001",name:"Launch Agent",reference:"https://attack.mitre.org/techniques/T1543/001",tactics:"persistence,privilege-escalation",techniqueId:"T1543",value:"launchAgent"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.launchDaemonT1543Description",{defaultMessage:"Launch Daemon (T1543.004)"}),id:"T1543.004",name:"Launch Daemon",reference:"https://attack.mitre.org/techniques/T1543/004",tactics:"persistence,privilege-escalation",techniqueId:"T1543",value:"launchDaemon"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.launchctlT1569Description",{defaultMessage:"Launchctl (T1569.001)"}),id:"T1569.001",name:"Launchctl",reference:"https://attack.mitre.org/techniques/T1569/001",tactics:"execution",techniqueId:"T1569",value:"launchctl"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.launchdT1053Description",{defaultMessage:"Launchd (T1053.004)"}),id:"T1053.004",name:"Launchd",reference:"https://attack.mitre.org/techniques/T1053/004",tactics:"execution,persistence,privilege-escalation",techniqueId:"T1053",value:"launchd"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.linuxAndMacFileAndDirectoryPermissionsModificationT1222Description",{defaultMessage:"Linux and Mac File and Directory Permissions Modification (T1222.002)"}),id:"T1222.002",name:"Linux and Mac File and Directory Permissions Modification",reference:"https://attack.mitre.org/techniques/T1222/002",tactics:"defense-evasion",techniqueId:"T1222",value:"linuxAndMacFileAndDirectoryPermissionsModification"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.localAccountT1136Description",{defaultMessage:"Local Account (T1136.001)"}),id:"T1136.001",name:"Local Account",reference:"https://attack.mitre.org/techniques/T1136/001",tactics:"persistence",techniqueId:"T1136",value:"localAccount"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.localAccountT1087Description",{defaultMessage:"Local Account (T1087.001)"}),id:"T1087.001",name:"Local Account",reference:"https://attack.mitre.org/techniques/T1087/001",tactics:"discovery",techniqueId:"T1087",value:"localAccount"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.localAccountsT1078Description",{defaultMessage:"Local Accounts (T1078.003)"}),id:"T1078.003",name:"Local Accounts",reference:"https://attack.mitre.org/techniques/T1078/003",tactics:"defense-evasion,persistence,privilege-escalation,initial-access",techniqueId:"T1078",value:"localAccounts"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.localDataStagingT1074Description",{defaultMessage:"Local Data Staging (T1074.001)"}),id:"T1074.001",name:"Local Data Staging",reference:"https://attack.mitre.org/techniques/T1074/001",tactics:"collection",techniqueId:"T1074",value:"localDataStaging"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.localEmailCollectionT1114Description",{defaultMessage:"Local Email Collection (T1114.001)"}),id:"T1114.001",name:"Local Email Collection",reference:"https://attack.mitre.org/techniques/T1114/001",tactics:"collection",techniqueId:"T1114",value:"localEmailCollection"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.localGroupsT1069Description",{defaultMessage:"Local Groups (T1069.001)"}),id:"T1069.001",name:"Local Groups",reference:"https://attack.mitre.org/techniques/T1069/001",tactics:"discovery",techniqueId:"T1069",value:"localGroups"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.logonScriptMacT1037Description",{defaultMessage:"Logon Script (Mac) (T1037.002)"}),id:"T1037.002",name:"Logon Script (Mac)",reference:"https://attack.mitre.org/techniques/T1037/002",tactics:"persistence,privilege-escalation",techniqueId:"T1037",value:"logonScriptMac"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.logonScriptWindowsT1037Description",{defaultMessage:"Logon Script (Windows) (T1037.001)"}),id:"T1037.001",name:"Logon Script (Windows)",reference:"https://attack.mitre.org/techniques/T1037/001",tactics:"persistence,privilege-escalation",techniqueId:"T1037",value:"logonScriptWindows"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.msBuildT1127Description",{defaultMessage:"MSBuild (T1127.001)"}),id:"T1127.001",name:"MSBuild",reference:"https://attack.mitre.org/techniques/T1127/001",tactics:"defense-evasion",techniqueId:"T1127",value:"msBuild"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.mailProtocolsT1071Description",{defaultMessage:"Mail Protocols (T1071.003)"}),id:"T1071.003",name:"Mail Protocols",reference:"https://attack.mitre.org/techniques/T1071/003",tactics:"command-and-control",techniqueId:"T1071",value:"mailProtocols"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.makeAndImpersonateTokenT1134Description",{defaultMessage:"Make and Impersonate Token (T1134.003)"}),id:"T1134.003",name:"Make and Impersonate Token",reference:"https://attack.mitre.org/techniques/T1134/003",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1134",value:"makeAndImpersonateToken"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.maliciousFileT1204Description",{defaultMessage:"Malicious File (T1204.002)"}),id:"T1204.002",name:"Malicious File",reference:"https://attack.mitre.org/techniques/T1204/002",tactics:"execution",techniqueId:"T1204",value:"maliciousFile"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.maliciousLinkT1204Description",{defaultMessage:"Malicious Link (T1204.001)"}),id:"T1204.001",name:"Malicious Link",reference:"https://attack.mitre.org/techniques/T1204/001",tactics:"execution",techniqueId:"T1204",value:"maliciousLink"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.malwareT1587Description",{defaultMessage:"Malware (T1587.001)"}),id:"T1587.001",name:"Malware",reference:"https://attack.mitre.org/techniques/T1587/001",tactics:"resource-development",techniqueId:"T1587",value:"malware"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.malwareT1588Description",{defaultMessage:"Malware (T1588.001)"}),id:"T1588.001",name:"Malware",reference:"https://attack.mitre.org/techniques/T1588/001",tactics:"resource-development",techniqueId:"T1588",value:"malware"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.masqueradeTaskOrServiceT1036Description",{defaultMessage:"Masquerade Task or Service (T1036.004)"}),id:"T1036.004",name:"Masquerade Task or Service",reference:"https://attack.mitre.org/techniques/T1036/004",tactics:"defense-evasion",techniqueId:"T1036",value:"masqueradeTaskOrService"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.matchLegitimateNameOrLocationT1036Description",{defaultMessage:"Match Legitimate Name or Location (T1036.005)"}),id:"T1036.005",name:"Match Legitimate Name or Location",reference:"https://attack.mitre.org/techniques/T1036/005",tactics:"defense-evasion",techniqueId:"T1036",value:"matchLegitimateNameOrLocation"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.mshtaT1218Description",{defaultMessage:"Mshta (T1218.005)"}),id:"T1218.005",name:"Mshta",reference:"https://attack.mitre.org/techniques/T1218/005",tactics:"defense-evasion",techniqueId:"T1218",value:"mshta"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.msiexecT1218Description",{defaultMessage:"Msiexec (T1218.007)"}),id:"T1218.007",name:"Msiexec",reference:"https://attack.mitre.org/techniques/T1218/007",tactics:"defense-evasion",techniqueId:"T1218",value:"msiexec"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.multiHopProxyT1090Description",{defaultMessage:"Multi-hop Proxy (T1090.003)"}),id:"T1090.003",name:"Multi-hop Proxy",reference:"https://attack.mitre.org/techniques/T1090/003",tactics:"command-and-control",techniqueId:"T1090",value:"multiHopProxy"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.ntdsT1003Description",{defaultMessage:"NTDS (T1003.003)"}),id:"T1003.003",name:"NTDS",reference:"https://attack.mitre.org/techniques/T1003/003",tactics:"credential-access",techniqueId:"T1003",value:"ntds"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.ntfsFileAttributesT1564Description",{defaultMessage:"NTFS File Attributes (T1564.004)"}),id:"T1564.004",name:"NTFS File Attributes",reference:"https://attack.mitre.org/techniques/T1564/004",tactics:"defense-evasion",techniqueId:"T1564",value:"ntfsFileAttributes"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.netshHelperDllT1546Description",{defaultMessage:"Netsh Helper DLL (T1546.007)"}),id:"T1546.007",name:"Netsh Helper DLL",reference:"https://attack.mitre.org/techniques/T1546/007",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"netshHelperDll"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.networkAddressTranslationTraversalT1599Description",{defaultMessage:"Network Address Translation Traversal (T1599.001)"}),id:"T1599.001",name:"Network Address Translation Traversal",reference:"https://attack.mitre.org/techniques/T1599/001",tactics:"defense-evasion",techniqueId:"T1599",value:"networkAddressTranslationTraversal"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.networkDeviceAuthenticationT1556Description",{defaultMessage:"Network Device Authentication (T1556.004)"}),id:"T1556.004",name:"Network Device Authentication",reference:"https://attack.mitre.org/techniques/T1556/004",tactics:"credential-access,defense-evasion",techniqueId:"T1556",value:"networkDeviceAuthentication"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.networkDeviceCliT1059Description",{defaultMessage:"Network Device CLI (T1059.008)"}),id:"T1059.008",name:"Network Device CLI",reference:"https://attack.mitre.org/techniques/T1059/008",tactics:"execution",techniqueId:"T1059",value:"networkDeviceCli"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.networkDeviceConfigurationDumpT1602Description",{defaultMessage:"Network Device Configuration Dump (T1602.002)"}),id:"T1602.002",name:"Network Device Configuration Dump",reference:"https://attack.mitre.org/techniques/T1602/002",tactics:"collection",techniqueId:"T1602",value:"networkDeviceConfigurationDump"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.networkLogonScriptT1037Description",{defaultMessage:"Network Logon Script (T1037.003)"}),id:"T1037.003",name:"Network Logon Script",reference:"https://attack.mitre.org/techniques/T1037/003",tactics:"persistence,privilege-escalation",techniqueId:"T1037",value:"networkLogonScript"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.networkSecurityAppliancesT1590Description",{defaultMessage:"Network Security Appliances (T1590.006)"}),id:"T1590.006",name:"Network Security Appliances",reference:"https://attack.mitre.org/techniques/T1590/006",tactics:"reconnaissance",techniqueId:"T1590",value:"networkSecurityAppliances"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.networkShareConnectionRemovalT1070Description",{defaultMessage:"Network Share Connection Removal (T1070.005)"}),id:"T1070.005",name:"Network Share Connection Removal",reference:"https://attack.mitre.org/techniques/T1070/005",tactics:"defense-evasion",techniqueId:"T1070",value:"networkShareConnectionRemoval"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.networkTopologyT1590Description",{defaultMessage:"Network Topology (T1590.004)"}),id:"T1590.004",name:"Network Topology",reference:"https://attack.mitre.org/techniques/T1590/004",tactics:"reconnaissance",techniqueId:"T1590",value:"networkTopology"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.networkTrustDependenciesT1590Description",{defaultMessage:"Network Trust Dependencies (T1590.003)"}),id:"T1590.003",name:"Network Trust Dependencies",reference:"https://attack.mitre.org/techniques/T1590/003",tactics:"reconnaissance",techniqueId:"T1590",value:"networkTrustDependencies"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.nonStandardEncodingT1132Description",{defaultMessage:"Non-Standard Encoding (T1132.002)"}),id:"T1132.002",name:"Non-Standard Encoding",reference:"https://attack.mitre.org/techniques/T1132/002",tactics:"command-and-control",techniqueId:"T1132",value:"nonStandardEncoding"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.osExhaustionFloodT1499Description",{defaultMessage:"OS Exhaustion Flood (T1499.001)"}),id:"T1499.001",name:"OS Exhaustion Flood",reference:"https://attack.mitre.org/techniques/T1499/001",tactics:"impact",techniqueId:"T1499",value:"osExhaustionFlood"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.odbcconfT1218Description",{defaultMessage:"Odbcconf (T1218.008)"}),id:"T1218.008",name:"Odbcconf",reference:"https://attack.mitre.org/techniques/T1218/008",tactics:"defense-evasion",techniqueId:"T1218",value:"odbcconf"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.officeTemplateMacrosT1137Description",{defaultMessage:"Office Template Macros (T1137.001)"}),id:"T1137.001",name:"Office Template Macros",reference:"https://attack.mitre.org/techniques/T1137/001",tactics:"persistence",techniqueId:"T1137",value:"officeTemplateMacros"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.officeTestT1137Description",{defaultMessage:"Office Test (T1137.002)"}),id:"T1137.002",name:"Office Test",reference:"https://attack.mitre.org/techniques/T1137/002",tactics:"persistence",techniqueId:"T1137",value:"officeTest"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.oneWayCommunicationT1102Description",{defaultMessage:"One-Way Communication (T1102.003)"}),id:"T1102.003",name:"One-Way Communication",reference:"https://attack.mitre.org/techniques/T1102/003",tactics:"command-and-control",techniqueId:"T1102",value:"oneWayCommunication"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.outlookFormsT1137Description",{defaultMessage:"Outlook Forms (T1137.003)"}),id:"T1137.003",name:"Outlook Forms",reference:"https://attack.mitre.org/techniques/T1137/003",tactics:"persistence",techniqueId:"T1137",value:"outlookForms"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.outlookHomePageT1137Description",{defaultMessage:"Outlook Home Page (T1137.004)"}),id:"T1137.004",name:"Outlook Home Page",reference:"https://attack.mitre.org/techniques/T1137/004",tactics:"persistence",techniqueId:"T1137",value:"outlookHomePage"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.outlookRulesT1137Description",{defaultMessage:"Outlook Rules (T1137.005)"}),id:"T1137.005",name:"Outlook Rules",reference:"https://attack.mitre.org/techniques/T1137/005",tactics:"persistence",techniqueId:"T1137",value:"outlookRules"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.parentPidSpoofingT1134Description",{defaultMessage:"Parent PID Spoofing (T1134.004)"}),id:"T1134.004",name:"Parent PID Spoofing",reference:"https://attack.mitre.org/techniques/T1134/004",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1134",value:"parentPidSpoofing"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.passTheHashT1550Description",{defaultMessage:"Pass the Hash (T1550.002)"}),id:"T1550.002",name:"Pass the Hash",reference:"https://attack.mitre.org/techniques/T1550/002",tactics:"defense-evasion,lateral-movement",techniqueId:"T1550",value:"passTheHash"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.passTheTicketT1550Description",{defaultMessage:"Pass the Ticket (T1550.003)"}),id:"T1550.003",name:"Pass the Ticket",reference:"https://attack.mitre.org/techniques/T1550/003",tactics:"defense-evasion,lateral-movement",techniqueId:"T1550",value:"passTheTicket"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.passwordCrackingT1110Description",{defaultMessage:"Password Cracking (T1110.002)"}),id:"T1110.002",name:"Password Cracking",reference:"https://attack.mitre.org/techniques/T1110/002",tactics:"credential-access",techniqueId:"T1110",value:"passwordCracking"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.passwordFilterDllT1556Description",{defaultMessage:"Password Filter DLL (T1556.002)"}),id:"T1556.002",name:"Password Filter DLL",reference:"https://attack.mitre.org/techniques/T1556/002",tactics:"credential-access,defense-evasion",techniqueId:"T1556",value:"passwordFilterDll"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.passwordGuessingT1110Description",{defaultMessage:"Password Guessing (T1110.001)"}),id:"T1110.001",name:"Password Guessing",reference:"https://attack.mitre.org/techniques/T1110/001",tactics:"credential-access",techniqueId:"T1110",value:"passwordGuessing"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.passwordSprayingT1110Description",{defaultMessage:"Password Spraying (T1110.003)"}),id:"T1110.003",name:"Password Spraying",reference:"https://attack.mitre.org/techniques/T1110/003",tactics:"credential-access",techniqueId:"T1110",value:"passwordSpraying"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.patchSystemImageT1601Description",{defaultMessage:"Patch System Image (T1601.001)"}),id:"T1601.001",name:"Patch System Image",reference:"https://attack.mitre.org/techniques/T1601/001",tactics:"defense-evasion",techniqueId:"T1601",value:"patchSystemImage"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.pathInterceptionByPathEnvironmentVariableT1574Description",{defaultMessage:"Path Interception by PATH Environment Variable (T1574.007)"}),id:"T1574.007",name:"Path Interception by PATH Environment Variable",reference:"https://attack.mitre.org/techniques/T1574/007",tactics:"persistence,privilege-escalation,defense-evasion",techniqueId:"T1574",value:"pathInterceptionByPathEnvironmentVariable"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.pathInterceptionBySearchOrderHijackingT1574Description",{defaultMessage:"Path Interception by Search Order Hijacking (T1574.008)"}),id:"T1574.008",name:"Path Interception by Search Order Hijacking",reference:"https://attack.mitre.org/techniques/T1574/008",tactics:"persistence,privilege-escalation,defense-evasion",techniqueId:"T1574",value:"pathInterceptionBySearchOrderHijacking"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.pathInterceptionByUnquotedPathT1574Description",{defaultMessage:"Path Interception by Unquoted Path (T1574.009)"}),id:"T1574.009",name:"Path Interception by Unquoted Path",reference:"https://attack.mitre.org/techniques/T1574/009",tactics:"persistence,privilege-escalation,defense-evasion",techniqueId:"T1574",value:"pathInterceptionByUnquotedPath"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.plistModificationT1547Description",{defaultMessage:"Plist Modification (T1547.011)"}),id:"T1547.011",name:"Plist Modification",reference:"https://attack.mitre.org/techniques/T1547/011",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"plistModification"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.pluggableAuthenticationModulesT1556Description",{defaultMessage:"Pluggable Authentication Modules (T1556.003)"}),id:"T1556.003",name:"Pluggable Authentication Modules",reference:"https://attack.mitre.org/techniques/T1556/003",tactics:"credential-access,defense-evasion",techniqueId:"T1556",value:"pluggableAuthenticationModules"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.portKnockingT1205Description",{defaultMessage:"Port Knocking (T1205.001)"}),id:"T1205.001",name:"Port Knocking",reference:"https://attack.mitre.org/techniques/T1205/001",tactics:"defense-evasion,persistence,command-and-control",techniqueId:"T1205",value:"portKnocking"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.portMonitorsT1547Description",{defaultMessage:"Port Monitors (T1547.010)"}),id:"T1547.010",name:"Port Monitors",reference:"https://attack.mitre.org/techniques/T1547/010",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"portMonitors"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.portableExecutableInjectionT1055Description",{defaultMessage:"Portable Executable Injection (T1055.002)"}),id:"T1055.002",name:"Portable Executable Injection",reference:"https://attack.mitre.org/techniques/T1055/002",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1055",value:"portableExecutableInjection"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.powerShellT1059Description",{defaultMessage:"PowerShell (T1059.001)"}),id:"T1059.001",name:"PowerShell",reference:"https://attack.mitre.org/techniques/T1059/001",tactics:"execution",techniqueId:"T1059",value:"powerShell"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.powerShellProfileT1546Description",{defaultMessage:"PowerShell Profile (T1546.013)"}),id:"T1546.013",name:"PowerShell Profile",reference:"https://attack.mitre.org/techniques/T1546/013",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"powerShellProfile"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.printProcessorsT1547Description",{defaultMessage:"Print Processors (T1547.012)"}),id:"T1547.012",name:"Print Processors",reference:"https://attack.mitre.org/techniques/T1547/012",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"printProcessors"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.privateKeysT1552Description",{defaultMessage:"Private Keys (T1552.004)"}),id:"T1552.004",name:"Private Keys",reference:"https://attack.mitre.org/techniques/T1552/004",tactics:"credential-access",techniqueId:"T1552",value:"privateKeys"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.procFilesystemT1003Description",{defaultMessage:"Proc Filesystem (T1003.007)"}),id:"T1003.007",name:"Proc Filesystem",reference:"https://attack.mitre.org/techniques/T1003/007",tactics:"credential-access",techniqueId:"T1003",value:"procFilesystem"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.procMemoryT1055Description",{defaultMessage:"Proc Memory (T1055.009)"}),id:"T1055.009",name:"Proc Memory",reference:"https://attack.mitre.org/techniques/T1055/009",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1055",value:"procMemory"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.processDoppelgangingT1055Description",{defaultMessage:"Process Doppelgänging (T1055.013)"}),id:"T1055.013",name:"Process Doppelgänging",reference:"https://attack.mitre.org/techniques/T1055/013",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1055",value:"processDoppelganging"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.processHollowingT1055Description",{defaultMessage:"Process Hollowing (T1055.012)"}),id:"T1055.012",name:"Process Hollowing",reference:"https://attack.mitre.org/techniques/T1055/012",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1055",value:"processHollowing"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.protocolImpersonationT1001Description",{defaultMessage:"Protocol Impersonation (T1001.003)"}),id:"T1001.003",name:"Protocol Impersonation",reference:"https://attack.mitre.org/techniques/T1001/003",tactics:"command-and-control",techniqueId:"T1001",value:"protocolImpersonation"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.ptraceSystemCallsT1055Description",{defaultMessage:"Ptrace System Calls (T1055.008)"}),id:"T1055.008",name:"Ptrace System Calls",reference:"https://attack.mitre.org/techniques/T1055/008",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1055",value:"ptraceSystemCalls"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.pubPrnT1216Description",{defaultMessage:"PubPrn (T1216.001)"}),id:"T1216.001",name:"PubPrn",reference:"https://attack.mitre.org/techniques/T1216/001",tactics:"defense-evasion",techniqueId:"T1216",value:"pubPrn"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.purchaseTechnicalDataT1597Description",{defaultMessage:"Purchase Technical Data (T1597.002)"}),id:"T1597.002",name:"Purchase Technical Data",reference:"https://attack.mitre.org/techniques/T1597/002",tactics:"reconnaissance",techniqueId:"T1597",value:"purchaseTechnicalData"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.pythonT1059Description",{defaultMessage:"Python (T1059.006)"}),id:"T1059.006",name:"Python",reference:"https://attack.mitre.org/techniques/T1059/006",tactics:"execution",techniqueId:"T1059",value:"python"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.rdpHijackingT1563Description",{defaultMessage:"RDP Hijacking (T1563.002)"}),id:"T1563.002",name:"RDP Hijacking",reference:"https://attack.mitre.org/techniques/T1563/002",tactics:"lateral-movement",techniqueId:"T1563",value:"rdpHijacking"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.rommoNkitT1542Description",{defaultMessage:"ROMMONkit (T1542.004)"}),id:"T1542.004",name:"ROMMONkit",reference:"https://attack.mitre.org/techniques/T1542/004",tactics:"defense-evasion,persistence",techniqueId:"T1542",value:"rommoNkit"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.rcCommonT1037Description",{defaultMessage:"Rc.common (T1037.004)"}),id:"T1037.004",name:"Rc.common",reference:"https://attack.mitre.org/techniques/T1037/004",tactics:"persistence,privilege-escalation",techniqueId:"T1037",value:"rcCommon"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.reOpenedApplicationsT1547Description",{defaultMessage:"Re-opened Applications (T1547.007)"}),id:"T1547.007",name:"Re-opened Applications",reference:"https://attack.mitre.org/techniques/T1547/007",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"reOpenedApplications"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.reduceKeySpaceT1600Description",{defaultMessage:"Reduce Key Space (T1600.001)"}),id:"T1600.001",name:"Reduce Key Space",reference:"https://attack.mitre.org/techniques/T1600/001",tactics:"defense-evasion",techniqueId:"T1600",value:"reduceKeySpace"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.reflectionAmplificationT1498Description",{defaultMessage:"Reflection Amplification (T1498.002)"}),id:"T1498.002",name:"Reflection Amplification",reference:"https://attack.mitre.org/techniques/T1498/002",tactics:"impact",techniqueId:"T1498",value:"reflectionAmplification"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.registryRunKeysStartupFolderT1547Description",{defaultMessage:"Registry Run Keys / Startup Folder (T1547.001)"}),id:"T1547.001",name:"Registry Run Keys / Startup Folder",reference:"https://attack.mitre.org/techniques/T1547/001",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"registryRunKeysStartupFolder"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.regsvcsRegasmT1218Description",{defaultMessage:"Regsvcs/Regasm (T1218.009)"}),id:"T1218.009",name:"Regsvcs/Regasm",reference:"https://attack.mitre.org/techniques/T1218/009",tactics:"defense-evasion",techniqueId:"T1218",value:"regsvcsRegasm"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.regsvr32T1218Description",{defaultMessage:"Regsvr32 (T1218.010)"}),id:"T1218.010",name:"Regsvr32",reference:"https://attack.mitre.org/techniques/T1218/010",tactics:"defense-evasion",techniqueId:"T1218",value:"regsvr32"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.remoteDataStagingT1074Description",{defaultMessage:"Remote Data Staging (T1074.002)"}),id:"T1074.002",name:"Remote Data Staging",reference:"https://attack.mitre.org/techniques/T1074/002",tactics:"collection",techniqueId:"T1074",value:"remoteDataStaging"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.remoteDesktopProtocolT1021Description",{defaultMessage:"Remote Desktop Protocol (T1021.001)"}),id:"T1021.001",name:"Remote Desktop Protocol",reference:"https://attack.mitre.org/techniques/T1021/001",tactics:"lateral-movement",techniqueId:"T1021",value:"remoteDesktopProtocol"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.remoteEmailCollectionT1114Description",{defaultMessage:"Remote Email Collection (T1114.002)"}),id:"T1114.002",name:"Remote Email Collection",reference:"https://attack.mitre.org/techniques/T1114/002",tactics:"collection",techniqueId:"T1114",value:"remoteEmailCollection"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.renameSystemUtilitiesT1036Description",{defaultMessage:"Rename System Utilities (T1036.003)"}),id:"T1036.003",name:"Rename System Utilities",reference:"https://attack.mitre.org/techniques/T1036/003",tactics:"defense-evasion",techniqueId:"T1036",value:"renameSystemUtilities"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.revertCloudInstanceT1578Description",{defaultMessage:"Revert Cloud Instance (T1578.004)"}),id:"T1578.004",name:"Revert Cloud Instance",reference:"https://attack.mitre.org/techniques/T1578/004",tactics:"defense-evasion",techniqueId:"T1578",value:"revertCloudInstance"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.rightToLeftOverrideT1036Description",{defaultMessage:"Right-to-Left Override (T1036.002)"}),id:"T1036.002",name:"Right-to-Left Override",reference:"https://attack.mitre.org/techniques/T1036/002",tactics:"defense-evasion",techniqueId:"T1036",value:"rightToLeftOverride"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.runVirtualInstanceT1564Description",{defaultMessage:"Run Virtual Instance (T1564.006)"}),id:"T1564.006",name:"Run Virtual Instance",reference:"https://attack.mitre.org/techniques/T1564/006",tactics:"defense-evasion",techniqueId:"T1564",value:"runVirtualInstance"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.rundll32T1218Description",{defaultMessage:"Rundll32 (T1218.011)"}),id:"T1218.011",name:"Rundll32",reference:"https://attack.mitre.org/techniques/T1218/011",tactics:"defense-evasion",techniqueId:"T1218",value:"rundll32"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.runtimeDataManipulationT1565Description",{defaultMessage:"Runtime Data Manipulation (T1565.003)"}),id:"T1565.003",name:"Runtime Data Manipulation",reference:"https://attack.mitre.org/techniques/T1565/003",tactics:"impact",techniqueId:"T1565",value:"runtimeDataManipulation"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.sidHistoryInjectionT1134Description",{defaultMessage:"SID-History Injection (T1134.005)"}),id:"T1134.005",name:"SID-History Injection",reference:"https://attack.mitre.org/techniques/T1134/005",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1134",value:"sidHistoryInjection"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.sipAndTrustProviderHijackingT1553Description",{defaultMessage:"SIP and Trust Provider Hijacking (T1553.003)"}),id:"T1553.003",name:"SIP and Trust Provider Hijacking",reference:"https://attack.mitre.org/techniques/T1553/003",tactics:"defense-evasion",techniqueId:"T1553",value:"sipAndTrustProviderHijacking"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.smbWindowsAdminSharesT1021Description",{defaultMessage:"SMB/Windows Admin Shares (T1021.002)"}),id:"T1021.002",name:"SMB/Windows Admin Shares",reference:"https://attack.mitre.org/techniques/T1021/002",tactics:"lateral-movement",techniqueId:"T1021",value:"smbWindowsAdminShares"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.snmpMibDumpT1602Description",{defaultMessage:"SNMP (MIB Dump) (T1602.001)"}),id:"T1602.001",name:"SNMP (MIB Dump)",reference:"https://attack.mitre.org/techniques/T1602/001",tactics:"collection",techniqueId:"T1602",value:"snmpMibDump"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.sqlStoredProceduresT1505Description",{defaultMessage:"SQL Stored Procedures (T1505.001)"}),id:"T1505.001",name:"SQL Stored Procedures",reference:"https://attack.mitre.org/techniques/T1505/001",tactics:"persistence",techniqueId:"T1505",value:"sqlStoredProcedures"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.sshT1021Description",{defaultMessage:"SSH (T1021.004)"}),id:"T1021.004",name:"SSH",reference:"https://attack.mitre.org/techniques/T1021/004",tactics:"lateral-movement",techniqueId:"T1021",value:"ssh"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.sshAuthorizedKeysT1098Description",{defaultMessage:"SSH Authorized Keys (T1098.004)"}),id:"T1098.004",name:"SSH Authorized Keys",reference:"https://attack.mitre.org/techniques/T1098/004",tactics:"persistence",techniqueId:"T1098",value:"sshAuthorizedKeys"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.sshHijackingT1563Description",{defaultMessage:"SSH Hijacking (T1563.001)"}),id:"T1563.001",name:"SSH Hijacking",reference:"https://attack.mitre.org/techniques/T1563/001",tactics:"lateral-movement",techniqueId:"T1563",value:"sshHijacking"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.scanDatabasesT1596Description",{defaultMessage:"Scan Databases (T1596.005)"}),id:"T1596.005",name:"Scan Databases",reference:"https://attack.mitre.org/techniques/T1596/005",tactics:"reconnaissance",techniqueId:"T1596",value:"scanDatabases"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.scanningIpBlocksT1595Description",{defaultMessage:"Scanning IP Blocks (T1595.001)"}),id:"T1595.001",name:"Scanning IP Blocks",reference:"https://attack.mitre.org/techniques/T1595/001",tactics:"reconnaissance",techniqueId:"T1595",value:"scanningIpBlocks"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.scheduledTaskT1053Description",{defaultMessage:"Scheduled Task (T1053.005)"}),id:"T1053.005",name:"Scheduled Task",reference:"https://attack.mitre.org/techniques/T1053/005",tactics:"execution,persistence,privilege-escalation",techniqueId:"T1053",value:"scheduledTask"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.screensaverT1546Description",{defaultMessage:"Screensaver (T1546.002)"}),id:"T1546.002",name:"Screensaver",reference:"https://attack.mitre.org/techniques/T1546/002",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"screensaver"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.searchEnginesT1593Description",{defaultMessage:"Search Engines (T1593.002)"}),id:"T1593.002",name:"Search Engines",reference:"https://attack.mitre.org/techniques/T1593/002",tactics:"reconnaissance",techniqueId:"T1593",value:"searchEngines"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.securityAccountManagerT1003Description",{defaultMessage:"Security Account Manager (T1003.002)"}),id:"T1003.002",name:"Security Account Manager",reference:"https://attack.mitre.org/techniques/T1003/002",tactics:"credential-access",techniqueId:"T1003",value:"securityAccountManager"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.securitySoftwareDiscoveryT1518Description",{defaultMessage:"Security Software Discovery (T1518.001)"}),id:"T1518.001",name:"Security Software Discovery",reference:"https://attack.mitre.org/techniques/T1518/001",tactics:"discovery",techniqueId:"T1518",value:"securitySoftwareDiscovery"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.securitySupportProviderT1547Description",{defaultMessage:"Security Support Provider (T1547.005)"}),id:"T1547.005",name:"Security Support Provider",reference:"https://attack.mitre.org/techniques/T1547/005",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"securitySupportProvider"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.securitydMemoryT1555Description",{defaultMessage:"Securityd Memory (T1555.002)"}),id:"T1555.002",name:"Securityd Memory",reference:"https://attack.mitre.org/techniques/T1555/002",tactics:"credential-access",techniqueId:"T1555",value:"securitydMemory"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.serverT1583Description",{defaultMessage:"Server (T1583.004)"}),id:"T1583.004",name:"Server",reference:"https://attack.mitre.org/techniques/T1583/004",tactics:"resource-development",techniqueId:"T1583",value:"server"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.serverT1584Description",{defaultMessage:"Server (T1584.004)"}),id:"T1584.004",name:"Server",reference:"https://attack.mitre.org/techniques/T1584/004",tactics:"resource-development",techniqueId:"T1584",value:"server"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.serviceExecutionT1569Description",{defaultMessage:"Service Execution (T1569.002)"}),id:"T1569.002",name:"Service Execution",reference:"https://attack.mitre.org/techniques/T1569/002",tactics:"execution",techniqueId:"T1569",value:"serviceExecution"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.serviceExhaustionFloodT1499Description",{defaultMessage:"Service Exhaustion Flood (T1499.002)"}),id:"T1499.002",name:"Service Exhaustion Flood",reference:"https://attack.mitre.org/techniques/T1499/002",tactics:"impact",techniqueId:"T1499",value:"serviceExhaustionFlood"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.servicesFilePermissionsWeaknessT1574Description",{defaultMessage:"Services File Permissions Weakness (T1574.010)"}),id:"T1574.010",name:"Services File Permissions Weakness",reference:"https://attack.mitre.org/techniques/T1574/010",tactics:"persistence,privilege-escalation,defense-evasion",techniqueId:"T1574",value:"servicesFilePermissionsWeakness"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.servicesRegistryPermissionsWeaknessT1574Description",{defaultMessage:"Services Registry Permissions Weakness (T1574.011)"}),id:"T1574.011",name:"Services Registry Permissions Weakness",reference:"https://attack.mitre.org/techniques/T1574/011",tactics:"persistence,privilege-escalation,defense-evasion",techniqueId:"T1574",value:"servicesRegistryPermissionsWeakness"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.setuidAndSetgidT1548Description",{defaultMessage:"Setuid and Setgid (T1548.001)"}),id:"T1548.001",name:"Setuid and Setgid",reference:"https://attack.mitre.org/techniques/T1548/001",tactics:"privilege-escalation,defense-evasion",techniqueId:"T1548",value:"setuidAndSetgid"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.sharepointT1213Description",{defaultMessage:"Sharepoint (T1213.002)"}),id:"T1213.002",name:"Sharepoint",reference:"https://attack.mitre.org/techniques/T1213/002",tactics:"collection",techniqueId:"T1213",value:"sharepoint"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.shortcutModificationT1547Description",{defaultMessage:"Shortcut Modification (T1547.009)"}),id:"T1547.009",name:"Shortcut Modification",reference:"https://attack.mitre.org/techniques/T1547/009",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"shortcutModification"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.silverTicketT1558Description",{defaultMessage:"Silver Ticket (T1558.002)"}),id:"T1558.002",name:"Silver Ticket",reference:"https://attack.mitre.org/techniques/T1558/002",tactics:"credential-access",techniqueId:"T1558",value:"silverTicket"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.socialMediaT1593Description",{defaultMessage:"Social Media (T1593.001)"}),id:"T1593.001",name:"Social Media",reference:"https://attack.mitre.org/techniques/T1593/001",tactics:"reconnaissance",techniqueId:"T1593",value:"socialMedia"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.socialMediaAccountsT1585Description",{defaultMessage:"Social Media Accounts (T1585.001)"}),id:"T1585.001",name:"Social Media Accounts",reference:"https://attack.mitre.org/techniques/T1585/001",tactics:"resource-development",techniqueId:"T1585",value:"socialMediaAccounts"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.socialMediaAccountsT1586Description",{defaultMessage:"Social Media Accounts (T1586.001)"}),id:"T1586.001",name:"Social Media Accounts",reference:"https://attack.mitre.org/techniques/T1586/001",tactics:"resource-development",techniqueId:"T1586",value:"socialMediaAccounts"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.softwareT1592Description",{defaultMessage:"Software (T1592.002)"}),id:"T1592.002",name:"Software",reference:"https://attack.mitre.org/techniques/T1592/002",tactics:"reconnaissance",techniqueId:"T1592",value:"software"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.softwarePackingT1027Description",{defaultMessage:"Software Packing (T1027.002)"}),id:"T1027.002",name:"Software Packing",reference:"https://attack.mitre.org/techniques/T1027/002",tactics:"defense-evasion",techniqueId:"T1027",value:"softwarePacking"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.spaceAfterFilenameT1036Description",{defaultMessage:"Space after Filename (T1036.006)"}),id:"T1036.006",name:"Space after Filename",reference:"https://attack.mitre.org/techniques/T1036/006",tactics:"defense-evasion",techniqueId:"T1036",value:"spaceAfterFilename"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.spearphishingAttachmentT1566Description",{defaultMessage:"Spearphishing Attachment (T1566.001)"}),id:"T1566.001",name:"Spearphishing Attachment",reference:"https://attack.mitre.org/techniques/T1566/001",tactics:"initial-access",techniqueId:"T1566",value:"spearphishingAttachment"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.spearphishingAttachmentT1598Description",{defaultMessage:"Spearphishing Attachment (T1598.002)"}),id:"T1598.002",name:"Spearphishing Attachment",reference:"https://attack.mitre.org/techniques/T1598/002",tactics:"reconnaissance",techniqueId:"T1598",value:"spearphishingAttachment"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.spearphishingLinkT1566Description",{defaultMessage:"Spearphishing Link (T1566.002)"}),id:"T1566.002",name:"Spearphishing Link",reference:"https://attack.mitre.org/techniques/T1566/002",tactics:"initial-access",techniqueId:"T1566",value:"spearphishingLink"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.spearphishingLinkT1598Description",{defaultMessage:"Spearphishing Link (T1598.003)"}),id:"T1598.003",name:"Spearphishing Link",reference:"https://attack.mitre.org/techniques/T1598/003",tactics:"reconnaissance",techniqueId:"T1598",value:"spearphishingLink"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.spearphishingServiceT1598Description",{defaultMessage:"Spearphishing Service (T1598.001)"}),id:"T1598.001",name:"Spearphishing Service",reference:"https://attack.mitre.org/techniques/T1598/001",tactics:"reconnaissance",techniqueId:"T1598",value:"spearphishingService"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.spearphishingViaServiceT1566Description",{defaultMessage:"Spearphishing via Service (T1566.003)"}),id:"T1566.003",name:"Spearphishing via Service",reference:"https://attack.mitre.org/techniques/T1566/003",tactics:"initial-access",techniqueId:"T1566",value:"spearphishingViaService"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.standardEncodingT1132Description",{defaultMessage:"Standard Encoding (T1132.001)"}),id:"T1132.001",name:"Standard Encoding",reference:"https://attack.mitre.org/techniques/T1132/001",tactics:"command-and-control",techniqueId:"T1132",value:"standardEncoding"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.startupItemsT1037Description",{defaultMessage:"Startup Items (T1037.005)"}),id:"T1037.005",name:"Startup Items",reference:"https://attack.mitre.org/techniques/T1037/005",tactics:"persistence,privilege-escalation",techniqueId:"T1037",value:"startupItems"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.steganographyT1027Description",{defaultMessage:"Steganography (T1027.003)"}),id:"T1027.003",name:"Steganography",reference:"https://attack.mitre.org/techniques/T1027/003",tactics:"defense-evasion",techniqueId:"T1027",value:"steganography"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.steganographyT1001Description",{defaultMessage:"Steganography (T1001.002)"}),id:"T1001.002",name:"Steganography",reference:"https://attack.mitre.org/techniques/T1001/002",tactics:"command-and-control",techniqueId:"T1001",value:"steganography"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.storedDataManipulationT1565Description",{defaultMessage:"Stored Data Manipulation (T1565.001)"}),id:"T1565.001",name:"Stored Data Manipulation",reference:"https://attack.mitre.org/techniques/T1565/001",tactics:"impact",techniqueId:"T1565",value:"storedDataManipulation"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.sudoAndSudoCachingT1548Description",{defaultMessage:"Sudo and Sudo Caching (T1548.003)"}),id:"T1548.003",name:"Sudo and Sudo Caching",reference:"https://attack.mitre.org/techniques/T1548/003",tactics:"privilege-escalation,defense-evasion",techniqueId:"T1548",value:"sudoAndSudoCaching"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.symmetricCryptographyT1573Description",{defaultMessage:"Symmetric Cryptography (T1573.001)"}),id:"T1573.001",name:"Symmetric Cryptography",reference:"https://attack.mitre.org/techniques/T1573/001",tactics:"command-and-control",techniqueId:"T1573",value:"symmetricCryptography"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.systemChecksT1497Description",{defaultMessage:"System Checks (T1497.001)"}),id:"T1497.001",name:"System Checks",reference:"https://attack.mitre.org/techniques/T1497/001",tactics:"defense-evasion,discovery",techniqueId:"T1497",value:"systemChecks"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.systemFirmwareT1542Description",{defaultMessage:"System Firmware (T1542.001)"}),id:"T1542.001",name:"System Firmware",reference:"https://attack.mitre.org/techniques/T1542/001",tactics:"persistence,defense-evasion",techniqueId:"T1542",value:"systemFirmware"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.systemdServiceT1543Description",{defaultMessage:"Systemd Service (T1543.002)"}),id:"T1543.002",name:"Systemd Service",reference:"https://attack.mitre.org/techniques/T1543/002",tactics:"persistence,privilege-escalation",techniqueId:"T1543",value:"systemdService"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.systemdTimersT1053Description",{defaultMessage:"Systemd Timers (T1053.006)"}),id:"T1053.006",name:"Systemd Timers",reference:"https://attack.mitre.org/techniques/T1053/006",tactics:"execution,persistence,privilege-escalation",techniqueId:"T1053",value:"systemdTimers"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.tftpBootT1542Description",{defaultMessage:"TFTP Boot (T1542.005)"}),id:"T1542.005",name:"TFTP Boot",reference:"https://attack.mitre.org/techniques/T1542/005",tactics:"defense-evasion,persistence",techniqueId:"T1542",value:"tftpBoot"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.threadExecutionHijackingT1055Description",{defaultMessage:"Thread Execution Hijacking (T1055.003)"}),id:"T1055.003",name:"Thread Execution Hijacking",reference:"https://attack.mitre.org/techniques/T1055/003",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1055",value:"threadExecutionHijacking"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.threadLocalStorageT1055Description",{defaultMessage:"Thread Local Storage (T1055.005)"}),id:"T1055.005",name:"Thread Local Storage",reference:"https://attack.mitre.org/techniques/T1055/005",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1055",value:"threadLocalStorage"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.threatIntelVendorsT1597Description",{defaultMessage:"Threat Intel Vendors (T1597.001)"}),id:"T1597.001",name:"Threat Intel Vendors",reference:"https://attack.mitre.org/techniques/T1597/001",tactics:"reconnaissance",techniqueId:"T1597",value:"threatIntelVendors"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.timeBasedEvasionT1497Description",{defaultMessage:"Time Based Evasion (T1497.003)"}),id:"T1497.003",name:"Time Based Evasion",reference:"https://attack.mitre.org/techniques/T1497/003",tactics:"defense-evasion,discovery",techniqueId:"T1497",value:"timeBasedEvasion"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.timeProvidersT1547Description",{defaultMessage:"Time Providers (T1547.003)"}),id:"T1547.003",name:"Time Providers",reference:"https://attack.mitre.org/techniques/T1547/003",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"timeProviders"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.timestompT1070Description",{defaultMessage:"Timestomp (T1070.006)"}),id:"T1070.006",name:"Timestomp",reference:"https://attack.mitre.org/techniques/T1070/006",tactics:"defense-evasion",techniqueId:"T1070",value:"timestomp"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.tokenImpersonationTheftT1134Description",{defaultMessage:"Token Impersonation/Theft (T1134.001)"}),id:"T1134.001",name:"Token Impersonation/Theft",reference:"https://attack.mitre.org/techniques/T1134/001",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1134",value:"tokenImpersonationTheft"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.toolT1588Description",{defaultMessage:"Tool (T1588.002)"}),id:"T1588.002",name:"Tool",reference:"https://attack.mitre.org/techniques/T1588/002",tactics:"resource-development",techniqueId:"T1588",value:"tool"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.trafficDuplicationT1020Description",{defaultMessage:"Traffic Duplication (T1020.001)"}),id:"T1020.001",name:"Traffic Duplication",reference:"https://attack.mitre.org/techniques/T1020/001",tactics:"exfiltration",techniqueId:"T1020",value:"trafficDuplication"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.transmittedDataManipulationT1565Description",{defaultMessage:"Transmitted Data Manipulation (T1565.002)"}),id:"T1565.002",name:"Transmitted Data Manipulation",reference:"https://attack.mitre.org/techniques/T1565/002",tactics:"impact",techniqueId:"T1565",value:"transmittedDataManipulation"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.transportAgentT1505Description",{defaultMessage:"Transport Agent (T1505.002)"}),id:"T1505.002",name:"Transport Agent",reference:"https://attack.mitre.org/techniques/T1505/002",tactics:"persistence",techniqueId:"T1505",value:"transportAgent"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.trapT1546Description",{defaultMessage:"Trap (T1546.005)"}),id:"T1546.005",name:"Trap",reference:"https://attack.mitre.org/techniques/T1546/005",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"trap"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.unixShellT1059Description",{defaultMessage:"Unix Shell (T1059.004)"}),id:"T1059.004",name:"Unix Shell",reference:"https://attack.mitre.org/techniques/T1059/004",tactics:"execution",techniqueId:"T1059",value:"unixShell"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.userActivityBasedChecksT1497Description",{defaultMessage:"User Activity Based Checks (T1497.002)"}),id:"T1497.002",name:"User Activity Based Checks",reference:"https://attack.mitre.org/techniques/T1497/002",tactics:"defense-evasion,discovery",techniqueId:"T1497",value:"userActivityBasedChecks"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.vbaStompingT1564Description",{defaultMessage:"VBA Stomping (T1564.007)"}),id:"T1564.007",name:"VBA Stomping",reference:"https://attack.mitre.org/techniques/T1564/007",tactics:"defense-evasion",techniqueId:"T1564",value:"vbaStomping"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.vdsoHijackingT1055Description",{defaultMessage:"VDSO Hijacking (T1055.014)"}),id:"T1055.014",name:"VDSO Hijacking",reference:"https://attack.mitre.org/techniques/T1055/014",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1055",value:"vdsoHijacking"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.vncT1021Description",{defaultMessage:"VNC (T1021.005)"}),id:"T1021.005",name:"VNC",reference:"https://attack.mitre.org/techniques/T1021/005",tactics:"lateral-movement",techniqueId:"T1021",value:"vnc"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.verclsidT1218Description",{defaultMessage:"Verclsid (T1218.012)"}),id:"T1218.012",name:"Verclsid",reference:"https://attack.mitre.org/techniques/T1218/012",tactics:"defense-evasion",techniqueId:"T1218",value:"verclsid"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.virtualPrivateServerT1583Description",{defaultMessage:"Virtual Private Server (T1583.003)"}),id:"T1583.003",name:"Virtual Private Server",reference:"https://attack.mitre.org/techniques/T1583/003",tactics:"resource-development",techniqueId:"T1583",value:"virtualPrivateServer"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.virtualPrivateServerT1584Description",{defaultMessage:"Virtual Private Server (T1584.003)"}),id:"T1584.003",name:"Virtual Private Server",reference:"https://attack.mitre.org/techniques/T1584/003",tactics:"resource-development",techniqueId:"T1584",value:"virtualPrivateServer"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.visualBasicT1059Description",{defaultMessage:"Visual Basic (T1059.005)"}),id:"T1059.005",name:"Visual Basic",reference:"https://attack.mitre.org/techniques/T1059/005",tactics:"execution",techniqueId:"T1059",value:"visualBasic"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.vulnerabilitiesT1588Description",{defaultMessage:"Vulnerabilities (T1588.006)"}),id:"T1588.006",name:"Vulnerabilities",reference:"https://attack.mitre.org/techniques/T1588/006",tactics:"resource-development",techniqueId:"T1588",value:"vulnerabilities"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.vulnerabilityScanningT1595Description",{defaultMessage:"Vulnerability Scanning (T1595.002)"}),id:"T1595.002",name:"Vulnerability Scanning",reference:"https://attack.mitre.org/techniques/T1595/002",tactics:"reconnaissance",techniqueId:"T1595",value:"vulnerabilityScanning"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.whoisT1596Description",{defaultMessage:"WHOIS (T1596.002)"}),id:"T1596.002",name:"WHOIS",reference:"https://attack.mitre.org/techniques/T1596/002",tactics:"reconnaissance",techniqueId:"T1596",value:"whois"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.webPortalCaptureT1056Description",{defaultMessage:"Web Portal Capture (T1056.003)"}),id:"T1056.003",name:"Web Portal Capture",reference:"https://attack.mitre.org/techniques/T1056/003",tactics:"collection,credential-access",techniqueId:"T1056",value:"webPortalCapture"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.webProtocolsT1071Description",{defaultMessage:"Web Protocols (T1071.001)"}),id:"T1071.001",name:"Web Protocols",reference:"https://attack.mitre.org/techniques/T1071/001",tactics:"command-and-control",techniqueId:"T1071",value:"webProtocols"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.webServicesT1583Description",{defaultMessage:"Web Services (T1583.006)"}),id:"T1583.006",name:"Web Services",reference:"https://attack.mitre.org/techniques/T1583/006",tactics:"resource-development",techniqueId:"T1583",value:"webServices"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.webServicesT1584Description",{defaultMessage:"Web Services (T1584.006)"}),id:"T1584.006",name:"Web Services",reference:"https://attack.mitre.org/techniques/T1584/006",tactics:"resource-development",techniqueId:"T1584",value:"webServices"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.webSessionCookieT1550Description",{defaultMessage:"Web Session Cookie (T1550.004)"}),id:"T1550.004",name:"Web Session Cookie",reference:"https://attack.mitre.org/techniques/T1550/004",tactics:"defense-evasion,lateral-movement",techniqueId:"T1550",value:"webSessionCookie"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.webShellT1505Description",{defaultMessage:"Web Shell (T1505.003)"}),id:"T1505.003",name:"Web Shell",reference:"https://attack.mitre.org/techniques/T1505/003",tactics:"persistence",techniqueId:"T1505",value:"webShell"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.windowsCommandShellT1059Description",{defaultMessage:"Windows Command Shell (T1059.003)"}),id:"T1059.003",name:"Windows Command Shell",reference:"https://attack.mitre.org/techniques/T1059/003",tactics:"execution",techniqueId:"T1059",value:"windowsCommandShell"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.windowsFileAndDirectoryPermissionsModificationT1222Description",{defaultMessage:"Windows File and Directory Permissions Modification (T1222.001)"}),id:"T1222.001",name:"Windows File and Directory Permissions Modification",reference:"https://attack.mitre.org/techniques/T1222/001",tactics:"defense-evasion",techniqueId:"T1222",value:"windowsFileAndDirectoryPermissionsModification"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.windowsManagementInstrumentationEventSubscriptionT1546Description",{defaultMessage:"Windows Management Instrumentation Event Subscription (T1546.003)"}),id:"T1546.003",name:"Windows Management Instrumentation Event Subscription",reference:"https://attack.mitre.org/techniques/T1546/003",tactics:"privilege-escalation,persistence",techniqueId:"T1546",value:"windowsManagementInstrumentationEventSubscription"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.windowsRemoteManagementT1021Description",{defaultMessage:"Windows Remote Management (T1021.006)"}),id:"T1021.006",name:"Windows Remote Management",reference:"https://attack.mitre.org/techniques/T1021/006",tactics:"lateral-movement",techniqueId:"T1021",value:"windowsRemoteManagement"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.windowsServiceT1543Description",{defaultMessage:"Windows Service (T1543.003)"}),id:"T1543.003",name:"Windows Service",reference:"https://attack.mitre.org/techniques/T1543/003",tactics:"persistence,privilege-escalation",techniqueId:"T1543",value:"windowsService"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.winlogonHelperDllT1547Description",{defaultMessage:"Winlogon Helper DLL (T1547.004)"}),id:"T1547.004",name:"Winlogon Helper DLL",reference:"https://attack.mitre.org/techniques/T1547/004",tactics:"persistence,privilege-escalation",techniqueId:"T1547",value:"winlogonHelperDll"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.additionalCloudCredentialsT1098Description",{defaultMessage:"Additional Cloud Credentials (T1098.001)"}),id:"T1098.001",name:"Additional Cloud Credentials",reference:"https://attack.mitre.org/techniques/T1098/001",tactics:"persistence",techniqueId:"T1098",value:"additionalCloudCredentials"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.groupPolicyModificationT1484Description",{defaultMessage:"Group Policy Modification (T1484.001)"}),id:"T1484.001",name:"Group Policy Modification",reference:"https://attack.mitre.org/techniques/T1484/001",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1484",value:"groupPolicyModification"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.domainTrustModificationT1484Description",{defaultMessage:"Domain Trust Modification (T1484.002)"}),id:"T1484.002",name:"Domain Trust Modification",reference:"https://attack.mitre.org/techniques/T1484/002",tactics:"defense-evasion,privilege-escalation",techniqueId:"T1484",value:"domainTrustModification"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.webCookiesT1606Description",{defaultMessage:"Web Cookies (T1606.001)"}),id:"T1606.001",name:"Web Cookies",reference:"https://attack.mitre.org/techniques/T1606/001",tactics:"credential-access",techniqueId:"T1606",value:"webCookies"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttackSubtechniques.samlTokensT1606Description",{defaultMessage:"SAML Tokens (T1606.002)"}),id:"T1606.002",name:"SAML Tokens",reference:"https://attack.mitre.org/techniques/T1606/002",tactics:"credential-access",techniqueId:"T1606",value:"samlTokens"}],FILTERS_LABEL=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.filtersLabel",{defaultMessage:"Filters"}),QUERY_LABEL=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.QueryLabel",{defaultMessage:"Custom query"}),THREAT_QUERY_LABEL=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.threatQueryLabel",{defaultMessage:"Indicator index query"}),SAVED_ID_LABEL=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.savedIdLabel",{defaultMessage:"Saved query name"}),ML_TYPE_DESCRIPTION=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.mlRuleTypeDescription",{defaultMessage:"Machine Learning"}),EQL_TYPE_DESCRIPTION=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.eqlRuleTypeDescription",{defaultMessage:"Event Correlation"}),QUERY_TYPE_DESCRIPTION=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.queryRuleTypeDescription",{defaultMessage:"Query"}),THRESHOLD_TYPE_DESCRIPTION=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.thresholdRuleTypeDescription",{defaultMessage:"Threshold"}),THREAT_MATCH_TYPE_DESCRIPTION=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.threatMatchRuleTypeDescription",{defaultMessage:"Indicator Match"}),ML_JOB_STARTED=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.mlJobStartedDescription",{defaultMessage:"Started"}),ML_JOB_STOPPED=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.mlJobStoppedDescription",{defaultMessage:"Stopped"}),THRESHOLD_RESULTS_ALL=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.thresholdResultsAllDescription",{defaultMessage:"All results"}),THRESHOLD_RESULTS_AGGREGATED_BY=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.thresholdResultsAggregatedByDescription",{defaultMessage:"Results aggregated by"}),SeverityBadgeComponent=({value:value})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHealth,{"data-test-subj":"severity",color:"low"===value?external_kbnSharedDeps_Theme_euiLightVars_default.a.euiColorVis0:"medium"===value?external_kbnSharedDeps_Theme_euiLightVars_default.a.euiColorVis5:"high"===value?external_kbnSharedDeps_Theme_euiLightVars_default.a.euiColorVis7:external_kbnSharedDeps_Theme_euiLightVars_default.a.euiColorVis9},Object(external_kbnSharedDeps_LodashFp_.upperFirst)(value)),SeverityBadge=external_kbnSharedDeps_React_default.a.memo(SeverityBadgeComponent);var list_tree_icon=__webpack_require__(1026),list_tree_icon_default=__webpack_require__.n(list_tree_icon),empty_value=__webpack_require__(122);const NoteDescriptionContainer=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexItem).withConfig({displayName:"NoteDescriptionContainer",componentId:"sc-123zi2b-0"})(["height:105px;overflow-y:hidden;"]),isNotEmptyArray=values=>!Object(external_kbnSharedDeps_LodashFp_.isEmpty)(values.join("")),EuiBadgeWrap=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiBadge).withConfig({displayName:"EuiBadgeWrap",componentId:"sc-123zi2b-1"})([".euiBadge__text{white-space:pre-wrap !important;}"]),Query=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"Query",componentId:"sc-123zi2b-2"})(["white-space:pre-wrap;"]),buildQueryBarDescription=({field:field,filters:filters,filterManager:filterManager,query:query,savedId:savedId,indexPatterns:indexPatterns,queryLabel:queryLabel})=>{let items=[];return Object(external_kbnSharedDeps_LodashFp_.isEmpty)(filters)||(filterManager.setFilters(filters),items=[...items,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,FILTERS_LABEL," "),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{wrap:!0,responsive:!1,gutterSize:"xs"},filterManager.getFilters().map((filter,index)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,key:`${field}-filter-${index}`},external_kbnSharedDeps_React_default.a.createElement(EuiBadgeWrap,{color:"hollow"},null!=indexPatterns?external_kbnSharedDeps_React_default.a.createElement(public_.esFilters.FilterLabel,{filter:filter,valueLabel:public_.esFilters.getDisplayValueFromFilter(filter,[indexPatterns])}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingSpinner,{size:"m"})))))}]),Object(external_kbnSharedDeps_LodashFp_.isEmpty)(query)||(items=[...items,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,null!=queryLabel?queryLabel:QUERY_LABEL),description:external_kbnSharedDeps_React_default.a.createElement(Query,null,query)}]),Object(external_kbnSharedDeps_LodashFp_.isEmpty)(savedId)||(items=[...items,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,SAVED_ID_LABEL," "),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,savedId," ")}]),items},ThreatEuiFlexGroup=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup).withConfig({displayName:"ThreatEuiFlexGroup",componentId:"sc-123zi2b-3"})([".euiFlexItem{margin-bottom:0px;}"]),SubtechniqueFlexItem=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexItem).withConfig({displayName:"SubtechniqueFlexItem",componentId:"sc-123zi2b-4"})(["margin-left:",";"],({theme:theme})=>theme.eui.paddingSizes.m),TechniqueLinkItem=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty).withConfig({displayName:"TechniqueLinkItem",componentId:"sc-123zi2b-5"})([".euiIcon{width:8px;height:8px;}align-self:flex-start;"]),OverrideColumn=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexItem).withConfig({displayName:"OverrideColumn",componentId:"sc-123zi2b-6"})(["width:125px;max-width:125px;overflow:hidden;text-overflow:ellipsis;"]),MyRefUrlLink=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiLink).withConfig({displayName:"MyRefUrlLink",componentId:"sc-123zi2b-7"})(["word-break:break-word;"]);var MessageLevels,ml_public_=__webpack_require__(95),use_security_jobs=__webpack_require__(499);!function(MessageLevels){MessageLevels.info="info",MessageLevels.warning="warning",MessageLevels.error="error"}(MessageLevels||(MessageLevels={}));const AuditIconComponent=({message:message})=>{if(!message)return null;let color="primary",icon="alert";return message.level===MessageLevels.info?icon="iInCircle":message.level===MessageLevels.warning?color="warning":message.level===MessageLevels.error&&(color="danger"),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{content:message.text},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{type:icon,color:color}))},AuditIcon=external_kbnSharedDeps_React_default.a.memo(AuditIconComponent),JobStatusBadgeComponent=({job:job})=>{const isStarted=Object(helpers.c)(job.jobState,job.datafeedState),color=isStarted?"secondary":"danger",text=isStarted?ML_JOB_STARTED:ML_JOB_STOPPED;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBadge,{"data-test-subj":"machineLearningJobStatus",color:color},text)},JobStatusBadge=external_kbnSharedDeps_React_default.a.memo(JobStatusBadgeComponent),JobLink=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiLink).withConfig({displayName:"JobLink",componentId:"c3w1h4-0"})(["margin-right:",";"],({theme:theme})=>theme.eui.euiSizeS),Wrapper=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"Wrapper",componentId:"c3w1h4-1"})(["overflow:hidden;"]),MlJobDescriptionComponent=({jobId:jobId})=>{const{jobs:jobs}=Object(use_security_jobs.a)(!1),{services:{http:http,ml:ml}}=Object(lib_kibana.h)(),jobUrl=Object(ml_public_.useMlHref)(ml,http.basePath.get(),{page:ml_public_.ML_PAGES.ANOMALY_DETECTION_JOBS_MANAGE,pageState:{jobId:[jobId]}}),job=jobs.find(({id:id})=>id===jobId),jobIdSpan=external_kbnSharedDeps_React_default.a.createElement("span",{"data-test-subj":"machineLearningJobId"},jobId);return null!=job?external_kbnSharedDeps_React_default.a.createElement(Wrapper,null,external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(JobLink,{href:jobUrl,target:"_blank"},jobIdSpan),external_kbnSharedDeps_React_default.a.createElement(AuditIcon,{message:job.auditMessage})),external_kbnSharedDeps_React_default.a.createElement(JobStatusBadge,{job:job})):jobIdSpan},MlJobDescription=external_kbnSharedDeps_React_default.a.memo(MlJobDescriptionComponent),MlJobsDescription=({jobIds:jobIds})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,jobIds.map(jobId=>external_kbnSharedDeps_React_default.a.createElement(MlJobDescription,{key:jobId,jobId:jobId}))),ActionsDescription=({actions:actions})=>actions.length?external_kbnSharedDeps_React_default.a.createElement("ul",null,actions.map((action,index)=>external_kbnSharedDeps_React_default.a.createElement("li",{key:index},getActionTypeName(action.actionTypeId)))):null,getActionTypeName=actionTypeId=>{if(!actionTypeId)return"";const actionType=actionTypeId.split(".")[1];return actionType?Object(external_kbnSharedDeps_LodashFp_.startCase)(actionType):""};function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const THROTTLE_OPTIONS=[{value:constants.Z,text:"Perform no actions"},{value:constants.ab,text:"On each rule execution"},{value:"1h",text:"Hourly"},{value:"1d",text:"Daily"},{value:"7d",text:"Weekly"}],DEFAULT_THROTTLE_OPTION=THROTTLE_OPTIONS[0],ThrottleSelectField=props=>{const{setValue:setValue}=props.field,onChange=Object(external_kbnSharedDeps_React_.useCallback)(e=>{const throttle=e.target.value;setValue(throttle)},[setValue]),newEuiFieldProps={...props.euiFieldProps,onChange:onChange};return external_kbnSharedDeps_React_default.a.createElement(shared_imports.j,_extends({},props,{euiFieldProps:newEuiFieldProps}))},buildThrottleDescription=(value=DEFAULT_THROTTLE_OPTION.value,title)=>{const throttleOption=Object(external_kbnSharedDeps_LodashFp_.find)(["value",value],THROTTLE_OPTIONS);return{title:title,description:throttleOption?throttleOption.text:value}},DescriptionListContainer=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiDescriptionList).withConfig({displayName:"DescriptionListContainer",componentId:"sc-1jqwta0-0"})(["&.euiDescriptionList--column .euiDescriptionList__title{width:30%;}&.euiDescriptionList--column .euiDescriptionList__description{width:70%;overflow-wrap:anywhere;}"]),StepRuleDescriptionComponent=({data:data,columns:columns="multi",indexPatterns:indexPatterns,schema:schema})=>{const kibana=Object(lib_kibana.h)(),[filterManager]=Object(external_kbnSharedDeps_React_.useState)(new public_.FilterManager(kibana.services.uiSettings)),listItems=Object.keys(schema).reduce((acc,key)=>{return"machineLearningJobId"===key?[...acc,(jobIds=Object(external_kbnSharedDeps_LodashFp_.get)(key,data),label=Object(external_kbnSharedDeps_LodashFp_.get)(key,schema).label,{title:label,description:external_kbnSharedDeps_React_default.a.createElement(MlJobsDescription,{jobIds:jobIds})})]:"throttle"===key?[...acc,buildThrottleDescription(Object(external_kbnSharedDeps_LodashFp_.get)(key,data),Object(external_kbnSharedDeps_LodashFp_.get)([key,"label"],schema))]:"actions"===key?[...acc,(actions=Object(external_kbnSharedDeps_LodashFp_.get)(key,data),title=Object(external_kbnSharedDeps_LodashFp_.get)([key,"label"],schema),{title:actions.length?title:"",description:external_kbnSharedDeps_React_default.a.createElement(ActionsDescription,{actions:actions})})]:[...acc,...buildListItems(data,Object(external_kbnSharedDeps_LodashFp_.pick)(key,schema),filterManager,indexPatterns)];var jobIds,label,actions,title},[]);return"multi"===columns?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,Object(external_kbnSharedDeps_LodashFp_.chunk)(Math.ceil(listItems.length/2),listItems).map((chunkListItems,index)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{"data-test-subj":"listItemColumnStepRuleDescription",key:"description-step-rule-"+index},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionList,{listItems:chunkListItems})))):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{"data-test-subj":"listItemColumnStepRuleDescription"},"single"===columns?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionList,{listItems:listItems}):external_kbnSharedDeps_React_default.a.createElement(DescriptionListContainer,{"data-test-subj":"singleSplitStepRuleDescriptionList",type:"column",listItems:listItems})))},StepRuleDescription=Object(external_kbnSharedDeps_React_.memo)(StepRuleDescriptionComponent),buildListItems=(data,schema,filterManager,indexPatterns)=>Object.keys(schema).reduce((acc,field)=>[...acc,...getDescriptionItem(field,Object(external_kbnSharedDeps_LodashFp_.get)([field,"label"],schema),data,filterManager,indexPatterns)],[]),addFilterStateIfNotThere=filters=>filters.map(filter=>null==filter.$state?{$state:{store:public_.esFilters.FilterStateStore.APP_STATE},...filter}:filter),getDescriptionItem=(field,label,data,filterManager,indexPatterns)=>{if("queryBar"===field){var _get;const filters=addFilterStateIfNotThere(null!==(_get=Object(external_kbnSharedDeps_LodashFp_.get)("queryBar.filters",data))&&void 0!==_get?_get:[]),query=Object(external_kbnSharedDeps_LodashFp_.get)("queryBar.query.query",data),savedId=Object(external_kbnSharedDeps_LodashFp_.get)("queryBar.saved_id",data);return buildQueryBarDescription({field:field,filters:filters,filterManager:filterManager,query:query,savedId:savedId,indexPatterns:indexPatterns})}if("threat"===field){const threats=Object(external_kbnSharedDeps_LodashFp_.get)(field,data);return(({label:label,threat:threat})=>threat.length>0?[{title:label,description:external_kbnSharedDeps_React_default.a.createElement(ThreatEuiFlexGroup,{direction:"column"},threat.map((singleThreat,index)=>{const tactic=tacticsOptions.find(t=>t.id===singleThreat.tactic.id);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{key:`${singleThreat.tactic.name}-${index}`},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{"data-test-subj":"threatTacticLink",href:singleThreat.tactic.reference,target:"_blank"},null!=tactic?tactic.text:`${singleThreat.tactic.name} (${singleThreat.tactic.id})`),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"none",alignItems:"flexStart",direction:"column"},singleThreat.technique&&singleThreat.technique.map((technique,techniqueIndex)=>{var _myTechnique$id;const myTechnique=techniquesOptions.find(t=>t.id===technique.id);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{key:null!==(_myTechnique$id=null==myTechnique?void 0:myTechnique.id)&&void 0!==_myTechnique$id?_myTechnique$id:techniqueIndex},external_kbnSharedDeps_React_default.a.createElement(TechniqueLinkItem,{"data-test-subj":"threatTechniqueLink",href:technique.reference,target:"_blank",iconType:list_tree_icon_default.a,size:"xs"},null!=myTechnique?myTechnique.label:`${technique.name} (${technique.id})`),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"none",alignItems:"flexStart",direction:"column"},null!=technique.subtechnique&&technique.subtechnique.map((subtechnique,subtechniqueIndex)=>{var _mySubtechnique$id;const mySubtechnique=subtechniquesOptions.find(t=>t.id===subtechnique.id);return external_kbnSharedDeps_React_default.a.createElement(SubtechniqueFlexItem,{key:null!==(_mySubtechnique$id=null==mySubtechnique?void 0:mySubtechnique.id)&&void 0!==_mySubtechnique$id?_mySubtechnique$id:subtechniqueIndex},external_kbnSharedDeps_React_default.a.createElement(TechniqueLinkItem,{"data-test-subj":"threatSubtechniqueLink",href:subtechnique.reference,target:"_blank",iconType:list_tree_icon_default.a,size:"xs"},null!=mySubtechnique?mySubtechnique.label:`${subtechnique.name} (${subtechnique.id})`))})))})))}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null))}]:[])({label:label,threat:filterEmptyThreats(threats)})}if("threshold"===field){return((label,threshold)=>[{title:label,description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,Object(external_kbnSharedDeps_LodashFp_.isEmpty)(threshold.field[0])?`${THRESHOLD_RESULTS_ALL} >= ${threshold.value}`:`${THRESHOLD_RESULTS_AGGREGATED_BY} ${Array.isArray(threshold.field)?threshold.field.join(","):threshold.field} >= ${threshold.value}`)}])(label,Object(external_kbnSharedDeps_LodashFp_.get)(field,data))}if("references"===field){return((label,values)=>isNotEmptyArray(values)?[{title:label,description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"s"},external_kbnSharedDeps_React_default.a.createElement("ul",null,values.filter(v=>!Object(external_kbnSharedDeps_LodashFp_.isEmpty)(v)).map((val,index)=>external_kbnSharedDeps_React_default.a.createElement("li",{"data-test-subj":"urlsDescriptionReferenceLinkItem",key:`${index}-${val}`},external_kbnSharedDeps_React_default.a.createElement(MyRefUrlLink,{href:val,external:!0,target:"_blank"},val)))))}]:[])(label,Object(external_kbnSharedDeps_LodashFp_.get)(field,data))}if("falsePositives"===field){return((label,field,values)=>isNotEmptyArray(values)?[{title:label,description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"s"},external_kbnSharedDeps_React_default.a.createElement("ul",null,values.map(val=>Object(external_kbnSharedDeps_LodashFp_.isEmpty)(val)?null:external_kbnSharedDeps_React_default.a.createElement("li",{"data-test-subj":"unorderedListArrayDescriptionItem",key:`${field}-${val}`},val))))}]:[])(label,field,Object(external_kbnSharedDeps_LodashFp_.get)(field,data))}if(Array.isArray(Object(external_kbnSharedDeps_LodashFp_.get)(field,data))&&"threatMapping"!==field){return((label,field,values)=>isNotEmptyArray(values)?[{title:label,description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{responsive:!1,gutterSize:"xs",wrap:!0},values.map(val=>Object(external_kbnSharedDeps_LodashFp_.isEmpty)(val)?null:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,key:`${field}-${val}`},external_kbnSharedDeps_React_default.a.createElement(EuiBadgeWrap,{"data-test-subj":"stringArrayDescriptionBadgeItem",color:"hollow"},val))))}]:[])(label,field,Object(external_kbnSharedDeps_LodashFp_.get)(field,data))}if("riskScore"===field){const values=Object(external_kbnSharedDeps_LodashFp_.get)(field,data);return[{title:RISK_SCORE,description:(riskScore=values).value},...riskScore.isMappingChecked?riskScore.mapping.filter(riskScoreItem=>""!==riskScoreItem.field).map((riskScoreItem,index)=>({title:0===index?RISK_SCORE_MAPPING:"",description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(OverrideColumn,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{content:riskScoreItem.field,"data-test-subj":"riskScoreOverrideField"+index},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,riskScoreItem.field))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{type:"sortRight"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,"signal.rule.risk_score"))})):[]]}if("severity"===field){const values=Object(external_kbnSharedDeps_LodashFp_.get)(field,data);return severity=values,[{title:DEFAULT_SEVERITY,description:external_kbnSharedDeps_React_default.a.createElement(SeverityBadge,{value:severity.value})},...severity.isMappingChecked?severity.mapping.filter(severityItem=>""!==severityItem.field).map((severityItem,index)=>({title:0===index?SEVERITY_MAPPING:"",description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(OverrideColumn,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{content:severityItem.field,"data-test-subj":"severityOverrideField"+index},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,severityItem.field+":"))),external_kbnSharedDeps_React_default.a.createElement(OverrideColumn,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{content:severityItem.value,"data-test-subj":"severityOverrideValue"+index},Object(empty_value.a)(severityItem.value))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{type:"sortRight"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(SeverityBadge,{"data-test-subj":"severityOverrideSeverity"+index,value:severityItem.severity})))})):[]]}if("timeline"===field){var _timeline$title;return[{title:label,description:null!==(_timeline$title=Object(external_kbnSharedDeps_LodashFp_.get)(field,data).title)&&void 0!==_timeline$title?_timeline$title:timeline_translations.b}]}if("note"===field){return((label,note)=>""!==note.trim()?[{title:label,description:external_kbnSharedDeps_React_default.a.createElement(NoteDescriptionContainer,null,external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":"noteDescriptionItem",className:"eui-yScrollWithShadows"},note))}]:[])(label,Object(external_kbnSharedDeps_LodashFp_.get)(field,data))}if("ruleType"===field){return((label,ruleType)=>{switch(ruleType){case"machine_learning":return[{title:label,description:ML_TYPE_DESCRIPTION}];case"query":case"saved_query":return[{title:label,description:QUERY_TYPE_DESCRIPTION}];case"threshold":return[{title:label,description:THRESHOLD_TYPE_DESCRIPTION}];case"eql":return[{title:label,description:EQL_TYPE_DESCRIPTION}];case"threat_match":return[{title:label,description:THREAT_MATCH_TYPE_DESCRIPTION}];default:return Object(utility_types.a)(ruleType)}})(label,Object(external_kbnSharedDeps_LodashFp_.get)(field,data))}if("kibanaSiemAppUrl"===field)return[];if("threatQueryBar"===field){var _get2;const filters=addFilterStateIfNotThere(null!==(_get2=Object(external_kbnSharedDeps_LodashFp_.get)("threatQueryBar.filters",data))&&void 0!==_get2?_get2:[]),query=Object(external_kbnSharedDeps_LodashFp_.get)("threatQueryBar.query.query",data),savedId=Object(external_kbnSharedDeps_LodashFp_.get)("threatQueryBar.saved_id",data);return buildQueryBarDescription({field:field,filters:filters,filterManager:filterManager,query:query,savedId:savedId,indexPatterns:indexPatterns,queryLabel:THREAT_QUERY_LABEL})}if("threatMapping"===field){const threatMap=Object(external_kbnSharedDeps_LodashFp_.get)(field,data);return[{title:label,description:threatMap.reduce((accumThreatMaps,threatMap,threatMapIndex,{length:threatMappingLength})=>{const matches=threatMap.entries.reduce((accumItems,item,itemsIndex,{length:threatMapLength})=>1===threatMapLength?`${item.field} ${MATCHES} ${item.value}`:0===itemsIndex?`(${item.field} ${MATCHES} ${item.value})`:`${accumItems} ${AND} (${item.field} ${MATCHES} ${item.value})`,"");return 1===threatMappingLength?""+matches:0===threatMapIndex?`(${matches})`:`${accumThreatMaps} ${OR} (${matches})`},"")}]}var severity,riskScore;const description=Object(external_kbnSharedDeps_LodashFp_.get)(field,data);return Object(external_kbnSharedDeps_LodashFp_.isNumber)(description)||!Object(external_kbnSharedDeps_LodashFp_.isEmpty)(description)?[{title:label,description:description}]:[]};var external_kbnSharedDeps_Rxjs_=__webpack_require__(15),fast_deep_equal=__webpack_require__(112),fast_deep_equal_default=__webpack_require__.n(fast_deep_equal),open_timeline_modal=__webpack_require__(675),query_bar=__webpack_require__(383),timeline_helpers=__webpack_require__(126),timeline_query_bar=__webpack_require__(479),keury=__webpack_require__(165),saved_query_services=__webpack_require__(384);const IMPORT_TIMELINE_MODAL=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.importTimelineModalTitle",{defaultMessage:"Import query from saved timeline"}),actionTimelineToHide=["duplicate","createFrom"],StyledEuiFormRow=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFormRow).withConfig({displayName:"StyledEuiFormRow",componentId:"sc-8c6vgp-0"})([".kbnTypeahead__items{max-height:45vh !important;}.globalQueryBar{padding:4px 0px 0px 0px;.kbnQueryBar{& > div:first-child{margin:0px 0px 0px 4px;}}}"]),QueryBarDefineRule=({browserFields:browserFields,dataTestSubj:dataTestSubj,field:field,idAria:idAria,indexPattern:indexPattern,isLoading:isLoading=!1,onCloseTimelineSearch:onCloseTimelineSearch,openTimelineSearch:openTimelineSearch=!1,resizeParentContainer:resizeParentContainer,onValidityChange:onValidityChange})=>{const{value:fieldValue,setValue:setFieldValue}=field,[originalHeight,setOriginalHeight]=Object(external_kbnSharedDeps_React_.useState)(-1),[loadingTimeline,setLoadingTimeline]=Object(external_kbnSharedDeps_React_.useState)(!1),[savedQuery,setSavedQuery]=Object(external_kbnSharedDeps_React_.useState)(void 0),{isInvalid:isInvalid,errorMessage:errorMessage}=Object(shared_imports.w)(field),{uiSettings:uiSettings}=Object(lib_kibana.h)().services,[filterManager]=Object(external_kbnSharedDeps_React_.useState)(new public_.FilterManager(uiSettings)),savedQueryServices=Object(saved_query_services.a)();Object(external_kbnSharedDeps_React_.useEffect)(()=>{null!=onValidityChange&&onValidityChange(!isInvalid)},[isInvalid,onValidityChange]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{let isSubscribed=!0;const subscriptions=new external_kbnSharedDeps_Rxjs_.Subscription;return filterManager.setFilters([]),subscriptions.add(filterManager.getUpdates$().subscribe({next:()=>{if(isSubscribed){const newFilters=filterManager.getFilters(),{filters:filters}=fieldValue;fast_deep_equal_default()(filters,newFilters)||setFieldValue({...fieldValue,filters:newFilters})}}})),()=>{isSubscribed=!1,subscriptions.unsubscribe()}},[fieldValue,filterManager,setFieldValue]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{let isSubscribed=!0;return async function(){const{filters:filters,saved_id:savedId}=fieldValue;if(fast_deep_equal_default()(filters,filterManager.getFilters())||filterManager.setFilters(filters),null!=savedId&&null!=savedQuery&&savedId!==savedQuery.id||null!=savedId&&null==savedQuery)try{const mySavedQuery=await savedQueryServices.getSavedQuery(savedId);isSubscribed&&null!=mySavedQuery&&setSavedQuery(mySavedQuery)}catch{setSavedQuery(void 0)}else null==savedId&&null!=savedQuery&&setSavedQuery(void 0)}(),()=>{isSubscribed=!1}},[fieldValue,filterManager,savedQuery,savedQueryServices]);const onSubmitQuery=Object(external_kbnSharedDeps_React_.useCallback)(newQuery=>{const{query:query}=fieldValue;fast_deep_equal_default()(query,newQuery)||setFieldValue({...fieldValue,query:newQuery})},[fieldValue,setFieldValue]),onChangedQuery=Object(external_kbnSharedDeps_React_.useCallback)(newQuery=>{const{query:query}=fieldValue;fast_deep_equal_default()(query,newQuery)||setFieldValue({...fieldValue,query:newQuery})},[fieldValue,setFieldValue]),onSavedQuery=Object(external_kbnSharedDeps_React_.useCallback)(newSavedQuery=>{if(null!=newSavedQuery){const{saved_id:savedId}=fieldValue;var _newSavedQuery$attrib;if(newSavedQuery.id!==savedId)setSavedQuery(newSavedQuery),setFieldValue({filters:null!==(_newSavedQuery$attrib=newSavedQuery.attributes.filters)&&void 0!==_newSavedQuery$attrib?_newSavedQuery$attrib:[],query:newSavedQuery.attributes.query,saved_id:newSavedQuery.id});else setSavedQuery(newSavedQuery),setFieldValue({filters:[],query:{query:"",language:"kuery"},saved_id:void 0})}},[fieldValue,setFieldValue]),onCloseTimelineModal=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setLoadingTimeline(!0),onCloseTimelineSearch()},[onCloseTimelineSearch]),onOpenTimeline=Object(external_kbnSharedDeps_React_.useCallback)(timeline=>{var _timeline$kqlQuery$fi,_timeline$kqlQuery$fi2,_timeline$kqlQuery$fi3,_timeline$kqlQuery$fi4,_timeline$kqlQuery$fi5,_timeline$kqlQuery$fi6,_timeline$filters;setLoadingTimeline(!1);const newQuery={query:null!==(_timeline$kqlQuery$fi=null===(_timeline$kqlQuery$fi2=timeline.kqlQuery.filterQuery)||void 0===_timeline$kqlQuery$fi2||null===(_timeline$kqlQuery$fi3=_timeline$kqlQuery$fi2.kuery)||void 0===_timeline$kqlQuery$fi3?void 0:_timeline$kqlQuery$fi3.expression)&&void 0!==_timeline$kqlQuery$fi?_timeline$kqlQuery$fi:"",language:null!==(_timeline$kqlQuery$fi4=null===(_timeline$kqlQuery$fi5=timeline.kqlQuery.filterQuery)||void 0===_timeline$kqlQuery$fi5||null===(_timeline$kqlQuery$fi6=_timeline$kqlQuery$fi5.kuery)||void 0===_timeline$kqlQuery$fi6?void 0:_timeline$kqlQuery$fi6.kind)&&void 0!==_timeline$kqlQuery$fi4?_timeline$kqlQuery$fi4:"kuery"},dataProvidersDsl=null!=timeline.dataProviders&&timeline.dataProviders.length>0?Object(keury.a)(Object(timeline_helpers.i)(timeline.dataProviders,browserFields),indexPattern):"",newFilters=null!==(_timeline$filters=timeline.filters)&&void 0!==_timeline$filters?_timeline$filters:[];setFieldValue({filters:""!==dataProvidersDsl?[...newFilters,Object(timeline_query_bar.b)(dataProvidersDsl)]:newFilters,query:newQuery,saved_id:void 0})},[browserFields,indexPattern,setFieldValue]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(StyledEuiFormRow,{label:field.label,labelAppend:field.labelAppend,helpText:field.helpText,error:errorMessage,isInvalid:isInvalid,fullWidth:!0,"data-test-subj":dataTestSubj,describedByIds:idAria?[idAria]:void 0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiMutationObserver,{observerOptions:{subtree:!0,attributes:!0,childList:!0},onMutation:()=>{if(null!=resizeParentContainer){const suggestionContainer=document.getElementById("kbnTypeahead__items");if(null!=suggestionContainer){const box=suggestionContainer.getBoundingClientRect(),accordionContainer=document.getElementById("define-rule");if(null!=accordionContainer){const accordionBox=accordionContainer.getBoundingClientRect();(-1===originalHeight||accordionBox.height<originalHeight+box.height)&&resizeParentContainer(originalHeight+box.height-100),-1===originalHeight&&setOriginalHeight(accordionBox.height)}}else resizeParentContainer(-1)}}},mutationRef=>external_kbnSharedDeps_React_default.a.createElement("div",{ref:mutationRef},external_kbnSharedDeps_React_default.a.createElement(query_bar.a,{indexPattern:indexPattern,isLoading:isLoading||loadingTimeline,isRefreshPaused:!1,filterQuery:fieldValue.query,filterManager:filterManager,filters:filterManager.getFilters()||[],onChangedQuery:onChangedQuery,onSubmitQuery:onSubmitQuery,savedQuery:savedQuery,onSavedQuery:onSavedQuery,hideSavedQuery:!1})))),openTimelineSearch?external_kbnSharedDeps_React_default.a.createElement(open_timeline_modal.a,{hideActions:actionTimelineToHide,modalTitle:IMPORT_TIMELINE_MODAL,onClose:onCloseTimelineModal,onOpen:onOpenTimeline}):null)},EQL_TYPE_TITLE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.eqlTypeTitle",{defaultMessage:"Event Correlation"}),translations_EQL_TYPE_DESCRIPTION=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.eqlTypeDescription",{defaultMessage:"Use Event Query Language (EQL) to match events, generate sequences, and stack data"}),QUERY_TYPE_TITLE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.queryTypeTitle",{defaultMessage:"Custom query"}),translations_QUERY_TYPE_DESCRIPTION=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.queryTypeDescription",{defaultMessage:"Use KQL or Lucene to detect issues across indices."}),ML_TYPE_TITLE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.mlTypeTitle",{defaultMessage:"Machine Learning"}),translations_ML_TYPE_DESCRIPTION=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.mlTypeDescription",{defaultMessage:"Select ML job to detect anomalous activity."}),THRESHOLD_TYPE_TITLE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.thresholdTypeTitle",{defaultMessage:"Threshold"}),translations_THRESHOLD_TYPE_DESCRIPTION=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.thresholdTypeDescription",{defaultMessage:"Aggregate query results to detect when number of matches exceeds threshold."}),THREAT_MATCH_TYPE_TITLE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.threatMatchTitle",{defaultMessage:"Indicator Match"}),translations_THREAT_MATCH_TYPE_DESCRIPTION=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.threatMatchDescription",{defaultMessage:"Use indicators from intelligence sources to detect matching events and alerts."});var external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(76);const SmallText=external_kbnSharedDeps_StyledComponents_default.a.span.withConfig({displayName:"SmallText",componentId:"lss4m0-0"})(["font-size:",";"],({theme:theme})=>theme.eui.euiFontSizeS),MlCardDescriptionComponent=({subscriptionUrl:subscriptionUrl,hasValidLicense:hasValidLicense=!1})=>external_kbnSharedDeps_React_default.a.createElement(SmallText,null,hasValidLicense?translations_ML_TYPE_DESCRIPTION:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.createRule.stepDefineRule.ruleTypeField.mlTypeDisabledDescription",defaultMessage:"Access to ML requires a {subscriptionsLink}.",values:{subscriptionsLink:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{href:subscriptionUrl,target:"_blank"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.components.stepDefineRule.ruleTypeField.subscriptionsLink",defaultMessage:"Platinum subscription"}))}}));MlCardDescriptionComponent.displayName="MlCardDescriptionComponent";const MlCardDescription=external_kbnSharedDeps_React_default.a.memo(MlCardDescriptionComponent);MlCardDescription.displayName="MlCardDescription";const SelectRuleType=({describedByIds:describedByIds=[],field:field,isUpdateView:isUpdateView,hasValidLicense:hasValidLicense,isMlAdmin:isMlAdmin})=>{const ruleType=field.value,setType=Object(external_kbnSharedDeps_React_.useCallback)(type=>{field.setValue(type)},[field]),setEql=Object(external_kbnSharedDeps_React_.useCallback)(()=>setType("eql"),[setType]),setMl=Object(external_kbnSharedDeps_React_.useCallback)(()=>setType("machine_learning"),[setType]),setQuery=Object(external_kbnSharedDeps_React_.useCallback)(()=>setType("query"),[setType]),setThreshold=Object(external_kbnSharedDeps_React_.useCallback)(()=>setType("threshold"),[setType]),setThreatMatch=Object(external_kbnSharedDeps_React_.useCallback)(()=>setType("threat_match"),[setType]),licensingUrl=Object(lib_kibana.h)().services.application.getUrlForApp("kibana",{path:"#/management/stack/license_management"}),eqlSelectableConfig=Object(external_kbnSharedDeps_React_.useMemo)(()=>({onClick:setEql,isSelected:Object(utils.c)(ruleType)}),[ruleType,setEql]),querySelectableConfig=Object(external_kbnSharedDeps_React_.useMemo)(()=>({onClick:setQuery,isSelected:Object(utils.d)(ruleType)}),[ruleType,setQuery]),mlSelectableConfig=Object(external_kbnSharedDeps_React_.useMemo)(()=>({isDisabled:!hasValidLicense||!isMlAdmin,onClick:setMl,isSelected:Object(helpers.d)(ruleType)}),[ruleType,setMl,hasValidLicense,isMlAdmin]),thresholdSelectableConfig=Object(external_kbnSharedDeps_React_.useMemo)(()=>({onClick:setThreshold,isSelected:Object(utils.f)(ruleType)}),[ruleType,setThreshold]),threatMatchSelectableConfig=Object(external_kbnSharedDeps_React_.useMemo)(()=>({onClick:setThreatMatch,isSelected:Object(utils.e)(ruleType)}),[ruleType,setThreatMatch]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{fullWidth:!0,"data-test-subj":"selectRuleType",describedByIds:describedByIds,label:field.label},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGrid,{columns:3},(!isUpdateView||querySelectableConfig.isSelected)&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCard,{"data-test-subj":"customRuleType",title:QUERY_TYPE_TITLE,titleSize:"xs",description:translations_QUERY_TYPE_DESCRIPTION,icon:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{size:"xl",type:"search"}),selectable:querySelectableConfig,layout:"horizontal"})),(!isUpdateView||mlSelectableConfig.isSelected)&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCard,{"data-test-subj":"machineLearningRuleType",title:ML_TYPE_TITLE,titleSize:"xs",description:external_kbnSharedDeps_React_default.a.createElement(MlCardDescription,{subscriptionUrl:licensingUrl,hasValidLicense:hasValidLicense}),icon:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{size:"l",type:"machineLearningApp"}),isDisabled:mlSelectableConfig.isDisabled&&!mlSelectableConfig.isSelected,selectable:mlSelectableConfig,layout:"horizontal"})),(!isUpdateView||thresholdSelectableConfig.isSelected)&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCard,{"data-test-subj":"thresholdRuleType",title:THRESHOLD_TYPE_TITLE,titleSize:"xs",description:translations_THRESHOLD_TYPE_DESCRIPTION,icon:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{size:"l",type:"indexFlush"}),selectable:thresholdSelectableConfig,layout:"horizontal"})),(!isUpdateView||eqlSelectableConfig.isSelected)&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCard,{"data-test-subj":"eqlRuleType",title:EQL_TYPE_TITLE,titleSize:"xs",description:translations_EQL_TYPE_DESCRIPTION,icon:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{size:"l",type:"eql"}),selectable:eqlSelectableConfig,layout:"horizontal"})),(!isUpdateView||threatMatchSelectableConfig.isSelected)&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCard,{"data-test-subj":"threatMatchRuleType",title:THREAT_MATCH_TYPE_TITLE,titleSize:"xs",description:translations_THREAT_MATCH_TYPE_DESCRIPTION,icon:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{size:"l",type:"list"}),selectable:threatMatchSelectableConfig,layout:"horizontal"}))))},AnomalyThresholdSlider=({describedByIds:describedByIds=[],field:field})=>{const threshold=field.value,onThresholdChange=Object(external_kbnSharedDeps_React_.useCallback)(event=>{const thresholdValue=Number(event.target.value);field.setValue(thresholdValue)},[field]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:field.label,"data-test-subj":"anomalyThresholdSlider",describedByIds:describedByIds},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiRange,{value:threshold,onChange:onThresholdChange,fullWidth:!0,showInput:!0,showRange:!0,showTicks:!0,tickInterval:25}))))},CUSTOM_QUERY_REQUIRED=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.customQueryFieldRequiredError",{defaultMessage:"A custom query is required."}),INVALID_CUSTOM_QUERY=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.customQueryFieldInvalidError",{defaultMessage:"The KQL is invalid"}),INDEX_HELPER_TEXT=(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.indicesFromConfigDescription",{defaultMessage:"Use Elasticsearch indices from Security Solution advanced settings"}),external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.indicesCustomDescription",{defaultMessage:"Provide custom list of indices"}),external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.indicesHelperDescription",{defaultMessage:"Enter the pattern of Elasticsearch indices where you would like this rule to run. By default, these will include index patterns defined in Security Solution advanced settings."})),RESET_DEFAULT_INDEX=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.resetDefaultIndicesButton",{defaultMessage:"Reset to default index patterns"}),IMPORT_TIMELINE_QUERY=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.importTimelineQueryButton",{defaultMessage:"Import query from saved timeline"}),ML_JOB_SELECT_PLACEHOLDER_TEXT=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.mlJobSelectPlaceholderText",{defaultMessage:"Select a job"}),QUERY_BAR_LABEL=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldQuerBarLabel",{defaultMessage:"Custom query"}),EQL_QUERY_BAR_LABEL=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.EqlQueryBarLabel",{defaultMessage:"EQL query"}),THREAT_MATCH_INDEX_HELPER_TEXT=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.threatMatchingIcesHelperDescription",{defaultMessage:"Select threat indices"}),THREAT_MATCH_REQUIRED=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.customThreatQueryFieldRequiredError",{defaultMessage:"At least one indicator match is required."}),THREAT_MATCH_EMPTIES=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.customThreatQueryFieldRequiredEmptyError",{defaultMessage:"All matches require both a field and threat index field."}),HelpTextWarningContainer=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"HelpTextWarningContainer",componentId:"v7btd6-0"})(["margin-top:10px;"]),HelpTextComponent=({href:href,notRunningJobIds:notRunningJobIds})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.createRule.stepDefineRule.machineLearningJobIdHelpText",defaultMessage:"We've provided a few common jobs to get you started. To add your own custom jobs, assign a group of 'security' to those jobs in the {machineLearning} application to make them appear here.",values:{machineLearning:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{href:href,target:"_blank"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.components.mlJobSelect.machineLearningLink",defaultMessage:"Machine Learning"}))}}),notRunningJobIds.length>0&&external_kbnSharedDeps_React_default.a.createElement(HelpTextWarningContainer,{"data-test-subj":"ml-warning-not-running-jobs"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs",color:"warning"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{type:"alert"}),external_kbnSharedDeps_React_default.a.createElement("span",null,1===notRunningJobIds.length?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.createRule.stepDefineRule.mlEnableJobSingle",defaultMessage:"The selected ML job, {jobName}, is not currently running. Please set {jobName} to run via 'ML job settings' before activating this rule.",values:{jobName:notRunningJobIds[0]}}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.createRule.stepDefineRule.mlEnableJobMulti",defaultMessage:"The selected ML jobs, {jobNames}, are not currently running. Please set all of these jobs to run via 'ML job settings' before activating this rule.",values:{jobNames:notRunningJobIds.reduce((acc,value,i,array)=>acc+(i<array.length-1?", ":", and ")+value)}}))))),HelpText=external_kbnSharedDeps_React_default.a.memo(HelpTextComponent),JobDisplayContainer=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"JobDisplayContainer",componentId:"sc-1kiq2lp-0"})(["width:100%;height:100%;display:flex;flex-direction:column;"]),MlJobSelectEuiFlexGroup=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup).withConfig({displayName:"MlJobSelectEuiFlexGroup",componentId:"sc-1kiq2lp-1"})(["margin-bottom:5px;"]),JobDisplay=({id:id,description:description})=>external_kbnSharedDeps_React_default.a.createElement(JobDisplayContainer,null,external_kbnSharedDeps_React_default.a.createElement("strong",null,id),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{content:description},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs",color:"subdued"},external_kbnSharedDeps_React_default.a.createElement("p",null,description)))),renderJobOption=option=>external_kbnSharedDeps_React_default.a.createElement(JobDisplay,{id:option.value.id,description:option.value.description}),MlJobSelect=({describedByIds:describedByIds=[],field:field})=>{const jobIds=field.value,{isInvalid:isInvalid,errorMessage:errorMessage}=Object(shared_imports.w)(field),{loading:loading,jobs:jobs}=Object(use_security_jobs.a)(!1),mlUrl=Object(lib_kibana.h)().services.application.getUrlForApp("ml"),handleJobSelect=Object(external_kbnSharedDeps_React_.useCallback)(selectedJobOptions=>{const selectedJobIds=selectedJobOptions.map(option=>option.value.id);field.setValue(selectedJobIds)},[field]),jobOptions=jobs.map(job=>({value:{id:job.id,description:job.description},label:job.id})),selectedJobOptions=jobOptions.filter(option=>jobIds.includes(option.value.id)),notRunningJobIds=Object(external_kbnSharedDeps_React_.useMemo)(()=>jobs.filter(({id:id})=>jobIds.includes(id)).reduce((acc,job)=>(Object(helpers.c)(job.jobState,job.datafeedState)||acc.push(job.id),acc),[]),[jobs,jobIds]);return external_kbnSharedDeps_React_default.a.createElement(MlJobSelectEuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:field.label,helpText:external_kbnSharedDeps_React_default.a.createElement(HelpText,{href:mlUrl,notRunningJobIds:notRunningJobIds}),isInvalid:isInvalid,error:errorMessage,"data-test-subj":"mlJobSelect",describedByIds:describedByIds},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiComboBox,{isLoading:loading,onChange:handleJobSelect,options:jobOptions,placeholder:ML_JOB_SELECT_PLACEHOLDER_TEXT,renderOption:renderJobOption,rowHeight:50,selectedOptions:selectedJobOptions}))))))};var selectable_timeline=__webpack_require__(628);const StyledEuiFieldText=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFieldText).withConfig({displayName:"StyledEuiFieldText",componentId:"oqcycb-0"})(["padding-left:12px;padding-right:40px;&[readonly]{cursor:pointer;background-size:0 100%;background-repeat:no-repeat;&:focus{background-color:#fff;background-image:linear-gradient( to top,#006bb4,#006bb4 2px,transparent 2px,transparent 100% );background-size:100% 100%;}}& + .euiFormControlLayoutIcons{left:unset;right:12px;}"]),getBasicSelectableOptions=timelineId=>[{description:timeline_translations.a,favorite:[],label:timeline_translations.b,id:void 0,title:timeline_translations.b,checked:"-1"===timelineId?"on":void 0}],SearchTimelineSuperSelectComponent=({isDisabled:isDisabled,hideUntitled:hideUntitled=!1,timelineId:timelineId,timelineTitle:timelineTitle,timelineType:timelineType=types_timeline.k.template,onTimelineChange:onTimelineChange})=>{const[isPopoverOpen,setIsPopoverOpen]=Object(external_kbnSharedDeps_React_.useState)(!1),handleClosePopover=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setIsPopoverOpen(!1)},[]),handleOpenPopover=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setIsPopoverOpen(!0)},[]),superSelect=Object(external_kbnSharedDeps_React_.useMemo)(()=>external_kbnSharedDeps_React_default.a.createElement(StyledEuiFieldText,{readOnly:!0,disabled:isDisabled,onFocus:handleOpenPopover,value:null!=timelineTitle?timelineTitle:timeline_translations.b,icon:"arrowDown"}),[handleOpenPopover,isDisabled,timelineTitle]),handleGetSelectableOptions=Object(external_kbnSharedDeps_React_.useCallback)(({timelines:timelines,onlyFavorites:onlyFavorites,searchTimelineValue:searchTimelineValue})=>[...onlyFavorites||""!==searchTimelineValue?[]:getBasicSelectableOptions(null==timelineId?"-1":timelineId),...timelines.filter(t=>!hideUntitled||""!==t.title).map((t,index)=>({description:t.description,favorite:t.favorite,label:t.title,id:timelineType===types_timeline.k.template?t.templateTimelineId:t.savedObjectId,key:`${t.title}-${index}`,title:t.title,checked:[t.savedObjectId,t.templateTimelineId].includes(timelineId)?"on":void 0}))],[hideUntitled,timelineId,timelineType]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiInputPopover,{id:"searchTimelinePopover",input:superSelect,isOpen:isPopoverOpen,closePopover:handleClosePopover},external_kbnSharedDeps_React_default.a.createElement(selectable_timeline.a,{hideUntitled:hideUntitled,getSelectableOptions:handleGetSelectableOptions,onClosePopover:handleClosePopover,onTimelineChange:onTimelineChange,timelineType:timelineType}))},SearchTimelineSuperSelect=Object(external_kbnSharedDeps_React_.memo)(SearchTimelineSuperSelectComponent),PickTimeline=({dataTestSubj:dataTestSubj,field:field,idAria:idAria,isDisabled:isDisabled=!1})=>{const[timelineId,setTimelineId]=Object(external_kbnSharedDeps_React_.useState)(null),[timelineTitle,setTimelineTitle]=Object(external_kbnSharedDeps_React_.useState)(null),{isInvalid:isInvalid,errorMessage:errorMessage}=Object(shared_imports.w)(field);Object(external_kbnSharedDeps_React_.useEffect)(()=>{const{id:id,title:title}=field.value;timelineTitle!==title&&timelineId!==id&&(setTimelineId(id),setTimelineTitle(title))},[field.value]);const handleOnTimelineChange=Object(external_kbnSharedDeps_React_.useCallback)((title,id)=>{null===id?field.setValue({id:id,title:null}):timelineTitle!==title&&timelineId!==id&&field.setValue({id:id,title:title})},[field]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:field.label,labelAppend:field.labelAppend,helpText:field.helpText,error:errorMessage,isInvalid:isInvalid,"data-test-subj":dataTestSubj,describedByIds:idAria?[idAria]:void 0},external_kbnSharedDeps_React_default.a.createElement(SearchTimelineSuperSelect,{isDisabled:isDisabled,hideUntitled:!0,timelineId:timelineId,timelineTitle:timelineTitle,onTimelineChange:handleOnTimelineChange}))},StyledDiv=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"StyledDiv",componentId:"sc-1adamx3-0"})(["padding-left:",";"],({addPadding:addPadding})=>addPadding&&"53px");StyledDiv.defaultProps={addPadding:!1};const StepContentWrapper=external_kbnSharedDeps_React_default.a.memo(StyledDiv);StepContentWrapper.displayName="StepContentWrapper";var rules_translations=__webpack_require__(135);const NextStep=external_kbnSharedDeps_React_default.a.memo(({onClick:onClick,isDisabled:isDisabled,dataTestSubj:dataTestSubj="nextStep-continue"})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHorizontalRule,{margin:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",justifyContent:"flexEnd",gutterSize:"xs",responsive:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{fill:!0,onClick:onClick,isDisabled:isDisabled,"data-test-subj":dataTestSubj},rules_translations.F)))));NextStep.displayName="NextStep";var edit_data_provider_helpers=__webpack_require__(605);const THRESHOLD_FIELD_PLACEHOLDER=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.thresholdField.thresholdFieldPlaceholderText",{defaultMessage:"All results"}),OperatorWrapper=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexItem).withConfig({displayName:"OperatorWrapper",componentId:"sc-10hzoxx-0"})(["align-self:center;"]),fieldDescribedByIds=["detectionEngineStepDefineRuleThresholdField"],valueDescribedByIds=["detectionEngineStepDefineRuleThresholdValue"],cardinalityFieldDescribedByIds=["detectionEngineStepDefineRuleThresholdCardinalityField"],cardinalityValueDescribedByIds=["detectionEngineStepDefineRuleThresholdCardinalityValue"],ThresholdInputComponent=({thresholdField:thresholdField,thresholdValue:thresholdValue,browserFields:browserFields,thresholdCardinalityField:thresholdCardinalityField,thresholdCardinalityValue:thresholdCardinalityValue})=>{const fieldEuiFieldProps=Object(external_kbnSharedDeps_React_.useMemo)(()=>({fullWidth:!0,noSuggestions:!1,options:Object(edit_data_provider_helpers.a)(browserFields),placeholder:THRESHOLD_FIELD_PLACEHOLDER,onCreateOption:void 0,style:{width:"410px"}}),[browserFields]),cardinalityFieldEuiProps=Object(external_kbnSharedDeps_React_.useMemo)(()=>({fullWidth:!0,noSuggestions:!1,options:Object(edit_data_provider_helpers.a)(browserFields),placeholder:THRESHOLD_FIELD_PLACEHOLDER,onCreateOption:void 0,style:{width:"410px"},singleSelection:{asPlainText:!0}}),[browserFields]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"column",style:{marginLeft:0}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(shared_imports.e,{field:thresholdField,idAria:fieldDescribedByIds[0],"data-test-subj":fieldDescribedByIds[0],describedByIds:fieldDescribedByIds,type:thresholdField.type,euiFieldProps:fieldEuiFieldProps})),external_kbnSharedDeps_React_default.a.createElement(OperatorWrapper,{grow:!1},">="),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(shared_imports.e,{field:thresholdValue,idAria:valueDescribedByIds[0],"data-test-subj":valueDescribedByIds[0],describedByIds:valueDescribedByIds,type:thresholdValue.type}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(shared_imports.e,{field:thresholdCardinalityField,idAria:cardinalityFieldDescribedByIds[0],"data-test-subj":cardinalityFieldDescribedByIds[0],describedByIds:cardinalityFieldDescribedByIds,type:thresholdCardinalityField.type,euiFieldProps:cardinalityFieldEuiProps})),external_kbnSharedDeps_React_default.a.createElement(OperatorWrapper,{grow:!1},">="),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(shared_imports.e,{field:thresholdCardinalityValue,idAria:cardinalityValueDescribedByIds[0],"data-test-subj":cardinalityValueDescribedByIds[0],describedByIds:cardinalityValueDescribedByIds,type:thresholdCardinalityValue.type}))))},ThresholdInput=external_kbnSharedDeps_React_default.a.memo(ThresholdInputComponent);var external_kbnSharedDeps_Lodash_=__webpack_require__(80),uuid=__webpack_require__(19),uuid_default=__webpack_require__.n(uuid),add_remove_id_to_item=__webpack_require__(29);const getFormattedEntries=(indexPattern,threatIndexPatterns,entries)=>entries.reduce((acc,item,index)=>[...acc,((indexPattern,threatIndexPatterns,item,itemIndex,uuidGen=uuid_default.a.v4)=>{var _maybeId$id;const{fields:fields}=indexPattern,{fields:threatFields}=threatIndexPatterns,field=item.field,threatField=item.value,[foundField]=fields.filter(({name:name})=>null!=field&&field===name),[threatFoundField]=threatFields.filter(({name:name})=>null!=threatField&&threatField===name);return{id:null!==(_maybeId$id=item.id)&&void 0!==_maybeId$id?_maybeId$id:uuidGen(),field:foundField,type:"mapping",value:threatFoundField,entryIndex:itemIndex}})(indexPattern,threatIndexPatterns,item,index)],[]),getDefaultEmptyEntry=()=>Object(add_remove_id_to_item.a)({field:"",type:"mapping",value:""});var validators=__webpack_require__(324);const schema_schema={index:{fieldsToValidateOnChange:["index","queryBar"],type:shared_imports.d.COMBO_BOX,label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fiedIndexPatternsLabel",{defaultMessage:"Index patterns"}),helpText:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs"},INDEX_HELPER_TEXT),validations:[{validator:(...args)=>{const[{formData:formData}]=args;if(!Object(helpers.d)(formData.ruleType))return shared_imports.v.emptyField(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.outputIndiceNameFieldRequiredError",{defaultMessage:"A minimum of one index pattern is required."}))(...args)}}]},queryBar:{validations:[{validator:(...args)=>{const[{value:value,path:path,formData:formData}]=args,{query:query,filters:filters}=value;if(!Object(helpers.d)(formData.ruleType))return Object(external_kbnSharedDeps_Lodash_.isEmpty)(query.query)&&Object(external_kbnSharedDeps_Lodash_.isEmpty)(filters)?{code:"ERR_FIELD_MISSING",path:path,message:CUSTOM_QUERY_REQUIRED}:void 0}},{validator:(...args)=>{const[{value:value,path:path,formData:formData}]=args,{query:query}=value;if(!Object(helpers.d)(formData.ruleType)&&!Object(external_kbnSharedDeps_Lodash_.isEmpty)(query.query)&&"kuery"===query.language)try{public_.esKuery.fromKueryExpression(query.query)}catch(err){return{code:"ERR_FIELD_FORMAT",path:path,message:INVALID_CUSTOM_QUERY}}}},{validator:Object(validators.a)(validators.b,300)}]},ruleType:{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldRuleTypeLabel",{defaultMessage:"Rule type"}),validations:[]},anomalyThreshold:{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldAnomalyThresholdLabel",{defaultMessage:"Anomaly score threshold"}),validations:[]},machineLearningJobId:{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldMachineLearningJobIdLabel",{defaultMessage:"Machine Learning job"}),validations:[{validator:(...args)=>{const[{formData:formData}]=args;if(Object(helpers.d)(formData.ruleType))return shared_imports.v.emptyField(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.machineLearningJobIdRequired",{defaultMessage:"A Machine Learning job is required."}))(...args)}}]},timeline:{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTimelineTemplateLabel",{defaultMessage:"Timeline template"}),helpText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTimelineTemplateHelpText",{defaultMessage:"Select which timeline to use when investigating generated alerts."})},threshold:{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThresholdLabel",{defaultMessage:"Threshold"}),field:{type:shared_imports.d.COMBO_BOX,label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThresholdFieldLabel",{defaultMessage:"Group by"}),helpText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThresholdFieldHelpText",{defaultMessage:"Select fields to group by. Fields are joined together with 'AND'"}),validations:[{validator:(...args)=>{const[{formData:formData}]=args;if(Object(utils.f)(formData.ruleType))return shared_imports.v.maxLengthField({length:3,message:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.validations.thresholdFieldFieldData.arrayLengthGreaterThanMaxErrorMessage",{defaultMessage:"Number of fields must be 3 or less."})})(...args)}}]},value:{type:shared_imports.d.NUMBER,label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThresholdValueLabel",{defaultMessage:"Threshold"}),validations:[{validator:(...args)=>{const[{formData:formData}]=args;if(Object(utils.f)(formData.ruleType))return shared_imports.v.numberGreaterThanField({than:1,message:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.validations.thresholdValueFieldData.numberGreaterThanOrEqualOneErrorMessage",{defaultMessage:"Value must be greater than or equal to one."}),allowEquality:!0})(...args)}}]},cardinality:{field:{defaultValue:[],fieldsToValidateOnChange:["threshold.cardinality.field","threshold.cardinality.value"],type:shared_imports.d.COMBO_BOX,label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThresholdCardinalityFieldLabel",{defaultMessage:"Count"}),validations:[{validator:(...args)=>{const[{formData:formData}]=args;if(Object(utils.f)(formData.ruleType))return Object(external_kbnSharedDeps_Lodash_.isEmpty)(formData["threshold.cardinality.field"])&&!Object(external_kbnSharedDeps_Lodash_.isEmpty)(formData["threshold.cardinality.value"])?shared_imports.v.emptyField(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.validations.thresholdCardinalityFieldFieldData.thresholdCardinalityFieldNotSuppliedMessage",{defaultMessage:"A Cardinality Field is required."}))(...args):void 0}}],helpText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThresholdFieldCardinalityFieldHelpText",{defaultMessage:"Select a field to check cardinality"})},value:{fieldsToValidateOnChange:["threshold.cardinality.field","threshold.cardinality.value"],type:shared_imports.d.NUMBER,label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThresholdCardinalityValueFieldLabel",{defaultMessage:"Unique values"}),validations:[{validator:(...args)=>{const[{formData:formData}]=args;if(Object(utils.f)(formData.ruleType))return Object(external_kbnSharedDeps_Lodash_.isEmpty)(formData["threshold.cardinality.field"])?void 0:shared_imports.v.numberGreaterThanField({than:1,message:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.validations.thresholdCardinalityValueFieldData.numberGreaterThanOrEqualOneErrorMessage",{defaultMessage:"Value must be greater than or equal to one."}),allowEquality:!0})(...args)}}]}}},threatIndex:{type:shared_imports.d.COMBO_BOX,label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThreatIndexPatternsLabel",{defaultMessage:"Indicator index patterns"}),helpText:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs"},THREAT_MATCH_INDEX_HELPER_TEXT),validations:[{validator:(...args)=>{const[{formData:formData}]=args;if(Object(utils.e)(formData.ruleType))return shared_imports.v.emptyField(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.threatMatchoutputIndiceNameFieldRequiredError",{defaultMessage:"A minimum of one index pattern is required."}))(...args)}}]},threatMapping:{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThreatMappingLabel",{defaultMessage:"Indicator mapping"}),validations:[{validator:(...args)=>{const[{path:path,formData:formData}]=args;var items;if(Object(utils.e)(formData.ruleType))return 1===(items=formData.threatMapping).length&&1===items[0].entries.length&&""===items[0].entries[0].field&&""===items[0].entries[0].value?{code:"ERR_FIELD_MISSING",path:path,message:THREAT_MATCH_REQUIRED}:(items=>items.some(item=>item.entries.some(subEntry=>""===subEntry.field||""===subEntry.value)))(formData.threatMapping)?{code:"ERR_FIELD_MISSING",path:path,message:THREAT_MATCH_EMPTIES}:void 0}}]},threatQueryBar:{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThreatQueryBarLabel",{defaultMessage:"Indicator index query"}),validations:[{validator:(...args)=>{const[{value:value,path:path,formData:formData}]=args;if(!Object(utils.e)(formData.ruleType))return;const{query:query,filters:filters}=value;return Object(external_kbnSharedDeps_Lodash_.isEmpty)(query.query)&&Object(external_kbnSharedDeps_Lodash_.isEmpty)(filters)?{code:"ERR_FIELD_MISSING",path:path,message:CUSTOM_QUERY_REQUIRED}:void 0}},{validator:(...args)=>{const[{value:value,path:path,formData:formData}]=args;if(!Object(utils.e)(formData.ruleType))return;const{query:query}=value;if(!Object(external_kbnSharedDeps_Lodash_.isEmpty)(query.query)&&"kuery"===query.language)try{public_.esKuery.fromKueryExpression(query.query)}catch(err){return{code:"ERR_FIELD_FORMAT",path:path,message:INVALID_CUSTOM_QUERY}}}}]}};var eql_query_bar=__webpack_require__(491);__webpack_require__(662);const LOADING=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.autocomplete.loadingDescription",{defaultMessage:"Loading..."}),SELECT_FIELD_FIRST=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.autocomplete.selectField",{defaultMessage:"Please select a field first..."}),FIELD_REQUIRED_ERR=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.autocomplete.fieldRequiredError",{defaultMessage:"Value cannot be empty"}),NUMBER_ERR=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.autocomplete.invalidNumberError",{defaultMessage:"Not a valid number"}),DATE_ERR=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.autocomplete.invalidDateError",{defaultMessage:"Not a valid date"}),paramIsValid=(param,field,isRequired,touched)=>{if(null==field)return;const emptyValueError=((param,field,isRequired,touched)=>isRequired&&touched&&(null==param||""===param.trim())?FIELD_REQUIRED_ERR:null==field||isRequired&&!touched||!(isRequired||null!=param&&""!==param)?void 0:null)(param,field,isRequired,touched);if(null!==emptyValueError)return emptyValueError;switch(field.type){case"date":const moment=target_default.a.parse(null!=param?param:"");return Boolean(moment&&moment.isValid())?void 0:DATE_ERR;case"number":return null!=param&&""!==param.trim()&&!isNaN(+param)?void 0:NUMBER_ERR;default:return}};function getGenericComboBoxProps({options:options,selectedOptions:selectedOptions,getLabel:getLabel}){const newLabels=options.map(getLabel),newComboOptions=newLabels.map(label=>({label:label})),newSelectedComboOptions=selectedOptions.map(getLabel).filter(option=>-1!==newLabels.indexOf(option)).map(option=>newComboOptions[newLabels.indexOf(option)]);return{comboOptions:newComboOptions,labels:newLabels,selectedComboOptions:newSelectedComboOptions}}const FieldComponent=({placeholder:placeholder,selectedField:selectedField,indexPattern:indexPattern,isLoading:isLoading=!1,isDisabled:isDisabled=!1,isClearable:isClearable=!1,isRequired:isRequired=!1,fieldTypeFilter:fieldTypeFilter=[],fieldInputWidth:fieldInputWidth,onChange:onChange})=>{const[touched,setIsTouched]=Object(external_kbnSharedDeps_React_.useState)(!1),{availableFields:availableFields,selectedFields:selectedFields}=Object(external_kbnSharedDeps_React_.useMemo)(()=>getComboBoxFields(indexPattern,selectedField,fieldTypeFilter),[indexPattern,selectedField,fieldTypeFilter]),{comboOptions:comboOptions,labels:labels,selectedComboOptions:selectedComboOptions}=Object(external_kbnSharedDeps_React_.useMemo)(()=>getComboBoxProps({availableFields:availableFields,selectedFields:selectedFields}),[availableFields,selectedFields]),handleValuesChange=Object(external_kbnSharedDeps_React_.useCallback)(newOptions=>{const newValues=newOptions.map(({label:label})=>availableFields[labels.indexOf(label)]);onChange(newValues)},[availableFields,labels,onChange]),handleTouch=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setIsTouched(!0)},[setIsTouched]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiComboBox,{placeholder:placeholder,options:comboOptions,selectedOptions:selectedComboOptions,onChange:handleValuesChange,isLoading:isLoading,isDisabled:isDisabled,isClearable:isClearable,isInvalid:!!isRequired&&(touched&&null==selectedField),onFocus:handleTouch,singleSelection:{asPlainText:!0},"data-test-subj":"fieldAutocompleteComboBox",style:fieldInputWidth?{width:fieldInputWidth+"px"}:{},fullWidth:!0})};FieldComponent.displayName="Field";const getComboBoxFields=(indexPattern,selectedField,fieldTypeFilter)=>{const existingFields=getExistingFields(indexPattern),selectedFields=getSelectedFields(selectedField);return{availableFields:getAvailableFields(existingFields,selectedFields,fieldTypeFilter),selectedFields:selectedFields}},getComboBoxProps=fields=>{const{availableFields:availableFields,selectedFields:selectedFields}=fields;return getGenericComboBoxProps({options:availableFields,selectedOptions:selectedFields,getLabel:field=>field.name})},getExistingFields=indexPattern=>null!=indexPattern?indexPattern.fields:[],getSelectedFields=selectedField=>selectedField?[selectedField]:[],getAvailableFields=(existingFields,selectedFields,fieldTypeFilter)=>{const fieldsByName=new Map;existingFields.forEach(f=>fieldsByName.set(f.name,f)),selectedFields.forEach(f=>fieldsByName.set(f.name,f));const uniqueFields=Array.from(fieldsByName.values());return fieldTypeFilter.length>0?uniqueFields.filter(({type:type})=>fieldTypeFilter.includes(type)):uniqueFields},FlexItemWithLabel=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexItem).withConfig({displayName:"FlexItemWithLabel",componentId:"sc-1i1appc-0"})(["padding-top:20px;text-align:center;"]),FlexItemWithoutLabel=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexItem).withConfig({displayName:"FlexItemWithoutLabel",componentId:"sc-1i1appc-1"})(["text-align:center;"]),EntryItem=({entry:entry,indexPattern:indexPattern,threatIndexPatterns:threatIndexPatterns,showLabel:showLabel,onChange:onChange})=>{const handleFieldChange=Object(external_kbnSharedDeps_React_.useCallback)(([newField])=>{const{updatedEntry:updatedEntry,index:index}=((item,newField)=>{const{entryIndex:entryIndex}=item;return{updatedEntry:{id:item.id,field:null!=newField?newField.name:"",type:"mapping",value:null!=item.value?item.value.name:""},index:entryIndex}})(entry,newField);onChange(updatedEntry,index)},[onChange,entry]),handleThreatFieldChange=Object(external_kbnSharedDeps_React_.useCallback)(([newField])=>{const{updatedEntry:updatedEntry,index:index}=((item,newField)=>{const{entryIndex:entryIndex}=item;return{updatedEntry:{id:item.id,field:null!=item.field?item.field.name:"",type:"mapping",value:null!=newField?newField.name:""},index:entryIndex}})(entry,newField);onChange(updatedEntry,index)},[onChange,entry]),renderFieldInput=Object(external_kbnSharedDeps_React_.useMemo)(()=>{const comboBox=external_kbnSharedDeps_React_default.a.createElement(FieldComponent,{placeholder:FIELD_PLACEHOLDER,indexPattern:indexPattern,selectedField:entry.field,isClearable:!1,isLoading:!1,isDisabled:null==indexPattern,onChange:handleFieldChange,"data-test-subj":"entryField",fieldInputWidth:360});return showLabel?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:FIELD,"data-test-subj":"entryItemFieldInputFormRow"},comboBox):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:"","data-test-subj":"entryItemFieldInputFormRow"},comboBox)},[handleFieldChange,indexPattern,entry,showLabel]),renderThreatFieldInput=Object(external_kbnSharedDeps_React_.useMemo)(()=>{const comboBox=external_kbnSharedDeps_React_default.a.createElement(FieldComponent,{placeholder:FIELD_PLACEHOLDER,indexPattern:threatIndexPatterns,selectedField:entry.value,isClearable:!1,isLoading:!1,isDisabled:null==threatIndexPatterns,onChange:handleThreatFieldChange,"data-test-subj":"threatEntryField",fieldInputWidth:360});return showLabel?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:THREAT_FIELD,"data-test-subj":"threatFieldInputFormRow"},comboBox):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:"","data-test-subj":"threatFieldInputFormRow"},comboBox)},[handleThreatFieldChange,threatIndexPatterns,entry,showLabel]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"row",gutterSize:"s",alignItems:"center",justifyContent:"spaceAround","data-test-subj":"itemEntryContainer"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},renderFieldInput),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceAround",alignItems:"center"},showLabel?external_kbnSharedDeps_React_default.a.createElement(FlexItemWithLabel,{grow:!0},MATCHES):external_kbnSharedDeps_React_default.a.createElement(FlexItemWithoutLabel,{grow:!0},MATCHES))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},renderThreatFieldInput))};EntryItem.displayName="EntryItem";const MyFirstRowContainer=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexItem).withConfig({displayName:"MyFirstRowContainer",componentId:"sc-136w498-0"})(["padding-top:20px;"]),EntryDeleteButtonComponent=external_kbnSharedDeps_React_default.a.memo(({entries:entries,isOnlyItem:isOnlyItem,entryIndex:entryIndex,itemIndex:itemIndex,onDelete:onDelete})=>{const isDisabled=isOnlyItem&&1===entries.length&&0===itemIndex&&(null==entries[0].field||""===entries[0].field),handleDelete=Object(external_kbnSharedDeps_React_.useCallback)(()=>{onDelete(entryIndex)},[onDelete,entryIndex]),button=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{color:"danger",iconType:"trash",onClick:handleDelete,isDisabled:isDisabled,"aria-label":"entryDeleteButton",className:"itemEntryDeleteButton","data-test-subj":"itemEntryDeleteButton"});return 0===entryIndex&&0===itemIndex?external_kbnSharedDeps_React_default.a.createElement(MyFirstRowContainer,{grow:!1,"data-test-subj":"firstRowDeleteButton"},button):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,"data-test-subj":"deleteButton"},button)});EntryDeleteButtonComponent.displayName="EntryDeleteButton";var and_or_badge=__webpack_require__(219);const MyInvisibleAndBadge=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexItem).withConfig({displayName:"MyInvisibleAndBadge",componentId:"d6yaa8-0"})(["visibility:hidden;"]),and_badge_MyFirstRowContainer=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexItem).withConfig({displayName:"MyFirstRowContainer",componentId:"d6yaa8-1"})(["padding-top:20px;"]),AndBadgeComponent=external_kbnSharedDeps_React_default.a.memo(({entriesLength:entriesLength,entryItemIndex:entryItemIndex})=>{const badge=external_kbnSharedDeps_React_default.a.createElement(and_or_badge.a,{includeAntennas:!0,type:"and"});return entriesLength>1&&0===entryItemIndex?external_kbnSharedDeps_React_default.a.createElement(and_badge_MyFirstRowContainer,{grow:!1,"data-test-subj":"entryItemEntryFirstRowAndBadge"},badge):entriesLength<=1?external_kbnSharedDeps_React_default.a.createElement(MyInvisibleAndBadge,{grow:!1,"data-test-subj":"entryItemEntryInvisibleAndBadge"},badge):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,"data-test-subj":"entryItemEntryAndBadge"},badge)});AndBadgeComponent.displayName="AndBadge";const MyOverflowContainer=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexItem).withConfig({displayName:"MyOverflowContainer",componentId:"o1uavm-0"})(["overflow:hidden;width:100%;"]),ListItemComponent=external_kbnSharedDeps_React_default.a.memo(({listItem:listItem,listItemIndex:listItemIndex,indexPattern:indexPattern,threatIndexPatterns:threatIndexPatterns,isOnlyItem:isOnlyItem,andLogicIncluded:andLogicIncluded,onDeleteEntryItem:onDeleteEntryItem,onChangeEntryItem:onChangeEntryItem})=>{const handleEntryChange=Object(external_kbnSharedDeps_React_.useCallback)((entry,entryIndex)=>{const updatedEntries=[...listItem.entries.slice(0,entryIndex),{...entry},...listItem.entries.slice(entryIndex+1)],updatedEntryItem={...listItem,entries:updatedEntries};onChangeEntryItem(updatedEntryItem,listItemIndex)},[onChangeEntryItem,listItem,listItemIndex]),handleDeleteEntry=Object(external_kbnSharedDeps_React_.useCallback)(entryIndex=>{const updatedEntryItem=((item,entryIndex)=>({...item,entries:[...item.entries.slice(0,entryIndex),...item.entries.slice(entryIndex+1)]}))(listItem,entryIndex);onDeleteEntryItem(updatedEntryItem,listItemIndex)},[listItem,onDeleteEntryItem,listItemIndex]),entries=Object(external_kbnSharedDeps_React_.useMemo)(()=>null!=indexPattern&&listItem.entries.length>0?getFormattedEntries(indexPattern,threatIndexPatterns,listItem.entries):[],[listItem.entries,indexPattern,threatIndexPatterns]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s","data-test-subj":"entriesContainer"},andLogicIncluded&&external_kbnSharedDeps_React_default.a.createElement(AndBadgeComponent,{entriesLength:listItem.entries.length,entryItemIndex:listItemIndex}),external_kbnSharedDeps_React_default.a.createElement(MyOverflowContainer,{grow:6},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s",direction:"column"},entries.map((item,index)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{key:item.id,grow:1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"xs",alignItems:"center",direction:"row"},external_kbnSharedDeps_React_default.a.createElement(MyOverflowContainer,{grow:1},external_kbnSharedDeps_React_default.a.createElement(EntryItem,{entry:item,threatIndexPatterns:threatIndexPatterns,indexPattern:indexPattern,showLabel:0===listItemIndex&&0===index,onChange:handleEntryChange})),external_kbnSharedDeps_React_default.a.createElement(EntryDeleteButtonComponent,{entries:listItem.entries,isOnlyItem:isOnlyItem,entryIndex:item.entryIndex,itemIndex:listItemIndex,onDelete:handleDeleteEntry}))))))))});ListItemComponent.displayName="ListItem";const MyEuiButton=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiButton).withConfig({displayName:"MyEuiButton",componentId:"sc-1dsnlky-0"})(["min-width:95px;"]),LogicButtons=({isOrDisabled:isOrDisabled=!1,isAndDisabled:isAndDisabled=!1,onAndClicked:onAndClicked,onOrClicked:onOrClicked})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(MyEuiButton,{fill:!0,size:"s",iconType:"plusInCircle",onClick:onAndClicked,"data-test-subj":"andButton",isDisabled:isAndDisabled},AND)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(MyEuiButton,{fill:!0,size:"s",iconType:"plusInCircle",onClick:onOrClicked,isDisabled:isOrDisabled,"data-test-subj":"orButton"},OR))),threat_match_MyInvisibleAndBadge=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexItem).withConfig({displayName:"MyInvisibleAndBadge",componentId:"ph2s87-0"})(["visibility:hidden;"]),MyAndBadge=external_kbnSharedDeps_StyledComponents_default()(and_or_badge.a).withConfig({displayName:"MyAndBadge",componentId:"ph2s87-1"})(["& > .euiFlexItem{margin:0;}"]),MyButtonsContainer=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexItem).withConfig({displayName:"MyButtonsContainer",componentId:"ph2s87-2"})(["margin:16px 0;"]),threat_match_initialState={andLogicIncluded:!1,entries:[],entriesToDelete:[]},ThreatMatchComponent=({listItems:listItems,indexPatterns:indexPatterns,threatIndexPatterns:threatIndexPatterns,onChange:onChange})=>{const[{entries:entries,entriesToDelete:entriesToDelete,andLogicIncluded:andLogicIncluded},dispatch]=Object(external_kbnSharedDeps_React_.useReducer)((state,action)=>{switch(action.type){case"setEntries":{const isAndLogicIncluded=action.entries.filter(({entries:entries})=>entries.length>1).length>0;return{...state,andLogicIncluded:isAndLogicIncluded,entries:action.entries}}case"setDefault":return{...state,...action.initialState,entries:[{...action.lastEntry,entries:[getDefaultEmptyEntry()]}]};default:return state}},{...threat_match_initialState}),setUpdateEntries=Object(external_kbnSharedDeps_React_.useCallback)(items=>{dispatch({type:"setEntries",entries:items})},[dispatch]),setDefaultEntries=Object(external_kbnSharedDeps_React_.useCallback)(item=>{dispatch({type:"setDefault",initialState:threat_match_initialState,lastEntry:item})},[dispatch]),handleEntryItemChange=Object(external_kbnSharedDeps_React_.useCallback)((item,index)=>{const updatedEntries=[...entries.slice(0,index),{...item},...entries.slice(index+1)];setUpdateEntries(updatedEntries)},[setUpdateEntries,entries]),handleDeleteEntryItem=Object(external_kbnSharedDeps_React_.useCallback)((item,itemIndex)=>{if(0===item.entries.length){0===[...entries.slice(0,itemIndex),...entries.slice(itemIndex+1)].length?setDefaultEntries(item):setUpdateEntries([...entries.slice(0,itemIndex),...entries.slice(itemIndex+1)])}else handleEntryItemChange(item,itemIndex)},[handleEntryItemChange,setUpdateEntries,entries,setDefaultEntries]),handleAddNewEntryItemEntry=Object(external_kbnSharedDeps_React_.useCallback)(()=>{const lastEntry=entries[entries.length-1],{entries:innerEntries}=lastEntry,updatedEntry={...lastEntry,entries:[...innerEntries,getDefaultEmptyEntry()]};setUpdateEntries([...entries.slice(0,entries.length-1),{...updatedEntry}])},[setUpdateEntries,entries]),handleAddNewEntryItem=Object(external_kbnSharedDeps_React_.useCallback)(()=>{const newItem=Object(add_remove_id_to_item.a)({entries:[Object(add_remove_id_to_item.a)({field:"",type:"mapping",value:""})]});setUpdateEntries([...entries,{...newItem}])},[setUpdateEntries,entries]),handleAddClick=Object(external_kbnSharedDeps_React_.useCallback)(()=>{handleAddNewEntryItemEntry()},[handleAddNewEntryItemEntry]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{var items;onChange({entryItems:(items=entries,items.reduce((acc,item)=>{const newItem={...item,entries:item.entries};return types.c.is(newItem)?[...acc,newItem]:acc},[])),entriesToDelete:entriesToDelete})},[onChange,entriesToDelete,entries]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{(0===entries.length||1===entries.length&&null!=entries[0].entries&&0===entries[0].entries.length)&&handleAddNewEntryItem()},[entries,handleAddNewEntryItem]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{listItems.length>0&&setUpdateEntries(listItems)},[]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s",direction:"column"},entries.map((entryListItem,index)=>{var _id;const key=null!==(_id=entryListItem.id)&&void 0!==_id?_id:""+index;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:1,key:key},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s",direction:"column"},0!==index&&(andLogicIncluded?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"none",direction:"row"},external_kbnSharedDeps_React_default.a.createElement(threat_match_MyInvisibleAndBadge,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(MyAndBadge,{includeAntennas:!0,type:"and"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(MyAndBadge,{type:"or"})))):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(MyAndBadge,{type:"or"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(ListItemComponent,{key:key,listItem:entryListItem,indexPattern:indexPatterns,threatIndexPatterns:threatIndexPatterns,listItemIndex:index,andLogicIncluded:andLogicIncluded,isOnlyItem:1===entries.length,onDeleteEntryItem:handleDeleteEntryItem,onChangeEntryItem:handleEntryItemChange}))))}),external_kbnSharedDeps_React_default.a.createElement(MyButtonsContainer,{"data-test-subj":"andOrOperatorButtons"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s"},andLogicIncluded&&external_kbnSharedDeps_React_default.a.createElement(threat_match_MyInvisibleAndBadge,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(and_or_badge.a,{includeAntennas:!0,type:"and"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:1},external_kbnSharedDeps_React_default.a.createElement(LogicButtons,{isOrDisabled:!1,isAndDisabled:!1,onOrClicked:handleAddNewEntryItem,onAndClicked:handleAddClick})))))};ThreatMatchComponent.displayName="ThreatMatch";const CommonUseField=Object(shared_imports.x)({component:shared_imports.e}),ThreatMatchInputComponent=({threatMapping:threatMapping,indexPatterns:indexPatterns,threatIndexPatterns:threatIndexPatterns,threatIndexPatternsLoading:threatIndexPatternsLoading,threatBrowserFields:threatBrowserFields})=>{const{setValue:setValue,value:threatItems}=threatMapping,{isInvalid:isInvalid,errorMessage:errorMessage}=Object(shared_imports.w)(threatMapping),handleBuilderOnChange=Object(external_kbnSharedDeps_React_.useCallback)(({entryItems:entryItems})=>{setValue(entryItems)},[setValue]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"column"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!0},external_kbnSharedDeps_React_default.a.createElement(CommonUseField,{path:"threatIndex",config:{...schema_schema.threatIndex,labelAppend:null},componentProps:{idAria:"detectionEngineStepDefineRuleThreatMatchIndices","data-test-subj":"detectionEngineStepDefineRuleThreatMatchIndices",euiFieldProps:{fullWidth:!0,isDisabled:!1,placeholder:""}}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!0},external_kbnSharedDeps_React_default.a.createElement(shared_imports.k,{path:"threatQueryBar",config:{...schema_schema.threatQueryBar,labelAppend:null},component:QueryBarDefineRule,componentProps:{browserFields:threatBrowserFields,idAria:"detectionEngineStepDefineThreatRuleQueryBar",indexPattern:threatIndexPatterns,isDisabled:!1,isLoading:threatIndexPatternsLoading,dataTestSubj:"detectionEngineStepDefineThreatRuleQueryBar",openTimelineSearch:!1}}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:threatMapping.label,labelAppend:threatMapping.labelAppend,helpText:threatMapping.helpText,error:errorMessage,isInvalid:isInvalid,fullWidth:!0},external_kbnSharedDeps_React_default.a.createElement(ThreatMatchComponent,{listItems:threatItems,indexPatterns:indexPatterns,threatIndexPatterns:threatIndexPatterns,"data-test-subj":"threatmatch-builder","id-aria":"threatmatch-builder",onChange:handleBuilderOnChange})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}))},ThreatMatchInput=external_kbnSharedDeps_React_default.a.memo(ThreatMatchInputComponent);var source=__webpack_require__(202);const QUERY_PREVIEW_BUTTON=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.stepDefineRule.previewQueryButton",{defaultMessage:"Preview results"}),QUERY_PREVIEW_SELECT_ARIA=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.stepDefineRule.previewQueryAriaLabel",{defaultMessage:"Query preview timeframe select"}),QUERY_PREVIEW_LABEL=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryPreviewLabel",{defaultMessage:"Quick query preview"}),QUERY_PREVIEW_HELP_TEXT=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryPreviewHelpText",{defaultMessage:"Select a timeframe of data to preview query results"}),QUERY_GRAPH_COUNT=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryGraphCountLabel",{defaultMessage:"Count"}),THRESHOLD_QUERY_GRAPH_COUNT=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryThresholdGraphCountLabel",{defaultMessage:"Cumulative Threshold Count"}),QUERY_GRAPH_HITS_TITLE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryGraphHitsTitle",{defaultMessage:"Hits"}),QUERY_PREVIEW_TITLE=hits=>external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryPreviewGraphTitle",{values:{hits:hits},defaultMessage:"{hits} {hits, plural, =1 {hit} other {hits}}"}),QUERY_PREVIEW_NOISE_WARNING=(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryGraphPreviewInspectTitle",{defaultMessage:"query preview"}),external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryGraphPreviewNoiseWarning",{defaultMessage:"Noise warning: This rule may cause a lot of noise. Consider narrowing your query. This is based on a linear progression of 1 alert per hour."})),QUERY_PREVIEW_ERROR=(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryNoHits",{defaultMessage:"No hits were found."}),external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryGraphPreviewError",{defaultMessage:"Error fetching preview"})),QUERY_PREVIEW_DISCLAIMER=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryGraphDisclaimer",{defaultMessage:"Note: This preview excludes effects of rule exceptions and timestamp overrides."}),QUERY_PREVIEW_DISCLAIMER_EQL=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryGraphDisclaimerEql",{defaultMessage:"Note: This preview excludes effects of rule exceptions and timestamp overrides, and is limited to 100 results."}),QUERY_PREVIEW_SUBTITLE_LOADING=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryPreviewSubtitleLoading",{defaultMessage:"...loading"});external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryPreviewEqlSequenceTitle",{defaultMessage:"No histogram available"}),external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryPreviewEqlSequenceDescription",{defaultMessage:"No histogram is available at this time for EQL sequence queries. You can use the inspect in the top right corner to view query details."});var matrix_histogram=__webpack_require__(755),security_solution_matrix_histogram=__webpack_require__(292),external_kbnSharedDeps_ElasticCharts_=__webpack_require__(87),components_utils=__webpack_require__(227),get_query_filter=__webpack_require__(665);const isNoisy=(hits,timeframe)=>"h"===timeframe?hits>1:"d"===timeframe?hits/24>1:"M"===timeframe&&hits/730>1,getHistogramConfig=(to,from,showLegend=!1)=>({series:{xScaleType:external_kbnSharedDeps_ElasticCharts_.ScaleType.Time,yScaleType:external_kbnSharedDeps_ElasticCharts_.ScaleType.Linear,stackAccessors:["g"]},axis:{xTickFormatter:Object(components_utils.a)([to,from]),yTickFormatter:value=>value.toLocaleString(),tickSize:8},yAxisTitle:QUERY_GRAPH_COUNT,settings:{legendPosition:external_kbnSharedDeps_ElasticCharts_.Position.Right,showLegend:showLegend,showLegendExtra:showLegend,theme:{scales:{barsPadding:.08},chartMargins:{left:0,right:0,top:0,bottom:0},chartPaddings:{left:0,right:0,top:0,bottom:0}}},customHeight:200});var use_global_time=__webpack_require__(166),barchart=__webpack_require__(428),panel=__webpack_require__(209),header_section=__webpack_require__(154);const LoadingChart=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiLoadingChart).withConfig({displayName:"LoadingChart",componentId:"sc-1sjd0mf-0"})(["display:block;margin:0 auto;"]),PreviewHistogram=({id:id,data:data,dataTestSubj:dataTestSubj,barConfig:barConfig,title:title,subtitle:subtitle,disclaimer:disclaimer,isLoading:isLoading})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(panel.a,{height:300,"data-test-subj":dataTestSubj},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"none",direction:"column"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:1},external_kbnSharedDeps_React_default.a.createElement(header_section.a,{id:id,title:title,titleSize:"xs",subtitle:subtitle})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:1},isLoading?external_kbnSharedDeps_React_default.a.createElement(LoadingChart,{size:"l","data-test-subj":"queryPreviewLoading"}):external_kbnSharedDeps_React_default.a.createElement(barchart.a,{configs:barConfig,barChart:data,stackByField:void 0,timelineId:void 0,"data-test-subj":"sharedPreviewQueryHistogram"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"s",color:"subdued"},external_kbnSharedDeps_React_default.a.createElement("p",null,disclaimer))))))),ID="queryEqlPreviewHistogramQuery",PreviewEqlQueryHistogram=({from:from,to:to,totalCount:totalCount,data:data,inspect:inspect,refetch:refetch,isLoading:isLoading})=>{const{setQuery:setQuery,isInitializing:isInitializing}=Object(use_global_time.a)();Object(external_kbnSharedDeps_React_.useEffect)(()=>{isInitializing||setQuery({id:ID,inspect:inspect,loading:!1,refetch:refetch})},[setQuery,inspect,isInitializing,refetch]);const barConfig=Object(external_kbnSharedDeps_React_.useMemo)(()=>getHistogramConfig(to,from),[from,to]),subtitle=Object(external_kbnSharedDeps_React_.useMemo)(()=>isLoading?QUERY_PREVIEW_SUBTITLE_LOADING:QUERY_PREVIEW_TITLE(totalCount),[isLoading,totalCount]),chartData=Object(external_kbnSharedDeps_React_.useMemo)(()=>[{key:"hits",value:data}],[data]);return external_kbnSharedDeps_React_default.a.createElement(PreviewHistogram,{id:ID,data:chartData,barConfig:barConfig,title:QUERY_GRAPH_HITS_TITLE,subtitle:subtitle,disclaimer:QUERY_PREVIEW_DISCLAIMER_EQL,isLoading:isLoading,dataTestSubj:"queryPreviewEqlHistogram"})};var external_kbnSharedDeps_RxjsOperators_=__webpack_require__(37),hooks_translations=__webpack_require__(591),common_=__webpack_require__(83),kibanaUtils_common_=__webpack_require__(103);const formatInspect=(response,indices)=>{const body=response.rawResponse.meta.request.params.body,bodyParse="string"==typeof body?JSON.parse(body):body;return{dsl:[JSON.stringify({...response.rawResponse.meta.request.params,index:indices,body:bodyParse},null,2)],response:[JSON.stringify(response.rawResponse.body,null,2)]}},getEqlAggsData=(response,range,to,refetch,indices,isSequence)=>{const{dsl:dsl,response:inspectResponse}=formatInspect(response,indices),relativeNow=Date.parse(to),accumulator=getInterval(range,relativeNow),events=((isSequence,response)=>{var _response$rawResponse;const hits=null!==(_response$rawResponse=response.rawResponse.body.hits)&&void 0!==_response$rawResponse?_response$rawResponse:[];var _hits$sequences$map,_hits$sequences,_hits$events;return isSequence?null!==(_hits$sequences$map=null===(_hits$sequences=hits.sequences)||void 0===_hits$sequences?void 0:_hits$sequences.map(seq=>seq.events[seq.events.length-1]))&&void 0!==_hits$sequences$map?_hits$sequences$map:[]:null!==(_hits$events=hits.events)&&void 0!==_hits$events?_hits$events:[]})(isSequence,response),totalCount=response.rawResponse.body.hits.total.value,buckets=events.reduce((acc,hit)=>{const timestamp=hit._source["@timestamp"];if(null==timestamp)return acc;const eventDate=new Date(timestamp).toISOString(),eventTimestamp=Date.parse(eventDate),bucket="h"===range?((eventTimestamp,relativeNow)=>{const diff=Math.abs(relativeNow-eventTimestamp),minutes=Math.floor(diff/6e4);return 2*Math.ceil(minutes/2)})(eventTimestamp,relativeNow):((eventTimestamp,relativeNow)=>{const diff=Math.abs(relativeNow-eventTimestamp),minutes=Math.floor(diff/6e4);return Math.ceil(minutes/60)})(eventTimestamp,relativeNow);return null!=acc[bucket]&&(acc[bucket].total+=1),acc},accumulator),data=Object.keys(buckets).map(key=>({x:Number(buckets[key].timestamp),y:buckets[key].total,g:"hits"})),isAllZeros=data.every(({y:y})=>0===y);return{data:data,totalCount:isAllZeros?0:totalCount,inspect:{dsl:dsl,response:inspectResponse},refetch:refetch}},createIntervalArray=(start,end,multiplier)=>Array(end-start+1).fill(0).map((_,idx)=>start+idx*multiplier),getInterval=(range,relativeNow)=>{switch(range){case"h":return createIntervalArray(0,30,2).reduce((acc,int)=>({...acc,[int]:{timestamp:external_kbnSharedDeps_Moment_default()(relativeNow).subtract(int,"m").format("x"),total:0}}),{});case"d":return createIntervalArray(0,24,1).reduce((acc,int)=>({...acc,[int]:{timestamp:external_kbnSharedDeps_Moment_default()(relativeNow).subtract(int,"h").format("x"),total:0}}),{});default:throw new RangeError('Invalid time range selected. Must be "Last hour" or "Last day".')}};var parse_schedule_dates=__webpack_require__(58),dataEnhanced_public_=__webpack_require__(96);const PreviewThresholdQueryHistogram=({buckets:buckets,inspect:inspect,refetch:refetch,isLoading:isLoading})=>{const{setQuery:setQuery,isInitializing:isInitializing}=Object(use_global_time.a)();Object(external_kbnSharedDeps_React_.useEffect)(()=>{isLoading||isInitializing||setQuery({id:"queryPreviewThresholdHistogramQuery",inspect:inspect,loading:isLoading,refetch:refetch})},[setQuery,inspect,isLoading,isInitializing,refetch]);const{data:data,totalCount:totalCount}=Object(external_kbnSharedDeps_React_.useMemo)(()=>{const total=buckets.length;return{data:[{key:"hits",value:buckets.map(({key:key,doc_count:docCount})=>({x:key,y:docCount,g:key}))}],totalCount:total}},[buckets]),barConfig=Object(external_kbnSharedDeps_React_.useMemo)(()=>({series:{xScaleType:external_kbnSharedDeps_ElasticCharts_.ScaleType.Ordinal,yScaleType:external_kbnSharedDeps_ElasticCharts_.ScaleType.Linear,stackAccessors:["g"]},axis:{yTickFormatter:value=>value.toLocaleString(),tickSize:8},yAxisTitle:THRESHOLD_QUERY_GRAPH_COUNT,settings:{legendPosition:external_kbnSharedDeps_ElasticCharts_.Position.Right,showLegend:!0,showLegendExtra:!0,theme:{scales:{barsPadding:.08},chartMargins:{left:0,right:0,top:0,bottom:0},chartPaddings:{left:0,right:0,top:0,bottom:0}}},customHeight:200}),[]),subtitle=Object(external_kbnSharedDeps_React_.useMemo)(()=>isLoading?QUERY_PREVIEW_SUBTITLE_LOADING:(buckets=>external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.queryPreview.queryPreviewGraphThresholdWithFieldTitle",{values:{buckets:buckets},defaultMessage:"{buckets} {buckets, plural, =1 {unique hit} other {unique hits}}"}))(totalCount),[isLoading,totalCount]);return external_kbnSharedDeps_React_default.a.createElement(PreviewHistogram,{id:"queryPreviewThresholdHistogramQuery",data:data,barConfig:barConfig,title:QUERY_GRAPH_HITS_TITLE,subtitle:subtitle,disclaimer:QUERY_PREVIEW_DISCLAIMER,isLoading:isLoading,dataTestSubj:"thresholdQueryPreviewHistogram"})};var super_date_picker=__webpack_require__(244);const queryPreviewReducer=()=>(state,action)=>{switch(action.type){case"setQueryInfo":if(null!=action.queryBar){const{queryString:queryString,language:language,filters:filters,queryFilter:queryFilter}=((queryBar,index,ruleType)=>{const queryString="string"==typeof queryBar.query.query?queryBar.query.query:"",language=queryBar.query.language,filters=queryBar.filters;try{return{queryString:queryString,language:language,filters:filters,queryFilter:"eql"!==ruleType?Object(get_query_filter.a)(queryString,language,filters,index,[],!0):void 0}}catch{return{queryString:queryString,language:language,filters:filters,queryFilter:void 0}}})(action.queryBar,action.index,action.ruleType);return{...state,queryString:queryString,language:language,filters:filters,queryFilter:queryFilter,showHistogram:!1}}return{...state,showHistogram:!1};case"setTimeframeSelect":return{...state,timeframe:action.timeframe,showHistogram:!1,warnings:[]};case"setResetRuleTypeChange":{const showNonEqlHist="query"===action.ruleType||"saved_query"===action.ruleType||"threshold"===action.ruleType&&!state.thresholdFieldExists;return{...state,showHistogram:!1,timeframe:"h",timeframeOptions:(ruleType=action.ruleType,"eql"===ruleType?[{value:"h",text:"Last hour"},{value:"d",text:"Last day"}]:[{value:"h",text:"Last hour"},{value:"d",text:"Last day"},{value:"M",text:"Last month"}]),showNonEqlHistogram:showNonEqlHist,warnings:[]}}case"setWarnings":return{...state,warnings:action.warnings};case"setShowHistogram":return{...state,showHistogram:action.show};case"setThresholdQueryVals":{const thresholdField=null!=action.threshold&&null!=action.threshold.field&&action.threshold.field.length>0&&action.threshold.field.every(field=>""!==field.trim()),showNonEqlHist="query"===action.ruleType||"saved_query"===action.ruleType||"threshold"===action.ruleType&&!thresholdField;return{...state,thresholdFieldExists:thresholdField,showNonEqlHistogram:showNonEqlHist,showHistogram:!1,warnings:[]}}case"setToFrom":return{...state,fromTime:Object(super_date_picker.c)("now"),toTime:Object(super_date_picker.c)("now-1"+state.timeframe)};case"setNoiseWarning":return{...state,warnings:[...state.warnings,QUERY_PREVIEW_NOISE_WARNING]};default:return state}var ruleType},PreviewCustomQueryHistogram=({to:to,from:from,data:data,totalCount:totalCount,inspect:inspect,refetch:refetch,isLoading:isLoading})=>{const{setQuery:setQuery,isInitializing:isInitializing}=Object(use_global_time.a)();Object(external_kbnSharedDeps_React_.useEffect)(()=>{isLoading||isInitializing||setQuery({id:"queryPreviewCustomHistogramQuery",inspect:inspect,loading:isLoading,refetch:refetch})},[setQuery,inspect,isLoading,isInitializing,refetch]);const barConfig=Object(external_kbnSharedDeps_React_.useMemo)(()=>getHistogramConfig(to,from,!0),[from,to]),subtitle=Object(external_kbnSharedDeps_React_.useMemo)(()=>isLoading?QUERY_PREVIEW_SUBTITLE_LOADING:QUERY_PREVIEW_TITLE(totalCount),[isLoading,totalCount]),chartData=Object(external_kbnSharedDeps_React_.useMemo)(()=>[{key:"hits",value:data}],[data]);return external_kbnSharedDeps_React_default.a.createElement(PreviewHistogram,{id:"queryPreviewCustomHistogramQuery",data:chartData,barConfig:barConfig,title:QUERY_GRAPH_HITS_TITLE,subtitle:subtitle,disclaimer:QUERY_PREVIEW_DISCLAIMER,isLoading:isLoading,dataTestSubj:"queryPreviewCustomHistogram"})},Select=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiSelect).withConfig({displayName:"Select",componentId:"sc-111a7av-0"})(["width:",";"],({theme:theme})=>theme.eui.euiSuperDatePickerWidth),PreviewButton=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiButton).withConfig({displayName:"PreviewButton",componentId:"sc-111a7av-1"})(["margin-left:0;"]),query_preview_initialState={timeframeOptions:[],showHistogram:!1,timeframe:"h",warnings:[],queryFilter:void 0,toTime:"",fromTime:"",queryString:"",language:"kuery",filters:[],thresholdFieldExists:!1,showNonEqlHistogram:!1},PreviewQuery=({ruleType:ruleType,dataTestSubj:dataTestSubj,idAria:idAria,query:query,index:index,threshold:threshold,isDisabled:isDisabled})=>{const[eqlQueryLoading,startEql,{totalCount:eqlQueryTotal,data:eqlQueryData,refetch:eqlQueryRefetch,inspect:eqlQueryInspect}]=(()=>{const{data:data}=Object(lib_kibana.h)().services,refetch=Object(external_kbnSharedDeps_React_.useRef)(external_kbnSharedDeps_LodashFp_.noop),abortCtrl=Object(external_kbnSharedDeps_React_.useRef)(new AbortController),unsubscribeStream=Object(external_kbnSharedDeps_React_.useRef)(new external_kbnSharedDeps_Rxjs_.Subject),[loading,setLoading]=Object(external_kbnSharedDeps_React_.useState)(!1),didCancel=Object(external_kbnSharedDeps_React_.useRef)(!1),{addError:addError,addWarning:addWarning}=Object(use_app_toasts.a)(),[response,setResponse]=Object(external_kbnSharedDeps_React_.useState)({data:[],inspect:{dsl:[],response:[]},refetch:refetch.current,totalCount:0}),searchEql=Object(external_kbnSharedDeps_React_.useCallback)(({from:from,to:to,query:query,index:index,interval:interval})=>{if(null==Object(parse_schedule_dates.a)(to)||null==Object(parse_schedule_dates.a)(from))return void addWarning(hooks_translations.d);const asyncSearch=async()=>{abortCtrl.current=new AbortController,setLoading(!0),setResponse(prevResponse=>({...prevResponse,data:[],inspect:{dsl:[],response:[]},totalCount:0})),data.search.search({params:{index:index.join(),body:{filter:{range:{"@timestamp":{gte:from,lte:to,format:"strict_date_optional_time"}}},query:query,size:100}}},{strategy:dataEnhanced_public_.EQL_SEARCH_STRATEGY,abortSignal:abortCtrl.current.signal}).pipe(Object(external_kbnSharedDeps_RxjsOperators_.takeUntil)(unsubscribeStream.current)).subscribe({next:res=>{Object(common_.isCompleteResponse)(res)?(didCancel.current||(setLoading(!1),setResponse(prev=>{const{inspect:inspect,...rest}=getEqlAggsData(res,interval,to,refetch.current,index,Object(utils.b)(query)),inspectDsl=prev.inspect.dsl[0]?prev.inspect.dsl:inspect.dsl,inspectResp=prev.inspect.response[0]?prev.inspect.response:inspect.response;return{...prev,...rest,inspect:{dsl:inspectDsl,response:inspectResp}}})),unsubscribeStream.current.next()):Object(common_.isPartialResponse)(res)?setResponse(prev=>({...prev,inspect:formatInspect(res,index)})):Object(common_.isErrorResponse)(res)&&(setLoading(!1),addWarning(hooks_translations.c),unsubscribeStream.current.next())},error:err=>{err instanceof kibanaUtils_common_.AbortError||(setLoading(!1),setResponse({data:[],inspect:{dsl:[],response:[]},refetch:refetch.current,totalCount:0}),addError(err,{title:hooks_translations.c}))}})};abortCtrl.current.abort(),asyncSearch(),refetch.current=asyncSearch},[data.search,addError,addWarning]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>()=>{didCancel.current=!0,abortCtrl.current.abort(),unsubscribeStream.current.complete()},[]),[loading,searchEql,response]})(),[{thresholdFieldExists:thresholdFieldExists,showNonEqlHistogram:showNonEqlHistogram,timeframeOptions:timeframeOptions,showHistogram:showHistogram,timeframe:timeframe,warnings:warnings,queryFilter:queryFilter,toTime:toTime,fromTime:fromTime,queryString:queryString},dispatch]=Object(external_kbnSharedDeps_React_.useReducer)(queryPreviewReducer(),{...query_preview_initialState,toTime:Object(super_date_picker.c)("now-1h"),fromTime:Object(super_date_picker.c)("now")}),[isMatrixHistogramLoading,{inspect:inspect,totalCount:matrixHistTotal,refetch:refetch,data:matrixHistoData,buckets:buckets},startNonEql]=Object(matrix_histogram.a)({errorMessage:QUERY_PREVIEW_ERROR,endDate:fromTime,startDate:toTime,filterQuery:queryFilter,indexNames:index,histogramType:security_solution_matrix_histogram.MatrixHistogramType.events,stackByField:"event.category",threshold:"threshold"===ruleType?threshold:void 0,skip:!0}),setQueryInfo=Object(external_kbnSharedDeps_React_.useCallback)((queryBar,indices,type)=>{dispatch({type:"setQueryInfo",queryBar:queryBar,index:indices,ruleType:type})},[dispatch]),debouncedSetQueryInfo=Object(external_kbnSharedDeps_React_.useRef)(Object(external_kbnSharedDeps_LodashFp_.debounce)(500,setQueryInfo)),setTimeframeSelect=Object(external_kbnSharedDeps_React_.useCallback)(selection=>{dispatch({type:"setTimeframeSelect",timeframe:selection})},[dispatch]),setRuleTypeChange=Object(external_kbnSharedDeps_React_.useCallback)(type=>{dispatch({type:"setResetRuleTypeChange",ruleType:type})},[dispatch]),setWarnings=Object(external_kbnSharedDeps_React_.useCallback)(yikes=>{dispatch({type:"setWarnings",warnings:yikes})},[dispatch]),setNoiseWarning=Object(external_kbnSharedDeps_React_.useCallback)(()=>{dispatch({type:"setNoiseWarning"})},[dispatch]),setShowHistogram=Object(external_kbnSharedDeps_React_.useCallback)(show=>{dispatch({type:"setShowHistogram",show:show})},[dispatch]),setThresholdValues=Object(external_kbnSharedDeps_React_.useCallback)((thresh,type)=>{dispatch({type:"setThresholdQueryVals",threshold:thresh,ruleType:type})},[dispatch]);Object(external_kbnSharedDeps_React_.useEffect)(()=>{debouncedSetQueryInfo.current(query,index,ruleType)},[index,query,ruleType]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{setThresholdValues(threshold,ruleType)},[setThresholdValues,threshold,ruleType]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{setRuleTypeChange(ruleType)},[ruleType,setRuleTypeChange]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{switch(ruleType){case"eql":isNoisy(eqlQueryTotal,timeframe)&&setNoiseWarning();break;case"threshold":const totalHits=thresholdFieldExists?buckets.length:matrixHistTotal;isNoisy(totalHits,timeframe)&&setNoiseWarning();break;default:isNoisy(matrixHistTotal,timeframe)&&setNoiseWarning()}},[timeframe,matrixHistTotal,eqlQueryTotal,ruleType,setNoiseWarning,thresholdFieldExists,buckets.length]);const handlePreviewEqlQuery=Object(external_kbnSharedDeps_React_.useCallback)((to,from)=>{startEql({index:index,query:queryString,from:from,to:to,interval:timeframe})},[startEql,index,queryString,timeframe]),handleSelectPreviewTimeframe=Object(external_kbnSharedDeps_React_.useCallback)(({target:{value:value}})=>{setTimeframeSelect(value)},[setTimeframeSelect]),handlePreviewClicked=Object(external_kbnSharedDeps_React_.useCallback)(()=>{const to=Object(super_date_picker.c)("now"),from=Object(super_date_picker.c)("now-1"+timeframe);setWarnings([]),setShowHistogram(!0),"eql"===ruleType?handlePreviewEqlQuery(to,from):startNonEql(to,from)},[setWarnings,setShowHistogram,ruleType,handlePreviewEqlQuery,startNonEql,timeframe]),previewButtonDisabled=Object(external_kbnSharedDeps_React_.useMemo)(()=>isMatrixHistogramLoading||eqlQueryLoading||isDisabled||null==query||null!=query&&""===query.query.query&&0===query.filters.length,[eqlQueryLoading,isDisabled,isMatrixHistogramLoading,query]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:QUERY_PREVIEW_LABEL,helpText:QUERY_PREVIEW_HELP_TEXT,error:void 0,isInvalid:!1,"data-test-subj":dataTestSubj,describedByIds:idAria?[idAria]:void 0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:1},external_kbnSharedDeps_React_default.a.createElement(Select,{id:"queryPreviewSelect",options:timeframeOptions,value:timeframe,onChange:handleSelectPreviewTimeframe,"aria-label":QUERY_PREVIEW_SELECT_ARIA,disabled:isDisabled,"data-test-subj":"queryPreviewTimeframeSelect"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(PreviewButton,{fill:!0,isDisabled:previewButtonDisabled,onClick:handlePreviewClicked,"data-test-subj":"queryPreviewButton"},QUERY_PREVIEW_BUTTON)))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),showNonEqlHistogram&&showHistogram&&external_kbnSharedDeps_React_default.a.createElement(PreviewCustomQueryHistogram,{to:toTime,from:fromTime,data:matrixHistoData,totalCount:matrixHistTotal,inspect:inspect,refetch:refetch,isLoading:isMatrixHistogramLoading}),"threshold"===ruleType&&thresholdFieldExists&&showHistogram&&external_kbnSharedDeps_React_default.a.createElement(PreviewThresholdQueryHistogram,{isLoading:isMatrixHistogramLoading,buckets:buckets,inspect:inspect,refetch:refetch}),"eql"===ruleType&&showHistogram&&external_kbnSharedDeps_React_default.a.createElement(PreviewEqlQueryHistogram,{to:toTime,from:fromTime,totalCount:eqlQueryTotal,data:eqlQueryData,inspect:eqlQueryInspect,refetch:eqlQueryRefetch,isLoading:eqlQueryLoading}),showHistogram&&warnings.length>0&&warnings.map((warning,i)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,{key:`${warning}-${i}`},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{color:"warning",iconType:"help","data-test-subj":"previewQueryWarning"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement("p",null,warning))))))},step_define_rule_CommonUseField=Object(shared_imports.x)({component:shared_imports.e}),stepDefineDefaultValue={anomalyThreshold:50,index:[],machineLearningJobId:[],ruleType:"query",threatIndex:[],queryBar:{query:{query:"",language:"kuery"},filters:[],saved_id:void 0},threatQueryBar:{query:{query:"*:*",language:"kuery"},filters:[],saved_id:void 0},threatMapping:[],threshold:{field:[],value:"200",cardinality:{field:[],value:""}},timeline:{id:null,title:timeline_translations.b}},threatQueryBarDefaultValue={...stepDefineDefaultValue.queryBar,query:{...stepDefineDefaultValue.queryBar.query,query:"*:*"}},MyLabelButton=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty).withConfig({displayName:"MyLabelButton",componentId:"f0vskm-0"})(["height:18px;font-size:12px;.euiIcon{width:14px;height:14px;}"]);MyLabelButton.defaultProps={flush:"right"};const RuleTypeEuiFormRow=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFormRow).attrs(({$isVisible:$isVisible})=>({style:{display:$isVisible?"flex":"none"}})).withConfig({displayName:"RuleTypeEuiFormRow",componentId:"f0vskm-1"})([""]),StepDefineRuleComponent=({addPadding:addPadding=!1,defaultValues:defaultValues,descriptionColumns:descriptionColumns="singleSplit",isReadOnlyView:isReadOnlyView,isLoading:isLoading,isUpdateView:isUpdateView=!1,onSubmit:onSubmit,setForm:setForm})=>{const mlCapabilities=Object(use_ml_capabilities.a)(),[openTimelineSearch,setOpenTimelineSearch]=Object(external_kbnSharedDeps_React_.useState)(!1),[indexModified,setIndexModified]=Object(external_kbnSharedDeps_React_.useState)(!1),[indicesConfig]=Object(lib_kibana.l)(constants.u),initialState=null!=defaultValues?defaultValues:{...stepDefineDefaultValue,index:indicesConfig},{form:form}=Object(shared_imports.I)({defaultValue:initialState,options:{stripEmptyFields:!1},schema:schema_schema}),{getFields:getFields,getFormData:getFormData,reset:reset,submit:submit}=form,[{index:formIndex,ruleType:formRuleType,queryBar:formQuery,threatIndex:formThreatIndex,threshold:formThreshold}]=Object(shared_imports.K)({form:form,watch:["index","ruleType","queryBar","threshold","threshold.field","threshold.value","threshold.cardinality.field","threshold.cardinality.value","threatIndex"]}),[isQueryBarValid,setIsQueryBarValid]=Object(external_kbnSharedDeps_React_.useState)(!1),index=formIndex||initialState.index,threatIndex=formThreatIndex||initialState.threatIndex,ruleType=formRuleType||initialState.ruleType,[indexPatternsLoading,{browserFields:browserFields,indexPatterns:indexPatterns}]=Object(source.b)(index),aggregatableFields=Object.entries(browserFields).reduce((groupAcc,[groupName,groupValue])=>{var _groupValue$fields;return{...groupAcc,[groupName]:{fields:Object.entries(null!==(_groupValue$fields=groupValue.fields)&&void 0!==_groupValue$fields?_groupValue$fields:{}).reduce((fieldAcc,[fieldName,fieldValue])=>(!0===fieldValue.aggregatable&&(fieldAcc[fieldName]=fieldValue),fieldAcc),{})}}},{}),[threatIndexPatternsLoading,{browserFields:threatBrowserFields,indexPatterns:threatIndexPatterns}]=Object(source.b)(threatIndex);Object(external_kbnSharedDeps_React_.useEffect)(()=>{reset({resetValues:!1})},[reset,ruleType]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{setIndexModified(!isEqual_default()(index,indicesConfig))},[index,indicesConfig]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{const{queryBar:queryBar}=getFields();if(null!=queryBar){const{queryBar:defaultQueryBar}=stepDefineDefaultValue;Object(utils.e)(ruleType)&&queryBar.value===defaultQueryBar?queryBar.reset({defaultValue:threatQueryBarDefaultValue}):queryBar.value===threatQueryBarDefaultValue&&queryBar.reset({defaultValue:defaultQueryBar})}},[ruleType,getFields]);const handleSubmit=Object(external_kbnSharedDeps_React_.useCallback)(()=>{onSubmit&&onSubmit()},[onSubmit]),getData=Object(external_kbnSharedDeps_React_.useCallback)(async()=>{const result=await submit();return result.isValid?result:{isValid:!1,data:getFormData()}},[getFormData,submit]);Object(external_kbnSharedDeps_React_.useEffect)(()=>{let didCancel=!1;return setForm&&!didCancel&&setForm(rules_types.a.defineRule,getData),()=>{didCancel=!0}},[getData,setForm]);const handleResetIndices=Object(external_kbnSharedDeps_React_.useCallback)(()=>{getFields().index.setValue(indicesConfig)},[getFields,indicesConfig]),handleOpenTimelineSearch=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setOpenTimelineSearch(!0)},[]),handleCloseTimelineSearch=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setOpenTimelineSearch(!1)},[]),ThresholdInputChildren=Object(external_kbnSharedDeps_React_.useCallback)(({thresholdField:thresholdField,thresholdValue:thresholdValue,thresholdCardinalityField:thresholdCardinalityField,thresholdCardinalityValue:thresholdCardinalityValue})=>external_kbnSharedDeps_React_default.a.createElement(ThresholdInput,{browserFields:aggregatableFields,thresholdField:thresholdField,thresholdValue:thresholdValue,thresholdCardinalityField:thresholdCardinalityField,thresholdCardinalityValue:thresholdCardinalityValue}),[aggregatableFields]),ThreatMatchInputChildren=Object(external_kbnSharedDeps_React_.useCallback)(({threatMapping:threatMapping})=>external_kbnSharedDeps_React_default.a.createElement(ThreatMatchInput,{threatBrowserFields:threatBrowserFields,indexPatterns:indexPatterns,threatIndexPatterns:threatIndexPatterns,threatMapping:threatMapping,threatIndexPatternsLoading:threatIndexPatternsLoading}),[threatBrowserFields,threatIndexPatternsLoading,threatIndexPatterns,indexPatterns]);return isReadOnlyView?external_kbnSharedDeps_React_default.a.createElement(StepContentWrapper,{"data-test-subj":"definitionRule",addPadding:addPadding},external_kbnSharedDeps_React_default.a.createElement(StepRuleDescription,{columns:descriptionColumns,indexPatterns:indexPatterns,schema:filterRuleFieldsForType(schema_schema,ruleType),data:filterRuleFieldsForType(initialState,ruleType)})):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(StepContentWrapper,{addPadding:!isUpdateView},external_kbnSharedDeps_React_default.a.createElement(shared_imports.f,{form:form,"data-test-subj":"stepDefineRule"},external_kbnSharedDeps_React_default.a.createElement(shared_imports.k,{path:"ruleType",component:SelectRuleType,componentProps:{describedByIds:["detectionEngineStepDefineRuleType"],isUpdateView:isUpdateView,hasValidLicense:Object(has_ml_license.a)(mlCapabilities),isMlAdmin:Object(has_ml_admin_permissions.a)(mlCapabilities)}}),external_kbnSharedDeps_React_default.a.createElement(RuleTypeEuiFormRow,{$isVisible:!Object(helpers.d)(ruleType),fullWidth:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(step_define_rule_CommonUseField,{path:"index",config:{...schema_schema.index,labelAppend:indexModified?external_kbnSharedDeps_React_default.a.createElement(MyLabelButton,{onClick:handleResetIndices,iconType:"refresh"},RESET_DEFAULT_INDEX):null},componentProps:{idAria:"detectionEngineStepDefineRuleIndices","data-test-subj":"detectionEngineStepDefineRuleIndices",euiFieldProps:{fullWidth:!0,isDisabled:isLoading,placeholder:""}}}),Object(utils.c)(ruleType)?external_kbnSharedDeps_React_default.a.createElement(shared_imports.k,{key:"EqlQueryBar",path:"queryBar",component:eql_query_bar.a,componentProps:{onValidityChange:setIsQueryBarValid,idAria:"detectionEngineStepDefineRuleEqlQueryBar",isDisabled:isLoading,isLoading:indexPatternsLoading,dataTestSubj:"detectionEngineStepDefineRuleEqlQueryBar"},config:{...schema_schema.queryBar,label:EQL_QUERY_BAR_LABEL}}):external_kbnSharedDeps_React_default.a.createElement(shared_imports.k,{key:"QueryBarDefineRule",path:"queryBar",config:{...schema_schema.queryBar,label:QUERY_BAR_LABEL,labelAppend:external_kbnSharedDeps_React_default.a.createElement(MyLabelButton,{"data-test-subj":"importQueryFromSavedTimeline",onClick:handleOpenTimelineSearch},IMPORT_TIMELINE_QUERY)},component:QueryBarDefineRule,componentProps:{browserFields:browserFields,idAria:"detectionEngineStepDefineRuleQueryBar",indexPattern:indexPatterns,isDisabled:isLoading,isLoading:indexPatternsLoading,dataTestSubj:"detectionEngineStepDefineRuleQueryBar",openTimelineSearch:openTimelineSearch,onValidityChange:setIsQueryBarValid,onCloseTimelineSearch:handleCloseTimelineSearch}}))),external_kbnSharedDeps_React_default.a.createElement(RuleTypeEuiFormRow,{$isVisible:Object(helpers.d)(ruleType),fullWidth:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(shared_imports.k,{path:"machineLearningJobId",component:MlJobSelect,componentProps:{describedByIds:["detectionEngineStepDefineRulemachineLearningJobId"]}}),external_kbnSharedDeps_React_default.a.createElement(shared_imports.k,{path:"anomalyThreshold",component:AnomalyThresholdSlider,componentProps:{describedByIds:["detectionEngineStepDefineRuleAnomalyThreshold"]}}))),external_kbnSharedDeps_React_default.a.createElement(RuleTypeEuiFormRow,{$isVisible:Object(utils.f)(ruleType),"data-test-subj":"thresholdInput",fullWidth:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(shared_imports.l,{fields:{thresholdField:{path:"threshold.field"},thresholdValue:{path:"threshold.value"},thresholdCardinalityField:{path:"threshold.cardinality.field"},thresholdCardinalityValue:{path:"threshold.cardinality.value"}}},ThresholdInputChildren))),external_kbnSharedDeps_React_default.a.createElement(RuleTypeEuiFormRow,{$isVisible:Object(utils.e)(ruleType),"data-test-subj":"threatMatchInput",fullWidth:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(shared_imports.l,{fields:{threatMapping:{path:"threatMapping"}}},ThreatMatchInputChildren))),external_kbnSharedDeps_React_default.a.createElement(shared_imports.k,{path:"timeline",component:PickTimeline,componentProps:{idAria:"detectionEngineStepDefineRuleTimeline",isDisabled:isLoading,dataTestSubj:"detectionEngineStepDefineRuleTimeline"}})),"machine_learning"!==ruleType&&"threat_match"!==ruleType&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(PreviewQuery,{dataTestSubj:"ruleCreationQueryPreview",idAria:"ruleCreationQueryPreview",ruleType:ruleType,index:index,query:formQuery,isDisabled:!isQueryBarValid||0===index.length,threshold:formThreshold}))),!isUpdateView&&external_kbnSharedDeps_React_default.a.createElement(NextStep,{dataTestSubj:"define-continue",onClick:handleSubmit,isDisabled:isLoading}))},StepDefineRule=Object(external_kbnSharedDeps_React_.memo)(StepDefineRuleComponent);function add_item_form_extends(){return(add_item_form_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const MyEuiFormRow=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFormRow).withConfig({displayName:"MyEuiFormRow",componentId:"sc-1urlknr-0"})([".euiFormRow__labelWrapper{.euiText{padding-right:32px;}}"]),MyAddItemButton=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty).withConfig({displayName:"MyAddItemButton",componentId:"sc-1urlknr-1"})(["margin:4px 0px;&.euiButtonEmpty--small{font-size:12px;}.euiIcon{width:12px;height:12px;}"]);MyAddItemButton.defaultProps={flush:"left",iconType:"plusInCircle",size:"s"};const AddItem=({addText:addText,dataTestSubj:dataTestSubj,field:field,idAria:idAria,isDisabled:isDisabled,validate:validate})=>{const[showValidation,setShowValidation]=Object(external_kbnSharedDeps_React_.useState)(!1),{isInvalid:isInvalid,errorMessage:errorMessage}=Object(shared_imports.w)(field),[haveBeenKeyboardDeleted,setHaveBeenKeyboardDeleted]=Object(external_kbnSharedDeps_React_.useState)(-1),inputsRef=Object(external_kbnSharedDeps_React_.useRef)([]),removeItem=Object(external_kbnSharedDeps_React_.useCallback)(index=>{const values=field.value,newValues=[...values.slice(0,index),...values.slice(index+1)];field.setValue(0===newValues.length?[""]:newValues),inputsRef.current=[...inputsRef.current.slice(0,index),...inputsRef.current.slice(index+1)],inputsRef.current=inputsRef.current.map((ref,i)=>(i>=index&&null!=inputsRef.current[index]&&(ref.value="re-render"),ref))},[field]),addItem=Object(external_kbnSharedDeps_React_.useCallback)(()=>{const values=field.value;field.setValue([...values,""])},[field]),updateItem=Object(external_kbnSharedDeps_React_.useCallback)((event,index)=>{event.persist();const values=field.value,value=event.target.value;field.setValue([...values.slice(0,index),value,...values.slice(index+1)])},[field]),handleLastInputRef=Object(external_kbnSharedDeps_React_.useCallback)((index,element)=>{null!=element&&(inputsRef.current=[...inputsRef.current.slice(0,index),element,...inputsRef.current.slice(index+1)])},[inputsRef]);Object(external_kbnSharedDeps_React_.useEffect)(()=>{-1===haveBeenKeyboardDeleted||Object(external_kbnSharedDeps_LodashFp_.isEmpty)(inputsRef.current)||null==inputsRef.current[haveBeenKeyboardDeleted]||(inputsRef.current[haveBeenKeyboardDeleted].focus(),setHaveBeenKeyboardDeleted(-1))},[haveBeenKeyboardDeleted,inputsRef.current]);const values=field.value;return external_kbnSharedDeps_React_default.a.createElement(MyEuiFormRow,{label:field.label,labelAppend:field.labelAppend,error:showValidation?errorMessage:null,isInvalid:showValidation&&isInvalid,fullWidth:!0,"data-test-subj":dataTestSubj,describedByIds:idAria?[idAria]:void 0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,values.map((item,index)=>{const euiFieldProps={disabled:isDisabled,...index===values.length-1?{inputRef:handleLastInputRef.bind(null,index)}:{},value:item,isInvalid:null!=validate&&(showValidation&&validate(item))};return external_kbnSharedDeps_React_default.a.createElement("div",{key:index},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldText,add_item_form_extends({onBlur:()=>setShowValidation(!0),onChange:e=>updateItem(e,index),fullWidth:!0},euiFieldProps))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{color:"danger",iconType:"trash",isDisabled:isDisabled||Object(external_kbnSharedDeps_LodashFp_.isEmpty)(item)&&1===values.length,onClick:()=>removeItem(index),"aria-label":rules_translations.J}))),values.length-1!==index&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}))}),external_kbnSharedDeps_React_default.a.createElement(MyAddItemButton,{onClick:addItem,isDisabled:isDisabled},addText)))},threatDefault=[{framework:"MITRE ATT&CK",tactic:{id:"none",name:"none",reference:"none"},technique:[]}],stepAboutDefaultValue={author:[],name:"",description:"",isAssociatedToEndpointList:!1,isBuildingBlock:!1,severity:{value:"low",mapping:fillEmptySeverityMappings([]),isMappingChecked:!1},riskScore:{value:21,mapping:[],isMappingChecked:!1},references:[""],falsePositives:[""],license:"",ruleNameOverride:"",tags:[],timestampOverride:"",threat:threatDefault,note:""},THREATS=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.threatsDescription",{defaultMessage:"threats"}),TACTIC=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.tacticsDescription",{defaultMessage:"tactic"}),TECHNIQUE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.techniquesDescription",{defaultMessage:"technique"}),SUBTECHNIQUE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.subtechniquesDescription",{defaultMessage:"subtechnique"}),ADD_MITRE_TACTIC=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.addTacticTitle",{defaultMessage:"Add tactic"}),ADD_MITRE_TECHNIQUE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.addTechniqueTitle",{defaultMessage:"Add technique"}),ADD_MITRE_SUBTECHNIQUE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.addSubtechniqueTitle",{defaultMessage:"Add subtechnique"}),TACTIC_PLACEHOLDER=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.tacticPlaceHolderDescription",{defaultMessage:"Select a tactic ..."}),TECHNIQUE_PLACEHOLDER=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.techniquePlaceHolderDescription",{defaultMessage:"Select a technique ..."}),SUBTECHNIQUE_PLACEHOLDER=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mitreAttack.subtechniquePlaceHolderDescription",{defaultMessage:"Select a subtechnique ..."}),hasSubtechniqueOptions=technique=>subtechniquesOptions.some(subtechnique=>subtechnique.techniqueId===technique.id),SubtechniqueContainer=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"SubtechniqueContainer",componentId:"sc-1cb5h5o-0"})(["margin-left:48px;"]),MitreAttackSubtechniqueFields=({field:field,idAria:idAria,isDisabled:isDisabled,threatIndex:threatIndex,techniqueIndex:techniqueIndex,onFieldChange:onFieldChange})=>{const values=field.value,technique=Object(external_kbnSharedDeps_React_.useMemo)(()=>{var _values$threatIndex$t;return[...null!==(_values$threatIndex$t=values[threatIndex].technique)&&void 0!==_values$threatIndex$t?_values$threatIndex$t:[]]},[values,threatIndex]),removeSubtechnique=Object(external_kbnSharedDeps_React_.useCallback)(index=>{var _technique$techniqueI;const threats=[...field.value],subtechniques=null!==(_technique$techniqueI=technique[techniqueIndex].subtechnique)&&void 0!==_technique$techniqueI?_technique$techniqueI:[];null!=subtechniques&&(subtechniques.splice(index,1),technique[techniqueIndex]={...technique[techniqueIndex],subtechnique:subtechniques},threats[threatIndex].technique=technique,onFieldChange(threats))},[field,onFieldChange,techniqueIndex,technique,threatIndex]),addMitreAttackSubtechnique=Object(external_kbnSharedDeps_React_.useCallback)(()=>{const threats=[...field.value],subtechniques=technique[techniqueIndex].subtechnique;technique[techniqueIndex]=null!=subtechniques?{...technique[techniqueIndex],subtechnique:[...subtechniques,{id:"none",name:"none",reference:"none"}]}:{...technique[techniqueIndex],subtechnique:[{id:"none",name:"none",reference:"none"}]},threats[threatIndex].technique=technique,onFieldChange(threats)},[field,onFieldChange,techniqueIndex,technique,threatIndex]),updateSubtechnique=Object(external_kbnSharedDeps_React_.useCallback)((index,value)=>{const threats=[...field.value],{id:id,reference:reference,name:name}=subtechniquesOptions.find(t=>t.value===value)||{id:"",name:"",reference:""},subtechniques=technique[techniqueIndex].subtechnique;null!=subtechniques&&onFieldChange([...threats.slice(0,threatIndex),{...threats[threatIndex],technique:[...technique.slice(0,techniqueIndex),{...technique[techniqueIndex],subtechnique:[...subtechniques.slice(0,index),{id:id,reference:reference,name:name},...subtechniques.slice(index+1)]},...technique.slice(techniqueIndex+1)]},...threats.slice(threatIndex+1)])},[threatIndex,techniqueIndex,onFieldChange,field,technique]),getSelectSubtechnique=Object(external_kbnSharedDeps_React_.useCallback)((index,disabled,subtechnique)=>{const options=subtechniquesOptions.filter(t=>t.techniqueId===technique[techniqueIndex].id);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSuperSelect,{id:"mitreAttackSubtechnique",options:[..."none"===subtechnique.name?[{inputDisplay:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,SUBTECHNIQUE_PLACEHOLDER),value:"none",disabled:disabled}]:[],...options.map(option=>({inputDisplay:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,option.label),value:option.value,disabled:disabled}))],prepend:`${field.label} ${SUBTECHNIQUE}`,"aria-label":"",onChange:updateSubtechnique.bind(null,index),fullWidth:!0,valueOfSelected:Object(external_kbnSharedDeps_LodashFp_.camelCase)(subtechnique.name),"data-test-subj":"mitreAttackSubtechnique",disabled:disabled,placeholder:SUBTECHNIQUE_PLACEHOLDER}))},[field,updateSubtechnique,technique,techniqueIndex]),subtechniques=Object(external_kbnSharedDeps_React_.useMemo)(()=>technique[techniqueIndex].subtechnique,[technique,techniqueIndex]);return external_kbnSharedDeps_React_default.a.createElement(SubtechniqueContainer,null,null!=subtechniques&&subtechniques.map((subtechnique,index)=>external_kbnSharedDeps_React_default.a.createElement("div",{key:index},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{fullWidth:!0,describedByIds:idAria?[`${idAria} ${SUBTECHNIQUE}`]:void 0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!0},getSelectSubtechnique(index,isDisabled,subtechnique)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{color:"danger",iconType:"trash",isDisabled:isDisabled,onClick:()=>removeSubtechnique(index),"aria-label":rules_translations.J})))))),external_kbnSharedDeps_React_default.a.createElement(MyAddItemButton,{"data-test-subj":"addMitreAttackSubtechnique",onClick:addMitreAttackSubtechnique,isDisabled:isDisabled},ADD_MITRE_SUBTECHNIQUE))},TechniqueContainer=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"TechniqueContainer",componentId:"sc-1fugnao-0"})(["",""],({theme:theme})=>Object(external_kbnSharedDeps_StyledComponents_.css)(["margin-left:24px;padding-left:24px;border-left:2px solid ",";"],theme.eui.euiColorLightestShade)),MitreAttackTechniqueFields=({field:field,idAria:idAria,isDisabled:isDisabled,threatIndex:threatIndex,onFieldChange:onFieldChange})=>{var _values$threatIndex$t;const values=field.value,removeTechnique=Object(external_kbnSharedDeps_React_.useCallback)(index=>{var _threats$threatIndex$;const threats=[...field.value],techniques=null!==(_threats$threatIndex$=threats[threatIndex].technique)&&void 0!==_threats$threatIndex$?_threats$threatIndex$:[];techniques.splice(index,1),threats[threatIndex]={...threats[threatIndex],technique:techniques},onFieldChange(threats)},[field,threatIndex,onFieldChange]),addMitreAttackTechnique=Object(external_kbnSharedDeps_React_.useCallback)(()=>{var _threats$threatIndex$2;const threats=[...field.value];threats[threatIndex]={...threats[threatIndex],technique:[...null!==(_threats$threatIndex$2=threats[threatIndex].technique)&&void 0!==_threats$threatIndex$2?_threats$threatIndex$2:[],{id:"none",name:"none",reference:"none",subtechnique:[]}]},onFieldChange(threats)},[field,threatIndex,onFieldChange]),updateTechnique=Object(external_kbnSharedDeps_React_.useCallback)((index,value)=>{var _threats$threatIndex$3;const threats=[...field.value],{id:id,reference:reference,name:name}=techniquesOptions.find(t=>t.value===value)||{id:"",name:"",reference:""},technique=null!==(_threats$threatIndex$3=threats[threatIndex].technique)&&void 0!==_threats$threatIndex$3?_threats$threatIndex$3:[];onFieldChange([...threats.slice(0,threatIndex),{...threats[threatIndex],technique:[...technique.slice(0,index),{id:id,reference:reference,name:name,subtechnique:[]},...technique.slice(index+1)]},...threats.slice(threatIndex+1)])},[threatIndex,onFieldChange,field]),getSelectTechnique=Object(external_kbnSharedDeps_React_.useCallback)((tacticName,index,disabled,technique)=>{const options=techniquesOptions.filter(t=>t.tactics.includes(Object(external_kbnSharedDeps_LodashFp_.kebabCase)(tacticName)));return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSuperSelect,{id:"mitreAttackTechnique",options:[..."none"===technique.name?[{inputDisplay:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,TECHNIQUE_PLACEHOLDER),value:"none",disabled:disabled}]:[],...options.map(option=>({inputDisplay:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,option.label),value:option.value,disabled:disabled}))],prepend:`${field.label} ${TECHNIQUE}`,"aria-label":"",onChange:updateTechnique.bind(null,index),fullWidth:!0,valueOfSelected:Object(external_kbnSharedDeps_LodashFp_.camelCase)(technique.name),"data-test-subj":"mitreAttackTechnique",disabled:disabled,placeholder:TECHNIQUE_PLACEHOLDER}))},[field,updateTechnique]),techniques=null!==(_values$threatIndex$t=values[threatIndex].technique)&&void 0!==_values$threatIndex$t?_values$threatIndex$t:[];return external_kbnSharedDeps_React_default.a.createElement(TechniqueContainer,null,techniques.map((technique,index)=>external_kbnSharedDeps_React_default.a.createElement("div",{key:index},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{fullWidth:!0,describedByIds:idAria?[`${idAria} ${TECHNIQUE}`]:void 0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!0},getSelectTechnique(values[threatIndex].tactic.name,index,isDisabled,technique)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{color:"danger",iconType:"trash",isDisabled:isDisabled,onClick:()=>removeTechnique(index),"aria-label":rules_translations.J})))),external_kbnSharedDeps_React_default.a.createElement(MitreAttackSubtechniqueFields,{field:field,idAria:idAria,isDisabled:isDisabled||"none"===technique.name||!1===hasSubtechniqueOptions(technique),threatIndex:threatIndex,techniqueIndex:index,onFieldChange:onFieldChange}))),external_kbnSharedDeps_React_default.a.createElement(MyAddItemButton,{"data-test-subj":"addMitreAttackTechnique",onClick:addMitreAttackTechnique,isDisabled:isDisabled},ADD_MITRE_TECHNIQUE))},MitreAttackContainer=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"MitreAttackContainer",componentId:"bsl0gv-0"})(["margin-top:16px;"]),InitialMitreAttackFormRow=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFormRow).withConfig({displayName:"InitialMitreAttackFormRow",componentId:"bsl0gv-1"})([".euiFormRow__labelWrapper{.euiText{padding-right:32px;}}"]),AddMitreAttackThreat=Object(external_kbnSharedDeps_React_.memo)(({field:field,idAria:idAria,isDisabled:isDisabled})=>{const removeTactic=Object(external_kbnSharedDeps_React_.useCallback)(index=>{const values=[...field.value];values.splice(index,1),Object(external_kbnSharedDeps_LodashFp_.isEmpty)(values)?field.setValue(threatDefault):field.setValue(values)},[field]),addMitreAttackTactic=Object(external_kbnSharedDeps_React_.useCallback)(()=>{const values=[...field.value];Object(external_kbnSharedDeps_LodashFp_.isEmpty)(values[values.length-1])?field.setValue([{tactic:{id:"none",name:"none",reference:"none"},technique:[]}]):field.setValue([...values,{tactic:{id:"none",name:"none",reference:"none"},technique:[]}])},[field]),updateTactic=Object(external_kbnSharedDeps_React_.useCallback)((index,value)=>{const values=[...field.value],{id:id,reference:reference,name:name}=tacticsOptions.find(t=>t.value===value)||{id:"",name:"",reference:""};values.splice(index,1,{...values[index],tactic:{id:id,reference:reference,name:name},technique:[]}),field.setValue([...values])},[field]),values=Object(external_kbnSharedDeps_React_.useMemo)(()=>[...field.value],[field]),getSelectTactic=Object(external_kbnSharedDeps_React_.useCallback)((threat,index,disabled)=>{const tacticName=threat.tactic.name;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSuperSelect,{id:"mitreAttackTactic",options:[..."none"===tacticName?[{inputDisplay:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,TACTIC_PLACEHOLDER),value:"none",disabled:disabled}]:[],...tacticsOptions.map(t=>({inputDisplay:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,t.text),value:t.value,disabled:disabled}))],prepend:`${field.label} ${TACTIC}`,"aria-label":"",onChange:updateTactic.bind(null,index),fullWidth:!0,valueOfSelected:Object(external_kbnSharedDeps_LodashFp_.camelCase)(tacticName),"data-test-subj":"mitreAttackTactic",placeholder:TACTIC_PLACEHOLDER})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{color:"danger",iconType:"trash",isDisabled:isDisabled||Object(external_kbnSharedDeps_Lodash_.isEqual)(values,threatDefault),onClick:()=>removeTactic(index),"aria-label":rules_translations.J})))},[field,isDisabled,removeTactic,updateTactic,values]),onFieldChange=Object(external_kbnSharedDeps_React_.useCallback)(threats=>{field.setValue(threats)},[field]);return external_kbnSharedDeps_React_default.a.createElement(MitreAttackContainer,null,values.map((threat,index)=>external_kbnSharedDeps_React_default.a.createElement("div",{key:index},0===index?external_kbnSharedDeps_React_default.a.createElement(InitialMitreAttackFormRow,{fullWidth:!0,label:`${field.label} ${THREATS}`,labelAppend:field.labelAppend,describedByIds:idAria?[`${idAria} ${TACTIC}`]:void 0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,getSelectTactic(threat,index,isDisabled))):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{fullWidth:!0,describedByIds:idAria?[`${idAria} ${TACTIC}`]:void 0},getSelectTactic(threat,index,isDisabled)),external_kbnSharedDeps_React_default.a.createElement(MitreAttackTechniqueFields,{field:field,threatIndex:index,isDisabled:isDisabled||"none"===threat.tactic.name,idAria:idAria,onFieldChange:onFieldChange}))),external_kbnSharedDeps_React_default.a.createElement(MyAddItemButton,{"data-test-subj":"addMitreAttackTactic",onClick:addMitreAttackTactic,isDisabled:isDisabled},ADD_MITRE_TACTIC))});var utils_validators=__webpack_require__(352);const OptionalFieldLabel=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{color:"subdued",size:"xs"},rules_translations.fb),{emptyField:emptyField}=shared_imports.v,step_about_rule_schema_schema={author:{type:shared_imports.d.COMBO_BOX,label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldAuthorLabel",{defaultMessage:"Author"}),helpText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldAuthorHelpText",{defaultMessage:"Type one or more authors for this rule. Press enter after each author to add a new one."}),labelAppend:OptionalFieldLabel},name:{type:shared_imports.d.TEXT,label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldNameLabel",{defaultMessage:"Name"}),validations:[{validator:emptyField(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.nameFieldRequiredError",{defaultMessage:"A name is required."}))}]},description:{type:shared_imports.d.TEXTAREA,label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldDescriptionLabel",{defaultMessage:"Description"}),validations:[{validator:emptyField(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.descriptionFieldRequiredError",{defaultMessage:"A description is required."}))}]},isBuildingBlock:{type:shared_imports.d.CHECKBOX,label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldBuildingBlockLabel",{defaultMessage:'Mark all generated alerts as "building block" alerts'}),labelAppend:OptionalFieldLabel},isAssociatedToEndpointList:{type:shared_imports.d.CHECKBOX,label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldAssociatedToEndpointListLabel",{defaultMessage:"Add existing Endpoint exceptions to the rule"}),labelAppend:OptionalFieldLabel},severity:{value:{},mapping:{},isMappingChecked:{}},riskScore:{value:{},mapping:{},isMappingChecked:{}},references:{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldReferenceUrlsLabel",{defaultMessage:"Reference URLs"}),labelAppend:OptionalFieldLabel,validations:[{validator:(...args)=>{const[{value:value,path:path}]=args;let hasError=!1;return value.forEach(url=>{Object(utils_validators.a)(url)&&(hasError=!0)}),hasError?{code:"ERR_FIELD_FORMAT",path:path,message:URL_FORMAT_INVALID}:void 0}}]},falsePositives:{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldFalsePositiveLabel",{defaultMessage:"False positive examples"}),labelAppend:OptionalFieldLabel},license:{type:shared_imports.d.TEXT,label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldLicenseLabel",{defaultMessage:"License"}),helpText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldLicenseHelpText",{defaultMessage:"Add a license name"}),labelAppend:OptionalFieldLabel},ruleNameOverride:{type:shared_imports.d.TEXT,label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldRuleNameOverrideLabel",{defaultMessage:"Rule name override"}),helpText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldRuleNameOverrideHelpText",{defaultMessage:"Choose a field from the source event to populate the rule name in the alert list."}),labelAppend:OptionalFieldLabel},threat:{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldMitreThreatLabel",{defaultMessage:"MITRE ATT&CK\\u2122"}),labelAppend:OptionalFieldLabel},threatIndicatorPath:{type:shared_imports.d.TEXT,label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThreatIndicatorPathLabel",{defaultMessage:"Indicator prefix override"}),helpText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThreatIndicatorPathHelpText",{defaultMessage:"Specify the document prefix containing your indicator fields. Used for enrichment of indicator match alerts."}),labelAppend:OptionalFieldLabel},timestampOverride:{type:shared_imports.d.TEXT,label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTimestampOverrideLabel",{defaultMessage:"Timestamp override"}),helpText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTimestampOverrideHelpText",{defaultMessage:"Choose timestamp field used when executing rule. Pick field with timestamp closest to ingest time (e.g. event.ingested)."}),labelAppend:OptionalFieldLabel},tags:{type:shared_imports.d.COMBO_BOX,label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTagsLabel",{defaultMessage:"Tags"}),helpText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTagsHelpText",{defaultMessage:"Type one or more custom identifying tags for this rule. Press enter after each tag to begin a new one."}),labelAppend:OptionalFieldLabel},note:{type:shared_imports.d.TEXTAREA,label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.guideLabel",{defaultMessage:"Investigation guide"}),helpText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.guideHelpText",{defaultMessage:"Provide helpful information for analysts that are investigating detection alerts. This guide will appear on the rule details page and in timelines (as notes) created from detection alerts generated by this rule."}),labelAppend:OptionalFieldLabel}};var eui_form=__webpack_require__(307),lists_plugin_deps=__webpack_require__(231);const AutocompleteFieldMatchComponent=({placeholder:placeholder,rowLabel:rowLabel,selectedField:selectedField,selectedValue:selectedValue,indexPattern:indexPattern,isLoading:isLoading,isDisabled:isDisabled=!1,isClearable:isClearable=!1,isRequired:isRequired=!1,fieldInputWidth:fieldInputWidth,onChange:onChange,onError:onError})=>{const[searchQuery,setSearchQuery]=Object(external_kbnSharedDeps_React_.useState)(""),[touched,setIsTouched]=Object(external_kbnSharedDeps_React_.useState)(!1),[error,setError]=Object(external_kbnSharedDeps_React_.useState)(void 0),[isLoadingSuggestions,isSuggestingValues,suggestions]=(({selectedField:selectedField,operatorType:operatorType,fieldValue:fieldValue,query:query,indexPattern:indexPattern})=>{const{services:services}=Object(lib_kibana.h)(),[isLoading,setIsLoading]=Object(external_kbnSharedDeps_React_.useState)(!1),[isSuggestingValues,setIsSuggestingValues]=Object(external_kbnSharedDeps_React_.useState)(!0),[suggestions,setSuggestions]=Object(external_kbnSharedDeps_React_.useState)([]),updateSuggestions=Object(external_kbnSharedDeps_React_.useRef)(null);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{let isSubscribed=!0;const abortCtrl=new AbortController,fetchSuggestions=Object(external_kbnSharedDeps_Lodash_.debounce)(async({fieldSelected:fieldSelected,value:value,searchQuery:searchQuery,patterns:patterns})=>{try{if(isSubscribed){if(null==fieldSelected||null==patterns)return;if("boolean"===fieldSelected.type)return void setIsSuggestingValues(!1);setIsLoading(!0);const field=null!=fieldSelected.subType&&null!=fieldSelected.subType.nested?{...fieldSelected,name:`${fieldSelected.subType.nested.path}.${fieldSelected.name}`}:fieldSelected,newSuggestions=await services.data.autocomplete.getValueSuggestions({indexPattern:patterns,field:field,query:searchQuery,signal:abortCtrl.signal});0===newSuggestions.length&&setIsSuggestingValues(!1),setIsLoading(!1),setSuggestions([...newSuggestions])}}catch(error){isSubscribed&&(setSuggestions([]),setIsLoading(!1))}},500);return operatorType!==lists_plugin_deps.c.EXISTS&&fetchSuggestions({fieldSelected:selectedField,value:fieldValue,searchQuery:query,patterns:indexPattern}),updateSuggestions.current=fetchSuggestions,()=>{isSubscribed=!1,abortCtrl.abort()}},[services.data.autocomplete,selectedField,operatorType,fieldValue,indexPattern,query]),[isLoading,isSuggestingValues,suggestions,updateSuggestions.current]})({selectedField:selectedField,operatorType:lists_plugin_deps.c.MATCH,fieldValue:selectedValue,query:searchQuery,indexPattern:indexPattern}),getLabel=Object(external_kbnSharedDeps_React_.useCallback)(option=>option,[]),optionsMemo=Object(external_kbnSharedDeps_React_.useMemo)(()=>{const valueAsStr=String(selectedValue);return null!=selectedValue&&""!==selectedValue.trim()?Object(external_kbnSharedDeps_Lodash_.uniq)([valueAsStr,...suggestions]):suggestions},[suggestions,selectedValue]),selectedOptionsMemo=Object(external_kbnSharedDeps_React_.useMemo)(()=>{const valueAsStr=String(selectedValue);return selectedValue?[valueAsStr]:[]},[selectedValue]),handleError=Object(external_kbnSharedDeps_React_.useCallback)(err=>{setError(existingErr=>{const newErr=null!=err;return null!=existingErr!==newErr&&null!=onError&&onError(newErr),err})},[setError,onError]),{comboOptions:comboOptions,labels:labels,selectedComboOptions:selectedComboOptions}=Object(external_kbnSharedDeps_React_.useMemo)(()=>getGenericComboBoxProps({options:optionsMemo,selectedOptions:selectedOptionsMemo,getLabel:getLabel}),[optionsMemo,selectedOptionsMemo,getLabel]),handleValuesChange=Object(external_kbnSharedDeps_React_.useCallback)(newOptions=>{const[newValue]=newOptions.map(({label:label})=>optionsMemo[labels.indexOf(label)]);handleError(void 0),onChange(null!=newValue?newValue:"")},[handleError,labels,onChange,optionsMemo]),handleSearchChange=Object(external_kbnSharedDeps_React_.useCallback)(searchVal=>{if(""!==searchVal&&null!=selectedField){const err=paramIsValid(searchVal,selectedField,isRequired,touched);handleError(err),setSearchQuery(searchVal)}},[handleError,isRequired,selectedField,touched]),handleCreateOption=Object(external_kbnSharedDeps_React_.useCallback)(option=>{const err=paramIsValid(option,selectedField,isRequired,touched);if(handleError(err),null!=err)return!1;onChange(option)},[isRequired,onChange,selectedField,touched,handleError]),handleNonComboBoxInputChange=event=>{const newValue=event.target.value;onChange(newValue)},handleBooleanInputChange=newOption=>{onChange(newOption)},setIsTouchedValue=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setIsTouched(!0);const err=paramIsValid(selectedValue,selectedField,isRequired,!0);handleError(err)},[setIsTouched,handleError,selectedValue,selectedField,isRequired]),inputPlaceholder=Object(external_kbnSharedDeps_React_.useMemo)(()=>isLoading||isLoadingSuggestions?LOADING:null==selectedField?SELECT_FIELD_FIRST:placeholder,[isLoading,selectedField,isLoadingSuggestions,placeholder]),isLoadingState=Object(external_kbnSharedDeps_React_.useMemo)(()=>isLoading||isLoadingSuggestions,[isLoading,isLoadingSuggestions]);Object(external_kbnSharedDeps_React_.useEffect)(()=>{setError(void 0),null!=onError&&onError(!1)},[selectedField,onError]);const defaultInput=Object(external_kbnSharedDeps_React_.useMemo)(()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:rowLabel,error:error,isInvalid:null!=selectedField&&null!=error,"data-test-subj":"valuesAutocompleteMatchLabel",fullWidth:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiComboBox,{placeholder:inputPlaceholder,isDisabled:isDisabled||!selectedField,isLoading:isLoadingState,isClearable:isClearable,options:comboOptions,selectedOptions:selectedComboOptions,onChange:handleValuesChange,singleSelection:{asPlainText:!0},onSearchChange:handleSearchChange,onCreateOption:handleCreateOption,isInvalid:null!=selectedField&&null!=error,onBlur:setIsTouchedValue,sortMatchesBy:"startsWith","data-test-subj":"valuesAutocompleteMatch",style:fieldInputWidth?{width:fieldInputWidth+"px"}:{},fullWidth:!0,async:!0})),[comboOptions,error,fieldInputWidth,handleCreateOption,handleSearchChange,handleValuesChange,inputPlaceholder,isClearable,isDisabled,isLoadingState,rowLabel,selectedComboOptions,selectedField,setIsTouchedValue]);if(isSuggestingValues||null==selectedField)return defaultInput;switch(selectedField.type){case"number":return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:rowLabel,error:error,isInvalid:null!=selectedField&&null!=error,"data-test-subj":"valuesAutocompleteMatchLabel",fullWidth:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldNumber,{placeholder:inputPlaceholder,onBlur:setIsTouchedValue,value:"string"==typeof selectedValue&&selectedValue.trim().length>0?parseFloat(selectedValue):null!=selectedValue?selectedValue:"",onChange:handleNonComboBoxInputChange,"data-test-subj":"valueAutocompleteFieldMatchNumber",style:fieldInputWidth?{width:fieldInputWidth+"px"}:{},fullWidth:!0}));case"boolean":return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:rowLabel,error:error,isInvalid:null!=selectedField&&null!=error,"data-test-subj":"valuesAutocompleteMatchLabel",fullWidth:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSuperSelect,{isLoading:isLoadingState,options:[{value:"true",inputDisplay:"true"},{value:"false",inputDisplay:"false"}],valueOfSelected:null!=selectedValue?selectedValue:"true",onChange:handleBooleanInputChange,"data-test-subj":"valuesAutocompleteMatchBoolean",style:fieldInputWidth?{width:fieldInputWidth+"px"}:{},fullWidth:!0}));default:return defaultInput}};AutocompleteFieldMatchComponent.displayName="AutocompleteFieldMatch";const NestedContent=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"NestedContent",componentId:"sc-1o9f6e3-0"})(["margin-left:24px;"]),EuiFlexItemComboBoxColumn=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexItem).withConfig({displayName:"EuiFlexItemComboBoxColumn",componentId:"sc-1o9f6e3-1"})(["max-width:376px;"]),EuiFlexItemIconColumn=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexItem).withConfig({displayName:"EuiFlexItemIconColumn",componentId:"sc-1o9f6e3-2"})(["width:20px;"]),EuiFlexItemSeverityColumn=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexItem).withConfig({displayName:"EuiFlexItemSeverityColumn",componentId:"sc-1o9f6e3-3"})(["width:80px;"]),SeverityField=({dataTestSubj:dataTestSubj,field:field,idAria:idAria,indices:indices,isDisabled:isDisabled,options:options})=>{const{value:value,isMappingChecked:isMappingChecked,mapping:mapping}=field.value,{setValue:setValue}=field,handleFieldValueChange=Object(external_kbnSharedDeps_React_.useCallback)((newMappingItems,index)=>{setValue({value:value,isMappingChecked:isMappingChecked,mapping:[...mapping.slice(0,index),...newMappingItems,...mapping.slice(index+1)]})},[value,isMappingChecked,mapping,setValue]),handleFieldChange=Object(external_kbnSharedDeps_React_.useCallback)((index,severity,[newField])=>{var _newField$name;const newMappingItems=[{...mapping[index],field:null!==(_newField$name=null==newField?void 0:newField.name)&&void 0!==_newField$name?_newField$name:"",value:null!=newField?mapping[index].value:"",operator:"equals",severity:severity}];handleFieldValueChange(newMappingItems,index)},[mapping,handleFieldValueChange]),handleDefaultSeverityChange=Object(external_kbnSharedDeps_React_.useCallback)(newValue=>{setValue({value:newValue,isMappingChecked:isMappingChecked,mapping:mapping})},[isMappingChecked,mapping,setValue]),handleFieldMatchValueChange=Object(external_kbnSharedDeps_React_.useCallback)((index,severity,newMatchValue)=>{const newMappingItems=[{...mapping[index],field:mapping[index].field,value:null!=mapping[index].field&&""!==mapping[index].field?newMatchValue:"",operator:"equals",severity:severity}];handleFieldValueChange(newMappingItems,index)},[mapping,handleFieldValueChange]),handleSeverityMappingChecked=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setValue({value:value,mapping:[...mapping],isMappingChecked:!isMappingChecked})},[isMappingChecked,mapping,value,setValue]),severityLabel=Object(external_kbnSharedDeps_React_.useMemo)(()=>external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,SEVERITY)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs"},SEVERITY_DESCRIPTION)),[]),severityMappingLabel=Object(external_kbnSharedDeps_React_.useMemo)(()=>external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",gutterSize:"s",onClick:isDisabled?external_kbnSharedDeps_LodashFp_.noop:handleSeverityMappingChecked},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCheckbox,{id:"severity-mapping-override",checked:isMappingChecked,disabled:isDisabled,onChange:handleSeverityMappingChecked})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,SEVERITY_MAPPING)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(NestedContent,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs"},SEVERITY_MAPPING_DESCRIPTION))),[handleSeverityMappingChecked,isDisabled,isMappingChecked]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"column"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:severityLabel,labelAppend:field.labelAppend,helpText:field.helpText,error:"errorMessage",isInvalid:!1,fullWidth:!0,"data-test-subj":"detectionEngineStepAboutRuleSeverity",describedByIds:["detectionEngineStepAboutRuleSeverity"]},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSuperSelect,{fullWidth:!1,disabled:!1,valueOfSelected:value,onChange:handleDefaultSeverityChange,options:options,"data-test-subj":"select"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:severityMappingLabel,labelAppend:field.labelAppend,helpText:isMappingChecked?external_kbnSharedDeps_React_default.a.createElement(NestedContent,null,SEVERITY_MAPPING_DETAILS):"",error:"errorMessage",isInvalid:!1,fullWidth:!0,"data-test-subj":dataTestSubj+"-severityOverride",describedByIds:idAria?[idAria]:void 0},external_kbnSharedDeps_React_default.a.createElement(NestedContent,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),isMappingChecked&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"column",gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(EuiFlexItemComboBoxColumn,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormLabel,null,SOURCE_FIELD)),external_kbnSharedDeps_React_default.a.createElement(EuiFlexItemComboBoxColumn,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormLabel,null,SOURCE_VALUE)),external_kbnSharedDeps_React_default.a.createElement(EuiFlexItemIconColumn,{grow:!1}),external_kbnSharedDeps_React_default.a.createElement(EuiFlexItemSeverityColumn,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormLabel,null,DEFAULT_SEVERITY)))),mapping.map((severityMappingItem,index)=>{var _options$find;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{key:`${severityMappingItem.severity}-${index}`},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{"data-test-subj":"severityOverrideRow",alignItems:"center",gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(EuiFlexItemComboBoxColumn,null,external_kbnSharedDeps_React_default.a.createElement(FieldComponent,{placeholder:"",selectedField:getFieldTypeByMapping(severityMappingItem,indices),isLoading:!1,isDisabled:isDisabled,isClearable:!1,indexPattern:indices,onChange:handleFieldChange.bind(null,index,severityMappingItem.severity),"data-test-subj":`detectionEngineStepAboutRuleSeverityMappingField-${severityMappingItem.severity}-${index}`,"aria-label":`detectionEngineStepAboutRuleSeverityMappingField-${severityMappingItem.severity}-${index}`})),external_kbnSharedDeps_React_default.a.createElement(EuiFlexItemComboBoxColumn,null,external_kbnSharedDeps_React_default.a.createElement(AutocompleteFieldMatchComponent,{placeholder:"",selectedField:getFieldTypeByMapping(severityMappingItem,indices),selectedValue:severityMappingItem.value,isClearable:!1,isDisabled:isDisabled,isLoading:!1,indexPattern:indices,onChange:handleFieldMatchValueChange.bind(null,index,severityMappingItem.severity),"data-test-subj":`detectionEngineStepAboutRuleSeverityMappingValue-${severityMappingItem.severity}-${index}`,"aria-label":`detectionEngineStepAboutRuleSeverityMappingValue-${severityMappingItem.severity}-${index}`})),external_kbnSharedDeps_React_default.a.createElement(EuiFlexItemIconColumn,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{type:"sortRight"})),external_kbnSharedDeps_React_default.a.createElement(EuiFlexItemSeverityColumn,{grow:!1},null===(_options$find=options.find(o=>o.value===severityMappingItem.severity))||void 0===_options$find?void 0:_options$find.inputDisplay)))}))))))},getFieldTypeByMapping=(mapping,pattern)=>{const{field:field}=mapping,[knownFieldType]=pattern.fields.filter(({name:name})=>field===name);return null!=knownFieldType?knownFieldType:{name:field,type:"string"}},risk_score_mapping_NestedContent=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"NestedContent",componentId:"sc-1k1nimg-0"})(["margin-left:24px;"]),risk_score_mapping_EuiFlexItemComboBoxColumn=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexItem).withConfig({displayName:"EuiFlexItemComboBoxColumn",componentId:"sc-1k1nimg-1"})(["max-width:376px;"]),risk_score_mapping_EuiFlexItemIconColumn=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexItem).withConfig({displayName:"EuiFlexItemIconColumn",componentId:"sc-1k1nimg-2"})(["width:20px;"]),EuiFlexItemRiskScoreColumn=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexItem).withConfig({displayName:"EuiFlexItemRiskScoreColumn",componentId:"sc-1k1nimg-3"})(["width:160px;"]),RiskScoreField=({dataTestSubj:dataTestSubj,field:field,idAria:idAria,indices:indices,isDisabled:isDisabled,placeholder:placeholder})=>{const{value:value,isMappingChecked:isMappingChecked,mapping:mapping}=field.value,{setValue:setValue}=field,fieldTypeFilter=Object(external_kbnSharedDeps_React_.useMemo)(()=>["number"],[]),selectedField=Object(external_kbnSharedDeps_React_.useMemo)(()=>risk_score_mapping_getFieldTypeByMapping(mapping,indices),[mapping,indices]),handleDefaultRiskScoreChange=Object(external_kbnSharedDeps_React_.useCallback)(e=>{const range=e.target.value;setValue({value:Number(range.trim()),isMappingChecked:isMappingChecked,mapping:mapping})},[setValue,isMappingChecked,mapping]),handleRiskScoreMappingChange=Object(external_kbnSharedDeps_React_.useCallback)(([newField])=>{var _newField$name;setValue({value:value,isMappingChecked:isMappingChecked,mapping:[{field:null!==(_newField$name=null==newField?void 0:newField.name)&&void 0!==_newField$name?_newField$name:"",operator:"equals",value:"",risk_score:void 0}]})},[setValue,value,isMappingChecked]),handleRiskScoreMappingChecked=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setValue({value:value,isMappingChecked:!isMappingChecked,mapping:[...mapping]})},[setValue,value,isMappingChecked,mapping]),riskScoreLabel=Object(external_kbnSharedDeps_React_.useMemo)(()=>external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,DEFAULT_RISK_SCORE)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs"},RISK_SCORE_DESCRIPTION)),[]),riskScoreMappingLabel=Object(external_kbnSharedDeps_React_.useMemo)(()=>external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",gutterSize:"s",onClick:isDisabled?external_kbnSharedDeps_LodashFp_.noop:handleRiskScoreMappingChecked},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCheckbox,{id:"risk_score-mapping-override",checked:isMappingChecked,disabled:isDisabled,onChange:handleRiskScoreMappingChecked})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,RISK_SCORE_MAPPING)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(risk_score_mapping_NestedContent,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs"},RISK_SCORE_MAPPING_DESCRIPTION))),[isMappingChecked,handleRiskScoreMappingChecked,isDisabled]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"column"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:riskScoreLabel,labelAppend:field.labelAppend,helpText:field.helpText,error:"errorMessage",isInvalid:!1,fullWidth:!0,"data-test-subj":dataTestSubj+"-defaultRisk",describedByIds:idAria?[idAria]:void 0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiRange,{value:value,onChange:handleDefaultRiskScoreChange,max:100,min:0,showRange:!0,showInput:!0,fullWidth:!1,showTicks:!0,tickInterval:25,"data-test-subj":dataTestSubj+"-defaultRiskRange"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:riskScoreMappingLabel,labelAppend:field.labelAppend,helpText:isMappingChecked?external_kbnSharedDeps_React_default.a.createElement(risk_score_mapping_NestedContent,null,RISK_SCORE_MAPPING_DETAILS):"",error:"errorMessage",isInvalid:!1,fullWidth:!0,"data-test-subj":dataTestSubj+"-riskOverride",describedByIds:idAria?[idAria]:void 0},external_kbnSharedDeps_React_default.a.createElement(risk_score_mapping_NestedContent,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),isMappingChecked&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"column",gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(risk_score_mapping_EuiFlexItemComboBoxColumn,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormLabel,null,translations_SOURCE_FIELD)),external_kbnSharedDeps_React_default.a.createElement(risk_score_mapping_EuiFlexItemIconColumn,{grow:!1}),external_kbnSharedDeps_React_default.a.createElement(EuiFlexItemRiskScoreColumn,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormLabel,null,DEFAULT_RISK_SCORE)))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(risk_score_mapping_EuiFlexItemComboBoxColumn,null,external_kbnSharedDeps_React_default.a.createElement(FieldComponent,{placeholder:null!=placeholder?placeholder:"",indexPattern:indices,selectedField:selectedField,fieldTypeFilter:fieldTypeFilter,isLoading:!1,isClearable:!1,isDisabled:isDisabled,onChange:handleRiskScoreMappingChange,"data-test-subj":dataTestSubj,"aria-label":idAria})),external_kbnSharedDeps_React_default.a.createElement(risk_score_mapping_EuiFlexItemIconColumn,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{type:"sortRight"})),external_kbnSharedDeps_React_default.a.createElement(EuiFlexItemRiskScoreColumn,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"s"},RISK_SCORE_FIELD)))))))))},risk_score_mapping_getFieldTypeByMapping=(mapping,pattern)=>{var _mapping$0$field,_mapping$;const field=null!==(_mapping$0$field=null==mapping||null===(_mapping$=mapping[0])||void 0===_mapping$?void 0:_mapping$.field)&&void 0!==_mapping$0$field?_mapping$0$field:"",[knownFieldType]=pattern.fields.filter(({name:name})=>null!=field&&field===name);return null!=knownFieldType?knownFieldType:{name:field,type:"number"}},AutocompleteField=({dataTestSubj:dataTestSubj,field:field,idAria:idAria,indices:indices,isDisabled:isDisabled,fieldType:fieldType,placeholder:placeholder})=>{const handleFieldChange=Object(external_kbnSharedDeps_React_.useCallback)(([newField])=>{var _newField$name;field.setValue(null!==(_newField$name=null==newField?void 0:newField.name)&&void 0!==_newField$name?_newField$name:"")},[field]),selectedField=Object(external_kbnSharedDeps_React_.useMemo)(()=>{var _ref;const existingField=null!==(_ref=field.value)&&void 0!==_ref?_ref:"",[newSelectedField]=indices.fields.filter(({name:name})=>null!=existingField&&existingField===name);return newSelectedField},[field.value,indices]),fieldTypeFilter=Object(external_kbnSharedDeps_React_.useMemo)(()=>[fieldType],[fieldType]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{"data-test-subj":dataTestSubj,describedByIds:idAria?[idAria]:void 0,fullWidth:!0,helpText:field.helpText,label:field.label,labelAppend:field.labelAppend},external_kbnSharedDeps_React_default.a.createElement(FieldComponent,{placeholder:null!=placeholder?placeholder:"",indexPattern:indices,selectedField:selectedField,fieldTypeFilter:fieldTypeFilter,isLoading:!1,isDisabled:isDisabled,isClearable:!1,onChange:handleFieldChange,"data-test-subj":dataTestSubj,"aria-label":idAria,fieldInputWidth:500}))},step_about_rule_CommonUseField=Object(shared_imports.x)({component:shared_imports.e});external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"ThreeQuartersContainer",componentId:"sc-1nsr0kk-0"})(["max-width:740px;"]).displayName="ThreeQuartersContainer";const TagContainer=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"TagContainer",componentId:"sc-1nsr0kk-1"})(["margin-top:16px;"]);TagContainer.displayName="TagContainer";const StepAboutRuleComponent=({addPadding:addPadding=!1,defaultValues:defaultValues,defineRuleData:defineRuleData,descriptionColumns:descriptionColumns="singleSplit",isReadOnlyView:isReadOnlyView,isUpdateView:isUpdateView=!1,isLoading:isLoading,onSubmit:onSubmit,setForm:setForm})=>{var _defineRuleData$index;const initialState=null!=defaultValues?defaultValues:stepAboutDefaultValue,[severityValue,setSeverityValue]=Object(external_kbnSharedDeps_React_.useState)(initialState.severity.value),[indexPatternLoading,{indexPatterns:indexPatterns}]=Object(source.b)(null!==(_defineRuleData$index=null==defineRuleData?void 0:defineRuleData.index)&&void 0!==_defineRuleData$index?_defineRuleData$index:[]),{form:form}=Object(shared_imports.I)({defaultValue:initialState,options:{stripEmptyFields:!1},schema:step_about_rule_schema_schema}),{getFields:getFields,getFormData:getFormData,submit:submit}=form,[{severity:formSeverity}]=Object(shared_imports.K)({form:form,watch:["severity"]});Object(external_kbnSharedDeps_React_.useEffect)(()=>{const formSeverityValue=null==formSeverity?void 0:formSeverity.value;if(null!=formSeverityValue&&formSeverityValue!==severityValue){setSeverityValue(formSeverityValue);const newRiskScoreValue=defaultRiskScoreBySeverity[formSeverityValue];if(null!=newRiskScoreValue){const riskScoreField=getFields().riskScore;riskScoreField.setValue({...riskScoreField.value,value:newRiskScoreValue})}}},[null==formSeverity?void 0:formSeverity.value,getFields,severityValue]);const getData=Object(external_kbnSharedDeps_React_.useCallback)(async()=>{const result=await submit();return null!=result&&result.isValid?result:{isValid:!1,data:getFormData()}},[getFormData,submit]),handleSubmit=Object(external_kbnSharedDeps_React_.useCallback)(()=>{onSubmit&&onSubmit()},[onSubmit]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{let didCancel=!1;return setForm&&!didCancel&&setForm(rules_types.a.aboutRule,getData),()=>{didCancel=!0}},[getData,setForm]),isReadOnlyView?external_kbnSharedDeps_React_default.a.createElement(StepContentWrapper,{"data-test-subj":"aboutStep",addPadding:addPadding},external_kbnSharedDeps_React_default.a.createElement(StepRuleDescription,{columns:descriptionColumns,schema:step_about_rule_schema_schema,data:initialState})):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(StepContentWrapper,{addPadding:!isUpdateView},external_kbnSharedDeps_React_default.a.createElement(shared_imports.f,{form:form},external_kbnSharedDeps_React_default.a.createElement(step_about_rule_CommonUseField,{path:"name",componentProps:{idAria:"detectionEngineStepAboutRuleName","data-test-subj":"detectionEngineStepAboutRuleName",euiFieldProps:{fullWidth:!0,disabled:isLoading}}}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(step_about_rule_CommonUseField,{path:"description",componentProps:{idAria:"detectionEngineStepAboutRuleDescription","data-test-subj":"detectionEngineStepAboutRuleDescription",euiFieldProps:{disabled:isLoading,compressed:!0,fullWidth:!0}}}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(shared_imports.k,{path:"severity",component:SeverityField,componentProps:{dataTestSubj:"detectionEngineStepAboutRuleSeverityField",idAria:"detectionEngineStepAboutRuleSeverityField",isDisabled:isLoading||indexPatternLoading,options:severityOptions,indices:indexPatterns}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(step_about_rule_CommonUseField,{path:"riskScore",component:RiskScoreField,componentProps:{dataTestSubj:"detectionEngineStepAboutRuleRiskScore",idAria:"detectionEngineStepAboutRuleRiskScore",isDisabled:isLoading||indexPatternLoading,indices:indexPatterns}})),external_kbnSharedDeps_React_default.a.createElement(TagContainer,null,external_kbnSharedDeps_React_default.a.createElement(step_about_rule_CommonUseField,{path:"tags",componentProps:{idAria:"detectionEngineStepAboutRuleTags","data-test-subj":"detectionEngineStepAboutRuleTags",euiFieldProps:{fullWidth:!0,isDisabled:isLoading||indexPatternLoading,placeholder:""}}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiAccordion,{"data-test-subj":"advancedSettings",id:"advancedSettingsAccordion",buttonContent:ADVANCED_SETTINGS},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(shared_imports.k,{path:"references",component:AddItem,componentProps:{addText:ADD_REFERENCE,idAria:"detectionEngineStepAboutRuleReferenceUrls",isDisabled:isLoading,dataTestSubj:"detectionEngineStepAboutRuleReferenceUrls",validate:utils_validators.a}}),external_kbnSharedDeps_React_default.a.createElement(shared_imports.k,{path:"falsePositives",component:AddItem,componentProps:{addText:ADD_FALSE_POSITIVE,idAria:"detectionEngineStepAboutRuleFalsePositives",isDisabled:isLoading,dataTestSubj:"detectionEngineStepAboutRuleFalsePositives"}}),external_kbnSharedDeps_React_default.a.createElement(shared_imports.k,{path:"threat",component:AddMitreAttackThreat,componentProps:{idAria:"detectionEngineStepAboutRuleMitreThreat",isDisabled:isLoading,dataTestSubj:"detectionEngineStepAboutRuleMitreThreat"}}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(shared_imports.k,{path:"note",component:eui_form.a,componentProps:{idAria:"detectionEngineStepAboutRuleNote",isDisabled:isLoading,dataTestSubj:"detectionEngineStepAboutRuleNote",placeholder:ADD_RULE_NOTE_HELP_TEXT}}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(step_about_rule_CommonUseField,{path:"author",componentProps:{idAria:"detectionEngineStepAboutRuleAuthor","data-test-subj":"detectionEngineStepAboutRuleAuthor",euiFieldProps:{fullWidth:!0,isDisabled:isLoading,placeholder:""}}}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(step_about_rule_CommonUseField,{path:"license",componentProps:{idAria:"detectionEngineStepAboutRuleLicense","data-test-subj":"detectionEngineStepAboutRuleLicense",euiFieldProps:{fullWidth:!0,disabled:isLoading,placeholder:""}}}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:GLOBAL_ENDPOINT_EXCEPTION_LIST,fullWidth:!0},external_kbnSharedDeps_React_default.a.createElement(step_about_rule_CommonUseField,{path:"isAssociatedToEndpointList",componentProps:{idAria:"detectionEngineStepAboutRuleAssociatedToEndpointList","data-test-subj":"detectionEngineStepAboutRuleAssociatedToEndpointList",euiFieldProps:{disabled:isLoading}}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:BUILDING_BLOCK,fullWidth:!0},external_kbnSharedDeps_React_default.a.createElement(step_about_rule_CommonUseField,{path:"isBuildingBlock",componentProps:{idAria:"detectionEngineStepAboutRuleBuildingBlock","data-test-subj":"detectionEngineStepAboutRuleBuildingBlock",euiFieldProps:{disabled:isLoading}}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"}),Object(utils.e)(null==defineRuleData?void 0:defineRuleData.ruleType)&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(step_about_rule_CommonUseField,{path:"threatIndicatorPath",componentProps:{idAria:"detectionEngineStepAboutThreatIndicatorPath","data-test-subj":"detectionEngineStepAboutThreatIndicatorPath",euiFieldProps:{fullWidth:!0,disabled:isLoading,placeholder:constants.w}}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(shared_imports.k,{path:"ruleNameOverride",component:AutocompleteField,componentProps:{dataTestSubj:"detectionEngineStepAboutRuleRuleNameOverride",fieldType:"string",idAria:"detectionEngineStepAboutRuleRuleNameOverride",indices:indexPatterns,isDisabled:isLoading||indexPatternLoading,placeholder:""}}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(shared_imports.k,{path:"timestampOverride",component:AutocompleteField,componentProps:{dataTestSubj:"detectionEngineStepAboutRuleTimestampOverride",fieldType:"date",idAria:"detectionEngineStepAboutRuleTimestampOverride",indices:indexPatterns,isDisabled:isLoading||indexPatternLoading,placeholder:""}})))),!isUpdateView&&external_kbnSharedDeps_React_default.a.createElement(NextStep,{dataTestSubj:"about-continue",onClick:handleSubmit,isDisabled:isLoading}))},StepAboutRule=Object(external_kbnSharedDeps_React_.memo)(StepAboutRuleComponent),SECONDS=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRuleForm.secondsOptionDescription",{defaultMessage:"Seconds"}),MINUTES=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRuleForm.minutesOptionDescription",{defaultMessage:"Minutes"}),HOURS=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRuleForm.hoursOptionDescription",{defaultMessage:"Hours"});external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRuleForm.invalidTimeMessageDescription",{defaultMessage:"A time is required."});function schedule_item_form_extends(){return(schedule_item_form_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const timeTypeOptions=[{value:"s",text:SECONDS},{value:"m",text:MINUTES},{value:"h",text:HOURS}],StyledLabelAppend=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexItem).withConfig({displayName:"StyledLabelAppend",componentId:"d3i8n6-0"})(["&.euiFlexItem.euiFlexItem--flexGrowZero{margin-left:31px;}"]),schedule_item_form_StyledEuiFormRow=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFormRow).withConfig({displayName:"StyledEuiFormRow",componentId:"d3i8n6-1"})(["max-width:none;.euiFormControlLayout{max-width:200px !important;}.euiFormControlLayout__childrenWrapper > *:first-child{box-shadow:none;height:38px;}.euiFormControlLayout:not(:first-child){border-left:1px solid ",";}"],({theme:theme})=>theme.eui.euiColorLightShade),MyEuiSelect=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiSelect).withConfig({displayName:"MyEuiSelect",componentId:"d3i8n6-2"})(["width:auto;"]),ScheduleItem=({dataTestSubj:dataTestSubj,field:field,idAria:idAria,isDisabled:isDisabled,minimumValue:minimumValue=0})=>{const[timeType,setTimeType]=Object(external_kbnSharedDeps_React_.useState)("s"),[timeVal,setTimeVal]=Object(external_kbnSharedDeps_React_.useState)(0),{isInvalid:isInvalid,errorMessage:errorMessage}=Object(shared_imports.w)(field),{value:value,setValue:setValue}=field,onChangeTimeType=Object(external_kbnSharedDeps_React_.useCallback)(e=>{setTimeType(e.target.value),setValue(`${timeVal}${e.target.value}`)},[setValue,timeVal]),onChangeTimeVal=Object(external_kbnSharedDeps_React_.useCallback)(e=>{const sanitizedValue=((input,defaultValue=0)=>{const number=parseInt(input,10);return Number.isNaN(number)?defaultValue:Math.min(number,Number.MAX_SAFE_INTEGER)})(e.target.value,minimumValue);setTimeVal(sanitizedValue),setValue(`${sanitizedValue}${timeType}`)},[minimumValue,setValue,timeType]);Object(external_kbnSharedDeps_React_.useEffect)(()=>{if(value!==`${timeVal}${timeType}`){const filterTimeVal=value.match(/\d+/g),filterTimeType=value.match(/[a-zA-Z]+/g);Object(external_kbnSharedDeps_LodashFp_.isEmpty)(filterTimeVal)||null==filterTimeVal||isNaN(Number(filterTimeVal[0]))||Number(filterTimeVal[0])===Number(timeVal)||setTimeVal(Number(filterTimeVal[0])),!Object(external_kbnSharedDeps_LodashFp_.isEmpty)(filterTimeType)&&null!=filterTimeType&&["s","m","h"].includes(filterTimeType[0])&&filterTimeType[0]!==timeType&&setTimeType(filterTimeType[0])}},[timeType,timeVal,value]);const rest={disabled:isDisabled},label=Object(external_kbnSharedDeps_React_.useMemo)(()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s",justifyContent:"flexStart",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,component:"span"},field.label),external_kbnSharedDeps_React_default.a.createElement(StyledLabelAppend,{grow:!1,component:"span"},field.labelAppend)),[field.label,field.labelAppend]);return external_kbnSharedDeps_React_default.a.createElement(schedule_item_form_StyledEuiFormRow,{label:label,helpText:field.helpText,error:errorMessage,isInvalid:isInvalid,fullWidth:!1,"data-test-subj":dataTestSubj,describedByIds:idAria?[idAria]:void 0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormControlLayout,{append:external_kbnSharedDeps_React_default.a.createElement(MyEuiSelect,schedule_item_form_extends({fullWidth:!1,options:timeTypeOptions,onChange:onChangeTimeType,value:timeType,"data-test-subj":"timeType"},rest))},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldNumber,schedule_item_form_extends({fullWidth:!0,min:minimumValue,max:Number.MAX_SAFE_INTEGER,onChange:onChangeTimeVal,value:timeVal,"data-test-subj":"interval"},rest))))},step_schedule_rule_schema_schema={interval:{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.fieldIntervalLabel",{defaultMessage:"Runs every"}),helpText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.fieldIntervalHelpText",{defaultMessage:"Rules run periodically and detect alerts within the specified time frame."})},from:{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.fieldAdditionalLookBackLabel",{defaultMessage:"Additional look-back time"}),labelAppend:OptionalFieldLabel,helpText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.fieldAdditionalLookBackHelpText",{defaultMessage:"Adds time to the look-back period to prevent missed alerts."})}},stepScheduleDefaultValue={interval:"5m",from:"1m"},StepScheduleRuleComponent=({addPadding:addPadding=!1,defaultValues:defaultValues,descriptionColumns:descriptionColumns="singleSplit",isReadOnlyView:isReadOnlyView,isLoading:isLoading,isUpdateView:isUpdateView=!1,onSubmit:onSubmit,setForm:setForm})=>{const initialState=null!=defaultValues?defaultValues:stepScheduleDefaultValue,{form:form}=Object(shared_imports.I)({defaultValue:initialState,options:{stripEmptyFields:!1},schema:step_schedule_rule_schema_schema}),{getFormData:getFormData,submit:submit}=form,handleSubmit=Object(external_kbnSharedDeps_React_.useCallback)(()=>{onSubmit&&onSubmit()},[onSubmit]),getData=Object(external_kbnSharedDeps_React_.useCallback)(async()=>{const result=await submit();return null!=result&&result.isValid?result:{isValid:!1,data:getFormData()}},[getFormData,submit]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{let didCancel=!1;return setForm&&!didCancel&&setForm(rules_types.a.scheduleRule,getData),()=>{didCancel=!0}},[getData,setForm]),isReadOnlyView?external_kbnSharedDeps_React_default.a.createElement(StepContentWrapper,{addPadding:addPadding},external_kbnSharedDeps_React_default.a.createElement(StepRuleDescription,{columns:descriptionColumns,schema:step_schedule_rule_schema_schema,data:initialState})):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(StepContentWrapper,{addPadding:!isUpdateView},external_kbnSharedDeps_React_default.a.createElement(shared_imports.f,{form:form,"data-test-subj":"stepScheduleRule"},external_kbnSharedDeps_React_default.a.createElement(shared_imports.k,{path:"interval",component:ScheduleItem,componentProps:{idAria:"detectionEngineStepScheduleRuleInterval",isDisabled:isLoading,dataTestSubj:"detectionEngineStepScheduleRuleInterval"}}),external_kbnSharedDeps_React_default.a.createElement(shared_imports.k,{path:"from",component:ScheduleItem,componentProps:{idAria:"detectionEngineStepScheduleRuleFrom",isDisabled:isLoading,dataTestSubj:"detectionEngineStepScheduleRuleFrom",minimumValue:1}}))),!isUpdateView&&external_kbnSharedDeps_React_default.a.createElement(NextStep,{dataTestSubj:"schedule-continue",onClick:handleSubmit,isDisabled:isLoading}))},StepScheduleRule=Object(external_kbnSharedDeps_React_.memo)(StepScheduleRuleComponent);var react_markdown=__webpack_require__(1027),react_markdown_default=__webpack_require__.n(react_markdown),triggersActionsUi_public_=__webpack_require__(104);const FORM_ERRORS_TITLE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.ruleActionsField.ruleActionsFormErrorsTitle",{defaultMessage:"Please fix issues listed below"}),FieldErrorsContainer=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"FieldErrorsContainer",componentId:"sc-1brsijn-0"})(["p{margin-bottom:0;}"]),ContainerActions=external_kbnSharedDeps_StyledComponents_default.a.div.attrs(({className:className="",$caseIndexes:$caseIndexes=[]})=>({className:className})).withConfig({displayName:"ContainerActions",componentId:"sc-1brsijn-1"})(["",""],({$caseIndexes:$caseIndexes})=>$caseIndexes.map(index=>`\n        div[id="${index}"].euiAccordion__childWrapper .euiAccordion__padding--l {\n          padding: 0px;\n          .euiFlexGroup {\n            display: none;\n          }\n          .euiSpacer.euiSpacer--xl {\n            height: 0px;\n          }\n        }\n      `)),RuleActionsField=({field:field,hasErrorOnCreationCaseAction:hasErrorOnCreationCaseAction,messageVariables:messageVariables})=>{const[fieldErrors,setFieldErrors]=Object(external_kbnSharedDeps_React_.useState)(null),[supportedActionTypes,setSupportedActionTypes]=Object(external_kbnSharedDeps_React_.useState)(),form=Object(shared_imports.J)(),{isSubmitted:isSubmitted,isSubmitting:isSubmitting,isValid:isValid}=form,{http:http,triggersActionsUi:{actionTypeRegistry:actionTypeRegistry}}=Object(lib_kibana.h)().services,actions=Object(external_kbnSharedDeps_React_.useMemo)(()=>Object(external_kbnSharedDeps_LodashFp_.isEmpty)(field.value)?[]:field.value,[field.value]),caseActionIndexes=Object(external_kbnSharedDeps_React_.useMemo)(()=>actions.reduce((acc,action,actionIndex)=>".case"===action.actionTypeId?[...acc,""+actionIndex]:acc,[]),[actions]),setActionIdByIndex=Object(external_kbnSharedDeps_React_.useCallback)((id,index)=>{const updatedActions=[...actions];updatedActions[index]=cjs_default()(updatedActions[index],{id:id}),field.setValue(updatedActions)},[field.setValue,actions]),setAlertActionsProperty=Object(external_kbnSharedDeps_React_.useCallback)(updatedActions=>field.setValue(updatedActions),[field]),setActionParamsProperty=Object(external_kbnSharedDeps_React_.useCallback)((key,value,index)=>{const updatedActions=[...actions];updatedActions[index].params[key]=value,field.setValue(updatedActions)},[field.setValue,actions]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{!async function(){const supportedTypes=((actionTypes,hasErrorOnCreationCaseAction)=>actionTypes.filter(actionType=>(".case"!==actionType.id||!hasErrorOnCreationCaseAction)&&constants.Y.includes(actionType.id)))(await Object(triggersActionsUi_public_.loadActionTypes)({http:http}),hasErrorOnCreationCaseAction);setSupportedActionTypes(supportedTypes)}()},[hasErrorOnCreationCaseAction]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{if(isSubmitting||!field.errors.length)return setFieldErrors(null);if(isSubmitted&&!isSubmitting&&!1===isValid&&field.errors.length){const errorsString=field.errors.map(({message:message})=>message).join("\n");return setFieldErrors(errorsString)}},[isSubmitted,isSubmitting,field.isChangingValue,isValid,field.errors,setFieldErrors]),supportedActionTypes?external_kbnSharedDeps_React_default.a.createElement(ContainerActions,{$caseIndexes:caseActionIndexes},fieldErrors?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(FieldErrorsContainer,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:FORM_ERRORS_TITLE,color:"danger",iconType:"alert"},external_kbnSharedDeps_React_default.a.createElement(react_markdown_default.a,{source:fieldErrors}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null)):null,external_kbnSharedDeps_React_default.a.createElement(triggersActionsUi_public_.ActionForm,{actions:actions,messageVariables:messageVariables,defaultActionGroupId:"default",setActionIdByIndex:setActionIdByIndex,setActions:setAlertActionsProperty,setActionParamsProperty:setActionParamsProperty,actionTypeRegistry:actionTypeRegistry,actionTypes:supportedActionTypes,defaultActionMessage:"Rule {{context.rule.name}} generated {{state.signals_count}} alerts"})):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null)},COMPLETE_WITHOUT_ACTIVATING=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.completeWithoutActivatingTitle",{defaultMessage:"Create rule without activating it"}),COMPLETE_WITH_ACTIVATING=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.completeWithActivatingTitle",{defaultMessage:"Create & activate rule"}),NO_CONNECTOR_SELECTED=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepRuleActions.noConnectorSelectedErrorMessage",{defaultMessage:"No connector selected"}),NO_ACTIONS_READ_PERMISSIONS=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepRuleActions.noReadActionsPrivileges",{defaultMessage:'Cannot create rule actions. You do not have "Read" permissions for the "Actions" plugin.'});var mustache=__webpack_require__(1106),mustache_default=__webpack_require__.n(mustache);const UUID_REGEX=/^[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}$/i,validateMustache=params=>{const errors=[];return Object.entries(params).forEach(([paramKey,paramValue])=>{if(Object(external_kbnSharedDeps_LodashFp_.isString)(paramValue))try{mustache_default.a.render(paramValue,{})}catch(e){errors.push((paramKey=>external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepRuleActions.invalidMustacheTemplateErrorMessage",{defaultMessage:"{key} is not valid mustache template",values:{key:Object(external_kbnSharedDeps_LodashFp_.startCase)(paramKey)}}))(paramKey))}}),errors},validateSingleAction=(actionItem,actionTypeRegistry)=>{if(!actionItem.id.match(UUID_REGEX))return[NO_CONNECTOR_SELECTED];return[...((actionItem,actionTypeRegistry)=>{var _actionTypeRegistry$g;const actionErrors=null===(_actionTypeRegistry$g=actionTypeRegistry.get(actionItem.actionTypeId))||void 0===_actionTypeRegistry$g?void 0:_actionTypeRegistry$g.validateParams(actionItem.params);if(actionErrors){const actionErrorsValues=Object.values(actionErrors.errors);if(actionErrorsValues.length){const filteredObjects=actionErrorsValues.filter(item=>Object(external_kbnSharedDeps_LodashFp_.isString)(item)||Object(external_kbnSharedDeps_LodashFp_.isArray)(item)),uniqActionErrors=Object(external_kbnSharedDeps_LodashFp_.uniq)(Object(external_kbnSharedDeps_LodashFp_.flattenDeep)(filteredObjects));if(uniqActionErrors.length)return uniqActionErrors}}return[]})(actionItem,actionTypeRegistry),...validateMustache(actionItem.params)]},validateRuleActionsField=actionTypeRegistry=>(...data)=>{const[{value:value,path:path}]=data,errors=value.reduce((acc,actionItem)=>{const errorsArray=validateSingleAction(actionItem,actionTypeRegistry);if(errorsArray.length){const actionTypeName=(actionTypeId=>{if(!actionTypeId)return"";const actionType=actionTypeId.split(".")[1];return actionType?Object(external_kbnSharedDeps_LodashFp_.startCase)(actionType):""})(actionItem.actionTypeId),errorsListItems=errorsArray.map(error=>`*   ${error}\n`);return[...acc,`\n**${actionTypeName}:**\n${errorsListItems.join("")}`]}return acc},[]);if(errors.length)return{code:"ERR_FIELD_FORMAT",path:path,message:""+errors.join("\n")}};var common_constants=__webpack_require__(41);const useManageCaseAction=()=>{const hasInit=Object(external_kbnSharedDeps_React_.useRef)(!0),[loading,setLoading]=Object(external_kbnSharedDeps_React_.useState)(!0),[hasError,setHasError]=Object(external_kbnSharedDeps_React_.useState)(!1);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{const abortCtrl=new AbortController;return hasInit.current&&(hasInit.current=!1,(async()=>{try{(await lib_kibana.b.get().http.fetch(common_constants.b,{method:"GET",signal:abortCtrl.signal})).some(a=>".case"===a.actionTypeId&&"Cases"===a.name)||await lib_kibana.b.get().http.post(common_constants.b+"/action",{method:"POST",body:JSON.stringify({actionTypeId:".case",config:{},name:"Cases",secrets:{}}),signal:abortCtrl.signal}),setLoading(!1)}catch{setLoading(!1),setHasError(!0)}})()),()=>{abortCtrl.abort()}},[]),[loading,hasError]},stepActionsDefaultValue={enabled:!0,actions:[],kibanaSiemAppUrl:"",throttle:DEFAULT_THROTTLE_OPTION.value},GhostFormField=()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null),StepRuleActionsComponent=({addPadding:addPadding=!1,defaultValues:defaultValues,isReadOnlyView:isReadOnlyView,isLoading:isLoading,isUpdateView:isUpdateView=!1,onSubmit:onSubmit,setForm:setForm,actionMessageParams:actionMessageParams})=>{const[isLoadingCaseAction,hasErrorOnCreationCaseAction]=useManageCaseAction(),{services:{application:application,triggersActionsUi:{actionTypeRegistry:actionTypeRegistry}}}=Object(lib_kibana.h)(),kibanaAbsoluteUrl=Object(external_kbnSharedDeps_React_.useMemo)(()=>application.getUrlForApp(""+constants.f,{absolute:!0}),[application]),initialState={...null!=defaultValues?defaultValues:stepActionsDefaultValue,kibanaSiemAppUrl:kibanaAbsoluteUrl},schema=Object(external_kbnSharedDeps_React_.useMemo)(()=>(({actionTypeRegistry:actionTypeRegistry})=>({actions:{validations:[{validator:validateRuleActionsField(actionTypeRegistry)}]},enabled:{},kibanaSiemAppUrl:{},throttle:{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepRuleActions.fieldThrottleLabel",{defaultMessage:"Actions frequency"}),helpText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepRuleActions.fieldThrottleHelpText",{defaultMessage:"Select when automated actions should be performed if a rule evaluates as true."})}}))({actionTypeRegistry:actionTypeRegistry}),[actionTypeRegistry]),{form:form}=Object(shared_imports.I)({defaultValue:initialState,options:{stripEmptyFields:!1},schema:schema}),{getFields:getFields,getFormData:getFormData,submit:submit}=form,[{throttle:formThrottle}]=Object(shared_imports.K)({form:form,watch:["throttle"]}),throttle=formThrottle||initialState.throttle,handleSubmit=Object(external_kbnSharedDeps_React_.useCallback)(enabled=>{getFields().enabled.setValue(enabled),onSubmit&&onSubmit()},[getFields,onSubmit]),getData=Object(external_kbnSharedDeps_React_.useCallback)(async()=>{const result=await submit();return null!=result&&result.isValid?result:{isValid:!1,data:getFormData()}},[getFormData,submit]);Object(external_kbnSharedDeps_React_.useEffect)(()=>{let didCancel=!1;return setForm&&!didCancel&&setForm(rules_types.a.ruleActions,getData),()=>{didCancel=!0}},[getData,setForm]);const throttleOptions=Object(external_kbnSharedDeps_React_.useMemo)(()=>(throttle=>throttle&&Object(external_kbnSharedDeps_LodashFp_.findIndex)(["value",throttle],THROTTLE_OPTIONS)<0?[...THROTTLE_OPTIONS,{value:throttle,text:throttle}]:THROTTLE_OPTIONS)(throttle),[throttle]),throttleFieldComponentProps=Object(external_kbnSharedDeps_React_.useMemo)(()=>({idAria:"detectionEngineStepRuleActionsThrottle",isDisabled:isLoading,isLoading:isLoadingCaseAction,dataTestSubj:"detectionEngineStepRuleActionsThrottle",hasNoInitialSelection:!1,euiFieldProps:{options:throttleOptions}}),[isLoading,isLoadingCaseAction,throttleOptions]),displayActionsOptions=Object(external_kbnSharedDeps_React_.useMemo)(()=>throttle!==stepActionsDefaultValue.throttle?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),external_kbnSharedDeps_React_default.a.createElement(shared_imports.k,{path:"actions",component:RuleActionsField,componentProps:{messageVariables:actionMessageParams,hasErrorOnCreationCaseAction:hasErrorOnCreationCaseAction}})):external_kbnSharedDeps_React_default.a.createElement(shared_imports.k,{path:"actions",component:GhostFormField}),[throttle,actionMessageParams,hasErrorOnCreationCaseAction]),displayActionsDropDown=Object(external_kbnSharedDeps_React_.useMemo)(()=>application.capabilities.actions.show?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(shared_imports.k,{path:"throttle",component:ThrottleSelectField,componentProps:throttleFieldComponentProps}),displayActionsOptions,external_kbnSharedDeps_React_default.a.createElement(shared_imports.k,{path:"kibanaSiemAppUrl",component:GhostFormField}),external_kbnSharedDeps_React_default.a.createElement(shared_imports.k,{path:"enabled",component:GhostFormField})):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,NO_ACTIONS_READ_PERMISSIONS),external_kbnSharedDeps_React_default.a.createElement(shared_imports.k,{path:"throttle",componentProps:throttleFieldComponentProps,component:GhostFormField}),external_kbnSharedDeps_React_default.a.createElement(shared_imports.k,{path:"actions",component:GhostFormField}),external_kbnSharedDeps_React_default.a.createElement(shared_imports.k,{path:"kibanaSiemAppUrl",component:GhostFormField}),external_kbnSharedDeps_React_default.a.createElement(shared_imports.k,{path:"enabled",component:GhostFormField})),[application.capabilities.actions.show,displayActionsOptions,throttleFieldComponentProps]);return isReadOnlyView?external_kbnSharedDeps_React_default.a.createElement(StepContentWrapper,{addPadding:addPadding},external_kbnSharedDeps_React_default.a.createElement(StepRuleDescription,{schema:schema,data:initialState,columns:"single"})):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(StepContentWrapper,{addPadding:!isUpdateView},external_kbnSharedDeps_React_default.a.createElement(shared_imports.f,{form:form,"data-test-subj":"stepRuleActions"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiForm,null,displayActionsDropDown))),!isUpdateView&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHorizontalRule,{margin:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",justifyContent:"flexEnd",gutterSize:"xs",responsive:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{fill:!1,isDisabled:isLoading,isLoading:isLoading,onClick:()=>handleSubmit(!1)},COMPLETE_WITHOUT_ACTIVATING)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{fill:!0,isDisabled:isLoading,isLoading:isLoading,onClick:()=>handleSubmit(!0),"data-test-subj":"create-activate"},COMPLETE_WITH_ACTIVATING)))))},StepRuleActions=Object(external_kbnSharedDeps_React_.memo)(StepRuleActionsComponent);var header_page=__webpack_require__(198);function detection_engine_header_page_extends(){return(detection_engine_header_page_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const DetectionEngineHeaderPageComponent=props=>external_kbnSharedDeps_React_default.a.createElement(header_page.a,detection_engine_header_page_extends({hideSourcerer:!0},props)),DetectionEngineHeaderPage=external_kbnSharedDeps_React_default.a.memo(DetectionEngineHeaderPageComponent);DetectionEngineHeaderPage.displayName="DetectionEngineHeaderPage";const PAGE_TITLE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.pageTitle",{defaultMessage:"Create new rule"}),BACK_TO_RULES=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.backToRulesDescription",{defaultMessage:"Back to detection rules"}),EDIT_RULE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.createRule.editRuleButton",{defaultMessage:"Edit"});var app_types=__webpack_require__(3),rules_utils=__webpack_require__(478);const formHookNoop=async()=>{},MyEuiPanel=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiPanel).withConfig({displayName:"MyEuiPanel",componentId:"wzrzmg-0"})(["position:relative;z-index:",";> .euiAccordion > .euiAccordion__triggerWrapper{.euiAccordion__button{cursor:default !important;&:hover{text-decoration:none !important;}}.euiAccordion__iconWrapper{display:none;}}"],props=>props.zindex);MyEuiPanel.displayName="MyEuiPanel";const StepDefineRuleAccordion=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiAccordion).withConfig({displayName:"StepDefineRuleAccordion",componentId:"wzrzmg-1"})([".euiAccordion__childWrapper{overflow:visible;}"]);StepDefineRuleAccordion.displayName="StepDefineRuleAccordion";const CreateRulePageComponent=()=>{var _stepsData$current$Ru,_stepsData$current$Ru2;const[{loading:userInfoLoading,isSignalIndexExists:isSignalIndexExists,isAuthenticated:isAuthenticated,hasEncryptionKey:hasEncryptionKey,canUserCRUD:canUserCRUD}]=Object(user_info.b)(),{loading:listsConfigLoading,needsConfiguration:needsListsConfiguration}=useListsConfig(),loading=userInfoLoading||listsConfigLoading,[,dispatchToaster]=Object(toasters.h)(),[activeStep,setActiveStep]=Object(external_kbnSharedDeps_React_.useState)(rules_types.a.defineRule),defineRuleRef=Object(external_kbnSharedDeps_React_.useRef)(null),aboutRuleRef=Object(external_kbnSharedDeps_React_.useRef)(null),scheduleRuleRef=Object(external_kbnSharedDeps_React_.useRef)(null),ruleActionsRef=Object(external_kbnSharedDeps_React_.useRef)(null),formHooks=Object(external_kbnSharedDeps_React_.useRef)({[rules_types.a.defineRule]:formHookNoop,[rules_types.a.aboutRule]:formHookNoop,[rules_types.a.scheduleRule]:formHookNoop,[rules_types.a.ruleActions]:formHookNoop}),setFormHook=Object(external_kbnSharedDeps_React_.useCallback)((step,hook)=>{formHooks.current[step]=hook},[]),stepsData=Object(external_kbnSharedDeps_React_.useRef)({[rules_types.a.defineRule]:{isValid:!1,data:void 0},[rules_types.a.aboutRule]:{isValid:!1,data:void 0},[rules_types.a.scheduleRule]:{isValid:!1,data:void 0},[rules_types.a.ruleActions]:{isValid:!1,data:void 0}}),setStepData=(step,data)=>{stepsData.current[step]=data},[openSteps,setOpenSteps]=Object(external_kbnSharedDeps_React_.useState)({[rules_types.a.defineRule]:!1,[rules_types.a.aboutRule]:!1,[rules_types.a.scheduleRule]:!1,[rules_types.a.ruleActions]:!1}),[{isLoading:isLoading,ruleId:ruleId},setRule]=(()=>{const[rule,setRule]=Object(external_kbnSharedDeps_React_.useState)(null),[ruleId,setRuleId]=Object(external_kbnSharedDeps_React_.useState)(null),[isLoading,setIsLoading]=Object(external_kbnSharedDeps_React_.useState)(!1),{addError:addError}=Object(use_app_toasts.a)();return Object(external_kbnSharedDeps_React_.useEffect)(()=>{let isSubscribed=!0;const abortCtrl=new AbortController;setRuleId(null);return(async()=>{if(null!=rule){try{setIsLoading(!0);const createRuleResponse=await Object(api.b)({rule:Object(transforms.b)(rule),signal:abortCtrl.signal});isSubscribed&&setRuleId(createRuleResponse.id)}catch(error){isSubscribed&&addError(error,{title:translations.g})}isSubscribed&&setIsLoading(!1)}})(),()=>{isSubscribed=!1,abortCtrl.abort()}},[rule,addError]),[{isLoading:isLoading,ruleId:ruleId},setRule]})(),ruleType=null===(_stepsData$current$Ru=stepsData.current[rules_types.a.defineRule].data)||void 0===_stepsData$current$Ru?void 0:_stepsData$current$Ru.ruleType,ruleName=null===(_stepsData$current$Ru2=stepsData.current[rules_types.a.aboutRule].data)||void 0===_stepsData$current$Ru2?void 0:_stepsData$current$Ru2.name,actionMessageParams=Object(external_kbnSharedDeps_React_.useMemo)(()=>getActionMessageParams(ruleType),[ruleType]),history=Object(external_kbnSharedDeps_ReactRouterDom_.useHistory)(),handleAccordionToggle=Object(external_kbnSharedDeps_React_.useCallback)((step,isOpen)=>setOpenSteps(_openSteps=>({..._openSteps,[step]:isOpen})),[]),goToStep=Object(external_kbnSharedDeps_React_.useCallback)(step=>{rules_utils.b.indexOf(step)>rules_utils.b.indexOf(activeStep)&&!openSteps[step]&&toggleStepAccordion(step),setActiveStep(step)},[activeStep,openSteps]),toggleStepAccordion=step=>{var _defineRuleRef$curren;if(step===rules_types.a.defineRule)null===(_defineRuleRef$curren=defineRuleRef.current)||void 0===_defineRuleRef$curren||_defineRuleRef$curren.onToggle();else if(step===rules_types.a.aboutRule){var _aboutRuleRef$current;null===(_aboutRuleRef$current=aboutRuleRef.current)||void 0===_aboutRuleRef$current||_aboutRuleRef$current.onToggle()}else if(step===rules_types.a.scheduleRule){var _scheduleRuleRef$curr;null===(_scheduleRuleRef$curr=scheduleRuleRef.current)||void 0===_scheduleRuleRef$curr||_scheduleRuleRef$curr.onToggle()}else if(step===rules_types.a.ruleActions){var _ruleActionsRef$curre;null===(_ruleActionsRef$curre=ruleActionsRef.current)||void 0===_ruleActionsRef$curre||_ruleActionsRef$curre.onToggle()}},editStep=Object(external_kbnSharedDeps_React_.useCallback)(async step=>{const activeStepData=await formHooks.current[activeStep]();null!=activeStepData&&activeStepData.isValid&&(setStepData(activeStep,activeStepData),goToStep(step))},[activeStep,goToStep]),submitStep=Object(external_kbnSharedDeps_React_.useCallback)(async step=>{const stepData=await formHooks.current[step]();if(null!=stepData&&stepData.isValid){setStepData(step,stepData);const nextStep=(step=>rules_utils.b[rules_utils.b.indexOf(step)+1])(step);if(null!=nextStep)goToStep(nextStep);else{const defineStep=stepsData.current[rules_types.a.defineRule],aboutStep=stepsData.current[rules_types.a.aboutRule],scheduleStep=stepsData.current[rules_types.a.scheduleRule],actionsStep=stepsData.current[rules_types.a.ruleActions];stepIsValid(defineStep)&&stepIsValid(aboutStep)&&stepIsValid(scheduleStep)&&stepIsValid(actionsStep)&&setRule(formatRule(defineStep.data,aboutStep.data,scheduleStep.data,actionsStep.data))}}},[goToStep,setRule]),getAccordionType=Object(external_kbnSharedDeps_React_.useCallback)(step=>step===activeStep?"active":stepsData.current[step].isValid?"valid":"passive",[activeStep]),defineRuleButton=external_kbnSharedDeps_React_default.a.createElement(AccordionTitle,{name:"1",title:rules_translations.H,type:getAccordionType(rules_types.a.defineRule)}),aboutRuleButton=external_kbnSharedDeps_React_default.a.createElement(AccordionTitle,{name:"2",title:rules_translations.b,type:getAccordionType(rules_types.a.aboutRule)}),scheduleRuleButton=external_kbnSharedDeps_React_default.a.createElement(AccordionTitle,{name:"3",title:rules_translations.rb,type:getAccordionType(rules_types.a.scheduleRule)}),ruleActionsButton=external_kbnSharedDeps_React_default.a.createElement(AccordionTitle,{name:"4",title:rules_translations.pb,type:getAccordionType(rules_types.a.ruleActions)});return ruleName&&ruleId?(Object(toasters.e)((ruleName=>external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.rules.create.successfullyCreatedRuleTitle",{values:{ruleName:ruleName},defaultMessage:"{ruleName} was created"}))(ruleName),dispatchToaster),history.replace(Object(redirect_to_detection_engine.e)(ruleId)),null):redirectToDetections(isSignalIndexExists,isAuthenticated,hasEncryptionKey,needsListsConfiguration)?(history.replace(Object(redirect_to_detection_engine.c)()),null):helpers_userHasNoPermissions(canUserCRUD)?(history.replace(Object(redirect_to_detection_engine.f)()),null):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(wrapper_page.a,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"row",justifyContent:"spaceAround"},external_kbnSharedDeps_React_default.a.createElement(MaxWidthEuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(DetectionEngineHeaderPage,{backOptions:{href:Object(redirect_to_detection_engine.f)(),text:BACK_TO_RULES,pageId:app_types.a.detections},border:!0,isLoading:isLoading||loading,title:PAGE_TITLE}),external_kbnSharedDeps_React_default.a.createElement(MyEuiPanel,{zindex:4},external_kbnSharedDeps_React_default.a.createElement(StepDefineRuleAccordion,{initialIsOpen:!0,id:rules_types.a.defineRule,buttonContent:defineRuleButton,paddingSize:"xs",ref:defineRuleRef,onToggle:handleAccordionToggle.bind(null,rules_types.a.defineRule),extraAction:stepsData.current[rules_types.a.defineRule].isValid&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{"data-test-subj":"edit-define-rule",iconType:"pencil",size:"xs",onClick:()=>editStep(rules_types.a.defineRule)},EDIT_RULE)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHorizontalRule,{margin:"m"}),external_kbnSharedDeps_React_default.a.createElement(StepDefineRule,{addPadding:!0,defaultValues:stepsData.current[rules_types.a.defineRule].data,isReadOnlyView:activeStep!==rules_types.a.defineRule,isLoading:isLoading||loading,setForm:setFormHook,onSubmit:()=>submitStep(rules_types.a.defineRule),descriptionColumns:"singleSplit"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(MyEuiPanel,{zindex:3},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiAccordion,{initialIsOpen:!1,id:rules_types.a.aboutRule,buttonContent:aboutRuleButton,paddingSize:"xs",ref:aboutRuleRef,onToggle:handleAccordionToggle.bind(null,rules_types.a.aboutRule),extraAction:stepsData.current[rules_types.a.aboutRule].isValid&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{"data-test-subj":"edit-about-rule",iconType:"pencil",size:"xs",onClick:()=>editStep(rules_types.a.aboutRule)},EDIT_RULE)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHorizontalRule,{margin:"m"}),external_kbnSharedDeps_React_default.a.createElement(StepAboutRule,{addPadding:!0,defaultValues:stepsData.current[rules_types.a.aboutRule].data,defineRuleData:stepsData.current[rules_types.a.defineRule].data,descriptionColumns:"singleSplit",isReadOnlyView:activeStep!==rules_types.a.aboutRule,isLoading:isLoading||loading,setForm:setFormHook,onSubmit:()=>submitStep(rules_types.a.aboutRule)}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(MyEuiPanel,{zindex:2},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiAccordion,{initialIsOpen:!1,id:rules_types.a.scheduleRule,buttonContent:scheduleRuleButton,paddingSize:"xs",ref:scheduleRuleRef,onToggle:handleAccordionToggle.bind(null,rules_types.a.scheduleRule),extraAction:stepsData.current[rules_types.a.scheduleRule].isValid&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{iconType:"pencil",size:"xs",onClick:()=>editStep(rules_types.a.scheduleRule)},EDIT_RULE)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHorizontalRule,{margin:"m"}),external_kbnSharedDeps_React_default.a.createElement(StepScheduleRule,{addPadding:!0,defaultValues:stepsData.current[rules_types.a.scheduleRule].data,descriptionColumns:"singleSplit",isReadOnlyView:activeStep!==rules_types.a.scheduleRule,isLoading:isLoading||loading,setForm:setFormHook,onSubmit:()=>submitStep(rules_types.a.scheduleRule)}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(MyEuiPanel,{zindex:1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiAccordion,{initialIsOpen:!1,id:rules_types.a.ruleActions,buttonContent:ruleActionsButton,paddingSize:"xs",ref:ruleActionsRef,onToggle:handleAccordionToggle.bind(null,rules_types.a.ruleActions),extraAction:stepsData.current[rules_types.a.ruleActions].isValid&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{iconType:"pencil",size:"xs",onClick:()=>editStep(rules_types.a.ruleActions)},EDIT_RULE)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHorizontalRule,{margin:"m"}),external_kbnSharedDeps_React_default.a.createElement(StepRuleActions,{addPadding:!0,defaultValues:stepsData.current[rules_types.a.ruleActions].data,isReadOnlyView:activeStep!==rules_types.a.ruleActions,isLoading:isLoading||loading,setForm:setFormHook,onSubmit:()=>submitStep(rules_types.a.ruleActions),actionMessageParams:actionMessageParams})))))),external_kbnSharedDeps_React_default.a.createElement(spy_routes.a,{pageName:app_types.a.detections}))},CreateRulePage=external_kbnSharedDeps_React_default.a.memo(CreateRulePageComponent);var react_redux_lib=__webpack_require__(110),use_selector=__webpack_require__(114),accessibility_helpers=__webpack_require__(141),filters_global=__webpack_require__(255),search_bar=__webpack_require__(256),inputs=__webpack_require__(155),inputs_actions=__webpack_require__(156),use_query=__webpack_require__(367);const useAlertInfo=({ruleId:ruleId=null})=>{const[lastAlerts,setLastAlerts]=Object(external_kbnSharedDeps_React_.useState)(external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingSpinner,{size:"m"})),[totalAlerts,setTotalAlerts]=Object(external_kbnSharedDeps_React_.useState)(external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingSpinner,{size:"m"})),{loading:loading,data:alerts}=Object(use_query.a)((ruleId=>{const queryFilter=[{bool:{should:[{match:{"signal.status":"open"}}],minimum_should_match:1}}];return{aggs:{lastSeen:{max:{field:"@timestamp"}}},query:{bool:{filter:null!=ruleId?[...queryFilter,{bool:{should:[{match:{"signal.rule.id":ruleId}}],minimum_should_match:1}}]:queryFilter}},size:1,track_total_hits:!0}})(ruleId));return Object(external_kbnSharedDeps_React_.useEffect)(()=>{if(null!=alerts){var _myAlerts$aggregation,_myAlerts$aggregation2,_myAlerts$aggregation3;const myAlerts=alerts;setLastAlerts(null!=(null===(_myAlerts$aggregation=myAlerts.aggregations)||void 0===_myAlerts$aggregation?void 0:_myAlerts$aggregation.lastSeen.value)?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedRelative,{value:new Date(null!==(_myAlerts$aggregation2=null===(_myAlerts$aggregation3=myAlerts.aggregations)||void 0===_myAlerts$aggregation3?void 0:_myAlerts$aggregation3.lastSeen.value_as_string)&&void 0!==_myAlerts$aggregation2?_myAlerts$aggregation2:"")}):null),setTotalAlerts(external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,myAlerts.hits.total.value))}else setLastAlerts(null),setTotalAlerts(null)},[loading,alerts]),[lastAlerts,totalAlerts]};var events_viewer=__webpack_require__(503),store=__webpack_require__(129),store_timeline=__webpack_require__(113),defaults=__webpack_require__(125),manage_timeline=__webpack_require__(157),alerts_table_actions=__webpack_require__(364),default_config=__webpack_require__(207),alerts_filter_group=__webpack_require__(462),external_kbnSharedDeps_ElasticNumeral_=__webpack_require__(85),external_kbnSharedDeps_ElasticNumeral_default=__webpack_require__.n(external_kbnSharedDeps_ElasticNumeral_),link_icon=__webpack_require__(469),utility_bar=__webpack_require__(322);const ADDITIONAL_FILTERS_ACTIONS=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.additionalFiltersTitle",{defaultMessage:"Additional filters"}),ADDITIONAL_FILTERS_ACTIONS_SHOW_BUILDING_BLOCK=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.additionalFiltersActions.showBuildingBlockTitle",{defaultMessage:"Include building block alerts"}),ADDITIONAL_FILTERS_ACTIONS_SHOW_ONLY_THREAT_INDICATOR_ALERTS=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.additionalFiltersActions.showOnlyThreatIndicatorAlerts",{defaultMessage:"Show only threat indicator alerts"}),CLEAR_SELECTION=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.clearSelectionTitle",{defaultMessage:"Clear selection"}),TAKE_ACTION=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.takeActionTitle",{defaultMessage:"Take action"}),BATCH_ACTION_OPEN_SELECTED=(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.batchActionsTitle",{defaultMessage:"Batch actions"}),external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.batchActions.viewSelectedInHostsTitle",{defaultMessage:"View selected in hosts"}),external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.batchActions.viewSelectedInNetworkTitle",{defaultMessage:"View selected in network"}),external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.batchActions.viewSelectedInTimelineTitle",{defaultMessage:"View selected in timeline"}),external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.batchActions.openSelectedTitle",{defaultMessage:"Open selected"})),BATCH_ACTION_CLOSE_SELECTED=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.batchActions.closeSelectedTitle",{defaultMessage:"Close selected"}),BATCH_ACTION_IN_PROGRESS_SELECTED=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.batchActions.inProgressSelectedTitle",{defaultMessage:"Mark in progress"}),UtilityBarFlexGroup=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup).withConfig({displayName:"UtilityBarFlexGroup",componentId:"jqzk8o-0"})(["min-width:175px;"]),BuildingBlockContainer=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexItem).withConfig({displayName:"BuildingBlockContainer",componentId:"jqzk8o-1"})(["background:repeating-linear-gradient( 127deg,rgba(245,167,0,0.2),rgba(245,167,0,0.2) 1px,rgba(245,167,0,0.05) 2px,rgba(245,167,0,0.05) 10px );"]),AlertsUtilityBarComponent=({areEventsLoading:areEventsLoading,clearSelection:clearSelection,currentFilter:currentFilter,hasIndexMaintenance:hasIndexMaintenance,hasIndexWrite:hasIndexWrite,onShowBuildingBlockAlertsChanged:onShowBuildingBlockAlertsChanged,onShowOnlyThreatIndicatorAlertsChanged:onShowOnlyThreatIndicatorAlertsChanged,selectAll:selectAll,selectedEventIds:selectedEventIds,showBuildingBlockAlerts:showBuildingBlockAlerts,showClearSelection:showClearSelection,showOnlyThreatIndicatorAlerts:showOnlyThreatIndicatorAlerts,totalCount:totalCount,updateAlertsStatus:updateAlertsStatus})=>{const[defaultNumberFormat]=Object(lib_kibana.l)(constants.B),handleUpdateStatus=Object(external_kbnSharedDeps_React_.useCallback)(async selectedStatus=>{await updateAlertsStatus({alertIds:Object.keys(selectedEventIds),status:currentFilter,selectedStatus:selectedStatus})},[currentFilter,selectedEventIds,updateAlertsStatus]),formattedTotalCount=external_kbnSharedDeps_ElasticNumeral_default()(totalCount).format(defaultNumberFormat),formattedSelectedEventsCount=external_kbnSharedDeps_ElasticNumeral_default()(Object.keys(selectedEventIds).length).format(defaultNumberFormat),handleSelectAllAlertsClick=Object(external_kbnSharedDeps_React_.useCallback)(()=>{showClearSelection?clearSelection():selectAll()},[clearSelection,selectAll,showClearSelection]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(utility_bar.a,null,external_kbnSharedDeps_React_default.a.createElement(utility_bar.d,{grow:!0},external_kbnSharedDeps_React_default.a.createElement(utility_bar.c,null,external_kbnSharedDeps_React_default.a.createElement(utility_bar.f,{dataTestSubj:"showingAlerts"},(totalAlertsFormatted=formattedTotalCount,totalAlerts=totalCount,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.showingAlertsTitle",{values:{totalAlertsFormatted:totalAlertsFormatted,totalAlerts:totalAlerts},defaultMessage:"Showing {totalAlertsFormatted} {totalAlerts, plural, =1 {alert} other {alerts}}"})))),external_kbnSharedDeps_React_default.a.createElement(utility_bar.c,{grow:!0},hasIndexWrite&&hasIndexMaintenance&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(utility_bar.f,{dataTestSubj:"selectedAlerts"},(selectedAlertsFormatted=showClearSelection?formattedTotalCount:formattedSelectedEventsCount,selectedAlerts=showClearSelection?totalCount:Object.keys(selectedEventIds).length,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.selectedAlertsTitle",{values:{selectedAlertsFormatted:selectedAlertsFormatted,selectedAlerts:selectedAlerts},defaultMessage:"Selected {selectedAlertsFormatted} {selectedAlerts, plural, =1 {alert} other {alerts}}"}))),external_kbnSharedDeps_React_default.a.createElement(utility_bar.b,{dataTestSubj:"alertActionPopover",disabled:areEventsLoading||Object(external_kbnSharedDeps_LodashFp_.isEmpty)(selectedEventIds)&&!1===showClearSelection,iconType:"arrowDown",iconSide:"right",ownFocus:!1,popoverContent:closePopover=>external_kbnSharedDeps_React_default.a.createElement(UtilityBarFlexGroup,{direction:"column"},currentFilter!==alerts_filter_group.d&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(link_icon.a,{"aria-label":"openSelectedAlerts",onClick:()=>{closePopover(),handleUpdateStatus("open")},color:"text","data-test-subj":"openSelectedAlertsButton"},BATCH_ACTION_OPEN_SELECTED)),currentFilter!==alerts_filter_group.b&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(link_icon.a,{"aria-label":"closeSelectedAlerts",onClick:()=>{closePopover(),handleUpdateStatus("closed")},color:"text","data-test-subj":"closeSelectedAlertsButton"},BATCH_ACTION_CLOSE_SELECTED)),currentFilter!==alerts_filter_group.c&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(link_icon.a,{"aria-label":"markSelectedAlertsInProgress",onClick:()=>{closePopover(),handleUpdateStatus("in-progress")},color:"text","data-test-subj":"markSelectedAlertsInProgressButton"},BATCH_ACTION_IN_PROGRESS_SELECTED)))},TAKE_ACTION),external_kbnSharedDeps_React_default.a.createElement(utility_bar.b,{"aria-label":"selectAllAlerts",dataTestSubj:"selectAllAlertsButton",iconType:showClearSelection?"cross":"pagesSelect",onClick:handleSelectAllAlertsClick},showClearSelection?CLEAR_SELECTION:((totalAlertsFormatted,totalAlerts)=>external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.selectAllAlertsTitle",{values:{totalAlertsFormatted:totalAlertsFormatted,totalAlerts:totalAlerts},defaultMessage:"Select all {totalAlertsFormatted} {totalAlerts, plural, =1 {alert} other {alerts}}"}))(formattedTotalCount,totalCount))),external_kbnSharedDeps_React_default.a.createElement(utility_bar.e,null),external_kbnSharedDeps_React_default.a.createElement(utility_bar.b,{dataTestSubj:"additionalFilters",disabled:areEventsLoading,iconType:"arrowDown",iconSide:"right",ownFocus:!0,popoverContent:closePopover=>external_kbnSharedDeps_React_default.a.createElement(UtilityBarFlexGroup,{direction:"column",gutterSize:"m"},external_kbnSharedDeps_React_default.a.createElement(BuildingBlockContainer,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCheckbox,{id:"showBuildingBlockAlertsCheckbox","aria-label":"showBuildingBlockAlerts",onChange:e=>{closePopover(),onShowBuildingBlockAlertsChanged(e.target.checked)},checked:showBuildingBlockAlerts,color:"text","data-test-subj":"showBuildingBlockAlertsCheckbox",label:ADDITIONAL_FILTERS_ACTIONS_SHOW_BUILDING_BLOCK})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCheckbox,{id:"showOnlyThreatIndicatorAlertsCheckbox","aria-label":"showOnlyThreatIndicatorAlerts",onChange:e=>{closePopover(),onShowOnlyThreatIndicatorAlertsChanged(e.target.checked)},checked:showOnlyThreatIndicatorAlerts,color:"text","data-test-subj":"showOnlyThreatIndicatorAlertsCheckbox",label:ADDITIONAL_FILTERS_ACTIONS_SHOW_ONLY_THREAT_INDICATOR_ALERTS})))},ADDITIONAL_FILTERS_ACTIONS)))));var selectedAlertsFormatted,selectedAlerts,totalAlertsFormatted,totalAlerts},AlertsUtilityBar=external_kbnSharedDeps_React_default.a.memo(AlertsUtilityBarComponent,(prevProps,nextProps)=>prevProps.areEventsLoading===nextProps.areEventsLoading&&prevProps.selectedEventIds===nextProps.selectedEventIds&&prevProps.totalCount===nextProps.totalCount&&prevProps.showClearSelection===nextProps.showClearSelection&&prevProps.showBuildingBlockAlerts===nextProps.showBuildingBlockAlerts&&prevProps.onShowOnlyThreatIndicatorAlertsChanged===nextProps.onShowOnlyThreatIndicatorAlertsChanged);var common_translations=__webpack_require__(365),alerts_table_translations=__webpack_require__(264),model=__webpack_require__(124),sourcerer=__webpack_require__(130),alerts_table_helpers=__webpack_require__(663),default_cell_renderer=__webpack_require__(398),renderers=__webpack_require__(323);const AlertsTableComponent=({clearEventsDeleted:clearEventsDeleted,clearEventsLoading:clearEventsLoading,clearSelected:clearSelected,defaultFilters:defaultFilters,from:from,globalFilters:globalFilters,globalQuery:globalQuery,hasIndexMaintenance:hasIndexMaintenance,hasIndexWrite:hasIndexWrite,isSelectAllChecked:isSelectAllChecked,loading:loading,loadingEventIds:loadingEventIds,onRuleChange:onRuleChange,onShowBuildingBlockAlertsChanged:onShowBuildingBlockAlertsChanged,onShowOnlyThreatIndicatorAlertsChanged:onShowOnlyThreatIndicatorAlertsChanged,selectedEventIds:selectedEventIds,setEventsDeleted:setEventsDeleted,setEventsLoading:setEventsLoading,showBuildingBlockAlerts:showBuildingBlockAlerts,showOnlyThreatIndicatorAlerts:showOnlyThreatIndicatorAlerts,timelineId:timelineId,to:to})=>{const[showClearSelectionAction,setShowClearSelectionAction]=Object(external_kbnSharedDeps_React_.useState)(!1),[filterGroup,setFilterGroup]=Object(external_kbnSharedDeps_React_.useState)(alerts_filter_group.d),{browserFields:browserFields,indexPattern:indexPatterns,loading:indexPatternsLoading,selectedPatterns:selectedPatterns}=Object(sourcerer.b)(model.SourcererScopeName.detections),kibana=Object(lib_kibana.h)(),[,dispatchToaster]=Object(toasters.h)(),{addWarning:addWarning}=Object(use_app_toasts.a)(),{initializeTimeline:initializeTimeline,setSelectAll:setSelectAll}=Object(manage_timeline.b)(),getGlobalQuery=Object(external_kbnSharedDeps_React_.useCallback)(customFilters=>null!=browserFields&&null!=indexPatterns?Object(timeline_helpers.k)({config:public_.esQuery.getEsQueryConfig(kibana.services.uiSettings),dataProviders:[],indexPattern:indexPatterns,browserFields:browserFields,filters:[...null!=defaultFilters?defaultFilters:[],...globalFilters,...customFilters,...Object(alerts_table_helpers.a)(from,to)],kqlQuery:globalQuery,kqlMode:globalQuery.language,isEventViewer:!0}):null,[browserFields,defaultFilters,globalFilters,globalQuery,indexPatterns,kibana,to,from]),setEventsLoadingCallback=Object(external_kbnSharedDeps_React_.useCallback)(({eventIds:eventIds,isLoading:isLoading})=>{setEventsLoading({id:timelineId,eventIds:eventIds,isLoading:isLoading})},[setEventsLoading,timelineId]),setEventsDeletedCallback=Object(external_kbnSharedDeps_React_.useCallback)(({eventIds:eventIds,isDeleted:isDeleted})=>{setEventsDeleted({id:timelineId,eventIds:eventIds,isDeleted:isDeleted})},[setEventsDeleted,timelineId]),onAlertStatusUpdateSuccess=Object(external_kbnSharedDeps_React_.useCallback)((updated,conflicts,status)=>{if(conflicts>0)addWarning({title:common_translations.i(conflicts),text:common_translations.j(updated,conflicts)});else{let title;switch(status){case"closed":title=alerts_table_translations.s(updated);break;case"open":title=alerts_table_translations.z(updated);break;case"in-progress":title=alerts_table_translations.v(updated)}Object(toasters.e)(title,dispatchToaster)}},[addWarning,dispatchToaster]),onAlertStatusUpdateFailure=Object(external_kbnSharedDeps_React_.useCallback)((status,error)=>{let title;switch(status){case"closed":title=alerts_table_translations.r;break;case"open":title=alerts_table_translations.y;break;case"in-progress":title=alerts_table_translations.u}Object(toasters.d)(title,[error.message],dispatchToaster)},[dispatchToaster]);Object(external_kbnSharedDeps_React_.useEffect)(()=>{isSelectAllChecked?setSelectAll({id:timelineId,selectAll:!1}):setShowClearSelectionAction(!1)},[isSelectAllChecked,setSelectAll,timelineId]);const onFilterGroupChangedCallback=Object(external_kbnSharedDeps_React_.useCallback)(newFilterGroup=>{clearEventsLoading({id:timelineId}),clearEventsDeleted({id:timelineId}),clearSelected({id:timelineId}),setFilterGroup(newFilterGroup)},[clearEventsLoading,clearEventsDeleted,clearSelected,setFilterGroup,timelineId]),clearSelectionCallback=Object(external_kbnSharedDeps_React_.useCallback)(()=>{clearSelected({id:timelineId}),setSelectAll({id:timelineId,selectAll:!1}),setShowClearSelectionAction(!1)},[clearSelected,setSelectAll,setShowClearSelectionAction,timelineId]),selectAllOnAllPagesCallback=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setSelectAll({id:timelineId,selectAll:!0}),setShowClearSelectionAction(!0)},[setSelectAll,setShowClearSelectionAction,timelineId]),updateAlertsStatusCallback=Object(external_kbnSharedDeps_React_.useCallback)(async(refetchQuery,{status:status,selectedStatus:selectedStatus})=>{var _getGlobalQuery;const currentStatusFilter=Object(default_config.c)(status);await Object(alerts_table_actions.c)({query:showClearSelectionAction?null===(_getGlobalQuery=getGlobalQuery(currentStatusFilter))||void 0===_getGlobalQuery?void 0:_getGlobalQuery.filterQuery:void 0,alertIds:Object.keys(selectedEventIds),selectedStatus:selectedStatus,setEventsDeleted:setEventsDeletedCallback,setEventsLoading:setEventsLoadingCallback,onAlertStatusUpdateSuccess:onAlertStatusUpdateSuccess,onAlertStatusUpdateFailure:onAlertStatusUpdateFailure}),refetchQuery()},[getGlobalQuery,selectedEventIds,setEventsDeletedCallback,setEventsLoadingCallback,showClearSelectionAction,onAlertStatusUpdateSuccess,onAlertStatusUpdateFailure]),utilityBarCallback=Object(external_kbnSharedDeps_React_.useCallback)((refetchQuery,totalCount)=>external_kbnSharedDeps_React_default.a.createElement(AlertsUtilityBar,{areEventsLoading:loadingEventIds.length>0,clearSelection:clearSelectionCallback,currentFilter:filterGroup,hasIndexMaintenance:hasIndexMaintenance,hasIndexWrite:hasIndexWrite,onShowBuildingBlockAlertsChanged:onShowBuildingBlockAlertsChanged,onShowOnlyThreatIndicatorAlertsChanged:onShowOnlyThreatIndicatorAlertsChanged,selectAll:selectAllOnAllPagesCallback,selectedEventIds:selectedEventIds,showBuildingBlockAlerts:showBuildingBlockAlerts,showClearSelection:showClearSelectionAction,showOnlyThreatIndicatorAlerts:showOnlyThreatIndicatorAlerts,totalCount:totalCount,updateAlertsStatus:updateAlertsStatusCallback.bind(null,refetchQuery)}),[clearSelectionCallback,filterGroup,hasIndexMaintenance,hasIndexWrite,loadingEventIds.length,onShowBuildingBlockAlertsChanged,onShowOnlyThreatIndicatorAlertsChanged,selectAllOnAllPagesCallback,selectedEventIds,showBuildingBlockAlerts,showClearSelectionAction,showOnlyThreatIndicatorAlerts,updateAlertsStatusCallback]),defaultFiltersMemo=Object(external_kbnSharedDeps_React_.useMemo)(()=>Object(external_kbnSharedDeps_LodashFp_.isEmpty)(defaultFilters)?Object(default_config.c)(filterGroup):null==defaultFilters||Object(external_kbnSharedDeps_LodashFp_.isEmpty)(defaultFilters)?void 0:[...defaultFilters,...Object(default_config.c)(filterGroup)],[defaultFilters,filterGroup]),{filterManager:filterManager}=Object(lib_kibana.h)().services.data.query;Object(external_kbnSharedDeps_React_.useEffect)(()=>{initializeTimeline({defaultModel:default_config.a,documentType:alerts_table_translations.h,filterManager:filterManager,footerText:alerts_table_translations.B,id:timelineId,loadingText:alerts_table_translations.w,selectAll:!1,queryFields:default_config.g,title:""})},[]);const headerFilterGroup=Object(external_kbnSharedDeps_React_.useMemo)(()=>external_kbnSharedDeps_React_default.a.createElement(alerts_filter_group.a,{onFilterGroupChanged:onFilterGroupChangedCallback}),[onFilterGroupChangedCallback]);return loading||indexPatternsLoading||Object(external_kbnSharedDeps_LodashFp_.isEmpty)(selectedPatterns)?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPanel,null,external_kbnSharedDeps_React_default.a.createElement(header_section.a,{title:""}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingContent,{"data-test-subj":"loading-alerts-panel"})):external_kbnSharedDeps_React_default.a.createElement(events_viewer.a,{pageFilters:defaultFiltersMemo,defaultModel:default_config.a,end:to,headerFilterGroup:headerFilterGroup,id:timelineId,onRuleChange:onRuleChange,renderCellValue:default_cell_renderer.a,rowRenderers:renderers.b,scopeId:model.SourcererScopeName.detections,start:from,utilityBar:utilityBarCallback})},AlertsTable=Object(react_redux_lib.connect)(()=>{const getTimeline=store_timeline.b.getTimelineByIdSelector(),getGlobalInputs=store.inputsSelectors.globalSelector();return(state,ownProps)=>{var _getTimeline;const{timelineId:timelineId}=ownProps,timeline=null!==(_getTimeline=getTimeline(state,timelineId))&&void 0!==_getTimeline?_getTimeline:defaults.a,{deletedEventIds:deletedEventIds,isSelectAllChecked:isSelectAllChecked,loadingEventIds:loadingEventIds,selectedEventIds:selectedEventIds}=timeline,globalInputs=getGlobalInputs(state),{query:query,filters:filters}=globalInputs;return{globalQuery:query,globalFilters:filters,deletedEventIds:deletedEventIds,isSelectAllChecked:isSelectAllChecked,loadingEventIds:loadingEventIds,selectedEventIds:selectedEventIds}}},dispatch=>({clearSelected:({id:id})=>dispatch(store_timeline.a.clearSelected({id:id})),setEventsLoading:({id:id,eventIds:eventIds,isLoading:isLoading})=>dispatch(store_timeline.a.setEventsLoading({id:id,eventIds:eventIds,isLoading:isLoading})),clearEventsLoading:({id:id})=>dispatch(store_timeline.a.clearEventsLoading({id:id})),setEventsDeleted:({id:id,eventIds:eventIds,isDeleted:isDeleted})=>dispatch(store_timeline.a.setEventsDeleted({id:id,eventIds:eventIds,isDeleted:isDeleted})),clearEventsDeleted:({id:id})=>dispatch(store_timeline.a.clearEventsDeleted({id:id}))}))(external_kbnSharedDeps_React_default.a.memo(AlertsTableComponent)),NO_API_INTEGRATION_KEY_CALLOUT_TITLE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.noApiIntegrationKeyCallOutTitle",{defaultMessage:"API integration key required"}),NO_API_INTEGRATION_KEY_CALLOUT_MSG=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.noApiIntegrationKeyCallOutMsg",{defaultMessage:"A new encryption key is generated for saved objects each time you start Kibana. Without a persistent key, you cannot delete or modify rules after Kibana restarts. To set a persistent key, add the xpack.encryptedSavedObjects.encryptionKey setting with any text value of 32 or more characters to the kibana.yml file."}),DISMISS_CALLOUT=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.dismissNoApiIntegrationKeyButton",{defaultMessage:"Dismiss"}),NoApiIntegrationKeyCallOutComponent=()=>{const[showCallOut,setShowCallOut]=Object(external_kbnSharedDeps_React_.useState)(!0),handleCallOut=Object(external_kbnSharedDeps_React_.useCallback)(()=>setShowCallOut(!1),[setShowCallOut]);return showCallOut?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:NO_API_INTEGRATION_KEY_CALLOUT_TITLE,color:"danger",iconType:"alert"},external_kbnSharedDeps_React_default.a.createElement("p",null,NO_API_INTEGRATION_KEY_CALLOUT_MSG),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{color:"danger",onClick:handleCallOut},DISMISS_CALLOUT)):null},NoApiIntegrationKeyCallOut=Object(external_kbnSharedDeps_React_.memo)(NoApiIntegrationKeyCallOutComponent);var callouts=__webpack_require__(387);const ExternalLink=({url:url,children:children,ariaLabel:ariaLabel})=>children?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{content:url,position:"top","data-test-subj":"externalLinkTooltip"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{href:url,"aria-label":ariaLabel,external:!0,target:"_blank",rel:"noopener","data-test-subj":"externalLink"},children)):null,COMMON_ARIA_LABEL_ENDING=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.documentationLinks.ariaLabelEnding",{defaultMessage:"click to open documentation in a new tab"}),SOLUTION_REQUIREMENTS_LINK_TEXT=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.documentationLinks.solutionRequirements.text",{defaultMessage:"Elastic Security system requirements"}),DETECTIONS_REQUIREMENTS_LINK_TEXT=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.documentationLinks.detectionsRequirements.text",{defaultMessage:"Detections prerequisites and requirements"}),ML_JOB_COMPATIBILITY_LINK_TEXT=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.documentationLinks.mlJobCompatibility.text",{defaultMessage:"ML job compatibility"}),DocLink=({guidePath:guidePath="security",docPath:docPath,linkText:linkText})=>{const{services:services}=Object(lib_kibana.h)(),{ELASTIC_WEBSITE_URL:ELASTIC_WEBSITE_URL,DOC_LINK_VERSION:DOC_LINK_VERSION}=services.docLinks,url=`${ELASTIC_WEBSITE_URL}guide/en/${guidePath}/${DOC_LINK_VERSION}/${docPath}`,ariaLabel=`${linkText} - ${COMMON_ARIA_LABEL_ENDING}`;return external_kbnSharedDeps_React_default.a.createElement(ExternalLink,{url:url,ariaLabel:ariaLabel},linkText)},DocLinkWrapper=Object(external_kbnSharedDeps_React_.memo)(DocLink),SecuritySolutionRequirementsLink=()=>external_kbnSharedDeps_React_default.a.createElement(DocLinkWrapper,{docPath:"sec-requirements.html",linkText:SOLUTION_REQUIREMENTS_LINK_TEXT}),DetectionsRequirementsLink=()=>external_kbnSharedDeps_React_default.a.createElement(DocLinkWrapper,{docPath:"detections-permissions-section.html",linkText:DETECTIONS_REQUIREMENTS_LINK_TEXT}),MlJobCompatibilityLink=()=>external_kbnSharedDeps_React_default.a.createElement(DocLinkWrapper,{docPath:"alerts-ui-monitor.html#ml-job-compatibility",linkText:ML_JOB_COMPATIBILITY_LINK_TEXT}),readOnlyAccessToAlertsMessage={type:"primary",id:"read-only-access-to-alerts",title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.readOnlyAlertsCallOut.messageTitle",{defaultMessage:"You cannot change alert states"}),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.readOnlyAlertsCallOut.messageBody.messageDetail",defaultMessage:"{essence} Related documentation: {docs}",values:{essence:external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.readOnlyAlertsCallOut.messageBody.essenceDescription",defaultMessage:"You only have permissions to view alerts. If you need to update alert states (open or close alerts), contact your Kibana administrator."})),docs:external_kbnSharedDeps_React_default.a.createElement("ul",null,external_kbnSharedDeps_React_default.a.createElement("li",null,external_kbnSharedDeps_React_default.a.createElement(DetectionsRequirementsLink,null)),external_kbnSharedDeps_React_default.a.createElement("li",null,external_kbnSharedDeps_React_default.a.createElement(SecuritySolutionRequirementsLink,null)))}})},ReadOnlyAlertsCallOutComponent=()=>{const[{hasIndexUpdateDelete:hasIndexUpdateDelete}]=Object(user_info.b)();return external_kbnSharedDeps_React_default.a.createElement(callouts.CallOutSwitcher,{namespace:"detections",condition:null!=hasIndexUpdateDelete&&!hasIndexUpdateDelete,message:readOnlyAccessToAlertsMessage})},ReadOnlyAlertsCallOut=Object(external_kbnSharedDeps_React_.memo)(ReadOnlyAlertsCallOutComponent);var alerts_histogram_panel=__webpack_require__(493),alerts_histogram_panel_config=__webpack_require__(376),overview_empty=__webpack_require__(214),empty_page=__webpack_require__(370),detection_engine_translations=__webpack_require__(251);const DetectionEngineNoIndexComponent=({needsListsIndex:needsListsIndex,needsSignalsIndex:needsSignalsIndex})=>{const docLinks=Object(lib_kibana.h)().services.docLinks,actions=Object(external_kbnSharedDeps_React_.useMemo)(()=>({detections:{icon:"documents",label:detection_engine_translations.d,url:`${docLinks.ELASTIC_WEBSITE_URL}guide/en/security/${docLinks.DOC_LINK_VERSION}/detections-permissions-section.html`,target:"_blank"}}),[docLinks]),message=((needsListsIndex,needsSignalsIndex)=>needsSignalsIndex&&needsListsIndex?detection_engine_translations.h(detection_engine_translations.j):needsSignalsIndex?detection_engine_translations.h(detection_engine_translations.k):needsListsIndex?detection_engine_translations.h(detection_engine_translations.i):detection_engine_translations.h(""))(needsListsIndex,needsSignalsIndex);return external_kbnSharedDeps_React_default.a.createElement(empty_page.a,{actions:actions,"data-test-subj":"no_index",message:message,title:detection_engine_translations.l})},DetectionEngineNoIndex=external_kbnSharedDeps_React_default.a.memo(DetectionEngineNoIndexComponent),DetectionEngineUserUnauthenticated=external_kbnSharedDeps_React_default.a.memo(()=>{const docLinks=Object(lib_kibana.h)().services.docLinks,actions=Object(external_kbnSharedDeps_React_.useMemo)(()=>({detectionUnauthenticated:{icon:"documents",label:detection_engine_translations.d,url:`${docLinks.ELASTIC_WEBSITE_URL}guide/en/security/${docLinks.DOC_LINK_VERSION}/detections-permissions-section.html`,target:"_blank"}}),[docLinks]);return external_kbnSharedDeps_React_default.a.createElement(empty_page.a,{actions:actions,message:detection_engine_translations.n,"data-test-subj":"no_index",title:detection_engine_translations.o})});DetectionEngineUserUnauthenticated.displayName="DetectionEngineUserUnauthenticated";var links=__webpack_require__(121),link_to=__webpack_require__(119),use_full_screen=__webpack_require__(146);const Display=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"Display",componentId:"sc-1njjyjq-0"})(["",";"],({show:show})=>show?"":"display: none;");Display.displayName="Display";const needAdminForUpdateRulesMessage={type:"primary",id:"need-admin-for-update-rules",title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.needAdminForUpdateCallOutBody.messageTitle",{defaultMessage:"Administration permissions required for alert migration"}),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.needAdminForUpdateCallOutBody.messageBody.messageDetail",defaultMessage:"{essence} Related documentation: {docs}",values:{essence:external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.needAdminForUpdateCallOutBody.messageBody.essenceDescription",defaultMessage:"You are currently missing the required permissions to auto migrate your alert data. Please have your administrator visit this page one time to auto migrate your alert data."})),docs:external_kbnSharedDeps_React_default.a.createElement("ul",null,external_kbnSharedDeps_React_default.a.createElement("li",null,external_kbnSharedDeps_React_default.a.createElement(DetectionsRequirementsLink,null)),external_kbnSharedDeps_React_default.a.createElement("li",null,external_kbnSharedDeps_React_default.a.createElement(SecuritySolutionRequirementsLink,null)))}})},NeedAdminForUpdateCallOutComponent=()=>{const[{signalIndexMappingOutdated:signalIndexMappingOutdated,hasIndexManage:hasIndexManage}]=Object(user_info.b)(),signalIndexMappingIsOutdated=null!=signalIndexMappingOutdated&&signalIndexMappingOutdated,userDoesntHaveIndexManage=null!=hasIndexManage&&!hasIndexManage;return external_kbnSharedDeps_React_default.a.createElement(callouts.CallOutPersistentSwitcher,{condition:signalIndexMappingIsOutdated&&userDoesntHaveIndexManage,message:needAdminForUpdateRulesMessage})},NeedAdminForUpdateRulesCallOut=Object(external_kbnSharedDeps_React_.memo)(NeedAdminForUpdateCallOutComponent),StyledFullHeightContainer=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"StyledFullHeightContainer",componentId:"sc-7rr6ls-0"})(["display:flex;flex-direction:column;flex:1 1 auto;"]),DetectionEnginePageComponent=()=>{const dispatch=Object(react_redux_lib.useDispatch)(),containerElement=Object(external_kbnSharedDeps_React_.useRef)(null),getTimeline=Object(external_kbnSharedDeps_React_.useMemo)(()=>store_timeline.b.getTimelineByIdSelector(),[]),graphEventId=Object(use_selector.b)(state=>{var _getTimeline;return(null!==(_getTimeline=getTimeline(state,types_timeline.g.detectionsPage))&&void 0!==_getTimeline?_getTimeline:defaults.a).graphEventId}),getGlobalFiltersQuerySelector=Object(external_kbnSharedDeps_React_.useMemo)(()=>inputs.d.globalFiltersQuerySelector(),[]),getGlobalQuerySelector=Object(external_kbnSharedDeps_React_.useMemo)(()=>inputs.d.globalQuerySelector(),[]),query=Object(use_selector.a)(getGlobalQuerySelector),filters=Object(use_selector.a)(getGlobalFiltersQuerySelector),{to:to,from:from,deleteQuery:deleteQuery,setQuery:setQuery}=Object(use_global_time.a)(),{globalFullScreen:globalFullScreen}=Object(use_full_screen.a)(),[{loading:userInfoLoading,isSignalIndexExists:isSignalIndexExists,isAuthenticated:isUserAuthenticated,hasEncryptionKey:hasEncryptionKey,signalIndexName:signalIndexName,hasIndexWrite:hasIndexWrite,hasIndexMaintenance:hasIndexMaintenance}]=Object(user_info.b)(),{loading:listsConfigLoading,needsConfiguration:needsListsConfiguration}=useListsConfig(),history=Object(external_kbnSharedDeps_ReactRouterDom_.useHistory)(),[lastAlerts]=useAlertInfo({}),{formatUrl:formatUrl}=Object(link_to.o)(app_types.a.detections),[showBuildingBlockAlerts,setShowBuildingBlockAlerts]=Object(external_kbnSharedDeps_React_.useState)(!1),[showOnlyThreatIndicatorAlerts,setShowOnlyThreatIndicatorAlerts]=Object(external_kbnSharedDeps_React_.useState)(!1),loading=userInfoLoading||listsConfigLoading,updateDateRangeCallback=Object(external_kbnSharedDeps_React_.useCallback)(({x:x})=>{if(!x)return;const[min,max]=x;dispatch(Object(inputs_actions.setAbsoluteRangeDatePicker)({id:"global",from:new Date(min).toISOString(),to:new Date(max).toISOString()}))},[dispatch]),goToRules=Object(external_kbnSharedDeps_React_.useCallback)(ev=>{ev.preventDefault(),history.push(Object(redirect_to_detection_engine.f)())},[history]),alertsHistogramDefaultFilters=Object(external_kbnSharedDeps_React_.useMemo)(()=>[...filters,...Object(default_config.e)(showBuildingBlockAlerts),...Object(default_config.f)(showOnlyThreatIndicatorAlerts)],[filters,showBuildingBlockAlerts,showOnlyThreatIndicatorAlerts]),alertsTableDefaultFilters=Object(external_kbnSharedDeps_React_.useMemo)(()=>[...Object(default_config.e)(showBuildingBlockAlerts),...Object(default_config.f)(showOnlyThreatIndicatorAlerts)],[showBuildingBlockAlerts,showOnlyThreatIndicatorAlerts]),onShowBuildingBlockAlertsChangedCallback=Object(external_kbnSharedDeps_React_.useCallback)(newShowBuildingBlockAlerts=>{setShowBuildingBlockAlerts(newShowBuildingBlockAlerts)},[setShowBuildingBlockAlerts]),onShowOnlyThreatIndicatorAlertsCallback=Object(external_kbnSharedDeps_React_.useCallback)(newShowOnlyThreatIndicatorAlerts=>{setShowOnlyThreatIndicatorAlerts(newShowOnlyThreatIndicatorAlerts)},[setShowOnlyThreatIndicatorAlerts]),{indicesExist:indicesExist,indexPattern:indexPattern}=Object(sourcerer.b)(model.SourcererScopeName.detections),onSkipFocusBeforeEventsTable=Object(external_kbnSharedDeps_React_.useCallback)(()=>{Object(timeline_helpers.m)(containerElement.current)},[containerElement]),onSkipFocusAfterEventsTable=Object(external_kbnSharedDeps_React_.useCallback)(()=>{Object(timeline_helpers.o)()},[]),onKeyDown=Object(external_kbnSharedDeps_React_.useCallback)(keyboardEvent=>{Object(accessibility_helpers.r)(keyboardEvent)&&Object(timeline_helpers.n)({containerElement:containerElement.current,keyboardEvent:keyboardEvent,onSkipFocusBeforeEventsTable:onSkipFocusBeforeEventsTable,onSkipFocusAfterEventsTable:onSkipFocusAfterEventsTable})},[containerElement,onSkipFocusBeforeEventsTable,onSkipFocusAfterEventsTable]);return null==isUserAuthenticated||isUserAuthenticated||loading?loading||!1!==isSignalIndexExists&&!needsListsConfiguration?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,null!=hasEncryptionKey&&!hasEncryptionKey&&external_kbnSharedDeps_React_default.a.createElement(NoApiIntegrationKeyCallOut,null),external_kbnSharedDeps_React_default.a.createElement(ReadOnlyAlertsCallOut,null),external_kbnSharedDeps_React_default.a.createElement(NeedAdminForUpdateRulesCallOut,null),indicesExist?external_kbnSharedDeps_React_default.a.createElement(StyledFullHeightContainer,{onKeyDown:onKeyDown,ref:containerElement},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiWindowEvent,{event:"resize",handler:external_kbnSharedDeps_LodashFp_.noop}),external_kbnSharedDeps_React_default.a.createElement(filters_global.a,{show:Object(timeline_helpers.q)({globalFullScreen:globalFullScreen,graphEventId:graphEventId})},external_kbnSharedDeps_React_default.a.createElement(search_bar.a,{id:"global",indexPattern:indexPattern})),external_kbnSharedDeps_React_default.a.createElement(wrapper_page.a,{noPadding:globalFullScreen},external_kbnSharedDeps_React_default.a.createElement(Display,{show:!globalFullScreen},external_kbnSharedDeps_React_default.a.createElement(DetectionEngineHeaderPage,{subtitle:null!=lastAlerts&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,detection_engine_translations.e,": ",lastAlerts),title:detection_engine_translations.m},external_kbnSharedDeps_React_default.a.createElement(links.g,{fill:!0,onClick:goToRules,href:formatUrl(Object(redirect_to_detection_engine.f)()),iconType:"gear","data-test-subj":"manage-alert-detection-rules"},detection_engine_translations.c)),external_kbnSharedDeps_React_default.a.createElement(alerts_histogram_panel.a,{deleteQuery:deleteQuery,filters:alertsHistogramDefaultFilters,from:from,query:query,setQuery:setQuery,showTotalAlertsCount:!0,signalIndexName:signalIndexName,stackByOptions:alerts_histogram_panel_config.a,to:to,updateDateRange:updateDateRangeCallback}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"})),external_kbnSharedDeps_React_default.a.createElement(AlertsTable,{timelineId:types_timeline.g.detectionsPage,loading:loading,hasIndexWrite:null!=hasIndexWrite&&hasIndexWrite,hasIndexMaintenance:null!=hasIndexMaintenance&&hasIndexMaintenance,from:from,defaultFilters:alertsTableDefaultFilters,showBuildingBlockAlerts:showBuildingBlockAlerts,onShowBuildingBlockAlertsChanged:onShowBuildingBlockAlertsChangedCallback,showOnlyThreatIndicatorAlerts:showOnlyThreatIndicatorAlerts,onShowOnlyThreatIndicatorAlertsChanged:onShowOnlyThreatIndicatorAlertsCallback,to:to}))):external_kbnSharedDeps_React_default.a.createElement(wrapper_page.a,null,external_kbnSharedDeps_React_default.a.createElement(DetectionEngineHeaderPage,{border:!0,title:detection_engine_translations.m}),external_kbnSharedDeps_React_default.a.createElement(overview_empty.a,null)),external_kbnSharedDeps_React_default.a.createElement(spy_routes.a,{pageName:app_types.a.detections})):external_kbnSharedDeps_React_default.a.createElement(wrapper_page.a,null,external_kbnSharedDeps_React_default.a.createElement(DetectionEngineHeaderPage,{border:!0,title:detection_engine_translations.m}),external_kbnSharedDeps_React_default.a.createElement(DetectionEngineNoIndex,{needsSignalsIndex:!1===isSignalIndexExists,needsListsIndex:needsListsConfiguration})):external_kbnSharedDeps_React_default.a.createElement(wrapper_page.a,null,external_kbnSharedDeps_React_default.a.createElement(DetectionEngineHeaderPage,{border:!0,title:detection_engine_translations.m}),external_kbnSharedDeps_React_default.a.createElement(DetectionEngineUserUnauthenticated,null))},DetectionEnginePage=external_kbnSharedDeps_React_default.a.memo(DetectionEnginePageComponent),MyPanel=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiPanel).withConfig({displayName:"MyPanel",componentId:"sc-177nzsv-0"})(["position:relative;"]);MyPanel.displayName="MyPanel";const StepPanelComponent=({children:children,loading:loading,title:title})=>external_kbnSharedDeps_React_default.a.createElement(MyPanel,null,loading&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiProgress,{size:"xs",color:"accent",position:"absolute"}),external_kbnSharedDeps_React_default.a.createElement(header_section.a,{title:title}),children),StepPanel=Object(external_kbnSharedDeps_React_.memo)(StepPanelComponent),translations_PAGE_TITLE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.editRule.pageTitle",{defaultMessage:"Edit rule settings"}),CANCEL=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.editRule.cancelTitle",{defaultMessage:"Cancel"}),SAVE_CHANGES=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.editRule.saveChangeTitle",{defaultMessage:"Save changes"}),SORRY_ERRORS=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.editRule.errorMsgDescription",{defaultMessage:"Sorry"}),BACK_TO=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.editRule.backToDescription",{defaultMessage:"Back to"}),edit_formHookNoop=async()=>{},EditRulePageComponent=()=>{var _rule$name2;const history=Object(external_kbnSharedDeps_ReactRouterDom_.useHistory)(),[,dispatchToaster]=Object(toasters.h)(),[{loading:userInfoLoading,isSignalIndexExists:isSignalIndexExists,isAuthenticated:isAuthenticated,hasEncryptionKey:hasEncryptionKey,canUserCRUD:canUserCRUD}]=Object(user_info.b)(),{loading:listsConfigLoading,needsConfiguration:needsListsConfiguration}=useListsConfig(),{detailName:ruleId}=Object(external_kbnSharedDeps_ReactRouterDom_.useParams)(),[ruleLoading,rule]=useRule(ruleId),loading=ruleLoading||userInfoLoading||listsConfigLoading,formHooks=Object(external_kbnSharedDeps_React_.useRef)({[rules_types.a.defineRule]:edit_formHookNoop,[rules_types.a.aboutRule]:edit_formHookNoop,[rules_types.a.scheduleRule]:edit_formHookNoop,[rules_types.a.ruleActions]:edit_formHookNoop}),stepsData=Object(external_kbnSharedDeps_React_.useRef)({[rules_types.a.defineRule]:{isValid:!1,data:void 0},[rules_types.a.aboutRule]:{isValid:!1,data:void 0},[rules_types.a.scheduleRule]:{isValid:!1,data:void 0},[rules_types.a.ruleActions]:{isValid:!1,data:void 0}}),defineStep=stepsData.current[rules_types.a.defineRule],aboutStep=stepsData.current[rules_types.a.aboutRule],scheduleStep=stepsData.current[rules_types.a.scheduleRule],actionsStep=stepsData.current[rules_types.a.ruleActions],[activeStep,setActiveStep]=Object(external_kbnSharedDeps_React_.useState)(rules_types.a.defineRule),invalidSteps=rules_utils.b.filter(step=>{const stepData=stepsData.current[step];return null!=stepData.data&&!stepIsValid(stepData)}),[{isLoading:isLoading,isSaved:isSaved},setRule]=(()=>{const[rule,setRule]=Object(external_kbnSharedDeps_React_.useState)(null),[isSaved,setIsSaved]=Object(external_kbnSharedDeps_React_.useState)(!1),[isLoading,setIsLoading]=Object(external_kbnSharedDeps_React_.useState)(!1),{addError:addError}=Object(use_app_toasts.a)();return Object(external_kbnSharedDeps_React_.useEffect)(()=>{let isSubscribed=!0;const abortCtrl=new AbortController;setIsSaved(!1);return(async()=>{if(null!=rule){try{setIsLoading(!0),await Object(api.p)({rule:Object(transforms.b)(rule),signal:abortCtrl.signal}),isSubscribed&&setIsSaved(!0)}catch(error){isSubscribed&&addError(error,{title:translations.g})}isSubscribed&&setIsLoading(!1)}})(),()=>{isSubscribed=!1,abortCtrl.abort()}},[rule,addError]),[{isLoading:isLoading,isSaved:isSaved},setRule]})(),actionMessageParams=Object(external_kbnSharedDeps_React_.useMemo)(()=>getActionMessageParams(null==rule?void 0:rule.type),[null==rule?void 0:rule.type]),setFormHook=Object(external_kbnSharedDeps_React_.useCallback)((step,hook)=>{formHooks.current[step]=hook,step===activeStep&&hook()},[activeStep]),setStepData=Object(external_kbnSharedDeps_React_.useCallback)((step,data,isValid)=>{stepsData.current[step]={...stepsData.current[step],data:data,isValid:isValid}},[]),tabs=Object(external_kbnSharedDeps_React_.useMemo)(()=>[{"data-test-subj":"edit-rule-define-tab",id:rules_types.a.defineRule,name:rules_translations.I,disabled:null==rule?void 0:rule.immutable,content:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),external_kbnSharedDeps_React_default.a.createElement(StepPanel,{loading:loading,title:rules_translations.I},null!=defineStep.data&&external_kbnSharedDeps_React_default.a.createElement(StepDefineRule,{isReadOnlyView:!1,isLoading:isLoading,isUpdateView:!0,defaultValues:defineStep.data,setForm:setFormHook}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null)))},{"data-test-subj":"edit-rule-about-tab",id:rules_types.a.aboutRule,name:rules_translations.a,disabled:null==rule?void 0:rule.immutable,content:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),external_kbnSharedDeps_React_default.a.createElement(StepPanel,{loading:loading,title:rules_translations.a},null!=aboutStep.data&&null!=defineStep.data&&external_kbnSharedDeps_React_default.a.createElement(StepAboutRule,{isReadOnlyView:!1,isLoading:isLoading,isUpdateView:!0,defaultValues:aboutStep.data,defineRuleData:defineStep.data,setForm:setFormHook}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null)))},{"data-test-subj":"edit-rule-schedule-tab",id:rules_types.a.scheduleRule,name:rules_translations.qb,disabled:null==rule?void 0:rule.immutable,content:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),external_kbnSharedDeps_React_default.a.createElement(StepPanel,{loading:loading,title:rules_translations.qb},null!=scheduleStep.data&&external_kbnSharedDeps_React_default.a.createElement(StepScheduleRule,{isReadOnlyView:!1,isLoading:isLoading,isUpdateView:!0,defaultValues:scheduleStep.data,setForm:setFormHook}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null)))},{"data-test-subj":"edit-rule-actions-tab",id:rules_types.a.ruleActions,name:rules_translations.c,content:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),external_kbnSharedDeps_React_default.a.createElement(StepPanel,{loading:loading,title:rules_translations.c},null!=actionsStep.data&&external_kbnSharedDeps_React_default.a.createElement(StepRuleActions,{isReadOnlyView:!1,isLoading:isLoading,isUpdateView:!0,defaultValues:actionsStep.data,setForm:setFormHook,actionMessageParams:actionMessageParams}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null)))}],[null==rule?void 0:rule.immutable,loading,defineStep.data,isLoading,setFormHook,aboutStep.data,scheduleStep.data,actionsStep.data,actionMessageParams]),onSubmit=Object(external_kbnSharedDeps_React_.useCallback)(async()=>{const activeStepData=await formHooks.current[activeStep]();null!=(null==activeStepData?void 0:activeStepData.data)&&setStepData(activeStep,activeStepData.data,activeStepData.isValid);const define=(input=activeStepData,Object(external_kbnSharedDeps_LodashFp_.has)("data.ruleType",input)?activeStepData:defineStep);var input;const about=(input=>Object(external_kbnSharedDeps_LodashFp_.has)("data.name",input))(activeStepData)?activeStepData:aboutStep,schedule=(input=>Object(external_kbnSharedDeps_LodashFp_.has)("data.interval",input))(activeStepData)?activeStepData:scheduleStep,actions=(input=>Object(external_kbnSharedDeps_LodashFp_.has)("data.actions",input))(activeStepData)?activeStepData:actionsStep;stepIsValid(define)&&stepIsValid(about)&&stepIsValid(schedule)&&stepIsValid(actions)&&setRule({...formatRule(define.data,about.data,schedule.data,actions.data,rule),...ruleId?{id:ruleId}:{},...null!=rule?{max_signals:rule.max_signals}:{}})},[aboutStep,actionsStep,activeStep,defineStep,rule,ruleId,scheduleStep,setRule,setStepData]);Object(external_kbnSharedDeps_React_.useEffect)(()=>{if(null!=rule){const{aboutRuleData:aboutRuleData,defineRuleData:defineRuleData,scheduleRuleData:scheduleRuleData,ruleActionsData:ruleActionsData}=getStepsData({rule:rule});setStepData(rules_types.a.defineRule,defineRuleData,!0),setStepData(rules_types.a.aboutRule,aboutRuleData,!0),setStepData(rules_types.a.scheduleRule,scheduleRuleData,!0),setStepData(rules_types.a.ruleActions,ruleActionsData,!0)}},[rule,setStepData]);const goToStep=Object(external_kbnSharedDeps_React_.useCallback)(async step=>{setActiveStep(step),await formHooks.current[step]()},[]),onTabClick=Object(external_kbnSharedDeps_React_.useCallback)(async tab=>{const targetStep=tab.id,activeStepData=await formHooks.current[activeStep]();null!=(null==activeStepData?void 0:activeStepData.data)&&(setStepData(activeStep,activeStepData.data,activeStepData.isValid),goToStep(targetStep))},[activeStep,goToStep,setStepData]),goToDetailsRule=Object(external_kbnSharedDeps_React_.useCallback)(ev=>{ev.preventDefault(),history.replace(Object(redirect_to_detection_engine.e)(null!=ruleId?ruleId:""))},[history,ruleId]);var _rule$name,ruleName;return Object(external_kbnSharedDeps_React_.useEffect)(()=>{null!=rule&&rule.immutable?setActiveStep(rules_types.a.ruleActions):setActiveStep(rules_types.a.defineRule)},[rule]),isSaved?(Object(toasters.e)((ruleName=null!==(_rule$name=null==rule?void 0:rule.name)&&void 0!==_rule$name?_rule$name:"",external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.rules.update.successfullySavedRuleTitle",{values:{ruleName:ruleName},defaultMessage:"{ruleName} was saved"})),dispatchToaster),history.replace(Object(redirect_to_detection_engine.e)(null!=ruleId?ruleId:"")),null):redirectToDetections(isSignalIndexExists,isAuthenticated,hasEncryptionKey,needsListsConfiguration)?(history.replace(Object(redirect_to_detection_engine.c)()),null):helpers_userHasNoPermissions(canUserCRUD)?(history.replace(Object(redirect_to_detection_engine.e)(null!=ruleId?ruleId:"")),null):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(wrapper_page.a,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"row",justifyContent:"spaceAround"},external_kbnSharedDeps_React_default.a.createElement(MaxWidthEuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(DetectionEngineHeaderPage,{backOptions:{href:Object(redirect_to_detection_engine.e)(null!=ruleId?ruleId:""),text:`${BACK_TO} ${null!==(_rule$name2=null==rule?void 0:rule.name)&&void 0!==_rule$name2?_rule$name2:""}`,pageId:app_types.a.detections,dataTestSubj:"ruleEditBackToRuleDetails"},isLoading:isLoading,title:translations_PAGE_TITLE}),invalidSteps.length>0&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:SORRY_ERRORS,color:"danger",iconType:"alert"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.rule.editRule.errorMsgDescription",defaultMessage:"You have an invalid input in {countError, plural, one {this tab} other {these tabs}}: {tabHasError}",values:{countError:invalidSteps.length,tabHasError:invalidSteps.map(t=>t===rules_types.a.aboutRule?rules_translations.a:t===rules_types.a.defineRule?rules_translations.I:t===rules_types.a.scheduleRule?rules_translations.qb:t===rules_types.a.ruleActions?rules_translations.pb:t).join(", ")}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTabbedContent,{initialSelectedTab:tabs[0],selectedTab:tabs.find(t=>t.id===activeStep),onTabClick:onTabClick,tabs:tabs}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",gutterSize:"s",justifyContent:"flexEnd",responsive:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{iconType:"cross",onClick:goToDetailsRule},CANCEL)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{"data-test-subj":"ruleEditSubmitButton",fill:!0,onClick:onSubmit,iconType:"save",isLoading:isLoading,isDisabled:loading},SAVE_CHANGES)))))),external_kbnSharedDeps_React_default.a.createElement(spy_routes.a,{pageName:app_types.a.detections,state:{ruleName:null==rule?void 0:rule.name}}))},EditRulePage=Object(external_kbnSharedDeps_React_.memo)(EditRulePageComponent);var formatted_date=__webpack_require__(134),markdown_editor=__webpack_require__(305);const ABOUT_PANEL_DETAILS_TAB=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.details.stepAboutRule.detailsLabel",{defaultMessage:"Details"}),ABOUT_TEXT=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.details.stepAboutRule.aboutText",{defaultMessage:"About"}),ABOUT_PANEL_NOTES_TAB=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.details.stepAboutRule.investigationGuideLabel",{defaultMessage:"Investigation guide"}),ABOUT_CONTROL_LEGEND=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.details.stepAboutRule.controlLegend",{defaultMessage:"Viewing"}),step_about_rule_details_MyPanel=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiPanel).withConfig({displayName:"MyPanel",componentId:"wtwaaw-0"})(["position:relative;"]),FlexGroupFullHeight=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup).withConfig({displayName:"FlexGroupFullHeight",componentId:"wtwaaw-1"})(["height:100%;"]),VerticalOverflowContainer=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"VerticalOverflowContainer",componentId:"wtwaaw-2"})(props=>({"max-height":props.maxHeight+"px","overflow-y":"hidden"})),VerticalOverflowContent=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"VerticalOverflowContent",componentId:"wtwaaw-3"})(props=>({"max-height":props.maxHeight+"px"})),AboutContent=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"AboutContent",componentId:"wtwaaw-4"})(["height:100%;"]),toggleOptions=[{id:"details",label:ABOUT_PANEL_DETAILS_TAB,"data-test-subj":"stepAboutDetailsToggle-details"},{id:"notes",label:ABOUT_PANEL_NOTES_TAB,"data-test-subj":"stepAboutDetailsToggle-notes"}],StepAboutRuleToggleDetailsComponent=({stepData:stepData,stepDataDetails:stepDataDetails,loading:loading})=>{const[selectedToggleOption,setToggleOption]=Object(external_kbnSharedDeps_React_.useState)("details"),[aboutPanelHeight,setAboutPanelHeight]=Object(external_kbnSharedDeps_React_.useState)(0),onResize=Object(external_kbnSharedDeps_React_.useCallback)(e=>{setAboutPanelHeight(e.height)},[setAboutPanelHeight]);return external_kbnSharedDeps_React_default.a.createElement(step_about_rule_details_MyPanel,null,loading&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiProgress,{size:"xs",color:"accent",position:"absolute"}),external_kbnSharedDeps_React_default.a.createElement(header_section.a,{title:ABOUT_TEXT})),null!=stepData&&null!=stepDataDetails&&external_kbnSharedDeps_React_default.a.createElement(FlexGroupFullHeight,{gutterSize:"xs",direction:"column"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,key:"header"},external_kbnSharedDeps_React_default.a.createElement(header_section.a,{title:ABOUT_TEXT},!Object(external_kbnSharedDeps_LodashFp_.isEmpty)(stepDataDetails.note)&&""!==stepDataDetails.note.trim()&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonGroup,{options:toggleOptions,idSelected:selectedToggleOption,onChange:val=>{setToggleOption(val)},"data-test-subj":"stepAboutDetailsToggle",legend:ABOUT_CONTROL_LEGEND}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{key:"details"},"details"===selectedToggleOption?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiResizeObserver,{"data-test-subj":"stepAboutDetailsContent",onResize:onResize},resizeRef=>external_kbnSharedDeps_React_default.a.createElement(AboutContent,{ref:resizeRef},external_kbnSharedDeps_React_default.a.createElement(VerticalOverflowContainer,{maxHeight:120},external_kbnSharedDeps_React_default.a.createElement(VerticalOverflowContent,{maxHeight:120,className:"eui-yScrollWithShadows"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"s","data-test-subj":"stepAboutRuleDetailsToggleDescriptionText"},stepDataDetails.description))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(StepAboutRule,{descriptionColumns:"singleSplit",isReadOnlyView:!0,isLoading:!1,defaultValues:stepData}))):external_kbnSharedDeps_React_default.a.createElement(VerticalOverflowContainer,{"data-test-subj":"stepAboutDetailsNoteContent",maxHeight:aboutPanelHeight},external_kbnSharedDeps_React_default.a.createElement(VerticalOverflowContent,{maxHeight:aboutPanelHeight,className:"eui-yScrollWithShadows"},external_kbnSharedDeps_React_default.a.createElement(markdown_editor.MarkdownRenderer,null,stepDataDetails.note))))))},StepAboutRuleToggleDetails=Object(external_kbnSharedDeps_React_.memo)(StepAboutRuleToggleDetailsComponent),readOnlyAccessToRulesMessage={type:"primary",id:"read-only-access-to-rules",title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.readOnlyRulesCallOut.messageTitle",{defaultMessage:"Rule permissions required"}),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.readOnlyRulesCallOut.messageBody.messageDetail",defaultMessage:"{essence} Related documentation: {docs}",values:{essence:external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.readOnlyRulesCallOut.messageBody.essenceDescription",defaultMessage:"You are currently missing the required permissions to create/edit detection engine rule. Please contact your administrator for further assistance."})),docs:external_kbnSharedDeps_React_default.a.createElement("ul",null,external_kbnSharedDeps_React_default.a.createElement("li",null,external_kbnSharedDeps_React_default.a.createElement(DetectionsRequirementsLink,null)),external_kbnSharedDeps_React_default.a.createElement("li",null,external_kbnSharedDeps_React_default.a.createElement(SecuritySolutionRequirementsLink,null)))}})},ReadOnlyRulesCallOutComponent=()=>{const[{canUserCRUD:canUserCRUD}]=Object(user_info.b)();return external_kbnSharedDeps_React_default.a.createElement(callouts.CallOutSwitcher,{namespace:"detections",condition:null!=canUserCRUD&&!canUserCRUD,message:readOnlyAccessToRulesMessage})},ReadOnlyRulesCallOut=Object(external_kbnSharedDeps_React_.memo)(ReadOnlyRulesCallOutComponent);var telemetry=__webpack_require__(43);const bucketRulesResponse=response=>response.reduce((acc,cv)=>"error"in cv?{rules:[...acc.rules],errors:[...acc.errors,cv]}:{rules:[...acc.rules,cv],errors:[...acc.errors]},{rules:[],errors:[]}),caseInsensitiveSort=tags=>tags.sort((a,b)=>a.toLowerCase().localeCompare(b.toLowerCase())),editRuleAction=(rule,history)=>{history.push(Object(redirect_to_detection_engine.d)(rule.id))},duplicateRulesAction=async(rules,ruleIds,dispatch,dispatchToaster)=>{try{dispatch({type:"loadingRuleIds",ids:ruleIds,actionType:"duplicate"});const response=await Object(api.d)({rules:rules.map(rule=>Object(transforms.b)(rule))}),{errors:errors,rules:createdRules}=bucketRulesResponse(response);return errors.length>0?Object(toasters.d)(rules_translations.N,errors.map(e=>e.error.message),dispatchToaster):Object(toasters.e)(rules_translations.yb(ruleIds.length),dispatchToaster),dispatch({type:"loadingRuleIds",ids:[],actionType:null}),createdRules}catch(error){dispatch({type:"loadingRuleIds",ids:[],actionType:null}),Object(toasters.g)({title:rules_translations.N,error:error,dispatchToaster:dispatchToaster})}},exportRulesAction=(exportRuleId,dispatch)=>{dispatch({type:"exportRuleIds",ids:exportRuleId})},deleteRulesAction=async(ruleIds,dispatch,dispatchToaster,onRuleDeleted)=>{try{dispatch({type:"loadingRuleIds",ids:ruleIds,actionType:"delete"});const response=await Object(api.c)({ids:ruleIds}),{errors:errors}=bucketRulesResponse(response);dispatch({type:"loadingRuleIds",ids:[],actionType:null}),errors.length>0?Object(toasters.d)(rules_translations.o(ruleIds.length),errors.map(e=>e.error.message),dispatchToaster):onRuleDeleted&&onRuleDeleted()}catch(error){dispatch({type:"loadingRuleIds",ids:[],actionType:null}),Object(toasters.g)({title:rules_translations.o(ruleIds.length),error:error,dispatchToaster:dispatchToaster})}},enableRulesAction=async(ids,enabled,dispatch,dispatchToaster)=>{const errorTitle=enabled?rules_translations.k(ids.length):rules_translations.m(ids.length);try{dispatch({type:"loadingRuleIds",ids:ids,actionType:enabled?"enable":"disable"});const response=await Object(api.e)({ids:ids,enabled:enabled}),{rules:rules,errors:errors}=bucketRulesResponse(response);dispatch({type:"updateRules",rules:rules}),errors.length>0&&Object(toasters.d)(errorTitle,errors.map(e=>e.error.message),dispatchToaster),rules.some(rule=>rule.immutable)&&Object(telemetry.e)(telemetry.a.COUNT,enabled?telemetry.b.SIEM_RULE_ENABLED:telemetry.b.SIEM_RULE_DISABLED),rules.some(rule=>!rule.immutable)&&Object(telemetry.e)(telemetry.a.COUNT,enabled?telemetry.b.CUSTOM_RULE_ENABLED:telemetry.b.CUSTOM_RULE_DISABLED)}catch(e){Object(toasters.d)(errorTitle,[e.message],dispatchToaster),dispatch({type:"loadingRuleIds",ids:[],actionType:null})}},StaticSwitch=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiSwitch).withConfig({displayName:"StaticSwitch",componentId:"sc-12pilng-0"})([".euiSwitch__thumb,.euiSwitch__icon{transition:none;}"]);StaticSwitch.displayName="StaticSwitch";const RuleSwitchComponent=({dispatch:dispatch,id:id,isDisabled:isDisabled,isLoading:isLoading,enabled:enabled,optionLabel:optionLabel,onChange:onChange})=>{const[myIsLoading,setMyIsLoading]=Object(external_kbnSharedDeps_React_.useState)(!1),[myEnabled,setMyEnabled]=Object(external_kbnSharedDeps_React_.useState)(null!=enabled&&enabled),[,dispatchToaster]=Object(toasters.h)(),onRuleStateChange=Object(external_kbnSharedDeps_React_.useCallback)(async event=>{if(setMyIsLoading(!0),null!=dispatch)await enableRulesAction([id],event.target.checked,dispatch,dispatchToaster);else{const enabling=event.target.checked,title=enabling?rules_translations.k(1):rules_translations.m(1);try{const response=await Object(api.e)({ids:[id],enabled:enabling}),{rules:rules,errors:errors}=bucketRulesResponse(response);if(errors.length>0)setMyIsLoading(!1),Object(toasters.d)(title,errors.map(e=>e.error.message),dispatchToaster);else{const[rule]=rules;setMyEnabled(rule.enabled),null!=onChange&&onChange(rule.enabled)}}catch(err){setMyIsLoading(!1),Object(toasters.d)(title,err.message,dispatchToaster)}}setMyIsLoading(!1)},[dispatch,id]);Object(external_kbnSharedDeps_React_.useEffect)(()=>{myEnabled!==enabled&&setMyEnabled(enabled)},[enabled]);const showLoader=Object(external_kbnSharedDeps_React_.useMemo)(()=>myIsLoading!==isLoading&&isLoading||myIsLoading,[myIsLoading,isLoading]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceAround"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},showLoader?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingSpinner,{size:"m","data-test-subj":"ruleSwitchLoader"}):external_kbnSharedDeps_React_default.a.createElement(StaticSwitch,{"data-test-subj":"ruleSwitch",label:null!=optionLabel?optionLabel:"",showLabel:!Object(external_kbnSharedDeps_LodashFp_.isEmpty)(optionLabel),disabled:isDisabled,checked:myEnabled,onChange:onRuleStateChange})))},RuleSwitch=external_kbnSharedDeps_React_default.a.memo(RuleSwitchComponent);RuleSwitch.displayName="RuleSwitch";const ALL_ACTIONS=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.rules.components.ruleActionsOverflow.allActionsTitle",{defaultMessage:"All actions"});var generic_downloader=__webpack_require__(505);const isBoolean=obj=>"boolean"==typeof obj,canEditRuleWithActions=(rule,privileges)=>{var _rule$actions;return null==rule||(!((null===(_rule$actions=rule.actions)||void 0===_rule$actions?void 0:_rule$actions.length)>0&&isBoolean(privileges))||privileges)},getToolTipContent=(rule,hasMlPermissions,hasReadActionsPrivileges)=>null==rule?void 0:Object(helpers.d)(rule.type)&&!hasMlPermissions?detection_engine_translations.f:canEditRuleWithActions(rule,hasReadActionsPrivileges)?void 0:rules_translations.Q,MyEuiButtonIcon=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon).withConfig({displayName:"MyEuiButtonIcon",componentId:"wltxb1-0"})(["&.euiButtonIcon{svg{transform:rotate(90deg);}border:1px solid  ",";width:40px;height:40px;}"],({theme:theme})=>theme.euiColorPrimary),RuleActionsOverflowComponent=({rule:rule,userHasNoPermissions:userHasNoPermissions,canDuplicateRuleWithActions:canDuplicateRuleWithActions})=>{const[isPopoverOpen,setIsPopoverOpen]=Object(external_kbnSharedDeps_React_.useState)(!1),[rulesToExport,setRulesToExport]=Object(external_kbnSharedDeps_React_.useState)([]),history=Object(external_kbnSharedDeps_ReactRouterDom_.useHistory)(),[,dispatchToaster]=Object(toasters.h)(),onRuleDeletedCallback=Object(external_kbnSharedDeps_React_.useCallback)(()=>{history.push(Object(redirect_to_detection_engine.f)())},[history]),actions=Object(external_kbnSharedDeps_React_.useMemo)(()=>null!=rule?[external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenuItem,{key:rules_translations.M,icon:"copy",disabled:!canDuplicateRuleWithActions||userHasNoPermissions,"data-test-subj":"rules-details-duplicate-rule",onClick:async()=>{setIsPopoverOpen(!1);const createdRules=await duplicateRulesAction([rule],[rule.id],external_kbnSharedDeps_LodashFp_.noop,dispatchToaster);null!=createdRules&&createdRules.length&&editRuleAction(createdRules[0],history)}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{position:"left",content:getToolTipContent(rule,!0,canDuplicateRuleWithActions)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,rules_translations.M))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenuItem,{key:rules_translations.U,icon:"exportAction",disabled:userHasNoPermissions||rule.immutable,"data-test-subj":"rules-details-export-rule",onClick:()=>{setIsPopoverOpen(!1),setRulesToExport([rule.rule_id])}},rules_translations.U),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenuItem,{key:rules_translations.K,icon:"trash",disabled:userHasNoPermissions,"data-test-subj":"rules-details-delete-rule",onClick:async()=>{setIsPopoverOpen(!1),await deleteRulesAction([rule.id],external_kbnSharedDeps_LodashFp_.noop,dispatchToaster,onRuleDeletedCallback)}},rules_translations.K)]:[],[rule,userHasNoPermissions]),handlePopoverOpen=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setIsPopoverOpen(!isPopoverOpen)},[setIsPopoverOpen,isPopoverOpen]),button=Object(external_kbnSharedDeps_React_.useMemo)(()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{position:"top",content:ALL_ACTIONS},external_kbnSharedDeps_React_default.a.createElement(MyEuiButtonIcon,{iconType:"boxesHorizontal","aria-label":ALL_ACTIONS,isDisabled:userHasNoPermissions,"data-test-subj":"rules-details-popover-button-icon",onClick:handlePopoverOpen})),[handlePopoverOpen,userHasNoPermissions]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopover,{anchorPosition:"leftCenter",button:button,closePopover:()=>setIsPopoverOpen(!1),id:"ruleActionsOverflow",isOpen:isPopoverOpen,"data-test-subj":"rules-details-popover",ownFocus:!0,panelPaddingSize:"none",repositionOnScroll:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenuPanel,{"data-test-subj":"rules-details-menu-panel",items:actions})),external_kbnSharedDeps_React_default.a.createElement(generic_downloader.a,{filename:rules_translations.T+".ndjson",ids:rulesToExport,exportSelectedData:api.f,"data-test-subj":"rules-details-generic-downloader",onExportSuccess:exportCount=>{Object(toasters.e)(rules_translations.zb(exportCount),dispatchToaster)}}))},RuleActionsOverflow=external_kbnSharedDeps_React_default.a.memo(RuleActionsOverflowComponent);RuleActionsOverflow.displayName="RuleActionsOverflow";const details_translations_PAGE_TITLE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.pageTitle",{defaultMessage:"Rule details"}),translations_BACK_TO_RULES=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.backToRulesDescription",{defaultMessage:"Back to detection rules"}),ACTIVATED_RULE=(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.experimentalDescription",{defaultMessage:"Experimental"}),external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.activatedRuleLabel",{defaultMessage:"Activated"})),UNKNOWN=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.unknownDescription",{defaultMessage:"Unknown"}),ERROR_CALLOUT_TITLE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.errorCalloutTitle",{defaultMessage:"Rule failure at"}),PARTIAL_FAILURE_CALLOUT_TITLE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.partialErrorCalloutTitle",{defaultMessage:"Warning at"}),FAILURE_HISTORY_TAB=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.failureHistoryTab",{defaultMessage:"Failure History"}),LAST_FIVE_ERRORS=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.lastFiveErrorsTitle",{defaultMessage:"Last five errors"}),COLUMN_STATUS_TYPE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.statusTypeColumn",{defaultMessage:"Type"}),COLUMN_FAILED_AT=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.statusFailedAtColumn",{defaultMessage:"Failed at"}),COLUMN_FAILED_MSG=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.statusFailedMsgColumn",{defaultMessage:"Failed message"}),TYPE_FAILED=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.statusFailedDescription",{defaultMessage:"Failed"}),EXCEPTIONS_TAB=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.exceptionsTab",{defaultMessage:"Exceptions"}),RuleStatusFailedCallOutComponent=({date:date,message:message,color:color})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"xs",alignItems:"center",justifyContent:"flexStart"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},"warning"===color?PARTIAL_FAILURE_CALLOUT_TITLE:ERROR_CALLOUT_TITLE),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!0},external_kbnSharedDeps_React_default.a.createElement(formatted_date.a,{value:date,fieldName:"last_failure_at"}))),color:color||"danger",iconType:"alert"},external_kbnSharedDeps_React_default.a.createElement("p",null,message)),RuleStatusFailedCallOut=Object(external_kbnSharedDeps_React_.memo)(RuleStatusFailedCallOutComponent),FailureHistoryComponent=({id:id})=>{const[loading,ruleStatus]=useRuleStatus(id);if(loading)return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPanel,null,external_kbnSharedDeps_React_default.a.createElement(header_section.a,{title:LAST_FIVE_ERRORS}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingContent,null));const columns=[{name:COLUMN_STATUS_TYPE,render:()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHealth,{color:"danger"},TYPE_FAILED),truncateText:!1,width:"16%"},{field:"last_failure_at",name:COLUMN_FAILED_AT,render:value=>external_kbnSharedDeps_React_default.a.createElement(formatted_date.a,{value:value,fieldName:"last_failure_at"}),sortable:!1,truncateText:!1,width:"24%"},{field:"last_failure_message",name:COLUMN_FAILED_MSG,render:value=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,value),sortable:!1,truncateText:!1,width:"60%"}];return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPanel,null,external_kbnSharedDeps_React_default.a.createElement(header_section.a,{title:LAST_FIVE_ERRORS}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBasicTable,{columns:columns,loading:loading,items:null!=ruleStatus?null==ruleStatus?void 0:ruleStatus.failures.filter(rs=>null!=rs.last_failure_at):[],sorting:{sort:{field:"status_date",direction:"desc"}}}))},FailureHistory=Object(external_kbnSharedDeps_React_.memo)(FailureHistoryComponent),getStatusColor=status=>null==status?"subdued":"succeeded"===status?"success":"failed"===status?"danger":"executing"===status||"going to run"===status||"partial failure"===status||"warning"===status?"warning":"subdued",STATUS=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.ruleStatus.statusDescription",{defaultMessage:"Last response"}),STATUS_AT=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.ruleStatus.statusAtDescription",{defaultMessage:"at"}),STATUS_DATE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.ruleStatus.statusDateDescription",{defaultMessage:"Status date"}),RuleStatusComponent=(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.ruleStatus.refreshButton",{defaultMessage:"Refresh"}),({children:children,statusDate:statusDate,status:status})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHealth,{color:getStatusColor(null!=status?status:null)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{"data-test-subj":"ruleStatus",size:"xs"},null!=status?status:Object(empty_value.d)()))),null!=statusDate&&null!=status&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,STATUS_AT)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!0},external_kbnSharedDeps_React_default.a.createElement(formatted_date.a,{value:statusDate,fieldName:STATUS_DATE}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},children))),RuleStatus=Object(external_kbnSharedDeps_React_.memo)(RuleStatusComponent);var exceptions_translations=__webpack_require__(170),loader=__webpack_require__(175);const ExceptionsViewerHeaderComponent=({isInitLoading:isInitLoading,supportedListTypes:supportedListTypes,detectionsListItems:detectionsListItems,endpointListItems:endpointListItems,onFilterChange:onFilterChange,onAddExceptionClick:onAddExceptionClick})=>{const[filter,setFilter]=Object(external_kbnSharedDeps_React_.useState)(""),[tags,setTags]=Object(external_kbnSharedDeps_React_.useState)([]),[showDetectionsListsOnly,setShowDetectionsList]=Object(external_kbnSharedDeps_React_.useState)(!1),[showEndpointListsOnly,setShowEndpointList]=Object(external_kbnSharedDeps_React_.useState)(!1),[isAddExceptionMenuOpen,setAddExceptionMenuOpen]=Object(external_kbnSharedDeps_React_.useState)(!1);Object(external_kbnSharedDeps_React_.useEffect)(()=>{onFilterChange({filter:{filter:filter,tags:tags},pagination:{pageIndex:0},showDetectionsListsOnly:showDetectionsListsOnly,showEndpointListsOnly:showEndpointListsOnly})},[filter,tags,showDetectionsListsOnly,showEndpointListsOnly,onFilterChange]);const onAddExceptionDropdownClick=Object(external_kbnSharedDeps_React_.useCallback)(()=>setAddExceptionMenuOpen(!isAddExceptionMenuOpen),[setAddExceptionMenuOpen,isAddExceptionMenuOpen]),handleDetectionsListClick=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setShowDetectionsList(!showDetectionsListsOnly),setShowEndpointList(!1)},[showDetectionsListsOnly,setShowDetectionsList,setShowEndpointList]),handleEndpointListClick=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setShowEndpointList(!showEndpointListsOnly),setShowDetectionsList(!1)},[showEndpointListsOnly,setShowEndpointList,setShowDetectionsList]),handleOnSearch=Object(external_kbnSharedDeps_React_.useCallback)(searchValue=>{const tagsRegex=/(tags:[^\s]*)/i,tagsMatch=searchValue.match(tagsRegex),foundTags=null!=tagsMatch?tagsMatch[0].split(":")[1]:"",filterString=null!=tagsMatch?searchValue.replace(tagsRegex,""):searchValue;foundTags.length>0&&setTags(foundTags.split(",")),setFilter(filterString.trim())},[setTags,setFilter]),onAddException=Object(external_kbnSharedDeps_React_.useCallback)(type=>{onAddExceptionClick(type),setAddExceptionMenuOpen(!1)},[onAddExceptionClick,setAddExceptionMenuOpen]),addExceptionButtonOptions=Object(external_kbnSharedDeps_React_.useMemo)(()=>[{id:0,items:[{name:exceptions_translations.g,onClick:()=>onAddException(lists_plugin_deps.a.ENDPOINT),"data-test-subj":"addEndpointExceptionBtn"},{name:exceptions_translations.f,onClick:()=>onAddException(lists_plugin_deps.a.DETECTION),"data-test-subj":"addDetectionsExceptionBtn"}]}],[onAddException]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldSearch,{"data-test-subj":"exceptionsHeaderSearch","aria-label":exceptions_translations.G,placeholder:exceptions_translations.G,onSearch:handleOnSearch,disabled:isInitLoading,incremental:!1,fullWidth:!0})),supportedListTypes.length<2&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{"data-test-subj":"exceptionsHeaderAddExceptionBtn",onClick:()=>onAddException(supportedListTypes[0]),isDisabled:isInitLoading,fill:!0},exceptions_translations.d)),supportedListTypes.length>1&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFilterGroup,{"data-test-subj":"exceptionsFilterGroupBtns"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFilterButton,{"data-test-subj":"exceptionsDetectionFilterBtn",hasActiveFilters:showDetectionsListsOnly,onClick:handleDetectionsListClick,isDisabled:isInitLoading},exceptions_translations.q,null!=detectionsListItems?` (${detectionsListItems})`:""),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFilterButton,{"data-test-subj":"exceptionsEndpointFilterBtn",hasActiveFilters:showEndpointListsOnly,onClick:handleEndpointListClick,isDisabled:isInitLoading},exceptions_translations.u,null!=endpointListItems?` (${endpointListItems})`:""))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopover,{button:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{"data-test-subj":"exceptionsHeaderAddExceptionPopoverBtn",onClick:onAddExceptionDropdownClick,isDisabled:isInitLoading,iconType:"arrowDown",iconSide:"right",fill:!0},exceptions_translations.d),isOpen:isAddExceptionMenuOpen,closePopover:onAddExceptionDropdownClick,anchorPosition:"downCenter",panelPaddingSize:"none",repositionOnScroll:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenu,{initialPanelId:0,panels:addExceptionButtonOptions}))))))};ExceptionsViewerHeaderComponent.displayName="ExceptionsViewerHeaderComponent";const ExceptionsViewerHeader=external_kbnSharedDeps_React_default.a.memo(ExceptionsViewerHeaderComponent);ExceptionsViewerHeader.displayName="ExceptionsViewerHeader";const ExceptionsViewerPaginationComponent=({pagination:pagination,onPaginationChange:onPaginationChange})=>{const[isOpen,setIsOpen]=Object(external_kbnSharedDeps_React_.useState)(!1),handleClosePerPageMenu=Object(external_kbnSharedDeps_React_.useCallback)(()=>setIsOpen(!1),[setIsOpen]),handlePerPageMenuClick=Object(external_kbnSharedDeps_React_.useCallback)(()=>setIsOpen(isPopoverOpen=>!isPopoverOpen),[setIsOpen]),handlePageClick=Object(external_kbnSharedDeps_React_.useCallback)(pageIndex=>{onPaginationChange({pagination:{pageIndex:pageIndex,pageSize:pagination.pageSize,totalItemCount:pagination.totalItemCount}})},[pagination,onPaginationChange]),items=Object(external_kbnSharedDeps_React_.useMemo)(()=>pagination.pageSizeOptions.map(rows=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenuItem,{key:rows,icon:"empty",onClick:()=>{onPaginationChange({pagination:{pageIndex:0,pageSize:rows,totalItemCount:pagination.totalItemCount}}),handleClosePerPageMenu()},"data-test-subj":"exceptionsPerPageItem"},exceptions_translations.C(rows))),[pagination,onPaginationChange,handleClosePerPageMenu]),totalPages=Object(external_kbnSharedDeps_React_.useMemo)(()=>pagination.totalItemCount>0?Math.ceil(pagination.totalItemCount/pagination.pageSize):1,[pagination]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopover,{button:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{size:"s",color:"text",iconType:"arrowDown",iconSide:"right",onClick:handlePerPageMenuClick,"data-test-subj":"exceptionsPerPageBtn"},exceptions_translations.A(pagination.pageSize)),isOpen:isOpen,closePopover:handleClosePerPageMenu,panelPaddingSize:"none",repositionOnScroll:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenuPanel,{items:items}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPagination,{pageCount:totalPages,activePage:pagination.pageIndex,onPageClick:handlePageClick,"data-test-subj":"exceptionsPagination"})))};ExceptionsViewerPaginationComponent.displayName="ExceptionsViewerPaginationComponent";const ExceptionsViewerPagination=external_kbnSharedDeps_React_default.a.memo(ExceptionsViewerPaginationComponent);ExceptionsViewerPagination.displayName="ExceptionsViewerPagination";const StyledText=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiText).withConfig({displayName:"StyledText",componentId:"oztuyc-0"})(["font-style:italic;"]),MyUtilities=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup).withConfig({displayName:"MyUtilities",componentId:"oztuyc-1"})(["height:50px;"]),ExceptionsViewerUtilityComponent=({pagination:pagination,showEndpointListsOnly:showEndpointListsOnly,showDetectionsListsOnly:showDetectionsListsOnly,ruleSettingsUrl:ruleSettingsUrl,onRefreshClick:onRefreshClick})=>{var _pagination$totalItem;return external_kbnSharedDeps_React_default.a.createElement(MyUtilities,{alignItems:"center",justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(utility_bar.a,null,external_kbnSharedDeps_React_default.a.createElement(utility_bar.d,null,external_kbnSharedDeps_React_default.a.createElement(utility_bar.c,null,external_kbnSharedDeps_React_default.a.createElement(utility_bar.f,{dataTestSubj:"exceptionsShowing"},exceptions_translations.H(null!==(_pagination$totalItem=pagination.totalItemCount)&&void 0!==_pagination$totalItem?_pagination$totalItem:0))),external_kbnSharedDeps_React_default.a.createElement(utility_bar.c,null,external_kbnSharedDeps_React_default.a.createElement(utility_bar.b,{dataTestSubj:"exceptionsRefresh",iconSide:"left",iconType:"refresh",onClick:onRefreshClick},exceptions_translations.E))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(StyledText,{size:"s"},showEndpointListsOnly&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.exceptions.viewer.exceptionEndpointDetailsDescription",defaultMessage:"All exceptions to this rule are applied to the endpoint and the detection rule. View {ruleSettings} for more details.","data-test-subj":"exceptionsEndpointMessage",values:{ruleSettings:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{href:ruleSettingsUrl,target:"_blank"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.exceptions.viewer.exceptionEndpointDetailsDescription.ruleSettingsLink",defaultMessage:"rule settings"}))}}),showDetectionsListsOnly&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.exceptions.viewer.exceptionDetectionDetailsDescription",defaultMessage:"All exceptions to this rule are applied to the detection rule, not the endpoint. View {ruleSettings} for more details.","data-test-subj":"exceptionsDetectionsMessage",values:{ruleSettings:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{href:ruleSettingsUrl,target:"_blank"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.exceptions.viewer.exceptionDetectionDetailsDescription.ruleSettingsLink",defaultMessage:"rule settings"}))}}))))};ExceptionsViewerUtilityComponent.displayName="ExceptionsViewerUtilityComponent";const ExceptionsViewerUtility=external_kbnSharedDeps_React_default.a.memo(ExceptionsViewerUtilityComponent);ExceptionsViewerUtility.displayName="ExceptionsViewerUtility";var exceptions_helpers=__webpack_require__(247);const formatEntry=({isNested:isNested,item:item})=>{var _item$field;const operator=Object(exceptions_helpers.l)(item),value=Object(exceptions_helpers.k)(item);return{fieldName:null!==(_item$field=item.field)&&void 0!==_item$field?_item$field:"",operator:operator.message,value:value,isNested:isNested}},MyExceptionDetails=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexItem).withConfig({displayName:"MyExceptionDetails",componentId:"z36hrg-0"})(["",""],({theme:theme})=>Object(external_kbnSharedDeps_StyledComponents_.css)(["background-color:",";padding:",";"],theme.eui.euiColorLightestShade,theme.eui.euiSize)),MyDescriptionListTitle=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiDescriptionListTitle).withConfig({displayName:"MyDescriptionListTitle",componentId:"z36hrg-1"})(["width:40%;"]),MyDescriptionListDescription=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiDescriptionListDescription).withConfig({displayName:"MyDescriptionListDescription",componentId:"z36hrg-2"})(["width:60%;"]),ExceptionDetailsComponent=({showComments:showComments,onCommentsClick:onCommentsClick,exceptionItem:exceptionItem})=>{const descriptionListItems=Object(external_kbnSharedDeps_React_.useMemo)(()=>(exceptionItem=>[{title:exceptions_translations.D,value:Object(exceptions_helpers.j)(exceptionItem.os_types)},{title:exceptions_translations.n,value:external_kbnSharedDeps_Moment_default()(exceptionItem.created_at).format("MMMM Do YYYY @ HH:mm:ss")},{title:exceptions_translations.m,value:exceptionItem.created_by},{title:exceptions_translations.p,value:exceptionItem.description}].reduce((acc,{value:value,title:title})=>null!=value&&""!==value.trim()?[...acc,{title:title,description:value}]:acc,[]))(exceptionItem),[exceptionItem]),commentsSection=Object(external_kbnSharedDeps_React_.useMemo)(()=>{const{comments:comments}=exceptionItem;return comments.length>0?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{onClick:onCommentsClick,flush:"left",size:"xs","data-test-subj":"exceptionsViewerItemCommentsBtn"},showComments?exceptions_translations.j(comments.length):exceptions_translations.k(comments.length)):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null)},[showComments,onCommentsClick,exceptionItem]);return external_kbnSharedDeps_React_default.a.createElement(MyExceptionDetails,{grow:2},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"column",alignItems:"flexStart"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionList,{compressed:!0,type:"column","data-test-subj":"exceptionsViewerItemDetails"},descriptionListItems.map(item=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,{key:""+item.title},external_kbnSharedDeps_React_default.a.createElement(MyDescriptionListTitle,null,item.title),external_kbnSharedDeps_React_default.a.createElement(MyDescriptionListDescription,null,item.description))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},commentsSection)))};ExceptionDetailsComponent.displayName="ExceptionDetailsComponent";const ExceptionDetails=external_kbnSharedDeps_React_default.a.memo(ExceptionDetailsComponent);ExceptionDetails.displayName="ExceptionDetails";var polished_lib=__webpack_require__(184);const MyEntriesDetails=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexItem).withConfig({displayName:"MyEntriesDetails",componentId:"sc-1tpcxfd-0"})(["padding:",";"],({theme:theme})=>theme.eui.euiSize),MyEditButton=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiButton).withConfig({displayName:"MyEditButton",componentId:"sc-1tpcxfd-1"})(["",""],({theme:theme})=>Object(external_kbnSharedDeps_StyledComponents_.css)(["background-color:",";border:none;font-weight:",";"],Object(polished_lib.transparentize)(.9,theme.eui.euiColorPrimary),theme.eui.euiFontWeightSemiBold)),MyRemoveButton=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiButton).withConfig({displayName:"MyRemoveButton",componentId:"sc-1tpcxfd-2"})(["",""],({theme:theme})=>Object(external_kbnSharedDeps_StyledComponents_.css)(["background-color:",";border:none;font-weight:",";"],Object(polished_lib.transparentize)(.9,theme.eui.euiColorDanger),theme.eui.euiFontWeightSemiBold)),MyAndOrBadgeContainer=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexItem).withConfig({displayName:"MyAndOrBadgeContainer",componentId:"sc-1tpcxfd-3"})(["padding-top:",";padding-bottom:",";"],({theme:theme})=>theme.eui.euiSizeXL,({theme:theme})=>theme.eui.euiSizeS),MyActionButton=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexItem).withConfig({displayName:"MyActionButton",componentId:"sc-1tpcxfd-4"})(["align-self:flex-end;"]),MyNestedValueContainer=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"MyNestedValueContainer",componentId:"sc-1tpcxfd-5"})(["margin-left:",";"],({theme:theme})=>theme.eui.euiSizeL),MyNestedValue=external_kbnSharedDeps_StyledComponents_default.a.span.withConfig({displayName:"MyNestedValue",componentId:"sc-1tpcxfd-6"})(["margin-left:",";"],({theme:theme})=>theme.eui.euiSizeS),ValueBadgeGroup=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiBadgeGroup).withConfig({displayName:"ValueBadgeGroup",componentId:"sc-1tpcxfd-7"})(["width:100%;"]),ExceptionEntriesComponent=({entries:entries,disableDelete:disableDelete,onDelete:onDelete,onEdit:onEdit})=>{const columns=Object(external_kbnSharedDeps_React_.useMemo)(()=>[{field:"fieldName",name:"Field",sortable:!1,truncateText:!0,textOnly:!0,"data-test-subj":"exceptionFieldNameCell",width:"30%",render:(value,data)=>null!=value&&data.isNested?external_kbnSharedDeps_React_default.a.createElement(MyNestedValueContainer,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIconTip,{type:"nested",size:"s"}),external_kbnSharedDeps_React_default.a.createElement(MyNestedValue,null,value)):null!=value?value:Object(empty_value.e)()},{field:"operator",name:"Operator",sortable:!1,truncateText:!0,"data-test-subj":"exceptionFieldOperatorCell",width:"20%",render:value=>null!=value?value:Object(empty_value.e)()},{field:"value",name:"Value",sortable:!1,truncateText:!0,"data-test-subj":"exceptionFieldValueCell",width:"60%",render:values=>Array.isArray(values)?external_kbnSharedDeps_React_default.a.createElement(ValueBadgeGroup,{gutterSize:"xs"},values.map(value=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBadge,{color:"#DDD",key:value},value))):null!=values?values:Object(empty_value.e)()}],[entries]);return external_kbnSharedDeps_React_default.a.createElement(MyEntriesDetails,{grow:5},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"column",gutterSize:"m"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"row",gutterSize:"none"},entries.length>1&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHideFor,{sizes:["xs","s"]},external_kbnSharedDeps_React_default.a.createElement(MyAndOrBadgeContainer,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(and_or_badge.a,{type:"and",includeAntennas:!0,"data-test-subj":"exceptionsViewerAndBadge"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBasicTable,{isSelectable:!1,itemId:"id",columns:columns,items:entries,responsive:!0})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s",justifyContent:"flexEnd"},external_kbnSharedDeps_React_default.a.createElement(MyActionButton,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(MyEditButton,{size:"s",color:"primary",onClick:onEdit,isDisabled:disableDelete,"data-test-subj":"exceptionsViewerEditBtn"},exceptions_translations.t)),external_kbnSharedDeps_React_default.a.createElement(MyActionButton,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(MyRemoveButton,{size:"s",color:"danger",onClick:onDelete,isLoading:disableDelete,"data-test-subj":"exceptionsViewerDeleteBtn"},exceptions_translations.F))))))};ExceptionEntriesComponent.displayName="ExceptionEntriesComponent";const ExceptionEntries=external_kbnSharedDeps_React_default.a.memo(ExceptionEntriesComponent);ExceptionEntries.displayName="ExceptionEntries";const MyFlexItem=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexItem).withConfig({displayName:"MyFlexItem",componentId:"l5qlm8-0"})(["&.comments--show{padding:",";border-top:",";}"],({theme:theme})=>theme.eui.euiSize,({theme:theme})=>""+theme.eui.euiBorderThin),ExceptionItemComponent=({loadingItemIds:loadingItemIds,exceptionItem:exceptionItem,commentsAccordionId:commentsAccordionId,onDeleteException:onDeleteException,onEditException:onEditException})=>{const[entryItems,setEntryItems]=Object(external_kbnSharedDeps_React_.useState)([]),[showComments,setShowComments]=Object(external_kbnSharedDeps_React_.useState)(!1);Object(external_kbnSharedDeps_React_.useEffect)(()=>{const formattedEntries=exceptionItem.entries.map(item=>{if(lists_plugin_deps.f.is(item)){const parent={fieldName:item.field,operator:void 0,value:void 0,isNested:!1};return item.entries.reduce((acc,nestedEntry)=>[...acc,{...formatEntry({isNested:!0,item:nestedEntry})}],[parent])}return formatEntry({isNested:!1,item:item})}).flat();setEntryItems(formattedEntries)},[exceptionItem.entries]);const handleDelete=Object(external_kbnSharedDeps_React_.useCallback)(()=>{onDeleteException({id:exceptionItem.id,namespaceType:exceptionItem.namespace_type})},[onDeleteException,exceptionItem.id,exceptionItem.namespace_type]),handleEdit=Object(external_kbnSharedDeps_React_.useCallback)(()=>{onEditException(exceptionItem)},[onEditException,exceptionItem]),onCommentsClick=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setShowComments(!showComments)},[setShowComments,showComments]),formattedComments=Object(external_kbnSharedDeps_React_.useMemo)(()=>Object(exceptions_helpers.m)(exceptionItem.comments),[exceptionItem.comments]),disableDelete=Object(external_kbnSharedDeps_React_.useMemo)(()=>loadingItemIds.filter(({id:id})=>id===exceptionItem.id).length>0,[loadingItemIds,exceptionItem.id]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPanel,{paddingSize:"none"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"column",gutterSize:"none"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"row"},external_kbnSharedDeps_React_default.a.createElement(ExceptionDetails,{showComments:showComments,exceptionItem:exceptionItem,onCommentsClick:onCommentsClick}),external_kbnSharedDeps_React_default.a.createElement(ExceptionEntries,{disableDelete:disableDelete,entries:entryItems,onDelete:handleDelete,onEdit:handleEdit}))),external_kbnSharedDeps_React_default.a.createElement(MyFlexItem,{className:showComments?"comments--show":""},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiAccordion,{id:commentsAccordionId,arrowDisplay:"none",forceState:showComments?"open":"closed","data-test-subj":"exceptionsViewerCommentAccordion"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCommentList,{comments:formattedComments})))))};ExceptionItemComponent.displayName="ExceptionItemComponent";const ExceptionItem=external_kbnSharedDeps_React_default.a.memo(ExceptionItemComponent);ExceptionItem.displayName="ExceptionItem";const exceptions_viewer_items_MyFlexItem=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexItem).withConfig({displayName:"MyFlexItem",componentId:"z8zhds-0"})(["margin:",";&:first-child{margin:",";}"],({theme:theme})=>theme.eui.euiSize+" 0",({theme:theme})=>`${theme.eui.euiSizeXS} 0 ${theme.eui.euiSize}`),MyExceptionsContainer=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup).withConfig({displayName:"MyExceptionsContainer",componentId:"z8zhds-1"})(["height:600px;overflow:hidden;"]),MyExceptionItemContainer=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup).withConfig({displayName:"MyExceptionItemContainer",componentId:"z8zhds-2"})(["margin:",";"],({theme:theme})=>`0 ${theme.eui.euiSize} ${theme.eui.euiSize} 0`),ExceptionsViewerItemsComponent=({showEmpty:showEmpty,showNoResults:showNoResults,isInitLoading:isInitLoading,exceptions:exceptions,loadingItemIds:loadingItemIds,commentsAccordionId:commentsAccordionId,onDeleteException:onDeleteException,onEditExceptionItem:onEditExceptionItem})=>external_kbnSharedDeps_React_default.a.createElement(MyExceptionsContainer,{direction:"column",className:"eui-yScrollWithShadows"},showEmpty||showNoResults||isInitLoading?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiEmptyPrompt,{iconType:showNoResults?"searchProfilerApp":"list",title:external_kbnSharedDeps_React_default.a.createElement("h2",{"data-test-subj":"exceptionsEmptyPromptTitle"},showNoResults?"":exceptions_translations.x),body:external_kbnSharedDeps_React_default.a.createElement("p",{"data-test-subj":"exceptionsEmptyPromptBody"},showNoResults?exceptions_translations.y:exceptions_translations.w),"data-test-subj":"exceptionsEmptyPrompt"})):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,className:"eui-yScrollWithShadows"},external_kbnSharedDeps_React_default.a.createElement(MyExceptionItemContainer,{"data-test-subj":"exceptionsContainer",gutterSize:"none",direction:"column"},!isInitLoading&&exceptions.length>0&&exceptions.map((exception,index)=>external_kbnSharedDeps_React_default.a.createElement(exceptions_viewer_items_MyFlexItem,{"data-test-subj":"exceptionItemContainer",grow:!1,key:exception.id},0!==index?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(and_or_badge.a,{"data-test-subj":"exceptionItemOrBadge",type:"or"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null)):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(ExceptionItem,{loadingItemIds:loadingItemIds,commentsAccordionId:commentsAccordionId,exceptionItem:exception,onDeleteException:onDeleteException,onEditException:onEditExceptionItem}))))));ExceptionsViewerItemsComponent.displayName="ExceptionsViewerItemsComponent";const ExceptionsViewerItems=external_kbnSharedDeps_React_default.a.memo(ExceptionsViewerItemsComponent);ExceptionsViewerItems.displayName="ExceptionsViewerItems";var use_signal_index=__webpack_require__(286),use_rule_async=__webpack_require__(366);const translations_CANCEL=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.exceptions.editException.cancel",{defaultMessage:"Cancel"}),EDIT_EXCEPTION_SAVE_BUTTON=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.exceptions.editException.editExceptionSaveButton",{defaultMessage:"Save"}),EDIT_EXCEPTION_TITLE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.exceptions.editException.editExceptionTitle",{defaultMessage:"Edit Rule Exception"}),EDIT_ENDPOINT_EXCEPTION_TITLE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.exceptions.editException.editEndpointExceptionTitle",{defaultMessage:"Edit Endpoint Exception"}),EDIT_EXCEPTION_SUCCESS=(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.exceptions.editException.error",{defaultMessage:"Failed to update exception"}),external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.exceptions.editException.success",{defaultMessage:"Successfully updated exception"})),BULK_CLOSE_LABEL=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.exceptions.editException.bulkCloseLabel",{defaultMessage:"Close all alerts that match this exception and were generated by this rule"}),BULK_CLOSE_LABEL_DISABLED=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.exceptions.editException.bulkCloseLabel.disabled",{defaultMessage:"Close all alerts that match this exception and were generated by this rule (Lists and non-ECS fields are not supported)"}),ENDPOINT_QUARANTINE_TEXT=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.exceptions.editException.endpointQuarantineText",{defaultMessage:"On all Endpoint hosts, quarantined files that match the exception are automatically restored to their original locations. This exception applies to all rules using Endpoint exceptions."}),EXCEPTION_BUILDER_INFO=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.exceptions.editException.infoLabel",{defaultMessage:"Alerts are generated when the rule's conditions are met, except when:"}),VERSION_CONFLICT_ERROR_TITLE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.exceptions.editException.versionConflictTitle",{defaultMessage:"Sorry, there was an error"}),VERSION_CONFLICT_ERROR_DESCRIPTION=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.exceptions.editException.versionConflictDescription",{defaultMessage:"It appears this exception was updated since you first selected to edit it. Try clicking 'Cancel' and editing the exception again."}),EDIT_EXCEPTION_SEQUENCE_WARNING=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.exceptions.editException.sequenceWarning",{defaultMessage:"This rule's query contains an EQL sequence statement. The exception modified will apply to all events in the sequence."});var use_add_exception=__webpack_require__(664),add_exception_comments=__webpack_require__(666),error_callout=__webpack_require__(757),use_get_jobs=__webpack_require__(758);const Modal=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiModal).withConfig({displayName:"Modal",componentId:"sc-1xmfgey-0"})(["",""],({theme:theme})=>Object(external_kbnSharedDeps_StyledComponents_.css)(["width:",";max-width:",";"],theme.eui.euiBreakpoints.l,theme.eui.euiBreakpoints.l)),ModalHeader=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiModalHeader).withConfig({displayName:"ModalHeader",componentId:"sc-1xmfgey-1"})(["flex-direction:column;align-items:flex-start;"]),ModalHeaderSubtitle=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"ModalHeaderSubtitle",componentId:"sc-1xmfgey-2"})(["",""],({theme:theme})=>Object(external_kbnSharedDeps_StyledComponents_.css)(["color:",";"],theme.eui.euiColorMediumShade)),ModalBodySection=external_kbnSharedDeps_StyledComponents_default.a.section.withConfig({displayName:"ModalBodySection",componentId:"sc-1xmfgey-3"})(["",""],({theme:theme})=>Object(external_kbnSharedDeps_StyledComponents_.css)(["padding:"," ",";&.builder-section{overflow-y:scroll;}"],theme.eui.euiSizeS,theme.eui.euiSizeL)),edit_exception_modal_EditExceptionModal=Object(external_kbnSharedDeps_React_.memo)((function({ruleName:ruleName,ruleId:ruleId,ruleIndices:ruleIndices,exceptionItem:exceptionItem,exceptionListType:exceptionListType,onCancel:onCancel,onConfirm:onConfirm,onRuleChange:onRuleChange}){const{http:http,data:data}=Object(lib_kibana.h)().services,[comment,setComment]=Object(external_kbnSharedDeps_React_.useState)(""),[errorsExist,setErrorExists]=Object(external_kbnSharedDeps_React_.useState)(!1),{rule:maybeRule,loading:isRuleLoading}=Object(use_rule_async.a)(ruleId),[updateError,setUpdateError]=Object(external_kbnSharedDeps_React_.useState)(null),[hasVersionConflict,setHasVersionConflict]=Object(external_kbnSharedDeps_React_.useState)(!1),[shouldBulkCloseAlert,setShouldBulkCloseAlert]=Object(external_kbnSharedDeps_React_.useState)(!1),[shouldDisableBulkClose,setShouldDisableBulkClose]=Object(external_kbnSharedDeps_React_.useState)(!1),[exceptionItemsToAdd,setExceptionItemsToAdd]=Object(external_kbnSharedDeps_React_.useState)([]),{addError:addError,addSuccess:addSuccess}=Object(use_app_toasts.a)(),{loading:isSignalIndexLoading,signalIndexName:signalIndexName}=Object(use_signal_index.a)(),memoSignalIndexName=Object(external_kbnSharedDeps_React_.useMemo)(()=>null!==signalIndexName?[signalIndexName]:[],[signalIndexName]),[isSignalIndexPatternLoading,{indexPatterns:signalIndexPatterns}]=Object(source.b)(memoSignalIndexName),memoMlJobIds=Object(external_kbnSharedDeps_React_.useMemo)(()=>{var _maybeRule$machine_le;return null!==(_maybeRule$machine_le=null==maybeRule?void 0:maybeRule.machine_learning_job_id)&&void 0!==_maybeRule$machine_le?_maybeRule$machine_le:[]},[maybeRule]),{loading:mlJobLoading,jobs:jobs}=Object(use_get_jobs.a)(memoMlJobIds),memoRuleIndices=Object(external_kbnSharedDeps_React_.useMemo)(()=>jobs.length>0?jobs[0].results_index_name?[".ml-anomalies-"+jobs[0].results_index_name]:[]:ruleIndices,[jobs,ruleIndices]),[isIndexPatternLoading,{indexPatterns:indexPatterns}]=Object(source.b)(memoRuleIndices),handleExceptionUpdateError=Object(external_kbnSharedDeps_React_.useCallback)((error,statusCode,message)=>{error.message.includes("Conflict")?setHasVersionConflict(!0):setUpdateError({reason:error.message,code:statusCode,details:message,listListId:exceptionItem.list_id})},[setUpdateError,setHasVersionConflict,exceptionItem.list_id]),handleDissasociationSuccess=Object(external_kbnSharedDeps_React_.useCallback)(id=>{addSuccess(exceptions_translations.s(id)),onRuleChange&&onRuleChange(),onCancel()},[addSuccess,onCancel,onRuleChange]),handleDissasociationError=Object(external_kbnSharedDeps_React_.useCallback)(error=>{addError(error,{title:exceptions_translations.r}),onCancel()},[addError,onCancel]),handleExceptionUpdateSuccess=Object(external_kbnSharedDeps_React_.useCallback)(()=>{addSuccess(EDIT_EXCEPTION_SUCCESS),onConfirm()},[addSuccess,onConfirm]),[{isLoading:addExceptionIsLoading},addOrUpdateExceptionItems]=Object(use_add_exception.a)({http:http,onSuccess:handleExceptionUpdateSuccess,onError:handleExceptionUpdateError});Object(external_kbnSharedDeps_React_.useEffect)(()=>{!1===isSignalIndexPatternLoading&&!1===isSignalIndexLoading&&setShouldDisableBulkClose(Object(exceptions_helpers.f)(exceptionItemsToAdd)||Object(exceptions_helpers.g)(exceptionItemsToAdd,signalIndexPatterns)||exceptionItemsToAdd.every(item=>0===item.entries.length))},[setShouldDisableBulkClose,exceptionItemsToAdd,isSignalIndexPatternLoading,isSignalIndexLoading,signalIndexPatterns]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{!0===shouldDisableBulkClose&&setShouldBulkCloseAlert(!1)},[shouldDisableBulkClose]);const isSubmitButtonDisabled=Object(external_kbnSharedDeps_React_.useMemo)(()=>exceptionItemsToAdd.every(item=>0===item.entries.length)||hasVersionConflict||errorsExist,[exceptionItemsToAdd,hasVersionConflict,errorsExist]),handleBuilderOnChange=Object(external_kbnSharedDeps_React_.useCallback)(({exceptionItems:exceptionItems,errorExists:errorExists})=>{setExceptionItemsToAdd(exceptionItems),setErrorExists(errorExists)},[setExceptionItemsToAdd]),onCommentChange=Object(external_kbnSharedDeps_React_.useCallback)(value=>{setComment(value)},[setComment]),onBulkCloseAlertCheckboxChange=Object(external_kbnSharedDeps_React_.useCallback)(event=>{setShouldBulkCloseAlert(event.currentTarget.checked)},[setShouldBulkCloseAlert]),enrichExceptionItems=Object(external_kbnSharedDeps_React_.useCallback)(()=>{const[exceptionItemToEdit]=exceptionItemsToAdd;let enriched=[{...Object(exceptions_helpers.d)(exceptionItemToEdit,[...exceptionItem.comments,...""!==comment.trim()?[{comment:comment}]:[]])}];return"endpoint"===exceptionListType&&(enriched=Object(exceptions_helpers.n)(Object(exceptions_helpers.c)(enriched,exceptionItem.os_types))),enriched},[exceptionItemsToAdd,exceptionItem,comment,exceptionListType]),onEditExceptionConfirm=Object(external_kbnSharedDeps_React_.useCallback)(()=>{if(null!==addOrUpdateExceptionItems){const bulkCloseIndex=shouldBulkCloseAlert&&null!==signalIndexName?[signalIndexName]:void 0;addOrUpdateExceptionItems(ruleId,enrichExceptionItems(),void 0,bulkCloseIndex)}},[addOrUpdateExceptionItems,ruleId,enrichExceptionItems,shouldBulkCloseAlert,signalIndexName]),isRuleEQLSequenceStatement=Object(external_kbnSharedDeps_React_.useMemo)(()=>null!=maybeRule&&(Object(utils.c)(maybeRule.type)&&Object(utils.b)(maybeRule.query)),[maybeRule]);return external_kbnSharedDeps_React_default.a.createElement(Modal,{onClose:onCancel,"data-test-subj":"add-exception-modal"},external_kbnSharedDeps_React_default.a.createElement(ModalHeader,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalHeaderTitle,null,"endpoint"===exceptionListType?EDIT_ENDPOINT_EXCEPTION_TITLE:EDIT_EXCEPTION_TITLE),external_kbnSharedDeps_React_default.a.createElement(ModalHeaderSubtitle,{className:"eui-textTruncate",title:ruleName},ruleName)),(addExceptionIsLoading||isIndexPatternLoading||isSignalIndexLoading)&&external_kbnSharedDeps_React_default.a.createElement(loader.a,{"data-test-subj":"loadingEditExceptionModal",size:"xl"}),!isSignalIndexLoading&&!addExceptionIsLoading&&!isIndexPatternLoading&&!isRuleLoading&&!mlJobLoading&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(ModalBodySection,{className:"builder-section"},isRuleEQLSequenceStatement&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{"data-test-subj":"eql-sequence-callout",title:EDIT_EXCEPTION_SEQUENCE_WARNING}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,EXCEPTION_BUILDER_INFO),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),external_kbnSharedDeps_React_default.a.createElement(shared_imports.b.ExceptionBuilderComponent,{allowLargeValueLists:!Object(utils.c)(null==maybeRule?void 0:maybeRule.type)&&!Object(utils.f)(null==maybeRule?void 0:maybeRule.type),httpService:http,autocompleteService:data.autocomplete,exceptionListItems:[exceptionItem],listType:exceptionListType,listId:exceptionItem.list_id,listNamespaceType:exceptionItem.namespace_type,listTypeSpecificIndexPatternFilter:exceptions_helpers.h,ruleName:ruleName,isOrDisabled:!0,isAndDisabled:!1,isNestedDisabled:!1,"data-test-subj":"edit-exception-modal-builder","id-aria":"edit-exception-modal-builder",onChange:handleBuilderOnChange,indexPatterns:indexPatterns}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),external_kbnSharedDeps_React_default.a.createElement(add_exception_comments.a,{exceptionItemComments:exceptionItem.comments,newCommentValue:comment,newCommentOnChange:onCommentChange})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHorizontalRule,null),external_kbnSharedDeps_React_default.a.createElement(ModalBodySection,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{fullWidth:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCheckbox,{"data-test-subj":"close-alert-on-add-edit-exception-checkbox",id:"close-alert-on-add-edit-exception-checkbox",label:shouldDisableBulkClose?BULK_CLOSE_LABEL_DISABLED:BULK_CLOSE_LABEL,checked:shouldBulkCloseAlert,onChange:onBulkCloseAlertCheckboxChange,disabled:shouldDisableBulkClose})),"endpoint"===exceptionListType&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{"data-test-subj":"edit-exception-endpoint-text",color:"subdued",size:"s"},ENDPOINT_QUARANTINE_TEXT)))),null!=updateError&&external_kbnSharedDeps_React_default.a.createElement(ModalBodySection,null,external_kbnSharedDeps_React_default.a.createElement(error_callout.a,{http:http,errorInfo:updateError,rule:maybeRule,onCancel:onCancel,onSuccess:handleDissasociationSuccess,onError:handleDissasociationError})),hasVersionConflict&&external_kbnSharedDeps_React_default.a.createElement(ModalBodySection,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:VERSION_CONFLICT_ERROR_TITLE,color:"danger",iconType:"alert"},external_kbnSharedDeps_React_default.a.createElement("p",null,VERSION_CONFLICT_ERROR_DESCRIPTION))),null==updateError&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalFooter,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{"data-test-subj":"cancelExceptionAddButton",onClick:onCancel},translations_CANCEL),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{"data-test-subj":"edit-exception-confirm-button",onClick:onEditExceptionConfirm,isLoading:addExceptionIsLoading,isDisabled:isSubmitButtonDisabled,fill:!0},EDIT_EXCEPTION_SAVE_BUTTON)))}));var add_exception_modal=__webpack_require__(733);const viewer_initialState={filterOptions:{filter:"",tags:[]},pagination:{pageIndex:0,pageSize:20,totalItemCount:0,pageSizeOptions:[5,10,20,50,100,200,300]},exceptions:[],exceptionToEdit:null,loadingItemIds:[],isInitLoading:!0,currentModal:null,exceptionListTypeToEdit:null,totalEndpointItems:0,totalDetectionsItems:0,showEndpointListsOnly:!1,showDetectionsListsOnly:!1},ExceptionsViewerComponent=({ruleId:ruleId,ruleName:ruleName,ruleIndices:ruleIndices,exceptionListsMeta:exceptionListsMeta,availableListTypes:availableListTypes,commentsAccordionId:commentsAccordionId,onRuleChange:onRuleChange})=>{const{services:services}=Object(lib_kibana.h)(),[,dispatchToaster]=Object(toasters.h)(),onDispatchToaster=Object(external_kbnSharedDeps_React_.useCallback)(({title:title,color:color,iconType:iconType})=>()=>{dispatchToaster({type:"addToaster",toast:{id:uuid_default.a.v4(),title:title,color:color,iconType:iconType}})},[dispatchToaster]),[{exceptions:exceptions,filterOptions:filterOptions,pagination:pagination,loadingItemIds:loadingItemIds,isInitLoading:isInitLoading,currentModal:currentModal,exceptionToEdit:exceptionToEdit,exceptionListTypeToEdit:exceptionListTypeToEdit,totalEndpointItems:totalEndpointItems,totalDetectionsItems:totalDetectionsItems,showDetectionsListsOnly:showDetectionsListsOnly,showEndpointListsOnly:showEndpointListsOnly},dispatch]=Object(external_kbnSharedDeps_React_.useReducer)((state,action)=>{switch(action.type){case"setExceptions":{var _pagination$total;const{exceptions:exceptions,pagination:pagination}=action;return{...state,pagination:{...state.pagination,pageIndex:pagination.page-1,pageSize:pagination.perPage,totalItemCount:null!==(_pagination$total=pagination.total)&&void 0!==_pagination$total?_pagination$total:0},exceptions:exceptions}}case"updateFilterOptions":{const{filter:filter,pagination:pagination,showEndpointListsOnly:showEndpointListsOnly,showDetectionsListsOnly:showDetectionsListsOnly}=action.filters;return{...state,filterOptions:{...state.filterOptions,...filter},pagination:{...state.pagination,...pagination},showEndpointListsOnly:null!=showEndpointListsOnly?showEndpointListsOnly:state.showEndpointListsOnly,showDetectionsListsOnly:null!=showDetectionsListsOnly?showDetectionsListsOnly:state.showDetectionsListsOnly}}case"setExceptionItemTotals":return{...state,totalEndpointItems:null==action.totalEndpointItems?state.totalEndpointItems:action.totalEndpointItems,totalDetectionsItems:null==action.totalDetectionsItems?state.totalDetectionsItems:action.totalDetectionsItems};case"updateIsInitLoading":return{...state,isInitLoading:action.loading};case"updateLoadingItemIds":return{...state,loadingItemIds:[...state.loadingItemIds,...action.items]};case"updateExceptionToEdit":{const{exception:exception,lists:lists}=action,exceptionListToEdit=lists.find(list=>null!==list&&exception.list_id===list.listId);return{...state,exceptionToEdit:exception,exceptionListTypeToEdit:exceptionListToEdit?exceptionListToEdit.type:null}}case"updateModalOpen":return{...state,currentModal:action.modalName};case"updateExceptionListTypeToEdit":return{...state,exceptionListTypeToEdit:action.exceptionListType};default:return state}},{...viewer_initialState}),{deleteExceptionItem:deleteExceptionItem,getExceptionListsItems:getExceptionListsItems}=Object(lists_plugin_deps.h)(services.http),setExceptions=Object(external_kbnSharedDeps_React_.useCallback)(({exceptions:newExceptions,pagination:newPagination})=>{dispatch({type:"setExceptions",lists:exceptionListsMeta,exceptions:newExceptions,pagination:newPagination})},[dispatch,exceptionListsMeta]),[loadingList,,,fetchListItems]=Object(lists_plugin_deps.i)({http:services.http,lists:exceptionListsMeta,filterOptions:""!==filterOptions.filter||filterOptions.tags.length>0?[filterOptions]:[],pagination:{page:pagination.pageIndex+1,perPage:pagination.pageSize,total:pagination.totalItemCount},showDetectionsListsOnly:showDetectionsListsOnly,showEndpointListsOnly:showEndpointListsOnly,matchFilters:!0,onSuccess:setExceptions,onError:onDispatchToaster({color:"danger",title:exceptions_translations.z,iconType:"alert"})}),setCurrentModal=Object(external_kbnSharedDeps_React_.useCallback)(modalName=>{dispatch({type:"updateModalOpen",modalName:modalName})},[dispatch]),setExceptionItemTotals=Object(external_kbnSharedDeps_React_.useCallback)((endpointItemTotals,detectionItemTotals)=>{dispatch({type:"setExceptionItemTotals",totalEndpointItems:endpointItemTotals,totalDetectionsItems:detectionItemTotals})},[dispatch]),handleGetTotals=Object(external_kbnSharedDeps_React_.useCallback)(async()=>{await getExceptionListsItems({lists:exceptionListsMeta,filterOptions:[],pagination:{page:0,perPage:1,total:0},showDetectionsListsOnly:!0,showEndpointListsOnly:!1,onSuccess:({pagination:detectionPagination})=>{var _detectionPagination$;setExceptionItemTotals(null,null!==(_detectionPagination$=detectionPagination.total)&&void 0!==_detectionPagination$?_detectionPagination$:0)},onError:()=>{onDispatchToaster({color:"danger",title:exceptions_translations.I,iconType:"alert"})()}}),await getExceptionListsItems({lists:exceptionListsMeta,filterOptions:[],pagination:{page:0,perPage:1,total:0},showDetectionsListsOnly:!1,showEndpointListsOnly:!0,onSuccess:({pagination:endpointPagination})=>{var _endpointPagination$t;setExceptionItemTotals(null!==(_endpointPagination$t=endpointPagination.total)&&void 0!==_endpointPagination$t?_endpointPagination$t:0,null)},onError:()=>{onDispatchToaster({color:"danger",title:exceptions_translations.I,iconType:"alert"})()}})},[setExceptionItemTotals,exceptionListsMeta,getExceptionListsItems,onDispatchToaster]),handleFetchList=Object(external_kbnSharedDeps_React_.useCallback)(()=>{null!=fetchListItems&&(fetchListItems(),handleGetTotals())},[fetchListItems,handleGetTotals]),handleFilterChange=Object(external_kbnSharedDeps_React_.useCallback)(filters=>{dispatch({type:"updateFilterOptions",filters:filters})},[dispatch]),handleAddException=Object(external_kbnSharedDeps_React_.useCallback)(type=>{dispatch({type:"updateExceptionListTypeToEdit",exceptionListType:type}),setCurrentModal("addModal")},[setCurrentModal]),handleEditException=Object(external_kbnSharedDeps_React_.useCallback)(exception=>{dispatch({type:"updateExceptionToEdit",lists:exceptionListsMeta,exception:exception}),setCurrentModal("editModal")},[setCurrentModal,exceptionListsMeta]),handleOnCancelExceptionModal=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setCurrentModal(null),handleFetchList()},[setCurrentModal,handleFetchList]),handleOnConfirmExceptionModal=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setCurrentModal(null),handleFetchList()},[setCurrentModal,handleFetchList]),setLoadingItemIds=Object(external_kbnSharedDeps_React_.useCallback)(items=>{dispatch({type:"updateLoadingItemIds",items:items})},[dispatch]),handleDeleteException=Object(external_kbnSharedDeps_React_.useCallback)(({id:itemId,namespaceType:namespaceType})=>{setLoadingItemIds([{id:itemId,namespaceType:namespaceType}]),deleteExceptionItem({id:itemId,namespaceType:namespaceType,onSuccess:()=>{setLoadingItemIds(loadingItemIds.filter(({id:id})=>id!==itemId)),handleFetchList()},onError:()=>{onDispatchToaster({color:"danger",title:exceptions_translations.o,iconType:"alert"})(),setLoadingItemIds(loadingItemIds.filter(({id:id})=>id!==itemId))}})},[setLoadingItemIds,deleteExceptionItem,loadingItemIds,handleFetchList,onDispatchToaster]);Object(external_kbnSharedDeps_React_.useEffect)(()=>{!isInitLoading||loadingList||0!==exceptions.length&&null==exceptions||(handleGetTotals(),dispatch({type:"updateIsInitLoading",loading:!1}))},[handleGetTotals,isInitLoading,exceptions,loadingList,dispatch]);const ruleSettingsUrl=services.application.getUrlForApp(`security/detections/rules/id/${encodeURI(ruleId)}/edit`),showEmpty=!isInitLoading&&!loadingList&&0===totalEndpointItems&&0===totalDetectionsItems,showNoResults=0===exceptions.length&&(totalEndpointItems>0||totalDetectionsItems>0);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,"editModal"===currentModal&&null!=exceptionToEdit&&null!=exceptionListTypeToEdit&&external_kbnSharedDeps_React_default.a.createElement(edit_exception_modal_EditExceptionModal,{ruleName:ruleName,ruleId:ruleId,ruleIndices:ruleIndices,exceptionListType:exceptionListTypeToEdit,exceptionItem:exceptionToEdit,onCancel:handleOnCancelExceptionModal,onConfirm:handleOnConfirmExceptionModal,onRuleChange:onRuleChange}),"addModal"===currentModal&&null!=exceptionListTypeToEdit&&external_kbnSharedDeps_React_default.a.createElement(add_exception_modal.a,{ruleName:ruleName,ruleIndices:ruleIndices,ruleId:ruleId,exceptionListType:exceptionListTypeToEdit,onCancel:handleOnCancelExceptionModal,onConfirm:handleOnConfirmExceptionModal,onRuleChange:onRuleChange}),external_kbnSharedDeps_React_default.a.createElement(panel.a,{loading:isInitLoading||loadingList},(isInitLoading||loadingList)&&external_kbnSharedDeps_React_default.a.createElement(loader.a,{"data-test-subj":"loadingPanelAllRulesTable",overlay:!0,size:"xl"}),external_kbnSharedDeps_React_default.a.createElement(ExceptionsViewerHeader,{isInitLoading:isInitLoading,supportedListTypes:availableListTypes,detectionsListItems:totalDetectionsItems,endpointListItems:totalEndpointItems,onFilterChange:handleFilterChange,onAddExceptionClick:handleAddException}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(ExceptionsViewerUtility,{pagination:pagination,showEndpointListsOnly:showEndpointListsOnly,showDetectionsListsOnly:showDetectionsListsOnly,onRefreshClick:handleFetchList,ruleSettingsUrl:ruleSettingsUrl}),external_kbnSharedDeps_React_default.a.createElement(ExceptionsViewerItems,{showEmpty:showEmpty,showNoResults:showNoResults,isInitLoading:isInitLoading,exceptions:exceptions,loadingItemIds:loadingItemIds,commentsAccordionId:commentsAccordionId,onDeleteException:handleDeleteException,onEditExceptionItem:handleEditException}),external_kbnSharedDeps_React_default.a.createElement(ExceptionsViewerPagination,{onPaginationChange:handleFilterChange,pagination:pagination})))};ExceptionsViewerComponent.displayName="ExceptionsViewerComponent";const ExceptionsViewer=external_kbnSharedDeps_React_default.a.memo(ExceptionsViewerComponent);ExceptionsViewer.displayName="ExceptionsViewer";const details_StyledFullHeightContainer=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"StyledFullHeightContainer",componentId:"ycgey0-0"})(["display:flex;flex-direction:column;flex:1 1 auto;"]);var RuleDetailTabs;!function(RuleDetailTabs){RuleDetailTabs.alerts="alerts",RuleDetailTabs.failures="failures",RuleDetailTabs.exceptions="exceptions"}(RuleDetailTabs||(RuleDetailTabs={}));const RuleDetailsPageComponent=()=>{var _ruleStatus$current_s,_rule$name,_rule$id,_rule$enabled,_rule$name2,_rule$index;const dispatch=Object(react_redux_lib.useDispatch)(),containerElement=Object(external_kbnSharedDeps_React_.useRef)(null),getTimeline=Object(external_kbnSharedDeps_React_.useMemo)(()=>store_timeline.b.getTimelineByIdSelector(),[]),graphEventId=Object(use_selector.b)(state=>{var _getTimeline;return(null!==(_getTimeline=getTimeline(state,types_timeline.g.detectionsRulesDetailsPage))&&void 0!==_getTimeline?_getTimeline:defaults.a).graphEventId}),getGlobalFiltersQuerySelector=Object(external_kbnSharedDeps_React_.useMemo)(()=>inputs.d.globalFiltersQuerySelector(),[]),getGlobalQuerySelector=Object(external_kbnSharedDeps_React_.useMemo)(()=>inputs.d.globalQuerySelector(),[]),query=Object(use_selector.a)(getGlobalQuerySelector),filters=Object(use_selector.a)(getGlobalFiltersQuerySelector),{to:to,from:from,deleteQuery:deleteQuery,setQuery:setQuery}=Object(use_global_time.a)(),[{loading:userInfoLoading,isSignalIndexExists:isSignalIndexExists,isAuthenticated:isAuthenticated,hasEncryptionKey:hasEncryptionKey,canUserCRUD:canUserCRUD,hasIndexWrite:hasIndexWrite,hasIndexMaintenance:hasIndexMaintenance,signalIndexName:signalIndexName}]=Object(user_info.b)(),{loading:listsConfigLoading,needsConfiguration:needsListsConfiguration}=useListsConfig(),loading=userInfoLoading||listsConfigLoading,{detailName:ruleId}=Object(external_kbnSharedDeps_ReactRouterDom_.useParams)(),{rule:maybeRule,refresh:refreshRule,loading:ruleLoading}=Object(use_rule_async.a)(ruleId),[loadingStatus,ruleStatus,fetchRuleStatus]=useRuleStatus(ruleId),[currentStatus,setCurrentStatus]=Object(external_kbnSharedDeps_React_.useState)(null!==(_ruleStatus$current_s=null==ruleStatus?void 0:ruleStatus.current_status)&&void 0!==_ruleStatus$current_s?_ruleStatus$current_s:null);Object(external_kbnSharedDeps_React_.useEffect)(()=>{var _ruleStatus$current_s2;fast_deep_equal_default()(currentStatus,null==ruleStatus?void 0:ruleStatus.current_status)||setCurrentStatus(null!==(_ruleStatus$current_s2=null==ruleStatus?void 0:ruleStatus.current_status)&&void 0!==_ruleStatus$current_s2?_ruleStatus$current_s2:null)},[currentStatus,ruleStatus,setCurrentStatus]);const[rule,setRule]=Object(external_kbnSharedDeps_React_.useState)(null),isLoading=ruleLoading&&null==rule,[ruleEnabled,setRuleEnabled]=Object(external_kbnSharedDeps_React_.useState)(null),[ruleDetailTab,setRuleDetailTab]=Object(external_kbnSharedDeps_React_.useState)(RuleDetailTabs.alerts),{aboutRuleData:aboutRuleData,modifiedAboutRuleDetailsData:modifiedAboutRuleDetailsData,defineRuleData:defineRuleData,scheduleRuleData:scheduleRuleData}=null!=rule?getStepsData({rule:rule,detailsView:!0}):{aboutRuleData:null,modifiedAboutRuleDetailsData:null,defineRuleData:null,scheduleRuleData:null},[lastAlerts]=useAlertInfo({ruleId:ruleId}),[showBuildingBlockAlerts,setShowBuildingBlockAlerts]=Object(external_kbnSharedDeps_React_.useState)(!1),[showOnlyThreatIndicatorAlerts,setShowOnlyThreatIndicatorAlerts]=Object(external_kbnSharedDeps_React_.useState)(!1),mlCapabilities=Object(use_ml_capabilities.a)(),history=Object(external_kbnSharedDeps_ReactRouterDom_.useHistory)(),{formatUrl:formatUrl}=Object(link_to.o)(app_types.a.detections),{globalFullScreen:globalFullScreen}=Object(use_full_screen.a)(),hasMlPermissions=Object(has_ml_license.a)(mlCapabilities)&&Object(has_ml_admin_permissions.a)(mlCapabilities),ruleDetailTabs=[{id:RuleDetailTabs.alerts,name:detection_engine_translations.a,disabled:!1,dataTestSubj:"alertsTab"},{id:RuleDetailTabs.exceptions,name:EXCEPTIONS_TAB,disabled:!1,dataTestSubj:"exceptionsTab"},{id:RuleDetailTabs.failures,name:FAILURE_HISTORY_TAB,disabled:!1,dataTestSubj:"failureHistoryTab"}],{services:{application:{capabilities:{actions:actions}}}}=Object(lib_kibana.h)(),hasActionsPrivileges=Object(external_kbnSharedDeps_React_.useMemo)(()=>!(null!=(null==rule?void 0:rule.actions)&&(null==rule?void 0:rule.actions.length)>0&&isBoolean(actions.show))||actions.show,[actions,null==rule?void 0:rule.actions]);Object(external_kbnSharedDeps_React_.useEffect)(()=>{null!=maybeRule&&setRule(maybeRule)},[maybeRule]);const title=null!==(_rule$name=null==rule?void 0:rule.name)&&void 0!==_rule$name?_rule$name:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingSpinner,{size:"m"}),subTitle=Object(external_kbnSharedDeps_React_.useMemo)(()=>{var _rule$created_by,_rule$created_at,_rule$updated_by,_rule$updated_at;return null==rule?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingSpinner,{size:"m"}):[external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.ruleDetails.ruleCreationDescription",defaultMessage:"Created by: {by} on {date}",values:{by:null!==(_rule$created_by=null==rule?void 0:rule.created_by)&&void 0!==_rule$created_by?_rule$created_by:UNKNOWN,date:external_kbnSharedDeps_React_default.a.createElement(formatted_date.a,{value:null!==(_rule$created_at=null==rule?void 0:rule.created_at)&&void 0!==_rule$created_at?_rule$created_at:(new Date).toISOString(),fieldName:"createdAt"})}}),null!=(null==rule?void 0:rule.updated_by)?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.ruleDetails.ruleUpdateDescription",defaultMessage:"Updated by: {by} on {date}",values:{by:null!==(_rule$updated_by=null==rule?void 0:rule.updated_by)&&void 0!==_rule$updated_by?_rule$updated_by:UNKNOWN,date:external_kbnSharedDeps_React_default.a.createElement(formatted_date.a,{value:null!==(_rule$updated_at=null==rule?void 0:rule.updated_at)&&void 0!==_rule$updated_at?_rule$updated_at:(new Date).toISOString(),fieldName:"updatedAt"})}}):""]},[rule]);Object(external_kbnSharedDeps_React_.useEffect)(()=>{setShowBuildingBlockAlerts(null!=(null==rule?void 0:rule.building_block_type))},[rule]);const alertDefaultFilters=Object(external_kbnSharedDeps_React_.useMemo)(()=>[...Object(default_config.d)(ruleId),...Object(default_config.e)(showBuildingBlockAlerts),...Object(default_config.f)(showOnlyThreatIndicatorAlerts)],[ruleId,showBuildingBlockAlerts,showOnlyThreatIndicatorAlerts]),alertMergedFilters=Object(external_kbnSharedDeps_React_.useMemo)(()=>[...alertDefaultFilters,...filters],[alertDefaultFilters,filters]),tabs=Object(external_kbnSharedDeps_React_.useMemo)(()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTabs,null,ruleDetailTabs.map(tab=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTab,{onClick:()=>setRuleDetailTab(tab.id),isSelected:tab.id===ruleDetailTab,disabled:tab.disabled,key:tab.id,"data-test-subj":tab.dataTestSubj},tab.name))),[ruleDetailTabs,ruleDetailTab,setRuleDetailTab]),handleRefresh=Object(external_kbnSharedDeps_React_.useCallback)(()=>{null!=fetchRuleStatus&&null!=ruleId&&fetchRuleStatus(ruleId)},[fetchRuleStatus,ruleId]),ruleStatusInfo=Object(external_kbnSharedDeps_React_.useMemo)(()=>loadingStatus?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingSpinner,{size:"m","data-test-subj":"rule-status-loader"})):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(RuleStatus,{status:Object(utils.a)(null==currentStatus?void 0:currentStatus.status),statusDate:null==currentStatus?void 0:currentStatus.status_date},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{"data-test-subj":"refreshButton",color:"primary",onClick:handleRefresh,iconType:"refresh","aria-label":rules_translations.ib}))),[currentStatus,loadingStatus,handleRefresh]),ruleError=Object(external_kbnSharedDeps_React_.useMemo)(()=>{return loadingStatus?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingSpinner,{size:"m","data-test-subj":"rule-status-loader"})):"failed"===(null==currentStatus?void 0:currentStatus.status)&&ruleDetailTab===RuleDetailTabs.alerts&&null!=(null==currentStatus?void 0:currentStatus.last_failure_at)?external_kbnSharedDeps_React_default.a.createElement(RuleStatusFailedCallOut,{message:null!==(_currentStatus$last_f=null==currentStatus?void 0:currentStatus.last_failure_message)&&void 0!==_currentStatus$last_f?_currentStatus$last_f:"",date:null==currentStatus?void 0:currentStatus.last_failure_at}):"warning"!==(null==currentStatus?void 0:currentStatus.status)&&"partial failure"!==(null==currentStatus?void 0:currentStatus.status)||ruleDetailTab!==RuleDetailTabs.alerts||null==(null==currentStatus?void 0:currentStatus.last_success_at)?null:external_kbnSharedDeps_React_default.a.createElement(RuleStatusFailedCallOut,{message:null!==(_currentStatus$last_s=null==currentStatus?void 0:currentStatus.last_success_message)&&void 0!==_currentStatus$last_s?_currentStatus$last_s:"",date:null==currentStatus?void 0:currentStatus.last_success_at,color:"warning"});var _currentStatus$last_f,_currentStatus$last_s},[ruleDetailTab,currentStatus,loadingStatus]),updateDateRangeCallback=Object(external_kbnSharedDeps_React_.useCallback)(({x:x})=>{if(!x)return;const[min,max]=x;dispatch(Object(inputs_actions.setAbsoluteRangeDatePicker)({id:"global",from:new Date(min).toISOString(),to:new Date(max).toISOString()}))},[dispatch]),handleOnChangeEnabledRule=Object(external_kbnSharedDeps_React_.useCallback)(enabled=>{null!=ruleEnabled&&enabled===ruleEnabled||setRuleEnabled(enabled)},[ruleEnabled,setRuleEnabled]),goToEditRule=Object(external_kbnSharedDeps_React_.useCallback)(ev=>{ev.preventDefault(),history.push(Object(redirect_to_detection_engine.d)(null!=ruleId?ruleId:""))},[history,ruleId]),editRule=Object(external_kbnSharedDeps_React_.useMemo)(()=>{var _userHasNoPermissions;return hasActionsPrivileges?external_kbnSharedDeps_React_default.a.createElement(links.g,{onClick:goToEditRule,iconType:"controlsHorizontal",isDisabled:null===(_userHasNoPermissions=helpers_userHasNoPermissions(canUserCRUD))||void 0===_userHasNoPermissions||_userHasNoPermissions,href:formatUrl(Object(redirect_to_detection_engine.d)(null!=ruleId?ruleId:""))},rules_translations.P):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{position:"top",content:rules_translations.Q},external_kbnSharedDeps_React_default.a.createElement(links.g,{onClick:goToEditRule,iconType:"controlsHorizontal",isDisabled:!0,href:formatUrl(Object(redirect_to_detection_engine.d)(null!=ruleId?ruleId:""))},rules_translations.P))},[canUserCRUD,formatUrl,goToEditRule,hasActionsPrivileges,ruleId]),onShowBuildingBlockAlertsChangedCallback=Object(external_kbnSharedDeps_React_.useCallback)(newShowBuildingBlockAlerts=>{setShowBuildingBlockAlerts(newShowBuildingBlockAlerts)},[setShowBuildingBlockAlerts]),onShowOnlyThreatIndicatorAlertsCallback=Object(external_kbnSharedDeps_React_.useCallback)(newShowOnlyThreatIndicatorAlerts=>{setShowOnlyThreatIndicatorAlerts(newShowOnlyThreatIndicatorAlerts)},[setShowOnlyThreatIndicatorAlerts]),{indicesExist:indicesExist,indexPattern:indexPattern}=Object(sourcerer.b)(model.SourcererScopeName.detections),exceptionLists=Object(external_kbnSharedDeps_React_.useMemo)(()=>null!=rule&&null!=rule.exceptions_list?rule.exceptions_list.reduce((acc,{id:id,list_id:listId,namespace_type:namespaceType,type:type})=>{const{allowedExceptionListTypes:allowedExceptionListTypes,lists:lists}=acc;return{lists:[...lists,{id:id,listId:listId,namespaceType:namespaceType,type:type}],allowedExceptionListTypes:type===shared_imports.c.ENDPOINT&&!allowedExceptionListTypes.includes(shared_imports.c.ENDPOINT)?[...allowedExceptionListTypes,shared_imports.c.ENDPOINT]:allowedExceptionListTypes}},{lists:[],allowedExceptionListTypes:[shared_imports.c.DETECTION]}):{lists:[],allowedExceptionListTypes:[shared_imports.c.DETECTION]},[rule]),onSkipFocusBeforeEventsTable=Object(external_kbnSharedDeps_React_.useCallback)(()=>{Object(timeline_helpers.m)(containerElement.current)},[containerElement]),onSkipFocusAfterEventsTable=Object(external_kbnSharedDeps_React_.useCallback)(()=>{Object(timeline_helpers.o)()},[]),onKeyDown=Object(external_kbnSharedDeps_React_.useCallback)(keyboardEvent=>{Object(accessibility_helpers.r)(keyboardEvent)&&Object(timeline_helpers.n)({containerElement:containerElement.current,keyboardEvent:keyboardEvent,onSkipFocusBeforeEventsTable:onSkipFocusBeforeEventsTable,onSkipFocusAfterEventsTable:onSkipFocusAfterEventsTable})},[containerElement,onSkipFocusBeforeEventsTable,onSkipFocusAfterEventsTable]);if(redirectToDetections(isSignalIndexExists,isAuthenticated,hasEncryptionKey,needsListsConfiguration))return history.replace(Object(redirect_to_detection_engine.c)()),null;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(NeedAdminForUpdateRulesCallOut,null),external_kbnSharedDeps_React_default.a.createElement(ReadOnlyAlertsCallOut,null),external_kbnSharedDeps_React_default.a.createElement(ReadOnlyRulesCallOut,null),indicesExist?external_kbnSharedDeps_React_default.a.createElement(details_StyledFullHeightContainer,{onKeyDown:onKeyDown,ref:containerElement},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiWindowEvent,{event:"resize",handler:external_kbnSharedDeps_LodashFp_.noop}),external_kbnSharedDeps_React_default.a.createElement(filters_global.a,{show:Object(timeline_helpers.q)({globalFullScreen:globalFullScreen,graphEventId:graphEventId})},external_kbnSharedDeps_React_default.a.createElement(search_bar.a,{id:"global",indexPattern:indexPattern})),external_kbnSharedDeps_React_default.a.createElement(wrapper_page.a,{noPadding:globalFullScreen},external_kbnSharedDeps_React_default.a.createElement(Display,{show:!globalFullScreen},external_kbnSharedDeps_React_default.a.createElement(DetectionEngineHeaderPage,{backOptions:{href:Object(redirect_to_detection_engine.f)(),text:translations_BACK_TO_RULES,pageId:app_types.a.detections,dataTestSubj:"ruleDetailsBackToAllRules"},border:!0,subtitle:subTitle,subtitle2:[...null!=lastAlerts?[external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,detection_engine_translations.e,": ",lastAlerts)]:[],external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"xs",alignItems:"center",justifyContent:"flexStart"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},STATUS,":"),ruleStatusInfo))],title:title},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{position:"top",content:getToolTipContent(rule,hasMlPermissions,hasActionsPrivileges)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(RuleSwitch,{id:null!==(_rule$id=null==rule?void 0:rule.id)&&void 0!==_rule$id?_rule$id:"-1",isDisabled:!canEditRuleWithActions(rule,hasActionsPrivileges)||helpers_userHasNoPermissions(canUserCRUD)||!hasMlPermissions&&!(null!=rule&&rule.enabled),enabled:null!==(_rule$enabled=null==rule?void 0:rule.enabled)&&void 0!==_rule$enabled&&_rule$enabled,onChange:handleOnChangeEnabledRule}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,ACTIVATED_RULE)))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},editRule),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(RuleActionsOverflow,{rule:rule,userHasNoPermissions:helpers_userHasNoPermissions(canUserCRUD),canDuplicateRuleWithActions:canEditRuleWithActions(rule,hasActionsPrivileges)})))))),ruleError,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{"data-test-subj":"aboutRule",component:"section",grow:1},external_kbnSharedDeps_React_default.a.createElement(StepAboutRuleToggleDetails,{loading:isLoading,stepData:aboutRuleData,stepDataDetails:modifiedAboutRuleDetailsData})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"column"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{component:"section",grow:1},external_kbnSharedDeps_React_default.a.createElement(StepPanel,{loading:isLoading,title:rules_translations.I},null!=defineRuleData&&external_kbnSharedDeps_React_default.a.createElement(StepDefineRule,{descriptionColumns:"singleSplit",isReadOnlyView:!0,isLoading:!1,defaultValues:defineRuleData}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{"data-test-subj":"schedule",component:"section",grow:1},external_kbnSharedDeps_React_default.a.createElement(StepPanel,{loading:isLoading,title:rules_translations.qb},null!=scheduleRuleData&&external_kbnSharedDeps_React_default.a.createElement(StepScheduleRule,{descriptionColumns:"singleSplit",isReadOnlyView:!0,isLoading:!1,defaultValues:scheduleRuleData})))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),tabs,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null)),ruleDetailTab===RuleDetailTabs.alerts&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(Display,{show:!globalFullScreen},external_kbnSharedDeps_React_default.a.createElement(alerts_histogram_panel.a,{deleteQuery:deleteQuery,filters:alertMergedFilters,query:query,from:from,signalIndexName:signalIndexName,setQuery:setQuery,stackByOptions:alerts_histogram_panel_config.a,defaultStackByOption:{text:"event.category",value:"event.category"},to:to,updateDateRange:updateDateRangeCallback}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null)),null!=ruleId&&external_kbnSharedDeps_React_default.a.createElement(AlertsTable,{timelineId:types_timeline.g.detectionsRulesDetailsPage,defaultFilters:alertDefaultFilters,hasIndexWrite:null!=hasIndexWrite&&hasIndexWrite,hasIndexMaintenance:null!=hasIndexMaintenance&&hasIndexMaintenance,from:from,loading:loading,showBuildingBlockAlerts:showBuildingBlockAlerts,showOnlyThreatIndicatorAlerts:showOnlyThreatIndicatorAlerts,onShowBuildingBlockAlertsChanged:onShowBuildingBlockAlertsChangedCallback,onShowOnlyThreatIndicatorAlertsChanged:onShowOnlyThreatIndicatorAlertsCallback,onRuleChange:refreshRule,to:to})),ruleDetailTab===RuleDetailTabs.exceptions&&external_kbnSharedDeps_React_default.a.createElement(ExceptionsViewer,{ruleId:null!=ruleId?ruleId:"",ruleName:null!==(_rule$name2=null==rule?void 0:rule.name)&&void 0!==_rule$name2?_rule$name2:"",ruleIndices:null!==(_rule$index=null==rule?void 0:rule.index)&&void 0!==_rule$index?_rule$index:constants.v,availableListTypes:exceptionLists.allowedExceptionListTypes,commentsAccordionId:"ruleDetailsTabExceptions",exceptionListsMeta:exceptionLists.lists,onRuleChange:refreshRule}),ruleDetailTab===RuleDetailTabs.failures&&external_kbnSharedDeps_React_default.a.createElement(FailureHistory,{id:null==rule?void 0:rule.id}))):external_kbnSharedDeps_React_default.a.createElement(wrapper_page.a,null,external_kbnSharedDeps_React_default.a.createElement(DetectionEngineHeaderPage,{border:!0,title:details_translations_PAGE_TITLE}),external_kbnSharedDeps_React_default.a.createElement(overview_empty.a,null)),external_kbnSharedDeps_React_default.a.createElement(spy_routes.a,{pageName:app_types.a.detections,state:{ruleName:null==rule?void 0:rule.name}}))};RuleDetailsPageComponent.displayName="RuleDetailsPageComponent";const RuleDetailsPage=external_kbnSharedDeps_React_default.a.memo(RuleDetailsPageComponent);RuleDetailsPage.displayName="RuleDetailsPage";const PRE_BUILT_TITLE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.rules.prePackagedRules.emptyPromptTitle",{defaultMessage:"Load Elastic prebuilt detection rules"}),PRE_BUILT_MSG=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.rules.prePackagedRules.emptyPromptMessage",{defaultMessage:"Elastic Security comes with prebuilt detection rules that run in the background and create alerts when their conditions are met. By default, all prebuilt rules except the Endpoint Security rule are disabled. You can select additional rules you want to activate."}),CREATE_RULE_ACTION=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.rules.prePackagedRules.createOwnRuletButton",{defaultMessage:"Create your own rules"}),UPDATE_PREPACKAGED_RULES_TITLE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.rules.updatePrePackagedRulesTitle",{defaultMessage:"Update available for Elastic prebuilt rules or timeline templates"}),UPDATE_PREPACKAGED_RULES_MSG=updateRules=>external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.rules.updatePrePackagedRulesMsg",{values:{updateRules:updateRules},defaultMessage:"You can update {updateRules} Elastic prebuilt {updateRules, plural, =1 {rule} other {rules}}"}),UPDATE_PREPACKAGED_RULES_AND_TIMELINES_MSG=(updateRules,updateTimelines)=>external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.rules.updatePrePackagedRulesAndTimelinesMsg",{values:{updateRules:updateRules,updateTimelines:updateTimelines},defaultMessage:"You can update {updateRules} Elastic prebuilt {updateRules, plural, =1 {rule} other {rules}} and {updateTimelines} Elastic prebuilt {updateTimelines, plural, =1 {timeline} other {timelines}}. Note that this will reload deleted Elastic prebuilt rules."}),UPDATE_PREPACKAGED_RULES=updateRules=>external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.rules.updatePrePackagedRulesButton",{values:{updateRules:updateRules},defaultMessage:"Update {updateRules} Elastic prebuilt {updateRules, plural, =1 {rule} other {rules}}"}),UPDATE_PREPACKAGED_TIMELINES=updateTimelines=>external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.rules.updatePrePackagedTimelinesButton",{values:{updateTimelines:updateTimelines},defaultMessage:"Update {updateTimelines} Elastic prebuilt {updateTimelines, plural, =1 {timeline} other {timelines}}"}),UPDATE_PREPACKAGED_RULES_AND_TIMELINES=(updateRules,updateTimelines)=>external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.rules.updatePrePackagedRulesAndTimelinesButton",{values:{updateRules:updateRules,updateTimelines:updateTimelines},defaultMessage:"Update {updateRules} Elastic prebuilt {updateRules, plural, =1 {rule} other {rules}} and {updateTimelines} Elastic prebuilt {updateTimelines, plural, =1 {timeline} other {timelines}}"}),RELEASE_NOTES_HELP=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.rules.releaseNotesHelp",{defaultMessage:"Release notes"}),EmptyPrompt=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiEmptyPrompt).withConfig({displayName:"EmptyPrompt",componentId:"sc-1rs1rob-0"})(["align-self:center;"]);EmptyPrompt.displayName="EmptyPrompt";const PrePackagedRulesPromptComponent=({createPrePackagedRules:createPrePackagedRules,loading:loading=!1,userHasNoPermissions:userHasNoPermissions=!0})=>{const history=Object(external_kbnSharedDeps_ReactRouterDom_.useHistory)(),handlePreBuiltCreation=Object(external_kbnSharedDeps_React_.useCallback)(()=>{createPrePackagedRules()},[createPrePackagedRules]),{formatUrl:formatUrl}=Object(link_to.o)(app_types.a.detections),goToCreateRule=Object(external_kbnSharedDeps_React_.useCallback)(ev=>{ev.preventDefault(),history.push(Object(redirect_to_detection_engine.a)())},[history]),[{isSignalIndexExists:isSignalIndexExists,isAuthenticated:isAuthenticated,hasEncryptionKey:hasEncryptionKey,canUserCRUD:canUserCRUD,hasIndexWrite:hasIndexWrite}]=Object(user_info.b)(),{getLoadPrebuiltRulesAndTemplatesButton:getLoadPrebuiltRulesAndTemplatesButton}=usePrePackagedRules({canUserCRUD:canUserCRUD,hasIndexWrite:hasIndexWrite,isSignalIndexExists:isSignalIndexExists,isAuthenticated:isAuthenticated,hasEncryptionKey:hasEncryptionKey}),loadPrebuiltRulesAndTemplatesButton=Object(external_kbnSharedDeps_React_.useMemo)(()=>getLoadPrebuiltRulesAndTemplatesButton({isDisabled:userHasNoPermissions,onClick:handlePreBuiltCreation,fill:!0,"data-test-subj":"load-prebuilt-rules"}),[getLoadPrebuiltRulesAndTemplatesButton,handlePreBuiltCreation,userHasNoPermissions]);return external_kbnSharedDeps_React_default.a.createElement(EmptyPrompt,{title:external_kbnSharedDeps_React_default.a.createElement("h2",null,PRE_BUILT_TITLE),body:external_kbnSharedDeps_React_default.a.createElement("p",null,PRE_BUILT_MSG),actions:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},loadPrebuiltRulesAndTemplatesButton),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(links.g,{isDisabled:userHasNoPermissions,onClick:goToCreateRule,href:formatUrl(Object(redirect_to_detection_engine.a)()),iconType:"plusInCircle"},CREATE_RULE_ACTION)))})},PrePackagedRulesPrompt=Object(external_kbnSharedDeps_React_.memo)(PrePackagedRulesPromptComponent),all_rules_tables_emptyPrompt=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiEmptyPrompt,{title:external_kbnSharedDeps_React_default.a.createElement("h3",null,rules_translations.cb),titleSize:"xs",body:rules_translations.db}),AllRulesTablesComponent=({euiBasicTableSelectionProps:euiBasicTableSelectionProps,hasNoPermissions:hasNoPermissions,monitoringColumns:monitoringColumns,pagination:pagination,rules:rules,rulesColumns:rulesColumns,rulesStatuses:rulesStatuses,sorting:sorting,tableOnChangeCallback:tableOnChangeCallback,tableRef:tableRef,selectedTab:selectedTab})=>{var _hasNoPermissions,_hasNoPermissions2;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,selectedTab===AllRulesTabs.rules&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBasicTable,{"data-test-subj":"rules-table",columns:rulesColumns,isSelectable:null!==(_hasNoPermissions=!hasNoPermissions)&&void 0!==_hasNoPermissions&&_hasNoPermissions,itemId:"id",items:null!=rules?rules:[],noItemsMessage:all_rules_tables_emptyPrompt,onChange:tableOnChangeCallback,pagination:pagination,ref:tableRef,sorting:sorting,selection:hasNoPermissions?void 0:euiBasicTableSelectionProps}),selectedTab===AllRulesTabs.monitoring&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBasicTable,{"data-test-subj":"monitoring-table",columns:monitoringColumns,isSelectable:null!==(_hasNoPermissions2=!hasNoPermissions)&&void 0!==_hasNoPermissions2&&_hasNoPermissions2,itemId:"id",items:rulesStatuses,noItemsMessage:all_rules_tables_emptyPrompt,onChange:tableOnChangeCallback,pagination:pagination}))},AllRulesTables=Object(external_kbnSharedDeps_React_.memo)(AllRulesTablesComponent);var localized_date_tooltip=__webpack_require__(344);const TagWrapper=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiBadgeGroup).withConfig({displayName:"TagWrapper",componentId:"dbczeh-0"})(["width:100%;"]),TagPopoverWrapper=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiBadgeGroup).withConfig({displayName:"TagPopoverWrapper",componentId:"dbczeh-1"})(["max-height:200px;max-width:600px;overflow:auto;"]),TagPopoverButton=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty).withConfig({displayName:"TagPopoverButton",componentId:"dbczeh-2"})(["font-size:"," font-weight:500;height:20px;"],({theme:theme})=>theme.eui.euiFontSizeXS),TagsDisplayComponent=({tags:tags})=>{const[isTagPopoverOpen,setIsTagPopoverOpen]=Object(external_kbnSharedDeps_React_.useState)(!1),sortedTags=Object(external_kbnSharedDeps_React_.useMemo)(()=>caseInsensitiveSort(tags),[tags]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,sortedTags.length<=3?external_kbnSharedDeps_React_default.a.createElement(TagWrapper,{"data-test-subj":"tags"},sortedTags.map((tag,i)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBadge,{color:"hollow",key:`${tag}-${i}`,"data-test-subj":"rules-table-column-tags-"+i},tag))):external_kbnSharedDeps_React_default.a.createElement(TagWrapper,{"data-test-subj":"tags"},sortedTags.slice(0,3).map((tag,i)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBadge,{color:"hollow",key:`${tag}-${i}`,"data-test-subj":"rules-table-column-tags-"+i},tag)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopover,{ownFocus:!0,display:"block","data-test-subj":"tags-display-popover",button:external_kbnSharedDeps_React_default.a.createElement(TagPopoverButton,{size:"xs","data-test-subj":"tags-display-popover-button",onClick:()=>setIsTagPopoverOpen(!isTagPopoverOpen)},rules_translations.B),isOpen:isTagPopoverOpen,closePopover:()=>setIsTagPopoverOpen(!isTagPopoverOpen),repositionOnScroll:!0},external_kbnSharedDeps_React_default.a.createElement(TagPopoverWrapper,null,sortedTags.map((tag,i)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBadge,{color:"hollow",key:`${tag}-${i}`,"data-test-subj":"rules-table-column-popover-tags-"+i,title:tag},tag))))))},TagsDisplay=external_kbnSharedDeps_React_default.a.memo(TagsDisplayComponent);TagsDisplay.displayName="TagsDisplay";const getActions=(dispatch,dispatchToaster,history,reFetchRules,refetchPrePackagedRulesStatus,actionsPrivileges)=>[{"data-test-subj":"editRuleAction",description:rules_translations.P,name:actionsPrivileges?rules_translations.P:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{position:"left",content:rules_translations.Q},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,rules_translations.P)),icon:"controlsHorizontal",onClick:rowItem=>editRuleAction(rowItem,history),enabled:rowItem=>canEditRuleWithActions(rowItem,actionsPrivileges)},{"data-test-subj":"duplicateRuleAction",description:rules_translations.M,icon:"copy",name:actionsPrivileges?rules_translations.M:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{position:"left",content:rules_translations.Q},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,rules_translations.M)),enabled:rowItem=>canEditRuleWithActions(rowItem,actionsPrivileges),onClick:async rowItem=>{const createdRules=await duplicateRulesAction([rowItem],[rowItem.id],dispatch,dispatchToaster);null!=createdRules&&createdRules.length&&editRuleAction(createdRules[0],history)}},{"data-test-subj":"exportRuleAction",description:rules_translations.U,icon:"exportAction",name:rules_translations.U,onClick:rowItem=>exportRulesAction([rowItem.rule_id],dispatch),enabled:rowItem=>!rowItem.immutable},{"data-test-subj":"deleteRuleAction",description:rules_translations.K,icon:"trash",name:rules_translations.K,onClick:async rowItem=>{await deleteRulesAction([rowItem.id],dispatch,dispatchToaster),await reFetchRules(),await refetchPrePackagedRulesStatus()}}];var toggle_selected_group=__webpack_require__(692);const PopoverContentWrapper=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"PopoverContentWrapper",componentId:"sc-1c6dnvx-0"})(["width:275px;"]),ScrollableDiv=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"ScrollableDiv",componentId:"sc-1c6dnvx-1"})(["max-height:250px;overflow-y:auto;"]),TagOverflowContainer=external_kbnSharedDeps_StyledComponents_default.a.span.withConfig({displayName:"TagOverflowContainer",componentId:"sc-1c6dnvx-2"})(["overflow:hidden;text-overflow:ellipsis;white-space:nowrap;"]),TagsFilterPopoverComponent=({tags:tags,selectedTags:selectedTags,onSelectedTagsChanged:onSelectedTagsChanged,currentFilterTags:currentFilterTags})=>{const sortedTags=Object(external_kbnSharedDeps_React_.useMemo)(()=>caseInsensitiveSort(Array.from(new Set([...tags,...currentFilterTags]))),[tags,currentFilterTags]),[isTagPopoverOpen,setIsTagPopoverOpen]=Object(external_kbnSharedDeps_React_.useState)(!1),[searchInput,setSearchInput]=Object(external_kbnSharedDeps_React_.useState)(""),[filterTags,setFilterTags]=Object(external_kbnSharedDeps_React_.useState)(sortedTags),tagsComponent=Object(external_kbnSharedDeps_React_.useMemo)(()=>filterTags.map((tag,index)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFilterSelectItem,{checked:selectedTags.includes(tag)?"on":void 0,key:`${index}-${tag}`,onClick:()=>Object(toggle_selected_group.a)(tag,selectedTags,onSelectedTagsChanged),title:tag},external_kbnSharedDeps_React_default.a.createElement(TagOverflowContainer,null,tag))),[onSelectedTagsChanged,selectedTags,filterTags]),onSearchInputChange=Object(external_kbnSharedDeps_React_.useCallback)(event=>{setSearchInput(event.target.value)},[]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{setFilterTags(sortedTags.filter(tag=>tag.toLowerCase().includes(searchInput.toLowerCase())))},[sortedTags,searchInput]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopover,{ownFocus:!0,button:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFilterButton,{"data-test-subj":"tags-filter-popover-button",iconType:"arrowDown",onClick:()=>setIsTagPopoverOpen(!isTagPopoverOpen),isSelected:isTagPopoverOpen,hasActiveFilters:selectedTags.length>0,numActiveFilters:selectedTags.length},rules_translations.Bb),isOpen:isTagPopoverOpen,closePopover:()=>setIsTagPopoverOpen(!isTagPopoverOpen),panelPaddingSize:"none",repositionOnScroll:!0},external_kbnSharedDeps_React_default.a.createElement(PopoverContentWrapper,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopoverTitle,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldSearch,{placeholder:"Search tags",value:searchInput,onChange:onSearchInputChange,isClearable:!0,"aria-label":"Rules tag search"})),external_kbnSharedDeps_React_default.a.createElement(ScrollableDiv,null,tagsComponent),0===filterTags.length&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"m",justifyContent:"spaceAround"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPanel,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,rules_translations.eb))))))};TagsFilterPopoverComponent.displayName="TagsFilterPopoverComponent";const TagsFilterPopover=external_kbnSharedDeps_React_default.a.memo(TagsFilterPopoverComponent);TagsFilterPopover.displayName="TagsFilterPopover";const RulesTableFiltersComponent=({onFilterChanged:onFilterChanged,rulesCustomInstalled:rulesCustomInstalled,rulesInstalled:rulesInstalled,currentFilterTags:currentFilterTags})=>{const[filter,setFilter]=Object(external_kbnSharedDeps_React_.useState)(""),[selectedTags,setSelectedTags]=Object(external_kbnSharedDeps_React_.useState)([]),[showCustomRules,setShowCustomRules]=Object(external_kbnSharedDeps_React_.useState)(!1),[showElasticRules,setShowElasticRules]=Object(external_kbnSharedDeps_React_.useState)(!1),[isLoadingTags,tags,reFetchTags]=(()=>{const[tags,setTags]=Object(external_kbnSharedDeps_React_.useState)([]),[loading,setLoading]=Object(external_kbnSharedDeps_React_.useState)(!0),reFetchTags=Object(external_kbnSharedDeps_React_.useRef)(external_kbnSharedDeps_LodashFp_.noop),{addError:addError}=Object(use_app_toasts.a)();return Object(external_kbnSharedDeps_React_.useEffect)(()=>{let isSubscribed=!0;const abortCtrl=new AbortController,fetchData=async()=>{setLoading(!0);try{const fetchTagsResult=await Object(api.i)({signal:abortCtrl.signal});isSubscribed&&setTags(fetchTagsResult)}catch(error){isSubscribed&&addError(error,{title:translations.l})}isSubscribed&&setLoading(!1)};return fetchData(),reFetchTags.current=fetchData,()=>{isSubscribed=!1,abortCtrl.abort()}},[addError]),[loading,tags,reFetchTags.current]})();Object(external_kbnSharedDeps_React_.useEffect)(()=>{reFetchTags()},[rulesCustomInstalled,rulesInstalled]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{onFilterChanged({filter:filter,showCustomRules:showCustomRules,showElasticRules:showElasticRules,tags:selectedTags})},[filter,selectedTags,showCustomRules,showElasticRules,onFilterChanged]);const handleOnSearch=Object(external_kbnSharedDeps_React_.useCallback)(filterString=>setFilter(filterString.trim()),[setFilter]),handleElasticRulesClick=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setShowElasticRules(!showElasticRules),setShowCustomRules(!1)},[setShowElasticRules,showElasticRules,setShowCustomRules]),handleCustomRulesClick=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setShowCustomRules(!showCustomRules),setShowElasticRules(!1)},[setShowElasticRules,showCustomRules,setShowCustomRules]),handleSelectedTags=Object(external_kbnSharedDeps_React_.useCallback)(newTags=>{Object(external_kbnSharedDeps_LodashFp_.isEqual)(newTags,selectedTags)||setSelectedTags(newTags)},[selectedTags]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"m",justifyContent:"flexEnd"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldSearch,{"aria-label":rules_translations.tb,fullWidth:!0,incremental:!1,placeholder:rules_translations.sb,onSearch:handleOnSearch})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFilterGroup,null,external_kbnSharedDeps_React_default.a.createElement(TagsFilterPopover,{isLoading:isLoadingTags,onSelectedTagsChanged:handleSelectedTags,selectedTags:selectedTags,tags:tags,currentFilterTags:currentFilterTags,"data-test-subj":"allRulesTagPopover"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFilterGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFilterButton,{hasActiveFilters:showElasticRules,onClick:handleElasticRulesClick,"data-test-subj":"showElasticRulesFilterButton",withNext:!0},rules_translations.R,null!=rulesInstalled?` (${rulesInstalled})`:""),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFilterButton,{hasActiveFilters:showCustomRules,onClick:handleCustomRulesClick,"data-test-subj":"showCustomRulesFilterButton"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,rules_translations.G,null!=rulesCustomInstalled?` (${rulesCustomInstalled})`:"")))))};RulesTableFiltersComponent.displayName="RulesTableFiltersComponent";const RulesTableFilters=external_kbnSharedDeps_React_default.a.memo(RulesTableFiltersComponent);RulesTableFilters.displayName="RulesTableFilters";const AllRulesUtilityBar=external_kbnSharedDeps_React_default.a.memo(({userHasNoPermissions:userHasNoPermissions,onRefresh:onRefresh,paginationTotal:paginationTotal,numberSelectedItems:numberSelectedItems,onGetBatchItemsPopoverContent:onGetBatchItemsPopoverContent,isAutoRefreshOn:isAutoRefreshOn,showBulkActions:showBulkActions=!0,onRefreshSwitch:onRefreshSwitch})=>{const handleGetBatchItemsPopoverContent=Object(external_kbnSharedDeps_React_.useCallback)(closePopover=>null!=onGetBatchItemsPopoverContent?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenuPanel,{items:onGetBatchItemsPopoverContent(closePopover)}):null,[onGetBatchItemsPopoverContent]),handleAutoRefreshSwitch=Object(external_kbnSharedDeps_React_.useCallback)(closePopover=>e=>{null!=onRefreshSwitch&&(onRefreshSwitch(e.target.checked),closePopover())},[onRefreshSwitch]),handleGetRefreshSettingsPopoverContent=Object(external_kbnSharedDeps_React_.useCallback)(closePopover=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenuPanel,{items:[external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSwitch,{key:"allRulesAutoRefreshSwitch",label:rules_translations.mb,checked:null!=isAutoRefreshOn&&isAutoRefreshOn,onChange:handleAutoRefreshSwitch(closePopover),compressed:!0,"data-test-subj":"refreshSettingsSwitch"})]}),[isAutoRefreshOn,handleAutoRefreshSwitch]);return external_kbnSharedDeps_React_default.a.createElement(utility_bar.a,null,external_kbnSharedDeps_React_default.a.createElement(utility_bar.d,null,external_kbnSharedDeps_React_default.a.createElement(utility_bar.c,null,showBulkActions?external_kbnSharedDeps_React_default.a.createElement(utility_bar.f,{dataTestSubj:"showingRules"},rules_translations.xb(paginationTotal)):external_kbnSharedDeps_React_default.a.createElement(utility_bar.f,{dataTestSubj:"showingExceptionLists"},rules_translations.wb(paginationTotal))),showBulkActions?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(utility_bar.c,{"data-test-subj":"tableBulkActions"},external_kbnSharedDeps_React_default.a.createElement(utility_bar.f,{dataTestSubj:"selectedRules"},rules_translations.ub(numberSelectedItems)),!userHasNoPermissions&&external_kbnSharedDeps_React_default.a.createElement(utility_bar.b,{dataTestSubj:"bulkActions",iconSide:"right",iconType:"arrowDown",popoverContent:handleGetBatchItemsPopoverContent},rules_translations.i),external_kbnSharedDeps_React_default.a.createElement(utility_bar.b,{dataTestSubj:"refreshRulesAction",iconSide:"left",iconType:"refresh",onClick:onRefresh},rules_translations.ib),external_kbnSharedDeps_React_default.a.createElement(utility_bar.b,{dataTestSubj:"refreshSettings",iconSide:"right",iconType:"arrowDown",popoverContent:handleGetRefreshSettingsPopoverContent},rules_translations.nb))):external_kbnSharedDeps_React_default.a.createElement(utility_bar.c,null,external_kbnSharedDeps_React_default.a.createElement(utility_bar.b,{dataTestSubj:"refreshRulesAction",iconSide:"left",iconType:"refresh",onClick:onRefresh},rules_translations.ib))))});AllRulesUtilityBar.displayName="AllRulesUtilityBar";var last_updated=__webpack_require__(506);const RulesTables=external_kbnSharedDeps_React_default.a.memo(({history:history,formatUrl:formatUrl,createPrePackagedRules:createPrePackagedRules,hasNoPermissions:hasNoPermissions,loading:loading,loadingCreatePrePackagedRules:loadingCreatePrePackagedRules,refetchPrePackagedRulesStatus:refetchPrePackagedRulesStatus,rulesCustomInstalled:rulesCustomInstalled,rulesInstalled:rulesInstalled,rulesNotInstalled:rulesNotInstalled,rulesNotUpdated:rulesNotUpdated,setRefreshRulesData:setRefreshRulesData,selectedTab:selectedTab})=>{var _pagination$total;const[initLoading,setInitLoading]=Object(external_kbnSharedDeps_React_.useState)(!0),{services:{application:{capabilities:{actions:actions}}}}=Object(lib_kibana.h)(),tableRef=Object(external_kbnSharedDeps_React_.useRef)(null),[defaultAutoRefreshSetting]=Object(lib_kibana.l)(constants.C),rulesTable=useRulesTable({tableRef:tableRef,initialStateOverride:{isRefreshOn:defaultAutoRefreshSetting.on}}),{exportRuleIds:exportRuleIds,filterOptions:filterOptions,loadingRuleIds:loadingRuleIds,loadingRulesAction:loadingRulesAction,pagination:pagination,rules:rules,selectedRuleIds:selectedRuleIds,lastUpdated:lastUpdated,showIdleModal:showIdleModal,isRefreshOn:isRefreshOn,isRefreshing:isRefreshing}=rulesTable.state,{dispatch:dispatch,updateOptions:updateOptions,actionStopped:actionStopped,setShowIdleModal:setShowIdleModal,setLastRefreshDate:setLastRefreshDate,setAutoRefreshOn:setAutoRefreshOn,setIsRefreshing:setIsRefreshing,reFetchRules:reFetchRules}=rulesTable,{loading:isLoadingRulesStatuses,rulesStatuses:rulesStatuses}=useRulesStatuses(rules),[,dispatchToaster]=Object(toasters.h)(),mlCapabilities=Object(use_ml_capabilities.a)(),hasMlPermissions=Object(has_ml_license.a)(mlCapabilities)&&Object(has_ml_admin_permissions.a)(mlCapabilities),isLoadingRules="load"===loadingRulesAction,isLoadingAnActionOnRule=Object(external_kbnSharedDeps_React_.useMemo)(()=>(!(loadingRuleIds.length>0)||"disable"!==loadingRulesAction&&"enable"!==loadingRulesAction)&&loadingRuleIds.length>0,[loadingRuleIds,loadingRulesAction]),sorting=Object(external_kbnSharedDeps_React_.useMemo)(()=>({sort:{field:filterOptions.sortField,direction:filterOptions.sortOrder}}),[filterOptions]),prePackagedRuleStatus=getPrePackagedRuleStatus(rulesInstalled,rulesNotInstalled,rulesNotUpdated),hasActionsPrivileges=Object(external_kbnSharedDeps_React_.useMemo)(()=>!isBoolean(actions.show)||actions.show,[actions]),getBatchItemsPopoverContent=Object(external_kbnSharedDeps_React_.useCallback)(closePopover=>(({closePopover:closePopover,dispatch:dispatch,dispatchToaster:dispatchToaster,hasMlPermissions:hasMlPermissions,loadingRuleIds:loadingRuleIds,reFetchRules:reFetchRules,refetchPrePackagedRulesStatus:refetchPrePackagedRulesStatus,rules:rules,selectedRuleIds:selectedRuleIds,hasActionsPrivileges:hasActionsPrivileges})=>{const selectedRules=selectedRuleIds.reduce((acc,id)=>{const found=rules.find(r=>r.id===id);return null!=found?{[id]:found,...acc}:acc},{}),containsEnabled=selectedRuleIds.some(id=>{var _selectedRules$id$ena,_selectedRules$id;return null!==(_selectedRules$id$ena=null===(_selectedRules$id=selectedRules[id])||void 0===_selectedRules$id?void 0:_selectedRules$id.enabled)&&void 0!==_selectedRules$id$ena&&_selectedRules$id$ena}),containsDisabled=selectedRuleIds.some(id=>{var _selectedRules$id$ena2,_selectedRules$id2;return null!==(_selectedRules$id$ena2=!(null!==(_selectedRules$id2=selectedRules[id])&&void 0!==_selectedRules$id2&&_selectedRules$id2.enabled))&&void 0!==_selectedRules$id$ena2&&_selectedRules$id$ena2}),containsLoading=selectedRuleIds.some(id=>loadingRuleIds.includes(id)),containsImmutable=selectedRuleIds.some(id=>{var _selectedRules$id$imm,_selectedRules$id3;return null!==(_selectedRules$id$imm=null===(_selectedRules$id3=selectedRules[id])||void 0===_selectedRules$id3?void 0:_selectedRules$id3.immutable)&&void 0!==_selectedRules$id$imm&&_selectedRules$id$imm}),missingActionPrivileges=!hasActionsPrivileges&&selectedRuleIds.some(id=>!canEditRuleWithActions(selectedRules[id],hasActionsPrivileges));return[external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenuItem,{key:rules_translations.j,icon:"checkInCircleFilled",disabled:missingActionPrivileges||containsLoading||!containsDisabled,onClick:async()=>{closePopover();const deactivatedIds=selectedRuleIds.filter(id=>{var _selectedRules$id$ena3,_selectedRules$id4;return null!==(_selectedRules$id$ena3=!(null!==(_selectedRules$id4=selectedRules[id])&&void 0!==_selectedRules$id4&&_selectedRules$id4.enabled))&&void 0!==_selectedRules$id$ena3&&_selectedRules$id$ena3}),deactivatedIdsNoML=deactivatedIds.filter(id=>{var _selectedRules$id5;return!Object(helpers.d)(null===(_selectedRules$id5=selectedRules[id])||void 0===_selectedRules$id5?void 0:_selectedRules$id5.type)}),mlRuleCount=deactivatedIds.length-deactivatedIdsNoML.length;!hasMlPermissions&&mlRuleCount>0&&Object(toasters.f)(detection_engine_translations.g(mlRuleCount),dispatchToaster),await enableRulesAction(hasMlPermissions?deactivatedIds:deactivatedIdsNoML,!0,dispatch,dispatchToaster)}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{position:"right",content:missingActionPrivileges?rules_translations.Q:void 0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,rules_translations.j))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenuItem,{key:rules_translations.l,icon:"crossInACircleFilled",disabled:missingActionPrivileges||containsLoading||!containsEnabled,onClick:async()=>{closePopover();const activatedIds=selectedRuleIds.filter(id=>{var _selectedRules$id$ena4,_selectedRules$id6;return null!==(_selectedRules$id$ena4=null===(_selectedRules$id6=selectedRules[id])||void 0===_selectedRules$id6?void 0:_selectedRules$id6.enabled)&&void 0!==_selectedRules$id$ena4&&_selectedRules$id$ena4});await enableRulesAction(activatedIds,!1,dispatch,dispatchToaster)}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{position:"right",content:missingActionPrivileges?rules_translations.Q:void 0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,rules_translations.l))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenuItem,{key:rules_translations.r,icon:"exportAction",disabled:containsImmutable||containsLoading||0===selectedRuleIds.length,onClick:()=>{closePopover(),exportRulesAction(rules.filter(r=>selectedRuleIds.includes(r.id)).map(r=>r.rule_id),dispatch)}},rules_translations.r),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenuItem,{key:rules_translations.q,"data-test-subj":"duplicateRuleBulk",icon:"copy",disabled:missingActionPrivileges||containsLoading||0===selectedRuleIds.length,onClick:async()=>{closePopover(),await duplicateRulesAction(rules.filter(r=>selectedRuleIds.includes(r.id)),selectedRuleIds,dispatch,dispatchToaster),await reFetchRules(),await refetchPrePackagedRulesStatus()}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{position:"right",content:missingActionPrivileges?rules_translations.Q:void 0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,rules_translations.q))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenuItem,{"data-test-subj":"deleteRuleBulk",key:rules_translations.n,icon:"trash",title:containsImmutable?rules_translations.p:void 0,disabled:containsLoading||0===selectedRuleIds.length,onClick:async()=>{closePopover(),await deleteRulesAction(selectedRuleIds,dispatch,dispatchToaster),await reFetchRules(),await refetchPrePackagedRulesStatus()}},rules_translations.n)]})({closePopover:closePopover,dispatch:dispatch,dispatchToaster:dispatchToaster,hasMlPermissions:hasMlPermissions,hasActionsPrivileges:hasActionsPrivileges,loadingRuleIds:loadingRuleIds,selectedRuleIds:selectedRuleIds,reFetchRules:reFetchRules,refetchPrePackagedRulesStatus:refetchPrePackagedRulesStatus,rules:rules}),[dispatch,dispatchToaster,hasMlPermissions,loadingRuleIds,reFetchRules,refetchPrePackagedRulesStatus,rules,selectedRuleIds,hasActionsPrivileges]),paginationMemo=Object(external_kbnSharedDeps_React_.useMemo)(()=>({pageIndex:pagination.page-1,pageSize:pagination.perPage,totalItemCount:pagination.total,pageSizeOptions:[5,10,20,50,100,200,300,400,500,600]}),[pagination]),onFilterChangedCallback=Object(external_kbnSharedDeps_React_.useCallback)(newFilter=>{updateOptions(newFilter,{page:1})},[updateOptions]),tableOnChangeCallback=Object(external_kbnSharedDeps_React_.useCallback)(({page:page,sort:sort})=>{var _ref,_sort$direction;updateOptions({sortField:null!==(_ref=null==sort?void 0:sort.field)&&void 0!==_ref?_ref:"enabled",sortOrder:null!==(_sort$direction=null==sort?void 0:sort.direction)&&void 0!==_sort$direction?_sort$direction:"desc"},{page:page.index+1,perPage:page.size}),setLastRefreshDate()},[updateOptions,setLastRefreshDate]),rulesColumns=Object(external_kbnSharedDeps_React_.useMemo)(()=>(({dispatch:dispatch,dispatchToaster:dispatchToaster,formatUrl:formatUrl,history:history,hasMlPermissions:hasMlPermissions,hasNoPermissions:hasNoPermissions,loadingRuleIds:loadingRuleIds,reFetchRules:reFetchRules,refetchPrePackagedRulesStatus:refetchPrePackagedRulesStatus,hasReadActionsPrivileges:hasReadActionsPrivileges})=>{const cols=[{field:"name",name:rules_translations.A,render:(value,item)=>external_kbnSharedDeps_React_default.a.createElement(links.f,{"data-test-subj":"ruleName",onClick:ev=>{ev.preventDefault(),history.push(Object(redirect_to_detection_engine.e)(item.id))},href:formatUrl(Object(redirect_to_detection_engine.e)(item.id))},value),truncateText:!0,width:"20%",sortable:!0},{field:"risk_score",name:rules_translations.z,render:value=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{"data-test-subj":"riskScore",size:"s"},value),truncateText:!0,width:"10%"},{field:"severity",name:rules_translations.C,render:value=>external_kbnSharedDeps_React_default.a.createElement(SeverityBadge,{value:value}),truncateText:!0,width:"12%"},{field:"status_date",name:rules_translations.v,render:value=>null==value?Object(empty_value.d)():external_kbnSharedDeps_React_default.a.createElement(localized_date_tooltip.a,{fieldName:rules_translations.v,date:new Date(value)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedRelative,{value:value})),truncateText:!0,width:"14%"},{field:"status",name:rules_translations.w,render:value=>{var _getRuleStatusText;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHealth,{color:getStatusColor(null!=value?value:null)},null!==(_getRuleStatusText=Object(utils.a)(value))&&void 0!==_getRuleStatusText?_getRuleStatusText:Object(empty_value.d)()))},width:"12%",truncateText:!0},{field:"updated_at",name:rules_translations.x,render:value=>null==value?Object(empty_value.d)():external_kbnSharedDeps_React_default.a.createElement(localized_date_tooltip.a,{fieldName:rules_translations.x,date:new Date(value)},external_kbnSharedDeps_React_default.a.createElement(formatted_date.a,{value:value,fieldName:"last rule update date"})),sortable:!0,truncateText:!0,width:"14%"},{field:"version",name:rules_translations.E,render:value=>null==value?Object(empty_value.d)():external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{"data-test-subj":"version",size:"s"},value),truncateText:!0,width:"8%"},{field:"tags",name:rules_translations.D,render:value=>value.length>0?external_kbnSharedDeps_React_default.a.createElement(TagsDisplay,{tags:value}):Object(empty_value.d)(),truncateText:!0,width:"20%"},{align:"center",field:"enabled",name:rules_translations.s,render:(value,item)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{position:"top",content:getToolTipContent(item,hasMlPermissions,hasReadActionsPrivileges)},external_kbnSharedDeps_React_default.a.createElement(RuleSwitch,{"data-test-subj":"enabled",dispatch:dispatch,id:item.id,enabled:item.enabled,isDisabled:!canEditRuleWithActions(item,hasReadActionsPrivileges)||hasNoPermissions||Object(helpers.d)(item.type)&&!hasMlPermissions&&!item.enabled,isLoading:loadingRuleIds.includes(item.id)})),sortable:!0,width:"95px"}],actions=[{actions:getActions(dispatch,dispatchToaster,history,reFetchRules,refetchPrePackagedRulesStatus,hasReadActionsPrivileges),width:"40px"}];return hasNoPermissions?cols:[...cols,...actions]})({dispatch:dispatch,dispatchToaster:dispatchToaster,formatUrl:formatUrl,history:history,hasMlPermissions:hasMlPermissions,hasNoPermissions:hasNoPermissions,loadingRuleIds:null==loadingRulesAction||"enable"!==loadingRulesAction&&"disable"!==loadingRulesAction?[]:loadingRuleIds,reFetchRules:reFetchRules,refetchPrePackagedRulesStatus:refetchPrePackagedRulesStatus,hasReadActionsPrivileges:hasActionsPrivileges}),[dispatch,dispatchToaster,formatUrl,refetchPrePackagedRulesStatus,hasActionsPrivileges,hasNoPermissions,hasMlPermissions,history,loadingRuleIds,loadingRulesAction,reFetchRules]),monitoringColumns=Object(external_kbnSharedDeps_React_.useMemo)(()=>((history,formatUrl)=>[{field:"name",name:rules_translations.A,render:(value,item)=>external_kbnSharedDeps_React_default.a.createElement(links.f,{"data-test-subj":"ruleName",onClick:ev=>{ev.preventDefault(),history.push(Object(redirect_to_detection_engine.e)(item.id))},href:formatUrl(Object(redirect_to_detection_engine.e)(item.id))},"partial failure"===value?"warning":value),truncateText:!0,width:"24%"},{field:"current_status.bulk_create_time_durations",name:rules_translations.u,render:value=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{"data-test-subj":"bulk_create_time_durations",size:"s"},null!=value&&value.length>0?Math.max(...null==value?void 0:value.map(item=>Number.parseFloat(item))):Object(empty_value.d)()),truncateText:!0,width:"14%"},{field:"current_status.search_after_time_durations",name:rules_translations.y,render:value=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{"data-test-subj":"search_after_time_durations",size:"s"},null!=value&&value.length>0?Math.max(...null==value?void 0:value.map(item=>Number.parseFloat(item))):Object(empty_value.d)()),truncateText:!0,width:"14%"},{field:"current_status.gap",name:rules_translations.t,render:value=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{"data-test-subj":"gap",size:"s"},null!=value?value:Object(empty_value.d)()),truncateText:!0,width:"14%"},{field:"current_status.status_date",name:rules_translations.v,render:value=>null==value?Object(empty_value.d)():external_kbnSharedDeps_React_default.a.createElement(localized_date_tooltip.a,{fieldName:rules_translations.v,date:new Date(value)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedRelative,{value:value})),truncateText:!0,width:"20%"},{field:"current_status.status",name:rules_translations.w,render:value=>{var _getRuleStatusText2;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHealth,{color:getStatusColor(null!=value?value:null)},null!==(_getRuleStatusText2=Object(utils.a)(value))&&void 0!==_getRuleStatusText2?_getRuleStatusText2:Object(empty_value.d)()))},width:"16%",truncateText:!0},{field:"activate",name:rules_translations.s,render:value=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{"data-test-subj":"search_after_time_durations",size:"s"},value?rules_translations.d:rules_translations.Z),width:"95px"}])(history,formatUrl),[history,formatUrl]);Object(external_kbnSharedDeps_React_.useEffect)(()=>{setRefreshRulesData(reFetchRules)},[reFetchRules,setRefreshRulesData]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{!initLoading||loading||isLoadingRules||isLoadingRulesStatuses||setInitLoading(!1)},[initLoading,loading,isLoadingRules,isLoadingRulesStatuses]);const handleCreatePrePackagedRules=Object(external_kbnSharedDeps_React_.useCallback)(async()=>{null!=createPrePackagedRules&&(await createPrePackagedRules(),await reFetchRules(),await refetchPrePackagedRulesStatus())},[createPrePackagedRules,reFetchRules,refetchPrePackagedRulesStatus]),euiBasicTableSelectionProps=Object(external_kbnSharedDeps_React_.useMemo)(()=>({selectable:item=>!loadingRuleIds.includes(item.id),onSelectionChange:selected=>dispatch({type:"selectedRuleIds",ids:selected.map(r=>r.id)})}),[loadingRuleIds,dispatch]),refreshTable=Object(external_kbnSharedDeps_React_.useCallback)(async(mode="manual")=>{if(isLoadingAnActionOnRule)return;const isAutoRefresh="auto"===mode;isAutoRefresh&&setIsRefreshing(!0),await reFetchRules(),await refetchPrePackagedRulesStatus(),setLastRefreshDate(),isAutoRefresh&&setIsRefreshing(!1)},[isLoadingAnActionOnRule,setIsRefreshing,reFetchRules,refetchPrePackagedRulesStatus,setLastRefreshDate]),handleAutoRefresh=Object(external_kbnSharedDeps_React_.useCallback)(async()=>{await refreshTable("auto")},[refreshTable]),handleManualRefresh=Object(external_kbnSharedDeps_React_.useCallback)(async()=>{await refreshTable()},[refreshTable]),handleResetIdleTimer=Object(external_kbnSharedDeps_React_.useCallback)(()=>{isRefreshOn&&(setShowIdleModal(!0),setAutoRefreshOn(!1))},[setShowIdleModal,setAutoRefreshOn,isRefreshOn]),debounceResetIdleTimer=Object(external_kbnSharedDeps_React_.useMemo)(()=>Object(external_kbnSharedDeps_LodashFp_.debounce)(defaultAutoRefreshSetting.idleTimeout,handleResetIdleTimer),[handleResetIdleTimer,defaultAutoRefreshSetting.idleTimeout]);Object(external_kbnSharedDeps_React_.useEffect)(()=>{const interval=setInterval(()=>{isRefreshOn&&handleAutoRefresh()},defaultAutoRefreshSetting.value);return()=>{clearInterval(interval)}},[isRefreshOn,handleAutoRefresh,defaultAutoRefreshSetting.value]);const handleIdleModalContinue=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setShowIdleModal(!1),handleAutoRefresh(),setAutoRefreshOn(!0)},[setShowIdleModal,setAutoRefreshOn,handleAutoRefresh]),handleAutoRefreshSwitch=Object(external_kbnSharedDeps_React_.useCallback)(refreshOn=>{refreshOn&&handleAutoRefresh(),setAutoRefreshOn(refreshOn)},[setAutoRefreshOn,handleAutoRefresh]),shouldShowRulesTable=Object(external_kbnSharedDeps_React_.useMemo)(()=>(({rulesCustomInstalled:rulesCustomInstalled,rulesInstalled:rulesInstalled})=>null!=rulesCustomInstalled&&rulesCustomInstalled>0||null!=rulesInstalled&&rulesInstalled>0)({rulesCustomInstalled:rulesCustomInstalled,rulesInstalled:rulesInstalled})&&!initLoading,[initLoading,rulesCustomInstalled,rulesInstalled]),shouldShowPrepackagedRulesPrompt=Object(external_kbnSharedDeps_React_.useMemo)(()=>null!=rulesCustomInstalled&&0===rulesCustomInstalled&&"ruleNotInstalled"===prePackagedRuleStatus&&!initLoading,[initLoading,prePackagedRuleStatus,rulesCustomInstalled]),handleGenericDownloaderSuccess=Object(external_kbnSharedDeps_React_.useCallback)(exportCount=>{actionStopped(),dispatchToaster({type:"addToaster",toast:{id:uuid_default.a.v4(),title:rules_translations.zb(exportCount),color:"success",iconType:"check"}})},[actionStopped,dispatchToaster]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiWindowEvent,{event:"mousemove",handler:debounceResetIdleTimer}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiWindowEvent,{event:"mousedown",handler:debounceResetIdleTimer}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiWindowEvent,{event:"click",handler:debounceResetIdleTimer}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiWindowEvent,{event:"keydown",handler:debounceResetIdleTimer}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiWindowEvent,{event:"scroll",handler:debounceResetIdleTimer}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiWindowEvent,{event:"load",handler:debounceResetIdleTimer}),external_kbnSharedDeps_React_default.a.createElement(generic_downloader.a,{filename:rules_translations.T+".ndjson",ids:exportRuleIds,onExportSuccess:handleGenericDownloaderSuccess,exportSelectedData:api.f}),external_kbnSharedDeps_React_default.a.createElement(panel.a,{loading:loading||isLoadingRules||isLoadingRulesStatuses,"data-test-subj":"allRulesPanel"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,!initLoading&&(loading||isLoadingRules||isLoadingAnActionOnRule)&&isRefreshing&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiProgress,{"data-test-subj":"loadingRulesInfoProgress",size:"xs",position:"absolute",color:"accent"}),external_kbnSharedDeps_React_default.a.createElement(header_section.a,{split:!0,growLeftSplit:!1,title:rules_translations.g,subtitle:external_kbnSharedDeps_React_default.a.createElement(last_updated.a,{showUpdating:loading||isLoadingRules||isLoadingRulesStatuses,updatedAt:lastUpdated})},shouldShowRulesTable&&external_kbnSharedDeps_React_default.a.createElement(RulesTableFilters,{onFilterChanged:onFilterChangedCallback,rulesCustomInstalled:rulesCustomInstalled,rulesInstalled:rulesInstalled,currentFilterTags:filterOptions.tags})),!initLoading&&(loading||isLoadingRules||isLoadingAnActionOnRule)&&!isRefreshing&&external_kbnSharedDeps_React_default.a.createElement(loader.a,{"data-test-subj":"loadingPanelAllRulesTable",overlay:!0,size:"xl"}),shouldShowPrepackagedRulesPrompt&&external_kbnSharedDeps_React_default.a.createElement(PrePackagedRulesPrompt,{createPrePackagedRules:handleCreatePrePackagedRules,loading:loadingCreatePrePackagedRules,userHasNoPermissions:hasNoPermissions}),initLoading&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingContent,{"data-test-subj":"initialLoadingPanelAllRulesTable",lines:10}),showIdleModal&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiConfirmModal,{title:rules_translations.lb,onCancel:handleIdleModalContinue,onConfirm:handleIdleModalContinue,confirmButtonText:rules_translations.kb,defaultFocusedButton:"confirm","data-test-subj":"allRulesIdleModal"},external_kbnSharedDeps_React_default.a.createElement("p",null,rules_translations.jb)),shouldShowRulesTable&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(AllRulesUtilityBar,{userHasNoPermissions:hasNoPermissions,paginationTotal:null!==(_pagination$total=pagination.total)&&void 0!==_pagination$total?_pagination$total:0,numberSelectedItems:selectedRuleIds.length,onGetBatchItemsPopoverContent:getBatchItemsPopoverContent,onRefresh:handleManualRefresh,isAutoRefreshOn:isRefreshOn,onRefreshSwitch:handleAutoRefreshSwitch,showBulkActions:!0}),external_kbnSharedDeps_React_default.a.createElement(AllRulesTables,{selectedTab:selectedTab,euiBasicTableSelectionProps:euiBasicTableSelectionProps,hasNoPermissions:hasNoPermissions,monitoringColumns:monitoringColumns,pagination:paginationMemo,rules:rules,rulesColumns:rulesColumns,rulesStatuses:rulesStatuses,sorting:sorting,tableOnChangeCallback:tableOnChangeCallback,tableRef:tableRef})))))});RulesTables.displayName="RulesTables";const InvisibleAnchor=external_kbnSharedDeps_StyledComponents_default.a.a.withConfig({displayName:"InvisibleAnchor",componentId:"bxvucm-0"})(["display:none;"]),AutoDownload=({blob:blob,name:name,onDownload:onDownload})=>{const anchorRef=Object(external_kbnSharedDeps_React_.useRef)(null);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{if(blob&&null!=anchorRef&&anchorRef.current){if("function"==typeof window.navigator.msSaveOrOpenBlob)window.navigator.msSaveBlob(blob);else{const objectURL=window.URL.createObjectURL(blob);anchorRef.current.href=objectURL,anchorRef.current.download=null!=name?name:"download.txt",anchorRef.current.click(),window.URL.revokeObjectURL(objectURL)}onDownload&&onDownload()}},[blob,name,onDownload]),external_kbnSharedDeps_React_default.a.createElement(InvisibleAnchor,{ref:anchorRef})},EXCEPTION_LIST_ID_TITLE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.idTitle",{defaultMessage:"List ID"}),EXCEPTION_LIST_NAME=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.listName",{defaultMessage:"Name"}),NUMBER_RULES_ASSIGNED_TO_TITLE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.numberRulesAssignedTitle",{defaultMessage:"Number of rules assigned to"}),RULES_ASSIGNED_TO_TITLE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.rulesAssignedTitle",{defaultMessage:"Rules assigned to"}),LIST_DATE_CREATED_TITLE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.dateCreatedTitle",{defaultMessage:"Date created"}),LIST_DATE_UPDATED_TITLE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.dateUpdatedTitle",{defaultMessage:"Last edited"}),ERROR_EXCEPTION_LISTS=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.errorFetching",{defaultMessage:"Error fetching exception lists"}),NO_EXCEPTION_LISTS=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.rules.allExceptionLists.filters.noExceptionsTitle",{defaultMessage:"No exception lists found"}),EXCEPTIONS_LISTS_SEARCH_PLACEHOLDER=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.rules.allExceptionLists.search.placeholder",{defaultMessage:"Search exception lists"}),ALL_EXCEPTIONS=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.rules.allExceptions.tableTitle",{defaultMessage:"Exception Lists"}),NO_LISTS_BODY=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.rules.allExceptions.filters.noListsBody",{defaultMessage:"We weren't able to find any exception lists."}),EXCEPTION_EXPORT_ERROR=(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.exportSuccess",{defaultMessage:"Exception list export success"}),external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.exportError",{defaultMessage:"Exception list export error"})),EXCEPTION_DELETE_ERROR=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.deleteError",{defaultMessage:"Error occurred deleting exception list"}),exceptionDeleteSuccessMessage=listId=>external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.exceptions.referenceModalSuccessDescription",{defaultMessage:"Exception list - {listId} - deleted successfully.",values:{listId:listId}}),REFERENCE_MODAL_TITLE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.exceptions.referenceModalTitle",{defaultMessage:"Remove exception list"}),REFERENCE_MODAL_CANCEL_BUTTON=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.exceptions.referenceModalCancelButton",{defaultMessage:"Cancel"}),REFERENCE_MODAL_CONFIRM_BUTTON=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.exceptions.referenceModalDeleteButton",{defaultMessage:"Remove exception list"}),EXCEPTION_LIST_SEARCH_PLACEHOLDER=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.exceptions.searchPlaceholder",{defaultMessage:"e.g. Example List Name"});var page=__webpack_require__(158);const MarkdownContainer=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"MarkdownContainer",componentId:"sc-1c9tzb5-0"})(["max-height:200px;overflow-y:auto;&::-webkit-scrollbar{height:",";width:",";}&::-webkit-scrollbar-thumb{background-clip:content-box;background-color:",";border:"," solid transparent;}&::-webkit-scrollbar-corner,&::-webkit-scrollbar-track{background-color:transparent;}"],({theme:theme})=>theme.eui.euiScrollBar,({theme:theme})=>theme.eui.euiScrollBar,({theme:theme})=>Object(polished_lib.rgba)(theme.eui.euiColorDarkShade,.5),({theme:theme})=>theme.eui.euiScrollBarCorner),ReferenceErrorModalComponent=({cancelText:cancelText,confirmText:confirmText,contentText:contentText,onClose:onClose,onCancel:onCancel,onConfirm:onConfirm,references:references=[],showModal:showModal,titleText:titleText})=>showModal?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiConfirmModal,{maxWidth:460,title:titleText,onCancel:onCancel,onConfirm:onConfirm,cancelButtonText:cancelText,confirmButtonText:confirmText,buttonColor:"danger",defaultFocusedButton:"confirm","data-test-subj":"referenceErrorModal"},external_kbnSharedDeps_React_default.a.createElement("p",null,contentText),external_kbnSharedDeps_React_default.a.createElement(MarkdownContainer,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiListGroup,{gutterSize:"none",showToolTips:!0},references.map((r,index)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiListGroupItem,{key:`${index}-${r}`,label:r}))))):null;ReferenceErrorModalComponent.displayName="ReferenceErrorModalComponent";const ReferenceErrorModal=external_kbnSharedDeps_React_default.a.memo(ReferenceErrorModalComponent);ReferenceErrorModal.displayName="ReferenceErrorModal";const EXCEPTIONS_SEARCH_SCHEMA={strict:!0,fields:{created_by:{type:"string"},name:{type:"string"},type:{type:"string"},list_id:{type:"string"},tags:{type:"string"}}},ExceptionsSearchBar=external_kbnSharedDeps_React_default.a.memo(({onSearch:onSearch})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSearchBar,{"data-test-subj":"exceptionsHeaderSearch","aria-label":EXCEPTIONS_LISTS_SEARCH_PLACEHOLDER,onChange:onSearch,box:{placeholder:EXCEPTION_LIST_SEARCH_PLACEHOLDER,incremental:!1,schema:EXCEPTIONS_SEARCH_SCHEMA}}));ExceptionsSearchBar.displayName="ExceptionsSearchBar";const exceptionReferenceModalInitialState={contentText:"",rulesReferences:[],isLoading:!1,listId:"",listNamespaceType:"single"},ExceptionListsTable=external_kbnSharedDeps_React_default.a.memo(({formatUrl:formatUrl,history:history,hasNoPermissions:hasNoPermissions,loading:loading})=>{var _exceptionListsWithRu,_hasNoPermissions;const{services:{http:http,notifications:notifications}}=Object(lib_kibana.h)(),{exportExceptionList:exportExceptionList,deleteExceptionList:deleteExceptionList}=Object(shared_imports.A)(http),[showReferenceErrorModal,setShowReferenceErrorModal]=Object(external_kbnSharedDeps_React_.useState)(!1),[referenceModalState,setReferenceModalState]=Object(external_kbnSharedDeps_React_.useState)(exceptionReferenceModalInitialState),[filters,setFilters]=Object(external_kbnSharedDeps_React_.useState)(void 0),[loadingExceptions,exceptions,pagination,refreshExceptions]=Object(shared_imports.G)({errorMessage:ERROR_EXCEPTION_LISTS,filterOptions:filters,http:http,namespaceTypes:["single","agnostic"],notifications:notifications,showTrustedApps:!1}),[loadingTableInfo,exceptionListsWithRuleRefs,exceptionsListsRef]=(({exceptionLists:exceptionLists})=>{const[loading,setLoading]=Object(external_kbnSharedDeps_React_.useState)(!0),[exceptions,setExceptions]=Object(external_kbnSharedDeps_React_.useState)([]),[exceptionsListsInfo,setExceptionsListInfo]=Object(external_kbnSharedDeps_React_.useState)({}),handleExceptionsInfo=Object(external_kbnSharedDeps_React_.useCallback)(rules=>{const listsSkeleton=exceptionLists.reduce((acc,{id:id,...rest})=>(acc[id]={...rest,id:id,rules:[]},acc),{});return rules.reduce((acc,rule)=>{const ruleExceptionLists=rule.exceptions_list;return null!=ruleExceptionLists&&ruleExceptionLists.length>0&&ruleExceptionLists.forEach(ex=>{const list=acc[ex.id];null!=list&&(acc[ex.id]={...list,rules:[...list.rules,rule]})}),acc},listsSkeleton)},[exceptionLists]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{let isSubscribed=!0;const abortCtrl=new AbortController;return(async()=>{if(0===exceptionLists.length&&isSubscribed)return setLoading(!1),setExceptions([]),void setExceptionsListInfo({});try{setLoading(!0);const{data:rules}=await Object(api.h)({pagination:{page:1,perPage:1e4,total:0},signal:abortCtrl.signal}),updatedLists=handleExceptionsInfo(rules),lists=Object.keys(updatedLists).map(listKey=>updatedLists[listKey]);setExceptions(lists),setExceptionsListInfo(updatedLists),isSubscribed&&setLoading(!1)}catch(error){isSubscribed&&setLoading(!1)}})(),()=>{isSubscribed=!1,abortCtrl.abort()}},[exceptionLists.length,handleExceptionsInfo]),[loading,exceptions,exceptionsListsInfo]})({exceptionLists:null!=exceptions?exceptions:[]}),[initLoading,setInitLoading]=Object(external_kbnSharedDeps_React_.useState)(!0),[lastUpdated,setLastUpdated]=Object(external_kbnSharedDeps_React_.useState)(Date.now()),[deletingListIds,setDeletingListIds]=Object(external_kbnSharedDeps_React_.useState)([]),[exportingListIds,setExportingListIds]=Object(external_kbnSharedDeps_React_.useState)([]),[exportDownload,setExportDownload]=Object(external_kbnSharedDeps_React_.useState)({}),{addError:addError}=Object(use_app_toasts.a)(),handleDeleteSuccess=Object(external_kbnSharedDeps_React_.useCallback)(listId=>()=>{notifications.toasts.addSuccess({title:exceptionDeleteSuccessMessage(null!=listId?listId:referenceModalState.listId)})},[notifications.toasts,referenceModalState.listId]),handleDeleteError=Object(external_kbnSharedDeps_React_.useCallback)(err=>{addError(err,{title:EXCEPTION_DELETE_ERROR})},[addError]),handleDelete=Object(external_kbnSharedDeps_React_.useCallback)(({id:id,listId:listId,namespaceType:namespaceType})=>async()=>{try{setDeletingListIds(ids=>[...ids,id]),null!=refreshExceptions&&await refreshExceptions(),null!=exceptionsListsRef[id]&&0===exceptionsListsRef[id].rules.length?(await deleteExceptionList({id:id,namespaceType:namespaceType,onError:handleDeleteError,onSuccess:handleDeleteSuccess(listId)}),null!=refreshExceptions&&refreshExceptions()):(setReferenceModalState({contentText:(referenceCount=exceptionsListsRef[id].rules.length,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.exceptions.referenceModalDescription",{defaultMessage:"This exception list is associated with ({referenceCount}) {referenceCount, plural, =1 {rule} other {rules}}. Removing this exception list will also remove its reference from the associated rules.",values:{referenceCount:referenceCount}})),rulesReferences:exceptionsListsRef[id].rules.map(({name:name})=>name),isLoading:!0,listId:id,listNamespaceType:namespaceType}),setShowReferenceErrorModal(!0))}catch(error){handleDeleteError(error)}finally{setDeletingListIds(ids=>[...ids.filter(_id=>_id!==id)])}var referenceCount},[deleteExceptionList,exceptionsListsRef,handleDeleteError,handleDeleteSuccess,refreshExceptions]),handleExportSuccess=Object(external_kbnSharedDeps_React_.useCallback)(listId=>blob=>{setExportDownload({name:listId,blob:blob})},[]),handleExportError=Object(external_kbnSharedDeps_React_.useCallback)(err=>{addError(err,{title:EXCEPTION_EXPORT_ERROR})},[addError]),handleExport=Object(external_kbnSharedDeps_React_.useCallback)(({id:id,listId:listId,namespaceType:namespaceType})=>async()=>{setExportingListIds(ids=>[...ids,id]),await exportExceptionList({id:id,listId:listId,namespaceType:namespaceType,onError:handleExportError,onSuccess:handleExportSuccess(listId)})},[exportExceptionList,handleExportError,handleExportSuccess]),exceptionsColumns=Object(external_kbnSharedDeps_React_.useMemo)(()=>((onExport,onDelete,history,formatUrl)=>[{align:"left",field:"list_id",name:EXCEPTION_LIST_ID_TITLE,truncateText:!0,dataType:"string",width:"15%",render:value=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{position:"left",content:value},external_kbnSharedDeps_React_default.a.createElement("p",{"data-test-subj":"exceptionsTableListId"},value))},{align:"left",field:"name",name:EXCEPTION_LIST_NAME,truncateText:!0,dataType:"string",width:"10%",render:value=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{position:"left",content:value},external_kbnSharedDeps_React_default.a.createElement("p",{"data-test-subj":"exceptionsTableName"},value))},{align:"center",field:"rules",name:NUMBER_RULES_ASSIGNED_TO_TITLE,truncateText:!0,dataType:"number",width:"10%",render:value=>external_kbnSharedDeps_React_default.a.createElement("p",null,value.length)},{align:"left",field:"rules",name:RULES_ASSIGNED_TO_TITLE,truncateText:!0,dataType:"string",width:"20%",render:value=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,value.map(({id:id,name:name},index)=>external_kbnSharedDeps_React_default.a.createElement(page.h,{key:id},external_kbnSharedDeps_React_default.a.createElement(links.f,{key:id,"data-test-subj":"ruleName",onClick:ev=>{ev.preventDefault(),history.push(Object(redirect_to_detection_engine.e)(id))},href:formatUrl(Object(redirect_to_detection_engine.e)(id))},name),index!==value.length-1?", ":"")))},{align:"left",field:"created_at",name:LIST_DATE_CREATED_TITLE,truncateText:!0,dataType:"date",width:"14%"},{align:"left",field:"updated_at",name:LIST_DATE_UPDATED_TITLE,truncateText:!0,width:"14%"},{align:"center",isExpander:!1,width:"25px",render:({id:id,list_id:listId,namespace_type:namespaceType})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{onClick:onExport({id:id,listId:listId,namespaceType:namespaceType}),"aria-label":"Export exception list",iconType:"exportAction","data-test-subj":"exceptionsTableExportButton"})},{align:"center",width:"25px",isExpander:!1,render:({id:id,list_id:listId,namespace_type:namespaceType})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{color:"danger",onClick:onDelete({id:id,listId:listId,namespaceType:namespaceType}),"aria-label":"Delete exception list",iconType:"trash",isDisabled:"endpoint_list"===listId,"data-test-subj":"exceptionsTableDeleteButton"})}])(handleExport,handleDelete,history,formatUrl),[handleExport,handleDelete,history,formatUrl]),handleRefresh=Object(external_kbnSharedDeps_React_.useCallback)(()=>{null!=refreshExceptions&&(setLastUpdated(Date.now()),refreshExceptions())},[refreshExceptions]);Object(external_kbnSharedDeps_React_.useEffect)(()=>{!initLoading||loading||loadingExceptions||loadingTableInfo||setInitLoading(!1)},[initLoading,loading,loadingExceptions,loadingTableInfo]);const emptyPrompt=Object(external_kbnSharedDeps_React_.useMemo)(()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiEmptyPrompt,{title:external_kbnSharedDeps_React_default.a.createElement("h3",null,NO_EXCEPTION_LISTS),titleSize:"xs",body:NO_LISTS_BODY}),[]),handleSearch=Object(external_kbnSharedDeps_React_.useCallback)(async({query:query,queryText:queryText})=>{const searchTerms=(({query:query,searchValue:searchValue,filterOptions:filterOptions,defaultSearchTerm:defaultSearchTerm})=>{const fieldClauses=null==query?void 0:query.ast.getFieldClauses();if(null!=fieldClauses&&fieldClauses.length>0){return fieldClauses.reduce((acc,{field:field,value:value})=>(acc[field]=""+value,acc),filterOptions)}return{[defaultSearchTerm]:searchValue}})({defaultSearchTerm:"name",filterOptions:{name:null,list_id:null,created_by:null,type:null,tags:null},query:query,searchValue:queryText});setFilters(searchTerms)},[]),handleCloseReferenceErrorModal=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setDeletingListIds([]),setShowReferenceErrorModal(!1),setReferenceModalState({contentText:"",rulesReferences:[],isLoading:!1,listId:"",listNamespaceType:"single"})},[]),handleReferenceDelete=Object(external_kbnSharedDeps_React_.useCallback)(async()=>{const exceptionListId=referenceModalState.listId,exceptionListNamespaceType=referenceModalState.listNamespaceType,relevantRules=exceptionsListsRef[exceptionListId].rules;try{await Promise.all(relevantRules.map(rule=>{var _rule$exceptions_list;const abortCtrl=new AbortController,exceptionLists=(null!==(_rule$exceptions_list=rule.exceptions_list)&&void 0!==_rule$exceptions_list?_rule$exceptions_list:[]).filter(({id:id})=>id!==exceptionListId);return Object(api.n)({ruleProperties:{rule_id:rule.rule_id,exceptions_list:exceptionLists},signal:abortCtrl.signal})})),await deleteExceptionList({id:exceptionListId,namespaceType:exceptionListNamespaceType,onError:handleDeleteError,onSuccess:handleDeleteSuccess()})}catch(err){handleDeleteError(err)}finally{setReferenceModalState(exceptionReferenceModalInitialState),setDeletingListIds([]),setShowReferenceErrorModal(!1),null!=refreshExceptions&&refreshExceptions()}},[referenceModalState.listId,referenceModalState.listNamespaceType,exceptionsListsRef,deleteExceptionList,handleDeleteError,handleDeleteSuccess,refreshExceptions]),paginationMemo=Object(external_kbnSharedDeps_React_.useMemo)(()=>({pageIndex:pagination.page-1,pageSize:pagination.perPage,totalItemCount:pagination.total||0,pageSizeOptions:[5,10,20,50,100,200,300]}),[pagination]),handleOnDownload=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setExportDownload({})},[]),tableItems=(null!=exceptionListsWithRuleRefs?exceptionListsWithRuleRefs:[]).map(item=>({...item,isDeleting:deletingListIds.includes(item.id),isExporting:exportingListIds.includes(item.id)}));return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(panel.a,{loading:!initLoading&&loadingTableInfo,"data-test-subj":"allExceptionListsPanel"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,loadingTableInfo&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiProgress,{"data-test-subj":"loadingRulesInfoProgress",size:"xs",position:"absolute",color:"accent"}),external_kbnSharedDeps_React_default.a.createElement(header_section.a,{split:!0,title:ALL_EXCEPTIONS,subtitle:external_kbnSharedDeps_React_default.a.createElement(last_updated.a,{showUpdating:loading,updatedAt:lastUpdated})},!initLoading&&external_kbnSharedDeps_React_default.a.createElement(ExceptionsSearchBar,{onSearch:handleSearch})),loadingTableInfo&&!initLoading&&!showReferenceErrorModal&&external_kbnSharedDeps_React_default.a.createElement(loader.a,{"data-test-subj":"loadingPanelAllRulesTable",overlay:!0,size:"xl"}),initLoading?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingContent,{"data-test-subj":"initialLoadingPanelAllRulesTable",lines:10}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(AllRulesUtilityBar,{showBulkActions:!1,userHasNoPermissions:hasNoPermissions,paginationTotal:null!==(_exceptionListsWithRu=exceptionListsWithRuleRefs.length)&&void 0!==_exceptionListsWithRu?_exceptionListsWithRu:0,numberSelectedItems:0,onRefresh:handleRefresh}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBasicTable,{"data-test-subj":"exceptions-table",columns:exceptionsColumns,isSelectable:null!==(_hasNoPermissions=!hasNoPermissions)&&void 0!==_hasNoPermissions&&_hasNoPermissions,itemId:"id",items:tableItems,noItemsMessage:emptyPrompt,onChange:()=>{},pagination:paginationMemo})))),external_kbnSharedDeps_React_default.a.createElement(AutoDownload,{blob:exportDownload.blob,name:exportDownload.name+".ndjson",onDownload:handleOnDownload}),external_kbnSharedDeps_React_default.a.createElement(ReferenceErrorModal,{cancelText:REFERENCE_MODAL_CANCEL_BUTTON,confirmText:REFERENCE_MODAL_CONFIRM_BUTTON,contentText:referenceModalState.contentText,onCancel:handleCloseReferenceErrorModal,onClose:handleCloseReferenceErrorModal,onConfirm:handleReferenceDelete,references:referenceModalState.rulesReferences,showModal:showReferenceErrorModal,titleText:REFERENCE_MODAL_TITLE}))});let AllRulesTabs;!function(AllRulesTabs){AllRulesTabs.rules="rules",AllRulesTabs.monitoring="monitoring",AllRulesTabs.exceptions="exceptions"}(AllRulesTabs||(AllRulesTabs={}));const allRulesTabs=[{id:AllRulesTabs.rules,name:rules_translations.ob,disabled:!1},{id:AllRulesTabs.monitoring,name:rules_translations.bb,disabled:!1},{id:AllRulesTabs.exceptions,name:rules_translations.S,disabled:!1}],AllRules=external_kbnSharedDeps_React_default.a.memo(({createPrePackagedRules:createPrePackagedRules,hasNoPermissions:hasNoPermissions,loading:loading,loadingCreatePrePackagedRules:loadingCreatePrePackagedRules,refetchPrePackagedRulesStatus:refetchPrePackagedRulesStatus,rulesCustomInstalled:rulesCustomInstalled,rulesInstalled:rulesInstalled,rulesNotInstalled:rulesNotInstalled,rulesNotUpdated:rulesNotUpdated,setRefreshRulesData:setRefreshRulesData})=>{const history=Object(external_kbnSharedDeps_ReactRouterDom_.useHistory)(),{formatUrl:formatUrl}=Object(link_to.o)(app_types.a.detections),[allRulesTab,setAllRulesTab]=Object(external_kbnSharedDeps_React_.useState)(AllRulesTabs.rules),tabs=Object(external_kbnSharedDeps_React_.useMemo)(()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTabs,null,allRulesTabs.map(tab=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTab,{"data-test-subj":"allRulesTableTab-"+tab.id,onClick:()=>setAllRulesTab(tab.id),isSelected:tab.id===allRulesTab,disabled:tab.disabled,key:tab.id},tab.name))),[allRulesTabs,allRulesTab,setAllRulesTab]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),tabs,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),(allRulesTab===AllRulesTabs.rules||allRulesTab===AllRulesTabs.monitoring)&&external_kbnSharedDeps_React_default.a.createElement(RulesTables,{history:history,formatUrl:formatUrl,selectedTab:allRulesTab,createPrePackagedRules:createPrePackagedRules,hasNoPermissions:hasNoPermissions,loading:loading,loadingCreatePrePackagedRules:loadingCreatePrePackagedRules,refetchPrePackagedRulesStatus:refetchPrePackagedRulesStatus,rulesCustomInstalled:rulesCustomInstalled,rulesInstalled:rulesInstalled,rulesNotInstalled:rulesNotInstalled,rulesNotUpdated:rulesNotUpdated,setRefreshRulesData:setRefreshRulesData}),allRulesTab===AllRulesTabs.exceptions&&external_kbnSharedDeps_React_default.a.createElement(ExceptionListsTable,{formatUrl:formatUrl,history:history,hasNoPermissions:hasNoPermissions,loading:loading}))});AllRules.displayName="AllRules";var import_data_modal=__webpack_require__(745);const MODAL_TITLE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.lists.uploadValueListTitle",{defaultMessage:"Upload value lists"}),FILE_PICKER_LABEL=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.lists.uploadValueListDescription",{defaultMessage:"Upload single value lists to use while writing rule exceptions."}),FILE_PICKER_PROMPT=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.lists.uploadValueListPrompt",{defaultMessage:"Select or drag and drop a file"}),CLOSE_BUTTON=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.lists.closeValueListsModalTitle",{defaultMessage:"Close"}),CANCEL_BUTTON=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.lists.cancelValueListsUploadTitle",{defaultMessage:"Cancel upload"}),UPLOAD_BUTTON=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.lists.valueListsUploadButton",{defaultMessage:"Upload list"}),UPLOAD_SUCCESS_TITLE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.lists.valueListsUploadSuccessTitle",{defaultMessage:"Value list uploaded"}),UPLOAD_ERROR=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.lists.valueListsUploadError",{defaultMessage:"There was an error uploading the value list."}),EXPORT_ERROR=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.lists.valueListsExportError",{defaultMessage:"There was an error exporting the value list."}),COLUMN_FILE_NAME=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.lists.valueListsTable.fileNameColumn",{defaultMessage:"Filename"}),COLUMN_TYPE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.lists.valueListsTable.typeColumn",{defaultMessage:"Type"}),COLUMN_UPLOAD_DATE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.lists.valueListsTable.uploadDateColumn",{defaultMessage:"Upload Date"}),COLUMN_CREATED_BY=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.lists.valueListsTable.createdByColumn",{defaultMessage:"Created by"}),COLUMN_ACTIONS=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.lists.valueListsTable.actionsColumn",{defaultMessage:"Actions"}),ACTION_EXPORT_DESCRIPTION=(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.lists.valueListsTable.exportActionName",{defaultMessage:"Export"}),external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.lists.valueListsTable.exportActionDescription",{defaultMessage:"Export value list"})),ACTION_DELETE_DESCRIPTION=(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.lists.valueListsTable.deleteActionName",{defaultMessage:"Remove"}),external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.lists.valueListsTable.deleteActionDescription",{defaultMessage:"Remove value list"})),TABLE_TITLE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.lists.valueListsTable.title",{defaultMessage:"Value lists"}),LIST_TYPES_RADIO_LABEL=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.lists.valueListsForm.listTypesRadioLabel",{defaultMessage:"Type of value list"}),IP_RADIO=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.lists.valueListsForm.ipRadioLabel",{defaultMessage:"IP addresses"}),KEYWORDS_RADIO=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.lists.valueListsForm.keywordsRadioLabel",{defaultMessage:"Keywords"}),IP_RANGE_RADIO=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.lists.valueListsForm.ipRangesRadioLabel",{defaultMessage:"IP ranges"}),TEXT_RADIO=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.lists.valueListsForm.textRadioLabel",{defaultMessage:"Text"}),translations_REFERENCE_MODAL_TITLE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.lists.referenceModalTitle",{defaultMessage:"Remove value list"}),translations_REFERENCE_MODAL_CANCEL_BUTTON=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.lists.referenceModalCancelButton",{defaultMessage:"Cancel"}),translations_REFERENCE_MODAL_CONFIRM_BUTTON=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.lists.referenceModalDeleteButton",{defaultMessage:"Remove value list"}),listFormOptions=[{value:"keyword",text:KEYWORDS_RADIO},{value:"ip",text:IP_RADIO},{value:"ip_range",text:IP_RANGE_RADIO},{value:"text",text:TEXT_RADIO}],validFileTypes=["text/csv","text/plain"],ValueListsFormComponent=({onError:onError,onSuccess:onSuccess})=>{const ctrl=Object(external_kbnSharedDeps_React_.useRef)(new AbortController),[file,setFile]=Object(external_kbnSharedDeps_React_.useState)(null),[type,setType]=Object(external_kbnSharedDeps_React_.useState)("keyword"),filePickerRef=Object(external_kbnSharedDeps_React_.useRef)(null),{http:http}=Object(lib_kibana.h)().services,{start:importList,...importState}=Object(shared_imports.L)(),fileIsValid=!file||validFileTypes.some(fileType=>file.type===fileType),handleRadioChange=Object(external_kbnSharedDeps_React_.useCallback)(event=>setType(event.target.value),[setType]),handleFileChange=Object(external_kbnSharedDeps_React_.useCallback)(files=>{var _files$item;setFile(null!==(_files$item=null==files?void 0:files.item(0))&&void 0!==_files$item?_files$item:null)},[]),resetForm=Object(external_kbnSharedDeps_React_.useCallback)(()=>{var _filePickerRef$curren;null!==(_filePickerRef$curren=filePickerRef.current)&&void 0!==_filePickerRef$curren&&_filePickerRef$curren.fileInput&&(filePickerRef.current.fileInput.value="",filePickerRef.current.handleChange()),setFile(null),setType("keyword")},[]),handleCancel=Object(external_kbnSharedDeps_React_.useCallback)(()=>{ctrl.current.abort()},[]),handleSuccess=Object(external_kbnSharedDeps_React_.useCallback)(response=>{resetForm(),onSuccess(response)},[resetForm,onSuccess]),handleError=Object(external_kbnSharedDeps_React_.useCallback)(error=>{onError(error)},[onError]),handleImport=Object(external_kbnSharedDeps_React_.useCallback)(()=>{!importState.loading&&file&&(ctrl.current=new AbortController,importList({file:file,listId:void 0,http:http,signal:ctrl.current.signal,type:type}))},[importState.loading,file,importList,http,type]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{!importState.loading&&importState.result?handleSuccess(importState.result):!importState.loading&&importState.error&&handleError(importState.error)},[handleError,handleSuccess,importState.error,importState.loading,importState.result]),Object(external_kbnSharedDeps_React_.useEffect)(()=>handleCancel,[handleCancel]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiForm,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{"data-test-subj":"value-list-file-picker-row",label:FILE_PICKER_LABEL,fullWidth:!0,isInvalid:!fileIsValid,error:[(fileTypes=validFileTypes.join(", "),external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.lists.uploadValueListExtensionValidationMessage",{values:{fileTypes:fileTypes},defaultMessage:"File must be one of the following types: [{fileTypes}]"}))]},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFilePicker,{accept:validFileTypes.join(),"data-test-subj":"value-list-file-picker",id:"value-list-file-picker",initialPromptText:FILE_PICKER_PROMPT,ref:filePickerRef,onChange:handleFileChange,fullWidth:!0,isLoading:importState.loading,isInvalid:!fileIsValid})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{fullWidth:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:LIST_TYPES_RADIO_LABEL},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSelect,{"data-test-subj":"value-lists-form-select-type-action",options:listFormOptions,value:type,onChange:handleRadioChange,name:"valueListType"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{hasEmptyLabelSpace:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"flexEnd"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,importState.loading&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{onClick:handleCancel},CANCEL_BUTTON)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{"data-test-subj":"value-lists-form-import-action",onClick:handleImport,disabled:null==file||!fileIsValid||importState.loading},UPLOAD_BUTTON))))))));var fileTypes};ValueListsFormComponent.displayName="ValueListsFormComponent";const ValueListsForm=external_kbnSharedDeps_React_default.a.memo(ValueListsFormComponent);ValueListsForm.displayName="ValueListsForm";const AlignedSpinner=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiLoadingSpinner).withConfig({displayName:"AlignedSpinner",componentId:"j76bhq-0"})(["margin:",";vertical-align:middle;"],({theme:theme})=>theme.eui.euiSizeXS),referenceModalInitialState={contentText:"",exceptionListReferences:[],isLoading:!1,valueListId:""},ValueListsModalComponent=({onClose:onClose,showModal:showModal})=>{var _lists$result$data,_lists$result2,_lists$result$total,_lists$result3;const[pageIndex,setPageIndex]=Object(external_kbnSharedDeps_React_.useState)(0),[pageSize,setPageSize]=Object(external_kbnSharedDeps_React_.useState)(5),[cursor,setCursor]=Object(shared_imports.D)({pageIndex:pageIndex,pageSize:pageSize}),{http:http}=Object(lib_kibana.h)().services,{start:findLists,...lists}=Object(shared_imports.H)(),{start:deleteList,result:deleteResult,error:deleteError}=Object(shared_imports.E)(),[deletingListIds,setDeletingListIds]=Object(external_kbnSharedDeps_React_.useState)([]),[exportingListIds,setExportingListIds]=Object(external_kbnSharedDeps_React_.useState)([]),[exportDownload,setExportDownload]=Object(external_kbnSharedDeps_React_.useState)({}),{addError:addError,addSuccess:addSuccess}=Object(use_app_toasts.a)(),[showReferenceErrorModal,setShowReferenceErrorModal]=Object(external_kbnSharedDeps_React_.useState)(!1),[referenceModalState,setReferenceModalState]=Object(external_kbnSharedDeps_React_.useState)(referenceModalInitialState),fetchLists=Object(external_kbnSharedDeps_React_.useCallback)(()=>{findLists({cursor:cursor,http:http,pageIndex:pageIndex+1,pageSize:pageSize})},[cursor,http,findLists,pageIndex,pageSize]),handleDelete=Object(external_kbnSharedDeps_React_.useCallback)(({deleteReferences:deleteReferences,id:id})=>{setDeletingListIds([...deletingListIds,id]),deleteList({deleteReferences:deleteReferences,http:http,id:id})},[deleteList,deletingListIds,http]),handleReferenceDelete=Object(external_kbnSharedDeps_React_.useCallback)(async()=>{setShowReferenceErrorModal(!1),deleteList({deleteReferences:!0,http:http,id:referenceModalState.valueListId}),setReferenceModalState(referenceModalInitialState),setDeletingListIds([])},[deleteList,http,referenceModalState.valueListId]);Object(external_kbnSharedDeps_React_.useEffect)(()=>{null!=deleteResult&&(setDeletingListIds(ids=>[...ids.filter(id=>id!==deleteResult.id)]),fetchLists())},[deleteResult,fetchLists]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{if(!Object(external_kbnSharedDeps_LodashFp_.isEmpty)(deleteError)){var _deleteError$body$mes,_deleteError$body,_deleteError$body$mes2,_deleteError$body$mes3,_deleteError$body$mes4,_deleteError$body2,_deleteError$body2$me,_deleteError$body2$me2;const references=null!==(_deleteError$body$mes=null==deleteError||null===(_deleteError$body=deleteError.body)||void 0===_deleteError$body||null===(_deleteError$body$mes2=_deleteError$body.message)||void 0===_deleteError$body$mes2||null===(_deleteError$body$mes3=_deleteError$body$mes2.error)||void 0===_deleteError$body$mes3||null===(_deleteError$body$mes4=_deleteError$body$mes3.references)||void 0===_deleteError$body$mes4?void 0:_deleteError$body$mes4.map(ref=>null==ref?void 0:ref.exception_list.name))&&void 0!==_deleteError$body$mes?_deleteError$body$mes:[],uniqueExceptionListReferences=Array.from(new Set(references));setShowReferenceErrorModal(!0),setReferenceModalState({contentText:(referenceCount=uniqueExceptionListReferences.length,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.lists.referenceModalDescription",{defaultMessage:"This value list is associated with ({referenceCount}) exception {referenceCount, plural, =1 {list} other {lists}}. Removing this list will remove all exception items that reference this value list.",values:{referenceCount:referenceCount}})),exceptionListReferences:uniqueExceptionListReferences,isLoading:!1,valueListId:null==deleteError||null===(_deleteError$body2=deleteError.body)||void 0===_deleteError$body2||null===(_deleteError$body2$me=_deleteError$body2.message)||void 0===_deleteError$body2$me||null===(_deleteError$body2$me2=_deleteError$body2$me.error)||void 0===_deleteError$body2$me2?void 0:_deleteError$body2$me2.value_list_id})}var referenceCount},[deleteError]);const handleExport=Object(external_kbnSharedDeps_React_.useCallback)(async({id:id})=>{try{setExportingListIds(ids=>[...ids,id]);const blob=await Object(shared_imports.t)({http:http,listId:id,signal:(new AbortController).signal});setExportDownload({name:id,blob:blob})}catch(error){addError(error,{title:EXPORT_ERROR})}finally{setExportingListIds(ids=>[...ids.filter(_id=>_id!==id)])}},[addError,http]),handleTableChange=Object(external_kbnSharedDeps_React_.useCallback)(({page:{index:index,size:size}})=>{setPageIndex(index),setPageSize(size)},[setPageIndex,setPageSize]),handleUploadError=Object(external_kbnSharedDeps_React_.useCallback)(error=>{"AbortError"!==error.name&&addError(error,{title:UPLOAD_ERROR})},[addError]),handleUploadSuccess=Object(external_kbnSharedDeps_React_.useCallback)(response=>{var fileName;addSuccess({text:(fileName=response.name,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.lists.valueListsUploadSuccess",{defaultMessage:"Value list '{fileName}' was uploaded",values:{fileName:fileName}})),title:UPLOAD_SUCCESS_TITLE}),fetchLists()},[addSuccess]);Object(external_kbnSharedDeps_React_.useEffect)(()=>{showModal&&fetchLists()},[showModal,fetchLists]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{var _lists$result;!lists.loading&&null!==(_lists$result=lists.result)&&void 0!==_lists$result&&_lists$result.cursor&&setCursor(lists.result.cursor)},[lists.loading,lists.result,setCursor]);const handleCloseReferenceErrorModal=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setDeletingListIds([]),setShowReferenceErrorModal(!1),setReferenceModalState({contentText:"",exceptionListReferences:[],isLoading:!1,valueListId:""})},[]);if(!showModal)return null;const tableItems=(null!==(_lists$result$data=null===(_lists$result2=lists.result)||void 0===_lists$result2?void 0:_lists$result2.data)&&void 0!==_lists$result$data?_lists$result$data:[]).map(item=>({...item,isDeleting:deletingListIds.includes(item.id),isExporting:exportingListIds.includes(item.id)})),pagination={pageIndex:pageIndex,pageSize:pageSize,totalItemCount:null!==(_lists$result$total=null===(_lists$result3=lists.result)||void 0===_lists$result3?void 0:_lists$result3.total)&&void 0!==_lists$result$total?_lists$result$total:0,hidePerPageOptions:!0},columns=(onExport=handleExport,onDelete=handleDelete,[{field:"name",name:COLUMN_FILE_NAME,truncateText:!1},{field:"type",name:COLUMN_TYPE,width:"15%",truncateText:!0,render:type=>{const option=listFormOptions.find(({value:value})=>value===type);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,option?option.text:type)}},{field:"created_at",name:COLUMN_UPLOAD_DATE,render:value=>external_kbnSharedDeps_React_default.a.createElement(formatted_date.a,{value:value,fieldName:"created_at"}),width:"30%"},{field:"created_by",name:COLUMN_CREATED_BY,truncateText:!0,width:"20%"},{name:COLUMN_ACTIONS,actions:[{render:item=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{content:ACTION_EXPORT_DESCRIPTION},item.isExporting?external_kbnSharedDeps_React_default.a.createElement(AlignedSpinner,{size:"m"}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{"aria-label":ACTION_EXPORT_DESCRIPTION,"data-test-subj":"action-export-value-list",iconType:"exportAction",onClick:()=>onExport(item)}))},{render:item=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{content:ACTION_DELETE_DESCRIPTION},item.isDeleting?external_kbnSharedDeps_React_default.a.createElement(AlignedSpinner,{size:"m"}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{"aria-label":ACTION_DELETE_DESCRIPTION,"data-test-subj":"action-delete-value-list-"+item.name,iconType:"trash",onClick:()=>onDelete(item)}))}],width:"15%"}]);var onExport,onDelete;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModal,{onClose:onClose,maxWidth:800},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalHeader,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalHeaderTitle,null,MODAL_TITLE)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalBody,null,external_kbnSharedDeps_React_default.a.createElement(ValueListsForm,{onSuccess:handleUploadSuccess,onError:handleUploadError}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPanel,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"s"},external_kbnSharedDeps_React_default.a.createElement("h2",null,TABLE_TITLE)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBasicTable,{"data-test-subj":"value-lists-table",columns:columns,items:tableItems,loading:lists.loading,onChange:handleTableChange,pagination:pagination}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalFooter,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{"data-test-subj":"value-lists-modal-close-action",onClick:onClose},CLOSE_BUTTON))),external_kbnSharedDeps_React_default.a.createElement(ReferenceErrorModal,{cancelText:translations_REFERENCE_MODAL_CANCEL_BUTTON,confirmText:translations_REFERENCE_MODAL_CONFIRM_BUTTON,contentText:referenceModalState.contentText,onCancel:handleCloseReferenceErrorModal,onClose:handleCloseReferenceErrorModal,onConfirm:handleReferenceDelete,references:referenceModalState.exceptionListReferences,showModal:showReferenceErrorModal,titleText:translations_REFERENCE_MODAL_TITLE}),external_kbnSharedDeps_React_default.a.createElement(AutoDownload,{blob:exportDownload.blob,name:exportDownload.name,onDownload:()=>setExportDownload({})}))};ValueListsModalComponent.displayName="ValueListsModalComponent";const ValueListsModal=external_kbnSharedDeps_React_default.a.memo(ValueListsModalComponent);ValueListsModal.displayName="ValueListsModal";const UpdatePrePackagedRulesCallOutComponent=({loading:loading,numberOfUpdatedRules:numberOfUpdatedRules,numberOfUpdatedTimelines:numberOfUpdatedTimelines,updateRules:updateRules})=>{const{services:services}=Object(lib_kibana.h)(),prepackagedRulesOrTimelines=Object(external_kbnSharedDeps_React_.useMemo)(()=>{return numberOfUpdatedRules>0&&0===numberOfUpdatedTimelines?{callOutMessage:UPDATE_PREPACKAGED_RULES_MSG(numberOfUpdatedRules),buttonTitle:UPDATE_PREPACKAGED_RULES(numberOfUpdatedRules)}:0===numberOfUpdatedRules&&numberOfUpdatedTimelines>0?{callOutMessage:(updateTimelines=numberOfUpdatedTimelines,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.rules.updatePrePackagedTimelinesMsg",{values:{updateTimelines:updateTimelines},defaultMessage:"You can update {updateTimelines} Elastic prebuilt {updateTimelines, plural, =1 {timeline} other {timelines}}"})),buttonTitle:UPDATE_PREPACKAGED_TIMELINES(numberOfUpdatedTimelines)}:numberOfUpdatedRules>0&&numberOfUpdatedTimelines>0?{callOutMessage:UPDATE_PREPACKAGED_RULES_AND_TIMELINES_MSG(numberOfUpdatedRules,numberOfUpdatedTimelines),buttonTitle:UPDATE_PREPACKAGED_RULES_AND_TIMELINES(numberOfUpdatedRules,numberOfUpdatedTimelines)}:void 0;var updateTimelines},[numberOfUpdatedRules,numberOfUpdatedTimelines]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:UPDATE_PREPACKAGED_RULES_TITLE,"data-test-subj":"update-callout"},external_kbnSharedDeps_React_default.a.createElement("p",null,null==prepackagedRulesOrTimelines?void 0:prepackagedRulesOrTimelines.callOutMessage,external_kbnSharedDeps_React_default.a.createElement("br",null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{href:`${services.docLinks.ELASTIC_WEBSITE_URL}guide/en/security/${services.docLinks.DOC_LINK_VERSION}/prebuilt-rules-changelog.html`,target:"_blank"},RELEASE_NOTES_HELP)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{onClick:updateRules,size:"s",isLoading:loading,"data-test-subj":"update-callout-button"},null==prepackagedRulesOrTimelines?void 0:prepackagedRulesOrTimelines.buttonTitle))},UpdatePrePackagedRulesCallOut=Object(external_kbnSharedDeps_React_.memo)(UpdatePrePackagedRulesCallOutComponent);var use_installed_security_jobs=__webpack_require__(497);const affectedJobIds=["v2_rare_process_by_host_linux_ecs","v2_linux_rare_metadata_user","v2_linux_rare_metadata_process","v2_linux_anomalous_user_name_ecs","v2_linux_anomalous_process_all_hosts_ecs","v2_linux_anomalous_network_port_activity_ecs","v2_rare_process_by_host_windows_ecs","v2_windows_anomalous_network_activity_ecs","v2_windows_anomalous_path_activity_ecs","v2_windows_anomalous_process_all_hosts_ecs","v2_windows_anomalous_process_creation","v2_windows_anomalous_user_name_ecs","v2_windows_rare_metadata_process","v2_windows_rare_metadata_user","rare_process_by_host_linux_ecs","linux_anomalous_network_activity_ecs","linux_anomalous_network_port_activity_ecs","linux_anomalous_network_service","linux_anomalous_network_url_activity_ecs","linux_anomalous_process_all_hosts_ecs","linux_anomalous_user_name_ecs","linux_rare_metadata_process","linux_rare_metadata_user","linux_rare_user_compiler","linux_rare_kernel_module_arguments","linux_rare_sudo_user","linux_system_user_discovery","linux_system_information_discovery","linux_system_process_discovery","linux_network_connection_discovery","linux_network_configuration_discovery","rare_process_by_host_windows_ecs","windows_anomalous_network_activity_ecs","windows_anomalous_path_activity_ecs","windows_anomalous_process_all_hosts_ecs","windows_anomalous_process_creation","windows_anomalous_script","windows_anomalous_service","windows_anomalous_user_name_ecs","windows_rare_user_runas_event","windows_rare_metadata_process","windows_rare_metadata_user"],MlJobCompatibilityCalloutBody=()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.mlJobCompatibilityCallout.messageBody",defaultMessage:"{summary} Related documentation: {docs}",values:{summary:external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.mlJobCompatibilityCallout.messageBody.summary",defaultMessage:"Machine learning rules specify ML jobs that in turn have dependencies on data fields populated by the Elastic beats and agent integrations that were current when the ML job was created. New ML jobs, prefixed with V2, have been updated to operate on now-current ECS fields. If you are using multiple versions of beats and agents, you need to create new machine learning rules that specify the new ML (V2) jobs, and enable them to run alongside your existing machine learning rules, in order to ensure continued rule coverage."})),docs:external_kbnSharedDeps_React_default.a.createElement("ul",null,external_kbnSharedDeps_React_default.a.createElement("li",null,external_kbnSharedDeps_React_default.a.createElement(MlJobCompatibilityLink,null)))}}),mlJobCompatibilityCalloutMessage={type:"primary",id:"ml-job-compatibility",title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.detectionEngine.mlJobCompatibilityCallout.messageTitle",{defaultMessage:"Your ML jobs may be incompatible with your data sources and/or ML rules"}),description:external_kbnSharedDeps_React_default.a.createElement(MlJobCompatibilityCalloutBody,null)},MlJobCompatibilityCalloutComponent=()=>{const{loading:loading,jobs:jobs}=Object(use_installed_security_jobs.a)(),newJobsInstalled=jobs.some(job=>affectedJobIds.includes(job.id));return external_kbnSharedDeps_React_default.a.createElement(callouts.CallOutSwitcher,{namespace:"detections",condition:!loading&&newJobsInstalled,message:mlJobCompatibilityCalloutMessage})},MlJobCompatibilityCallout=Object(external_kbnSharedDeps_React_.memo)(MlJobCompatibilityCalloutComponent),RulesPageComponent=()=>{const history=Object(external_kbnSharedDeps_ReactRouterDom_.useHistory)(),[showImportModal,setShowImportModal]=Object(external_kbnSharedDeps_React_.useState)(!1),[showValueListsModal,setShowValueListsModal]=Object(external_kbnSharedDeps_React_.useState)(!1),refreshRulesData=Object(external_kbnSharedDeps_React_.useRef)(null),[{loading:userInfoLoading,isSignalIndexExists:isSignalIndexExists,isAuthenticated:isAuthenticated,hasEncryptionKey:hasEncryptionKey,canUserCRUD:canUserCRUD,hasIndexWrite:hasIndexWrite}]=Object(user_info.b)(),{loading:listsConfigLoading,canWriteIndex:canWriteListsIndex,needsConfiguration:needsListsConfiguration}=useListsConfig(),loading=userInfoLoading||listsConfigLoading,{createPrePackagedRules:createPrePackagedRules,loading:prePackagedRuleLoading,loadingCreatePrePackagedRules:loadingCreatePrePackagedRules,refetchPrePackagedRulesStatus:refetchPrePackagedRulesStatus,rulesCustomInstalled:rulesCustomInstalled,rulesInstalled:rulesInstalled,rulesNotInstalled:rulesNotInstalled,rulesNotUpdated:rulesNotUpdated,timelinesInstalled:timelinesInstalled,timelinesNotInstalled:timelinesNotInstalled,timelinesNotUpdated:timelinesNotUpdated,getLoadPrebuiltRulesAndTemplatesButton:getLoadPrebuiltRulesAndTemplatesButton,getReloadPrebuiltRulesAndTemplatesButton:getReloadPrebuiltRulesAndTemplatesButton}=usePrePackagedRules({canUserCRUD:canUserCRUD,hasIndexWrite:hasIndexWrite,isSignalIndexExists:isSignalIndexExists,isAuthenticated:isAuthenticated,hasEncryptionKey:hasEncryptionKey}),prePackagedRuleStatus=getPrePackagedRuleStatus(rulesInstalled,rulesNotInstalled,rulesNotUpdated),prePackagedTimelineStatus=getPrePackagedTimelineStatus(timelinesInstalled,timelinesNotInstalled,timelinesNotUpdated),{formatUrl:formatUrl}=Object(link_to.o)(app_types.a.detections),handleRefreshRules=Object(external_kbnSharedDeps_React_.useCallback)(async()=>{null!=refreshRulesData.current&&await refreshRulesData.current()},[refreshRulesData]),handleCreatePrePackagedRules=Object(external_kbnSharedDeps_React_.useCallback)(async()=>{if(null!=createPrePackagedRules)return await createPrePackagedRules(),handleRefreshRules()},[createPrePackagedRules,handleRefreshRules]),handleRefetchPrePackagedRulesStatus=Object(external_kbnSharedDeps_React_.useCallback)(()=>null!=refetchPrePackagedRulesStatus?refetchPrePackagedRulesStatus():Promise.resolve(),[refetchPrePackagedRulesStatus]),handleSetRefreshRulesData=Object(external_kbnSharedDeps_React_.useCallback)(refreshRule=>{refreshRulesData.current=refreshRule},[]),goToNewRule=Object(external_kbnSharedDeps_React_.useCallback)(ev=>{ev.preventDefault(),history.push(Object(redirect_to_detection_engine.a)())},[history]),loadPrebuiltRulesAndTemplatesButton=Object(external_kbnSharedDeps_React_.useMemo)(()=>getLoadPrebuiltRulesAndTemplatesButton({isDisabled:helpers_userHasNoPermissions(canUserCRUD)||loading,onClick:handleCreatePrePackagedRules}),[canUserCRUD,getLoadPrebuiltRulesAndTemplatesButton,handleCreatePrePackagedRules,loading]),reloadPrebuiltRulesAndTemplatesButton=Object(external_kbnSharedDeps_React_.useMemo)(()=>getReloadPrebuiltRulesAndTemplatesButton({isDisabled:helpers_userHasNoPermissions(canUserCRUD)||loading,onClick:handleCreatePrePackagedRules}),[canUserCRUD,getReloadPrebuiltRulesAndTemplatesButton,handleCreatePrePackagedRules,loading]);return redirectToDetections(isSignalIndexExists,isAuthenticated,hasEncryptionKey,needsListsConfiguration)?(history.replace(Object(redirect_to_detection_engine.c)()),null):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(NeedAdminForUpdateRulesCallOut,null),external_kbnSharedDeps_React_default.a.createElement(ReadOnlyRulesCallOut,null),external_kbnSharedDeps_React_default.a.createElement(MlJobCompatibilityCallout,null),external_kbnSharedDeps_React_default.a.createElement(ValueListsModal,{showModal:showValueListsModal,onClose:()=>setShowValueListsModal(!1)}),external_kbnSharedDeps_React_default.a.createElement(import_data_modal.a,{checkBoxLabel:rules_translations.gb,closeModal:()=>setShowImportModal(!1),description:rules_translations.vb,errorMessage:rules_translations.V,failedDetailed:rules_translations.W,importComplete:handleRefreshRules,importData:api.m,successMessage:rules_translations.Ab,showCheckBox:!0,showModal:showImportModal,submitBtnText:rules_translations.Y,subtitle:rules_translations.ab,title:rules_translations.X}),external_kbnSharedDeps_React_default.a.createElement(wrapper_page.a,null,external_kbnSharedDeps_React_default.a.createElement(DetectionEngineHeaderPage,{backOptions:{href:Object(redirect_to_detection_engine.c)(),text:rules_translations.h,pageId:app_types.a.detections},title:rules_translations.hb},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:!1,wrap:!0},loadPrebuiltRulesAndTemplatesButton&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},loadPrebuiltRulesAndTemplatesButton),reloadPrebuiltRulesAndTemplatesButton&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},reloadPrebuiltRulesAndTemplatesButton),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{position:"top",content:rules_translations.Db},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{"data-test-subj":"open-value-lists-modal-button",iconType:"importAction",isDisabled:!canWriteListsIndex||loading,onClick:()=>setShowValueListsModal(!0)},rules_translations.Cb))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{iconType:"importAction",isDisabled:helpers_userHasNoPermissions(canUserCRUD)||loading,onClick:()=>{setShowImportModal(!0)}},rules_translations.X)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(links.g,{"data-test-subj":"create-new-rule",fill:!0,onClick:goToNewRule,href:formatUrl(Object(redirect_to_detection_engine.a)()),iconType:"plusInCircle",isDisabled:helpers_userHasNoPermissions(canUserCRUD)||loading},rules_translations.e)))),("ruleNeedUpdate"===prePackagedRuleStatus||"timelineNeedUpdate"===prePackagedTimelineStatus)&&external_kbnSharedDeps_React_default.a.createElement(UpdatePrePackagedRulesCallOut,{"data-test-subj":"update-callout-button",loading:loadingCreatePrePackagedRules,numberOfUpdatedRules:null!=rulesNotUpdated?rulesNotUpdated:0,numberOfUpdatedTimelines:null!=timelinesNotUpdated?timelinesNotUpdated:0,updateRules:handleCreatePrePackagedRules}),external_kbnSharedDeps_React_default.a.createElement(AllRules,{createPrePackagedRules:createPrePackagedRules,"data-test-subj":"all-rules",loading:loading||prePackagedRuleLoading,loadingCreatePrePackagedRules:loadingCreatePrePackagedRules,hasNoPermissions:helpers_userHasNoPermissions(canUserCRUD),refetchPrePackagedRulesStatus:handleRefetchPrePackagedRulesStatus,rulesCustomInstalled:rulesCustomInstalled,rulesInstalled:rulesInstalled,rulesNotInstalled:rulesNotInstalled,rulesNotUpdated:rulesNotUpdated,setRefreshRulesData:handleSetRefreshRulesData})),external_kbnSharedDeps_React_default.a.createElement(spy_routes.a,{pageName:app_types.a.detections}))},RulesPage=external_kbnSharedDeps_React_default.a.memo(RulesPageComponent),DetectionEngineContainerComponent=()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Switch,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:"/rules/id/:detailName/edit"},external_kbnSharedDeps_React_default.a.createElement(EditRulePage,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:"/rules/id/:detailName"},external_kbnSharedDeps_React_default.a.createElement(RuleDetailsPage,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:"/rules/create"},external_kbnSharedDeps_React_default.a.createElement(CreateRulePage,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:"/rules"},external_kbnSharedDeps_React_default.a.createElement(RulesPage,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{exact:!0,path:"",strict:!0},external_kbnSharedDeps_React_default.a.createElement(DetectionEnginePage,null))),DetectionEngineContainer=external_kbnSharedDeps_React_default.a.memo(DetectionEngineContainerComponent);var _404=__webpack_require__(173);const AlertsRoutes=()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Switch,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:"/"},external_kbnSharedDeps_React_default.a.createElement(DetectionEngineContainer,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,null,external_kbnSharedDeps_React_default.a.createElement(_404.a,null))),DETECTIONS_TIMELINE_IDS=[types_timeline.g.detectionsRulesDetailsPage,types_timeline.g.detectionsPage];var use_get_url_search=__webpack_require__(300),home_navigations=__webpack_require__(273),common_api=__webpack_require__(33),lib_helpers=__webpack_require__(224);const SAVE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.header.editableTitle.save",{defaultMessage:"Save"}),header_page_translations_CANCEL=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.header.editableTitle.cancel",{defaultMessage:"Cancel"}),EDIT_TITLE_ARIA=title=>external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.header.editableTitle.editButtonAria",{values:{title:title},defaultMessage:"You can edit {title} by clicking"});var header_page_title=__webpack_require__(687);const editable_title_MyEuiButtonIcon=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon).withConfig({displayName:"MyEuiButtonIcon",componentId:"sc-1mw23e4-0"})(["",""],({theme:theme})=>Object(external_kbnSharedDeps_StyledComponents_.css)(["margin-left:",";"],theme.eui.euiSize)),MySpinner=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiLoadingSpinner).withConfig({displayName:"MySpinner",componentId:"sc-1mw23e4-1"})(["",""],({theme:theme})=>Object(external_kbnSharedDeps_StyledComponents_.css)(["margin-left:",";"],theme.eui.euiSize)),EditableTitleComponent=({disabled:disabled=!1,onSubmit:onSubmit,isLoading:isLoading,title:title})=>{const[editMode,setEditMode]=Object(external_kbnSharedDeps_React_.useState)(!1),[changedTitle,onTitleChange]=Object(external_kbnSharedDeps_React_.useState)("string"==typeof title?title:""),onCancel=Object(external_kbnSharedDeps_React_.useCallback)(()=>setEditMode(!1),[]),onClickEditIcon=Object(external_kbnSharedDeps_React_.useCallback)(()=>setEditMode(!0),[]),onClickSubmit=Object(external_kbnSharedDeps_React_.useCallback)(()=>{changedTitle!==title&&onSubmit(changedTitle),setEditMode(!1)},[changedTitle,title]),handleOnChange=Object(external_kbnSharedDeps_React_.useCallback)(e=>onTitleChange(e.target.value),[]);return editMode?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",gutterSize:"m",justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldText,{onChange:handleOnChange,value:""+changedTitle,"data-test-subj":"editable-title-input-field"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"none",responsive:!1,wrap:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{color:"secondary","data-test-subj":"editable-title-submit-btn",fill:!0,iconType:"save",onClick:onClickSubmit,size:"s"},SAVE)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{"data-test-subj":"editable-title-cancel-btn",iconType:"cross",onClick:onCancel,size:"s"},header_page_translations_CANCEL))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null)):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(header_page_title.a,{title:title})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},isLoading&&external_kbnSharedDeps_React_default.a.createElement(MySpinner,{"data-test-subj":"editable-title-loading"}),!isLoading&&external_kbnSharedDeps_React_default.a.createElement(editable_title_MyEuiButtonIcon,{isDisabled:disabled,"aria-label":EDIT_TITLE_ARIA(title),iconType:"pencil",onClick:onClickEditIcon,"data-test-subj":"editable-title-edit-icon"})))},EditableTitle=external_kbnSharedDeps_React_default.a.memo(EditableTitleComponent);var cases_translations=__webpack_require__(34);const EDIT_TAGS_ARIA=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.cases.caseView.editTagsLinkAria",{defaultMessage:"click to edit tags"});const tag_list_schema_schema={tags:__webpack_require__(759).b};var use_get_tags=__webpack_require__(466);const TagsComponent=({tags:tags,color:color="default",gutterSize:gutterSize})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,tags.length>0&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBadgeGroup,{gutterSize:gutterSize},tags.map(tag=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBadge,{"data-test-subj":"tag-"+tag,color:color,key:tag},tag)))),Tags=Object(external_kbnSharedDeps_React_.memo)(TagsComponent),tag_list_CommonUseField=Object(shared_imports.x)({component:shared_imports.e}),MyFlexGroup=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup).withConfig({displayName:"MyFlexGroup",componentId:"sc-1hmj58j-0"})(["",""],({theme:theme})=>Object(external_kbnSharedDeps_StyledComponents_.css)(["margin-top:",";p{font-size:",";}"],theme.eui.euiSizeM,theme.eui.euiSizeM)),TagList=external_kbnSharedDeps_React_default.a.memo(({disabled:disabled=!1,isLoading:isLoading,onSubmit:onSubmit,tags:tags})=>{const initialState={tags:tags},{form:form}=Object(shared_imports.I)({defaultValue:initialState,options:{stripEmptyFields:!1},schema:tag_list_schema_schema}),{submit:submit}=form,[isEditTags,setIsEditTags]=Object(external_kbnSharedDeps_React_.useState)(!1),onSubmitTags=Object(external_kbnSharedDeps_React_.useCallback)(async()=>{const{isValid:isValid,data:newData}=await submit();isValid&&newData.tags&&(onSubmit(newData.tags),setIsEditTags(!1))},[onSubmit,submit]),{tags:tagOptions}=Object(use_get_tags.a)(),[options,setOptions]=Object(external_kbnSharedDeps_React_.useState)(tagOptions.map(label=>({label:label})));return Object(external_kbnSharedDeps_React_.useEffect)(()=>setOptions(tagOptions.map(label=>({label:label}))),[tagOptions]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",gutterSize:"xs",justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement("h4",null,cases_translations.P)),isLoading&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingSpinner,{"data-test-subj":"tag-list-loading"}),!isLoading&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{"data-test-subj":"tag-list-edit",grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{"data-test-subj":"tag-list-edit-button",isDisabled:disabled,"aria-label":EDIT_TAGS_ARIA,iconType:"pencil",onClick:setIsEditTags.bind(null,!0)}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHorizontalRule,{margin:"xs"}),external_kbnSharedDeps_React_default.a.createElement(MyFlexGroup,{gutterSize:"none","data-test-subj":"case-tags"},0===tags.length&&!isEditTags&&external_kbnSharedDeps_React_default.a.createElement("p",{"data-test-subj":"no-tags"},cases_translations.z),!isEditTags&&external_kbnSharedDeps_React_default.a.createElement(Tags,{tags:tags,color:"hollow"}),isEditTags&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{"data-test-subj":"edit-tags",direction:"column"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(shared_imports.f,{form:form},external_kbnSharedDeps_React_default.a.createElement(tag_list_CommonUseField,{path:"tags",componentProps:{idAria:"caseTags","data-test-subj":"caseTags",euiFieldProps:{fullWidth:!0,placeholder:"",options:options,noSuggestions:!1}}}),external_kbnSharedDeps_React_default.a.createElement(shared_imports.g,{pathsToWatch:"tags"},({tags:anotherTags})=>{const current=options.map(opt=>opt.label),newOptions=anotherTags.reduce((acc,item)=>acc.includes(item)?acc:[...acc,item],current);return Object(external_kbnSharedDeps_LodashFp_.isEqual)(current,newOptions)||setOptions(newOptions.map(label=>({label:label}))),null}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{color:"secondary","data-test-subj":"edit-tags-submit",fill:!0,iconType:"save",onClick:onSubmitTags,size:"s"},cases_translations.K)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{"data-test-subj":"edit-tags-cancel",iconType:"cross",onClick:setIsEditTags.bind(null,!1),size:"s"},cases_translations.e)))))))});TagList.displayName="TagList";var containers_translations=__webpack_require__(127),containers_api=__webpack_require__(167);const dataFetchReducer=(state,action)=>{switch(action.type){case"FETCH_INIT":return{...state,isLoading:!0,isError:!1};case"FETCH_SUCCESS":return{...state,isLoading:!1,isError:!1,data:action.payload};case"FETCH_FAILURE":return{...state,isLoading:!1,isError:!0};case"UPDATE_CASE":return{...state,data:action.payload};default:return state}};var classnames=__webpack_require__(293),classnames_default=__webpack_require__.n(classnames),Either=__webpack_require__(4);const ADDED_FIELD=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.cases.caseView.actionLabel.addedField",{defaultMessage:"added"}),CHANGED_FIELD=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.cases.caseView.actionLabel.changededField",{defaultMessage:"changed"}),REMOVED_THIRD_PARTY=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.cases.caseView.actionLabel.removedThirdParty",{defaultMessage:"removed external incident management system"}),EDITED_FIELD=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.cases.caseView.actionLabel.editedField",{defaultMessage:"edited"}),REMOVED_FIELD=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.cases.caseView.actionLabel.removedField",{defaultMessage:"removed"}),PUSHED_NEW_INCIDENT=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.cases.caseView.actionLabel.pushedNewIncident",{defaultMessage:"pushed as new incident"}),UPDATE_INCIDENT=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.cases.caseView.actionLabel.updateIncident",{defaultMessage:"updated incident"}),ADDED_DESCRIPTION=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.cases.caseView.actionLabel.addDescription",{defaultMessage:"added description"}),EDIT_DESCRIPTION=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.cases.caseView.edit.description",{defaultMessage:"Edit description"}),QUOTE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.cases.caseView.edit.quote",{defaultMessage:"Quote"}),EDIT_COMMENT=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.cases.caseView.edit.comment",{defaultMessage:"Edit comment"}),translations_STATUS=(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.cases.caseView.actionLabel.on",{defaultMessage:"on"}),external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.cases.caseView.actionLabel.addComment",{defaultMessage:"added comment"}),external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.cases.caseView.statusLabel",{defaultMessage:"Status"})),COMMENT=(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.cases.caseView.case",{defaultMessage:"case"}),external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.cases.caseView.comment",{defaultMessage:"comment"})),CASE_REFRESH=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.cases.caseView.caseRefresh",{defaultMessage:"Refresh case"}),CHANGED_CONNECTOR_FIELD=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.cases.caseView.fieldChanged",{defaultMessage:"changed connector field"}),SYNC_ALERTS=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.cases.caseView.syncAlertsLabel",{defaultMessage:"Sync alerts"}),REQUIRED_UPDATE_TO_SERVICE=externalService=>external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.cases.caseView.requiredUpdateToExternalService",{values:{externalService:externalService},defaultMessage:"Requires update to { externalService } incident"}),COPY_REFERENCE_LINK=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.cases.caseView.copyCommentLinkAria",{defaultMessage:"Copy reference link"}),MOVE_TO_ORIGINAL_COMMENT=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.cases.caseView.moveToCommentAria",{defaultMessage:"Highlight the referenced comment"}),ALERT_COMMENT_LABEL_TITLE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.cases.caseView.alertCommentLabelTitle",{defaultMessage:"added an alert from"}),GENERATED_ALERT_COMMENT_LABEL_TITLE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.cases.caseView.generatedAlertCommentLabelTitle",{defaultMessage:"were added from"}),SHOW_ALERT_TOOLTIP=(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.cases.caseView.alertRuleDeletedLabelTitle",{defaultMessage:"added an alert"}),external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.cases.caseView.showAlertTooltip",{defaultMessage:"Show alert details"})),SEND_ALERT_TO_TIMELINE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.cases.caseView.sendAlertToTimelineTooltip",{defaultMessage:"Investigate in timeline"}),UNKNOWN_RULE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.cases.caseView.unknownRule.label",{defaultMessage:"Unknown rule"}),use_update_comment_dataFetchReducer=(state,action)=>{switch(action.type){case"FETCH_INIT":return{...state,isLoadingIds:[...state.isLoadingIds,action.payload],isError:!1};case"FETCH_SUCCESS":return{...state,isLoadingIds:state.isLoadingIds.filter(id=>action.payload.commentId!==id),isError:!1};case"FETCH_FAILURE":return{...state,isLoadingIds:state.isLoadingIds.filter(id=>action.payload!==id),isError:!0};default:return state}};var use_post_comment=__webpack_require__(668);const{emptyField:schema_emptyField}=shared_imports.v,add_comment_schema_schema={comment:{type:shared_imports.d.TEXTAREA,validations:[{validator:schema_emptyField(cases_translations.k)}]}};var timeline_actions=__webpack_require__(20);const useInsertTimeline=(value,onChange)=>{const dispatch=Object(react_redux_lib.useDispatch)(),{formatUrl:formatUrl}=Object(link_to.o)(app_types.a.timelines),insertTimeline=Object(use_selector.b)(store_timeline.b.selectInsertTimeline),handleOnTimelineChange=Object(external_kbnSharedDeps_React_.useCallback)((title,id,graphEventId)=>{let newValue=`[${title}](${formatUrl(Object(link_to.n)(null!=id?id:"",graphEventId),{absolute:!0,skipSearch:!0})})`;Object(external_kbnSharedDeps_LodashFp_.isEmpty)(value)||(newValue=`${value} ${newValue}`),onChange(newValue)},[value,onChange,formatUrl]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{null!=insertTimeline&&null!=value&&(dispatch(store_timeline.a.showTimeline({id:insertTimeline.timelineId,show:!1})),handleOnTimelineChange(insertTimeline.timelineTitle,insertTimeline.timelineSavedObjectId,insertTimeline.graphEventId),dispatch(Object(timeline_actions.setInsertTimeline)(null)))},[insertTimeline,dispatch,handleOnTimelineChange,value]),{handleOnTimelineChange:handleOnTimelineChange}},add_comment_MySpinner=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiLoadingSpinner).withConfig({displayName:"MySpinner",componentId:"sc-12tgh7e-0"})(["position:absolute;top:50%;left:50%;"]),initialCommentValue={comment:""},AddComment=external_kbnSharedDeps_React_default.a.memo(Object(external_kbnSharedDeps_React_.forwardRef)(({caseId:caseId,disabled:disabled,onCommentPosted:onCommentPosted,onCommentSaving:onCommentSaving,showLoading:showLoading=!0,subCaseId:subCaseId},ref)=>{const{isLoading:isLoading,postComment:postComment}=Object(use_post_comment.a)(),{form:form}=Object(shared_imports.I)({defaultValue:initialCommentValue,options:{stripEmptyFields:!1},schema:add_comment_schema_schema}),{setFieldValue:setFieldValue,reset:reset,submit:submit}=form,[{comment:comment}]=Object(shared_imports.K)({form:form,watch:["comment"]}),addQuote=Object(external_kbnSharedDeps_React_.useCallback)(quote=>{setFieldValue("comment",`${comment}${comment.length>0?"\n\n":""}${quote}`)},[comment,setFieldValue]);Object(external_kbnSharedDeps_React_.useImperativeHandle)(ref,()=>({addQuote:addQuote}));const onTimelineAttached=Object(external_kbnSharedDeps_React_.useCallback)(newValue=>setFieldValue("comment",newValue),[setFieldValue]);useInsertTimeline(null!=comment?comment:"",onTimelineAttached);const onSubmit=Object(external_kbnSharedDeps_React_.useCallback)(async()=>{const{isValid:isValid,data:data}=await submit();isValid&&(null!=onCommentSaving&&onCommentSaving(),postComment({caseId:caseId,data:{...data,type:common_api.k.user},updateCase:onCommentPosted,subCaseId:subCaseId}),reset())},[caseId,onCommentPosted,onCommentSaving,postComment,reset,submit,subCaseId]);return external_kbnSharedDeps_React_default.a.createElement("span",{id:"add-comment-permLink"},isLoading&&showLoading&&external_kbnSharedDeps_React_default.a.createElement(add_comment_MySpinner,{"data-test-subj":"loading-spinner",size:"xl"}),external_kbnSharedDeps_React_default.a.createElement(shared_imports.f,{form:form},external_kbnSharedDeps_React_default.a.createElement(shared_imports.k,{path:"comment",component:eui_form.a,componentProps:{idAria:"caseComment",isDisabled:isLoading,dataTestSubj:"add-comment",placeholder:cases_translations.c,bottomRightContent:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{"data-test-subj":"submit-comment",iconType:"plusInCircle",isDisabled:isLoading||disabled,isLoading:isLoading,onClick:onSubmit,size:"s"},cases_translations.b)}})))}));AddComment.displayName="AddComment";var containers_utils=__webpack_require__(140);const UserActionUsernameComponent=({username:username,fullName:fullName})=>{var _ref;const tooltipContent=null!==(_ref=Object(external_kbnSharedDeps_LodashFp_.isEmpty)(fullName)?username:fullName)&&void 0!==_ref?_ref:cases_translations.T;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{position:"top",content:external_kbnSharedDeps_React_default.a.createElement("p",null,tooltipContent),"data-test-subj":"user-action-username-tooltip"},external_kbnSharedDeps_React_default.a.createElement("strong",null,null!=username?username:cases_translations.T.toLowerCase()))},UserActionUsername=Object(external_kbnSharedDeps_React_.memo)(UserActionUsernameComponent),UserActionUsernameWithAvatarComponent=({username:username,fullName:fullName})=>{var _ref;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{responsive:!1,alignItems:"center",gutterSize:"s","data-test-subj":"user-action-username-with-avatar"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiAvatar,{size:"s",name:null!==(_ref=Object(external_kbnSharedDeps_LodashFp_.isEmpty)(fullName)?username:fullName)&&void 0!==_ref?_ref:cases_translations.T,"data-test-subj":"user-action-username-avatar"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(UserActionUsername,{username:username,fullName:fullName})))},UserActionUsernameWithAvatar=Object(external_kbnSharedDeps_React_.memo)(UserActionUsernameWithAvatarComponent),UserActionTimestampComponent=({createdAt:createdAt,updatedAt:updatedAt})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(localized_date_tooltip.a,{date:new Date(createdAt)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedRelative,{"data-test-subj":"user-action-title-creation-relative-time",value:createdAt})),updatedAt&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTextColor,{color:"subdued"}," (",EDITED_FIELD," ",external_kbnSharedDeps_React_default.a.createElement(localized_date_tooltip.a,{date:new Date(updatedAt)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedRelative,{"data-test-subj":"user-action-title-edited-relative-time",value:updatedAt})),")")),UserActionTimestamp=Object(external_kbnSharedDeps_React_.memo)(UserActionTimestampComponent);var copy_to_clipboard=__webpack_require__(610),copy_to_clipboard_default=__webpack_require__.n(copy_to_clipboard);const UserActionCopyLinkComponent=({id:commentId})=>{const{detailName:caseId,subCaseId:subCaseId}=Object(external_kbnSharedDeps_ReactRouterDom_.useParams)(),{formatUrl:formatUrl}=Object(link_to.o)(app_types.a.case),handleAnchorLink=Object(external_kbnSharedDeps_React_.useCallback)(()=>{copy_to_clipboard_default()(formatUrl(Object(link_to.c)({id:caseId,commentId:commentId,subCaseId:subCaseId}),{absolute:!0}))},[caseId,commentId,formatUrl,subCaseId]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{position:"top",content:external_kbnSharedDeps_React_default.a.createElement("p",null,COPY_REFERENCE_LINK)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{"aria-label":COPY_REFERENCE_LINK,"data-test-subj":"copy-link-"+commentId,onClick:handleAnchorLink,iconType:"link",id:commentId+"-permLink"}))},UserActionCopyLink=Object(external_kbnSharedDeps_React_.memo)(UserActionCopyLinkComponent),UserActionMoveToReferenceComponent=({id:id,outlineComment:outlineComment})=>{const handleMoveToLink=Object(external_kbnSharedDeps_React_.useCallback)(()=>{outlineComment(id)},[id,outlineComment]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{position:"top",content:external_kbnSharedDeps_React_default.a.createElement("p",null,MOVE_TO_ORIGINAL_COMMENT)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{"aria-label":MOVE_TO_ORIGINAL_COMMENT,"data-test-subj":"move-to-link-"+id,onClick:handleMoveToLink,iconType:"arrowUp"}))},UserActionMoveToReference=Object(external_kbnSharedDeps_React_.memo)(UserActionMoveToReferenceComponent);var components_status=__webpack_require__(178);const UserActionShowAlertComponent=({id:id,alertId:alertId,index:index,onShowAlertDetails:onShowAlertDetails})=>{const onClick=Object(external_kbnSharedDeps_React_.useCallback)(()=>onShowAlertDetails(alertId,index),[alertId,index,onShowAlertDetails]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{position:"top",content:external_kbnSharedDeps_React_default.a.createElement("p",null,SHOW_ALERT_TOOLTIP)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{"aria-label":SHOW_ALERT_TOOLTIP,"data-test-subj":"comment-action-show-alert-"+id,onClick:onClick,iconType:"arrowRight",id:id+"-show-alert"}))},UserActionShowAlert=Object(external_kbnSharedDeps_React_.memo)(UserActionShowAlertComponent),AlertCommentEventComponent=({alertId:alertId,loadingAlertData:loadingAlertData=!1,ruleId:ruleId,ruleName:ruleName,alertsCount:alertsCount,commentType:commentType})=>{const{navigateToApp:navigateToApp}=Object(lib_kibana.h)().services.application,{formatUrl:formatUrl,search:urlSearch}=Object(link_to.o)(app_types.a.detections),onLinkClick=Object(external_kbnSharedDeps_React_.useCallback)(ev=>{ev.preventDefault(),navigateToApp(`${constants.f}:${app_types.a.detections}`,{path:Object(link_to.l)(null!=ruleId?ruleId:"")})},[ruleId,navigateToApp]);return commentType!==common_api.k.generatedAlert?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,ALERT_COMMENT_LABEL_TITLE+" ",loadingAlertData&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingSpinner,{size:"m"}),!loadingAlertData&&!Object(external_kbnSharedDeps_Lodash_.isEmpty)(ruleId)&&external_kbnSharedDeps_React_default.a.createElement(links.f,{onClick:onLinkClick,href:formatUrl(Object(link_to.l)(null!=ruleId?ruleId:"",urlSearch)),"data-test-subj":"alert-rule-link-"+(null!=alertId?alertId:"deleted")},null!=ruleName?ruleName:UNKNOWN_RULE),!loadingAlertData&&Object(external_kbnSharedDeps_Lodash_.isEmpty)(ruleId)&&UNKNOWN_RULE):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement("b",null,(totalCount=null!=alertsCount?alertsCount:0,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.cases.caseView.generatedAlertCountCommentLabelTitle",{values:{totalCount:totalCount},defaultMessage:"{totalCount} {totalCount, plural, =1 {alert} other {alerts}}"})))," ",GENERATED_ALERT_COMMENT_LABEL_TITLE," ",loadingAlertData&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingSpinner,{size:"m"}),!loadingAlertData&&""!==ruleId&&external_kbnSharedDeps_React_default.a.createElement(links.f,{onClick:onLinkClick,href:formatUrl(Object(link_to.l)(null!=ruleId?ruleId:"",urlSearch)),"data-test-subj":"alert-rule-link-"+(null!=alertId?alertId:"deleted")},ruleName),!loadingAlertData&&""===ruleId&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,ruleName));var totalCount},AlertCommentEvent=Object(external_kbnSharedDeps_React_.memo)(AlertCommentEventComponent);var investigate_in_timeline_action=__webpack_require__(667);const buildAlertsQuery=alertIds=>0===alertIds.length?{}:{query:{bool:{filter:{ids:{values:alertIds}}}},size:1e4},getLabelTitle=({action:action,field:field})=>{if("tags"===field)return getTagsLabelTitle(action);if("title"===field&&"update"===action.action)return`${CHANGED_FIELD.toLowerCase()} ${cases_translations.f.toLowerCase()}  ${cases_translations.S} "${action.newValue}"`;if("description"===field&&"update"===action.action)return`${EDITED_FIELD} ${cases_translations.r.toLowerCase()}`;if("status"===field&&"update"===action.action){var _action$newValue;const status=null!==(_action$newValue=action.newValue)&&void 0!==_action$newValue?_action$newValue:"";return(status=>Object.prototype.hasOwnProperty.call(components_status.d,status))(status)?((id,status)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s",alignItems:"center","data-test-subj":id+"-user-action-status-title"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},cases_translations.u),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(components_status.b,{type:status}))))(action.actionId,status):""}return"comment"===field&&"update"===action.action?`${EDITED_FIELD} ${COMMENT.toLowerCase()}`:""},getConnectorLabelTitle=({action:action,connectors:connectors})=>{const oldValue=Object(containers_utils.m)(""+action.oldValue),newValue=Object(containers_utils.m)(""+action.newValue);if(null===oldValue||null===newValue)return"";if(oldValue.id!==newValue.id){const newConnector=connectors.find(c=>c.id===newValue.id);return null!=newValue.id&&"none"!==newValue.id&&null!=newConnector?(thirdParty=newConnector.name,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.cases.caseView.actionLabel.selectedThirdParty",{values:{thirdParty:thirdParty},defaultMessage:"selected { thirdParty } as incident management system"})):REMOVED_THIRD_PARTY}return CHANGED_CONNECTOR_FIELD;var thirdParty},getTagsLabelTitle=action=>{const tags=null!=action.newValue?action.newValue.split(","):[];return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"baseline",gutterSize:"xs",component:"span"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{"data-test-subj":"ua-tags-label",grow:!1},"add"===action.action&&ADDED_FIELD,"delete"===action.action&&REMOVED_FIELD," ",cases_translations.P.toLowerCase()),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(Tags,{tags:tags,gutterSize:"xs"})))},getUpdateAction=({action:action,label:label,handleOutlineComment:handleOutlineComment})=>{return{username:external_kbnSharedDeps_React_default.a.createElement(UserActionUsernameWithAvatar,{username:action.actionBy.username,fullName:action.actionBy.fullName}),type:"update",event:label,"data-test-subj":`${action.actionField[0]}-${action.action}-action-${action.actionId}`,timestamp:external_kbnSharedDeps_React_default.a.createElement(UserActionTimestamp,{createdAt:action.actionAt}),timelineIcon:(actionField=action.actionField[0],"tags"===actionField?"tag":"status"===actionField?"folderClosed":"dot"),actions:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(UserActionCopyLink,{id:action.actionId})),"update"===action.action&&null!=action.commentId&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(UserActionMoveToReference,{id:action.commentId,outlineComment:handleOutlineComment})))};var actionField},getAlertAttachment=({action:action,alertId:alertId,index:index,loadingAlertData:loadingAlertData,ruleId:ruleId,ruleName:ruleName,onShowAlertDetails:onShowAlertDetails})=>({username:external_kbnSharedDeps_React_default.a.createElement(UserActionUsernameWithAvatar,{username:action.actionBy.username,fullName:action.actionBy.fullName}),className:"comment-alert",type:"update",event:external_kbnSharedDeps_React_default.a.createElement(AlertCommentEvent,{alertId:alertId,loadingAlertData:loadingAlertData,ruleId:ruleId,ruleName:ruleName,commentType:common_api.k.alert}),"data-test-subj":`${action.actionField[0]}-${action.action}-action-${action.actionId}`,timestamp:external_kbnSharedDeps_React_default.a.createElement(UserActionTimestamp,{createdAt:action.actionAt}),timelineIcon:"bell",actions:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(UserActionCopyLink,{id:action.actionId})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(UserActionShowAlert,{id:action.actionId,alertId:alertId,index:index,onShowAlertDetails:onShowAlertDetails})))}),toStringArray=value=>{if(Array.isArray(value))return value.reduce((acc,v)=>{if(null!=v)switch(typeof v){case"number":case"boolean":return[...acc,v.toString()];case"object":try{return[...acc,JSON.stringify(v)]}catch{return[...acc,"Invalid Object"]}case"string":return[...acc,v];default:return[...acc,""+v]}return acc},[]);if(null==value)return[];if(Array.isArray(value)||"object"!=typeof value)return[""+value];try{return[JSON.stringify(value)]}catch{return["Invalid Object"]}},formatAlertToEcsSignal=alert=>Object.keys(alert).reduce((accumulator,key)=>{const item=Object(external_kbnSharedDeps_Lodash_.get)(alert,key);return null!=item&&Object(external_kbnSharedDeps_Lodash_.isObject)(item)?{...accumulator,[key]:formatAlertToEcsSignal(item)}:Array.isArray(item)||Object(external_kbnSharedDeps_Lodash_.isString)(item)||Object(external_kbnSharedDeps_Lodash_.isNumber)(item)?{...accumulator,[key]:toStringArray(item)}:accumulator},{}),EMPTY_ARRAY=[],getGeneratedAlertsAttachment=({action:action,alertIds:alertIds,ruleId:ruleId,ruleName:ruleName})=>({username:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{type:"logoSecurity",size:"m"}),className:"comment-alert",type:"update",event:external_kbnSharedDeps_React_default.a.createElement(AlertCommentEvent,{alertId:alertIds[0],ruleId:ruleId,ruleName:ruleName,alertsCount:alertIds.length,commentType:common_api.k.generatedAlert}),"data-test-subj":`${action.actionField[0]}-${action.action}-action-${action.actionId}`,timestamp:external_kbnSharedDeps_React_default.a.createElement(UserActionTimestamp,{createdAt:action.actionAt}),timelineIcon:"bell",actions:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(UserActionCopyLink,{id:action.actionId})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(investigate_in_timeline_action.a,{ariaLabel:SEND_ALERT_TO_TIMELINE,alertIds:alertIds,key:"investigate-in-timeline",ecsRowData:null,fetchEcsAlertsData:async fetchAlertIds=>{var _alertResponse$hits$h;if(Object(external_kbnSharedDeps_Lodash_.isEmpty)(fetchAlertIds))return[];const alertResponse=await lib_kibana.b.get().http.fetch(constants.K,{method:"POST",body:JSON.stringify(buildAlertsQuery(null!=fetchAlertIds?fetchAlertIds:[]))});return null!==(_alertResponse$hits$h=null==alertResponse?void 0:alertResponse.hits.hits.reduce((acc,{_id:_id,_index:_index,_source:_source})=>[...acc,{...formatAlertToEcsSignal(_source),_id:_id,_index:_index,timestamp:_source["@timestamp"]}],[]))&&void 0!==_alertResponse$hits$h?_alertResponse$hits$h:[]},nonEcsRowData:EMPTY_ARRAY})))}),UserActionAvatarComponent=({username:username,fullName:fullName})=>{const avatarName=fullName&&fullName.length>0?fullName:null!=username?username:cases_translations.T;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiAvatar,{name:avatarName,"data-test-subj":"user-action-avatar"})},UserActionAvatar=Object(external_kbnSharedDeps_React_.memo)(UserActionAvatarComponent),{emptyField:user_action_tree_schema_emptyField}=shared_imports.v,user_action_tree_schema_schema={content:{type:shared_imports.d.TEXTAREA,validations:[{validator:user_action_tree_schema_emptyField(cases_translations.J)}]}},ContentWrapper=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"ContentWrapper",componentId:"t03oqe-0"})(["padding:",";"],({theme:theme})=>`${theme.eui.euiSizeM} ${theme.eui.euiSizeL}`),UserActionMarkdown=({id:id,content:content,isEditable:isEditable,onChangeEditable:onChangeEditable,onSaveContent:onSaveContent})=>{const initialState={content:content},{form:form}=Object(shared_imports.I)({defaultValue:initialState,options:{stripEmptyFields:!1},schema:user_action_tree_schema_schema}),{submit:submit}=form,handleCancelAction=Object(external_kbnSharedDeps_React_.useCallback)(()=>{onChangeEditable(id)},[id,onChangeEditable]),handleSaveAction=Object(external_kbnSharedDeps_React_.useCallback)(async()=>{const{isValid:isValid,data:data}=await submit();isValid&&onSaveContent(data.content),onChangeEditable(id)},[id,onChangeEditable,onSaveContent,submit]),renderButtons=Object(external_kbnSharedDeps_React_.useCallback)(({cancelAction:cancelAction,saveAction:saveAction})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{"data-test-subj":"user-action-cancel-markdown",size:"s",onClick:cancelAction,iconType:"cross"},cases_translations.e)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{"data-test-subj":"user-action-save-markdown",color:"secondary",fill:!0,iconType:"save",onClick:saveAction,size:"s"},cases_translations.K))),[]);return isEditable?external_kbnSharedDeps_React_default.a.createElement(shared_imports.f,{form:form,"data-test-subj":"user-action-markdown-form"},external_kbnSharedDeps_React_default.a.createElement(shared_imports.k,{path:"content",component:markdown_editor.MarkdownEditorForm,componentProps:{"aria-label":"Cases markdown editor",value:content,id:id,bottomRightContent:renderButtons({cancelAction:handleCancelAction,saveAction:handleSaveAction})}})):external_kbnSharedDeps_React_default.a.createElement(ContentWrapper,{"data-test-subj":"user-action-markdown"},external_kbnSharedDeps_React_default.a.createElement(markdown_editor.MarkdownRenderer,null,content))},ACTIONS_ARIA=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.cases.caseView.editActionsLinkAria",{defaultMessage:"click to see all actions"}),PropertyActionButton=external_kbnSharedDeps_React_default.a.memo(({disabled:disabled=!1,onClick:onClick,iconType:iconType,label:label})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{"data-test-subj":"property-actions-"+iconType,"aria-label":label,color:"text",iconSide:"left",iconType:iconType,isDisabled:disabled,onClick:onClick},label));PropertyActionButton.displayName="PropertyActionButton";const PropertyActions=external_kbnSharedDeps_React_default.a.memo(({propertyActions:propertyActions})=>{const[showActions,setShowActions]=Object(external_kbnSharedDeps_React_.useState)(!1),onButtonClick=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setShowActions(!showActions)},[showActions]),onClosePopover=Object(external_kbnSharedDeps_React_.useCallback)(cb=>{setShowActions(!1),null!=cb&&cb()},[]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"flexStart","data-test-subj":"property-actions",gutterSize:"none"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopover,{anchorPosition:"downRight",ownFocus:!0,button:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{"data-test-subj":"property-actions-ellipses","aria-label":ACTIONS_ARIA,iconType:"boxesHorizontal",onClick:onButtonClick}),id:"settingsPopover",isOpen:showActions,closePopover:onClosePopover,repositionOnScroll:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"flexStart","data-test-subj":"property-actions-group",direction:"column",gutterSize:"none"},propertyActions.map((action,key)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,key:`${action.label}${key}`},external_kbnSharedDeps_React_default.a.createElement(PropertyActionButton,{disabled:action.disabled,iconType:action.iconType,label:action.label,onClick:()=>onClosePopover(action.onClick)})))))))});PropertyActions.displayName="PropertyActions";const UserActionPropertyActionsComponent=({id:id,editLabel:editLabel,quoteLabel:quoteLabel,disabled:disabled,isLoading:isLoading,onEdit:onEdit,onQuote:onQuote})=>{const onEditClick=Object(external_kbnSharedDeps_React_.useCallback)(()=>onEdit(id),[id,onEdit]),onQuoteClick=Object(external_kbnSharedDeps_React_.useCallback)(()=>onQuote(id),[id,onQuote]),propertyActions=Object(external_kbnSharedDeps_React_.useMemo)(()=>[{disabled:disabled,iconType:"pencil",label:editLabel,onClick:onEditClick},{disabled:disabled,iconType:"quote",label:quoteLabel,onClick:onQuoteClick}],[disabled,editLabel,quoteLabel,onEditClick,onQuoteClick]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,isLoading&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingSpinner,{"data-test-subj":"user-action-title-loading"}),!isLoading&&external_kbnSharedDeps_React_default.a.createElement(PropertyActions,{propertyActions:propertyActions}))},UserActionPropertyActions=Object(external_kbnSharedDeps_React_.memo)(UserActionPropertyActionsComponent),UserActionContentToolbarComponent=({id:id,editLabel:editLabel,quoteLabel:quoteLabel,disabled:disabled,isLoading:isLoading,onEdit:onEdit,onQuote:onQuote})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(UserActionCopyLink,{id:id})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(UserActionPropertyActions,{id:id,editLabel:editLabel,quoteLabel:quoteLabel,disabled:disabled,isLoading:isLoading,onEdit:onEdit,onQuote:onQuote}))),UserActionContentToolbar=Object(external_kbnSharedDeps_React_.memo)(UserActionContentToolbarComponent),MyEuiFlexGroup=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup).withConfig({displayName:"MyEuiFlexGroup",componentId:"sc-1dz3qn9-0"})(["margin-bottom:8px;"]),MyEuiCommentList=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiCommentList).withConfig({displayName:"MyEuiCommentList",componentId:"sc-1dz3qn9-1"})(["",""],({theme:theme})=>`\n    & .userAction__comment.outlined .euiCommentEvent {\n      outline: solid 5px ${theme.eui.euiColorVis1_behindText};\n      margin: 0.5em;\n      transition: 0.8s;\n    }\n\n    & .euiComment.isEdit {\n      & .euiCommentEvent {\n        border: none;\n        box-shadow: none;\n      }\n\n      & .euiCommentEvent__body {\n        padding: 0;\n      }\n\n      & .euiCommentEvent__header {\n        display: none;\n      }\n    }\n\n    & .comment-alert .euiCommentEvent {\n      background-color: ${theme.eui.euiColorLightestShade};\n      border: ${theme.eui.euiFlyoutBorder};\n      padding: 10px;\n      border-radius: ${theme.eui.paddingSizes.xs};\n    }\n\n    & .comment-alert .euiCommentEvent__headerData {\n      flex-grow: 1;\n    }\n  `),UserActionTree=external_kbnSharedDeps_React_default.a.memo(({data:caseData,caseServices:caseServices,caseUserActions:caseUserActions,connectors:connectors,fetchUserActions:fetchUserActions,isLoadingDescription:isLoadingDescription,isLoadingUserActions:isLoadingUserActions,onUpdateField:onUpdateField,updateCase:updateCase,userCanCrud:userCanCrud,onShowAlertDetails:onShowAlertDetails})=>{const{detailName:caseId,commentId:commentId,subCaseId:subCaseId}=Object(external_kbnSharedDeps_ReactRouterDom_.useParams)(),handlerTimeoutId=Object(external_kbnSharedDeps_React_.useRef)(0),addCommentRef=Object(external_kbnSharedDeps_React_.useRef)(null),[initLoading,setInitLoading]=Object(external_kbnSharedDeps_React_.useState)(!0),[selectedOutlineCommentId,setSelectedOutlineCommentId]=Object(external_kbnSharedDeps_React_.useState)(""),{isLoadingIds:isLoadingIds,patchComment:patchComment}=(()=>{const[state,dispatch]=Object(external_kbnSharedDeps_React_.useReducer)(use_update_comment_dataFetchReducer,{isLoadingIds:[],isError:!1}),[,dispatchToaster]=Object(toasters.h)(),isCancelledRef=Object(external_kbnSharedDeps_React_.useRef)(!1),abortCtrlRef=Object(external_kbnSharedDeps_React_.useRef)(new AbortController),dispatchUpdateComment=Object(external_kbnSharedDeps_React_.useCallback)(async({caseId:caseId,commentId:commentId,commentUpdate:commentUpdate,fetchUserActions:fetchUserActions,subCaseId:subCaseId,updateCase:updateCase,version:version})=>{try{isCancelledRef.current=!1,abortCtrlRef.current.abort(),abortCtrlRef.current=new AbortController,dispatch({type:"FETCH_INIT",payload:commentId});const response=await Object(containers_api.n)(caseId,commentId,commentUpdate,version,abortCtrlRef.current.signal,subCaseId);isCancelledRef.current||(updateCase(response),fetchUserActions(),dispatch({type:"FETCH_SUCCESS",payload:{commentId:commentId}}))}catch(error){isCancelledRef.current||("AbortError"!==error.name&&Object(toasters.g)({title:containers_translations.d,error:error.body&&error.body.message?new Error(error.body.message):error,dispatchToaster:dispatchToaster}),dispatch({type:"FETCH_FAILURE",payload:commentId}))}},[]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>()=>{isCancelledRef.current=!0,abortCtrlRef.current.abort()},[]),{...state,patchComment:dispatchUpdateComment}})(),currentUser=Object(lib_kibana.d)(),[manageMarkdownEditIds,setManangeMardownEditIds]=Object(external_kbnSharedDeps_React_.useState)([]),[loadingAlertData,manualAlertsData]=(alertIds=>{const{selectedPatterns:selectedPatterns}=Object(sourcerer.b)(model.SourcererScopeName.detections),alertsQuery=Object(external_kbnSharedDeps_React_.useMemo)(()=>buildAlertsQuery(alertIds),[alertIds]),{loading:isLoadingAlerts,data:alertsData}=Object(use_query.a)(alertsQuery,selectedPatterns[0]);return[isLoadingAlerts,Object(external_kbnSharedDeps_React_.useMemo)(()=>{var _alertsData$hits$hits;return null!==(_alertsData$hits$hits=null==alertsData?void 0:alertsData.hits.hits.reduce((acc,{_id:_id,_index:_index,_source:_source})=>({...acc,[_id]:{...formatAlertToEcsSignal(_source),_id:_id,_index:_index,timestamp:_source["@timestamp"]}}),{}))&&void 0!==_alertsData$hits$hits?_alertsData$hits$hits:{}},[null==alertsData?void 0:alertsData.hits.hits])]})((comments=>[...comments.reduce((alertIds,comment)=>{if(comment.type===common_api.k.alert&&Object(external_kbnSharedDeps_Lodash_.isEmpty)(comment.rule.id)){return(Array.isArray(comment.alertId)?comment.alertId:[comment.alertId]).forEach(id=>alertIds.add(id)),alertIds}return alertIds},new Set)])(caseData.comments)),handleManageMarkdownEditId=Object(external_kbnSharedDeps_React_.useCallback)(id=>{manageMarkdownEditIds.includes(id)?setManangeMardownEditIds(manageMarkdownEditIds.filter(myId=>id!==myId)):setManangeMardownEditIds([...manageMarkdownEditIds,id])},[manageMarkdownEditIds]),handleSaveComment=Object(external_kbnSharedDeps_React_.useCallback)(({id:id,version:version},content)=>{patchComment({caseId:caseId,commentId:id,commentUpdate:content,fetchUserActions:fetchUserActions,version:version,updateCase:updateCase,subCaseId:subCaseId})},[caseId,fetchUserActions,patchComment,subCaseId,updateCase]),handleOutlineComment=Object(external_kbnSharedDeps_React_.useCallback)(id=>{const moveToTarget=document.getElementById(id+"-permLink");if(null!=moveToTarget){const yOffset=-60,y=moveToTarget.getBoundingClientRect().top+window.pageYOffset+yOffset;window.scrollTo({top:y,behavior:"smooth"}),"add-comment"===id&&moveToTarget.getElementsByTagName("textarea")[0].focus()}window.clearTimeout(handlerTimeoutId.current),setSelectedOutlineCommentId(id),handlerTimeoutId.current=window.setTimeout(()=>{setSelectedOutlineCommentId(""),window.clearTimeout(handlerTimeoutId.current)},2400)},[handlerTimeoutId]),handleManageQuote=Object(external_kbnSharedDeps_React_.useCallback)(quote=>{const addCarrots=quote.replace(new RegExp("\r?\n","g"),"  \n> ");addCommentRef&&addCommentRef.current&&addCommentRef.current.addQuote(`> ${addCarrots} \n`),handleOutlineComment("add-comment")},[handleOutlineComment]),handleUpdate=Object(external_kbnSharedDeps_React_.useCallback)(newCase=>{updateCase(newCase),fetchUserActions()},[fetchUserActions,updateCase]),MarkdownDescription=Object(external_kbnSharedDeps_React_.useMemo)(()=>external_kbnSharedDeps_React_default.a.createElement(UserActionMarkdown,{id:"description",content:caseData.description,isEditable:manageMarkdownEditIds.includes("description"),onSaveContent:content=>{onUpdateField({key:"description",value:content})},onChangeEditable:handleManageMarkdownEditId}),[caseData.description,handleManageMarkdownEditId,manageMarkdownEditIds,onUpdateField]),MarkdownNewComment=Object(external_kbnSharedDeps_React_.useMemo)(()=>external_kbnSharedDeps_React_default.a.createElement(AddComment,{caseId:caseId,disabled:!userCanCrud,ref:addCommentRef,onCommentPosted:handleUpdate,onCommentSaving:handleManageMarkdownEditId.bind(null,"newComment"),showLoading:!1,subCaseId:subCaseId}),[caseId,userCanCrud,handleUpdate,handleManageMarkdownEditId,subCaseId]);Object(external_kbnSharedDeps_React_.useEffect)(()=>{initLoading&&!isLoadingUserActions&&0===isLoadingIds.length&&(setInitLoading(!1),null!=commentId&&handleOutlineComment(commentId))},[commentId,initLoading,isLoadingUserActions,isLoadingIds,handleOutlineComment]);const descriptionCommentListObj=Object(external_kbnSharedDeps_React_.useMemo)(()=>({username:external_kbnSharedDeps_React_default.a.createElement(UserActionUsername,{username:caseData.createdBy.username,fullName:caseData.createdBy.fullName}),event:ADDED_DESCRIPTION,"data-test-subj":"description-action",timestamp:external_kbnSharedDeps_React_default.a.createElement(UserActionTimestamp,{createdAt:caseData.createdAt}),children:MarkdownDescription,timelineIcon:external_kbnSharedDeps_React_default.a.createElement(UserActionAvatar,{username:caseData.createdBy.username,fullName:caseData.createdBy.fullName}),className:classnames_default()({isEdit:manageMarkdownEditIds.includes("description")}),actions:external_kbnSharedDeps_React_default.a.createElement(UserActionContentToolbar,{id:"description",editLabel:EDIT_DESCRIPTION,quoteLabel:QUOTE,disabled:!userCanCrud,isLoading:isLoadingDescription,onEdit:handleManageMarkdownEditId.bind(null,"description"),onQuote:handleManageQuote.bind(null,caseData.description)})}),[MarkdownDescription,caseData,handleManageMarkdownEditId,handleManageQuote,isLoadingDescription,userCanCrud,manageMarkdownEditIds]),comments=[...Object(external_kbnSharedDeps_React_.useMemo)(()=>caseUserActions.reduce((comments,action,index)=>{if(null!=action.commentId&&"create"===action.action){const comment=caseData.comments.find(c=>c.id===action.commentId);if(null!=comment&&Object(Either.isRight)(common_api.m.decode(comment))&&comment.type===common_api.k.user)return[...comments,{username:external_kbnSharedDeps_React_default.a.createElement(UserActionUsername,{username:comment.createdBy.username,fullName:comment.createdBy.fullName}),"data-test-subj":"comment-create-action-"+comment.id,timestamp:external_kbnSharedDeps_React_default.a.createElement(UserActionTimestamp,{createdAt:comment.createdAt,updatedAt:comment.updatedAt}),className:classnames_default()("userAction__comment",{outlined:comment.id===selectedOutlineCommentId,isEdit:manageMarkdownEditIds.includes(comment.id)}),children:external_kbnSharedDeps_React_default.a.createElement(UserActionMarkdown,{id:comment.id,content:comment.comment,isEditable:manageMarkdownEditIds.includes(comment.id),onChangeEditable:handleManageMarkdownEditId,onSaveContent:handleSaveComment.bind(null,{id:comment.id,version:comment.version})}),timelineIcon:external_kbnSharedDeps_React_default.a.createElement(UserActionAvatar,{username:comment.createdBy.username,fullName:comment.createdBy.fullName}),actions:external_kbnSharedDeps_React_default.a.createElement(UserActionContentToolbar,{id:comment.id,editLabel:EDIT_COMMENT,quoteLabel:QUOTE,disabled:!userCanCrud,isLoading:isLoadingIds.includes(comment.id),onEdit:handleManageMarkdownEditId.bind(null,comment.id),onQuote:handleManageQuote.bind(null,comment.comment)})}];if(null!=comment&&Object(Either.isRight)(common_api.a.decode(comment))&&comment.type===common_api.k.alert){var _ref,_comment$rule$id,_comment$rule,_manualAlertsData$ale,_manualAlertsData$ale2,_manualAlertsData$ale3,_manualAlertsData$ale4,_ref2,_comment$rule$name,_comment$rule2,_manualAlertsData$ale5,_manualAlertsData$ale6,_manualAlertsData$ale7,_manualAlertsData$ale8;const alertId=Array.isArray(comment.alertId)?comment.alertId.length>0?comment.alertId[0]:"":comment.alertId,alertIndex=Array.isArray(comment.index)?comment.index.length>0?comment.index[0]:"":comment.index;if(Object(external_kbnSharedDeps_Lodash_.isEmpty)(alertId))return comments;const ruleId=null!==(_ref=null!==(_comment$rule$id=null==comment||null===(_comment$rule=comment.rule)||void 0===_comment$rule?void 0:_comment$rule.id)&&void 0!==_comment$rule$id?_comment$rule$id:null===(_manualAlertsData$ale=manualAlertsData[alertId])||void 0===_manualAlertsData$ale||null===(_manualAlertsData$ale2=_manualAlertsData$ale.signal)||void 0===_manualAlertsData$ale2||null===(_manualAlertsData$ale3=_manualAlertsData$ale2.rule)||void 0===_manualAlertsData$ale3||null===(_manualAlertsData$ale4=_manualAlertsData$ale3.id)||void 0===_manualAlertsData$ale4?void 0:_manualAlertsData$ale4[0])&&void 0!==_ref?_ref:null,ruleName=null!==(_ref2=null!==(_comment$rule$name=null==comment||null===(_comment$rule2=comment.rule)||void 0===_comment$rule2?void 0:_comment$rule2.name)&&void 0!==_comment$rule$name?_comment$rule$name:null===(_manualAlertsData$ale5=manualAlertsData[alertId])||void 0===_manualAlertsData$ale5||null===(_manualAlertsData$ale6=_manualAlertsData$ale5.signal)||void 0===_manualAlertsData$ale6||null===(_manualAlertsData$ale7=_manualAlertsData$ale6.rule)||void 0===_manualAlertsData$ale7||null===(_manualAlertsData$ale8=_manualAlertsData$ale7.name)||void 0===_manualAlertsData$ale8?void 0:_manualAlertsData$ale8[0])&&void 0!==_ref2?_ref2:null;return[...comments,getAlertAttachment({action:action,alertId:alertId,index:alertIndex,loadingAlertData:loadingAlertData,ruleId:ruleId,ruleName:ruleName,onShowAlertDetails:onShowAlertDetails})]}if(null!=comment&&comment.type===common_api.k.generatedAlert){var _comment$rule$id2,_comment$rule3,_comment$rule$name2,_comment$rule4;const alertIds=Array.isArray(comment.alertId)?comment.alertId:[comment.alertId];return Object(external_kbnSharedDeps_Lodash_.isEmpty)(alertIds)?comments:[...comments,getGeneratedAlertsAttachment({action:action,alertIds:alertIds,ruleId:null!==(_comment$rule$id2=null===(_comment$rule3=comment.rule)||void 0===_comment$rule3?void 0:_comment$rule3.id)&&void 0!==_comment$rule$id2?_comment$rule$id2:"",ruleName:null!==(_comment$rule$name2=null===(_comment$rule4=comment.rule)||void 0===_comment$rule4?void 0:_comment$rule4.name)&&void 0!==_comment$rule$name2?_comment$rule$name2:UNKNOWN_RULE})]}}if(1===action.actionField.length&&"connector"===action.actionField[0]){const label=getConnectorLabelTitle({action:action,connectors:connectors});return[...comments,getUpdateAction({action:action,label:label,handleOutlineComment:handleOutlineComment})]}if(1===action.actionField.length&&"pushed"===action.actionField[0]){var _caseServices$parsedC,_caseServices$parsedC2;const parsedValue=Object(containers_utils.m)(""+action.newValue),{firstPush:firstPush,parsedConnectorId:parsedConnectorId,parsedConnectorName:parsedConnectorName}=((caseServices,parsedValue,index)=>{var _caseServices$parsedV;return null!=parsedValue?{firstPush:(null===(_caseServices$parsedV=caseServices[parsedValue.connector_id])||void 0===_caseServices$parsedV?void 0:_caseServices$parsedV.firstPushIndex)===index,parsedConnectorId:parsedValue.connector_id,parsedConnectorName:parsedValue.connector_name}:{firstPush:!1,parsedConnectorId:"none",parsedConnectorName:"none"}})(caseServices,parsedValue,index),label=((action,firstPush)=>{var _action$newValue2;const pushedVal=JSON.parse(null!==(_action$newValue2=action.newValue)&&void 0!==_action$newValue2?_action$newValue2:"");return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"baseline",gutterSize:"xs","data-test-subj":"pushed-service-label-title"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{"data-test-subj":"pushed-label"},`${firstPush?PUSHED_NEW_INCIDENT:UPDATE_INCIDENT} ${null==pushedVal?void 0:pushedVal.connector_name}`),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{"data-test-subj":"pushed-value",href:null==pushedVal?void 0:pushedVal.external_url,target:"_blank"},null==pushedVal?void 0:pushedVal.external_title)))})(action,firstPush),showTopFooter="push-to-service"===action.action&&index===(null===(_caseServices$parsedC=caseServices[parsedConnectorId])||void 0===_caseServices$parsedC?void 0:_caseServices$parsedC.lastPushIndex),showBottomFooter="push-to-service"===action.action&&index===(null===(_caseServices$parsedC2=caseServices[parsedConnectorId])||void 0===_caseServices$parsedC2?void 0:_caseServices$parsedC2.lastPushIndex)&&caseServices[parsedConnectorId].hasDataToPush;let footers=[];return showTopFooter&&(footers=[...footers,{username:"",type:"update",event:(externalService=""+parsedConnectorName,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.cases.caseView.alreadyPushedToExternalService",{values:{externalService:externalService},defaultMessage:"Already pushed to { externalService } incident"})),timelineIcon:"sortUp","data-test-subj":"top-footer"}]),showBottomFooter&&(footers=[...footers,{username:"",type:"update",event:REQUIRED_UPDATE_TO_SERVICE(""+parsedConnectorName),timelineIcon:"sortDown","data-test-subj":"bottom-footer"}]),[...comments,getUpdateAction({action:action,label:label,handleOutlineComment:handleOutlineComment}),...footers]}var externalService;if(1===action.actionField.length&&["title","description","comment","tags","status"].includes(action.actionField[0])){const myField=action.actionField[0],label=getLabelTitle({action:action,field:myField});return[...comments,getUpdateAction({action:action,label:label,handleOutlineComment:handleOutlineComment})]}return comments},[descriptionCommentListObj]),[caseData,caseServices,caseUserActions,connectors,handleOutlineComment,descriptionCommentListObj,handleManageMarkdownEditId,handleManageQuote,handleSaveComment,isLoadingIds,loadingAlertData,manualAlertsData,manageMarkdownEditIds,selectedOutlineCommentId,userCanCrud,onShowAlertDetails]),...[{username:external_kbnSharedDeps_React_default.a.createElement(UserActionUsername,{username:null==currentUser?void 0:currentUser.username,fullName:null==currentUser?void 0:currentUser.fullName}),"data-test-subj":"add-comment",timelineIcon:external_kbnSharedDeps_React_default.a.createElement(UserActionAvatar,{username:null==currentUser?void 0:currentUser.username,fullName:null==currentUser?void 0:currentUser.fullName}),className:"isEdit",children:MarkdownNewComment}]];return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(MyEuiCommentList,{comments:comments,"data-test-subj":"user-actions"}),(isLoadingUserActions||isLoadingIds.includes("newComment"))&&external_kbnSharedDeps_React_default.a.createElement(MyEuiFlexGroup,{justifyContent:"center",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingSpinner,{"data-test-subj":"user-actions-loading",size:"l"}))))});UserActionTree.displayName="UserActionTree";const MyAvatar=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiAvatar).withConfig({displayName:"MyAvatar",componentId:"i4ieve-0"})(["top:-4px;"]),user_list_MyFlexGroup=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup).withConfig({displayName:"MyFlexGroup",componentId:"i4ieve-1"})(["",""],({theme:theme})=>Object(external_kbnSharedDeps_StyledComponents_.css)(["margin-top:",";"],theme.eui.euiSizeM)),UserList=external_kbnSharedDeps_React_default.a.memo(({email:email,headline:headline,loading:loading,users:users})=>{const handleSendEmail=Object(external_kbnSharedDeps_React_.useCallback)(emailAddress=>{emailAddress&&null!=emailAddress&&window.open(`mailto:${emailAddress}?subject=${email.subject}&body=${email.body}`,"_blank")},[email.subject]);return users.filter(({username:username})=>null!=username&&""!==username).length>0?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement("h4",null,headline),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHorizontalRule,{margin:"xs"}),loading&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingSpinner,null))),((users,handleSendEmail)=>users.map(({fullName:fullName,username:username,email:email},key)=>{return external_kbnSharedDeps_React_default.a.createElement(user_list_MyFlexGroup,{key:key,justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"xs"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(MyAvatar,{name:fullName||(null!=username?username:"")})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{position:"top",content:external_kbnSharedDeps_React_default.a.createElement("p",null,fullName||(null!=username?username:""))},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement("strong",null,external_kbnSharedDeps_React_default.a.createElement("small",{"data-test-subj":"case-view-username"},username))))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{"data-test-subj":"user-list-email-button",onClick:handleSendEmail.bind(null,email),iconType:"email","aria-label":(user=fullName||(null!=username?username:""),external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.cases.caseView.sendEmalLinkAria",{values:{user:user},defaultMessage:"click to send an email to {user}"})),isDisabled:Object(external_kbnSharedDeps_LodashFp_.isEmpty)(email)})));var user}))(users.filter(({username:username})=>null!=username&&""!==username),handleSendEmail)):null});UserList.displayName="UserList";const use_update_case_dataFetchReducer=(state,action)=>{switch(action.type){case"FETCH_INIT":return{...state,isLoading:!0,isError:!1,updateKey:action.payload};case"FETCH_SUCCESS":return{...state,isLoading:!1,isError:!1,updateKey:null};case"FETCH_FAILURE":return{...state,isLoading:!1,isError:!0,updateKey:null};default:return state}},WhitePageWrapper=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"WhitePageWrapper",componentId:"d11hu8-0"})(["background-color:",";border-top:",";flex:1 1 auto;"],({theme:theme})=>theme.eui.euiColorEmptyShade,({theme:theme})=>theme.eui.euiBorderThin),SectionWrapper=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"SectionWrapper",componentId:"d11hu8-1"})(["box-sizing:content-box;margin:0 auto;max-width:1175px;width:100%;"]),wrappers_HeaderWrapper=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"HeaderWrapper",componentId:"d11hu8-2"})(["padding:",";"],({theme:theme})=>`${theme.eui.paddingSizes.l} ${theme.eui.paddingSizes.l} 0 ${theme.eui.paddingSizes.l}`);var use_delete_cases=__webpack_require__(686),confirm_delete_case=__webpack_require__(749);const ActionsComponent=({caseData:caseData,currentExternalIncident:currentExternalIncident,disabled:disabled=!1})=>{const history=Object(external_kbnSharedDeps_ReactRouterDom_.useHistory)(),{handleToggleModal:handleToggleModal,handleOnDeleteConfirm:handleOnDeleteConfirm,isDeleted:isDeleted,isDisplayConfirmDeleteModal:isDisplayConfirmDeleteModal}=Object(use_delete_cases.a)(),confirmDeleteModal=Object(external_kbnSharedDeps_React_.useMemo)(()=>external_kbnSharedDeps_React_default.a.createElement(confirm_delete_case.a,{caseTitle:caseData.title,isModalVisible:isDisplayConfirmDeleteModal,isPlural:!1,onCancel:handleToggleModal,onConfirm:handleOnDeleteConfirm.bind(null,[{id:caseData.id,title:caseData.title,type:caseData.type}])}),[isDisplayConfirmDeleteModal,caseData]),propertyActions=Object(external_kbnSharedDeps_React_.useMemo)(()=>{var _currentExternalIncid,incidentNumber;return[{disabled:disabled,iconType:"trash",label:cases_translations.p,onClick:handleToggleModal},...null==currentExternalIncident||Object(external_kbnSharedDeps_LodashFp_.isEmpty)(null==currentExternalIncident?void 0:currentExternalIncident.externalUrl)?[]:[{iconType:"popout",label:(incidentNumber=null!==(_currentExternalIncid=null==currentExternalIncident?void 0:currentExternalIncident.externalTitle)&&void 0!==_currentExternalIncid?_currentExternalIncid:"",external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.cases.caseView.actionLabel.viewIncident",{defaultMessage:"View {incidentNumber}",values:{incidentNumber:incidentNumber}})),onClick:()=>window.open(null==currentExternalIncident?void 0:currentExternalIncident.externalUrl,"_blank")}]]},[disabled,handleToggleModal,currentExternalIncident]);return isDeleted?(history.push("/"),null):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(PropertyActions,{propertyActions:propertyActions}),confirmDeleteModal)},Actions=external_kbnSharedDeps_React_default.a.memo(ActionsComponent),StatusContextMenuComponent=({currentStatus:currentStatus,onStatusChanged:onStatusChanged})=>{const[isPopoverOpen,setIsPopoverOpen]=Object(external_kbnSharedDeps_React_.useState)(!1),closePopover=Object(external_kbnSharedDeps_React_.useCallback)(()=>setIsPopoverOpen(!1),[]),openPopover=Object(external_kbnSharedDeps_React_.useCallback)(()=>setIsPopoverOpen(!0),[]),popOverButton=Object(external_kbnSharedDeps_React_.useMemo)(()=>external_kbnSharedDeps_React_default.a.createElement(components_status.b,{type:currentStatus,withArrow:!0,onClick:openPopover}),[currentStatus,openPopover]),onContextMenuItemClick=Object(external_kbnSharedDeps_React_.useMemo)(()=>Object(external_kbnSharedDeps_LodashFp_.memoize)(status=>()=>{closePopover(),onStatusChanged(status)}),[closePopover,onStatusChanged]),panelItems=common_api.n.map(status=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenuItem,{key:status,icon:status===currentStatus?"check":"empty",onClick:onContextMenuItemClick(status),"data-test-subj":"case-view-status-dropdown-"+status},external_kbnSharedDeps_React_default.a.createElement(components_status.b,{type:status})));return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopover,{id:"caseStatusPopover",button:popOverButton,isOpen:isPopoverOpen,closePopover:closePopover,anchorPosition:"downLeft","data-test-subj":"case-view-status-dropdown"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenuPanel,{items:panelItems})))},StatusContextMenu=Object(external_kbnSharedDeps_React_.memo)(StatusContextMenuComponent),SyncAlertsSwitchComponent=({disabled:disabled,isSynced:isSynced=!0,showLabel:showLabel=!1,onSwitchChange:onSwitchChange})=>{const[isOn,setIsOn]=Object(external_kbnSharedDeps_React_.useState)(isSynced),onChange=Object(external_kbnSharedDeps_React_.useCallback)(()=>{onSwitchChange&&onSwitchChange(!isOn),setIsOn(!isOn)},[isOn,onSwitchChange]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSwitch,{label:isOn?cases_translations.O:cases_translations.N,showLabel:showLabel,checked:isOn,onChange:onChange,disabled:disabled,"data-test-subj":"sync-alerts-switch"})};SyncAlertsSwitchComponent.displayName="SyncAlertsSwitchComponent";const SyncAlertsSwitch=Object(external_kbnSharedDeps_React_.memo)(SyncAlertsSwitchComponent),MyDescriptionList=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiDescriptionList).withConfig({displayName:"MyDescriptionList",componentId:"sc-1pjs4ua-0"})(["",""],({theme:theme})=>Object(external_kbnSharedDeps_StyledComponents_.css)(["&{padding-right:",";border-right:",";}"],theme.eui.euiSizeL,theme.eui.euiBorderThin)),CaseActionBarComponent=({caseData:caseData,currentExternalIncident:currentExternalIncident,disabled:disabled=!1,isLoading:isLoading,onRefresh:onRefresh,onUpdateField:onUpdateField})=>{const date=Object(external_kbnSharedDeps_React_.useMemo)(()=>{return(theCase=caseData).status===common_api.e.open?theCase.createdAt:theCase.status===common_api.e["in-progress"]?theCase.updatedAt:theCase.status===common_api.e.closed?theCase.closedAt:null;var theCase},[caseData]),title=Object(external_kbnSharedDeps_React_.useMemo)(()=>{return status=caseData.status,components_status.d[status].actionBar.title;var status},[caseData.status]),onStatusChanged=Object(external_kbnSharedDeps_React_.useCallback)(status=>onUpdateField({key:"status",value:status}),[onUpdateField]),onSyncAlertsChanged=Object(external_kbnSharedDeps_React_.useCallback)(syncAlerts=>onUpdateField({key:"settings",value:{...caseData.settings,syncAlerts:syncAlerts}}),[caseData.settings,onUpdateField]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"l",justifyContent:"flexEnd","data-test-subj":"case-action-bar-wrapper"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(MyDescriptionList,{compressed:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,caseData.type!==common_api.f.collection&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,"data-test-subj":"case-view-status"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionListTitle,null,translations_STATUS),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionListDescription,null,external_kbnSharedDeps_React_default.a.createElement(StatusContextMenu,{currentStatus:caseData.status,onStatusChanged:onStatusChanged}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionListTitle,null,title),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionListDescription,null,external_kbnSharedDeps_React_default.a.createElement(formatted_date.b,{"data-test-subj":"case-action-bar-status-date",value:date})))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionList,{compressed:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"l",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionListTitle,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{component:"span",alignItems:"center",gutterSize:"xs"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement("span",null,SYNC_ALERTS)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIconTip,{content:cases_translations.M})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionListDescription,null,external_kbnSharedDeps_React_default.a.createElement(SyncAlertsSwitch,{disabled:disabled||isLoading,isSynced:caseData.settings.syncAlerts,onSwitchChange:onSyncAlertsChanged}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{"data-test-subj":"case-refresh",iconType:"refresh",onClick:onRefresh},CASE_REFRESH)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,"data-test-subj":"case-view-actions"},external_kbnSharedDeps_React_default.a.createElement(Actions,{caseData:caseData,currentExternalIncident:currentExternalIncident,disabled:disabled}))))))},CaseActionBar=external_kbnSharedDeps_React_default.a.memo(CaseActionBarComponent),initialData={caseServices:{},caseUserActions:[],hasDataToPush:!1,isError:!1,isLoading:!0,participants:[]},getExternalService=value=>Object(containers_utils.c)(Object(containers_utils.m)(""+value)),groupConnectorFields=userActions=>userActions.reduce((acc,mua)=>{if("connector"!==mua.actionField[0])return acc;const oldValue=Object(containers_utils.m)(""+mua.oldValue),newValue=Object(containers_utils.m)(""+mua.newValue);return null==oldValue||null==newValue?acc:{...acc,[oldValue.id]:[...acc[oldValue.id]||[],...oldValue.id===newValue.id?[oldValue.fields,newValue.fields]:[oldValue.fields]],[newValue.id]:[...acc[newValue.id]||[],...oldValue.id===newValue.id?[oldValue.fields,newValue.fields]:[newValue.fields]]}},{}),getPushedInfo=(caseUserActions,caseConnectorId)=>{const hasDataToPushForConnector=connectorId=>{const caseUserActionsReversed=[...caseUserActions].reverse(),lastPushOfConnectorReversedIndex=caseUserActionsReversed.findIndex(mua=>{var _getExternalService;return"push-to-service"===mua.action&&(null===(_getExternalService=getExternalService(""+mua.newValue))||void 0===_getExternalService?void 0:_getExternalService.connectorId)===connectorId});if(-1===lastPushOfConnectorReversedIndex)return!0;const lastPushOfConnectorIndex=caseUserActionsReversed.length-lastPushOfConnectorReversedIndex-1,actionsBeforePush=caseUserActions.slice(0,lastPushOfConnectorIndex),actionsAfterPush=caseUserActions.slice(lastPushOfConnectorIndex+1,caseUserActionsReversed.length),connectorHasChanged=(({connectorFieldsBeforePush:connectorFieldsBeforePush,connectorFieldsAfterPush:connectorFieldsAfterPush,connectorId:connectorId})=>{if(null==connectorFieldsAfterPush||null==connectorFieldsAfterPush[connectorId])return!1;const fieldsAfterPush=connectorFieldsAfterPush[connectorId];if(null!=connectorFieldsBeforePush&&null!=connectorFieldsBeforePush[connectorId]){const fieldsBeforePush=connectorFieldsBeforePush[connectorId];return!fast_deep_equal_default()(fieldsBeforePush[fieldsBeforePush.length-1],fieldsAfterPush[fieldsAfterPush.length-1])}return fieldsAfterPush.length>=2&&!fast_deep_equal_default()(fieldsAfterPush[fieldsAfterPush.length-2],fieldsAfterPush[fieldsAfterPush.length-1])})({connectorFieldsBeforePush:groupConnectorFields(actionsBeforePush),connectorFieldsAfterPush:groupConnectorFields(actionsAfterPush),connectorId:connectorId});return actionsAfterPush.some(mua=>"connector"!==mua.actionField[0]&&"push-to-service"!==mua.action)||connectorHasChanged},commentsAndIndex=caseUserActions.reduce((bacc,mua,index)=>"comment"===mua.actionField[0]&&null!=mua.commentId?[...bacc,{commentId:mua.commentId,commentIndex:index}]:bacc,[]);let caseServices=caseUserActions.reduce((acc,cua,i)=>{if("push-to-service"!==cua.action)return acc;const externalService=getExternalService(""+cua.newValue);return null===externalService?acc:{...acc,...null!=acc[externalService.connectorId]?{[externalService.connectorId]:{...acc[externalService.connectorId],...externalService,lastPushIndex:i,commentsToUpdate:[]}}:{[externalService.connectorId]:{...externalService,firstPushIndex:i,lastPushIndex:i,hasDataToPush:hasDataToPushForConnector(externalService.connectorId),commentsToUpdate:[]}}}},{});caseServices=Object.keys(caseServices).reduce((acc,key)=>({...acc,[key]:{...caseServices[key],commentsToUpdate:commentsAndIndex.reduce((bacc,currentComment)=>currentComment.commentIndex>caseServices[key].lastPushIndex?bacc.indexOf(currentComment.commentId)>-1?[...bacc.filter(e=>e!==currentComment.commentId),currentComment.commentId]:[...bacc,currentComment.commentId]:bacc,[])}}),{});return{hasDataToPush:null==caseServices[caseConnectorId]||caseServices[caseConnectorId].hasDataToPush,caseServices:caseServices}};var use_get_action_license=__webpack_require__(688),use_post_push_to_service=__webpack_require__(670),callout=__webpack_require__(391),use_push_to_service_helpers=__webpack_require__(689),use_push_to_service_translations=__webpack_require__(474);var connector_selector_form=__webpack_require__(672),fields_form=__webpack_require__(674),configure_cases_utils=__webpack_require__(311);const edit_connector_schema_schema={connectorId:{type:shared_imports.d.SUPER_SELECT}},getConnectorFieldsFromUserActions=(id,userActions)=>{try{for(const action of[...userActions].reverse())if(1===action.actionField.length&&"connector"===action.actionField[0]&&action.oldValue&&action.newValue){const oldValue=JSON.parse(action.oldValue),newValue=JSON.parse(action.newValue);if(newValue.id===id)return newValue.fields;if(oldValue.id===id)return oldValue.fields}return null}catch{return null}},EDIT_CONNECTOR_ARIA=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.cases.editConnector.editConnectorLinkAria",{defaultMessage:"click to edit connector"}),edit_connector_MyFlexGroup=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup).withConfig({displayName:"MyFlexGroup",componentId:"sc-1e8a7nn-0"})(["",""],({theme:theme})=>`\n    margin-top: ${theme.eui.euiSizeM};\n    p {\n      font-size: ${theme.eui.euiSizeM};\n    }\n  `),DisappearingFlexItem=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexItem).withConfig({displayName:"DisappearingFlexItem",componentId:"sc-1e8a7nn-1"})(["",""],({$isHidden:$isHidden})=>$isHidden&&"\n      margin: 0 !important;\n    "),editConnectorReducer=(state,action)=>{switch(action.type){case"SET_CURRENT_CONNECTOR":return{...state,currentConnector:action.payload};case"SET_FIELDS":return{...state,fields:action.payload};case"SET_EDIT_CONNECTOR":return{...state,editConnector:action.payload};default:return state}},edit_connector_initialState={currentConnector:null,fields:null,editConnector:!1},EditConnector=external_kbnSharedDeps_React_default.a.memo(({caseFields:caseFields,connectors:connectors,disabled:disabled=!1,hideConnectorServiceNowSir:hideConnectorServiceNowSir=!1,isLoading:isLoading,onSubmit:onSubmit,selectedConnector:selectedConnector,userActions:userActions})=>{const{form:form}=Object(shared_imports.I)({defaultValue:{connectorId:selectedConnector},options:{stripEmptyFields:!1},schema:edit_connector_schema_schema}),{setFieldValue:setFieldValue,submit:submit}=form,[{currentConnector:currentConnector,fields:fields,editConnector:editConnector},dispatch]=Object(external_kbnSharedDeps_React_.useReducer)(editConnectorReducer,{...edit_connector_initialState,fields:caseFields}),onChangeConnector=Object(external_kbnSharedDeps_React_.useCallback)(newConnectorId=>{null==currentConnector?dispatch({type:"SET_CURRENT_CONNECTOR",payload:Object(configure_cases_utils.a)(newConnectorId,connectors)}):currentConnector.id!==newConnectorId?(dispatch({type:"SET_CURRENT_CONNECTOR",payload:Object(configure_cases_utils.a)(newConnectorId,connectors)}),dispatch({type:"SET_FIELDS",payload:getConnectorFieldsFromUserActions(newConnectorId,null!=userActions?userActions:[])})):null===fields&&dispatch({type:"SET_FIELDS",payload:getConnectorFieldsFromUserActions(newConnectorId,null!=userActions?userActions:[])})},[currentConnector,fields,userActions,connectors]),onFieldsChange=Object(external_kbnSharedDeps_React_.useCallback)(newFields=>{fast_deep_equal_default()(newFields,fields)||dispatch({type:"SET_FIELDS",payload:newFields})},[fields,dispatch]),onError=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setFieldValue("connectorId",selectedConnector),dispatch({type:"SET_EDIT_CONNECTOR",payload:!1})},[dispatch,setFieldValue,selectedConnector]),onCancelConnector=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setFieldValue("connectorId",selectedConnector),dispatch({type:"SET_FIELDS",payload:caseFields}),dispatch({type:"SET_EDIT_CONNECTOR",payload:!1})},[dispatch,selectedConnector,setFieldValue,caseFields]),onSubmitConnector=Object(external_kbnSharedDeps_React_.useCallback)(async()=>{const{isValid:isValid,data:newData}=await submit();isValid&&newData.connectorId&&(onSubmit(newData.connectorId,fields,onError,external_kbnSharedDeps_LodashFp_.noop),dispatch({type:"SET_EDIT_CONNECTOR",payload:!1}))},[dispatch,submit,fields,onSubmit,onError]),onEditClick=Object(external_kbnSharedDeps_React_.useCallback)(()=>{dispatch({type:"SET_EDIT_CONNECTOR",payload:!0})},[dispatch]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement(edit_connector_MyFlexGroup,{alignItems:"center",gutterSize:"xs",justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement("h4",null,cases_translations.m)),isLoading&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingSpinner,{"data-test-subj":"connector-loading"}),!isLoading&&!editConnector&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{"data-test-subj":"connector-edit",grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{"data-test-subj":"connector-edit-button",isDisabled:disabled,"aria-label":EDIT_CONNECTOR_ARIA,iconType:"pencil",onClick:onEditClick}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHorizontalRule,{margin:"xs"}),external_kbnSharedDeps_React_default.a.createElement(edit_connector_MyFlexGroup,{"data-test-subj":"edit-connectors",direction:"column"},external_kbnSharedDeps_React_default.a.createElement(DisappearingFlexItem,{$isHidden:!editConnector},external_kbnSharedDeps_React_default.a.createElement(shared_imports.f,{form:form},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"none",direction:"row"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(shared_imports.k,{path:"connectorId",component:connector_selector_form.a,componentProps:{connectors:connectors,dataTestSubj:"caseConnectors",defaultValue:selectedConnector,disabled:disabled,hideConnectorServiceNowSir:hideConnectorServiceNowSir,idAria:"caseConnectors",isEdit:editConnector,isLoading:isLoading},onChange:onChangeConnector}))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{"data-test-subj":"edit-connector-fields-form-flex-item"},(null==currentConnector||"none"===(null==currentConnector?void 0:currentConnector.id))&&!(null===currentConnector&&"none"!==selectedConnector)&&!editConnector&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"s"},external_kbnSharedDeps_React_default.a.createElement("span",null,cases_translations.x)),external_kbnSharedDeps_React_default.a.createElement(fields_form.a,{connector:currentConnector,fields:fields,isEdit:editConnector,onChange:onFieldsChange})),editConnector&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{color:"secondary","data-test-subj":"edit-connectors-submit",fill:!0,iconType:"save",onClick:onSubmitConnector,size:"s"},cases_translations.K)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{"data-test-subj":"edit-connectors-cancel",iconType:"cross",onClick:onCancelConnector,size:"s"},cases_translations.e))))))});EditConnector.displayName="EditConnector";var use_connectors=__webpack_require__(369),side_panel=__webpack_require__(283),status_config=__webpack_require__(309);const StatusActionButtonComponent=({status:status,onStatusChanged:onStatusChanged,disabled:disabled,isLoading:isLoading})=>{const indexOfCurrentStatus=Object(external_kbnSharedDeps_React_.useMemo)(()=>common_api.n.findIndex(caseStatus=>caseStatus===status),[status]),nextStatusIndex=Object(external_kbnSharedDeps_React_.useMemo)(()=>(indexOfCurrentStatus+1)%common_api.n.length,[indexOfCurrentStatus]),onClick=Object(external_kbnSharedDeps_React_.useCallback)(()=>{onStatusChanged(common_api.n[nextStatusIndex])},[nextStatusIndex,onStatusChanged]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{"data-test-subj":"case-view-status-action-button",iconType:status_config.b[common_api.n[nextStatusIndex]].icon,isDisabled:disabled,isLoading:isLoading,onClick:onClick},status_config.b[common_api.n[nextStatusIndex]].button.label)},StatusActionButton=Object(external_kbnSharedDeps_React_.memo)(StatusActionButtonComponent),MyWrapper=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"MyWrapper",componentId:"sc-1xjixbg-0"})(["padding:",";"],({theme:theme})=>`${theme.eui.paddingSizes.l} ${theme.eui.paddingSizes.l} ${lib_helpers.d} ${theme.eui.paddingSizes.l}`),case_view_MyEuiFlexGroup=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup).withConfig({displayName:"MyEuiFlexGroup",componentId:"sc-1xjixbg-1"})(["height:100%;"]),MyEuiHorizontalRule=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiHorizontalRule).withConfig({displayName:"MyEuiHorizontalRule",componentId:"sc-1xjixbg-2"})(["margin-left:48px;&.euiHorizontalRule--full{width:calc(100% - 48px);}"]),CaseComponent=external_kbnSharedDeps_React_default.a.memo(({caseId:caseId,caseData:caseData,fetchCase:fetchCase,subCaseId:subCaseId,updateCase:updateCase,userCanCrud:userCanCrud})=>{const dispatch=Object(react_redux_lib.useDispatch)(),{formatUrl:formatUrl,search:search}=Object(link_to.o)(app_types.a.case),allCasesLink=Object(link_to.d)(search),caseDetailsLink=formatUrl(Object(link_to.b)({id:caseId}),{absolute:!0}),[initLoadingData,setInitLoadingData]=Object(external_kbnSharedDeps_React_.useState)(!0),init=Object(external_kbnSharedDeps_React_.useRef)(!0),{caseUserActions:caseUserActions,fetchCaseUserActions:fetchCaseUserActions,caseServices:caseServices,hasDataToPush:hasDataToPush,isLoading:isLoadingUserActions,participants:participants}=((caseId,caseConnectorId,subCaseId)=>{const[caseUserActionsState,setCaseUserActionsState]=Object(external_kbnSharedDeps_React_.useState)(initialData),abortCtrlRef=Object(external_kbnSharedDeps_React_.useRef)(new AbortController),isCancelledRef=Object(external_kbnSharedDeps_React_.useRef)(!1),[,dispatchToaster]=Object(toasters.h)(),fetchCaseUserActions=Object(external_kbnSharedDeps_React_.useCallback)(async(thisCaseId,thisCaseConnectorId,thisSubCaseId)=>{try{isCancelledRef.current=!1,abortCtrlRef.current.abort(),abortCtrlRef.current=new AbortController,setCaseUserActionsState({...caseUserActionsState,isLoading:!0});const response=await(thisSubCaseId?Object(containers_api.j)(thisCaseId,thisSubCaseId,abortCtrlRef.current.signal):Object(containers_api.e)(thisCaseId,abortCtrlRef.current.signal));if(!isCancelledRef.current){const participants=Object(external_kbnSharedDeps_LodashFp_.isEmpty)(response)?[]:Object(external_kbnSharedDeps_LodashFp_.uniqBy)("actionBy.username",response).map(cau=>cau.actionBy),caseUserActions=Object(external_kbnSharedDeps_LodashFp_.isEmpty)(response)?[]:thisSubCaseId?response:response.slice(1);setCaseUserActionsState({caseUserActions:caseUserActions,...getPushedInfo(caseUserActions,thisCaseConnectorId),isLoading:!1,isError:!1,participants:participants})}}catch(error){isCancelledRef.current||("AbortError"!==error.name&&Object(toasters.g)({title:containers_translations.d,error:error.body&&error.body.message?new Error(error.body.message):error,dispatchToaster:dispatchToaster}),setCaseUserActionsState({caseServices:{},caseUserActions:[],hasDataToPush:!1,isError:!0,isLoading:!1,participants:[]}))}},[caseUserActionsState]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>(Object(external_kbnSharedDeps_LodashFp_.isEmpty)(caseId)||fetchCaseUserActions(caseId,caseConnectorId,subCaseId),()=>{isCancelledRef.current=!0,abortCtrlRef.current.abort()}),[caseId,subCaseId]),{...caseUserActionsState,fetchCaseUserActions:fetchCaseUserActions}})(caseId,caseData.connector.id,subCaseId),{isLoading:isLoading,updateKey:updateKey,updateCaseProperty:updateCaseProperty}=(({caseId:caseId,subCaseId:subCaseId})=>{const[state,dispatch]=Object(external_kbnSharedDeps_React_.useReducer)(use_update_case_dataFetchReducer,{isLoading:!1,isError:!1,updateKey:null}),[,dispatchToaster]=Object(toasters.h)(),isCancelledRef=Object(external_kbnSharedDeps_React_.useRef)(!1),abortCtrlRef=Object(external_kbnSharedDeps_React_.useRef)(new AbortController),dispatchUpdateCaseProperty=Object(external_kbnSharedDeps_React_.useCallback)(async({fetchCaseUserActions:fetchCaseUserActions,updateKey:updateKey,updateValue:updateValue,updateCase:updateCase,caseData:caseData,onSuccess:onSuccess,onError:onError})=>{try{isCancelledRef.current=!1,abortCtrlRef.current.abort(),abortCtrlRef.current=new AbortController,dispatch({type:"FETCH_INIT",payload:updateKey});const response=await("status"===updateKey&&subCaseId?Object(containers_api.o)(caseId,subCaseId,{status:updateValue},caseData.version,abortCtrlRef.current.signal):Object(containers_api.l)(caseId,{[updateKey]:updateValue},caseData.version,abortCtrlRef.current.signal));isCancelledRef.current||(null!=fetchCaseUserActions&&fetchCaseUserActions(caseId,response[0].connector.id,subCaseId),null!=updateCase&&updateCase(response[0]),dispatch({type:"FETCH_SUCCESS"}),dispatchToaster({type:"addToaster",toast:Object(containers_utils.e)(caseData,response[0],updateKey,updateValue)}),onSuccess&&onSuccess())}catch(error){isCancelledRef.current||("AbortError"!==error.name&&Object(toasters.g)({title:containers_translations.d,error:error.body&&error.body.message?new Error(error.body.message):error,dispatchToaster:dispatchToaster}),dispatch({type:"FETCH_FAILURE"}),onError&&onError())}},[caseId,subCaseId]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>()=>{isCancelledRef.current=!0,abortCtrlRef.current.abort()},[]),{...state,updateCaseProperty:dispatchUpdateCaseProperty}})({caseId:caseId,subCaseId:subCaseId}),{browserFields:browserFields,docValueFields:docValueFields}=Object(sourcerer.b)(model.SourcererScopeName.detections),onUpdateField=Object(external_kbnSharedDeps_React_.useCallback)(({key:key,value:value,onSuccess:onSuccess,onError:onError})=>{const handleUpdateNewCase=newCase=>updateCase({...newCase,comments:caseData.comments});switch(key){case"title":const titleUpdate=Object(containers_utils.l)(value);titleUpdate.length>0&&updateCaseProperty({fetchCaseUserActions:fetchCaseUserActions,updateKey:"title",updateValue:titleUpdate,updateCase:handleUpdateNewCase,caseData:caseData,onSuccess:onSuccess,onError:onError});break;case"connector":const connector=Object(containers_utils.l)(value);null!=connector&&updateCaseProperty({fetchCaseUserActions:fetchCaseUserActions,updateKey:"connector",updateValue:connector,updateCase:handleUpdateNewCase,caseData:caseData,onSuccess:onSuccess,onError:onError});break;case"description":const descriptionUpdate=Object(containers_utils.l)(value);descriptionUpdate.length>0&&updateCaseProperty({fetchCaseUserActions:fetchCaseUserActions,updateKey:"description",updateValue:descriptionUpdate,updateCase:handleUpdateNewCase,caseData:caseData,onSuccess:onSuccess,onError:onError});break;case"tags":const tagsUpdate=Object(containers_utils.l)(value);updateCaseProperty({fetchCaseUserActions:fetchCaseUserActions,updateKey:"tags",updateValue:tagsUpdate,updateCase:handleUpdateNewCase,caseData:caseData,onSuccess:onSuccess,onError:onError});break;case"status":const statusUpdate=Object(containers_utils.l)(value);caseData.status!==value&&updateCaseProperty({fetchCaseUserActions:fetchCaseUserActions,updateKey:"status",updateValue:statusUpdate,updateCase:handleUpdateNewCase,caseData:caseData,onSuccess:onSuccess,onError:onError});break;case"settings":const settingsUpdate=Object(containers_utils.l)(value);caseData.settings!==value&&updateCaseProperty({fetchCaseUserActions:fetchCaseUserActions,updateKey:"settings",updateValue:settingsUpdate,updateCase:handleUpdateNewCase,caseData:caseData,onSuccess:onSuccess,onError:onError});break;default:return null}},[fetchCaseUserActions,updateCaseProperty,updateCase,caseData]),handleUpdateCase=Object(external_kbnSharedDeps_React_.useCallback)(newCase=>{updateCase(newCase),fetchCaseUserActions(caseId,newCase.connector.id,subCaseId)},[updateCase,fetchCaseUserActions,caseId,subCaseId]),{loading:isLoadingConnectors,connectors:connectors}=Object(use_connectors.a)(),[connectorName,isValidConnector]=Object(external_kbnSharedDeps_React_.useMemo)(()=>{var _connector$name;const connector=connectors.find(c=>c.id===caseData.connector.id);return[null!==(_connector$name=null==connector?void 0:connector.name)&&void 0!==_connector$name?_connector$name:"",!!connector]},[connectors,caseData.connector]),currentExternalIncident=Object(external_kbnSharedDeps_React_.useMemo)(()=>null!=caseServices&&null!=caseServices[caseData.connector.id]?caseServices[caseData.connector.id]:null,[caseServices,caseData.connector]),{pushButton:pushButton,pushCallouts:pushCallouts}=(({connector:connector,caseId:caseId,caseServices:caseServices,caseStatus:caseStatus,connectors:connectors,updateCase:updateCase,userCanCrud:userCanCrud,isValidConnector:isValidConnector})=>{const history=Object(external_kbnSharedDeps_ReactRouterDom_.useHistory)(),{formatUrl:formatUrl,search:urlSearch}=Object(link_to.o)(app_types.a.case),{isLoading:isLoading,pushCaseToExternalService:pushCaseToExternalService}=Object(use_post_push_to_service.a)(),{isLoading:loadingLicense,actionLicense:actionLicense}=Object(use_get_action_license.a)(),handlePushToService=Object(external_kbnSharedDeps_React_.useCallback)(async()=>{if(null!=connector.id&&"none"!==connector.id){const theCase=await pushCaseToExternalService({caseId:caseId,connector:connector});null!=theCase&&updateCase(theCase)}},[caseId,connector,pushCaseToExternalService,updateCase]),goToConfigureCases=Object(external_kbnSharedDeps_React_.useCallback)(ev=>{ev.preventDefault(),history.push(Object(link_to.e)(urlSearch))},[history,urlSearch]),errorsMsg=Object(external_kbnSharedDeps_React_.useMemo)(()=>{let errors=[];return null==actionLicense||actionLicense.enabledInLicense||(errors=[...errors,Object(use_push_to_service_helpers.c)()]),0!==connectors.length||"none"!==connector.id||loadingLicense?"none"!==connector.id||loadingLicense?isValidConnector||loadingLicense||(errors=[...errors,{id:"connector-deleted-error",title:use_push_to_service_translations.h,description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{defaultMessage:"The connector used to send updates to external service has been deleted. To update cases in external systems, select a different connector or create a new one.",id:"xpack.securitySolution.cases.caseView.pushToServiceDisableByInvalidConnector"}),errorType:"danger"}]):errors=[...errors,{id:"connector-not-selected-error",title:use_push_to_service_translations.h,description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{defaultMessage:"To open and update cases in external systems, you must select an external incident management system for this case.",id:"xpack.securitySolution.cases.caseView.pushToServiceDisableByNoCaseConfigDescription"})}]:errors=[...errors,{id:"connector-missing-error",title:use_push_to_service_translations.i,description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{defaultMessage:"To open and update cases in external systems, you must configure a {link}.",id:"xpack.securitySolution.cases.caseView.pushToServiceDisableByNoConnectors",values:{link:external_kbnSharedDeps_React_default.a.createElement(links.f,{onClick:goToConfigureCases,href:formatUrl(Object(link_to.e)()),target:"_blank"},use_push_to_service_translations.d)}})}],caseStatus===common_api.e.closed&&(errors=[...errors,{id:"closed-case-push-error",title:use_push_to_service_translations.e,description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{defaultMessage:"Closed cases cannot be sent to external systems. Reopen the case if you want to open or update it in an external system.",id:"xpack.securitySolution.cases.caseView.pushToServiceDisableBecauseCaseClosedDescription"})}]),null==actionLicense||actionLicense.enabledInConfig||(errors=[...errors,Object(use_push_to_service_helpers.b)()]),errors},[actionLicense,caseStatus,connectors.length,connector,loadingLicense,urlSearch]),pushToServiceButton=Object(external_kbnSharedDeps_React_.useMemo)(()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{"data-test-subj":"push-to-external-service",fill:!0,iconType:"importAction",onClick:handlePushToService,disabled:isLoading||loadingLicense||errorsMsg.length>0||!userCanCrud||!isValidConnector,isLoading:isLoading},caseServices[connector.id]?use_push_to_service_translations.k(connector.name):use_push_to_service_translations.j(connector.name)),[connector,connectors,errorsMsg,handlePushToService,isLoading,loadingLicense,userCanCrud,isValidConnector]);return Object(external_kbnSharedDeps_React_.useMemo)(()=>({pushButton:errorsMsg.length>0?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{position:"top",title:errorsMsg[0].title,content:external_kbnSharedDeps_React_default.a.createElement("p",null,errorsMsg[0].description)},pushToServiceButton):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,pushToServiceButton),pushCallouts:errorsMsg.length>0?external_kbnSharedDeps_React_default.a.createElement(callout.a,{title:use_push_to_service_translations.a,messages:errorsMsg}):null}),[errorsMsg,pushToServiceButton])})({connector:{...caseData.connector,name:Object(external_kbnSharedDeps_LodashFp_.isEmpty)(connectorName)?caseData.connector.name:connectorName},caseServices:caseServices,caseId:caseData.id,caseStatus:caseData.status,connectors:connectors,updateCase:handleUpdateCase,userCanCrud:userCanCrud,isValidConnector:!!isLoadingConnectors||isValidConnector}),onSubmitConnector=Object(external_kbnSharedDeps_React_.useCallback)((connectorId,connectorFields,onError,onSuccess)=>{const connector=Object(configure_cases_utils.a)(connectorId,connectors),connectorToUpdate=connector?Object(configure_cases_utils.c)(connector):Object(configure_cases_utils.b)();onUpdateField({key:"connector",value:{...connectorToUpdate,fields:connectorFields},onSuccess:onSuccess,onError:onError})},[onUpdateField,connectors]),onSubmitTags=Object(external_kbnSharedDeps_React_.useCallback)(newTags=>onUpdateField({key:"tags",value:newTags}),[onUpdateField]),onSubmitTitle=Object(external_kbnSharedDeps_React_.useCallback)(newTitle=>onUpdateField({key:"title",value:newTitle}),[onUpdateField]),changeStatus=Object(external_kbnSharedDeps_React_.useCallback)(status=>onUpdateField({key:"status",value:status}),[onUpdateField]),handleRefresh=Object(external_kbnSharedDeps_React_.useCallback)(()=>{fetchCaseUserActions(caseId,caseData.connector.id,subCaseId),fetchCase()},[caseData.connector.id,caseId,fetchCase,fetchCaseUserActions,subCaseId]),spyState=Object(external_kbnSharedDeps_React_.useMemo)(()=>({caseTitle:caseData.title}),[caseData.title]),emailContent=Object(external_kbnSharedDeps_React_.useMemo)(()=>{return{subject:(caseTitle=caseData.title,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.cases.caseView.emailSubject",{values:{caseTitle:caseTitle},defaultMessage:"Security Case - {caseTitle}"})),body:(caseUrl=caseDetailsLink,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.cases.caseView.emailBody",{values:{caseUrl:caseUrl},defaultMessage:"Case reference: {caseUrl}"}))};var caseUrl,caseTitle},[caseDetailsLink,caseData.title]);Object(external_kbnSharedDeps_React_.useEffect)(()=>{initLoadingData&&!isLoadingUserActions&&setInitLoadingData(!1)},[initLoadingData,isLoadingUserActions]);const backOptions=Object(external_kbnSharedDeps_React_.useMemo)(()=>({href:allCasesLink,text:cases_translations.d,dataTestSubj:"backToCases",pageId:app_types.a.case}),[allCasesLink]),showAlert=Object(external_kbnSharedDeps_React_.useCallback)((alertId,index)=>{dispatch(store_timeline.a.toggleDetailPanel({panelView:"eventDetail",timelineId:types_timeline.g.casePage,params:{eventId:alertId,indexName:index}}))},[dispatch]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{init.current&&(init.current=!1,dispatch(store_timeline.a.createTimeline({id:types_timeline.g.casePage,columns:[],indexNames:[],expandedDetail:{},show:!1})))},[dispatch]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(wrappers_HeaderWrapper,null,external_kbnSharedDeps_React_default.a.createElement(header_page.a,{backOptions:backOptions,"data-test-subj":"case-view-title",hideSourcerer:!0,titleNode:external_kbnSharedDeps_React_default.a.createElement(EditableTitle,{disabled:!userCanCrud,isLoading:isLoading&&"title"===updateKey,title:caseData.title,onSubmit:onSubmitTitle}),title:caseData.title},external_kbnSharedDeps_React_default.a.createElement(CaseActionBar,{currentExternalIncident:currentExternalIncident,caseData:caseData,disabled:!userCanCrud,isLoading:isLoading&&("status"===updateKey||"settings"===updateKey),onRefresh:handleRefresh,onUpdateField:onUpdateField}))),external_kbnSharedDeps_React_default.a.createElement(WhitePageWrapper,null,external_kbnSharedDeps_React_default.a.createElement(MyWrapper,null,!initLoadingData&&null!=pushCallouts&&pushCallouts,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:6},initLoadingData&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingContent,{lines:8,"data-test-subj":"case-view-loading-content"}),!initLoadingData&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(UserActionTree,{caseServices:caseServices,caseUserActions:caseUserActions,connectors:connectors,data:caseData,fetchUserActions:fetchCaseUserActions.bind(null,caseId,caseData.connector.id,subCaseId),isLoadingDescription:isLoading&&"description"===updateKey,isLoadingUserActions:isLoadingUserActions,onShowAlertDetails:showAlert,onUpdateField:onUpdateField,updateCase:updateCase,userCanCrud:userCanCrud}),(caseData.type!==common_api.f.collection||hasDataToPush)&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(MyEuiHorizontalRule,{margin:"s","data-test-subj":"case-view-bottom-actions-horizontal-rule"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",gutterSize:"s",justifyContent:"flexEnd"},caseData.type!==common_api.f.collection&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(StatusActionButton,{status:caseData.status,onStatusChanged:changeStatus,disabled:!userCanCrud,isLoading:isLoading&&"status"===updateKey})),hasDataToPush&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{"data-test-subj":"has-data-to-push-button",grow:!1},pushButton))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:2},external_kbnSharedDeps_React_default.a.createElement(UserList,{"data-test-subj":"case-view-user-list-reporter",email:emailContent,headline:cases_translations.I,users:[caseData.createdBy]}),external_kbnSharedDeps_React_default.a.createElement(UserList,{"data-test-subj":"case-view-user-list-participants",email:emailContent,headline:cases_translations.G,loading:isLoadingUserActions,users:participants}),external_kbnSharedDeps_React_default.a.createElement(TagList,{"data-test-subj":"case-view-tag-list",disabled:!userCanCrud,tags:caseData.tags,onSubmit:onSubmitTags,isLoading:isLoading&&"tags"===updateKey}),external_kbnSharedDeps_React_default.a.createElement(EditConnector,{caseFields:caseData.connector.fields,connectors:connectors,disabled:!userCanCrud,hideConnectorServiceNowSir:null!=subCaseId||caseData.type===common_api.f.collection,isLoading:isLoadingConnectors||isLoading&&"connector"===updateKey,onSubmit:onSubmitConnector,selectedConnector:caseData.connector.id,userActions:caseUserActions}))))),external_kbnSharedDeps_React_default.a.createElement(side_panel.a,{browserFields:browserFields,docValueFields:docValueFields,isFlyoutView:!0,timelineId:types_timeline.g.casePage}),external_kbnSharedDeps_React_default.a.createElement(spy_routes.a,{state:spyState,pageName:app_types.a.case}))}),CaseView=external_kbnSharedDeps_React_default.a.memo(({caseId:caseId,subCaseId:subCaseId,userCanCrud:userCanCrud})=>{const{data:data,isLoading:isLoading,isError:isError,fetchCase:fetchCase,updateCase:updateCase}=((caseId,subCaseId)=>{const[state,dispatch]=Object(external_kbnSharedDeps_React_.useReducer)(dataFetchReducer,{isLoading:!1,isError:!1,data:null}),[,dispatchToaster]=Object(toasters.h)(),isCancelledRef=Object(external_kbnSharedDeps_React_.useRef)(!1),abortCtrlRef=Object(external_kbnSharedDeps_React_.useRef)(new AbortController),updateCase=Object(external_kbnSharedDeps_React_.useCallback)(newCase=>{dispatch({type:"UPDATE_CASE",payload:newCase})},[]),callFetch=Object(external_kbnSharedDeps_React_.useCallback)(async()=>{try{isCancelledRef.current=!1,abortCtrlRef.current.abort(),abortCtrlRef.current=new AbortController,dispatch({type:"FETCH_INIT"});const response=await(subCaseId?Object(containers_api.i)(caseId,subCaseId,!0,abortCtrlRef.current.signal):Object(containers_api.d)(caseId,!0,abortCtrlRef.current.signal));isCancelledRef.current||dispatch({type:"FETCH_SUCCESS",payload:response})}catch(error){isCancelledRef.current||("AbortError"!==error.name&&Object(toasters.g)({title:containers_translations.d,error:error.body&&error.body.message?new Error(error.body.message):error,dispatchToaster:dispatchToaster}),dispatch({type:"FETCH_FAILURE"}))}},[caseId,subCaseId]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>(callFetch(),()=>{isCancelledRef.current=!0,abortCtrlRef.current.abort()}),[caseId,subCaseId]),{...state,fetchCase:callFetch,updateCase:updateCase}})(caseId,subCaseId);return isError?null:isLoading?external_kbnSharedDeps_React_default.a.createElement(case_view_MyEuiFlexGroup,{gutterSize:"none",justifyContent:"center",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingSpinner,{"data-test-subj":"case-view-loading",size:"xl"}))):data&&external_kbnSharedDeps_React_default.a.createElement(CaseComponent,{caseId:caseId,subCaseId:subCaseId,fetchCase:fetchCase,caseData:data,updateCase:updateCase,userCanCrud:userCanCrud})});CaseComponent.displayName="CaseComponent",CaseView.displayName="CaseView";const CaseDetailsPage=external_kbnSharedDeps_React_default.a.memo(()=>{var _userPermissions$crud;const history=Object(external_kbnSharedDeps_ReactRouterDom_.useHistory)(),userPermissions=Object(lib_kibana.f)(),{detailName:caseId,subCaseId:subCaseId}=Object(external_kbnSharedDeps_ReactRouterDom_.useParams)(),search=Object(use_get_url_search.a)(home_navigations.a.case);return null==userPermissions||userPermissions.read?null!=caseId?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(wrapper_page.a,{noPadding:!0},null!=userPermissions&&!(null!=userPermissions&&userPermissions.crud)&&(null==userPermissions?void 0:userPermissions.read)&&external_kbnSharedDeps_React_default.a.createElement(callout.a,{title:callout.b.title,messages:[{...callout.b}]}),external_kbnSharedDeps_React_default.a.createElement(CaseView,{caseId:caseId,subCaseId:subCaseId,userCanCrud:null!==(_userPermissions$crud=null==userPermissions?void 0:userPermissions.crud)&&void 0!==_userPermissions$crud&&_userPermissions$crud})),external_kbnSharedDeps_React_default.a.createElement(spy_routes.a,{pageName:app_types.a.case})):null:(history.replace(Object(link_to.d)(search)),null)});CaseDetailsPage.displayName="CaseDetailsPage";var all_cases=__webpack_require__(715),pages_translations=__webpack_require__(381);const CaseSavedObjectNoPermissions=external_kbnSharedDeps_React_default.a.memo(()=>{const docLinks=Object(lib_kibana.h)().services.docLinks,actions=Object(external_kbnSharedDeps_React_.useMemo)(()=>({savedObject:{icon:"documents",label:pages_translations.e,url:`${docLinks.ELASTIC_WEBSITE_URL}guide/en/security/${docLinks.DOC_LINK_VERSION}s`,target:"_blank"}}),[docLinks]);return external_kbnSharedDeps_React_default.a.createElement(empty_page.a,{actions:actions,message:pages_translations.g,"data-test-subj":"no_saved_objects_permissions",title:pages_translations.h})});CaseSavedObjectNoPermissions.displayName="CaseSavedObjectNoPermissions";const CasesPage=external_kbnSharedDeps_React_default.a.memo(()=>{var _userPermissions$crud;const userPermissions=Object(lib_kibana.f)();return null==userPermissions||null!=userPermissions&&userPermissions.read?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(wrapper_page.a,null,null!=userPermissions&&!(null!=userPermissions&&userPermissions.crud)&&(null==userPermissions?void 0:userPermissions.read)&&external_kbnSharedDeps_React_default.a.createElement(callout.a,{title:callout.b.title,messages:[{...callout.b}]}),external_kbnSharedDeps_React_default.a.createElement(all_cases.a,{userCanCrud:null!==(_userPermissions$crud=null==userPermissions?void 0:userPermissions.crud)&&void 0!==_userPermissions$crud&&_userPermissions$crud})),external_kbnSharedDeps_React_default.a.createElement(spy_routes.a,{pageName:app_types.a.case})):external_kbnSharedDeps_React_default.a.createElement(CaseSavedObjectNoPermissions,null)});CasesPage.displayName="CasesPage";var case_header_page=__webpack_require__(473),create_translations=__webpack_require__(310),create_form=__webpack_require__(490),form_context=__webpack_require__(504),create_description=__webpack_require__(671),submit_button=__webpack_require__(467);Object(shared_imports.x)({component:shared_imports.e});const Container=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"Container",componentId:"sc-3p3fo4-0"})(["",""],({theme:theme})=>`\n    margin-top: ${theme.eui.euiSize};\n  `),InsertTimeline=()=>{var _formData$description;const{setFieldValue:setFieldValue,getFormData:getFormData}=Object(shared_imports.J)(),formData=getFormData(),onTimelineAttached=Object(external_kbnSharedDeps_React_.useCallback)(newValue=>setFieldValue(create_description.b,newValue),[setFieldValue]);return useInsertTimeline(null!==(_formData$description=formData[create_description.b])&&void 0!==_formData$description?_formData$description:"",onTimelineAttached),null},Create=external_kbnSharedDeps_React_default.a.memo(()=>{const history=Object(external_kbnSharedDeps_ReactRouterDom_.useHistory)(),onSuccess=Object(external_kbnSharedDeps_React_.useCallback)(async({id:id})=>{history.push(Object(link_to.b)({id:id}))},[history]),handleSetIsCancel=Object(external_kbnSharedDeps_React_.useCallback)(()=>{history.push("/")},[history]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPanel,null,external_kbnSharedDeps_React_default.a.createElement(form_context.a,{onSuccess:onSuccess},external_kbnSharedDeps_React_default.a.createElement(create_form.a,null),external_kbnSharedDeps_React_default.a.createElement(Container,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",justifyContent:"flexEnd",gutterSize:"xs",responsive:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{"data-test-subj":"create-case-cancel",size:"s",onClick:handleSetIsCancel,iconType:"cross"},create_translations.a)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(submit_button.a,null)))),external_kbnSharedDeps_React_default.a.createElement(InsertTimeline,null)))});Create.displayName="Create";const CreateCasePage=external_kbnSharedDeps_React_default.a.memo(()=>{const history=Object(external_kbnSharedDeps_ReactRouterDom_.useHistory)(),userPermissions=Object(lib_kibana.f)(),search=Object(use_get_url_search.a)(home_navigations.a.case),backOptions=Object(external_kbnSharedDeps_React_.useMemo)(()=>({href:Object(link_to.d)(search),text:pages_translations.a,pageId:app_types.a.case}),[search]);return null==userPermissions||userPermissions.crud?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(wrapper_page.a,null,external_kbnSharedDeps_React_default.a.createElement(case_header_page.a,{backOptions:backOptions,title:pages_translations.d}),external_kbnSharedDeps_React_default.a.createElement(Create,null)),external_kbnSharedDeps_React_default.a.createElement(spy_routes.a,{pageName:app_types.a.case})):(history.replace(Object(link_to.d)(search)),null)});CreateCasePage.displayName="CreateCasePage";var configure_api=__webpack_require__(465);var use_configure=__webpack_require__(748),connectors_dropdown=__webpack_require__(673),configure_cases_translations=__webpack_require__(248);const FieldMappingRowComponent=({isLoading:isLoading,securitySolutionField:securitySolutionField,selectedActionType:selectedActionType,selectedThirdParty:selectedThirdParty})=>{const selectedActionTypeCapitalized=Object(external_kbnSharedDeps_React_.useMemo)(()=>Object(external_kbnSharedDeps_LodashFp_.capitalize)(selectedActionType),[selectedActionType]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{"data-test-subj":"static-mappings",alignItems:"center",responsive:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{component:"span",justifyContent:"spaceBetween",responsive:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{component:"span",grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCode,{"data-test-subj":"field-mapping-source"},securitySolutionField)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{component:"span",grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{type:"sortRight"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{component:"span",justifyContent:"spaceBetween",responsive:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{component:"span",grow:!1},isLoading?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingSpinner,{size:"m"}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCode,{"data-test-subj":"field-mapping-target"},selectedThirdParty)))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,isLoading?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingSpinner,{size:"m"}):selectedActionTypeCapitalized))},FieldMappingRowStatic=external_kbnSharedDeps_React_default.a.memo(FieldMappingRowComponent);var components_connectors=__webpack_require__(38);const FieldRowWrapper=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"FieldRowWrapper",componentId:"sc-1007xg6-0"})(["margin:10px 0;font-size:14px;"]),FieldMappingComponent=({connectorActionTypeId:connectorActionTypeId,isLoading:isLoading,mappings:mappings})=>{const selectedConnector=Object(external_kbnSharedDeps_React_.useMemo)(()=>{var _connectorsConfigurat;return null!==(_connectorsConfigurat=components_connectors.a[connectorActionTypeId])&&void 0!==_connectorsConfigurat?_connectorsConfigurat:{fields:{}}},[connectorActionTypeId]);return mappings.length?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"column",gutterSize:"none"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null," ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{responsive:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement("span",{className:"euiFormLabel"},configure_cases_translations.j)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement("span",{className:"euiFormLabel"},configure_cases_translations.k(selectedConnector.name))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement("span",{className:"euiFormLabel"},configure_cases_translations.l)))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(FieldRowWrapper,{"data-test-subj":"case-configure-field-mappings-row-wrapper"},mappings.map(item=>{var _item$target;return external_kbnSharedDeps_React_default.a.createElement(FieldMappingRowStatic,{key:""+item.source,securitySolutionField:item.source,isLoading:isLoading,selectedActionType:item.actionType,selectedThirdParty:null!==(_item$target=item.target)&&void 0!==_item$target?_item$target:"not_mapped"})})))):null},FieldMapping=external_kbnSharedDeps_React_default.a.memo(FieldMappingComponent),MappingComponent=({connectorActionTypeId:connectorActionTypeId,isLoading:isLoading,mappings:mappings})=>{const selectedConnector=Object(external_kbnSharedDeps_React_.useMemo)(()=>components_connectors.a[connectorActionTypeId],[connectorActionTypeId]),fieldMappingDesc=Object(external_kbnSharedDeps_React_.useMemo)(()=>mappings.length>0||isLoading?{desc:configure_cases_translations.h(selectedConnector.name),color:"subdued"}:{desc:configure_cases_translations.i(selectedConnector.name),color:"danger"},[isLoading,mappings.length,selectedConnector.name]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"column",gutterSize:"none"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("h4",null,configure_cases_translations.m(selectedConnector.name)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTextColor,{"data-test-subj":"field-mapping-desc",color:fieldMappingDesc.color},fieldMappingDesc.desc))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(FieldMapping,{connectorActionTypeId:connectorActionTypeId,"data-test-subj":"case-mappings-field",isLoading:isLoading,mappings:mappings})))},Mapping=external_kbnSharedDeps_React_default.a.memo(MappingComponent);var api_connectors=__webpack_require__(10);const EuiFormRowExtended=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFormRow).withConfig({displayName:"EuiFormRowExtended",componentId:"iiz1mi-0"})([".euiFormRow__labelWrapper{.euiFormRow__label{width:100%;}}"]),ConnectorsComponent=({connectors:connectors,disabled:disabled,handleShowEditFlyout:handleShowEditFlyout,isLoading:isLoading,mappings:mappings,onChangeConnector:onChangeConnector,selectedConnector:selectedConnector,updateConnectorDisabled:updateConnectorDisabled})=>{const connectorsName=Object(external_kbnSharedDeps_React_.useMemo)(()=>{var _connectors$find$name,_connectors$find;return null!==(_connectors$find$name=null===(_connectors$find=connectors.find(c=>c.id===selectedConnector.id))||void 0===_connectors$find?void 0:_connectors$find.name)&&void 0!==_connectors$find$name?_connectors$find$name:"none"},[connectors,selectedConnector.id]),dropDownLabel=Object(external_kbnSharedDeps_React_.useMemo)(()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},configure_cases_translations.o),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},"none"!==connectorsName&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{disabled:updateConnectorDisabled,onClick:handleShowEditFlyout,"data-test-subj":"case-configure-update-selected-connector-button"},configure_cases_translations.r(connectorsName)))),[connectorsName,handleShowEditFlyout,updateConnectorDisabled]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescribedFormGroup,{fullWidth:!0,title:external_kbnSharedDeps_React_default.a.createElement("h3",null,configure_cases_translations.p),description:configure_cases_translations.n,"data-test-subj":"case-connectors-form-group"},external_kbnSharedDeps_React_default.a.createElement(EuiFormRowExtended,{fullWidth:!0,label:dropDownLabel,"data-test-subj":"case-connectors-form-row"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"column"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(connectors_dropdown.a,{connectors:connectors,disabled:disabled,selectedConnector:selectedConnector.id,isLoading:isLoading,onChange:onChangeConnector,"data-test-subj":"case-connectors-dropdown",appendAddConnectorButton:!0})),selectedConnector.type!==api_connectors.c.none?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(Mapping,{connectorActionTypeId:selectedConnector.type,isLoading:isLoading,mappings:mappings})):null))))},Connectors=external_kbnSharedDeps_React_default.a.memo(ConnectorsComponent),radios=[{id:"close-by-user",label:configure_cases_translations.d},{id:"close-by-pushing",label:configure_cases_translations.e}],ClosureOptionsRadioComponent=({closureTypeSelected:closureTypeSelected,disabled:disabled,onChangeClosureType:onChangeClosureType})=>{const onChangeLocal=Object(external_kbnSharedDeps_React_.useCallback)(id=>{onChangeClosureType(id)},[onChangeClosureType]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiRadioGroup,{disabled:disabled,options:radios,idSelected:closureTypeSelected,onChange:onChangeLocal,name:"closure_options","data-test-subj":"closure-options-radio-group"})},ClosureOptionsRadio=external_kbnSharedDeps_React_default.a.memo(ClosureOptionsRadioComponent),ClosureOptionsComponent=({closureTypeSelected:closureTypeSelected,disabled:disabled,onChangeClosureType:onChangeClosureType})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescribedFormGroup,{fullWidth:!0,title:external_kbnSharedDeps_React_default.a.createElement("h3",null,configure_cases_translations.f),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement("p",null,configure_cases_translations.b),external_kbnSharedDeps_React_default.a.createElement("p",null,configure_cases_translations.g)),"data-test-subj":"case-closure-options-form-group"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{fullWidth:!0,label:configure_cases_translations.c,"data-test-subj":"case-closure-options-form-row"},external_kbnSharedDeps_React_default.a.createElement(ClosureOptionsRadio,{closureTypeSelected:closureTypeSelected,disabled:disabled,onChangeClosureType:onChangeClosureType,"data-test-subj":"case-closure-options-radio"}))),ClosureOptions=external_kbnSharedDeps_React_default.a.memo(ClosureOptionsComponent),FormWrapper=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"FormWrapper",componentId:"ox2hsq-0"})(["",""],({theme:theme})=>Object(external_kbnSharedDeps_StyledComponents_.css)(["& > *{margin-top 40px;}& >:first-child{margin-top:0;}padding-top:",";padding-bottom:",";.euiFlyout{z-index:",";}"],theme.eui.paddingSizes.xl,theme.eui.paddingSizes.xl,theme.eui.euiZNavigation+1)),ConfigureCasesComponent=({userCanCrud:userCanCrud})=>{const{triggersActionsUi:triggersActionsUi}=Object(lib_kibana.h)().services,[connectorIsValid,setConnectorIsValid]=Object(external_kbnSharedDeps_React_.useState)(!0),[addFlyoutVisible,setAddFlyoutVisibility]=Object(external_kbnSharedDeps_React_.useState)(!1),[editFlyoutVisible,setEditFlyoutVisibility]=Object(external_kbnSharedDeps_React_.useState)(!1),[editedConnectorItem,setEditedConnectorItem]=Object(external_kbnSharedDeps_React_.useState)(null),{connector:connector,closureType:closureType,loading:loadingCaseConfigure,mappings:mappings,persistLoading:persistLoading,persistCaseConfigure:persistCaseConfigure,refetchCaseConfigure:refetchCaseConfigure,setConnector:setConnector,setClosureType:setClosureType}=Object(use_configure.a)(),{loading:isLoadingConnectors,connectors:connectors,refetchConnectors:refetchConnectors}=Object(use_connectors.a)(),{loading:isLoadingActionTypes,actionTypes:actionTypes,refetchActionTypes:refetchActionTypes}=(()=>{const[,dispatchToaster]=Object(toasters.h)(),[loading,setLoading]=Object(external_kbnSharedDeps_React_.useState)(!0),[actionTypes,setActionTypes]=Object(external_kbnSharedDeps_React_.useState)([]),isCancelledRef=Object(external_kbnSharedDeps_React_.useRef)(!1),abortCtrlRef=Object(external_kbnSharedDeps_React_.useRef)(new AbortController),queryFirstTime=Object(external_kbnSharedDeps_React_.useRef)(!0),refetchActionTypes=Object(external_kbnSharedDeps_React_.useCallback)(async()=>{try{setLoading(!0),isCancelledRef.current=!1,abortCtrlRef.current.abort(),abortCtrlRef.current=new AbortController;const res=await Object(configure_api.a)({signal:abortCtrlRef.current.signal});isCancelledRef.current||(setLoading(!1),setActionTypes(res))}catch(error){isCancelledRef.current||(setLoading(!1),setActionTypes([]),Object(toasters.g)({title:containers_translations.d,error:error.body&&error.body.message?new Error(error.body.message):error,dispatchToaster:dispatchToaster}))}},[dispatchToaster]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>(queryFirstTime.current&&(refetchActionTypes(),queryFirstTime.current=!1),()=>{isCancelledRef.current=!0,abortCtrlRef.current.abort(),queryFirstTime.current=!0}),[refetchActionTypes]),{loading:loading,actionTypes:actionTypes,refetchActionTypes:refetchActionTypes}})(),supportedActionTypes=Object(external_kbnSharedDeps_React_.useMemo)(()=>actionTypes.filter(actionType=>common_constants.s.includes(actionType.id)),[actionTypes]),onConnectorUpdate=Object(external_kbnSharedDeps_React_.useCallback)(async()=>{refetchConnectors(),refetchActionTypes(),refetchCaseConfigure()},[refetchActionTypes,refetchCaseConfigure,refetchConnectors]),isLoadingAny=isLoadingConnectors||persistLoading||loadingCaseConfigure||isLoadingActionTypes,updateConnectorDisabled=isLoadingAny||!connectorIsValid||"none"===connector.id,onClickUpdateConnector=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setEditFlyoutVisibility(!0)},[]),onCloseAddFlyout=Object(external_kbnSharedDeps_React_.useCallback)(()=>setAddFlyoutVisibility(!1),[setAddFlyoutVisibility]),onCloseEditFlyout=Object(external_kbnSharedDeps_React_.useCallback)(()=>setEditFlyoutVisibility(!1),[]),onChangeConnector=Object(external_kbnSharedDeps_React_.useCallback)(id=>{if("add-connector"===id)return void setAddFlyoutVisibility(!0);const actionConnector=Object(configure_cases_utils.a)(id,connectors),caseConnector=null!=actionConnector?Object(configure_cases_utils.c)(actionConnector):Object(configure_cases_utils.b)();setConnector(caseConnector),persistCaseConfigure({connector:caseConnector,closureType:closureType})},[connectors,closureType,persistCaseConfigure,setConnector]),onChangeClosureType=Object(external_kbnSharedDeps_React_.useCallback)(type=>{setClosureType(type),persistCaseConfigure({connector:connector,closureType:type})},[connector,persistCaseConfigure,setClosureType]);Object(external_kbnSharedDeps_React_.useEffect)(()=>{isLoadingConnectors||"none"===connector.id||connectors.some(c=>c.id===connector.id)?isLoadingConnectors||"none"!==connector.id&&!connectors.some(c=>c.id===connector.id)||setConnectorIsValid(!0):setConnectorIsValid(!1)},[connectors,connector,isLoadingConnectors]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{isLoadingConnectors||"none"===connector.id||setEditedConnectorItem(Object(configure_cases_utils.d)(connectors,connector))},[connectors,connector,isLoadingConnectors]);const ConnectorAddFlyout=Object(external_kbnSharedDeps_React_.useMemo)(()=>triggersActionsUi.getAddConnectorFlyout({consumer:"case",onClose:onCloseAddFlyout,actionTypes:supportedActionTypes,reloadConnectors:onConnectorUpdate}),[supportedActionTypes]),ConnectorEditFlyout=Object(external_kbnSharedDeps_React_.useMemo)(()=>editedConnectorItem&&editFlyoutVisible?triggersActionsUi.getEditConnectorFlyout({initialConnector:editedConnectorItem,consumer:"case",onClose:onCloseEditFlyout,reloadConnectors:onConnectorUpdate}):null,[connector.id,editFlyoutVisible]);return external_kbnSharedDeps_React_default.a.createElement(FormWrapper,null,!connectorIsValid&&external_kbnSharedDeps_React_default.a.createElement(SectionWrapper,{style:{marginTop:0}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:configure_cases_translations.t,color:"warning",iconType:"help","data-test-subj":"configure-cases-warning-callout"},configure_cases_translations.s)),external_kbnSharedDeps_React_default.a.createElement(SectionWrapper,null,external_kbnSharedDeps_React_default.a.createElement(ClosureOptions,{closureTypeSelected:closureType,disabled:persistLoading||isLoadingConnectors||!userCanCrud,onChangeClosureType:onChangeClosureType})),external_kbnSharedDeps_React_default.a.createElement(SectionWrapper,null,external_kbnSharedDeps_React_default.a.createElement(Connectors,{connectors:null!=connectors?connectors:[],disabled:persistLoading||isLoadingConnectors||!userCanCrud,handleShowEditFlyout:onClickUpdateConnector,isLoading:isLoadingAny,mappings:mappings,onChangeConnector:onChangeConnector,selectedConnector:connector,updateConnectorDisabled:updateConnectorDisabled||!userCanCrud})),addFlyoutVisible&&ConnectorAddFlyout,ConnectorEditFlyout)},ConfigureCases=external_kbnSharedDeps_React_default.a.memo(ConfigureCasesComponent),ConfigureCasesPageComponent=()=>{var _userPermissions$crud;const history=Object(external_kbnSharedDeps_ReactRouterDom_.useHistory)(),userPermissions=Object(lib_kibana.f)(),search=Object(use_get_url_search.a)(home_navigations.a.case),backOptions=Object(external_kbnSharedDeps_React_.useMemo)(()=>({href:Object(link_to.d)(search),text:pages_translations.a,pageId:app_types.a.case}),[search]);if(null!=userPermissions&&!userPermissions.read)return history.push(Object(link_to.d)(search)),null;const HeaderWrapper=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"HeaderWrapper",componentId:"ty9qqa-0"})(["padding-top:",";"],({theme:theme})=>theme.eui.paddingSizes.l);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(wrapper_page.a,{noPadding:!0},external_kbnSharedDeps_React_default.a.createElement(SectionWrapper,null,external_kbnSharedDeps_React_default.a.createElement(HeaderWrapper,null,external_kbnSharedDeps_React_default.a.createElement(case_header_page.a,{title:pages_translations.b,backOptions:backOptions}))),external_kbnSharedDeps_React_default.a.createElement(WhitePageWrapper,null,external_kbnSharedDeps_React_default.a.createElement(ConfigureCases,{userCanCrud:null!==(_userPermissions$crud=null==userPermissions?void 0:userPermissions.crud)&&void 0!==_userPermissions$crud&&_userPermissions$crud}))),external_kbnSharedDeps_React_default.a.createElement(spy_routes.a,{pageName:app_types.a.case}))},ConfigureCasesPage=external_kbnSharedDeps_React_default.a.memo(ConfigureCasesPageComponent),CaseContainerComponent=()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Switch,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:"/create"},external_kbnSharedDeps_React_default.a.createElement(CreateCasePage,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:"/configure"},external_kbnSharedDeps_React_default.a.createElement(ConfigureCasesPage,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{exact:!0,path:"/:detailName/sub-cases/:subCaseId/:commentId"},external_kbnSharedDeps_React_default.a.createElement(CaseDetailsPage,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{exact:!0,path:"/:detailName/:commentId"},external_kbnSharedDeps_React_default.a.createElement(CaseDetailsPage,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{exact:!0,path:"/:detailName/sub-cases/:subCaseId"},external_kbnSharedDeps_React_default.a.createElement(CaseDetailsPage,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:"/:detailName"},external_kbnSharedDeps_React_default.a.createElement(CaseDetailsPage,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{strict:!0,exact:!0,path:""},external_kbnSharedDeps_React_default.a.createElement(CasesPage,null))),Case=external_kbnSharedDeps_React_default.a.memo(CaseContainerComponent),CasesRoutes=()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Switch,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:"/"},external_kbnSharedDeps_React_default.a.createElement(Case,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{render:()=>external_kbnSharedDeps_React_default.a.createElement(_404.a,null)}));var search_strategy=__webpack_require__(118),last_event_time=__webpack_require__(393),anomaly_table_provider=__webpack_require__(679),host_to_criteria=__webpack_require__(681),has_ml_user_permissions=__webpack_require__(213),score_interval_to_datetime=__webpack_require__(249),navigation=__webpack_require__(325),containers_helpers=__webpack_require__(138);const ERROR_HOSTS_KPI_AUTHENTICATIONS=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.hostsKpiAuthentications.errorSearchDescription",{defaultMessage:"An error has occurred on hosts kpi authentications search"}),FAIL_HOSTS_KPI_AUTHENTICATIONS=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.hostsKpiAuthentications.failSearchDescription",{defaultMessage:"Failed to run search on hosts kpi authentications"});var public_helpers=__webpack_require__(35);var manage_query=__webpack_require__(142),chart_place_holder=__webpack_require__(613),common=__webpack_require__(345);const checkIfAllTheDataInTheSeriesAreValid=series=>!!Object(external_kbnSharedDeps_LodashFp_.get)("value.length",series)&&Object(external_kbnSharedDeps_LodashFp_.get)("value",series).every(({x:x,y:y})=>!Object(external_kbnSharedDeps_LodashFp_.isNull)(x)&&Object(external_kbnSharedDeps_LodashFp_.isNumber)(y)&&y>0),axisStyle={tickLine:{visible:!1},tickLabel:{padding:3}},AreaChartBaseComponent=({data:data,...chartConfigs})=>{const theme=Object(common.f)(),timeZone=Object(lib_kibana.i)(),xTickFormatter=Object(external_kbnSharedDeps_LodashFp_.get)("configs.axis.xTickFormatter",chartConfigs),yTickFormatter=Object(external_kbnSharedDeps_LodashFp_.get)("configs.axis.yTickFormatter",chartConfigs),xAxisId=`group-${data[0].key}-x`,yAxisId=`group-${data[0].key}-y`,settings={...common.b,theme:theme,...Object(external_kbnSharedDeps_LodashFp_.get)("configs.settings",chartConfigs)};return chartConfigs.width&&chartConfigs.height?external_kbnSharedDeps_React_default.a.createElement("div",{style:{height:chartConfigs.height,width:chartConfigs.width,position:"relative"}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_.Chart,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_.Settings,settings),data.map(series=>{const seriesKey=series.key;return checkIfAllTheDataInTheSeriesAreValid(series)?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_.AreaSeries,{id:seriesKey,key:seriesKey,name:series.key.replace("Histogram",""),data:series.value||[],xScaleType:Object(external_kbnSharedDeps_LodashFp_.getOr)(external_kbnSharedDeps_ElasticCharts_.ScaleType.Linear,"configs.series.xScaleType",chartConfigs),yScaleType:Object(external_kbnSharedDeps_LodashFp_.getOr)(external_kbnSharedDeps_ElasticCharts_.ScaleType.Linear,"configs.series.yScaleType",chartConfigs),timeZone:timeZone,xAccessor:"x",yAccessors:["y"],areaSeriesStyle:{area:{opacity:.04,visible:!0},line:{strokeWidth:1,visible:!0},point:{visible:!1,radius:.2,strokeWidth:1,opacity:1}},color:series.color?series.color:void 0}):null}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_.Axis,{id:xAxisId,position:external_kbnSharedDeps_ElasticCharts_.Position.Bottom,showOverlappingTicks:!1,tickFormat:xTickFormatter,style:axisStyle}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_.Axis,{id:yAxisId,position:external_kbnSharedDeps_ElasticCharts_.Position.Left,style:axisStyle,tickFormat:yTickFormatter}))):null};AreaChartBaseComponent.displayName="AreaChartBaseComponent";const AreaChartBase=external_kbnSharedDeps_React_default.a.memo(AreaChartBaseComponent);AreaChartBase.displayName="AreaChartBase";const AreaChartComponent=({areaChart:areaChart,configs:configs})=>{const{ref:measureRef,width:width,height:height}=Object(components_utils.b)(),customHeight=Object(external_kbnSharedDeps_LodashFp_.get)("customHeight",configs),customWidth=Object(external_kbnSharedDeps_LodashFp_.get)("customWidth",configs),chartHeight=Object(common.d)(customHeight,height),chartWidth=Object(common.e)(customWidth,width);return data=areaChart,Array.isArray(data)&&data.some(checkIfAllTheDataInTheSeriesAreValid)?external_kbnSharedDeps_React_default.a.createElement(common.a,{ref:measureRef,height:chartHeight},external_kbnSharedDeps_React_default.a.createElement(AreaChartBase,{data:areaChart,height:chartHeight,width:chartWidth,configs:configs})):external_kbnSharedDeps_React_default.a.createElement(chart_place_holder.a,{height:chartHeight,width:chartWidth,data:areaChart});var data},AreaChart=external_kbnSharedDeps_React_default.a.memo(AreaChartComponent);var components_inspect=__webpack_require__(191);const FlexItem=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexItem).withConfig({displayName:"FlexItem",componentId:"sc-1rm4ik7-0"})(["min-width:0;"]);FlexItem.displayName="FlexItem";const StatValue=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiTitle).withConfig({displayName:"StatValue",componentId:"sc-1rm4ik7-1"})(["overflow:hidden;text-overflow:ellipsis;white-space:nowrap;"]);StatValue.displayName="StatValue";const numberFormatter=value=>value.toLocaleString(),areachartConfigs=config=>({series:{xScaleType:external_kbnSharedDeps_ElasticCharts_.ScaleType.Time,yScaleType:external_kbnSharedDeps_ElasticCharts_.ScaleType.Linear},axis:{xTickFormatter:Object(external_kbnSharedDeps_LodashFp_.get)("xTickFormatter",config),yTickFormatter:numberFormatter},settings:{onBrushEnd:Object(external_kbnSharedDeps_LodashFp_.getOr)(()=>{},"onBrushEnd",config)},customHeight:74}),addValueToFields=(fields,data)=>fields.map(field=>({...field,value:Object(external_kbnSharedDeps_LodashFp_.get)(field.key,data)})),addValueToAreaChart=(fields,data)=>fields.filter(field=>null!=Object(external_kbnSharedDeps_LodashFp_.get)(field.key+"Histogram",data)).map(field=>({...field,value:Object(external_kbnSharedDeps_LodashFp_.get)(field.key+"Histogram",data),key:field.key+"Histogram"})),addValueToBarChart=(fields,data)=>0===fields.length?[]:fields.reduce((acc,field,idx)=>{const{key:key,color:color}=field,y=Object(external_kbnSharedDeps_LodashFp_.getOr)(null,key,data);return[...acc,{key:key,color:color,value:[{x:Object(external_kbnSharedDeps_LodashFp_.get)(idx+".name",fields)||Object(external_kbnSharedDeps_LodashFp_.getOr)("",idx+".description",fields),y:y,g:key,y0:0}]}]},[]),useKpiMatrixStatus=(mappings,data,id,from,to,narrowDateRange)=>{const[statItemsProps,setStatItemsProps]=Object(external_kbnSharedDeps_React_.useState)(mappings);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{setStatItemsProps(mappings.map(stat=>({...stat,areaChart:stat.enableAreaChart?addValueToAreaChart(stat.fields,data):void 0,barChart:stat.enableBarChart?addValueToBarChart(stat.fields,data):void 0,fields:addValueToFields(stat.fields,data),id:id,key:"kpi-summary-"+stat.key,statKey:""+stat.key,from:from,to:to,narrowDateRange:narrowDateRange})))},[data]),statItemsProps},StatItemsComponent=external_kbnSharedDeps_React_default.a.memo(({areaChart:areaChart,barChart:barChart,description:description,enableAreaChart:enableAreaChart,enableBarChart:enableBarChart,fields:fields,from:from,grow:grow,id:id,index:index,narrowDateRange:narrowDateRange,statKey:statKey="item",to:to})=>{const isBarChartDataAvailable=barChart&&barChart.length&&barChart.every(item=>null!=item.value&&item.value.length>0),isAreaChartDataAvailable=areaChart&&areaChart.length&&areaChart.every(item=>null!=item.value&&item.value.length>0);return external_kbnSharedDeps_React_default.a.createElement(FlexItem,{grow:grow,"data-test-subj":"stat-"+statKey},external_kbnSharedDeps_React_default.a.createElement(components_inspect.b,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPanel,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"none"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"xxxs"},external_kbnSharedDeps_React_default.a.createElement("h6",null,description))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(components_inspect.a,{queryId:id,title:"KPI "+description,inspectIndex:index}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,fields.map(field=>external_kbnSharedDeps_React_default.a.createElement(FlexItem,{key:"stat-items-field-"+field.key},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",gutterSize:"m",responsive:!1},(isAreaChartDataAvailable||isBarChartDataAvailable)&&field.icon&&external_kbnSharedDeps_React_default.a.createElement(FlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{type:field.icon,color:field.color,size:"l","data-test-subj":"stat-icon"})),external_kbnSharedDeps_React_default.a.createElement(FlexItem,null,external_kbnSharedDeps_React_default.a.createElement(StatValue,null,external_kbnSharedDeps_React_default.a.createElement("p",{"data-test-subj":"stat-title"},null!=field.value?field.value.toLocaleString():Object(empty_value.d)()," ",field.description))))))),(enableAreaChart||enableBarChart)&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHorizontalRule,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,enableBarChart&&external_kbnSharedDeps_React_default.a.createElement(FlexItem,null,external_kbnSharedDeps_React_default.a.createElement(barchart.a,{barChart:barChart,configs:{series:{xScaleType:external_kbnSharedDeps_ElasticCharts_.ScaleType.Ordinal,yScaleType:external_kbnSharedDeps_ElasticCharts_.ScaleType.Linear,stackAccessors:["y0"]},axis:{xTickFormatter:numberFormatter},settings:{onElementClick:Object(external_kbnSharedDeps_LodashFp_.getOr)(()=>{},"onElementClick",config),rotation:90},customHeight:74}})),enableAreaChart&&null!=from&&null!=to&&external_kbnSharedDeps_React_default.a.createElement(FlexItem,null,external_kbnSharedDeps_React_default.a.createElement(AreaChart,{areaChart:areaChart,configs:areachartConfigs({xTickFormatter:Object(components_utils.a)([from,to]),onBrushEnd:narrowDateRange})}))))));var config},(prevProps,nextProps)=>prevProps.description===nextProps.description&&prevProps.enableAreaChart===nextProps.enableAreaChart&&prevProps.enableBarChart===nextProps.enableBarChart&&prevProps.from===nextProps.from&&prevProps.grow===nextProps.grow&&prevProps.id===nextProps.id&&prevProps.index===nextProps.index&&prevProps.narrowDateRange===nextProps.narrowDateRange&&prevProps.statKey===nextProps.statKey&&prevProps.to===nextProps.to&&fast_deep_equal_default()(prevProps.areaChart,nextProps.areaChart)&&fast_deep_equal_default()(prevProps.barChart,nextProps.barChart)&&fast_deep_equal_default()(prevProps.fields,nextProps.fields));StatItemsComponent.displayName="StatItemsComponent";const FlexGroup=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup).withConfig({displayName:"FlexGroup",componentId:"sc-17i7jd7-0"})(["min-height:","px;"],247);FlexGroup.displayName="FlexGroup";const HostsKpiBaseComponent=external_kbnSharedDeps_React_default.a.memo(({fieldsMapping:fieldsMapping,data:data,id:id,loading:loading=!1,from:from,to:to,narrowDateRange:narrowDateRange})=>{const statItemsProps=useKpiMatrixStatus(fieldsMapping,data,id,from,to,narrowDateRange);return loading?external_kbnSharedDeps_React_default.a.createElement(FlexGroup,{justifyContent:"center",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingSpinner,{size:"xl"}))):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{wrap:!0},statItemsProps.map(mappedStatItemProps=>external_kbnSharedDeps_React_default.a.createElement(StatItemsComponent,mappedStatItemProps)))},(prevProps,nextProps)=>prevProps.fieldsMapping===nextProps.fieldsMapping&&prevProps.id===nextProps.id&&prevProps.loading===nextProps.loading&&prevProps.from===nextProps.from&&prevProps.to===nextProps.to&&prevProps.narrowDateRange===nextProps.narrowDateRange&&fast_deep_equal_default()(prevProps.data,nextProps.data));HostsKpiBaseComponent.displayName="HostsKpiBaseComponent";const HostsKpiBaseComponentManage=Object(manage_query.a)(HostsKpiBaseComponent);var kpi_hosts_types=__webpack_require__(348);const USER_AUTHENTICATIONS=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.kpiHosts.userAuthentications.title",{defaultMessage:"User authentications"}),SUCCESS_UNIT_LABEL=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.kpiHosts.userAuthentications.successUnitLabel",{defaultMessage:"success"}),FAIL_UNIT_LABEL=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.kpiHosts.userAuthentications.failUnitLabel",{defaultMessage:"fail"}),SUCCESS_CHART_LABEL=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.kpiHosts.userAuthentications.successChartLabel",{defaultMessage:"Succ."}),FAIL_CHART_LABEL=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.kpiHosts.userAuthentications.failChartLabel",{defaultMessage:"Fail"}),authentications_fieldsMapping=[{key:"authentication",fields:[{key:"authenticationsSuccess",name:SUCCESS_CHART_LABEL,description:SUCCESS_UNIT_LABEL,value:null,color:kpi_hosts_types.a.authenticationsSuccess,icon:"check"},{key:"authenticationsFailure",name:FAIL_CHART_LABEL,description:FAIL_UNIT_LABEL,value:null,color:kpi_hosts_types.a.authenticationsFailure,icon:"cross"}],enableAreaChart:!0,enableBarChart:!0,description:USER_AUTHENTICATIONS}],HostsKpiAuthenticationsComponent=({filterQuery:filterQuery,from:from,indexNames:indexNames,to:to,narrowDateRange:narrowDateRange,setQuery:setQuery,skip:skip})=>{const[loading,{refetch:refetch,id:id,inspect:inspect,...data}]=(({filterQuery:filterQuery,endDate:endDate,indexNames:indexNames,skip:skip=!1,startDate:startDate})=>{const{data:data}=Object(lib_kibana.h)().services,refetch=Object(external_kbnSharedDeps_React_.useRef)(external_kbnSharedDeps_LodashFp_.noop),abortCtrl=Object(external_kbnSharedDeps_React_.useRef)(new AbortController),searchSubscription$=Object(external_kbnSharedDeps_React_.useRef)(new external_kbnSharedDeps_Rxjs_.Subscription),[loading,setLoading]=Object(external_kbnSharedDeps_React_.useState)(!1),[hostsKpiAuthenticationsRequest,setHostsKpiAuthenticationsRequest]=Object(external_kbnSharedDeps_React_.useState)(null),[hostsKpiAuthenticationsResponse,setHostsKpiAuthenticationsResponse]=Object(external_kbnSharedDeps_React_.useState)({authenticationsSuccess:0,authenticationsSuccessHistogram:[],authenticationsFailure:0,authenticationsFailureHistogram:[],id:"hostsKpiAuthenticationsQuery",inspect:{dsl:[],response:[]},isInspected:!1,refetch:refetch.current}),{addError:addError,addWarning:addWarning}=Object(use_app_toasts.a)(),hostsKpiAuthenticationsSearch=Object(external_kbnSharedDeps_React_.useCallback)(request=>{if(null==request||skip)return;const asyncSearch=async()=>{abortCtrl.current=new AbortController,setLoading(!0),searchSubscription$.current=data.search.search(request,{strategy:"securitySolutionSearchStrategy",abortSignal:abortCtrl.current.signal}).subscribe({next:response=>{response.isPartial||response.isRunning?response.isPartial&&!response.isRunning&&(setLoading(!1),addWarning(ERROR_HOSTS_KPI_AUTHENTICATIONS),searchSubscription$.current.unsubscribe()):(setLoading(!1),setHostsKpiAuthenticationsResponse(prevResponse=>({...prevResponse,authenticationsSuccess:response.authenticationsSuccess,authenticationsSuccessHistogram:response.authenticationsSuccessHistogram,authenticationsFailure:response.authenticationsFailure,authenticationsFailureHistogram:response.authenticationsFailureHistogram,inspect:Object(public_helpers.a)(response,prevResponse.inspect),refetch:refetch.current})),searchSubscription$.current.unsubscribe())},error:msg=>{setLoading(!1),addError(msg,{title:FAIL_HOSTS_KPI_AUTHENTICATIONS}),searchSubscription$.current.unsubscribe()}})};searchSubscription$.current.unsubscribe(),abortCtrl.current.abort(),asyncSearch(),refetch.current=asyncSearch},[data.search,addError,addWarning,skip]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{setHostsKpiAuthenticationsRequest(prevRequest=>{const myRequest={...null!=prevRequest?prevRequest:{},defaultIndex:indexNames,factoryQueryType:search_strategy.HostsKpiQueries.kpiAuthentications,filterQuery:Object(containers_helpers.a)(filterQuery),timerange:{interval:"12h",from:startDate,to:endDate}};return fast_deep_equal_default()(prevRequest,myRequest)?prevRequest:myRequest})},[indexNames,endDate,filterQuery,startDate]),Object(external_kbnSharedDeps_React_.useEffect)(()=>(hostsKpiAuthenticationsSearch(hostsKpiAuthenticationsRequest),()=>{searchSubscription$.current.unsubscribe(),abortCtrl.current.abort()}),[hostsKpiAuthenticationsRequest,hostsKpiAuthenticationsSearch]),[loading,hostsKpiAuthenticationsResponse]})({filterQuery:filterQuery,endDate:to,indexNames:indexNames,startDate:from,skip:skip});return external_kbnSharedDeps_React_default.a.createElement(HostsKpiBaseComponentManage,{data:data,id:id,inspect:inspect,loading:loading,fieldsMapping:authentications_fieldsMapping,from:from,to:to,narrowDateRange:narrowDateRange,refetch:refetch,setQuery:setQuery})};HostsKpiAuthenticationsComponent.displayName="HostsKpiAuthenticationsComponent";const HostsKpiAuthentications=external_kbnSharedDeps_React_default.a.memo(HostsKpiAuthenticationsComponent),ERROR_HOSTS_KPI_HOSTS=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.hostsKpiHosts.errorSearchDescription",{defaultMessage:"An error has occurred on hosts kpi hosts search"}),FAIL_HOSTS_KPI_HOSTS=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.hostsKpiHosts.failSearchDescription",{defaultMessage:"Failed to run search on hosts kpi hosts"}),HOSTS=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.kpiHosts.hosts.title",{defaultMessage:"Hosts"}),hosts_fieldsMapping=[{key:"hosts",fields:[{key:"hosts",value:null,color:kpi_hosts_types.a.hosts,icon:"storage"}],enableAreaChart:!0,description:HOSTS}],HostsKpiHostsComponent=({filterQuery:filterQuery,from:from,indexNames:indexNames,to:to,narrowDateRange:narrowDateRange,setQuery:setQuery,skip:skip})=>{const[loading,{refetch:refetch,id:id,inspect:inspect,...data}]=(({filterQuery:filterQuery,endDate:endDate,indexNames:indexNames,skip:skip=!1,startDate:startDate})=>{const{data:data}=Object(lib_kibana.h)().services,refetch=Object(external_kbnSharedDeps_React_.useRef)(external_kbnSharedDeps_LodashFp_.noop),abortCtrl=Object(external_kbnSharedDeps_React_.useRef)(new AbortController),searchSubscription$=Object(external_kbnSharedDeps_React_.useRef)(new external_kbnSharedDeps_Rxjs_.Subscription),[loading,setLoading]=Object(external_kbnSharedDeps_React_.useState)(!1),[hostsKpiHostsRequest,setHostsKpiHostsRequest]=Object(external_kbnSharedDeps_React_.useState)(null),[hostsKpiHostsResponse,setHostsKpiHostsResponse]=Object(external_kbnSharedDeps_React_.useState)({hosts:0,hostsHistogram:[],id:"hostsKpiHostsQuery",inspect:{dsl:[],response:[]},isInspected:!1,refetch:refetch.current}),{addError:addError,addWarning:addWarning}=Object(use_app_toasts.a)(),hostsKpiHostsSearch=Object(external_kbnSharedDeps_React_.useCallback)(request=>{if(null==request||skip)return;const asyncSearch=async()=>{abortCtrl.current=new AbortController,setLoading(!0),searchSubscription$.current=data.search.search(request,{strategy:"securitySolutionSearchStrategy",abortSignal:abortCtrl.current.signal}).subscribe({next:response=>{response.isPartial||response.isRunning?response.isPartial&&!response.isRunning&&(setLoading(!1),addWarning(ERROR_HOSTS_KPI_HOSTS),searchSubscription$.current.unsubscribe()):(setLoading(!1),setHostsKpiHostsResponse(prevResponse=>({...prevResponse,hosts:response.hosts,hostsHistogram:response.hostsHistogram,inspect:Object(public_helpers.a)(response,prevResponse.inspect),refetch:refetch.current})),searchSubscription$.current.unsubscribe())},error:msg=>{setLoading(!1),addError(msg,{title:FAIL_HOSTS_KPI_HOSTS}),searchSubscription$.current.unsubscribe()}})};searchSubscription$.current.unsubscribe(),abortCtrl.current.abort(),asyncSearch(),refetch.current=asyncSearch},[data.search,addError,addWarning,skip]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{setHostsKpiHostsRequest(prevRequest=>{const myRequest={...null!=prevRequest?prevRequest:{},defaultIndex:indexNames,factoryQueryType:search_strategy.HostsKpiQueries.kpiHosts,filterQuery:Object(containers_helpers.a)(filterQuery),timerange:{interval:"12h",from:startDate,to:endDate}};return fast_deep_equal_default()(prevRequest,myRequest)?prevRequest:myRequest})},[indexNames,endDate,filterQuery,startDate]),Object(external_kbnSharedDeps_React_.useEffect)(()=>(hostsKpiHostsSearch(hostsKpiHostsRequest),()=>{searchSubscription$.current.unsubscribe(),abortCtrl.current.abort()}),[hostsKpiHostsRequest,hostsKpiHostsSearch]),[loading,hostsKpiHostsResponse]})({filterQuery:filterQuery,endDate:to,indexNames:indexNames,startDate:from,skip:skip});return external_kbnSharedDeps_React_default.a.createElement(HostsKpiBaseComponentManage,{data:data,id:id,inspect:inspect,loading:loading,fieldsMapping:hosts_fieldsMapping,from:from,to:to,narrowDateRange:narrowDateRange,refetch:refetch,setQuery:setQuery})},HostsKpiHosts=external_kbnSharedDeps_React_default.a.memo(HostsKpiHostsComponent),ERROR_HOSTS_KPI_UNIQUE_IPS=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.hostsKpiUniqueIps.errorSearchDescription",{defaultMessage:"An error has occurred on hosts kpi unique ips search"}),FAIL_HOSTS_KPI_UNIQUE_IPS=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.hostsKpiUniqueIps.failSearchDescription",{defaultMessage:"Failed to run search on hosts kpi unique ips"}),UNIQUE_IPS=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.kpiHosts.uniqueIps.title",{defaultMessage:"Unique IPs"}),SOURCE_UNIT_LABEL=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.kpiHosts.uniqueIps.sourceUnitLabel",{defaultMessage:"source"}),DESTINATION_UNIT_LABEL=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.kpiHosts.uniqueIps.destinationUnitLabel",{defaultMessage:"destination"}),SOURCE_CHART_LABEL=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.kpiHosts.uniqueIps.sourceChartLabel",{defaultMessage:"Src."}),DESTINATION_CHART_LABEL=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.kpiHosts.uniqueIps.destinationChartLabel",{defaultMessage:"Dest."}),unique_ips_fieldsMapping=[{key:"uniqueIps",fields:[{key:"uniqueSourceIps",name:SOURCE_CHART_LABEL,description:SOURCE_UNIT_LABEL,value:null,color:kpi_hosts_types.a.uniqueSourceIps,icon:"visMapCoordinate"},{key:"uniqueDestinationIps",name:DESTINATION_CHART_LABEL,description:DESTINATION_UNIT_LABEL,value:null,color:kpi_hosts_types.a.uniqueDestinationIps,icon:"visMapCoordinate"}],enableAreaChart:!0,enableBarChart:!0,description:UNIQUE_IPS}],HostsKpiUniqueIpsComponent=({filterQuery:filterQuery,from:from,indexNames:indexNames,to:to,narrowDateRange:narrowDateRange,setQuery:setQuery,skip:skip})=>{const[loading,{refetch:refetch,id:id,inspect:inspect,...data}]=(({filterQuery:filterQuery,endDate:endDate,indexNames:indexNames,skip:skip=!1,startDate:startDate})=>{const{data:data}=Object(lib_kibana.h)().services,refetch=Object(external_kbnSharedDeps_React_.useRef)(external_kbnSharedDeps_LodashFp_.noop),abortCtrl=Object(external_kbnSharedDeps_React_.useRef)(new AbortController),searchSubscription$=Object(external_kbnSharedDeps_React_.useRef)(new external_kbnSharedDeps_Rxjs_.Subscription),[loading,setLoading]=Object(external_kbnSharedDeps_React_.useState)(!1),[hostsKpiUniqueIpsRequest,setHostsKpiUniqueIpsRequest]=Object(external_kbnSharedDeps_React_.useState)(null),[hostsKpiUniqueIpsResponse,setHostsKpiUniqueIpsResponse]=Object(external_kbnSharedDeps_React_.useState)({uniqueSourceIps:0,uniqueSourceIpsHistogram:[],uniqueDestinationIps:0,uniqueDestinationIpsHistogram:[],id:"hostsKpiUniqueIpsQuery",inspect:{dsl:[],response:[]},isInspected:!1,refetch:refetch.current}),{addError:addError,addWarning:addWarning}=Object(use_app_toasts.a)(),hostsKpiUniqueIpsSearch=Object(external_kbnSharedDeps_React_.useCallback)(request=>{if(null==request||skip)return;const asyncSearch=async()=>{abortCtrl.current=new AbortController,setLoading(!0),searchSubscription$.current=data.search.search(request,{strategy:"securitySolutionSearchStrategy",abortSignal:abortCtrl.current.signal}).subscribe({next:response=>{response.isPartial||response.isRunning?response.isPartial&&!response.isRunning&&(setLoading(!1),addWarning(ERROR_HOSTS_KPI_UNIQUE_IPS),searchSubscription$.current.unsubscribe()):(setLoading(!1),setHostsKpiUniqueIpsResponse(prevResponse=>({...prevResponse,uniqueSourceIps:response.uniqueSourceIps,uniqueSourceIpsHistogram:response.uniqueSourceIpsHistogram,uniqueDestinationIps:response.uniqueDestinationIps,uniqueDestinationIpsHistogram:response.uniqueDestinationIpsHistogram,inspect:Object(public_helpers.a)(response,prevResponse.inspect),refetch:refetch.current})),searchSubscription$.current.unsubscribe())},error:msg=>{setLoading(!1),addError(msg,{title:FAIL_HOSTS_KPI_UNIQUE_IPS}),searchSubscription$.current.unsubscribe()}})};searchSubscription$.current.unsubscribe(),abortCtrl.current.abort(),asyncSearch(),refetch.current=asyncSearch},[data.search,addError,addWarning,skip]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{setHostsKpiUniqueIpsRequest(prevRequest=>{const myRequest={...null!=prevRequest?prevRequest:{},defaultIndex:indexNames,factoryQueryType:search_strategy.HostsKpiQueries.kpiUniqueIps,filterQuery:Object(containers_helpers.a)(filterQuery),timerange:{interval:"12h",from:startDate,to:endDate}};return fast_deep_equal_default()(prevRequest,myRequest)?prevRequest:myRequest})},[indexNames,endDate,filterQuery,skip,startDate]),Object(external_kbnSharedDeps_React_.useEffect)(()=>(hostsKpiUniqueIpsSearch(hostsKpiUniqueIpsRequest),()=>{searchSubscription$.current.unsubscribe(),abortCtrl.current.abort()}),[hostsKpiUniqueIpsRequest,hostsKpiUniqueIpsSearch]),[loading,hostsKpiUniqueIpsResponse]})({filterQuery:filterQuery,endDate:to,indexNames:indexNames,startDate:from,skip:skip});return external_kbnSharedDeps_React_default.a.createElement(HostsKpiBaseComponentManage,{data:data,id:id,inspect:inspect,loading:loading,fieldsMapping:unique_ips_fieldsMapping,from:from,to:to,narrowDateRange:narrowDateRange,refetch:refetch,setQuery:setQuery})},HostsKpiUniqueIps=external_kbnSharedDeps_React_default.a.memo(HostsKpiUniqueIpsComponent),HostsKpiComponent=external_kbnSharedDeps_React_default.a.memo(({filterQuery:filterQuery,from:from,indexNames:indexNames,to:to,setQuery:setQuery,skip:skip,narrowDateRange:narrowDateRange})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{wrap:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:1},external_kbnSharedDeps_React_default.a.createElement(HostsKpiHosts,{filterQuery:filterQuery,from:from,indexNames:indexNames,to:to,narrowDateRange:narrowDateRange,setQuery:setQuery,skip:skip})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:2},external_kbnSharedDeps_React_default.a.createElement(HostsKpiAuthentications,{filterQuery:filterQuery,from:from,indexNames:indexNames,to:to,narrowDateRange:narrowDateRange,setQuery:setQuery,skip:skip})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:2},external_kbnSharedDeps_React_default.a.createElement(HostsKpiUniqueIps,{filterQuery:filterQuery,from:from,indexNames:indexNames,to:to,narrowDateRange:narrowDateRange,setQuery:setQuery,skip:skip}))));HostsKpiComponent.displayName="HostsKpiComponent";const HostsDetailsKpiComponent=external_kbnSharedDeps_React_default.a.memo(({filterQuery:filterQuery,from:from,indexNames:indexNames,to:to,setQuery:setQuery,skip:skip,narrowDateRange:narrowDateRange})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{wrap:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:1},external_kbnSharedDeps_React_default.a.createElement(HostsKpiAuthentications,{filterQuery:filterQuery,from:from,indexNames:indexNames,to:to,narrowDateRange:narrowDateRange,setQuery:setQuery,skip:skip})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:1},external_kbnSharedDeps_React_default.a.createElement(HostsKpiUniqueIps,{filterQuery:filterQuery,from:from,indexNames:indexNames,to:to,narrowDateRange:narrowDateRange,setQuery:setQuery,skip:skip}))));HostsDetailsKpiComponent.displayName="HostsDetailsKpiComponent";var host_overview=__webpack_require__(720),store_actions=__webpack_require__(346),store_model=__webpack_require__(148),anomalies_query_tab_body=__webpack_require__(392),use_anomalies_table_data=__webpack_require__(326),tables_translations=__webpack_require__(379),tables_helpers=__webpack_require__(186),entity_draggable=__webpack_require__(694),create_compound_key=__webpack_require__(695),get_entries=__webpack_require__(313),draggable_score=__webpack_require__(470),create_explorer_link=__webpack_require__(471),drag_and_drop_helpers=__webpack_require__(123);const getAnomaliesHostTableColumnsCurated=(pageType,startDate,endDate,interval,narrowDateRange)=>{const columns=((startDate,endDate,interval,narrowDateRange)=>[{name:tables_translations.d,field:"hostName",sortable:!0,render:(hostName,anomaliesByHost)=>Object(tables_helpers.b)({rowItem:hostName,attrName:"host.name",idPrefix:`anomalies-host-table-hostName-${Object(create_compound_key.a)(anomaliesByHost)}-hostName`,render:item=>external_kbnSharedDeps_React_default.a.createElement(links.d,{hostName:item})})},{name:tables_translations.b,field:"anomaly.jobId",sortable:!0,render:(jobId,anomaliesByHost)=>external_kbnSharedDeps_React_default.a.createElement(create_explorer_link.a,{score:anomaliesByHost.anomaly,startDate:startDate,endDate:endDate,linkName:jobId})},{name:tables_translations.g,field:"anomaly.severity",sortable:!0,render:(_,anomaliesByHost)=>external_kbnSharedDeps_React_default.a.createElement(draggable_score.a,{id:Object(drag_and_drop_helpers.l)("anomalies-host-table-severity-"+Object(create_compound_key.a)(anomaliesByHost)),score:anomaliesByHost.anomaly})},{name:tables_translations.c,field:"anomaly.entityValue",sortable:!0,render:(entityValue,anomaliesByHost)=>external_kbnSharedDeps_React_default.a.createElement(entity_draggable.a,{idPrefix:`anomalies-host-table-entityValue${Object(create_compound_key.a)(anomaliesByHost)}-entity`,entityName:anomaliesByHost.anomaly.entityName,entityValue:entityValue})},{name:tables_translations.e,field:"anomaly.influencers",render:(influencers,anomaliesByHost)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"column",gutterSize:"none",responsive:!1},influencers&&influencers.map(influencer=>{const[key,value]=Object(get_entries.a)(influencer),entityName=null!=key?key:"",entityValue=null!=value?value:"";return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{key:`${entityName}-${entityValue}-${Object(create_compound_key.a)(anomaliesByHost)}`,grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"none",responsive:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(entity_draggable.a,{idPrefix:`anomalies-host-table-influencers-${entityName}-${entityValue}-${Object(create_compound_key.a)(anomaliesByHost)}`,entityName:entityName,entityValue:entityValue}))))}))},{name:tables_translations.i,field:"anomaly.time",sortable:!0,render:time=>external_kbnSharedDeps_React_default.a.createElement(formatted_date.b,{value:time})}])(startDate,endDate);return pageType===store_model.HostsType.details?columns.filter(column=>column.name!==tables_translations.d):columns},convertAnomaliesToHosts=(anomalies,hostName)=>null==anomalies?[]:anomalies.anomalies.reduce((accum,item)=>{if(getHostNameFromEntity(item,hostName))return[...accum,{hostName:item.entityValue,anomaly:item}];{const hostNameFromInfluencers=((influencers=[],hostName)=>{const recordFound=influencers.find(influencer=>{const[influencerName,influencerValue]=Object(get_entries.a)(influencer);return"host.name"===influencerName&&(null==hostName||influencerValue===hostName)});return null!=recordFound?Object.values(recordFound)[0]:null})(item.influencers,hostName);return null!=hostNameFromInfluencers?[...accum,{hostName:hostNameFromInfluencers,anomaly:item}]:accum}},[]),getHostNameFromEntity=(anomaly,hostName)=>"host.name"===anomaly.entityName&&(null==hostName||anomaly.entityValue===hostName);var basic_table=__webpack_require__(696);const hostEquality=(prevProps,nextProps)=>prevProps.startDate===nextProps.startDate&&prevProps.endDate===nextProps.endDate&&prevProps.skip===nextProps.skip,getCriteriaFromHostType=(type,hostName)=>type===store_model.HostsType.details&&null!=hostName?[{fieldName:"host.name",fieldValue:hostName}]:[],anomalies_host_table_sorting={sort:{field:"anomaly.severity",direction:"desc"}},AnomaliesHostTableComponent=({startDate:startDate,endDate:endDate,narrowDateRange:narrowDateRange,hostName:hostName,skip:skip,type:type})=>{const capabilities=Object(use_ml_capabilities.a)(),[loading,tableData]=Object(use_anomalies_table_data.a)({startDate:startDate,endDate:endDate,skip:skip,criteriaFields:getCriteriaFromHostType(type,hostName)}),hosts=convertAnomaliesToHosts(tableData,hostName);null==(anomalies=tableData)||anomalies.interval;var anomalies;const columns=getAnomaliesHostTableColumnsCurated(type,startDate,endDate),pagination={initialPageIndex:0,initialPageSize:10,totalItemCount:hosts.length,pageSizeOptions:[5,10,20,50],hidePerPageOptions:!1};return Object(has_ml_user_permissions.a)(capabilities)?external_kbnSharedDeps_React_default.a.createElement(panel.a,{loading:loading},external_kbnSharedDeps_React_default.a.createElement(header_section.a,{subtitle:`${tables_translations.h}: ${pagination.totalItemCount.toLocaleString()} ${tables_translations.k(pagination.totalItemCount)}`,title:tables_translations.a,tooltip:tables_translations.j}),external_kbnSharedDeps_React_default.a.createElement(basic_table.a,{columns:columns,items:hosts,pagination:pagination,sorting:anomalies_host_table_sorting}),loading&&external_kbnSharedDeps_React_default.a.createElement(loader.a,{"data-test-subj":"anomalies-host-table-loading-panel",overlay:!0,size:"xl"})):null},AnomaliesHostTable=external_kbnSharedDeps_React_default.a.memo(AnomaliesHostTableComponent,hostEquality);var details_utils=__webpack_require__(477),pages_navigation=__webpack_require__(390);function details_tabs_extends(){return(details_tabs_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const HostDetailsTabs=external_kbnSharedDeps_React_default.a.memo(({detailName:detailName,docValueFields:docValueFields,filterQuery:filterQuery,indexNames:indexNames,indexPattern:indexPattern,pageFilters:pageFilters,setAbsoluteRangeDatePicker:setAbsoluteRangeDatePicker,hostDetailsPagePath:hostDetailsPagePath})=>{const{from:from,to:to,isInitializing:isInitializing,deleteQuery:deleteQuery,setQuery:setQuery}=Object(use_global_time.a)(),narrowDateRange=Object(external_kbnSharedDeps_React_.useCallback)((score,interval)=>{const fromTo=Object(score_interval_to_datetime.a)(score,interval);setAbsoluteRangeDatePicker({id:"global",from:fromTo.from,to:fromTo.to})},[setAbsoluteRangeDatePicker]),updateDateRange=Object(external_kbnSharedDeps_React_.useCallback)(({x:x})=>{if(!x)return;const[min,max]=x;setAbsoluteRangeDatePicker({id:"global",from:new Date(min).toISOString(),to:new Date(max).toISOString()})},[setAbsoluteRangeDatePicker]),tabProps={deleteQuery:deleteQuery,endDate:to,filterQuery:filterQuery,skip:isInitializing,setQuery:setQuery,startDate:from,type:details_utils.b,indexPattern:indexPattern,indexNames:indexNames,hostName:detailName,narrowDateRange:narrowDateRange,updateDateRange:updateDateRange};return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Switch,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:`${hostDetailsPagePath}/:tabName(${store_model.HostsTableType.authentications})`},external_kbnSharedDeps_React_default.a.createElement(pages_navigation.a,details_tabs_extends({docValueFields:docValueFields},tabProps))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:`${hostDetailsPagePath}/:tabName(${store_model.HostsTableType.hosts})`},external_kbnSharedDeps_React_default.a.createElement(pages_navigation.d,tabProps)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:`${hostDetailsPagePath}/:tabName(${store_model.HostsTableType.uncommonProcesses})`},external_kbnSharedDeps_React_default.a.createElement(pages_navigation.e,tabProps)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:`${hostDetailsPagePath}/:tabName(${store_model.HostsTableType.anomalies})`},external_kbnSharedDeps_React_default.a.createElement(anomalies_query_tab_body.a,details_tabs_extends({},tabProps,{AnomaliesTableComponent:AnomaliesHostTable}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:`${hostDetailsPagePath}/:tabName(${store_model.HostsTableType.events})`},external_kbnSharedDeps_React_default.a.createElement(pages_navigation.b,details_tabs_extends({},tabProps,{pageFilters:pageFilters}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:`${hostDetailsPagePath}/:tabName(${store_model.HostsTableType.alerts})`},external_kbnSharedDeps_React_default.a.createElement(pages_navigation.c,details_tabs_extends({},tabProps,{pageFilters:pageFilters}))))});HostDetailsTabs.displayName="HostDetailsTabs";var hosts_pages_translations=__webpack_require__(270);const getTabsOnHostDetailsUrl=(hostName,tabName)=>`/${hostName}/${tabName}`,navTabsHostDetails=(hostName,hasMlUserPermissions)=>{const hostDetailsNavTabs={[store_model.HostsTableType.authentications]:{id:store_model.HostsTableType.authentications,name:hosts_pages_translations.f,href:getTabsOnHostDetailsUrl(hostName,store_model.HostsTableType.authentications),disabled:!1,urlKey:"host",isDetailPage:!0,pageId:app_types.a.hosts},[store_model.HostsTableType.uncommonProcesses]:{id:store_model.HostsTableType.uncommonProcesses,name:hosts_pages_translations.h,href:getTabsOnHostDetailsUrl(hostName,store_model.HostsTableType.uncommonProcesses),disabled:!1,urlKey:"host",isDetailPage:!0,pageId:app_types.a.hosts},[store_model.HostsTableType.anomalies]:{id:store_model.HostsTableType.anomalies,name:hosts_pages_translations.e,href:getTabsOnHostDetailsUrl(hostName,store_model.HostsTableType.anomalies),disabled:!1,urlKey:"host",isDetailPage:!0,pageId:app_types.a.hosts},[store_model.HostsTableType.events]:{id:store_model.HostsTableType.events,name:hosts_pages_translations.g,href:getTabsOnHostDetailsUrl(hostName,store_model.HostsTableType.events),disabled:!1,urlKey:"host",isDetailPage:!0,pageId:app_types.a.hosts},[store_model.HostsTableType.alerts]:{id:store_model.HostsTableType.alerts,name:hosts_pages_translations.c,href:getTabsOnHostDetailsUrl(hostName,store_model.HostsTableType.alerts),disabled:!1,urlKey:"host",pageId:app_types.a.hosts}};return hasMlUserPermissions?hostDetailsNavTabs:Object(external_kbnSharedDeps_LodashFp_.omit)(store_model.HostsTableType.anomalies,hostDetailsNavTabs)};var hosts_details=__webpack_require__(746);const HostOverviewManage=Object(manage_query.a)(host_overview.a),HostDetailsComponent=({detailName:detailName,hostDetailsPagePath:hostDetailsPagePath})=>{const dispatch=Object(react_redux_lib.useDispatch)(),getTimeline=Object(external_kbnSharedDeps_React_.useMemo)(()=>store_timeline.b.getTimelineByIdSelector(),[]),graphEventId=Object(use_selector.b)(state=>{var _getTimeline;return(null!==(_getTimeline=getTimeline(state,types_timeline.g.hostsPageEvents))&&void 0!==_getTimeline?_getTimeline:defaults.a).graphEventId}),getGlobalFiltersQuerySelector=Object(external_kbnSharedDeps_React_.useMemo)(()=>store.inputsSelectors.globalFiltersQuerySelector(),[]),getGlobalQuerySelector=Object(external_kbnSharedDeps_React_.useMemo)(()=>store.inputsSelectors.globalQuerySelector(),[]),query=Object(use_selector.a)(getGlobalQuerySelector),filters=Object(use_selector.a)(getGlobalFiltersQuerySelector),{to:to,from:from,deleteQuery:deleteQuery,setQuery:setQuery,isInitializing:isInitializing}=Object(use_global_time.a)(),{globalFullScreen:globalFullScreen}=Object(use_full_screen.a)(),capabilities=Object(use_ml_capabilities.a)(),kibana=Object(lib_kibana.h)(),hostDetailsPageFilters=Object(external_kbnSharedDeps_React_.useMemo)(()=>{return[{meta:{alias:null,negate:!1,disabled:!1,type:"phrase",key:"host.name",value:hostName=detailName,params:{query:hostName}},query:{match:{"host.name":{query:hostName,type:"phrase"}}}}];var hostName},[detailName]),narrowDateRange=Object(external_kbnSharedDeps_React_.useCallback)(({x:x})=>{if(!x)return;const[min,max]=x;dispatch(Object(inputs_actions.setAbsoluteRangeDatePicker)({id:"global",from:new Date(min).toISOString(),to:new Date(max).toISOString()}))},[dispatch]),{docValueFields:docValueFields,indicesExist:indicesExist,indexPattern:indexPattern,selectedPatterns:selectedPatterns}=Object(sourcerer.b)(),[loading,{hostDetails:hostOverview,id:id,refetch:refetch}]=Object(hosts_details.b)({endDate:to,startDate:from,hostName:detailName,indexNames:selectedPatterns,skip:0===selectedPatterns.length}),filterQuery=Object(keury.b)({config:public_.esQuery.getEsQueryConfig(kibana.services.uiSettings),indexPattern:indexPattern,queries:[query],filters:[...hostDetailsPageFilters,...filters]});return Object(external_kbnSharedDeps_React_.useEffect)(()=>{dispatch(Object(store_actions.setHostDetailsTablesActivePageToZero)())},[dispatch,detailName]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,indicesExist?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiWindowEvent,{event:"resize",handler:external_kbnSharedDeps_LodashFp_.noop}),external_kbnSharedDeps_React_default.a.createElement(filters_global.a,{show:Object(timeline_helpers.q)({globalFullScreen:globalFullScreen,graphEventId:graphEventId})},external_kbnSharedDeps_React_default.a.createElement(search_bar.a,{indexPattern:indexPattern,id:"global"})),external_kbnSharedDeps_React_default.a.createElement(wrapper_page.a,{noPadding:globalFullScreen},external_kbnSharedDeps_React_default.a.createElement(Display,{show:!globalFullScreen},external_kbnSharedDeps_React_default.a.createElement(header_page.a,{border:!0,subtitle:external_kbnSharedDeps_React_default.a.createElement(last_event_time.a,{docValueFields:docValueFields,indexKey:search_strategy.LastEventIndexKey.hostDetails,hostName:detailName,indexNames:selectedPatterns}),title:detailName}),external_kbnSharedDeps_React_default.a.createElement(anomaly_table_provider.a,{criteriaFields:Object(host_to_criteria.a)(hostOverview),startDate:from,endDate:to,skip:isInitializing},({isLoadingAnomaliesData:isLoadingAnomaliesData,anomaliesData:anomaliesData})=>external_kbnSharedDeps_React_default.a.createElement(HostOverviewManage,{docValueFields:docValueFields,id:id,isInDetailsSidePanel:!1,data:hostOverview,anomaliesData:anomaliesData,isLoadingAnomaliesData:isLoadingAnomaliesData,indexNames:selectedPatterns,loading:loading,startDate:from,endDate:to,narrowDateRange:(score,interval)=>{const fromTo=Object(score_interval_to_datetime.a)(score,interval);Object(inputs_actions.setAbsoluteRangeDatePicker)({id:"global",from:fromTo.from,to:fromTo.to})},setQuery:setQuery,refetch:refetch})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHorizontalRule,null),external_kbnSharedDeps_React_default.a.createElement(HostsDetailsKpiComponent,{filterQuery:filterQuery,from:from,indexNames:selectedPatterns,setQuery:setQuery,to:to,narrowDateRange:narrowDateRange,skip:isInitializing}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),external_kbnSharedDeps_React_default.a.createElement(navigation.a,{navTabs:navTabsHostDetails(detailName,Object(has_ml_user_permissions.a)(capabilities))}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null)),external_kbnSharedDeps_React_default.a.createElement(HostDetailsTabs,{docValueFields:docValueFields,indexNames:selectedPatterns,isInitializing:isInitializing,deleteQuery:deleteQuery,pageFilters:hostDetailsPageFilters,to:to,from:from,detailName:detailName,type:details_utils.b,setQuery:setQuery,filterQuery:filterQuery,hostDetailsPagePath:hostDetailsPagePath,indexPattern:indexPattern,setAbsoluteRangeDatePicker:inputs_actions.setAbsoluteRangeDatePicker}))):external_kbnSharedDeps_React_default.a.createElement(wrapper_page.a,null,external_kbnSharedDeps_React_default.a.createElement(header_page.a,{border:!0,title:detailName}),external_kbnSharedDeps_React_default.a.createElement(overview_empty.a,null)),external_kbnSharedDeps_React_default.a.createElement(spy_routes.a,{pageName:app_types.a.hosts}))};HostDetailsComponent.displayName="HostDetailsComponent";const HostDetails=external_kbnSharedDeps_React_default.a.memo(HostDetailsComponent);var query_string=__webpack_require__(350),external_kbnSharedDeps_RisonNode_=__webpack_require__(86);const decodeRison=value=>{try{return Object(external_kbnSharedDeps_RisonNode_.decode)(value)}catch(error){return null}},isRisonObject=value=>Object(external_kbnSharedDeps_LodashFp_.isObject)(value),isRegularString=value=>Object(external_kbnSharedDeps_LodashFp_.isString)(value),entitiesToKql=(entityNames,entities)=>entities.reduce((accum,entity,index)=>{const entityKql=((entityNames,entity)=>1===entityNames.length?`${entityNames[0]}: "${entity}"`:entityNames.reduce((accum,entityName,index,array)=>0===index?`(${entityName}: "${entity}"`:index===array.length-1?`${accum} or ${entityName}: "${entity}")`:`${accum} or ${entityName}: "${entity}"`,""))(entityNames,entity);return 0===index?entityKql:`${accum} or ${entityKql}`},""),addEntitiesToKql=(entityNames,entities,kqlQuery)=>{const value=decodeRison(kqlQuery);if(isRisonObject(value)){const appQuery=value;if(isRisonObject(appQuery)&&isRegularString(appQuery.query)){const entitiesKql=entitiesToKql(entityNames,entities);return""!==appQuery.query&&""!==entitiesKql?appQuery.query=`(${entitiesKql}) and (${appQuery.query})`:""===appQuery.query&&""!==entitiesKql&&(appQuery.query=`(${entitiesKql})`),Object(external_kbnSharedDeps_RisonNode_.encode)(value)}}else if(null==value){const entitiesKql=entitiesToKql(entityNames,entities);return Object(external_kbnSharedDeps_RisonNode_.encode)({query:`(${entitiesKql})`,language:"kuery"})}return kqlQuery},replacement=(match,p1,p2)=>`(${p2.split(",").reduce((accum,item,index)=>0===index?`${p1}: "${item}"`:`${accum} or ${p1}: "${item}"`,"")})`,replaceKqlCommasWithOr=kqlQuery=>{const value=decodeRison(kqlQuery);if(isRisonObject(value)){const appQuery=value;if(isRisonObject(appQuery)&&isRegularString(appQuery.query))return appQuery.query=appQuery.query.replace(/([\w\.\-\[\]]+)\s*:\s*"(([\w\.\-\(\)\[\]]+,[\w\.\-\(\)\[\]]+){1,})"/g,replacement),Object(external_kbnSharedDeps_RisonNode_.encode)(value)}return kqlQuery},remove_kql_variables_operators=["and","or","not"],replacer=(match,...parts)=>{if(null==parts)return"";const operatorsMatched=parts.reduce((accum,part)=>null!=part&&remove_kql_variables_operators.includes(part)?[...accum,part]:accum,[]);return operatorsMatched.length>1?` ${operatorsMatched[operatorsMatched.length-1].trim()} `:""},removeKqlVariables=kqlQuery=>{const value=decodeRison(kqlQuery);if(isRisonObject(value)){const appQuery=value;if(isRisonObject(appQuery)&&isRegularString(appQuery.query))return appQuery.query=appQuery.query.replace(/(\s+)*(and|or|not){0,1}(\s+)*([\w\.\-\[\]]+)\s*:\s*"(\$[\w\.\-\(\)\[\]]+\$)"(\s+)*(and|or|not){0,1}(\s+)*/g,replacer),Object(external_kbnSharedDeps_RisonNode_.encode)(value)}return kqlQuery},replaceKQLParts=kqlQuery=>Object(external_kbnSharedDeps_LodashFp_.flow)(replaceKqlCommasWithOr,removeKqlVariables)(kqlQuery),emptyEntity=entity=>""===entity.trim()||entity.startsWith("$")&&entity.endsWith("$"),multipleEntities=entity=>entity.split(",").length>1,getMultipleEntities=entity=>entity.split(",");var kibanaUtils_public_=__webpack_require__(39);const MlHostConditionalContainer=external_kbnSharedDeps_React_default.a.memo(({url:url})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Switch,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{strict:!0,exact:!0,path:url,render:({location:location})=>{const queryStringDecoded=Object(query_string.parse)(location.search.substring(1),{sort:!1});null!=queryStringDecoded.query&&(queryStringDecoded.query=replaceKQLParts(queryStringDecoded.query));const reEncoded=Object(query_string.stringify)(kibanaUtils_public_.url.encodeQuery(queryStringDecoded),{sort:!1,encode:!1});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Redirect,{to:"?"+reEncoded})}}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:url+"/:hostName",render:({location:location,match:{params:{hostName:hostName}}})=>{const queryStringDecoded=Object(query_string.parse)(location.search.substring(1),{sort:!1});if(null!=queryStringDecoded.query&&(queryStringDecoded.query=replaceKQLParts(queryStringDecoded.query)),emptyEntity(hostName)){const reEncoded=Object(query_string.stringify)(kibanaUtils_public_.url.encodeQuery(queryStringDecoded),{sort:!1,encode:!1});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Redirect,{to:`/${store_model.HostsTableType.anomalies}?${reEncoded}`})}if(multipleEntities(hostName)){const hosts=getMultipleEntities(hostName);queryStringDecoded.query=addEntitiesToKql(["host.name"],hosts,queryStringDecoded.query||"");const reEncoded=Object(query_string.stringify)(kibanaUtils_public_.url.encodeQuery(queryStringDecoded),{sort:!1,encode:!1});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Redirect,{to:`/${store_model.HostsTableType.anomalies}?${reEncoded}`})}{const reEncoded=Object(query_string.stringify)(kibanaUtils_public_.url.encodeQuery(queryStringDecoded),{sort:!1,encode:!1});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Redirect,{to:`/${hostName}/${store_model.HostsTableType.anomalies}?${reEncoded}`})}}}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:"/ml-hosts/",render:({location:{search:search=""}})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Redirect,{from:"/ml-hosts/",to:"/ml-hosts"+search})})));MlHostConditionalContainer.displayName="MlHostConditionalContainer";var alerts_query_tab_body=__webpack_require__(374);function hosts_tabs_extends(){return(hosts_tabs_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const HostsTabs=Object(external_kbnSharedDeps_React_.memo)(({deleteQuery:deleteQuery,docValueFields:docValueFields,filterQuery:filterQuery,from:from,indexNames:indexNames,isInitializing:isInitializing,setAbsoluteRangeDatePicker:setAbsoluteRangeDatePicker,setQuery:setQuery,to:to,type:type})=>{const tabProps={deleteQuery:deleteQuery,endDate:to,filterQuery:filterQuery,indexNames:indexNames,skip:isInitializing,setQuery:setQuery,startDate:from,type:type,narrowDateRange:Object(external_kbnSharedDeps_React_.useCallback)((score,interval)=>{const fromTo=Object(score_interval_to_datetime.a)(score,interval);setAbsoluteRangeDatePicker({id:"global",from:fromTo.from,to:fromTo.to})},[setAbsoluteRangeDatePicker]),updateDateRange:Object(external_kbnSharedDeps_React_.useCallback)(({x:x})=>{if(!x)return;const[min,max]=x;setAbsoluteRangeDatePicker({id:"global",from:new Date(min).toISOString(),to:new Date(max).toISOString()})},[setAbsoluteRangeDatePicker])};return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Switch,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:`/:tabName(${store_model.HostsTableType.hosts})`},external_kbnSharedDeps_React_default.a.createElement(pages_navigation.d,hosts_tabs_extends({docValueFields:docValueFields},tabProps))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:`/:tabName(${store_model.HostsTableType.authentications})`},external_kbnSharedDeps_React_default.a.createElement(pages_navigation.a,hosts_tabs_extends({docValueFields:docValueFields},tabProps))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:`/:tabName(${store_model.HostsTableType.uncommonProcesses})`},external_kbnSharedDeps_React_default.a.createElement(pages_navigation.e,tabProps)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:`/:tabName(${store_model.HostsTableType.anomalies})`},external_kbnSharedDeps_React_default.a.createElement(anomalies_query_tab_body.a,hosts_tabs_extends({},tabProps,{AnomaliesTableComponent:AnomaliesHostTable}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:`/:tabName(${store_model.HostsTableType.events})`},external_kbnSharedDeps_React_default.a.createElement(pages_navigation.b,tabProps)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:`/:tabName(${store_model.HostsTableType.alerts})`},external_kbnSharedDeps_React_default.a.createElement(alerts_query_tab_body.a,tabProps)))});HostsTabs.displayName="HostsTabs";const getTabsOnHostsUrl=tabName=>"/"+tabName,navTabsHosts=hasMlUserPermissions=>{const hostsNavTabs={[store_model.HostsTableType.hosts]:{id:store_model.HostsTableType.hosts,name:hosts_pages_translations.d,href:getTabsOnHostsUrl(store_model.HostsTableType.hosts),disabled:!1,urlKey:"host",pageId:app_types.a.hosts},[store_model.HostsTableType.authentications]:{id:store_model.HostsTableType.authentications,name:hosts_pages_translations.f,href:getTabsOnHostsUrl(store_model.HostsTableType.authentications),disabled:!1,urlKey:"host",pageId:app_types.a.hosts},[store_model.HostsTableType.uncommonProcesses]:{id:store_model.HostsTableType.uncommonProcesses,name:hosts_pages_translations.h,href:getTabsOnHostsUrl(store_model.HostsTableType.uncommonProcesses),disabled:!1,urlKey:"host",pageId:app_types.a.hosts},[store_model.HostsTableType.anomalies]:{id:store_model.HostsTableType.anomalies,name:hosts_pages_translations.e,href:getTabsOnHostsUrl(store_model.HostsTableType.anomalies),disabled:!1,urlKey:"host",pageId:app_types.a.hosts},[store_model.HostsTableType.events]:{id:store_model.HostsTableType.events,name:hosts_pages_translations.g,href:getTabsOnHostsUrl(store_model.HostsTableType.events),disabled:!1,urlKey:"host",pageId:app_types.a.hosts},[store_model.HostsTableType.alerts]:{id:store_model.HostsTableType.alerts,name:hosts_pages_translations.c,href:getTabsOnHostsUrl(store_model.HostsTableType.alerts),disabled:!1,urlKey:"host",pageId:app_types.a.hosts}};return hasMlUserPermissions?hostsNavTabs:Object(external_kbnSharedDeps_LodashFp_.omit)([store_model.HostsTableType.anomalies],hostsNavTabs)};var hosts_store=__webpack_require__(201);const hosts_StyledFullHeightContainer=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"StyledFullHeightContainer",componentId:"sc-13ka402-0"})(["display:flex;flex-direction:column;flex:1 1 auto;"]),HostsComponent=()=>{const dispatch=Object(react_redux_lib.useDispatch)(),containerElement=Object(external_kbnSharedDeps_React_.useRef)(null),getTimeline=Object(external_kbnSharedDeps_React_.useMemo)(()=>store_timeline.b.getTimelineByIdSelector(),[]),graphEventId=Object(use_selector.b)(state=>{var _ref,_getTimeline;return(null!==(_ref=null!==(_getTimeline=getTimeline(state,types_timeline.g.hostsPageEvents))&&void 0!==_getTimeline?_getTimeline:getTimeline(state,types_timeline.g.hostsPageExternalAlerts))&&void 0!==_ref?_ref:defaults.a).graphEventId}),getGlobalFiltersQuerySelector=Object(external_kbnSharedDeps_React_.useMemo)(()=>store.inputsSelectors.globalFiltersQuerySelector(),[]),getGlobalQuerySelector=Object(external_kbnSharedDeps_React_.useMemo)(()=>store.inputsSelectors.globalQuerySelector(),[]),query=Object(use_selector.a)(getGlobalQuerySelector),filters=Object(use_selector.a)(getGlobalFiltersQuerySelector),{to:to,from:from,deleteQuery:deleteQuery,setQuery:setQuery,isInitializing:isInitializing}=Object(use_global_time.a)(),{globalFullScreen:globalFullScreen}=Object(use_full_screen.a)(),capabilities=Object(use_ml_capabilities.a)(),{uiSettings:uiSettings}=Object(lib_kibana.h)().services,{tabName:tabName}=Object(external_kbnSharedDeps_ReactRouterDom_.useParams)(),tabsFilters=external_kbnSharedDeps_React_default.a.useMemo(()=>tabName===store_model.HostsTableType.alerts?filters.length>0?[...filters,...pages_navigation.g]:pages_navigation.g:filters,[tabName,filters]),narrowDateRange=Object(external_kbnSharedDeps_React_.useCallback)(({x:x})=>{if(!x)return;const[min,max]=x;dispatch(Object(inputs_actions.setAbsoluteRangeDatePicker)({id:"global",from:new Date(min).toISOString(),to:new Date(max).toISOString()}))},[dispatch]),{docValueFields:docValueFields,indicesExist:indicesExist,indexPattern:indexPattern,selectedPatterns:selectedPatterns}=Object(sourcerer.b)(),filterQuery=Object(external_kbnSharedDeps_React_.useMemo)(()=>Object(keury.b)({config:public_.esQuery.getEsQueryConfig(uiSettings),indexPattern:indexPattern,queries:[query],filters:filters}),[filters,indexPattern,uiSettings,query]),tabsFilterQuery=Object(external_kbnSharedDeps_React_.useMemo)(()=>Object(keury.b)({config:public_.esQuery.getEsQueryConfig(uiSettings),indexPattern:indexPattern,queries:[query],filters:tabsFilters}),[indexPattern,query,tabsFilters,uiSettings]),onSkipFocusBeforeEventsTable=Object(external_kbnSharedDeps_React_.useCallback)(()=>{var _containerElement$cur,_containerElement$cur2;null===(_containerElement$cur=containerElement.current)||void 0===_containerElement$cur||null===(_containerElement$cur2=_containerElement$cur.querySelector(".inspectButtonComponent:last-of-type"))||void 0===_containerElement$cur2||_containerElement$cur2.focus()},[containerElement]),onSkipFocusAfterEventsTable=Object(external_kbnSharedDeps_React_.useCallback)(()=>{Object(timeline_helpers.o)()},[]),onKeyDown=Object(external_kbnSharedDeps_React_.useCallback)(keyboardEvent=>{Object(accessibility_helpers.r)(keyboardEvent)&&Object(timeline_helpers.n)({containerElement:containerElement.current,keyboardEvent:keyboardEvent,onSkipFocusBeforeEventsTable:onSkipFocusBeforeEventsTable,onSkipFocusAfterEventsTable:onSkipFocusAfterEventsTable})},[containerElement,onSkipFocusBeforeEventsTable,onSkipFocusAfterEventsTable]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,indicesExist?external_kbnSharedDeps_React_default.a.createElement(hosts_StyledFullHeightContainer,{onKeyDown:onKeyDown,ref:containerElement},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiWindowEvent,{event:"resize",handler:external_kbnSharedDeps_LodashFp_.noop}),external_kbnSharedDeps_React_default.a.createElement(filters_global.a,{show:Object(timeline_helpers.q)({globalFullScreen:globalFullScreen,graphEventId:graphEventId})},external_kbnSharedDeps_React_default.a.createElement(search_bar.a,{indexPattern:indexPattern,id:"global"})),external_kbnSharedDeps_React_default.a.createElement(wrapper_page.a,{noPadding:globalFullScreen},external_kbnSharedDeps_React_default.a.createElement(Display,{show:!globalFullScreen},external_kbnSharedDeps_React_default.a.createElement(header_page.a,{border:!0,subtitle:external_kbnSharedDeps_React_default.a.createElement(last_event_time.a,{docValueFields:docValueFields,indexKey:search_strategy.LastEventIndexKey.hosts,indexNames:selectedPatterns}),title:hosts_pages_translations.i}),external_kbnSharedDeps_React_default.a.createElement(HostsKpiComponent,{filterQuery:filterQuery,indexNames:selectedPatterns,from:from,setQuery:setQuery,to:to,skip:isInitializing,narrowDateRange:narrowDateRange}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),external_kbnSharedDeps_React_default.a.createElement(navigation.a,{navTabs:navTabsHosts(Object(has_ml_user_permissions.a)(capabilities))}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null)),external_kbnSharedDeps_React_default.a.createElement(HostsTabs,{deleteQuery:deleteQuery,docValueFields:docValueFields,to:to,filterQuery:tabsFilterQuery,isInitializing:isInitializing,indexNames:selectedPatterns,setAbsoluteRangeDatePicker:inputs_actions.setAbsoluteRangeDatePicker,setQuery:setQuery,from:from,type:hosts_store.b.HostsType.page}))):external_kbnSharedDeps_React_default.a.createElement(wrapper_page.a,null,external_kbnSharedDeps_React_default.a.createElement(header_page.a,{border:!0,title:hosts_pages_translations.i}),external_kbnSharedDeps_React_default.a.createElement(overview_empty.a,null)),external_kbnSharedDeps_React_default.a.createElement(spy_routes.a,{pageName:app_types.a.hosts}))};HostsComponent.displayName="HostsComponent";const hosts_Hosts=external_kbnSharedDeps_React_default.a.memo(HostsComponent),HostsContainer=external_kbnSharedDeps_React_default.a.memo(({url:url})=>{const history=Object(external_kbnSharedDeps_ReactRouterDom_.useHistory)();return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Switch,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:"/ml-hosts",render:({location:location,match:match})=>external_kbnSharedDeps_React_default.a.createElement(MlHostConditionalContainer,{location:location,url:match.url})}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:"/:tabName("+store_model.HostsTableType.hosts+"|"+store_model.HostsTableType.authentications+"|"+store_model.HostsTableType.uncommonProcesses+"|"+store_model.HostsTableType.anomalies+"|"+store_model.HostsTableType.events+"|"+store_model.HostsTableType.alerts+")"},external_kbnSharedDeps_React_default.a.createElement(hosts_Hosts,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:"/:detailName/:tabName("+store_model.HostsTableType.authentications+"|"+store_model.HostsTableType.uncommonProcesses+"|"+store_model.HostsTableType.anomalies+"|"+store_model.HostsTableType.events+"|"+store_model.HostsTableType.alerts+")",render:({match:{params:{detailName:detailName}}})=>external_kbnSharedDeps_React_default.a.createElement(HostDetails,{hostDetailsPagePath:"/:detailName",detailName:detailName})}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:"/:detailName",render:({match:{params:{detailName:detailName}},location:{search:search=""}})=>(history.replace(`${detailName}/${store_model.HostsTableType.authentications}${search}`),null)}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{exact:!0,strict:!0,path:"",render:({location:{search:search=""}})=>(history.replace(`${store_model.HostsTableType.hosts}${search}`),null)}))});HostsContainer.displayName="HostsContainer";const HostsRoutes=()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Switch,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:"/",render:({match:match})=>external_kbnSharedDeps_React_default.a.createElement(HostsContainer,{url:match.url})}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{render:()=>external_kbnSharedDeps_React_default.a.createElement(_404.a,null)})),HOST_TIMELINE_IDS=[types_timeline.g.hostsPageEvents,types_timeline.g.hostsPageExternalAlerts];var pages_details=__webpack_require__(714),web=__webpack_require__(232),embeddable_public_=__webpack_require__(100);const Panel=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiPanel).withConfig({displayName:"Panel",componentId:"sc-4inzan-0"})(["overflow:hidden;"]);Panel.displayName="Panel";const Embeddable=external_kbnSharedDeps_React_default.a.memo(({children:children})=>external_kbnSharedDeps_React_default.a.createElement("section",{className:"siemEmbeddable"},external_kbnSharedDeps_React_default.a.createElement(Panel,{paddingSize:"none"},children)));Embeddable.displayName="Embeddable";const Header=external_kbnSharedDeps_StyledComponents_default.a.header.attrs(({className:className})=>({className:"siemEmbeddable__header "+className})).withConfig({displayName:"Header",componentId:"yclxqi-0"})(["border-bottom:",";padding:",";"],({theme:theme})=>theme.eui.euiBorderThin,({theme:theme})=>theme.eui.paddingSizes.m);Header.displayName="Header";const EmbeddableHeader=external_kbnSharedDeps_React_default.a.memo(({children:children,title:title})=>external_kbnSharedDeps_React_default.a.createElement(Header,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",gutterSize:"m"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"xxxs"},external_kbnSharedDeps_React_default.a.createElement("h6",{"data-test-subj":"header-embeddable-title"},title))),children&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{"data-test-subj":"header-embeddable-supplements",grow:!1},children))));EmbeddableHeader.displayName="EmbeddableHeader";__webpack_require__(1109);const EMBEDDABLE_HEADER_TITLE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.components.embeddables.embeddedMap.embeddableHeaderTitle",{defaultMessage:"Network map"}),EMBEDDABLE_HEADER_HELP=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.components.embeddables.embeddedMap.embeddableHeaderHelp",{defaultMessage:"Map configuration help"}),MAP_TITLE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.components.embeddables.embeddedMap.embeddablePanelTitle",{defaultMessage:"Source -> Destination Point-to-Point Map"}),SOURCE_LAYER=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.components.embeddables.embeddedMap.sourceLayerLabel",{defaultMessage:"Source Point"}),DESTINATION_LAYER=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.components.embeddables.embeddedMap.destinationLayerLabel",{defaultMessage:"Destination Point"}),CLIENT_LAYER=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.components.embeddables.embeddedMap.clientLayerLabel",{defaultMessage:"Client Point"}),SERVER_LAYER=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.components.embeddables.embeddedMap.serverLayerLabel",{defaultMessage:"Server Point"}),LINE_LAYER=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.components.embeddables.embeddedMap.lineLayerLabel",{defaultMessage:"Line"}),ERROR_CREATING_EMBEDDABLE=(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.components.embeddables.embeddedMap.errorConfiguringEmbeddableApiTitle",{defaultMessage:"Error configuring Embeddables API"}),external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.components.embeddables.embeddedMap.errorCreatingMapEmbeddableTitle",{defaultMessage:"Error creating Map Embeddable"})),ERROR_TITLE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.components.embeddables.indexPatternsMissingPrompt.errorTitle",{defaultMessage:"Required index patterns not configured"}),ERROR_BUTTON=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.components.embeddables.indexPatternsMissingPrompt.errorButtonLabel",{defaultMessage:"Configure index patterns"}),MAP_TOOL_TIP_ERROR=(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.filterForValueHoverAction",{defaultMessage:"Filter for value"}),external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.errorTitle",{defaultMessage:"Error loading map features"})),HOST=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.hostTitle",{defaultMessage:"Host"}),SOURCE_IP=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.sourceIPTitle",{defaultMessage:"Source IP"}),DESTINATION_IP=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.destinationIPTitle",{defaultMessage:"Destination IP"}),CLIENT_IP=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.clientIPTitle",{defaultMessage:"Client IP"}),SERVER_IP=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.serverIPTitle",{defaultMessage:"Server IP"}),SOURCE_DOMAIN=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.sourceDomainTitle",{defaultMessage:"Source domain"}),DESTINATION_DOMAIN=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.destinationDomainTitle",{defaultMessage:"Destination domain"}),CLIENT_DOMAIN=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.clientDomainTitle",{defaultMessage:"Client domain"}),SERVER_DOMAIN=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.serverDomainTitle",{defaultMessage:"Server domain"}),LOCATION=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.locationTitle",{defaultMessage:"Location"}),ASN=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.pointContent.asnTitle",{defaultMessage:"ASN"}),SOURCE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.lineContent.sourceLabel",{defaultMessage:"Source"}),DESTINATION=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.lineContent.destinationLabel",{defaultMessage:"Destination"}),CLIENT=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.lineContent.clientLabel",{defaultMessage:"Client"}),SERVER=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.lineContent.serverLabel",{defaultMessage:"Server"});var constants_=__webpack_require__(105);const euiVisColorPalette=Object(external_kbnSharedDeps_ElasticEui_.euiPaletteColorBlind)(),sourceFieldMappings={"host.name":HOST,"source.ip":SOURCE_IP,"source.domain":SOURCE_DOMAIN,"source.geo.country_iso_code":LOCATION,"source.as.organization.name":ASN},destinationFieldMappings={"host.name":HOST,"destination.ip":DESTINATION_IP,"destination.domain":DESTINATION_DOMAIN,"destination.geo.country_iso_code":LOCATION,"destination.as.organization.name":ASN},clientFieldMappings={"host.name":HOST,"client.ip":CLIENT_IP,"client.domain":CLIENT_DOMAIN,"client.geo.country_iso_code":LOCATION,"client.as.organization.name":ASN},serverFieldMappings={"host.name":HOST,"server.ip":SERVER_IP,"server.domain":SERVER_DOMAIN,"server.geo.country_iso_code":LOCATION,"server.as.organization.name":ASN},sourceDestinationFieldMappings={...sourceFieldMappings,...destinationFieldMappings,...clientFieldMappings,...serverFieldMappings},lmc={default:{source:{metricField:"source.bytes",geoField:"source.geo.location",tooltipProperties:Object.keys(sourceFieldMappings),label:SOURCE_LAYER},destination:{metricField:"destination.bytes",geoField:"destination.geo.location",tooltipProperties:Object.keys(destinationFieldMappings),label:DESTINATION_LAYER}},"apm-*":{source:{metricField:"client.bytes",geoField:"client.geo.location",tooltipProperties:Object.keys(clientFieldMappings),label:CLIENT_LAYER},destination:{metricField:"server.bytes",geoField:"server.geo.location",tooltipProperties:Object.keys(serverFieldMappings),label:SERVER_LAYER}}},getLayerList=indexPatternIds=>[{sourceDescriptor:{type:constants_.SOURCE_TYPES.EMS_TMS,isAutoSelect:!0},id:uuid_default.a.v4(),label:null,minZoom:0,maxZoom:24,alpha:1,visible:!0,style:null,type:"VECTOR_TILE"},...indexPatternIds.reduce((acc,{title:title,id:id})=>{var _lmc$title,_lmc$title$destinatio,_lmc$title2,_lmc$title$source,_lmc$title3;return[...acc,getLineLayer(title,id,null!==(_lmc$title=lmc[title])&&void 0!==_lmc$title?_lmc$title:lmc.default),getDestinationLayer(title,id,null!==(_lmc$title$destinatio=null===(_lmc$title2=lmc[title])||void 0===_lmc$title2?void 0:_lmc$title2.destination)&&void 0!==_lmc$title$destinatio?_lmc$title$destinatio:lmc.default.destination),getSourceLayer(title,id,null!==(_lmc$title$source=null===(_lmc$title3=lmc[title])||void 0===_lmc$title3?void 0:_lmc$title3.source)&&void 0!==_lmc$title$source?_lmc$title$source:lmc.default.source)]},[])],getSourceLayer=(indexPatternTitle,indexPatternId,layerDetails)=>({sourceDescriptor:{id:uuid_default.a.v4(),type:"ES_SEARCH",applyGlobalQuery:!0,geoField:layerDetails.geoField,filterByMapBounds:!1,tooltipProperties:layerDetails.tooltipProperties,useTopHits:!1,topHitsTimeField:"@timestamp",topHitsSize:1,indexPatternId:indexPatternId},style:{type:"VECTOR",properties:{fillColor:{type:"STATIC",options:{color:euiVisColorPalette[1]}},lineColor:{type:"STATIC",options:{color:"#FFFFFF"}},lineWidth:{type:"STATIC",options:{size:2}},iconSize:{type:"STATIC",options:{size:8}},iconOrientation:{type:"STATIC",options:{orientation:0}},symbolizeAs:{options:{value:"icon"}},icon:{type:"STATIC",options:{value:"home"}}}},id:uuid_default.a.v4(),label:`${indexPatternTitle} | ${layerDetails.label}`,minZoom:0,maxZoom:24,alpha:1,visible:!0,type:"VECTOR",query:{query:"",language:"kuery"},joins:[]}),getDestinationLayer=(indexPatternTitle,indexPatternId,layerDetails)=>({sourceDescriptor:{id:uuid_default.a.v4(),type:"ES_SEARCH",applyGlobalQuery:!0,geoField:layerDetails.geoField,filterByMapBounds:!0,tooltipProperties:layerDetails.tooltipProperties,useTopHits:!1,topHitsTimeField:"@timestamp",topHitsSize:1,indexPatternId:indexPatternId},style:{type:"VECTOR",properties:{fillColor:{type:"STATIC",options:{color:euiVisColorPalette[2]}},lineColor:{type:"STATIC",options:{color:"#FFFFFF"}},lineWidth:{type:"STATIC",options:{size:2}},iconSize:{type:"STATIC",options:{size:8}},iconOrientation:{type:"STATIC",options:{orientation:0}},symbolizeAs:{options:{value:"icon"}},icon:{type:"STATIC",options:{value:"marker"}}}},id:uuid_default.a.v4(),label:`${indexPatternTitle} | ${layerDetails.label}`,minZoom:0,maxZoom:24,alpha:1,visible:!0,type:"VECTOR",query:{query:"",language:"kuery"}}),getLineLayer=(indexPatternTitle,indexPatternId,layerDetails)=>({sourceDescriptor:{type:constants_.SOURCE_TYPES.ES_PEW_PEW,applyGlobalQuery:!0,id:uuid_default.a.v4(),indexPatternId:indexPatternId,sourceGeoField:layerDetails.source.geoField,destGeoField:layerDetails.destination.geoField,metrics:[{type:"sum",field:layerDetails.source.metricField,label:layerDetails.source.metricField},{type:"sum",field:layerDetails.destination.metricField,label:layerDetails.destination.metricField}]},style:{type:"VECTOR",properties:{fillColor:{type:"STATIC",options:{color:"#1EA593"}},lineColor:{type:"STATIC",options:{color:euiVisColorPalette[1]}},lineWidth:{type:"DYNAMIC",options:{field:{label:"count",name:"doc_count",origin:"source"},minSize:1,maxSize:8,fieldMetaOptions:{isEnabled:!0,sigma:3}}},iconSize:{type:"STATIC",options:{size:10}},iconOrientation:{type:"STATIC",options:{orientation:0}},symbolizeAs:{options:{value:"icon"}},icon:{type:"STATIC",options:{value:"airfield"}}}},id:uuid_default.a.v4(),label:`${indexPatternTitle} | ${LINE_LAYER}`,minZoom:0,maxZoom:24,alpha:.5,visible:!0,type:"VECTOR",query:{query:"",language:"kuery"}});var maps_public_=__webpack_require__(106);function embedded_map_helpers_extends(){return(embedded_map_helpers_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const IndexPatternsMissingPromptComponent=()=>{const{docLinks:docLinks}=Object(lib_kibana.h)().services,kibanaBasePath=Object(lib_kibana.c)()+"/app";return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiEmptyPrompt,{iconType:"gisApp",title:external_kbnSharedDeps_React_default.a.createElement("h2",null,ERROR_TITLE),titleSize:"xs",body:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{defaultMessage:"To display map data, you must define SIEM indices ({defaultIndex}) and Kibana index patterns with matching glob patterns. When using {beats}, you can run the {setup} command on your hosts to automatically create the index patterns. For example: {example}.",id:"xpack.securitySolution.components.embeddables.indexPatternsMissingPrompt.errorDescription1",values:{defaultIndex:external_kbnSharedDeps_React_default.a.createElement("a",{href:kibanaBasePath+"/management/kibana/settings",rel:"noopener noreferrer",target:"_blank"},"securitySolution:defaultIndex"),beats:external_kbnSharedDeps_React_default.a.createElement("a",{href:`${docLinks.ELASTIC_WEBSITE_URL}guide/en/beats/libbeat/${docLinks.DOC_LINK_VERSION}/getting-started.html`,rel:"noopener noreferrer",target:"_blank"},"beats"),setup:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCode,null,"setup"),example:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCode,null,"./packetbeat setup")}})),external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{defaultMessage:"You can also configure index patterns manually in Kibana.",id:"xpack.securitySolution.components.embeddables.indexPatternsMissingPrompt.errorDescription2"}))),actions:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{href:kibanaBasePath+"/management/kibana/indexPatterns",color:"primary",target:"_blank",fill:!0},ERROR_BUTTON)})};IndexPatternsMissingPromptComponent.displayName="IndexPatternsMissingPromptComponent";const IndexPatternsMissingPrompt=external_kbnSharedDeps_React_default.a.memo(IndexPatternsMissingPromptComponent);IndexPatternsMissingPrompt.displayName="IndexPatternsMissingPrompt";external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiIcon).withConfig({displayName:"Icon",componentId:"s0r863-0"})(["margin-right:",";"],external_kbnSharedDeps_Theme_euiLightVars_default.a.euiSizeS).displayName="Icon";const ToolTipFooterComponent=({featureIndex:featureIndex,totalFeatures:totalFeatures,previousFeature:previousFeature,nextFeature:nextFeature})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHorizontalRule,{margin:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center",gutterSize:"xs"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs"},((currentFeature,totalFeatures)=>external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.components.embeddables.mapToolTip.footerLabel",{values:{currentFeature:currentFeature,totalFeatures:totalFeatures},defaultMessage:"{currentFeature} of {totalFeatures} {totalFeatures, plural, =1 {feature} other {features}}"}))(featureIndex+1,totalFeatures))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement("span",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{"data-test-subj":"previous-feature-button",color:"text",onClick:previousFeature,iconType:"arrowLeft","aria-label":"Next",isDisabled:featureIndex<=0}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{"data-test-subj":"next-feature-button",color:"text",onClick:nextFeature,iconType:"arrowRight","aria-label":"Next",isDisabled:featureIndex>=totalFeatures-1})))));ToolTipFooterComponent.displayName="ToolTipFooterComponent";const ToolTipFooter=external_kbnSharedDeps_React_default.a.memo(ToolTipFooterComponent);ToolTipFooter.displayName="ToolTipFooter";var source_destination_arrows=__webpack_require__(396);const FlowBadge=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiBadge).withConfig({displayName:"FlowBadge",componentId:"sc-120vo88-0"})(["height:45px;min-width:85px;"]),EuiFlexGroupStyled=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup).withConfig({displayName:"EuiFlexGroupStyled",componentId:"sc-120vo88-1"})(["margin:0 auto;"]),LineToolTipContentComponent=({contextId:contextId,featureProps:featureProps})=>{const lineProps=featureProps.reduce((acc,f)=>{var _f$getRawValue;const rawValue=null!==(_f$getRawValue=f.getRawValue())&&void 0!==_f$getRawValue?_f$getRawValue:[];return{...acc,[f.getPropertyKey()]:Array.isArray(rawValue)?rawValue:[rawValue]}},{}),isSrcDest=Object.keys(lineProps).includes("sum_of_source.bytes");return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"center",gutterSize:"none"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(FlowBadge,{color:"hollow"},external_kbnSharedDeps_React_default.a.createElement(EuiFlexGroupStyled,{direction:"column"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},isSrcDest?SOURCE:CLIENT)))),external_kbnSharedDeps_React_default.a.createElement(source_destination_arrows.e,{contextId:contextId,destinationBytes:isSrcDest?lineProps["sum_of_destination.bytes"]:lineProps["sum_of_server.bytes"],eventId:"map-line-tooltip-"+contextId,sourceBytes:isSrcDest?lineProps["sum_of_source.bytes"]:lineProps["sum_of_client.bytes"]}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(FlowBadge,{color:"hollow"},external_kbnSharedDeps_React_default.a.createElement(EuiFlexGroupStyled,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},isSrcDest?DESTINATION:SERVER)))))};LineToolTipContentComponent.displayName="LineToolTipContentComponent";const LineToolTipContent=external_kbnSharedDeps_React_default.a.memo(LineToolTipContentComponent);LineToolTipContent.displayName="LineToolTipContent";var field_renderers=__webpack_require__(266);const PointToolTipContentComponent=({contextId:contextId,featureProps:featureProps})=>{const featureDescriptionListItems=Object(external_kbnSharedDeps_React_.useMemo)(()=>featureProps.map(featureProp=>{var _featureProp$getRawVa;const key=featureProp.getPropertyKey(),value=null!==(_featureProp$getRawVa=featureProp.getRawValue())&&void 0!==_featureProp$getRawVa?_featureProp$getRawVa:[];return{title:sourceDestinationFieldMappings[key],description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,null!=value?external_kbnSharedDeps_React_default.a.createElement(field_renderers.b,{rowItems:Array.isArray(value)?value:[value],attrName:key,idPrefix:`map-point-tooltip-${contextId}-${key}-${value}`,render:item=>getRenderedFieldValue(key,item)}):Object(empty_value.d)())}}),[contextId,featureProps]);return external_kbnSharedDeps_React_default.a.createElement(page.d,{listItems:featureDescriptionListItems})};PointToolTipContentComponent.displayName="PointToolTipContentComponent";const PointToolTipContent=external_kbnSharedDeps_React_default.a.memo(PointToolTipContentComponent);PointToolTipContent.displayName="PointToolTipContent";const getRenderedFieldValue=(field,value)=>{if(""===value)return Object(empty_value.f)(value);if(["host.name"].includes(field))return external_kbnSharedDeps_React_default.a.createElement(links.d,{hostName:value});if(["source.ip","destination.ip"].includes(field)){const flowTarget=field.split(".")[0];return external_kbnSharedDeps_React_default.a.createElement(links.h,{ip:value,flowTarget:flowTarget})}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,value)},MapToolTipComponent=({closeTooltip:closeTooltip,features:features=[],getLayerName:getLayerName,loadFeatureProperties:loadFeatureProperties,loadFeatureGeometry:loadFeatureGeometry})=>{const[isLoading,setIsLoading]=Object(external_kbnSharedDeps_React_.useState)(!0),[isLoadingNextFeature,setIsLoadingNextFeature]=Object(external_kbnSharedDeps_React_.useState)(!1),[isError,setIsError]=Object(external_kbnSharedDeps_React_.useState)(!1),[featureIndex,setFeatureIndex]=Object(external_kbnSharedDeps_React_.useState)(0),[featureProps,setFeatureProps]=Object(external_kbnSharedDeps_React_.useState)([]),[featureGeometry,setFeatureGeometry]=Object(external_kbnSharedDeps_React_.useState)(null),[,setLayerName]=Object(external_kbnSharedDeps_React_.useState)(""),handleCloseTooltip=Object(external_kbnSharedDeps_React_.useCallback)(()=>{null!=closeTooltip&&(closeTooltip(),setFeatureIndex(0))},[closeTooltip]),handlePreviousFeature=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setFeatureIndex(prevFeatureIndex=>prevFeatureIndex-1),setIsLoadingNextFeature(!0)},[]),handleNextFeature=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setFeatureIndex(prevFeatureIndex=>prevFeatureIndex+1),setIsLoadingNextFeature(!0)},[]),content=Object(external_kbnSharedDeps_React_.useMemo)(()=>isError?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceAround"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},MAP_TOOL_TIP_ERROR)):isLoading&&!isLoadingNextFeature?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceAround"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingSpinner,{size:"m"}))):external_kbnSharedDeps_React_default.a.createElement("div",null,null!=featureGeometry&&"LineString"===featureGeometry.type?external_kbnSharedDeps_React_default.a.createElement(LineToolTipContent,{contextId:`${features[featureIndex].layerId}-${features[featureIndex].id}-${featureIndex}`,featureProps:featureProps}):external_kbnSharedDeps_React_default.a.createElement(PointToolTipContent,{contextId:`${features[featureIndex].layerId}-${features[featureIndex].id}-${featureIndex}`,featureProps:featureProps}),features.length>1&&external_kbnSharedDeps_React_default.a.createElement(ToolTipFooter,{featureIndex:featureIndex,totalFeatures:features.length,previousFeature:handlePreviousFeature,nextFeature:handleNextFeature}),isLoadingNextFeature&&external_kbnSharedDeps_React_default.a.createElement(loader.a,{"data-test-subj":"loading-panel",overlay:!0,size:"m"})),[featureGeometry,featureIndex,featureProps,features,handleNextFeature,handlePreviousFeature,isError,isLoading,isLoadingNextFeature]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{if(0===features.length||null==getLayerName||null==loadFeatureProperties||null==loadFeatureGeometry)return;isLoadingNextFeature||setIsLoading(!0),setIsError(!1);(async()=>{if(null!=features[featureIndex]){const layerId=features[featureIndex].layerId,featureId=features[featureIndex].id;try{const featureGeo=loadFeatureGeometry({layerId:layerId,featureId:featureId}),[featureProperties,layerNameString]=await Promise.all([loadFeatureProperties({layerId:layerId,featureId:featureId}),getLayerName(layerId)]);setFeatureProps(featureProperties),setFeatureGeometry(featureGeo),setLayerName(layerNameString)}catch(e){setIsError(!0)}finally{setIsLoading(!1),setIsLoadingNextFeature(!1)}}})()},[featureIndex,features,getLayerName,isLoadingNextFeature,loadFeatureGeometry,loadFeatureProperties]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiOutsideClickDetector,{onOutsideClick:handleCloseTooltip},content)};MapToolTipComponent.displayName="MapToolTipComponent";const MapToolTip=external_kbnSharedDeps_React_default.a.memo(MapToolTipComponent);MapToolTip.displayName="MapToolTip";var store_sourcerer=__webpack_require__(144);const getDefaultSourcererSelector=()=>{const getKibanaIndexPatternsSelector=store_sourcerer.d.kibanaIndexPatternsSelector(),getScopesSelector=store_sourcerer.d.scopesSelector();return state=>({kibanaIndexPatterns:getKibanaIndexPatternsSelector(state),sourcererScope:getScopesSelector(state)[model.SourcererScopeName.default]})},EmbeddableMap=external_kbnSharedDeps_StyledComponents_default.a.div.attrs(()=>({className:"siemEmbeddable__map"})).withConfig({displayName:"EmbeddableMap",componentId:"sc-1t0ky4k-0"})([".embPanel{border:none;box-shadow:none;}.mapToolbarOverlay__button{display:none;}",""],({maintainRatio:maintainRatio})=>maintainRatio&&Object(external_kbnSharedDeps_StyledComponents_.css)(["padding-top:calc(3 / 4 * 100%);position:relative;@media only screen and (min-width:","){padding-top:calc(9 / 32 * 100%);}@media only screen and (min-width:1441px) and (min-height:901px){padding-top:calc(9 / 21 * 100%);}.embPanel{bottom:0;left:0;position:absolute;right:0;top:0;}"],({theme:theme})=>theme.eui.euiBreakpoints.m));EmbeddableMap.displayName="EmbeddableMap";const EmbeddedMapComponent=({endDate:endDate,filters:filters,query:query,setQuery:setQuery,startDate:startDate})=>{const[embeddable,setEmbeddable]=external_kbnSharedDeps_React_default.a.useState(void 0),[isError,setIsError]=Object(external_kbnSharedDeps_React_.useState)(!1),[isIndexError,setIsIndexError]=Object(external_kbnSharedDeps_React_.useState)(!1),[,dispatchToaster]=Object(toasters.h)(),defaultSourcererScopeSelector=Object(external_kbnSharedDeps_React_.useMemo)(getDefaultSourcererSelector,[]),{kibanaIndexPatterns:kibanaIndexPatterns,sourcererScope:sourcererScope}=Object(use_selector.a)(defaultSourcererScopeSelector),[mapIndexPatterns,setMapIndexPatterns]=Object(external_kbnSharedDeps_React_.useState)(kibanaIndexPatterns.filter(kip=>sourcererScope.selectedPatterns.includes(kip.title))),portalNode=external_kbnSharedDeps_React_default.a.useMemo(()=>Object(web.c)(),[]),{services:services}=Object(lib_kibana.h)();return Object(external_kbnSharedDeps_React_.useEffect)(()=>{setMapIndexPatterns(prevMapIndexPatterns=>{const newIndexPatterns=kibanaIndexPatterns.filter(kip=>sourcererScope.selectedPatterns.includes(kip.title));return fast_deep_equal_default()(newIndexPatterns,prevMapIndexPatterns)?prevMapIndexPatterns:(0===newIndexPatterns.length&&setIsError(!0),newIndexPatterns)})},[kibanaIndexPatterns,sourcererScope.selectedPatterns]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{let isSubscribed=!0;return null==embeddable&&sourcererScope.selectedPatterns.length>0&&async function(){try{const embeddableObject=await(async(filters,indexPatterns,query,startDate,endDate,setQuery,portalNode,embeddableApi)=>{const factory=embeddableApi.getEmbeddableFactory(maps_public_.MAP_SAVED_OBJECT_TYPE);if(!factory)throw new Error("Map embeddable factory undefined");const input={title:MAP_TITLE,attributes:{title:""},id:uuid_default.a.v4(),filters:filters,hidePanelTitles:!0,query:query,refreshConfig:{value:0,pause:!0},timeRange:{from:new Date(startDate).toISOString(),to:new Date(endDate).toISOString()},viewMode:embeddable_public_.ViewMode.VIEW,isLayerTOCOpen:!1,openTOCDetails:[],hideFilterActions:!1,mapCenter:{lon:-1.05469,lat:15.96133,zoom:1},disabledActions:["CUSTOM_TIME_RANGE","CUSTOM_TIME_RANGE_BADGE"]},renderTooltipContent=({addFilters:addFilters,closeTooltip:closeTooltip,features:features,isLocked:isLocked,getLayerName:getLayerName,loadFeatureProperties:loadFeatureProperties,loadFeatureGeometry:loadFeatureGeometry})=>{const props={addFilters:addFilters,closeTooltip:closeTooltip,features:features,isLocked:isLocked,getLayerName:getLayerName,loadFeatureProperties:loadFeatureProperties,loadFeatureGeometry:loadFeatureGeometry};return external_kbnSharedDeps_React_default.a.createElement(web.b,embedded_map_helpers_extends({node:portalNode},props))},embeddableObject=await factory.create(input);if(!embeddableObject)throw new Error("Map embeddable is undefined");return Object(embeddable_public_.isErrorEmbeddable)(embeddableObject)||(embeddableObject.setRenderTooltipContent(renderTooltipContent),embeddableObject.setLayerList(getLayerList(indexPatterns))),setQuery({id:"embeddedMap",inspect:null,loading:!1,refetch:()=>embeddableObject.reload()}),embeddableObject})(filters,mapIndexPatterns,query,startDate,endDate,setQuery,portalNode,services.embeddable);isSubscribed&&(0===mapIndexPatterns.length?setIsIndexError(!0):(setEmbeddable(embeddableObject),setIsIndexError(!1)))}catch(e){isSubscribed&&(Object(toasters.d)(ERROR_CREATING_EMBEDDABLE,[e.message],dispatchToaster),setIsError(!0))}}(),()=>{isSubscribed=!1}},[dispatchToaster,endDate,embeddable,filters,mapIndexPatterns,query,portalNode,services.embeddable,sourcererScope.selectedPatterns,setQuery,startDate]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{null==embeddable||Object(embeddable_public_.isErrorEmbeddable)(embeddable)||(async()=>{null!=embeddable&&(await embeddable.setLayerList(getLayerList(mapIndexPatterns)),embeddable.reload())})()},[embeddable,mapIndexPatterns]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{null!=embeddable&&embeddable.updateInput({query:query})},[embeddable,query]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{null!=embeddable&&embeddable.updateInput({filters:filters})},[embeddable,filters]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{if(null!=embeddable&&null!=startDate&&null!=endDate){const timeRange={from:new Date(startDate).toISOString(),to:new Date(endDate).toISOString()};embeddable.updateInput({timeRange:timeRange})}},[embeddable,startDate,endDate]),isError?null:external_kbnSharedDeps_React_default.a.createElement(Embeddable,null,external_kbnSharedDeps_React_default.a.createElement(EmbeddableHeader,{title:EMBEDDABLE_HEADER_TITLE},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{href:`${services.docLinks.ELASTIC_WEBSITE_URL}guide/en/security/${services.docLinks.DOC_LINK_VERSION}/conf-map-ui.html`,target:"_blank"},EMBEDDABLE_HEADER_HELP))),external_kbnSharedDeps_React_default.a.createElement(web.a,{node:portalNode},external_kbnSharedDeps_React_default.a.createElement(MapToolTip,null)),external_kbnSharedDeps_React_default.a.createElement(EmbeddableMap,{maintainRatio:!isIndexError},isIndexError?external_kbnSharedDeps_React_default.a.createElement(IndexPatternsMissingPrompt,{"data-test-subj":"missing-prompt"}):null!=embeddable?external_kbnSharedDeps_React_default.a.createElement(services.embeddable.EmbeddablePanel,{embeddable:embeddable}):external_kbnSharedDeps_React_default.a.createElement(loader.a,{"data-test-subj":"loading-panel",overlay:!0,size:"xl"})))};EmbeddedMapComponent.displayName="EmbeddedMapComponent";const EmbeddedMap=external_kbnSharedDeps_React_default.a.memo(EmbeddedMapComponent);EmbeddedMap.displayName="EmbeddedMap";const ERROR_NETWORK_KPI_DNS=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.networkKpiDns.errorSearchDescription",{defaultMessage:"An error has occurred on network kpi dns search"}),FAIL_NETWORK_KPI_DNS=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.networkKpiDns.failSearchDescription",{defaultMessage:"Failed to run search on network kpi dns"}),common_FlexGroup=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup).withConfig({displayName:"FlexGroup",componentId:"sc-1sakt4o-0"})(["min-height:","px;"],228);common_FlexGroup.displayName="FlexGroup";const NetworkKpiBaseComponent=external_kbnSharedDeps_React_default.a.memo(({fieldsMapping:fieldsMapping,data:data,id:id,loading:loading=!1,from:from,to:to,narrowDateRange:narrowDateRange})=>{const statItemsProps=useKpiMatrixStatus(fieldsMapping,data,id,from,to,narrowDateRange);return loading?external_kbnSharedDeps_React_default.a.createElement(common_FlexGroup,{justifyContent:"center",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingSpinner,{size:"xl"}))):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{wrap:!0},statItemsProps.map(mappedStatItemProps=>external_kbnSharedDeps_React_default.a.createElement(StatItemsComponent,mappedStatItemProps)))},(prevProps,nextProps)=>prevProps.fieldsMapping===nextProps.fieldsMapping&&prevProps.loading===nextProps.loading&&prevProps.id===nextProps.id&&prevProps.from===nextProps.from&&prevProps.to===nextProps.to&&prevProps.narrowDateRange===nextProps.narrowDateRange&&fast_deep_equal_default()(prevProps.data,nextProps.data));NetworkKpiBaseComponent.displayName="NetworkKpiBaseComponent";const NetworkKpiBaseComponentManage=Object(manage_query.a)(NetworkKpiBaseComponent),dns_fieldsMapping=[{key:"dnsQueries",fields:[{key:"dnsQueries",value:null}],description:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.kpiNetwork.dnsQueries.title",{defaultMessage:"DNS queries"})}],NetworkKpiDnsComponent=({filterQuery:filterQuery,from:from,indexNames:indexNames,to:to,narrowDateRange:narrowDateRange,setQuery:setQuery,skip:skip})=>{const[loading,{refetch:refetch,id:id,inspect:inspect,...data}]=(({filterQuery:filterQuery,endDate:endDate,indexNames:indexNames,skip:skip=!1,startDate:startDate})=>{const{data:data}=Object(lib_kibana.h)().services,refetch=Object(external_kbnSharedDeps_React_.useRef)(external_kbnSharedDeps_LodashFp_.noop),abortCtrl=Object(external_kbnSharedDeps_React_.useRef)(new AbortController),searchSubscription$=Object(external_kbnSharedDeps_React_.useRef)(new external_kbnSharedDeps_Rxjs_.Subscription),[loading,setLoading]=Object(external_kbnSharedDeps_React_.useState)(!1),[networkKpiDnsRequest,setNetworkKpiDnsRequest]=Object(external_kbnSharedDeps_React_.useState)(null),[networkKpiDnsResponse,setNetworkKpiDnsResponse]=Object(external_kbnSharedDeps_React_.useState)({dnsQueries:0,id:"networkKpiDnsQuery",inspect:{dsl:[],response:[]},isInspected:!1,refetch:refetch.current}),{addError:addError,addWarning:addWarning}=Object(use_app_toasts.a)(),networkKpiDnsSearch=Object(external_kbnSharedDeps_React_.useCallback)(request=>{if(null==request||skip)return;const asyncSearch=async()=>{abortCtrl.current=new AbortController,setLoading(!0),searchSubscription$.current=data.search.search(request,{strategy:"securitySolutionSearchStrategy",abortSignal:abortCtrl.current.signal}).subscribe({next:response=>{Object(common_.isCompleteResponse)(response)?(setLoading(!1),setNetworkKpiDnsResponse(prevResponse=>({...prevResponse,dnsQueries:response.dnsQueries,inspect:Object(public_helpers.a)(response,prevResponse.inspect),refetch:refetch.current})),searchSubscription$.current.unsubscribe()):Object(common_.isErrorResponse)(response)&&(setLoading(!1),addWarning(ERROR_NETWORK_KPI_DNS),searchSubscription$.current.unsubscribe())},error:msg=>{setLoading(!1),addError(msg,{title:FAIL_NETWORK_KPI_DNS}),searchSubscription$.current.unsubscribe()}})};searchSubscription$.current.unsubscribe(),abortCtrl.current.abort(),asyncSearch(),refetch.current=asyncSearch},[data.search,addError,addWarning,skip]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{setNetworkKpiDnsRequest(prevRequest=>{const myRequest={...null!=prevRequest?prevRequest:{},defaultIndex:indexNames,factoryQueryType:search_strategy.NetworkKpiQueries.dns,filterQuery:Object(containers_helpers.a)(filterQuery),timerange:{interval:"12h",from:startDate,to:endDate}};return fast_deep_equal_default()(prevRequest,myRequest)?prevRequest:myRequest})},[indexNames,endDate,filterQuery,startDate]),Object(external_kbnSharedDeps_React_.useEffect)(()=>(networkKpiDnsSearch(networkKpiDnsRequest),()=>{searchSubscription$.current.unsubscribe(),abortCtrl.current.abort()}),[networkKpiDnsRequest,networkKpiDnsSearch]),[loading,networkKpiDnsResponse]})({filterQuery:filterQuery,endDate:to,indexNames:indexNames,startDate:from,skip:skip});return external_kbnSharedDeps_React_default.a.createElement(NetworkKpiBaseComponentManage,{data:data,id:id,inspect:inspect,loading:loading,fieldsMapping:dns_fieldsMapping,from:from,to:to,narrowDateRange:narrowDateRange,refetch:refetch,setQuery:setQuery})},NetworkKpiDns=external_kbnSharedDeps_React_default.a.memo(NetworkKpiDnsComponent),ERROR_NETWORK_KPI_NETWORK_EVENTS=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.networkKpiNetworkEvents.errorSearchDescription",{defaultMessage:"An error has occurred on network kpi network events search"}),FAIL_NETWORK_KPI_NETWORK_EVENTS=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.networkKpiNetworkEvents.failSearchDescription",{defaultMessage:"Failed to run search on network kpi network events"}),NETWORK_EVENTS=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.kpiNetwork.networkEvents.title",{defaultMessage:"Network events"}),network_events_fieldsMapping=[{key:"networkEvents",fields:[{key:"networkEvents",value:null,color:Object(external_kbnSharedDeps_ElasticEui_.euiPaletteColorBlind)()[1]}],description:NETWORK_EVENTS}],NetworkKpiNetworkEventsComponent=({filterQuery:filterQuery,from:from,indexNames:indexNames,to:to,narrowDateRange:narrowDateRange,setQuery:setQuery,skip:skip})=>{const[loading,{refetch:refetch,id:id,inspect:inspect,...data}]=(({filterQuery:filterQuery,endDate:endDate,indexNames:indexNames,skip:skip=!1,startDate:startDate})=>{const{data:data}=Object(lib_kibana.h)().services,refetch=Object(external_kbnSharedDeps_React_.useRef)(external_kbnSharedDeps_LodashFp_.noop),abortCtrl=Object(external_kbnSharedDeps_React_.useRef)(new AbortController),searchSubscription$=Object(external_kbnSharedDeps_React_.useRef)(new external_kbnSharedDeps_Rxjs_.Subscription),[loading,setLoading]=Object(external_kbnSharedDeps_React_.useState)(!1),[networkKpiNetworkEventsRequest,setNetworkKpiNetworkEventsRequest]=Object(external_kbnSharedDeps_React_.useState)(null),[networkKpiNetworkEventsResponse,setNetworkKpiNetworkEventsResponse]=Object(external_kbnSharedDeps_React_.useState)({networkEvents:0,id:"networkKpiNetworkEventsQuery",inspect:{dsl:[],response:[]},isInspected:!1,refetch:refetch.current}),{addError:addError,addWarning:addWarning}=Object(use_app_toasts.a)(),networkKpiNetworkEventsSearch=Object(external_kbnSharedDeps_React_.useCallback)(request=>{if(null==request||skip)return;const asyncSearch=async()=>{abortCtrl.current=new AbortController,setLoading(!0),searchSubscription$.current=data.search.search(request,{strategy:"securitySolutionSearchStrategy",abortSignal:abortCtrl.current.signal}).subscribe({next:response=>{Object(common_.isCompleteResponse)(response)?(setLoading(!1),setNetworkKpiNetworkEventsResponse(prevResponse=>({...prevResponse,networkEvents:response.networkEvents,inspect:Object(public_helpers.a)(response,prevResponse.inspect),refetch:refetch.current})),searchSubscription$.current.unsubscribe()):Object(common_.isErrorResponse)(response)&&(setLoading(!1),addWarning(ERROR_NETWORK_KPI_NETWORK_EVENTS),searchSubscription$.current.unsubscribe())},error:msg=>{setLoading(!1),addError(msg,{title:FAIL_NETWORK_KPI_NETWORK_EVENTS}),searchSubscription$.current.unsubscribe()}})};searchSubscription$.current.unsubscribe(),abortCtrl.current.abort(),asyncSearch(),refetch.current=asyncSearch},[data.search,addError,addWarning,skip]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{setNetworkKpiNetworkEventsRequest(prevRequest=>{const myRequest={...null!=prevRequest?prevRequest:{},defaultIndex:indexNames,factoryQueryType:search_strategy.NetworkKpiQueries.networkEvents,filterQuery:Object(containers_helpers.a)(filterQuery),timerange:{interval:"12h",from:startDate,to:endDate}};return fast_deep_equal_default()(prevRequest,myRequest)?prevRequest:myRequest})},[indexNames,endDate,filterQuery,startDate]),Object(external_kbnSharedDeps_React_.useEffect)(()=>(networkKpiNetworkEventsSearch(networkKpiNetworkEventsRequest),()=>{searchSubscription$.current.unsubscribe(),abortCtrl.current.abort()}),[networkKpiNetworkEventsRequest,networkKpiNetworkEventsSearch]),[loading,networkKpiNetworkEventsResponse]})({filterQuery:filterQuery,endDate:to,indexNames:indexNames,startDate:from,skip:skip});return external_kbnSharedDeps_React_default.a.createElement(NetworkKpiBaseComponentManage,{data:data,id:id,inspect:inspect,loading:loading,fieldsMapping:network_events_fieldsMapping,from:from,to:to,narrowDateRange:narrowDateRange,refetch:refetch,setQuery:setQuery})},NetworkKpiNetworkEvents=external_kbnSharedDeps_React_default.a.memo(NetworkKpiNetworkEventsComponent),ERROR_NETWORK_KPI_TLS_HANDSHAKES=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.networkKpiTlsHandshakes.errorSearchDescription",{defaultMessage:"An error has occurred on network kpi tls handshakes search"}),FAIL_NETWORK_KPI_TLS_HANDSHAKES=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.networkKpiTlsHandshakes.failSearchDescription",{defaultMessage:"Failed to run search on network kpi tls handshakes"}),tls_handshakes_fieldsMapping=[{key:"tlsHandshakes",fields:[{key:"tlsHandshakes",value:null}],description:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.kpiNetwork.tlsHandshakes.title",{defaultMessage:"TLS handshakes"})}],NetworkKpiTlsHandshakesComponent=({filterQuery:filterQuery,from:from,indexNames:indexNames,to:to,narrowDateRange:narrowDateRange,setQuery:setQuery,skip:skip})=>{const[loading,{refetch:refetch,id:id,inspect:inspect,...data}]=(({filterQuery:filterQuery,endDate:endDate,indexNames:indexNames,skip:skip=!1,startDate:startDate})=>{const{data:data}=Object(lib_kibana.h)().services,refetch=Object(external_kbnSharedDeps_React_.useRef)(external_kbnSharedDeps_LodashFp_.noop),abortCtrl=Object(external_kbnSharedDeps_React_.useRef)(new AbortController),searchSubscription$=Object(external_kbnSharedDeps_React_.useRef)(new external_kbnSharedDeps_Rxjs_.Subscription),[loading,setLoading]=Object(external_kbnSharedDeps_React_.useState)(!1),[networkKpiTlsHandshakesRequest,setNetworkKpiTlsHandshakesRequest]=Object(external_kbnSharedDeps_React_.useState)(null),[networkKpiTlsHandshakesResponse,setNetworkKpiTlsHandshakesResponse]=Object(external_kbnSharedDeps_React_.useState)({tlsHandshakes:0,id:"networkKpiTlsHandshakesQuery",inspect:{dsl:[],response:[]},isInspected:!1,refetch:refetch.current}),{addError:addError,addWarning:addWarning}=Object(use_app_toasts.a)(),networkKpiTlsHandshakesSearch=Object(external_kbnSharedDeps_React_.useCallback)(request=>{if(null==request||skip)return;const asyncSearch=async()=>{abortCtrl.current=new AbortController,setLoading(!0),searchSubscription$.current=data.search.search(request,{strategy:"securitySolutionSearchStrategy",abortSignal:abortCtrl.current.signal}).subscribe({next:response=>{Object(common_.isCompleteResponse)(response)?(setLoading(!1),setNetworkKpiTlsHandshakesResponse(prevResponse=>({...prevResponse,tlsHandshakes:response.tlsHandshakes,inspect:Object(public_helpers.a)(response,prevResponse.inspect),refetch:refetch.current})),searchSubscription$.current.unsubscribe()):Object(common_.isErrorResponse)(response)&&(setLoading(!1),addWarning(ERROR_NETWORK_KPI_TLS_HANDSHAKES),searchSubscription$.current.unsubscribe())},error:msg=>{setLoading(!1),addError(msg,{title:FAIL_NETWORK_KPI_TLS_HANDSHAKES}),searchSubscription$.current.unsubscribe()}})};searchSubscription$.current.unsubscribe(),abortCtrl.current.abort(),asyncSearch(),refetch.current=asyncSearch},[data.search,addError,addWarning,skip]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{setNetworkKpiTlsHandshakesRequest(prevRequest=>{const myRequest={...null!=prevRequest?prevRequest:{},defaultIndex:indexNames,factoryQueryType:search_strategy.NetworkKpiQueries.tlsHandshakes,filterQuery:Object(containers_helpers.a)(filterQuery),timerange:{interval:"12h",from:startDate,to:endDate}};return fast_deep_equal_default()(prevRequest,myRequest)?prevRequest:myRequest})},[indexNames,endDate,filterQuery,startDate]),Object(external_kbnSharedDeps_React_.useEffect)(()=>(networkKpiTlsHandshakesSearch(networkKpiTlsHandshakesRequest),()=>{searchSubscription$.current.unsubscribe(),abortCtrl.current.abort()}),[networkKpiTlsHandshakesRequest,networkKpiTlsHandshakesSearch]),[loading,networkKpiTlsHandshakesResponse]})({filterQuery:filterQuery,endDate:to,indexNames:indexNames,startDate:from,skip:skip});return external_kbnSharedDeps_React_default.a.createElement(NetworkKpiBaseComponentManage,{data:data,id:id,inspect:inspect,loading:loading,fieldsMapping:tls_handshakes_fieldsMapping,from:from,to:to,narrowDateRange:narrowDateRange,refetch:refetch,setQuery:setQuery})},NetworkKpiTlsHandshakes=external_kbnSharedDeps_React_default.a.memo(NetworkKpiTlsHandshakesComponent),ERROR_NETWORK_KPI_UNIQUE_FLOWS=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.networkKpiUniqueFlows.errorSearchDescription",{defaultMessage:"An error has occurred on network kpi unique flows search"}),FAIL_NETWORK_KPI_UNIQUE_FLOWS=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.networkKpiUniqueFlows.failSearchDescription",{defaultMessage:"Failed to run search on network kpi unique flows"}),unique_flows_fieldsMapping=[{key:"uniqueFlowId",fields:[{key:"uniqueFlowId",value:null}],description:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.kpiNetwork.uniqueFlowIds.title",{defaultMessage:"Unique flow IDs"})}],NetworkKpiUniqueFlowsComponent=({filterQuery:filterQuery,from:from,indexNames:indexNames,to:to,narrowDateRange:narrowDateRange,setQuery:setQuery,skip:skip})=>{const[loading,{refetch:refetch,id:id,inspect:inspect,...data}]=(({filterQuery:filterQuery,endDate:endDate,indexNames:indexNames,skip:skip=!1,startDate:startDate})=>{const{data:data}=Object(lib_kibana.h)().services,refetch=Object(external_kbnSharedDeps_React_.useRef)(external_kbnSharedDeps_LodashFp_.noop),abortCtrl=Object(external_kbnSharedDeps_React_.useRef)(new AbortController),searchSubscription$=Object(external_kbnSharedDeps_React_.useRef)(new external_kbnSharedDeps_Rxjs_.Subscription),[loading,setLoading]=Object(external_kbnSharedDeps_React_.useState)(!1),[networkKpiUniqueFlowsRequest,setNetworkKpiUniqueFlowsRequest]=Object(external_kbnSharedDeps_React_.useState)(null),[networkKpiUniqueFlowsResponse,setNetworkKpiUniqueFlowsResponse]=Object(external_kbnSharedDeps_React_.useState)({uniqueFlowId:0,id:"networkKpiUniqueFlowsQuery",inspect:{dsl:[],response:[]},isInspected:!1,refetch:refetch.current}),{addError:addError,addWarning:addWarning}=Object(use_app_toasts.a)(),networkKpiUniqueFlowsSearch=Object(external_kbnSharedDeps_React_.useCallback)(request=>{if(null==request||skip)return;const asyncSearch=async()=>{abortCtrl.current=new AbortController,setLoading(!0),searchSubscription$.current=data.search.search(request,{strategy:"securitySolutionSearchStrategy",abortSignal:abortCtrl.current.signal}).subscribe({next:response=>{Object(common_.isCompleteResponse)(response)?(setLoading(!1),setNetworkKpiUniqueFlowsResponse(prevResponse=>({...prevResponse,uniqueFlowId:response.uniqueFlowId,inspect:Object(public_helpers.a)(response,prevResponse.inspect),refetch:refetch.current})),searchSubscription$.current.unsubscribe()):Object(common_.isErrorResponse)(response)&&(setLoading(!1),addWarning(ERROR_NETWORK_KPI_UNIQUE_FLOWS),searchSubscription$.current.unsubscribe())},error:msg=>{setLoading(!1),addError(msg,{title:FAIL_NETWORK_KPI_UNIQUE_FLOWS}),searchSubscription$.current.unsubscribe()}})};searchSubscription$.current.unsubscribe(),abortCtrl.current.abort(),asyncSearch(),refetch.current=asyncSearch},[data.search,addError,addWarning,skip]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{setNetworkKpiUniqueFlowsRequest(prevRequest=>{const myRequest={...null!=prevRequest?prevRequest:{},defaultIndex:indexNames,factoryQueryType:search_strategy.NetworkKpiQueries.uniqueFlows,filterQuery:Object(containers_helpers.a)(filterQuery),timerange:{interval:"12h",from:startDate,to:endDate}};return fast_deep_equal_default()(prevRequest,myRequest)?prevRequest:myRequest})},[indexNames,endDate,filterQuery,startDate]),Object(external_kbnSharedDeps_React_.useEffect)(()=>(networkKpiUniqueFlowsSearch(networkKpiUniqueFlowsRequest),()=>{searchSubscription$.current.unsubscribe(),abortCtrl.current.abort()}),[networkKpiUniqueFlowsRequest,networkKpiUniqueFlowsSearch]),[loading,networkKpiUniqueFlowsResponse]})({filterQuery:filterQuery,endDate:to,indexNames:indexNames,startDate:from,skip:skip});return external_kbnSharedDeps_React_default.a.createElement(NetworkKpiBaseComponentManage,{data:data,id:id,inspect:inspect,loading:loading,fieldsMapping:unique_flows_fieldsMapping,from:from,to:to,narrowDateRange:narrowDateRange,refetch:refetch,setQuery:setQuery})},NetworkKpiUniqueFlows=external_kbnSharedDeps_React_default.a.memo(NetworkKpiUniqueFlowsComponent),ERROR_NETWORK_KPI_UNIQUE_PRIVATE_IPS=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.networkKpiUniquePrivateIps.errorSearchDescription",{defaultMessage:"An error has occurred on network kpi unique private ips search"}),FAIL_NETWORK_KPI_UNIQUE_PRIVATE_IPS=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.networkKpiUniquePrivateIps.failSearchDescription",{defaultMessage:"Failed to run search on network kpi unique private ips"}),UNIQUE_PRIVATE_IPS=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.kpiNetwork.uniquePrivateIps.title",{defaultMessage:"Unique private IPs"}),translations_SOURCE_UNIT_LABEL=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.kpiNetwork.uniquePrivateIps.sourceUnitLabel",{defaultMessage:"source"}),translations_DESTINATION_UNIT_LABEL=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.kpiNetwork.uniquePrivateIps.destinationUnitLabel",{defaultMessage:"destination"}),translations_SOURCE_CHART_LABEL=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.kpiNetwork.uniquePrivateIps.sourceChartLabel",{defaultMessage:"Src."}),translations_DESTINATION_CHART_LABEL=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.kpiNetwork.uniquePrivateIps.destinationChartLabel",{defaultMessage:"Dest."}),unique_private_ips_euiVisColorPalette=Object(external_kbnSharedDeps_ElasticEui_.euiPaletteColorBlind)(),unique_private_ips_fieldsMapping=[{key:"UniqueIps",fields:[{key:"uniqueSourcePrivateIps",value:null,name:translations_SOURCE_CHART_LABEL,description:translations_SOURCE_UNIT_LABEL,color:unique_private_ips_euiVisColorPalette[2],icon:"visMapCoordinate"},{key:"uniqueDestinationPrivateIps",value:null,name:translations_DESTINATION_CHART_LABEL,description:translations_DESTINATION_UNIT_LABEL,color:unique_private_ips_euiVisColorPalette[3],icon:"visMapCoordinate"}],description:UNIQUE_PRIVATE_IPS,enableAreaChart:!0,enableBarChart:!0}],NetworkKpiUniquePrivateIpsComponent=({filterQuery:filterQuery,from:from,indexNames:indexNames,to:to,narrowDateRange:narrowDateRange,setQuery:setQuery,skip:skip})=>{const[loading,{refetch:refetch,id:id,inspect:inspect,...data}]=(({filterQuery:filterQuery,endDate:endDate,indexNames:indexNames,skip:skip=!1,startDate:startDate})=>{const{data:data}=Object(lib_kibana.h)().services,refetch=Object(external_kbnSharedDeps_React_.useRef)(external_kbnSharedDeps_LodashFp_.noop),abortCtrl=Object(external_kbnSharedDeps_React_.useRef)(new AbortController),searchSubscription$=Object(external_kbnSharedDeps_React_.useRef)(new external_kbnSharedDeps_Rxjs_.Subscription),[loading,setLoading]=Object(external_kbnSharedDeps_React_.useState)(!1),[networkKpiUniquePrivateIpsRequest,setNetworkKpiUniquePrivateIpsRequest]=Object(external_kbnSharedDeps_React_.useState)(null),[networkKpiUniquePrivateIpsResponse,setNetworkKpiUniquePrivateIpsResponse]=Object(external_kbnSharedDeps_React_.useState)({uniqueDestinationPrivateIps:0,uniqueDestinationPrivateIpsHistogram:null,uniqueSourcePrivateIps:0,uniqueSourcePrivateIpsHistogram:null,id:"networkKpiUniquePrivateIpsQuery",inspect:{dsl:[],response:[]},isInspected:!1,refetch:refetch.current}),{addError:addError,addWarning:addWarning}=Object(use_app_toasts.a)(),networkKpiUniquePrivateIpsSearch=Object(external_kbnSharedDeps_React_.useCallback)(request=>{if(null==request||skip)return;const asyncSearch=async()=>{abortCtrl.current=new AbortController,setLoading(!0),searchSubscription$.current=data.search.search(request,{strategy:"securitySolutionSearchStrategy",abortSignal:abortCtrl.current.signal}).subscribe({next:response=>{Object(common_.isCompleteResponse)(response)?(setLoading(!1),setNetworkKpiUniquePrivateIpsResponse(prevResponse=>({...prevResponse,uniqueDestinationPrivateIps:response.uniqueDestinationPrivateIps,uniqueDestinationPrivateIpsHistogram:response.uniqueDestinationPrivateIpsHistogram,uniqueSourcePrivateIps:response.uniqueSourcePrivateIps,uniqueSourcePrivateIpsHistogram:response.uniqueSourcePrivateIpsHistogram,inspect:Object(public_helpers.a)(response,prevResponse.inspect),refetch:refetch.current})),searchSubscription$.current.unsubscribe()):Object(common_.isErrorResponse)(response)&&(setLoading(!1),addWarning(ERROR_NETWORK_KPI_UNIQUE_PRIVATE_IPS),searchSubscription$.current.unsubscribe())},error:msg=>{setLoading(!1),addError(msg,{title:FAIL_NETWORK_KPI_UNIQUE_PRIVATE_IPS}),searchSubscription$.current.unsubscribe()}})};searchSubscription$.current.unsubscribe(),abortCtrl.current.abort(),asyncSearch(),refetch.current=asyncSearch},[data.search,addError,addWarning,skip]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{setNetworkKpiUniquePrivateIpsRequest(prevRequest=>{const myRequest={...null!=prevRequest?prevRequest:{},defaultIndex:indexNames,factoryQueryType:search_strategy.NetworkKpiQueries.uniquePrivateIps,filterQuery:Object(containers_helpers.a)(filterQuery),timerange:{interval:"12h",from:startDate,to:endDate}};return fast_deep_equal_default()(prevRequest,myRequest)?prevRequest:myRequest})},[indexNames,endDate,filterQuery,startDate]),Object(external_kbnSharedDeps_React_.useEffect)(()=>(networkKpiUniquePrivateIpsSearch(networkKpiUniquePrivateIpsRequest),()=>{searchSubscription$.current.unsubscribe(),abortCtrl.current.abort()}),[networkKpiUniquePrivateIpsRequest,networkKpiUniquePrivateIpsSearch]),[loading,networkKpiUniquePrivateIpsResponse]})({filterQuery:filterQuery,endDate:to,indexNames:indexNames,startDate:from,skip:skip});return external_kbnSharedDeps_React_default.a.createElement(NetworkKpiBaseComponentManage,{data:data,id:id,inspect:inspect,loading:loading,fieldsMapping:unique_private_ips_fieldsMapping,from:from,to:to,narrowDateRange:narrowDateRange,refetch:refetch,setQuery:setQuery})},NetworkKpiUniquePrivateIps=external_kbnSharedDeps_React_default.a.memo(NetworkKpiUniquePrivateIpsComponent),NetworkKpiComponent=external_kbnSharedDeps_React_default.a.memo(({filterQuery:filterQuery,from:from,indexNames:indexNames,to:to,setQuery:setQuery,skip:skip,narrowDateRange:narrowDateRange})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{wrap:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{wrap:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(NetworkKpiNetworkEvents,{filterQuery:filterQuery,from:from,indexNames:indexNames,to:to,narrowDateRange:narrowDateRange,setQuery:setQuery,skip:skip})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(NetworkKpiDns,{filterQuery:filterQuery,from:from,indexNames:indexNames,to:to,narrowDateRange:narrowDateRange,setQuery:setQuery,skip:skip}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{wrap:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(NetworkKpiUniqueFlows,{filterQuery:filterQuery,from:from,indexNames:indexNames,to:to,narrowDateRange:narrowDateRange,setQuery:setQuery,skip:skip})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(NetworkKpiTlsHandshakes,{filterQuery:filterQuery,from:from,indexNames:indexNames,to:to,narrowDateRange:narrowDateRange,setQuery:setQuery,skip:skip})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:1},external_kbnSharedDeps_React_default.a.createElement(NetworkKpiUniquePrivateIps,{filterQuery:filterQuery,from:from,indexNames:indexNames,to:to,narrowDateRange:narrowDateRange,setQuery:setQuery,skip:skip}))));NetworkKpiComponent.displayName="NetworkKpiComponent";var network_store=__webpack_require__(136),network=__webpack_require__(183),network_top_n_flow_table=__webpack_require__(737),network_top_n_flow=__webpack_require__(752);const NetworkTopNFlowTableManage=Object(manage_query.a)(network_top_n_flow_table.a),IPsQueryTabBody=({endDate:endDate,filterQuery:filterQuery,indexNames:indexNames,skip:skip,startDate:startDate,setQuery:setQuery,flowTarget:flowTarget})=>{const[loading,{id:id,inspect:inspect,isInspected:isInspected,loadPage:loadPage,networkTopNFlow:networkTopNFlow,pageInfo:pageInfo,refetch:refetch,totalCount:totalCount}]=Object(network_top_n_flow.a)({endDate:endDate,flowTarget:flowTarget,filterQuery:filterQuery,indexNames:indexNames,skip:skip,startDate:startDate,type:network_store.c.NetworkType.page});return external_kbnSharedDeps_React_default.a.createElement(NetworkTopNFlowTableManage,{data:networkTopNFlow,fakeTotalCount:Object(external_kbnSharedDeps_LodashFp_.getOr)(50,"fakeTotalCount",pageInfo),flowTargeted:flowTarget,id:id,inspect:inspect,isInspect:isInspected,loading:loading,loadPage:loadPage,refetch:refetch,setQuery:setQuery,showMorePagesIndicator:Object(external_kbnSharedDeps_LodashFp_.getOr)(!1,"showMorePagesIndicator",pageInfo),totalCount:totalCount,type:network_store.c.NetworkType.page})};IPsQueryTabBody.displayName="IPsQueryTabBody";var network_top_countries_table=__webpack_require__(736),network_top_countries=__webpack_require__(751);const NetworkTopCountriesTableManage=Object(manage_query.a)(network_top_countries_table.a),CountriesQueryTabBody=({endDate:endDate,filterQuery:filterQuery,indexNames:indexNames,skip:skip,startDate:startDate,setQuery:setQuery,indexPattern:indexPattern,flowTarget:flowTarget})=>{const[loading,{id:id,inspect:inspect,isInspected:isInspected,loadPage:loadPage,networkTopCountries:networkTopCountries,pageInfo:pageInfo,refetch:refetch,totalCount:totalCount}]=Object(network_top_countries.a)({endDate:endDate,flowTarget:flowTarget,filterQuery:filterQuery,indexNames:indexNames,skip:skip,startDate:startDate,type:network_store.c.NetworkType.page});return external_kbnSharedDeps_React_default.a.createElement(NetworkTopCountriesTableManage,{data:networkTopCountries,fakeTotalCount:Object(external_kbnSharedDeps_LodashFp_.getOr)(50,"fakeTotalCount",pageInfo),flowTargeted:flowTarget,id:id,indexPattern:indexPattern,inspect:inspect,isInspect:isInspected,loading:loading,loadPage:loadPage,refetch:refetch,setQuery:setQuery,showMorePagesIndicator:Object(external_kbnSharedDeps_LodashFp_.getOr)(!1,"showMorePagesIndicator",pageInfo),totalCount:totalCount,type:network_store.c.NetworkType.page})};CountriesQueryTabBody.displayName="CountriesQueryTabBody";var network_http_table=__webpack_require__(735),network_http=__webpack_require__(750);const NetworkHttpTableManage=Object(manage_query.a)(network_http_table.a),HttpQueryTabBody=({endDate:endDate,filterQuery:filterQuery,indexNames:indexNames,skip:skip,startDate:startDate,setQuery:setQuery})=>{const[loading,{id:id,inspect:inspect,isInspected:isInspected,loadPage:loadPage,networkHttp:networkHttp,pageInfo:pageInfo,refetch:refetch,totalCount:totalCount}]=Object(network_http.a)({endDate:endDate,filterQuery:filterQuery,indexNames:indexNames,skip:skip,startDate:startDate,type:network_store.c.NetworkType.page});return external_kbnSharedDeps_React_default.a.createElement(NetworkHttpTableManage,{data:networkHttp,fakeTotalCount:Object(external_kbnSharedDeps_LodashFp_.getOr)(50,"fakeTotalCount",pageInfo),id:id,inspect:inspect,isInspect:isInspected,loading:loading,loadPage:loadPage,refetch:refetch,setQuery:setQuery,showMorePagesIndicator:Object(external_kbnSharedDeps_LodashFp_.getOr)(!1,"showMorePagesIndicator",pageInfo),totalCount:totalCount,type:network_store.c.NetworkType.page})};HttpQueryTabBody.displayName="HttpQueryTabBody";var anomalies_network_table=__webpack_require__(721),paginated_table=__webpack_require__(220),draggable_wrapper=__webpack_require__(153),data_provider=__webpack_require__(133),formatted_bytes=__webpack_require__(272),data_providers_provider=__webpack_require__(168);const TOP_DNS_DOMAINS=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.networkDnsTable.title",{defaultMessage:"Top DNS domains"}),UNIT=totalCount=>external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.networkDnsTable.unit",{values:{totalCount:totalCount},defaultMessage:"{totalCount, plural, =1 {domain} other {domains}}"}),TOOLTIP=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.networkDnsTable.helperTooltip",{defaultMessage:"This shows DNS protocol traffic only and can be useful for hunting domains used in DNS data exfiltration."}),REGISTERED_DOMAIN=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.networkDnsTable.column.registeredDomain",{defaultMessage:"Registered domain"}),TOTAL_QUERIES=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.networkDnsTable.column.TotalQueriesTitle",{defaultMessage:"Total queries"}),UNIQUE_DOMAINS=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.networkDnsTable.column.uniqueDomainsTitle",{defaultMessage:"Unique domains"}),DNS_BYTES_IN=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.networkDnsTable.column.bytesInTitle",{defaultMessage:"DNS bytes in"}),DNS_BYTES_OUT=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.networkDnsTable.column.bytesOutTitle",{defaultMessage:"DNS bytes out"}),INCLUDE_PTR_RECORDS=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.networkDnsTable.select.includePtrRecords",{defaultMessage:"Include PTR records"}),ROWS_5=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.networkDnsTable.rows",{values:{numRows:5},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),ROWS_10=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.networkDnsTable.rows",{values:{numRows:10},defaultMessage:"{numRows} {numRows, plural, =0 {rows} =1 {row} other {rows}}"}),IsPtrIncluded=external_kbnSharedDeps_React_default.a.memo(({isPtrIncluded:isPtrIncluded,onChange:onChange})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSwitch,{name:"switch-ptr-included",label:INCLUDE_PTR_RECORDS,checked:isPtrIncluded,onChange:onChange}));IsPtrIncluded.displayName="IsPtrIncluded";const tableType=network_store.c.NetworkTableType.dns,rowItems=[{text:ROWS_5,numberOfRow:5},{text:ROWS_10,numberOfRow:10}],NetworkDnsTableComponent=({data:data,fakeTotalCount:fakeTotalCount,id:id,isInspect:isInspect,loading:loading,loadPage:loadPage,showMorePagesIndicator:showMorePagesIndicator,totalCount:totalCount,type:type})=>{const dispatch=Object(react_redux_lib.useDispatch)(),getNetworkDnsSelector=Object(external_kbnSharedDeps_React_.useMemo)(()=>network_store.e.dnsSelector(),[]),{activePage:activePage,isPtrIncluded:isPtrIncluded,limit:limit,sort:sort}=Object(use_selector.a)(getNetworkDnsSelector),updateLimitPagination=Object(external_kbnSharedDeps_React_.useCallback)(newLimit=>dispatch(network_store.b.updateNetworkTable({networkType:type,tableType:tableType,updates:{limit:newLimit}})),[type,dispatch]),updateActivePage=Object(external_kbnSharedDeps_React_.useCallback)(newPage=>dispatch(network_store.b.updateNetworkTable({networkType:type,tableType:tableType,updates:{activePage:newPage}})),[dispatch,type]),onChange=Object(external_kbnSharedDeps_React_.useCallback)(criteria=>{if(null!=criteria.sort){const newDnsSortField={field:criteria.sort.field.split(".")[1],direction:criteria.sort.direction};fast_deep_equal_default()(newDnsSortField,sort)||dispatch(network_store.b.updateNetworkTable({networkType:type,tableType:tableType,updates:{sort:newDnsSortField}}))}},[sort,type,dispatch]),onChangePtrIncluded=Object(external_kbnSharedDeps_React_.useCallback)(()=>dispatch(network_store.b.updateNetworkTable({networkType:type,tableType:tableType,updates:{isPtrIncluded:!isPtrIncluded}})),[dispatch,type,isPtrIncluded]),columns=Object(external_kbnSharedDeps_React_.useMemo)(()=>[{field:"node."+search_strategy.NetworkDnsFields.dnsName,name:REGISTERED_DOMAIN,truncateText:!1,hideForMobile:!1,sortable:!0,render:dnsName=>{if(null!=dnsName){const id=Object(drag_and_drop_helpers.l)("networkDns-table--name-"+dnsName);return external_kbnSharedDeps_React_default.a.createElement(draggable_wrapper.b,{key:id,dataProvider:{and:[],enabled:!0,id:id,name:dnsName,excluded:!1,kqlQuery:"",queryMatch:{field:"dns.question.registered_domain",value:dnsName,operator:data_provider.c}},render:(dataProvider,_,snapshot)=>snapshot.isDragging?external_kbnSharedDeps_React_default.a.createElement(draggable_wrapper.a,null,external_kbnSharedDeps_React_default.a.createElement(data_providers_provider.a,{dataProvider:dataProvider})):Object(empty_value.a)(dnsName)})}return Object(empty_value.d)()}},{align:"right",field:"node."+search_strategy.NetworkDnsFields.queryCount,name:TOTAL_QUERIES,sortable:!0,truncateText:!1,hideForMobile:!1,render:queryCount=>null!=queryCount?external_kbnSharedDeps_ElasticNumeral_default()(queryCount).format("0"):Object(empty_value.d)()},{align:"right",field:"node."+search_strategy.NetworkDnsFields.uniqueDomains,name:UNIQUE_DOMAINS,sortable:!0,truncateText:!1,hideForMobile:!1,render:uniqueDomains=>null!=uniqueDomains?external_kbnSharedDeps_ElasticNumeral_default()(uniqueDomains).format("0"):Object(empty_value.d)()},{align:"right",field:"node."+search_strategy.NetworkDnsFields.dnsBytesIn,name:DNS_BYTES_IN,sortable:!0,truncateText:!1,hideForMobile:!1,render:dnsBytesIn=>null!=dnsBytesIn?external_kbnSharedDeps_React_default.a.createElement(formatted_bytes.a,{value:dnsBytesIn}):Object(empty_value.d)()},{align:"right",field:"node."+search_strategy.NetworkDnsFields.dnsBytesOut,name:DNS_BYTES_OUT,sortable:!0,truncateText:!1,hideForMobile:!1,render:dnsBytesOut=>null!=dnsBytesOut?external_kbnSharedDeps_React_default.a.createElement(formatted_bytes.a,{value:dnsBytesOut}):Object(empty_value.d)()}],[]),sorting=Object(external_kbnSharedDeps_React_.useMemo)(()=>({field:"node."+sort.field,direction:sort.direction}),[sort.direction,sort.field]),HeaderSupplement=Object(external_kbnSharedDeps_React_.useMemo)(()=>external_kbnSharedDeps_React_default.a.createElement(IsPtrIncluded,{isPtrIncluded:isPtrIncluded,onChange:onChangePtrIncluded}),[isPtrIncluded,onChangePtrIncluded]);return external_kbnSharedDeps_React_default.a.createElement(paginated_table.a,{activePage:activePage,columns:columns,dataTestSubj:"table-"+tableType,headerCount:totalCount,headerSupplement:HeaderSupplement,headerTitle:TOP_DNS_DOMAINS,headerTooltip:TOOLTIP,headerUnit:UNIT(totalCount),id:id,itemsPerRow:rowItems,isInspect:isInspect,limit:limit,loading:loading,loadPage:loadPage,onChange:onChange,pageOfItems:data,showMorePagesIndicator:showMorePagesIndicator,sorting:sorting,totalCount:fakeTotalCount,updateActivePage:updateActivePage,updateLimitPagination:updateLimitPagination})};NetworkDnsTableComponent.displayName="NetworkDnsTableComponent";const NetworkDnsTable=external_kbnSharedDeps_React_default.a.memo(NetworkDnsTableComponent);var paginated_table_helpers=__webpack_require__(210);const ERROR_NETWORK_DNS=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.networkDns.errorSearchDescription",{defaultMessage:"An error has occurred on network dns search"}),FAIL_NETWORK_DNS=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.networkDns.failSearchDescription",{defaultMessage:"Failed to run search on network dns"});var _dnsStackByOptions$fi,network_pages_translations=__webpack_require__(380),components_matrix_histogram=__webpack_require__(257),security_solution=__webpack_require__(195);function dns_query_tab_body_extends(){return(dns_query_tab_body_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const NetworkDnsTableManage=Object(manage_query.a)(NetworkDnsTable),dnsStackByOptions=[{text:"dns.question.registered_domain",value:"dns.question.registered_domain"}],histogramConfigs={defaultStackByOption:null!==(_dnsStackByOptions$fi=dnsStackByOptions.find(o=>"dns.question.registered_domain"===o.text))&&void 0!==_dnsStackByOptions$fi?_dnsStackByOptions$fi:dnsStackByOptions[0],errorMessage:network_pages_translations.b,histogramType:security_solution.MatrixHistogramType.dns,stackByOptions:dnsStackByOptions,subtitle:void 0},DnsQueryTabBodyComponent=({deleteQuery:deleteQuery,docValueFields:docValueFields,endDate:endDate,filterQuery:filterQuery,indexNames:indexNames,skip:skip,startDate:startDate,setQuery:setQuery,type:type})=>{const getNetworkDnsSelector=network_store.e.dnsSelector(),isPtrIncluded=Object(use_selector.b)(state=>getNetworkDnsSelector(state).isPtrIncluded);Object(external_kbnSharedDeps_React_.useEffect)(()=>()=>{deleteQuery&&deleteQuery({id:"networkDnsHistogramQuery"})},[deleteQuery]);const[loading,{totalCount:totalCount,networkDns:networkDns,pageInfo:pageInfo,loadPage:loadPage,id:id,inspect:inspect,isInspected:isInspected,refetch:refetch}]=(({docValueFields:docValueFields,endDate:endDate,filterQuery:filterQuery,indexNames:indexNames,skip:skip,startDate:startDate,type:type})=>{const getNetworkDnsSelector=Object(external_kbnSharedDeps_React_.useMemo)(()=>network_store.e.dnsSelector(),[]),{activePage:activePage,sort:sort,isPtrIncluded:isPtrIncluded,limit:limit}=Object(use_selector.a)(getNetworkDnsSelector),{data:data}=Object(lib_kibana.h)().services,refetch=Object(external_kbnSharedDeps_React_.useRef)(external_kbnSharedDeps_LodashFp_.noop),abortCtrl=Object(external_kbnSharedDeps_React_.useRef)(new AbortController),searchSubscription$=Object(external_kbnSharedDeps_React_.useRef)(new external_kbnSharedDeps_Rxjs_.Subscription),[loading,setLoading]=Object(external_kbnSharedDeps_React_.useState)(!1),[networkDnsRequest,setNetworkDnsRequest]=Object(external_kbnSharedDeps_React_.useState)(null),wrappedLoadMore=Object(external_kbnSharedDeps_React_.useCallback)(newActivePage=>{setNetworkDnsRequest(prevRequest=>prevRequest?{...prevRequest,pagination:Object(paginated_table_helpers.a)(newActivePage,limit)}:prevRequest)},[limit]),[networkDnsResponse,setNetworkDnsResponse]=Object(external_kbnSharedDeps_React_.useState)({networkDns:[],histogram:[],id:"networkDnsQuery",inspect:{dsl:[],response:[]},isInspected:!1,loadPage:wrappedLoadMore,pageInfo:{activePage:0,fakeTotalCount:0,showMorePagesIndicator:!1},refetch:refetch.current,totalCount:-1}),{addError:addError,addWarning:addWarning}=Object(use_app_toasts.a)(),networkDnsSearch=Object(external_kbnSharedDeps_React_.useCallback)(request=>{if(null==request||skip)return;const asyncSearch=async()=>{abortCtrl.current=new AbortController,setLoading(!0),searchSubscription$.current=data.search.search(request,{strategy:"securitySolutionSearchStrategy",abortSignal:abortCtrl.current.signal}).subscribe({next:response=>{Object(common_.isCompleteResponse)(response)?(setLoading(!1),setNetworkDnsResponse(prevResponse=>{var _response$histogram;return{...prevResponse,networkDns:response.edges,inspect:Object(public_helpers.a)(response,prevResponse.inspect),pageInfo:response.pageInfo,refetch:refetch.current,totalCount:response.totalCount,histogram:null!==(_response$histogram=response.histogram)&&void 0!==_response$histogram?_response$histogram:prevResponse.histogram}}),searchSubscription$.current.unsubscribe()):Object(common_.isErrorResponse)(response)&&(setLoading(!1),addWarning(ERROR_NETWORK_DNS),searchSubscription$.current.unsubscribe())},error:msg=>{setLoading(!1),addError(msg,{title:FAIL_NETWORK_DNS}),searchSubscription$.current.unsubscribe()}})};searchSubscription$.current.unsubscribe(),abortCtrl.current.abort(),asyncSearch(),refetch.current=asyncSearch},[data.search,addError,addWarning,skip]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{setNetworkDnsRequest(prevRequest=>{const myRequest={...null!=prevRequest?prevRequest:{},defaultIndex:indexNames,docValueFields:null!=docValueFields?docValueFields:[],isPtrIncluded:isPtrIncluded,factoryQueryType:search_strategy.NetworkQueries.dns,filterQuery:Object(containers_helpers.a)(filterQuery),pagination:Object(paginated_table_helpers.a)(activePage,limit,!0),sort:sort,timerange:{interval:"12h",from:startDate,to:endDate}};return fast_deep_equal_default()(prevRequest,myRequest)?prevRequest:myRequest})},[activePage,indexNames,endDate,filterQuery,limit,startDate,sort,isPtrIncluded,docValueFields]),Object(external_kbnSharedDeps_React_.useEffect)(()=>(networkDnsSearch(networkDnsRequest),()=>{searchSubscription$.current.unsubscribe(),abortCtrl.current.abort()}),[networkDnsRequest,networkDnsSearch]),[loading,networkDnsResponse]})({docValueFields:null!=docValueFields?docValueFields:[],endDate:endDate,filterQuery:filterQuery,indexNames:indexNames,skip:skip,startDate:startDate,type:type}),getTitle=Object(external_kbnSharedDeps_React_.useCallback)(option=>network_pages_translations.a(option.text),[]),dnsHistogramConfigs=Object(external_kbnSharedDeps_React_.useMemo)(()=>({...histogramConfigs,title:getTitle}),[getTitle]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(components_matrix_histogram.a,dns_query_tab_body_extends({id:"networkDnsHistogramQuery",isPtrIncluded:isPtrIncluded,docValueFields:docValueFields,endDate:endDate,filterQuery:filterQuery,indexNames:indexNames,setQuery:setQuery,showLegend:!0,startDate:startDate},dnsHistogramConfigs)),external_kbnSharedDeps_React_default.a.createElement(NetworkDnsTableManage,{data:networkDns,fakeTotalCount:Object(external_kbnSharedDeps_LodashFp_.getOr)(50,"fakeTotalCount",pageInfo),id:id,inspect:inspect,isInspect:isInspected,loading:loading,loadPage:loadPage,refetch:refetch,setQuery:setQuery,showMorePagesIndicator:Object(external_kbnSharedDeps_LodashFp_.getOr)(!1,"showMorePagesIndicator",pageInfo),totalCount:totalCount,type:type}))};DnsQueryTabBodyComponent.displayName="DnsQueryTabBodyComponent";const DnsQueryTabBody=external_kbnSharedDeps_React_default.a.memo(DnsQueryTabBodyComponent);var conditional_flex_group=__webpack_require__(697),navigation_types=__webpack_require__(279),containers_tls=__webpack_require__(753),tls_table=__webpack_require__(738);const TlsTableManage=Object(manage_query.a)(tls_table.a),TlsQueryTabBodyComponent=({endDate:endDate,filterQuery:filterQuery,flowTarget:flowTarget,indexNames:indexNames,ip:ip="",setQuery:setQuery,skip:skip,startDate:startDate,type:type})=>{const[loading,{id:id,inspect:inspect,isInspected:isInspected,tls:tls,totalCount:totalCount,pageInfo:pageInfo,loadPage:loadPage,refetch:refetch}]=Object(containers_tls.a)({endDate:endDate,filterQuery:filterQuery,flowTarget:flowTarget,indexNames:indexNames,ip:ip,skip:skip,startDate:startDate,type:type});return external_kbnSharedDeps_React_default.a.createElement(TlsTableManage,{data:tls,id:id,inspect:inspect,isInspect:isInspected,fakeTotalCount:Object(external_kbnSharedDeps_LodashFp_.getOr)(50,"fakeTotalCount",pageInfo),loading:loading,loadPage:loadPage,showMorePagesIndicator:Object(external_kbnSharedDeps_LodashFp_.getOr)(!1,"showMorePagesIndicator",pageInfo),refetch:refetch,setQuery:setQuery,totalCount:totalCount,type:type})};TlsQueryTabBodyComponent.displayName="TlsQueryTabBodyComponent";const TlsQueryTabBody=external_kbnSharedDeps_React_default.a.memo(TlsQueryTabBodyComponent);var alerts_viewer=__webpack_require__(734);function alerts_query_tab_body_extends(){return(alerts_query_tab_body_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const filterNetworkData=[{query:{bool:{filter:[{bool:{should:[{bool:{should:[{exists:{field:"source.ip"}}],minimum_should_match:1}},{bool:{should:[{exists:{field:"destination.ip"}}],minimum_should_match:1}}],minimum_should_match:1}}]}},meta:{alias:"",disabled:!1,key:"bool",negate:!1,type:"custom",value:'{"bool":{"filter":[{"bool":{"should":[{"bool":{"should":[{"exists":{"field": "source.ip"}}],"minimum_should_match":1}},{"bool":{"should":[{"exists":{"field": "destination.ip"}}],"minimum_should_match":1}}],"minimum_should_match":1}}]}}'}}],NetworkAlertsQueryTabBody=external_kbnSharedDeps_React_default.a.memo(alertsProps=>external_kbnSharedDeps_React_default.a.createElement(alerts_viewer.a,alerts_query_tab_body_extends({timelineId:types_timeline.g.networkPageExternalAlerts},alertsProps,{pageFilters:filterNetworkData})));function network_routes_extends(){return(network_routes_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}NetworkAlertsQueryTabBody.displayName="NetworkAlertsQueryTabBody";const NetworkRoutes=external_kbnSharedDeps_React_default.a.memo(({networkPagePath:networkPagePath,docValueFields:docValueFields,type:type,to:to,filterQuery:filterQuery,isInitializing:isInitializing,from:from,indexPattern:indexPattern,indexNames:indexNames,setQuery:setQuery,setAbsoluteRangeDatePicker:setAbsoluteRangeDatePicker})=>{const narrowDateRange=Object(external_kbnSharedDeps_React_.useCallback)((score,interval)=>{const fromTo=Object(score_interval_to_datetime.a)(score,interval);setAbsoluteRangeDatePicker({id:"global",from:fromTo.from,to:fromTo.to})},[setAbsoluteRangeDatePicker]),updateDateRange=Object(external_kbnSharedDeps_React_.useCallback)(({x:x})=>{if(!x)return;const[min,max]=x;setAbsoluteRangeDatePicker({id:"global",from:new Date(min).toISOString(),to:new Date(max).toISOString()})},[setAbsoluteRangeDatePicker]),commonProps={startDate:from,endDate:to,indexNames:indexNames,skip:isInitializing,type:type,narrowDateRange:narrowDateRange,setQuery:setQuery,filterQuery:filterQuery},tabProps={...commonProps,indexPattern:indexPattern,updateDateRange:updateDateRange},anomaliesProps={...commonProps,anomaliesFilterQuery:{bool:{should:[{exists:{field:"source.ip"}},{exists:{field:"destination.ip"}}],minimum_should_match:1}},AnomaliesTableComponent:anomalies_network_table.a};return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Switch,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:`/:tabName(${navigation_types.a.dns})`},external_kbnSharedDeps_React_default.a.createElement(DnsQueryTabBody,network_routes_extends({},tabProps,{docValueFields:docValueFields}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:`/:tabName(${navigation_types.a.flows})`},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(conditional_flex_group.a,{direction:"column"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(IPsQueryTabBody,network_routes_extends({},tabProps,{flowTarget:network.FlowTargetSourceDest.source}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(IPsQueryTabBody,network_routes_extends({},tabProps,{flowTarget:network.FlowTargetSourceDest.destination})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),external_kbnSharedDeps_React_default.a.createElement(conditional_flex_group.a,{direction:"column"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(CountriesQueryTabBody,network_routes_extends({},tabProps,{flowTarget:network.FlowTargetSourceDest.source}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(CountriesQueryTabBody,network_routes_extends({},tabProps,{flowTarget:network.FlowTargetSourceDest.destination})))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:`/:tabName(${navigation_types.a.http})`},external_kbnSharedDeps_React_default.a.createElement(HttpQueryTabBody,tabProps)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:`/:tabName(${navigation_types.a.tls})`},external_kbnSharedDeps_React_default.a.createElement(TlsQueryTabBody,network_routes_extends({},tabProps,{flowTarget:network.FlowTargetSourceDest.source}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:`/:tabName(${navigation_types.a.anomalies})`},external_kbnSharedDeps_React_default.a.createElement(anomalies_query_tab_body.a,network_routes_extends({},anomaliesProps,{AnomaliesTableComponent:anomalies_network_table.a}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:`/:tabName(${navigation_types.a.alerts})`},external_kbnSharedDeps_React_default.a.createElement(NetworkAlertsQueryTabBody,tabProps)))});NetworkRoutes.displayName="NetworkRoutes";const network_routes_loading_FlexGroup=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup).withConfig({displayName:"FlexGroup",componentId:"sc-1sbaj97-0"})(["min-height:200px;"]);network_routes_loading_FlexGroup.displayName="FlexGroup";const NetworkRoutesLoading=()=>external_kbnSharedDeps_React_default.a.createElement(network_routes_loading_FlexGroup,{justifyContent:"center",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingSpinner,{size:"xl"})));NetworkRoutesLoading.displayName="NetworkRoutesLoading";const getTabsOnNetworkUrl=tabName=>"/"+tabName,navTabsNetwork=hasMlUserPermissions=>{const networkNavTabs={[navigation_types.a.flows]:{id:navigation_types.a.flows,name:network_pages_translations.f,href:getTabsOnNetworkUrl(navigation_types.a.flows),disabled:!1,urlKey:"network",pageId:app_types.a.network},[navigation_types.a.dns]:{id:navigation_types.a.dns,name:network_pages_translations.e,href:getTabsOnNetworkUrl(navigation_types.a.dns),disabled:!1,urlKey:"network",pageId:app_types.a.network},[navigation_types.a.http]:{id:navigation_types.a.http,name:network_pages_translations.g,href:getTabsOnNetworkUrl(navigation_types.a.http),disabled:!1,urlKey:"network",pageId:app_types.a.network},[navigation_types.a.tls]:{id:navigation_types.a.tls,name:network_pages_translations.h,href:getTabsOnNetworkUrl(navigation_types.a.tls),disabled:!1,urlKey:"network",pageId:app_types.a.network},[navigation_types.a.anomalies]:{id:navigation_types.a.anomalies,name:network_pages_translations.d,href:getTabsOnNetworkUrl(navigation_types.a.anomalies),disabled:!1,urlKey:"network",pageId:app_types.a.network},[navigation_types.a.alerts]:{id:navigation_types.a.alerts,name:network_pages_translations.c,href:getTabsOnNetworkUrl(navigation_types.a.alerts),disabled:!1,urlKey:"network",pageId:app_types.a.network}};return hasMlUserPermissions?networkNavTabs:Object(external_kbnSharedDeps_LodashFp_.omit)([navigation_types.a.anomalies],networkNavTabs)},network_StyledFullHeightContainer=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"StyledFullHeightContainer",componentId:"sc-5donvf-0"})(["display:flex;flex-direction:column;flex:1 1 auto;"]),NetworkComponent=external_kbnSharedDeps_React_default.a.memo(({networkPagePath:networkPagePath,hasMlUserPermissions:hasMlUserPermissions,capabilitiesFetched:capabilitiesFetched})=>{const dispatch=Object(react_redux_lib.useDispatch)(),containerElement=Object(external_kbnSharedDeps_React_.useRef)(null),getTimeline=Object(external_kbnSharedDeps_React_.useMemo)(()=>store_timeline.b.getTimelineByIdSelector(),[]),graphEventId=Object(use_selector.b)(state=>{var _getTimeline;return(null!==(_getTimeline=getTimeline(state,types_timeline.g.networkPageExternalAlerts))&&void 0!==_getTimeline?_getTimeline:defaults.a).graphEventId}),getGlobalFiltersQuerySelector=Object(external_kbnSharedDeps_React_.useMemo)(()=>store.inputsSelectors.globalFiltersQuerySelector(),[]),getGlobalQuerySelector=Object(external_kbnSharedDeps_React_.useMemo)(()=>store.inputsSelectors.globalQuerySelector(),[]),query=Object(use_selector.a)(getGlobalQuerySelector),filters=Object(use_selector.a)(getGlobalFiltersQuerySelector),{to:to,from:from,setQuery:setQuery,isInitializing:isInitializing}=Object(use_global_time.a)(),{globalFullScreen:globalFullScreen}=Object(use_full_screen.a)(),kibana=Object(lib_kibana.h)(),{tabName:tabName}=Object(external_kbnSharedDeps_ReactRouterDom_.useParams)(),tabsFilters=Object(external_kbnSharedDeps_React_.useMemo)(()=>tabName===navigation_types.a.alerts?filters.length>0?[...filters,...filterNetworkData]:filterNetworkData:filters,[tabName,filters]),narrowDateRange=Object(external_kbnSharedDeps_React_.useCallback)(({x:x})=>{if(!x)return;const[min,max]=x;dispatch(Object(inputs_actions.setAbsoluteRangeDatePicker)({id:"global",from:new Date(min).toISOString(),to:new Date(max).toISOString()}))},[dispatch]),{docValueFields:docValueFields,indicesExist:indicesExist,indexPattern:indexPattern,selectedPatterns:selectedPatterns}=Object(sourcerer.b)(),onSkipFocusBeforeEventsTable=Object(external_kbnSharedDeps_React_.useCallback)(()=>{var _containerElement$cur,_containerElement$cur2;null===(_containerElement$cur=containerElement.current)||void 0===_containerElement$cur||null===(_containerElement$cur2=_containerElement$cur.querySelector(".inspectButtonComponent:last-of-type"))||void 0===_containerElement$cur2||_containerElement$cur2.focus()},[containerElement]),onSkipFocusAfterEventsTable=Object(external_kbnSharedDeps_React_.useCallback)(()=>{Object(timeline_helpers.o)()},[]),onKeyDown=Object(external_kbnSharedDeps_React_.useCallback)(keyboardEvent=>{Object(accessibility_helpers.r)(keyboardEvent)&&Object(timeline_helpers.n)({containerElement:containerElement.current,keyboardEvent:keyboardEvent,onSkipFocusBeforeEventsTable:onSkipFocusBeforeEventsTable,onSkipFocusAfterEventsTable:onSkipFocusAfterEventsTable})},[containerElement,onSkipFocusBeforeEventsTable,onSkipFocusAfterEventsTable]),filterQuery=Object(keury.b)({config:public_.esQuery.getEsQueryConfig(kibana.services.uiSettings),indexPattern:indexPattern,queries:[query],filters:filters}),tabsFilterQuery=Object(keury.b)({config:public_.esQuery.getEsQueryConfig(kibana.services.uiSettings),indexPattern:indexPattern,queries:[query],filters:tabsFilters});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,indicesExist?external_kbnSharedDeps_React_default.a.createElement(network_StyledFullHeightContainer,{onKeyDown:onKeyDown,ref:containerElement},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiWindowEvent,{event:"resize",handler:external_kbnSharedDeps_LodashFp_.noop}),external_kbnSharedDeps_React_default.a.createElement(filters_global.a,{show:Object(timeline_helpers.q)({globalFullScreen:globalFullScreen,graphEventId:graphEventId})},external_kbnSharedDeps_React_default.a.createElement(search_bar.a,{indexPattern:indexPattern,id:"global"})),external_kbnSharedDeps_React_default.a.createElement(wrapper_page.a,{noPadding:globalFullScreen},external_kbnSharedDeps_React_default.a.createElement(Display,{show:!globalFullScreen},external_kbnSharedDeps_React_default.a.createElement(header_page.a,{border:!0,subtitle:external_kbnSharedDeps_React_default.a.createElement(last_event_time.a,{docValueFields:docValueFields,indexKey:search_strategy.LastEventIndexKey.network,indexNames:selectedPatterns}),title:network_pages_translations.i}),external_kbnSharedDeps_React_default.a.createElement(EmbeddedMap,{query:query,filters:filters,startDate:from,endDate:to,setQuery:setQuery}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),external_kbnSharedDeps_React_default.a.createElement(NetworkKpiComponent,{filterQuery:filterQuery,from:from,indexNames:selectedPatterns,narrowDateRange:narrowDateRange,setQuery:setQuery,skip:isInitializing,to:to})),capabilitiesFetched&&!isInitializing?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(Display,{show:!globalFullScreen},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),external_kbnSharedDeps_React_default.a.createElement(navigation.a,{navTabs:navTabsNetwork(hasMlUserPermissions)}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null)),external_kbnSharedDeps_React_default.a.createElement(NetworkRoutes,{docValueFields:docValueFields,filterQuery:tabsFilterQuery,from:from,isInitializing:isInitializing,indexPattern:indexPattern,indexNames:selectedPatterns,setQuery:setQuery,setAbsoluteRangeDatePicker:inputs_actions.setAbsoluteRangeDatePicker,type:network_store.c.NetworkType.page,to:to,networkPagePath:networkPagePath})):external_kbnSharedDeps_React_default.a.createElement(NetworkRoutesLoading,null))):external_kbnSharedDeps_React_default.a.createElement(wrapper_page.a,null,external_kbnSharedDeps_React_default.a.createElement(header_page.a,{border:!0,title:network_pages_translations.i}),external_kbnSharedDeps_React_default.a.createElement(overview_empty.a,null)),external_kbnSharedDeps_React_default.a.createElement(spy_routes.a,{pageName:app_types.a.network}))});NetworkComponent.displayName="NetworkComponent";const network_Network=external_kbnSharedDeps_React_default.a.memo(NetworkComponent),MlNetworkConditionalContainer=external_kbnSharedDeps_React_default.a.memo(({url:url})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Switch,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{strict:!0,exact:!0,path:url,render:({location:location})=>{const queryStringDecoded=Object(query_string.parse)(location.search.substring(1),{sort:!1});null!=queryStringDecoded.query&&(queryStringDecoded.query=replaceKQLParts(queryStringDecoded.query));const reEncoded=Object(query_string.stringify)(kibanaUtils_public_.url.encodeQuery(queryStringDecoded),{sort:!1,encode:!1});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Redirect,{to:"?"+reEncoded})}}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:url+"/ip/:ip",render:({location:location,match:{params:{ip:ip}}})=>{const queryStringDecoded=Object(query_string.parse)(location.search.substring(1),{sort:!1});if(null!=queryStringDecoded.query&&(queryStringDecoded.query=replaceKQLParts(queryStringDecoded.query)),emptyEntity(ip)){const reEncoded=Object(query_string.stringify)(kibanaUtils_public_.url.encodeQuery(queryStringDecoded),{sort:!1,encode:!1});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Redirect,{to:"?"+reEncoded})}if(multipleEntities(ip)){const ips=getMultipleEntities(ip);queryStringDecoded.query=addEntitiesToKql(["source.ip","destination.ip"],ips,queryStringDecoded.query||"");const reEncoded=Object(query_string.stringify)(kibanaUtils_public_.url.encodeQuery(queryStringDecoded),{sort:!1,encode:!1});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Redirect,{to:"?"+reEncoded})}{const reEncoded=Object(query_string.stringify)(kibanaUtils_public_.url.encodeQuery(queryStringDecoded),{sort:!1,encode:!1});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Redirect,{to:`/ip/${ip}?${reEncoded}`})}}}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:"/ml-network/",render:({location:{search:search=""}})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Redirect,{from:"/ml-network/",to:"/ml-network"+search})})));MlNetworkConditionalContainer.displayName="MlNetworkConditionalContainer";const NetworkContainerComponent=()=>{const history=Object(external_kbnSharedDeps_ReactRouterDom_.useHistory)(),capabilities=Object(use_ml_capabilities.a)(),capabilitiesFetched=capabilities.capabilitiesFetched,userHasMlUserPermissions=Object(external_kbnSharedDeps_React_.useMemo)(()=>Object(has_ml_user_permissions.a)(capabilities),[capabilities]),networkRoutePath=Object(external_kbnSharedDeps_React_.useMemo)(()=>((capabilitiesFetched,hasMlUserPermission)=>capabilitiesFetched&&!hasMlUserPermission?`/:tabName(${navigation_types.a.flows}|${navigation_types.a.dns}|${navigation_types.a.http}|${navigation_types.a.tls}|${navigation_types.a.alerts})`:"/:tabName("+navigation_types.a.flows+"|"+navigation_types.a.dns+"|"+navigation_types.a.anomalies+"|"+navigation_types.a.http+"|"+navigation_types.a.tls+"|"+navigation_types.a.alerts+")")(capabilitiesFetched,userHasMlUserPermissions),[capabilitiesFetched,userHasMlUserPermissions]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Switch,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:"/ml-network",render:({location:location,match:match})=>external_kbnSharedDeps_React_default.a.createElement(MlNetworkConditionalContainer,{location:location,url:match.url})}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{strict:!0,path:networkRoutePath},external_kbnSharedDeps_React_default.a.createElement(network_Network,{networkPagePath:"",capabilitiesFetched:capabilities.capabilitiesFetched,hasMlUserPermissions:userHasMlUserPermissions})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:"/ip/:detailName/:flowTarget"},external_kbnSharedDeps_React_default.a.createElement(pages_details.a,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:"/ip/:detailName",render:({location:{search:search=""},match:{params:{detailName:detailName}}})=>(history.replace(`ip/${detailName}/${search_strategy.FlowTarget.source}${search}`),null)}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:"/",render:({location:{search:search=""}})=>(history.replace(`${navigation_types.a.flows}${search}`),null)}))},NetworkContainer=external_kbnSharedDeps_React_default.a.memo(NetworkContainerComponent),routes_NetworkRoutes=()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Switch,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:"/",render:({location:location,match:match})=>external_kbnSharedDeps_React_default.a.createElement(NetworkContainer,{location:location,url:match.url})}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{render:()=>external_kbnSharedDeps_React_default.a.createElement(_404.a,null)}));var alerts_viewer_translations=__webpack_require__(375),overview_pages_translations=__webpack_require__(315),histogram_configs=__webpack_require__(684),redirect_to_hosts=__webpack_require__(268);function alerts_by_category_extends(){return(alerts_by_category_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const AlertsByCategoryComponent=({deleteQuery:deleteQuery,filters:filters,from:from,hideHeaderChildren:hideHeaderChildren=!1,indexPattern:indexPattern,indexNames:indexNames,query:query,setQuery:setQuery,to:to})=>{const{uiSettings:uiSettings,application:{navigateToApp:navigateToApp}}=Object(lib_kibana.h)().services,{formatUrl:formatUrl,search:urlSearch}=Object(link_to.o)(app_types.a.hosts),[defaultNumberFormat]=Object(lib_kibana.l)(constants.B),goToHostAlerts=Object(external_kbnSharedDeps_React_.useCallback)(ev=>{ev.preventDefault(),navigateToApp(`${constants.f}:${app_types.a.hosts}`,{path:Object(redirect_to_hosts.c)(store_model.HostsTableType.alerts,urlSearch)})},[navigateToApp,urlSearch]),alertsCountViewAlertsButton=Object(external_kbnSharedDeps_React_.useMemo)(()=>external_kbnSharedDeps_React_default.a.createElement(links.g,{"data-test-subj":"view-alerts",onClick:goToHostAlerts,href:formatUrl(Object(redirect_to_hosts.c)(store_model.HostsTableType.alerts))},overview_pages_translations.f),[goToHostAlerts,formatUrl]),alertsByCategoryHistogramConfigs=Object(external_kbnSharedDeps_React_.useMemo)(()=>{var _alertsStackByOptions;return{...histogram_configs.b,defaultStackByOption:null!==(_alertsStackByOptions=histogram_configs.a.find(o=>"event.module"===o.text))&&void 0!==_alertsStackByOptions?_alertsStackByOptions:histogram_configs.a[0],subtitle:totalCount=>`${alerts_viewer_translations.e}: ${external_kbnSharedDeps_ElasticNumeral_default()(totalCount).format(defaultNumberFormat)} ${Object(alerts_viewer_translations.g)(totalCount)}`,legendPosition:external_kbnSharedDeps_ElasticCharts_.Position.Right}},[]),filterQuery=Object(external_kbnSharedDeps_React_.useMemo)(()=>Object(keury.b)({config:public_.esQuery.getEsQueryConfig(uiSettings),indexPattern:indexPattern,queries:[query],filters:filters}),[filters,indexPattern,uiSettings,query]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>()=>{deleteQuery&&deleteQuery({id:"alertsByCategoryOverview"})},[deleteQuery]),external_kbnSharedDeps_React_default.a.createElement(components_matrix_histogram.a,alerts_by_category_extends({endDate:to,filterQuery:filterQuery,headerChildren:hideHeaderChildren?null:alertsCountViewAlertsButton,id:"alertsByCategoryOverview",indexNames:indexNames,setQuery:setQuery,startDate:from},alertsByCategoryHistogramConfigs))};AlertsByCategoryComponent.displayName="AlertsByCategoryComponent";const AlertsByCategory=external_kbnSharedDeps_React_default.a.memo(AlertsByCategoryComponent);var events_by_dataset=__webpack_require__(612);const ERROR_HOST_OVERVIEW=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.allHost.errorSearchDescription",{defaultMessage:"An error has occurred on all hosts search"}),FAIL_HOST_OVERVIEW=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.allHost.failSearchDescription",{defaultMessage:"Failed to run search on all hosts"}),ProgressContainer=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"ProgressContainer",componentId:"sc-1qvjg2g-0"})(["margin-left:8px;min-width:100px;"]),LoadingContent=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiLoadingContent).withConfig({displayName:"LoadingContent",componentId:"sc-1qvjg2g-1"})([".euiLoadingContent__singleLine{margin-bottom:0px;}"]),StatValueComponent=({count:count,isGroupStat:isGroupStat,isLoading:isLoading,max:max})=>{const[defaultNumberFormat]=Object(lib_kibana.l)(constants.B),[isInitialLoading,setIsInitialLoading]=Object(external_kbnSharedDeps_React_.useState)(!0);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{isInitialLoading&&!isLoading&&setIsInitialLoading(!1)},[isLoading,isInitialLoading,setIsInitialLoading]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},!isInitialLoading&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{color:isGroupStat?"default":"subdued",size:isGroupStat?"m":"s"},external_kbnSharedDeps_ElasticNumeral_default()(count).format(defaultNumberFormat))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!0},external_kbnSharedDeps_React_default.a.createElement(ProgressContainer,null,isLoading?external_kbnSharedDeps_React_default.a.createElement(LoadingContent,{"data-test-subj":"stat-value-loading-spinner",lines:1}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiProgress,{color:isGroupStat?"primary":"subdued",max:max,size:"m",value:count}))))};StatValueComponent.displayName="StatValueComponent";const stat_value_StatValue=external_kbnSharedDeps_React_default.a.memo(StatValueComponent),getOverviewHostStats=data=>{var _data$auditbeatAuditd,_data$auditbeatFIM,_data$auditbeatLogin,_data$auditbeatPackag,_data$auditbeatProces,_data$auditbeatUser,_data$endgameDns,_data$endgameFile,_data$endgameImageLoa,_data$endgameNetwork,_data$endgameProcess,_data$endgameRegistry,_data$endgameSecurity,_data$filebeatSystemM,_data$winlogbeatSecur,_data$winlogbeatMWSys;return[{count:null!==(_data$auditbeatAuditd=data.auditbeatAuditd)&&void 0!==_data$auditbeatAuditd?_data$auditbeatAuditd:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.overview.auditBeatAuditTitle",defaultMessage:"Audit"}),id:"auditbeatAuditd"},{count:null!==(_data$auditbeatFIM=data.auditbeatFIM)&&void 0!==_data$auditbeatFIM?_data$auditbeatFIM:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.overview.auditBeatFimTitle",defaultMessage:"File Integrity Module"}),id:"auditbeatFIM"},{count:null!==(_data$auditbeatLogin=data.auditbeatLogin)&&void 0!==_data$auditbeatLogin?_data$auditbeatLogin:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.overview.auditBeatLoginTitle",defaultMessage:"Login"}),id:"auditbeatLogin"},{count:null!==(_data$auditbeatPackag=data.auditbeatPackage)&&void 0!==_data$auditbeatPackag?_data$auditbeatPackag:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.overview.auditBeatPackageTitle",defaultMessage:"Package"}),id:"auditbeatPackage"},{count:null!==(_data$auditbeatProces=data.auditbeatProcess)&&void 0!==_data$auditbeatProces?_data$auditbeatProces:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.overview.auditBeatProcessTitle",defaultMessage:"Process"}),id:"auditbeatProcess"},{count:null!==(_data$auditbeatUser=data.auditbeatUser)&&void 0!==_data$auditbeatUser?_data$auditbeatUser:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.overview.auditBeatUserTitle",defaultMessage:"User"}),id:"auditbeatUser"},{count:null!==(_data$endgameDns=data.endgameDns)&&void 0!==_data$endgameDns?_data$endgameDns:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.overview.endgameDnsTitle",defaultMessage:"DNS"}),id:"endgameDns"},{count:null!==(_data$endgameFile=data.endgameFile)&&void 0!==_data$endgameFile?_data$endgameFile:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.overview.endgameFileTitle",defaultMessage:"File"}),id:"endgameFile"},{count:null!==(_data$endgameImageLoa=data.endgameImageLoad)&&void 0!==_data$endgameImageLoa?_data$endgameImageLoa:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.overview.endgameImageLoadTitle",defaultMessage:"Image Load"}),id:"endgameImageLoad"},{count:null!==(_data$endgameNetwork=data.endgameNetwork)&&void 0!==_data$endgameNetwork?_data$endgameNetwork:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.overview.endgameNetworkTitle",defaultMessage:"Network"}),id:"endgameNetwork"},{count:null!==(_data$endgameProcess=data.endgameProcess)&&void 0!==_data$endgameProcess?_data$endgameProcess:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.overview.endgameProcessTitle",defaultMessage:"Process"}),id:"endgameProcess"},{count:null!==(_data$endgameRegistry=data.endgameRegistry)&&void 0!==_data$endgameRegistry?_data$endgameRegistry:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.overview.endgameRegistryTitle",defaultMessage:"Registry"}),id:"endgameRegistry"},{count:null!==(_data$endgameSecurity=data.endgameSecurity)&&void 0!==_data$endgameSecurity?_data$endgameSecurity:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.overview.endgameSecurityTitle",defaultMessage:"Security"}),id:"endgameSecurity"},{count:null!==(_data$filebeatSystemM=data.filebeatSystemModule)&&void 0!==_data$filebeatSystemM?_data$filebeatSystemM:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.overview.filebeatSystemModuleTitle",defaultMessage:"System Module"}),id:"filebeatSystemModule"},{count:null!==(_data$winlogbeatSecur=data.winlogbeatSecurity)&&void 0!==_data$winlogbeatSecur?_data$winlogbeatSecur:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.overview.winlogbeatSecurityTitle",defaultMessage:"Security"}),id:"winlogbeatSecurity"},{count:null!==(_data$winlogbeatMWSys=data.winlogbeatMWSysmonOperational)&&void 0!==_data$winlogbeatMWSys?_data$winlogbeatMWSys:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.overview.winlogbeatMWSysmonOperational",defaultMessage:"Microsoft-Windows-Sysmon/Operational"}),id:"winlogbeatMWSysmonOperational"}]},HostStatsContainer=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"HostStatsContainer",componentId:"ej4zfy-0"})([".accordion-button{width:100%;}"]),hostStatGroups=[{groupId:"auditbeat",name:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.overview.hostStatGroupAuditbeat",defaultMessage:"Auditbeat"}),statIds:["auditbeatAuditd","auditbeatFIM","auditbeatLogin","auditbeatPackage","auditbeatProcess","auditbeatUser"]},{groupId:"endgame",name:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.overview.hostStatGroupElasticEndpointSecurity",defaultMessage:"Endpoint Security"}),statIds:["endgameDns","endgameFile","endgameImageLoad","endgameNetwork","endgameProcess","endgameRegistry","endgameSecurity"]},{groupId:"filebeat",name:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.overview.hostStatGroupFilebeat",defaultMessage:"Filebeat"}),statIds:["filebeatSystemModule"]},{groupId:"winlogbeat",name:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.overview.hostStatGroupWinlogbeat",defaultMessage:"Winlogbeat"}),statIds:["winlogbeatSecurity","winlogbeatMWSysmonOperational"]}],Title=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"Title",componentId:"ej4zfy-1"})(["margin-left:24px;"]),AccordionContent=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"AccordionContent",componentId:"ej4zfy-2"})(["margin-top:8px;"]),OverviewHostStatsComponent=({data:data,loading:loading})=>{const allHostStats=getOverviewHostStats(data),allHostStatsCount=allHostStats.reduce((total,stat)=>total+stat.count,0);return external_kbnSharedDeps_React_default.a.createElement(HostStatsContainer,{"data-test-subj":"overview-hosts-stats"},hostStatGroups.map((statGroup,i)=>{const statsForGroup=allHostStats.filter(s=>statGroup.statIds.includes(s.id)),statsForGroupCount=statsForGroup.reduce((total,stat)=>total+stat.count,0);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,{key:statGroup.groupId},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHorizontalRule,{margin:"xs"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiAccordion,{id:"host-stat-accordion-group"+statGroup.groupId,buttonContent:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"none",justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,statGroup.name)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(stat_value_StatValue,{count:statsForGroupCount,isGroupStat:!0,isLoading:loading,max:allHostStatsCount}))),buttonContentClassName:"accordion-button"},external_kbnSharedDeps_React_default.a.createElement(AccordionContent,null,statsForGroup.map(stat=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{key:stat.id,justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{color:"subdued",size:"s"},external_kbnSharedDeps_React_default.a.createElement(Title,null,stat.title))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{"data-test-subj":"host-stat-"+stat.id,grow:!1},external_kbnSharedDeps_React_default.a.createElement(stat_value_StatValue,{count:stat.count,isGroupStat:!1,isLoading:loading,max:statsForGroupCount})))))))}))},OverviewHostStats=external_kbnSharedDeps_React_default.a.memo(OverviewHostStatsComponent),OverviewHostStatsManage=Object(manage_query.a)(OverviewHostStats),OverviewHostComponent=({endDate:endDate,filterQuery:filterQuery,indexNames:indexNames,startDate:startDate,setQuery:setQuery})=>{const{formatUrl:formatUrl,search:urlSearch}=Object(link_to.o)(app_types.a.hosts),{navigateToApp:navigateToApp}=Object(lib_kibana.h)().services.application,[defaultNumberFormat]=Object(lib_kibana.l)(constants.B),[loading,{overviewHost:overviewHost,id:id,inspect:inspect,refetch:refetch}]=(({filterQuery:filterQuery,endDate:endDate,indexNames:indexNames,skip:skip=!1,startDate:startDate})=>{const{data:data}=Object(lib_kibana.h)().services,refetch=Object(external_kbnSharedDeps_React_.useRef)(external_kbnSharedDeps_LodashFp_.noop),abortCtrl=Object(external_kbnSharedDeps_React_.useRef)(new AbortController),searchSubscription$=Object(external_kbnSharedDeps_React_.useRef)(new external_kbnSharedDeps_Rxjs_.Subscription),[loading,setLoading]=Object(external_kbnSharedDeps_React_.useState)(!1),[overviewHostRequest,setHostRequest]=Object(external_kbnSharedDeps_React_.useState)(null),[overviewHostResponse,setHostOverviewResponse]=Object(external_kbnSharedDeps_React_.useState)({overviewHost:{},id:"overviewHostQuery",inspect:{dsl:[],response:[]},isInspected:!1,refetch:refetch.current}),{addError:addError,addWarning:addWarning}=Object(use_app_toasts.a)(),overviewHostSearch=Object(external_kbnSharedDeps_React_.useCallback)(request=>{if(null==request||skip)return;const asyncSearch=async()=>{abortCtrl.current=new AbortController,setLoading(!0),searchSubscription$.current=data.search.search(request,{strategy:"securitySolutionSearchStrategy",abortSignal:abortCtrl.current.signal}).subscribe({next:response=>{Object(common_.isCompleteResponse)(response)?(setLoading(!1),setHostOverviewResponse(prevResponse=>({...prevResponse,overviewHost:response.overviewHost,inspect:Object(public_helpers.a)(response,prevResponse.inspect),refetch:refetch.current})),searchSubscription$.current.unsubscribe()):Object(common_.isErrorResponse)(response)&&(setLoading(!1),addWarning(ERROR_HOST_OVERVIEW),searchSubscription$.current.unsubscribe())},error:msg=>{setLoading(!1),addError(msg,{title:FAIL_HOST_OVERVIEW}),searchSubscription$.current.unsubscribe()}})};searchSubscription$.current.unsubscribe(),abortCtrl.current.abort(),asyncSearch(),refetch.current=asyncSearch},[data.search,addError,addWarning,skip]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{setHostRequest(prevRequest=>{const myRequest={...null!=prevRequest?prevRequest:{},defaultIndex:indexNames,factoryQueryType:security_solution.HostsQueries.overview,filterQuery:Object(containers_helpers.a)(filterQuery),timerange:{interval:"12h",from:startDate,to:endDate}};return fast_deep_equal_default()(prevRequest,myRequest)?prevRequest:myRequest})},[indexNames,endDate,filterQuery,startDate]),Object(external_kbnSharedDeps_React_.useEffect)(()=>(overviewHostSearch(overviewHostRequest),()=>{searchSubscription$.current.unsubscribe(),abortCtrl.current.abort()}),[overviewHostRequest,overviewHostSearch]),[loading,overviewHostResponse]})({endDate:endDate,filterQuery:filterQuery,indexNames:indexNames,startDate:startDate}),goToHost=Object(external_kbnSharedDeps_React_.useCallback)(ev=>{ev.preventDefault(),navigateToApp(`${constants.f}:${app_types.a.hosts}`,{path:Object(link_to.i)(urlSearch)})},[navigateToApp,urlSearch]),hostEventsCount=Object(external_kbnSharedDeps_React_.useMemo)(()=>getOverviewHostStats(overviewHost).reduce((total,stat)=>total+stat.count,0),[overviewHost]),formattedHostEventsCount=Object(external_kbnSharedDeps_React_.useMemo)(()=>external_kbnSharedDeps_ElasticNumeral_default()(hostEventsCount).format(defaultNumberFormat),[defaultNumberFormat,hostEventsCount]),hostPageButton=Object(external_kbnSharedDeps_React_.useMemo)(()=>external_kbnSharedDeps_React_default.a.createElement(links.g,{onClick:goToHost,href:formatUrl(Object(link_to.i)())},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.overview.hostsAction",defaultMessage:"View hosts"})),[goToHost,formatUrl]),title=Object(external_kbnSharedDeps_React_.useMemo)(()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.overview.hostsTitle",defaultMessage:"Host events"}),[]),subtitle=Object(external_kbnSharedDeps_React_.useMemo)(()=>Object(external_kbnSharedDeps_LodashFp_.isEmpty)(overviewHost)?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,""):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{defaultMessage:"Showing: {formattedHostEventsCount} {hostEventsCount, plural, one {event} other {events}}",id:"xpack.securitySolution.overview.overviewHost.hostsSubtitle",values:{hostEventsCount:hostEventsCount,formattedHostEventsCount:formattedHostEventsCount}}),[formattedHostEventsCount,hostEventsCount,overviewHost]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(components_inspect.b,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPanel,null,external_kbnSharedDeps_React_default.a.createElement(header_section.a,{id:"overviewHostQuery",subtitle:subtitle,title:title},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,hostPageButton)),external_kbnSharedDeps_React_default.a.createElement(OverviewHostStatsManage,{loading:loading,data:overviewHost,setQuery:setQuery,id:id,inspect:inspect,refetch:refetch}))))};OverviewHostComponent.displayName="OverviewHostComponent";const OverviewHost=external_kbnSharedDeps_React_default.a.memo(OverviewHostComponent),ERROR_NETWORK_OVERVIEW=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.allHost.errorSearchDescription",{defaultMessage:"An error has occurred on all hosts search"}),FAIL_NETWORK_OVERVIEW=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.allHost.failSearchDescription",{defaultMessage:"Failed to run search on all hosts"}),getOverviewNetworkStats=data=>{var _data$auditbeatSocket,_data$filebeatCisco,_data$filebeatNetflow,_data$filebeatPanw,_data$filebeatSuricat,_data$filebeatZeek,_data$packetbeatDNS,_data$packetbeatFlow,_data$packetbeatTLS;return[{count:null!==(_data$auditbeatSocket=data.auditbeatSocket)&&void 0!==_data$auditbeatSocket?_data$auditbeatSocket:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.overview.auditBeatSocketTitle",defaultMessage:"Socket"}),id:"auditbeatSocket"},{count:null!==(_data$filebeatCisco=data.filebeatCisco)&&void 0!==_data$filebeatCisco?_data$filebeatCisco:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.overview.filebeatCiscoTitle",defaultMessage:"Cisco"}),id:"filebeatCisco"},{count:null!==(_data$filebeatNetflow=data.filebeatNetflow)&&void 0!==_data$filebeatNetflow?_data$filebeatNetflow:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.overview.filebeatNetflowTitle",defaultMessage:"Netflow"}),id:"filebeatNetflow"},{count:null!==(_data$filebeatPanw=data.filebeatPanw)&&void 0!==_data$filebeatPanw?_data$filebeatPanw:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.overview.filebeatPanwTitle",defaultMessage:"Palo Alto Networks"}),id:"filebeatPanw"},{count:null!==(_data$filebeatSuricat=data.filebeatSuricata)&&void 0!==_data$filebeatSuricat?_data$filebeatSuricat:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.overview.fileBeatSuricataTitle",defaultMessage:"Suricata"}),id:"filebeatSuricata"},{count:null!==(_data$filebeatZeek=data.filebeatZeek)&&void 0!==_data$filebeatZeek?_data$filebeatZeek:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.overview.fileBeatZeekTitle",defaultMessage:"Zeek"}),id:"filebeatZeek"},{count:null!==(_data$packetbeatDNS=data.packetbeatDNS)&&void 0!==_data$packetbeatDNS?_data$packetbeatDNS:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.overview.packetBeatDnsTitle",defaultMessage:"DNS"}),id:"packetbeatDNS"},{count:null!==(_data$packetbeatFlow=data.packetbeatFlow)&&void 0!==_data$packetbeatFlow?_data$packetbeatFlow:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.overview.packetBeatFlowTitle",defaultMessage:"Flow"}),id:"packetbeatFlow"},{count:null!==(_data$packetbeatTLS=data.packetbeatTLS)&&void 0!==_data$packetbeatTLS?_data$packetbeatTLS:0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.overview.packetbeatTLSTitle",defaultMessage:"TLS"}),id:"packetbeatTLS"}]},networkStatGroups=[{groupId:"auditbeat",name:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.overview.networkStatGroupAuditbeat",defaultMessage:"Auditbeat"}),statIds:["auditbeatSocket"]},{groupId:"filebeat",name:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.overview.networkStatGroupFilebeat",defaultMessage:"Filebeat"}),statIds:["filebeatCisco","filebeatNetflow","filebeatPanw","filebeatSuricata","filebeatZeek"]},{groupId:"packetbeat",name:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.overview.networkStatGroupPacketbeat",defaultMessage:"Packetbeat"}),statIds:["packetbeatDNS","packetbeatFlow","packetbeatTLS"]}],NetworkStatsContainer=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"NetworkStatsContainer",componentId:"sc-1wm45zw-0"})([".accordion-button{width:100%;}"]),overview_network_stats_Title=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"Title",componentId:"sc-1wm45zw-1"})(["margin-left:24px;"]),overview_network_stats_AccordionContent=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"AccordionContent",componentId:"sc-1wm45zw-2"})(["margin-top:8px;"]),OverviewNetworkStatsComponent=({data:data,loading:loading})=>{const allNetworkStats=getOverviewNetworkStats(data),allNetworkStatsCount=allNetworkStats.reduce((total,stat)=>total+stat.count,0);return external_kbnSharedDeps_React_default.a.createElement(NetworkStatsContainer,{"data-test-subj":"overview-network-stats"},networkStatGroups.map((statGroup,i)=>{const statsForGroup=allNetworkStats.filter(s=>statGroup.statIds.includes(s.id)),statsForGroupCount=statsForGroup.reduce((total,stat)=>total+stat.count,0);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,{key:statGroup.groupId},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHorizontalRule,{margin:"xs"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiAccordion,{id:"network-stat-accordion-group"+statGroup.groupId,buttonContent:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{"data-test-subj":"network-stat-group-"+statGroup.groupId,justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,statGroup.name)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(stat_value_StatValue,{count:statsForGroupCount,isGroupStat:!0,isLoading:loading,max:allNetworkStatsCount}))),buttonContentClassName:"accordion-button"},external_kbnSharedDeps_React_default.a.createElement(overview_network_stats_AccordionContent,null,statsForGroup.map(stat=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{key:stat.id,justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{color:"subdued",size:"s"},external_kbnSharedDeps_React_default.a.createElement(overview_network_stats_Title,null,stat.title))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{"data-test-subj":"network-stat-"+stat.id,grow:!1},external_kbnSharedDeps_React_default.a.createElement(stat_value_StatValue,{count:stat.count,isGroupStat:!1,isLoading:loading,max:statsForGroupCount})))))))}))},OverviewNetworkStats=external_kbnSharedDeps_React_default.a.memo(OverviewNetworkStatsComponent),OverviewNetworkStatsManage=Object(manage_query.a)(OverviewNetworkStats),OverviewNetworkComponent=({endDate:endDate,filterQuery:filterQuery,indexNames:indexNames,startDate:startDate,setQuery:setQuery})=>{const{formatUrl:formatUrl,search:urlSearch}=Object(link_to.o)(app_types.a.network),{navigateToApp:navigateToApp}=Object(lib_kibana.h)().services.application,[defaultNumberFormat]=Object(lib_kibana.l)(constants.B),[loading,{overviewNetwork:overviewNetwork,id:id,inspect:inspect,refetch:refetch}]=(({filterQuery:filterQuery,endDate:endDate,indexNames:indexNames,skip:skip=!1,startDate:startDate})=>{const{data:data}=Object(lib_kibana.h)().services,refetch=Object(external_kbnSharedDeps_React_.useRef)(external_kbnSharedDeps_LodashFp_.noop),abortCtrl=Object(external_kbnSharedDeps_React_.useRef)(new AbortController),searchSubscription$=Object(external_kbnSharedDeps_React_.useRef)(new external_kbnSharedDeps_Rxjs_.Subscription),[loading,setLoading]=Object(external_kbnSharedDeps_React_.useState)(!1),[overviewNetworkRequest,setNetworkRequest]=Object(external_kbnSharedDeps_React_.useState)(null),[overviewNetworkResponse,setNetworkOverviewResponse]=Object(external_kbnSharedDeps_React_.useState)({overviewNetwork:{},id:"overviewNetworkQuery",inspect:{dsl:[],response:[]},isInspected:!1,refetch:refetch.current}),{addError:addError,addWarning:addWarning}=Object(use_app_toasts.a)(),overviewNetworkSearch=Object(external_kbnSharedDeps_React_.useCallback)(request=>{if(null==request)return;const asyncSearch=async()=>{abortCtrl.current=new AbortController,setLoading(!0),searchSubscription$.current=data.search.search(request,{strategy:"securitySolutionSearchStrategy",abortSignal:abortCtrl.current.signal}).subscribe({next:response=>{Object(common_.isCompleteResponse)(response)?(setLoading(!1),setNetworkOverviewResponse(prevResponse=>({...prevResponse,overviewNetwork:response.overviewNetwork,inspect:Object(public_helpers.a)(response,prevResponse.inspect),refetch:refetch.current})),searchSubscription$.current.unsubscribe()):Object(common_.isErrorResponse)(response)&&(setLoading(!1),addWarning(ERROR_NETWORK_OVERVIEW),searchSubscription$.current.unsubscribe())},error:msg=>{setLoading(!1),addError(msg,{title:FAIL_NETWORK_OVERVIEW}),searchSubscription$.current.unsubscribe()}})};searchSubscription$.current.unsubscribe(),abortCtrl.current.abort(),asyncSearch(),refetch.current=asyncSearch},[data.search,addError,addWarning]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{setNetworkRequest(prevRequest=>{const myRequest={...null!=prevRequest?prevRequest:{},defaultIndex:indexNames,factoryQueryType:security_solution.NetworkQueries.overview,filterQuery:Object(containers_helpers.a)(filterQuery),timerange:{interval:"12h",from:startDate,to:endDate}};return fast_deep_equal_default()(prevRequest,myRequest)?prevRequest:myRequest})},[indexNames,endDate,filterQuery,startDate]),Object(external_kbnSharedDeps_React_.useEffect)(()=>(overviewNetworkSearch(overviewNetworkRequest),()=>{searchSubscription$.current.unsubscribe(),abortCtrl.current.abort()}),[overviewNetworkRequest,overviewNetworkSearch]),[loading,overviewNetworkResponse]})({endDate:endDate,filterQuery:filterQuery,indexNames:indexNames,startDate:startDate}),goToNetwork=Object(external_kbnSharedDeps_React_.useCallback)(ev=>{ev.preventDefault(),navigateToApp(`${constants.f}:${app_types.a.network}`,{path:Object(link_to.k)(urlSearch)})},[navigateToApp,urlSearch]),networkEventsCount=Object(external_kbnSharedDeps_React_.useMemo)(()=>getOverviewNetworkStats(overviewNetwork).reduce((total,stat)=>total+stat.count,0),[overviewNetwork]),formattedNetworkEventsCount=Object(external_kbnSharedDeps_React_.useMemo)(()=>external_kbnSharedDeps_ElasticNumeral_default()(networkEventsCount).format(defaultNumberFormat),[defaultNumberFormat,networkEventsCount]),networkPageButton=Object(external_kbnSharedDeps_React_.useMemo)(()=>external_kbnSharedDeps_React_default.a.createElement(links.g,{"data-test-subj":"overview-network-go-to-network-page",onClick:goToNetwork,href:formatUrl(Object(link_to.k)())},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.overview.networkAction",defaultMessage:"View network"})),[goToNetwork,formatUrl]),title=Object(external_kbnSharedDeps_React_.useMemo)(()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.overview.networkTitle",defaultMessage:"Network events"}),[]),subtitle=Object(external_kbnSharedDeps_React_.useMemo)(()=>Object(external_kbnSharedDeps_LodashFp_.isEmpty)(overviewNetwork)?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,""):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{defaultMessage:"Showing: {formattedNetworkEventsCount} {networkEventsCount, plural, one {event} other {events}}",id:"xpack.securitySolution.overview.overviewNetwork.networkSubtitle",values:{formattedNetworkEventsCount:formattedNetworkEventsCount,networkEventsCount:networkEventsCount}}),[formattedNetworkEventsCount,networkEventsCount,overviewNetwork]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(components_inspect.b,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPanel,{"data-test-subj":"overview-network-query"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(header_section.a,{id:"overviewNetworkQuery",subtitle:subtitle,title:title},networkPageButton),external_kbnSharedDeps_React_default.a.createElement(OverviewNetworkStatsManage,{loading:loading,data:overviewNetwork,id:id,inspect:inspect,setQuery:setQuery,refetch:refetch})))))};OverviewNetworkComponent.displayName="OverviewNetworkComponent";const OverviewNetwork=external_kbnSharedDeps_React_default.a.memo(OverviewNetworkComponent),HorizontalSpacer=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexItem).withConfig({displayName:"HorizontalSpacer",componentId:"sc-1b49qwl-0"})(["width:24px;"]),EventCountsComponent=({filters:filters,from:from,indexNames:indexNames,indexPattern:indexPattern,query:query,setQuery:setQuery,to:to})=>{const{uiSettings:uiSettings}=Object(lib_kibana.h)().services,hostFilterQuery=Object(external_kbnSharedDeps_React_.useMemo)(()=>Object(keury.b)({config:public_.esQuery.getEsQueryConfig(uiSettings),indexPattern:indexPattern,queries:[query],filters:[...filters,...alerts_query_tab_body.b]}),[filters,indexPattern,query,uiSettings]),networkFilterQuery=Object(external_kbnSharedDeps_React_.useMemo)(()=>Object(keury.b)({config:public_.esQuery.getEsQueryConfig(uiSettings),indexPattern:indexPattern,queries:[query],filters:[...filters,...filterNetworkData]}),[filters,indexPattern,uiSettings,query]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"none",justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!0},external_kbnSharedDeps_React_default.a.createElement(OverviewHost,{endDate:to,filterQuery:hostFilterQuery,indexNames:indexNames,startDate:from,setQuery:setQuery})),external_kbnSharedDeps_React_default.a.createElement(HorizontalSpacer,{grow:!1}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!0},external_kbnSharedDeps_React_default.a.createElement(OverviewNetwork,{endDate:to,filterQuery:networkFilterQuery,indexNames:indexNames,startDate:from,setQuery:setQuery})))},EventCounts=external_kbnSharedDeps_React_default.a.memo(EventCountsComponent),COMMENTS=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.recentCases.commentsTooltip",{defaultMessage:"Comments"}),MY_RECENTLY_REPORTED_CASES=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.overview.myRecentlyReportedCasesButtonLabel",{defaultMessage:"My recently reported cases"}),NO_CASES=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.recentCases.noCasesMessage",{defaultMessage:"No cases have been created yet. Put your detective hat on and"}),RECENTLY_CREATED_CASES=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.overview.recentlyCreatedCasesButtonLabel",{defaultMessage:"Recently created cases"}),START_A_NEW_CASE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.recentCases.startNewCaseLink",{defaultMessage:"start a new case"}),VIEW_ALL_CASES=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.recentCases.viewAllCasesLink",{defaultMessage:"View all cases"}),CASES_FILTER_CONTROL=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.recentCases.controlLegend",{defaultMessage:"Cases filter"}),toggleButtonIcons=[{id:"recentlyCreated",label:RECENTLY_CREATED_CASES,iconType:"folderExclamation"},{id:"myRecentlyReported",label:MY_RECENTLY_REPORTED_CASES,iconType:"reporter"}],Filters=external_kbnSharedDeps_React_default.a.memo(({filterBy:filterBy,setFilterBy:setFilterBy,showMyRecentlyReported:showMyRecentlyReported})=>{const options=Object(external_kbnSharedDeps_React_.useMemo)(()=>showMyRecentlyReported?toggleButtonIcons:toggleButtonIcons.filter(x=>"myRecentlyReported"!==x.id),[showMyRecentlyReported]),onChange=Object(external_kbnSharedDeps_React_.useCallback)(filterMode=>{setFilterBy(filterMode)},[setFilterBy]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonGroup,{options:options,idSelected:filterBy,onChange:onChange,isIconOnly:!0,legend:CASES_FILTER_CONTROL})});Filters.displayName="Filters";external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.recentTimelines.errorRetrievingUserDetailsMessage",{defaultMessage:"Recent Timelines: An error occurred while retrieving user details"});const FAVORITES=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.recentTimelines.favoritesButtonLabel",{defaultMessage:"Favorites"}),NO_FAVORITE_TIMELINES=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.recentTimelines.noFavoriteTimelinesMessage",{defaultMessage:"You haven't favorited any timelines yet. Get out there and start threat hunting!"}),LAST_UPDATED=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.recentTimelines.lastUpdatedButtonLabel",{defaultMessage:"Last updated"}),NO_TIMELINES=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.recentTimelines.noTimelinesMessage",{defaultMessage:"You haven't created any timelines yet. Get out there and start threat hunting!"}),NOTES=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.recentTimelines.notesTooltip",{defaultMessage:"Notes"}),OPEN_AS_DUPLICATE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.recentTimelines.openAsDuplicateTooltip",{defaultMessage:"Open as a timeline duplicate"}),OPEN_AS_DUPLICATE_TEMPLATE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.recentTimelines.openAsDuplicateTemplateTooltip",{defaultMessage:"Open as a template duplicate"}),PINNED_EVENTS=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.recentTimelines.pinnedEventsTooltip",{defaultMessage:"Pinned events"}),UNTITLED_TIMELINE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.recentTimelines.untitledTimelineLabel",{defaultMessage:"Untitled timeline"}),VIEW_ALL_TIMELINES=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.recentTimelines.viewAllTimelinesLink",{defaultMessage:"View all timelines"}),TIMELINES_FILTER_CONTROL=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.recentTimelines.filterControlLegend",{defaultMessage:"Timelines filter"}),filters_toggleButtonIcons=[{id:"favorites",label:FAVORITES,iconType:"starFilled"},{id:"recently-updated",label:LAST_UPDATED,iconType:"documentEdit"}],filters_Filters=external_kbnSharedDeps_React_default.a.memo(({filterBy:filterBy,setFilterBy:setFilterBy})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonGroup,{options:filters_toggleButtonIcons,idSelected:filterBy,onChange:f=>{setFilterBy(f)},isIconOnly:!0,legend:TIMELINES_FILTER_CONTROL}));filters_Filters.displayName="Filters";var use_get_cases=__webpack_require__(397);const LoadingPlaceholdersComponent=({lines:lines,placeholders:placeholders})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,[...Array(placeholders).keys()].map((_,i)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,{key:i},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingContent,{lines:lines}),i!==placeholders-1&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"}))));LoadingPlaceholdersComponent.displayName="LoadingPlaceholdersComponent";const LoadingPlaceholders=external_kbnSharedDeps_React_default.a.memo(LoadingPlaceholdersComponent);var redirect_to_case=__webpack_require__(230);const NoCasesComponent=()=>{const{formatUrl:formatUrl,search:search}=Object(link_to.o)(app_types.a.case),{navigateToApp:navigateToApp}=Object(lib_kibana.h)().services.application,goToCreateCase=Object(external_kbnSharedDeps_React_.useCallback)(ev=>{ev.preventDefault(),navigateToApp(`${constants.f}:${app_types.a.case}`,{path:Object(redirect_to_case.e)(search)})},[navigateToApp,search]),newCaseLink=Object(external_kbnSharedDeps_React_.useMemo)(()=>external_kbnSharedDeps_React_default.a.createElement(links.f,{"data-test-subj":"no-cases-create-case",onClick:goToCreateCase,href:formatUrl(Object(redirect_to_case.e)())}," "+START_A_NEW_CASE),[formatUrl,goToCreateCase]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement("span",null,NO_CASES),newCaseLink,"!")};NoCasesComponent.displayName="NoCasesComponent";const NoCases=external_kbnSharedDeps_React_default.a.memo(NoCasesComponent);var open_timeline_helpers=__webpack_require__(169);const counts_Icon=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiIcon).withConfig({displayName:"Icon",componentId:"sc-1ht70gq-0"})(["margin-right:8px;"]),counts_FlexGroup=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup).withConfig({displayName:"FlexGroup",componentId:"sc-1ht70gq-1"})(["margin-right:16px;"]),IconWithCount=external_kbnSharedDeps_React_default.a.memo(({count:count,icon:icon,tooltip:tooltip})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{content:tooltip},external_kbnSharedDeps_React_default.a.createElement(counts_FlexGroup,{alignItems:"center",gutterSize:"none"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(counts_Icon,{color:"subdued",size:"s",type:icon})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{color:"subdued",size:"xs"},count)))));IconWithCount.displayName="IconWithCount";const RecentTimelineCounts=external_kbnSharedDeps_React_default.a.memo(({timeline:timeline})=>external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(IconWithCount,{count:Object(open_timeline_helpers.e)(timeline),icon:"pinFilled",tooltip:PINNED_EVENTS}),external_kbnSharedDeps_React_default.a.createElement(IconWithCount,{count:Object(open_timeline_helpers.d)(timeline),icon:"editorComment",tooltip:NOTES})));RecentTimelineCounts.displayName="RecentTimelineCounts";const recent_cases_MarkdownContainer=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"MarkdownContainer",componentId:"nw1m7p-0"})(["max-height:150px;overflow-y:auto;width:300px;"]),RecentCasesComponent=({cases:cases})=>{const{formatUrl:formatUrl,search:search}=Object(link_to.o)(app_types.a.case),{navigateToApp:navigateToApp}=Object(lib_kibana.h)().services.application;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,cases.map((c,i)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{key:c.id,gutterSize:"none",justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"s"},external_kbnSharedDeps_React_default.a.createElement(links.f,{onClick:ev=>{ev.preventDefault(),navigateToApp(`${constants.f}:${app_types.a.case}`,{path:Object(redirect_to_case.a)({id:c.id,search:search})})},href:formatUrl(Object(redirect_to_case.a)({id:c.id}))},c.title)),external_kbnSharedDeps_React_default.a.createElement(IconWithCount,{count:c.totalComment,icon:"editorComment",tooltip:COMMENTS}),c.description&&c.description.length&&external_kbnSharedDeps_React_default.a.createElement(recent_cases_MarkdownContainer,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{color:"subdued",size:"xs"},external_kbnSharedDeps_React_default.a.createElement(markdown_editor.MarkdownRenderer,{disableLinks:!0},c.description))),i!==cases.length-1&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"})))))};RecentCasesComponent.displayName="RecentCasesComponent";const RecentCases=external_kbnSharedDeps_React_default.a.memo(RecentCasesComponent),queryParams={...use_get_cases.b,perPage:3},StatefulRecentCasesComponent=external_kbnSharedDeps_React_default.a.memo(({filterOptions:filterOptions})=>{const{formatUrl:formatUrl}=Object(link_to.o)(app_types.a.case),{navigateToApp:navigateToApp}=Object(lib_kibana.h)().services.application,previousFilterOptions=(value=>{const ref=Object(external_kbnSharedDeps_React_.useRef)();return Object(external_kbnSharedDeps_React_.useEffect)(()=>{ref.current=value}),ref.current})(filterOptions),{data:data,loading:loading,setFilters:setFilters}=Object(use_get_cases.c)(queryParams),isLoadingCases=Object(external_kbnSharedDeps_React_.useMemo)(()=>loading.indexOf("cases")>-1||loading.indexOf("caseUpdate")>-1,[loading]),goToCases=Object(external_kbnSharedDeps_React_.useCallback)(ev=>{ev.preventDefault(),navigateToApp(`${constants.f}:${app_types.a.case}`)},[navigateToApp]),allCasesLink=Object(external_kbnSharedDeps_React_.useMemo)(()=>external_kbnSharedDeps_React_default.a.createElement(links.f,{onClick:goToCases,href:formatUrl("")}," ",VIEW_ALL_CASES),[goToCases,formatUrl]);Object(external_kbnSharedDeps_React_.useEffect)(()=>{void 0!==previousFilterOptions&&previousFilterOptions!==filterOptions&&setFilters(filterOptions)},[previousFilterOptions,filterOptions,setFilters]);const content=Object(external_kbnSharedDeps_React_.useMemo)(()=>isLoadingCases?external_kbnSharedDeps_React_default.a.createElement(LoadingPlaceholders,{lines:2,placeholders:3}):isLoadingCases||0!==data.cases.length?external_kbnSharedDeps_React_default.a.createElement(RecentCases,{cases:data.cases}):external_kbnSharedDeps_React_default.a.createElement(NoCases,null),[isLoadingCases,data]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{color:"subdued",size:"s"},content,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHorizontalRule,{margin:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs"},allCasesLink))});StatefulRecentCasesComponent.displayName="StatefulRecentCasesComponent";const StatefulRecentCases=external_kbnSharedDeps_React_default.a.memo(StatefulRecentCasesComponent);var containers_all=__webpack_require__(338);const RecentTimelineHeader=external_kbnSharedDeps_React_default.a.memo(({onOpenTimeline:onOpenTimeline,timeline:timeline,timeline:{title:title,savedObjectId:savedObjectId}})=>{const onClick=Object(external_kbnSharedDeps_React_.useCallback)(()=>onOpenTimeline({duplicate:!1,timelineId:""+savedObjectId}),[onOpenTimeline,savedObjectId]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{onClick:onClick},Object(open_timeline_helpers.f)(timeline)?UNTITLED_TIMELINE:title))});RecentTimelineHeader.displayName="RecentTimelineHeader";var with_hover_actions=__webpack_require__(296);const RecentTimelinesItem=external_kbnSharedDeps_React_default.a.memo(({timeline:timeline,onOpenTimeline:onOpenTimeline,isLastItem:isLastItem})=>{const handleClick=Object(external_kbnSharedDeps_React_.useCallback)(()=>onOpenTimeline({duplicate:!0,timelineId:""+timeline.savedObjectId}),[onOpenTimeline,timeline.savedObjectId]),render=Object(external_kbnSharedDeps_React_.useCallback)(showHoverContent=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"none",justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(RecentTimelineHeader,{onOpenTimeline:onOpenTimeline,timeline:timeline}),external_kbnSharedDeps_React_default.a.createElement(RecentTimelineCounts,{timeline:timeline}),timeline.description&&timeline.description.length&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{color:"subdued",size:"xs"},timeline.description)),showHoverContent&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{content:timeline.timelineType===types_timeline.k.default?OPEN_AS_DUPLICATE:OPEN_AS_DUPLICATE_TEMPLATE},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{"aria-label":timeline.timelineType===types_timeline.k.default?OPEN_AS_DUPLICATE:OPEN_AS_DUPLICATE_TEMPLATE,"data-test-subj":"open-duplicate",isDisabled:null==timeline.savedObjectId,iconSize:"s",iconType:"copy",onClick:handleClick,size:"s"})))),[handleClick,onOpenTimeline,timeline]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(with_hover_actions.b,{render:render}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,!isLastItem&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"})))});RecentTimelinesItem.displayName="RecentTimelinesItem";const RecentTimelines=external_kbnSharedDeps_React_default.a.memo(({noTimelinesMessage:noTimelinesMessage,onOpenTimeline:onOpenTimeline,timelines:timelines})=>{const content=Object(external_kbnSharedDeps_React_.useMemo)(()=>timelines.map((timeline,index)=>external_kbnSharedDeps_React_default.a.createElement(RecentTimelinesItem,{key:`${timeline.savedObjectId}-${timeline.title}`,timeline:timeline,onOpenTimeline:onOpenTimeline,isLastItem:index===timelines.length-1})),[onOpenTimeline,timelines]);return 0===timelines.length?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{color:"subdued",size:"s"},noTimelinesMessage)):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,content)});RecentTimelines.displayName="RecentTimelines";var use_timeline_status=__webpack_require__(676);const StatefulRecentTimelinesComponent=({filterBy:filterBy})=>{const dispatch=Object(react_redux_lib.useDispatch)(),updateIsLoading=Object(external_kbnSharedDeps_React_.useCallback)(payload=>dispatch(Object(timeline_actions.updateIsLoading)(payload)),[dispatch]),updateTimeline=Object(external_kbnSharedDeps_React_.useMemo)(()=>Object(open_timeline_helpers.b)(dispatch),[dispatch]),{formatUrl:formatUrl}=Object(link_to.o)(app_types.a.timelines),{navigateToApp:navigateToApp}=Object(lib_kibana.h)().services.application,onOpenTimeline=Object(external_kbnSharedDeps_React_.useCallback)(({duplicate:duplicate,timelineId:timelineId})=>{Object(open_timeline_helpers.h)({duplicate:duplicate,timelineId:timelineId,updateIsLoading:updateIsLoading,updateTimeline:updateTimeline})},[updateIsLoading,updateTimeline]),goToTimelines=Object(external_kbnSharedDeps_React_.useCallback)(ev=>{ev.preventDefault(),navigateToApp(`${constants.f}:${app_types.a.timelines}`)},[navigateToApp]),noTimelinesMessage="favorites"===filterBy?NO_FAVORITE_TIMELINES:NO_TIMELINES,linkAllTimelines=Object(external_kbnSharedDeps_React_.useMemo)(()=>external_kbnSharedDeps_React_default.a.createElement(links.f,{onClick:goToTimelines,href:formatUrl("")},VIEW_ALL_TIMELINES),[goToTimelines,formatUrl]),loadingPlaceholders=Object(external_kbnSharedDeps_React_.useMemo)(()=>external_kbnSharedDeps_React_default.a.createElement(LoadingPlaceholders,{lines:2,placeholders:"favorites"===filterBy?1:3}),[filterBy]),{fetchAllTimeline:fetchAllTimeline,timelines:timelines,loading:loading}=Object(containers_all.b)(),timelineType=types_timeline.k.default,{timelineStatus:timelineStatus}=Object(use_timeline_status.a)({timelineType:timelineType});return Object(external_kbnSharedDeps_React_.useEffect)(()=>{fetchAllTimeline({pageInfo:{pageIndex:1,pageSize:3},search:"",sort:{sortField:types_timeline.d.updated,sortOrder:search_strategy.Direction.desc},onlyUserFavorite:"favorites"===filterBy,status:timelineStatus,timelineType:timelineType})},[fetchAllTimeline,filterBy,timelineStatus,timelineType]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,loading?loadingPlaceholders:external_kbnSharedDeps_React_default.a.createElement(RecentTimelines,{noTimelinesMessage:noTimelinesMessage,onOpenTimeline:onOpenTimeline,timelines:null!=timelines?timelines:[]}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHorizontalRule,{margin:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs"},linkAllTimelines))};StatefulRecentTimelinesComponent.displayName="StatefulRecentTimelinesComponent";const StatefulRecentTimelines=external_kbnSharedDeps_React_default.a.memo(StatefulRecentTimelinesComponent),NO_NEWS_ITEMS=[],getNewsItemsFromApiResponse=response=>{const locale=(fallback="en",""===document.documentElement.lang?fallback:null!==(_document$documentEle=document.documentElement.lang)&&void 0!==_document$documentEle?_document$documentEle:fallback);var fallback,_document$documentEle;return null==response||null==response.items?NO_NEWS_ITEMS:response.items.filter(x=>null!=x).map(x=>{var _ref,_get,_x$expire_on,_x$hash,_ref2,_get2,_ref3,_get3,_x$publish_on,_ref4,_get4;return{description:null!==(_ref=null!==(_get=Object(external_kbnSharedDeps_LodashFp_.get)(locale,x.description))&&void 0!==_get?_get:Object(external_kbnSharedDeps_LodashFp_.get)("en",x.description))&&void 0!==_ref?_ref:"",expireOn:new Date(null!==(_x$expire_on=x.expire_on)&&void 0!==_x$expire_on?_x$expire_on:""),hash:null!==(_x$hash=x.hash)&&void 0!==_x$hash?_x$hash:uuid_default.a.v4(),imageUrl:null!==(_ref2=null!==(_get2=Object(external_kbnSharedDeps_LodashFp_.get)(locale,x.image_url))&&void 0!==_get2?_get2:Object(external_kbnSharedDeps_LodashFp_.get)("en",x.image_url))&&void 0!==_ref2?_ref2:null,linkUrl:null!==(_ref3=null!==(_get3=Object(external_kbnSharedDeps_LodashFp_.get)(locale,x.link_url))&&void 0!==_get3?_get3:Object(external_kbnSharedDeps_LodashFp_.get)("en",x.link_url))&&void 0!==_ref3?_ref3:"",publishOn:new Date(null!==(_x$publish_on=x.publish_on)&&void 0!==_x$publish_on?_x$publish_on:""),title:null!==(_ref4=null!==(_get4=Object(external_kbnSharedDeps_LodashFp_.get)(locale,x.title))&&void 0!==_get4?_get4:Object(external_kbnSharedDeps_LodashFp_.get)("en",x.title))&&void 0!==_ref4?_ref4:""}})},SidebarHeader=external_kbnSharedDeps_React_default.a.memo(({children:children,title:title})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",gutterSize:"none",justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("h2",null,title))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},children)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHorizontalRule,{margin:"s"})));SidebarHeader.displayName="SidebarHeader";const NO_NEWS_MESSAGE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.newsFeed.noNewsMessage",{defaultMessage:"Your current news feed URL returned no recent news."}),NO_NEWS_MESSAGE_ADMIN=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.newsFeed.noNewsMessageForAdmin",{defaultMessage:"Your current news feed URL returned no recent news. You may update the URL or disable security news via"}),ADVANCED_SETTINGS_LINK_TITLE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.newsFeed.advancedSettingsLinkTitle",{defaultMessage:"SIEM advanced settings"}),NoNews=external_kbnSharedDeps_React_default.a.memo(()=>{var _capabilities$managem;const{getUrlForApp:getUrlForApp,navigateToApp:navigateToApp,capabilities:capabilities}=Object(lib_kibana.h)().services.application,canSeeAdvancedSettings=null!==(_capabilities$managem=capabilities.management.kibana.settings)&&void 0!==_capabilities$managem&&_capabilities$managem,goToKibanaSettings=Object(external_kbnSharedDeps_React_.useCallback)(()=>navigateToApp("management",{path:"/kibana/settings"}),[navigateToApp]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{color:"subdued",size:"s"},canSeeAdvancedSettings?NO_NEWS_MESSAGE_ADMIN:NO_NEWS_MESSAGE,canSeeAdvancedSettings&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null," ",external_kbnSharedDeps_React_default.a.createElement(links.f,{onClick:goToKibanaSettings,href:""+getUrlForApp("management",{path:"/kibana/settings"})},ADVANCED_SETTINGS_LINK_TITLE),"."))});NoNews.displayName="NoNews";const NewsLink=({href:href,children:children})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{href:href,rel:"noopener nofollow noreferrer",target:"_blank"},children),NewsItemPreviewImage=external_kbnSharedDeps_StyledComponents_default.a.img.withConfig({displayName:"NewsItemPreviewImage",componentId:"e9sq8j-0"})(["height:56px;margin-left:16px;min-width:56px;padding:4px;width:56px;"]),Post=external_kbnSharedDeps_React_default.a.memo(({newsItem:newsItem})=>{const{linkUrl:linkUrl,title:title,publishOn:publishOn,description:description,imageUrl:imageUrl}=newsItem;return(({publishOn:publishOn,expireOn:expireOn})=>external_kbnSharedDeps_Moment_default()(Date.now()).isAfter(publishOn)&&external_kbnSharedDeps_Moment_default()(Date.now()).isBefore(expireOn))(newsItem)?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"none",justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(NewsLink,{href:linkUrl},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"s"},title)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{color:"subdued",size:"xs"},external_kbnSharedDeps_React_default.a.createElement(formatted_date.e,{value:publishOn}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement("div",null,description),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},imageUrl&&external_kbnSharedDeps_React_default.a.createElement(NewsLink,{href:linkUrl},external_kbnSharedDeps_React_default.a.createElement(NewsItemPreviewImage,{alt:title,className:"euiPanel",src:imageUrl})))):null});Post.displayName="Post";const NewsFeedComponent=({news:news})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(SidebarHeader,{title:overview_pages_translations.b}),null==news?external_kbnSharedDeps_React_default.a.createElement(LoadingPlaceholders,{lines:4,placeholders:5}):0===news.length?external_kbnSharedDeps_React_default.a.createElement(NoNews,null):news.map(n=>external_kbnSharedDeps_React_default.a.createElement(Post,{key:n.hash,newsItem:n})));NewsFeedComponent.displayName="NewsFeedComponent";const NewsFeed=external_kbnSharedDeps_React_default.a.memo(NewsFeedComponent),StatefulNewsFeed=external_kbnSharedDeps_React_default.a.memo(({enableNewsFeedSetting:enableNewsFeedSetting,newsFeedSetting:newsFeedSetting})=>{const kibanaNewsfeedEnabled=Object(lib_kibana.h)().services.newsfeed,[enableNewsFeed]=Object(lib_kibana.l)(enableNewsFeedSetting),[newsFeedUrlSetting]=Object(lib_kibana.l)(newsFeedSetting),[news,setNews]=Object(external_kbnSharedDeps_React_.useState)(null),newsfeedEnabled=kibanaNewsfeedEnabled&&enableNewsFeed,newsFeedUrl=(({newsFeedUrlSetting:newsFeedUrlSetting,getKibanaVersion:getKibanaVersion})=>{return[null==newsFeedUrlSetting?void 0:newsFeedUrlSetting.trim().replace(/\/$/,""),`v${kibanaVersion=getKibanaVersion(),null!==(_kibanaVersion$replac=null==kibanaVersion?void 0:kibanaVersion.replace(/-SNAPSHOT/gi,""))&&void 0!==_kibanaVersion$replac?_kibanaVersion$replac:kibanaVersion}.json`].join("/");var kibanaVersion,_kibanaVersion$replac})({newsFeedUrlSetting:newsFeedUrlSetting,getKibanaVersion:()=>lib_kibana.b.getKibanaVersion()});return Object(external_kbnSharedDeps_React_.useEffect)(()=>{let canceled=!1;return newsfeedEnabled&&(async()=>{try{const apiResponse=await(async({newsFeedUrl:newsFeedUrl})=>lib_kibana.b.get().http.fetch(newsFeedUrl,{method:"GET",credentials:"omit",mode:"cors"}))({newsFeedUrl:newsFeedUrl});canceled||setNews(getNewsItemsFromApiResponse(apiResponse))}catch{canceled||setNews([])}})(),()=>{canceled=!0}},[newsfeedEnabled,newsFeedUrl]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,newsfeedEnabled?external_kbnSharedDeps_React_default.a.createElement(NewsFeed,{news:news}):null)});StatefulNewsFeed.displayName="StatefulNewsFeed";const SidebarFlexGroup=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup).withConfig({displayName:"SidebarFlexGroup",componentId:"s31pt6-0"})(["width:305px;"]),SidebarSpacerComponent=()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"xxl"}));SidebarSpacerComponent.displayName="SidebarSpacerComponent";const Spacer=external_kbnSharedDeps_React_default.a.memo(SidebarSpacerComponent),Sidebar=external_kbnSharedDeps_React_default.a.memo(({recentCasesFilterBy:recentCasesFilterBy,recentTimelinesFilterBy:recentTimelinesFilterBy,setRecentCasesFilterBy:setRecentCasesFilterBy,setRecentTimelinesFilterBy:setRecentTimelinesFilterBy})=>{const currentUser=Object(lib_kibana.d)(),recentCasesFilters=Object(external_kbnSharedDeps_React_.useMemo)(()=>external_kbnSharedDeps_React_default.a.createElement(Filters,{filterBy:recentCasesFilterBy,setFilterBy:setRecentCasesFilterBy,showMyRecentlyReported:null!=currentUser}),[currentUser,recentCasesFilterBy,setRecentCasesFilterBy]),recentCasesFilterOptions=Object(external_kbnSharedDeps_React_.useMemo)(()=>"myRecentlyReported"===recentCasesFilterBy&&null!=currentUser?{...use_get_cases.a,reporters:[{email:currentUser.email,full_name:currentUser.fullName,username:currentUser.username}]}:use_get_cases.a,[currentUser,recentCasesFilterBy]),recentTimelinesFilters=Object(external_kbnSharedDeps_React_.useMemo)(()=>external_kbnSharedDeps_React_default.a.createElement(filters_Filters,{filterBy:recentTimelinesFilterBy,setFilterBy:setRecentTimelinesFilterBy}),[recentTimelinesFilterBy,setRecentTimelinesFilterBy]);return external_kbnSharedDeps_React_default.a.createElement(SidebarFlexGroup,{direction:"column",gutterSize:"none"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(SidebarHeader,{title:overview_pages_translations.c},recentCasesFilters),external_kbnSharedDeps_React_default.a.createElement(StatefulRecentCases,{filterOptions:recentCasesFilterOptions})),external_kbnSharedDeps_React_default.a.createElement(Spacer,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(SidebarHeader,{title:overview_pages_translations.d},recentTimelinesFilters),external_kbnSharedDeps_React_default.a.createElement(StatefulRecentTimelines,{filterBy:recentTimelinesFilterBy})),external_kbnSharedDeps_React_default.a.createElement(Spacer,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(StatefulNewsFeed,{enableNewsFeedSetting:constants.P,newsFeedSetting:constants.W})))});Sidebar.displayName="Sidebar";const StatefulSidebar=external_kbnSharedDeps_React_default.a.memo(()=>{const[recentTimelinesFilterBy,setRecentTimelinesFilterBy]=Object(external_kbnSharedDeps_React_.useState)("favorites"),[recentCasesFilterBy,setRecentCasesFilterBy]=Object(external_kbnSharedDeps_React_.useState)("recentlyCreated");return external_kbnSharedDeps_React_default.a.createElement(Sidebar,{recentCasesFilterBy:recentCasesFilterBy,setRecentCasesFilterBy:setRecentCasesFilterBy,recentTimelinesFilterBy:recentTimelinesFilterBy,setRecentTimelinesFilterBy:setRecentTimelinesFilterBy})});StatefulSidebar.displayName="StatefulSidebar";var signals_by_category=__webpack_require__(685),routing=__webpack_require__(149),use_navigate_to_app_event_handler=__webpack_require__(215),management_common_constants=__webpack_require__(132);const EndpointNotice=Object(external_kbnSharedDeps_React_.memo)(({onDismiss:onDismiss})=>{const endpointsPath=Object(routing.d)({name:"endpointList"}),endpointsLink=(managementPath=endpointsPath,`${Object(lib_kibana.h)().services.application.getUrlForApp(management_common_constants.b)}${managementPath}`);var managementPath;const handleGetStartedClick=Object(use_navigate_to_app_event_handler.a)(management_common_constants.b,{path:endpointsPath});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{"data-test-subj":"endpoint-prompt-banner",iconType:"cheer",title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement("b",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.overview.endpointNotice.introducing",defaultMessage:"Introducing: "})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.overview.endpointNotice.title",defaultMessage:"Endpoint Security (beta)"}))},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.overview.endpointNotice.message",defaultMessage:"Protect your hosts with threat prevention, detection, and deep security data visibility."})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{onClick:handleGetStartedClick,href:endpointsLink},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.overview.endpointNotice.tryButton",defaultMessage:"Try Endpoint Security (beta)"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{onClick:onDismiss},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.overview.endpointNotice.dismiss",defaultMessage:"Dismiss message"}))))});EndpointNotice.displayName="EndpointNotice";var use_messages_storage=__webpack_require__(475),ingest_enabled=__webpack_require__(372),components_sourcerer=__webpack_require__(732);const SidebarFlexItem=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexItem).withConfig({displayName:"SidebarFlexItem",componentId:"g6j99s-0"})(["margin-right:24px;"]),OverviewComponent=()=>{const getGlobalFiltersQuerySelector=Object(external_kbnSharedDeps_React_.useMemo)(()=>store.inputsSelectors.globalFiltersQuerySelector(),[]),getGlobalQuerySelector=Object(external_kbnSharedDeps_React_.useMemo)(()=>store.inputsSelectors.globalQuerySelector(),[]),query=Object(use_selector.a)(getGlobalQuerySelector),filters=Object(use_selector.a)(getGlobalFiltersQuerySelector),{from:from,deleteQuery:deleteQuery,setQuery:setQuery,to:to}=Object(use_global_time.a)(),{indicesExist:indicesExist,indexPattern:indexPattern,selectedPatterns:selectedPatterns}=Object(sourcerer.b)(),endpointMetadataIndex=Object(external_kbnSharedDeps_React_.useMemo)(()=>[constants.Q],[]),[,{indexExists:metadataIndexExists}]=Object(source.b)(endpointMetadataIndex,!0),{addMessage:addMessage,hasMessage:hasMessage}=Object(use_messages_storage.a)(),hasDismissEndpointNoticeMessage=Object(external_kbnSharedDeps_React_.useMemo)(()=>hasMessage("management","dismissEndpointNotice"),[hasMessage]),[dismissMessage,setDismissMessage]=Object(external_kbnSharedDeps_React_.useState)(hasDismissEndpointNoticeMessage),dismissEndpointNotice=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setDismissMessage(!0),addMessage("management","dismissEndpointNotice")},[addMessage]),{allEnabled:isIngestEnabled}=Object(ingest_enabled.a)();return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,indicesExist?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(filters_global.a,null,external_kbnSharedDeps_React_default.a.createElement(search_bar.a,{id:"global",indexPattern:indexPattern})),external_kbnSharedDeps_React_default.a.createElement(wrapper_page.a,null,!dismissMessage&&!metadataIndexExists&&isIngestEnabled&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(EndpointNotice,{onDismiss:dismissEndpointNotice}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"})),external_kbnSharedDeps_React_default.a.createElement(components_sourcerer.a,{scope:model.SourcererScopeName.default}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"none",justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(SidebarFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(StatefulSidebar,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"column",gutterSize:"none"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(signals_by_category.a,{filters:filters,from:from,query:query,setQuery:setQuery,to:to}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(AlertsByCategory,{deleteQuery:deleteQuery,filters:filters,from:from,indexPattern:indexPattern,indexNames:selectedPatterns,query:query,setQuery:setQuery,to:to})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(events_by_dataset.a,{deleteQuery:deleteQuery,filters:filters,from:from,indexPattern:indexPattern,indexNames:selectedPatterns,query:query,setQuery:setQuery,to:to})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(EventCounts,{filters:filters,from:from,indexNames:selectedPatterns,indexPattern:indexPattern,query:query,setQuery:setQuery,to:to}))))))):external_kbnSharedDeps_React_default.a.createElement(overview_empty.a,null),external_kbnSharedDeps_React_default.a.createElement(spy_routes.a,{pageName:app_types.a.overview}))},StatefulOverview=external_kbnSharedDeps_React_default.a.memo(OverviewComponent),pages_Overview=Object(external_kbnSharedDeps_React_.memo)(()=>external_kbnSharedDeps_React_default.a.createElement(StatefulOverview,null));pages_Overview.displayName="Overview";const OverviewRoutes=()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Switch,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:"/",render:()=>external_kbnSharedDeps_React_default.a.createElement(pages_Overview,null)}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{render:()=>external_kbnSharedDeps_React_default.a.createElement(_404.a,null)}));var pages=__webpack_require__(743);const TimelinesRoutesComponent=()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Switch,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:"/"},external_kbnSharedDeps_React_default.a.createElement(pages.a,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,null,external_kbnSharedDeps_React_default.a.createElement(_404.a,null))),TimelinesRoutes=external_kbnSharedDeps_React_default.a.memo(TimelinesRoutesComponent);var dist=__webpack_require__(235),store_timeline_helpers=__webpack_require__(417);const initialTimelineState={timelineById:{},autoSavedWarningMsg:{timelineId:null,newTimelineModel:null},showCallOutUnauthorizedMsg:!1,insertTimeline:null},timelineReducer=Object(dist.reducerWithInitialState)(initialTimelineState).case(timeline_actions.addTimeline,(state,{id:id,timeline:timeline})=>({...state,timelineById:Object(store_timeline_helpers.f)({id:id,timeline:timeline,timelineById:state.timelineById})})).case(timeline_actions.createTimeline,(state,{id:id,dataProviders:dataProviders,dateRange:dateRange,excludedRowRendererIds:excludedRowRendererIds,expandedDetail:expandedDetail={},show:show,columns:columns,itemsPerPage:itemsPerPage,indexNames:indexNames,kqlQuery:kqlQuery,sort:sort,showCheckboxes:showCheckboxes,timelineType:timelineType=types_timeline.k.default,filters:filters})=>({...state,timelineById:Object(store_timeline_helpers.a)({columns:columns,dataProviders:dataProviders,dateRange:dateRange,excludedRowRendererIds:excludedRowRendererIds,expandedDetail:expandedDetail,filters:filters,id:id,itemsPerPage:itemsPerPage,indexNames:indexNames,kqlQuery:kqlQuery,sort:sort,show:show,showCheckboxes:showCheckboxes,timelineById:state.timelineById,timelineType:timelineType})})).case(timeline_actions.upsertColumn,(state,{column:column,id:id,index:index})=>({...state,timelineById:Object(store_timeline_helpers.N)({column:column,id:id,index:index,timelineById:state.timelineById})})).case(timeline_actions.addHistory,(state,{id:id,historyId:historyId})=>({...state,timelineById:Object(store_timeline_helpers.b)({id:id,historyId:historyId,timelineById:state.timelineById})})).case(timeline_actions.addNote,(state,{id:id,noteId:noteId})=>({...state,timelineById:Object(store_timeline_helpers.c)({id:id,noteId:noteId,timelineById:state.timelineById})})).case(timeline_actions.addNoteToEvent,(state,{id:id,noteId:noteId,eventId:eventId})=>({...state,timelineById:Object(store_timeline_helpers.d)({id:id,noteId:noteId,eventId:eventId,timelineById:state.timelineById})})).case(timeline_actions.toggleDetailPanel,(state,action)=>({...state,timelineById:{...state.timelineById,[action.timelineId]:{...state.timelineById[action.timelineId],expandedDetail:{...state.timelineById[action.timelineId].expandedDetail,...Object(store_timeline_helpers.v)(action)}}}})).case(timeline_actions.addProvider,(state,{id:id,provider:provider})=>({...state,timelineById:Object(store_timeline_helpers.e)({id:id,provider:provider,timelineById:state.timelineById})})).case(timeline_actions.applyKqlFilterQuery,(state,{id:id,filterQuery:filterQuery})=>({...state,timelineById:Object(store_timeline_helpers.h)({id:id,filterQuery:filterQuery,timelineById:state.timelineById})})).case(timeline_actions.showTimeline,(state,{id:id,show:show})=>({...state,timelineById:Object(store_timeline_helpers.K)({id:id,show:show,timelineById:state.timelineById})})).case(timeline_actions.updateTimelineGraphEventId,(state,{id:id,graphEventId:graphEventId})=>({...state,timelineById:Object(store_timeline_helpers.s)({id:id,graphEventId:graphEventId,timelineById:state.timelineById})})).case(timeline_actions.applyDeltaToColumnWidth,(state,{id:id,columnId:columnId,delta:delta})=>({...state,timelineById:Object(store_timeline_helpers.g)({id:id,columnId:columnId,delta:delta,timelineById:state.timelineById})})).case(timeline_actions.pinEvent,(state,{id:id,eventId:eventId})=>({...state,timelineById:Object(store_timeline_helpers.j)({id:id,eventId:eventId,timelineById:state.timelineById})})).case(timeline_actions.removeColumn,(state,{id:id,columnId:columnId})=>({...state,timelineById:Object(store_timeline_helpers.k)({id:id,columnId:columnId,timelineById:state.timelineById})})).case(timeline_actions.removeProvider,(state,{id:id,providerId:providerId,andProviderId:andProviderId})=>({...state,timelineById:Object(store_timeline_helpers.l)({id:id,providerId:providerId,timelineById:state.timelineById,andProviderId:andProviderId})})).case(timeline_actions.startTimelineSaving,(state,{id:id})=>({...state,timelineById:{...state.timelineById,[id]:{...state.timelineById[id],isSaving:!0}}})).case(timeline_actions.endTimelineSaving,(state,{id:id})=>({...state,timelineById:{...state.timelineById,[id]:{...state.timelineById[id],isSaving:!1}}})).case(timeline_actions.setEventsDeleted,(state,{id:id,eventIds:eventIds,isDeleted:isDeleted})=>({...state,timelineById:Object(store_timeline_helpers.m)({id:id,eventIds:eventIds,timelineById:state.timelineById,isDeleted:isDeleted})})).case(timeline_actions.clearEventsDeleted,(state,{id:id})=>({...state,timelineById:{...state.timelineById,[id]:{...state.timelineById[id],deletedEventIds:[]}}})).case(timeline_actions.setEventsLoading,(state,{id:id,eventIds:eventIds,isLoading:isLoading})=>({...state,timelineById:Object(store_timeline_helpers.n)({id:id,eventIds:eventIds,timelineById:state.timelineById,isLoading:isLoading})})).case(timeline_actions.clearEventsLoading,(state,{id:id})=>({...state,timelineById:{...state.timelineById,[id]:{...state.timelineById[id],loadingEventIds:[]}}})).case(timeline_actions.setExcludedRowRendererIds,(state,{id:id,excludedRowRendererIds:excludedRowRendererIds})=>({...state,timelineById:Object(store_timeline_helpers.q)({id:id,excludedRowRendererIds:excludedRowRendererIds,timelineById:state.timelineById})})).case(timeline_actions.setSelected,(state,{id:id,eventIds:eventIds,isSelected:isSelected,isSelectAllChecked:isSelectAllChecked})=>({...state,timelineById:Object(store_timeline_helpers.o)({id:id,eventIds:eventIds,timelineById:state.timelineById,isSelected:isSelected,isSelectAllChecked:isSelectAllChecked})})).case(timeline_actions.clearSelected,(state,{id:id})=>({...state,timelineById:{...state.timelineById,[id]:{...state.timelineById[id],selectedEventIds:{},isSelectAllChecked:!1}}})).case(timeline_actions.updateIsLoading,(state,{id:id,isLoading:isLoading})=>({...state,timelineById:{...state.timelineById,[id]:{...state.timelineById[id],isLoading:isLoading}}})).case(timeline_actions.updateTimeline,(state,{id:id,timeline:timeline})=>({...state,timelineById:{...state.timelineById,[id]:timeline}})).case(timeline_actions.unPinEvent,(state,{id:id,eventId:eventId})=>({...state,timelineById:Object(store_timeline_helpers.p)({id:id,eventId:eventId,timelineById:state.timelineById})})).case(timeline_actions.updateColumns,(state,{id:id,columns:columns})=>({...state,timelineById:Object(store_timeline_helpers.u)({id:id,columns:columns,timelineById:state.timelineById})})).case(timeline_actions.updateEventType,(state,{id:id,eventType:eventType})=>({...state,timelineById:Object(store_timeline_helpers.w)({id:id,eventType:eventType,timelineById:state.timelineById})})).case(timeline_actions.updateIsFavorite,(state,{id:id,isFavorite:isFavorite})=>({...state,timelineById:Object(store_timeline_helpers.x)({id:id,isFavorite:isFavorite,timelineById:state.timelineById})})).case(timeline_actions.updateIsLive,(state,{id:id,isLive:isLive})=>({...state,timelineById:Object(store_timeline_helpers.y)({id:id,isLive:isLive,timelineById:state.timelineById})})).case(timeline_actions.updateKqlMode,(state,{id:id,kqlMode:kqlMode})=>({...state,timelineById:Object(store_timeline_helpers.A)({id:id,kqlMode:kqlMode,timelineById:state.timelineById})})).case(timeline_actions.updateTitleAndDescription,(state,{id:id,title:title,description:description})=>({...state,timelineById:Object(store_timeline_helpers.M)({id:id,title:title,description:description,timelineById:state.timelineById})})).case(timeline_actions.updateProviders,(state,{id:id,providers:providers})=>({...state,timelineById:Object(store_timeline_helpers.I)({id:id,providers:providers,timelineById:state.timelineById})})).case(timeline_actions.updateRange,(state,{id:id,start:start,end:end})=>({...state,timelineById:Object(store_timeline_helpers.J)({id:id,start:start,end:end,timelineById:state.timelineById})})).case(timeline_actions.updateSort,(state,{id:id,sort:sort})=>({...state,timelineById:Object(store_timeline_helpers.L)({id:id,sort:sort,timelineById:state.timelineById})})).case(timeline_actions.updateDataProviderEnabled,(state,{id:id,enabled:enabled,providerId:providerId,andProviderId:andProviderId})=>({...state,timelineById:Object(store_timeline_helpers.D)({id:id,enabled:enabled,providerId:providerId,timelineById:state.timelineById,andProviderId:andProviderId})})).case(timeline_actions.updateDataProviderExcluded,(state,{id:id,excluded:excluded,providerId:providerId,andProviderId:andProviderId})=>({...state,timelineById:Object(store_timeline_helpers.E)({id:id,excluded:excluded,providerId:providerId,timelineById:state.timelineById,andProviderId:andProviderId})})).case(timeline_actions.dataProviderEdited,(state,{andProviderId:andProviderId,excluded:excluded,field:field,id:id,operator:operator,providerId:providerId,value:value})=>({...state,timelineById:Object(store_timeline_helpers.G)({andProviderId:andProviderId,excluded:excluded,field:field,id:id,operator:operator,providerId:providerId,timelineById:state.timelineById,value:value})})).case(timeline_actions.updateDataProviderType,(state,{id:id,type:type,providerId:providerId,andProviderId:andProviderId})=>({...state,timelineById:Object(store_timeline_helpers.H)({id:id,type:type,providerId:providerId,timelineById:state.timelineById,andProviderId:andProviderId})})).case(timeline_actions.updateDataProviderKqlQuery,(state,{id:id,kqlQuery:kqlQuery,providerId:providerId})=>({...state,timelineById:Object(store_timeline_helpers.F)({id:id,kqlQuery:kqlQuery,providerId:providerId,timelineById:state.timelineById})})).case(timeline_actions.updateItemsPerPage,(state,{id:id,itemsPerPage:itemsPerPage})=>({...state,timelineById:Object(store_timeline_helpers.z)({id:id,itemsPerPage:itemsPerPage,timelineById:state.timelineById})})).case(timeline_actions.updatePageIndex,(state,{id:id,activePage:activePage})=>({...state,timelineById:Object(store_timeline_helpers.B)({id:id,activePage:activePage,timelineById:state.timelineById})})).case(timeline_actions.updateItemsPerPageOptions,(state,{id:id,itemsPerPageOptions:itemsPerPageOptions})=>({...state,timelineById:Object(store_timeline_helpers.C)({id:id,itemsPerPageOptions:itemsPerPageOptions,timelineById:state.timelineById})})).case(timeline_actions.updateAutoSaveMsg,(state,{timelineId:timelineId,newTimelineModel:newTimelineModel})=>({...state,autoSavedWarningMsg:{timelineId:timelineId,newTimelineModel:newTimelineModel}})).case(timeline_actions.showCallOutUnauthorizedMsg,state=>({...state,showCallOutUnauthorizedMsg:!0})).case(timeline_actions.setSavedQueryId,(state,{id:id,savedQueryId:savedQueryId})=>({...state,timelineById:Object(store_timeline_helpers.t)({id:id,savedQueryId:savedQueryId,timelineById:state.timelineById})})).case(timeline_actions.setFilters,(state,{id:id,filters:filters})=>({...state,timelineById:Object(store_timeline_helpers.r)({id:id,filters:filters,timelineById:state.timelineById})})).case(timeline_actions.setInsertTimeline,(state,insertTimeline)=>({...state,insertTimeline:insertTimeline})).case(timeline_actions.updateIndexNames,(state,{id:id,indexNames:indexNames})=>({...state,timelineById:{...state.timelineById,[id]:{...state.timelineById[id],indexNames:indexNames}}})).case(timeline_actions.setActiveTabTimeline,(state,{id:id,activeTab:activeTab})=>({...state,timelineById:{...state.timelineById,[id]:{...state.timelineById[id],activeTab:activeTab,prevActiveTab:state.timelineById[id].activeTab}}})).case(timeline_actions.toggleModalSaveTimeline,(state,{id:id,showModalSaveTimeline:showModalSaveTimeline})=>({...state,timelineById:{...state.timelineById,[id]:{...state.timelineById[id],showSaveModal:showModalSaveTimeline}}})).case(timeline_actions.updateEqlOptions,(state,{id:id,field:field,value:value})=>{var _state$timelineById$i;return{...state,timelineById:{...state.timelineById,[id]:{...state.timelineById[id],eqlOptions:{...null!==(_state$timelineById$i=state.timelineById[id].eqlOptions)&&void 0!==_state$timelineById$i?_state$timelineById$i:{},[field]:value}}}}}).build();var management_pages=__webpack_require__(709),current_license=__webpack_require__(707);const ManagementRoutes=()=>external_kbnSharedDeps_React_default.a.createElement(current_license.a,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Switch,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:"/",component:management_pages.a}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{render:()=>external_kbnSharedDeps_React_default.a.createElement(_404.a,null)})));var store_reducer=__webpack_require__(730),middleware=__webpack_require__(719);const subPluginClasses={Detections:class{setup(){}start(storage){return{SubPluginRoutes:AlertsRoutes,storageTimelines:{timelineById:Object(local_storage.b)(storage,DETECTIONS_TIMELINE_IDS)}}}},Cases:class{setup(){}start(){return{SubPluginRoutes:CasesRoutes}}},Hosts:class{setup(){}start(storage){return{SubPluginRoutes:HostsRoutes,storageTimelines:{timelineById:Object(local_storage.b)(storage,HOST_TIMELINE_IDS)},store:{initialState:{hosts:hosts_store.e},reducer:{hosts:hosts_store.c}}}}},Network:class{setup(){}start(storage){return{SubPluginRoutes:routes_NetworkRoutes,storageTimelines:{timelineById:Object(local_storage.b)(storage,[types_timeline.g.networkPageExternalAlerts])},store:{initialState:{network:network_store.a},reducer:{network:network_store.d}}}}},Overview:class{setup(){}start(){return{SubPluginRoutes:OverviewRoutes}}},Timelines:class{setup(){}start(){return{SubPluginRoutes:TimelinesRoutes,store:{initialState:{timeline:initialTimelineState},reducer:{timeline:timelineReducer}}}}},Management:class{setup(){}start(core,plugins){return{SubPluginRoutes:ManagementRoutes,store:{initialState:{management:void 0},reducer:{management:store_reducer.a},middleware:Object(middleware.a)(core,plugins)}}}}}},177:function(module,exports,__webpack_require__){"use strict";module.exports=function(character){return re.test("number"==typeof character?fromCode(character):character.charAt(0))};var fromCode=String.fromCharCode,re=/\s/},189:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"m",(function(){return EQL_VALIDATION_REQUEST_ERROR})),__webpack_require__.d(__webpack_exports__,"k",(function(){return EQL_VALIDATION_ERRORS_TITLE})),__webpack_require__.d(__webpack_exports__,"l",(function(){return EQL_VALIDATION_ERROR_POPOVER_LABEL})),__webpack_require__.d(__webpack_exports__,"i",(function(){return EQL_OVERVIEW_LINK_TEXT})),__webpack_require__.d(__webpack_exports__,"j",(function(){return EQL_SETTINGS_TITLE})),__webpack_require__.d(__webpack_exports__,"h",(function(){return EQL_OPTIONS_SIZE_LABEL})),__webpack_require__.d(__webpack_exports__,"g",(function(){return EQL_OPTIONS_SIZE_HELPER})),__webpack_require__.d(__webpack_exports__,"b",(function(){return EQL_OPTIONS_EVENT_CATEGORY_FIELD_LABEL})),__webpack_require__.d(__webpack_exports__,"a",(function(){return EQL_OPTIONS_EVENT_CATEGORY_FIELD_HELPER})),__webpack_require__.d(__webpack_exports__,"d",(function(){return EQL_OPTIONS_EVENT_TIEBREAKER_FIELD_LABEL})),__webpack_require__.d(__webpack_exports__,"c",(function(){return EQL_OPTIONS_EVENT_TIEBREAKER_FIELD_HELPER})),__webpack_require__.d(__webpack_exports__,"f",(function(){return EQL_OPTIONS_EVENT_TIMESTAMP_FIELD_LABEL})),__webpack_require__.d(__webpack_exports__,"e",(function(){return EQL_OPTIONS_EVENT_TIMESTAMP_FIELD_HELPER}));var _kbn_i18n__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1);const EQL_VALIDATION_REQUEST_ERROR=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.detectionEngine.eqlValidation.requestError",{defaultMessage:"An error occurred while validating your EQL query"}),EQL_VALIDATION_ERRORS_TITLE=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.detectionEngine.eqlValidation.title",{defaultMessage:"EQL Validation Errors"}),EQL_VALIDATION_ERROR_POPOVER_LABEL=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.detectionEngine.eqlValidation.showErrorsLabel",{defaultMessage:"Show EQL Validation Errors"}),EQL_OVERVIEW_LINK_TEXT=(_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.detectionEngine.eqlQueryBar.label",{defaultMessage:"Enter an EQL Query"}),_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.detectionEngine.eqlOverViewLink.text",{defaultMessage:"Event Query Language (EQL) Overview"})),EQL_SETTINGS_TITLE=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.detectionEngine.eqlSettings.title",{defaultMessage:"EQL settings"}),EQL_OPTIONS_SIZE_LABEL=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsSize.label",{defaultMessage:"Size"}),EQL_OPTIONS_SIZE_HELPER=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsSize.text",{defaultMessage:"For basic queries, the maximum number of matching events to return. For sequence queries, the maximum number of matching sequences to return."}),EQL_OPTIONS_EVENT_CATEGORY_FIELD_LABEL=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventCategoryField.label",{defaultMessage:"Event category field"}),EQL_OPTIONS_EVENT_CATEGORY_FIELD_HELPER=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventCategoryField.text",{defaultMessage:"Field containing the event classification, such as process, file, or network. This field is typically mapped as a field type in the keyword family"}),EQL_OPTIONS_EVENT_TIEBREAKER_FIELD_LABEL=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventTiebreakerField.label",{defaultMessage:"Tiebreaker field"}),EQL_OPTIONS_EVENT_TIEBREAKER_FIELD_HELPER=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventTiebreakerField.text",{defaultMessage:"Field used to sort hits with the same timestamp in ascending, lexicographic order"}),EQL_OPTIONS_EVENT_TIMESTAMP_FIELD_LABEL=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventTimestampField.label",{defaultMessage:"Timestamp field"}),EQL_OPTIONS_EVENT_TIMESTAMP_FIELD_HELPER=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventTimestampField.text",{defaultMessage:"Field containing event timestamp"})},217:function(module,exports){module.exports=function(){for(var target={},i=0;i<arguments.length;i++){var source=arguments[i];for(var key in source)hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target};var hasOwnProperty=Object.prototype.hasOwnProperty},282:function(module,exports){(exports=module.exports=function(str){return str.trim?str.trim():exports.right(exports.left(str))}).left=function(str){return str.trimLeft?str.trimLeft():str.replace(/^\s\s*/,"")},exports.right=function(str){if(str.trimRight)return str.trimRight();for(var whitespace_pattern=/\s/,i=str.length;whitespace_pattern.test(str.charAt(--i)););return str.slice(0,i+1)}},324:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return debounceAsync})),__webpack_require__.d(__webpack_exports__,"b",(function(){return eqlValidator})),__webpack_require__.d(__webpack_exports__,"c",(function(){return getValidationResults}));var external_kbnSharedDeps_Lodash_=__webpack_require__(80),utils=__webpack_require__(176),kibana=__webpack_require__(109),public_=__webpack_require__(96);const isValidationErrorType=type=>"parsing_exception"===type||"verification_exception"===type||"mapping_exception"===type,isErrorResponse=response=>Object(external_kbnSharedDeps_Lodash_.has)(response,"error.type"),getValidationErrors=response=>response.error.root_cause.filter(cause=>isValidationErrorType(cause.type)).map(cause=>cause.reason),validateEql=async({data:data,index:index,query:query,signal:signal})=>{const{rawResponse:response}=await data.search.search({params:{index:index.join(),body:{query:query,size:0}},options:{ignore:[400]}},{strategy:public_.EQL_SEARCH_STRATEGY,abortSignal:signal}).toPromise();if((response=>isErrorResponse(response)&&isValidationErrorType(Object(external_kbnSharedDeps_Lodash_.get)(response,"error.type")))(response.body))return{valid:!1,errors:getValidationErrors(response.body)};if(isErrorResponse(response.body))throw new Error(JSON.stringify(response.body));return{valid:!0,errors:[]}};var translations=__webpack_require__(189);let ERROR_CODES;!function(ERROR_CODES){ERROR_CODES.FAILED_REQUEST="ERR_FAILED_REQUEST",ERROR_CODES.INVALID_EQL="ERR_INVALID_EQL"}(ERROR_CODES||(ERROR_CODES={}));const debounceAsync=(fn,interval)=>{let handle,resolves=[];return(...args)=>(handle&&clearTimeout(handle),handle=setTimeout(()=>{const result=fn(...args);resolves.forEach(resolve=>resolve(result)),resolves=[]},interval),new Promise(resolve=>resolves.push(resolve)))},eqlValidator=async(...args)=>{const[{value:value,formData:formData}]=args,{query:queryValue}=value,query=queryValue.query,{index:index,ruleType:ruleType}=formData;if(void 0===ruleType&&!Object(external_kbnSharedDeps_Lodash_.isEmpty)(query)||Object(utils.c)(ruleType)&&!Object(external_kbnSharedDeps_Lodash_.isEmpty)(query))try{const{data:data}=kibana.b.get(),signal=(new AbortController).signal,response=await validateEql({data:data,query:query,signal:signal,index:index});if(!1===(null==response?void 0:response.valid))return{code:ERROR_CODES.INVALID_EQL,message:"",messages:response.errors}}catch(error){return{code:ERROR_CODES.FAILED_REQUEST,message:translations.m,error:error}}},getValidationResults=field=>{const hasErrors=field.errors.length>0,isValid=!field.isChangingValue&&!hasErrors;if(hasErrors){const[error]=field.errors,message=error.message;return error.code===ERROR_CODES.INVALID_EQL?{isValid:isValid,message:message,messages:error.messages}:{isValid:isValid,message:message,error:error.error}}return{isValid:isValid,message:""}}},383:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return QueryBar}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(6),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),fast_deep_equal__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(112),fast_deep_equal__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(fast_deep_equal__WEBPACK_IMPORTED_MODULE_1__),_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(81),_src_plugins_kibana_utils_public__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(39);const QueryBar=Object(react__WEBPACK_IMPORTED_MODULE_0__.memo)(({dateRangeFrom:dateRangeFrom,dateRangeTo:dateRangeTo,hideSavedQuery:hideSavedQuery=!1,indexPattern:indexPattern,isLoading:isLoading=!1,isRefreshPaused:isRefreshPaused,filterQuery:filterQuery,filterManager:filterManager,filters:filters,onChangedQuery:onChangedQuery,onSubmitQuery:onSubmitQuery,refreshInterval:refreshInterval,savedQuery:savedQuery,onSavedQuery:onSavedQuery,dataTestSubj:dataTestSubj})=>{const onQuerySubmit=Object(react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(payload=>{null==payload.query||fast_deep_equal__WEBPACK_IMPORTED_MODULE_1___default()(payload.query,filterQuery)||onSubmitQuery(payload.query)},[filterQuery,onSubmitQuery]),onQueryChange=Object(react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(payload=>{onChangedQuery&&null!=payload.query&&!fast_deep_equal__WEBPACK_IMPORTED_MODULE_1___default()(payload.query,filterQuery)&&onChangedQuery(payload.query)},[filterQuery,onChangedQuery]),onSavedQueryUpdated=Object(react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(savedQueryUpdated=>{const{query:newQuery,filters:newFilters,timefilter:timefilter}=savedQueryUpdated.attributes;onSubmitQuery(newQuery,timefilter),filterManager.setFilters(newFilters||[]),onSavedQuery(savedQueryUpdated)},[filterManager,onSubmitQuery,onSavedQuery]),onClearSavedQuery=Object(react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(()=>{null!=savedQuery&&(onSubmitQuery({query:"",language:savedQuery.attributes.query.language}),filterManager.setFilters([]),onSavedQuery(void 0))},[filterManager,onSubmitQuery,onSavedQuery,savedQuery]),onFiltersUpdated=Object(react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(newFilters=>{filterManager.setFilters(newFilters)},[filterManager]),CustomButton=react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0___default.a.Fragment,null,null),indexPatterns=Object(react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(()=>[indexPattern],[indexPattern]);return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_2__.SearchBar,{customSubmitButton:CustomButton,dateRangeFrom:dateRangeFrom,dateRangeTo:dateRangeTo,filters:filters,indexPatterns:indexPatterns,isLoading:isLoading,isRefreshPaused:isRefreshPaused,query:filterQuery,onClearSavedQuery:onClearSavedQuery,onFiltersUpdated:onFiltersUpdated,onQueryChange:onQueryChange,onQuerySubmit:onQuerySubmit,onSaved:onSavedQuery,onSavedQueryUpdated:onSavedQueryUpdated,refreshInterval:refreshInterval,showAutoRefreshOnly:!1,showFilterBar:!hideSavedQuery,showDatePicker:!1,showQueryBar:!0,showQueryInput:!0,showSaveQuery:!0,timeHistory:new _src_plugins_data_public__WEBPACK_IMPORTED_MODULE_2__.TimeHistory(new _src_plugins_kibana_utils_public__WEBPACK_IMPORTED_MODULE_3__.Storage(localStorage)),dataTestSubj:dataTestSubj,savedQuery:savedQuery})});QueryBar.displayName="QueryBar"},384:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return useSavedQueryServices}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(6),_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(81),_lib_kibana__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(109);const useSavedQueryServices=()=>{const client=Object(_lib_kibana__WEBPACK_IMPORTED_MODULE_2__.h)().services.savedObjects.client,[savedQueryService,setSavedQueryService]=Object(react__WEBPACK_IMPORTED_MODULE_0__.useState)(Object(_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_1__.createSavedQueryService)(client));return Object(react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>{setSavedQueryService(Object(_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_1__.createSavedQueryService)(client))},[client]),savedQueryService}},385:function(module,exports,__webpack_require__){"use strict";module.exports=function(character){var code="string"==typeof character?character.charCodeAt(0):character;return code>=48&&code<=57}},386:function(module,exports,__webpack_require__){"use strict";module.exports=visit;var visitParents=__webpack_require__(1059),CONTINUE=visitParents.CONTINUE,SKIP=visitParents.SKIP,EXIT=visitParents.EXIT;function visit(tree,test,visitor,reverse){"function"==typeof test&&"function"!=typeof visitor&&(reverse=visitor,visitor=test,test=null),visitParents(tree,test,(function(node,parents){var parent=parents[parents.length-1],index=parent?parent.children.indexOf(node):null;return visitor(node,index,parent)}),reverse)}visit.CONTINUE=CONTINUE,visit.SKIP=SKIP,visit.EXIT=EXIT},387:function(module,__webpack_exports__,__webpack_require__){"use strict";var _callout_switcher__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(760);__webpack_require__.d(__webpack_exports__,"CallOutSwitcher",(function(){return _callout_switcher__WEBPACK_IMPORTED_MODULE_0__.a}));var _callout_types__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(705);__webpack_require__.o(_callout_types__WEBPACK_IMPORTED_MODULE_1__,"CallOutPersistentSwitcher")&&__webpack_require__.d(__webpack_exports__,"CallOutPersistentSwitcher",(function(){return _callout_types__WEBPACK_IMPORTED_MODULE_1__.CallOutPersistentSwitcher}));__webpack_require__(394);var _callout_persistent_switcher__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(706);__webpack_require__.d(__webpack_exports__,"CallOutPersistentSwitcher",(function(){return _callout_persistent_switcher__WEBPACK_IMPORTED_MODULE_3__.a}))},394:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return CallOut}));var external_kbnSharedDeps_React_=__webpack_require__(6),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),external_kbnSharedDeps_ElasticEui_=__webpack_require__(74),utility_types=__webpack_require__(194),external_kbnSharedDeps_LodashFp_=__webpack_require__(7);const DISMISS_BUTTON=__webpack_require__(1).i18n.translate("xpack.securitySolution.callouts.dismissButton",{defaultMessage:"Dismiss"}),CallOutDismissButton=({message:message,text:text,onClick:onClick=external_kbnSharedDeps_LodashFp_.noop})=>{const{type:type}=message,buttonColor="success"===type?"secondary":type,buttonText=null!=text?text:DISMISS_BUTTON,handleClick=Object(external_kbnSharedDeps_React_.useCallback)(()=>onClick(message),[onClick,message]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{color:buttonColor,"data-test-subj":"callout-dismiss-btn",onClick:handleClick},buttonText)},CallOutComponent=({message:message,iconType:iconType,dismissButtonText:dismissButtonText,onDismiss:onDismiss,showDismissButton:showDismissButton=!0})=>{const{type:type,id:id,title:title,description:description}=message,finalIconType=null!=iconType?iconType:getDefaultIconType(type);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{color:type,title:title,iconType:finalIconType,"data-test-subj":"callout-"+id,"data-test-messages":`[${id}]`},description,showDismissButton&&external_kbnSharedDeps_React_default.a.createElement(CallOutDismissButton,{message:message,text:dismissButtonText,onClick:onDismiss}))},getDefaultIconType=type=>{switch(type){case"primary":return"iInCircle";case"success":return"cheer";case"warning":return"help";case"danger":return"alert";default:return Object(utility_types.a)(type)}},CallOut=Object(external_kbnSharedDeps_React_.memo)(CallOutComponent)},479:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return QueryBarTimeline})),__webpack_require__.d(__webpack_exports__,"b",(function(){return getDataProviderFilter}));var lodash_fp__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(7),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(6),react__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__),react_redux__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(110),rxjs__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(15),fast_deep_equal__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(112),fast_deep_equal__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(fast_deep_equal__WEBPACK_IMPORTED_MODULE_4__),_common_containers_sourcerer__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(130),_common_store_sourcerer_model__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(124),_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(81),_common_lib_keury__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(165),_common_utils_saved_query_services__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(384),_common_components_query_bar__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(383),_helpers__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(126),_store_timeline__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(113);const getNonDropAreaFilters=(filters=[])=>filters.filter(f=>"timeline-filter-drop-area"!==f.meta.controlledBy),QueryBarTimeline=Object(react__WEBPACK_IMPORTED_MODULE_1__.memo)(({dataProviders:dataProviders,filters:filters,filterManager:filterManager,filterQuery:filterQuery,from:from,fromStr:fromStr,kqlMode:kqlMode,isRefreshPaused:isRefreshPaused,savedQueryId:savedQueryId,setFilters:setFilters,setSavedQueryId:setSavedQueryId,refreshInterval:refreshInterval,timelineId:timelineId,to:to,toStr:toStr,updateReduxTime:updateReduxTime})=>{const dispatch=Object(react_redux__WEBPACK_IMPORTED_MODULE_2__.useDispatch)(),[dateRangeFrom,setDateRangeFrom]=Object(react__WEBPACK_IMPORTED_MODULE_1__.useState)(null!=fromStr?fromStr:new Date(from).toISOString()),[dateRangeTo,setDateRangTo]=Object(react__WEBPACK_IMPORTED_MODULE_1__.useState)(null!=toStr?toStr:new Date(to).toISOString()),{browserFields:browserFields,indexPattern:indexPattern}=Object(_common_containers_sourcerer__WEBPACK_IMPORTED_MODULE_5__.b)(_common_store_sourcerer_model__WEBPACK_IMPORTED_MODULE_6__.SourcererScopeName.timeline),[savedQuery,setSavedQuery]=Object(react__WEBPACK_IMPORTED_MODULE_1__.useState)(void 0),[filterQueryConverted,setFilterQueryConverted]=Object(react__WEBPACK_IMPORTED_MODULE_1__.useState)({query:null!=filterQuery?filterQuery.expression:"",language:null!=filterQuery?filterQuery.kind:"kuery"}),[queryBarFilters,setQueryBarFilters]=Object(react__WEBPACK_IMPORTED_MODULE_1__.useState)(getNonDropAreaFilters(filters)),[dataProvidersDsl,setDataProvidersDsl]=Object(react__WEBPACK_IMPORTED_MODULE_1__.useState)(Object(_common_lib_keury__WEBPACK_IMPORTED_MODULE_8__.a)(Object(_helpers__WEBPACK_IMPORTED_MODULE_11__.i)(dataProviders,browserFields),indexPattern)),savedQueryServices=Object(_common_utils_saved_query_services__WEBPACK_IMPORTED_MODULE_9__.a)(),applyKqlFilterQuery=Object(react__WEBPACK_IMPORTED_MODULE_1__.useCallback)((expression,kind)=>dispatch(_store_timeline__WEBPACK_IMPORTED_MODULE_12__.a.applyKqlFilterQuery({id:timelineId,filterQuery:{kuery:{kind:kind,expression:expression},serializedQuery:Object(_common_lib_keury__WEBPACK_IMPORTED_MODULE_8__.a)(expression,indexPattern)}})),[dispatch,indexPattern,timelineId]);Object(react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{let isSubscribed=!0;const subscriptions=new rxjs__WEBPACK_IMPORTED_MODULE_3__.Subscription;return filterManager.setFilters(filters),subscriptions.add(filterManager.getUpdates$().subscribe({next:()=>{if(isSubscribed){const filterWithoutDropArea=getNonDropAreaFilters(filterManager.getFilters());setFilters(filterWithoutDropArea),setQueryBarFilters(filterWithoutDropArea)}}})),()=>{isSubscribed=!1,subscriptions.unsubscribe()}},[]),Object(react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{const filterWithoutDropArea=getNonDropAreaFilters(filterManager.getFilters());fast_deep_equal__WEBPACK_IMPORTED_MODULE_4___default()(filters,filterWithoutDropArea)||filterManager.setFilters(filters)},[filters]),Object(react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{setFilterQueryConverted({query:null!=filterQuery?filterQuery.expression:"",language:null!=filterQuery?filterQuery.kind:"kuery"})},[filterQuery]),Object(react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{setDataProvidersDsl(Object(_common_lib_keury__WEBPACK_IMPORTED_MODULE_8__.a)(Object(_helpers__WEBPACK_IMPORTED_MODULE_11__.i)(dataProviders,browserFields),indexPattern))},[dataProviders,browserFields,indexPattern]),Object(react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{null!=fromStr&&null!=toStr?(setDateRangeFrom(fromStr),setDateRangTo(toStr)):null!=from&&null!=to&&(setDateRangeFrom(new Date(from).toISOString()),setDateRangTo(new Date(to).toISOString()))},[from,fromStr,to,toStr]),Object(react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{let isSubscribed=!0;return async function(){if(null!=savedQueryId&&null!=savedQueryServices)try{const mySavedQuery=await savedQueryServices.getSavedQuery(savedQueryId);isSubscribed&&null!=mySavedQuery&&setSavedQuery({...mySavedQuery,attributes:{...mySavedQuery.attributes,filters:getNonDropAreaFilters(filters)}})}catch(exc){setSavedQuery(void 0)}else isSubscribed&&setSavedQuery(void 0)}(),()=>{isSubscribed=!1}},[savedQueryId]);const onSubmitQuery=Object(react__WEBPACK_IMPORTED_MODULE_1__.useCallback)((newQuery,timefilter)=>{if((null==filterQuery||null!=filterQuery&&filterQuery.expression!==newQuery.query||filterQuery.kind!==newQuery.language)&&applyKqlFilterQuery(newQuery.query,newQuery.language),null!=timefilter){const isQuickSelection=timefilter.from.includes("now")||timefilter.to.includes("now");updateReduxTime({id:"timeline",end:timefilter.to,start:timefilter.from,isInvalid:!1,isQuickSelection:isQuickSelection,timelineId:timelineId})}},[filterQuery,timelineId]),onSavedQuery=Object(react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(newSavedQuery=>{if(null!=newSavedQuery){if(newSavedQuery.id!==savedQueryId&&setSavedQueryId(newSavedQuery.id),null!=savedQueryServices&&""!==dataProvidersDsl){const dataProviderFilterExists=null!=newSavedQuery.attributes.filters?newSavedQuery.attributes.filters.findIndex(f=>"timeline-filter-drop-area"===f.meta.controlledBy):-1;savedQueryServices.saveQuery({...newSavedQuery.attributes,filters:null!=newSavedQuery.attributes.filters?dataProviderFilterExists>-1?[...newSavedQuery.attributes.filters.slice(0,dataProviderFilterExists),getDataProviderFilter(dataProvidersDsl),...newSavedQuery.attributes.filters.slice(dataProviderFilterExists+1)]:[...newSavedQuery.attributes.filters,getDataProviderFilter(dataProvidersDsl)]:[]},{overwrite:!0})}}else setSavedQueryId(null)},[dataProvidersDsl,savedQueryId,savedQueryServices]);return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_common_components_query_bar__WEBPACK_IMPORTED_MODULE_10__.a,{dateRangeFrom:dateRangeFrom,dateRangeTo:dateRangeTo,hideSavedQuery:"search"===kqlMode,indexPattern:indexPattern,isRefreshPaused:isRefreshPaused,filterQuery:filterQueryConverted,filterManager:filterManager,filters:queryBarFilters,onSubmitQuery:onSubmitQuery,refreshInterval:refreshInterval,savedQuery:savedQuery,onSavedQuery:onSavedQuery,dataTestSubj:"timelineQueryInput"})}),getDataProviderFilter=dataProviderDsl=>{const dslObject=JSON.parse(dataProviderDsl),key=Object.keys(dslObject);return{...dslObject,meta:{alias:"timeline-filter-drop-area",controlledBy:"timeline-filter-drop-area",negate:!1,disabled:!1,type:"custom",key:Object(lodash_fp__WEBPACK_IMPORTED_MODULE_0__.isEmpty)(key)?"bool":key[0],value:dataProviderDsl},$state:{store:_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_7__.esFilters.FilterStateStore.APP_STATE}}}},480:function(module,exports,__webpack_require__){(function(process){function normalizeArray(parts,allowAboveRoot){for(var up=0,i=parts.length-1;i>=0;i--){var last=parts[i];"."===last?parts.splice(i,1):".."===last?(parts.splice(i,1),up++):up&&(parts.splice(i,1),up--)}if(allowAboveRoot)for(;up--;up)parts.unshift("..");return parts}function filter(xs,f){if(xs.filter)return xs.filter(f);for(var res=[],i=0;i<xs.length;i++)f(xs[i],i,xs)&&res.push(xs[i]);return res}exports.resolve=function(){for(var resolvedPath="",resolvedAbsolute=!1,i=arguments.length-1;i>=-1&&!resolvedAbsolute;i--){var path=i>=0?arguments[i]:process.cwd();if("string"!=typeof path)throw new TypeError("Arguments to path.resolve must be strings");path&&(resolvedPath=path+"/"+resolvedPath,resolvedAbsolute="/"===path.charAt(0))}return(resolvedAbsolute?"/":"")+(resolvedPath=normalizeArray(filter(resolvedPath.split("/"),(function(p){return!!p})),!resolvedAbsolute).join("/"))||"."},exports.normalize=function(path){var isAbsolute=exports.isAbsolute(path),trailingSlash="/"===substr(path,-1);return(path=normalizeArray(filter(path.split("/"),(function(p){return!!p})),!isAbsolute).join("/"))||isAbsolute||(path="."),path&&trailingSlash&&(path+="/"),(isAbsolute?"/":"")+path},exports.isAbsolute=function(path){return"/"===path.charAt(0)},exports.join=function(){var paths=Array.prototype.slice.call(arguments,0);return exports.normalize(filter(paths,(function(p,index){if("string"!=typeof p)throw new TypeError("Arguments to path.join must be strings");return p})).join("/"))},exports.relative=function(from,to){function trim(arr){for(var start=0;start<arr.length&&""===arr[start];start++);for(var end=arr.length-1;end>=0&&""===arr[end];end--);return start>end?[]:arr.slice(start,end-start+1)}from=exports.resolve(from).substr(1),to=exports.resolve(to).substr(1);for(var fromParts=trim(from.split("/")),toParts=trim(to.split("/")),length=Math.min(fromParts.length,toParts.length),samePartsLength=length,i=0;i<length;i++)if(fromParts[i]!==toParts[i]){samePartsLength=i;break}var outputParts=[];for(i=samePartsLength;i<fromParts.length;i++)outputParts.push("..");return(outputParts=outputParts.concat(toParts.slice(samePartsLength))).join("/")},exports.sep="/",exports.delimiter=":",exports.dirname=function(path){if("string"!=typeof path&&(path+=""),0===path.length)return".";for(var code=path.charCodeAt(0),hasRoot=47===code,end=-1,matchedSlash=!0,i=path.length-1;i>=1;--i)if(47===(code=path.charCodeAt(i))){if(!matchedSlash){end=i;break}}else matchedSlash=!1;return-1===end?hasRoot?"/":".":hasRoot&&1===end?"/":path.slice(0,end)},exports.basename=function(path,ext){var f=function(path){"string"!=typeof path&&(path+="");var i,start=0,end=-1,matchedSlash=!0;for(i=path.length-1;i>=0;--i)if(47===path.charCodeAt(i)){if(!matchedSlash){start=i+1;break}}else-1===end&&(matchedSlash=!1,end=i+1);return-1===end?"":path.slice(start,end)}(path);return ext&&f.substr(-1*ext.length)===ext&&(f=f.substr(0,f.length-ext.length)),f},exports.extname=function(path){"string"!=typeof path&&(path+="");for(var startDot=-1,startPart=0,end=-1,matchedSlash=!0,preDotState=0,i=path.length-1;i>=0;--i){var code=path.charCodeAt(i);if(47!==code)-1===end&&(matchedSlash=!1,end=i+1),46===code?-1===startDot?startDot=i:1!==preDotState&&(preDotState=1):-1!==startDot&&(preDotState=-1);else if(!matchedSlash){startPart=i+1;break}}return-1===startDot||-1===end||0===preDotState||1===preDotState&&startDot===end-1&&startDot===startPart+1?"":path.slice(startDot,end)};var substr="b"==="ab".substr(-1)?function(str,start,len){return str.substr(start,len)}:function(str,start,len){return start<0&&(start=str.length+start),str.substr(start,len)}}).call(this,__webpack_require__(698))},481:function(module,exports,__webpack_require__){"use strict";var legacy=__webpack_require__(1048),invalid=__webpack_require__(1049),decimal=__webpack_require__(385),hexadecimal=__webpack_require__(1050),alphanumerical=__webpack_require__(1051),decodeEntity=__webpack_require__(1052);module.exports=function(value,options){var option,key,settings={};options||(options={});for(key in defaults)option=options[key],settings[key]=null==option?defaults[key]:option;(settings.position.indent||settings.position.start)&&(settings.indent=settings.position.indent||[],settings.position=settings.position.start);return function(value,settings){var entityCharacters,namedEntity,terminated,characters,character,reference,following,warning,reason,output,entity,begin,start,type,test,prev,next,diff,end,additional=settings.additional,nonTerminated=settings.nonTerminated,handleText=settings.text,handleReference=settings.reference,handleWarning=settings.warning,textContext=settings.textContext,referenceContext=settings.referenceContext,warningContext=settings.warningContext,pos=settings.position,indent=settings.indent||[],length=value.length,index=0,lines=-1,column=pos.column||1,line=pos.line||1,queue="",result=[];prev=now(),warning=handleWarning?function(code,offset){var position=now();position.column+=offset,position.offset+=offset,handleWarning.call(warningContext,MESSAGES[code],position,code)}:noop,index--,length++;for(;++index<length;)if("\n"===character&&(column=indent[lines]||1),"&"!==(character=at(index)))"\n"===character&&(line++,lines++,column=0),character?(queue+=character,column++):flush();else{if("\t"===(following=at(index+1))||"\n"===following||"\f"===following||" "===following||"<"===following||"&"===following||""===following||additional&&following===additional){queue+=character,column++;continue}for(begin=start=index+1,end=start,"#"!==following?type="named":(end=++begin,"x"===(following=at(end))||"X"===following?(type="hexadecimal",end=++begin):type="decimal"),entityCharacters="",entity="",characters="",test=TESTS[type],end--;++end<length&&(following=at(end),test(following));)characters+=following,"named"===type&&own.call(legacy,characters)&&(entityCharacters=characters,entity=legacy[characters]);(terminated=";"===at(end))&&(end++,(namedEntity="named"===type&&decodeEntity(characters))&&(entityCharacters=characters,entity=namedEntity)),diff=1+end-start,(terminated||nonTerminated)&&(characters?"named"===type?(terminated&&!entity?warning(5,1):(entityCharacters!==characters&&(end=begin+entityCharacters.length,diff=1+end-begin,terminated=!1),terminated||(reason=entityCharacters?1:3,settings.attribute?"="===(following=at(end))?(warning(reason,diff),entity=null):alphanumerical(following)?entity=null:warning(reason,diff):warning(reason,diff))),reference=entity):(terminated||warning(2,diff),reference=parseInt(characters,BASE[type]),(code=reference)>=55296&&code<=57343||code>1114111?(warning(7,diff),reference="�"):reference in invalid?(warning(6,diff),reference=invalid[reference]):(output="",disallowed(reference)&&warning(6,diff),reference>65535&&(output+=fromCharCode((reference-=65536)>>>10|55296),reference=56320|1023&reference),reference=output+fromCharCode(reference))):"named"!==type&&warning(4,diff)),reference?(flush(),prev=now(),index=end-1,column+=end-start+1,result.push(reference),(next=now()).offset++,handleReference&&handleReference.call(referenceContext,reference,{start:prev,end:next},value.slice(start-1,end)),prev=next):(characters=value.slice(start-1,end),queue+=characters,column+=characters.length,index=end-1)}var code;return result.join("");function now(){return{line:line,column:column,offset:index+(pos.offset||0)}}function at(position){return value.charAt(position)}function flush(){queue&&(result.push(queue),handleText&&handleText.call(textContext,queue,{start:prev,end:now()}),queue="")}}(value,settings)};var own={}.hasOwnProperty,fromCharCode=String.fromCharCode,noop=Function.prototype,defaults={warning:null,reference:null,text:null,warningContext:null,referenceContext:null,textContext:null,position:{},additional:null,attribute:!1,nonTerminated:!0},BASE={hexadecimal:16,decimal:10},TESTS={};TESTS.named=alphanumerical,TESTS.decimal=decimal,TESTS.hexadecimal=hexadecimal;var MESSAGES={};function disallowed(code){return code>=1&&code<=8||11===code||code>=13&&code<=31||code>=127&&code<=159||code>=64976&&code<=65007||65535==(65535&code)||65534==(65535&code)}MESSAGES[1]="Named character references must be terminated by a semicolon",MESSAGES[2]="Numeric character references must be terminated by a semicolon",MESSAGES[3]="Named character references cannot be empty",MESSAGES[4]="Numeric character references cannot be empty",MESSAGES[5]="Named character references must be known",MESSAGES[6]="Numeric character references cannot be disallowed",MESSAGES[7]="Numeric character references cannot be outside the permissible Unicode range"},482:function(module,exports,__webpack_require__){"use strict";
/*!
 * repeat-string <https://github.com/jonschlinkert/repeat-string>
 *
 * Copyright (c) 2014-2015, Jon Schlinkert.
 * Licensed under the MIT License.
 */var cache,res="";module.exports=function(str,num){if("string"!=typeof str)throw new TypeError("expected a string");if(1===num)return str;if(2===num)return str+str;var max=str.length*num;if(cache!==str||void 0===cache)cache=str,res="";else if(res.length>=max)return res.substr(0,max);for(;max>res.length&&num>1;)1&num&&(res+=str),num>>=1,str+=str;return res=(res+=str).substr(0,max)}},483:function(module,exports,__webpack_require__){"use strict";module.exports=function(value){var val=String(value),index=val.length;for(;"\n"===val.charAt(--index););return val.slice(0,index+1)}},484:function(module,exports,__webpack_require__){"use strict";module.exports=function(interruptors,tokenizers,ctx,params){var interruptor,config,fn,offset,bool,ignore,bools=["pedantic","commonmark"],count=bools.length,length=interruptors.length,index=-1;for(;++index<length;){for(interruptor=interruptors[index],config=interruptor[1]||{},fn=interruptor[0],offset=-1,ignore=!1;++offset<count;)if(void 0!==config[bool=bools[offset]]&&config[bool]!==ctx.options[bool]){ignore=!0;break}if(!ignore&&tokenizers[fn].apply(ctx,params))return!0}return!1}},485:function(module,exports,__webpack_require__){"use strict";var collapseWhiteSpace=__webpack_require__(1072);module.exports=function(value){return collapseWhiteSpace(value).toLowerCase()}},491:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return EqlQueryBar}));var external_kbnSharedDeps_React_=__webpack_require__(6),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),external_kbnSharedDeps_StyledComponents_=__webpack_require__(75),external_kbnSharedDeps_StyledComponents_default=__webpack_require__.n(external_kbnSharedDeps_StyledComponents_),external_kbnSharedDeps_ElasticEui_=__webpack_require__(74),use_app_toasts=__webpack_require__(115),translations=__webpack_require__(189),external_kbnSharedDeps_Lodash_=__webpack_require__(80);const ErrorsPopover=({ariaLabel:ariaLabel,errors:errors})=>{const[isOpen,setIsOpen]=Object(external_kbnSharedDeps_React_.useState)(!1),handleToggle=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setIsOpen(!isOpen)},[isOpen]),handleClose=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setIsOpen(!1)},[]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopover,{"data-test-subj":"eql-validation-errors-popover",button:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{"data-test-subj":"eql-validation-errors-popover-button",iconType:"crossInACircleFilled",size:"s",color:"danger","aria-label":ariaLabel,onClick:handleToggle},errors.length),isOpen:isOpen,closePopover:handleClose,anchorPosition:"downCenter"},external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":"eql-validation-errors-popover-content"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopoverTitle,null,translations.k),errors.map((message,idx)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{key:idx},message))))};var kibana=__webpack_require__(109);const InlineText=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiText).withConfig({displayName:"InlineText",componentId:"i91hzt-0"})(["display:inline-block;"]),EqlOverviewLink=()=>{const overviewUrl=Object(kibana.h)().services.docLinks.links.query.eql;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{external:!0,href:overviewUrl,target:"_blank"},external_kbnSharedDeps_React_default.a.createElement(InlineText,{size:"xs"},translations.i))},Container=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiPanel).withConfig({displayName:"Container",componentId:"sc-10yczbx-0"})(["border-radius:0;background:",";padding:"," ",";"],({theme:theme})=>theme.eui.euiPageBackgroundColor,({theme:theme})=>theme.eui.euiSizeXS,({theme:theme})=>theme.eui.euiSizeS),FlexGroup=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup).withConfig({displayName:"FlexGroup",componentId:"sc-10yczbx-1"})(["min-height:",";"],({theme:theme})=>theme.eui.euiSizeXL),FlexItemLeftBorder=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexItem).withConfig({displayName:"FlexItemLeftBorder",componentId:"sc-10yczbx-2"})(["border-left:1px solid ",";"],({theme:theme})=>theme.eui.euiColorLightShade),FlexItemWithMarginRight=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexItem).withConfig({displayName:"FlexItemWithMarginRight",componentId:"sc-10yczbx-3"})(["margin-right:",";"],({theme:theme})=>theme.eui.euiSizeS),Spinner=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiLoadingSpinner).withConfig({displayName:"Spinner",componentId:"sc-10yczbx-4"})(["margin:0 ",";"],({theme:theme})=>theme.eui.euiSizeS),singleSelection={asPlainText:!0},EqlQueryBarFooter=({errors:errors,isLoading:isLoading,optionsData:optionsData,optionsSelected:optionsSelected,onOptionsChange:onOptionsChange})=>{var _optionsSelected$size;const[openEqlSettings,setIsOpenEqlSettings]=Object(external_kbnSharedDeps_React_.useState)(!1),[localSize,setLocalSize]=Object(external_kbnSharedDeps_React_.useState)(null!==(_optionsSelected$size=null==optionsSelected?void 0:optionsSelected.size)&&void 0!==_optionsSelected$size?_optionsSelected$size:100),debounceSize=Object(external_kbnSharedDeps_React_.useRef)(),openEqlSettingsHandler=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setIsOpenEqlSettings(!0)},[]),closeEqlSettingsHandler=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setIsOpenEqlSettings(!1)},[]),handleEventCategoryField=Object(external_kbnSharedDeps_React_.useCallback)(opt=>{onOptionsChange&&(opt.length>0?onOptionsChange("eventCategoryField",opt[0].label):onOptionsChange("eventCategoryField",null))},[onOptionsChange]),handleTiebreakerField=Object(external_kbnSharedDeps_React_.useCallback)(opt=>{onOptionsChange&&(opt.length>0?onOptionsChange("tiebreakerField",opt[0].label):onOptionsChange("tiebreakerField",null))},[onOptionsChange]),handleTimestampField=Object(external_kbnSharedDeps_React_.useCallback)(opt=>{onOptionsChange&&(opt.length>0?onOptionsChange("timestampField",opt[0].label):onOptionsChange("timestampField",null))},[onOptionsChange]),handleSizeField=Object(external_kbnSharedDeps_React_.useCallback)(evt=>{if(onOptionsChange){var _evt$target,_debounceSize$current,_evt$target2,_debounceSize$current2;if(setLocalSize(null==evt||null===(_evt$target=evt.target)||void 0===_evt$target?void 0:_evt$target.value),null!==(_debounceSize$current=debounceSize.current)&&void 0!==_debounceSize$current&&_debounceSize$current.cancel)null===(_debounceSize$current2=debounceSize.current)||void 0===_debounceSize$current2||_debounceSize$current2.cancel();debounceSize.current=Object(external_kbnSharedDeps_Lodash_.debounce)(newSize=>onOptionsChange("size",newSize),800),debounceSize.current(null==evt||null===(_evt$target2=evt.target)||void 0===_evt$target2?void 0:_evt$target2.value)}},[onOptionsChange]),eventCategoryField=Object(external_kbnSharedDeps_React_.useMemo)(()=>null!=(null==optionsSelected?void 0:optionsSelected.eventCategoryField)?[{label:null==optionsSelected?void 0:optionsSelected.eventCategoryField}]:void 0,[null==optionsSelected?void 0:optionsSelected.eventCategoryField]),tiebreakerField=Object(external_kbnSharedDeps_React_.useMemo)(()=>null!=(null==optionsSelected?void 0:optionsSelected.tiebreakerField)?[{label:null==optionsSelected?void 0:optionsSelected.tiebreakerField}]:void 0,[null==optionsSelected?void 0:optionsSelected.tiebreakerField]),timestampField=Object(external_kbnSharedDeps_React_.useMemo)(()=>null!=(null==optionsSelected?void 0:optionsSelected.timestampField)?[{label:null==optionsSelected?void 0:optionsSelected.timestampField}]:void 0,[null==optionsSelected?void 0:optionsSelected.timestampField]);return external_kbnSharedDeps_React_default.a.createElement(Container,null,external_kbnSharedDeps_React_default.a.createElement(FlexGroup,{alignItems:"center",justifyContent:"spaceBetween",gutterSize:"none"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,errors.length>0&&external_kbnSharedDeps_React_default.a.createElement(ErrorsPopover,{ariaLabel:translations.l,errors:errors}),isLoading&&external_kbnSharedDeps_React_default.a.createElement(Spinner,{"data-test-subj":"eql-validation-loading",size:"m"})),!onOptionsChange&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(EqlOverviewLink,null)),onOptionsChange&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(FlexItemWithMarginRight,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(EqlOverviewLink,null)),external_kbnSharedDeps_React_default.a.createElement(FlexItemLeftBorder,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopover,{button:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{onClick:openEqlSettingsHandler,iconType:"controlsVertical",isDisabled:openEqlSettings,"aria-label":"eql settings","data-test-subj":"eql-settings-trigger"}),isOpen:openEqlSettings,closePopover:closeEqlSettingsHandler,anchorPosition:"downCenter",ownFocus:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopoverTitle,null,translations.j),external_kbnSharedDeps_React_default.a.createElement("div",{style:{width:"300px"}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:translations.h,helpText:translations.g},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldNumber,{value:localSize,onChange:handleSizeField,min:1,max:1e4})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:translations.b,helpText:translations.a},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiComboBox,{options:null==optionsData?void 0:optionsData.keywordFields,selectedOptions:eventCategoryField,singleSelection:singleSelection,onChange:handleEventCategoryField})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:translations.d,helpText:translations.c},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiComboBox,{options:null==optionsData?void 0:optionsData.nonDateFields,selectedOptions:tiebreakerField,singleSelection:singleSelection,onChange:handleTiebreakerField})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:translations.f,helpText:translations.e},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiComboBox,{options:null==optionsData?void 0:optionsData.dateFields,selectedOptions:timestampField,singleSelection:singleSelection,onChange:handleTimestampField}))))))))};var validators=__webpack_require__(324);const TextArea=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiTextArea).withConfig({displayName:"TextArea",componentId:"sc-4u43ce-0"})(["display:block;border:",";border-bottom:0;box-shadow:none;min-height:",";"],({theme:theme})=>theme.eui.euiBorderThin,({theme:theme})=>theme.eui.euiFormControlHeight),EqlQueryBar=({dataTestSubj:dataTestSubj,field:field,idAria:idAria,optionsData:optionsData,optionsSelected:optionsSelected,onOptionsChange:onOptionsChange,onValidityChange:onValidityChange,onValiditingChange:onValiditingChange})=>{const{addError:addError}=Object(use_app_toasts.a)(),[errorMessages,setErrorMessages]=Object(external_kbnSharedDeps_React_.useState)([]),{isValidating:isValidating,setValue:setValue}=field,{isValid:isValid,message:message,messages:messages,error:error}=Object(validators.c)(field),fieldValue=field.value.query.query;Object(external_kbnSharedDeps_React_.useEffect)(()=>{null!=onValidityChange&&onValidityChange(isValid)},[isValid,onValidityChange]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{setErrorMessages(null!=messages?messages:[])},[messages]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{error&&addError(error,{title:translations.m})},[error,addError]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{onValiditingChange&&onValiditingChange(isValidating)},[isValidating,onValiditingChange]);const handleChange=Object(external_kbnSharedDeps_React_.useCallback)(e=>{const newQuery=e.target.value;onValiditingChange&&onValiditingChange(!0),setErrorMessages([]),setValue({filters:[],query:{query:newQuery,language:"eql"}})},[setValue,onValiditingChange]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:field.label,labelAppend:field.labelAppend,helpText:field.helpText,error:message,isInvalid:!isValid&&!isValidating,fullWidth:!0,"data-test-subj":dataTestSubj,describedByIds:idAria?[idAria]:void 0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(TextArea,{"data-test-subj":"eqlQueryBarTextInput",fullWidth:!0,isInvalid:!isValid&&!isValidating,value:fieldValue,onChange:handleChange}),external_kbnSharedDeps_React_default.a.createElement(EqlQueryBarFooter,{errors:errorMessages,isLoading:isValidating,optionsData:optionsData,optionsSelected:optionsSelected,onOptionsChange:onOptionsChange})))}},698:function(module,exports){var cachedSetTimeout,cachedClearTimeout,process=module.exports={};function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}function runTimeout(fun){if(cachedSetTimeout===setTimeout)return setTimeout(fun,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(fun,0);try{return cachedSetTimeout(fun,0)}catch(e){try{return cachedSetTimeout.call(null,fun,0)}catch(e){return cachedSetTimeout.call(this,fun,0)}}}!function(){try{cachedSetTimeout="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){cachedSetTimeout=defaultSetTimout}try{cachedClearTimeout="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){cachedClearTimeout=defaultClearTimeout}}();var currentQueue,queue=[],draining=!1,queueIndex=-1;function cleanUpNextTick(){draining&&currentQueue&&(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var timeout=runTimeout(cleanUpNextTick);draining=!0;for(var len=queue.length;len;){for(currentQueue=queue,queue=[];++queueIndex<len;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,len=queue.length}currentQueue=null,draining=!1,function(marker){if(cachedClearTimeout===clearTimeout)return clearTimeout(marker);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(marker);try{cachedClearTimeout(marker)}catch(e){try{return cachedClearTimeout.call(null,marker)}catch(e){return cachedClearTimeout.call(this,marker)}}}(timeout)}}function Item(fun,array){this.fun=fun,this.array=array}function noop(){}process.nextTick=function(fun){var args=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)args[i-1]=arguments[i];queue.push(new Item(fun,args)),1!==queue.length||draining||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.prependListener=noop,process.prependOnceListener=noop,process.listeners=function(name){return[]},process.binding=function(name){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(dir){throw new Error("process.chdir is not supported")},process.umask=function(){return 0}},699:function(module,exports,__webpack_require__){"use strict";module.exports=function(character){var code="string"==typeof character?character.charCodeAt(0):character;return code>=97&&code<=122||code>=65&&code<=90}},700:function(module,exports,__webpack_require__){"use strict";module.exports={position:!0,gfm:!0,commonmark:!1,footnotes:!1,pedantic:!1,blocks:__webpack_require__(1056)}},701:function(module,exports,__webpack_require__){"use strict";module.exports=function(value){var size,index=0,indent=0,character=value.charAt(index),stops={};for(;character in characters;)indent+=size=characters[character],size>1&&(indent=Math.floor(indent/size)*size),stops[indent]=index,character=value.charAt(++index);return{indent:indent,stops:stops}};var characters={" ":1,"\t":4}},702:function(module,exports,__webpack_require__){"use strict";var openTag="<[A-Za-z][A-Za-z0-9\\-]*(?:\\s+[a-zA-Z_:][a-zA-Z0-9:._-]*(?:\\s*=\\s*(?:[^\"'=<>`\\u0000-\\u0020]+|'[^']*'|\"[^\"]*\"))?)*\\s*\\/?>",closeTag="<\\/[A-Za-z][A-Za-z0-9\\-]*\\s*>";exports.openCloseTag=new RegExp("^(?:"+openTag+"|"+closeTag+")"),exports.tag=new RegExp("^(?:"+openTag+"|"+closeTag+"|\x3c!----\x3e|\x3c!--(?:-?[^>-])(?:-?[^-])*--\x3e|<[?].*?[?]>|<![A-Za-z]+\\s+[^>]*>|<!\\[CDATA\\[[\\s\\S]*?\\]\\]>)")},703:function(module,exports,__webpack_require__){"use strict";module.exports=function(value,fromIndex){return value.indexOf("<",fromIndex)}},704:function(module,exports,__webpack_require__){"use strict";module.exports=function(value,fromIndex){var link=value.indexOf("[",fromIndex),image=value.indexOf("![",fromIndex);if(-1===image)return link;return link<image?link:image}},705:function(module,exports){},706:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return CallOutPersistentSwitcher}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(6),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),_callout__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(394);const CallOutPersistentSwitcherComponent=({condition:condition,message:message})=>condition?react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_callout__WEBPACK_IMPORTED_MODULE_1__.a,{message:message,showDismissButton:!1}):null,CallOutPersistentSwitcher=Object(react__WEBPACK_IMPORTED_MODULE_0__.memo)(CallOutPersistentSwitcherComponent)},760:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return CallOutSwitcher}));var external_kbnSharedDeps_React_=__webpack_require__(6),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),callout=__webpack_require__(394),external_kbnSharedDeps_LodashFp_=__webpack_require__(7),useEffectOnce=__webpack_require__(1108),useEffectOnce_default=__webpack_require__.n(useEffectOnce),useMap=__webpack_require__(1107),useMap_default=__webpack_require__.n(useMap),use_messages_storage=__webpack_require__(475);const getDismissedMessagesStorageKey=namespace=>`kibana.securitySolution.${namespace}.callouts.dismissed`,createInitialVisibilityState=messages=>createVisibilityState(messages.map(m=>m.id),!1),createVisibilityState=(messageIds,isVisible)=>mapToObject(messageIds,external_kbnSharedDeps_LodashFp_.identity,()=>isVisible),mapToObject=(array,getKey,getValue)=>{const kvPairs=array.map(el=>[getKey(el),getValue(el)]);return Object(external_kbnSharedDeps_LodashFp_.fromPairs)(kvPairs)},CallOutSwitcherComponent=({namespace:namespace,condition:condition,message:message})=>{const{isVisible:isVisible,dismiss:dismiss}=((messages,namespace="common")=>{const{getMessages:getMessages,addMessage:addMessage}=Object(use_messages_storage.a)(),visibilityStateInitial=Object(external_kbnSharedDeps_React_.useMemo)(()=>createInitialVisibilityState(messages),[messages]),[visibilityState,setVisibilityState]=useMap_default()(visibilityStateInitial),dismissedMessagesKey=getDismissedMessagesStorageKey(namespace),getVisibleMessageIds=Object(external_kbnSharedDeps_React_.useCallback)(()=>Object.entries(visibilityState).filter(([messageId,isVisible])=>isVisible).map(([messageId,isVisible])=>messageId),[visibilityState]),isVisible=Object(external_kbnSharedDeps_React_.useCallback)(message=>{var _visibilityState$mess;return null!==(_visibilityState$mess=visibilityState[message.id])&&void 0!==_visibilityState$mess&&_visibilityState$mess},[visibilityState]),dismiss=Object(external_kbnSharedDeps_React_.useCallback)(message=>{const{id:id,type:type}=message;setVisibilityState.set(id,!1),"primary"!==type&&"success"!==type||addMessage(dismissedMessagesKey,id)},[setVisibilityState,addMessage,dismissedMessagesKey]);return useEffectOnce_default()(()=>{const idsAll=Object.keys(visibilityState),idsDismissed=getMessages(dismissedMessagesKey),idsToMakeVisible=Object(external_kbnSharedDeps_LodashFp_.difference)(idsAll)(idsDismissed);setVisibilityState.setAll({...createVisibilityState(idsToMakeVisible,!0),...createVisibilityState(idsDismissed,!1)})}),{getVisibleMessageIds:getVisibleMessageIds,isVisible:isVisible,dismiss:dismiss}})([message],namespace);return condition&&isVisible(message)?external_kbnSharedDeps_React_default.a.createElement(callout.a,{message:message,onDismiss:dismiss}):null},CallOutSwitcher=Object(external_kbnSharedDeps_React_.memo)(CallOutSwitcherComponent)}}]);