/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[19],{1126:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"EqlTabContentComponent",(function(){return EqlTabContentComponent})),__webpack_require__.d(__webpack_exports__,"default",(function(){return EqlTabContent}));var external_kbnSharedDeps_ElasticEui_=__webpack_require__(74),external_kbnSharedDeps_LodashFp_=__webpack_require__(7),external_kbnSharedDeps_React_=__webpack_require__(6),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),external_kbnSharedDeps_StyledComponents_=__webpack_require__(75),external_kbnSharedDeps_StyledComponents_default=__webpack_require__.n(external_kbnSharedDeps_StyledComponents_),lib=__webpack_require__(110),fast_deep_equal=__webpack_require__(112),fast_deep_equal_default=__webpack_require__.n(fast_deep_equal),web=__webpack_require__(232),store_timeline=__webpack_require__(113),containers=__webpack_require__(395),default_headers=__webpack_require__(152),body=__webpack_require__(389),footer=__webpack_require__(399),helpers=__webpack_require__(126),refetch_timeline=__webpack_require__(468),manage_timeline=__webpack_require__(157),types_timeline=__webpack_require__(111),default_config=__webpack_require__(207),exit_full_screen=__webpack_require__(312),super_date_picker=__webpack_require__(244),event_details_width_context=__webpack_require__(276),pick_events=__webpack_require__(511),store=__webpack_require__(129),sourcerer=__webpack_require__(144),model=__webpack_require__(124),defaults=__webpack_require__(125),containers_sourcerer=__webpack_require__(130),use_timeline_events_count=__webpack_require__(377),date_picker_lock=__webpack_require__(512),use_full_screen=__webpack_require__(146),active_timeline_context=__webpack_require__(223),side_panel=__webpack_require__(283),external_kbnSharedDeps_Lodash_=__webpack_require__(80),use_selector=__webpack_require__(114),eql_query_bar=__webpack_require__(491),validators=__webpack_require__(324),shared_imports=__webpack_require__(117);const EQL_QUERY_BAR_LABEL=__webpack_require__(1).i18n.translate("xpack.securitySolution.timeline.EqlQueryBarLabel",{defaultMessage:"EQL query"});var reselect_lib=__webpack_require__(128),selectors=__webpack_require__(288);const defaultValues={index:[],eqlQueryBar:{query:{query:"",language:"eql"},filters:[],saved_id:void 0}},schema={index:{fieldsToValidateOnChange:["index","eqlQueryBar"],validations:[]},eqlQueryBar:{validations:[{validator:Object(validators.a)(validators.b,300)}]}},HiddenUseField=external_kbnSharedDeps_StyledComponents_default()(shared_imports.k).withConfig({displayName:"HiddenUseField",componentId:"fj97qw-0"})(["display:none;"]),EqlQueryBarTimeline=Object(external_kbnSharedDeps_React_.memo)(({timelineId:timelineId})=>{var _optionsSelected$quer;const dispatch=Object(lib.useDispatch)(),isInit=Object(external_kbnSharedDeps_React_.useRef)(!0),[isQueryBarValid,setIsQueryBarValid]=Object(external_kbnSharedDeps_React_.useState)(!1),[isQueryBarValidating,setIsQueryBarValidating]=Object(external_kbnSharedDeps_React_.useState)(!1),getOptionsSelected=Object(external_kbnSharedDeps_React_.useMemo)(()=>Object(reselect_lib.createSelector)(selectors.selectTimeline,timeline=>{var _timeline$eqlOptions;return null!==(_timeline$eqlOptions=null==timeline?void 0:timeline.eqlOptions)&&void 0!==_timeline$eqlOptions?_timeline$eqlOptions:{eventCategoryField:[{label:"event.category"}],tiebreakerField:[{label:""}],timestampField:[{label:"@timestamp"}],size:100,query:""}}),[]),optionsSelected=Object(use_selector.a)(state=>getOptionsSelected(state,timelineId)),{loading:indexPatternsLoading,indexPattern:indexPattern,selectedPatterns:selectedPatterns}=Object(containers_sourcerer.b)(model.SourcererScopeName.timeline),initialState={...defaultValues,index:selectedPatterns.sort(),eqlQueryBar:{...defaultValues.eqlQueryBar,query:{query:null!==(_optionsSelected$quer=optionsSelected.query)&&void 0!==_optionsSelected$quer?_optionsSelected$quer:"",language:"eql"}}},{form:form}=Object(shared_imports.I)({defaultValue:initialState,options:{stripEmptyFields:!1},schema:schema}),{getFields:getFields}=form,onOptionsChange=Object(external_kbnSharedDeps_React_.useCallback)((field,value)=>dispatch(store_timeline.a.updateEqlOptions({id:timelineId,field:field,value:value})),[dispatch,timelineId]),[{eqlQueryBar:formEqlQueryBar}]=Object(shared_imports.K)({form:form,watch:["eqlQueryBar"]}),optionsData=Object(external_kbnSharedDeps_React_.useMemo)(()=>Object(external_kbnSharedDeps_Lodash_.isEmpty)(indexPattern.fields)?{keywordFields:[],dateFields:[],nonDateFields:[]}:{keywordFields:indexPattern.fields.filter(f=>{var _f$esTypes;return null===(_f$esTypes=f.esTypes)||void 0===_f$esTypes?void 0:_f$esTypes.includes("keyword")}).map(f=>({label:f.name})),dateFields:indexPattern.fields.filter(f=>"date"===f.type).map(f=>({label:f.name})),nonDateFields:indexPattern.fields.filter(f=>"date"!==f.type).map(f=>({label:f.name}))},[indexPattern]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{const{index:indexField}=getFields(),newIndexValue=selectedPatterns.sort(),indexFieldValue=indexField.value.sort();Object(external_kbnSharedDeps_Lodash_.isEqual)(indexFieldValue,newIndexValue)||indexField.setValue(newIndexValue)},[getFields,selectedPatterns]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{const{eqlQueryBar:eqlQueryBar}=getFields();var _optionsSelected$quer2;isInit.current&&(isInit.current=!1,setIsQueryBarValidating(!0),eqlQueryBar.setValue({...defaultValues.eqlQueryBar,query:{query:null!==(_optionsSelected$quer2=optionsSelected.query)&&void 0!==_optionsSelected$quer2?_optionsSelected$quer2:"",language:"eql"}}));return()=>{isInit.current=!0}},[getFields,optionsSelected.query]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{null==formEqlQueryBar||Object(external_kbnSharedDeps_Lodash_.isEmpty)(formEqlQueryBar.query.query)||!isQueryBarValid||isQueryBarValidating||(dispatch(store_timeline.a.updateEqlOptions({id:timelineId,field:"query",value:""+formEqlQueryBar.query.query})),setIsQueryBarValid(!1),setIsQueryBarValidating(!1))},[dispatch,formEqlQueryBar,isQueryBarValid,isQueryBarValidating,timelineId]),external_kbnSharedDeps_React_default.a.createElement(shared_imports.f,{form:form,"data-test-subj":"EqlQueryBarTimeline"},external_kbnSharedDeps_React_default.a.createElement(HiddenUseField,{key:"Index",path:"index"}),external_kbnSharedDeps_React_default.a.createElement(shared_imports.k,{key:"EqlQueryBar",path:"eqlQueryBar",component:eql_query_bar.a,componentProps:{optionsData:optionsData,optionsSelected:optionsSelected,onOptionsChange:onOptionsChange,onValidityChange:setIsQueryBarValid,onValiditingChange:setIsQueryBarValidating,idAria:"timelineEqlQueryBar",isDisabled:indexPatternsLoading,isLoading:indexPatternsLoading,dataTestSubj:"timelineEqlQueryBar"},config:{...schema.eqlQueryBar,label:EQL_QUERY_BAR_LABEL}}))}),TimelineHeaderContainer=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"TimelineHeaderContainer",componentId:"sc-1f3fsnr-0"})(["margin-top:6px;width:100%;"]);TimelineHeaderContainer.displayName="TimelineHeaderContainer";const StyledEuiFlyoutHeader=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlyoutHeader).withConfig({displayName:"StyledEuiFlyoutHeader",componentId:"sc-1f3fsnr-1"})(["align-items:stretch;box-shadow:none;display:flex;flex-direction:column;padding:0;&.euiFlyoutHeader{","}"],({theme:theme})=>`padding: 0 ${theme.eui.euiSizeS} ${theme.eui.euiSizeS} ${theme.eui.euiSizeS};`),StyledEuiFlyoutBody=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlyoutBody).withConfig({displayName:"StyledEuiFlyoutBody",componentId:"sc-1f3fsnr-2"})(["overflow-y:hidden;flex:1;.euiFlyoutBody__overflow{overflow:hidden;mask-image:none;}.euiFlyoutBody__overflowContent{padding:0;height:100%;display:flex;}"]),StyledEuiFlyoutFooter=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlyoutFooter).withConfig({displayName:"StyledEuiFlyoutFooter",componentId:"sc-1f3fsnr-3"})(["background:none;padding:0;&.euiFlyoutFooter{","}"],({theme:theme})=>`padding: ${theme.eui.euiSizeS} 0 0 0;`),FullWidthFlexGroup=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup).withConfig({displayName:"FullWidthFlexGroup",componentId:"sc-1f3fsnr-4"})(["margin:0;width:100%;overflow:hidden;"]),ScrollableFlexItem=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexItem).withConfig({displayName:"ScrollableFlexItem",componentId:"sc-1f3fsnr-5"})(["overflow:hidden;"]),DatePicker=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexItem).withConfig({displayName:"DatePicker",componentId:"sc-1f3fsnr-6"})([".euiSuperDatePicker__flexWrapper{max-width:none;width:auto;}"]);DatePicker.displayName="DatePicker";const VerticalRule=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"VerticalRule",componentId:"sc-1f3fsnr-7"})(["width:2px;height:100%;background:",";"],({theme:theme})=>theme.eui.euiColorLightShade);VerticalRule.displayName="VerticalRule";const EventsCountBadge=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiBadge).withConfig({displayName:"EventsCountBadge",componentId:"sc-1f3fsnr-8"})(["margin-left:",";"],({theme:theme})=>theme.eui.paddingSizes.s),EMPTY_EVENTS=[],NO_SORTING=[],EqlTabContentComponent=({activeTab:activeTab,columns:columns,end:end,eqlOptions:eqlOptions,eventType:eventType,expandedDetail:expandedDetail,timelineId:timelineId,isLive:isLive,itemsPerPage:itemsPerPage,itemsPerPageOptions:itemsPerPageOptions,onEventClosed:onEventClosed,renderCellValue:renderCellValue,rowRenderers:rowRenderers,showExpandedDetails:showExpandedDetails,start:start,timerangeKind:timerangeKind,updateEventTypeAndIndexesName:updateEventTypeAndIndexesName})=>{var _pageInfo$activePage;const{query:eqlQuery="",...restEqlOption}=eqlOptions,{portalNode:eqlEventsCountPortalNode}=Object(use_timeline_events_count.c)(),{setTimelineFullScreen:setTimelineFullScreen,timelineFullScreen:timelineFullScreen}=Object(use_full_screen.b)(),{browserFields:browserFields,docValueFields:docValueFields,loading:loadingSourcerer,selectedPatterns:selectedPatterns}=Object(containers_sourcerer.b)(model.SourcererScopeName.timeline),isBlankTimeline=Object(external_kbnSharedDeps_LodashFp_.isEmpty)(eqlQuery),{initializeTimeline:initializeTimeline,setIsTimelineLoading:setIsTimelineLoading}=Object(manage_timeline.b)();Object(external_kbnSharedDeps_React_.useEffect)(()=>{initializeTimeline({id:timelineId})},[initializeTimeline,timelineId]);const[isQueryLoading,{events:events,inspect:inspect,totalCount:totalCount,pageInfo:pageInfo,loadPage:loadPage,updatedAt:updatedAt,refetch:refetch}]=Object(containers.a)({docValueFields:docValueFields,endDate:end,eqlOptions:restEqlOption,id:timelineId,indexNames:selectedPatterns,fields:[...(Object(external_kbnSharedDeps_LodashFp_.isEmpty)(columns)?default_headers.c:columns).map(c=>c.id),...default_config.g],language:"eql",limit:itemsPerPage,filterQuery:null!=eqlQuery?eqlQuery:"",startDate:start,skip:!!(null==loadingSourcerer||loadingSourcerer||Object(external_kbnSharedDeps_LodashFp_.isEmpty)(start)||Object(external_kbnSharedDeps_LodashFp_.isEmpty)(end)||isBlankTimeline),timerangeKind:timerangeKind}),handleOnPanelClosed=Object(external_kbnSharedDeps_React_.useCallback)(()=>{var _expandedDetail$Timel;onEventClosed({tabType:types_timeline.j.eql,timelineId:timelineId}),null!==(_expandedDetail$Timel=expandedDetail[types_timeline.j.eql])&&void 0!==_expandedDetail$Timel&&_expandedDetail$Timel.panelView&&timelineId===types_timeline.g.active&&showExpandedDetails&&active_timeline_context.a.toggleExpandedDetail({})},[onEventClosed,timelineId,expandedDetail,showExpandedDetails]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{setIsTimelineLoading({id:timelineId,isLoading:isQueryLoading||loadingSourcerer})},[loadingSourcerer,timelineId,isQueryLoading,setIsTimelineLoading]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(web.a,{node:eqlEventsCountPortalNode},totalCount>=0?external_kbnSharedDeps_React_default.a.createElement(EventsCountBadge,null,totalCount):null),external_kbnSharedDeps_React_default.a.createElement(refetch_timeline.a,{id:`${timelineId}-${types_timeline.j.eql}`,inputId:"timeline",inspect:inspect,loading:isQueryLoading,refetch:refetch}),external_kbnSharedDeps_React_default.a.createElement(FullWidthFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(ScrollableFlexItem,{grow:2},external_kbnSharedDeps_React_default.a.createElement(StyledEuiFlyoutHeader,{"data-test-subj":activeTab+"-tab-flyout-header",hasBorder:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",gutterSize:"s","data-test-subj":"timeline-date-picker-container"},timelineFullScreen&&null!=setTimelineFullScreen&&external_kbnSharedDeps_React_default.a.createElement(exit_full_screen.b,{fullScreen:timelineFullScreen,setFullScreen:setTimelineFullScreen}),external_kbnSharedDeps_React_default.a.createElement(DatePicker,{grow:1},external_kbnSharedDeps_React_default.a.createElement(super_date_picker.a,{id:"timeline",timelineId:timelineId})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(date_picker_lock.a,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(pick_events.a,{eventType:eventType,onChangeEventTypeAndIndexesName:updateEventTypeAndIndexesName}))),external_kbnSharedDeps_React_default.a.createElement(TimelineHeaderContainer,{"data-test-subj":"timelineHeader"},external_kbnSharedDeps_React_default.a.createElement(EqlQueryBarTimeline,{timelineId:timelineId}))),external_kbnSharedDeps_React_default.a.createElement(event_details_width_context.a,null,external_kbnSharedDeps_React_default.a.createElement(StyledEuiFlyoutBody,{"data-test-subj":types_timeline.j.eql+"-tab-flyout-body",className:"timeline-flyout-body"},external_kbnSharedDeps_React_default.a.createElement(body.a,{activePage:pageInfo.activePage,browserFields:browserFields,data:isBlankTimeline?EMPTY_EVENTS:events,id:timelineId,refetch:refetch,renderCellValue:renderCellValue,rowRenderers:rowRenderers,sort:NO_SORTING,tabType:types_timeline.j.eql,totalPages:Object(helpers.j)({itemsCount:totalCount,itemsPerPage:itemsPerPage})})),external_kbnSharedDeps_React_default.a.createElement(StyledEuiFlyoutFooter,{"data-test-subj":types_timeline.j.eql+"-tab-flyout-footer",className:"timeline-flyout-footer"},!isBlankTimeline&&external_kbnSharedDeps_React_default.a.createElement(footer.a,{activePage:null!==(_pageInfo$activePage=null==pageInfo?void 0:pageInfo.activePage)&&void 0!==_pageInfo$activePage?_pageInfo$activePage:0,"data-test-subj":"timeline-footer",updatedAt:updatedAt,height:footer.b,id:timelineId,isLive:isLive,isLoading:isQueryLoading||loadingSourcerer,itemsCount:isBlankTimeline?0:events.length,itemsPerPage:itemsPerPage,itemsPerPageOptions:itemsPerPageOptions,onChangePage:loadPage,totalCount:isBlankTimeline?0:totalCount})))),showExpandedDetails&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(VerticalRule,null),external_kbnSharedDeps_React_default.a.createElement(ScrollableFlexItem,{grow:1},external_kbnSharedDeps_React_default.a.createElement(side_panel.a,{browserFields:browserFields,docValueFields:docValueFields,tabType:types_timeline.j.eql,timelineId:timelineId,handleOnPanelClosed:handleOnPanelClosed})))))},EqlTabContent=Object(lib.connect)(()=>{const getTimeline=store_timeline.b.getTimelineByIdSelector(),getInputsTimeline=store.inputsSelectors.getTimelineSelector();return(state,{timelineId:timelineId})=>{var _getTimeline,_expandedDetail$Timel2;const timeline=null!==(_getTimeline=getTimeline(state,timelineId))&&void 0!==_getTimeline?_getTimeline:defaults.a,input=getInputsTimeline(state),{activeTab:activeTab,columns:columns,eqlOptions:eqlOptions,eventType:eventType,expandedDetail:expandedDetail,itemsPerPage:itemsPerPage,itemsPerPageOptions:itemsPerPageOptions}=timeline;return{activeTab:activeTab,columns:columns,eqlOptions:eqlOptions,eventType:null!=eventType?eventType:"raw",end:input.timerange.to,expandedDetail:expandedDetail,timelineId:timelineId,isLive:"interval"===input.policy.kind,itemsPerPage:itemsPerPage,itemsPerPageOptions:itemsPerPageOptions,showExpandedDetails:!!expandedDetail[types_timeline.j.eql]&&!(null===(_expandedDetail$Timel2=expandedDetail[types_timeline.j.eql])||void 0===_expandedDetail$Timel2||!_expandedDetail$Timel2.panelView),start:input.timerange.from,timerangeKind:input.timerange.kind}}},(dispatch,{timelineId:timelineId})=>({updateEventTypeAndIndexesName:(newEventType,newIndexNames)=>{dispatch(store_timeline.a.updateEventType({id:timelineId,eventType:newEventType})),dispatch(store_timeline.a.updateIndexNames({id:timelineId,indexNames:newIndexNames})),dispatch(sourcerer.a.setSelectedIndexPatterns({id:model.SourcererScopeName.timeline,selectedPatterns:newIndexNames}))},onEventClosed:args=>{dispatch(store_timeline.a.toggleDetailPanel(args))}}))(external_kbnSharedDeps_React_default.a.memo(EqlTabContentComponent,(prevProps,nextProps)=>prevProps.activeTab===nextProps.activeTab&&((prevProps,nextProps)=>prevProps.end===nextProps.end&&prevProps.start===nextProps.start&&prevProps.timerangeKind===nextProps.timerangeKind)(prevProps,nextProps)&&fast_deep_equal_default()(prevProps.eqlOptions,nextProps.eqlOptions)&&prevProps.eventType===nextProps.eventType&&prevProps.isLive===nextProps.isLive&&prevProps.itemsPerPage===nextProps.itemsPerPage&&prevProps.onEventClosed===nextProps.onEventClosed&&prevProps.showExpandedDetails===nextProps.showExpandedDetails&&prevProps.timelineId===nextProps.timelineId&&prevProps.updateEventTypeAndIndexesName===nextProps.updateEventTypeAndIndexesName&&fast_deep_equal_default()(prevProps.columns,nextProps.columns)&&fast_deep_equal_default()(prevProps.itemsPerPageOptions,nextProps.itemsPerPageOptions)))},189:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"m",(function(){return EQL_VALIDATION_REQUEST_ERROR})),__webpack_require__.d(__webpack_exports__,"k",(function(){return EQL_VALIDATION_ERRORS_TITLE})),__webpack_require__.d(__webpack_exports__,"l",(function(){return EQL_VALIDATION_ERROR_POPOVER_LABEL})),__webpack_require__.d(__webpack_exports__,"i",(function(){return EQL_OVERVIEW_LINK_TEXT})),__webpack_require__.d(__webpack_exports__,"j",(function(){return EQL_SETTINGS_TITLE})),__webpack_require__.d(__webpack_exports__,"h",(function(){return EQL_OPTIONS_SIZE_LABEL})),__webpack_require__.d(__webpack_exports__,"g",(function(){return EQL_OPTIONS_SIZE_HELPER})),__webpack_require__.d(__webpack_exports__,"b",(function(){return EQL_OPTIONS_EVENT_CATEGORY_FIELD_LABEL})),__webpack_require__.d(__webpack_exports__,"a",(function(){return EQL_OPTIONS_EVENT_CATEGORY_FIELD_HELPER})),__webpack_require__.d(__webpack_exports__,"d",(function(){return EQL_OPTIONS_EVENT_TIEBREAKER_FIELD_LABEL})),__webpack_require__.d(__webpack_exports__,"c",(function(){return EQL_OPTIONS_EVENT_TIEBREAKER_FIELD_HELPER})),__webpack_require__.d(__webpack_exports__,"f",(function(){return EQL_OPTIONS_EVENT_TIMESTAMP_FIELD_LABEL})),__webpack_require__.d(__webpack_exports__,"e",(function(){return EQL_OPTIONS_EVENT_TIMESTAMP_FIELD_HELPER}));var _kbn_i18n__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1);const EQL_VALIDATION_REQUEST_ERROR=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.detectionEngine.eqlValidation.requestError",{defaultMessage:"An error occurred while validating your EQL query"}),EQL_VALIDATION_ERRORS_TITLE=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.detectionEngine.eqlValidation.title",{defaultMessage:"EQL Validation Errors"}),EQL_VALIDATION_ERROR_POPOVER_LABEL=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.detectionEngine.eqlValidation.showErrorsLabel",{defaultMessage:"Show EQL Validation Errors"}),EQL_OVERVIEW_LINK_TEXT=(_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.detectionEngine.eqlQueryBar.label",{defaultMessage:"Enter an EQL Query"}),_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.detectionEngine.eqlOverViewLink.text",{defaultMessage:"Event Query Language (EQL) Overview"})),EQL_SETTINGS_TITLE=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.detectionEngine.eqlSettings.title",{defaultMessage:"EQL settings"}),EQL_OPTIONS_SIZE_LABEL=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsSize.label",{defaultMessage:"Size"}),EQL_OPTIONS_SIZE_HELPER=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsSize.text",{defaultMessage:"For basic queries, the maximum number of matching events to return. For sequence queries, the maximum number of matching sequences to return."}),EQL_OPTIONS_EVENT_CATEGORY_FIELD_LABEL=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventCategoryField.label",{defaultMessage:"Event category field"}),EQL_OPTIONS_EVENT_CATEGORY_FIELD_HELPER=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventCategoryField.text",{defaultMessage:"Field containing the event classification, such as process, file, or network. This field is typically mapped as a field type in the keyword family"}),EQL_OPTIONS_EVENT_TIEBREAKER_FIELD_LABEL=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventTiebreakerField.label",{defaultMessage:"Tiebreaker field"}),EQL_OPTIONS_EVENT_TIEBREAKER_FIELD_HELPER=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventTiebreakerField.text",{defaultMessage:"Field used to sort hits with the same timestamp in ascending, lexicographic order"}),EQL_OPTIONS_EVENT_TIMESTAMP_FIELD_LABEL=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventTimestampField.label",{defaultMessage:"Timestamp field"}),EQL_OPTIONS_EVENT_TIMESTAMP_FIELD_HELPER=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventTimestampField.text",{defaultMessage:"Field containing event timestamp"})},321:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"f",(function(){return FILTER_DESCRIPTION})),__webpack_require__.d(__webpack_exports__,"i",(function(){return FILTER_KQL_TOOLTIP})),__webpack_require__.d(__webpack_exports__,"g",(function(){return FILTER_KQL_PLACEHOLDER})),__webpack_require__.d(__webpack_exports__,"h",(function(){return FILTER_KQL_SELECTED_TEXT})),__webpack_require__.d(__webpack_exports__,"o",(function(){return SEARCH_DESCRIPTION})),__webpack_require__.d(__webpack_exports__,"r",(function(){return SEARCH_KQL_TOOLTIP})),__webpack_require__.d(__webpack_exports__,"p",(function(){return SEARCH_KQL_PLACEHOLDER})),__webpack_require__.d(__webpack_exports__,"q",(function(){return SEARCH_KQL_SELECTED_TEXT})),__webpack_require__.d(__webpack_exports__,"j",(function(){return FILTER_OR_SEARCH_WITH_KQL})),__webpack_require__.d(__webpack_exports__,"a",(function(){return ALL_EVENT})),__webpack_require__.d(__webpack_exports__,"m",(function(){return RAW_EVENT})),__webpack_require__.d(__webpack_exports__,"e",(function(){return DETECTION_ALERTS_EVENT})),__webpack_require__.d(__webpack_exports__,"c",(function(){return CUSTOM_INDEX_PATTERNS})),__webpack_require__.d(__webpack_exports__,"s",(function(){return SELECT_INDEX_PATTERNS})),__webpack_require__.d(__webpack_exports__,"b",(function(){return CONFIGURE_INDEX_PATTERNS})),__webpack_require__.d(__webpack_exports__,"n",(function(){return SAVE_INDEX_PATTERNS})),__webpack_require__.d(__webpack_exports__,"t",(function(){return SHOW_INDEX_PATTERNS_ADVANCED_SETTINGS})),__webpack_require__.d(__webpack_exports__,"k",(function(){return HIDE_INDEX_PATTERNS_ADVANCED_SETTINGS})),__webpack_require__.d(__webpack_exports__,"d",(function(){return DATA_SOURCES_RESET})),__webpack_require__.d(__webpack_exports__,"l",(function(){return PICK_INDEX_PATTERNS}));var _kbn_i18n__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1);const FILTER_DESCRIPTION=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.filterDescription",{defaultMessage:"Events from the data providers above are filtered by the adjacent KQL"}),FILTER_KQL_TOOLTIP=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.filterKqlTooltip",{defaultMessage:"Events from the data providers above are filtered by this KQL"}),FILTER_KQL_PLACEHOLDER=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.filterKqlPlaceholder",{defaultMessage:"Filter events"}),FILTER_KQL_SELECTED_TEXT=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.filterKqlSelectedText",{defaultMessage:"Filter"}),SEARCH_DESCRIPTION=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.searchDescription",{defaultMessage:"Events from the data providers above are combined with results from the adjacent KQL"}),SEARCH_KQL_TOOLTIP=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.searchKqlTooltip",{defaultMessage:"Events from the data providers above are combined with results from this KQL"}),SEARCH_KQL_PLACEHOLDER=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.searchKqlPlaceholder",{defaultMessage:"Search events"}),SEARCH_KQL_SELECTED_TEXT=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.searchKqlSelectedText",{defaultMessage:"Search"}),FILTER_OR_SEARCH_WITH_KQL=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.filterOrSearchWithKql",{defaultMessage:"Filter or Search with KQL"}),ALL_EVENT=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.eventTypeAllEvent",{defaultMessage:"All data sources"}),RAW_EVENT=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.eventTypeRawEvent",{defaultMessage:"Events"}),DETECTION_ALERTS_EVENT=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.eventTypeDetectionAlertsEvent",{defaultMessage:"Detection Alerts"}),CUSTOM_INDEX_PATTERNS=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.customeIndexNames",{defaultMessage:"Custom"}),SELECT_INDEX_PATTERNS=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.indexPatterns.help",{defaultMessage:"Data sources selection"}),CONFIGURE_INDEX_PATTERNS=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.indexPatterns.configure",{defaultMessage:"View data sources associated with each of the above selections"}),SAVE_INDEX_PATTERNS=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.indexPatterns.save",{defaultMessage:"Save"}),SHOW_INDEX_PATTERNS_ADVANCED_SETTINGS=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.indexPatterns.showAdvancedSettings",{defaultMessage:"Show Advanced"}),HIDE_INDEX_PATTERNS_ADVANCED_SETTINGS=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.indexPatterns.hideAdvancedSettings",{defaultMessage:"Hide Advanced"}),DATA_SOURCES_RESET=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.indexPatterns.resetSettings",{defaultMessage:"Reset"}),PICK_INDEX_PATTERNS=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.indexPatterns.pickIndexPatternsCombo",{defaultMessage:"Pick index patterns"})},324:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return debounceAsync})),__webpack_require__.d(__webpack_exports__,"b",(function(){return eqlValidator})),__webpack_require__.d(__webpack_exports__,"c",(function(){return getValidationResults}));var external_kbnSharedDeps_Lodash_=__webpack_require__(80),utils=__webpack_require__(176),kibana=__webpack_require__(109),public_=__webpack_require__(96);const isValidationErrorType=type=>"parsing_exception"===type||"verification_exception"===type||"mapping_exception"===type,isErrorResponse=response=>Object(external_kbnSharedDeps_Lodash_.has)(response,"error.type"),getValidationErrors=response=>response.error.root_cause.filter(cause=>isValidationErrorType(cause.type)).map(cause=>cause.reason),validateEql=async({data:data,index:index,query:query,signal:signal})=>{const{rawResponse:response}=await data.search.search({params:{index:index.join(),body:{query:query,size:0}},options:{ignore:[400]}},{strategy:public_.EQL_SEARCH_STRATEGY,abortSignal:signal}).toPromise();if((response=>isErrorResponse(response)&&isValidationErrorType(Object(external_kbnSharedDeps_Lodash_.get)(response,"error.type")))(response.body))return{valid:!1,errors:getValidationErrors(response.body)};if(isErrorResponse(response.body))throw new Error(JSON.stringify(response.body));return{valid:!0,errors:[]}};var translations=__webpack_require__(189);let ERROR_CODES;!function(ERROR_CODES){ERROR_CODES.FAILED_REQUEST="ERR_FAILED_REQUEST",ERROR_CODES.INVALID_EQL="ERR_INVALID_EQL"}(ERROR_CODES||(ERROR_CODES={}));const debounceAsync=(fn,interval)=>{let handle,resolves=[];return(...args)=>(handle&&clearTimeout(handle),handle=setTimeout(()=>{const result=fn(...args);resolves.forEach(resolve=>resolve(result)),resolves=[]},interval),new Promise(resolve=>resolves.push(resolve)))},eqlValidator=async(...args)=>{const[{value:value,formData:formData}]=args,{query:queryValue}=value,query=queryValue.query,{index:index,ruleType:ruleType}=formData;if(void 0===ruleType&&!Object(external_kbnSharedDeps_Lodash_.isEmpty)(query)||Object(utils.c)(ruleType)&&!Object(external_kbnSharedDeps_Lodash_.isEmpty)(query))try{const{data:data}=kibana.b.get(),signal=(new AbortController).signal,response=await validateEql({data:data,query:query,signal:signal,index:index});if(!1===(null==response?void 0:response.valid))return{code:ERROR_CODES.INVALID_EQL,message:"",messages:response.errors}}catch(error){return{code:ERROR_CODES.FAILED_REQUEST,message:translations.m,error:error}}},getValidationResults=field=>{const hasErrors=field.errors.length>0,isValid=!field.isChangingValue&&!hasErrors;if(hasErrors){const[error]=field.errors,message=error.message;return error.code===ERROR_CODES.INVALID_EQL?{isValid:isValid,message:message,messages:error.messages}:{isValid:isValid,message:message,error:error.error}}return{isValid:isValid,message:""}}},491:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return EqlQueryBar}));var external_kbnSharedDeps_React_=__webpack_require__(6),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),external_kbnSharedDeps_StyledComponents_=__webpack_require__(75),external_kbnSharedDeps_StyledComponents_default=__webpack_require__.n(external_kbnSharedDeps_StyledComponents_),external_kbnSharedDeps_ElasticEui_=__webpack_require__(74),use_app_toasts=__webpack_require__(115),translations=__webpack_require__(189),external_kbnSharedDeps_Lodash_=__webpack_require__(80);const ErrorsPopover=({ariaLabel:ariaLabel,errors:errors})=>{const[isOpen,setIsOpen]=Object(external_kbnSharedDeps_React_.useState)(!1),handleToggle=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setIsOpen(!isOpen)},[isOpen]),handleClose=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setIsOpen(!1)},[]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopover,{"data-test-subj":"eql-validation-errors-popover",button:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{"data-test-subj":"eql-validation-errors-popover-button",iconType:"crossInACircleFilled",size:"s",color:"danger","aria-label":ariaLabel,onClick:handleToggle},errors.length),isOpen:isOpen,closePopover:handleClose,anchorPosition:"downCenter"},external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":"eql-validation-errors-popover-content"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopoverTitle,null,translations.k),errors.map((message,idx)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{key:idx},message))))};var kibana=__webpack_require__(109);const InlineText=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiText).withConfig({displayName:"InlineText",componentId:"i91hzt-0"})(["display:inline-block;"]),EqlOverviewLink=()=>{const overviewUrl=Object(kibana.h)().services.docLinks.links.query.eql;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{external:!0,href:overviewUrl,target:"_blank"},external_kbnSharedDeps_React_default.a.createElement(InlineText,{size:"xs"},translations.i))},Container=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiPanel).withConfig({displayName:"Container",componentId:"sc-10yczbx-0"})(["border-radius:0;background:",";padding:"," ",";"],({theme:theme})=>theme.eui.euiPageBackgroundColor,({theme:theme})=>theme.eui.euiSizeXS,({theme:theme})=>theme.eui.euiSizeS),FlexGroup=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup).withConfig({displayName:"FlexGroup",componentId:"sc-10yczbx-1"})(["min-height:",";"],({theme:theme})=>theme.eui.euiSizeXL),FlexItemLeftBorder=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexItem).withConfig({displayName:"FlexItemLeftBorder",componentId:"sc-10yczbx-2"})(["border-left:1px solid ",";"],({theme:theme})=>theme.eui.euiColorLightShade),FlexItemWithMarginRight=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexItem).withConfig({displayName:"FlexItemWithMarginRight",componentId:"sc-10yczbx-3"})(["margin-right:",";"],({theme:theme})=>theme.eui.euiSizeS),Spinner=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiLoadingSpinner).withConfig({displayName:"Spinner",componentId:"sc-10yczbx-4"})(["margin:0 ",";"],({theme:theme})=>theme.eui.euiSizeS),singleSelection={asPlainText:!0},EqlQueryBarFooter=({errors:errors,isLoading:isLoading,optionsData:optionsData,optionsSelected:optionsSelected,onOptionsChange:onOptionsChange})=>{var _optionsSelected$size;const[openEqlSettings,setIsOpenEqlSettings]=Object(external_kbnSharedDeps_React_.useState)(!1),[localSize,setLocalSize]=Object(external_kbnSharedDeps_React_.useState)(null!==(_optionsSelected$size=null==optionsSelected?void 0:optionsSelected.size)&&void 0!==_optionsSelected$size?_optionsSelected$size:100),debounceSize=Object(external_kbnSharedDeps_React_.useRef)(),openEqlSettingsHandler=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setIsOpenEqlSettings(!0)},[]),closeEqlSettingsHandler=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setIsOpenEqlSettings(!1)},[]),handleEventCategoryField=Object(external_kbnSharedDeps_React_.useCallback)(opt=>{onOptionsChange&&(opt.length>0?onOptionsChange("eventCategoryField",opt[0].label):onOptionsChange("eventCategoryField",null))},[onOptionsChange]),handleTiebreakerField=Object(external_kbnSharedDeps_React_.useCallback)(opt=>{onOptionsChange&&(opt.length>0?onOptionsChange("tiebreakerField",opt[0].label):onOptionsChange("tiebreakerField",null))},[onOptionsChange]),handleTimestampField=Object(external_kbnSharedDeps_React_.useCallback)(opt=>{onOptionsChange&&(opt.length>0?onOptionsChange("timestampField",opt[0].label):onOptionsChange("timestampField",null))},[onOptionsChange]),handleSizeField=Object(external_kbnSharedDeps_React_.useCallback)(evt=>{if(onOptionsChange){var _evt$target,_debounceSize$current,_evt$target2,_debounceSize$current2;if(setLocalSize(null==evt||null===(_evt$target=evt.target)||void 0===_evt$target?void 0:_evt$target.value),null!==(_debounceSize$current=debounceSize.current)&&void 0!==_debounceSize$current&&_debounceSize$current.cancel)null===(_debounceSize$current2=debounceSize.current)||void 0===_debounceSize$current2||_debounceSize$current2.cancel();debounceSize.current=Object(external_kbnSharedDeps_Lodash_.debounce)(newSize=>onOptionsChange("size",newSize),800),debounceSize.current(null==evt||null===(_evt$target2=evt.target)||void 0===_evt$target2?void 0:_evt$target2.value)}},[onOptionsChange]),eventCategoryField=Object(external_kbnSharedDeps_React_.useMemo)(()=>null!=(null==optionsSelected?void 0:optionsSelected.eventCategoryField)?[{label:null==optionsSelected?void 0:optionsSelected.eventCategoryField}]:void 0,[null==optionsSelected?void 0:optionsSelected.eventCategoryField]),tiebreakerField=Object(external_kbnSharedDeps_React_.useMemo)(()=>null!=(null==optionsSelected?void 0:optionsSelected.tiebreakerField)?[{label:null==optionsSelected?void 0:optionsSelected.tiebreakerField}]:void 0,[null==optionsSelected?void 0:optionsSelected.tiebreakerField]),timestampField=Object(external_kbnSharedDeps_React_.useMemo)(()=>null!=(null==optionsSelected?void 0:optionsSelected.timestampField)?[{label:null==optionsSelected?void 0:optionsSelected.timestampField}]:void 0,[null==optionsSelected?void 0:optionsSelected.timestampField]);return external_kbnSharedDeps_React_default.a.createElement(Container,null,external_kbnSharedDeps_React_default.a.createElement(FlexGroup,{alignItems:"center",justifyContent:"spaceBetween",gutterSize:"none"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,errors.length>0&&external_kbnSharedDeps_React_default.a.createElement(ErrorsPopover,{ariaLabel:translations.l,errors:errors}),isLoading&&external_kbnSharedDeps_React_default.a.createElement(Spinner,{"data-test-subj":"eql-validation-loading",size:"m"})),!onOptionsChange&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(EqlOverviewLink,null)),onOptionsChange&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(FlexItemWithMarginRight,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(EqlOverviewLink,null)),external_kbnSharedDeps_React_default.a.createElement(FlexItemLeftBorder,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopover,{button:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{onClick:openEqlSettingsHandler,iconType:"controlsVertical",isDisabled:openEqlSettings,"aria-label":"eql settings","data-test-subj":"eql-settings-trigger"}),isOpen:openEqlSettings,closePopover:closeEqlSettingsHandler,anchorPosition:"downCenter",ownFocus:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopoverTitle,null,translations.j),external_kbnSharedDeps_React_default.a.createElement("div",{style:{width:"300px"}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:translations.h,helpText:translations.g},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldNumber,{value:localSize,onChange:handleSizeField,min:1,max:1e4})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:translations.b,helpText:translations.a},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiComboBox,{options:null==optionsData?void 0:optionsData.keywordFields,selectedOptions:eventCategoryField,singleSelection:singleSelection,onChange:handleEventCategoryField})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:translations.d,helpText:translations.c},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiComboBox,{options:null==optionsData?void 0:optionsData.nonDateFields,selectedOptions:tiebreakerField,singleSelection:singleSelection,onChange:handleTiebreakerField})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:translations.f,helpText:translations.e},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiComboBox,{options:null==optionsData?void 0:optionsData.dateFields,selectedOptions:timestampField,singleSelection:singleSelection,onChange:handleTimestampField}))))))))};var validators=__webpack_require__(324);const TextArea=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiTextArea).withConfig({displayName:"TextArea",componentId:"sc-4u43ce-0"})(["display:block;border:",";border-bottom:0;box-shadow:none;min-height:",";"],({theme:theme})=>theme.eui.euiBorderThin,({theme:theme})=>theme.eui.euiFormControlHeight),EqlQueryBar=({dataTestSubj:dataTestSubj,field:field,idAria:idAria,optionsData:optionsData,optionsSelected:optionsSelected,onOptionsChange:onOptionsChange,onValidityChange:onValidityChange,onValiditingChange:onValiditingChange})=>{const{addError:addError}=Object(use_app_toasts.a)(),[errorMessages,setErrorMessages]=Object(external_kbnSharedDeps_React_.useState)([]),{isValidating:isValidating,setValue:setValue}=field,{isValid:isValid,message:message,messages:messages,error:error}=Object(validators.c)(field),fieldValue=field.value.query.query;Object(external_kbnSharedDeps_React_.useEffect)(()=>{null!=onValidityChange&&onValidityChange(isValid)},[isValid,onValidityChange]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{setErrorMessages(null!=messages?messages:[])},[messages]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{error&&addError(error,{title:translations.m})},[error,addError]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{onValiditingChange&&onValiditingChange(isValidating)},[isValidating,onValiditingChange]);const handleChange=Object(external_kbnSharedDeps_React_.useCallback)(e=>{const newQuery=e.target.value;onValiditingChange&&onValiditingChange(!0),setErrorMessages([]),setValue({filters:[],query:{query:newQuery,language:"eql"}})},[setValue,onValiditingChange]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:field.label,labelAppend:field.labelAppend,helpText:field.helpText,error:message,isInvalid:!isValid&&!isValidating,fullWidth:!0,"data-test-subj":dataTestSubj,describedByIds:idAria?[idAria]:void 0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(TextArea,{"data-test-subj":"eqlQueryBarTextInput",fullWidth:!0,isInvalid:!isValid&&!isValidating,value:fieldValue,onChange:handleChange}),external_kbnSharedDeps_React_default.a.createElement(EqlQueryBarFooter,{errors:errorMessages,isLoading:isValidating,optionsData:optionsData,optionsSelected:optionsSelected,onOptionsChange:onOptionsChange})))}},511:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return PickEventType}));var external_kbnSharedDeps_ElasticEui_=__webpack_require__(74),fast_deep_equal=__webpack_require__(112),fast_deep_equal_default=__webpack_require__.n(fast_deep_equal),external_kbnSharedDeps_React_=__webpack_require__(6),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),lib=__webpack_require__(110),external_kbnSharedDeps_StyledComponents_=__webpack_require__(75),external_kbnSharedDeps_StyledComponents_default=__webpack_require__.n(external_kbnSharedDeps_StyledComponents_),model=__webpack_require__(124),selectors=__webpack_require__(287);const getSourcererScopeSelector=()=>{const getkibanaIndexPatternsSelector=selectors.d.kibanaIndexPatternsSelector(),getScopeIdSelector=selectors.d.scopeIdSelector(),getConfigIndexPatternsSelector=selectors.d.configIndexPatternsSelector(),getSignalIndexNameSelector=selectors.d.signalIndexNameSelector();return(state,scopeId)=>{const kibanaIndexPatterns=getkibanaIndexPatternsSelector(state),scope=getScopeIdSelector(state,scopeId);return{kibanaIndexPatterns:kibanaIndexPatterns,configIndexPatterns:getConfigIndexPatternsSelector(state),signalIndexName:getSignalIndexNameSelector(state),sourcererScope:scope}}};var translations=__webpack_require__(321);const PopoverContent=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"PopoverContent",componentId:"sc-13xuah3-0"})(["width:600px;"]),ResetButton=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty).withConfig({displayName:"ResetButton",componentId:"sc-13xuah3-1"})(["width:fit-content;"]),MyEuiButton=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiButton).withConfig({displayName:"MyEuiButton",componentId:"sc-13xuah3-2"})([".euiHealth{vertical-align:middle;}"]),AllEuiHealth=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiHealth).withConfig({displayName:"AllEuiHealth",componentId:"sc-13xuah3-3"})(["margin-left:-2px;svg{stroke:#fff;stroke-width:1px;stroke-linejoin:round;width:19px;height:19px;margin-top:1px;z-index:1;}"]),WarningEuiHealth=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiHealth).withConfig({displayName:"WarningEuiHealth",componentId:"sc-13xuah3-4"})(["margin-left:-17px;svg{z-index:0;}"]),AdvancedSettings=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiText).withConfig({displayName:"AdvancedSettings",componentId:"sc-13xuah3-5"})(["color:",";"],({theme:theme})=>theme.eui.euiColorPrimary),ConfigHelper=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiText).withConfig({displayName:"ConfigHelper",componentId:"sc-13xuah3-6"})(["margin-left:4px;"]),Filter=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiRadioGroup).withConfig({displayName:"Filter",componentId:"sc-13xuah3-7"})(["margin-left:4px;"]),PickEventContainer=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"PickEventContainer",componentId:"sc-13xuah3-8"})([".euiSuperSelect{width:170px;max-width:170px;button.euiSuperSelectControl{padding-top:3px;}}"]),getEventTypeOptions=(isCustomDisabled=!0)=>[{id:"all",label:external_kbnSharedDeps_React_default.a.createElement(AllEuiHealth,{color:"subdued"},external_kbnSharedDeps_React_default.a.createElement(WarningEuiHealth,{color:"warning"},translations.a))},{id:"raw",label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHealth,{color:"subdued"}," ",translations.m)},{id:"alert",label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHealth,{color:"warning"}," ",translations.e)},{id:"custom",label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,translations.c),disabled:isCustomDisabled}],PickEventTypeComponents=({eventType:eventType="all",onChangeEventTypeAndIndexesName:onChangeEventTypeAndIndexesName})=>{const[isPopoverOpen,setPopover]=Object(external_kbnSharedDeps_React_.useState)(!1),[showAdvanceSettings,setAdvanceSettings]=Object(external_kbnSharedDeps_React_.useState)("custom"===eventType),[filterEventType,setFilterEventType]=Object(external_kbnSharedDeps_React_.useState)(eventType),sourcererScopeSelector=Object(external_kbnSharedDeps_React_.useMemo)(getSourcererScopeSelector,[]),{configIndexPatterns:configIndexPatterns,kibanaIndexPatterns:kibanaIndexPatterns,signalIndexName:signalIndexName,sourcererScope:sourcererScope}=Object(lib.useSelector)(state=>sourcererScopeSelector(state,model.SourcererScopeName.timeline),fast_deep_equal_default.a),[selectedOptions,setSelectedOptions]=Object(external_kbnSharedDeps_React_.useState)(sourcererScope.selectedPatterns.map(indexSelected=>({label:indexSelected,value:indexSelected}))),indexesPatternOptions=Object(external_kbnSharedDeps_React_.useMemo)(()=>[...configIndexPatterns,...kibanaIndexPatterns.map(kip=>kip.title),signalIndexName].reduce((acc,index)=>null==index||acc.some(o=>o.label.includes(index))?acc:[...acc,{label:index,value:index}],[]),[configIndexPatterns,kibanaIndexPatterns,signalIndexName]),renderOption=Object(external_kbnSharedDeps_React_.useCallback)(option=>{const{value:value}=option;return kibanaIndexPatterns.some(kip=>kip.title===value)?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{type:"logoKibana",size:"s"})," ",value):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,value)},[kibanaIndexPatterns]),onChangeCombo=Object(external_kbnSharedDeps_React_.useCallback)(newSelectedOptions=>{const localSelectedPatterns=newSelectedOptions.map(nso=>nso.label);localSelectedPatterns.sort().join()===[...configIndexPatterns,signalIndexName].sort().join()?setFilterEventType("all"):localSelectedPatterns.sort().join()===configIndexPatterns.sort().join()?setFilterEventType("raw"):localSelectedPatterns.sort().join()===signalIndexName?setFilterEventType("alert"):setFilterEventType("custom"),setSelectedOptions(newSelectedOptions)},[configIndexPatterns,signalIndexName]),onChangeFilter=Object(external_kbnSharedDeps_React_.useCallback)(filter=>{setFilterEventType(filter),"all"===filter?setSelectedOptions([...configIndexPatterns,null!=signalIndexName?signalIndexName:""].map(indexSelected=>({label:indexSelected,value:indexSelected}))):"raw"===filter?setSelectedOptions(configIndexPatterns.map(indexSelected=>({label:indexSelected,value:indexSelected}))):"alert"===filter?setSelectedOptions([{label:null!=signalIndexName?signalIndexName:"",value:null!=signalIndexName?signalIndexName:""}]):"kibana"===filter&&setSelectedOptions(kibanaIndexPatterns.map(kip=>({label:kip.title,value:kip.title})))},[configIndexPatterns,kibanaIndexPatterns,signalIndexName]),togglePopover=Object(external_kbnSharedDeps_React_.useCallback)(()=>setPopover(prevIsPopoverOpen=>!prevIsPopoverOpen),[]),closePopover=Object(external_kbnSharedDeps_React_.useCallback)(()=>setPopover(!1),[]),handleSaveIndices=Object(external_kbnSharedDeps_React_.useCallback)(()=>{onChangeEventTypeAndIndexesName(filterEventType,selectedOptions.map(so=>so.label)),setPopover(!1)},[filterEventType,onChangeEventTypeAndIndexesName,selectedOptions]),resetDataSources=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setSelectedOptions(sourcererScope.selectedPatterns.map(indexSelected=>({label:indexSelected,value:indexSelected}))),setFilterEventType(eventType)},[eventType,sourcererScope.selectedPatterns]),comboBox=Object(external_kbnSharedDeps_React_.useMemo)(()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiComboBox,{"data-test-subj":"timeline-sourcerer",fullWidth:!0,onChange:onChangeCombo,options:indexesPatternOptions,placeholder:translations.l,renderOption:renderOption,selectedOptions:selectedOptions}),[onChangeCombo,indexesPatternOptions,renderOption,selectedOptions]),filterOptions=Object(external_kbnSharedDeps_React_.useMemo)(()=>getEventTypeOptions("custom"!==filterEventType),[filterEventType]),filter=Object(external_kbnSharedDeps_React_.useMemo)(()=>external_kbnSharedDeps_React_default.a.createElement(Filter,{"data-test-subj":"timeline-sourcerer-radio",options:filterOptions,idSelected:filterEventType,onChange:onChangeFilter,name:translations.s}),[filterEventType,filterOptions,onChangeFilter]),button=Object(external_kbnSharedDeps_React_.useMemo)(()=>{var _options$find;const options=getEventTypeOptions();return external_kbnSharedDeps_React_default.a.createElement(MyEuiButton,{"data-test-subj":"sourcerer-timeline-trigger",iconType:"arrowDown",iconSide:"right",isLoading:sourcererScope.loading,onClick:togglePopover},null===(_options$find=options.find(opt=>opt.id===eventType))||void 0===_options$find?void 0:_options$find.label)},[eventType,sourcererScope.loading,togglePopover]),tooltipContent=Object(external_kbnSharedDeps_React_.useMemo)(()=>isPopoverOpen?null:sourcererScope.selectedPatterns.sort().join(", "),[isPopoverOpen,sourcererScope.selectedPatterns]),ButtonContent=Object(external_kbnSharedDeps_React_.useMemo)(()=>external_kbnSharedDeps_React_default.a.createElement(AdvancedSettings,{"data-test-subj":"advanced-settings"},showAdvanceSettings?translations.k:translations.t),[showAdvanceSettings]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{const newSelectedOptions=sourcererScope.selectedPatterns.map(indexSelected=>({label:indexSelected,value:indexSelected}));setSelectedOptions(prevSelectedOptions=>fast_deep_equal_default()(newSelectedOptions,prevSelectedOptions)?prevSelectedOptions:newSelectedOptions)},[sourcererScope.selectedPatterns]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{setFilterEventType(prevFilter=>prevFilter!==eventType?eventType:prevFilter),setAdvanceSettings("custom"===eventType)},[eventType]),external_kbnSharedDeps_React_default.a.createElement(PickEventContainer,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{position:"top",content:tooltipContent},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopover,{button:button,closePopover:closePopover,id:"popover",isOpen:isPopoverOpen,ownFocus:!0,repositionOnScroll:!0},external_kbnSharedDeps_React_default.a.createElement(PopoverContent,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopoverTitle,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,translations.s)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),filter,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiAccordion,{id:"accordion1",forceState:showAdvanceSettings?"open":"closed",buttonContent:ButtonContent,onToggle:setAdvanceSettings},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),comboBox)),!showAdvanceSettings&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(ConfigHelper,{size:"s",color:"subdued"},translations.b)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(ResetButton,{"aria-label":translations.d,"data-test-subj":"sourcerer-reset",flush:"left",onClick:resetDataSources,size:"l",title:translations.d},translations.d)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{onClick:handleSaveIndices,"data-test-subj":"add-index",fill:!0,fullWidth:!0,size:"s"},translations.n)))))))},PickEventType=Object(external_kbnSharedDeps_React_.memo)(PickEventTypeComponents)},512:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return TimelineDatePickerLock}));var external_kbnSharedDeps_ElasticEui_=__webpack_require__(74),external_kbnSharedDeps_React_=__webpack_require__(6),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),lib=__webpack_require__(110),inputs=__webpack_require__(155),use_selector=__webpack_require__(114),external_kbnSharedDeps_KbnI18n_=__webpack_require__(1);const LOCK_SYNC_MAIN_DATE_PICKER_TOOL_TIP=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.timeline.properties.lockDatePickerTooltip",{defaultMessage:"Disable syncing of date/time range bteween the currently viewed page and your timeline"}),UNLOCK_SYNC_MAIN_DATE_PICKER_TOOL_TIP=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.timeline.properties.unlockDatePickerTooltip",{defaultMessage:"Enable syncing of date/time range between the currently viewed page and your timeline"}),LOCK_SYNC_MAIN_DATE_PICKER_ARIA=(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.timeline.properties.lockedDatePickerLabel",{defaultMessage:"Global date picker is locked to timeline date picker"}),external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.timeline.properties.unlockedDatePickerLabel",{defaultMessage:"Global date picker NOT locked to timeline date picker"}),external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.timeline.properties.lockDatePickerDescription",{defaultMessage:"Lock global date picker to timeline date picker"})),UNLOCK_SYNC_MAIN_DATE_PICKER_ARIA=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.timeline.properties.unlockDatePickerDescription",{defaultMessage:"Unlock global date picker from timeline date picker"}),TimelineDatePickerLockComponent=()=>{const dispatch=Object(lib.useDispatch)(),getGlobalInput=Object(external_kbnSharedDeps_React_.useMemo)(()=>inputs.d.globalSelector(),[]),isDatePickerLocked=Object(use_selector.b)(state=>getGlobalInput(state).linkTo.includes("timeline")),onToggleLock=Object(external_kbnSharedDeps_React_.useCallback)(()=>dispatch(inputs.b.toggleTimelineLinkTo({linkToId:"timeline"})),[dispatch]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{"data-test-subj":"timeline-date-picker-lock-tooltip",position:"top",content:isDatePickerLocked?LOCK_SYNC_MAIN_DATE_PICKER_TOOL_TIP:UNLOCK_SYNC_MAIN_DATE_PICKER_TOOL_TIP},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{"data-test-subj":`timeline-date-picker-${isDatePickerLocked?"lock":"unlock"}-button`,color:"primary",onClick:onToggleLock,iconType:isDatePickerLocked?"lock":"lockOpen","aria-label":isDatePickerLocked?UNLOCK_SYNC_MAIN_DATE_PICKER_ARIA:LOCK_SYNC_MAIN_DATE_PICKER_ARIA}))};TimelineDatePickerLockComponent.displayName="TimelineDatePickerLockComponent";const TimelineDatePickerLock=external_kbnSharedDeps_React_default.a.memo(TimelineDatePickerLockComponent)}}]);