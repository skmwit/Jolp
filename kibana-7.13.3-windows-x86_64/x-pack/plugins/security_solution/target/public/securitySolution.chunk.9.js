/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[9],{1021:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var react_1=__webpack_require__(6);exports.default=function(state){var ref=react_1.useRef();return react_1.useEffect((function(){ref.current=state})),ref.current}},1121:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"renderApp",(function(){return renderApp})),__webpack_require__.d(__webpack_exports__,"createStore",(function(){return common_store.createStore})),__webpack_require__.d(__webpack_exports__,"createInitialState",(function(){return common_store.createInitialState}));var external_kbnSharedDeps_React_=__webpack_require__(6),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),external_kbnSharedDeps_ReactDom_=__webpack_require__(92),lib=__webpack_require__(110),external_kbnSharedDeps_ElasticEui_=__webpack_require__(74),user_info=__webpack_require__(179),constants=__webpack_require__(2),use_selector=__webpack_require__(114),common_store=__webpack_require__(129),app=__webpack_require__(180),toasters=__webpack_require__(116);const ErrorToastDispatcherComponent=({toastLifeTimeMs:toastLifeTimeMs=5e3})=>{const dispatch=Object(lib.useDispatch)(),getErrorSelector=Object(external_kbnSharedDeps_React_.useMemo)(()=>common_store.appSelectors.errorsSelector(),[]),errors=Object(use_selector.a)(getErrorSelector),[{toasts:toasts},dispatchToaster]=Object(toasters.h)();return Object(external_kbnSharedDeps_React_.useEffect)(()=>{errors.forEach(({id:id,title:title,message:message})=>{toasts.some(toast=>toast.id===id)||dispatchToaster({type:"addToaster",toast:{color:"danger",id:id,iconType:"alert",title:title,errors:message,toastLifeTimeMs:toastLifeTimeMs}}),dispatch(app.a.removeError({id:id}))})},[dispatch,dispatchToaster,errors,toastLifeTimeMs,toasts]),null};ErrorToastDispatcherComponent.displayName="ErrorToastDispatcherComponent";const ErrorToastDispatcher=external_kbnSharedDeps_React_default.a.memo(ErrorToastDispatcherComponent);var ml_capabilities_provider=__webpack_require__(725),kibana=__webpack_require__(109),manage_timeline=__webpack_require__(157),external_kbnSharedDeps_ReactRouterDom_=__webpack_require__(77),helpers=__webpack_require__(590);const ManageRoutesSpyComponent=({children:children})=>external_kbnSharedDeps_React_default.a.createElement(helpers.a.Provider,{value:Object(external_kbnSharedDeps_React_.useReducer)((state,action)=>{switch(action.type){case"updateRoute":return action.route;case"updateRouteWithOutSearch":return{...state,...action.route};case"updateSearch":return{...state,search:action.search};default:return state}},helpers.b)},children),ManageRoutesSpy=Object(external_kbnSharedDeps_React_.memo)(ManageRoutesSpyComponent),RouteCapture=Object(external_kbnSharedDeps_React_.memo)(({children:children})=>{const location=Object(external_kbnSharedDeps_ReactRouterDom_.useLocation)(),dispatch=Object(lib.useDispatch)();return Object(external_kbnSharedDeps_React_.useEffect)(()=>{dispatch({type:"userChangedUrl",payload:location})}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,children)});RouteCapture.displayName="RouteCapture";var _404=__webpack_require__(173),external_kbnSharedDeps_StyledComponents_=__webpack_require__(75),external_kbnSharedDeps_StyledComponents_default=__webpack_require__.n(external_kbnSharedDeps_StyledComponents_),types_timeline=__webpack_require__(111),external_kbnSharedDeps_LodashFp_=__webpack_require__(7),react_beautiful_dnd_cjs=__webpack_require__(240),fast_deep_equal=__webpack_require__(112),fast_deep_equal_default=__webpack_require__.n(fast_deep_equal),store_timeline=__webpack_require__(113),data_providers_helpers=__webpack_require__(294),translations=__webpack_require__(591),use_add_to_timeline=__webpack_require__(420),drag_and_drop_helpers=__webpack_require__(123),defaults=__webpack_require__(125);window["__react-beautiful-dnd-disable-dev-warnings"]=!0;const sensors=[use_add_to_timeline.b],DragDropContextWrapperComponent=({browserFields:browserFields,children:children})=>{const dispatch=Object(lib.useDispatch)(),getTimeline=Object(external_kbnSharedDeps_React_.useMemo)(()=>store_timeline.b.getTimelineByIdSelector(),[]),getDataProviders=Object(external_kbnSharedDeps_React_.useMemo)(()=>common_store.dragAndDropSelectors.getDataProvidersSelector(),[]),{dataProviders:activeTimelineDataProviders,timelineType:timelineType}=Object(use_selector.a)(state=>{var _getTimeline;return Object(external_kbnSharedDeps_LodashFp_.pick)(["dataProviders","timelineType"],null!==(_getTimeline=getTimeline(state,types_timeline.g.active))&&void 0!==_getTimeline?_getTimeline:defaults.a)}),dataProviders=Object(use_selector.a)(getDataProviders),[,dispatchToaster]=Object(toasters.h)(),onAddedToTimeline=Object(external_kbnSharedDeps_React_.useCallback)(fieldOrValue=>{const message=timelineType===types_timeline.k.template?Object(translations.b)(fieldOrValue):Object(translations.a)(fieldOrValue);Object(toasters.e)(message,dispatchToaster)},[dispatchToaster,timelineType]),onDragEnd=Object(external_kbnSharedDeps_React_.useCallback)(result=>{try{enableScrolling(),null!=dataProviders&&(({activeTimelineDataProviders:activeTimelineDataProviders,browserFields:browserFields,dataProviders:dataProviders,dispatch:dispatch,onAddedToTimeline:onAddedToTimeline,result:result})=>{if(Object(drag_and_drop_helpers.u)(result))Object(data_providers_helpers.d)({dataProviders:activeTimelineDataProviders,destination:result.destination,dispatch:dispatch,source:result.source,timelineId:types_timeline.g.active});else if(Object(drag_and_drop_helpers.t)(result))Object(drag_and_drop_helpers.f)({activeTimelineDataProviders:activeTimelineDataProviders,dataProviders:dataProviders,dispatch:dispatch,onAddedToTimeline:onAddedToTimeline,result:result,timelineId:types_timeline.g.active});else if(Object(drag_and_drop_helpers.m)(result)){var _result$destination$d,_result$destination;Object(drag_and_drop_helpers.e)({browserFields:browserFields,dispatch:dispatch,result:result,timelineId:Object(drag_and_drop_helpers.q)(null!==(_result$destination$d=null===(_result$destination=result.destination)||void 0===_result$destination?void 0:_result$destination.droppableId)&&void 0!==_result$destination$d?_result$destination$d:"")})}})({activeTimelineDataProviders:activeTimelineDataProviders,browserFields:browserFields,dataProviders:dataProviders,dispatch:dispatch,onAddedToTimeline:onAddedToTimeline,result:result})}finally{document.body.classList.remove(drag_and_drop_helpers.c),Object(drag_and_drop_helpers.h)(result)&&document.body.classList.remove(drag_and_drop_helpers.d)}},[activeTimelineDataProviders,browserFields,dataProviders,dispatch,onAddedToTimeline]);return external_kbnSharedDeps_React_default.a.createElement(react_beautiful_dnd_cjs.DragDropContext,{onDragEnd:onDragEnd,onBeforeCapture:onBeforeCapture,sensors:sensors},children)};DragDropContextWrapperComponent.displayName="DragDropContextWrapperComponent";const DragDropContextWrapper=external_kbnSharedDeps_React_default.a.memo(DragDropContextWrapperComponent,(prevProps,nextProps)=>fast_deep_equal_default()(prevProps.children,nextProps.children));DragDropContextWrapper.displayName="DragDropContextWrapper";const onBeforeCapture=before=>{Object(drag_and_drop_helpers.h)(before)||document.body.classList.add(drag_and_drop_helpers.c),Object(drag_and_drop_helpers.h)(before)&&document.body.classList.add(drag_and_drop_helpers.d)},enableScrolling=()=>window.onscroll=()=>external_kbnSharedDeps_LodashFp_.noop;var external_kbnSharedDeps_KbnI18n_=__webpack_require__(1),polished_lib=__webpack_require__(184),data_providers=__webpack_require__(609),timeline_helpers=__webpack_require__(126),external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(76),properties_helpers=__webpack_require__(297),use_all_cases_modal=__webpack_require__(740),timeline_actions=__webpack_require__(20),link_to=__webpack_require__(119),types=__webpack_require__(3),properties_translations=__webpack_require__(241);const AddToCaseButtonComponent=({timelineId:timelineId})=>{const getTimeline=Object(external_kbnSharedDeps_React_.useMemo)(()=>store_timeline.b.getTimelineByIdSelector(),[]),{navigateToApp:navigateToApp}=Object(kibana.h)().services.application,dispatch=Object(lib.useDispatch)(),{graphEventId:graphEventId,savedObjectId:savedObjectId,status:timelineStatus,title:timelineTitle,timelineType:timelineType}=Object(use_selector.a)(state=>{var _getTimeline;return Object(external_kbnSharedDeps_LodashFp_.pick)(["graphEventId","savedObjectId","status","title","timelineType"],null!==(_getTimeline=getTimeline(state,timelineId))&&void 0!==_getTimeline?_getTimeline:defaults.a)}),[isPopoverOpen,setPopover]=Object(external_kbnSharedDeps_React_.useState)(!1),onRowClick=Object(external_kbnSharedDeps_React_.useCallback)(async theCase=>{await navigateToApp(`${constants.f}:${types.a.case}`,{path:null!=theCase?Object(link_to.b)({id:theCase.id}):Object(link_to.f)()}),dispatch(Object(timeline_actions.setInsertTimeline)({graphEventId:graphEventId,timelineId:timelineId,timelineSavedObjectId:savedObjectId,timelineTitle:timelineTitle}))},[dispatch,graphEventId,navigateToApp,savedObjectId,timelineId,timelineTitle]),{modal:allCasesModal,openModal:openCaseModal}=Object(use_all_cases_modal.a)({onRowClick:onRowClick}),handleButtonClick=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setPopover(currentIsOpen=>!currentIsOpen)},[]),handlePopoverClose=Object(external_kbnSharedDeps_React_.useCallback)(()=>setPopover(!1),[]),handleNewCaseClick=Object(external_kbnSharedDeps_React_.useCallback)(()=>{handlePopoverClose(),dispatch(Object(timeline_actions.showTimeline)({id:types_timeline.g.active,show:!1})),navigateToApp(`${constants.f}:${types.a.case}`,{path:Object(link_to.f)()}).then(()=>dispatch(Object(timeline_actions.setInsertTimeline)({graphEventId:graphEventId,timelineId:timelineId,timelineSavedObjectId:savedObjectId,timelineTitle:timelineTitle.length>0?timelineTitle:properties_translations.l})))},[dispatch,graphEventId,navigateToApp,handlePopoverClose,savedObjectId,timelineId,timelineTitle]),handleExistingCaseClick=Object(external_kbnSharedDeps_React_.useCallback)(()=>{handlePopoverClose(),openCaseModal()},[openCaseModal,handlePopoverClose]),closePopover=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setPopover(!1)},[]),button=Object(external_kbnSharedDeps_React_.useMemo)(()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{fill:!0,size:"m","data-test-subj":"attach-timeline-case-button",iconType:"arrowDown",iconSide:"right",onClick:handleButtonClick,disabled:timelineStatus===types_timeline.i.draft||timelineType!==types_timeline.k.default},properties_translations.c),[handleButtonClick,timelineStatus,timelineType]),items=Object(external_kbnSharedDeps_React_.useMemo)(()=>[external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenuItem,{key:"new-case","data-test-subj":"attach-timeline-new-case",onClick:handleNewCaseClick},properties_translations.e),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenuItem,{key:"existing-case","data-test-subj":"attach-timeline-existing-case",onClick:handleExistingCaseClick},properties_translations.d)],[handleExistingCaseClick,handleNewCaseClick]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopover,{id:"singlePanel",button:button,isOpen:isPopoverOpen,closePopover:closePopover,panelPaddingSize:"none",anchorPosition:"downLeft"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenuPanel,{items:items})),allCasesModal)};AddToCaseButtonComponent.displayName="AddToCaseButtonComponent";const AddToCaseButton=external_kbnSharedDeps_React_default.a.memo(AddToCaseButtonComponent);var add_timeline_button=__webpack_require__(761),reselect_lib=__webpack_require__(128);var usePrevious=__webpack_require__(1021),usePrevious_default=__webpack_require__.n(usePrevious),shared_imports=__webpack_require__(117);var use_create_timeline=__webpack_require__(426),header_translations=__webpack_require__(476);const formSchema={title:{type:shared_imports.d.TEXT,validations:[{validator:shared_imports.v.emptyField("")}]},description:{type:shared_imports.d.TEXTAREA,validations:[]}},CommonUseField=Object(shared_imports.x)({component:shared_imports.e}),TimelineTitleAndDescription=external_kbnSharedDeps_React_default.a.memo(({closeSaveTimeline:closeSaveTimeline,initialFocus:initialFocus,timelineId:timelineId,showWarning:showWarning})=>{const getTimeline=Object(external_kbnSharedDeps_React_.useMemo)(()=>store_timeline.b.getTimelineByIdSelector(),[]),{isSaving:isSaving,description:description="",status:status,title:title="",timelineType:timelineType}=Object(use_selector.a)(state=>Object(external_kbnSharedDeps_LodashFp_.pick)(["isSaving","description","status","title","timelineType"],getTimeline(state,timelineId))),prevIsSaving=usePrevious_default()(isSaving),dispatch=Object(lib.useDispatch)(),handleCreateNewTimeline=Object(use_create_timeline.a)({timelineId:types_timeline.g.active,timelineType:types_timeline.k.default}),handleSubmit=Object(external_kbnSharedDeps_React_.useCallback)((titleAndDescription,isValid)=>(isValid&&dispatch(store_timeline.a.updateTitleAndDescription({id:timelineId,...titleAndDescription})),Promise.resolve()),[dispatch,timelineId]),initialState=Object(external_kbnSharedDeps_React_.useMemo)(()=>({title:title,description:description}),[title,description]),{form:form}=Object(shared_imports.I)({id:"timelineTitleAndDescriptionForm",schema:formSchema,onSubmit:handleSubmit,options:{stripEmptyFields:!1},defaultValue:initialState}),{isSubmitted:isSubmitted,isSubmitting:isSubmitting,submit:submit}=form,handleCancel=Object(external_kbnSharedDeps_React_.useCallback)(()=>{showWarning&&handleCreateNewTimeline(),closeSaveTimeline()},[closeSaveTimeline,handleCreateNewTimeline,showWarning]),closeModalText=Object(external_kbnSharedDeps_React_.useMemo)(()=>status===types_timeline.i.draft&&showWarning?timelineType===types_timeline.k.template?header_translations.e:header_translations.d:header_translations.c,[showWarning,status,timelineType]),modalHeader=Object(external_kbnSharedDeps_React_.useMemo)(()=>status===types_timeline.i.draft?timelineType===types_timeline.k.template?header_translations.l:header_translations.k:timelineType===types_timeline.k.template?header_translations.h:header_translations.g,[status,timelineType]),saveButtonTitle=Object(external_kbnSharedDeps_React_.useMemo)(()=>status===types_timeline.i.draft&&showWarning?timelineType===types_timeline.k.template?header_translations.l:header_translations.k:header_translations.j,[showWarning,status,timelineType]),calloutMessage=Object(external_kbnSharedDeps_React_.useMemo)(()=>header_translations.p(timelineType),[timelineType]),descriptionLabel=Object(external_kbnSharedDeps_React_.useMemo)(()=>`${header_translations.m} (${header_translations.i})`,[]),titleFieldProps=Object(external_kbnSharedDeps_React_.useMemo)(()=>({"aria-label":header_translations.n,autoFocus:"title"===initialFocus,"data-test-subj":"save-timeline-title",disabled:isSaving,spellCheck:!0,placeholder:timelineType===types_timeline.k.template?properties_translations.k:properties_translations.l}),[initialFocus,isSaving,timelineType]),descriptionFieldProps=Object(external_kbnSharedDeps_React_.useMemo)(()=>({"aria-label":header_translations.m,autoFocus:"description"===initialFocus,"data-test-subj":"save-timeline-description",disabled:isSaving,placeholder:properties_translations.f}),[initialFocus,isSaving]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{isSubmitted&&!isSaving&&prevIsSaving&&closeSaveTimeline()},[isSubmitted,isSaving,prevIsSaving,closeSaveTimeline]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModal,{"data-test-subj":"save-timeline-modal",maxWidth:1024,onClose:closeSaveTimeline},isSaving&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiProgress,{size:"s",color:"primary",position:"absolute","data-test-subj":"progress-bar"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalHeader,{"data-test-subj":"modal-header"},modalHeader),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalBody,null,showWarning&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:calloutMessage,color:"danger",iconType:"alert","data-test-subj":"save-timeline-callout"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"})),external_kbnSharedDeps_React_default.a.createElement(shared_imports.f,{form:form},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!0},external_kbnSharedDeps_React_default.a.createElement(CommonUseField,{path:"title",fullWidth:!0,label:header_translations.o,euiFieldProps:titleFieldProps}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!0},external_kbnSharedDeps_React_default.a.createElement(CommonUseField,{label:descriptionLabel,path:"description",fullWidth:!0,euiFieldProps:descriptionFieldProps}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,component:"span"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{size:"s",fill:!1,onClick:handleCancel,isDisabled:isSaving,"data-test-subj":"close-button"},closeModalText)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,component:"span"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{size:"s",isDisabled:isSaving||isSubmitting,fill:!0,onClick:submit,"data-test-subj":"save-button"},saveButtonTitle)))))))});TimelineTitleAndDescription.displayName="TimelineTitleAndDescription";const SaveTimelineButton=external_kbnSharedDeps_React_default.a.memo(({initialFocus:initialFocus,timelineId:timelineId,toolTip:toolTip})=>{const dispatch=Object(lib.useDispatch)(),getTimelineSaveModal=Object(external_kbnSharedDeps_React_.useMemo)(()=>Object(reselect_lib.createSelector)(store_timeline.b.selectTimeline,timeline=>{var _timeline$showSaveMod;return null!==(_timeline$showSaveMod=null==timeline?void 0:timeline.showSaveModal)&&void 0!==_timeline$showSaveMod&&_timeline$showSaveMod}),[]),show=Object(use_selector.a)(state=>getTimelineSaveModal(state,timelineId)),[showSaveTimelineOverlay,setShowSaveTimelineOverlay]=Object(external_kbnSharedDeps_React_.useState)(!1),closeSaveTimeline=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setShowSaveTimelineOverlay(!1),show&&dispatch(store_timeline.a.toggleModalSaveTimeline({id:types_timeline.g.active,showModalSaveTimeline:!1}))},[dispatch,setShowSaveTimelineOverlay,show]),openSaveTimeline=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setShowSaveTimelineOverlay(!0)},[setShowSaveTimelineOverlay]),saveTimelineButtonIcon=Object(external_kbnSharedDeps_React_.useMemo)(()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{"aria-label":header_translations.f,onClick:openSaveTimeline,iconType:"pencil","data-test-subj":"save-timeline-button-icon"}),[openSaveTimeline]);return"title"===initialFocus&&show||showSaveTimelineOverlay?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,saveTimelineButtonIcon,external_kbnSharedDeps_React_default.a.createElement(TimelineTitleAndDescription,{"data-test-subj":"save-timeline-modal-comp",closeSaveTimeline:closeSaveTimeline,initialFocus:initialFocus,timelineId:timelineId,showWarning:"title"===initialFocus&&show})):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{content:null!=toolTip?toolTip:"","data-test-subj":"save-timeline-btn-tooltip"},saveTimelineButtonIcon)});SaveTimelineButton.displayName="SaveTimelineButton";var inspect=__webpack_require__(191),external_kbnSharedDeps_Rxjs_=__webpack_require__(15),search_strategy=__webpack_require__(118),public_=__webpack_require__(81),use_app_toasts=__webpack_require__(115);const FAIL_TIMELINE_KPI_DETAILS=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.timeline.kpiFailDescription",{defaultMessage:"An error has occurred"}),FAIL_TIMELINE_KPI_SEARCH_DETAILS=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.timeline.kpiFailSearchDescription",{defaultMessage:"Failed to load KPIs"});var sourcerer=__webpack_require__(130),selectors=__webpack_require__(187),model=__webpack_require__(124),use_timeline_events_count=__webpack_require__(377);const CLOSE_TIMELINE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.timeline.flyout.header.closeTimelineButtonLabel",{defaultMessage:"Close timeline"}),UNSAVED=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.timeline.properties.unsavedLabel",{defaultMessage:"Unsaved"}),AUTOSAVED=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.timeline.properties.autosavedLabel",{defaultMessage:"Autosaved"}),INSPECT_TIMELINE_TITLE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.timeline.properties.inspectTimelineTitle",{defaultMessage:"Timeline"}),PROCESS_KPI_TITLE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.timeline.kpis.processKpiTitle",{defaultMessage:"Processes"}),HOST_KPI_TITLE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.timeline.kpis.hostKpiTitle",{defaultMessage:"Hosts"}),SOURCE_IP_KPI_TITLE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.timeline.kpis.sourceIpKpiTitle",{defaultMessage:"Source IPs"}),DESTINATION_IP_KPI_TITLE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.timeline.kpis.destinationKpiTitle",{defaultMessage:"Destination IPs"}),USER_KPI_TITLE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.timeline.kpis.userKpiTitle",{defaultMessage:"Users"}),TIMELINE_TOGGLE_BUTTON_ARIA_LABEL=({isOpen:isOpen,title:title})=>external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.timeline.properties.timelineToggleButtonAriaLabel",{values:{isOpen:isOpen,title:title},defaultMessage:"{isOpen, select, false {Open} true {Close} other {Toggle}} timeline {title}"}),ButtonWrapper=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexItem).withConfig({displayName:"ButtonWrapper",componentId:"sc-4g9vxo-0"})(["flex-direction:row;align-items:center;"]),EuiHealthStyled=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiHealth).withConfig({displayName:"EuiHealthStyled",componentId:"sc-4g9vxo-1"})(["display:block;"]),StyledEuiButtonEmpty=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty).withConfig({displayName:"StyledEuiButtonEmpty",componentId:"sc-4g9vxo-2"})(["> span{padding:0;}"]),ActiveTimelinesComponent=({timelineId:timelineId,timelineStatus:timelineStatus,timelineType:timelineType,timelineTitle:timelineTitle,updated:updated,isOpen:isOpen})=>{const dispatch=Object(lib.useDispatch)(),handleToggleOpen=Object(external_kbnSharedDeps_React_.useCallback)(()=>{dispatch(store_timeline.a.showTimeline({id:timelineId,show:!isOpen})),Object(timeline_helpers.l)()},[dispatch,isOpen,timelineId]),title=Object(external_kbnSharedDeps_LodashFp_.isEmpty)(timelineTitle)?timelineType===types_timeline.k.template?properties_translations.k:properties_translations.l:timelineTitle,tooltipContent=Object(external_kbnSharedDeps_React_.useMemo)(()=>timelineStatus===types_timeline.i.draft?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,UNSAVED):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,AUTOSAVED," ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedRelative,{"data-test-subj":"timeline-status",key:"timeline-status-autosaved",value:new Date(updated)})),[timelineStatus,updated]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"none"},external_kbnSharedDeps_React_default.a.createElement(ButtonWrapper,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(StyledEuiButtonEmpty,{"aria-label":TIMELINE_TOGGLE_BUTTON_ARIA_LABEL({isOpen:isOpen,title:title}),className:timeline_helpers.b,flush:"both","data-test-subj":"flyoutOverlay",size:"s",isSelected:isOpen,onClick:handleToggleOpen},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"none",alignItems:"center",justifyContent:"flexStart"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{position:"top",content:tooltipContent},external_kbnSharedDeps_React_default.a.createElement(EuiHealthStyled,{color:timelineStatus===types_timeline.i.draft?"warning":"success"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},title),!isOpen&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(use_timeline_events_count.b,null))))))},ActiveTimelines=external_kbnSharedDeps_React_default.a.memo(ActiveTimelinesComponent);var external_kbnSharedDeps_ElasticNumeral_=__webpack_require__(85),external_kbnSharedDeps_ElasticNumeral_default=__webpack_require__.n(external_kbnSharedDeps_ElasticNumeral_),empty_value=__webpack_require__(122);const NoWrapEuiStat=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiStat).withConfig({displayName:"NoWrapEuiStat",componentId:"sc-9jxvke-0"})(["& .euiStat__description{white-space:nowrap;}"]),TimelineKPIs=external_kbnSharedDeps_React_default.a.memo(({kpis:kpis,isLoading:isLoading})=>{const[defaultNumberFormat]=Object(kibana.l)(constants.B),formattedKpis=Object(external_kbnSharedDeps_React_.useMemo)(()=>({process:null===kpis?Object(empty_value.e)():external_kbnSharedDeps_ElasticNumeral_default()(kpis.processCount).format("0,0.[000]a"),user:null===kpis?Object(empty_value.e)():external_kbnSharedDeps_ElasticNumeral_default()(kpis.userCount).format("0,0.[000]a"),host:null===kpis?Object(empty_value.e)():external_kbnSharedDeps_ElasticNumeral_default()(kpis.hostCount).format("0,0.[000]a"),sourceIp:null===kpis?Object(empty_value.e)():external_kbnSharedDeps_ElasticNumeral_default()(kpis.sourceIpCount).format("0,0.[000]a"),destinationIp:null===kpis?Object(empty_value.e)():external_kbnSharedDeps_ElasticNumeral_default()(kpis.destinationIpCount).format("0,0.[000]a")}),[kpis]),formattedKpiToolTips=Object(external_kbnSharedDeps_React_.useMemo)(()=>({process:external_kbnSharedDeps_ElasticNumeral_default()(null==kpis?void 0:kpis.processCount).format(defaultNumberFormat),user:external_kbnSharedDeps_ElasticNumeral_default()(null==kpis?void 0:kpis.userCount).format(defaultNumberFormat),host:external_kbnSharedDeps_ElasticNumeral_default()(null==kpis?void 0:kpis.hostCount).format(defaultNumberFormat),sourceIp:external_kbnSharedDeps_ElasticNumeral_default()(null==kpis?void 0:kpis.sourceIpCount).format(defaultNumberFormat),destinationIp:external_kbnSharedDeps_ElasticNumeral_default()(null==kpis?void 0:kpis.destinationIpCount).format(defaultNumberFormat)}),[kpis,defaultNumberFormat]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{wrap:!0,"data-test-subj":"siem-timeline-kpis"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{position:"left",content:formattedKpiToolTips.process},external_kbnSharedDeps_React_default.a.createElement(NoWrapEuiStat,{"data-test-subj":"siem-timeline-process-kpi",title:formattedKpis.process,description:PROCESS_KPI_TITLE,titleSize:"s",isLoading:isLoading}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{position:"left",content:formattedKpiToolTips.user},external_kbnSharedDeps_React_default.a.createElement(NoWrapEuiStat,{"data-test-subj":"siem-timeline-user-kpi",title:formattedKpis.user,description:USER_KPI_TITLE,titleSize:"s",isLoading:isLoading}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{position:"left",content:formattedKpiToolTips.host},external_kbnSharedDeps_React_default.a.createElement(NoWrapEuiStat,{"data-test-subj":"siem-timeline-host-kpi",title:formattedKpis.host,description:HOST_KPI_TITLE,titleSize:"s",isLoading:isLoading}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{position:"left",content:formattedKpiToolTips.sourceIp},external_kbnSharedDeps_React_default.a.createElement(NoWrapEuiStat,{"data-test-subj":"siem-timeline-source-ip-kpi",title:formattedKpis.sourceIp,description:SOURCE_IP_KPI_TITLE,titleSize:"s",isLoading:isLoading}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,style:{minWidth:100}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{position:"left",content:formattedKpiToolTips.destinationIp},external_kbnSharedDeps_React_default.a.createElement(NoWrapEuiStat,{"data-test-subj":"siem-timeline-destination-ip-kpi",title:formattedKpis.destinationIp,description:DESTINATION_IP_KPI_TITLE,titleSize:"s",isLoading:isLoading}))))});TimelineKPIs.displayName="TimelineKPIs";const StyledPanel=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiPanel).withConfig({displayName:"StyledPanel",componentId:"sc-12xgwp3-0"})(["margin:0 -1px 0;"]),FlyoutHeaderPanelComponent=({timelineId:timelineId})=>{const dispatch=Object(lib.useDispatch)(),getTimeline=Object(external_kbnSharedDeps_React_.useMemo)(()=>store_timeline.b.getTimelineByIdSelector(),[]),{activeTab:activeTab,dataProviders:dataProviders,kqlQuery:kqlQuery,title:title,timelineType:timelineType,status:timelineStatus,updated:updated,show:show}=Object(use_selector.a)(state=>{var _getTimeline;return Object(external_kbnSharedDeps_LodashFp_.pick)(["activeTab","dataProviders","kqlQuery","status","title","timelineType","updated","show"],null!==(_getTimeline=getTimeline(state,timelineId))&&void 0!==_getTimeline?_getTimeline:defaults.a)}),isDataInTimeline=Object(external_kbnSharedDeps_React_.useMemo)(()=>!Object(external_kbnSharedDeps_LodashFp_.isEmpty)(dataProviders)||!Object(external_kbnSharedDeps_LodashFp_.isEmpty)(Object(external_kbnSharedDeps_LodashFp_.get)("filterQuery.kuery.expression",kqlQuery)),[dataProviders,kqlQuery]),handleClose=Object(external_kbnSharedDeps_React_.useCallback)(()=>{dispatch(store_timeline.a.showTimeline({id:timelineId,show:!1})),Object(timeline_helpers.l)()},[dispatch,timelineId]);return external_kbnSharedDeps_React_default.a.createElement(StyledPanel,{borderRadius:"none",grow:!1,paddingSize:"s",hasShadow:!1,"data-test-subj":"timeline-flyout-header-panel"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(add_timeline_button.b,{timelineId:timelineId}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!0},external_kbnSharedDeps_React_default.a.createElement(ActiveTimelines,{timelineId:timelineId,timelineType:timelineType,timelineTitle:title,timelineStatus:timelineStatus,isOpen:show,updated:updated})),show&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s"},(activeTab===types_timeline.j.query||activeTab===types_timeline.j.eql)&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(inspect.a,{compact:!0,queryId:`${timelineId}-${activeTab}`,inputId:"timeline",inspectIndex:0,isDisabled:!isDataInTimeline,title:INSPECT_TIMELINE_TITLE})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{content:CLOSE_TIMELINE},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{"aria-label":CLOSE_TIMELINE,"data-test-subj":"close-timeline",iconType:"cross",onClick:handleClose})))))))},FlyoutHeaderPanel=external_kbnSharedDeps_React_default.a.memo(FlyoutHeaderPanelComponent),StyledTimelineHeader=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup).withConfig({displayName:"StyledTimelineHeader",componentId:"sc-12xgwp3-1"})([""," flex:0;"],({theme:theme})=>`margin: ${theme.eui.euiSizeXS} ${theme.eui.euiSizeS} 0 ${theme.eui.euiSizeS};`),TimelineStatusInfoContainer=external_kbnSharedDeps_StyledComponents_default.a.span.withConfig({displayName:"TimelineStatusInfoContainer",componentId:"sc-12xgwp3-2"})(["",""],({theme:theme})=>`margin-left: ${theme.eui.euiSizeS};`),KpisContainer=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"KpisContainer",componentId:"sc-12xgwp3-3"})(["",""],({theme:theme})=>`margin-right: ${theme.eui.euiSizeM};`),RowFlexItem=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexItem).withConfig({displayName:"RowFlexItem",componentId:"sc-12xgwp3-4"})(["flex-direction:row;align-items:center;"]),TimelineNameComponent=({timelineId:timelineId})=>{const getTimeline=Object(external_kbnSharedDeps_React_.useMemo)(()=>store_timeline.b.getTimelineByIdSelector(),[]),{title:title,timelineType:timelineType}=Object(use_selector.a)(state=>{var _getTimeline2;return Object(external_kbnSharedDeps_LodashFp_.pick)(["title","timelineType"],null!==(_getTimeline2=getTimeline(state,timelineId))&&void 0!==_getTimeline2?_getTimeline2:defaults.a)}),placeholder=Object(external_kbnSharedDeps_React_.useMemo)(()=>timelineType===types_timeline.k.template?properties_translations.k:properties_translations.l,[timelineType]),content=Object(external_kbnSharedDeps_React_.useMemo)(()=>title.length?title:placeholder,[title,placeholder]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement("h3",{"data-test-subj":"timeline-title"},content))},TimelineName=external_kbnSharedDeps_React_default.a.memo(TimelineNameComponent),TimelineDescriptionComponent=({timelineId:timelineId})=>{const getTimeline=Object(external_kbnSharedDeps_React_.useMemo)(()=>store_timeline.b.getTimelineByIdSelector(),[]),description=Object(use_selector.a)(state=>{var _getTimeline3;return(null!==(_getTimeline3=getTimeline(state,timelineId))&&void 0!==_getTimeline3?_getTimeline3:defaults.a).description}),content=Object(external_kbnSharedDeps_React_.useMemo)(()=>description.length?description:properties_translations.f,[description]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"s","data-test-subj":"timeline-description"},content)},TimelineDescription=external_kbnSharedDeps_React_default.a.memo(TimelineDescriptionComponent),TimelineStatusInfoComponent=({timelineId:timelineId})=>{const getTimelineStatus=Object(external_kbnSharedDeps_React_.useMemo)(()=>Object(reselect_lib.createSelector)(store_timeline.b.selectTimeline,timeline=>{var _timeline$status,_timeline$updated;return{status:null!==(_timeline$status=null==timeline?void 0:timeline.status)&&void 0!==_timeline$status?_timeline$status:types_timeline.i.draft,updated:null!==(_timeline$updated=null==timeline?void 0:timeline.updated)&&void 0!==_timeline$updated?_timeline$updated:void 0}}),[]),{status:timelineStatus,updated:updated}=Object(use_selector.a)(state=>getTimelineStatus(state,timelineId));return Object(external_kbnSharedDeps_React_.useMemo)(()=>timelineStatus===types_timeline.i.draft,[timelineStatus])?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTextColor,{color:"warning","data-test-subj":"timeline-status"},UNSAVED)):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTextColor,{color:"default"},AUTOSAVED," ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedRelative,{"data-test-subj":"timeline-status",key:"timeline-status-autosaved",value:new Date(updated)})))},TimelineStatusInfo=external_kbnSharedDeps_React_default.a.memo(TimelineStatusInfoComponent),FlyoutHeaderComponent=({timelineId:timelineId})=>{var _combinedQueries$filt;const{selectedPatterns:selectedPatterns,indexPattern:indexPattern,docValueFields:docValueFields,browserFields:browserFields}=Object(sourcerer.b)(model.SourcererScopeName.timeline),getStartSelector=Object(external_kbnSharedDeps_React_.useMemo)(()=>Object(selectors.i)(),[]),getEndSelector=Object(external_kbnSharedDeps_React_.useMemo)(()=>Object(selectors.b)(),[]),isActive=Object(external_kbnSharedDeps_React_.useMemo)(()=>timelineId===types_timeline.g.active,[timelineId]),timerange=Object(use_selector.a)(state=>isActive?{from:getStartSelector(state.inputs.timeline),to:getEndSelector(state.inputs.timeline),interval:""}:{from:getStartSelector(state.inputs.global),to:getEndSelector(state.inputs.global),interval:""}),{uiSettings:uiSettings}=Object(kibana.h)().services,esQueryConfig=Object(external_kbnSharedDeps_React_.useMemo)(()=>public_.esQuery.getEsQueryConfig(uiSettings),[uiSettings]),getTimeline=Object(external_kbnSharedDeps_React_.useMemo)(()=>store_timeline.b.getTimelineByIdSelector(),[]),timeline=Object(lib.useSelector)(state=>{var _getTimeline4;return null!==(_getTimeline4=getTimeline(state,timelineId))&&void 0!==_getTimeline4?_getTimeline4:defaults.a}),{dataProviders:dataProviders,filters:filters,timelineType:timelineType,kqlMode:kqlMode,activeTab:activeTab}=timeline,getKqlQueryTimeline=Object(external_kbnSharedDeps_React_.useMemo)(()=>store_timeline.b.getKqlFilterQuerySelector(),[]),kqlQueryTimeline=Object(lib.useSelector)(state=>getKqlQueryTimeline(state,timelineId)),kqlQueryExpression=Object(external_kbnSharedDeps_LodashFp_.isEmpty)(dataProviders)&&Object(external_kbnSharedDeps_LodashFp_.isEmpty)(kqlQueryTimeline)&&"template"===timelineType?" ":kqlQueryTimeline,kqlQuery=Object(external_kbnSharedDeps_React_.useMemo)(()=>({query:kqlQueryExpression,language:"kuery"}),[kqlQueryExpression]),isBlankTimeline=Object(external_kbnSharedDeps_React_.useMemo)(()=>Object(external_kbnSharedDeps_LodashFp_.isEmpty)(dataProviders)&&Object(external_kbnSharedDeps_LodashFp_.isEmpty)(filters)&&Object(external_kbnSharedDeps_LodashFp_.isEmpty)(kqlQuery.query),[dataProviders,filters,kqlQuery]),combinedQueries=Object(external_kbnSharedDeps_React_.useMemo)(()=>Object(timeline_helpers.k)({config:esQueryConfig,dataProviders:dataProviders,indexPattern:indexPattern,browserFields:browserFields,filters:filters||[],kqlQuery:kqlQuery,kqlMode:kqlMode}),[browserFields,dataProviders,esQueryConfig,filters,indexPattern,kqlMode,kqlQuery]),[loading,kpis]=(({timerange:timerange,filterQuery:filterQuery,docValueFields:docValueFields,defaultIndex:defaultIndex,isBlankTimeline:isBlankTimeline})=>{const{data:data}=Object(kibana.h)().services,refetch=Object(external_kbnSharedDeps_React_.useRef)(external_kbnSharedDeps_LodashFp_.noop),abortCtrl=Object(external_kbnSharedDeps_React_.useRef)(new AbortController),searchSubscription$=Object(external_kbnSharedDeps_React_.useRef)(new external_kbnSharedDeps_Rxjs_.Subscription),[loading,setLoading]=Object(external_kbnSharedDeps_React_.useState)(!1),[timelineKpiRequest,setTimelineKpiRequest]=Object(external_kbnSharedDeps_React_.useState)(null),[timelineKpiResponse,setTimelineKpiResponse]=Object(external_kbnSharedDeps_React_.useState)(null),{addError:addError,addWarning:addWarning}=Object(use_app_toasts.a)(),timelineKpiSearch=Object(external_kbnSharedDeps_React_.useCallback)(request=>{if(null==request)return;const asyncSearch=async()=>{abortCtrl.current=new AbortController,setLoading(!0),searchSubscription$.current=data.search.search(request,{strategy:"securitySolutionTimelineSearchStrategy",abortSignal:abortCtrl.current.signal}).subscribe({next:response=>{Object(public_.isCompleteResponse)(response)?(setLoading(!1),setTimelineKpiResponse(response),searchSubscription$.current.unsubscribe()):Object(public_.isErrorResponse)(response)&&(setLoading(!1),addWarning(FAIL_TIMELINE_KPI_DETAILS),searchSubscription$.current.unsubscribe())},error:msg=>{setLoading(!1),addError(msg,{title:FAIL_TIMELINE_KPI_SEARCH_DETAILS}),searchSubscription$.current.unsubscribe()}})};searchSubscription$.current.unsubscribe(),abortCtrl.current.abort(),asyncSearch(),refetch.current=asyncSearch},[data.search,addError,addWarning]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{setTimelineKpiRequest(prevRequest=>{const myRequest={...null!=prevRequest?prevRequest:{},docValueFields:docValueFields,defaultIndex:defaultIndex,timerange:timerange,filterQuery:filterQuery,factoryQueryType:search_strategy.TimelineEventsQueries.kpi};return fast_deep_equal_default()(prevRequest,myRequest)?prevRequest:myRequest})},[docValueFields,defaultIndex,timerange,filterQuery]),Object(external_kbnSharedDeps_React_.useEffect)(()=>(isBlankTimeline?(setLoading(!1),setTimelineKpiResponse(null)):timelineKpiSearch(timelineKpiRequest),()=>{searchSubscription$.current.unsubscribe(),abortCtrl.current.abort()}),[isBlankTimeline,timelineKpiRequest,timelineKpiSearch]),[loading,timelineKpiResponse]})({defaultIndex:selectedPatterns,docValueFields:docValueFields,timerange:timerange,isBlankTimeline:isBlankTimeline,filterQuery:null!==(_combinedQueries$filt=null==combinedQueries?void 0:combinedQueries.filterQuery)&&void 0!==_combinedQueries$filt?_combinedQueries$filt:""});return external_kbnSharedDeps_React_default.a.createElement(StyledTimelineHeader,{alignItems:"center",gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{"data-test-subj":"properties-left",direction:"column",gutterSize:"none"},external_kbnSharedDeps_React_default.a.createElement(RowFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(TimelineName,{timelineId:timelineId}),external_kbnSharedDeps_React_default.a.createElement(SaveTimelineButton,{timelineId:timelineId,initialFocus:"title"}),external_kbnSharedDeps_React_default.a.createElement(TimelineStatusInfoContainer,null,external_kbnSharedDeps_React_default.a.createElement(TimelineStatusInfo,{timelineId:timelineId}))),external_kbnSharedDeps_React_default.a.createElement(RowFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(TimelineDescription,{timelineId:timelineId}),external_kbnSharedDeps_React_default.a.createElement(SaveTimelineButton,{timelineId:timelineId,initialFocus:"description"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(KpisContainer,null,activeTab===types_timeline.j.query?external_kbnSharedDeps_React_default.a.createElement(TimelineKPIs,{kpis:kpis,isLoading:loading}):null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(properties_helpers.a,{timelineId:timelineId})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(AddToCaseButton,{timelineId:timelineId})))))};FlyoutHeaderComponent.displayName="FlyoutHeaderComponent";const FlyoutHeader=external_kbnSharedDeps_React_default.a.memo(FlyoutHeaderComponent),Container=external_kbnSharedDeps_StyledComponents_default.a.div.attrs(({$isGlobal:$isGlobal=!0})=>({style:{transform:$isGlobal?"translateY(calc(100% - 50px))":"translateY(calc(100% - 0px))"}})).withConfig({displayName:"Container",componentId:"oo43db-0"})(["position:fixed;left:0;bottom:0;user-select:none;width:100%;z-index:",";."," &{transform:none !important;}.","{background:",";border-radius:4px 4px 0 0;box-shadow:none;height:46px;}."," & .","{color:",";background:"," !important;border:1px solid ",";border-bottom:none;text-decoration:none;}"],({theme:theme})=>theme.eui.euiZLevel8+1,drag_and_drop_helpers.c,timeline_helpers.g,({theme:theme})=>Object(polished_lib.rgba)(theme.eui.euiPageBackgroundColor,1),drag_and_drop_helpers.c,timeline_helpers.g,({theme:theme})=>theme.eui.euiColorSuccess,({theme:theme})=>Object(polished_lib.rgba)(theme.eui.euiColorSuccess,.2),({theme:theme})=>theme.eui.euiColorSuccess);Container.displayName="Container";const DataProvidersPanel=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiPanel).withConfig({displayName:"DataProvidersPanel",componentId:"oo43db-1"})(["border-radius:0;padding:0 4px 0 4px;user-select:none;z-index:",";"],({theme:theme})=>theme.eui.euiZLevel9),FlyoutBottomBar=external_kbnSharedDeps_React_default.a.memo(({activeTab:activeTab,showDataproviders:showDataproviders,timelineId:timelineId})=>external_kbnSharedDeps_React_default.a.createElement(Container,{className:timeline_helpers.f,$isGlobal:showDataproviders,"data-test-subj":"flyoutBottomBar"},showDataproviders&&external_kbnSharedDeps_React_default.a.createElement(FlyoutHeaderPanel,{timelineId:timelineId}),(showDataproviders||!showDataproviders&&activeTab!==types_timeline.j.query)&&external_kbnSharedDeps_React_default.a.createElement(DataProvidersPanel,{paddingSize:"none"},external_kbnSharedDeps_React_default.a.createElement(data_providers.a,{timelineId:timelineId,"data-test-subj":"dataProviders-bottomBar"}))));FlyoutBottomBar.displayName="FlyoutBottomBar";var default_headers=__webpack_require__(152),accessibility_helpers=__webpack_require__(141),active_timeline_context=__webpack_require__(223),timeline_translations=__webpack_require__(262),app_selectors=__webpack_require__(408),timeline_selectors=__webpack_require__(288);const QUERY_TAB=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.timeline.tabs.queyTabTimelineTitle",{defaultMessage:"Query"}),EQL_TAB=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.timeline.tabs.eqlTabTimelineTitle",{defaultMessage:"Correlation"}),ANALYZER_TAB=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.timeline.tabs.analyserTabTimelineTitle",{defaultMessage:"Analyzer"}),NOTES_TAB=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.timeline.tabs.notesTabTimelineTitle",{defaultMessage:"Notes"}),PINNED_TAB=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.timeline.tabs.pinnedTabTimelineTitle",{defaultMessage:"Pinned"}),HideShowContainer=external_kbnSharedDeps_StyledComponents_default.a.div.attrs(({$isVisible:$isVisible=!1})=>({style:{display:$isVisible?"flex":"none"}})).withConfig({displayName:"HideShowContainer",componentId:"sc-14igzi1-0"})(["flex:1;overflow:hidden;"]),QueryTabContent=Object(external_kbnSharedDeps_React_.lazy)(()=>__webpack_require__.e(18).then(__webpack_require__.bind(null,1122))),EqlTabContent=Object(external_kbnSharedDeps_React_.lazy)(()=>__webpack_require__.e(19).then(__webpack_require__.bind(null,1126))),GraphTabContent=Object(external_kbnSharedDeps_React_.lazy)(()=>__webpack_require__.e(23).then(__webpack_require__.bind(null,1118))),NotesTabContent=Object(external_kbnSharedDeps_React_.lazy)(()=>__webpack_require__.e(24).then(__webpack_require__.bind(null,1127))),PinnedTabContent=Object(external_kbnSharedDeps_React_.lazy)(()=>__webpack_require__.e(25).then(__webpack_require__.bind(null,1119))),QueryTab=Object(external_kbnSharedDeps_React_.memo)(({renderCellValue:renderCellValue,rowRenderers:rowRenderers,timelineId:timelineId})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Suspense,{fallback:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingContent,{lines:10})},external_kbnSharedDeps_React_default.a.createElement(QueryTabContent,{renderCellValue:renderCellValue,rowRenderers:rowRenderers,timelineId:timelineId})));QueryTab.displayName="QueryTab";const EqlTab=Object(external_kbnSharedDeps_React_.memo)(({renderCellValue:renderCellValue,rowRenderers:rowRenderers,timelineId:timelineId})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Suspense,{fallback:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingContent,{lines:10})},external_kbnSharedDeps_React_default.a.createElement(EqlTabContent,{renderCellValue:renderCellValue,rowRenderers:rowRenderers,timelineId:timelineId})));EqlTab.displayName="EqlTab";const GraphTab=Object(external_kbnSharedDeps_React_.memo)(({timelineId:timelineId})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Suspense,{fallback:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingContent,{lines:10})},external_kbnSharedDeps_React_default.a.createElement(GraphTabContent,{timelineId:timelineId})));GraphTab.displayName="GraphTab";const NotesTab=Object(external_kbnSharedDeps_React_.memo)(({timelineId:timelineId})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Suspense,{fallback:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingContent,{lines:10})},external_kbnSharedDeps_React_default.a.createElement(NotesTabContent,{timelineId:timelineId})));NotesTab.displayName="NotesTab";const PinnedTab=Object(external_kbnSharedDeps_React_.memo)(({renderCellValue:renderCellValue,rowRenderers:rowRenderers,timelineId:timelineId})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Suspense,{fallback:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingContent,{lines:10})},external_kbnSharedDeps_React_default.a.createElement(PinnedTabContent,{renderCellValue:renderCellValue,rowRenderers:rowRenderers,timelineId:timelineId})));PinnedTab.displayName="PinnedTab";const ActiveTimelineTab=Object(external_kbnSharedDeps_React_.memo)(({activeTimelineTab:activeTimelineTab,renderCellValue:renderCellValue,rowRenderers:rowRenderers,timelineId:timelineId,timelineType:timelineType})=>{const getTab=Object(external_kbnSharedDeps_React_.useCallback)(tab=>{switch(tab){case types_timeline.j.graph:return external_kbnSharedDeps_React_default.a.createElement(GraphTab,{timelineId:timelineId});case types_timeline.j.notes:return external_kbnSharedDeps_React_default.a.createElement(NotesTab,{timelineId:timelineId});default:return null}},[timelineId]),isGraphOrNotesTabs=Object(external_kbnSharedDeps_React_.useMemo)(()=>[types_timeline.j.graph,types_timeline.j.notes].includes(activeTimelineTab),[activeTimelineTab]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(HideShowContainer,{$isVisible:types_timeline.j.query===activeTimelineTab},external_kbnSharedDeps_React_default.a.createElement(QueryTab,{renderCellValue:renderCellValue,rowRenderers:rowRenderers,timelineId:timelineId})),external_kbnSharedDeps_React_default.a.createElement(HideShowContainer,{$isVisible:types_timeline.j.pinned===activeTimelineTab},external_kbnSharedDeps_React_default.a.createElement(PinnedTab,{renderCellValue:renderCellValue,rowRenderers:rowRenderers,timelineId:timelineId})),timelineType===types_timeline.k.default&&external_kbnSharedDeps_React_default.a.createElement(HideShowContainer,{$isVisible:types_timeline.j.eql===activeTimelineTab},external_kbnSharedDeps_React_default.a.createElement(EqlTab,{renderCellValue:renderCellValue,rowRenderers:rowRenderers,timelineId:timelineId})),external_kbnSharedDeps_React_default.a.createElement(HideShowContainer,{$isVisible:isGraphOrNotesTabs},isGraphOrNotesTabs&&getTab(activeTimelineTab)))});ActiveTimelineTab.displayName="ActiveTimelineTab";const CountBadge=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiBadge).withConfig({displayName:"CountBadge",componentId:"sc-14igzi1-1"})(["margin-left:",";"],({theme:theme})=>theme.eui.paddingSizes.s),StyledEuiTab=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiTab).withConfig({displayName:"StyledEuiTab",componentId:"sc-14igzi1-2"})(["> span{display:flex;flex-direction:row;white-space:pre;}:focus{text-decoration:none;> span > span{text-decoration:underline;}}"]),TabsContentComponent=({renderCellValue:renderCellValue,rowRenderers:rowRenderers,timelineId:timelineId,timelineFullScreen:timelineFullScreen,timelineType:timelineType,graphEventId:graphEventId})=>{const dispatch=Object(lib.useDispatch)(),getActiveTab=Object(external_kbnSharedDeps_React_.useMemo)(()=>Object(reselect_lib.createSelector)(timeline_selectors.selectTimeline,timeline=>{var _timeline$activeTab;return null!==(_timeline$activeTab=null==timeline?void 0:timeline.activeTab)&&void 0!==_timeline$activeTab?_timeline$activeTab:types_timeline.j.query}),[]),getShowTimeline=Object(external_kbnSharedDeps_React_.useMemo)(()=>Object(reselect_lib.createSelector)(timeline_selectors.selectTimeline,timeline=>{var _timeline$show;return null!==(_timeline$show=null==timeline?void 0:timeline.show)&&void 0!==_timeline$show&&_timeline$show}),[]),getNumberOfPinnedEvents=Object(external_kbnSharedDeps_React_.useMemo)(()=>Object(reselect_lib.createSelector)(timeline_selectors.selectTimeline,timeline=>{var _timeline$pinnedEvent;return Object.keys(null!==(_timeline$pinnedEvent=null==timeline?void 0:timeline.pinnedEventIds)&&void 0!==_timeline$pinnedEvent?_timeline$pinnedEvent:{}).length}),[]),getAppNotes=Object(external_kbnSharedDeps_React_.useMemo)(()=>Object(reselect_lib.createSelector)(app_selectors.selectNotesById,notesById=>Object.values(notesById)),[]),getTimelineNoteIds=Object(external_kbnSharedDeps_React_.useMemo)(()=>Object(reselect_lib.createSelector)(timeline_selectors.selectTimeline,timeline=>{var _timeline$noteIds;return null!==(_timeline$noteIds=null==timeline?void 0:timeline.noteIds)&&void 0!==_timeline$noteIds?_timeline$noteIds:[]}),[]),getTimelinePinnedEventNotes=Object(external_kbnSharedDeps_React_.useMemo)(()=>Object(reselect_lib.createSelector)(timeline_selectors.selectTimeline,timeline=>{var _timeline$eventIdToNo;return null!==(_timeline$eventIdToNo=null==timeline?void 0:timeline.eventIdToNoteIds)&&void 0!==_timeline$eventIdToNo?_timeline$eventIdToNo:{}}),[]),activeTab=Object(use_selector.b)(state=>getActiveTab(state,timelineId)),showTimeline=Object(use_selector.b)(state=>getShowTimeline(state,timelineId)),numberOfPinnedEvents=Object(use_selector.b)(state=>getNumberOfPinnedEvents(state,timelineId)),globalTimelineNoteIds=Object(use_selector.a)(state=>getTimelineNoteIds(state,timelineId)),eventIdToNoteIds=Object(use_selector.a)(state=>getTimelinePinnedEventNotes(state,timelineId)),appNotes=Object(use_selector.a)(state=>getAppNotes(state)),allTimelineNoteIds=Object(external_kbnSharedDeps_React_.useMemo)(()=>{const eventNoteIds=Object.values(eventIdToNoteIds).reduce((acc,v)=>[...acc,...v],[]);return[...globalTimelineNoteIds,...eventNoteIds]},[globalTimelineNoteIds,eventIdToNoteIds]),numberOfNotes=Object(external_kbnSharedDeps_React_.useMemo)(()=>appNotes.filter(appNote=>allTimelineNoteIds.includes(appNote.id)).length,[appNotes,allTimelineNoteIds]),setQueryAsActiveTab=Object(external_kbnSharedDeps_React_.useCallback)(()=>{dispatch(store_timeline.a.setActiveTabTimeline({id:timelineId,activeTab:types_timeline.j.query}))},[dispatch,timelineId]),setEqlAsActiveTab=Object(external_kbnSharedDeps_React_.useCallback)(()=>{dispatch(store_timeline.a.setActiveTabTimeline({id:timelineId,activeTab:types_timeline.j.eql}))},[dispatch,timelineId]),setGraphAsActiveTab=Object(external_kbnSharedDeps_React_.useCallback)(()=>{dispatch(store_timeline.a.setActiveTabTimeline({id:timelineId,activeTab:types_timeline.j.graph}))},[dispatch,timelineId]),setNotesAsActiveTab=Object(external_kbnSharedDeps_React_.useCallback)(()=>{dispatch(store_timeline.a.setActiveTabTimeline({id:timelineId,activeTab:types_timeline.j.notes}))},[dispatch,timelineId]),setPinnedAsActiveTab=Object(external_kbnSharedDeps_React_.useCallback)(()=>{dispatch(store_timeline.a.setActiveTabTimeline({id:timelineId,activeTab:types_timeline.j.pinned}))},[dispatch,timelineId]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{graphEventId||activeTab!==types_timeline.j.graph||setQueryAsActiveTab()},[activeTab,graphEventId,setQueryAsActiveTab]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,!timelineFullScreen&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTabs,null,external_kbnSharedDeps_React_default.a.createElement(StyledEuiTab,{"data-test-subj":"timelineTabs-"+types_timeline.j.query,onClick:setQueryAsActiveTab,isSelected:activeTab===types_timeline.j.query,disabled:!1,key:types_timeline.j.query},external_kbnSharedDeps_React_default.a.createElement("span",null,QUERY_TAB),showTimeline&&external_kbnSharedDeps_React_default.a.createElement(use_timeline_events_count.b,null)),timelineType===types_timeline.k.default&&external_kbnSharedDeps_React_default.a.createElement(StyledEuiTab,{"data-test-subj":"timelineTabs-"+types_timeline.j.eql,onClick:setEqlAsActiveTab,isSelected:activeTab===types_timeline.j.eql,disabled:!1,key:types_timeline.j.eql},external_kbnSharedDeps_React_default.a.createElement("span",null,EQL_TAB),showTimeline&&external_kbnSharedDeps_React_default.a.createElement(use_timeline_events_count.a,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTab,{"data-test-subj":"timelineTabs-"+types_timeline.j.graph,onClick:setGraphAsActiveTab,isSelected:activeTab===types_timeline.j.graph,disabled:!graphEventId,key:types_timeline.j.graph},ANALYZER_TAB),external_kbnSharedDeps_React_default.a.createElement(StyledEuiTab,{"data-test-subj":"timelineTabs-"+types_timeline.j.notes,onClick:setNotesAsActiveTab,isSelected:activeTab===types_timeline.j.notes,disabled:!1,key:types_timeline.j.notes},external_kbnSharedDeps_React_default.a.createElement("span",null,NOTES_TAB),showTimeline&&numberOfNotes>0&&external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(CountBadge,null,numberOfNotes))),external_kbnSharedDeps_React_default.a.createElement(StyledEuiTab,{"data-test-subj":"timelineTabs-"+types_timeline.j.pinned,onClick:setPinnedAsActiveTab,isSelected:activeTab===types_timeline.j.pinned,key:types_timeline.j.pinned},external_kbnSharedDeps_React_default.a.createElement("span",null,PINNED_TAB),showTimeline&&numberOfPinnedEvents>0&&external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(CountBadge,null,numberOfPinnedEvents)))),external_kbnSharedDeps_React_default.a.createElement(ActiveTimelineTab,{activeTimelineTab:activeTab,renderCellValue:renderCellValue,rowRenderers:rowRenderers,timelineId:timelineId,timelineType:timelineType}))},TabsContent=Object(external_kbnSharedDeps_React_.memo)(TabsContentComponent);var styles=__webpack_require__(147),use_full_screen=__webpack_require__(146),exit_full_screen=__webpack_require__(312);const TimelineTemplateBadge=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"TimelineTemplateBadge",componentId:"h40gwq-0"})(["background:",";color:#fff;padding:10px 15px;font-size:0.8em;"],({theme:theme})=>theme.eui.euiColorVis3_behindText),TimelineSavingProgressComponent=({timelineId:timelineId})=>{const getTimeline=Object(external_kbnSharedDeps_React_.useMemo)(()=>store_timeline.b.getTimelineByIdSelector(),[]);return Object(use_selector.b)(state=>{var _getTimeline;return(null!==(_getTimeline=getTimeline(state,timelineId))&&void 0!==_getTimeline?_getTimeline:defaults.a).isSaving})?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiProgress,{size:"s",color:"primary",position:"absolute"}):null},TimelineSavingProgress=external_kbnSharedDeps_React_default.a.memo(TimelineSavingProgressComponent),StatefulTimelineComponent=({renderCellValue:renderCellValue,rowRenderers:rowRenderers,timelineId:timelineId})=>{const dispatch=Object(lib.useDispatch)(),containerElement=Object(external_kbnSharedDeps_React_.useRef)(null),getTimeline=Object(external_kbnSharedDeps_React_.useMemo)(()=>store_timeline.b.getTimelineByIdSelector(),[]),{selectedPatterns:selectedPatterns}=Object(sourcerer.b)(model.SourcererScopeName.timeline),{graphEventId:graphEventId,savedObjectId:savedObjectId,timelineType:timelineType}=Object(use_selector.a)(state=>{var _getTimeline2;return Object(external_kbnSharedDeps_LodashFp_.pick)(["graphEventId","savedObjectId","timelineType"],null!==(_getTimeline2=getTimeline(state,timelineId))&&void 0!==_getTimeline2?_getTimeline2:defaults.a)}),{setTimelineFullScreen:setTimelineFullScreen,timelineFullScreen:timelineFullScreen}=Object(use_full_screen.b)();Object(external_kbnSharedDeps_React_.useEffect)(()=>{savedObjectId||dispatch(store_timeline.a.createTimeline({id:timelineId,columns:default_headers.c,indexNames:selectedPatterns,expandedDetail:active_timeline_context.a.getExpandedDetail(),show:!1}))},[]);const onSkipFocusBeforeEventsTable=Object(external_kbnSharedDeps_React_.useCallback)(()=>{var _containerElement$cur;const exitFullScreenButton=null===(_containerElement$cur=containerElement.current)||void 0===_containerElement$cur?void 0:_containerElement$cur.querySelector(exit_full_screen.a);var _containerElement$cur2,_containerElement$cur3;null!=exitFullScreenButton?exitFullScreenButton.focus():null===(_containerElement$cur2=containerElement.current)||void 0===_containerElement$cur2||null===(_containerElement$cur3=_containerElement$cur2.querySelector(".globalFilterBar__addButton"))||void 0===_containerElement$cur3||_containerElement$cur3.focus()},[containerElement]),onSkipFocusAfterEventsTable=Object(external_kbnSharedDeps_React_.useCallback)(()=>{var _containerElement$cur4,_containerElement$cur5;null===(_containerElement$cur4=containerElement.current)||void 0===_containerElement$cur4||null===(_containerElement$cur5=_containerElement$cur4.querySelector("."+timeline_helpers.e))||void 0===_containerElement$cur5||_containerElement$cur5.focus()},[]),onKeyDown=Object(external_kbnSharedDeps_React_.useCallback)(keyboardEvent=>{Object(accessibility_helpers.r)(keyboardEvent)&&Object(timeline_helpers.n)({containerElement:containerElement.current,keyboardEvent:keyboardEvent,onSkipFocusBeforeEventsTable:onSkipFocusBeforeEventsTable,onSkipFocusAfterEventsTable:onSkipFocusAfterEventsTable})},[containerElement,onSkipFocusBeforeEventsTable,onSkipFocusAfterEventsTable]);return external_kbnSharedDeps_React_default.a.createElement(styles.C,{"data-test-subj":"timeline","data-timeline-id":timelineId,onKeyDown:onKeyDown,ref:containerElement},external_kbnSharedDeps_React_default.a.createElement(TimelineSavingProgress,{timelineId:timelineId}),timelineType===types_timeline.k.template&&external_kbnSharedDeps_React_default.a.createElement(TimelineTemplateBadge,null,timeline_translations.e),external_kbnSharedDeps_React_default.a.createElement(styles.y,{$isVisible:!timelineFullScreen},external_kbnSharedDeps_React_default.a.createElement(FlyoutHeaderPanel,{timelineId:timelineId}),external_kbnSharedDeps_React_default.a.createElement(FlyoutHeader,{timelineId:timelineId})),external_kbnSharedDeps_React_default.a.createElement(TabsContent,{graphEventId:graphEventId,renderCellValue:renderCellValue,rowRenderers:rowRenderers,setTimelineFullScreen:setTimelineFullScreen,timelineId:timelineId,timelineType:timelineType,timelineFullScreen:timelineFullScreen}))};StatefulTimelineComponent.displayName="StatefulTimelineComponent";const StatefulTimeline=external_kbnSharedDeps_React_default.a.memo(StatefulTimelineComponent),TIMELINE_DESCRIPTION=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.timeline.flyout.pane.timelinePropertiesAriaLabel",{defaultMessage:"Timeline Properties"});var renderers=__webpack_require__(323),default_cell_renderer=__webpack_require__(398);const EuiFlyoutContainer=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"EuiFlyoutContainer",componentId:"jz8ju6-0"})([".timeline-flyout{z-index:",";min-width:150px;width:100%;animation:none;}"],({theme:theme})=>theme.eui.euiZLevel8),FlyoutPaneComponent=({timelineId:timelineId})=>{const dispatch=Object(lib.useDispatch)(),handleClose=Object(external_kbnSharedDeps_React_.useCallback)(()=>{dispatch(store_timeline.a.showTimeline({id:timelineId,show:!1})),Object(timeline_helpers.l)()},[dispatch,timelineId]);return external_kbnSharedDeps_React_default.a.createElement(EuiFlyoutContainer,{"data-test-subj":"flyout-pane"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyout,{"aria-label":TIMELINE_DESCRIPTION,className:"timeline-flyout","data-test-subj":"eui-flyout",hideCloseButton:!0,onClose:handleClose,size:"l"},external_kbnSharedDeps_React_default.a.createElement(StatefulTimeline,{renderCellValue:default_cell_renderer.a,rowRenderers:renderers.b,timelineId:timelineId})))},Pane=external_kbnSharedDeps_React_default.a.memo(FlyoutPaneComponent);Pane.displayName="Pane";const Visible=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"Visible",componentId:"sc-1m0i0a-0"})(["visibility:",";"],({show:show})=>show?"visible":"hidden");Visible.displayName="Visible";const FlyoutComponent=({timelineId:timelineId,onAppLeave:onAppLeave})=>{const dispatch=Object(lib.useDispatch)(),getTimelineShowStatus=Object(external_kbnSharedDeps_React_.useMemo)(()=>Object(reselect_lib.createSelector)(store_timeline.b.selectTimeline,timeline=>{var _timeline$activeTab,_timeline$status,_timeline$show,_timeline$updated;return{activeTab:null!==(_timeline$activeTab=null==timeline?void 0:timeline.activeTab)&&void 0!==_timeline$activeTab?_timeline$activeTab:types_timeline.j.query,status:null!==(_timeline$status=null==timeline?void 0:timeline.status)&&void 0!==_timeline$status?_timeline$status:types_timeline.i.draft,show:null!==(_timeline$show=null==timeline?void 0:timeline.show)&&void 0!==_timeline$show&&_timeline$show,updated:null!==(_timeline$updated=null==timeline?void 0:timeline.updated)&&void 0!==_timeline$updated?_timeline$updated:void 0}}),[]),{activeTab:activeTab,show:show,status:timelineStatus,updated:updated}=Object(use_selector.a)(state=>getTimelineShowStatus(state,timelineId)),[focusOwnership,setFocusOwnership]=Object(external_kbnSharedDeps_React_.useState)(!0),[triggerOnBlur,setTriggerOnBlur]=Object(external_kbnSharedDeps_React_.useState)(!0),callbackRef=Object(external_kbnSharedDeps_React_.useRef)(null),searchRef=Object(external_kbnSharedDeps_React_.useRef)(null),handleSearch=Object(external_kbnSharedDeps_React_.useCallback)(()=>{show&&!1===focusOwnership&&setFocusOwnership(!0)},[show,focusOwnership]),onOutsideClick=Object(external_kbnSharedDeps_React_.useCallback)(event=>{setFocusOwnership(!1);event.target.classList.contains("kbnSearchBar")&&(searchRef.current=event.target,setTriggerOnBlur(prev=>!prev),window.setTimeout(()=>{null!==searchRef.current&&searchRef.current.focus()},0))},[]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>(null!=searchRef.current&&(null!==callbackRef.current&&searchRef.current.removeEventListener("blur",callbackRef.current),searchRef.current.addEventListener("blur",handleSearch),callbackRef.current=handleSearch),()=>{null!=searchRef.current&&null!==callbackRef.current&&searchRef.current.removeEventListener("blur",callbackRef.current)}),[handleSearch,triggerOnBlur]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{onAppLeave((actions,nextAppId)=>{if(show&&dispatch(store_timeline.a.showTimeline({id:types_timeline.g.active,show:!1})),(null!=nextAppId?nextAppId:"").includes("securitySolution")||timelineStatus!==types_timeline.i.draft||null==updated)return actions.default();{const showSaveTimelineModal=()=>{dispatch(store_timeline.a.showTimeline({id:types_timeline.g.active,show:!0})),dispatch(store_timeline.a.setActiveTabTimeline({id:types_timeline.g.active,activeTab:types_timeline.j.query})),dispatch(store_timeline.a.toggleModalSaveTimeline({id:types_timeline.g.active,showModalSaveTimeline:!0}))};return actions.confirm(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.timeline.unsavedWorkMessage",{defaultMessage:"Leave Timeline with unsaved work?"}),external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.timeline.unsavedWorkTitle",{defaultMessage:"Unsaved changes"}),showSaveTimelineModal)}})},[dispatch,onAppLeave,show,timelineStatus,updated]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiOutsideClickDetector,{onOutsideClick:onOutsideClick},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFocusTrap,{disabled:!focusOwnership},external_kbnSharedDeps_React_default.a.createElement(Visible,{show:show},external_kbnSharedDeps_React_default.a.createElement(Pane,{timelineId:timelineId}))),external_kbnSharedDeps_React_default.a.createElement(FlyoutBottomBar,{activeTab:activeTab,timelineId:timelineId,showDataproviders:!show})))};FlyoutComponent.displayName="FlyoutComponent";const Flyout=external_kbnSharedDeps_React_default.a.memo(FlyoutComponent);Flyout.displayName="Flyout";var page=__webpack_require__(158),web=__webpack_require__(232),home_navigations=__webpack_require__(273),external_kbnSharedDeps_Moment_=__webpack_require__(25),external_kbnSharedDeps_Moment_default=__webpack_require__.n(external_kbnSharedDeps_Moment_),telemetry=__webpack_require__(43),api=__webpack_require__(728);const searchFilter=(jobs,filterQuery)=>jobs.filter(job=>null==filterQuery||(job.id.includes(filterQuery)||job.description.includes(filterQuery))),FILTER_PLACEHOLDER=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.components.mlPopover.jobsTable.filters.searchFilterPlaceholder",{defaultMessage:"e.g. rare_process_linux"}),GROUPS=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.components.mlPopover.jobsTable.filters.groupsLabel",{defaultMessage:"Groups"}),NO_GROUPS_AVAILABLE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.components.mlPopover.jobsTable.filters.noGroupsAvailableDescription",{defaultMessage:"No Groups available"}),SHOW_ELASTIC_JOBS=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.components.mlPopover.jobsTable.filters.showAllJobsLabel",{defaultMessage:"Elastic jobs"}),SHOW_CUSTOM_JOBS=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.components.mlPopover.jobsTable.filters.showSiemJobsLabel",{defaultMessage:"Custom jobs"});var toggle_selected_group=__webpack_require__(692);const GroupsFilterPopoverComponent=({securityJobs:securityJobs,onSelectedGroupsChanged:onSelectedGroupsChanged})=>{const[isGroupPopoverOpen,setIsGroupPopoverOpen]=Object(external_kbnSharedDeps_React_.useState)(!1),[selectedGroups,setSelectedGroups]=Object(external_kbnSharedDeps_React_.useState)([]),groups=securityJobs.map(j=>j.groups).flat().filter(g=>"siem"!==g&&"security"!==g),uniqueGroups=Array.from(new Set(groups));return Object(external_kbnSharedDeps_React_.useEffect)(()=>{onSelectedGroupsChanged(selectedGroups)},[selectedGroups.sort().join()]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopover,{ownFocus:!0,button:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFilterButton,{"data-test-subj":"groups-filter-popover-button",iconType:"arrowDown",onClick:()=>setIsGroupPopoverOpen(!isGroupPopoverOpen),isSelected:isGroupPopoverOpen,hasActiveFilters:selectedGroups.length>0,numActiveFilters:selectedGroups.length},GROUPS),isOpen:isGroupPopoverOpen,closePopover:()=>setIsGroupPopoverOpen(!isGroupPopoverOpen),panelPaddingSize:"none",repositionOnScroll:!0},uniqueGroups.map((group,index)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFilterSelectItem,{checked:selectedGroups.includes(group)?"on":void 0,key:`${index}-${group}`,onClick:()=>Object(toggle_selected_group.a)(group,selectedGroups,setSelectedGroups)},`${group} (${groups.filter(g=>g===group).length})`)),0===uniqueGroups.length&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"m",justifyContent:"spaceAround"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{type:"minusInCircle"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement("p",null,NO_GROUPS_AVAILABLE))))};GroupsFilterPopoverComponent.displayName="GroupsFilterPopoverComponent";const GroupsFilterPopover=external_kbnSharedDeps_React_default.a.memo(GroupsFilterPopoverComponent);GroupsFilterPopover.displayName="GroupsFilterPopover";const JobsTableFiltersComponent=({securityJobs:securityJobs,onFilterChanged:onFilterChanged})=>{const[filterQuery,setFilterQuery]=Object(external_kbnSharedDeps_React_.useState)(""),[selectedGroups,setSelectedGroups]=Object(external_kbnSharedDeps_React_.useState)([]),[showCustomJobs,setShowCustomJobs]=Object(external_kbnSharedDeps_React_.useState)(!1),[showElasticJobs,setShowElasticJobs]=Object(external_kbnSharedDeps_React_.useState)(!1);Object(external_kbnSharedDeps_React_.useEffect)(()=>{onFilterChanged({filterQuery:filterQuery,showCustomJobs:showCustomJobs,showElasticJobs:showElasticJobs,selectedGroups:selectedGroups})},[filterQuery,selectedGroups,showCustomJobs,showElasticJobs,onFilterChanged]);const handleChange=Object(external_kbnSharedDeps_React_.useCallback)(query=>setFilterQuery(query.queryText.trim()),[setFilterQuery]),handleElasticJobsClick=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setShowElasticJobs(!showElasticJobs),setShowCustomJobs(!1)},[setShowElasticJobs,showElasticJobs,setShowCustomJobs]),handleCustomJobsClick=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setShowCustomJobs(!showCustomJobs),setShowElasticJobs(!1)},[setShowElasticJobs,showCustomJobs,setShowCustomJobs]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"m",justifyContent:"flexEnd"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSearchBar,{"data-test-subj":"jobs-filter-bar",box:{placeholder:FILTER_PLACEHOLDER,incremental:!0},onChange:handleChange})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFilterGroup,null,external_kbnSharedDeps_React_default.a.createElement(GroupsFilterPopover,{securityJobs:securityJobs,onSelectedGroupsChanged:setSelectedGroups}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFilterGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFilterButton,{hasActiveFilters:showElasticJobs,onClick:handleElasticJobsClick,"data-test-subj":"show-elastic-jobs-filter-button",withNext:!0},SHOW_ELASTIC_JOBS),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFilterButton,{hasActiveFilters:showCustomJobs,onClick:handleCustomJobsClick,"data-test-subj":"show-custom-jobs-filter-button"},SHOW_CUSTOM_JOBS))))};JobsTableFiltersComponent.displayName="JobsTableFiltersComponent";const JobsTableFilters=external_kbnSharedDeps_React_default.a.memo(JobsTableFiltersComponent);JobsTableFilters.displayName="JobsTableFilters";const COLUMN_JOB_NAME=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.components.mlPopup.jobsTable.jobNameColumn",{defaultMessage:"Job name"}),COLUMN_GROUPS=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.components.mlPopup.jobsTable.tagsColumn",{defaultMessage:"Groups"}),COLUMN_RUN_JOB=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.components.mlPopup.jobsTable.runJobColumn",{defaultMessage:"Run job"}),NO_ITEMS_TEXT=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.components.mlPopup.jobsTable.noItemsDescription",{defaultMessage:"No Security Machine Learning jobs found"}),CREATE_CUSTOM_JOB=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.components.mlPopup.jobsTable.createCustomJobButtonLabel",{defaultMessage:"Create custom job"});var machine_learning_helpers=__webpack_require__(216);const StaticSwitch=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiSwitch).withConfig({displayName:"StaticSwitch",componentId:"sc-1xsgv9-0"})([".euiSwitch__thumb,.euiSwitch__icon{transition:none;}"]);StaticSwitch.displayName="StaticSwitch";const JobSwitchComponent=({job:job,isSecurityJobsLoading:isSecurityJobsLoading,onJobStateChange:onJobStateChange})=>{const[isLoading,setIsLoading]=Object(external_kbnSharedDeps_React_.useState)(!1),handleChange=Object(external_kbnSharedDeps_React_.useCallback)(async e=>{setIsLoading(!0),await onJobStateChange(job,job.latestTimestampMs||0,e.target.checked),setIsLoading(!1)},[job,setIsLoading,onJobStateChange]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceAround"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},isSecurityJobsLoading||isLoading||Object(machine_learning_helpers.b)(job.jobState,job.datafeedState)?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingSpinner,{size:"m","data-test-subj":"job-switch-loader"}):external_kbnSharedDeps_React_default.a.createElement(StaticSwitch,{"data-test-subj":"job-switch",disabled:Object(machine_learning_helpers.a)(job.jobState,job.datafeedState),checked:Object(machine_learning_helpers.c)(job.jobState,job.datafeedState),onChange:handleChange,showLabel:!1,label:""})))};JobSwitchComponent.displayName="JobSwitchComponent";const JobSwitch=external_kbnSharedDeps_React_default.a.memo(JobSwitchComponent);JobSwitch.displayName="JobSwitch";var ml_public_=__webpack_require__(95);const JobNameWrapper=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"JobNameWrapper",componentId:"sc-1foobv2-0"})(["margin:5px 0;"]);JobNameWrapper.displayName="JobNameWrapper";const JobName=({id:id,description:description,basePath:basePath})=>{const{services:{ml:ml}}=Object(kibana.h)(),jobUrl=Object(ml_public_.useMlHref)(ml,basePath,{page:ml_public_.ML_PAGES.ANOMALY_DETECTION_JOBS_MANAGE,pageState:{jobId:id}});return external_kbnSharedDeps_React_default.a.createElement(JobNameWrapper,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{"data-test-subj":"jobs-table-link",href:jobUrl,target:"_blank"},id)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{color:"subdued",size:"xs"},description.length>200?description.substring(0,200)+"...":description))},getJobsTableColumns=(isLoading,onJobStateChange,basePath)=>[{name:COLUMN_JOB_NAME,render:({id:id,description:description})=>external_kbnSharedDeps_React_default.a.createElement(JobName,{id:id,description:description,basePath:basePath})},{name:COLUMN_GROUPS,render:({groups:groups})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{wrap:!0,responsive:!0,gutterSize:"xs"},groups.map(group=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,key:group},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBadge,{color:"hollow"},group)))),width:"140px"},{name:COLUMN_RUN_JOB,render:job=>job.isCompatible?external_kbnSharedDeps_React_default.a.createElement(JobSwitch,{job:job,isSecurityJobsLoading:isLoading,onJobStateChange:onJobStateChange}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{"aria-label":"Warning",size:"s",type:"alert",color:"warning"}),align:external_kbnSharedDeps_ElasticEui_.CENTER_ALIGNMENT,width:"80px"}],getPaginatedItems=(items,pageIndex,pageSize)=>items.slice(pageIndex*pageSize,pageIndex*pageSize+pageSize),JobsTableComponent=({isLoading:isLoading,jobs:jobs,onJobStateChange:onJobStateChange})=>{const[pageIndex,setPageIndex]=Object(external_kbnSharedDeps_React_.useState)(0),basePath=Object(kibana.c)(),pagination={hidePerPageOptions:!0,pageIndex:pageIndex,pageSize:5,totalItemCount:jobs.length};return Object(external_kbnSharedDeps_React_.useEffect)(()=>{setPageIndex(0)},[jobs.length]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBasicTable,{"data-test-subj":"jobs-table",columns:getJobsTableColumns(isLoading,onJobStateChange,basePath),items:getPaginatedItems(jobs,pageIndex,5),loading:isLoading,noItemsMessage:external_kbnSharedDeps_React_default.a.createElement(NoItemsMessage,{basePath:basePath}),pagination:pagination,responsive:!1,onChange:({page:page})=>{setPageIndex(page.index)}})};JobsTableComponent.displayName="JobsTableComponent";const JobsTable=external_kbnSharedDeps_React_default.a.memo(JobsTableComponent);JobsTable.displayName="JobsTable";const NoItemsMessage=external_kbnSharedDeps_React_default.a.memo(({basePath:basePath})=>{const{services:{ml:ml}}=Object(kibana.h)(),createNewAnomalyDetectionJoUrl=Object(ml_public_.useMlHref)(ml,basePath,{page:ml_public_.ML_PAGES.ANOMALY_DETECTION_CREATE_JOB_SELECT_INDEX});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiEmptyPrompt,{title:external_kbnSharedDeps_React_default.a.createElement("h3",null,NO_ITEMS_TEXT),titleSize:"xs",actions:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{href:createNewAnomalyDetectionJoUrl,iconType:"popout",iconSide:"right",size:"s",target:"_blank"},CREATE_CUSTOM_JOB)})});NoItemsMessage.displayName="NoItemsMessage";const ShowingContainer=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"ShowingContainer",componentId:"sc-8k6h3p-0"})(["user-select:none;margin-top:5px;"]);ShowingContainer.displayName="ShowingContainer";const ShowingCountComponent=({filterResultsLength:filterResultsLength})=>external_kbnSharedDeps_React_default.a.createElement(ShowingContainer,{"data-test-subj":"showing"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{color:"subdued",size:"xs"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{"data-test-subj":"query-message",id:"xpack.securitySolution.components.mlPopup.showingLabel",defaultMessage:"Showing: {filterResultsLength} {filterResultsLength, plural, one {job} other {jobs}}",values:{filterResultsLength:filterResultsLength}})));ShowingCountComponent.displayName="ShowingCountComponent";const ShowingCount=external_kbnSharedDeps_React_default.a.memo(ShowingCountComponent);ShowingCount.displayName="ShowingCount";const PopoverDescriptionComponent=()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.components.mlPopup.anomalyDetectionDescription",defaultMessage:"Run any of the Machine Learning jobs below to prepare for creating detection rules that produce alerts for detected anomalies, and to view anomalous events throughout the Security application. We’ve provided a collection of common detection jobs to get you started. If you wish to add your own custom ML jobs, create and add them to the “Security” group from the {machineLearning} application.",values:{machineLearning:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{href:Object(kibana.c)()+"/app/ml",target:"_blank"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.components.mlPopup.machineLearningLink",defaultMessage:"Machine Learning"}))}}));PopoverDescriptionComponent.displayName="PopoverDescriptionComponent";const PopoverDescription=external_kbnSharedDeps_React_default.a.memo(PopoverDescriptionComponent);PopoverDescription.displayName="PopoverDescription";const ML_JOB_SETTINGS=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.components.mlPopup.mlJobSettingsButtonLabel",{defaultMessage:"ML job settings"}),UPGRADE_TITLE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.components.mlPopup.upgradeTitle",{defaultMessage:"Upgrade to Elastic Platinum"}),UPGRADE_BUTTON=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.components.mlPopup.upgradeButtonLabel",{defaultMessage:"Subscription plans"}),LICENSE_BUTTON=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.components.mlPopup.licenseButtonLabel",{defaultMessage:"Manage license"}),MODULE_NOT_COMPATIBLE_TITLE=incompatibleJobCount=>external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.components.mlPopup.moduleNotCompatibleTitle",{values:{incompatibleJobCount:incompatibleJobCount},defaultMessage:"{incompatibleJobCount} {incompatibleJobCount, plural, =1 {job} other {jobs}} are currently unavailable"}),START_JOB_FAILURE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.components.mlPopup.errors.startJobFailureTitle",{defaultMessage:"Start job failure"}),STOP_JOB_FAILURE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.containers.errors.stopJobFailureTitle",{defaultMessage:"Stop job failure"}),CREATE_JOB_FAILURE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.components.mlPopup.errors.createJobFailureTitle",{defaultMessage:"Create job failure"}),PopoverContentsDiv=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"PopoverContentsDiv",componentId:"fqnfg5-0"})(["width:384px;"]);PopoverContentsDiv.displayName="PopoverContentsDiv";const UpgradeContentsComponent=()=>external_kbnSharedDeps_React_default.a.createElement(PopoverContentsDiv,{"data-test-subj":"ml-popover-upgrade-contents"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopoverTitle,null,UPGRADE_TITLE),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.components.mlPopup.upgradeDescription",defaultMessage:"To access SIEM’s anomaly detection features, you must update your license to Platinum, start a free 30-day trial, or spin up a {cloudLink} on AWS, GCP, or Azure. You can then run Machine Learning jobs and view anomalies.",values:{cloudLink:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{href:"https://www.elastic.co/cloud/",target:"_blank"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.components.mlPopup.cloudLink",defaultMessage:"cloud deployment"}))}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s",wrap:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{href:"https://www.elastic.co/subscriptions",iconType:"popout",iconSide:"right",target:"_blank"},UPGRADE_BUTTON)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{href:Object(kibana.c)()+"/app/management/stack/license_management",iconType:"gear",target:"_blank"},LICENSE_BUTTON)))),UpgradeContents=external_kbnSharedDeps_React_default.a.memo(UpgradeContentsComponent);UpgradeContents.displayName="UpgradeContents";var use_security_jobs=__webpack_require__(499);const ml_popover_PopoverContentsDiv=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"PopoverContentsDiv",componentId:"z6keba-0"})(["max-width:684px;max-height:90vh;overflow-y:auto;overflow-x:hidden;padding-bottom:15px;"]);function mlPopoverReducer(state,action){switch(action.type){case"refresh":return{...state,refreshToggle:!state.refreshToggle};case"loading":return{...state,isLoading:!0};case"success":case"failure":return{...state,isLoading:!1};default:return state}}ml_popover_PopoverContentsDiv.displayName="PopoverContentsDiv";const ml_popover_initialState={isLoading:!1,refreshToggle:!0},defaultFilterProps={filterQuery:"",showCustomJobs:!1,showElasticJobs:!1,selectedGroups:[]},MlPopover=external_kbnSharedDeps_React_default.a.memo(()=>{const[{isLoading:isLoading,refreshToggle:refreshToggle},dispatch]=Object(external_kbnSharedDeps_React_.useReducer)(mlPopoverReducer,ml_popover_initialState),[isPopoverOpen,setIsPopoverOpen]=Object(external_kbnSharedDeps_React_.useState)(!1),[filterProperties,setFilterProperties]=Object(external_kbnSharedDeps_React_.useState)(defaultFilterProps),{isMlAdmin:isMlAdmin,isLicensed:isLicensed,loading:isLoadingSecurityJobs,jobs:jobs}=Object(use_security_jobs.a)(refreshToggle),[,dispatchToaster]=Object(toasters.h)(),docLinks=Object(kibana.h)().services.docLinks,handleJobStateChange=Object(external_kbnSharedDeps_React_.useCallback)((job,latestTimestampMs,enable)=>enableDatafeed(job,latestTimestampMs,enable,dispatch,dispatchToaster),[dispatch,dispatchToaster]),filteredJobs=(({jobs:jobs,selectedGroups:selectedGroups,showCustomJobs:showCustomJobs,showElasticJobs:showElasticJobs,filterQuery:filterQuery})=>searchFilter(jobs.filter(job=>!showCustomJobs||showCustomJobs&&!job.isElasticJob).filter(job=>!showElasticJobs||showElasticJobs&&job.isElasticJob).filter(job=>0===selectedGroups.length||selectedGroups.some(g=>job.groups.includes(g))),filterQuery))({jobs:jobs,...filterProperties}),incompatibleJobCount=jobs.filter(j=>!j.isCompatible).length;return isLicensed?isMlAdmin?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopover,{anchorPosition:"downRight",id:"integrations-popover",button:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{"data-test-subj":"integrations-button",iconType:"arrowDown",iconSide:"right",onClick:()=>{setIsPopoverOpen(!isPopoverOpen),dispatch({type:"refresh"})}},ML_JOB_SETTINGS),isOpen:isPopoverOpen,closePopover:()=>setIsPopoverOpen(!isPopoverOpen),repositionOnScroll:!0},external_kbnSharedDeps_React_default.a.createElement(ml_popover_PopoverContentsDiv,{"data-test-subj":"ml-popover-contents"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopoverTitle,null,ML_JOB_SETTINGS),external_kbnSharedDeps_React_default.a.createElement(PopoverDescription,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),external_kbnSharedDeps_React_default.a.createElement(JobsTableFilters,{securityJobs:jobs,onFilterChanged:setFilterProperties}),external_kbnSharedDeps_React_default.a.createElement(ShowingCount,{filterResultsLength:filteredJobs.length}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),incompatibleJobCount>0&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:MODULE_NOT_COMPATIBLE_TITLE(incompatibleJobCount),color:"warning",iconType:"alert",size:"s"},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{defaultMessage:"We could not find any data, see {mlDocs} for more information on Machine Learning job requirements.",id:"xpack.securitySolution.components.mlPopup.moduleNotCompatibleDescription",values:{mlDocs:external_kbnSharedDeps_React_default.a.createElement("a",{href:`${docLinks.ELASTIC_WEBSITE_URL}guide/en/security/${docLinks.DOC_LINK_VERSION}/machine-learning.html`,rel:"noopener noreferrer",target:"_blank"},"Anomaly Detection with Machine Learning")}}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"})),external_kbnSharedDeps_React_default.a.createElement(JobsTable,{isLoading:isLoadingSecurityJobs||isLoading,jobs:filteredJobs,onJobStateChange:handleJobStateChange}))):null:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopover,{anchorPosition:"downRight",id:"integrations-popover",button:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{"data-test-subj":"integrations-button",iconType:"arrowDown",iconSide:"right",onClick:()=>setIsPopoverOpen(!isPopoverOpen)},ML_JOB_SETTINGS),isOpen:isPopoverOpen,closePopover:()=>setIsPopoverOpen(!isPopoverOpen),repositionOnScroll:!0},external_kbnSharedDeps_React_default.a.createElement(UpgradeContents,null))}),enableDatafeed=async(job,latestTimestampMs,enable,dispatch,dispatchToaster)=>{if(submitTelemetry(job,enable),!job.isInstalled){dispatch({type:"loading"});try{await Object(api.c)({configTemplate:job.moduleId,indexPatternName:job.defaultIndexPattern,jobIdErrorFilter:[job.id],groups:job.groups}),dispatch({type:"success"})}catch(error){return Object(toasters.g)({title:CREATE_JOB_FAILURE,error:error,dispatchToaster:dispatchToaster}),dispatch({type:"failure"}),void dispatch({type:"refresh"})}}const maxStartTime=external_kbnSharedDeps_Moment_default.a.utc().subtract(14,"days").valueOf();if(enable){const startTime=Math.max(latestTimestampMs,maxStartTime);try{await Object(api.d)({datafeedIds:["datafeed-"+job.id],start:startTime})}catch(error){Object(telemetry.e)(telemetry.a.COUNT,telemetry.b.JOB_ENABLE_FAILURE),Object(toasters.g)({title:START_JOB_FAILURE,error:error,dispatchToaster:dispatchToaster})}}else try{await Object(api.e)({datafeedIds:["datafeed-"+job.id]})}catch(error){Object(telemetry.e)(telemetry.a.COUNT,telemetry.b.JOB_DISABLE_FAILURE),Object(toasters.g)({title:STOP_JOB_FAILURE,error:error,dispatchToaster:dispatchToaster})}dispatch({type:"refresh"})},submitTelemetry=(job,enabled)=>{Object(telemetry.e)(telemetry.a.COUNT,job.isElasticJob?enabled?telemetry.b.SIEM_JOB_ENABLED:telemetry.b.SIEM_JOB_DISABLED:enabled?telemetry.b.CUSTOM_JOB_ENABLED:telemetry.b.CUSTOM_JOB_DISABLED)};MlPopover.displayName="MlPopover";var navigation=__webpack_require__(325);const SECURITY_SOLUTION=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.headerGlobal.securitySolution",{defaultMessage:"Security solution"}),BUTTON_ADD_DATA=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.headerGlobal.buttonAddData",{defaultMessage:"Add data"});var use_get_url_search=__webpack_require__(300),use_global_header_portal=__webpack_require__(693),links=__webpack_require__(121);const Wrapper=external_kbnSharedDeps_StyledComponents_default.a.header.withConfig({displayName:"Wrapper",componentId:"o5t5gh-0"})(["",""],({theme:theme,$isFixed:$isFixed})=>`\n    background: ${theme.eui.euiColorEmptyShade};\n    border-bottom: ${theme.eui.euiBorderThin};\n    width: 100%;\n    z-index: ${theme.eui.euiZNavigation};\n    position: ${$isFixed?"fixed":"relative"};\n  `);Wrapper.displayName="Wrapper";const WrapperContent=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"WrapperContent",componentId:"o5t5gh-1"})(["display:",";padding-top:",";"],({$globalFullScreen:$globalFullScreen})=>$globalFullScreen?"none":"block",({$globalFullScreen:$globalFullScreen,theme:theme})=>$globalFullScreen?theme.eui.paddingSizes.s:theme.eui.paddingSizes.m);WrapperContent.displayName="WrapperContent";const FlexItem=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexItem).withConfig({displayName:"FlexItem",componentId:"o5t5gh-2"})(["min-width:0;"]);FlexItem.displayName="FlexItem";const FlexGroup=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup).withConfig({displayName:"FlexGroup",componentId:"o5t5gh-3"})(["",""],({$hasSibling:$hasSibling,theme:theme})=>`\n    border-bottom: ${theme.eui.euiBorderThin};\n    margin-bottom: 1px;\n    padding-bottom: 4px;\n    padding-left: ${theme.eui.paddingSizes.l};\n    padding-right: ${theme.eui.paddingSizes.l};\n    ${$hasSibling?`border-bottom: ${theme.eui.euiBorderThin};`:"border-bottom-width: 0px;"}\n  `);FlexGroup.displayName="FlexGroup";const HeaderGlobal=external_kbnSharedDeps_React_default.a.memo(Object(external_kbnSharedDeps_React_.forwardRef)(({hideDetectionEngine:hideDetectionEngine=!1,isFixed:isFixed=!0},ref)=>{const{globalHeaderPortalNode:globalHeaderPortalNode}=Object(use_global_header_portal.a)(),{globalFullScreen:globalFullScreen}=Object(use_full_screen.a)(),{timelineFullScreen:timelineFullScreen}=Object(use_full_screen.b)(),search=Object(use_get_url_search.a)(home_navigations.a.overview),{application:application,http:http}=Object(kibana.h)().services,{navigateToApp:navigateToApp,getUrlForApp:getUrlForApp}=application,overviewPath=Object(external_kbnSharedDeps_React_.useMemo)(()=>getUrlForApp(constants.f,{path:types.a.overview}),[getUrlForApp]),overviewHref=Object(external_kbnSharedDeps_React_.useMemo)(()=>Object(link_to.a)(overviewPath,search),[overviewPath,search]),basePath=http.basePath.get(),goToOverview=Object(external_kbnSharedDeps_React_.useCallback)(ev=>{ev.preventDefault(),navigateToApp(`${constants.f}:${types.a.overview}`,{path:search})},[navigateToApp,search]);return external_kbnSharedDeps_React_default.a.createElement(Wrapper,{ref:ref,$isFixed:isFixed},external_kbnSharedDeps_React_default.a.createElement(WrapperContent,{$globalFullScreen:null!=globalFullScreen?globalFullScreen:timelineFullScreen},external_kbnSharedDeps_React_default.a.createElement(FlexGroup,{alignItems:"center",$hasSibling:globalHeaderPortalNode.hasChildNodes(),justifyContent:"spaceBetween",wrap:!0},external_kbnSharedDeps_React_default.a.createElement(FlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",responsive:!1},external_kbnSharedDeps_React_default.a.createElement(FlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(links.f,{onClick:goToOverview,href:overviewHref},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{"aria-label":SECURITY_SOLUTION,type:"logoSecurity",size:"l"}))),external_kbnSharedDeps_React_default.a.createElement(FlexItem,{component:"nav"},external_kbnSharedDeps_React_default.a.createElement(navigation.a,{display:"condensed",navTabs:hideDetectionEngine?Object(external_kbnSharedDeps_LodashFp_.pickBy)((_,key)=>key!==types.a.detections,home_navigations.a):home_navigations.a})))),external_kbnSharedDeps_React_default.a.createElement(FlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:!1,wrap:!0},window.location.pathname.includes(constants.c)&&external_kbnSharedDeps_React_default.a.createElement(FlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(MlPopover,null)),external_kbnSharedDeps_React_default.a.createElement(FlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{"data-test-subj":"add-data",href:`${basePath}${constants.a}`,iconType:"plusInCircle"},BUTTON_ADD_DATA)))))),external_kbnSharedDeps_React_default.a.createElement(web.b,{node:globalHeaderPortalNode}))}));HeaderGlobal.displayName="HeaderGlobal";const HelpMenu=external_kbnSharedDeps_React_default.a.memo(()=>{const{chrome:chrome,docLinks:docLinks}=Object(kibana.h)().services;return Object(external_kbnSharedDeps_React_.useEffect)(()=>{chrome.setHelpExtension({appName:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.chrome.help.appName",{defaultMessage:"Security"}),links:[{content:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.chrome.helpMenu.documentation",{defaultMessage:"Security documentation"}),href:docLinks.links.siem.guide,iconType:"documents",linkType:"custom",target:"_blank",rel:"noopener"},{content:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.chrome.helpMenu.documentation.ecs",{defaultMessage:"ECS documentation"}),href:docLinks.ELASTIC_WEBSITE_URL+"guide/en/ecs/current/index.html",iconType:"documents",linkType:"custom",target:"_blank",rel:"noopener"},{linkType:"discuss",href:"https://discuss.elastic.co/c/security",target:"_blank",rel:"noopener"}]})},[]),null});HelpMenu.displayName="HelpMenu";var inputs_actions=__webpack_require__(156);const TITLE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.timeline.autosave.warning.title",{defaultMessage:"Auto-save disabled until refresh"}),DESCRIPTION=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.timeline.autosave.warning.description",{defaultMessage:"Another user has made changes to this timeline. Any changes you make will not be auto-saved until you have refreshed this timeline to absorb those changes."}),REFRESH_TIMELINE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.timeline.autosave.warning.refresh.title",{defaultMessage:"Refresh timeline"}),AutoSaveWarningMsgComponent=()=>{const dispatch=Object(lib.useDispatch)(),dispatchToaster=Object(toasters.h)()[1],{timelineId:timelineId,newTimelineModel:newTimelineModel}=Object(use_selector.a)(store_timeline.b.autoSaveMsgSelector),handleClick=Object(external_kbnSharedDeps_React_.useCallback)(()=>{null!=timelineId&&null!=newTimelineModel&&(dispatch(store_timeline.a.updateTimeline({id:timelineId,timeline:newTimelineModel})),dispatch(store_timeline.a.updateAutoSaveMsg({timelineId:null,newTimelineModel:null})),dispatch(Object(inputs_actions.setTimelineRangeDatePicker)({from:Object(external_kbnSharedDeps_LodashFp_.getOr)(0,"dateRange.start",newTimelineModel),to:Object(external_kbnSharedDeps_LodashFp_.getOr)(0,"dateRange.end",newTimelineModel)})))},[dispatch,newTimelineModel,timelineId]),TextComponent=Object(external_kbnSharedDeps_React_.useMemo)(()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement("p",null,DESCRIPTION),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{size:"s",onClick:handleClick},REFRESH_TIMELINE)))),[handleClick]);if(null!=timelineId&&null!=newTimelineModel){dispatchToaster({type:"addToaster",toast:{id:"AutoSaveWarningMsg",title:TITLE,color:"warning",iconType:"alert",toastLifeTimeMs:1e4,text:TextComponent}})}return null};AutoSaveWarningMsgComponent.displayName="AutoSaveWarningMsgComponent";const AutoSaveWarningMsg=external_kbnSharedDeps_React_default.a.memo(AutoSaveWarningMsgComponent);var redux=__webpack_require__(192),use_route_spy=__webpack_require__(298),url_state_constants=__webpack_require__(258),url_state_helpers=__webpack_require__(243),url_state_types=__webpack_require__(618);const useUrlStateHooks=({detailName:detailName,indexPattern:indexPattern,history:history,navTabs:navTabs,pageName:pageName,pathName:pathName,search:search,setInitialStateFromUrl:setInitialStateFromUrl,updateTimeline:updateTimeline,updateTimelineIsLoading:updateTimelineIsLoading,urlState:urlState})=>{const[isInitializing,setIsInitializing]=Object(external_kbnSharedDeps_React_.useState)(!0),{filterManager:filterManager,savedQueries:savedQueries}=Object(kibana.h)().services.data.query,prevProps=function(value){const ref=Object(external_kbnSharedDeps_React_.useRef)(value);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{ref.current=value}),ref.current}({pathName:pathName,pageName:pageName,urlState:urlState}),handleInitialize=(type,needUpdate)=>{let mySearch=search,urlStateToUpdate=[];url_state_types.b[type].forEach(urlKey=>{var _urlState$urlKey;const newUrlStateString=Object(url_state_helpers.b)(Object(url_state_helpers.c)(mySearch),urlKey);if(newUrlStateString){if(mySearch=Object(url_state_helpers.j)({history:history,isInitializing:isInitializing,newUrlStateString:newUrlStateString,pathName:pathName,search:mySearch,updateTimerange:null!=needUpdate&&needUpdate||isInitializing,urlKey:urlKey}),isInitializing||needUpdate){var _getParamFromQueryStr;const updatedUrlStateString=null!==(_getParamFromQueryStr=Object(url_state_helpers.b)(Object(url_state_helpers.c)(mySearch),urlKey))&&void 0!==_getParamFromQueryStr?_getParamFromQueryStr:newUrlStateString;!isInitializing&&fast_deep_equal_default()(updatedUrlStateString,newUrlStateString)||((urlKey,newUrlStateString,urlState)=>{let updateUrlState=!0;if(urlKey===url_state_constants.a.timeline){const timeline=Object(url_state_helpers.a)(newUrlStateString);null!=timeline&&urlState.timeline.id===timeline.id&&(updateUrlState=!1)}return updateUrlState})(urlKey,newUrlStateString,urlState)&&(urlStateToUpdate=[...urlStateToUpdate,{urlKey:urlKey,newUrlStateString:updatedUrlStateString}])}}else mySearch=urlKey===url_state_constants.a.appQuery&&null!=urlState[urlKey]&&""===(null===(_urlState$urlKey=urlState[urlKey])||void 0===_urlState$urlKey?void 0:_urlState$urlKey.query)||urlKey===url_state_constants.a.filters&&Object(external_kbnSharedDeps_LodashFp_.isEmpty)(urlState[urlKey])||urlKey===url_state_constants.a.timeline&&null!=urlState[urlKey]&&""===urlState[urlKey].id?Object(url_state_helpers.h)({history:history,pathName:pathName,search:mySearch,urlStateToReplace:"",urlStateKey:urlKey}):Object(url_state_helpers.h)({history:history,pathName:pathName,search:mySearch,urlStateToReplace:urlState[urlKey]||"",urlStateKey:urlKey})}),Object(external_kbnSharedDeps_LodashFp_.difference)(url_state_types.a,url_state_types.b[type]).forEach(urlKey=>{mySearch=Object(url_state_helpers.h)({history:history,pathName:pathName,search:mySearch,urlStateToReplace:"",urlStateKey:urlKey})}),setInitialStateFromUrl({detailName:detailName,filterManager:filterManager,indexPattern:indexPattern,pageName:pageName,savedQueries:savedQueries,updateTimeline:updateTimeline,updateTimelineIsLoading:updateTimelineIsLoading,urlStateToUpdate:urlStateToUpdate})()};return Object(external_kbnSharedDeps_React_.useEffect)(()=>{const type=Object(url_state_helpers.e)(pageName);if(isInitializing&&null!=pageName&&""!==pageName)handleInitialize(type),setIsInitializing(!1);else if(fast_deep_equal_default()(urlState,prevProps.urlState)||isInitializing)pathName!==prevProps.pathName&&handleInitialize(type,pageName===types.a.detections);else{let mySearch=search;url_state_types.b[type].forEach(urlKey=>{var _urlState$urlKey2;mySearch=urlKey===url_state_constants.a.appQuery&&null!=urlState[urlKey]&&""===(null===(_urlState$urlKey2=urlState[urlKey])||void 0===_urlState$urlKey2?void 0:_urlState$urlKey2.query)||urlKey===url_state_constants.a.filters&&Object(external_kbnSharedDeps_LodashFp_.isEmpty)(urlState[urlKey])||urlKey===url_state_constants.a.timeline&&null!=urlState[urlKey]&&""===urlState[urlKey].id?Object(url_state_helpers.h)({history:history,pathName:pathName,search:mySearch,urlStateToReplace:"",urlStateKey:urlKey}):Object(url_state_helpers.h)({history:history,pathName:pathName,search:mySearch,urlStateToReplace:urlState[urlKey]||"",urlStateKey:urlKey})})}},[isInitializing,history,pathName,pageName,prevProps,urlState]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{document.title=Object(url_state_helpers.d)(pageName,detailName,navTabs)+" - Kibana"},[pageName]),null};var open_timeline_helpers=__webpack_require__(169),store_actions=__webpack_require__(238),normalize_time_range=__webpack_require__(340);const dispatchSetInitialStateFromUrl=dispatch=>({detailName:detailName,filterManager:filterManager,indexPattern:indexPattern,pageName:pageName,savedQueries:savedQueries,updateTimeline:updateTimeline,updateTimelineIsLoading:updateTimelineIsLoading,urlStateToUpdate:urlStateToUpdate})=>()=>{urlStateToUpdate.forEach(({urlKey:urlKey,newUrlStateString:newUrlStateString})=>{if(urlKey===url_state_constants.a.timerange&&updateTimerange(newUrlStateString,dispatch),urlKey===url_state_constants.a.sourcerer){const sourcererState=Object(url_state_helpers.a)(newUrlStateString);if(null!=sourcererState){Object.keys(sourcererState).filter(key=>!(key===model.SourcererScopeName.default&&pageName===constants.eb.detections)).forEach(scope=>{var _sourcererState$scope;return dispatch(store_actions.c.setSelectedIndexPatterns({id:scope,selectedPatterns:null!==(_sourcererState$scope=sourcererState[scope])&&void 0!==_sourcererState$scope?_sourcererState$scope:[]}))})}}if(urlKey===url_state_constants.a.appQuery&&null!=indexPattern){const appQuery=Object(url_state_helpers.a)(newUrlStateString);null!=appQuery&&dispatch(store_actions.b.setFilterQuery({id:"global",query:appQuery.query,language:appQuery.language}))}if(urlKey===url_state_constants.a.filters){const filters=Object(url_state_helpers.a)(newUrlStateString);filterManager.setFilters(filters||[])}if(urlKey===url_state_constants.a.savedQuery){const savedQueryId=Object(url_state_helpers.a)(newUrlStateString);null!=savedQueryId&&""!==savedQueryId&&savedQueries.getSavedQuery(savedQueryId).then(savedQueryData=>{filterManager.setFilters(savedQueryData.attributes.filters||[]),dispatch(store_actions.b.setFilterQuery({id:"global",...savedQueryData.attributes.query})),dispatch(store_actions.b.setSavedQuery({id:"global",savedQuery:savedQueryData}))})}if(urlKey===url_state_constants.a.timeline){const timeline=Object(url_state_helpers.a)(newUrlStateString);null!=timeline&&""!==timeline.id&&Object(open_timeline_helpers.h)({activeTimelineTab:timeline.activeTab,duplicate:!1,graphEventId:timeline.graphEventId,timelineId:timeline.id,openTimeline:timeline.isOpen,updateIsLoading:updateTimelineIsLoading,updateTimeline:updateTimeline})}})},updateTimerange=(newUrlStateString,dispatch)=>{const timerangeStateData=Object(url_state_helpers.a)(newUrlStateString),globalLinkTo={linkTo:Object(external_kbnSharedDeps_LodashFp_.get)("global.linkTo",timerangeStateData)},globalType=Object(external_kbnSharedDeps_LodashFp_.get)("global.timerange.kind",timerangeStateData),timelineLinkTo={linkTo:Object(external_kbnSharedDeps_LodashFp_.get)("timeline.linkTo",timerangeStateData)},timelineType=Object(external_kbnSharedDeps_LodashFp_.get)("timeline.timerange.kind",timerangeStateData);if(Object(external_kbnSharedDeps_LodashFp_.isEmpty)(globalLinkTo.linkTo)?dispatch(store_actions.b.removeGlobalLinkTo()):dispatch(store_actions.b.addGlobalLinkTo({linkToId:"timeline"})),Object(external_kbnSharedDeps_LodashFp_.isEmpty)(timelineLinkTo.linkTo)?dispatch(store_actions.b.removeTimelineLinkTo()):dispatch(store_actions.b.addTimelineLinkTo({linkToId:"global"})),timelineType){if("absolute"===timelineType){const absoluteRange=Object(normalize_time_range.a)(Object(external_kbnSharedDeps_LodashFp_.get)("timeline.timerange",timerangeStateData));dispatch(store_actions.b.setAbsoluteRangeDatePicker({...absoluteRange,id:"timeline"}))}if("relative"===timelineType){const relativeRange=Object(normalize_time_range.a)(Object(external_kbnSharedDeps_LodashFp_.get)("timeline.timerange",timerangeStateData));dispatch(store_actions.b.setRelativeRangeDatePicker({...relativeRange,id:"timeline"}))}}if(globalType){if("absolute"===globalType){const absoluteRange=Object(normalize_time_range.a)(Object(external_kbnSharedDeps_LodashFp_.get)("global.timerange",timerangeStateData));dispatch(store_actions.b.setAbsoluteRangeDatePicker({...absoluteRange,id:"global"}))}if("relative"===globalType){const relativeRange=Object(normalize_time_range.a)(Object(external_kbnSharedDeps_LodashFp_.get)("global.timerange",timerangeStateData));dispatch(store_actions.b.setRelativeRangeDatePicker({...relativeRange,id:"global"}))}}},UrlStateContainer=props=>(useUrlStateHooks(props),null),UrlStateRedux=Object(redux.compose)(Object(lib.connect)(url_state_helpers.f,dispatch=>({setInitialStateFromUrl:dispatchSetInitialStateFromUrl(dispatch),updateTimeline:Object(open_timeline_helpers.b)(dispatch),updateTimelineIsLoading:({id:id,isLoading:isLoading})=>dispatch(store_timeline.a.updateIsLoading({id:id,isLoading:isLoading}))})))(external_kbnSharedDeps_React_default.a.memo(UrlStateContainer,(prevProps,nextProps)=>prevProps.pathName===nextProps.pathName&&fast_deep_equal_default()(prevProps.urlState,nextProps.urlState))),UseUrlStateComponent=props=>{const[routeProps]=Object(use_route_spy.a)(),urlStateReduxProps={...routeProps,...props};return external_kbnSharedDeps_React_default.a.createElement(UrlStateRedux,urlStateReduxProps)},UseUrlState=external_kbnSharedDeps_React_default.a.memo(UseUrlStateComponent,(prevProps,nextProps)=>fast_deep_equal_default()(prevProps.indexPattern,nextProps.indexPattern)&&fast_deep_equal_default()(prevProps.navTabs,nextProps.navTabs)),hideTimelineForRoutes=["/cases/configure","/administration"];var kibanaReact_public_=__webpack_require__(79),common_=__webpack_require__(91),ingest_enabled=__webpack_require__(372);const useUpgradeEndpointPackage=()=>{const context=Object(kibanaReact_public_.useKibana)(),{allEnabled:ingestEnabled}=Object(ingest_enabled.a)();Object(external_kbnSharedDeps_React_.useEffect)(()=>{const abortController=new AbortController,abortRequests=()=>{abortController.abort()};if(ingestEnabled){const signal=abortController.signal;(async()=>{try{const{success:hasPermissions}=await(async(http,options={})=>http.get(common_.appRoutesService.getCheckPermissionsPath(),{...options}))(context.services.http,{signal:signal});if(!hasPermissions)return abortRequests;await(async(http,options={})=>http.post(common_.epmRouteService.getBulkInstallPath(),{...options,body:JSON.stringify({packages:["endpoint"]})}))(context.services.http,{signal:signal})}catch(error){abortController.signal.aborted||console.error(error)}})()}},[ingestEnabled,context.services.http])};var utils=__webpack_require__(227);const Main=external_kbnSharedDeps_StyledComponents_default.a.main.attrs(({paddingTop:paddingTop})=>({style:{paddingTop:paddingTop+"px"}})).withConfig({displayName:"Main",componentId:"k9o3ur-0"})(["overflow:auto;display:flex;flex-direction:column;flex:1 1 auto;"]);Main.displayName="Main";const HomePageComponent=({children:children,onAppLeave:onAppLeave})=>{const{application:application,overlays:overlays}=Object(kibana.h)().services,subPluginId=Object(external_kbnSharedDeps_React_.useRef)(""),{ref:ref,height:height=0}=Object(utils.b)(300),banners$=overlays.banners.get$(),[headerFixed,setHeaderFixed]=Object(external_kbnSharedDeps_React_.useState)(!0),mainPaddingTop=headerFixed?height:0;Object(external_kbnSharedDeps_React_.useEffect)(()=>{const subscription=banners$.subscribe(banners=>setHeaderFixed(!banners.length));return()=>subscription.unsubscribe()},[banners$]),application.currentAppId$.subscribe(appId=>{subPluginId.current=null!=appId?appId:""}),Object(sourcerer.a)(subPluginId.current===constants.F?model.SourcererScopeName.detections:model.SourcererScopeName.default);const[showTimeline]=(()=>{const[{pageName:pageName,pathName:pathName}]=Object(use_route_spy.a)(),[showTimeline,setShowTimeline]=Object(external_kbnSharedDeps_React_.useState)(!hideTimelineForRoutes.includes(window.location.pathname));return Object(external_kbnSharedDeps_React_.useEffect)(()=>{hideTimelineForRoutes.filter(route=>window.location.pathname.includes(route)).length>0?showTimeline&&setShowTimeline(!1):showTimeline||setShowTimeline(!0)},[pageName,pathName]),[showTimeline]})(),{browserFields:browserFields,indexPattern:indexPattern,indicesExist:indicesExist}=Object(sourcerer.b)(subPluginId.current===constants.F?model.SourcererScopeName.detections:model.SourcererScopeName.default);return useUpgradeEndpointPackage(),external_kbnSharedDeps_React_default.a.createElement(page.g,null,external_kbnSharedDeps_React_default.a.createElement(HeaderGlobal,{ref:ref,isFixed:headerFixed}),external_kbnSharedDeps_React_default.a.createElement(Main,{paddingTop:mainPaddingTop,"data-test-subj":"pageContainer"},external_kbnSharedDeps_React_default.a.createElement(DragDropContextWrapper,{browserFields:browserFields},external_kbnSharedDeps_React_default.a.createElement(UseUrlState,{indexPattern:indexPattern,navTabs:home_navigations.a}),indicesExist&&showTimeline&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(AutoSaveWarningMsg,null),external_kbnSharedDeps_React_default.a.createElement(Flyout,{timelineId:types_timeline.g.active,onAppLeave:onAppLeave})),children)),external_kbnSharedDeps_React_default.a.createElement(HelpMenu,null))};HomePageComponent.displayName="HomePage";const HomePage=external_kbnSharedDeps_React_default.a.memo(HomePageComponent),PageRouterComponent=({children:children,history:history,onAppLeave:onAppLeave})=>{const dispatch=Object(lib.useDispatch)();return Object(external_kbnSharedDeps_React_.useEffect)(()=>()=>{dispatch({type:"userChangedUrl",payload:{pathname:"",search:"",hash:""}})},[dispatch]),external_kbnSharedDeps_React_default.a.createElement(ManageRoutesSpy,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Router,{history:history},external_kbnSharedDeps_React_default.a.createElement(RouteCapture,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Switch,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:"/"},external_kbnSharedDeps_React_default.a.createElement(HomePage,{onAppLeave:onAppLeave},children)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,null,external_kbnSharedDeps_React_default.a.createElement(_404.a,null))))))},PageRouter=Object(external_kbnSharedDeps_React_.memo)(PageRouterComponent);var kibanaReact_common_=__webpack_require__(102);const StartAppComponent=({children:children,history:history,onAppLeave:onAppLeave,store:store})=>{const{i18n:i18n}=Object(kibana.h)().services,[darkMode]=Object(kibana.l)(constants.q);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiErrorBoundary,null,external_kbnSharedDeps_React_default.a.createElement(i18n.Context,null,external_kbnSharedDeps_React_default.a.createElement(toasters.b,null,external_kbnSharedDeps_React_default.a.createElement(manage_timeline.a,null,external_kbnSharedDeps_React_default.a.createElement(lib.Provider,{store:store},external_kbnSharedDeps_React_default.a.createElement(kibanaReact_common_.EuiThemeProvider,{darkMode:darkMode},external_kbnSharedDeps_React_default.a.createElement(ml_capabilities_provider.b,null,external_kbnSharedDeps_React_default.a.createElement(user_info.a,null,external_kbnSharedDeps_React_default.a.createElement(PageRouter,{history:history,onAppLeave:onAppLeave},children)))),external_kbnSharedDeps_React_default.a.createElement(ErrorToastDispatcher,null),external_kbnSharedDeps_React_default.a.createElement(toasters.a,null))))))},StartApp=Object(external_kbnSharedDeps_React_.memo)(StartAppComponent),SecurityAppComponent=({children:children,history:history,onAppLeave:onAppLeave,services:services,store:store})=>external_kbnSharedDeps_React_default.a.createElement(kibana.a,{services:{appName:constants.h,...services}},external_kbnSharedDeps_React_default.a.createElement(StartApp,{history:history,onAppLeave:onAppLeave,store:store},children)),SecurityApp=Object(external_kbnSharedDeps_React_.memo)(SecurityAppComponent),renderApp=({element:element,history:history,onAppLeave:onAppLeave,services:services,store:store,SubPluginRoutes:SubPluginRoutes})=>(Object(external_kbnSharedDeps_ReactDom_.render)(external_kbnSharedDeps_React_default.a.createElement(SecurityApp,{history:history,onAppLeave:onAppLeave,services:services,store:store},external_kbnSharedDeps_React_default.a.createElement(SubPluginRoutes,null)),element),()=>Object(external_kbnSharedDeps_ReactDom_.unmountComponentAtNode)(element))},377:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"d",(function(){return useTimelineEventsCountPortal})),__webpack_require__.d(__webpack_exports__,"b",(function(){return TimelineEventsCountBadge})),__webpack_require__.d(__webpack_exports__,"c",(function(){return useEqlEventsCountPortal})),__webpack_require__.d(__webpack_exports__,"a",(function(){return EqlEventsCountBadge}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(6),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),react_reverse_portal__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(232);const timelineEventsCountPortalNodeSingleton=Object(react_reverse_portal__WEBPACK_IMPORTED_MODULE_1__.c)(),eqlEventsCountPortalNodeSingleton=Object(react_reverse_portal__WEBPACK_IMPORTED_MODULE_1__.c)(),useTimelineEventsCountPortal=()=>{const[timelineEventsCountPortalNode]=Object(react__WEBPACK_IMPORTED_MODULE_0__.useState)(timelineEventsCountPortalNodeSingleton);return{portalNode:timelineEventsCountPortalNode}},TimelineEventsCountBadge=react__WEBPACK_IMPORTED_MODULE_0___default.a.memo(()=>{const{portalNode:portalNode}=useTimelineEventsCountPortal();return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_reverse_portal__WEBPACK_IMPORTED_MODULE_1__.b,{node:portalNode})});TimelineEventsCountBadge.displayName="TimelineEventsCountBadge";const useEqlEventsCountPortal=()=>{const[eqlEventsCountPortalNode]=Object(react__WEBPACK_IMPORTED_MODULE_0__.useState)(eqlEventsCountPortalNodeSingleton);return{portalNode:eqlEventsCountPortalNode}},EqlEventsCountBadge=react__WEBPACK_IMPORTED_MODULE_0___default.a.memo(()=>{const{portalNode:portalNode}=useEqlEventsCountPortal();return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_reverse_portal__WEBPACK_IMPORTED_MODULE_1__.b,{node:portalNode})});EqlEventsCountBadge.displayName="EqlEventsCountBadge"},476:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return CALL_OUT_UNAUTHORIZED_MSG})),__webpack_require__.d(__webpack_exports__,"a",(function(){return CALL_OUT_IMMUTABLE})),__webpack_require__.d(__webpack_exports__,"f",(function(){return EDIT})),__webpack_require__.d(__webpack_exports__,"k",(function(){return SAVE_TIMELINE})),__webpack_require__.d(__webpack_exports__,"l",(function(){return SAVE_TIMELINE_TEMPLATE})),__webpack_require__.d(__webpack_exports__,"j",(function(){return SAVE})),__webpack_require__.d(__webpack_exports__,"g",(function(){return NAME_TIMELINE})),__webpack_require__.d(__webpack_exports__,"h",(function(){return NAME_TIMELINE_TEMPLATE})),__webpack_require__.d(__webpack_exports__,"d",(function(){return DISCARD_TIMELINE})),__webpack_require__.d(__webpack_exports__,"e",(function(){return DISCARD_TIMELINE_TEMPLATE})),__webpack_require__.d(__webpack_exports__,"c",(function(){return CLOSE_MODAL})),__webpack_require__.d(__webpack_exports__,"p",(function(){return UNSAVED_TIMELINE_WARNING})),__webpack_require__.d(__webpack_exports__,"o",(function(){return TITLE})),__webpack_require__.d(__webpack_exports__,"n",(function(){return TIMELINE_TITLE})),__webpack_require__.d(__webpack_exports__,"m",(function(){return TIMELINE_DESCRIPTION})),__webpack_require__.d(__webpack_exports__,"i",(function(){return OPTIONAL}));var _kbn_i18n__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1),_common_types_timeline__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(111);const CALL_OUT_UNAUTHORIZED_MSG=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.timeline.callOut.unauthorized.message.description",{defaultMessage:"You can use Timeline to investigate events, but you do not have the required permissions to save timelines for future use. If you need to save timelines, contact your Kibana administrator."}),CALL_OUT_IMMUTABLE=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.timeline.callOut.immutable.message.description",{defaultMessage:"This prebuilt timeline template cannot be modified. To make changes, please duplicate this template and make modifications to the duplicate template."}),EDIT=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.button",{defaultMessage:"Edit timeline name and description"}),SAVE_TIMELINE=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.header",{defaultMessage:"Save Timeline"}),SAVE_TIMELINE_TEMPLATE=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.timeline.saveTimelineTemplate.modal.header",{defaultMessage:"Save Timeline Template"}),SAVE=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.timeline.nameTimeline.save.title",{defaultMessage:"Save"}),NAME_TIMELINE=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.timeline.nameTimeline.modal.header",{defaultMessage:"Name Timeline"}),NAME_TIMELINE_TEMPLATE=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.timeline.nameTimelineTemplate.modal.header",{defaultMessage:"Name Timeline Template"}),DISCARD_TIMELINE=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.discard.title",{defaultMessage:"Discard Timeline"}),DISCARD_TIMELINE_TEMPLATE=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.timeline.saveTimelineTemplate.modal.discard.title",{defaultMessage:"Discard Timeline Template"}),CLOSE_MODAL=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.close.title",{defaultMessage:"Close"}),UNSAVED_TIMELINE_WARNING=timelineType=>_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.warning.title",{values:{timeline:timelineType===_common_types_timeline__WEBPACK_IMPORTED_MODULE_1__.k.template?"timeline template":"timeline"},defaultMessage:"You have an unsaved {timeline}. Do you wish to save it?"}),TITLE=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.titleTitle",{defaultMessage:"Title"}),TIMELINE_TITLE=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.titleAriaLabel",{defaultMessage:"Title"}),TIMELINE_DESCRIPTION=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.descriptionLabel",{defaultMessage:"Description"}),OPTIONAL=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.optionalLabel",{defaultMessage:"Optional"})},609:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return DataProviders}));var polished__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(184),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(6),react__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__),styled_components__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(75),styled_components__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(styled_components__WEBPACK_IMPORTED_MODULE_2__),uuid__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(19),uuid__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(uuid__WEBPACK_IMPORTED_MODULE_3__),_common_store_sourcerer_model__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(124),_common_containers_sourcerer__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(130),_common_hooks_use_selector__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(114),_common_components_drag_and_drop_droppable_wrapper__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(425),_common_components_drag_and_drop_helpers__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(123),_empty__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(602),_providers__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(607),_manage_timeline__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(157),_store_timeline__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(113),_store_timeline_defaults__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(125),_translations__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(265);const DropTargetDataProvidersContainer=styled_components__WEBPACK_IMPORTED_MODULE_2___default.a.div.withConfig({displayName:"DropTargetDataProvidersContainer",componentId:"rnh8sd-0"})(["padding:2px 0 4px 0;."," & .drop-target-data-providers{background:",";border:0.2rem dashed ",";& .euiTextColor--subdued{color:",";}& .euiFormHelpText{color:",";}}"],_common_components_drag_and_drop_helpers__WEBPACK_IMPORTED_MODULE_8__.c,({theme:theme})=>Object(polished__WEBPACK_IMPORTED_MODULE_0__.rgba)(theme.eui.euiColorSuccess,.1),({theme:theme})=>theme.eui.euiColorSuccess,({theme:theme})=>theme.eui.euiColorSuccess,({theme:theme})=>theme.eui.euiColorSuccess),DropTargetDataProviders=styled_components__WEBPACK_IMPORTED_MODULE_2___default.a.div.withConfig({displayName:"DropTargetDataProviders",componentId:"rnh8sd-1"})(["display:flex;flex-direction:column;justify-content:flex-start;padding-bottom:2px;position:relative;border:0.2rem dashed ",";border-radius:5px;padding:"," 0;margin:2px 0 2px 0;max-height:33vh;min-height:100px;overflow:auto;resize:vertical;background-color:",";"],({theme:theme})=>theme.eui.euiColorMediumShade,({theme:theme})=>theme.eui.euiSizeXS,({theme:theme})=>theme.eui.euiFormBackgroundColor);DropTargetDataProviders.displayName="DropTargetDataProviders";const DataProviders=react__WEBPACK_IMPORTED_MODULE_1___default.a.memo(({timelineId:timelineId})=>{const{browserFields:browserFields}=Object(_common_containers_sourcerer__WEBPACK_IMPORTED_MODULE_5__.b)(_common_store_sourcerer_model__WEBPACK_IMPORTED_MODULE_4__.SourcererScopeName.timeline),{getManageTimelineById:getManageTimelineById}=Object(_manage_timeline__WEBPACK_IMPORTED_MODULE_11__.b)(),isLoading=Object(react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(()=>getManageTimelineById(timelineId).isLoading,[getManageTimelineById,timelineId]),getTimeline=Object(react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(()=>_store_timeline__WEBPACK_IMPORTED_MODULE_12__.b.getTimelineByIdSelector(),[]),dataProviders=Object(_common_hooks_use_selector__WEBPACK_IMPORTED_MODULE_6__.a)(state=>{var _getTimeline;return(null!==(_getTimeline=getTimeline(state,timelineId))&&void 0!==_getTimeline?_getTimeline:_store_timeline_defaults__WEBPACK_IMPORTED_MODULE_13__.a).dataProviders}),droppableId=Object(react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(()=>{return id=timelineId,`${_common_components_drag_and_drop_helpers__WEBPACK_IMPORTED_MODULE_8__.k}${id}${uuid__WEBPACK_IMPORTED_MODULE_3___default.a.v4()}`;var id},[timelineId]);return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(DropTargetDataProvidersContainer,{"aria-label":_translations__WEBPACK_IMPORTED_MODULE_14__.r,className:"drop-target-data-providers-container"},react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(DropTargetDataProviders,{className:"drop-target-data-providers","data-test-subj":"dataProviders"},null!=dataProviders&&dataProviders.length?react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_providers__WEBPACK_IMPORTED_MODULE_10__.b,{browserFields:browserFields,timelineId:timelineId,dataProviders:dataProviders}):react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_common_components_drag_and_drop_droppable_wrapper__WEBPACK_IMPORTED_MODULE_7__.a,{isDropDisabled:isLoading,droppableId:droppableId},react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_empty__WEBPACK_IMPORTED_MODULE_9__.a,{browserFields:browserFields,timelineId:timelineId}))))});DataProviders.displayName="DataProviders"}}]);