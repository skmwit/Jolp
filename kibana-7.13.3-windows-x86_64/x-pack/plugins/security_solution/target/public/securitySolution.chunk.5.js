/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[5],{137:function(module,__webpack_exports__,__webpack_require__){"use strict";let OperatingSystem,ConditionEntryField,EndpointStatus,HostStatus,MetadataQueryStrategyVersions,ProtectionModes,HostPolicyResponseActionStatus;__webpack_require__.d(__webpack_exports__,"e",(function(){return OperatingSystem})),__webpack_require__.d(__webpack_exports__,"a",(function(){return ConditionEntryField})),__webpack_require__.d(__webpack_exports__,"c",(function(){return HostStatus})),__webpack_require__.d(__webpack_exports__,"d",(function(){return MetadataQueryStrategyVersions})),__webpack_require__.d(__webpack_exports__,"f",(function(){return ProtectionModes})),__webpack_require__.d(__webpack_exports__,"b",(function(){return HostPolicyResponseActionStatus})),function(OperatingSystem){OperatingSystem.LINUX="linux",OperatingSystem.MAC="macos",OperatingSystem.WINDOWS="windows"}(OperatingSystem||(OperatingSystem={})),function(ConditionEntryField){ConditionEntryField.HASH="process.hash.*",ConditionEntryField.PATH="process.executable.caseless",ConditionEntryField.SIGNER="process.Ext.code_signature"}(ConditionEntryField||(ConditionEntryField={})),function(EndpointStatus){EndpointStatus.enrolled="enrolled",EndpointStatus.unenrolled="unenrolled"}(EndpointStatus||(EndpointStatus={})),function(HostStatus){HostStatus.UNHEALTHY="unhealthy",HostStatus.HEALTHY="healthy",HostStatus.OFFLINE="offline",HostStatus.UPDATING="updating",HostStatus.INACTIVE="inactive"}(HostStatus||(HostStatus={})),function(MetadataQueryStrategyVersions){MetadataQueryStrategyVersions.VERSION_1="v1",MetadataQueryStrategyVersions.VERSION_2="v2"}(MetadataQueryStrategyVersions||(MetadataQueryStrategyVersions={})),function(ProtectionModes){ProtectionModes.detect="detect",ProtectionModes.prevent="prevent",ProtectionModes.off="off"}(ProtectionModes||(ProtectionModes={})),function(HostPolicyResponseActionStatus){HostPolicyResponseActionStatus.success="success",HostPolicyResponseActionStatus.failure="failure",HostPolicyResponseActionStatus.warning="warning",HostPolicyResponseActionStatus.unsupported="unsupported"}(HostPolicyResponseActionStatus||(HostPolicyResponseActionStatus={}))},172:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"j",(function(){return policyDetails})),__webpack_require__.d(__webpack_exports__,"d",(function(){return getPolicyDataForUpdate})),__webpack_require__.d(__webpack_exports__,"k",(function(){return policyDetailsForUpdate})),__webpack_require__.d(__webpack_exports__,"g",(function(){return isOnPolicyDetailsPage})),__webpack_require__.d(__webpack_exports__,"h",(function(){return selectors_license})),__webpack_require__.d(__webpack_exports__,"l",(function(){return policyIdFromParams})),__webpack_require__.d(__webpack_exports__,"c",(function(){return fullPolicy})),__webpack_require__.d(__webpack_exports__,"i",(function(){return policyConfig})),__webpack_require__.d(__webpack_exports__,"e",(function(){return isAntivirusRegistrationEnabled})),__webpack_require__.d(__webpack_exports__,"f",(function(){return isLoading})),__webpack_require__.d(__webpack_exports__,"b",(function(){return apiError})),__webpack_require__.d(__webpack_exports__,"a",(function(){return agentStatusSummary})),__webpack_require__.d(__webpack_exports__,"m",(function(){return updateStatus}));var lib=__webpack_require__(128),external_kbnSharedDeps_ReactRouterDom_=__webpack_require__(77),license_license=__webpack_require__(48),policy_config=__webpack_require__(280);var constants=__webpack_require__(132);const policyDetails=state=>state.policyItem,licensedPolicy=Object(lib.createSelector)(policyDetails,state=>state.license,(policyData,license)=>{if(policyData){const policyValue=((policy,license)=>Object(license_license.b)(license,"platinum")?policy:Object(policy_config.c)(policy))(policyData.inputs[0].config.policy.value,license);return{...policyData,inputs:[{...policyData.inputs[0],config:{...policyData.inputs[0].config,policy:{...policyData.inputs[0].config.policy,value:policyValue}}}]}}return policyData}),getPolicyDataForUpdate=policy=>{const{id:id,revision:revision,created_by:created_by,created_at:created_at,updated_by:updated_by,updated_at:updated_at,...newPolicy}=policy;return{...newPolicy,inputs:newPolicy.inputs.map(input=>({...input,config:input.config&&{...input.config,policy:{...input.config.policy,value:{...input.config.policy.value,windows:{...input.config.policy.value.windows,popup:{...input.config.policy.value.windows.popup,malware:{...input.config.policy.value.windows.popup.malware,message:input.config.policy.value.windows.popup.malware.message.trim()}}},mac:{...input.config.policy.value.mac,popup:{...input.config.policy.value.mac.popup,malware:{...input.config.policy.value.mac.popup.malware,message:input.config.policy.value.mac.popup.malware.message.trim()}}}}}}}))}},policyDetailsForUpdate=Object(lib.createSelector)(licensedPolicy,policy=>{if(policy)return getPolicyDataForUpdate(policy)}),isOnPolicyDetailsPage=state=>{var _state$location$pathn,_state$location;return null!==Object(external_kbnSharedDeps_ReactRouterDom_.matchPath)(null!==(_state$location$pathn=null===(_state$location=state.location)||void 0===_state$location?void 0:_state$location.pathname)&&void 0!==_state$location$pathn?_state$location$pathn:"",{path:constants.h,exact:!0})},selectors_license=state=>state.license,policyIdFromParams=Object(lib.createSelector)(state=>state.location,location=>{var _matchPath$params$pol,_matchPath,_matchPath$params,_location$pathname;return null!==(_matchPath$params$pol=null===(_matchPath=Object(external_kbnSharedDeps_ReactRouterDom_.matchPath)(null!==(_location$pathname=null==location?void 0:location.pathname)&&void 0!==_location$pathname?_location$pathname:"",{path:constants.h,exact:!0}))||void 0===_matchPath||null===(_matchPath$params=_matchPath.params)||void 0===_matchPath$params?void 0:_matchPath$params.policyId)&&void 0!==_matchPath$params$pol?_matchPath$params$pol:""}),defaultFullPolicy=Object(policy_config.b)(),fullPolicy=Object(lib.createSelector)(licensedPolicy,policyData=>{var _policyData$inputs$0$,_policyData$inputs$,_policyData$inputs$$c,_policyData$inputs$$c2;return null!==(_policyData$inputs$0$=null==policyData||null===(_policyData$inputs$=policyData.inputs[0])||void 0===_policyData$inputs$||null===(_policyData$inputs$$c=_policyData$inputs$.config)||void 0===_policyData$inputs$$c||null===(_policyData$inputs$$c2=_policyData$inputs$$c.policy)||void 0===_policyData$inputs$$c2?void 0:_policyData$inputs$$c2.value)&&void 0!==_policyData$inputs$0$?_policyData$inputs$0$:defaultFullPolicy}),fullWindowsPolicySettings=Object(lib.createSelector)(fullPolicy,policy=>null==policy?void 0:policy.windows),fullMacPolicySettings=Object(lib.createSelector)(fullPolicy,policy=>null==policy?void 0:policy.mac),fullLinuxPolicySettings=Object(lib.createSelector)(fullPolicy,policy=>null==policy?void 0:policy.linux),policyConfig=Object(lib.createSelector)(fullWindowsPolicySettings,fullMacPolicySettings,fullLinuxPolicySettings,(windows,mac,linux)=>({windows:{advanced:windows.advanced,events:windows.events,malware:windows.malware,ransomware:windows.ransomware,popup:windows.popup,antivirus_registration:windows.antivirus_registration},mac:{advanced:mac.advanced,events:mac.events,malware:mac.malware,popup:mac.popup},linux:{advanced:linux.advanced,events:linux.events}})),isAntivirusRegistrationEnabled=Object(lib.createSelector)(policyConfig,uiPolicyConfig=>uiPolicyConfig.windows.antivirus_registration.enabled),isLoading=state=>state.isLoading,apiError=state=>state.apiError,agentStatusSummary=state=>state.agentStatusSummary,updateStatus=state=>state.updateStatus},199:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return usePolicyDetailsSelector}));var react_redux__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(110),_common_constants__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(132);function usePolicyDetailsSelector(selector){return Object(react_redux__WEBPACK_IMPORTED_MODULE_0__.useSelector)(state=>selector(state[_common_constants__WEBPACK_IMPORTED_MODULE_1__.l][_common_constants__WEBPACK_IMPORTED_MODULE_1__.m]))}},215:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return useNavigateToAppEventHandler}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(6),_lib_kibana__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(109);const useNavigateToAppEventHandler=(appId,options)=>{const{services:services}=Object(_lib_kibana__WEBPACK_IMPORTED_MODULE_1__.h)(),{path:path,state:state,onClick:onClick}=options||{};return Object(react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(ev=>{try{onClick&&onClick(ev)}catch(error){throw ev.preventDefault(),error}ev.defaultPrevented||0===ev.button&&(ev.currentTarget instanceof HTMLAnchorElement&&""!==ev.currentTarget.target&&"_self"!==ev.currentTarget.target||ev.metaKey||ev.altKey||ev.ctrlKey||ev.shiftKey||(ev.preventDefault(),services.application.navigateToApp(appId,{path:path,state:state})))},[appId,onClick,path,services.application,state])}},253:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return LinkToApp}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(6),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),_elastic_eui__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(74),_hooks_endpoint_use_navigate_to_app_event_handler__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(215);function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const LinkToApp=Object(react__WEBPACK_IMPORTED_MODULE_0__.memo)(({appId:appId,appPath:path,appState:state,onClick:onClick,asButton:asButton,children:children,...otherProps})=>{const handleOnClick=Object(_hooks_endpoint_use_navigate_to_app_event_handler__WEBPACK_IMPORTED_MODULE_2__.a)(appId,{path:path,state:state,onClick:onClick});return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0___default.a.Fragment,null,asButton&&!0===asButton?react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__.EuiButton,_extends({},otherProps,{onClick:handleOnClick}),children):react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__.EuiLink,_extends({},otherProps,{onClick:handleOnClick}),children))})},280:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return policyFactory})),__webpack_require__.d(__webpack_exports__,"c",(function(){return policyFactoryWithoutPaidFeatures})),__webpack_require__.d(__webpack_exports__,"a",(function(){return DefaultMalwareMessage}));var _types__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(137);const policyFactory=()=>({windows:{events:{dll_and_driver_load:!0,dns:!0,file:!0,network:!0,process:!0,registry:!0,security:!0},malware:{mode:_types__WEBPACK_IMPORTED_MODULE_0__.f.prevent},ransomware:{mode:_types__WEBPACK_IMPORTED_MODULE_0__.f.prevent},popup:{malware:{message:"",enabled:!0},ransomware:{message:"",enabled:!0}},logging:{file:"info"},antivirus_registration:{enabled:!1}},mac:{events:{process:!0,file:!0,network:!0},malware:{mode:_types__WEBPACK_IMPORTED_MODULE_0__.f.prevent},popup:{malware:{message:"",enabled:!0}},logging:{file:"info"}},linux:{events:{process:!0,file:!0,network:!0},logging:{file:"info"}}}),policyFactoryWithoutPaidFeatures=(policy=policyFactory())=>({...policy,windows:{...policy.windows,ransomware:{mode:_types__WEBPACK_IMPORTED_MODULE_0__.f.off},popup:{...policy.windows.popup,malware:{message:"",enabled:!0},ransomware:{message:"",enabled:!1}}},mac:{...policy.mac,popup:{...policy.mac.popup,malware:{message:"",enabled:!0}}}}),DefaultMalwareMessage="Elastic Security {action} {filename}"},317:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return ENDPOINTS_TAB})),__webpack_require__.d(__webpack_exports__,"d",(function(){return POLICIES_TAB})),__webpack_require__.d(__webpack_exports__,"e",(function(){return TRUSTED_APPS_TAB})),__webpack_require__.d(__webpack_exports__,"a",(function(){return BETA_BADGE_LABEL})),__webpack_require__.d(__webpack_exports__,"c",(function(){return OS_TITLES}));var _kbn_i18n__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1),_common_endpoint_types__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(137);const ENDPOINTS_TAB=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.endpointsTab",{defaultMessage:"Endpoints"}),POLICIES_TAB=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.policiesTab",{defaultMessage:"Policies"}),TRUSTED_APPS_TAB=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.trustedAppsTab",{defaultMessage:"Trusted applications"}),BETA_BADGE_LABEL=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.administration.list.beta",{defaultMessage:"Beta"}),OS_TITLES={[_common_endpoint_types__WEBPACK_IMPORTED_MODULE_1__.e.WINDOWS]:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.administration.os.windows",{defaultMessage:"Windows"}),[_common_endpoint_types__WEBPACK_IMPORTED_MODULE_1__.e.MAC]:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.administration.os.macos",{defaultMessage:"Mac"}),[_common_endpoint_types__WEBPACK_IMPORTED_MODULE_1__.e.LINUX]:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.securitySolution.administration.os.linux",{defaultMessage:"Linux"})}},500:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return AdvancedPolicyForms}));var external_kbnSharedDeps_React_=__webpack_require__(6),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),lib=__webpack_require__(110),external_kbnSharedDeps_ElasticEui_=__webpack_require__(74),external_kbnSharedDeps_Lodash_=__webpack_require__(80),external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(76),external_kbnSharedDeps_KbnI18n_=__webpack_require__(1),selectors=__webpack_require__(172),policy_hooks=__webpack_require__(199);const AdvancedPolicySchema=[{key:"linux.advanced.agent.connection_delay",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.agent.connection_delay",{defaultMessage:"How long to wait for agent connectivity before sending first policy reply, in seconds. Default: 60."})},{key:"linux.advanced.artifacts.global.base_url",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.artifacts.global.base_url",{defaultMessage:"Base URL from which to download global artifact manifests. Default: https://artifacts.security.elastic.co."})},{key:"linux.advanced.artifacts.global.manifest_relative_url",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.artifacts.global.manifest_relative_url",{defaultMessage:"Relative URL from which to download global artifact manifests. Default: /downloads/endpoint/manifest/artifacts-<version>.zip."})},{key:"linux.advanced.artifacts.global.public_key",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.artifacts.global.public_key",{defaultMessage:"PEM-encoded public key used to verify the global artifact manifest signature."})},{key:"linux.advanced.artifacts.global.interval",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.artifacts.global.interval",{defaultMessage:"Interval between global artifact manifest download attempts, in seconds. Default: 3600."})},{key:"linux.advanced.artifacts.user.public_key",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.artifacts.user.public_key",{defaultMessage:"PEM-encoded public key used to verify the user artifact manifest signature."})},{key:"linux.advanced.elasticsearch.delay",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.elasticsearch.delay",{defaultMessage:"Delay for sending events to Elasticsearch, in seconds. Default: 120."})},{key:"linux.advanced.elasticsearch.tls.verify_peer",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.elasticsearch.tls.verify_peer",{defaultMessage:"Whether to verify the certificates presented by the peer. Default: true."})},{key:"linux.advanced.elasticsearch.tls.verify_hostname",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.elasticsearch.tls.verify_hostname",{defaultMessage:"Whether to verify the hostname of the peer is what's in the certificate. Default: true."})},{key:"linux.advanced.elasticsearch.tls.ca_cert",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.elasticsearch.tls.ca_cert",{defaultMessage:"PEM-encoded certificate for Elasticsearch certificate authority."})},{key:"linux.advanced.logging.file",first_supported_version:"7.11",documentation:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.logging.file",{defaultMessage:"A supplied value will override the log level configured for logs that are saved to disk and streamed to Elasticsearch. It is recommended Fleet be used to change this logging in most circumstances. Allowed values are error, warning, info, debug, and trace."})},{key:"linux.advanced.logging.syslog",first_supported_version:"7.11",documentation:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.logging.syslog",{defaultMessage:"A supplied value will configure logging to syslog. Allowed values are error, warning, info, debug, and trace."})},{key:"mac.advanced.agent.connection_delay",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.agent.connection_delay",{defaultMessage:"How long to wait for agent connectivity before sending first policy reply, in seconds. Default: 60."})},{key:"mac.advanced.artifacts.global.base_url",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.artifacts.global.base_url",{defaultMessage:"URL from which to download global artifact manifests."})},{key:"mac.advanced.artifacts.global.manifest_relative_url",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.artifacts.global.manifest_relative_url",{defaultMessage:"Relative URL from which to download global artifact manifests. Default: /downloads/endpoint/manifest/artifacts-<version>.zip."})},{key:"mac.advanced.artifacts.global.public_key",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.artifacts.global.public_key",{defaultMessage:"PEM-encoded public key used to verify the global artifact manifest signature."})},{key:"mac.advanced.artifacts.global.interval",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.artifacts.global.interval",{defaultMessage:"Interval between global artifact manifest download attempts, in seconds. Default: 3600."})},{key:"mac.advanced.artifacts.user.public_key",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.artifacts.user.public_key",{defaultMessage:"PEM-encoded public key used to verify the user artifact manifest signature."})},{key:"mac.advanced.elasticsearch.delay",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.elasticsearch.delay",{defaultMessage:"Delay for sending events to Elasticsearch, in seconds. Default: 120."})},{key:"mac.advanced.elasticsearch.tls.verify_peer",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.elasticsearch.tls.verify_peer",{defaultMessage:"Whether to verify the certificates presented by the peer. Default: true."})},{key:"mac.advanced.elasticsearch.tls.verify_hostname",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.elasticsearch.tls.verify_hostname",{defaultMessage:"Whether to verify the hostname of the peer is what's in the certificate. Default: true."})},{key:"mac.advanced.elasticsearch.tls.ca_cert",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.elasticsearch.tls.ca_cert",{defaultMessage:"PEM-encoded certificate for Elasticsearch certificate authority."})},{key:"mac.advanced.logging.file",first_supported_version:"7.11",documentation:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.logging.file",{defaultMessage:"A supplied value will override the log level configured for logs that are saved to disk and streamed to Elasticsearch. It is recommended Fleet be used to change this logging in most circumstances. Allowed values are error, warning, info, debug, and trace."})},{key:"mac.advanced.logging.syslog",first_supported_version:"7.11",documentation:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.logging.syslog",{defaultMessage:"A supplied value will configure logging to syslog. Allowed values are error, warning, info, debug, and trace."})},{key:"mac.advanced.malware.quarantine",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.malware.quarantine",{defaultMessage:"Whether quarantine should be enabled when malware prevention is enabled. Default: true."})},{key:"mac.advanced.malware.threshold",first_supported_version:"7.11",documentation:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.malware.threshold",{defaultMessage:"The threshold that should be used for evaluating malware. Allowed values are normal, conservative, and aggressive. Default: normal."})},{key:"mac.advanced.kernel.connect",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.kernel.connect",{defaultMessage:"Whether to connect to the kernel driver. Default: true."})},{key:"mac.advanced.kernel.process",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.kernel.process",{defaultMessage:"A value of 'false' overrides other config settings that would enable kernel process events. Default: true."})},{key:"mac.advanced.kernel.filewrite",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.kernel.filewrite",{defaultMessage:"A value of 'false' overrides other config settings that would enable kernel file write events. Default: true."})},{key:"mac.advanced.kernel.network",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.kernel.network",{defaultMessage:"A value of 'false' overrides other config settings that would enable kernel network events. Default: true."})},{key:"mac.advanced.harden.self_protect",first_supported_version:"7.11",documentation:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.harden.self_protect",{defaultMessage:"Enables self-protection on macOS. Default: true."})},{key:"windows.advanced.agent.connection_delay",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.agent.connection_delay",{defaultMessage:"How long to wait for agent connectivity before sending first policy reply, in seconds. Default: 60."})},{key:"windows.advanced.artifacts.global.base_url",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.artifacts.global.base_url",{defaultMessage:"URL from which to download global artifact manifests."})},{key:"windows.advanced.artifacts.global.manifest_relative_url",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.artifacts.global.manifest_relative_url",{defaultMessage:"Relative URL from which to download global artifact manifests. Default: /downloads/endpoint/manifest/artifacts-<version>.zip."})},{key:"windows.advanced.artifacts.global.public_key",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.artifacts.global.public_key",{defaultMessage:"PEM-encoded public key used to verify the global artifact manifest signature."})},{key:"windows.advanced.artifacts.global.interval",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.artifacts.global.interval",{defaultMessage:"Interval between global artifact manifest download attempts, in seconds. Default: 3600."})},{key:"windows.advanced.artifacts.user.public_key",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.artifacts.user.public_key",{defaultMessage:"PEM-encoded public key used to verify the user artifact manifest signature."})},{key:"windows.advanced.elasticsearch.delay",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.elasticsearch.delay",{defaultMessage:"Delay for sending events to Elasticsearch, in seconds. Default: 120."})},{key:"windows.advanced.elasticsearch.tls.verify_peer",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.elasticsearch.tls.verify_peer",{defaultMessage:"Whether to verify the certificates presented by the peer. Default: true."})},{key:"windows.advanced.elasticsearch.tls.verify_hostname",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.elasticsearch.tls.verify_hostname",{defaultMessage:"Whether to verify the hostname of the peer is what's in the certificate. Default: true."})},{key:"windows.advanced.elasticsearch.tls.ca_cert",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.elasticsearch.tls.ca_cert",{defaultMessage:"PEM-encoded certificate for Elasticsearch certificate authority."})},{key:"windows.advanced.logging.file",first_supported_version:"7.11",documentation:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.logging.file",{defaultMessage:"A supplied value will override the log level configured for logs that are saved to disk and streamed to Elasticsearch. It is recommended Fleet be used to change this logging in most circumstances. Allowed values are error, warning, info, debug, and trace."})},{key:"windows.advanced.logging.debugview",first_supported_version:"7.11",documentation:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.logging.debugview",{defaultMessage:"A supplied value will configure logging to Debugview (a Sysinternals tool). Allowed values are error, warning, info, debug, and trace."})},{key:"windows.advanced.malware.quarantine",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.malware.quarantine",{defaultMessage:"Whether quarantine should be enabled when malware prevention is enabled. Default: true."})},{key:"windows.advanced.malware.threshold",first_supported_version:"7.11",documentation:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.malware.threshold",{defaultMessage:"The threshold that should be used for evaluating malware. Allowed values are normal, conservative, and aggressive. Default: normal."})},{key:"windows.advanced.kernel.connect",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.connect",{defaultMessage:"Whether to connect to the kernel driver. Default: true."})},{key:"windows.advanced.kernel.process",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.process",{defaultMessage:"A value of 'false' overrides other config settings that would enable kernel process events. Default: true."})},{key:"windows.advanced.kernel.filewrite",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.filewrite",{defaultMessage:"A value of 'false' overrides other config settings that would enable kernel file write events. Default: true."})},{key:"windows.advanced.kernel.network",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.network",{defaultMessage:"A value of 'false' overrides other config settings that would enable kernel network events. Default: true."})},{key:"windows.advanced.kernel.fileopen",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.fileopen",{defaultMessage:"A value of 'false' overrides other config settings that would enable kernel file open events. Default: true."})},{key:"windows.advanced.kernel.asyncimageload",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.asyncimageload",{defaultMessage:"A value of 'false' overrides other config settings that would enable kernel async image load events. Default: true."})},{key:"windows.advanced.kernel.syncimageload",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.syncimageload",{defaultMessage:"A value of 'false' overrides other config settings that would enable kernel sync image load events. Default: true."})},{key:"windows.advanced.kernel.registry",first_supported_version:"7.9",documentation:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.kernel.registry",{defaultMessage:"A value of 'false' overrides other config settings that would enable kernel registry events. Default: true."})},{key:"windows.advanced.diagnostic.enabled",first_supported_version:"7.11",documentation:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.diagnostic.enabled",{defaultMessage:"A value of 'false' disables running diagnostic features on Endpoint. Default: true."})},{key:"linux.advanced.diagnostic.enabled",first_supported_version:"7.12",documentation:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.linux.advanced.diagnostic.enabled",{defaultMessage:"A value of 'false' disables running diagnostic features on Endpoint. Default: true."})},{key:"mac.advanced.diagnostic.enabled",first_supported_version:"7.12",documentation:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.diagnostic.enabled",{defaultMessage:"A value of 'false' disables running diagnostic features on Endpoint. Default: true."})},{key:"windows.advanced.alerts.cloud_lookup",first_supported_version:"7.12",documentation:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.alerts.cloud_lookup",{defaultMessage:"A value of 'false' disables cloud lookup for Windows alerts. Default: true."})},{key:"mac.advanced.alerts.cloud_lookup",first_supported_version:"7.12",documentation:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.mac.advanced.alerts.cloud_lookup",{defaultMessage:"A value of 'false' disables cloud lookup for Mac alerts. Default: true."})},{key:"windows.advanced.ransomware.mbr",first_supported_version:"7.12",documentation:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.windows.advanced.ransomware.mbr",{defaultMessage:"A value of 'false' disables Ransomware MBR protection. Default: true."})}];const calloutTitle=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.calloutTitle",{defaultMessage:"Proceed with caution!"}),warningMessage=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.advanced.warningMessage",{defaultMessage:"This section contains policy values that support advanced use cases. If not configured\n    properly, these values can cause unpredictable behavior. Please consult documentation\n    carefully or contact support before editing these values."}),AdvancedPolicyForms=external_kbnSharedDeps_React_default.a.memo(()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:calloutTitle,color:"warning",iconType:"alert"},external_kbnSharedDeps_React_default.a.createElement("p",null,warningMessage)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs",color:"subdued"},external_kbnSharedDeps_React_default.a.createElement("h4",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.advanced",defaultMessage:"Advanced settings"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPanel,{"data-test-subj":"advancedPolicyPanel",paddingSize:"s"},AdvancedPolicySchema.map((advancedField,index)=>{const configPath=advancedField.key.split(".");return external_kbnSharedDeps_React_default.a.createElement(PolicyAdvanced,{key:index,configPath:configPath,firstSupportedVersion:advancedField.first_supported_version,lastSupportedVersion:advancedField.last_supported_version,documentation:advancedField.documentation})}))));AdvancedPolicyForms.displayName="AdvancedPolicyForms";const PolicyAdvanced=external_kbnSharedDeps_React_default.a.memo(({configPath:configPath,firstSupportedVersion:firstSupportedVersion,lastSupportedVersion:lastSupportedVersion,documentation:documentation})=>{const dispatch=Object(lib.useDispatch)(),policyDetailsConfig=Object(policy_hooks.a)(selectors.i),onChange=Object(external_kbnSharedDeps_React_.useCallback)(event=>{if(policyDetailsConfig){const newPayload=Object(external_kbnSharedDeps_Lodash_.cloneDeep)(policyDetailsConfig);!function(obj,value,path){let newPolicyConfig=obj;for(let i=0;i<path.length-1;i++)newPolicyConfig[path[i]]||(newPolicyConfig[path[i]]={}),newPolicyConfig=newPolicyConfig[path[i]];if(newPolicyConfig[path[path.length-1]]=value,""===value||void 0===value){newPolicyConfig=obj;for(let k=path.length;k>=0;k--){const nextPath=path.slice(0,k);for(let i=0;i<nextPath.length-1;i++)newPolicyConfig=newPolicyConfig[nextPath[i]];if(void 0!==newPolicyConfig[nextPath[nextPath.length-1]]&&""!==newPolicyConfig[nextPath[nextPath.length-1]]&&0!==Object.keys(newPolicyConfig[nextPath[nextPath.length-1]]).length)break;"advanced"===nextPath[nextPath.length-1]?newPolicyConfig[nextPath[nextPath.length-1]]=void 0:delete newPolicyConfig[nextPath[nextPath.length-1]],newPolicyConfig=obj}}}(newPayload,event.target.value,configPath),dispatch({type:"userChangedPolicyConfig",payload:{policyConfig:newPayload}})}},[dispatch,policyDetailsConfig,configPath]),value=policyDetailsConfig&&function(obj,path){let currentPolicyConfig=obj;for(let i=0;i<path.length-1;i++){if(!currentPolicyConfig[path[i]])return;currentPolicyConfig=currentPolicyConfig[path[i]]}return currentPolicyConfig[path[path.length-1]]}(policyDetailsConfig,configPath);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{fullWidth:!0,label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,configPath.join(".")),documentation&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIconTip,{content:documentation,position:"right"}))),labelAppend:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs"},lastSupportedVersion?`${firstSupportedVersion}-${lastSupportedVersion}`:firstSupportedVersion+"+")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldText,{"data-test-subj":configPath.join("."),fullWidth:!0,value:value,onChange:onChange})))});PolicyAdvanced.displayName="PolicyAdvanced"},713:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return PolicyDetailsForm}));var external_kbnSharedDeps_ElasticEui_=__webpack_require__(74),external_kbnSharedDeps_React_=__webpack_require__(6),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(76),external_kbnSharedDeps_KbnI18n_=__webpack_require__(1),constants=__webpack_require__(2),types=__webpack_require__(3),endpoint_types=__webpack_require__(137);let OS;!function(OS){OS.windows="windows",OS.mac="mac",OS.linux="linux"}(OS||(OS={}));var translations=__webpack_require__(317);const TITLES={type:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policyDetailType",{defaultMessage:"Type"}),os:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policyDetailOS",{defaultMessage:"Operating System"})},ConfigFormHeading=Object(external_kbnSharedDeps_React_.memo)(({children:children})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"xxs"},external_kbnSharedDeps_React_default.a.createElement("h5",null,children)));ConfigFormHeading.displayName="ConfigFormHeading";const ConfigForm=Object(external_kbnSharedDeps_React_.memo)(({type:type,supportedOss:supportedOss,osRestriction:osRestriction,dataTestSubj:dataTestSubj,rightCorner:rightCorner,children:children})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPanel,{"data-test-subj":dataTestSubj},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"row",gutterSize:"none",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:2},external_kbnSharedDeps_React_default.a.createElement(ConfigFormHeading,null,TITLES.type),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"m"},type)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:2},external_kbnSharedDeps_React_default.a.createElement(ConfigFormHeading,null,TITLES.os),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"row",gutterSize:"s",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,supportedOss.map(os=>translations.c[os]).join(", ")," ")),osRestriction&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"row",gutterSize:"xs"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTextColor,{color:"subdued"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.antivirusRegistration.osRestriction",defaultMessage:"Restrictions"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIconTip,{type:"iInCircle",color:"subdued",content:osRestriction})))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiShowFor,{sizes:["m","l","xl"]},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:3},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"row",gutterSize:"none",justifyContent:"flexEnd"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},rightCorner)))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiShowFor,{sizes:rightCorner?["s","xs"]:[]},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,rightCorner))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHorizontalRule,{margin:"m"}),children));ConfigForm.displayName="ConfigForm";var link_to_app=__webpack_require__(253),use_license=__webpack_require__(27),external_kbnSharedDeps_StyledComponents_=__webpack_require__(75),external_kbnSharedDeps_StyledComponents_default=__webpack_require__.n(external_kbnSharedDeps_StyledComponents_),lib=__webpack_require__(110),external_kbnSharedDeps_Lodash_=__webpack_require__(80),policy_hooks=__webpack_require__(199),selectors=__webpack_require__(172);const ProtectionRadio=external_kbnSharedDeps_React_default.a.memo(({protection:protection,protectionMode:protectionMode,osList:osList,label:label})=>{const policyDetailsConfig=Object(policy_hooks.a)(selectors.i),dispatch=Object(lib.useDispatch)(),radioButtonId=Object(external_kbnSharedDeps_React_.useMemo)(()=>Object(external_kbnSharedDeps_ElasticEui_.htmlIdGenerator)()(),[]),selected=policyDetailsConfig&&policyDetailsConfig.windows[protection].mode,isPlatinumPlus=Object(use_license.b)().isPlatinumPlus(),handleRadioChange=Object(external_kbnSharedDeps_React_.useCallback)(()=>{if(policyDetailsConfig){const newPayload=Object(external_kbnSharedDeps_Lodash_.cloneDeep)(policyDetailsConfig);for(const os of osList)("windows"===os||"mac"===os)&&(newPayload[os][protection].mode=protectionMode),isPlatinumPlus&&("windows"===os||"mac"===os)&&(protectionMode===endpoint_types.f.prevent?newPayload[os].popup[protection].enabled=!0:newPayload[os].popup[protection].enabled=!1);dispatch({type:"userChangedPolicyConfig",payload:{policyConfig:newPayload}})}},[dispatch,protectionMode,policyDetailsConfig,isPlatinumPlus,osList,protection]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiRadio,{className:"policyDetailsProtectionRadio",label:label,id:radioButtonId,checked:selected===protectionMode,onChange:handleRadioChange,disabled:selected===endpoint_types.f.off})});ProtectionRadio.displayName="ProtectionRadio";const RadioFlexGroup=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup).withConfig({displayName:"RadioFlexGroup",componentId:"sc-5bp4yp-0"})([".no-right-margin-radio{margin-right:0;}.no-horizontal-margin-radio{margin:"," 0;}"],props=>props.theme.eui.ruleMargins.marginSmall),RadioButtons=external_kbnSharedDeps_React_default.a.memo(({protection:protection,osList:osList})=>{const radios=Object(external_kbnSharedDeps_React_.useMemo)(()=>[{id:endpoint_types.f.detect,label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.details.detect",{defaultMessage:"Detect"})},{id:endpoint_types.f.prevent,label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.details.prevent",{defaultMessage:"Prevent"})}],[]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(ConfigFormHeading,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyDetailsConfig.protectionLevel",defaultMessage:"Protection Level"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(RadioFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{className:"no-right-margin-radio",grow:2},external_kbnSharedDeps_React_default.a.createElement(ProtectionRadio,{protection:protection,protectionMode:radios[0].id,osList:osList,key:{protection:protection}+radios[0].id,label:radios[0].label})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{className:"no-horizontal-margin-radio",grow:5},external_kbnSharedDeps_React_default.a.createElement(ProtectionRadio,{protection:protection,protectionMode:radios[1].id,osList:osList,key:{protection:protection}+radios[1].id,label:radios[1].label}))))});RadioButtons.displayName="RadioButtons";const popupVersionsMap=new Map([["malware","7.11+"],["ransomware","7.12+"]]),SupportedVersionNotice=({optionName:optionName})=>{const version=popupVersionsMap.get(optionName);return version?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{color:"subdued",size:"xs"},external_kbnSharedDeps_React_default.a.createElement("i",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyDetails.supportedVersion",defaultMessage:"Agent version {version}",values:{version:version}}))):null},UserNotification=external_kbnSharedDeps_React_default.a.memo(({protection:protection,osList:osList})=>{const policyDetailsConfig=Object(policy_hooks.a)(selectors.i),dispatch=Object(lib.useDispatch)(),selected=policyDetailsConfig&&policyDetailsConfig.windows[protection].mode,userNotificationSelected=policyDetailsConfig&&policyDetailsConfig.windows.popup[protection].enabled,userNotificationMessage=policyDetailsConfig&&policyDetailsConfig.windows.popup[protection].message,handleUserNotificationCheckbox=Object(external_kbnSharedDeps_React_.useCallback)(event=>{if(policyDetailsConfig){const newPayload=Object(external_kbnSharedDeps_Lodash_.cloneDeep)(policyDetailsConfig);for(const os of osList)("windows"===os||"mac"===os)&&(newPayload[os].popup[protection].enabled=event.target.checked);dispatch({type:"userChangedPolicyConfig",payload:{policyConfig:newPayload}})}},[policyDetailsConfig,dispatch,protection,osList]),handleCustomUserNotification=Object(external_kbnSharedDeps_React_.useCallback)(event=>{if(policyDetailsConfig){const newPayload=Object(external_kbnSharedDeps_Lodash_.cloneDeep)(policyDetailsConfig);for(const os of osList)("windows"===os||"mac"===os)&&(newPayload[os].popup[protection].message=event.target.value);dispatch({type:"userChangedPolicyConfig",payload:{policyConfig:newPayload}})}},[policyDetailsConfig,dispatch,protection,osList]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(ConfigFormHeading,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyDetailsConfig.userNotification",defaultMessage:"User Notification"})),external_kbnSharedDeps_React_default.a.createElement(SupportedVersionNotice,{optionName:protection}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCheckbox,{"data-test-subj":protection+"UserNotificationCheckbox",id:protection+"UserNotificationCheckbox}",onChange:handleUserNotificationCheckbox,checked:userNotificationSelected,disabled:selected===endpoint_types.f.off,label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policyDetail.notifyUser",{defaultMessage:"Notify User"})}),userNotificationSelected&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("h4",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyDetailsConfig.customizeUserNotification",defaultMessage:"Customize notification message"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIconTip,{position:"right","data-test-subj":protection+"Tooltip",content:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyDetailsConfig.notifyUserTooltip.a",defaultMessage:"Selecting the user notification option will display a notification to the host user when { protectionName } is prevented or detected.",values:{protectionName:protection}}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.endpoint.policyDetailsConfig.notifyUserTooltip.b",defaultMessage:" The user notification can be customized in the text box below. Bracketed tags can be used to dynamically populate the applicable action (such as prevented or detected) and the filename."}))}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTextArea,{placeholder:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policyDetails.userNotification.placeholder",{defaultMessage:"Input your custom notification message"}),value:userNotificationMessage,onChange:handleCustomUserNotification,fullWidth:!0,"data-test-subj":protection+"UserNotificationCustomMessage"})))});UserNotification.displayName="UserNotification";const ProtectionSwitch=external_kbnSharedDeps_React_default.a.memo(({protection:protection,osList:osList})=>{const policyDetailsConfig=Object(policy_hooks.a)(selectors.i),isPlatinumPlus=Object(use_license.b)().isPlatinumPlus(),dispatch=Object(lib.useDispatch)(),selected=policyDetailsConfig&&policyDetailsConfig.windows[protection].mode,handleSwitchChange=Object(external_kbnSharedDeps_React_.useCallback)(event=>{if(policyDetailsConfig){const newPayload=Object(external_kbnSharedDeps_Lodash_.cloneDeep)(policyDetailsConfig);if(!1===event.target.checked)for(const os of osList)("windows"===os||"mac"===os)&&(newPayload[os][protection].mode=endpoint_types.f.off),isPlatinumPlus&&("windows"===os||"mac"===os)&&(newPayload[os].popup[protection].enabled=event.target.checked);else for(const os of osList)("windows"===os||"mac"===os)&&(newPayload[os][protection].mode=endpoint_types.f.prevent),isPlatinumPlus&&("windows"===os||"mac"===os)&&(newPayload[os].popup[protection].enabled=event.target.checked);dispatch({type:"userChangedPolicyConfig",payload:{policyConfig:newPayload}})}},[dispatch,policyDetailsConfig,isPlatinumPlus,protection,osList]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSwitch,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.details.protectionsEnabled",{defaultMessage:"{protectionName} protections {mode, select, true {enabled} false {disabled}}",values:{protectionName:protection.charAt(0).toUpperCase()+protection.substring(1),mode:selected!==endpoint_types.f.off}}),checked:selected!==endpoint_types.f.off,onChange:handleSwitchChange})});ProtectionSwitch.displayName="ProtectionSwitch";const MalwareProtections=external_kbnSharedDeps_React_default.a.memo(()=>{const OSes=[OS.windows,OS.mac],isPlatinumPlus=Object(use_license.b)().isPlatinumPlus();return external_kbnSharedDeps_React_default.a.createElement(ConfigForm,{type:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.details.malware",{defaultMessage:"Malware"}),supportedOss:[endpoint_types.e.WINDOWS,endpoint_types.e.MAC],dataTestSubj:"malwareProtectionsForm",rightCorner:external_kbnSharedDeps_React_default.a.createElement(ProtectionSwitch,{protection:"malware",osList:OSes})},external_kbnSharedDeps_React_default.a.createElement(RadioButtons,{protection:"malware",osList:OSes}),isPlatinumPlus&&external_kbnSharedDeps_React_default.a.createElement(UserNotification,{protection:"malware",osList:OSes}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{iconType:"iInCircle"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.detectionRulesMessage",defaultMessage:"View {detectionRulesLink}. Prebuilt rules are tagged Elastic on the Detection Rules page.",values:{detectionRulesLink:external_kbnSharedDeps_React_default.a.createElement(link_to_app.a,{appId:`${constants.f}:${types.a.detections}`,appPath:"/rules"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.detectionRulesLink",defaultMessage:"related detection rules"}))}})))});MalwareProtections.displayName="MalwareProtections";const setIn=a=>key=>subKey=>leafKey=>v=>{const c=Object(external_kbnSharedDeps_Lodash_.cloneDeep)(a);return c[key][subKey][leafKey]=v,c},OPERATING_SYSTEM_TO_TEST_SUBJ={[endpoint_types.e.WINDOWS]:"Windows",[endpoint_types.e.LINUX]:"Linux",[endpoint_types.e.MAC]:"Mac"},countSelected=selection=>Object.values(selection).filter(value=>value).length,EventsForm=({os:os,options:options,selection:selection,onValueSelection:onValueSelection})=>external_kbnSharedDeps_React_default.a.createElement(ConfigForm,{type:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.details.eventCollection",{defaultMessage:"Event Collection"}),supportedOss:[os],rightCorner:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"s",color:"subdued"},external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.details.eventCollectionsEnabled",{defaultMessage:"{selected} / {total} event collections enabled",values:{selected:countSelected(selection),total:options.length}}))},external_kbnSharedDeps_React_default.a.createElement(ConfigFormHeading,null,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.eventingEvents",{defaultMessage:"Events"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),options.map(({name:name,protectionField:protectionField})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCheckbox,{key:String(protectionField),id:Object(external_kbnSharedDeps_ElasticEui_.htmlIdGenerator)()(),label:name,"data-test-subj":`policy${OPERATING_SYSTEM_TO_TEST_SUBJ[os]}Event_${protectionField}`,checked:selection[protectionField],onChange:event=>onValueSelection(protectionField,event.target.checked)})));EventsForm.displayName="EventsForm";const OPTIONS=[{name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.windows.events.dllDriverLoad",{defaultMessage:"DLL and Driver Load"}),protectionField:"dll_and_driver_load"},{name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.windows.events.dns",{defaultMessage:"DNS"}),protectionField:"dns"},{name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.windows.events.file",{defaultMessage:"File"}),protectionField:"file"},{name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.windows.events.network",{defaultMessage:"Network"}),protectionField:"network"},{name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.windows.events.process",{defaultMessage:"Process"}),protectionField:"process"},{name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.windows.events.registry",{defaultMessage:"Registry"}),protectionField:"registry"},{name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.windows.events.security",{defaultMessage:"Security"}),protectionField:"security"}],WindowsEvents=Object(external_kbnSharedDeps_React_.memo)(()=>{const policyDetailsConfig=Object(policy_hooks.a)(selectors.i),dispatch=Object(lib.useDispatch)();return external_kbnSharedDeps_React_default.a.createElement(EventsForm,{os:endpoint_types.e.WINDOWS,selection:policyDetailsConfig.windows.events,options:OPTIONS,onValueSelection:(value,selected)=>dispatch({type:"userChangedPolicyConfig",payload:{policyConfig:setIn(policyDetailsConfig)("windows")("events")(value)(selected)}})})});WindowsEvents.displayName="WindowsEvents";const mac_OPTIONS=[{name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.mac.events.file",{defaultMessage:"File"}),protectionField:"file"},{name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.mac.events.process",{defaultMessage:"Process"}),protectionField:"process"},{name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.mac.events.network",{defaultMessage:"Network"}),protectionField:"network"}],MacEvents=Object(external_kbnSharedDeps_React_.memo)(()=>{const policyDetailsConfig=Object(policy_hooks.a)(selectors.i),dispatch=Object(lib.useDispatch)();return external_kbnSharedDeps_React_default.a.createElement(EventsForm,{os:endpoint_types.e.MAC,selection:policyDetailsConfig.mac.events,options:mac_OPTIONS,onValueSelection:(value,selected)=>dispatch({type:"userChangedPolicyConfig",payload:{policyConfig:setIn(policyDetailsConfig)("mac")("events")(value)(selected)}})})});MacEvents.displayName="MacEvents";const linux_OPTIONS=[{name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.linux.events.file",{defaultMessage:"File"}),protectionField:"file"},{name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.linux.events.process",{defaultMessage:"Process"}),protectionField:"process"},{name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policyDetailsConfig.linux.events.network",{defaultMessage:"Network"}),protectionField:"network"}],LinuxEvents=Object(external_kbnSharedDeps_React_.memo)(()=>{const policyDetailsConfig=Object(policy_hooks.a)(selectors.i),dispatch=Object(lib.useDispatch)();return external_kbnSharedDeps_React_default.a.createElement(EventsForm,{os:endpoint_types.e.LINUX,selection:policyDetailsConfig.linux.events,options:linux_OPTIONS,onValueSelection:(value,selected)=>dispatch({type:"userChangedPolicyConfig",payload:{policyConfig:setIn(policyDetailsConfig)("linux")("events")(value)(selected)}})})});LinuxEvents.displayName="LinuxEvents";var policy_advanced=__webpack_require__(500);const TRANSLATIONS={title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.details.antivirusRegistration.type",{defaultMessage:"Register as antivirus"}),description:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.details.antivirusRegistration.explanation",{defaultMessage:"Toggle on to register Elastic as an official Antivirus solution for Windows OS. This will also disable Windows Defender."}),label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.details.antivirusRegistration.toggle",{defaultMessage:"Register as antivirus"})},AntivirusRegistrationForm=Object(external_kbnSharedDeps_React_.memo)(()=>{const antivirusRegistrationEnabled=Object(policy_hooks.a)(selectors.e),dispatch=Object(lib.useDispatch)(),handleSwitchChange=Object(external_kbnSharedDeps_React_.useCallback)(event=>dispatch({type:"userChangedAntivirusRegistration",payload:{enabled:event.target.checked}}),[dispatch]);return external_kbnSharedDeps_React_default.a.createElement(ConfigForm,{type:TRANSLATIONS.title,supportedOss:[endpoint_types.e.WINDOWS],osRestriction:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.details.av.windowsServerNotSupported",{defaultMessage:"Windows Server operating systems unsupported"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"s"},TRANSLATIONS.description),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSwitch,{label:TRANSLATIONS.label,checked:antivirusRegistrationEnabled,onChange:handleSwitchChange}))});AntivirusRegistrationForm.displayName="AntivirusRegistrationForm";const Ransomware=external_kbnSharedDeps_React_default.a.memo(()=>{const OSes=[OS.windows];return external_kbnSharedDeps_React_default.a.createElement(ConfigForm,{type:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.details.ransomware",{defaultMessage:"Ransomware"}),supportedOss:[endpoint_types.e.WINDOWS],dataTestSubj:"ransomwareProtectionsForm",rightCorner:external_kbnSharedDeps_React_default.a.createElement(ProtectionSwitch,{protection:"ransomware",osList:OSes})},external_kbnSharedDeps_React_default.a.createElement(RadioButtons,{protection:"ransomware",osList:OSes}),external_kbnSharedDeps_React_default.a.createElement(UserNotification,{protection:"ransomware",osList:OSes}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{iconType:"iInCircle"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.detectionRulesMessage",defaultMessage:"View {detectionRulesLink}. Prebuilt rules are tagged Elastic on the Detection Rules page.",values:{detectionRulesLink:external_kbnSharedDeps_React_default.a.createElement(link_to_app.a,{appId:`${constants.f}:${types.a.detections}`,appPath:"/rules"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.detectionRulesLink",defaultMessage:"related detection rules"}))}})))});Ransomware.displayName="RansomwareProtections";const LockedPolicyDiv=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"LockedPolicyDiv",componentId:"pvk7p4-0"})([".euiCard__betaBadgeWrapper{.euiCard__betaBadge{width:auto;}}.lockedCardDescription{padding:0 ",";}"],props=>props.theme.eui.fractions.thirds.percentage),LockedPolicyCard=Object(external_kbnSharedDeps_React_.memo)(()=>external_kbnSharedDeps_React_default.a.createElement(LockedPolicyDiv,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCard,{"data-test-subj":"lockedPolicyCard",betaBadgeLabel:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.policy.details.platinum",{defaultMessage:"Platinum"}),isDisabled:!0,icon:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{size:"xl",type:"lock"}),title:external_kbnSharedDeps_React_default.a.createElement("h3",null,external_kbnSharedDeps_React_default.a.createElement("strong",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.ransomware",defaultMessage:"Ransomware"}))),description:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{className:"lockedCardDescription",direction:"column",gutterSize:"none"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement("h4",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTextColor,{color:"subdued"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.upgradeToPlatinum",defaultMessage:"Upgrade to Elastic Platinum"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.lockedCard",defaultMessage:"To turn on Ransomware protection, you must upgrade your license to Platinum, start a free 30-day trial, or spin up a {cloudDeploymentLink} on AWS, GCP, or Azure.",values:{cloudDeploymentLink:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{href:"https://www.elastic.co/cloud/",target:"_blank"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.cloudDeploymentLInk",defaultMessage:"cloud deployment"}))}}))))))));LockedPolicyCard.displayName="LockedPolicyCard";const PolicyDetailsForm=Object(external_kbnSharedDeps_React_.memo)(()=>{const[showAdvancedPolicy,setShowAdvancedPolicy]=Object(external_kbnSharedDeps_React_.useState)(!1),handleAdvancedPolicyClick=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setShowAdvancedPolicy(!showAdvancedPolicy)},[showAdvancedPolicy]),isPlatinumPlus=Object(use_license.b)().isPlatinumPlus();return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs",color:"subdued"},external_kbnSharedDeps_React_default.a.createElement("h4",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.protections",defaultMessage:"Protections"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(MalwareProtections,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),isPlatinumPlus?external_kbnSharedDeps_React_default.a.createElement(Ransomware,null):external_kbnSharedDeps_React_default.a.createElement(LockedPolicyCard,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs",color:"subdued"},external_kbnSharedDeps_React_default.a.createElement("h4",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.details.settings",defaultMessage:"Settings"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(WindowsEvents,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(MacEvents,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(LinuxEvents,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(AntivirusRegistrationForm,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{"data-test-subj":"advancedPolicyButton",onClick:handleAdvancedPolicyClick},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.endpoint.policy.advanced.show",defaultMessage:"{action} advanced settings",values:{action:showAdvancedPolicy?"Hide":"Show"}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"}),showAdvancedPolicy&&external_kbnSharedDeps_React_default.a.createElement(policy_advanced.a,null))});PolicyDetailsForm.displayName="PolicyDetailsForm"}}]);