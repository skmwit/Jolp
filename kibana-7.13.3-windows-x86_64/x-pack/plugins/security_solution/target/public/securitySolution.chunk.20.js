/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[20],{1125:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"EndpointPackageCustomExtension",(function(){return EndpointPackageCustomExtension}));var external_kbnSharedDeps_React_=__webpack_require__(6),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),external_kbnSharedDeps_ElasticEui_=__webpack_require__(74),external_kbnSharedDeps_KbnI18n_=__webpack_require__(1),external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(76),public_=__webpack_require__(99),kibanaReact_public_=__webpack_require__(79),routing=__webpack_require__(149),common_=__webpack_require__(91),constants=__webpack_require__(132),external_kbnSharedDeps_StyledComponents_=__webpack_require__(75),external_kbnSharedDeps_StyledComponents_default=__webpack_require__.n(external_kbnSharedDeps_StyledComponents_),link_to_app=__webpack_require__(253);const LinkLabel=external_kbnSharedDeps_StyledComponents_default.a.span.withConfig({displayName:"LinkLabel",componentId:"sc-1ril6c5-0"})(["display:inline-block;padding-right:",";"],props=>props.theme.eui.paddingSizes.s),LinkWithIcon=Object(external_kbnSharedDeps_React_.memo)(({children:children,...props})=>external_kbnSharedDeps_React_default.a.createElement(link_to_app.a,props,external_kbnSharedDeps_React_default.a.createElement(LinkLabel,null,children),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{type:"popout"})));LinkWithIcon.displayName="LinkWithIcon";var service=__webpack_require__(502);const SUMMARY_KEYS=["windows","macos","linux","total"],SUMMARY_LABELS={windows:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.fleetCustomExtension.trustedAppItemsSummary.windows",{defaultMessage:"Windows"}),linux:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.fleetCustomExtension.trustedAppItemsSummary.linux",{defaultMessage:"Linux"}),macos:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.fleetCustomExtension.trustedAppItemsSummary.macos",{defaultMessage:"Mac"}),total:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.fleetCustomExtension.trustedAppItemsSummary.total",{defaultMessage:"Total"})},CSS_BOLD={fontWeight:"bold"},TrustedAppItemsSummary=Object(external_kbnSharedDeps_React_.memo)(()=>{const{services:{http:http}}=Object(kibanaReact_public_.useKibana)(),[stats,setStats]=Object(external_kbnSharedDeps_React_.useState)(),[trustedAppsApi]=Object(external_kbnSharedDeps_React_.useState)(()=>new service.a(http));return Object(external_kbnSharedDeps_React_.useEffect)(()=>{trustedAppsApi.getTrustedAppsSummary().then(response=>{setStats(response)})},[trustedAppsApi]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{responsive:!1},SUMMARY_KEYS.map(stat=>{var _stats$stat;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(SummaryStat,{value:null!==(_stats$stat=null==stats?void 0:stats[stat])&&void 0!==_stats$stat?_stats$stat:0,color:"total"===stat?"primary":"default",key:stat},SUMMARY_LABELS[stat]))}))});TrustedAppItemsSummary.displayName="TrustedAppItemsSummary";const SummaryStat=Object(external_kbnSharedDeps_React_.memo)(({children:children,value:value,color:color,...commonProps})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{className:"eui-displayInlineBlock",size:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{responsive:!1,justifyContent:"center",direction:"row",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,style:"primary"===color?CSS_BOLD:void 0},children),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBadge,{color:color},value)))));SummaryStat.displayName="SummaryState";const FleetTrustedAppsCard=Object(external_kbnSharedDeps_React_.memo)(({pkgkey:pkgkey})=>{const{services:{application:{getUrlForApp:getUrlForApp}}}=Object(kibanaReact_public_.useKibana)(),trustedAppsListUrlPath=Object(routing.f)(),trustedAppRouteState=Object(external_kbnSharedDeps_React_.useMemo)(()=>{const fleetPackageCustomUrlPath="#"+public_.pagePathGetters.integration_details_custom({pkgkey:pkgkey});return{backButtonLabel:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.securitySolution.endpoint.fleetCustomExtension.backButtonLabel",{defaultMessage:"Back to Endpoint Integration"}),onBackButtonNavigateTo:[common_.PLUGIN_ID,{path:fleetPackageCustomUrlPath}],backButtonUrl:getUrlForApp(common_.PLUGIN_ID,{path:fleetPackageCustomUrlPath})}},[getUrlForApp,pkgkey]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPanel,{paddingSize:"l"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"baseline"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement("h4",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.endpoint.fleetCustomExtension.trustedAppsLabel",defaultMessage:"Trusted Applications"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(TrustedAppItemsSummary,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement("span",null,external_kbnSharedDeps_React_default.a.createElement(LinkWithIcon,{appId:constants.b,href:getUrlForApp(constants.b,{path:trustedAppsListUrlPath}),appPath:trustedAppsListUrlPath,appState:trustedAppRouteState,"data-test-subj":"linkToTrustedApps"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.securitySolution.endpoint.fleetCustomExtension.manageTrustedAppLinkLabel",defaultMessage:"Manage trusted applications"}))))))});FleetTrustedAppsCard.displayName="FleetTrustedAppsCard";const EndpointPackageCustomExtension=Object(external_kbnSharedDeps_React_.memo)(props=>external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":"fleetEndpointPackageCustomContent"},external_kbnSharedDeps_React_default.a.createElement(FleetTrustedAppsCard,props)));EndpointPackageCustomExtension.displayName="EndpointPackageCustomExtension"},215:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return useNavigateToAppEventHandler}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(6),_lib_kibana__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(109);const useNavigateToAppEventHandler=(appId,options)=>{const{services:services}=Object(_lib_kibana__WEBPACK_IMPORTED_MODULE_1__.h)(),{path:path,state:state,onClick:onClick}=options||{};return Object(react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(ev=>{try{onClick&&onClick(ev)}catch(error){throw ev.preventDefault(),error}ev.defaultPrevented||0===ev.button&&(ev.currentTarget instanceof HTMLAnchorElement&&""!==ev.currentTarget.target&&"_self"!==ev.currentTarget.target||ev.metaKey||ev.altKey||ev.ctrlKey||ev.shiftKey||(ev.preventDefault(),services.application.navigateToApp(appId,{path:path,state:state})))},[appId,onClick,path,services.application,state])}},253:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return LinkToApp}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(6),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),_elastic_eui__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(74),_hooks_endpoint_use_navigate_to_app_event_handler__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(215);function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const LinkToApp=Object(react__WEBPACK_IMPORTED_MODULE_0__.memo)(({appId:appId,appPath:path,appState:state,onClick:onClick,asButton:asButton,children:children,...otherProps})=>{const handleOnClick=Object(_hooks_endpoint_use_navigate_to_app_event_handler__WEBPACK_IMPORTED_MODULE_2__.a)(appId,{path:path,state:state,onClick:onClick});return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0___default.a.Fragment,null,asButton&&!0===asButton?react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__.EuiButton,_extends({},otherProps,{onClick:handleOnClick}),children):react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__.EuiLink,_extends({},otherProps,{onClick:handleOnClick}),children))})},320:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"c",(function(){return sendGetEndpointSpecificPackagePolicies})),__webpack_require__.d(__webpack_exports__,"f",(function(){return sendGetPackagePolicy})),__webpack_require__.d(__webpack_exports__,"a",(function(){return sendGetAgentPolicyList})),__webpack_require__.d(__webpack_exports__,"g",(function(){return sendPutPackagePolicy})),__webpack_require__.d(__webpack_exports__,"d",(function(){return sendGetFleetAgentStatusForPolicy})),__webpack_require__.d(__webpack_exports__,"e",(function(){return sendGetFleetAgentsWithEndpoint})),__webpack_require__.d(__webpack_exports__,"b",(function(){return sendGetEndpointSecurityPackage}));var _fleet_common__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(91);const sendGetEndpointSpecificPackagePolicies=(http,options={})=>{var _options$query;return http.get("/api/fleet/package_policies",{...options,query:{...options.query,kuery:`${null!=options&&null!==(_options$query=options.query)&&void 0!==_options$query&&_options$query.kuery?options.query.kuery+" and ":""}${_fleet_common__WEBPACK_IMPORTED_MODULE_0__.PACKAGE_POLICY_SAVED_OBJECT_TYPE}.package.name: endpoint`}})},sendGetPackagePolicy=(http,packagePolicyId,options)=>http.get("/api/fleet/package_policies/"+packagePolicyId,options),sendGetAgentPolicyList=(http,options)=>http.get("/api/fleet/agent_policies",options),sendPutPackagePolicy=(http,packagePolicyId,packagePolicy,options={})=>http.put("/api/fleet/package_policies/"+packagePolicyId,{...options,body:JSON.stringify(packagePolicy)}),sendGetFleetAgentStatusForPolicy=(http,policyId,options={})=>http.get("/api/fleet/agent-status",{...options,query:{policyId:policyId}}),sendGetFleetAgentsWithEndpoint=(http,options={})=>http.get("/api/fleet/agents",{...options,query:{page:1,perPage:1,kuery:'packages : "endpoint"'}}),sendGetEndpointSecurityPackage=async http=>{const endpointPackageInfo=(await http.get("/api/fleet/epm/packages",{query:{category:"security"}})).response.find(epmPackage=>"endpoint"===epmPackage.name);if(!endpointPackageInfo)throw new Error("Endpoint package was not found.");return endpointPackageInfo}},388:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"g",(function(){return metadataCurrentIndexPattern})),__webpack_require__.d(__webpack_exports__,"c",(function(){return TRUSTED_APPS_GET_API})),__webpack_require__.d(__webpack_exports__,"d",(function(){return TRUSTED_APPS_LIST_API})),__webpack_require__.d(__webpack_exports__,"a",(function(){return TRUSTED_APPS_CREATE_API})),__webpack_require__.d(__webpack_exports__,"f",(function(){return TRUSTED_APPS_UPDATE_API})),__webpack_require__.d(__webpack_exports__,"b",(function(){return TRUSTED_APPS_DELETE_API})),__webpack_require__.d(__webpack_exports__,"e",(function(){return TRUSTED_APPS_SUMMARY_API}));const metadataCurrentIndexPattern="metrics-endpoint.metadata_current_*",TRUSTED_APPS_GET_API="/api/endpoint/trusted_apps/{id}",TRUSTED_APPS_LIST_API="/api/endpoint/trusted_apps",TRUSTED_APPS_CREATE_API="/api/endpoint/trusted_apps",TRUSTED_APPS_UPDATE_API="/api/endpoint/trusted_apps/{id}",TRUSTED_APPS_DELETE_API="/api/endpoint/trusted_apps/{id}",TRUSTED_APPS_SUMMARY_API="/api/endpoint/trusted_apps/summary"},502:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return service_TrustedAppsHttpService}));var constants=__webpack_require__(388);const resolvePathVariables=(path,variables)=>Object.keys(variables).reduce((acc,paramName)=>acc.replace(new RegExp(`{${paramName}}`,"g"),String(variables[paramName])),path);var ingest=__webpack_require__(320);class service_TrustedAppsHttpService{constructor(http){this.http=http}async getTrustedApp(params){return this.http.get(resolvePathVariables(constants.c,params))}async getTrustedAppsList(request){return this.http.get(constants.d,{query:request})}async deleteTrustedApp(request){return this.http.delete(resolvePathVariables(constants.b,request))}async createTrustedApp(request){return this.http.post(constants.a,{body:JSON.stringify(request)})}async updateTrustedApp(params,updatedTrustedApp){return this.http.put(resolvePathVariables(constants.f,params),{body:JSON.stringify(updatedTrustedApp)})}async getTrustedAppsSummary(){return this.http.get(constants.e)}getPolicyList(options){return Object(ingest.c)(this.http,options)}}}}]);