/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */!function(modules){function webpackJsonpCallback(data){for(var moduleId,chunkId,chunkIds=data[0],moreModules=data[1],i=0,resolves=[];i<chunkIds.length;i++)chunkId=chunkIds[i],Object.prototype.hasOwnProperty.call(installedChunks,chunkId)&&installedChunks[chunkId]&&resolves.push(installedChunks[chunkId][0]),installedChunks[chunkId]=0;for(moduleId in moreModules)Object.prototype.hasOwnProperty.call(moreModules,moduleId)&&(modules[moduleId]=moreModules[moduleId]);for(parentJsonpFunction&&parentJsonpFunction(data);resolves.length;)resolves.shift()()}var installedModules={},installedChunks={0:0};function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}__webpack_require__.e=function(chunkId){var promises=[],installedChunkData=installedChunks[chunkId];if(0!==installedChunkData)if(installedChunkData)promises.push(installedChunkData[2]);else{var promise=new Promise((function(resolve,reject){installedChunkData=installedChunks[chunkId]=[resolve,reject]}));promises.push(installedChunkData[2]=promise);var onScriptComplete,script=document.createElement("script");script.charset="utf-8",script.timeout=120,__webpack_require__.nc&&script.setAttribute("nonce",__webpack_require__.nc),script.src=function(chunkId){return __webpack_require__.p+"savedObjectsTagging.chunk."+chunkId+".js"}(chunkId);var error=new Error;onScriptComplete=function(event){script.onerror=script.onload=null,clearTimeout(timeout);var chunk=installedChunks[chunkId];if(0!==chunk){if(chunk){var errorType=event&&("load"===event.type?"missing":event.type),realSrc=event&&event.target&&event.target.src;error.message="Loading chunk "+chunkId+" failed.\n("+errorType+": "+realSrc+")",error.name="ChunkLoadError",error.type=errorType,error.request=realSrc,chunk[1](error)}installedChunks[chunkId]=void 0}};var timeout=setTimeout((function(){onScriptComplete({type:"timeout",target:script})}),12e4);script.onerror=script.onload=onScriptComplete,document.head.appendChild(script)}return Promise.all(promises)},__webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{enumerable:!0,get:getter})},__webpack_require__.r=function(exports){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(exports,"__esModule",{value:!0})},__webpack_require__.t=function(value,mode){if(1&mode&&(value=__webpack_require__(value)),8&mode)return value;if(4&mode&&"object"==typeof value&&value&&value.__esModule)return value;var ns=Object.create(null);if(__webpack_require__.r(ns),Object.defineProperty(ns,"default",{enumerable:!0,value:value}),2&mode&&"string"!=typeof value)for(var key in value)__webpack_require__.d(ns,key,function(key){return value[key]}.bind(null,key));return ns},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function(){return module.default}:function(){return module};return __webpack_require__.d(getter,"a",getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p="",__webpack_require__.oe=function(err){throw console.error(err),err};var jsonpArray=window.savedObjectsTagging_bundle_jsonpfunction=window.savedObjectsTagging_bundle_jsonpfunction||[],oldJsonpFunction=jsonpArray.push.bind(jsonpArray);jsonpArray.push=webpackJsonpCallback,jsonpArray=jsonpArray.slice();for(var i=0;i<jsonpArray.length;i++)webpackJsonpCallback(jsonpArray[i]);var parentJsonpFunction=oldJsonpFunction;__webpack_require__(__webpack_require__.s=22)}([function(module,exports){module.exports=__kbnSharedDeps__.React},function(module,exports){module.exports=__kbnSharedDeps__.ElasticEui},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"h",(function(){return replaceTagReferences})),__webpack_require__.d(__webpack_exports__,"c",(function(){return getObjectTags})),__webpack_require__.d(__webpack_exports__,"f",(function(){return getTagsFromReferences})),__webpack_require__.d(__webpack_exports__,"b",(function(){return convertTagNameToId})),__webpack_require__.d(__webpack_exports__,"a",(function(){return byNameTagSorter})),__webpack_require__.d(__webpack_exports__,"d",(function(){return getTag})),__webpack_require__.d(__webpack_exports__,"g",(function(){return testSubjFriendly})),__webpack_require__.d(__webpack_exports__,"e",(function(){return getTagIdsFromReferences}));var common=__webpack_require__(9),constants=(__webpack_require__(13),__webpack_require__(4));const tagIdToReference=tagId=>({type:constants.c,id:tagId,name:"tag-ref-"+tagId}),replaceTagReferences=(references,newTagIds)=>[...references.filter(({type:type})=>type!==constants.c),...newTagIds.map(tagIdToReference)],getObjectTags=(object,allTags)=>getTagsFromReferences(object.references,allTags),getTagsFromReferences=(references,allTags)=>{const tagReferences=references.filter(ref=>ref.type===common.e),foundTags=[],missingRefs=[];return tagReferences.forEach(ref=>{const found=allTags.find(tag=>tag.id===ref.id);found?foundTags.push(found):missingRefs.push(ref)}),{tags:foundTags,missingRefs:missingRefs}},convertTagNameToId=(tagName,allTags)=>{const found=allTags.find(tag=>tag.name===tagName);return null==found?void 0:found.id},byNameTagSorter=(tagA,tagB)=>tagA.name.localeCompare(tagB.name),getTag=(tagId,allTags)=>allTags.find(({id:id})=>id===tagId),testSubjFriendly=name=>name.replace(" ","_"),getTagIdsFromReferences=references=>references.filter(ref=>ref.type===common.e).map(({id:id})=>id)},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return TagBadge})),__webpack_require__.d(__webpack_exports__,"b",(function(){return TagList})),__webpack_require__.d(__webpack_exports__,"d",(function(){return TagSelector})),__webpack_require__.d(__webpack_exports__,"c",(function(){return TagSearchBarOption}));var external_kbnSharedDeps_React_=__webpack_require__(0),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),external_kbnSharedDeps_ElasticEui_=__webpack_require__(1);const TagBadge=({tag:tag})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBadge,{color:tag.color,title:tag.description},tag.name),TagList=({tags:tags})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBadgeGroup,null,tags.map(tag=>external_kbnSharedDeps_React_default.a.createElement(TagBadge,{key:tag.name,tag:tag})));var external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(11),utils=__webpack_require__(2);function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const createOptionValue={type:"__create_option__"};function isTagOption(option){const value=option.value;return void 0!==value.name&&void 0!==value.color&&void 0!==value.id}function isCreateOption(option){return"__create_option__"===option.value.type}const renderOption=(option,searchValue,contentClassName)=>isCreateOption(option)?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{"data-test-subj":"tagSelectorOption-action__create",gutterSize:"xs",alignItems:"center",responsive:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{type:"tag"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement("span",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.savedObjectsTagging.components.tagSelector.createTagOptionLabel",defaultMessage:"Create tag"})))):isTagOption(option)?((option,searchValue,contentClassName)=>{var _option$value;const{name:name,color:color}=null!==(_option$value=option.value)&&void 0!==_option$value?_option$value:{name:""};return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHealth,{color:color,"data-test-subj":"tagSelectorOption-"+Object(utils.g)(name)},external_kbnSharedDeps_React_default.a.createElement("span",{className:contentClassName},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHighlight,{search:searchValue},name)))})(option,searchValue,contentClassName):void 0,TagSelector=({tags:tags,selected:selected,onTagsSelected:onTagsSelected,allowCreate:allowCreate,openCreateModal:openCreateModal,...otherProps})=>{const[currentSearch,setCurrentSearch]=Object(external_kbnSharedDeps_React_.useState)(""),createTagOption=Object(external_kbnSharedDeps_React_.useMemo)(()=>({label:currentSearch+" ",color:"#FFFFFF",value:createOptionValue}),[currentSearch]),options=Object(external_kbnSharedDeps_React_.useMemo)(()=>[...tags.map(tag=>({label:tag.name,color:tag.color,value:tag})),...allowCreate?[createTagOption]:[]],[allowCreate,tags,createTagOption]),selectedOptions=Object(external_kbnSharedDeps_React_.useMemo)(()=>options.filter(option=>isTagOption(option)&&selected.includes(option.value.id)),[selected,options]),onChange=Object(external_kbnSharedDeps_React_.useCallback)(newSelectedOptions=>{const selectedIds=newSelectedOptions.filter(isTagOption).map(option=>option.value.id);onTagsSelected(selectedIds),newSelectedOptions.find(isCreateOption)&&openCreateModal({defaultValues:{name:currentSearch},onCreate:tag=>{onTagsSelected([...selected,tag.id])}})},[selected,onTagsSelected,openCreateModal,currentSearch]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiComboBox,_extends({placeholder:"",options:options,selectedOptions:selectedOptions,onSearchChange:setCurrentSearch,onChange:onChange,renderOption:renderOption},otherProps))},TagSearchBarOption=({tag:tag})=>{const{name:name,color:color}=tag;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHealth,{color:color,"data-test-subj":"tag-searchbar-option-"+Object(utils.g)(name)},external_kbnSharedDeps_React_default.a.createElement("span",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,name)))}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return tagFeatureId})),__webpack_require__.d(__webpack_exports__,"c",(function(){return tagSavedObjectTypeName})),__webpack_require__.d(__webpack_exports__,"b",(function(){return tagManagementSectionId}));const tagFeatureId="savedObjectsTagging",tagSavedObjectTypeName="tag",tagManagementSectionId="tags"},function(module,exports){module.exports=__kbnSharedDeps__.KbnI18n},function(module,__webpack_exports__,__webpack_require__){"use strict";function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}__webpack_require__.d(__webpack_exports__,"b",(function(){return TagsClient})),__webpack_require__.d(__webpack_exports__,"a",(function(){return tags_cache_TagsCache})),__webpack_require__.d(__webpack_exports__,"c",(function(){return isServerValidationError}));const trapErrors=fn=>{try{fn()}catch(e){}};class TagsClient{constructor({http:http,changeListener:changeListener}){_defineProperty(this,"http",void 0),_defineProperty(this,"changeListener",void 0),this.http=http,this.changeListener=changeListener}async create(attributes){const{tag:tag}=await this.http.post("/api/saved_objects_tagging/tags/create",{body:JSON.stringify(attributes)});return trapErrors(()=>{this.changeListener&&this.changeListener.onCreate(tag)}),tag}async update(id,attributes){const{tag:tag}=await this.http.post("/api/saved_objects_tagging/tags/"+id,{body:JSON.stringify(attributes)});return trapErrors(()=>{if(this.changeListener){const{id:newId,...newAttributes}=tag;this.changeListener.onUpdate(newId,newAttributes)}}),tag}async get(id){const{tag:tag}=await this.http.get("/api/saved_objects_tagging/tags/"+id);return tag}async getAll({asSystemRequest:asSystemRequest}={}){const fetchOptions={asSystemRequest:asSystemRequest},{tags:tags}=await this.http.get("/api/saved_objects_tagging/tags",fetchOptions);return trapErrors(()=>{this.changeListener&&this.changeListener.onGetAll(tags)}),tags}async delete(id){await this.http.delete("/api/saved_objects_tagging/tags/"+id),trapErrors(()=>{this.changeListener&&this.changeListener.onDelete(id)})}async find({page:page,perPage:perPage,search:search}){return await this.http.get("/internal/saved_objects_tagging/tags/_find",{query:{page:page,perPage:perPage,search:search}})}async bulkDelete(tagIds){await this.http.post("/internal/saved_objects_tagging/tags/_bulk_delete",{body:JSON.stringify({ids:tagIds})}),trapErrors(()=>{this.changeListener&&tagIds.forEach(tagId=>{this.changeListener.onDelete(tagId)})})}}var external_kbnSharedDeps_Rxjs_=__webpack_require__(12),external_kbnSharedDeps_RxjsOperators_=__webpack_require__(16);__webpack_require__(18);function tags_cache_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class tags_cache_TagsCache{constructor({refreshHandler:refreshHandler,refreshInterval:refreshInterval}){tags_cache_defineProperty(this,"refreshInterval",void 0),tags_cache_defineProperty(this,"refreshHandler",void 0),tags_cache_defineProperty(this,"intervalId",void 0),tags_cache_defineProperty(this,"internal$",void 0),tags_cache_defineProperty(this,"public$",void 0),tags_cache_defineProperty(this,"stop$",void 0),this.refreshHandler=refreshHandler,this.refreshInterval=refreshInterval,this.stop$=new external_kbnSharedDeps_Rxjs_.Subject,this.internal$=new external_kbnSharedDeps_Rxjs_.BehaviorSubject([]),this.public$=this.internal$.pipe(Object(external_kbnSharedDeps_RxjsOperators_.takeUntil)(this.stop$))}async initialize(){await this.refresh(),this.refreshInterval&&(this.intervalId=window.setInterval(()=>{this.refresh()},this.refreshInterval.asMilliseconds()))}async refresh(){try{const tags=await this.refreshHandler();this.internal$.next(tags)}catch(e){}}getState(){return this.internal$.getValue()}getState$(){return this.public$}onDelete(id){this.internal$.next(this.internal$.value.filter(tag=>tag.id!==id))}onCreate(tag){this.internal$.next([...this.internal$.value.filter(f=>f.id!==tag.id),tag])}onUpdate(id,attributes){this.internal$.next(this.internal$.value.map(tag=>tag.id===id?{...tag,...attributes}:tag))}onGetAll(tags){this.internal$.next(tags)}stop(){this.intervalId&&window.clearInterval(this.intervalId),this.stop$.next()}}const isServerValidationError=error=>{var _error$attributes;return error&&400===error.statusCode&&"boolean"==typeof(null===(_error$attributes=error.attributes)||void 0===_error$attributes?void 0:_error$attributes.valid)&&"object"==typeof error.attributes.errors}},function(module,exports){},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var tslib_1=__webpack_require__(21),react_1=__webpack_require__(0),useIsomorphicLayoutEffect_1=tslib_1.__importDefault(__webpack_require__(24));exports.default=function(observable$,initialValue){var _a=react_1.useState(initialValue),value=_a[0],update=_a[1];return useIsomorphicLayoutEffect_1.default((function(){var s=observable$.subscribe(update);return function(){return s.unsubscribe()}}),[observable$]),value}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return capabilities.a})),__webpack_require__.d(__webpack_exports__,"e",(function(){return constants.c})),__webpack_require__.d(__webpack_exports__,"a",(function(){return types.Tag})),__webpack_require__.d(__webpack_exports__,"f",(function(){return validateTagColor})),__webpack_require__.d(__webpack_exports__,"h",(function(){return validateTagName})),__webpack_require__.d(__webpack_exports__,"g",(function(){return validateTagDescription})),__webpack_require__.d(__webpack_exports__,"d",(function(){return tagNameMaxLength})),__webpack_require__.d(__webpack_exports__,"c",(function(){return tagDescriptionMaxLength}));var capabilities=__webpack_require__(10),constants=__webpack_require__(4),types=__webpack_require__(7),external_kbnSharedDeps_KbnI18n_=__webpack_require__(5);const tagNameMaxLength=50,tagDescriptionMaxLength=100,hexColorRegexp=/^#[0-9A-F]{6}$/i,validateTagColor=color=>{if(!(color=>hexColorRegexp.test(color))(color))return external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.savedObjectsTagging.validation.color.errorInvalid",{defaultMessage:"Tag color must be a valid hex color"})},validateTagName=name=>name.length<2?external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.savedObjectsTagging.validation.name.errorTooShort",{defaultMessage:"Tag name must be at least {length} characters",values:{length:2}}):name.length>tagNameMaxLength?external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.savedObjectsTagging.validation.name.errorTooLong",{defaultMessage:"Tag name may not exceed {length} characters",values:{length:tagNameMaxLength}}):void 0,validateTagDescription=description=>{if(description.length>tagDescriptionMaxLength)return external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.savedObjectsTagging.validation.description.errorTooLong",{defaultMessage:"Tag description may not exceed {length} characters",values:{length:tagDescriptionMaxLength}})}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return getTagsCapabilities}));var _constants__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(4);const getTagsCapabilities=capabilities=>{var _ref,_ref2,_ref3,_ref4,_ref5,_ref6,_capabilities$savedOb;const rawTagCapabilities=capabilities[_constants__WEBPACK_IMPORTED_MODULE_0__.a];return{view:null!==(_ref=null==rawTagCapabilities?void 0:rawTagCapabilities.view)&&void 0!==_ref&&_ref,create:null!==(_ref2=null==rawTagCapabilities?void 0:rawTagCapabilities.create)&&void 0!==_ref2&&_ref2,edit:null!==(_ref3=null==rawTagCapabilities?void 0:rawTagCapabilities.edit)&&void 0!==_ref3&&_ref3,delete:null!==(_ref4=null==rawTagCapabilities?void 0:rawTagCapabilities.delete)&&void 0!==_ref4&&_ref4,assign:null!==(_ref5=null==rawTagCapabilities?void 0:rawTagCapabilities.assign)&&void 0!==_ref5&&_ref5,viewConnections:null!==(_ref6=null===(_capabilities$savedOb=capabilities.savedObjectsManagement)||void 0===_capabilities$savedOb?void 0:_capabilities$savedOb.read)&&void 0!==_ref6&&_ref6}}},function(module,exports){module.exports=__kbnSharedDeps__.KbnI18nReact},function(module,exports){module.exports=__kbnSharedDeps__.Rxjs},function(module,exports){module.exports=__kbnSharedDeps__.Lodash},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/kibanaReact/public");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,__webpack_exports__,__webpack_require__){"use strict";var _base__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(3);__webpack_require__.d(__webpack_exports__,"a",(function(){return _base__WEBPACK_IMPORTED_MODULE_0__.a})),__webpack_require__.d(__webpack_exports__,"b",(function(){return _base__WEBPACK_IMPORTED_MODULE_0__.c}))},function(module,exports){module.exports=__kbnSharedDeps__.RxjsOperators},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return getCreateModalOpener})),__webpack_require__.d(__webpack_exports__,"b",(function(){return getEditModalOpener}));var external_kbnSharedDeps_React_=__webpack_require__(0),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),external_kbnSharedDeps_ElasticEui_=__webpack_require__(1),public_=__webpack_require__(14);const LoadingIndicator=()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDelayRender,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingSpinner,null)),LazyCreateTagModal=external_kbnSharedDeps_React_default.a.lazy(()=>__webpack_require__.e(3).then(__webpack_require__.bind(null,52)).then(({CreateTagModal:CreateTagModal})=>({default:CreateTagModal}))),LazyEditTagModal=external_kbnSharedDeps_React_default.a.lazy(()=>__webpack_require__.e(4).then(__webpack_require__.bind(null,53)).then(({EditTagModal:EditTagModal})=>({default:EditTagModal}))),getCreateModalOpener=({overlays:overlays,tagClient:tagClient})=>async({onCreate:onCreate,defaultValues:defaultValues})=>{const modal=overlays.openModal(Object(public_.toMountPoint)(external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Suspense,{fallback:external_kbnSharedDeps_React_default.a.createElement(LoadingIndicator,null)},external_kbnSharedDeps_React_default.a.createElement(LazyCreateTagModal,{defaultValues:defaultValues,onClose:()=>{modal.close()},onSave:tag=>{modal.close(),onCreate(tag)},tagClient:tagClient}))));return modal},getEditModalOpener=({overlays:overlays,tagClient:tagClient})=>async({tagId:tagId,onUpdate:onUpdate})=>{const tag=await tagClient.get(tagId),modal=overlays.openModal(Object(public_.toMountPoint)(external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Suspense,{fallback:external_kbnSharedDeps_React_default.a.createElement(LoadingIndicator,null)},external_kbnSharedDeps_React_default.a.createElement(LazyEditTagModal,{tag:tag,onClose:()=>{modal.close()},onSave:saved=>{modal.close(),onUpdate(saved)},tagClient:tagClient}))));return modal}},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/savedObjectsTaggingOss/public");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,exports){},function(module,exports){module.exports=__kbnSharedDeps__.Moment},function(module,exports){module.exports=__kbnSharedDeps__.TsLib},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__(23);__kbnBundles__.define("plugin/savedObjectsTagging/public",__webpack_require__,25)},function(module,exports,__webpack_require__){__webpack_require__.p=window.__kbnPublicPath__.savedObjectsTagging},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var react_1=__webpack_require__(0),useIsomorphicLayoutEffect="undefined"!=typeof window?react_1.useLayoutEffect:react_1.useEffect;exports.default=useIsomorphicLayoutEffect},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"SavedObjectTaggingPluginStart",(function(){return types.SavedObjectTaggingPluginStart})),__webpack_require__.d(__webpack_exports__,"Tag",(function(){return common.a})),__webpack_require__.d(__webpack_exports__,"plugin",(function(){return public_plugin}));var external_kbnSharedDeps_KbnI18n_=__webpack_require__(5),constants=__webpack_require__(4),common_capabilities=__webpack_require__(10),services_tags=__webpack_require__(6);class TagAssignmentService{constructor({http:http}){var obj,key,value;value=void 0,(key="http")in(obj=this)?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,this.http=http}async findAssignableObjects({search:search,types:types,maxResults:maxResults}){const{objects:objects}=await this.http.get("/internal/saved_objects_tagging/assignments/_find_assignable_objects",{query:{search:search,types:types,max_results:maxResults}});return objects}async updateTagAssignments({tags:tags,assign:assign,unassign:unassign}){await this.http.post("/api/saved_objects_tagging/assignments/update_by_tags",{body:JSON.stringify({tags:tags,assign:assign,unassign:unassign})})}async getAssignableTypes(){const{types:types}=await this.http.get("/internal/saved_objects_tagging/assignments/_assignable_types");return types}}var utils=__webpack_require__(2),external_kbnSharedDeps_React_=__webpack_require__(0),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),useObservable=__webpack_require__(8),useObservable_default=__webpack_require__.n(useObservable),base=__webpack_require__(3);function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const SavedObjectTagList=({object:object,tags:allTags})=>{const objectTags=Object(external_kbnSharedDeps_React_.useMemo)(()=>{const{tags:tags}=Object(utils.c)(object,allTags);return tags.sort(utils.a),tags},[object,allTags]);return external_kbnSharedDeps_React_default.a.createElement(base.b,{tags:objectTags})},getConnectedTagListComponent=({cache:cache})=>props=>{const tags=useObservable_default()(cache.getState$(),cache.getState());return external_kbnSharedDeps_React_default.a.createElement(SavedObjectTagList,_extends({},props,{tags:tags}))};function tag_selector_extends(){return(tag_selector_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const getConnectedTagSelectorComponent=({cache:cache,capabilities:capabilities,openCreateModal:openCreateModal})=>props=>{const tags=useObservable_default()(cache.getState$(),cache.getState());return external_kbnSharedDeps_React_default.a.createElement(base.d,tag_selector_extends({},props,{tags:tags,allowCreate:capabilities.create,openCreateModal:openCreateModal}))};var external_kbnSharedDeps_ElasticEui_=__webpack_require__(1),external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(11);const getConnectedSavedObjectModalTagSelectorComponent=({cache:cache,capabilities:capabilities,openCreateModal:openCreateModal})=>({initialSelection:initialSelection,onTagsSelected:notifySelectionChange})=>{const tags=useObservable_default()(cache.getState$(),cache.getState()),[selected,setSelected]=Object(external_kbnSharedDeps_React_.useState)(initialSelection),setSelectedInternal=Object(external_kbnSharedDeps_React_.useCallback)(newSelection=>{setSelected(newSelection),notifySelectionChange(newSelection)},[notifySelectionChange]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{fullWidth:!0,label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.savedObjectsTagging.uiApi.saveModal.label",defaultMessage:"Tags"})},external_kbnSharedDeps_React_default.a.createElement(base.d,{selected:selected,onTagsSelected:setSelectedInternal,tags:tags,"data-test-subj":"savedObjectTagSelector",allowCreate:capabilities.create,openCreateModal:openCreateModal}))};var edition_modal=__webpack_require__(17);const buildGetTableColumnDefinition=({components:components,cache:cache})=>()=>({field:"references",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.savedObjectsTagging.uiApi.table.columnTagsName",{defaultMessage:"Tags"}),description:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.savedObjectsTagging.uiApi.table.columnTagsDescription",{defaultMessage:"Tags associated with this saved object"}),sortable:object=>{const{tags:tags}=Object(utils.f)(object.references,cache.getState());return tags.sort(utils.a),tags.length?tags[0].name:void 0},render:(references,object)=>external_kbnSharedDeps_React_default.a.createElement(components.TagList,{object:object}),"data-test-subj":"listingTableRowTags"});var public_components=__webpack_require__(15);const buildGetSearchBarFilter=({cache:cache})=>({useName:useName=!0,tagField:tagField="tag"}={})=>({type:"field_value_selection",field:tagField,name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.savedObjectsTagging.uiApi.searchBar.filterButtonLabel",{defaultMessage:"Tags"}),multiSelect:"or",options:()=>Promise.resolve(cache.getState().sort(utils.a).map(tag=>({value:useName?tag.name:tag.id,name:tag.name,view:external_kbnSharedDeps_React_default.a.createElement(public_components.b,{tag:tag})})))}),buildParseSearchQuery=({cache:cache})=>(query,{tagField:tagField="tag",useName:useName=!0}={})=>{let parsed;try{parsed=external_kbnSharedDeps_ElasticEui_.Query.parse(query)}catch(e){return{searchTerm:query,tagReferences:[],valid:!1}}if(!query)return{searchTerm:"",tagReferences:[],valid:!0};let searchTerm="",tagReferences=[];if(parsed.ast.getTermClauses().length&&(searchTerm=parsed.ast.getTermClauses().map(clause=>clause.value).join(" ")),parsed.ast.getFieldClauses(tagField)){const selectedTags=parsed.ast.getFieldClauses(tagField)[0].value;useName?selectedTags.forEach(tagName=>{const found=cache.getState().find(tag=>tag.name===tagName);found&&tagReferences.push({type:"tag",id:found.id})}):tagReferences=selectedTags.map(tagId=>({type:"tag",id:tagId}))}return{searchTerm:searchTerm,tagReferences:tagReferences,valid:!0}},buildConvertNameToReference=({cache:cache})=>tagName=>{const tagId=Object(utils.b)(tagName,cache.getState());return tagId?{type:"tag",id:tagId}:void 0},hasTagDecoration=object=>"getTags"in object&&"setTags"in object,getUiApi=({cache:cache,capabilities:capabilities,client:client,overlays:overlays})=>{const components=(({capabilities:capabilities,cache:cache,overlays:overlays,tagClient:tagClient})=>{const openCreateModal=Object(edition_modal.a)({overlays:overlays,tagClient:tagClient});return{TagList:getConnectedTagListComponent({cache:cache}),TagSelector:getConnectedTagSelectorComponent({cache:cache,capabilities:capabilities,openCreateModal:openCreateModal}),SavedObjectSaveModalTagSelector:getConnectedSavedObjectModalTagSelectorComponent({cache:cache,capabilities:capabilities,openCreateModal:openCreateModal})}})({cache:cache,capabilities:capabilities,overlays:overlays,tagClient:client});return{components:components,getTableColumnDefinition:buildGetTableColumnDefinition({components:components,cache:cache}),getSearchBarFilter:buildGetSearchBarFilter({cache:cache}),parseSearchQuery:buildParseSearchQuery({cache:cache}),convertNameToReference:buildConvertNameToReference({cache:cache}),hasTagDecoration:hasTagDecoration,getTagIdsFromReferences:utils.e,getTagIdFromName:tagName=>Object(utils.b)(tagName,cache.getState()),updateTagsReferences:utils.h,getTag:tagId=>Object(utils.d)(tagId,cache.getState())}};var external_kbnSharedDeps_Moment_=__webpack_require__(20),external_kbnSharedDeps_Moment_default=__webpack_require__.n(external_kbnSharedDeps_Moment_);class config_SavedObjectsTaggingClientConfig{constructor(rawConfig){var obj,key,value;value=void 0,(key="cacheRefreshInterval")in(obj=this)?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,this.cacheRefreshInterval=external_kbnSharedDeps_Moment_default.a.duration(rawConfig.cache_refresh_interval)}}function plugin_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class plugin_SavedObjectTaggingPlugin{constructor(context){plugin_defineProperty(this,"tagClient",void 0),plugin_defineProperty(this,"tagCache",void 0),plugin_defineProperty(this,"assignmentService",void 0),plugin_defineProperty(this,"config",void 0),this.config=new config_SavedObjectsTaggingClientConfig(context.config.get())}setup(core,{management:management,savedObjectsTaggingOss:savedObjectsTaggingOss}){return management.sections.section.kibana.registerApp({id:constants.b,title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.savedObjectsTagging.management.sectionLabel",{defaultMessage:"Tags"}),order:1.5,mount:async mountParams=>{const{mountSection:mountSection}=await __webpack_require__.e(1).then(__webpack_require__.bind(null,54));return mountSection({tagClient:this.tagClient,tagCache:this.tagCache,assignmentService:this.assignmentService,core:core,mountParams:mountParams})}}),savedObjectsTaggingOss.registerTaggingApi(core.getStartServices().then(([_core,_deps,startContract])=>startContract)),{}}start({http:http,application:application,overlays:overlays}){return this.tagCache=new services_tags.a({refreshHandler:()=>this.tagClient.getAll({asSystemRequest:!0}),refreshInterval:this.config.cacheRefreshInterval}),this.tagClient=new services_tags.b({http:http,changeListener:this.tagCache}),this.assignmentService=new TagAssignmentService({http:http}),http.anonymousPaths.isAnonymous(window.location.pathname)||this.tagCache.initialize().catch(()=>{}),{client:this.tagClient,cache:this.tagCache,ui:getUiApi({cache:this.tagCache,client:this.tagClient,capabilities:Object(common_capabilities.a)(application.capabilities),overlays:overlays})}}stop(){this.tagCache&&this.tagCache.stop()}}var types=__webpack_require__(19),common=__webpack_require__(9);const public_plugin=initializerContext=>new plugin_SavedObjectTaggingPlugin(initializerContext)},function(module,exports){module.exports=__kbnSharedDeps__.ReactDom}]);