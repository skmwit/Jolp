/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.security_bundle_jsonpfunction=window.security_bundle_jsonpfunction||[]).push([[7],{101:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return FormFlyout}));var _elastic_eui__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__),_kbn_i18n_react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(4),_use_html_id__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(93);function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const FormFlyout=({title:title,submitButtonText:submitButtonText,submitButtonColor:submitButtonColor,onCancel:onCancel,onSubmit:onSubmit,isLoading:isLoading,isDisabled:isDisabled,children:children,initialFocus:initialFocus,...rest})=>{Object(react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{initialFocus&&initialFocus.current&&initialFocus.current.focus()},[initialFocus]);const titleId=Object(_use_html_id__WEBPACK_IMPORTED_MODULE_3__.a)("formFlyout","title");return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_0__.EuiPortal,null,react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_0__.EuiFlyout,_extends({onClose:onCancel,"aria-labelledby":titleId},rest),react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_0__.EuiFlyoutHeader,{hasBorder:!0},react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_0__.EuiTitle,{size:"m"},react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("h2",{id:titleId},title))),react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_0__.EuiFlyoutBody,null,children),react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_0__.EuiFlyoutFooter,null,react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_0__.EuiFlexGroup,{justifyContent:"spaceBetween"},react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_0__.EuiFlexItem,{grow:!1},react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_0__.EuiButtonEmpty,{"data-test-subj":"formFlyoutCancelButton",flush:"right",isDisabled:isLoading,onClick:onCancel},react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_kbn_i18n_react__WEBPACK_IMPORTED_MODULE_2__.FormattedMessage,{id:"xpack.security.formFlyout.cancelButton",defaultMessage:"Cancel"}))),react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_0__.EuiFlexItem,{grow:!1},react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_0__.EuiButton,{"data-test-subj":"formFlyoutSubmitButton",isLoading:isLoading,isDisabled:isDisabled,color:submitButtonColor,fill:!0,onClick:onSubmit},submitButtonText))))))}},102:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return useInitialFocus}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0);function useInitialFocus(deps=[]){const inputRef=Object(react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);return Object(react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>{inputRef.current&&inputRef.current.focus()},deps),inputRef}},103:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"c",(function(){return isUserReserved})),__webpack_require__.d(__webpack_exports__,"b",(function(){return isUserDeprecated})),__webpack_require__.d(__webpack_exports__,"a",(function(){return getExtendedUserDeprecationNotice}));var _kbn_i18n__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1);const isUserReserved=user=>{var _user$metadata$_reser,_user$metadata;return null!==(_user$metadata$_reser=null===(_user$metadata=user.metadata)||void 0===_user$metadata?void 0:_user$metadata._reserved)&&void 0!==_user$metadata$_reser&&_user$metadata$_reser},isUserDeprecated=user=>{var _user$metadata$_depre,_user$metadata2;return null!==(_user$metadata$_depre=null===(_user$metadata2=user.metadata)||void 0===_user$metadata2?void 0:_user$metadata2._deprecated)&&void 0!==_user$metadata$_depre&&_user$metadata$_depre},getExtendedUserDeprecationNotice=user=>{var _user$metadata$_depre2,_user$metadata3;const reason=null!==(_user$metadata$_depre2=null===(_user$metadata3=user.metadata)||void 0===_user$metadata3?void 0:_user$metadata3._deprecated_reason)&&void 0!==_user$metadata$_depre2?_user$metadata$_depre2:"";return _kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.security.management.users.extendedUserDeprecationNotice",{defaultMessage:"The {username} user is deprecated. {reason}",values:{username:user.username,reason:reason}})}},108:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return RoleComboBox}));var external_kbnSharedDeps_ElasticEui_=__webpack_require__(2),external_kbnSharedDeps_React_=__webpack_require__(0),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),external_kbnSharedDeps_KbnI18n_=__webpack_require__(1),external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(4),model=__webpack_require__(15);const RoleComboBox=props=>{var _groupedOptions$custo,_groupedOptions$user,_groupedOptions$admin,_groupedOptions$syste,_groupedOptions$depre;const roleNameToOption=roleName=>{var _ref,_ref2,_ref3,_ref4,_roleDefinition$metad;const roleDefinition=props.availableRoles.find(role=>role.name===roleName),isReserved=null!==(_ref=roleDefinition&&Object(model.j)(roleDefinition))&&void 0!==_ref&&_ref,isDeprecated=null!==(_ref2=roleDefinition&&Object(model.g)(roleDefinition))&&void 0!==_ref2&&_ref2,isSystem=null!==(_ref3=roleDefinition&&Object(model.k)(roleDefinition))&&void 0!==_ref3&&_ref3,isAdmin=null!==(_ref4=roleDefinition&&Object(model.f)(roleDefinition))&&void 0!==_ref4&&_ref4;return{color:isDeprecated?"warning":isReserved?"primary":void 0,"data-test-subj":"roleOption-"+roleName,label:roleName,value:{isReserved:isReserved,isDeprecated:isDeprecated,isSystem:isSystem,isAdmin:isAdmin,deprecatedReason:null==roleDefinition||null===(_roleDefinition$metad=roleDefinition.metadata)||void 0===_roleDefinition$metad?void 0:_roleDefinition$metad._deprecated_reason}}},options=props.availableRoles.map(role=>roleNameToOption(role.name)),selectedOptions=props.selectedRoleNames.map(roleNameToOption),groupedOptions=options.reduce((acc,option)=>{var _option$value,_option$value2,_option$value3,_option$value4;const type=null!==(_option$value=option.value)&&void 0!==_option$value&&_option$value.isDeprecated?"deprecated":null!==(_option$value2=option.value)&&void 0!==_option$value2&&_option$value2.isSystem?"system":null!==(_option$value3=option.value)&&void 0!==_option$value3&&_option$value3.isAdmin?"admin":null!==(_option$value4=option.value)&&void 0!==_option$value4&&_option$value4.isReserved?"user":"custom";return acc[type]||(acc[type]=[]),acc[type].push(option),acc},{});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiComboBox,{"data-test-subj":"rolesDropdown",id:props.id,placeholder:props.placeholder||external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.security.management.users.roleComboBox.placeholder",{defaultMessage:"Select roles"}),onChange:selectedItems=>{props.onChange(selectedItems.map(item=>item.label))},isLoading:props.isLoading,isDisabled:props.isDisabled,options:[{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.security.management.users.roleComboBox.customRoles",{defaultMessage:"Custom roles"}),options:null!==(_groupedOptions$custo=groupedOptions.custom)&&void 0!==_groupedOptions$custo?_groupedOptions$custo:[]},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.security.management.users.roleComboBox.userRoles",{defaultMessage:"User roles"}),options:null!==(_groupedOptions$user=groupedOptions.user)&&void 0!==_groupedOptions$user?_groupedOptions$user:[]},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.security.management.users.roleComboBox.AdminRoles",{defaultMessage:"Admin roles"}),options:null!==(_groupedOptions$admin=groupedOptions.admin)&&void 0!==_groupedOptions$admin?_groupedOptions$admin:[]},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.security.management.users.roleComboBox.systemRoles",{defaultMessage:"System roles"}),options:null!==(_groupedOptions$syste=groupedOptions.system)&&void 0!==_groupedOptions$syste?_groupedOptions$syste:[]},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.security.management.users.roleComboBox.deprecatedRoles",{defaultMessage:"Deprecated roles"}),options:null!==(_groupedOptions$depre=groupedOptions.deprecated)&&void 0!==_groupedOptions$depre?_groupedOptions$depre:[]}],selectedOptions:selectedOptions,renderOption:renderOption})};function renderOption(option){var _option$value5,_option$value6;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center",responsive:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,option.label),null!==(_option$value5=option.value)&&void 0!==_option$value5&&_option$value5.isDeprecated?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBadge,{color:option.color},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.security.management.users.roleComboBox.deprecatedBadge",defaultMessage:"deprecated"}))):null!==(_option$value6=option.value)&&void 0!==_option$value6&&_option$value6.isReserved?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBadge,{color:option.color},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.security.management.users.roleComboBox.reservedBadge",defaultMessage:"built in"}))):void 0)}},305:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"EditUserPage",(function(){return EditUserPage})),__webpack_require__.d(__webpack_exports__,"CreateUserPage",(function(){return CreateUserPage}));var external_kbnSharedDeps_ElasticEui_=__webpack_require__(2),external_kbnSharedDeps_React_=__webpack_require__(0),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),external_kbnSharedDeps_ReactRouterDom_=__webpack_require__(3),useAsyncFn=__webpack_require__(40),useAsyncFn_default=__webpack_require__.n(useAsyncFn),external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(4),public_=__webpack_require__(6),model=__webpack_require__(15),user_api_client=__webpack_require__(17),user_utils=__webpack_require__(103),external_kbnSharedDeps_KbnI18n_=__webpack_require__(1),form_flyout=__webpack_require__(101),use_current_user=__webpack_require__(19),use_form=__webpack_require__(94),use_initial_focus=__webpack_require__(102);function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const ChangePasswordFlyout=({username:username,defaultValues:defaultValues={current_password:"",password:"",confirm_password:""},onSuccess:onSuccess,onCancel:onCancel})=>{const{services:services}=Object(public_.useKibana)(),{value:currentUser,loading:isLoading}=Object(use_current_user.b)(),isCurrentUser=(null==currentUser?void 0:currentUser.username)===username,isSystemUser="kibana"===username||"kibana_system"===username,[form,eventHandlers]=Object(use_form.a)({onSubmit:async values=>{try{await new user_api_client.UserAPIClient(services.http).changePassword(username,values.password,values.current_password),services.notifications.toasts.addSuccess(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.security.management.users.changePasswordFlyout.successMessage",{defaultMessage:"Password changed for '{username}'.",values:{username:username}})),null==onSuccess||onSuccess()}catch(error){var _body,_body2;if("security_exception"!==(null===(_body=error.body)||void 0===_body?void 0:_body.message))throw services.notifications.toasts.addDanger({title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.security.management.users.changePasswordFlyout.errorMessage",{defaultMessage:"Could not change password"}),text:(null===(_body2=error.body)||void 0===_body2?void 0:_body2.message)||error.message}),error;form.setError("current_password",external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.security.management.users.changePasswordFlyout.currentPasswordInvalidError",{defaultMessage:"Invalid password."}))}},validate:async values=>{const errors={};return isCurrentUser&&(values.current_password||(errors.current_password=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.security.management.users.changePasswordFlyout.currentPasswordRequiredError",{defaultMessage:"Enter your current password."}))),values.password?values.password.length<6?errors.password=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.security.management.users.changePasswordFlyout.passwordInvalidError",{defaultMessage:"Password must be at least 6 characters."}):values.confirm_password?values.password!==values.confirm_password&&(errors.confirm_password=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.security.management.users.changePasswordFlyout.confirmPasswordInvalidError",{defaultMessage:"Passwords do not match."})):errors.confirm_password=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.security.management.users.changePasswordFlyout.confirmPasswordRequiredError",{defaultMessage:"Passwords do not match."}):errors.password=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.security.management.users.changePasswordFlyout.passwordRequiredError",{defaultMessage:"Enter a new password."}),errors},defaultValues:defaultValues}),firstFieldRef=Object(use_initial_focus.a)([isLoading]);return external_kbnSharedDeps_React_default.a.createElement(form_flyout.a,{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.security.management.users.changePasswordFlyout.title",{defaultMessage:"Change password"}),onCancel:onCancel,onSubmit:form.submit,submitButtonText:isSystemUser?external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.security.management.users.changePasswordFlyout.confirmSystemPasswordButton",{defaultMessage:"{isSubmitting, select, true{Changing password…} other{Change password}}",values:{isSubmitting:form.isSubmitting}}):external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.security.management.users.changePasswordFlyout.confirmButton",{defaultMessage:"{isSubmitting, select, true{Changing password…} other{Change password}}",values:{isSubmitting:form.isSubmitting}}),submitButtonColor:isSystemUser?"danger":void 0,isLoading:form.isSubmitting,isDisabled:isLoading||form.isSubmitted&&form.isInvalid,size:"s",ownFocus:!0},isLoading?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingContent,null):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiForm,_extends({component:"form",noValidate:!0},eventHandlers),isSystemUser?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.security.management.users.changePasswordFlyout.systemUserTitle",{defaultMessage:"This is extremely important!"}),color:"danger",iconType:"alert"},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.security.management.users.changePasswordFlyout.systemUserWarning",defaultMessage:"Changing this password will prevent Kibana from communicating with Elasticsearch."})),external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.security.management.users.changePasswordFlyout.systemUserDescription",defaultMessage:"Once changed, you must manually update your config file with the new password and restart Kibana."}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null)):void 0,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.security.management.users.changePasswordFlyout.userLabel",{defaultMessage:"User"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{type:"user"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,username),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"xs"})))),isCurrentUser?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.security.management.users.changePasswordFlyout.currentPasswordLabel",{defaultMessage:"Current password"}),error:form.errors.current_password,isInvalid:form.touched.current_password&&!!form.errors.current_password},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldPassword,{name:"current_password",type:"dual",defaultValue:form.values.current_password,isInvalid:form.touched.current_password&&!!form.errors.current_password,autoComplete:"current-password",inputRef:firstFieldRef})):null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.security.management.users.changePasswordFlyout.passwordLabel",{defaultMessage:"New password"}),helpText:"Password must be at least 6 characters.",error:form.errors.password,isInvalid:form.touched.password&&!!form.errors.password},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldPassword,{name:"password",type:"dual",defaultValue:form.values.password,isInvalid:form.touched.password&&!!form.errors.password,autoComplete:"new-password",inputRef:isCurrentUser?void 0:firstFieldRef})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.security.management.users.changePasswordFlyout.confirmPasswordLabel",{defaultMessage:"Confirm password"}),error:form.errors.confirm_password,isInvalid:form.touched.confirm_password&&!!form.errors.confirm_password},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldPassword,{name:"confirm_password",type:"dual",defaultValue:form.values.confirm_password,isInvalid:form.touched.confirm_password&&!!form.errors.confirm_password,autoComplete:"new-password"})),external_kbnSharedDeps_React_default.a.createElement("input",{type:"submit",hidden:!0})))};var management_users=__webpack_require__(21);const ConfirmDeleteUsers=({usernames:usernames,onCancel:onCancel,onSuccess:onSuccess})=>{const{services:services}=Object(public_.useKibana)(),[state,deleteUsers]=useAsyncFn_default()(async()=>{for(const username of usernames)try{await new management_users.UserAPIClient(services.http).deleteUser(username),services.notifications.toasts.addSuccess(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.security.management.users.confirmDeleteUsers.successMessage",{defaultMessage:"Deleted user '{username}'",values:{username:username}})),null==onSuccess||onSuccess()}catch(error){var _body;services.notifications.toasts.addDanger({title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.security.management.users.confirmDeleteUsers.errorMessage",{defaultMessage:"Could not delete user '{username}'",values:{username:username}}),text:(null===(_body=error.body)||void 0===_body?void 0:_body.message)||error.message})}},[services.http]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiConfirmModal,{role:"dialog",title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.security.management.users.confirmDeleteUsers.title",{defaultMessage:"Delete {count, plural, one{user '{username}'} other{{count} users}}?",values:{count:usernames.length,username:usernames[0]}}),onCancel:onCancel,onConfirm:deleteUsers,cancelButtonText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.security.management.users.confirmDeleteUsers.cancelButton",{defaultMessage:"Cancel"}),confirmButtonText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.security.management.users.confirmDeleteUsers.confirmButton",{defaultMessage:"{isLoading, select, true{Deleting {count, plural, one{user} other{users}}…} other{Delete {count, plural, one{user} other{users}}}}",values:{count:usernames.length,isLoading:state.loading}}),buttonColor:"danger",isLoading:state.loading},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.security.management.users.confirmDeleteUsers.description",defaultMessage:"{count, plural, one{This user} other{These users}} will be permanently deleted and access to Elastic removed{count, plural, one{.} other{:}}",values:{count:usernames.length}})),usernames.length>1&&external_kbnSharedDeps_React_default.a.createElement("ul",null,usernames.map(username=>external_kbnSharedDeps_React_default.a.createElement("li",{key:username},username))),external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.security.management.users.confirmDelete.cannotUndoWarning",defaultMessage:"You can't recover deleted users."}))))},ConfirmDisableUsers=({usernames:usernames,onCancel:onCancel,onSuccess:onSuccess})=>{const{services:services}=Object(public_.useKibana)(),isSystemUser="kibana"===usernames[0]||"kibana_system"===usernames[0],[state,disableUsers]=useAsyncFn_default()(async()=>{for(const username of usernames)try{await new management_users.UserAPIClient(services.http).disableUser(username),services.notifications.toasts.addSuccess(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.security.management.users.confirmDisableUsers.successMessage",{defaultMessage:"Deactivated user '{username}'",values:{username:username}})),null==onSuccess||onSuccess()}catch(error){var _body;services.notifications.toasts.addDanger({title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.security.management.users.confirmDisableUsers.errorMessage",{defaultMessage:"Could not deactivate user '{username}'",values:{username:username}}),text:(null===(_body=error.body)||void 0===_body?void 0:_body.message)||error.message})}},[services.http]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiConfirmModal,{role:"dialog",title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.security.management.users.confirmDisableUsers.title",{defaultMessage:"Deactivate {count, plural, one{user '{username}'} other{{count} users}}?",values:{count:usernames.length,username:usernames[0]}}),onCancel:onCancel,onConfirm:disableUsers,cancelButtonText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.security.management.users.confirmDisableUsers.cancelButton",{defaultMessage:"Cancel"}),confirmButtonText:isSystemUser?external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.security.management.users.confirmDisableUsers.confirmSystemPasswordButton",{defaultMessage:"{isLoading, select, true{Deactivating user…} other{I understand, deactivate this user}}",values:{isLoading:state.loading}}):external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.security.management.users.confirmDisableUsers.confirmButton",{defaultMessage:"{isLoading, select, true{Deactivating {count, plural, one{user} other{users}}…} other{Deactivate {count, plural, one{user} other{users}}}}",values:{count:usernames.length,isLoading:state.loading}}),buttonColor:isSystemUser?"danger":void 0,isLoading:state.loading},isSystemUser?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.security.management.users.confirmDisableUsers.systemUserWarning",defaultMessage:"Deactivating this user will prevent Kibana from communicating with Elasticsearch."})),external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.security.management.users.confirmDisableUsers.systemUserDescription",defaultMessage:"Once deactivated, you must manually update your config file with different user details and restart Kibana."}))):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.security.management.users.confirmDisableUsers.description",defaultMessage:"{count, plural, one{This user} other{These users}} will no longer be able to access Elastic{count, plural, one{.} other{:}}",values:{count:usernames.length}})),usernames.length>1&&external_kbnSharedDeps_React_default.a.createElement("ul",null,usernames.map(username=>external_kbnSharedDeps_React_default.a.createElement("li",{key:username},username)))))},ConfirmEnableUsers=({usernames:usernames,onCancel:onCancel,onSuccess:onSuccess})=>{const{services:services}=Object(public_.useKibana)(),[state,enableUsers]=useAsyncFn_default()(async()=>{for(const username of usernames)try{await new management_users.UserAPIClient(services.http).enableUser(username),services.notifications.toasts.addSuccess(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.security.management.users.confirmEnableUsers.successMessage",{defaultMessage:"Activated user '{username}'",values:{username:username}})),null==onSuccess||onSuccess()}catch(error){var _body;services.notifications.toasts.addDanger({title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.security.management.users.confirmEnableUsers.errorMessage",{defaultMessage:"Could not activate user '{username}'",values:{username:username}}),text:(null===(_body=error.body)||void 0===_body?void 0:_body.message)||error.message})}},[services.http]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiConfirmModal,{role:"dialog",title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.security.management.users.confirmEnableUsers.title",{defaultMessage:"Activate {count, plural, one{user '{username}'} other{{count} users}}?",values:{count:usernames.length,username:usernames[0]}}),onCancel:onCancel,onConfirm:enableUsers,cancelButtonText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.security.management.users.confirmEnableUsers.cancelButton",{defaultMessage:"Cancel"}),confirmButtonText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.security.management.users.confirmEnableUsers.confirmButton",{defaultMessage:"{isLoading, select, true{Activating {count, plural, one{user} other{users}}…} other{Activate {count, plural, one{user} other{users}}}}",values:{count:usernames.length,isLoading:state.loading}}),isLoading:state.loading},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.security.management.users.confirmEnableUsers.description",defaultMessage:"{count, plural, one{This user} other{These users}} will be able to access Elastic{count, plural, one{.} other{:}}",values:{count:usernames.length}})),usernames.length>1&&external_kbnSharedDeps_React_default.a.createElement("ul",null,usernames.map(username=>external_kbnSharedDeps_React_default.a.createElement("li",{key:username},username)))))};var external_kbnSharedDeps_Lodash_=__webpack_require__(16),constants=__webpack_require__(18),doc_link=__webpack_require__(92),role_combo_box=__webpack_require__(108),management_roles=__webpack_require__(26);const defaultDefaultValues={username:"",password:"",confirm_password:"",full_name:"",email:"",roles:[]},UserForm=({isNewUser:isNewUser=!1,isReservedUser:isReservedUser=!1,defaultValues:defaultValues=defaultDefaultValues,onSuccess:onSuccess,onCancel:onCancel})=>{var _rolesState$value,_form$values$roles;const{services:services}=Object(public_.useKibana)(),[rolesState,getRoles]=useAsyncFn_default()(()=>new management_roles.RolesAPIClient(services.http).getRoles(),[services.http]),getUsersThrottled=Object(external_kbnSharedDeps_React_.useCallback)(Object(external_kbnSharedDeps_Lodash_.throttle)(()=>new user_api_client.UserAPIClient(services.http).getUsers(),1e4),[services.http]),[form,eventHandlers]=Object(use_form.a)({onSubmit:async values=>{const{password:password,confirm_password:confirm_password,...rest}=values,user=isNewUser?{password:password,...rest}:rest;try{await new user_api_client.UserAPIClient(services.http).saveUser(user),services.notifications.toasts.addSuccess(isNewUser?external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.security.management.users.userForm.createSuccessMessage",{defaultMessage:"Created user '{username}'",values:{username:user.username}}):external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.security.management.users.userForm.updateSuccessMessage",{defaultMessage:"Updated user '{username}'",values:{username:user.username}})),null==onSuccess||onSuccess()}catch(error){var _body;throw services.notifications.toasts.addDanger({title:isNewUser?external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.security.management.users.userForm.createErrorMessage",{defaultMessage:"Could not create user '{username}'",values:{username:user.username}}):external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.security.management.users.userForm.updateErrorMessage",{defaultMessage:"Could not update user '{username}'",values:{username:user.username}}),text:(null===(_body=error.body)||void 0===_body?void 0:_body.message)||error.message}),error}},validate:async values=>{const errors={};if(isNewUser){if(values.username)if(values.username.length>constants.d)errors.username=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.security.management.users.userForm.usernameMaxLengthError",{defaultMessage:"Username must not exceed {maxLength} characters.",values:{maxLength:constants.d}});else if(values.username.trim()!==values.username)errors.username=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.security.management.users.userForm.usernameWhitespaceError",{defaultMessage:"Username must not contain leading or trailing spaces."});else if(values.username.match(constants.e))try{(await getUsersThrottled()).some(user=>user.username===values.username)&&(errors.username=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.security.management.users.userForm.usernameTakenError",{defaultMessage:"User '{username}' already exists.",values:{username:values.username}}))}catch(error){}else errors.username=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.security.management.users.userForm.usernameInvalidError",{defaultMessage:"Username must contain only letters, numbers, spaces, punctuation, and symbols."});else errors.username=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.security.management.users.userForm.usernameRequiredError",{defaultMessage:"Enter a username."});values.password?values.password.length<6?errors.password=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.security.management.users.userForm.passwordInvalidError",{defaultMessage:"Password must be at least 6 characters."}):values.confirm_password?values.password!==values.confirm_password&&(errors.confirm_password=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.security.management.users.userForm.confirmPasswordInvalidError",{defaultMessage:"Passwords do not match."})):errors.confirm_password=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.security.management.users.userForm.confirmPasswordRequiredError",{defaultMessage:"Passwords do not match."}):errors.password=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.security.management.users.userForm.passwordRequiredError",{defaultMessage:"Enter a password."})}return errors},defaultValues:defaultValues});Object(external_kbnSharedDeps_React_.useEffect)(()=>{form.reset(defaultValues)},[defaultValues]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{getRoles()},[]);const availableRoles=null!==(_rolesState$value=rolesState.value)&&void 0!==_rolesState$value?_rolesState$value:[],selectedRoleNames=null!==(_form$values$roles=form.values.roles)&&void 0!==_form$values$roles?_form$values$roles:[],deprecatedRoles=selectedRoleNames.reduce((roles,name)=>{const role=availableRoles.find(r=>r.name===name);return role&&Object(model.g)(role)&&roles.push(role),roles},[]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiForm,{component:"form",error:Object.values(form.errors),isInvalid:form.isInvalid,invalidCallout:form.isSubmitted?"above":"none",onSubmit:eventHandlers.onSubmit,noValidate:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescribedFormGroup,{title:external_kbnSharedDeps_React_default.a.createElement("h2",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.security.management.users.userForm.profileTitle",defaultMessage:"Profile"})),description:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.security.management.users.userForm.profileDescription",{defaultMessage:"Provide personal details."})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.security.management.users.userForm.usernameLabel",{defaultMessage:"Username"}),helpText:isNewUser||isReservedUser?void 0:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.security.management.users.userForm.changingUserNameAfterCreationDescription",{defaultMessage:"Username can't be changed once created."}),error:form.errors.username,isInvalid:form.touched.username&&!!form.errors.username},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldText,{name:"username","data-test-subj":"userFormUserNameInput",icon:"user",value:form.values.username,isLoading:form.isValidating,isInvalid:form.touched.username&&!!form.errors.username,disabled:!isNewUser,onChange:eventHandlers.onChange,onBlur:eventHandlers.onBlur})),isReservedUser?void 0:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.security.management.users.userForm.fullNameLabel",{defaultMessage:"Full name"}),error:form.errors.full_name,isInvalid:form.touched.full_name&&!!form.errors.full_name},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldText,{name:"full_name","data-test-subj":"userFormFullNameInput",value:form.values.full_name,isInvalid:form.touched.full_name&&!!form.errors.full_name,onChange:eventHandlers.onChange,onBlur:eventHandlers.onBlur})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.security.management.users.userForm.emailLabel",{defaultMessage:"Email address"}),error:form.errors.email,isInvalid:form.touched.email&&!!form.errors.email},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldText,{name:"email","data-test-subj":"userFormEmailInput",value:form.values.email,isInvalid:form.touched.email&&!!form.errors.email,onChange:eventHandlers.onChange,onBlur:eventHandlers.onBlur})))),isNewUser?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescribedFormGroup,{title:external_kbnSharedDeps_React_default.a.createElement("h2",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.security.management.users.userForm.passwordTitle",defaultMessage:"Password"})),description:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.security.management.users.userForm.passwordDescription",{defaultMessage:"Protect your data with a strong password."})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.security.management.users.userForm.passwordLabel",{defaultMessage:"Password"}),helpText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.security.management.users.userForm.passwordHelpText",{defaultMessage:"Password must be at least 6 characters."}),error:form.errors.password,isInvalid:form.touched.password&&!!form.errors.password},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldPassword,{name:"password","data-test-subj":"passwordInput",type:"dual",value:form.values.password,isInvalid:form.touched.password&&!!form.errors.password,autoComplete:"new-password",onChange:eventHandlers.onChange,onBlur:eventHandlers.onBlur})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.security.management.users.userForm.confirmPasswordLabel",{defaultMessage:"Confirm password"}),error:form.errors.confirm_password,isInvalid:form.touched.confirm_password&&!!form.errors.confirm_password},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldPassword,{name:"confirm_password","data-test-subj":"passwordConfirmationInput",type:"dual",value:form.values.confirm_password,isInvalid:form.touched.confirm_password&&!!form.errors.confirm_password,autoComplete:"new-password",onChange:eventHandlers.onChange,onBlur:eventHandlers.onBlur}))):null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescribedFormGroup,{title:external_kbnSharedDeps_React_default.a.createElement("h2",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.security.management.users.userForm.privilegesTitle",defaultMessage:"Privileges"})),description:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.security.management.users.userForm.privilegesDescription",{defaultMessage:"Assign roles to manage access and permissions."})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.security.management.users.userForm.rolesLabel",{defaultMessage:"Roles"}),helpText:!isReservedUser&&deprecatedRoles.length>0?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTextColor,{color:"warning"},deprecatedRoles.map(role=>{var _role$metadata,_role$metadata$_depre;return external_kbnSharedDeps_React_default.a.createElement("p",{key:role.name},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.security.management.users.userForm.deprecatedRolesAssignedWarning",defaultMessage:"Role '{name}' is deprecated. {reason}.",values:{name:role.name,reason:null===(_role$metadata=role.metadata)||void 0===_role$metadata||null===(_role$metadata$_depre=_role$metadata._deprecated_reason)||void 0===_role$metadata$_depre?void 0:_role$metadata$_depre.replace(/\[(.+)\]/,"'$1'")}}))})):external_kbnSharedDeps_React_default.a.createElement(doc_link.a,{app:"elasticsearch",doc:"built-in-roles.html"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.security.management.users.userForm.rolesHelpText",defaultMessage:"Learn what privileges individual roles grant."}))},external_kbnSharedDeps_React_default.a.createElement(role_combo_box.a,{availableRoles:availableRoles,selectedRoleNames:selectedRoleNames,onChange:value=>form.setValue("roles",value),isLoading:rolesState.loading,isDisabled:isReservedUser})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"xxl"}),isReservedUser?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{responsive:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{iconType:"arrowLeft",onClick:onCancel},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.security.management.users.userForm.backToUsersButton",defaultMessage:"Back to users"})))):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{responsive:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{type:"submit",isLoading:form.isSubmitting,isDisabled:form.isSubmitted&&form.isInvalid,fill:!0},isNewUser?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.security.management.users.userForm.createUserButton",defaultMessage:"{isSubmitting, select, true{Creating user…} other{Create user}}",values:{isSubmitting:form.isSubmitting}}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.security.management.users.userForm.updateUserButton",defaultMessage:"{isSubmitting, select, true{Updating user…} other{Update user}}",values:{isSubmitting:form.isSubmitting}}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{flush:"left",isDisabled:form.isSubmitting,onClick:onCancel},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.security.management.users.userForm.cancelButton",defaultMessage:"Cancel"}))))))},EditUserPage=({username:username})=>{var _user$metadata,_user$metadata$_depre;const{services:services}=Object(public_.useKibana)(),history=Object(external_kbnSharedDeps_ReactRouterDom_.useHistory)(),[{value:user,error:error},getUser]=useAsyncFn_default()(()=>new user_api_client.UserAPIClient(services.http).getUser(username),[services.http]),[action,setAction]=Object(external_kbnSharedDeps_React_.useState)("none"),backToUsers=()=>history.push("/");if(Object(external_kbnSharedDeps_React_.useEffect)(()=>{getUser()},[]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{error&&backToUsers()},[error]),!user)return null;const isReservedUser=Object(user_utils.c)(user),isDeprecatedUser=Object(user_utils.b)(user),displayName=Object(model.e)(user);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageContent,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageContentHeader,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageContentHeaderSection,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",responsive:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiAvatar,{name:displayName,size:"xl"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,null,external_kbnSharedDeps_React_default.a.createElement("h1",null,displayName)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,user.email))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageContentBody,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHorizontalRule,null),isDeprecatedUser?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.security.management.users.editUserPage.deprecatedUserWarning",defaultMessage:"This user is deprecated."}),iconType:"alert",color:"warning"},null===(_user$metadata=user.metadata)||void 0===_user$metadata||null===(_user$metadata$_depre=_user$metadata._deprecated_reason)||void 0===_user$metadata$_depre?void 0:_user$metadata$_depre.replace(/\[(.+)\]/,"'$1'")),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null)):isReservedUser?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.security.management.users.editUserPage.reservedUserWarning",defaultMessage:"This user is built in and can't be updated or deleted."}),iconType:"lock"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null)):!1===user.enabled?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.security.management.users.editUserPage.disabledUserWarning",defaultMessage:"This user has been deactivated and can't access Elastic."})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{onClick:()=>setAction("enableUser"),size:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.security.management.users.editUserPage.enableUserButton",defaultMessage:"Activate user"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null)):void 0,external_kbnSharedDeps_React_default.a.createElement(UserForm,{isReservedUser:isReservedUser,defaultValues:user,onCancel:backToUsers,onSuccess:backToUsers}),"changePassword"===action?external_kbnSharedDeps_React_default.a.createElement(ChangePasswordFlyout,{username:username,onCancel:()=>setAction("none"),onSuccess:()=>setAction("none")}):"disableUser"===action?external_kbnSharedDeps_React_default.a.createElement(ConfirmDisableUsers,{usernames:[username],onCancel:()=>setAction("none"),onSuccess:()=>{setAction("none"),getUser()}}):"enableUser"===action?external_kbnSharedDeps_React_default.a.createElement(ConfirmEnableUsers,{usernames:[username],onCancel:()=>setAction("none"),onSuccess:()=>{setAction("none"),getUser()}}):"deleteUser"===action?external_kbnSharedDeps_React_default.a.createElement(ConfirmDeleteUsers,{usernames:[username],onCancel:()=>setAction("none"),onSuccess:backToUsers}):void 0,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHorizontalRule,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPanel,{color:"subdued",hasShadow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionList,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionListTitle,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.security.management.users.editUserPage.changePasswordTitle",defaultMessage:"Change password"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionListDescription,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.security.management.users.editUserPage.changePasswordDescription",defaultMessage:"The user will not be able to log in using their previous password."})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{onClick:()=>setAction("changePassword"),size:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.security.management.users.editUserPage.changePasswordButton",defaultMessage:"Change password"}))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),!1===user.enabled?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPanel,{color:"subdued",hasShadow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionList,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionListTitle,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.security.management.users.editUserPage.enableUserTitle",defaultMessage:"Activate user"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionListDescription,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.security.management.users.editUserPage.enableUserDescription",defaultMessage:"Allow the user to access Elastic."})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{onClick:()=>setAction("enableUser"),size:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.security.management.users.editUserPage.enableUserButton",defaultMessage:"Activate user"}))))):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPanel,{color:"subdued",hasShadow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionList,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionListTitle,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.security.management.users.editUserPage.disableUserTitle",defaultMessage:"Deactivate user"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionListDescription,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.security.management.users.editUserPage.disableUserDescription",defaultMessage:"Prevent the user from accessing Elastic."})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{onClick:()=>setAction("disableUser"),size:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.security.management.users.editUserPage.disableUserButton",defaultMessage:"Deactivate user"}))))),!isReservedUser&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPanel,{color:"subdued",hasShadow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionList,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionListTitle,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.security.management.users.editUserPage.deleteUserTitle",defaultMessage:"Delete user"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionListDescription,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.security.management.users.editUserPage.deleteUserDescription",defaultMessage:"Permanently delete the user and remove access to Elastic."})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{onClick:()=>setAction("deleteUser"),size:"s",color:"danger"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.security.management.users.editUserPage.deleteUserButton",defaultMessage:"Delete user"}))))))))},CreateUserPage=()=>{const history=Object(external_kbnSharedDeps_ReactRouterDom_.useHistory)(),backToUsers=()=>history.push("/");return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageContent,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageContentHeader,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageContentHeaderSection,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,null,external_kbnSharedDeps_React_default.a.createElement("h1",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.security.management.users.createUserPage.title",defaultMessage:"Create user"}))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageContentBody,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHorizontalRule,null),external_kbnSharedDeps_React_default.a.createElement(UserForm,{isNewUser:!0,onCancel:backToUsers,onSuccess:backToUsers})))}},92:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return DocLink}));var _elastic_eui__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__),_src_plugins_kibana_react_public__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(6);const DocLink=({app:app,doc:doc,children:children})=>{const[,getDocLink]=function(){const{services:services}=Object(_src_plugins_kibana_react_public__WEBPACK_IMPORTED_MODULE_2__.useKibana)(),{links:links,ELASTIC_WEBSITE_URL:ELASTIC_WEBSITE_URL,DOC_LINK_VERSION:DOC_LINK_VERSION}=services.docLinks;return[links,Object(react__WEBPACK_IMPORTED_MODULE_1__.useCallback)((app,doc)=>`${ELASTIC_WEBSITE_URL}guide/en/${app}/reference/${DOC_LINK_VERSION}/${doc}`,[ELASTIC_WEBSITE_URL,DOC_LINK_VERSION])]}();return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_0__.EuiLink,{href:getDocLink(app,doc),target:"_blank",external:!0},children)}},93:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return useHtmlId}));var _elastic_eui__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(0);function useHtmlId(prefix,suffix){return Object(react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(()=>Object(_elastic_eui__WEBPACK_IMPORTED_MODULE_0__.htmlIdGenerator)(prefix)(suffix),[prefix,suffix])}},94:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return useForm}));var lodash__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(16),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(0),react_use_lib_useAsyncFn__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(40),react_use_lib_useAsyncFn__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(react_use_lib_useAsyncFn__WEBPACK_IMPORTED_MODULE_2__);function useForm(options){const form=function({onSubmit:onSubmit,validate:validate,defaultValues:defaultValues}){const[values,setValues]=Object(react__WEBPACK_IMPORTED_MODULE_1__.useState)(defaultValues),[errors,setErrors]=Object(react__WEBPACK_IMPORTED_MODULE_1__.useState)({}),[touched,setTouched]=Object(react__WEBPACK_IMPORTED_MODULE_1__.useState)({}),[submitCount,setSubmitCount]=Object(react__WEBPACK_IMPORTED_MODULE_1__.useState)(0),[validationState,validateForm]=react_use_lib_useAsyncFn__WEBPACK_IMPORTED_MODULE_2___default()(async formValues=>{const nextErrors=await validate(formValues);return setErrors(nextErrors),0===Object.keys(nextErrors).length&&setSubmitCount(0),nextErrors},[validate]),[submitState,submitForm]=react_use_lib_useAsyncFn__WEBPACK_IMPORTED_MODULE_2___default()(async formValues=>{const nextErrors=await validateForm(formValues);if(setTouched(function(values,value){return Object(lodash__WEBPACK_IMPORTED_MODULE_0__.cloneDeepWith)(values,v=>{if("object"!=typeof v&&null!==v)return value})}(formValues,!0)),setSubmitCount(submitCount+1),0===Object.keys(nextErrors).length)return onSubmit(formValues)},[validateForm,onSubmit]);return{setValue:async(name,value)=>{const nextValues=setDeep(values,name,value);setValues(nextValues),await validateForm(nextValues)},setTouched:async(name,value=!0)=>{setTouched(setDeep(touched,name,value)),await validateForm(values)},setError:(name,message)=>{setErrors(setDeep(errors,name,message)),setTouched(setDeep(touched,name,!0))},reset:nextValues=>{setValues(nextValues),setErrors({}),setTouched({}),setSubmitCount(0)},submit:()=>submitForm(values),values:values,errors:errors,touched:touched,isValidating:validationState.loading,isSubmitting:submitState.loading,submitError:submitState.error,isInvalid:Object.keys(errors).length>0,isSubmitted:submitCount>0}}(options),eventHandlers={onSubmit:event=>{event.preventDefault(),form.submit()},onChange:event=>{const{name:name,type:type,checked:checked,value:value}=event.target;name&&form.setValue(name,"checkbox"===type?checked:value)},onBlur:event=>{const{name:name}=event.target;name&&form.setTouched(event.target.name)}};return[form,eventHandlers]}function setDeep(values,name,value){return Object(lodash__WEBPACK_IMPORTED_MODULE_0__.get)(values,name)!==value?Object(lodash__WEBPACK_IMPORTED_MODULE_0__.set)(Object(lodash__WEBPACK_IMPORTED_MODULE_0__.cloneDeep)(values),name,value):values}}}]);