/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */!function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}__webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{enumerable:!0,get:getter})},__webpack_require__.r=function(exports){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(exports,"__esModule",{value:!0})},__webpack_require__.t=function(value,mode){if(1&mode&&(value=__webpack_require__(value)),8&mode)return value;if(4&mode&&"object"==typeof value&&value&&value.__esModule)return value;var ns=Object.create(null);if(__webpack_require__.r(ns),Object.defineProperty(ns,"default",{enumerable:!0,value:value}),2&mode&&"string"!=typeof value)for(var key in value)__webpack_require__.d(ns,key,function(key){return value[key]}.bind(null,key));return ns},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function(){return module.default}:function(){return module};return __webpack_require__.d(getter,"a",getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=13)}([function(module,exports){module.exports=__kbnSharedDeps__.React},function(module,exports){module.exports=__kbnSharedDeps__.ElasticEui},function(module,exports){module.exports=__kbnSharedDeps__.KbnI18nReact},function(module,exports){module.exports=__kbnSharedDeps__.KbnI18n},function(module,exports){module.exports=__kbnSharedDeps__.KbnAnalytics},function(module,exports){},function(module,exports,__webpack_require__){"use strict";var memo,isOldIE=function(){return void 0===memo&&(memo=Boolean(window&&document&&document.all&&!window.atob)),memo},getTarget=function(){var memo={};return function(target){if(void 0===memo[target]){var styleTarget=document.querySelector(target);if(window.HTMLIFrameElement&&styleTarget instanceof window.HTMLIFrameElement)try{styleTarget=styleTarget.contentDocument.head}catch(e){styleTarget=null}memo[target]=styleTarget}return memo[target]}}(),stylesInDom=[];function getIndexByIdentifier(identifier){for(var result=-1,i=0;i<stylesInDom.length;i++)if(stylesInDom[i].identifier===identifier){result=i;break}return result}function modulesToDom(list,options){for(var idCountMap={},identifiers=[],i=0;i<list.length;i++){var item=list[i],id=options.base?item[0]+options.base:item[0],count=idCountMap[id]||0,identifier="".concat(id," ").concat(count);idCountMap[id]=count+1;var index=getIndexByIdentifier(identifier),obj={css:item[1],media:item[2],sourceMap:item[3]};-1!==index?(stylesInDom[index].references++,stylesInDom[index].updater(obj)):stylesInDom.push({identifier:identifier,updater:addStyle(obj,options),references:1}),identifiers.push(identifier)}return identifiers}function insertStyleElement(options){var style=document.createElement("style"),attributes=options.attributes||{};if(void 0===attributes.nonce){var nonce=__webpack_require__.nc;nonce&&(attributes.nonce=nonce)}if(Object.keys(attributes).forEach((function(key){style.setAttribute(key,attributes[key])})),"function"==typeof options.insert)options.insert(style);else{var target=getTarget(options.insert||"head");if(!target)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");target.appendChild(style)}return style}var textStore,replaceText=(textStore=[],function(index,replacement){return textStore[index]=replacement,textStore.filter(Boolean).join("\n")});function applyToSingletonTag(style,index,remove,obj){var css=remove?"":obj.media?"@media ".concat(obj.media," {").concat(obj.css,"}"):obj.css;if(style.styleSheet)style.styleSheet.cssText=replaceText(index,css);else{var cssNode=document.createTextNode(css),childNodes=style.childNodes;childNodes[index]&&style.removeChild(childNodes[index]),childNodes.length?style.insertBefore(cssNode,childNodes[index]):style.appendChild(cssNode)}}function applyToTag(style,options,obj){var css=obj.css,media=obj.media,sourceMap=obj.sourceMap;if(media?style.setAttribute("media",media):style.removeAttribute("media"),sourceMap&&btoa&&(css+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))))," */")),style.styleSheet)style.styleSheet.cssText=css;else{for(;style.firstChild;)style.removeChild(style.firstChild);style.appendChild(document.createTextNode(css))}}var singleton=null,singletonCounter=0;function addStyle(obj,options){var style,update,remove;if(options.singleton){var styleIndex=singletonCounter++;style=singleton||(singleton=insertStyleElement(options)),update=applyToSingletonTag.bind(null,style,styleIndex,!1),remove=applyToSingletonTag.bind(null,style,styleIndex,!0)}else style=insertStyleElement(options),update=applyToTag.bind(null,style,options),remove=function(){!function(style){if(null===style.parentNode)return!1;style.parentNode.removeChild(style)}(style)};return update(obj),function(newObj){if(newObj){if(newObj.css===obj.css&&newObj.media===obj.media&&newObj.sourceMap===obj.sourceMap)return;update(obj=newObj)}else remove()}}module.exports=function(list,options){(options=options||{}).singleton||"boolean"==typeof options.singleton||(options.singleton=isOldIE());var lastIdentifiers=modulesToDom(list=list||[],options);return function(newList){if(newList=newList||[],"[object Array]"===Object.prototype.toString.call(newList)){for(var i=0;i<lastIdentifiers.length;i++){var index=getIndexByIdentifier(lastIdentifiers[i]);stylesInDom[index].references--}for(var newLastIdentifiers=modulesToDom(newList,options),_i=0;_i<lastIdentifiers.length;_i++){var _index=getIndexByIdentifier(lastIdentifiers[_i]);0===stylesInDom[_index].references&&(stylesInDom[_index].updater(),stylesInDom.splice(_index,1))}lastIdentifiers=newLastIdentifiers}}}},function(module,exports,__webpack_require__){"use strict";module.exports=function(useSourceMap){var list=[];return list.toString=function(){return this.map((function(item){var content=function(item,useSourceMap){var content=item[1]||"",cssMapping=item[3];if(!cssMapping)return content;if(useSourceMap&&"function"==typeof btoa){var sourceMapping=(sourceMap=cssMapping,base64=btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))),data="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(base64),"/*# ".concat(data," */")),sourceURLs=cssMapping.sources.map((function(source){return"/*# sourceURL=".concat(cssMapping.sourceRoot||"").concat(source," */")}));return[content].concat(sourceURLs).concat([sourceMapping]).join("\n")}var sourceMap,base64,data;return[content].join("\n")}(item,useSourceMap);return item[2]?"@media ".concat(item[2]," {").concat(content,"}"):content})).join("")},list.i=function(modules,mediaQuery,dedupe){"string"==typeof modules&&(modules=[[null,modules,""]]);var alreadyImportedModules={};if(dedupe)for(var i=0;i<this.length;i++){var id=this[i][0];null!=id&&(alreadyImportedModules[id]=!0)}for(var _i=0;_i<modules.length;_i++){var item=[].concat(modules[_i]);dedupe&&alreadyImportedModules[item[0]]||(mediaQuery&&(item[2]?item[2]="".concat(mediaQuery," and ").concat(item[2]):item[2]=mediaQuery),list.push(item))}},list}},function(module,exports){module.exports=__kbnSharedDeps__.ReactDom},function(module,exports){module.exports=__kbnSharedDeps__.TsLib},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var react_1=__webpack_require__(0);exports.default=function(){var mountedRef=react_1.useRef(!1),get=react_1.useCallback((function(){return mountedRef.current}),[]);return react_1.useEffect((function(){return mountedRef.current=!0,function(){mountedRef.current=!1}})),get}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var tslib_1=__webpack_require__(9),react_1=__webpack_require__(0),useTimeoutFn_1=tslib_1.__importDefault(__webpack_require__(24));exports.default=function(fn,ms,deps){void 0===ms&&(ms=0),void 0===deps&&(deps=[]);var _a=useTimeoutFn_1.default(fn,ms),isReady=_a[0],cancel=_a[1],reset=_a[2];return react_1.useEffect(reset,deps),[isReady,cancel]}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var react_1=__webpack_require__(0),defaultTarget=__webpack_require__(25).isClient?window:null,isListenerType1=function(target){return!!target.addEventListener},isListenerType2=function(target){return!!target.on};exports.default=function(name,handler,target,options){void 0===target&&(target=defaultTarget),react_1.useEffect((function(){if(handler&&target)return isListenerType1(target)?target.addEventListener(name,handler,options):isListenerType2(target)&&target.on(name,handler,options),function(){isListenerType1(target)?target.removeEventListener(name,handler,options):isListenerType2(target)&&target.off(name,handler,options)}}),[name,handler,target,JSON.stringify(options)])}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__(14);__kbnBundles__.define("plugin/globalSearchBar/public",__webpack_require__,27)},function(module,exports,__webpack_require__){__webpack_require__.p=window.__kbnPublicPath__.globalSearchBar},function(module,exports,__webpack_require__){switch(window.__kbnThemeTag__){case"v7dark":return __webpack_require__(16);case"v7light":return __webpack_require__(18);case"v8dark":return __webpack_require__(20);case"v8light":return __webpack_require__(22)}},function(module,exports,__webpack_require__){var api=__webpack_require__(6),content=__webpack_require__(17);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){(exports=__webpack_require__(7)(!1)).push([module.i,".kbnSearchOption__tagsList{display:inline-block;line-height:18px !important}.kbnSearchOption__tagsList .kbnSearchOption__tagsListItem{display:inline-block;max-width:80px;margin-right:8px}.euiSelectableListItem-isFocused .kbnSearchOption__tagsList{margin-right:4px;border-right:1px solid #343741}.kbnSearchBar{width:400px;max-width:100%;will-change:width}@media only screen and (max-width: 574px){.kbnSearchOption__tagsList{display:none}}@media only screen and (min-width: 575px) and (max-width: 767px){.kbnSearchOption__tagsList{display:none}}@media only screen and (min-width: 992px) and (max-width: 1199px){.kbnSearchBar:focus{animation:kbnAnimateSearchBar 150ms forwards}}@media only screen and (min-width: 1200px){.kbnSearchBar:focus{animation:kbnAnimateSearchBar 150ms forwards}}@keyframes kbnAnimateSearchBar{from{width:400px}to{width:600px}}\n",""]),module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(6),content=__webpack_require__(19);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){(exports=__webpack_require__(7)(!1)).push([module.i,".kbnSearchOption__tagsList{display:inline-block;line-height:18px !important}.kbnSearchOption__tagsList .kbnSearchOption__tagsListItem{display:inline-block;max-width:80px;margin-right:8px}.euiSelectableListItem-isFocused .kbnSearchOption__tagsList{margin-right:4px;border-right:1px solid #D3DAE6}.kbnSearchBar{width:400px;max-width:100%;will-change:width}@media only screen and (max-width: 574px){.kbnSearchOption__tagsList{display:none}}@media only screen and (min-width: 575px) and (max-width: 767px){.kbnSearchOption__tagsList{display:none}}@media only screen and (min-width: 992px) and (max-width: 1199px){.kbnSearchBar:focus{animation:kbnAnimateSearchBar 150ms forwards}}@media only screen and (min-width: 1200px){.kbnSearchBar:focus{animation:kbnAnimateSearchBar 150ms forwards}}@keyframes kbnAnimateSearchBar{from{width:400px}to{width:600px}}\n",""]),module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(6),content=__webpack_require__(21);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){(exports=__webpack_require__(7)(!1)).push([module.i,".kbnSearchOption__tagsList{display:inline-block;line-height:16px !important}.kbnSearchOption__tagsList .kbnSearchOption__tagsListItem{display:inline-block;max-width:80px;margin-right:8px}.euiSelectableListItem-isFocused .kbnSearchOption__tagsList{margin-right:4px;border-right:1px solid #343741}.kbnSearchBar{width:400px;max-width:100%;will-change:width}@media only screen and (max-width: 574px){.kbnSearchOption__tagsList{display:none}}@media only screen and (min-width: 575px) and (max-width: 767px){.kbnSearchOption__tagsList{display:none}}@media only screen and (min-width: 992px) and (max-width: 1199px){.kbnSearchBar:focus{animation:kbnAnimateSearchBar 150ms forwards}}@media only screen and (min-width: 1200px){.kbnSearchBar:focus{animation:kbnAnimateSearchBar 150ms forwards}}@keyframes kbnAnimateSearchBar{from{width:400px}to{width:600px}}\n",""]),module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(6),content=__webpack_require__(23);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){(exports=__webpack_require__(7)(!1)).push([module.i,".kbnSearchOption__tagsList{display:inline-block;line-height:16px !important}.kbnSearchOption__tagsList .kbnSearchOption__tagsListItem{display:inline-block;max-width:80px;margin-right:8px}.euiSelectableListItem-isFocused .kbnSearchOption__tagsList{margin-right:4px;border-right:1px solid #D3DAE6}.kbnSearchBar{width:400px;max-width:100%;will-change:width}@media only screen and (max-width: 574px){.kbnSearchOption__tagsList{display:none}}@media only screen and (min-width: 575px) and (max-width: 767px){.kbnSearchOption__tagsList{display:none}}@media only screen and (min-width: 992px) and (max-width: 1199px){.kbnSearchBar:focus{animation:kbnAnimateSearchBar 150ms forwards}}@media only screen and (min-width: 1200px){.kbnSearchBar:focus{animation:kbnAnimateSearchBar 150ms forwards}}@keyframes kbnAnimateSearchBar{from{width:400px}to{width:600px}}\n",""]),module.exports=exports},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var react_1=__webpack_require__(0);exports.default=function(fn,ms){void 0===ms&&(ms=0);var ready=react_1.useRef(!1),timeout=react_1.useRef(),callback=react_1.useRef(fn),isReady=react_1.useCallback((function(){return ready.current}),[]),set=react_1.useCallback((function(){ready.current=!1,timeout.current&&clearTimeout(timeout.current),timeout.current=setTimeout((function(){ready.current=!0,callback.current()}),ms)}),[ms]),clear=react_1.useCallback((function(){ready.current=null,timeout.current&&clearTimeout(timeout.current)}),[]);return react_1.useEffect((function(){callback.current=fn}),[fn]),react_1.useEffect((function(){return set(),clear}),[ms]),[isReady,clear,set]}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isDeepEqual=exports.off=exports.on=exports.isClient=void 0;var react_1=__webpack_require__(9).__importDefault(__webpack_require__(26));exports.isClient="object"==typeof window,exports.on=function(obj){for(var args=[],_i=1;_i<arguments.length;_i++)args[_i-1]=arguments[_i];return obj.addEventListener.apply(obj,args)},exports.off=function(obj){for(var args=[],_i=1;_i<arguments.length;_i++)args[_i-1]=arguments[_i];return obj.removeEventListener.apply(obj,args)},exports.isDeepEqual=react_1.default},function(module,exports,__webpack_require__){"use strict";module.exports=function equal(a,b){if(a===b)return!0;if(a&&b&&"object"==typeof a&&"object"==typeof b){if(a.constructor!==b.constructor)return!1;var length,i,keys;if(Array.isArray(a)){if((length=a.length)!=b.length)return!1;for(i=length;0!=i--;)if(!equal(a[i],b[i]))return!1;return!0}if(a.constructor===RegExp)return a.source===b.source&&a.flags===b.flags;if(a.valueOf!==Object.prototype.valueOf)return a.valueOf()===b.valueOf();if(a.toString!==Object.prototype.toString)return a.toString()===b.toString();if((length=(keys=Object.keys(a)).length)!==Object.keys(b).length)return!1;for(i=length;0!=i--;)if(!Object.prototype.hasOwnProperty.call(b,keys[i]))return!1;for(i=length;0!=i--;){var key=keys[i];if(("_owner"!==key||!a.$$typeof)&&!equal(a[key],b[key]))return!1}return!0}return a!=a&&b!=b}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"plugin",(function(){return public_plugin}));var external_kbnSharedDeps_React_=__webpack_require__(0),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),external_kbnSharedDeps_ReactDom_=__webpack_require__(8),external_kbnSharedDeps_ReactDom_default=__webpack_require__.n(external_kbnSharedDeps_ReactDom_),external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(2),external_kbnSharedDeps_ElasticEui_=__webpack_require__(1),external_kbnSharedDeps_KbnAnalytics_=__webpack_require__(4),external_kbnSharedDeps_KbnI18n_=__webpack_require__(3),useDebounce=__webpack_require__(11),useDebounce_default=__webpack_require__.n(useDebounce),useEvent=__webpack_require__(12),useEvent_default=__webpack_require__.n(useEvent),useMountedState=__webpack_require__(10),useMountedState_default=__webpack_require__.n(useMountedState);const knownFilters=["tag","type"],aliasMap={tag:["tags"],type:["types"]},parseSearchParams=term=>{let query;try{query=external_kbnSharedDeps_ElasticEui_.Query.parse(term)}catch(e){return{term:term,filters:{unknowns:{}}}}const searchTerm=(query=>{var _term;let term;return query.ast.getTermClauses().length&&(term=query.ast.getTermClauses().map(clause=>clause.value).join(" ").replace(/\s{2,}/g," ").trim()),null!==(_term=term)&&void 0!==_term&&_term.length?term:void 0})(query),filterValues=((valueMap,aliasesMap)=>{const reverseLookup={};Object.entries(aliasesMap).forEach(([canonical,aliases])=>{aliases.forEach(alias=>{reverseLookup[alias]=canonical})});const resultMap=new Map;return valueMap.forEach((values,field)=>{var _reverseLookup$field,_resultMap$get;const targetKey=null!==(_reverseLookup$field=reverseLookup[field])&&void 0!==_reverseLookup$field?_reverseLookup$field:field;resultMap.set(targetKey,[...null!==(_resultMap$get=resultMap.get(targetKey))&&void 0!==_resultMap$get?_resultMap$get:[],...values])}),resultMap})((query=>{const fieldMap=new Map;return query.ast.clauses.forEach(clause=>{if("field"===clause.type){var _fieldMap$get;const{field:field,value:value}=clause;fieldMap.set(field,[...null!==(_fieldMap$get=fieldMap.get(field))&&void 0!==_fieldMap$get?_fieldMap$get:[],...Array.isArray(value)?value:[value]])}}),fieldMap})(query),aliasMap),unknownFilters=[...filterValues.entries()].filter(([key])=>!knownFilters.includes(key)).reduce((unknowns,[key,value])=>({...unknowns,[key]:value}),{}),tags=filterValues.get("tag"),types=filterValues.get("type");return{term:searchTerm,filters:{tags:tags?valuesToString(tags):void 0,types:types?valuesToString(types):void 0,unknowns:unknownFilters}}},valuesToString=raw=>raw.map(value=>String(value));__webpack_require__(5);const findIgnoreCase=(array,target)=>{for(const item of array)if(equalsIgnoreCase(item,target))return item},equalsIgnoreCase=(a,b)=>a.toLowerCase()===b.toLowerCase(),escapeIfWhiteSpaces=term=>/\s/g.test(term)?`"${term}"`:term;__webpack_require__(15);const isMac=navigator.platform.toLowerCase().indexOf("mac")>=0,setFieldValue=(field,value)=>{const nativeInputValue=Object.getOwnPropertyDescriptor(HTMLInputElement.prototype,"value"),nativeInputValueSetter=nativeInputValue?nativeInputValue.set:void 0;nativeInputValueSetter&&nativeInputValueSetter.call(field,value),field.dispatchEvent(new Event("change"))},blurEvent=new FocusEvent("blur"),sortByScore=(a,b)=>a.score<b.score?1:a.score>b.score?-1:0,sortByTitle=(a,b)=>{const titleA=a.title.toUpperCase(),titleB=b.title.toUpperCase();return titleA<titleB?-1:titleA>titleB?1:0},TagListWrapper=({children:children})=>external_kbnSharedDeps_React_default.a.createElement("ul",{className:"kbnSearchOption__tagsList","aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.globalSearchBar.searchBar.optionTagListAriaLabel",{defaultMessage:"Tags"})},children),buildListItem=({color:color,name:name,id:id})=>external_kbnSharedDeps_React_default.a.createElement("li",{className:"kbnSearchOption__tagsListItem",key:id},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBadge,{color:color},name)),resultToOption=(result,searchTagIds,getTag)=>{const{id:id,title:title,url:url,icon:icon,type:type,meta:meta={}}=result,{tagIds:tagIds=[],categoryLabel:categoryLabel=""}=meta,option={key:id,label:title,url:url,type:type,icon:{type:"application"===type&&icon?icon:"empty"},"data-test-subj":"nav-search-option"};var str;return option.meta="application"===type?[{text:categoryLabel}]:[{text:(str=type,(str.charAt(0).toUpperCase()+str.slice(1)).replace(/-/g," "))}],getTag&&tagIds.length&&(option.append=((tags,searchTagIds)=>{if(!(tags.length>3))return external_kbnSharedDeps_React_default.a.createElement(TagListWrapper,null,tags.map(buildListItem));tags.sort(a=>searchTagIds.find(id=>id===a.id)?-1:1);const overflowList=tags.splice(3),overflowMessage=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.globalSearchBar.searchbar.overflowTagsAriaLabel",{defaultMessage:"{n} more {n, plural, one {tag} other {tags}}: {tags}",values:{n:overflowList.length,tags:overflowList.map(({name:name})=>name)}});return external_kbnSharedDeps_React_default.a.createElement(TagListWrapper,null,tags.map(buildListItem),external_kbnSharedDeps_React_default.a.createElement("li",{className:"kbnSearchOption__tagsListItem","aria-label":overflowMessage},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBadge,{title:overflowMessage},"+",overflowList.length)))})(tagIds.map(getTag),searchTagIds)),option},suggestionToOption=suggestion=>{const{key:key,label:label,description:description,icon:icon,suggestedSearch:suggestedSearch}=suggestion;return{key:key,label:label,type:"__suggestion__",icon:{type:icon},suggestion:suggestedSearch,meta:[{text:description}],"data-test-subj":"nav-search-option"}};function SearchBar({globalSearch:globalSearch,taggingApi:taggingApi,navigateToUrl:navigateToUrl,trackUiMetric:trackUiMetric,basePathUrl:basePathUrl,darkMode:darkMode}){const isMounted=useMountedState_default()(),[searchValue,setSearchValue]=Object(external_kbnSharedDeps_React_.useState)(""),[searchTerm,setSearchTerm]=Object(external_kbnSharedDeps_React_.useState)(""),[searchRef,setSearchRef]=Object(external_kbnSharedDeps_React_.useState)(null),[buttonRef,setButtonRef]=Object(external_kbnSharedDeps_React_.useState)(null),searchSubscription=Object(external_kbnSharedDeps_React_.useRef)(null),[options,_setOptions]=Object(external_kbnSharedDeps_React_.useState)([]),[searchableTypes,setSearchableTypes]=Object(external_kbnSharedDeps_React_.useState)([]);Object(external_kbnSharedDeps_React_.useEffect)(()=>{(async()=>{const types=await globalSearch.getSearchableTypes();setSearchableTypes(types)})()},[globalSearch]);const loadSuggestions=Object(external_kbnSharedDeps_React_.useCallback)(term=>(({searchTerm:searchTerm,searchableTypes:searchableTypes,tagCache:tagCache})=>{const results=[],suggestionTerm=searchTerm.trim(),matchingType=findIgnoreCase(searchableTypes,suggestionTerm);if(matchingType){const suggestedSearch=escapeIfWhiteSpaces(matchingType);results.push({key:"__type__suggestion__",label:"type: "+matchingType,icon:"filter",description:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.globalSearchBar.suggestions.filterByTypeLabel",{defaultMessage:"Filter by type"}),suggestedSearch:"type:"+suggestedSearch})}if(tagCache&&searchTerm){const matchingTag=tagCache.getState().find(tag=>equalsIgnoreCase(tag.name,suggestionTerm));if(matchingTag){const suggestedSearch=escapeIfWhiteSpaces(matchingTag.name);results.push({key:"__tag__suggestion__",label:"tag: "+matchingTag.name,icon:"tag",description:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.globalSearchBar.suggestions.filterByTagLabel",{defaultMessage:"Filter by tag name"}),suggestedSearch:"tag:"+suggestedSearch})}}return results})({searchTerm:term,searchableTypes:searchableTypes,tagCache:null==taggingApi?void 0:taggingApi.cache}),[taggingApi,searchableTypes]),setOptions=Object(external_kbnSharedDeps_React_.useCallback)((_options,suggestions,searchTagIds=[])=>{isMounted()&&_setOptions([...suggestions.map(suggestionToOption),..._options.map(option=>{var _searchTagIds$filter;return resultToOption(option,null!==(_searchTagIds$filter=null==searchTagIds?void 0:searchTagIds.filter(id=>"__unknown__"!==id))&&void 0!==_searchTagIds$filter?_searchTagIds$filter:[],null==taggingApi?void 0:taggingApi.ui.getTag)})])},[isMounted,_setOptions,taggingApi]);useDebounce_default()(()=>{var _rawParams$term;searchSubscription.current&&(searchSubscription.current.unsubscribe(),searchSubscription.current=null);const suggestions=loadSuggestions(searchValue);let aggregatedResults=[];0!==searchValue.length&&trackUiMetric(external_kbnSharedDeps_KbnAnalytics_.METRIC_TYPE.COUNT,"search_request");const rawParams=parseSearchParams(searchValue),tagIds=taggingApi&&rawParams.filters.tags?rawParams.filters.tags.map(tagName=>{var _taggingApi$ui$getTag;return null!==(_taggingApi$ui$getTag=taggingApi.ui.getTagIdFromName(tagName))&&void 0!==_taggingApi$ui$getTag?_taggingApi$ui$getTag:"__unknown__"}):void 0,searchParams={term:rawParams.term,types:rawParams.filters.types,tags:tagIds};setSearchTerm(null!==(_rawParams$term=rawParams.term)&&void 0!==_rawParams$term?_rawParams$term:""),searchSubscription.current=globalSearch.find(searchParams,{}).subscribe({next:({results:results})=>{if(searchValue.length>0)return aggregatedResults=[...results,...aggregatedResults].sort(sortByScore),void setOptions(aggregatedResults,suggestions,searchParams.tags);results=results.filter(({type:type})=>"application"===type),aggregatedResults=[...results,...aggregatedResults].sort(sortByTitle),setOptions(aggregatedResults,suggestions,searchParams.tags)},error:()=>{trackUiMetric(external_kbnSharedDeps_KbnAnalytics_.METRIC_TYPE.COUNT,"unhandled_error")},complete:()=>{}})},350,[searchValue,loadSuggestions]);const emptyMessage=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSelectableMessage,{style:{minHeight:300},"data-test-subj":"nav-search-no-results"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiImage,{alt:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.globalSearchBar.searchBar.noResultsImageAlt",{defaultMessage:"Illustration of black hole"}),size:"fullWidth",url:`${basePathUrl}illustration_product_no_search_results_${darkMode?"dark":"light"}.svg`}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"m"},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.globalSearchBar.searchBar.noResultsHeading",defaultMessage:"No results found"}))),external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.globalSearchBar.searchBar.noResults",defaultMessage:"Try searching for applications, dashboards, visualizations, and more."})));return useEvent_default()("keydown",event=>{"/"===event.key&&(isMac?event.metaKey:event.ctrlKey)&&(event.preventDefault(),trackUiMetric(external_kbnSharedDeps_KbnAnalytics_.METRIC_TYPE.COUNT,"shortcut_used"),searchRef?searchRef.focus():buttonRef&&buttonRef.children[0].click())}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSelectableTemplateSitewide,{isPreFiltered:!0,onChange:selection=>{const selected=selection.find(({checked:checked})=>"on"===checked);if(!selected)return;const{url:url,type:type,suggestion:suggestion}=selected;if("__suggestion__"===type)return setFieldValue(searchRef,suggestion),void setSearchValue(suggestion);try{if("application"===type){var _selected$keys;const key=null!==(_selected$keys=selected.keys)&&void 0!==_selected$keys?_selected$keys:"unknown";trackUiMetric(external_kbnSharedDeps_KbnAnalytics_.METRIC_TYPE.CLICK,["user_navigated_to_application","user_navigated_to_application_"+key.toLowerCase().replaceAll(" ","_")])}else trackUiMetric(external_kbnSharedDeps_KbnAnalytics_.METRIC_TYPE.CLICK,["user_navigated_to_saved_object","user_navigated_to_saved_object_"+type])}catch(e){console.log("Error trying to track searchbar metrics",e)}navigateToUrl(url),document.activeElement.blur(),searchRef&&(setFieldValue(searchRef,""),searchRef.dispatchEvent(blurEvent))},options:options,popoverButtonBreakpoints:["xs","s"],singleSelection:!0,renderOption:option=>Object(external_kbnSharedDeps_ElasticEui_.euiSelectableTemplateSitewideRenderOptions)(option,searchTerm),popoverButton:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHeaderSectionItemButton,{"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.globalSearchBar.searchBar.mobileSearchButtonAriaLabel",{defaultMessage:"Site-wide search"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{type:"search",size:"m"})),searchProps:{onKeyUpCapture:e=>setSearchValue(e.currentTarget.value),"data-test-subj":"nav-search-input",inputRef:setSearchRef,compressed:!0,className:"kbnSearchBar","aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.globalSearchBar.searchBar.placeholder",{defaultMessage:"Search Elastic"}),placeholder:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.globalSearchBar.searchBar.placeholder",{defaultMessage:"Search Elastic"}),onFocus:()=>{trackUiMetric(external_kbnSharedDeps_KbnAnalytics_.METRIC_TYPE.COUNT,"search_focus")}},popoverProps:{"data-test-subj":"nav-search-popover",panelClassName:"navSearch__panel",repositionOnScroll:!0,buttonRef:setButtonRef},emptyMessage:emptyMessage,noMatchesMessage:emptyMessage,popoverFooter:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween",gutterSize:"s",responsive:!1,wrap:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{color:"subdued",size:"xs"},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.globalSearchBar.searchBar.helpText.helpTextPrefix",defaultMessage:"Filter by"})," ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCode,null,"type:")," ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.globalSearchBar.searchBar.helpText.helpTextConjunction",defaultMessage:"or"})," ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCode,null,"tag:")))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{color:"subdued",size:"xs"},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.globalSearchBar.searchBar.shortcutDescription.shortcutDetail",defaultMessage:"{shortcutDescription} {commandDescription}",values:{shortcutDescription:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.globalSearchBar.searchBar.shortcutDescription.shortcutInstructionDescription",defaultMessage:"Shortcut"}),commandDescription:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCode,null,isMac?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.globalSearchBar.searchBar.shortcutDescription.macCommandDescription",defaultMessage:"Command + /"}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.globalSearchBar.searchBar.shortcutDescription.windowsCommandDescription",defaultMessage:"Control + /"}))}})))))})}class plugin_GlobalSearchBarPlugin{async setup(){return{}}start(core,{globalSearch:globalSearch,savedObjectsTagging:savedObjectsTagging,usageCollection:usageCollection}){const trackUiMetric=usageCollection?usageCollection.reportUiCounter.bind(usageCollection,"global_search_bar"):(metricType,eventName)=>{};return core.chrome.navControls.registerCenter({order:1e3,mount:container=>this.mount({container:container,globalSearch:globalSearch,savedObjectsTagging:savedObjectsTagging,navigateToUrl:core.application.navigateToUrl,basePathUrl:core.http.basePath.prepend("/plugins/globalSearchBar/assets/"),darkMode:core.uiSettings.get("theme:darkMode"),trackUiMetric:trackUiMetric})}),{}}mount({container:container,globalSearch:globalSearch,savedObjectsTagging:savedObjectsTagging,navigateToUrl:navigateToUrl,basePathUrl:basePathUrl,darkMode:darkMode,trackUiMetric:trackUiMetric}){return external_kbnSharedDeps_ReactDom_default.a.render(external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.I18nProvider,null,external_kbnSharedDeps_React_default.a.createElement(SearchBar,{globalSearch:globalSearch,navigateToUrl:navigateToUrl,taggingApi:savedObjectsTagging,basePathUrl:basePathUrl,darkMode:darkMode,trackUiMetric:trackUiMetric})),container),()=>external_kbnSharedDeps_ReactDom_default.a.unmountComponentAtNode(container)}}const public_plugin=()=>new plugin_GlobalSearchBarPlugin}]);