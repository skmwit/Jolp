/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.fleet_bundle_jsonpfunction=window.fleet_bundle_jsonpfunction||[]).push([[2],Array(109).concat([function(module,exports,__webpack_require__){"use strict";module.exports=function(character){return re.test("number"==typeof character?fromCode(character):character.charAt(0))};var fromCode=String.fromCharCode,re=/\s/},,function(module,exports){module.exports=function(){for(var target={},i=0;i<arguments.length;i++){var source=arguments[i];for(var key in source)hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target};var hasOwnProperty=Object.prototype.hasOwnProperty},,function(module,exports){(exports=module.exports=function(str){return str.trim?str.trim():exports.right(exports.left(str))}).left=function(str){return str.trimLeft?str.trimLeft():str.replace(/^\s\s*/,"")},exports.right=function(str){if(str.trimRight)return str.trimRight();for(var whitespace_pattern=/\s/,i=str.length;whitespace_pattern.test(str.charAt(--i)););return str.slice(0,i+1)}},,function(module,exports,__webpack_require__){"use strict";module.exports=function(character){var code="string"==typeof character?character.charCodeAt(0):character;return code>=48&&code<=57}},function(module,exports,__webpack_require__){"use strict";module.exports=visit;var visitParents=__webpack_require__(193),CONTINUE=visitParents.CONTINUE,SKIP=visitParents.SKIP,EXIT=visitParents.EXIT;function visit(tree,test,visitor,reverse){"function"==typeof test&&"function"!=typeof visitor&&(reverse=visitor,visitor=test,test=null),visitParents(tree,test,(function(node,parents){var parent=parents[parents.length-1],index=parent?parent.children.indexOf(node):null;return visitor(node,index,parent)}),reverse)}visit.CONTINUE=CONTINUE,visit.SKIP=SKIP,visit.EXIT=EXIT},function(module,exports,__webpack_require__){"use strict";var memo,isOldIE=function(){return void 0===memo&&(memo=Boolean(window&&document&&document.all&&!window.atob)),memo},getTarget=function(){var memo={};return function(target){if(void 0===memo[target]){var styleTarget=document.querySelector(target);if(window.HTMLIFrameElement&&styleTarget instanceof window.HTMLIFrameElement)try{styleTarget=styleTarget.contentDocument.head}catch(e){styleTarget=null}memo[target]=styleTarget}return memo[target]}}(),stylesInDom=[];function getIndexByIdentifier(identifier){for(var result=-1,i=0;i<stylesInDom.length;i++)if(stylesInDom[i].identifier===identifier){result=i;break}return result}function modulesToDom(list,options){for(var idCountMap={},identifiers=[],i=0;i<list.length;i++){var item=list[i],id=options.base?item[0]+options.base:item[0],count=idCountMap[id]||0,identifier="".concat(id," ").concat(count);idCountMap[id]=count+1;var index=getIndexByIdentifier(identifier),obj={css:item[1],media:item[2],sourceMap:item[3]};-1!==index?(stylesInDom[index].references++,stylesInDom[index].updater(obj)):stylesInDom.push({identifier:identifier,updater:addStyle(obj,options),references:1}),identifiers.push(identifier)}return identifiers}function insertStyleElement(options){var style=document.createElement("style"),attributes=options.attributes||{};if(void 0===attributes.nonce){var nonce=__webpack_require__.nc;nonce&&(attributes.nonce=nonce)}if(Object.keys(attributes).forEach((function(key){style.setAttribute(key,attributes[key])})),"function"==typeof options.insert)options.insert(style);else{var target=getTarget(options.insert||"head");if(!target)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");target.appendChild(style)}return style}var textStore,replaceText=(textStore=[],function(index,replacement){return textStore[index]=replacement,textStore.filter(Boolean).join("\n")});function applyToSingletonTag(style,index,remove,obj){var css=remove?"":obj.media?"@media ".concat(obj.media," {").concat(obj.css,"}"):obj.css;if(style.styleSheet)style.styleSheet.cssText=replaceText(index,css);else{var cssNode=document.createTextNode(css),childNodes=style.childNodes;childNodes[index]&&style.removeChild(childNodes[index]),childNodes.length?style.insertBefore(cssNode,childNodes[index]):style.appendChild(cssNode)}}function applyToTag(style,options,obj){var css=obj.css,media=obj.media,sourceMap=obj.sourceMap;if(media?style.setAttribute("media",media):style.removeAttribute("media"),sourceMap&&btoa&&(css+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))))," */")),style.styleSheet)style.styleSheet.cssText=css;else{for(;style.firstChild;)style.removeChild(style.firstChild);style.appendChild(document.createTextNode(css))}}var singleton=null,singletonCounter=0;function addStyle(obj,options){var style,update,remove;if(options.singleton){var styleIndex=singletonCounter++;style=singleton||(singleton=insertStyleElement(options)),update=applyToSingletonTag.bind(null,style,styleIndex,!1),remove=applyToSingletonTag.bind(null,style,styleIndex,!0)}else style=insertStyleElement(options),update=applyToTag.bind(null,style,options),remove=function(){!function(style){if(null===style.parentNode)return!1;style.parentNode.removeChild(style)}(style)};return update(obj),function(newObj){if(newObj){if(newObj.css===obj.css&&newObj.media===obj.media&&newObj.sourceMap===obj.sourceMap)return;update(obj=newObj)}else remove()}}module.exports=function(list,options){(options=options||{}).singleton||"boolean"==typeof options.singleton||(options.singleton=isOldIE());var lastIdentifiers=modulesToDom(list=list||[],options);return function(newList){if(newList=newList||[],"[object Array]"===Object.prototype.toString.call(newList)){for(var i=0;i<lastIdentifiers.length;i++){var index=getIndexByIdentifier(lastIdentifiers[i]);stylesInDom[index].references--}for(var newLastIdentifiers=modulesToDom(newList,options),_i=0;_i<lastIdentifiers.length;_i++){var _index=getIndexByIdentifier(lastIdentifiers[_i]);0===stylesInDom[_index].references&&(stylesInDom[_index].updater(),stylesInDom.splice(_index,1))}lastIdentifiers=newLastIdentifiers}}}},function(module,exports,__webpack_require__){"use strict";module.exports=function(useSourceMap){var list=[];return list.toString=function(){return this.map((function(item){var content=function(item,useSourceMap){var content=item[1]||"",cssMapping=item[3];if(!cssMapping)return content;if(useSourceMap&&"function"==typeof btoa){var sourceMapping=(sourceMap=cssMapping,base64=btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))),data="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(base64),"/*# ".concat(data," */")),sourceURLs=cssMapping.sources.map((function(source){return"/*# sourceURL=".concat(cssMapping.sourceRoot||"").concat(source," */")}));return[content].concat(sourceURLs).concat([sourceMapping]).join("\n")}var sourceMap,base64,data;return[content].join("\n")}(item,useSourceMap);return item[2]?"@media ".concat(item[2]," {").concat(content,"}"):content})).join("")},list.i=function(modules,mediaQuery,dedupe){"string"==typeof modules&&(modules=[[null,modules,""]]);var alreadyImportedModules={};if(dedupe)for(var i=0;i<this.length;i++){var id=this[i][0];null!=id&&(alreadyImportedModules[id]=!0)}for(var _i=0;_i<modules.length;_i++){var item=[].concat(modules[_i]);dedupe&&alreadyImportedModules[item[0]]||(mediaQuery&&(item[2]?item[2]="".concat(mediaQuery," and ").concat(item[2]):item[2]=mediaQuery),list.push(item))}},list}},,,,function(module,exports,__webpack_require__){"use strict";function _toConsumableArray(arr){return function(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var xtend=__webpack_require__(111),unified=__webpack_require__(161),parse=__webpack_require__(174),PropTypes=__webpack_require__(230),addListMetadata=__webpack_require__(233),naiveHtml=__webpack_require__(235),disallowNode=__webpack_require__(236),astToReact=__webpack_require__(237),wrapTableRows=__webpack_require__(240),getDefinitions=__webpack_require__(241),uriTransformer=__webpack_require__(242),defaultRenderers=__webpack_require__(243),symbols=__webpack_require__(244),allTypes=Object.keys(defaultRenderers),ReactMarkdown=function(props){var src=props.source||props.children||"",parserOptions=props.parserOptions;if(props.allowedTypes&&props.disallowedTypes)throw new Error("Only one of `allowedTypes` and `disallowedTypes` should be defined");var renderers=xtend(defaultRenderers,props.renderers),parser=[[parse,parserOptions]].concat(props.plugins||[]).reduce(applyParserPlugin,unified()),rawAst=parser.parse(src),renderProps=xtend(props,{renderers:renderers,definitions:getDefinitions(rawAst)}),astPlugins=function(props){var plugins=[wrapTableRows,addListMetadata()],disallowedTypes=props.disallowedTypes;props.allowedTypes&&(disallowedTypes=allTypes.filter((function(type){return"root"!==type&&-1===props.allowedTypes.indexOf(type)})));var removalMethod=props.unwrapDisallowed?"unwrap":"remove";disallowedTypes&&disallowedTypes.length>0&&plugins.push(disallowNode.ofType(disallowedTypes,removalMethod));props.allowNode&&plugins.push(disallowNode.ifNotMatch(props.allowNode,removalMethod));var renderHtml=!props.escapeHtml&&!props.skipHtml,hasHtmlParser=(props.astPlugins||[]).some((function(item){return(Array.isArray(item)?item[0]:item).identity===symbols.HtmlParser}));renderHtml&&!hasHtmlParser&&plugins.push(naiveHtml);return props.astPlugins?plugins.concat(props.astPlugins):plugins}(props),transformedAst=parser.runSync(rawAst),ast=astPlugins.reduce((function(node,plugin){return plugin(node,renderProps)}),transformedAst);return astToReact(ast,renderProps)};function applyParserPlugin(parser,plugin){return Array.isArray(plugin)?parser.use.apply(parser,_toConsumableArray(plugin)):parser.use(plugin)}ReactMarkdown.defaultProps={renderers:{},escapeHtml:!0,skipHtml:!1,sourcePos:!1,rawSourcePos:!1,transformLinkUri:uriTransformer,astPlugins:[],plugins:[],parserOptions:{}},ReactMarkdown.propTypes={className:PropTypes.string,source:PropTypes.string,children:PropTypes.string,sourcePos:PropTypes.bool,rawSourcePos:PropTypes.bool,escapeHtml:PropTypes.bool,skipHtml:PropTypes.bool,allowNode:PropTypes.func,allowedTypes:PropTypes.arrayOf(PropTypes.oneOf(allTypes)),disallowedTypes:PropTypes.arrayOf(PropTypes.oneOf(allTypes)),transformLinkUri:PropTypes.oneOfType([PropTypes.func,PropTypes.bool]),linkTarget:PropTypes.oneOfType([PropTypes.func,PropTypes.string]),transformImageUri:PropTypes.func,astPlugins:PropTypes.arrayOf(PropTypes.func),unwrapDisallowed:PropTypes.bool,renderers:PropTypes.object,plugins:PropTypes.array,parserOptions:PropTypes.object},ReactMarkdown.types=allTypes,ReactMarkdown.renderers=defaultRenderers,ReactMarkdown.uriTransformer=uriTransformer,module.exports=ReactMarkdown},function(module,exports,__webpack_require__){"use strict";var legacy=__webpack_require__(182),invalid=__webpack_require__(183),decimal=__webpack_require__(115),hexadecimal=__webpack_require__(184),alphanumerical=__webpack_require__(185),decodeEntity=__webpack_require__(186);module.exports=function(value,options){var option,key,settings={};options||(options={});for(key in defaults)option=options[key],settings[key]=null==option?defaults[key]:option;(settings.position.indent||settings.position.start)&&(settings.indent=settings.position.indent||[],settings.position=settings.position.start);return function(value,settings){var entityCharacters,namedEntity,terminated,characters,character,reference,following,warning,reason,output,entity,begin,start,type,test,prev,next,diff,end,additional=settings.additional,nonTerminated=settings.nonTerminated,handleText=settings.text,handleReference=settings.reference,handleWarning=settings.warning,textContext=settings.textContext,referenceContext=settings.referenceContext,warningContext=settings.warningContext,pos=settings.position,indent=settings.indent||[],length=value.length,index=0,lines=-1,column=pos.column||1,line=pos.line||1,queue="",result=[];prev=now(),warning=handleWarning?function(code,offset){var position=now();position.column+=offset,position.offset+=offset,handleWarning.call(warningContext,MESSAGES[code],position,code)}:noop,index--,length++;for(;++index<length;)if("\n"===character&&(column=indent[lines]||1),"&"!==(character=at(index)))"\n"===character&&(line++,lines++,column=0),character?(queue+=character,column++):flush();else{if("\t"===(following=at(index+1))||"\n"===following||"\f"===following||" "===following||"<"===following||"&"===following||""===following||additional&&following===additional){queue+=character,column++;continue}for(begin=start=index+1,end=start,"#"!==following?type="named":(end=++begin,"x"===(following=at(end))||"X"===following?(type="hexadecimal",end=++begin):type="decimal"),entityCharacters="",entity="",characters="",test=TESTS[type],end--;++end<length&&(following=at(end),test(following));)characters+=following,"named"===type&&own.call(legacy,characters)&&(entityCharacters=characters,entity=legacy[characters]);(terminated=";"===at(end))&&(end++,(namedEntity="named"===type&&decodeEntity(characters))&&(entityCharacters=characters,entity=namedEntity)),diff=1+end-start,(terminated||nonTerminated)&&(characters?"named"===type?(terminated&&!entity?warning(5,1):(entityCharacters!==characters&&(end=begin+entityCharacters.length,diff=1+end-begin,terminated=!1),terminated||(reason=entityCharacters?1:3,settings.attribute?"="===(following=at(end))?(warning(reason,diff),entity=null):alphanumerical(following)?entity=null:warning(reason,diff):warning(reason,diff))),reference=entity):(terminated||warning(2,diff),reference=parseInt(characters,BASE[type]),(code=reference)>=55296&&code<=57343||code>1114111?(warning(7,diff),reference="ï¿½"):reference in invalid?(warning(6,diff),reference=invalid[reference]):(output="",disallowed(reference)&&warning(6,diff),reference>65535&&(output+=fromCharCode((reference-=65536)>>>10|55296),reference=56320|1023&reference),reference=output+fromCharCode(reference))):"named"!==type&&warning(4,diff)),reference?(flush(),prev=now(),index=end-1,column+=end-start+1,result.push(reference),(next=now()).offset++,handleReference&&handleReference.call(referenceContext,reference,{start:prev,end:next},value.slice(start-1,end)),prev=next):(characters=value.slice(start-1,end),queue+=characters,column+=characters.length,index=end-1)}var code;return result.join("");function now(){return{line:line,column:column,offset:index+(pos.offset||0)}}function at(position){return value.charAt(position)}function flush(){queue&&(result.push(queue),handleText&&handleText.call(textContext,queue,{start:prev,end:now()}),queue="")}}(value,settings)};var own={}.hasOwnProperty,fromCharCode=String.fromCharCode,noop=Function.prototype,defaults={warning:null,reference:null,text:null,warningContext:null,referenceContext:null,textContext:null,position:{},additional:null,attribute:!1,nonTerminated:!0},BASE={hexadecimal:16,decimal:10},TESTS={};TESTS.named=alphanumerical,TESTS.decimal=decimal,TESTS.hexadecimal=hexadecimal;var MESSAGES={};function disallowed(code){return code>=1&&code<=8||11===code||code>=13&&code<=31||code>=127&&code<=159||code>=64976&&code<=65007||65535==(65535&code)||65534==(65535&code)}MESSAGES[1]="Named character references must be terminated by a semicolon",MESSAGES[2]="Numeric character references must be terminated by a semicolon",MESSAGES[3]="Named character references cannot be empty",MESSAGES[4]="Numeric character references cannot be empty",MESSAGES[5]="Named character references must be known",MESSAGES[6]="Numeric character references cannot be disallowed",MESSAGES[7]="Numeric character references cannot be outside the permissible Unicode range"},function(module,exports,__webpack_require__){"use strict";
/*!
 * repeat-string <https://github.com/jonschlinkert/repeat-string>
 *
 * Copyright (c) 2014-2015, Jon Schlinkert.
 * Licensed under the MIT License.
 */var cache,res="";module.exports=function(str,num){if("string"!=typeof str)throw new TypeError("expected a string");if(1===num)return str;if(2===num)return str+str;var max=str.length*num;if(cache!==str||void 0===cache)cache=str,res="";else if(res.length>=max)return res.substr(0,max);for(;max>res.length&&num>1;)1&num&&(res+=str),num>>=1,str+=str;return res=(res+=str).substr(0,max)}},function(module,exports,__webpack_require__){"use strict";module.exports=function(value){var val=String(value),index=val.length;for(;"\n"===val.charAt(--index););return val.slice(0,index+1)}},function(module,exports,__webpack_require__){"use strict";module.exports=function(interruptors,tokenizers,ctx,params){var interruptor,config,fn,offset,bool,ignore,bools=["pedantic","commonmark"],count=bools.length,length=interruptors.length,index=-1;for(;++index<length;){for(interruptor=interruptors[index],config=interruptor[1]||{},fn=interruptor[0],offset=-1,ignore=!1;++offset<count;)if(void 0!==config[bool=bools[offset]]&&config[bool]!==ctx.options[bool]){ignore=!0;break}if(!ignore&&tokenizers[fn].apply(ctx,params))return!0}return!1}},function(module,exports,__webpack_require__){"use strict";var collapseWhiteSpace=__webpack_require__(206);module.exports=function(value){return collapseWhiteSpace(value).toLowerCase()}},,,,,,function(module,exports){ace.define("ace/mode/yaml_highlight_rules",["require","exports","module","ace/lib/oop","ace/mode/text_highlight_rules"],(function(acequire,exports,module){"use strict";var oop=acequire("../lib/oop"),TextHighlightRules=acequire("./text_highlight_rules").TextHighlightRules,YamlHighlightRules=function(){this.$rules={start:[{token:"comment",regex:"#.*$"},{token:"list.markup",regex:/^(?:-{3}|\.{3})\s*(?=#|$)/},{token:"list.markup",regex:/^\s*[\-?](?:$|\s)/},{token:"constant",regex:"!![\\w//]+"},{token:"constant.language",regex:"[&\\*][a-zA-Z0-9-_]+"},{token:["meta.tag","keyword"],regex:/^(\s*\w.*?)(:(?=\s|$))/},{token:["meta.tag","keyword"],regex:/(\w+?)(\s*:(?=\s|$))/},{token:"keyword.operator",regex:"<<\\w*:\\w*"},{token:"keyword.operator",regex:"-\\s*(?=[{])"},{token:"string",regex:'["](?:(?:\\\\.)|(?:[^"\\\\]))*?["]'},{token:"string",regex:/[|>][-+\d\s]*$/,onMatch:function(val,state,stack,line){var indent=/^\s*/.exec(line)[0];return stack.length<1?stack.push(this.next):stack[0]="mlString",stack.length<2?stack.push(indent.length):stack[1]=indent.length,this.token},next:"mlString"},{token:"string",regex:"['](?:(?:\\\\.)|(?:[^'\\\\]))*?[']"},{token:"constant.numeric",regex:/(\b|[+\-\.])[\d_]+(?:(?:\.[\d_]*)?(?:[eE][+\-]?[\d_]+)?)(?=[^\d-\w]|$)/},{token:"constant.numeric",regex:/[+\-]?\.inf\b|NaN\b|0x[\dA-Fa-f_]+|0b[10_]+/},{token:"constant.language.boolean",regex:"\\b(?:true|false|TRUE|FALSE|True|False|yes|no)\\b"},{token:"paren.lparen",regex:"[[({]"},{token:"paren.rparen",regex:"[\\])}]"},{token:"text",regex:/[^\s,:\[\]\{\}]+/}],mlString:[{token:"indent",regex:/^\s*$/},{token:"indent",regex:/^\s*/,onMatch:function(val,state,stack){return stack[1]>=val.length?(this.next="start",stack.splice(0)):this.next="mlString",this.token},next:"mlString"},{token:"string",regex:".+"}]},this.normalizeRules()};oop.inherits(YamlHighlightRules,TextHighlightRules),exports.YamlHighlightRules=YamlHighlightRules})),ace.define("ace/mode/matching_brace_outdent",["require","exports","module","ace/range"],(function(acequire,exports,module){"use strict";var Range=acequire("../range").Range,MatchingBraceOutdent=function(){};(function(){this.checkOutdent=function(line,input){return!!/^\s+$/.test(line)&&/^\s*\}/.test(input)},this.autoOutdent=function(doc,row){var match=doc.getLine(row).match(/^(\s*\})/);if(!match)return 0;var column=match[1].length,openBracePos=doc.findMatchingBracket({row:row,column:column});if(!openBracePos||openBracePos.row==row)return 0;var indent=this.$getIndent(doc.getLine(openBracePos.row));doc.replace(new Range(row,0,row,column-1),indent)},this.$getIndent=function(line){return line.match(/^\s*/)[0]}}).call(MatchingBraceOutdent.prototype),exports.MatchingBraceOutdent=MatchingBraceOutdent})),ace.define("ace/mode/folding/coffee",["require","exports","module","ace/lib/oop","ace/mode/folding/fold_mode","ace/range"],(function(acequire,exports,module){"use strict";var oop=acequire("../../lib/oop"),BaseFoldMode=acequire("./fold_mode").FoldMode,Range=acequire("../../range").Range,FoldMode=exports.FoldMode=function(){};oop.inherits(FoldMode,BaseFoldMode),function(){this.getFoldWidgetRange=function(session,foldStyle,row){var range=this.indentationBlock(session,row);if(range)return range;var re=/\S/,line=session.getLine(row),startLevel=line.search(re);if(-1!=startLevel&&"#"==line[startLevel]){for(var startColumn=line.length,maxRow=session.getLength(),startRow=row,endRow=row;++row<maxRow;){var level=(line=session.getLine(row)).search(re);if(-1!=level){if("#"!=line[level])break;endRow=row}}if(endRow>startRow){var endColumn=session.getLine(endRow).length;return new Range(startRow,startColumn,endRow,endColumn)}}},this.getFoldWidget=function(session,foldStyle,row){var line=session.getLine(row),indent=line.search(/\S/),next=session.getLine(row+1),prev=session.getLine(row-1),prevIndent=prev.search(/\S/),nextIndent=next.search(/\S/);if(-1==indent)return session.foldWidgets[row-1]=-1!=prevIndent&&prevIndent<nextIndent?"start":"","";if(-1==prevIndent){if(indent==nextIndent&&"#"==line[indent]&&"#"==next[indent])return session.foldWidgets[row-1]="",session.foldWidgets[row+1]="","start"}else if(prevIndent==indent&&"#"==line[indent]&&"#"==prev[indent]&&-1==session.getLine(row-2).search(/\S/))return session.foldWidgets[row-1]="start",session.foldWidgets[row+1]="","";return session.foldWidgets[row-1]=-1!=prevIndent&&prevIndent<indent?"start":"",indent<nextIndent?"start":""}}.call(FoldMode.prototype)})),ace.define("ace/mode/yaml",["require","exports","module","ace/lib/oop","ace/mode/text","ace/mode/yaml_highlight_rules","ace/mode/matching_brace_outdent","ace/mode/folding/coffee"],(function(acequire,exports,module){"use strict";var oop=acequire("../lib/oop"),TextMode=acequire("./text").Mode,YamlHighlightRules=acequire("./yaml_highlight_rules").YamlHighlightRules,MatchingBraceOutdent=acequire("./matching_brace_outdent").MatchingBraceOutdent,FoldMode=acequire("./folding/coffee").FoldMode,Mode=function(){this.HighlightRules=YamlHighlightRules,this.$outdent=new MatchingBraceOutdent,this.foldingRules=new FoldMode,this.$behaviour=this.$defaultBehaviour};oop.inherits(Mode,TextMode),function(){this.lineCommentStart=["#","//"],this.getNextLineIndent=function(state,line,tab){var indent=this.$getIndent(line);"start"==state&&(line.match(/^.*[\{\(\[]\s*$/)&&(indent+=tab));return indent},this.checkOutdent=function(state,line,input){return this.$outdent.checkOutdent(line,input)},this.autoOutdent=function(state,doc,row){this.$outdent.autoOutdent(doc,row)},this.$id="ace/mode/yaml"}.call(Mode.prototype),exports.Mode=Mode}))},function(module,exports){ace.define("ace/theme/textmate",["require","exports","module","ace/lib/dom"],(function(acequire,exports,module){"use strict";exports.isDark=!1,exports.cssClass="ace-tm",exports.cssText='.ace-tm .ace_gutter {background: #f0f0f0;color: #333;}.ace-tm .ace_print-margin {width: 1px;background: #e8e8e8;}.ace-tm .ace_fold {background-color: #6B72E6;}.ace-tm {background-color: #FFFFFF;color: black;}.ace-tm .ace_cursor {color: black;}.ace-tm .ace_invisible {color: rgb(191, 191, 191);}.ace-tm .ace_storage,.ace-tm .ace_keyword {color: blue;}.ace-tm .ace_constant {color: rgb(197, 6, 11);}.ace-tm .ace_constant.ace_buildin {color: rgb(88, 72, 246);}.ace-tm .ace_constant.ace_language {color: rgb(88, 92, 246);}.ace-tm .ace_constant.ace_library {color: rgb(6, 150, 14);}.ace-tm .ace_invalid {background-color: rgba(255, 0, 0, 0.1);color: red;}.ace-tm .ace_support.ace_function {color: rgb(60, 76, 114);}.ace-tm .ace_support.ace_constant {color: rgb(6, 150, 14);}.ace-tm .ace_support.ace_type,.ace-tm .ace_support.ace_class {color: rgb(109, 121, 222);}.ace-tm .ace_keyword.ace_operator {color: rgb(104, 118, 135);}.ace-tm .ace_string {color: rgb(3, 106, 7);}.ace-tm .ace_comment {color: rgb(76, 136, 107);}.ace-tm .ace_comment.ace_doc {color: rgb(0, 102, 255);}.ace-tm .ace_comment.ace_doc.ace_tag {color: rgb(128, 159, 191);}.ace-tm .ace_constant.ace_numeric {color: rgb(0, 0, 205);}.ace-tm .ace_variable {color: rgb(49, 132, 149);}.ace-tm .ace_xml-pe {color: rgb(104, 104, 91);}.ace-tm .ace_entity.ace_name.ace_function {color: #0000A2;}.ace-tm .ace_heading {color: rgb(12, 7, 255);}.ace-tm .ace_list {color:rgb(185, 6, 144);}.ace-tm .ace_meta.ace_tag {color:rgb(0, 22, 142);}.ace-tm .ace_string.ace_regex {color: rgb(255, 0, 0)}.ace-tm .ace_marker-layer .ace_selection {background: rgb(181, 213, 255);}.ace-tm.ace_multiselect .ace_selection.ace_start {box-shadow: 0 0 3px 0px white;}.ace-tm .ace_marker-layer .ace_step {background: rgb(252, 255, 0);}.ace-tm .ace_marker-layer .ace_stack {background: rgb(164, 229, 101);}.ace-tm .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid rgb(192, 192, 192);}.ace-tm .ace_marker-layer .ace_active-line {background: rgba(0, 0, 0, 0.07);}.ace-tm .ace_gutter-active-line {background-color : #dcdcdc;}.ace-tm .ace_marker-layer .ace_selected-word {background: rgb(250, 250, 255);border: 1px solid rgb(200, 200, 250);}.ace-tm .ace_indent-guide {background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") right repeat-y;}',acequire("../lib/dom").importCssString(exports.cssText,exports.cssClass)}))},function(module,exports,__webpack_require__){(function(process){function normalizeArray(parts,allowAboveRoot){for(var up=0,i=parts.length-1;i>=0;i--){var last=parts[i];"."===last?parts.splice(i,1):".."===last?(parts.splice(i,1),up++):up&&(parts.splice(i,1),up--)}if(allowAboveRoot)for(;up--;up)parts.unshift("..");return parts}function filter(xs,f){if(xs.filter)return xs.filter(f);for(var res=[],i=0;i<xs.length;i++)f(xs[i],i,xs)&&res.push(xs[i]);return res}exports.resolve=function(){for(var resolvedPath="",resolvedAbsolute=!1,i=arguments.length-1;i>=-1&&!resolvedAbsolute;i--){var path=i>=0?arguments[i]:process.cwd();if("string"!=typeof path)throw new TypeError("Arguments to path.resolve must be strings");path&&(resolvedPath=path+"/"+resolvedPath,resolvedAbsolute="/"===path.charAt(0))}return(resolvedAbsolute?"/":"")+(resolvedPath=normalizeArray(filter(resolvedPath.split("/"),(function(p){return!!p})),!resolvedAbsolute).join("/"))||"."},exports.normalize=function(path){var isAbsolute=exports.isAbsolute(path),trailingSlash="/"===substr(path,-1);return(path=normalizeArray(filter(path.split("/"),(function(p){return!!p})),!isAbsolute).join("/"))||isAbsolute||(path="."),path&&trailingSlash&&(path+="/"),(isAbsolute?"/":"")+path},exports.isAbsolute=function(path){return"/"===path.charAt(0)},exports.join=function(){var paths=Array.prototype.slice.call(arguments,0);return exports.normalize(filter(paths,(function(p,index){if("string"!=typeof p)throw new TypeError("Arguments to path.join must be strings");return p})).join("/"))},exports.relative=function(from,to){function trim(arr){for(var start=0;start<arr.length&&""===arr[start];start++);for(var end=arr.length-1;end>=0&&""===arr[end];end--);return start>end?[]:arr.slice(start,end-start+1)}from=exports.resolve(from).substr(1),to=exports.resolve(to).substr(1);for(var fromParts=trim(from.split("/")),toParts=trim(to.split("/")),length=Math.min(fromParts.length,toParts.length),samePartsLength=length,i=0;i<length;i++)if(fromParts[i]!==toParts[i]){samePartsLength=i;break}var outputParts=[];for(i=samePartsLength;i<fromParts.length;i++)outputParts.push("..");return(outputParts=outputParts.concat(toParts.slice(samePartsLength))).join("/")},exports.sep="/",exports.delimiter=":",exports.dirname=function(path){if("string"!=typeof path&&(path+=""),0===path.length)return".";for(var code=path.charCodeAt(0),hasRoot=47===code,end=-1,matchedSlash=!0,i=path.length-1;i>=1;--i)if(47===(code=path.charCodeAt(i))){if(!matchedSlash){end=i;break}}else matchedSlash=!1;return-1===end?hasRoot?"/":".":hasRoot&&1===end?"/":path.slice(0,end)},exports.basename=function(path,ext){var f=function(path){"string"!=typeof path&&(path+="");var i,start=0,end=-1,matchedSlash=!0;for(i=path.length-1;i>=0;--i)if(47===path.charCodeAt(i)){if(!matchedSlash){start=i+1;break}}else-1===end&&(matchedSlash=!1,end=i+1);return-1===end?"":path.slice(start,end)}(path);return ext&&f.substr(-1*ext.length)===ext&&(f=f.substr(0,f.length-ext.length)),f},exports.extname=function(path){"string"!=typeof path&&(path+="");for(var startDot=-1,startPart=0,end=-1,matchedSlash=!0,preDotState=0,i=path.length-1;i>=0;--i){var code=path.charCodeAt(i);if(47!==code)-1===end&&(matchedSlash=!1,end=i+1),46===code?-1===startDot?startDot=i:1!==preDotState&&(preDotState=1):-1!==startDot&&(preDotState=-1);else if(!matchedSlash){startPart=i+1;break}}return-1===startDot||-1===end||0===preDotState||1===preDotState&&startDot===end-1&&startDot===startPart+1?"":path.slice(startDot,end)};var substr="b"==="ab".substr(-1)?function(str,start,len){return str.substr(start,len)}:function(str,start,len){return start<0&&(start=str.length+start),str.substr(start,len)}}).call(this,__webpack_require__(63))},function(module,exports,__webpack_require__){"use strict";module.exports=function(character){var code="string"==typeof character?character.charCodeAt(0):character;return code>=97&&code<=122||code>=65&&code<=90}},function(module,exports,__webpack_require__){"use strict";module.exports={position:!0,gfm:!0,commonmark:!1,footnotes:!1,pedantic:!1,blocks:__webpack_require__(190)}},function(module,exports,__webpack_require__){"use strict";module.exports=function(value){var size,index=0,indent=0,character=value.charAt(index),stops={};for(;character in characters;)indent+=size=characters[character],size>1&&(indent=Math.floor(indent/size)*size),stops[indent]=index,character=value.charAt(++index);return{indent:indent,stops:stops}};var characters={" ":1,"\t":4}},function(module,exports,__webpack_require__){"use strict";var openTag="<[A-Za-z][A-Za-z0-9\\-]*(?:\\s+[a-zA-Z_:][a-zA-Z0-9:._-]*(?:\\s*=\\s*(?:[^\"'=<>`\\u0000-\\u0020]+|'[^']*'|\"[^\"]*\"))?)*\\s*\\/?>",closeTag="<\\/[A-Za-z][A-Za-z0-9\\-]*\\s*>";exports.openCloseTag=new RegExp("^(?:"+openTag+"|"+closeTag+")"),exports.tag=new RegExp("^(?:"+openTag+"|"+closeTag+"|\x3c!----\x3e|\x3c!--(?:-?[^>-])(?:-?[^-])*--\x3e|<[?].*?[?]>|<![A-Za-z]+\\s+[^>]*>|<!\\[CDATA\\[[\\s\\S]*?\\]\\]>)")},function(module,exports,__webpack_require__){"use strict";module.exports=function(value,fromIndex){return value.indexOf("<",fromIndex)}},function(module,exports,__webpack_require__){"use strict";module.exports=function(value,fromIndex){var link=value.indexOf("[",fromIndex),image=value.indexOf("![",fromIndex);if(-1===image)return link;return link<image?link:image}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var react_1=__webpack_require__(2),useIsomorphicLayoutEffect="undefined"!=typeof window?react_1.useLayoutEffect:react_1.useEffect;exports.default=useIsomorphicLayoutEffect},,,,,,,,,,,,,,,,,,,function(module,exports,__webpack_require__){"use strict";var extend=__webpack_require__(162),bail=__webpack_require__(163),vfile=__webpack_require__(164),trough=__webpack_require__(170),string=__webpack_require__(171),func=__webpack_require__(172),plain=__webpack_require__(173);module.exports=function unified(){var attachers=[],transformers=trough(),namespace={},frozen=!1,freezeIndex=-1;return processor.data=function(key,value){if(string(key))return 2===arguments.length?(assertUnfrozen("data",frozen),namespace[key]=value,processor):own.call(namespace,key)&&namespace[key]||null;if(key)return assertUnfrozen("data",frozen),namespace=key,processor;return namespace},processor.freeze=freeze,processor.attachers=attachers,processor.use=function(value){var settings;if(assertUnfrozen("use",frozen),null==value);else if(func(value))addPlugin.apply(null,arguments);else{if("object"!=typeof value)throw new Error("Expected usable value, not `"+value+"`");"length"in value?addList(value):addPreset(value)}settings&&(namespace.settings=extend(namespace.settings||{},settings));return processor;function addPreset(result){addList(result.plugins),result.settings&&(settings=extend(settings||{},result.settings))}function add(value){if(func(value))addPlugin(value);else{if("object"!=typeof value)throw new Error("Expected usable value, not `"+value+"`");"length"in value?addPlugin.apply(null,value):addPreset(value)}}function addList(plugins){var length,index;if(null==plugins);else{if("object"!=typeof plugins||!("length"in plugins))throw new Error("Expected a list of plugins, not `"+plugins+"`");for(length=plugins.length,index=-1;++index<length;)add(plugins[index])}}function addPlugin(plugin,value){var entry=find(plugin);entry?(plain(entry[1])&&plain(value)&&(value=extend(entry[1],value)),entry[1]=value):attachers.push(slice.call(arguments))}},processor.parse=function(doc){var Parser,file=vfile(doc);if(freeze(),assertParser("parse",Parser=processor.Parser),newable(Parser))return new Parser(String(file),file).parse();return Parser(String(file),file)},processor.stringify=function(node,doc){var Compiler,file=vfile(doc);if(freeze(),assertCompiler("stringify",Compiler=processor.Compiler),assertNode(node),newable(Compiler))return new Compiler(node,file).compile();return Compiler(node,file)},processor.run=run,processor.runSync=function(node,file){var result,complete=!1;return run(node,file,(function(err,tree){complete=!0,bail(err),result=tree})),assertDone("runSync","run",complete),result},processor.process=process,processor.processSync=function(doc){var file,complete=!1;return freeze(),assertParser("processSync",processor.Parser),assertCompiler("processSync",processor.Compiler),process(file=vfile(doc),(function(err){complete=!0,bail(err)})),assertDone("processSync","process",complete),file},processor;function processor(){for(var destination=unified(),length=attachers.length,index=-1;++index<length;)destination.use.apply(null,attachers[index]);return destination.data(extend(!0,{},namespace)),destination}function freeze(){var values,plugin,options,transformer;if(frozen)return processor;for(;++freezeIndex<attachers.length;)plugin=(values=attachers[freezeIndex])[0],null,!1!==(options=values[1])&&(!0===options&&(values[1]=void 0),transformer=plugin.apply(processor,values.slice(1)),func(transformer)&&transformers.use(transformer));return frozen=!0,freezeIndex=1/0,processor}function find(plugin){for(var entry,length=attachers.length,index=-1;++index<length;)if((entry=attachers[index])[0]===plugin)return entry}function run(node,file,cb){if(assertNode(node),freeze(),!cb&&func(file)&&(cb=file,file=null),!cb)return new Promise(executor);function executor(resolve,reject){transformers.run(node,vfile(file),(function(err,tree,file){tree=tree||node,err?reject(err):resolve?resolve(tree):cb(null,tree,file)}))}executor(null,cb)}function process(doc,cb){if(freeze(),assertParser("process",processor.Parser),assertCompiler("process",processor.Compiler),!cb)return new Promise(executor);function executor(resolve,reject){var file=vfile(doc);pipeline.run(processor,{file:file},(function(err){err?reject(err):resolve?resolve(file):cb(null,file)}))}executor(null,cb)}}().freeze();var slice=[].slice,own={}.hasOwnProperty,pipeline=trough().use((function(p,ctx){ctx.tree=p.parse(ctx.file)})).use((function(p,ctx,next){p.run(ctx.tree,ctx.file,(function(err,tree,file){err?next(err):(ctx.tree=tree,ctx.file=file,next())}))})).use((function(p,ctx){ctx.file.contents=p.stringify(ctx.tree,ctx.file)}));function newable(value){return func(value)&&function(value){var key;for(key in value)return!0;return!1}(value.prototype)}function assertParser(name,Parser){if(!func(Parser))throw new Error("Cannot `"+name+"` without `Parser`")}function assertCompiler(name,Compiler){if(!func(Compiler))throw new Error("Cannot `"+name+"` without `Compiler`")}function assertUnfrozen(name,frozen){if(frozen)throw new Error("Cannot invoke `"+name+"` on a frozen processor.\nCreate a new processor first, by invoking it: use `processor()` instead of `processor`.")}function assertNode(node){if(!node||!string(node.type))throw new Error("Expected node, got `"+node+"`")}function assertDone(name,asyncName,complete){if(!complete)throw new Error("`"+name+"` finished async. Use `"+asyncName+"` instead")}},function(module,exports,__webpack_require__){"use strict";var hasOwn=Object.prototype.hasOwnProperty,toStr=Object.prototype.toString,defineProperty=Object.defineProperty,gOPD=Object.getOwnPropertyDescriptor,isArray=function(arr){return"function"==typeof Array.isArray?Array.isArray(arr):"[object Array]"===toStr.call(arr)},isPlainObject=function(obj){if(!obj||"[object Object]"!==toStr.call(obj))return!1;var key,hasOwnConstructor=hasOwn.call(obj,"constructor"),hasIsPrototypeOf=obj.constructor&&obj.constructor.prototype&&hasOwn.call(obj.constructor.prototype,"isPrototypeOf");if(obj.constructor&&!hasOwnConstructor&&!hasIsPrototypeOf)return!1;for(key in obj);return void 0===key||hasOwn.call(obj,key)},setProperty=function(target,options){defineProperty&&"__proto__"===options.name?defineProperty(target,options.name,{enumerable:!0,configurable:!0,value:options.newValue,writable:!0}):target[options.name]=options.newValue},getProperty=function(obj,name){if("__proto__"===name){if(!hasOwn.call(obj,name))return;if(gOPD)return gOPD(obj,name).value}return obj[name]};module.exports=function extend(){var options,name,src,copy,copyIsArray,clone,target=arguments[0],i=1,length=arguments.length,deep=!1;for("boolean"==typeof target&&(deep=target,target=arguments[1]||{},i=2),(null==target||"object"!=typeof target&&"function"!=typeof target)&&(target={});i<length;++i)if(null!=(options=arguments[i]))for(name in options)src=getProperty(target,name),target!==(copy=getProperty(options,name))&&(deep&&copy&&(isPlainObject(copy)||(copyIsArray=isArray(copy)))?(copyIsArray?(copyIsArray=!1,clone=src&&isArray(src)?src:[]):clone=src&&isPlainObject(src)?src:{},setProperty(target,{name:name,newValue:extend(deep,clone,copy)})):void 0!==copy&&setProperty(target,{name:name,newValue:copy}));return target}},function(module,exports,__webpack_require__){"use strict";module.exports=function(err){if(err)throw err}},function(module,exports,__webpack_require__){"use strict";var VMessage=__webpack_require__(165),VFile=__webpack_require__(167);module.exports=VFile;var proto=VFile.prototype;function message(reason,position,origin){var filePath=this.path,message=new VMessage(reason,position,origin);return filePath&&(message.name=filePath+":"+message.name,message.file=filePath),message.fatal=!1,this.messages.push(message),message}proto.message=message,proto.info=function(){var message=this.message.apply(this,arguments);return message.fatal=null,message},proto.fail=function(){var message=this.message.apply(this,arguments);throw message.fatal=!0,message},proto.warn=message},function(module,exports,__webpack_require__){"use strict";var stringify=__webpack_require__(166);function VMessagePrototype(){}module.exports=VMessage,VMessagePrototype.prototype=Error.prototype,VMessage.prototype=new VMessagePrototype;var proto=VMessage.prototype;function VMessage(reason,position,origin){var parts,range,location;"string"==typeof position&&(origin=position,position=null),parts=function(origin){var index,result=[null,null];"string"==typeof origin&&(-1===(index=origin.indexOf(":"))?result[1]=origin:(result[0]=origin.slice(0,index),result[1]=origin.slice(index+1)));return result}(origin),range=stringify(position)||"1:1",location={start:{line:null,column:null},end:{line:null,column:null}},position&&position.position&&(position=position.position),position&&(position.start?(location=position,position=position.start):location.start=position),reason.stack&&(this.stack=reason.stack,reason=reason.message),this.message=reason,this.name=range,this.reason=reason,this.line=position?position.line:null,this.column=position?position.column:null,this.location=location,this.source=parts[0],this.ruleId=parts[1]}proto.file="",proto.name="",proto.reason="",proto.message="",proto.stack="",proto.fatal=null,proto.column=null,proto.line=null},function(module,exports,__webpack_require__){"use strict";var own={}.hasOwnProperty;function position(pos){return pos&&"object"==typeof pos||(pos={}),index(pos.line)+":"+index(pos.column)}function location(loc){return loc&&"object"==typeof loc||(loc={}),position(loc.start)+"-"+position(loc.end)}function index(value){return value&&"number"==typeof value?value:1}module.exports=function(value){if(!value||"object"!=typeof value)return null;if(own.call(value,"position")||own.call(value,"type"))return location(value.position);if(own.call(value,"start")||own.call(value,"end"))return location(value);if(own.call(value,"line")||own.call(value,"column"))return position(value);return null}},function(module,exports,__webpack_require__){"use strict";(function(process){var path=__webpack_require__(135),replace=__webpack_require__(168),buffer=__webpack_require__(169);module.exports=VFile;var own={}.hasOwnProperty,proto=VFile.prototype;proto.toString=function(encoding){var value=this.contents||"";return buffer(value)?value.toString(encoding):String(value)};var order=["history","path","basename","stem","extname","dirname"];function VFile(options){var prop,index,length;if(options){if("string"==typeof options||buffer(options))options={contents:options};else if("message"in options&&"messages"in options)return options}else options={};if(!(this instanceof VFile))return new VFile(options);for(this.data={},this.messages=[],this.history=[],this.cwd=process.cwd(),index=-1,length=order.length;++index<length;)prop=order[index],own.call(options,prop)&&(this[prop]=options[prop]);for(prop in options)-1===order.indexOf(prop)&&(this[prop]=options[prop])}function assertPart(part,name){if(-1!==part.indexOf(path.sep))throw new Error("`"+name+"` cannot be a path: did not expect `"+path.sep+"`")}function assertNonEmpty(part,name){if(!part)throw new Error("`"+name+"` cannot be empty")}function assertPath(path,name){if(!path)throw new Error("Setting `"+name+"` requires `path` to be set too")}Object.defineProperty(proto,"path",{get:function(){return this.history[this.history.length-1]},set:function(path){assertNonEmpty(path,"path"),path!==this.path&&this.history.push(path)}}),Object.defineProperty(proto,"dirname",{get:function(){return"string"==typeof this.path?path.dirname(this.path):void 0},set:function(dirname){assertPath(this.path,"dirname"),this.path=path.join(dirname||"",this.basename)}}),Object.defineProperty(proto,"basename",{get:function(){return"string"==typeof this.path?path.basename(this.path):void 0},set:function(basename){assertNonEmpty(basename,"basename"),assertPart(basename,"basename"),this.path=path.join(this.dirname||"",basename)}}),Object.defineProperty(proto,"extname",{get:function(){return"string"==typeof this.path?path.extname(this.path):void 0},set:function(extname){var ext=extname||"";if(assertPart(ext,"extname"),assertPath(this.path,"extname"),ext){if("."!==ext.charAt(0))throw new Error("`extname` must start with `.`");if(-1!==ext.indexOf(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=replace(this.path,ext)}}),Object.defineProperty(proto,"stem",{get:function(){return"string"==typeof this.path?path.basename(this.path,this.extname):void 0},set:function(stem){assertNonEmpty(stem,"stem"),assertPart(stem,"stem"),this.path=path.join(this.dirname||"",stem+(this.extname||""))}})}).call(this,__webpack_require__(63))},function(module,exports,__webpack_require__){"use strict";var path=__webpack_require__(135);module.exports=function(npath,ext){if("string"!=typeof npath)return npath;if(0===npath.length)return npath;var nFileName=path.basename(npath,path.extname(npath))+ext;return path.join(path.dirname(npath),nFileName)}},function(module,exports){function isBuffer(obj){return!!obj.constructor&&"function"==typeof obj.constructor.isBuffer&&obj.constructor.isBuffer(obj)}
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
module.exports=function(obj){return null!=obj&&(isBuffer(obj)||function(obj){return"function"==typeof obj.readFloatLE&&"function"==typeof obj.slice&&isBuffer(obj.slice(0,0))}(obj)||!!obj._isBuffer)}},function(module,exports,__webpack_require__){"use strict";module.exports=function(){var fns=[],middleware={};return middleware.run=function(){var index=-1,input=slice.call(arguments,0,-1),done=arguments[arguments.length-1];if("function"!=typeof done)throw new Error("Expected function as last argument, not "+done);function next(err){var fn=fns[++index],params=slice.call(arguments,0),values=params.slice(1),length=input.length,pos=-1;if(err)done(err);else{for(;++pos<length;)null!==values[pos]&&void 0!==values[pos]||(values[pos]=input[pos]);input=values,fn?wrap(fn,next).apply(null,input):done.apply(null,[null].concat(input))}}next.apply(null,[null].concat(input))},middleware.use=function(fn){if("function"!=typeof fn)throw new Error("Expected `fn` to be a function, not "+fn);return fns.push(fn),middleware},middleware};var slice=[].slice;function wrap(fn,next){var invoked;return function(){var result,params=slice.call(arguments,0),callback=fn.length>params.length;callback&&params.push(done);try{result=fn.apply(null,params)}catch(err){if(callback&&invoked)throw err;return done(err)}callback||(result&&"function"==typeof result.then?result.then(then,done):result instanceof Error?done(result):then(result))};function done(){invoked||(invoked=!0,next.apply(null,arguments))}function then(value){done(null,value)}}},function(module,exports){var toString=Object.prototype.toString;module.exports=function(obj){return"[object String]"===toString.call(obj)}},function(module,exports){module.exports=function(fn){return"[object Function]"===Object.prototype.toString.call(fn)}},function(module,exports,__webpack_require__){"use strict";var toString=Object.prototype.toString;module.exports=function(x){var prototype;return"[object Object]"===toString.call(x)&&(null===(prototype=Object.getPrototypeOf(x))||prototype===Object.getPrototypeOf({}))}},function(module,exports,__webpack_require__){"use strict";var unherit=__webpack_require__(175),xtend=__webpack_require__(111),Parser=__webpack_require__(177);function parse(options){var Local=unherit(Parser);Local.prototype.options=xtend(Local.prototype.options,this.data("settings"),options),this.Parser=Local}module.exports=parse,parse.Parser=Parser},function(module,exports,__webpack_require__){"use strict";
/**
 * @author Titus Wormer
 * @copyright 2015 Titus Wormer
 * @license MIT
 * @module unherit
 * @fileoverview Create a custom constructor which can be modified
 *   without affecting the original class.
 */var xtend=__webpack_require__(111),inherits=__webpack_require__(176);module.exports=function(Super){var result,key,value;for(key in inherits(Of,Super),inherits(From,Of),result=Of.prototype)(value=result[key])&&"object"==typeof value&&(result[key]="concat"in value?value.concat():xtend(value));return Of;function From(parameters){return Super.apply(this,parameters)}function Of(){return this instanceof Of?Super.apply(this,arguments):new From(arguments)}}},function(module,exports){"function"==typeof Object.create?module.exports=function(ctor,superCtor){superCtor&&(ctor.super_=superCtor,ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:!1,writable:!0,configurable:!0}}))}:module.exports=function(ctor,superCtor){if(superCtor){ctor.super_=superCtor;var TempCtor=function(){};TempCtor.prototype=superCtor.prototype,ctor.prototype=new TempCtor,ctor.prototype.constructor=ctor}}},function(module,exports,__webpack_require__){"use strict";var xtend=__webpack_require__(111),toggle=__webpack_require__(178),vfileLocation=__webpack_require__(179),unescape=__webpack_require__(180),decode=__webpack_require__(181),tokenizer=__webpack_require__(187);function Parser(doc,file){this.file=file,this.offset={},this.options=xtend(this.options),this.setOptions({}),this.inList=!1,this.inBlock=!1,this.inLink=!1,this.atStart=!0,this.toOffset=vfileLocation(file).toOffset,this.unescape=unescape(this,"escape"),this.decode=decode(this)}module.exports=Parser;var proto=Parser.prototype;function keys(value){var key,result=[];for(key in value)result.push(key);return result}proto.setOptions=__webpack_require__(188),proto.parse=__webpack_require__(191),proto.options=__webpack_require__(137),proto.exitStart=toggle("atStart",!0),proto.enterList=toggle("inList",!1),proto.enterLink=toggle("inLink",!1),proto.enterBlock=toggle("inBlock",!1),proto.interruptParagraph=[["thematicBreak"],["atxHeading"],["fencedCode"],["blockquote"],["html"],["setextHeading",{commonmark:!1}],["definition",{commonmark:!1}],["footnote",{commonmark:!1}]],proto.interruptList=[["atxHeading",{pedantic:!1}],["fencedCode",{pedantic:!1}],["thematicBreak",{pedantic:!1}],["definition",{commonmark:!1}],["footnote",{commonmark:!1}]],proto.interruptBlockquote=[["indentedCode",{commonmark:!0}],["fencedCode",{commonmark:!0}],["atxHeading",{commonmark:!0}],["setextHeading",{commonmark:!0}],["thematicBreak",{commonmark:!0}],["html",{commonmark:!0}],["list",{commonmark:!0}],["definition",{commonmark:!1}],["footnote",{commonmark:!1}]],proto.blockTokenizers={newline:__webpack_require__(195),indentedCode:__webpack_require__(196),fencedCode:__webpack_require__(197),blockquote:__webpack_require__(198),atxHeading:__webpack_require__(199),thematicBreak:__webpack_require__(200),list:__webpack_require__(201),setextHeading:__webpack_require__(203),html:__webpack_require__(204),footnote:__webpack_require__(205),definition:__webpack_require__(207),table:__webpack_require__(208),paragraph:__webpack_require__(209)},proto.inlineTokenizers={escape:__webpack_require__(210),autoLink:__webpack_require__(212),url:__webpack_require__(213),html:__webpack_require__(215),link:__webpack_require__(216),reference:__webpack_require__(217),strong:__webpack_require__(218),emphasis:__webpack_require__(220),deletion:__webpack_require__(223),code:__webpack_require__(225),break:__webpack_require__(227),text:__webpack_require__(229)},proto.blockMethods=keys(proto.blockTokenizers),proto.inlineMethods=keys(proto.inlineTokenizers),proto.tokenizeBlock=tokenizer("block"),proto.tokenizeInline=tokenizer("inline"),proto.tokenizeFactory=tokenizer},function(module,exports,__webpack_require__){"use strict";
/**
 * @author Titus Wormer
 * @copyright 2016 Titus Wormer
 * @license MIT
 * @module state-toggle
 * @fileoverview Enter/exit a state.
 */module.exports=function(key,state,ctx){return function(){var context=ctx||this,current=context[key];return context[key]=!state,function(){context[key]=current}}}},function(module,exports,__webpack_require__){"use strict";function offsetToPositionFactory(indices){return function(offset){var index=-1,length=indices.length;if(offset<0)return{};for(;++index<length;)if(indices[index]>offset)return{line:index+1,column:offset-(indices[index-1]||0)+1,offset:offset};return{}}}function positionToOffsetFactory(indices){return function(position){var line=position&&position.line,column=position&&position.column;if(!isNaN(line)&&!isNaN(column)&&line-1 in indices)return(indices[line-2]||0)+column-1||0;return-1}}module.exports=function(file){var contents=function(value){var result=[],index=value.indexOf("\n");for(;-1!==index;)result.push(index+1),index=value.indexOf("\n",index+1);return result.push(value.length+1),result}(String(file));return{toPosition:offsetToPositionFactory(contents),toOffset:positionToOffsetFactory(contents)}}},function(module,exports,__webpack_require__){"use strict";module.exports=function(ctx,key){return function(value){var character,prev=0,index=value.indexOf("\\"),escape=ctx[key],queue=[];for(;-1!==index;)queue.push(value.slice(prev,index)),prev=index+1,(character=value.charAt(prev))&&-1!==escape.indexOf(character)||queue.push("\\"),index=value.indexOf("\\",prev);return queue.push(value.slice(prev)),queue.join("")}}},function(module,exports,__webpack_require__){"use strict";var xtend=__webpack_require__(111),entities=__webpack_require__(123);module.exports=function(ctx){return decoder.raw=function(value,position,options){return entities(value,xtend(options,{position:normalize(position),warning:handleWarning}))},decoder;function normalize(position){for(var offsets=ctx.offset,line=position.line,result=[];++line&&line in offsets;)result.push((offsets[line]||0)+1);return{start:position,indent:result}}function handleWarning(reason,position,code){3!==code&&ctx.file.message(reason,position)}function decoder(value,position,handler){entities(value,{position:normalize(position),warning:handleWarning,text:handler,reference:handler,textContext:ctx,referenceContext:ctx})}}},function(module){module.exports=JSON.parse('{"AElig":"Ã","AMP":"&","Aacute":"Ã","Acirc":"Ã","Agrave":"Ã","Aring":"Ã","Atilde":"Ã","Auml":"Ã","COPY":"Â©","Ccedil":"Ã","ETH":"Ã","Eacute":"Ã","Ecirc":"Ã","Egrave":"Ã","Euml":"Ã","GT":">","Iacute":"Ã","Icirc":"Ã","Igrave":"Ã","Iuml":"Ã","LT":"<","Ntilde":"Ã","Oacute":"Ã","Ocirc":"Ã","Ograve":"Ã","Oslash":"Ã","Otilde":"Ã","Ouml":"Ã","QUOT":"\\"","REG":"Â®","THORN":"Ã","Uacute":"Ã","Ucirc":"Ã","Ugrave":"Ã","Uuml":"Ã","Yacute":"Ã","aacute":"Ã¡","acirc":"Ã¢","acute":"Â´","aelig":"Ã¦","agrave":"Ã ","amp":"&","aring":"Ã¥","atilde":"Ã£","auml":"Ã¤","brvbar":"Â¦","ccedil":"Ã§","cedil":"Â¸","cent":"Â¢","copy":"Â©","curren":"Â¤","deg":"Â°","divide":"Ã·","eacute":"Ã©","ecirc":"Ãª","egrave":"Ã¨","eth":"Ã°","euml":"Ã«","frac12":"Â½","frac14":"Â¼","frac34":"Â¾","gt":">","iacute":"Ã­","icirc":"Ã®","iexcl":"Â¡","igrave":"Ã¬","iquest":"Â¿","iuml":"Ã¯","laquo":"Â«","lt":"<","macr":"Â¯","micro":"Âµ","middot":"Â·","nbsp":"Â ","not":"Â¬","ntilde":"Ã±","oacute":"Ã³","ocirc":"Ã´","ograve":"Ã²","ordf":"Âª","ordm":"Âº","oslash":"Ã¸","otilde":"Ãµ","ouml":"Ã¶","para":"Â¶","plusmn":"Â±","pound":"Â£","quot":"\\"","raquo":"Â»","reg":"Â®","sect":"Â§","shy":"Â­","sup1":"Â¹","sup2":"Â²","sup3":"Â³","szlig":"Ã","thorn":"Ã¾","times":"Ã","uacute":"Ãº","ucirc":"Ã»","ugrave":"Ã¹","uml":"Â¨","uuml":"Ã¼","yacute":"Ã½","yen":"Â¥","yuml":"Ã¿"}')},function(module){module.exports=JSON.parse('{"0":"ï¿½","128":"â¬","130":"â","131":"Æ","132":"â","133":"â¦","134":"â ","135":"â¡","136":"Ë","137":"â°","138":"Å ","139":"â¹","140":"Å","142":"Å½","145":"â","146":"â","147":"â","148":"â","149":"â¢","150":"â","151":"â","152":"Ë","153":"â¢","154":"Å¡","155":"âº","156":"Å","158":"Å¾","159":"Å¸"}')},function(module,exports,__webpack_require__){"use strict";module.exports=function(character){var code="string"==typeof character?character.charCodeAt(0):character;return code>=97&&code<=102||code>=65&&code<=70||code>=48&&code<=57}},function(module,exports,__webpack_require__){"use strict";var alphabetical=__webpack_require__(136),decimal=__webpack_require__(115);module.exports=function(character){return alphabetical(character)||decimal(character)}},function(module,exports,__webpack_require__){"use strict";var el;module.exports=function(characters){var char,entity="&"+characters+";";if((el=el||document.createElement("i")).innerHTML=entity,";"===(char=el.textContent).slice(-1)&&"semi"!==characters)return!1;return char!==entity&&char}},function(module,exports,__webpack_require__){"use strict";module.exports=function(type){return function(value,location){var index,length,method,name,matched,valueLength,self=this,offset=self.offset,tokens=[],methods=self[type+"Methods"],tokenizers=self[type+"Tokenizers"],line=location.line,column=location.column;if(!value)return tokens;eat.now=now,eat.file=self.file,updatePosition("");for(;value;){for(index=-1,length=methods.length,matched=!1;++index<length&&(name=methods[index],!(method=tokenizers[name])||method.onlyAtStart&&!self.atStart||method.notInList&&self.inList||method.notInBlock&&self.inBlock||method.notInLink&&self.inLink||(valueLength=value.length,method.apply(self,[eat,value]),!(matched=valueLength!==value.length))););matched||self.file.fail(new Error("Infinite loop"),eat.now())}return self.eof=now(),tokens;function updatePosition(subvalue){for(var lastIndex=-1,index=subvalue.indexOf("\n");-1!==index;)line++,lastIndex=index,index=subvalue.indexOf("\n",index+1);-1===lastIndex?column+=subvalue.length:column=subvalue.length-lastIndex,line in offset&&(-1!==lastIndex?column+=offset[line]:column<=offset[line]&&(column=offset[line]+1))}function now(){var pos={line:line,column:column};return pos.offset=self.toOffset(pos),pos}function Position(start){this.start=start,this.end=now()}function eat(subvalue){var before,indent=function(){var indentation=[],pos=line+1;return function(){for(var last=line+1;pos<last;)indentation.push((offset[pos]||0)+1),pos++;return indentation}}(),pos=(before=now(),function(node,indent){var prev=node.position,start=prev?prev.start:before,combined=[],n=prev&&prev.end.line,l=before.line;if(node.position=new Position(start),prev&&indent&&prev.indent){if(combined=prev.indent,n<l){for(;++n<l;)combined.push((offset[n]||0)+1);combined.push(before.column)}indent=combined.concat(indent)}return node.position.indent=indent||[],node}),current=now();return function(subvalue){value.substring(0,subvalue.length)!==subvalue&&self.file.fail(new Error("Incorrectly eaten value: please report this warning on http://git.io/vg5Ft"),now())}(subvalue),apply.reset=reset,reset.test=test,apply.test=test,value=value.substring(subvalue.length),updatePosition(subvalue),indent=indent(),apply;function apply(node,parent){return pos(function(node,parent){var children=parent?parent.children:tokens,prev=children[children.length-1];return prev&&node.type===prev.type&&node.type in MERGEABLE_NODES&&mergeable(prev)&&mergeable(node)&&(node=MERGEABLE_NODES[node.type].call(self,prev,node)),node!==prev&&children.push(node),self.atStart&&0!==tokens.length&&self.exitStart(),node}(pos(node),parent),indent)}function reset(){var node=apply.apply(null,arguments);return line=current.line,column=current.column,value=subvalue+value,node}function test(){var result=pos({});return line=current.line,column=current.column,value=subvalue+value,result.position}}}};var MERGEABLE_NODES={text:function(prev,node){return prev.value+=node.value,prev},blockquote:function(prev,node){if(this.options.commonmark)return node;return prev.children=prev.children.concat(node.children),prev}};function mergeable(node){var start,end;return"text"!==node.type||!node.position||(start=node.position.start,end=node.position.end,start.line!==end.line||end.column-start.column===node.value.length)}},function(module,exports,__webpack_require__){"use strict";var xtend=__webpack_require__(111),escapes=__webpack_require__(189),defaults=__webpack_require__(137);module.exports=function(options){var key,value,current=this.options;if(null==options)options={};else{if("object"!=typeof options)throw new Error("Invalid value `"+options+"` for setting `options`");options=xtend(options)}for(key in defaults){if(null==(value=options[key])&&(value=current[key]),"blocks"!==key&&"boolean"!=typeof value||"blocks"===key&&"object"!=typeof value)throw new Error("Invalid value `"+value+"` for setting `options."+key+"`");options[key]=value}return this.options=options,this.escape=escapes(options),this}},function(module,exports,__webpack_require__){"use strict";module.exports=escapes;var defaults=["\\","`","*","{","}","[","]","(",")","#","+","-",".","!","_",">"],gfm=defaults.concat(["~","|"]),commonmark=gfm.concat(["\n",'"',"$","%","&","'",",","/",":",";","<","=","?","@","^"]);function escapes(options){var settings=options||{};return settings.commonmark?commonmark:settings.gfm?gfm:defaults}escapes.default=defaults,escapes.gfm=gfm,escapes.commonmark=commonmark},function(module){module.exports=JSON.parse('["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","iframe","legend","li","link","main","menu","menuitem","meta","nav","noframes","ol","optgroup","option","p","param","pre","section","source","title","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"]')},function(module,exports,__webpack_require__){"use strict";var xtend=__webpack_require__(111),removePosition=__webpack_require__(192);module.exports=function(){var node,value=String(this.file),start={line:1,column:1,offset:0},content=xtend(start);65279===(value=value.replace(EXPRESSION_LINE_BREAKS,"\n")).charCodeAt(0)&&(value=value.slice(1),content.column++,content.offset++);node={type:"root",children:this.tokenizeBlock(value,content),position:{start:start,end:this.eof||xtend(start)}},this.options.position||removePosition(node,!0);return node};var EXPRESSION_LINE_BREAKS=/\r\n|\r/g},function(module,exports,__webpack_require__){"use strict";var visit=__webpack_require__(116);function hard(node){delete node.position}function soft(node){node.position=void 0}module.exports=function(node,force){return visit(node,force?hard:soft),node}},function(module,exports,__webpack_require__){"use strict";module.exports=visitParents;var convert=__webpack_require__(194);function visitParents(tree,test,visitor,reverse){var is;function one(node,index,parents){var subresult,result=[];return(test&&!is(node,index,parents[parents.length-1]||null)||!1!==(result=toResult(visitor(node,parents)))[0])&&node.children&&"skip"!==result[0]&&!1===(subresult=toResult(function(children,parents){var result,step=reverse?-1:1,index=(reverse?children.length:-1)+step;for(;index>-1&&index<children.length;){if(!1===(result=one(children[index],index,parents))[0])return result;index="number"==typeof result[1]?result[1]:index+step}}(node.children,parents.concat(node))))[0]?subresult:result}"function"==typeof test&&"function"!=typeof visitor&&(reverse=visitor,visitor=test,test=null),is=convert(test),one(tree,null,[])}function toResult(value){return null!==value&&"object"==typeof value&&"length"in value?value:"number"==typeof value?[!0,value]:[value]}visitParents.CONTINUE=!0,visitParents.SKIP="skip",visitParents.EXIT=!1},function(module,exports,__webpack_require__){"use strict";function convert(test){if("string"==typeof test)return function(test){return function(node){return Boolean(node&&node.type===test)}}(test);if(null==test)return ok;if("object"==typeof test)return("length"in test?anyFactory:matchesFactory)(test);if("function"==typeof test)return test;throw new Error("Expected function, string, or object as test")}function matchesFactory(test){return function(node){var key;for(key in test)if(node[key]!==test[key])return!1;return!0}}function anyFactory(tests){var checks=function(tests){for(var results=[],length=tests.length,index=-1;++index<length;)results[index]=convert(tests[index]);return results}(tests),length=checks.length;return function(){var index=-1;for(;++index<length;)if(checks[index].apply(this,arguments))return!0;return!1}}function ok(){return!0}module.exports=convert},function(module,exports,__webpack_require__){"use strict";var whitespace=__webpack_require__(109);module.exports=function(eat,value,silent){var length,subvalue,queue,index,character=value.charAt(0);if("\n"!==character)return;if(silent)return!0;index=1,length=value.length,subvalue=character,queue="";for(;index<length&&(character=value.charAt(index),whitespace(character));)queue+=character,"\n"===character&&(subvalue+=queue,queue=""),index++;eat(subvalue)}},function(module,exports,__webpack_require__){"use strict";var repeat=__webpack_require__(124),trim=__webpack_require__(125);module.exports=function(eat,value,silent){var character,blankQueue,indent,index=-1,length=value.length,subvalue="",content="",subvalueQueue="",contentQueue="";for(;++index<length;)if(character=value.charAt(index),indent)if(indent=!1,subvalue+=subvalueQueue,content+=contentQueue,subvalueQueue="",contentQueue="","\n"===character)subvalueQueue=character,contentQueue=character;else for(subvalue+=character,content+=character;++index<length;){if(!(character=value.charAt(index))||"\n"===character){contentQueue=character,subvalueQueue=character;break}subvalue+=character,content+=character}else if(" "===character&&value.charAt(index+1)===character&&value.charAt(index+2)===character&&value.charAt(index+3)===character)subvalueQueue+=CODE_INDENT,index+=3,indent=!0;else if("\t"===character)subvalueQueue+=character,indent=!0;else{for(blankQueue="";"\t"===character||" "===character;)blankQueue+=character,character=value.charAt(++index);if("\n"!==character)break;subvalueQueue+=blankQueue+character,contentQueue+=character}if(content)return!!silent||eat(subvalue)({type:"code",lang:null,value:trim(content)})};var CODE_INDENT=repeat(" ",4)},function(module,exports,__webpack_require__){"use strict";var trim=__webpack_require__(125);module.exports=function(eat,value,silent){var fenceCount,marker,character,flag,queue,content,exdentedContent,closing,exdentedClosing,indent,now,settings=this.options,length=value.length+1,index=0,subvalue="";if(!settings.gfm)return;for(;index<length&&(" "===(character=value.charAt(index))||"\t"===character);)subvalue+=character,index++;if(indent=index,"~"!==(character=value.charAt(index))&&"`"!==character)return;index++,marker=character,fenceCount=1,subvalue+=character;for(;index<length&&(character=value.charAt(index))===marker;)subvalue+=character,fenceCount++,index++;if(fenceCount<3)return;for(;index<length&&(" "===(character=value.charAt(index))||"\t"===character);)subvalue+=character,index++;flag="",queue="";for(;index<length&&"\n"!==(character=value.charAt(index))&&"~"!==character&&"`"!==character;)" "===character||"\t"===character?queue+=character:(flag+=queue+character,queue=""),index++;if((character=value.charAt(index))&&"\n"!==character)return;if(silent)return!0;(now=eat.now()).column+=subvalue.length,now.offset+=subvalue.length,subvalue+=flag,flag=this.decode.raw(this.unescape(flag),now),queue&&(subvalue+=queue);queue="",closing="",exdentedClosing="",content="",exdentedContent="";for(;index<length;)if(character=value.charAt(index),content+=closing,exdentedContent+=exdentedClosing,closing="",exdentedClosing="","\n"===character){for(content?(closing+=character,exdentedClosing+=character):subvalue+=character,queue="",index++;index<length&&" "===(character=value.charAt(index));)queue+=character,index++;if(closing+=queue,exdentedClosing+=queue.slice(indent),!(queue.length>=4)){for(queue="";index<length&&(character=value.charAt(index))===marker;)queue+=character,index++;if(closing+=queue,exdentedClosing+=queue,!(queue.length<fenceCount)){for(queue="";index<length&&(" "===(character=value.charAt(index))||"\t"===character);)closing+=character,exdentedClosing+=character,index++;if(!character||"\n"===character)break}}}else content+=character,exdentedClosing+=character,index++;return eat(subvalue+=content+closing)({type:"code",lang:flag||null,value:trim(exdentedContent)})}},function(module,exports,__webpack_require__){"use strict";var trim=__webpack_require__(113),interrupt=__webpack_require__(126);module.exports=function(eat,value,silent){var add,character,rest,nextIndex,content,line,startIndex,prefixed,exit,offsets=this.offset,tokenizers=this.blockTokenizers,interruptors=this.interruptBlockquote,now=eat.now(),currentLine=now.line,length=value.length,values=[],contents=[],indents=[],index=0;for(;index<length&&(" "===(character=value.charAt(index))||"\t"===character);)index++;if(">"!==value.charAt(index))return;if(silent)return!0;index=0;for(;index<length;){for(nextIndex=value.indexOf("\n",index),startIndex=index,prefixed=!1,-1===nextIndex&&(nextIndex=length);index<length&&(" "===(character=value.charAt(index))||"\t"===character);)index++;if(">"===value.charAt(index)?(index++,prefixed=!0," "===value.charAt(index)&&index++):index=startIndex,content=value.slice(index,nextIndex),!prefixed&&!trim(content)){index=startIndex;break}if(!prefixed&&(rest=value.slice(index),interrupt(interruptors,tokenizers,this,[eat,rest,!0])))break;line=startIndex===index?content:value.slice(startIndex,nextIndex),indents.push(index-startIndex),values.push(line),contents.push(content),index=nextIndex+1}index=-1,length=indents.length,add=eat(values.join("\n"));for(;++index<length;)offsets[currentLine]=(offsets[currentLine]||0)+indents[index],currentLine++;return exit=this.enterBlock(),contents=this.tokenizeBlock(contents.join("\n"),now),exit(),add({type:"blockquote",children:contents})}},function(module,exports,__webpack_require__){"use strict";module.exports=function(eat,value,silent){var character,queue,depth,settings=this.options,length=value.length+1,index=-1,now=eat.now(),subvalue="",content="";for(;++index<length;){if(" "!==(character=value.charAt(index))&&"\t"!==character){index--;break}subvalue+=character}depth=0;for(;++index<=length;){if("#"!==(character=value.charAt(index))){index--;break}subvalue+=character,depth++}if(depth>6)return;if(!depth||!settings.pedantic&&"#"===value.charAt(index+1))return;length=value.length+1,queue="";for(;++index<length;){if(" "!==(character=value.charAt(index))&&"\t"!==character){index--;break}queue+=character}if(!settings.pedantic&&0===queue.length&&character&&"\n"!==character)return;if(silent)return!0;subvalue+=queue,queue="",content="";for(;++index<length&&(character=value.charAt(index))&&"\n"!==character;)if(" "===character||"\t"===character||"#"===character){for(;" "===character||"\t"===character;)queue+=character,character=value.charAt(++index);for(;"#"===character;)queue+=character,character=value.charAt(++index);for(;" "===character||"\t"===character;)queue+=character,character=value.charAt(++index);index--}else content+=queue+character,queue="";return now.column+=subvalue.length,now.offset+=subvalue.length,eat(subvalue+=content+queue)({type:"heading",depth:depth,children:this.tokenizeInline(content,now)})}},function(module,exports,__webpack_require__){"use strict";module.exports=function(eat,value,silent){var character,marker,markerCount,queue,index=-1,length=value.length+1,subvalue="";for(;++index<length&&("\t"===(character=value.charAt(index))||" "===character);)subvalue+=character;if("*"!==character&&"-"!==character&&"_"!==character)return;marker=character,subvalue+=character,markerCount=1,queue="";for(;++index<length;)if((character=value.charAt(index))===marker)markerCount++,subvalue+=queue+marker,queue="";else{if(" "!==character)return markerCount>=3&&(!character||"\n"===character)?(subvalue+=queue,!!silent||eat(subvalue)({type:"thematicBreak"})):void 0;queue+=character}}},function(module,exports,__webpack_require__){"use strict";var trim=__webpack_require__(113),repeat=__webpack_require__(124),decimal=__webpack_require__(115),getIndent=__webpack_require__(138),removeIndent=__webpack_require__(202),interrupt=__webpack_require__(126);module.exports=function(eat,value,silent){var markers,queue,ordered,character,marker,nextIndex,startIndex,prefixed,currentMarker,content,line,prevEmpty,empty,items,allLines,emptyLines,item,enterTop,exitBlockquote,isLoose,node,now,end,indented,commonmark=this.options.commonmark,pedantic=this.options.pedantic,tokenizers=this.blockTokenizers,interuptors=this.interruptList,index=0,length=value.length,start=null,size=0;for(;index<length;){if("\t"===(character=value.charAt(index)))size+=4-size%4;else{if(" "!==character)break;size++}index++}if(size>=4)return;if(character=value.charAt(index),markers=commonmark?LIST_ORDERED_COMMONMARK_MARKERS:LIST_ORDERED_MARKERS,!0===LIST_UNORDERED_MARKERS[character])marker=character,ordered=!1;else{for(ordered=!0,queue="";index<length&&(character=value.charAt(index),decimal(character));)queue+=character,index++;if(character=value.charAt(index),!queue||!0!==markers[character])return;start=parseInt(queue,10),marker=character}if(" "!==(character=value.charAt(++index))&&"\t"!==character)return;if(silent)return!0;index=0,items=[],allLines=[],emptyLines=[];for(;index<length;){for(nextIndex=value.indexOf("\n",index),startIndex=index,prefixed=!1,indented=!1,-1===nextIndex&&(nextIndex=length),end=index+4,size=0;index<length;){if("\t"===(character=value.charAt(index)))size+=4-size%4;else{if(" "!==character)break;size++}index++}if(size>=4&&(indented=!0),item&&size>=item.indent&&(indented=!0),character=value.charAt(index),currentMarker=null,!indented){if(!0===LIST_UNORDERED_MARKERS[character])currentMarker=character,index++,size++;else{for(queue="";index<length&&(character=value.charAt(index),decimal(character));)queue+=character,index++;character=value.charAt(index),index++,queue&&!0===markers[character]&&(currentMarker=character,size+=queue.length+1)}if(currentMarker)if("\t"===(character=value.charAt(index)))size+=4-size%4,index++;else if(" "===character){for(end=index+4;index<end&&" "===value.charAt(index);)index++,size++;index===end&&" "===value.charAt(index)&&(index-=3,size-=3)}else"\n"!==character&&""!==character&&(currentMarker=null)}if(currentMarker){if(!pedantic&&marker!==currentMarker)break;prefixed=!0}else commonmark||indented||" "!==value.charAt(startIndex)?commonmark&&item&&(indented=size>=item.indent||size>4):indented=!0,prefixed=!1,index=startIndex;if(line=value.slice(startIndex,nextIndex),content=startIndex===index?line:value.slice(index,nextIndex),("*"===currentMarker||"_"===currentMarker||"-"===currentMarker)&&tokenizers.thematicBreak.call(this,eat,line,!0))break;if(prevEmpty=empty,empty=!trim(content).length,indented&&item)item.value=item.value.concat(emptyLines,line),allLines=allLines.concat(emptyLines,line),emptyLines=[];else if(prefixed)0!==emptyLines.length&&(item.value.push(""),item.trail=emptyLines.concat()),item={value:[line],indent:size,trail:[]},items.push(item),allLines=allLines.concat(emptyLines,line),emptyLines=[];else if(empty){if(prevEmpty)break;emptyLines.push(line)}else{if(prevEmpty)break;if(interrupt(interuptors,tokenizers,this,[eat,line,!0]))break;item.value=item.value.concat(emptyLines,line),allLines=allLines.concat(emptyLines,line),emptyLines=[]}index=nextIndex+1}node=eat(allLines.join("\n")).reset({type:"list",ordered:ordered,start:start,loose:null,children:[]}),enterTop=this.enterList(),exitBlockquote=this.enterBlock(),isLoose=!1,index=-1,length=items.length;for(;++index<length;)item=items[index].value.join("\n"),now=eat.now(),(item=eat(item)(listItem(this,item,now),node)).loose&&(isLoose=!0),item=items[index].trail.join("\n"),index!==length-1&&(item+="\n"),eat(item);return enterTop(),exitBlockquote(),node.loose=isLoose,node};var EXPRESSION_LOOSE_LIST_ITEM=/\n\n(?!\s*$)/,EXPRESSION_TASK_ITEM=/^\[([ \t]|x|X)][ \t]/,EXPRESSION_BULLET=/^([ \t]*)([*+-]|\d+[.)])( {1,4}(?! )| |\t|$|(?=\n))([^\n]*)/,EXPRESSION_PEDANTIC_BULLET=/^([ \t]*)([*+-]|\d+[.)])([ \t]+)/,EXPRESSION_INITIAL_INDENT=/^( {1,4}|\t)?/gm,LIST_UNORDERED_MARKERS={"*":!0,"+":!0,"-":!0},LIST_ORDERED_MARKERS={".":!0},LIST_ORDERED_COMMONMARK_MARKERS={};function listItem(ctx,value,position){var task,indent,offsets=ctx.offset,fn=ctx.options.pedantic?pedanticListItem:normalListItem,checked=null;return value=fn.apply(null,arguments),ctx.options.gfm&&(task=value.match(EXPRESSION_TASK_ITEM))&&(indent=task[0].length,checked="x"===task[1].toLowerCase(),offsets[position.line]+=indent,value=value.slice(indent)),{type:"listItem",loose:EXPRESSION_LOOSE_LIST_ITEM.test(value)||"\n"===value.charAt(value.length-1),checked:checked,children:ctx.tokenizeBlock(value,position)}}function pedanticListItem(ctx,value,position){var offsets=ctx.offset,line=position.line;return value=value.replace(EXPRESSION_PEDANTIC_BULLET,replacer),line=position.line,value.replace(EXPRESSION_INITIAL_INDENT,replacer);function replacer($0){return offsets[line]=(offsets[line]||0)+$0.length,line++,""}}function normalListItem(ctx,value,position){var max,bullet,rest,lines,trimmedLines,index,length,offsets=ctx.offset,line=position.line;for(lines=(value=value.replace(EXPRESSION_BULLET,(function($0,$1,$2,$3,$4){bullet=$1+$2+$3,rest=$4,Number($2)<10&&bullet.length%2==1&&($2=" "+$2);return(max=$1+repeat(" ",$2.length)+$3)+rest}))).split("\n"),(trimmedLines=removeIndent(value,getIndent(max).indent).split("\n"))[0]=rest,offsets[line]=(offsets[line]||0)+bullet.length,line++,index=0,length=lines.length;++index<length;)offsets[line]=(offsets[line]||0)+lines[index].length-trimmedLines[index].length,line++;return trimmedLines.join("\n")}LIST_ORDERED_COMMONMARK_MARKERS["."]=!0,LIST_ORDERED_COMMONMARK_MARKERS[")"]=!0},function(module,exports,__webpack_require__){"use strict";var trim=__webpack_require__(113),repeat=__webpack_require__(124),getIndent=__webpack_require__(138);module.exports=function(value,maximum){var index,indentation,stops,padding,values=value.split("\n"),position=values.length+1,minIndent=1/0,matrix=[];values.unshift(repeat(" ",maximum)+"!");for(;position--;)if(indentation=getIndent(values[position]),matrix[position]=indentation.stops,0!==trim(values[position]).length){if(!indentation.indent){minIndent=1/0;break}indentation.indent>0&&indentation.indent<minIndent&&(minIndent=indentation.indent)}if(minIndent!==1/0)for(position=values.length;position--;){for(stops=matrix[position],index=minIndent;index&&!(index in stops);)index--;padding=0!==trim(values[position]).length&&minIndent&&index!==minIndent?"\t":"",values[position]=padding+values[position].slice(index in stops?stops[index]+1:0)}return values.shift(),values.join("\n")}},function(module,exports,__webpack_require__){"use strict";module.exports=function(eat,value,silent){var content,queue,character,marker,depth,now=eat.now(),length=value.length,index=-1,subvalue="";for(;++index<length;){if(" "!==(character=value.charAt(index))||index>=3){index--;break}subvalue+=character}content="",queue="";for(;++index<length;){if("\n"===(character=value.charAt(index))){index--;break}" "===character||"\t"===character?queue+=character:(content+=queue+character,queue="")}if(now.column+=subvalue.length,now.offset+=subvalue.length,subvalue+=content+queue,character=value.charAt(++index),marker=value.charAt(++index),"\n"!==character||!SETEXT_MARKERS[marker])return;subvalue+=character,queue=marker,depth=SETEXT_MARKERS[marker];for(;++index<length;){if((character=value.charAt(index))!==marker){if("\n"!==character)return;index--;break}queue+=character}if(silent)return!0;return eat(subvalue+queue)({type:"heading",depth:depth,children:this.tokenizeInline(content,now)})};var SETEXT_MARKERS={};SETEXT_MARKERS["="]=1,SETEXT_MARKERS["-"]=2},function(module,exports,__webpack_require__){"use strict";var openCloseTag=__webpack_require__(139).openCloseTag;module.exports=function(eat,value,silent){var next,line,offset,character,count,sequence,subvalue,blocks=this.options.blocks,length=value.length,index=0,sequences=[[/^<(script|pre|style)(?=(\s|>|$))/i,/<\/(script|pre|style)>/i,!0],[/^<!--/,/-->/,!0],[/^<\?/,/\?>/,!0],[/^<![A-Za-z]/,/>/,!0],[/^<!\[CDATA\[/,/\]\]>/,!0],[new RegExp("^</?("+blocks.join("|")+")(?=(\\s|/?>|$))","i"),/^$/,!0],[new RegExp(openCloseTag.source+"\\s*$"),/^$/,!1]];for(;index<length&&("\t"===(character=value.charAt(index))||" "===character);)index++;if("<"!==value.charAt(index))return;next=-1===(next=value.indexOf("\n",index+1))?length:next,line=value.slice(index,next),offset=-1,count=sequences.length;for(;++offset<count;)if(sequences[offset][0].test(line)){sequence=sequences[offset];break}if(!sequence)return;if(silent)return sequence[2];if(index=next,!sequence[1].test(line))for(;index<length;){if(next=-1===(next=value.indexOf("\n",index+1))?length:next,line=value.slice(index+1,next),sequence[1].test(line)){line&&(index=next);break}index=next}return subvalue=value.slice(0,index),eat(subvalue)({type:"html",value:subvalue})}},function(module,exports,__webpack_require__){"use strict";var whitespace=__webpack_require__(109),normalize=__webpack_require__(127);module.exports=footnoteDefinition,footnoteDefinition.notInList=!0,footnoteDefinition.notInBlock=!0;var EXPRESSION_INITIAL_TAB=/^( {4}|\t)?/gm;function footnoteDefinition(eat,value,silent){var index,length,subvalue,now,currentLine,content,queue,subqueue,character,identifier,add,exit,offsets=this.offset;if(this.options.footnotes){for(index=0,length=value.length,subvalue="",now=eat.now(),currentLine=now.line;index<length&&(character=value.charAt(index),whitespace(character));)subvalue+=character,index++;if("["===value.charAt(index)&&"^"===value.charAt(index+1)){for(index=(subvalue+="[^").length,queue="";index<length&&"]"!==(character=value.charAt(index));)"\\"===character&&(queue+=character,index++,character=value.charAt(index)),queue+=character,index++;if(queue&&"]"===value.charAt(index)&&":"===value.charAt(index+1)){if(silent)return!0;for(identifier=normalize(queue),index=(subvalue+=queue+"]:").length;index<length&&("\t"===(character=value.charAt(index))||" "===character);)subvalue+=character,index++;for(now.column+=subvalue.length,now.offset+=subvalue.length,queue="",content="",subqueue="";index<length;){if("\n"===(character=value.charAt(index))){for(subqueue=character,index++;index<length&&"\n"===(character=value.charAt(index));)subqueue+=character,index++;for(queue+=subqueue,subqueue="";index<length&&" "===(character=value.charAt(index));)subqueue+=character,index++;if(0===subqueue.length)break;queue+=subqueue}queue&&(content+=queue,queue=""),content+=character,index++}return subvalue+=content,content=content.replace(EXPRESSION_INITIAL_TAB,(function(line){return offsets[currentLine]=(offsets[currentLine]||0)+line.length,currentLine++,""})),add=eat(subvalue),exit=this.enterBlock(),content=this.tokenizeBlock(content,now),exit(),add({type:"footnoteDefinition",identifier:identifier,children:content})}}}}},function(module,exports,__webpack_require__){"use strict";module.exports=function(value){return String(value).replace(/\s+/g," ")}},function(module,exports,__webpack_require__){"use strict";var whitespace=__webpack_require__(109),normalize=__webpack_require__(127);module.exports=definition,definition.notInList=!0,definition.notInBlock=!0;function definition(eat,value,silent){for(var beforeURL,beforeTitle,queue,character,test,identifier,url,title,commonmark=this.options.commonmark,index=0,length=value.length,subvalue="";index<length&&(" "===(character=value.charAt(index))||"\t"===character);)subvalue+=character,index++;if("["===(character=value.charAt(index))){for(index++,subvalue+=character,queue="";index<length&&"]"!==(character=value.charAt(index));)"\\"===character&&(queue+=character,index++,character=value.charAt(index)),queue+=character,index++;if(queue&&"]"===value.charAt(index)&&":"===value.charAt(index+1)){for(identifier=queue,index=(subvalue+=queue+"]:").length,queue="";index<length&&("\t"===(character=value.charAt(index))||" "===character||"\n"===character);)subvalue+=character,index++;if(queue="",beforeURL=subvalue,"<"===(character=value.charAt(index))){for(index++;index<length&&isEnclosedURLCharacter(character=value.charAt(index));)queue+=character,index++;if((character=value.charAt(index))===isEnclosedURLCharacter.delimiter)subvalue+="<"+queue+character,index++;else{if(commonmark)return;index-=queue.length+1,queue=""}}if(!queue){for(;index<length&&isUnclosedURLCharacter(character=value.charAt(index));)queue+=character,index++;subvalue+=queue}if(queue){for(url=queue,queue="";index<length&&("\t"===(character=value.charAt(index))||" "===character||"\n"===character);)queue+=character,index++;if(test=null,'"'===(character=value.charAt(index))?test='"':"'"===character?test="'":"("===character&&(test=")"),test){if(!queue)return;for(index=(subvalue+=queue+character).length,queue="";index<length&&(character=value.charAt(index))!==test;){if("\n"===character){if(index++,"\n"===(character=value.charAt(index))||character===test)return;queue+="\n"}queue+=character,index++}if((character=value.charAt(index))!==test)return;beforeTitle=subvalue,subvalue+=queue+character,index++,title=queue,queue=""}else queue="",index=subvalue.length;for(;index<length&&("\t"===(character=value.charAt(index))||" "===character);)subvalue+=character,index++;return(character=value.charAt(index))&&"\n"!==character?void 0:!!silent||(beforeURL=eat(beforeURL).test().end,url=this.decode.raw(this.unescape(url),beforeURL,{nonTerminated:!1}),title&&(beforeTitle=eat(beforeTitle).test().end,title=this.decode.raw(this.unescape(title),beforeTitle)),eat(subvalue)({type:"definition",identifier:normalize(identifier),title:title||null,url:url}))}}}}function isEnclosedURLCharacter(character){return">"!==character&&"["!==character&&"]"!==character}function isUnclosedURLCharacter(character){return"["!==character&&"]"!==character&&!whitespace(character)}isEnclosedURLCharacter.delimiter=">"},function(module,exports,__webpack_require__){"use strict";var whitespace=__webpack_require__(109);module.exports=function(eat,value,silent){var index,alignments,alignment,subvalue,row,length,lines,queue,character,hasDash,align,cell,preamble,count,opening,now,position,lineCount,line,rows,table,lineIndex,pipeIndex,first;if(!this.options.gfm)return;index=0,lineCount=0,length=value.length+1,lines=[];for(;index<length;){if(lineIndex=value.indexOf("\n",index),pipeIndex=value.indexOf("|",index+1),-1===lineIndex&&(lineIndex=value.length),-1===pipeIndex||pipeIndex>lineIndex){if(lineCount<2)return;break}lines.push(value.slice(index,lineIndex)),lineCount++,index=lineIndex+1}subvalue=lines.join("\n"),alignments=lines.splice(1,1)[0]||[],index=0,length=alignments.length,lineCount--,alignment=!1,align=[];for(;index<length;){if("|"===(character=alignments.charAt(index))){if(hasDash=null,!1===alignment){if(!1===first)return}else align.push(alignment),alignment=!1;first=!1}else if("-"===character)hasDash=!0,alignment=alignment||null;else if(":"===character)alignment="left"===alignment?"center":hasDash&&null===alignment?"right":"left";else if(!whitespace(character))return;index++}!1!==alignment&&align.push(alignment);if(align.length<1)return;if(silent)return!0;position=-1,rows=[],table=eat(subvalue).reset({type:"table",align:align,children:rows});for(;++position<lineCount;){for(line=lines[position],row={type:"tableRow",children:[]},position&&eat("\n"),eat(line).reset(row,table),length=line.length+1,index=0,queue="",cell="",preamble=!0,count=null,opening=null;index<length;)if("\t"!==(character=line.charAt(index))&&" "!==character){if(""===character||"|"===character)if(preamble)eat(character);else{if(character&&opening){queue+=character,index++;continue}!cell&&!character||preamble||(subvalue=cell,queue.length>1&&(character?(subvalue+=queue.slice(0,queue.length-1),queue=queue.charAt(queue.length-1)):(subvalue+=queue,queue="")),now=eat.now(),eat(subvalue)({type:"tableCell",children:this.tokenizeInline(cell,now)},row)),eat(queue+character),queue="",cell=""}else if(queue&&(cell+=queue,queue=""),cell+=character,"\\"===character&&index!==length-2&&(cell+=line.charAt(index+1),index++),"`"===character){for(count=1;line.charAt(index+1)===character;)cell+=character,index++,count++;opening?count>=opening&&(opening=0):opening=count}preamble=!1,index++}else cell?queue+=character:eat(character),index++;position||eat("\n"+alignments)}return table}},function(module,exports,__webpack_require__){"use strict";var trim=__webpack_require__(113),decimal=__webpack_require__(115),trimTrailingLines=__webpack_require__(125),interrupt=__webpack_require__(126);module.exports=function(eat,value,silent){var position,subvalue,character,size,now,settings=this.options,commonmark=settings.commonmark,gfm=settings.gfm,tokenizers=this.blockTokenizers,interruptors=this.interruptParagraph,index=value.indexOf("\n"),length=value.length;for(;index<length;){if(-1===index){index=length;break}if("\n"===value.charAt(index+1))break;if(commonmark){for(size=0,position=index+1;position<length;){if("\t"===(character=value.charAt(position))){size=4;break}if(" "!==character)break;size++,position++}if(size>=4){index=value.indexOf("\n",index+1);continue}}if(subvalue=value.slice(index+1),interrupt(interruptors,tokenizers,this,[eat,subvalue,!0]))break;if(tokenizers.list.call(this,eat,subvalue,!0)&&(this.inList||commonmark||gfm&&!decimal(trim.left(subvalue).charAt(0))))break;if(position=index,-1!==(index=value.indexOf("\n",index+1))&&""===trim(value.slice(position,index))){index=position;break}}if(subvalue=value.slice(0,index),""===trim(subvalue))return eat(subvalue),null;if(silent)return!0;return now=eat.now(),subvalue=trimTrailingLines(subvalue),eat(subvalue)({type:"paragraph",children:this.tokenizeInline(subvalue,now)})}},function(module,exports,__webpack_require__){"use strict";var locate=__webpack_require__(211);function escape(eat,value,silent){var character,node;if("\\"===value.charAt(0)&&(character=value.charAt(1),-1!==this.escape.indexOf(character)))return!!silent||(node="\n"===character?{type:"break"}:{type:"text",value:character},eat("\\"+character)(node))}module.exports=escape,escape.locator=locate},function(module,exports,__webpack_require__){"use strict";module.exports=function(value,fromIndex){return value.indexOf("\\",fromIndex)}},function(module,exports,__webpack_require__){"use strict";var whitespace=__webpack_require__(109),decode=__webpack_require__(123),locate=__webpack_require__(140);module.exports=autoLink,autoLink.locator=locate,autoLink.notInLink=!0;var MAILTO_LENGTH="mailto:".length;function autoLink(eat,value,silent){var subvalue,length,index,queue,character,hasAtCharacter,link,now,content,tokenizers,exit;if("<"===value.charAt(0)){for(this,subvalue="",length=value.length,index=0,queue="",hasAtCharacter=!1,link="",index++,subvalue="<";index<length&&(character=value.charAt(index),!(whitespace(character)||">"===character||"@"===character||":"===character&&"/"===value.charAt(index+1)));)queue+=character,index++;if(queue){if(link+=queue,queue="",link+=character=value.charAt(index),index++,"@"===character)hasAtCharacter=!0;else{if(":"!==character||"/"!==value.charAt(index+1))return;link+="/",index++}for(;index<length&&(character=value.charAt(index),!whitespace(character)&&">"!==character);)queue+=character,index++;if(character=value.charAt(index),queue&&">"===character)return!!silent||(content=link+=queue,subvalue+=link+character,(now=eat.now()).column++,now.offset++,hasAtCharacter&&("mailto:"===link.slice(0,MAILTO_LENGTH).toLowerCase()?(content=content.substr(MAILTO_LENGTH),now.column+=MAILTO_LENGTH,now.offset+=MAILTO_LENGTH):link="mailto:"+link),tokenizers=this.inlineTokenizers,this.inlineTokenizers={text:tokenizers.text},exit=this.enterLink(),content=this.tokenizeInline(content,now),this.inlineTokenizers=tokenizers,exit(),eat(subvalue)({type:"link",title:null,url:decode(link,{nonTerminated:!1}),children:content}))}}}},function(module,exports,__webpack_require__){"use strict";var decode=__webpack_require__(123),whitespace=__webpack_require__(109),locate=__webpack_require__(214);module.exports=url,url.locator=locate,url.notInLink=!0;var PROTOCOLS=["http://","https://","mailto:"],PROTOCOLS_LENGTH=PROTOCOLS.length;function url(eat,value,silent){var subvalue,content,character,index,position,protocol,match,length,queue,parenCount,nextCharacter,exit;if(this.options.gfm){for(subvalue="",index=-1,length=PROTOCOLS_LENGTH;++index<length;)if(protocol=PROTOCOLS[index],(match=value.slice(0,protocol.length)).toLowerCase()===protocol){subvalue=match;break}if(subvalue){for(index=subvalue.length,length=value.length,queue="",parenCount=0;index<length&&(character=value.charAt(index),!whitespace(character)&&"<"!==character)&&("."!==character&&","!==character&&":"!==character&&";"!==character&&'"'!==character&&"'"!==character&&")"!==character&&"]"!==character||(nextCharacter=value.charAt(index+1))&&!whitespace(nextCharacter))&&("("!==character&&"["!==character||parenCount++,")"!==character&&"]"!==character||!(--parenCount<0));)queue+=character,index++;if(queue){if(content=subvalue+=queue,"mailto:"===protocol){if(-1===(position=queue.indexOf("@"))||position===length-1)return;content=content.substr("mailto:".length)}return!!silent||(exit=this.enterLink(),content=this.tokenizeInline(content,eat.now()),exit(),eat(subvalue)({type:"link",title:null,url:decode(subvalue,{nonTerminated:!1}),children:content}))}}}}},function(module,exports,__webpack_require__){"use strict";module.exports=function(value,fromIndex){var position,length=PROTOCOLS.length,index=-1,min=-1;if(!this.options.gfm)return-1;for(;++index<length;)-1!==(position=value.indexOf(PROTOCOLS[index],fromIndex))&&(position<min||-1===min)&&(min=position);return min};var PROTOCOLS=["https://","http://","mailto:"]},function(module,exports,__webpack_require__){"use strict";var alphabetical=__webpack_require__(136),locate=__webpack_require__(140),tag=__webpack_require__(139).tag;module.exports=inlineHTML,inlineHTML.locator=locate;var EXPRESSION_HTML_LINK_OPEN=/^<a /i,EXPRESSION_HTML_LINK_CLOSE=/^<\/a>/i;function inlineHTML(eat,value,silent){var character,subvalue,length=value.length;if(!("<"!==value.charAt(0)||length<3)&&(character=value.charAt(1),(alphabetical(character)||"?"===character||"!"===character||"/"===character)&&(subvalue=value.match(tag))))return!!silent||(subvalue=subvalue[0],!this.inLink&&EXPRESSION_HTML_LINK_OPEN.test(subvalue)?this.inLink=!0:this.inLink&&EXPRESSION_HTML_LINK_CLOSE.test(subvalue)&&(this.inLink=!1),eat(subvalue)({type:"html",value:subvalue}))}},function(module,exports,__webpack_require__){"use strict";var whitespace=__webpack_require__(109),locate=__webpack_require__(141);module.exports=link,link.locator=locate;var own={}.hasOwnProperty,LINK_MARKERS={'"':'"',"'":"'"},COMMONMARK_LINK_MARKERS={};function link(eat,value,silent){var closed,count,opening,beforeURL,beforeTitle,subqueue,hasMarker,markers,isImage,content,marker,length,title,depth,queue,url,now,exit,node,subvalue="",index=0,character=value.charAt(0),pedantic=this.options.pedantic,commonmark=this.options.commonmark,gfm=this.options.gfm;if("!"===character&&(isImage=!0,subvalue=character,character=value.charAt(++index)),"["===character&&(isImage||!this.inLink)){for(subvalue+=character,queue="",index++,length=value.length,depth=0,(now=eat.now()).column+=index,now.offset+=index;index<length;){if(subqueue=character=value.charAt(index),"`"===character){for(count=1;"`"===value.charAt(index+1);)subqueue+=character,index++,count++;opening?count>=opening&&(opening=0):opening=count}else if("\\"===character)index++,subqueue+=value.charAt(index);else if(opening&&!gfm||"["!==character){if((!opening||gfm)&&"]"===character){if(!depth){if(!pedantic)for(;index<length&&(character=value.charAt(index+1),whitespace(character));)subqueue+=character,index++;if("("!==value.charAt(index+1))return;subqueue+="(",closed=!0,index++;break}depth--}}else depth++;queue+=subqueue,subqueue="",index++}if(closed){for(content=queue,subvalue+=queue+subqueue,index++;index<length&&(character=value.charAt(index),whitespace(character));)subvalue+=character,index++;if(character=value.charAt(index),markers=commonmark?COMMONMARK_LINK_MARKERS:LINK_MARKERS,queue="",beforeURL=subvalue,"<"===character){for(index++,beforeURL+="<";index<length&&">"!==(character=value.charAt(index));){if(commonmark&&"\n"===character)return;queue+=character,index++}if(">"!==value.charAt(index))return;subvalue+="<"+queue+">",url=queue,index++}else{for(character=null,subqueue="";index<length&&(character=value.charAt(index),!subqueue||!own.call(markers,character));){if(whitespace(character)){if(!pedantic)break;subqueue+=character}else{if("("===character)depth++;else if(")"===character){if(0===depth)break;depth--}queue+=subqueue,subqueue="","\\"===character&&(queue+="\\",character=value.charAt(++index)),queue+=character}index++}url=queue,index=(subvalue+=queue).length}for(queue="";index<length&&(character=value.charAt(index),whitespace(character));)queue+=character,index++;if(character=value.charAt(index),subvalue+=queue,queue&&own.call(markers,character))if(index++,subvalue+=character,queue="",marker=markers[character],beforeTitle=subvalue,commonmark){for(;index<length&&(character=value.charAt(index))!==marker;)"\\"===character&&(queue+="\\",character=value.charAt(++index)),index++,queue+=character;if((character=value.charAt(index))!==marker)return;for(title=queue,subvalue+=queue+character,index++;index<length&&(character=value.charAt(index),whitespace(character));)subvalue+=character,index++}else for(subqueue="";index<length;){if((character=value.charAt(index))===marker)hasMarker&&(queue+=marker+subqueue,subqueue=""),hasMarker=!0;else if(hasMarker){if(")"===character){subvalue+=queue+marker+subqueue,title=queue;break}whitespace(character)?subqueue+=character:(queue+=marker+subqueue+character,subqueue="",hasMarker=!1)}else queue+=character;index++}if(")"===value.charAt(index))return!!silent||(subvalue+=")",url=this.decode.raw(this.unescape(url),eat(beforeURL).test().end,{nonTerminated:!1}),title&&(beforeTitle=eat(beforeTitle).test().end,title=this.decode.raw(this.unescape(title),beforeTitle)),node={type:isImage?"image":"link",title:title||null,url:url},isImage?node.alt=this.decode.raw(this.unescape(content),now)||null:(exit=this.enterLink(),node.children=this.tokenizeInline(content,now),exit()),eat(subvalue)(node))}}}COMMONMARK_LINK_MARKERS['"']='"',COMMONMARK_LINK_MARKERS["'"]="'",COMMONMARK_LINK_MARKERS["("]=")"},function(module,exports,__webpack_require__){"use strict";var whitespace=__webpack_require__(109),locate=__webpack_require__(141),normalize=__webpack_require__(127);module.exports=reference,reference.locator=locate;function reference(eat,value,silent){var content,identifier,now,node,exit,queue,bracketed,depth,character=value.charAt(0),index=0,length=value.length,subvalue="",intro="",type="link",referenceType="shortcut";if("!"===character&&(type="image",intro=character,character=value.charAt(++index)),"["===character){if(index++,intro+=character,queue="",this.options.footnotes&&"^"===value.charAt(index)){if("image"===type)return;intro+="^",index++,type="footnote"}for(depth=0;index<length;){if("["===(character=value.charAt(index)))bracketed=!0,depth++;else if("]"===character){if(!depth)break;depth--}"\\"===character&&(queue+="\\",character=value.charAt(++index)),queue+=character,index++}if(subvalue=queue,content=queue,"]"===(character=value.charAt(index))){for(index++,subvalue+=character,queue="";index<length&&(character=value.charAt(index),whitespace(character));)queue+=character,index++;if(character=value.charAt(index),"footnote"!==type&&"["===character){for(identifier="",queue+=character,index++;index<length&&"["!==(character=value.charAt(index))&&"]"!==character;)"\\"===character&&(identifier+="\\",character=value.charAt(++index)),identifier+=character,index++;"]"===(character=value.charAt(index))?(referenceType=identifier?"full":"collapsed",queue+=identifier+character,index++):identifier="",subvalue+=queue,queue=""}else{if(!content)return;identifier=content}if("full"===referenceType||!bracketed)return subvalue=intro+subvalue,"link"===type&&this.inLink?null:!!silent||("footnote"===type&&-1!==content.indexOf(" ")?eat(subvalue)({type:"footnote",children:this.tokenizeInline(content,eat.now())}):((now=eat.now()).column+=intro.length,now.offset+=intro.length,node={type:type+"Reference",identifier:normalize(identifier="full"===referenceType?identifier:content)},"link"!==type&&"image"!==type||(node.referenceType=referenceType),"link"===type?(exit=this.enterLink(),node.children=this.tokenizeInline(content,now),exit()):"image"===type&&(node.alt=this.decode.raw(this.unescape(content),now)||null),eat(subvalue)(node)))}}}},function(module,exports,__webpack_require__){"use strict";var trim=__webpack_require__(113),whitespace=__webpack_require__(109),locate=__webpack_require__(219);module.exports=strong,strong.locator=locate;function strong(eat,value,silent){var now,pedantic,marker,queue,subvalue,length,prev,index=0,character=value.charAt(index);if(!("*"!==character&&"_"!==character||value.charAt(++index)!==character||(pedantic=this.options.pedantic,subvalue=(marker=character)+marker,length=value.length,index++,queue="",character="",pedantic&&whitespace(value.charAt(index)))))for(;index<length;){if(prev=character,!((character=value.charAt(index))!==marker||value.charAt(index+1)!==marker||pedantic&&whitespace(prev))&&(character=value.charAt(index+2))!==marker){if(!trim(queue))return;return!!silent||((now=eat.now()).column+=2,now.offset+=2,eat(subvalue+queue+subvalue)({type:"strong",children:this.tokenizeInline(queue,now)}))}pedantic||"\\"!==character||(queue+=character,character=value.charAt(++index)),queue+=character,index++}}},function(module,exports,__webpack_require__){"use strict";module.exports=function(value,fromIndex){var asterisk=value.indexOf("**",fromIndex),underscore=value.indexOf("__",fromIndex);if(-1===underscore)return asterisk;if(-1===asterisk)return underscore;return underscore<asterisk?underscore:asterisk}},function(module,exports,__webpack_require__){"use strict";var trim=__webpack_require__(113),word=__webpack_require__(221),whitespace=__webpack_require__(109),locate=__webpack_require__(222);module.exports=emphasis,emphasis.locator=locate;function emphasis(eat,value,silent){var now,pedantic,marker,queue,subvalue,length,prev,index=0,character=value.charAt(index);if(!("*"!==character&&"_"!==character||(pedantic=this.options.pedantic,subvalue=character,marker=character,length=value.length,index++,queue="",character="",pedantic&&whitespace(value.charAt(index)))))for(;index<length;){if(prev=character,!((character=value.charAt(index))!==marker||pedantic&&whitespace(prev))){if((character=value.charAt(++index))!==marker){if(!trim(queue)||prev===marker)return;if(!pedantic&&"_"===marker&&word(character)){queue+=marker;continue}return!!silent||((now=eat.now()).column++,now.offset++,eat(subvalue+queue+marker)({type:"emphasis",children:this.tokenizeInline(queue,now)}))}queue+=marker}pedantic||"\\"!==character||(queue+=character,character=value.charAt(++index)),queue+=character,index++}}},function(module,exports,__webpack_require__){"use strict";module.exports=function(character){return re.test("number"==typeof character?fromCode(character):character.charAt(0))};var fromCode=String.fromCharCode,re=/\w/},function(module,exports,__webpack_require__){"use strict";module.exports=function(value,fromIndex){var asterisk=value.indexOf("*",fromIndex),underscore=value.indexOf("_",fromIndex);if(-1===underscore)return asterisk;if(-1===asterisk)return underscore;return underscore<asterisk?underscore:asterisk}},function(module,exports,__webpack_require__){"use strict";var whitespace=__webpack_require__(109),locate=__webpack_require__(224);module.exports=strikethrough,strikethrough.locator=locate;function strikethrough(eat,value,silent){var index,length,now,character="",previous="",preceding="",subvalue="";if(this.options.gfm&&"~"===value.charAt(0)&&"~"===value.charAt(1)&&!whitespace(value.charAt(2)))for(index=1,length=value.length,(now=eat.now()).column+=2,now.offset+=2;++index<length;){if(!("~"!==(character=value.charAt(index))||"~"!==previous||preceding&&whitespace(preceding)))return!!silent||eat("~~"+subvalue+"~~")({type:"delete",children:this.tokenizeInline(subvalue,now)});subvalue+=previous,preceding=previous,previous=character}}},function(module,exports,__webpack_require__){"use strict";module.exports=function(value,fromIndex){return value.indexOf("~~",fromIndex)}},function(module,exports,__webpack_require__){"use strict";var whitespace=__webpack_require__(109),locate=__webpack_require__(226);module.exports=inlineCode,inlineCode.locator=locate;function inlineCode(eat,value,silent){for(var contentQueue,subqueue,count,openingCount,subvalue,character,found,next,length=value.length,index=0,queue="",tickQueue="";index<length&&"`"===value.charAt(index);)queue+="`",index++;if(queue){for(subvalue=queue,openingCount=index,queue="",next=value.charAt(index),count=0;index<length;){if(character=next,next=value.charAt(index+1),"`"===character?(count++,tickQueue+=character):(count=0,queue+=character),count&&"`"!==next){if(count===openingCount){subvalue+=queue+tickQueue,found=!0;break}queue+=tickQueue,tickQueue=""}index++}if(!found){if(openingCount%2!=0)return;queue=""}if(silent)return!0;for(contentQueue="",subqueue="",length=queue.length,index=-1;++index<length;)character=queue.charAt(index),whitespace(character)?subqueue+=character:(subqueue&&(contentQueue&&(contentQueue+=subqueue),subqueue=""),contentQueue+=character);return eat(subvalue)({type:"inlineCode",value:contentQueue})}}},function(module,exports,__webpack_require__){"use strict";module.exports=function(value,fromIndex){return value.indexOf("`",fromIndex)}},function(module,exports,__webpack_require__){"use strict";var locate=__webpack_require__(228);module.exports=hardBreak,hardBreak.locator=locate;function hardBreak(eat,value,silent){for(var character,length=value.length,index=-1,queue="";++index<length;){if("\n"===(character=value.charAt(index))){if(index<2)return;return!!silent||eat(queue+=character)({type:"break"})}if(" "!==character)return;queue+=character}}},function(module,exports,__webpack_require__){"use strict";module.exports=function(value,fromIndex){var index=value.indexOf("\n",fromIndex);for(;index>fromIndex&&" "===value.charAt(index-1);)index--;return index}},function(module,exports,__webpack_require__){"use strict";module.exports=function(eat,value,silent){var methods,tokenizers,index,length,subvalue,position,tokenizer,name,min,now;if(silent)return!0;methods=this.inlineMethods,length=methods.length,tokenizers=this.inlineTokenizers,index=-1,min=value.length;for(;++index<length;)"text"!==(name=methods[index])&&tokenizers[name]&&((tokenizer=tokenizers[name].locator)||eat.file.fail("Missing locator: `"+name+"`"),-1!==(position=tokenizer.call(this,value,1))&&position<min&&(min=position));subvalue=value.slice(0,min),now=eat.now(),this.decode(subvalue,now,(function(content,position,source){eat(source||content)({type:"text",value:content})}))}},function(module,exports,__webpack_require__){module.exports=__webpack_require__(231)()},function(module,exports,__webpack_require__){"use strict";var ReactPropTypesSecret=__webpack_require__(232);function emptyFunction(){}function emptyFunctionWithReset(){}emptyFunctionWithReset.resetWarningCache=emptyFunction,module.exports=function(){function shim(props,propName,componentName,location,propFullName,secret){if(secret!==ReactPropTypesSecret){var err=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw err.name="Invariant Violation",err}}function getShim(){return shim}shim.isRequired=shim;var ReactPropTypes={array:shim,bool:shim,func:shim,number:shim,object:shim,string:shim,symbol:shim,any:shim,arrayOf:getShim,element:shim,elementType:shim,instanceOf:getShim,node:shim,objectOf:getShim,oneOf:getShim,oneOfType:getShim,shape:getShim,exact:getShim,checkPropTypes:emptyFunctionWithReset,resetWarningCache:emptyFunction};return ReactPropTypes.PropTypes=ReactPropTypes,ReactPropTypes}},function(module,exports,__webpack_require__){"use strict";module.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(module,exports,__webpack_require__){var visitWithParents=__webpack_require__(234);module.exports=function(){return function(ast){return visitWithParents(ast,"list",(function(listNode,parents){var i,n,depth=0;for(i=0,n=parents.length;i<n;i++)"list"===parents[i].type&&(depth+=1);for(i=0,n=listNode.children.length;i<n;i++){var child=listNode.children[i];child.index=i,child.ordered=listNode.ordered}listNode.depth=depth})),ast}}},function(module,exports,__webpack_require__){"use strict";module.exports=function(tree,type,visitor){var stack=[];"function"==typeof type&&(visitor=type,type=null);function one(node){var result;return type&&node.type!==type||(result=visitor(node,stack.concat())),node.children&&!1!==result?function(children,parent){var child,length=children.length,index=-1;stack.push(parent);for(;++index<length;)if((child=children[index])&&!1===one(child))return!1;return stack.pop(),!0}(node.children,node):result}one(tree)}},function(module,exports,__webpack_require__){"use strict";var visit=__webpack_require__(116),selfClosingRe=/^<(area|base|br|col|embed|hr|img|input|keygen|link|meta|param|source|track|wbr)\s*\/?>$/i,simpleTagRe=/^<(\/?)([a-z]+)\s*>$/;module.exports=function(tree){var open,currentParent;return visit(tree,"html",(function(node,index,parent){currentParent!==parent&&(open=[],currentParent=parent);var selfClosing=function(node){var match=node.value.match(selfClosingRe);return!!match&&match[1]}(node);if(selfClosing)return parent.children.splice(index,1,{type:"virtualHtml",tag:selfClosing,position:node.position}),!0;var current=function(node,parent){var match=node.value.match(simpleTagRe);return!!match&&{tag:match[2],opening:!match[1],node:node}}(node);if(!current)return!0;var matching=function(open,matchingTag){var i=open.length;for(;i--;)if(open[i].tag===matchingTag)return open.splice(i,1)[0];return!1}(open,current.tag);return matching?parent.children.splice(index,0,function(fromNode,toNode,parent){var fromIndex=parent.children.indexOf(fromNode.node),toIndex=parent.children.indexOf(toNode.node),children=parent.children.splice(fromIndex,toIndex-fromIndex+1).slice(1,-1);return{type:"virtualHtml",children:children,tag:fromNode.tag,position:{start:fromNode.node.position.start,end:toNode.node.position.end,indent:[]}}}(current,matching,parent)):current.opening||open.push(current),!0}),!0),tree}},function(module,exports,__webpack_require__){"use strict";var visit=__webpack_require__(116);function untangle(node,index,parent,mode){if("remove"===mode)parent.children.splice(index,1);else if("unwrap"===mode){var args=[index,1];node.children&&(args=args.concat(node.children)),Array.prototype.splice.apply(parent.children,args)}}exports.ofType=function(types,mode){return function(node){return types.forEach((function(type){return visit(node,type,disallow,!0)})),node};function disallow(node,index,parent){parent&&untangle(node,index,parent,mode)}},exports.ifNotMatch=function(allowNode,mode){return function(node){return visit(node,disallow,!0),node};function disallow(node,index,parent){parent&&!allowNode(node,index,parent)&&untangle(node,index,parent,mode)}}},function(module,exports,__webpack_require__){"use strict";var React=__webpack_require__(2),xtend=__webpack_require__(111),ReactIs=__webpack_require__(238),defaultNodePosition={start:{line:1,column:1,offset:0},end:{line:1,column:1,offset:0}};function astToReact(node,options){var parent=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},index=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,renderer=options.renderers[node.type];void 0===node.position&&(node.position=parent.node&&parent.node.position||defaultNodePosition);var pos=node.position.start,key=[node.type,pos.line,pos.column,index].join("-");if(!ReactIs.isValidElementType(renderer))throw new Error("Renderer for type `".concat(node.type,"` not defined or is not renderable"));var nodeProps=getNodeProps(node,key,options,renderer,parent,index);return React.createElement(renderer,nodeProps,nodeProps.children||resolveChildren()||void 0);function resolveChildren(){return node.children&&node.children.map((function(childNode,i){return astToReact(childNode,options,{node:node,props:nodeProps},i)}))}}function getNodeProps(node,key,opts,renderer,parent,index){var pos,props={key:key},isTagRenderer="string"==typeof renderer;opts.sourcePos&&node.position&&(props["data-sourcepos"]=[(pos=node.position).start.line,":",pos.start.column,"-",pos.end.line,":",pos.end.column].map(String).join("")),opts.rawSourcePos&&!isTagRenderer&&(props.sourcePosition=node.position),opts.includeNodeIndex&&parent.node&&parent.node.children&&!isTagRenderer&&(props.index=parent.node.children.indexOf(node),props.parentChildCount=parent.node.children.length);var ref=null!==node.identifier&&void 0!==node.identifier?opts.definitions[node.identifier]||{}:null;switch(node.type){case"root":assignDefined(props,{className:opts.className});break;case"text":props.nodeKey=key,props.children=node.value;break;case"heading":props.level=node.depth;break;case"list":props.start=node.start,props.ordered=node.ordered,props.tight=!node.loose,props.depth=node.depth;break;case"listItem":props.checked=node.checked,props.tight=!node.loose,props.ordered=node.ordered,props.index=node.index,props.children=function(node,parent){if(node.loose)return node.children;if(parent.node&&node.index>0&&parent.node.children[node.index-1].loose)return node.children;return function(node){return node.children.reduce((function(array,child){return array.concat("paragraph"===child.type?child.children||[]:[child])}),[])}(node)}(node,parent).map((function(childNode,i){return astToReact(childNode,opts,{node:node,props:props},i)}));break;case"definition":assignDefined(props,{identifier:node.identifier,title:node.title,url:node.url});break;case"code":assignDefined(props,{language:node.lang&&node.lang.split(/\s/,1)[0]});break;case"inlineCode":props.children=node.value,props.inline=!0;break;case"link":assignDefined(props,{title:node.title||void 0,target:"function"==typeof opts.linkTarget?opts.linkTarget(node.url,node.children,node.title):opts.linkTarget,href:opts.transformLinkUri?opts.transformLinkUri(node.url,node.children,node.title):node.url});break;case"image":assignDefined(props,{alt:node.alt||void 0,title:node.title||void 0,src:opts.transformImageUri?opts.transformImageUri(node.url,node.children,node.title,node.alt):node.url});break;case"linkReference":assignDefined(props,xtend(ref,{href:opts.transformLinkUri?opts.transformLinkUri(ref.href):ref.href}));break;case"imageReference":assignDefined(props,{src:opts.transformImageUri&&ref.href?opts.transformImageUri(ref.href,node.children,ref.title,node.alt):ref.href,title:ref.title||void 0,alt:node.alt||void 0});break;case"table":case"tableHead":case"tableBody":props.columnAlignment=node.align;break;case"tableRow":props.isHeader="tableHead"===parent.node.type,props.columnAlignment=parent.props.columnAlignment;break;case"tableCell":assignDefined(props,{isHeader:parent.props.isHeader,align:parent.props.columnAlignment[index]});break;case"virtualHtml":props.tag=node.tag;break;case"html":props.isBlock=node.position.start.line!==node.position.end.line,props.escapeHtml=opts.escapeHtml,props.skipHtml=opts.skipHtml;break;case"parsedHtml":var parsedChildren;node.children&&(parsedChildren=node.children.map((function(child,i){return astToReact(child,opts,{node:node,props:props},i)}))),props.escapeHtml=opts.escapeHtml,props.skipHtml=opts.skipHtml,props.element=function(node,parsedChildren){var el=node.element;if(Array.isArray(el)){var Fragment=React.Fragment||"div";return React.createElement(Fragment,null,el)}if(el.props.children||parsedChildren){var children=React.Children.toArray(el.props.children).concat(parsedChildren);return React.cloneElement(el,null,children)}return React.cloneElement(el,null)}(node,parsedChildren);break;default:assignDefined(props,xtend(node,{type:void 0,position:void 0,children:void 0}))}return!isTagRenderer&&node.value&&(props.value=node.value),props}function assignDefined(target,attrs){for(var key in attrs)void 0!==attrs[key]&&(target[key]=attrs[key])}module.exports=astToReact},function(module,exports,__webpack_require__){"use strict";module.exports=__webpack_require__(239)},function(module,exports,__webpack_require__){"use strict";
/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var b="function"==typeof Symbol&&Symbol.for,c=b?Symbol.for("react.element"):60103,d=b?Symbol.for("react.portal"):60106,e=b?Symbol.for("react.fragment"):60107,f=b?Symbol.for("react.strict_mode"):60108,g=b?Symbol.for("react.profiler"):60114,h=b?Symbol.for("react.provider"):60109,k=b?Symbol.for("react.context"):60110,l=b?Symbol.for("react.async_mode"):60111,m=b?Symbol.for("react.concurrent_mode"):60111,n=b?Symbol.for("react.forward_ref"):60112,p=b?Symbol.for("react.suspense"):60113,q=b?Symbol.for("react.suspense_list"):60120,r=b?Symbol.for("react.memo"):60115,t=b?Symbol.for("react.lazy"):60116,v=b?Symbol.for("react.block"):60121,w=b?Symbol.for("react.fundamental"):60117,x=b?Symbol.for("react.responder"):60118,y=b?Symbol.for("react.scope"):60119;function z(a){if("object"==typeof a&&null!==a){var u=a.$$typeof;switch(u){case c:switch(a=a.type){case l:case m:case e:case g:case f:case p:return a;default:switch(a=a&&a.$$typeof){case k:case n:case t:case r:case h:return a;default:return u}}case d:return u}}}function A(a){return z(a)===m}exports.AsyncMode=l,exports.ConcurrentMode=m,exports.ContextConsumer=k,exports.ContextProvider=h,exports.Element=c,exports.ForwardRef=n,exports.Fragment=e,exports.Lazy=t,exports.Memo=r,exports.Portal=d,exports.Profiler=g,exports.StrictMode=f,exports.Suspense=p,exports.isAsyncMode=function(a){return A(a)||z(a)===l},exports.isConcurrentMode=A,exports.isContextConsumer=function(a){return z(a)===k},exports.isContextProvider=function(a){return z(a)===h},exports.isElement=function(a){return"object"==typeof a&&null!==a&&a.$$typeof===c},exports.isForwardRef=function(a){return z(a)===n},exports.isFragment=function(a){return z(a)===e},exports.isLazy=function(a){return z(a)===t},exports.isMemo=function(a){return z(a)===r},exports.isPortal=function(a){return z(a)===d},exports.isProfiler=function(a){return z(a)===g},exports.isStrictMode=function(a){return z(a)===f},exports.isSuspense=function(a){return z(a)===p},exports.isValidElementType=function(a){return"string"==typeof a||"function"==typeof a||a===e||a===m||a===g||a===f||a===p||a===q||"object"==typeof a&&null!==a&&(a.$$typeof===t||a.$$typeof===r||a.$$typeof===h||a.$$typeof===k||a.$$typeof===n||a.$$typeof===w||a.$$typeof===x||a.$$typeof===y||a.$$typeof===v)},exports.typeOf=z},function(module,exports,__webpack_require__){"use strict";var visit=__webpack_require__(116);function wrap(table){var children=table.children;table.children=[{type:"tableHead",align:table.align,children:[children[0]],position:children[0].position}],children.length>1&&table.children.push({type:"tableBody",align:table.align,children:children.slice(1),position:{start:children[1].position.start,end:children[children.length-1].position.end}})}module.exports=function(node){return visit(node,"table",wrap),node}},function(module,exports,__webpack_require__){"use strict";module.exports=function getDefinitions(node){var defs=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(node.children||[]).reduce((function(definitions,child){return"definition"===child.type&&(definitions[child.identifier]={href:child.url,title:child.title}),getDefinitions(child,definitions)}),defs)}},function(module,exports,__webpack_require__){"use strict";var protocols=["http","https","mailto","tel"];module.exports=function(uri){var url=(uri||"").trim(),first=url.charAt(0);if("#"===first||"/"===first)return url;var colon=url.indexOf(":");if(-1===colon)return url;for(var length=protocols.length,index=-1;++index<length;){var protocol=protocols[index];if(colon===protocol.length&&url.slice(0,protocol.length).toLowerCase()===protocol)return url}return-1!==(index=url.indexOf("?"))&&colon>index||-1!==(index=url.indexOf("#"))&&colon>index?url:"javascript:void(0)"}},function(module,exports,__webpack_require__){"use strict";var xtend=__webpack_require__(111),React=__webpack_require__(2),supportsStringRender=parseInt((React.version||"16").slice(0,2),10)>=16,createElement=React.createElement;function SimpleRenderer(tag,props){return createElement(tag,getCoreProps(props),props.children)}function getCoreProps(props){return props["data-sourcepos"]?{"data-sourcepos":props["data-sourcepos"]}:{}}module.exports={break:"br",paragraph:"p",emphasis:"em",strong:"strong",thematicBreak:"hr",blockquote:"blockquote",delete:"del",link:"a",image:"img",linkReference:"a",imageReference:"img",table:SimpleRenderer.bind(null,"table"),tableHead:SimpleRenderer.bind(null,"thead"),tableBody:SimpleRenderer.bind(null,"tbody"),tableRow:SimpleRenderer.bind(null,"tr"),tableCell:function(props){var style=props.align?{textAlign:props.align}:void 0,coreProps=getCoreProps(props);return createElement(props.isHeader?"th":"td",style?xtend({style:style},coreProps):coreProps,props.children)},root:function(props){var useFragment=!props.className,root=useFragment&&React.Fragment||"div";return createElement(root,useFragment?null:props,props.children)},text:function(props){return supportsStringRender?props.children:createElement("span",null,props.children)},list:function(props){var attrs=getCoreProps(props);null!==props.start&&1!==props.start&&void 0!==props.start&&(attrs.start=props.start.toString());return createElement(props.ordered?"ol":"ul",attrs,props.children)},listItem:function(props){var checkbox=null;if(null!==props.checked&&void 0!==props.checked){var checked=props.checked;checkbox=createElement("input",{type:"checkbox",checked:checked,readOnly:!0})}return createElement("li",getCoreProps(props),checkbox,props.children)},definition:function(){return null},heading:function(props){return createElement("h".concat(props.level),getCoreProps(props),props.children)},inlineCode:function(props){return createElement("code",getCoreProps(props),props.children)},code:function(props){var className=props.language&&"language-".concat(props.language),code=createElement("code",className?{className:className}:null,props.value);return createElement("pre",getCoreProps(props),code)},html:function(props){if(props.skipHtml)return null;var tag=props.isBlock?"div":"span";if(props.escapeHtml){var comp=React.Fragment||tag;return createElement(comp,null,props.value)}var nodeProps={dangerouslySetInnerHTML:{__html:props.value}};return createElement(tag,nodeProps)},virtualHtml:function(props){return createElement(props.tag,getCoreProps(props),props.children)},parsedHtml:function(props){return props["data-sourcepos"]?React.cloneElement(props.element,{"data-sourcepos":props["data-sourcepos"]}):props.element}}},function(module,exports,__webpack_require__){"use strict";exports.HtmlParser="undefined"==typeof Symbol?"__RMD_HTML_PARSER__":Symbol("__RMD_HTML_PARSER__")},function(module,exports,__webpack_require__){switch(window.__kbnThemeTag__){case"v7dark":return __webpack_require__(246);case"v7light":return __webpack_require__(248);case"v8dark":return __webpack_require__(250);case"v8light":return __webpack_require__(252)}},function(module,exports,__webpack_require__){var api=__webpack_require__(117),content=__webpack_require__(247);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){(exports=__webpack_require__(118)(!1)).push([module.i,".fleet__epm__shiftNavTabs{margin-left:184px}\n",""]),module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(117),content=__webpack_require__(249);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){(exports=__webpack_require__(118)(!1)).push([module.i,".fleet__epm__shiftNavTabs{margin-left:184px}\n",""]),module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(117),content=__webpack_require__(251);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){(exports=__webpack_require__(118)(!1)).push([module.i,".fleet__epm__shiftNavTabs{margin-left:184px}\n",""]),module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(117),content=__webpack_require__(253);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){(exports=__webpack_require__(118)(!1)).push([module.i,".fleet__epm__shiftNavTabs{margin-left:184px}\n",""]),module.exports=exports},function(module,exports,__webpack_require__){"use strict";var punycode=__webpack_require__(255),util=__webpack_require__(257);function Url(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}exports.parse=urlParse,exports.resolve=function(source,relative){return urlParse(source,!1,!0).resolve(relative)},exports.resolveObject=function(source,relative){return source?urlParse(source,!1,!0).resolveObject(relative):relative},exports.format=function(obj){util.isString(obj)&&(obj=urlParse(obj));return obj instanceof Url?obj.format():Url.prototype.format.call(obj)},exports.Url=Url;var protocolPattern=/^([a-z0-9.+-]+:)/i,portPattern=/:[0-9]*$/,simplePathPattern=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,unwise=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),autoEscape=["'"].concat(unwise),nonHostChars=["%","/","?",";","#"].concat(autoEscape),hostEndingChars=["/","?","#"],hostnamePartPattern=/^[+a-z0-9A-Z_-]{0,63}$/,hostnamePartStart=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,unsafeProtocol={javascript:!0,"javascript:":!0},hostlessProtocol={javascript:!0,"javascript:":!0},slashedProtocol={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},querystring=__webpack_require__(258);function urlParse(url,parseQueryString,slashesDenoteHost){if(url&&util.isObject(url)&&url instanceof Url)return url;var u=new Url;return u.parse(url,parseQueryString,slashesDenoteHost),u}Url.prototype.parse=function(url,parseQueryString,slashesDenoteHost){if(!util.isString(url))throw new TypeError("Parameter 'url' must be a string, not "+typeof url);var queryIndex=url.indexOf("?"),splitter=-1!==queryIndex&&queryIndex<url.indexOf("#")?"?":"#",uSplit=url.split(splitter);uSplit[0]=uSplit[0].replace(/\\/g,"/");var rest=url=uSplit.join(splitter);if(rest=rest.trim(),!slashesDenoteHost&&1===url.split("#").length){var simplePath=simplePathPattern.exec(rest);if(simplePath)return this.path=rest,this.href=rest,this.pathname=simplePath[1],simplePath[2]?(this.search=simplePath[2],this.query=parseQueryString?querystring.parse(this.search.substr(1)):this.search.substr(1)):parseQueryString&&(this.search="",this.query={}),this}var proto=protocolPattern.exec(rest);if(proto){var lowerProto=(proto=proto[0]).toLowerCase();this.protocol=lowerProto,rest=rest.substr(proto.length)}if(slashesDenoteHost||proto||rest.match(/^\/\/[^@\/]+@[^@\/]+/)){var slashes="//"===rest.substr(0,2);!slashes||proto&&hostlessProtocol[proto]||(rest=rest.substr(2),this.slashes=!0)}if(!hostlessProtocol[proto]&&(slashes||proto&&!slashedProtocol[proto])){for(var auth,atSign,hostEnd=-1,i=0;i<hostEndingChars.length;i++){-1!==(hec=rest.indexOf(hostEndingChars[i]))&&(-1===hostEnd||hec<hostEnd)&&(hostEnd=hec)}-1!==(atSign=-1===hostEnd?rest.lastIndexOf("@"):rest.lastIndexOf("@",hostEnd))&&(auth=rest.slice(0,atSign),rest=rest.slice(atSign+1),this.auth=decodeURIComponent(auth)),hostEnd=-1;for(i=0;i<nonHostChars.length;i++){var hec;-1!==(hec=rest.indexOf(nonHostChars[i]))&&(-1===hostEnd||hec<hostEnd)&&(hostEnd=hec)}-1===hostEnd&&(hostEnd=rest.length),this.host=rest.slice(0,hostEnd),rest=rest.slice(hostEnd),this.parseHost(),this.hostname=this.hostname||"";var ipv6Hostname="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!ipv6Hostname)for(var hostparts=this.hostname.split(/\./),l=(i=0,hostparts.length);i<l;i++){var part=hostparts[i];if(part&&!part.match(hostnamePartPattern)){for(var newpart="",j=0,k=part.length;j<k;j++)part.charCodeAt(j)>127?newpart+="x":newpart+=part[j];if(!newpart.match(hostnamePartPattern)){var validParts=hostparts.slice(0,i),notHost=hostparts.slice(i+1),bit=part.match(hostnamePartStart);bit&&(validParts.push(bit[1]),notHost.unshift(bit[2])),notHost.length&&(rest="/"+notHost.join(".")+rest),this.hostname=validParts.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),ipv6Hostname||(this.hostname=punycode.toASCII(this.hostname));var p=this.port?":"+this.port:"",h=this.hostname||"";this.host=h+p,this.href+=this.host,ipv6Hostname&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==rest[0]&&(rest="/"+rest))}if(!unsafeProtocol[lowerProto])for(i=0,l=autoEscape.length;i<l;i++){var ae=autoEscape[i];if(-1!==rest.indexOf(ae)){var esc=encodeURIComponent(ae);esc===ae&&(esc=escape(ae)),rest=rest.split(ae).join(esc)}}var hash=rest.indexOf("#");-1!==hash&&(this.hash=rest.substr(hash),rest=rest.slice(0,hash));var qm=rest.indexOf("?");if(-1!==qm?(this.search=rest.substr(qm),this.query=rest.substr(qm+1),parseQueryString&&(this.query=querystring.parse(this.query)),rest=rest.slice(0,qm)):parseQueryString&&(this.search="",this.query={}),rest&&(this.pathname=rest),slashedProtocol[lowerProto]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){p=this.pathname||"";var s=this.search||"";this.path=p+s}return this.href=this.format(),this},Url.prototype.format=function(){var auth=this.auth||"";auth&&(auth=(auth=encodeURIComponent(auth)).replace(/%3A/i,":"),auth+="@");var protocol=this.protocol||"",pathname=this.pathname||"",hash=this.hash||"",host=!1,query="";this.host?host=auth+this.host:this.hostname&&(host=auth+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(host+=":"+this.port)),this.query&&util.isObject(this.query)&&Object.keys(this.query).length&&(query=querystring.stringify(this.query));var search=this.search||query&&"?"+query||"";return protocol&&":"!==protocol.substr(-1)&&(protocol+=":"),this.slashes||(!protocol||slashedProtocol[protocol])&&!1!==host?(host="//"+(host||""),pathname&&"/"!==pathname.charAt(0)&&(pathname="/"+pathname)):host||(host=""),hash&&"#"!==hash.charAt(0)&&(hash="#"+hash),search&&"?"!==search.charAt(0)&&(search="?"+search),protocol+host+(pathname=pathname.replace(/[?#]/g,(function(match){return encodeURIComponent(match)})))+(search=search.replace("#","%23"))+hash},Url.prototype.resolve=function(relative){return this.resolveObject(urlParse(relative,!1,!0)).format()},Url.prototype.resolveObject=function(relative){if(util.isString(relative)){var rel=new Url;rel.parse(relative,!1,!0),relative=rel}for(var result=new Url,tkeys=Object.keys(this),tk=0;tk<tkeys.length;tk++){var tkey=tkeys[tk];result[tkey]=this[tkey]}if(result.hash=relative.hash,""===relative.href)return result.href=result.format(),result;if(relative.slashes&&!relative.protocol){for(var rkeys=Object.keys(relative),rk=0;rk<rkeys.length;rk++){var rkey=rkeys[rk];"protocol"!==rkey&&(result[rkey]=relative[rkey])}return slashedProtocol[result.protocol]&&result.hostname&&!result.pathname&&(result.path=result.pathname="/"),result.href=result.format(),result}if(relative.protocol&&relative.protocol!==result.protocol){if(!slashedProtocol[relative.protocol]){for(var keys=Object.keys(relative),v=0;v<keys.length;v++){var k=keys[v];result[k]=relative[k]}return result.href=result.format(),result}if(result.protocol=relative.protocol,relative.host||hostlessProtocol[relative.protocol])result.pathname=relative.pathname;else{for(var relPath=(relative.pathname||"").split("/");relPath.length&&!(relative.host=relPath.shift()););relative.host||(relative.host=""),relative.hostname||(relative.hostname=""),""!==relPath[0]&&relPath.unshift(""),relPath.length<2&&relPath.unshift(""),result.pathname=relPath.join("/")}if(result.search=relative.search,result.query=relative.query,result.host=relative.host||"",result.auth=relative.auth,result.hostname=relative.hostname||relative.host,result.port=relative.port,result.pathname||result.search){var p=result.pathname||"",s=result.search||"";result.path=p+s}return result.slashes=result.slashes||relative.slashes,result.href=result.format(),result}var isSourceAbs=result.pathname&&"/"===result.pathname.charAt(0),isRelAbs=relative.host||relative.pathname&&"/"===relative.pathname.charAt(0),mustEndAbs=isRelAbs||isSourceAbs||result.host&&relative.pathname,removeAllDots=mustEndAbs,srcPath=result.pathname&&result.pathname.split("/")||[],psychotic=(relPath=relative.pathname&&relative.pathname.split("/")||[],result.protocol&&!slashedProtocol[result.protocol]);if(psychotic&&(result.hostname="",result.port=null,result.host&&(""===srcPath[0]?srcPath[0]=result.host:srcPath.unshift(result.host)),result.host="",relative.protocol&&(relative.hostname=null,relative.port=null,relative.host&&(""===relPath[0]?relPath[0]=relative.host:relPath.unshift(relative.host)),relative.host=null),mustEndAbs=mustEndAbs&&(""===relPath[0]||""===srcPath[0])),isRelAbs)result.host=relative.host||""===relative.host?relative.host:result.host,result.hostname=relative.hostname||""===relative.hostname?relative.hostname:result.hostname,result.search=relative.search,result.query=relative.query,srcPath=relPath;else if(relPath.length)srcPath||(srcPath=[]),srcPath.pop(),srcPath=srcPath.concat(relPath),result.search=relative.search,result.query=relative.query;else if(!util.isNullOrUndefined(relative.search)){if(psychotic)result.hostname=result.host=srcPath.shift(),(authInHost=!!(result.host&&result.host.indexOf("@")>0)&&result.host.split("@"))&&(result.auth=authInHost.shift(),result.host=result.hostname=authInHost.shift());return result.search=relative.search,result.query=relative.query,util.isNull(result.pathname)&&util.isNull(result.search)||(result.path=(result.pathname?result.pathname:"")+(result.search?result.search:"")),result.href=result.format(),result}if(!srcPath.length)return result.pathname=null,result.search?result.path="/"+result.search:result.path=null,result.href=result.format(),result;for(var last=srcPath.slice(-1)[0],hasTrailingSlash=(result.host||relative.host||srcPath.length>1)&&("."===last||".."===last)||""===last,up=0,i=srcPath.length;i>=0;i--)"."===(last=srcPath[i])?srcPath.splice(i,1):".."===last?(srcPath.splice(i,1),up++):up&&(srcPath.splice(i,1),up--);if(!mustEndAbs&&!removeAllDots)for(;up--;up)srcPath.unshift("..");!mustEndAbs||""===srcPath[0]||srcPath[0]&&"/"===srcPath[0].charAt(0)||srcPath.unshift(""),hasTrailingSlash&&"/"!==srcPath.join("/").substr(-1)&&srcPath.push("");var authInHost,isAbsolute=""===srcPath[0]||srcPath[0]&&"/"===srcPath[0].charAt(0);psychotic&&(result.hostname=result.host=isAbsolute?"":srcPath.length?srcPath.shift():"",(authInHost=!!(result.host&&result.host.indexOf("@")>0)&&result.host.split("@"))&&(result.auth=authInHost.shift(),result.host=result.hostname=authInHost.shift()));return(mustEndAbs=mustEndAbs||result.host&&srcPath.length)&&!isAbsolute&&srcPath.unshift(""),srcPath.length?result.pathname=srcPath.join("/"):(result.pathname=null,result.path=null),util.isNull(result.pathname)&&util.isNull(result.search)||(result.path=(result.pathname?result.pathname:"")+(result.search?result.search:"")),result.auth=relative.auth||result.auth,result.slashes=result.slashes||relative.slashes,result.href=result.format(),result},Url.prototype.parseHost=function(){var host=this.host,port=portPattern.exec(host);port&&(":"!==(port=port[0])&&(this.port=port.substr(1)),host=host.substr(0,host.length-port.length)),host&&(this.hostname=host)}},function(module,exports,__webpack_require__){(function(module,global){var __WEBPACK_AMD_DEFINE_RESULT__;/*! https://mths.be/punycode v1.4.1 by @mathias */!function(root){exports&&exports.nodeType,module&&module.nodeType;var freeGlobal="object"==typeof global&&global;freeGlobal.global!==freeGlobal&&freeGlobal.window!==freeGlobal&&freeGlobal.self;var punycode,maxInt=2147483647,regexPunycode=/^xn--/,regexNonASCII=/[^\x20-\x7E]/,regexSeparators=/[\x2E\u3002\uFF0E\uFF61]/g,errors={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},floor=Math.floor,stringFromCharCode=String.fromCharCode;function error(type){throw new RangeError(errors[type])}function map(array,fn){for(var length=array.length,result=[];length--;)result[length]=fn(array[length]);return result}function mapDomain(string,fn){var parts=string.split("@"),result="";return parts.length>1&&(result=parts[0]+"@",string=parts[1]),result+map((string=string.replace(regexSeparators,".")).split("."),fn).join(".")}function ucs2decode(string){for(var value,extra,output=[],counter=0,length=string.length;counter<length;)(value=string.charCodeAt(counter++))>=55296&&value<=56319&&counter<length?56320==(64512&(extra=string.charCodeAt(counter++)))?output.push(((1023&value)<<10)+(1023&extra)+65536):(output.push(value),counter--):output.push(value);return output}function ucs2encode(array){return map(array,(function(value){var output="";return value>65535&&(output+=stringFromCharCode((value-=65536)>>>10&1023|55296),value=56320|1023&value),output+=stringFromCharCode(value)})).join("")}function digitToBasic(digit,flag){return digit+22+75*(digit<26)-((0!=flag)<<5)}function adapt(delta,numPoints,firstTime){var k=0;for(delta=firstTime?floor(delta/700):delta>>1,delta+=floor(delta/numPoints);delta>455;k+=36)delta=floor(delta/35);return floor(k+36*delta/(delta+38))}function decode(input){var out,basic,j,index,oldi,w,k,digit,t,baseMinusT,codePoint,output=[],inputLength=input.length,i=0,n=128,bias=72;for((basic=input.lastIndexOf("-"))<0&&(basic=0),j=0;j<basic;++j)input.charCodeAt(j)>=128&&error("not-basic"),output.push(input.charCodeAt(j));for(index=basic>0?basic+1:0;index<inputLength;){for(oldi=i,w=1,k=36;index>=inputLength&&error("invalid-input"),((digit=(codePoint=input.charCodeAt(index++))-48<10?codePoint-22:codePoint-65<26?codePoint-65:codePoint-97<26?codePoint-97:36)>=36||digit>floor((maxInt-i)/w))&&error("overflow"),i+=digit*w,!(digit<(t=k<=bias?1:k>=bias+26?26:k-bias));k+=36)w>floor(maxInt/(baseMinusT=36-t))&&error("overflow"),w*=baseMinusT;bias=adapt(i-oldi,out=output.length+1,0==oldi),floor(i/out)>maxInt-n&&error("overflow"),n+=floor(i/out),i%=out,output.splice(i++,0,n)}return ucs2encode(output)}function encode(input){var n,delta,handledCPCount,basicLength,bias,j,m,q,k,t,currentValue,inputLength,handledCPCountPlusOne,baseMinusT,qMinusT,output=[];for(inputLength=(input=ucs2decode(input)).length,n=128,delta=0,bias=72,j=0;j<inputLength;++j)(currentValue=input[j])<128&&output.push(stringFromCharCode(currentValue));for(handledCPCount=basicLength=output.length,basicLength&&output.push("-");handledCPCount<inputLength;){for(m=maxInt,j=0;j<inputLength;++j)(currentValue=input[j])>=n&&currentValue<m&&(m=currentValue);for(m-n>floor((maxInt-delta)/(handledCPCountPlusOne=handledCPCount+1))&&error("overflow"),delta+=(m-n)*handledCPCountPlusOne,n=m,j=0;j<inputLength;++j)if((currentValue=input[j])<n&&++delta>maxInt&&error("overflow"),currentValue==n){for(q=delta,k=36;!(q<(t=k<=bias?1:k>=bias+26?26:k-bias));k+=36)qMinusT=q-t,baseMinusT=36-t,output.push(stringFromCharCode(digitToBasic(t+qMinusT%baseMinusT,0))),q=floor(qMinusT/baseMinusT);output.push(stringFromCharCode(digitToBasic(q,0))),bias=adapt(delta,handledCPCountPlusOne,handledCPCount==basicLength),delta=0,++handledCPCount}++delta,++n}return output.join("")}punycode={version:"1.4.1",ucs2:{decode:ucs2decode,encode:ucs2encode},decode:decode,encode:encode,toASCII:function(input){return mapDomain(input,(function(string){return regexNonASCII.test(string)?"xn--"+encode(string):string}))},toUnicode:function(input){return mapDomain(input,(function(string){return regexPunycode.test(string)?decode(string.slice(4).toLowerCase()):string}))}},void 0===(__WEBPACK_AMD_DEFINE_RESULT__=function(){return punycode}.call(exports,__webpack_require__,exports,module))||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)}()}).call(this,__webpack_require__(256)(module),__webpack_require__(64))},function(module,exports){module.exports=function(module){return module.webpackPolyfill||(module.deprecate=function(){},module.paths=[],module.children||(module.children=[]),Object.defineProperty(module,"loaded",{enumerable:!0,get:function(){return module.l}}),Object.defineProperty(module,"id",{enumerable:!0,get:function(){return module.i}}),module.webpackPolyfill=1),module}},function(module,exports,__webpack_require__){"use strict";module.exports={isString:function(arg){return"string"==typeof arg},isObject:function(arg){return"object"==typeof arg&&null!==arg},isNull:function(arg){return null===arg},isNullOrUndefined:function(arg){return null==arg}}},function(module,exports,__webpack_require__){"use strict";exports.decode=exports.parse=__webpack_require__(259),exports.encode=exports.stringify=__webpack_require__(260)},function(module,exports,__webpack_require__){"use strict";function hasOwnProperty(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}module.exports=function(qs,sep,eq,options){sep=sep||"&",eq=eq||"=";var obj={};if("string"!=typeof qs||0===qs.length)return obj;var regexp=/\+/g;qs=qs.split(sep);var maxKeys=1e3;options&&"number"==typeof options.maxKeys&&(maxKeys=options.maxKeys);var len=qs.length;maxKeys>0&&len>maxKeys&&(len=maxKeys);for(var i=0;i<len;++i){var kstr,vstr,k,v,x=qs[i].replace(regexp,"%20"),idx=x.indexOf(eq);idx>=0?(kstr=x.substr(0,idx),vstr=x.substr(idx+1)):(kstr=x,vstr=""),k=decodeURIComponent(kstr),v=decodeURIComponent(vstr),hasOwnProperty(obj,k)?isArray(obj[k])?obj[k].push(v):obj[k]=[obj[k],v]:obj[k]=v}return obj};var isArray=Array.isArray||function(xs){return"[object Array]"===Object.prototype.toString.call(xs)}},function(module,exports,__webpack_require__){"use strict";var stringifyPrimitive=function(v){switch(typeof v){case"string":return v;case"boolean":return v?"true":"false";case"number":return isFinite(v)?v:"";default:return""}};module.exports=function(obj,sep,eq,name){return sep=sep||"&",eq=eq||"=",null===obj&&(obj=void 0),"object"==typeof obj?map(objectKeys(obj),(function(k){var ks=encodeURIComponent(stringifyPrimitive(k))+eq;return isArray(obj[k])?map(obj[k],(function(v){return ks+encodeURIComponent(stringifyPrimitive(v))})).join(sep):ks+encodeURIComponent(stringifyPrimitive(obj[k]))})).join(sep):name?encodeURIComponent(stringifyPrimitive(name))+eq+encodeURIComponent(stringifyPrimitive(obj)):""};var isArray=Array.isArray||function(xs){return"[object Array]"===Object.prototype.toString.call(xs)};function map(xs,f){if(xs.map)return xs.map(f);for(var res=[],i=0;i<xs.length;i++)res.push(f(xs[i],i));return res}var objectKeys=Object.keys||function(obj){var res=[];for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&res.push(key);return res}},function(module,exports,__webpack_require__){const compare=__webpack_require__(65);module.exports=(a,b,loose)=>compare(a,b,loose)>=0},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var tslib_1=__webpack_require__(100),react_1=__webpack_require__(2),useIsomorphicLayoutEffect_1=tslib_1.__importDefault(__webpack_require__(142)),util_1=__webpack_require__(263),defaultState={x:0,y:0,width:0,height:0,top:0,left:0,bottom:0,right:0};exports.default=util_1.isClient&&window.ResizeObserver?function(){var _a=react_1.useState(null),element=_a[0],ref=_a[1],_b=react_1.useState(defaultState),rect=_b[0],setRect=_b[1],observer=react_1.useMemo((function(){return new window.ResizeObserver((function(entries){if(entries[0]){var _a=entries[0].contentRect,x=_a.x,y=_a.y,width=_a.width,height=_a.height,top_1=_a.top,left=_a.left,bottom=_a.bottom,right=_a.right;setRect({x:x,y:y,width:width,height:height,top:top_1,left:left,bottom:bottom,right:right})}}))}),[]);return useIsomorphicLayoutEffect_1.default((function(){if(element)return observer.observe(element),function(){observer.disconnect()}}),[element]),[ref,rect]}:function(){return[function(){},defaultState]}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isDeepEqual=exports.off=exports.on=exports.isClient=void 0;var react_1=__webpack_require__(100).__importDefault(__webpack_require__(264));exports.isClient="object"==typeof window,exports.on=function(obj){for(var args=[],_i=1;_i<arguments.length;_i++)args[_i-1]=arguments[_i];return obj.addEventListener.apply(obj,args)},exports.off=function(obj){for(var args=[],_i=1;_i<arguments.length;_i++)args[_i-1]=arguments[_i];return obj.removeEventListener.apply(obj,args)},exports.isDeepEqual=react_1.default},function(module,exports,__webpack_require__){"use strict";module.exports=function equal(a,b){if(a===b)return!0;if(a&&b&&"object"==typeof a&&"object"==typeof b){if(a.constructor!==b.constructor)return!1;var length,i,keys;if(Array.isArray(a)){if((length=a.length)!=b.length)return!1;for(i=length;0!=i--;)if(!equal(a[i],b[i]))return!1;return!0}if(a.constructor===RegExp)return a.source===b.source&&a.flags===b.flags;if(a.valueOf!==Object.prototype.valueOf)return a.valueOf()===b.valueOf();if(a.toString!==Object.prototype.toString)return a.toString()===b.toString();if((length=(keys=Object.keys(a)).length)!==Object.keys(b).length)return!1;for(i=length;0!=i--;)if(!Object.prototype.hasOwnProperty.call(b,keys[i]))return!1;for(i=length;0!=i--;){var key=keys[i];if(("_owner"!==key||!a.$$typeof)&&!equal(a[key],b[key]))return!1}return!0}return a!=a&&b!=b}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var tslib_1=__webpack_require__(100),react_1=__webpack_require__(2),useIsomorphicLayoutEffect_1=tslib_1.__importDefault(__webpack_require__(142));exports.default=function(observable$,initialValue){var _a=react_1.useState(initialValue),value=_a[0],update=_a[1];return useIsomorphicLayoutEffect_1.default((function(){var s=observable$.subscribe(update);return function(){return s.unsubscribe()}}),[observable$]),value}},function(module,exports,__webpack_require__){"use strict";module.exports=__webpack_require__(267)},function(module,exports,__webpack_require__){"use strict";function _interopDefault(n){return n&&"object"==typeof n&&"default"in n?n.default:n}Object.defineProperty(exports,"__esModule",{value:!0});var resolvePathname=_interopDefault(__webpack_require__(268)),valueEqual=_interopDefault(__webpack_require__(269));__webpack_require__(270);var invariant=_interopDefault(__webpack_require__(271));function _extends(){return(_extends=Object.assign||function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[a]=e[a])}return n}).apply(this,arguments)}function addLeadingSlash(n){return"/"===n.charAt(0)?n:"/"+n}function stripLeadingSlash(n){return"/"===n.charAt(0)?n.substr(1):n}function stripBasename(n,t){return function(n,t){return new RegExp("^"+t+"(\\/|\\?|#|$)","i").test(n)}(n,t)?n.substr(t.length):n}function stripTrailingSlash(n){return"/"===n.charAt(n.length-1)?n.slice(0,-1):n}function parsePath(n){var t=n||"/",e="",a="",o=t.indexOf("#");-1!==o&&(a=t.substr(o),t=t.substr(0,o));var r=t.indexOf("?");return-1!==r&&(e=t.substr(r),t=t.substr(0,r)),{pathname:t,search:"?"===e?"":e,hash:"#"===a?"":a}}function createPath(n){var t=n.pathname,e=n.search,a=n.hash,o=t||"/";return e&&"?"!==e&&(o+="?"===e.charAt(0)?e:"?"+e),a&&"#"!==a&&(o+="#"===a.charAt(0)?a:"#"+a),o}function createLocation(n,t,e,a){var o;"string"==typeof n?(o=parsePath(n)).state=t:(void 0===(o=_extends({},n)).pathname&&(o.pathname=""),o.search?"?"!==o.search.charAt(0)&&(o.search="?"+o.search):o.search="",o.hash?"#"!==o.hash.charAt(0)&&(o.hash="#"+o.hash):o.hash="",void 0!==t&&void 0===o.state&&(o.state=t));try{o.pathname=decodeURI(o.pathname)}catch(n){throw n instanceof URIError?new URIError('Pathname "'+o.pathname+'" could not be decoded. This is likely caused by an invalid percent-encoding.'):n}return e&&(o.key=e),a?o.pathname?"/"!==o.pathname.charAt(0)&&(o.pathname=resolvePathname(o.pathname,a.pathname)):o.pathname=a.pathname:o.pathname||(o.pathname="/"),o}function locationsAreEqual(n,t){return n.pathname===t.pathname&&n.search===t.search&&n.hash===t.hash&&n.key===t.key&&valueEqual(n.state,t.state)}function createTransitionManager(){var r=null,a=[];return{setPrompt:function(n){return r=n,function(){r===n&&(r=null)}},confirmTransitionTo:function(n,t,e,a){if(null!=r){var o="function"==typeof r?r(n,t):r;"string"==typeof o?"function"==typeof e?e(o,a):a(!0):a(!1!==o)}else a(!0)},appendListener:function(n){var t=!0;function e(){t&&n.apply(void 0,arguments)}return a.push(e),function(){t=!1,a=a.filter((function(n){return n!==e}))}},notifyListeners:function(){for(var n=arguments.length,t=new Array(n),e=0;e<n;e++)t[e]=arguments[e];a.forEach((function(n){return n.apply(void 0,t)}))}}}var canUseDOM=!("undefined"==typeof window||!window.document||!window.document.createElement);function getConfirmation(n,t){t(window.confirm(n))}function getHistoryState(){try{return window.history.state||{}}catch(n){return{}}}var HashPathCoders={hashbang:{encodePath:function(n){return"!"===n.charAt(0)?n:"!/"+stripLeadingSlash(n)},decodePath:function(n){return"!"===n.charAt(0)?n.substr(1):n}},noslash:{encodePath:stripLeadingSlash,decodePath:addLeadingSlash},slash:{encodePath:addLeadingSlash,decodePath:addLeadingSlash}};function getHashPath(){var n=window.location.href,t=n.indexOf("#");return-1===t?"":n.substring(t+1)}function replaceHashPath(n){var t=window.location.href.indexOf("#");window.location.replace(window.location.href.slice(0,0<=t?t:0)+"#"+n)}function clamp(n,t,e){return Math.min(Math.max(n,t),e)}exports.createBrowserHistory=function(n){void 0===n&&(n={}),canUseDOM||invariant(!1);var c=window.history,s=function(){var n=window.navigator.userAgent;return(-1===n.indexOf("Android 2.")&&-1===n.indexOf("Android 4.0")||-1===n.indexOf("Mobile Safari")||-1!==n.indexOf("Chrome")||-1!==n.indexOf("Windows Phone"))&&window.history&&"pushState"in window.history}(),t=!(-1===window.navigator.userAgent.indexOf("Trident")),e=n,a=e.forceRefresh,h=void 0!==a&&a,o=e.getUserConfirmation,u=void 0===o?getConfirmation:o,r=e.keyLength,i=void 0===r?6:r,f=n.basename?stripTrailingSlash(addLeadingSlash(n.basename)):"";function l(n){var t=n||{},e=t.key,a=t.state,o=window.location,r=o.pathname+o.search+o.hash;return f&&(r=stripBasename(r,f)),createLocation(r,a,e)}function d(){return Math.random().toString(36).substr(2,i)}var v=createTransitionManager();function p(n){_extends(T,n),T.length=c.length,v.notifyListeners(T.location,T.action)}function g(n){(function(n){void 0===n.state&&navigator.userAgent.indexOf("CriOS")})(n)||w(l(n.state))}function P(){w(l(getHistoryState()))}var m=!1;function w(t){m?(m=!1,p()):v.confirmTransitionTo(t,"POP",u,(function(n){n?p({action:"POP",location:t}):function(n){var t=T.location,e=H.indexOf(t.key);-1===e&&(e=0);var a=H.indexOf(n.key);-1===a&&(a=0);var o=e-a;o&&(m=!0,L(o))}(t)}))}var y=l(getHistoryState()),H=[y.key];function x(n){return f+createPath(n)}function L(n){c.go(n)}var O=0;function E(n){1===(O+=n)&&1===n?(window.addEventListener("popstate",g),t&&window.addEventListener("hashchange",P)):0===O&&(window.removeEventListener("popstate",g),t&&window.removeEventListener("hashchange",P))}var S=!1,T={length:c.length,action:"POP",location:y,createHref:x,push:function(n,t){var i=createLocation(n,t,d(),T.location);v.confirmTransitionTo(i,"PUSH",u,(function(n){if(n){var t=x(i),e=i.key,a=i.state;if(s)if(c.pushState({key:e,state:a},null,t),h)window.location.href=t;else{var o=H.indexOf(T.location.key),r=H.slice(0,-1===o?0:o+1);r.push(i.key),H=r,p({action:"PUSH",location:i})}else window.location.href=t}}))},replace:function(n,t){var r="REPLACE",i=createLocation(n,t,d(),T.location);v.confirmTransitionTo(i,r,u,(function(n){if(n){var t=x(i),e=i.key,a=i.state;if(s)if(c.replaceState({key:e,state:a},null,t),h)window.location.replace(t);else{var o=H.indexOf(T.location.key);-1!==o&&(H[o]=i.key),p({action:r,location:i})}else window.location.replace(t)}}))},go:L,goBack:function(){L(-1)},goForward:function(){L(1)},block:function(n){void 0===n&&(n=!1);var t=v.setPrompt(n);return S||(E(1),S=!0),function(){return S&&(S=!1,E(-1)),t()}},listen:function(n){var t=v.appendListener(n);return E(1),function(){E(-1),t()}}};return T},exports.createHashHistory=function(n){void 0===n&&(n={}),canUseDOM||invariant(!1);var t=window.history,e=(window.navigator.userAgent.indexOf("Firefox"),n),a=e.getUserConfirmation,i=void 0===a?getConfirmation:a,o=e.hashType,r=void 0===o?"slash":o,c=n.basename?stripTrailingSlash(addLeadingSlash(n.basename)):"",s=HashPathCoders[r],h=s.encodePath,u=s.decodePath;function f(){var n=u(getHashPath());return c&&(n=stripBasename(n,c)),createLocation(n)}var l=createTransitionManager();function d(n){_extends(E,n),E.length=t.length,l.notifyListeners(E.location,E.action)}var v=!1,p=null;function g(){var n=getHashPath(),t=h(n);if(n!==t)replaceHashPath(t);else{var e=f(),a=E.location;if(!v&&locationsAreEqual(a,e))return;if(p===createPath(e))return;p=null,function(t){v?(v=!1,d()):l.confirmTransitionTo(t,"POP",i,(function(n){n?d({action:"POP",location:t}):function(n){var t=E.location,e=y.lastIndexOf(createPath(t));-1===e&&(e=0);var a=y.lastIndexOf(createPath(n));-1===a&&(a=0);var o=e-a;o&&(v=!0,H(o))}(t)}))}(e)}}var P=getHashPath(),m=h(P);P!==m&&replaceHashPath(m);var w=f(),y=[createPath(w)];function H(n){t.go(n)}var x=0;function L(n){1===(x+=n)&&1===n?window.addEventListener("hashchange",g):0===x&&window.removeEventListener("hashchange",g)}var O=!1,E={length:t.length,action:"POP",location:w,createHref:function(n){return"#"+h(c+createPath(n))},push:function(n,t){var r=createLocation(n,void 0,void 0,E.location);l.confirmTransitionTo(r,"PUSH",i,(function(n){if(n){var t=createPath(r),e=h(c+t);if(getHashPath()!==e){p=t,function(n){window.location.hash=n}(e);var a=y.lastIndexOf(createPath(E.location)),o=y.slice(0,-1===a?0:a+1);o.push(t),y=o,d({action:"PUSH",location:r})}else d()}}))},replace:function(n,t){var o="REPLACE",r=createLocation(n,void 0,void 0,E.location);l.confirmTransitionTo(r,o,i,(function(n){if(n){var t=createPath(r),e=h(c+t);getHashPath()!==e&&(p=t,replaceHashPath(e));var a=y.indexOf(createPath(E.location));-1!==a&&(y[a]=t),d({action:o,location:r})}}))},go:H,goBack:function(){H(-1)},goForward:function(){H(1)},block:function(n){void 0===n&&(n=!1);var t=l.setPrompt(n);return O||(L(1),O=!0),function(){return O&&(O=!1,L(-1)),t()}},listen:function(n){var t=l.appendListener(n);return L(1),function(){L(-1),t()}}};return E},exports.createMemoryHistory=function(n){void 0===n&&(n={});var t=n,o=t.getUserConfirmation,e=t.initialEntries,a=void 0===e?["/"]:e,r=t.initialIndex,i=void 0===r?0:r,c=t.keyLength,s=void 0===c?6:c,h=createTransitionManager();function u(n){_extends(g,n),g.length=g.entries.length,h.notifyListeners(g.location,g.action)}function f(){return Math.random().toString(36).substr(2,s)}var l=clamp(i,0,a.length-1),d=a.map((function(n){return createLocation(n,void 0,"string"==typeof n?f():n.key||f())})),v=createPath;function p(n){var t=clamp(g.index+n,0,g.entries.length-1),e=g.entries[t];h.confirmTransitionTo(e,"POP",o,(function(n){n?u({action:"POP",location:e,index:t}):u()}))}var g={length:d.length,action:"POP",location:d[l],index:l,entries:d,createHref:v,push:function(n,t){var a=createLocation(n,t,f(),g.location);h.confirmTransitionTo(a,"PUSH",o,(function(n){if(n){var t=g.index+1,e=g.entries.slice(0);e.length>t?e.splice(t,e.length-t,a):e.push(a),u({action:"PUSH",location:a,index:t,entries:e})}}))},replace:function(n,t){var e="REPLACE",a=createLocation(n,t,f(),g.location);h.confirmTransitionTo(a,e,o,(function(n){n&&(g.entries[g.index]=a,u({action:e,location:a}))}))},go:p,goBack:function(){p(-1)},goForward:function(){p(1)},canGo:function(n){var t=g.index+n;return 0<=t&&t<g.entries.length},block:function(n){return void 0===n&&(n=!1),h.setPrompt(n)},listen:function(n){return h.appendListener(n)}};return g},exports.createLocation=createLocation,exports.locationsAreEqual=locationsAreEqual,exports.parsePath=parsePath,exports.createPath=createPath},function(module,exports,__webpack_require__){"use strict";function isAbsolute(pathname){return"/"===pathname.charAt(0)}function spliceOne(list,index){for(var i=index,k=i+1,n=list.length;k<n;i+=1,k+=1)list[i]=list[k];list.pop()}exports.__esModule=!0,exports.default=function(to){var from=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",toParts=to&&to.split("/")||[],fromParts=from&&from.split("/")||[],isToAbs=to&&isAbsolute(to),isFromAbs=from&&isAbsolute(from),mustEndAbs=isToAbs||isFromAbs;if(to&&isAbsolute(to)?fromParts=toParts:toParts.length&&(fromParts.pop(),fromParts=fromParts.concat(toParts)),!fromParts.length)return"/";var hasTrailingSlash=void 0;if(fromParts.length){var last=fromParts[fromParts.length-1];hasTrailingSlash="."===last||".."===last||""===last}else hasTrailingSlash=!1;for(var up=0,i=fromParts.length;i>=0;i--){var part=fromParts[i];"."===part?spliceOne(fromParts,i):".."===part?(spliceOne(fromParts,i),up++):up&&(spliceOne(fromParts,i),up--)}if(!mustEndAbs)for(;up--;up)fromParts.unshift("..");!mustEndAbs||""===fromParts[0]||fromParts[0]&&isAbsolute(fromParts[0])||fromParts.unshift("");var result=fromParts.join("/");return hasTrailingSlash&&"/"!==result.substr(-1)&&(result+="/"),result},module.exports=exports.default},function(module,exports,__webpack_require__){"use strict";exports.__esModule=!0;var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};exports.default=function valueEqual(a,b){if(a===b)return!0;if(null==a||null==b)return!1;if(Array.isArray(a))return Array.isArray(b)&&a.length===b.length&&a.every((function(item,index){return valueEqual(item,b[index])}));var aType=void 0===a?"undefined":_typeof(a);if(aType!==(void 0===b?"undefined":_typeof(b)))return!1;if("object"===aType){var aValue=a.valueOf(),bValue=b.valueOf();if(aValue!==a||bValue!==b)return valueEqual(aValue,bValue);var aKeys=Object.keys(a),bKeys=Object.keys(b);return aKeys.length===bKeys.length&&aKeys.every((function(key){return valueEqual(a[key],b[key])}))}return!1},module.exports=exports.default},function(module,exports,__webpack_require__){"use strict";module.exports=function(condition,message){}},function(module,exports,__webpack_require__){"use strict";module.exports=function(condition,message){if(!condition)throw new Error("Invariant failed")}},,,function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"ProtectedRoute",(function(){return ProtectedRoute})),__webpack_require__.d(__webpack_exports__,"renderApp",(function(){return renderApp})),__webpack_require__.d(__webpack_exports__,"teardownFleet",(function(){return teardownFleet}));var external_kbnSharedDeps_React_=__webpack_require__(2),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),external_kbnSharedDeps_ReactDom_=__webpack_require__(103),external_kbnSharedDeps_ReactDom_default=__webpack_require__.n(external_kbnSharedDeps_ReactDom_),external_kbnSharedDeps_ReactRouterDom_=__webpack_require__(97),hooks=__webpack_require__(107),external_kbnSharedDeps_ElasticEui_=__webpack_require__(10),node_modules_history=__webpack_require__(266),external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(95),external_kbnSharedDeps_KbnI18n_=__webpack_require__(4),external_kbnSharedDeps_StyledComponents_=__webpack_require__(96),external_kbnSharedDeps_StyledComponents_default=__webpack_require__.n(external_kbnSharedDeps_StyledComponents_),useObservable=__webpack_require__(265),useObservable_default=__webpack_require__.n(useObservable),public_=__webpack_require__(98),common_=__webpack_require__(104);const Loading=({size:size})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceAround"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingSpinner,{size:size||"xl"}))),error_Error=({title:title,error:error})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:title,color:"danger",iconType:"alert"},external_kbnSharedDeps_React_default.a.createElement("p",null,"string"==typeof error?error:error.message));function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const Container=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"Container",componentId:"h7yryh-0"})(["border-bottom:",";background-color:",";"],props=>props.theme.eui.euiBorderThin,props=>props.theme.eui.euiPageBackgroundColor),Wrapper=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"Wrapper",componentId:"h7yryh-1"})(["max-width:","px;margin-left:auto;margin-right:auto;padding-top:",";padding-left:",";padding-right:",";"],props=>props.maxWidth||1200,props=>props.theme.eui.paddingSizes.xl,props=>props.theme.eui.paddingSizes.m,props=>props.theme.eui.paddingSizes.m),Tabs=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiTabs).withConfig({displayName:"Tabs",componentId:"h7yryh-2"})(["top:1px;&:before{height:0px;}"]),HeaderColumns=Object(external_kbnSharedDeps_React_.memo)(({leftColumn:leftColumn,rightColumn:rightColumn,rightColumnGrow:rightColumnGrow})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center"},leftColumn?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,leftColumn):null,rightColumn?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:rightColumnGrow},rightColumn):null)),Header=({leftColumn:leftColumn,rightColumn:rightColumn,rightColumnGrow:rightColumnGrow,tabs:tabs,maxWidth:maxWidth,tabsClassName:tabsClassName,"data-test-subj":dataTestSubj})=>external_kbnSharedDeps_React_default.a.createElement(Container,{"data-test-subj":dataTestSubj},external_kbnSharedDeps_React_default.a.createElement(Wrapper,{maxWidth:maxWidth},external_kbnSharedDeps_React_default.a.createElement(HeaderColumns,{leftColumn:leftColumn,rightColumn:rightColumn,rightColumnGrow:rightColumnGrow}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,tabs?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(Tabs,{className:tabsClassName},tabs.map(props=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTab,_extends({},props,{key:props.id}),props.name)))):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"}))))),AlphaFlyout=({onClose:onClose})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyout,{onClose:onClose,size:"m",maxWidth:640},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyoutHeader,{hasBorder:!0,"aria-labelledby":"AlphaMessagingFlyoutTitle"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"m"},external_kbnSharedDeps_React_default.a.createElement("h2",{id:"AlphaMessagingFlyoutTitle"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.alphaMessaging.flyoutTitle",defaultMessage:"About this release"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyoutBody,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"m"},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.alphaMessaging.introText",defaultMessage:"Fleet is under active development and is not intended for use in production environments. This beta release is designed for users to test and offer feedback about Fleet and the new Elastic Agent. This plugin is not subject to the support SLA."})),external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.alphaMessaging.feedbackText",defaultMessage:"Read our {docsLink} or go to our {forumLink} for questions or feedback.",values:{docsLink:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{href:"https://www.elastic.co/guide/en/fleet/current/index.html",external:!0,target:"_blank"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.alphaMessaging.docsLink",defaultMessage:"documentation"})),forumLink:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{href:"https://ela.st/fleet-forum",external:!0,target:"_blank"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.alphaMessaging.forumLink",defaultMessage:"Discuss forum"}))}})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyoutFooter,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{onClick:onClose,flush:"left"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.alphaMessging.closeFlyoutLabel",defaultMessage:"Close"})))),Message=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiText).attrs(props=>({color:"subdued",textAlign:"center",size:"s"})).withConfig({displayName:"Message",componentId:"lt2gk4-0"})(["padding:",";margin-top:auto;"],props=>props.theme.eui.paddingSizes.m),AlphaMessaging=()=>{const[isAlphaFlyoutOpen,setIsAlphaFlyoutOpen]=Object(external_kbnSharedDeps_React_.useState)(!1);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(Message,null,external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement("strong",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.alphaMessageTitle",defaultMessage:"Beta release"}))," â ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.alphaMessageDescription",defaultMessage:"Fleet is not recommended for production environments."})," ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{color:"subdued",onClick:()=>setIsAlphaFlyoutOpen(!0)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.alphaMessageLinkText",defaultMessage:"See more details."})))),isAlphaFlyoutOpen&&external_kbnSharedDeps_React_default.a.createElement(AlphaFlyout,{onClose:()=>setIsAlphaFlyoutOpen(!1)}))};function package_icon_extends(){return(package_icon_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const PackageIcon=({packageName:packageName,version:version,icons:icons,tryApi:tryApi,...euiIconProps})=>{const iconType=Object(hooks.jb)({packageName:packageName,version:version,icons:icons,tryApi:tryApi});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,package_icon_extends({size:"s",type:iconType},euiIconProps))};function context_menu_actions_extends(){return(context_menu_actions_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const ContextMenuActions=external_kbnSharedDeps_React_default.a.memo(({button:button,onChange:onChange,isOpen:isOpen,...props})=>{const[isOpenState,setIsOpenState]=Object(external_kbnSharedDeps_React_.useState)(!1),handleCloseMenu=Object(external_kbnSharedDeps_React_.useCallback)(()=>{onChange?onChange(!1):setIsOpenState(!1)},[setIsOpenState,onChange]),handleToggleMenu=Object(external_kbnSharedDeps_React_.useCallback)(()=>{onChange?onChange(!isOpen):setIsOpenState(!isOpenState)},[isOpenState,onChange,isOpen]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopover,{anchorPosition:"downRight",panelPaddingSize:"none",button:button?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,context_menu_actions_extends({},button.props,{onClick:handleToggleMenu}),button.children):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{iconType:"boxesHorizontal",onClick:handleToggleMenu,"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.genericActionsMenuText",{defaultMessage:"Open"})}),isOpen:void 0===isOpen?isOpenState:isOpen,closePopover:handleCloseMenu},"items"in props?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenuPanel,{items:props.items}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenu,{panels:props.panels,initialPanelId:0}))});var data_public_=__webpack_require__(99),constants=__webpack_require__(11);const HIDDEN_FIELDS=[constants.d+".actions","_id","_index"],SearchBar=({value:value,fieldPrefix:fieldPrefix,onChange:onChange,placeholder:placeholder,indexPattern:indexPattern=constants.h})=>{const{data:data}=Object(hooks.nb)(),[indexPatternFields,setIndexPatternFields]=Object(external_kbnSharedDeps_React_.useState)(),isQueryValid=Object(external_kbnSharedDeps_React_.useMemo)(()=>{if(!value||""===value)return!0;try{return data_public_.esKuery.fromKueryExpression(value),!0}catch(e){return!1}},[value]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{(async()=>{try{const fields=(await data.indexPatterns.getFieldsForWildcard({pattern:indexPattern})||[]).filter(field=>{if(!fieldPrefix||field.name.startsWith(fieldPrefix)){for(const hiddenField of HIDDEN_FIELDS)if(field.name.startsWith(hiddenField))return!1;return!0}});setIndexPatternFields(fields)}catch(err){setIndexPatternFields(void 0)}})()},[data.indexPatterns,fieldPrefix,indexPattern]),external_kbnSharedDeps_React_default.a.createElement(data_public_.QueryStringInput,{iconType:"search",disableLanguageSwitcher:!0,indexPatterns:indexPatternFields?[{title:indexPattern,fields:indexPatternFields}]:[],query:{query:value,language:"kuery"},isInvalid:!isQueryValid,disableAutoFocus:!0,placeholder:placeholder,onChange:newQuery=>{onChange(newQuery.query)},onSubmit:newQuery=>{onChange(newQuery.query,!0)},submitOnBlur:!0})};var js_yaml=__webpack_require__(29),outputs=__webpack_require__(121),common=__webpack_require__(1);const TABLE_COLUMNS=[{name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.settingsConfirmModal.fieldLabel",{defaultMessage:"Field"}),field:"label",render:(_,item)=>function(change){if("elasticsearch"===change.type&&"removed"===change.direction)return external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.settingsConfirmModal.elasticsearchRemovedLabel",{defaultMessage:"Elasticsearch hosts (old)"});if("elasticsearch"===change.type&&"added"===change.direction)return external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.settingsConfirmModal.elasticsearchAddedLabel",{defaultMessage:"Elasticsearch hosts (new)"});if("fleet_server"===change.type&&"removed"===change.direction)return external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.settingsConfirmModal.fleetServerRemovedLabel",{defaultMessage:"Fleet Server hosts (old)"});if("fleet_server"===change.type&&"added"===change.direction)return external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.settingsConfirmModal.fleetServerAddedLabel",{defaultMessage:"Fleet Server hosts (new)"});return external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.settingsConfirmModal.defaultChangeLabel",{defaultMessage:"Unknown setting"})}(item),width:"180px"},{field:"urls",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.settingsConfirmModal.valueLabel",{defaultMessage:"Value"}),render:(_,item)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"s",color:"added"===item.direction?"secondary":"danger"},item.urls.map(url=>external_kbnSharedDeps_React_default.a.createElement("div",{key:url},url)))}];const SettingsConfirmModal=external_kbnSharedDeps_React_default.a.memo(({changes:changes,onConfirm:onConfirm,onClose:onClose})=>{const hasESChanges=changes.some(change=>"elasticsearch"===change.type),hasFleetServerChanges=changes.some(change=>"fleet_server"===change.type);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModal,{maxWidth:!0,onClose:onClose},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalHeader,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalHeaderTitle,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.settingsConfirmModal.title",defaultMessage:"Apply settings to all agent policies"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalBody,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.settingsConfirmModal.calloutTitle",defaultMessage:"This action updates all agent policies and enrolled agents"}),color:"warning",iconType:"alert"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"s"},hasFleetServerChanges&&external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.settingsConfirmModal.fleetServerChangedText",defaultMessage:"Agents that cannot connect to the new {fleetServerHosts} log an error. The agents remain on the current policy and check for updates at the old URL until they connect at the new URL.",values:{fleetServerHosts:external_kbnSharedDeps_React_default.a.createElement("strong",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.settingsConfirmModal.fleetServerHosts",defaultMessage:"Fleet Server hosts"}))}})),hasESChanges&&external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.settingsConfirmModal.eserverChangedText",defaultMessage:"Agents that cannot connect at the new {elasticsearchHosts} have a healthy status even though they are unable to send data. To update the URL that Fleet Server uses to connect to Elasticsearch, you must reenroll Fleet Server.",values:{elasticsearchHosts:external_kbnSharedDeps_React_default.a.createElement("strong",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.settingsConfirmModal.elasticsearchHosts",defaultMessage:"Elasticsearch hosts"}))}})))),changes.length>0&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBasicTable,{tableLayout:"auto",columns:TABLE_COLUMNS,items:changes}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalFooter,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{onClick:onClose},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.settingsConfirmModal.cancelButton",defaultMessage:"Cancel"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{onClick:onConfirm,fill:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.settingsConfirmModal.confirmButton",defaultMessage:"Apply settings"}))))});__webpack_require__(133),__webpack_require__(134);function settings_flyout_extends(){return(settings_flyout_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const URL_REGEX=/^(https?):\/\/[^\s$.?#].[^\s]*$/gm;function isSameArrayValue(arrayA=[],arrayB=[]){return arrayA.length===arrayB.length&&arrayA.every((val,index)=>val===arrayB[index])}const SettingFlyout=({onClose:onClose})=>{var _settingsRequest$data,_outputsRequest$data,_outputsRequest$data$;const settingsRequest=Object(hooks.db)(),settings=null==settingsRequest||null===(_settingsRequest$data=settingsRequest.data)||void 0===_settingsRequest$data?void 0:_settingsRequest$data.item,output=null===(_outputsRequest$data=Object(outputs.b)().data)||void 0===_outputsRequest$data||null===(_outputsRequest$data$=_outputsRequest$data.items)||void 0===_outputsRequest$data$?void 0:_outputsRequest$data$[0],{inputs:inputs,submit:submit,validate:validate,isLoading:isLoading}=function(outputId,onSuccess){const[isLoading,setIsloading]=external_kbnSharedDeps_React_default.a.useState(!1),{notifications:notifications}=Object(hooks.nb)(),fleetServerHostsInput=Object(hooks.L)([],value=>0===value.length?[external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.settings.fleetServerHostsEmptyError",{defaultMessage:"At least one URL is required"})]:value.some(v=>!v.match(URL_REGEX))?[external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.settings.fleetServerHostsError",{defaultMessage:"Invalid URL"})]:value.length&&Object(common.isDiffPathProtocol)(value)?[external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.settings.fleetServerHostsDifferentPathOrProtocolError",{defaultMessage:"Protocol and path must be the same for each URL"})]:void 0),elasticsearchUrlInput=Object(hooks.L)([],value=>{if(value.some(v=>!v.match(URL_REGEX)))return[external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.settings.elasticHostError",{defaultMessage:"Invalid URL"})]}),additionalYamlConfigInput=Object(hooks.eb)("",value=>{try{return void Object(js_yaml.safeLoad)(value)}catch(error){return[external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.settings.invalidYamlFormatErrorMessage",{defaultMessage:"Invalid YAML: {reason}",values:{reason:error.message}})]}});return{isLoading:isLoading,validate:Object(external_kbnSharedDeps_React_.useCallback)(()=>!!(fleetServerHostsInput.validate()&&elasticsearchUrlInput.validate()&&additionalYamlConfigInput.validate()),[fleetServerHostsInput,elasticsearchUrlInput,additionalYamlConfigInput]),submit:async()=>{try{if(setIsloading(!0),!outputId)throw new Error("Unable to load outputs");const outputResponse=await Object(outputs.a)(outputId,{hosts:elasticsearchUrlInput.value,config_yaml:additionalYamlConfigInput.value});if(outputResponse.error)throw outputResponse.error;const settingsResponse=await Object(hooks.D)({fleet_server_hosts:fleetServerHostsInput.value});if(settingsResponse.error)throw settingsResponse.error;notifications.toasts.addSuccess(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.settings.success.message",{defaultMessage:"Settings saved"})),setIsloading(!1),onSuccess()}catch(error){setIsloading(!1),notifications.toasts.addError(error,{title:"Error"})}},inputs:{fleetServerHosts:fleetServerHostsInput,elasticsearchUrl:elasticsearchUrlInput,additionalYamlConfig:additionalYamlConfigInput}}}(null==output?void 0:output.id,onClose),[isConfirmModalVisible,setConfirmModalVisible]=external_kbnSharedDeps_React_default.a.useState(!1),onSubmit=Object(external_kbnSharedDeps_React_.useCallback)(()=>{validate()&&setConfirmModalVisible(!0)},[validate,setConfirmModalVisible]),onConfirm=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setConfirmModalVisible(!1),submit()},[submit]),onConfirmModalClose=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setConfirmModalVisible(!1)},[setConfirmModalVisible]);Object(external_kbnSharedDeps_React_.useEffect)(()=>{output&&(inputs.elasticsearchUrl.setValue(output.hosts||[]),inputs.additionalYamlConfig.setValue(output.config_yaml||""))},[output]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{settings&&inputs.fleetServerHosts.setValue([...settings.fleet_server_hosts])},[settings]);const isUpdated=external_kbnSharedDeps_React_default.a.useMemo(()=>!(!settings||!output)&&(!isSameArrayValue(settings.fleet_server_hosts,inputs.fleetServerHosts.value)||!isSameArrayValue(output.hosts,inputs.elasticsearchUrl.value)||(output.config_yaml||"")!==inputs.additionalYamlConfig.value),[settings,inputs,output]),changes=external_kbnSharedDeps_React_default.a.useMemo(()=>{if(!settings||!output||!isConfirmModalVisible)return[];const tmpChanges=[];return isSameArrayValue(output.hosts,inputs.elasticsearchUrl.value)||tmpChanges.push({type:"elasticsearch",direction:"removed",urls:output.hosts||[]},{type:"elasticsearch",direction:"added",urls:inputs.elasticsearchUrl.value}),isSameArrayValue(settings.fleet_server_hosts,inputs.fleetServerHosts.value)||tmpChanges.push({type:"fleet_server",direction:"removed",urls:settings.fleet_server_hosts},{type:"fleet_server",direction:"added",urls:inputs.fleetServerHosts.value}),tmpChanges},[settings,inputs,output,isConfirmModalVisible]),body=settings&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiForm,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{color:"subdued",size:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.settings.globalOutputDescription",defaultMessage:"These settings are applied globally to the {outputs} section of all agent policies and affect all enrolled agents.",values:{outputs:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCode,null,"outputs")}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,settings_flyout_extends({fullWidth:!0,label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.settings.fleetServerHostsLabel",{defaultMessage:"Fleet Server hosts"}),helpText:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.settings.fleetServerHostsHelpTect",defaultMessage:"Specify the URLs that your agents will use to connect to a Fleet Server. If multiple URLs exist, Fleet shows the first provided URL for enrollment purposes. Refer to the {link}.",values:{link:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{href:"https://www.elastic.co/guide/en/fleet/current/index.html",target:"_blank",external:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.settings.userGuideLink",defaultMessage:"Fleet User Guide"}))}})},inputs.fleetServerHosts.formRowProps),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiComboBox,settings_flyout_extends({fullWidth:!0,noSuggestions:!0},inputs.fleetServerHosts.props))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,settings_flyout_extends({fullWidth:!0,label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.settings.elasticsearchUrlLabel",{defaultMessage:"Elasticsearch hosts"}),helpText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.settings.elasticsearchUrlsHelpTect",{defaultMessage:"Specify the Elasticsearch URLs where agents send data."})},inputs.elasticsearchUrl.formRowProps),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiComboBox,settings_flyout_extends({fullWidth:!0,noSuggestions:!0},inputs.elasticsearchUrl.props))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,settings_flyout_extends({},inputs.additionalYamlConfig.formRowProps,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.settings.additionalYamlConfig",{defaultMessage:"Elasticsearch output configuration (YAML)"}),fullWidth:!0}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCodeEditor,settings_flyout_extends({width:"100%",mode:"yaml",theme:"textmate",placeholder:"# YAML settings here will be added to the Elasticsearch output section of each policy",setOptions:{minLines:10,maxLines:30,tabSize:2,showGutter:!1,showPrintMargin:!1}},inputs.additionalYamlConfig.props,{onChange:inputs.additionalYamlConfig.setValue}))));return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,isConfirmModalVisible&&external_kbnSharedDeps_React_default.a.createElement(SettingsConfirmModal,{changes:changes,onConfirm:onConfirm,onClose:onConfirmModalClose}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyout,{onClose:onClose,size:"m"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyoutHeader,{hasBorder:!0,"aria-labelledby":"IngestManagerSettingsFlyoutTitle"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"m"},external_kbnSharedDeps_React_default.a.createElement("h2",{id:"IngestManagerSettingsFlyoutTitle"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.settings.flyoutTitle",defaultMessage:"Fleet settings"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyoutBody,null,body),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyoutFooter,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{onClick:onClose,flush:"left"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.settings.cancelButtonLabel",defaultMessage:"Cancel"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{disabled:!isUpdated,onClick:onSubmit,isLoading:isLoading,color:"primary",fill:!0},isLoading?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.settings.saveButtonLoadingLabel",defaultMessage:"Applying settings..."}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.settings.saveButtonLabel",defaultMessage:"Save and apply settings"})))))))},MIN_WIDTH={minWidth:0},NO_WRAP_WHITE_SPACE={whiteSpace:"nowrap"},AgentPolicySummaryLine=Object(external_kbnSharedDeps_React_.memo)(({policy:policy})=>{const{getHref:getHref}=Object(hooks.ib)(),{name:name,id:id,revision:revision,is_managed:isManaged}=policy;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s",alignItems:"baseline",style:MIN_WIDTH,responsive:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,className:"eui-textTruncate"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{className:"eui-textTruncate",href:getHref("policy_details",{policyId:id}),title:name||id},name||id)),isManaged&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIconTip,{title:"Hosted agent policy",content:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentPolicySummaryLine.hostedPolicyTooltip",{defaultMessage:"This policy is managed outside of Fleet. Most actions related to this policy are unavailable."}),type:"lock",size:"m",color:"subdued"}),revision&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{color:"subdued",size:"xs",style:NO_WRAP_WHITE_SPACE},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentPolicySummaryLine.revisionNumber",defaultMessage:"rev. {revNumber}",values:{revNumber:revision}}))))}),IntraAppStateContext=external_kbnSharedDeps_React_default.a.createContext({forRoute:""}),wasHandled=new WeakSet,IntraAppStateProvider=Object(external_kbnSharedDeps_React_.memo)(({kibanaScopedHistory:kibanaScopedHistory,children:children})=>{const internalAppToAppState=Object(external_kbnSharedDeps_React_.useMemo)(()=>({forRoute:new URL(""+kibanaScopedHistory.location.hash.substr(1),"http://localhost").pathname,routeState:kibanaScopedHistory.location.state}),[kibanaScopedHistory.location.state,kibanaScopedHistory.location.hash]);return external_kbnSharedDeps_React_default.a.createElement(IntraAppStateContext.Provider,{value:internalAppToAppState},children)});function useIntraAppState(){const location=Object(external_kbnSharedDeps_ReactRouterDom_.useLocation)(),intraAppState=Object(external_kbnSharedDeps_React_.useContext)(IntraAppStateContext);if(!intraAppState)throw new Error("Hook called outside of IntraAppStateContext");return Object(external_kbnSharedDeps_React_.useMemo)(()=>location.pathname!==intraAppState.forRoute||wasHandled.has(intraAppState)?location.state:(wasHandled.add(intraAppState),intraAppState.routeState),[intraAppState,location.pathname,location.state])}var epm_hooks=__webpack_require__(110);const default_Container=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"Container",componentId:"sc-1ascj29-0"})(["min-height:calc( 100vh - ","px );background:",";display:flex;flex-direction:column;"],props=>2*parseFloat(props.theme.eui.euiHeaderHeightCompensation),props=>props.theme.eui.euiColorEmptyShade),default_Wrapper=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"Wrapper",componentId:"sc-1ascj29-1"})(["display:flex;flex-direction:column;flex:1;"]),Nav=external_kbnSharedDeps_StyledComponents_default.a.nav.withConfig({displayName:"Nav",componentId:"sc-1ascj29-2"})(["background:",";border-bottom:",";padding:",";.euiTabs{padding-left:3px;margin-left:-3px;}"],props=>props.theme.eui.euiColorEmptyShade,props=>props.theme.eui.euiBorderThin,props=>`${props.theme.eui.euiSize} ${props.theme.eui.euiSizeL} ${props.theme.eui.euiSize} ${props.theme.eui.euiSizeL}`),DefaultLayout=({showSettings:showSettings=!0,section:section,children:children})=>{const{getHref:getHref}=Object(hooks.ib)(),{agents:agents}=Object(hooks.M)(),{modal:modal,setModal:setModal,getModalHref:getModalHref}=Object(hooks.ob)();return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,"settings"===modal&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPortal,null,external_kbnSharedDeps_React_default.a.createElement(SettingFlyout,{onClose:()=>{setModal(null)}})),external_kbnSharedDeps_React_default.a.createElement(default_Container,null,external_kbnSharedDeps_React_default.a.createElement(default_Wrapper,null,external_kbnSharedDeps_React_default.a.createElement(Nav,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"l",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTabs,{display:"condensed"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTab,{isSelected:"overview"===section,href:getHref("overview")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.appNavigation.overviewLinkText",defaultMessage:"Overview"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTab,{isSelected:"epm"===section,href:getHref("integrations_all")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.appNavigation.epmLinkText",defaultMessage:"Integrations"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTab,{isSelected:"agent_policy"===section,href:getHref("policies_list")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.appNavigation.policiesLinkText",defaultMessage:"Policies"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTab,{isSelected:"fleet"===section,href:getHref("fleet"),disabled:!(null!=agents&&agents.enabled)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.appNavigation.agentsLinkText",defaultMessage:"Agents"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTab,{isSelected:"data_stream"===section,href:getHref("data_streams")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.appNavigation.dataStreamsLinkText",defaultMessage:"Data streams"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s",direction:"row"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{iconType:"popout",href:"https://ela.st/fleet-feedback",target:"_blank"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.appNavigation.sendFeedbackButton",defaultMessage:"Send feedback"}))),showSettings?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{iconType:"gear",href:getModalHref("settings")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.appNavigation.settingsButton",defaultMessage:"Fleet settings"}))):null)))),children),external_kbnSharedDeps_React_default.a.createElement(AlphaMessaging,null)))},Page=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiPage).withConfig({displayName:"Page",componentId:"m0w1fb-0"})(["background:",";width:100%;align-self:center;margin-left:0;margin-right:0;flex:1;"],props=>props.theme.eui.euiColorEmptyShade),ContentWrapper=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"ContentWrapper",componentId:"m0w1fb-1"})(["height:100%;"]),WithoutHeaderLayout=({restrictWidth:restrictWidth,children:children})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(Page,{restrictWidth:restrictWidth||1200},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageBody,null,external_kbnSharedDeps_React_default.a.createElement(ContentWrapper,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),children))));function with_header_extends(){return(with_header_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const WithHeaderLayout=({restrictWidth:restrictWidth,restrictHeaderWidth:restrictHeaderWidth,children:children,"data-test-subj":dataTestSubj,...rest})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(Header,with_header_extends({maxWidth:restrictHeaderWidth,"data-test-subj":dataTestSubj?dataTestSubj+"_header":void 0},rest)),external_kbnSharedDeps_React_default.a.createElement(Page,{restrictWidth:restrictWidth||1200,"data-test-subj":dataTestSubj?dataTestSubj+"_page":void 0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageBody,null,external_kbnSharedDeps_React_default.a.createElement(ContentWrapper,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),children))));var services=__webpack_require__(108);const AgentPolicyDeleteProvider=({children:children})=>{const{notifications:notifications}=Object(hooks.nb)(),{agents:{enabled:isFleetEnabled}}=Object(hooks.M)(),[agentPolicy,setAgentPolicy]=Object(external_kbnSharedDeps_React_.useState)(),[isModalOpen,setIsModalOpen]=Object(external_kbnSharedDeps_React_.useState)(!1),[isLoadingAgentsCount,setIsLoadingAgentsCount]=Object(external_kbnSharedDeps_React_.useState)(!1),[agentsCount,setAgentsCount]=Object(external_kbnSharedDeps_React_.useState)(0),[isLoading,setIsLoading]=Object(external_kbnSharedDeps_React_.useState)(!1),onSuccessCallback=Object(external_kbnSharedDeps_React_.useRef)(null),closeModal=()=>{setAgentPolicy(void 0),setIsLoading(!1),setIsLoadingAgentsCount(!1),setIsModalOpen(!1)},deleteAgentPolicy=async()=>{setIsLoading(!0);try{const{data:data}=await Object(hooks.h)({agentPolicyId:agentPolicy});data?(notifications.toasts.addSuccess(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.deleteAgentPolicy.successSingleNotificationTitle",{defaultMessage:"Deleted agent policy '{id}'",values:{id:data.name||data.id}})),onSuccessCallback.current&&onSuccessCallback.current(agentPolicy)):notifications.toasts.addDanger(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.deleteAgentPolicy.failureSingleNotificationTitle",{defaultMessage:"Error deleting agent policy '{id}'",values:{id:agentPolicy}}))}catch(e){notifications.toasts.addDanger(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.deleteAgentPolicy.fatalErrorNotificationTitle",{defaultMessage:"Error deleting agent policy"}))}closeModal()},fetchAgentsCount=async agentPolicyToCheck=>{if(!isFleetEnabled||isLoadingAgentsCount)return;setIsLoadingAgentsCount(!0);const{data:data}=await Object(hooks.F)({path:"/api/fleet/agents",method:"get",query:{kuery:`${constants.d}.policy_id : ${agentPolicyToCheck}`}});setAgentsCount((null==data?void 0:data.total)||0),setIsLoadingAgentsCount(!1)};return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,children((agentPolicyToDelete,onSuccess=(()=>{}))=>{if(!agentPolicyToDelete)throw new Error("No agent policy specified for deletion");setIsModalOpen(!0),setAgentPolicy(agentPolicyToDelete),fetchAgentsCount(agentPolicyToDelete),onSuccessCallback.current=onSuccess}),isModalOpen?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiConfirmModal,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.deleteAgentPolicy.confirmModal.deletePolicyTitle",defaultMessage:"Delete this agent policy?"}),onCancel:closeModal,onConfirm:deleteAgentPolicy,cancelButtonText:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.deleteAgentPolicy.confirmModal.cancelButtonLabel",defaultMessage:"Cancel"}),confirmButtonText:isLoading||isLoadingAgentsCount?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.deleteAgentPolicy.confirmModal.loadingButtonLabel",defaultMessage:"Loadingâ¦"}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.deleteAgentPolicy.confirmModal.confirmButtonLabel",defaultMessage:"Delete policy"}),buttonColor:"danger",confirmButtonDisabled:isLoading||isLoadingAgentsCount||!!agentsCount},isLoadingAgentsCount?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.deleteAgentPolicy.confirmModal.loadingAgentsCountMessage",defaultMessage:"Checking amount of affected agentsâ¦"}):agentsCount?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{color:"danger",title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.deleteAgentPolicy.confirmModal.affectedAgentsTitle",{defaultMessage:"Policy in use"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.deleteAgentPolicy.confirmModal.affectedAgentsMessage",defaultMessage:"{agentsCount, plural, one {# agent is} other {# agents are}} assigned to this agent policy. Unassign these agents before deleting this policy.",values:{agentsCount:agentsCount}})):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.deleteAgentPolicy.confirmModal.irreversibleMessage",defaultMessage:"This action cannot be undone."})):null)},StyledEuiAccordion=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiAccordion).withConfig({displayName:"StyledEuiAccordion",componentId:"sc-1njiai8-0"})([".ingest-active-button{color:",";}"],props=>props.theme.eui.euiColorPrimary),agentPolicyFormValidation=agentPolicy=>{var _agentPolicy$name;const errors={},namespaceValidation=Object(services.n)(agentPolicy.namespace||"");return null!==(_agentPolicy$name=agentPolicy.name)&&void 0!==_agentPolicy$name&&_agentPolicy$name.trim()||(errors.name=[external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentPolicyForm.nameRequiredErrorMessage",defaultMessage:"Agent policy name is required"})]),!namespaceValidation.valid&&namespaceValidation.error&&(errors.namespace=[namespaceValidation.error]),errors},AgentPolicyForm=({agentPolicy:agentPolicy,updateAgentPolicy:updateAgentPolicy,withSysMonitoring:withSysMonitoring,updateSysMonitoring:updateSysMonitoring,validation:validation,isEditing:isEditing=!1,onDelete:onDelete=(()=>{})})=>{const[touchedFields,setTouchedFields]=Object(external_kbnSharedDeps_React_.useState)({}),generalFields=Object(external_kbnSharedDeps_React_.useMemo)(()=>[{name:"name",label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentPolicyForm.nameFieldLabel",defaultMessage:"Name"}),placeholder:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentPolicyForm.nameFieldPlaceholder",{defaultMessage:"Choose a name"})},{name:"description",label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentPolicyForm.descriptionFieldLabel",defaultMessage:"Description"}),placeholder:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentPolicyForm.descriptionFieldPlaceholder",{defaultMessage:"How will this policy be used?"})}],[]).map(({name:name,label:label,placeholder:placeholder})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{fullWidth:!0,key:name,label:label,error:touchedFields[name]&&validation[name]?validation[name]:null,isInvalid:Boolean(touchedFields[name]&&validation[name])},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldText,{disabled:!0===agentPolicy.is_managed,fullWidth:!0,value:agentPolicy[name],onChange:e=>updateAgentPolicy({[name]:e.target.value}),isInvalid:Boolean(touchedFields[name]&&validation[name]),onBlur:()=>setTouchedFields({...touchedFields,[name]:!0}),placeholder:placeholder}))),advancedOptionsContent=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescribedFormGroup,{title:external_kbnSharedDeps_React_default.a.createElement("h4",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentPolicyForm.namespaceFieldLabel",defaultMessage:"Default namespace"})),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentPolicyForm.namespaceFieldDescription",defaultMessage:"Namespaces are a user-configurable arbitrary grouping that makes it easier to search for data and manage user permissions. A policy namespace is used to name its integration's data streams. {fleetUserGuide}.",values:{fleetUserGuide:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{href:"https://www.elastic.co/guide/en/fleet/current/data-streams.html#data-streams-naming-scheme",target:"_blank"},external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentPolicyForm.nameSpaceFieldDescription.fleetUserGuideLabel",{defaultMessage:"Learn more"}))}})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{fullWidth:!0,error:touchedFields.namespace&&validation.namespace?validation.namespace:null,isInvalid:Boolean(touchedFields.namespace&&validation.namespace)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiComboBox,{fullWidth:!0,singleSelection:!0,noSuggestions:!0,selectedOptions:agentPolicy.namespace?[{label:agentPolicy.namespace}]:[],onCreateOption:value=>{updateAgentPolicy({namespace:value})},onChange:selectedOptions=>{updateAgentPolicy({namespace:selectedOptions.length?selectedOptions[0]:""})},isInvalid:Boolean(touchedFields.namespace&&validation.namespace),onBlur:()=>setTouchedFields({...touchedFields,namespace:!0})}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescribedFormGroup,{title:external_kbnSharedDeps_React_default.a.createElement("h4",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentPolicyForm.monitoringLabel",defaultMessage:"Agent monitoring"})),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentPolicyForm.monitoringDescription",defaultMessage:"Collect data about your agents for debugging and tracking performance."})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCheckboxGroup,{options:[{id:common.dataTypes.Logs,label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentPolicyForm.monitoringLogsFieldLabel",defaultMessage:"Collect agent logs"})," ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIconTip,{content:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentPolicyForm.monitoringLogsTooltipText",{defaultMessage:"Collect logs from Elastic Agents that use this policy."}),position:"right",type:"iInCircle",color:"subdued"}))},{id:common.dataTypes.Metrics,label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentPolicyForm.monitoringMetricsFieldLabel",defaultMessage:"Collect agent metrics"})," ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIconTip,{content:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentPolicyForm.monitoringMetricsTooltipText",{defaultMessage:"Collect metrics from Elastic Agents that use this policy."}),position:"right",type:"iInCircle",color:"subdued"}))}],idToSelectedMap:(agentPolicy.monitoring_enabled||[]).reduce((acc,key)=>(acc[key]=!0,acc),{logs:!1,metrics:!1}),onChange:id=>{if(id!==common.dataTypes.Logs&&id!==common.dataTypes.Metrics)return;const hasLogs=agentPolicy.monitoring_enabled&&agentPolicy.monitoring_enabled.indexOf(id)>=0,previousValues=agentPolicy.monitoring_enabled||[];updateAgentPolicy({monitoring_enabled:hasLogs?previousValues.filter(type=>type!==id):[...previousValues,id]})}})),!isEditing||!("id"in agentPolicy)||agentPolicy.is_managed||agentPolicy.is_default||agentPolicy.is_default_fleet_server?null:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescribedFormGroup,{title:external_kbnSharedDeps_React_default.a.createElement("h4",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.policyForm.deletePolicyGroupTitle",defaultMessage:"Delete policy"})),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.policyForm.deletePolicyGroupDescription",defaultMessage:"Existing data will not be deleted."}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(AgentPolicyDeleteProvider,null,deleteAgentPolicyPrompt=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{color:"danger",disabled:Boolean(agentPolicy.is_default),onClick:()=>deleteAgentPolicyPrompt(agentPolicy.id,onDelete)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.policyForm.deletePolicyActionText",defaultMessage:"Delete policy"}))),agentPolicy.is_default?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{color:"subdued",size:"xs"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.policyForm.unableToDeleteDefaultPolicyText",defaultMessage:"Default policy cannot be deleted"}))):null)}));return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiForm,null,isEditing?(children=generalFields,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescribedFormGroup,{title:external_kbnSharedDeps_React_default.a.createElement("h4",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.policyForm.generalSettingsGroupTitle",defaultMessage:"General settings"})),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.policyForm.generalSettingsGroupDescription",defaultMessage:"Choose a name and description for your agent policy."})},children)):generalFields,isEditing?null:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentPolicyForm.systemMonitoringFieldLabel",defaultMessage:"System monitoring"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCheckbox,{id:"agentPolicyFormSystemMonitoringCheckbox",label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentPolicyForm.systemMonitoringText",defaultMessage:"Collect system metrics"})," ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIconTip,{content:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentPolicyForm.systemMonitoringTooltipText",{defaultMessage:"Enable this option to bootstrap your policy with an integration that collects system metrics and information."}),position:"right",type:"iInCircle",color:"subdued"})),checked:withSysMonitoring,onChange:()=>{updateSysMonitoring(!withSysMonitoring)}})),isEditing?advancedOptionsContent:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHorizontalRule,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(StyledEuiAccordion,{id:"advancedOptions",buttonContent:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentPolicyForm.advancedOptionsToggleLabel",defaultMessage:"Advanced options"}),buttonClassName:"ingest-active-button"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"}),advancedOptionsContent)));var children},AgentPolicyCopyProvider=({children:children})=>{const{notifications:notifications}=Object(hooks.nb)(),[agentPolicy,setAgentPolicy]=Object(external_kbnSharedDeps_React_.useState)(),[newAgentPolicy,setNewAgentPolicy]=Object(external_kbnSharedDeps_React_.useState)(),[isModalOpen,setIsModalOpen]=Object(external_kbnSharedDeps_React_.useState)(!1),[isLoading,setIsLoading]=Object(external_kbnSharedDeps_React_.useState)(!1),onSuccessCallback=Object(external_kbnSharedDeps_React_.useRef)(null),closeModal=()=>{setAgentPolicy(void 0),setNewAgentPolicy(void 0),setIsLoading(!1),setIsModalOpen(!1)},copyAgentPolicy=async()=>{setIsLoading(!0);try{const{data:data}=await Object(hooks.e)(agentPolicy.id,newAgentPolicy);data?(notifications.toasts.addSuccess(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.copyAgentPolicy.successNotificationTitle",{defaultMessage:"Agent policy copied"})),onSuccessCallback.current&&onSuccessCallback.current(data.item)):notifications.toasts.addDanger(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.copyAgentPolicy.failureNotificationTitle",{defaultMessage:"Error copying agent policy '{id}'",values:{id:agentPolicy.id}}))}catch(e){notifications.toasts.addDanger(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.copyAgentPolicy.fatalErrorNotificationTitle",{defaultMessage:"Error copying agent policy"}))}closeModal()};return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,children((agentPolicyToCopy,onSuccess=(()=>{}))=>{if(!agentPolicyToCopy)throw new Error("No agent policy specified to copy");setIsModalOpen(!0),setAgentPolicy(agentPolicyToCopy),setNewAgentPolicy({name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.copyAgentPolicy.confirmModal.defaultNewPolicyName",{defaultMessage:"{name} (copy)",values:{name:agentPolicyToCopy.name}}),description:agentPolicyToCopy.description}),onSuccessCallback.current=onSuccess}),isModalOpen&&agentPolicy&&newAgentPolicy?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiConfirmModal,{title:external_kbnSharedDeps_React_default.a.createElement("span",{className:"eui-textBreakWord"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.copyAgentPolicy.confirmModal.copyPolicyTitle",defaultMessage:"Copy '{name}' agent policy",values:{name:agentPolicy.name}})),onCancel:closeModal,onConfirm:copyAgentPolicy,cancelButtonText:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.copyAgentPolicy.confirmModal.cancelButtonLabel",defaultMessage:"Cancel"}),confirmButtonText:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.copyAgentPolicy.confirmModal.confirmButtonLabel",defaultMessage:"Copy policy"}),confirmButtonDisabled:isLoading||!newAgentPolicy.name.trim()},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.copyAgentPolicy.confirmModal.copyPolicyPrompt",defaultMessage:"Choose a name and description for your new agent policy."})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.copyAgentPolicy.confirmModal.newNameLabel",defaultMessage:"New policy name"}),fullWidth:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldText,{fullWidth:!0,value:newAgentPolicy.name,onChange:e=>setNewAgentPolicy({...newAgentPolicy,name:e.target.value})})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.copyAgentPolicy.confirmModal.newDescriptionLabel",defaultMessage:"Description"}),fullWidth:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldText,{fullWidth:!0,value:newAgentPolicy.description,onChange:e=>setNewAgentPolicy({...newAgentPolicy,description:e.target.value})}))):null)},PackagePolicyDeleteProvider=({agentPolicy:agentPolicy,children:children})=>{const{notifications:notifications}=Object(hooks.nb)(),{agents:{enabled:isFleetEnabled}}=Object(hooks.M)(),[packagePolicies,setPackagePolicies]=Object(external_kbnSharedDeps_React_.useState)([]),[isModalOpen,setIsModalOpen]=Object(external_kbnSharedDeps_React_.useState)(!1),[isLoadingAgentsCount,setIsLoadingAgentsCount]=Object(external_kbnSharedDeps_React_.useState)(!1),[agentsCount,setAgentsCount]=Object(external_kbnSharedDeps_React_.useState)(0),[isLoading,setIsLoading]=Object(external_kbnSharedDeps_React_.useState)(!1),onSuccessCallback=Object(external_kbnSharedDeps_React_.useRef)(null),fetchAgentsCount=Object(external_kbnSharedDeps_React_.useMemo)(()=>async()=>{if(isLoadingAgentsCount||!isFleetEnabled)return;setIsLoadingAgentsCount(!0);const{data:data}=await Object(hooks.F)({path:constants.b.LIST_PATTERN,method:"get",query:{page:1,perPage:1,kuery:`${constants.d}.policy_id : ${agentPolicy.id}`}});setAgentsCount((null==data?void 0:data.total)||0),setIsLoadingAgentsCount(!1)},[agentPolicy.id,isFleetEnabled,isLoadingAgentsCount]),deletePackagePoliciesPrompt=Object(external_kbnSharedDeps_React_.useMemo)(()=>(packagePoliciesToDelete,onSuccess=(()=>{}))=>{if(!Array.isArray(packagePoliciesToDelete)||0===packagePoliciesToDelete.length)throw new Error("No package policies specified for deletion");setIsModalOpen(!0),setPackagePolicies(packagePoliciesToDelete),fetchAgentsCount(),onSuccessCallback.current=onSuccess},[fetchAgentsCount]),closeModal=Object(external_kbnSharedDeps_React_.useMemo)(()=>()=>{setPackagePolicies([]),setIsLoading(!1),setIsLoadingAgentsCount(!1),setIsModalOpen(!1)},[]),deletePackagePolicies=Object(external_kbnSharedDeps_React_.useMemo)(()=>async()=>{setIsLoading(!0);try{const{data:data}=await Object(hooks.j)({packagePolicyIds:packagePolicies}),successfulResults=(null==data?void 0:data.filter(result=>result.success))||[],failedResults=(null==data?void 0:data.filter(result=>!result.success))||[];if(successfulResults.length){const successMessage=successfulResults.length>1?external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.deletePackagePolicy.successMultipleNotificationTitle",{defaultMessage:"Deleted {count} integrations",values:{count:successfulResults.length}}):external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.deletePackagePolicy.successSingleNotificationTitle",{defaultMessage:"Deleted integration '{id}'",values:{id:successfulResults[0].name||successfulResults[0].id}});notifications.toasts.addSuccess(successMessage)}if(failedResults.length){const failureMessage=failedResults.length>1?external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.deletePackagePolicy.failureMultipleNotificationTitle",{defaultMessage:"Error deleting {count} integrations",values:{count:failedResults.length}}):external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.deletePackagePolicy.failureSingleNotificationTitle",{defaultMessage:"Error deleting integration '{id}'",values:{id:failedResults[0].id}});notifications.toasts.addDanger(failureMessage)}onSuccessCallback.current&&onSuccessCallback.current(successfulResults.map(result=>result.id))}catch(e){notifications.toasts.addDanger(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.deletePackagePolicy.fatalErrorNotificationTitle",{defaultMessage:"Error deleting integration"}))}closeModal()},[closeModal,packagePolicies,notifications.toasts]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,children(deletePackagePoliciesPrompt),isModalOpen?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiConfirmModal,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.deletePackagePolicy.confirmModal.deleteMultipleTitle",defaultMessage:"Delete {count, plural, one {integration} other {# integrations}}?",values:{count:packagePolicies.length}}),onCancel:closeModal,onConfirm:deletePackagePolicies,cancelButtonText:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.deletePackagePolicy.confirmModal.cancelButtonLabel",defaultMessage:"Cancel"}),confirmButtonText:isLoading||isLoadingAgentsCount?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.deletePackagePolicy.confirmModal.loadingButtonLabel",defaultMessage:"Loadingâ¦"}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.deletePackagePolicy.confirmModal.confirmButtonLabel",defaultMessage:"Delete {agentPoliciesCount, plural, one {integration} other {integrations}}",values:{agentPoliciesCount:packagePolicies.length}}),buttonColor:"danger",confirmButtonDisabled:isLoading||isLoadingAgentsCount},isLoadingAgentsCount?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.deletePackagePolicy.confirmModal.loadingAgentsCountMessage",defaultMessage:"Checking affected agentsâ¦"}):agentsCount?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{color:"danger",title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.deletePackagePolicy.confirmModal.affectedAgentsTitle",defaultMessage:"This action will affect {agentsCount} {agentsCount, plural, one {agent} other {agents}}.",values:{agentsCount:agentsCount}})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.deletePackagePolicy.confirmModal.affectedAgentsMessage",defaultMessage:"Fleet has detected that {agentPolicyName} is already in use by some of your agents.",values:{agentPolicyName:external_kbnSharedDeps_React_default.a.createElement("strong",null,agentPolicy.name)}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"})):null,!isLoadingAgentsCount&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.deletePackagePolicy.confirmModal.generalMessage",defaultMessage:"This action can not be undone. Are you sure you wish to continue?"})):null)},FlyoutBody=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlyoutBody).withConfig({displayName:"FlyoutBody",componentId:"l5rkdh-0"})([".euiFlyoutBody__overflowContent{padding:0;}"]),AgentPolicyYamlFlyout=Object(external_kbnSharedDeps_React_.memo)(({policyId:policyId,onClose:onClose})=>{const core=Object(hooks.nb)(),{isLoading:isLoadingYaml,data:yamlData,error:error}=Object(hooks.W)(policyId),{data:agentPolicyData}=Object(hooks.V)(policyId),body=isLoadingYaml?external_kbnSharedDeps_React_default.a.createElement(Loading,null):error?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.policyDetails.ErrorGettingFullAgentPolicy",defaultMessage:"Error loading agent policy"}),color:"danger",iconType:"alert"},error.message):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCodeBlock,{language:"yaml",isCopyable:!0,fontSize:"m",whiteSpace:"pre"},Object(services.j)(yamlData.item)),downloadLink=core.http.basePath.prepend(services.b.getInfoFullDownloadPath(policyId));return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyout,{onClose:onClose,size:"l",maxWidth:640},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyoutHeader,{hasBorder:!0,"aria-labelledby":"IngestManagerAgentPolicyYamlFlyoutTitle"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"m"},external_kbnSharedDeps_React_default.a.createElement("h2",{id:"IngestManagerAgentPolicyYamlFlyoutTitle"},null!=agentPolicyData&&agentPolicyData.item?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.policyDetails.yamlflyoutTitleWithName",defaultMessage:"'{name}' agent policy",values:{name:agentPolicyData.item.name}}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.policyDetails.yamlflyoutTitleWithoutName",defaultMessage:"Agent policy"})))),external_kbnSharedDeps_React_default.a.createElement(FlyoutBody,null,body),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyoutFooter,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{onClick:onClose,flush:"left"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.policyDetails.yamlFlyoutCloseButtonLabel",defaultMessage:"Close"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{href:downloadLink,iconType:"download",isDisabled:Boolean(isLoadingYaml&&!yamlData)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.policyDetails.yamlDownloadButtonLabel",defaultMessage:"Download policy"}))))))});function linked_agent_count_extends(){return(linked_agent_count_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const LinkedAgentCount=Object(external_kbnSharedDeps_React_.memo)(({count:count,agentPolicyId:agentPolicyId,...otherEuiLinkProps})=>{const{getHref:getHref}=Object(hooks.ib)();return count>0?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,linked_agent_count_extends({},otherEuiLinkProps,{href:getHref("fleet_agent_list",{kuery:`${constants.d}.policy_id : ${agentPolicyId}`})}),count):external_kbnSharedDeps_React_default.a.createElement("span",{"data-test-subj":otherEuiLinkProps["data-test-subj"],className:otherEuiLinkProps.className},count)}),ConfirmDeployAgentPolicyModal=({onConfirm:onConfirm,onCancel:onCancel,agentCount:agentCount,agentPolicy:agentPolicy})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiConfirmModal,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentPolicy.confirmModalTitle",defaultMessage:"Save and deploy changes"}),onCancel:onCancel,onConfirm:onConfirm,cancelButtonText:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentPolicy.confirmModalCancelButtonLabel",defaultMessage:"Cancel"}),confirmButtonText:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentPolicy.confirmModalConfirmButtonLabel",defaultMessage:"Save and deploy changes"}),buttonColor:"primary"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{iconType:"iInCircle",title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentPolicy.confirmModalCalloutTitle",{defaultMessage:"This action will update {agentCount, plural, one {# agent} other {# agents}}",values:{agentCount:agentCount}})},external_kbnSharedDeps_React_default.a.createElement("div",{className:"eui-textBreakWord"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentPolicy.confirmModalCalloutDescription",defaultMessage:"Fleet has detected that the selected agent policy, {policyName}, is already in use by some of your agents. As a result of this action, Fleet will deploy updates to all agents that use this policy.",values:{policyName:external_kbnSharedDeps_React_default.a.createElement("b",null,agentPolicy.name)}}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentPolicy.confirmModalDescription",defaultMessage:"This action can not be undone. Are you sure you wish to continue?"})),DangerEuiContextMenuItem=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiContextMenuItem).withConfig({displayName:"DangerEuiContextMenuItem",componentId:"sc-1kxx75b-0"})(["color:",";"],props=>props.theme.eui.euiTextColors.danger),loading_Loading=()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceAround"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingSpinner,{size:"xl"})));var common_constants=__webpack_require__(0);const AgentPolicyPackageBadges=({agentPolicyId:agentPolicyId,hideTitle:hideTitle,excludeFleetServer:excludeFleetServer})=>{const agentPolicyRequest=Object(hooks.V)(agentPolicyId),agentPolicy=agentPolicyRequest.data?agentPolicyRequest.data.item:null,packages=Object(external_kbnSharedDeps_React_.useMemo)(()=>{if(!agentPolicy)return;const uniquePackages=new Map;return agentPolicy.package_policies.forEach(({package:pkg})=>{pkg&&(!uniquePackages.has(pkg.name)||uniquePackages.get(pkg.name).version<pkg.version)&&uniquePackages.set(pkg.name,pkg)}),[...uniquePackages.values()]},[agentPolicy]),showFleetServerWarning=Object(external_kbnSharedDeps_React_.useMemo)(()=>excludeFleetServer&&(null==packages?void 0:packages.some(pkg=>pkg.name===common_constants.N)),[packages,excludeFleetServer]),collectedIntegrationsCount=Object(external_kbnSharedDeps_React_.useMemo)(()=>packages?packages.filter(pkg=>!excludeFleetServer||pkg.name!==common_constants.N).length:0,[packages,excludeFleetServer]);return agentPolicy&&packages?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,!hideTitle&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentReassignPolicy.policyDescription",defaultMessage:"The selected agent policy will collect data for {count, plural, one {{countValue} integration} other {{countValue} integrations}}:",values:{count:collectedIntegrationsCount,countValue:external_kbnSharedDeps_React_default.a.createElement("b",null,collectedIntegrationsCount)}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"})),packages.map((pkg,idx)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBadge,{key:idx,color:"hollow",isDisabled:excludeFleetServer&&pkg.name===common_constants.N},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"row",gutterSize:"xs",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(PackageIcon,{packageName:pkg.name,version:pkg.version,tryApi:!0,style:{margin:"unset",width:"16px"}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},pkg.title)))),showFleetServerWarning&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{size:"s",color:"warning",iconType:"alert",title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentReassignPolicy.packageBadgeFleetServerWarning",{defaultMessage:"Fleet Server will not be enabled in standalone mode."})}))):null},AgentReassignAgentPolicyModal=({onClose:onClose,agents:agents})=>{const{notifications:notifications}=Object(hooks.nb)(),isSingleAgent=Array.isArray(agents)&&1===agents.length,[selectedAgentPolicyId,setSelectedAgentPolicyId]=Object(external_kbnSharedDeps_React_.useState)(isSingleAgent?agents[0].policy_id:void 0),agentPoliciesRequest=Object(hooks.O)({page:1,perPage:1e3}),agentPolicies=agentPoliciesRequest.data?agentPoliciesRequest.data.items:[];Object(external_kbnSharedDeps_React_.useEffect)(()=>{!selectedAgentPolicyId&&agentPolicies[0]&&setSelectedAgentPolicyId(agentPolicies[0].id)},[agentPolicies,selectedAgentPolicyId]);const policySelectOptions=Object(external_kbnSharedDeps_React_.useMemo)(()=>agentPolicies.filter(policy=>policy&&!policy.is_managed).map(agentPolicy=>({value:agentPolicy.id,text:agentPolicy.name})),[agentPolicies]),[isSubmitting,setIsSubmitting]=Object(external_kbnSharedDeps_React_.useState)(!1);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiConfirmModal,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentReassignPolicy.flyoutTitle",defaultMessage:"Assign new agent policy"}),onCancel:onClose,onConfirm:async function(){try{if(setIsSubmitting(!0),!selectedAgentPolicyId)throw new Error("No selected agent policy id");const res=isSingleAgent?await Object(hooks.C)(agents[0].id,{policy_id:selectedAgentPolicyId}):await Object(hooks.z)({policy_id:selectedAgentPolicyId,agents:Array.isArray(agents)?agents.map(agent=>agent.id):agents});if(res.error)throw res.error;setIsSubmitting(!1);const successMessage=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentReassignPolicy.successSingleNotificationTitle",{defaultMessage:"Agent policy reassigned"});notifications.toasts.addSuccess(successMessage),onClose()}catch(error){setIsSubmitting(!1),notifications.toasts.addError(error,{title:"Unable to reassign agent policy"})}},cancelButtonText:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentReassignPolicy.cancelButtonLabel",defaultMessage:"Cancel"}),confirmButtonDisabled:isSubmitting||isSingleAgent&&selectedAgentPolicyId===agents[0].policy_id,confirmButtonText:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentReassignPolicy.continueButtonLabel",defaultMessage:"Assign policy"}),buttonColor:"danger"},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentReassignPolicy.flyoutDescription",defaultMessage:"Choose a new agent policy to assign the selected {count, plural, one {agent} other {agents}} to.",values:{count:isSingleAgent?1:0}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{fullWidth:!0,label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentReassignPolicy.selectPolicyLabel",{defaultMessage:"Agent policy"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSelect,{fullWidth:!0,isLoading:agentPoliciesRequest.isLoading,options:policySelectOptions,value:selectedAgentPolicyId,onChange:e=>setSelectedAgentPolicyId(e.target.value)})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"}),selectedAgentPolicyId&&external_kbnSharedDeps_React_default.a.createElement(AgentPolicyPackageBadges,{agentPolicyId:selectedAgentPolicyId}))},PLATFORM_OPTIONS=[{text:"Linux / macOS",value:"linux-mac"},{text:"Windows",value:"windows"},{text:"RPM / DEB",value:"rpm-deb"}];function usePlatform(){const[platform,setPlatform]=Object(external_kbnSharedDeps_React_.useState)("linux-mac");return{platform:platform,setPlatform:setPlatform}}const CommandCode=external_kbnSharedDeps_StyledComponents_default.a.pre.withConfig({displayName:"CommandCode",componentId:"sc-1hf7c98-0"})({overflow:"scroll"});const ManualInstructions=({apiKey:apiKey,fleetServerHosts:fleetServerHosts})=>{const{platform:platform,setPlatform:setPlatform}=usePlatform(),enrollArgs=function(apiKey,fleetServerHosts){return`--url=${fleetServerHosts[0]} --enrollment-token=${apiKey.api_key}`}(apiKey,fleetServerHosts),linuxMacCommand="sudo ./elastic-agent install -f "+enrollArgs,windowsCommand=".\\elastic-agent.exe install -f "+enrollArgs;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.enrollmentInstructions.descriptionText",defaultMessage:"From the agent directory, run the appropriate command to install, enroll, and start an Elastic Agent. You can reuse these commands to set up agents on more than one host. Requires administrator privileges."})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSelect,{prepend:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.enrollmentInstructions.platformSelectLabel",defaultMessage:"Platform"})),options:PLATFORM_OPTIONS,value:platform,onChange:e=>setPlatform(e.target.value),"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.enrollmentInstructions.platformSelectAriaLabel",{defaultMessage:"Platform"})}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),"linux-mac"===platform&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCodeBlock,{fontSize:"m",isCopyable:!0,paddingSize:"m"},external_kbnSharedDeps_React_default.a.createElement(CommandCode,null,linuxMacCommand)),"windows"===platform&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCodeBlock,{fontSize:"m",isCopyable:!0,paddingSize:"m"},external_kbnSharedDeps_React_default.a.createElement(CommandCode,null,windowsCommand)),"rpm-deb"===platform&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.enrollmentInstructions.moreInstructionsText",defaultMessage:"See the {link} for RPM / DEB deploy instructions.",values:{link:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{target:"_blank",external:!0,href:"https://www.elastic.co/guide/en/fleet/current/elastic-agent-installation-configuration.html"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.enrollmentInstructions.moreInstructionsLink",defaultMessage:"Elastic Agent docs"}))}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.enrollmentInstructions.troubleshootingText",defaultMessage:"If you are having trouble connecting, see our {link}.",values:{link:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{target:"_blank",external:!0,href:"https://www.elastic.co/guide/en/fleet/current/fleet-troubleshooting.html"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.enrollmentInstructions.troubleshootingLink",defaultMessage:"troubleshooting guide"}))}})))},RequirementItem=({isMissing:isMissing,children:children})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s",alignItems:"flexStart"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,isMissing?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{type:"crossInACircleFilled",color:"danger"}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{type:"checkInCircleFilled",color:"success"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,children))),MissingESRequirementsPage=({missingRequirements:missingRequirements})=>external_kbnSharedDeps_React_default.a.createElement(WithoutHeaderLayout,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageBody,{restrictWidth:820},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageContent,{hasBorder:!0,hasShadow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.setupPage.missingRequirementsCalloutTitle",{defaultMessage:"Missing security requirements"}),color:"warning",iconType:"alert"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.setupPage.missingRequirementsCalloutDescription",defaultMessage:"To use central management for Elastic Agents, enable the following Elasticsearch security features."})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.setupPage.missingRequirementsElasticsearchTitle",defaultMessage:"In your Elasticsearch policy, enable:"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(RequirementItem,{isMissing:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.setupPage.elasticsearchSecurityFlagText",defaultMessage:"{esSecurityLink}. Set {securityFlag} to {true} .",values:{esSecurityLink:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/configuring-security.html",target:"_blank",external:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.setupPage.elasticsearchSecurityLink",defaultMessage:"Elasticsearch security"})),securityFlag:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCode,null,"xpack.security.enabled"),true:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCode,null,"true")}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(RequirementItem,{isMissing:missingRequirements.includes("api_keys")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.setupPage.elasticsearchApiKeyFlagText",defaultMessage:"{apiKeyLink}. Set {apiKeyFlag} to {true} .",values:{apiKeyFlag:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCode,null,"xpack.security.authc.api_key.enabled"),true:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCode,null,"true"),apiKeyLink:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/security-settings.html#api-key-service-settings",target:"_blank",external:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.setupPage.apiKeyServiceLink",defaultMessage:"API key service"}))}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCodeBlock,{isCopyable:!0},"xpack.security.enabled: true\nxpack.security.authc.api_key.enabled: true"),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.setupPage.gettingStartedText",defaultMessage:"For more information, read our {link} guide.",values:{link:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{href:"https://www.elastic.co/guide/en/fleet/current/index.html",target:"_blank",external:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.setupPage.gettingStartedLink",defaultMessage:"Getting Started"}))}})))),EnrollmentStepAgentPolicy=props=>{const{notifications:notifications}=Object(hooks.nb)(),{withKeySelection:withKeySelection,agentPolicies:agentPolicies,onAgentPolicyChange:onAgentPolicyChange,excludeFleetServer:excludeFleetServer}=props,onKeyChange=props.withKeySelection&&props.onKeyChange,[isAuthenticationSettingsOpen,setIsAuthenticationSettingsOpen]=Object(external_kbnSharedDeps_React_.useState)(!1),[enrollmentAPIKeys,setEnrollmentAPIKeys]=Object(external_kbnSharedDeps_React_.useState)([]),[selectedState,setSelectedState]=Object(external_kbnSharedDeps_React_.useState)({});return Object(external_kbnSharedDeps_React_.useEffect)((function(){onAgentPolicyChange&&selectedState.agentPolicyId&&onAgentPolicyChange(selectedState.agentPolicyId)}),[selectedState.agentPolicyId,onAgentPolicyChange]),Object(external_kbnSharedDeps_React_.useEffect)((function(){withKeySelection&&onKeyChange&&selectedState.enrollmentAPIKeyId&&onKeyChange(selectedState.enrollmentAPIKeyId)}),[withKeySelection,onKeyChange,selectedState.enrollmentAPIKeyId]),Object(external_kbnSharedDeps_React_.useEffect)((function(){if(agentPolicies&&agentPolicies.length&&!selectedState.agentPolicyId){if(1===agentPolicies.length)return void setSelectedState({...selectedState,agentPolicyId:agentPolicies[0].id});const defaultAgentPolicy=agentPolicies.find(agentPolicy=>agentPolicy.is_default);defaultAgentPolicy&&setSelectedState({...selectedState,agentPolicyId:defaultAgentPolicy.id})}}),[agentPolicies,selectedState]),Object(external_kbnSharedDeps_React_.useEffect)((function(){withKeySelection&&(selectedState.agentPolicyId?async function(){try{const res=await Object(hooks.n)({page:1,perPage:constants.l});if(res.error)throw res.error;if(!res.data)throw new Error("No data while fetching enrollment API keys");setEnrollmentAPIKeys(res.data.list.filter(key=>key.policy_id===selectedState.agentPolicyId&&!0===key.active))}catch(error){notifications.toasts.addError(error,{title:"Error"})}}():setEnrollmentAPIKeys([]))}),[withKeySelection,selectedState.agentPolicyId,notifications.toasts]),Object(external_kbnSharedDeps_React_.useEffect)((function(){if(withKeySelection&&!selectedState.enrollmentAPIKeyId&&enrollmentAPIKeys.length>0&&enrollmentAPIKeys[0].policy_id===selectedState.agentPolicyId){const enrollmentAPIKeyId=enrollmentAPIKeys[0].id;setSelectedState({agentPolicyId:selectedState.agentPolicyId,enrollmentAPIKeyId:enrollmentAPIKeyId})}}),[withKeySelection,enrollmentAPIKeys,selectedState.enrollmentAPIKeyId,selectedState.agentPolicyId]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSelect,{fullWidth:!0,prepend:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.enrollmentStepAgentPolicy.policySelectLabel",defaultMessage:"Agent policy"})),isLoading:!agentPolicies,options:(agentPolicies||[]).map(agentPolicy=>({value:agentPolicy.id,text:agentPolicy.name})),value:selectedState.agentPolicyId||void 0,onChange:e=>setSelectedState({agentPolicyId:e.target.value,enrollmentAPIKeyId:void 0}),"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.enrollmentStepAgentPolicy.policySelectAriaLabel",{defaultMessage:"Agent policy"})}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),selectedState.agentPolicyId&&external_kbnSharedDeps_React_default.a.createElement(AgentPolicyPackageBadges,{agentPolicyId:selectedState.agentPolicyId,excludeFleetServer:excludeFleetServer}),withKeySelection&&onKeyChange&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{flush:"left",iconType:isAuthenticationSettingsOpen?"arrowDown":"arrowRight",onClick:()=>setIsAuthenticationSettingsOpen(!isAuthenticationSettingsOpen)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.enrollmentStepAgentPolicy.showAuthenticationSettingsButton",defaultMessage:"Authentication settings"})),isAuthenticationSettingsOpen&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSelect,{fullWidth:!0,options:enrollmentAPIKeys.map(key=>({value:key.id,text:key.name})),value:selectedState.enrollmentAPIKeyId||void 0,prepend:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.enrollmentStepAgentPolicy.enrollmentTokenSelectLabel",defaultMessage:"Enrollment token"})),onChange:e=>{setSelectedState({...selectedState,enrollmentAPIKeyId:e.target.value})}}))))},DownloadStep=()=>({title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentEnrollment.stepDownloadAgentTitle",{defaultMessage:"Download the Elastic Agent to your host"}),children:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentEnrollment.downloadDescription",defaultMessage:"You can download the agent binaries and their verification signatures from the Elastic Agent download page."})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{href:"https://ela.st/download-elastic-agent",target:"_blank",iconSide:"right",iconType:"popout"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentEnrollment.downloadLink",defaultMessage:"Go to download page"})))}),AgentPolicySelectionStep=({agentPolicies:agentPolicies,setSelectedAPIKeyId:setSelectedAPIKeyId,setSelectedPolicyId:setSelectedPolicyId,setIsFleetServerPolicySelected:setIsFleetServerPolicySelected,excludeFleetServer:excludeFleetServer})=>{const regularAgentPolicies=Array.isArray(agentPolicies)?agentPolicies.filter(policy=>policy&&!policy.is_managed&&(!excludeFleetServer||!policy.is_default_fleet_server)):[],onAgentPolicyChange=Object(external_kbnSharedDeps_React_.useCallback)(async policyId=>{if(setSelectedPolicyId&&setSelectedPolicyId(policyId),setIsFleetServerPolicySelected){var _agentPolicyRequest$d;const agentPolicyRequest=await Object(hooks.p)(policyId);null!==(_agentPolicyRequest$d=agentPolicyRequest.data)&&void 0!==_agentPolicyRequest$d&&_agentPolicyRequest$d.item&&agentPolicyRequest.data.item.package_policies.some(packagePolicy=>{var _packagePolicy$packag;return(null===(_packagePolicy$packag=packagePolicy.package)||void 0===_packagePolicy$packag?void 0:_packagePolicy$packag.name)===constants.g})?setIsFleetServerPolicySelected(!0):setIsFleetServerPolicySelected(!1)}},[setIsFleetServerPolicySelected,setSelectedPolicyId]);return{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentEnrollment.stepChooseAgentPolicyTitle",{defaultMessage:"Choose an agent policy"}),children:external_kbnSharedDeps_React_default.a.createElement(EnrollmentStepAgentPolicy,{agentPolicies:regularAgentPolicies,withKeySelection:!!setSelectedAPIKeyId,onKeyChange:setSelectedAPIKeyId,onAgentPolicyChange:onAgentPolicyChange,excludeFleetServer:excludeFleetServer})}},FlexItemWithMinWidth=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexItem).withConfig({displayName:"FlexItemWithMinWidth",componentId:"sc-1urw201-0"})(["min-width:0px;max-width:100%;"]),fleet_server_requirement_page_ContentWrapper=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup).withConfig({displayName:"ContentWrapper",componentId:"sc-1urw201-1"})(["height:100%;margin:0 auto;max-width:800px;"]),fleet_server_requirement_page_CommandCode=external_kbnSharedDeps_StyledComponents_default.a.pre.withConfig({displayName:"CommandCode",componentId:"sc-1urw201-2"})({overflow:"scroll"}),ServiceTokenStep=({serviceToken:serviceToken,getServiceToken:getServiceToken,isLoadingServiceToken:isLoadingServiceToken})=>({title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.fleetServerSetup.stepGenerateServiceTokenTitle",{defaultMessage:"Generate a service token"}),children:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.fleetServerSetup.generateServiceTokenDescription",defaultMessage:"A service token grants Fleet Server permissions to write to Elasticsearch."})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),serviceToken?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{size:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.fleetServerSetup.saveServiceTokenDescription",defaultMessage:"Save your service token information. This will be shown only once."})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement("strong",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.fleetServerSetup.serviceTokenLabel",defaultMessage:"Service token"}))),external_kbnSharedDeps_React_default.a.createElement(FlexItemWithMinWidth,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCodeBlock,{paddingSize:"m",isCopyable:!0},external_kbnSharedDeps_React_default.a.createElement(fleet_server_requirement_page_CommandCode,null,serviceToken))))):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{fill:!0,isLoading:isLoadingServiceToken,isDisabled:isLoadingServiceToken,onClick:()=>{getServiceToken()}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.fleetServerSetup.generateServiceTokenButton",defaultMessage:"Generate service token"})))))}),FleetServerCommandStep=({serviceToken:serviceToken,installCommand:installCommand,platform:platform,setPlatform:setPlatform})=>({title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.fleetServerSetup.stepInstallAgentTitle",{defaultMessage:"Start Fleet Server"}),status:serviceToken?void 0:"disabled",children:serviceToken?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.fleetServerSetup.installAgentDescription",defaultMessage:"From the agent directory, copy and run the appropriate quick start command to start an Elastic Agent as a Fleet Server using the generated token and a self-signed certificate. See the {userGuideLink} for instructions on using your own certificates for production deployment. All commands require administrator privileges.",values:{userGuideLink:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{href:"https://ela.st/add-fleet-server",external:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.fleetServerSetup.setupGuideLink",defaultMessage:"Fleet User Guide"}))}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSelect,{prepend:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.fleetServerSetup.platformSelectLabel",defaultMessage:"Platform"})),options:PLATFORM_OPTIONS,value:platform,onChange:e=>setPlatform(e.target.value),"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.fleetServerSetup.platformSelectAriaLabel",{defaultMessage:"Platform"})}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCodeBlock,{fontSize:"m",isCopyable:!0,paddingSize:"m",language:"console",whiteSpace:"pre"},external_kbnSharedDeps_React_default.a.createElement(fleet_server_requirement_page_CommandCode,null,installCommand)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.enrollmentInstructions.troubleshootingText",defaultMessage:"If you are having trouble connecting, see our {link}.",values:{link:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{target:"_blank",external:!0,href:"https://www.elastic.co/guide/en/fleet/current/fleet-troubleshooting.html"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.enrollmentInstructions.troubleshootingLink",defaultMessage:"troubleshooting guide"}))}}))):null});const useFleetServerInstructions=policyId=>{var _outputsRequest$data,_outputsRequest$data$,_output$hosts;const outputsRequest=Object(hooks.Y)(),{notifications:notifications}=Object(hooks.nb)(),[serviceToken,setServiceToken]=Object(external_kbnSharedDeps_React_.useState)(),[isLoadingServiceToken,setIsLoadingServiceToken]=Object(external_kbnSharedDeps_React_.useState)(!1),{platform:platform,setPlatform:setPlatform}=usePlatform(),output=null===(_outputsRequest$data=outputsRequest.data)||void 0===_outputsRequest$data||null===(_outputsRequest$data$=_outputsRequest$data.items)||void 0===_outputsRequest$data$?void 0:_outputsRequest$data$[0],esHost=null==output||null===(_output$hosts=output.hosts)||void 0===_output$hosts?void 0:_output$hosts[0],installCommand=Object(external_kbnSharedDeps_React_.useMemo)(()=>serviceToken&&esHost?function(platform,esHost,serviceToken,policyId){const commandArguments=`-f --fleet-server-es=${esHost} --fleet-server-service-token=${serviceToken}${policyId?" --fleet-server-policy="+policyId:""}`;switch(platform){case"linux-mac":return"sudo ./elastic-agent install "+commandArguments;case"windows":return".\\elastic-agent.exe install "+commandArguments;case"rpm-deb":return"sudo elastic-agent enroll "+commandArguments;default:return""}}(platform,esHost,serviceToken,policyId):"",[serviceToken,esHost,platform,policyId]),getServiceToken=Object(external_kbnSharedDeps_React_.useCallback)(async()=>{setIsLoadingServiceToken(!0);try{const{data:data}=await Object(hooks.k)();null!=data&&data.value&&setServiceToken(null==data?void 0:data.value)}catch(err){notifications.toasts.addError(err,{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.fleetServerSetup.errorGeneratingTokenTitleText",{defaultMessage:"Error generating token"})})}setIsLoadingServiceToken(!1)},[notifications]);return{serviceToken:serviceToken,getServiceToken:getServiceToken,isLoadingServiceToken:isLoadingServiceToken,installCommand:installCommand,platform:platform,setPlatform:setPlatform}},OnPremInstructions=()=>{const{serviceToken:serviceToken,getServiceToken:getServiceToken,isLoadingServiceToken:isLoadingServiceToken,installCommand:installCommand,platform:platform,setPlatform:setPlatform}=useFleetServerInstructions();return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPanel,{paddingSize:"l",grow:!1,hasShadow:!1,hasBorder:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{className:"eui-textCenter"},external_kbnSharedDeps_React_default.a.createElement("h2",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.fleetServerSetup.setupTitle",defaultMessage:"Add a Fleet Server"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.fleetServerSetup.setupText",defaultMessage:"A Fleet Server is required before you can enroll agents with Fleet. See the {userGuideLink} for more information.",values:{userGuideLink:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{href:"https://ela.st/add-fleet-server",external:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.fleetServerSetup.setupGuideLink",defaultMessage:"Fleet User Guide"}))}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSteps,{className:"eui-textLeft",steps:[DownloadStep(),ServiceTokenStep({serviceToken:serviceToken,getServiceToken:getServiceToken,isLoadingServiceToken:isLoadingServiceToken}),FleetServerCommandStep({serviceToken:serviceToken,installCommand:installCommand,platform:platform,setPlatform:setPlatform})]}))},CloudInstructions=({deploymentUrl:deploymentUrl})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPanel,{paddingSize:"none",grow:!1,hasShadow:!1,hasBorder:!0,className:"eui-textCenter"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiEmptyPrompt,{title:external_kbnSharedDeps_React_default.a.createElement("h2",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.fleetServerSetup.cloudSetupTitle",defaultMessage:"Enable APM & Fleet"})),body:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.fleetServerSetup.cloudSetupText",defaultMessage:"A Fleet Server is required before you can enroll agents with Fleet. You can add one to your deployment by enabling APM & Fleet. For more information see the {link}",values:{link:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{href:"https://ela.st/add-fleet-server",target:"_blank",external:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.settings.userGuideLink",defaultMessage:"Fleet User Guide"}))}}),actions:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{iconSide:"right",iconType:"popout",fill:!0,isLoading:!1,type:"submit",href:deploymentUrl+"/edit",target:"_blank"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.fleetServerSetup.cloudDeploymentLink",defaultMessage:"Edit deployment"})))})),FleetServerRequirementPage=()=>{var _startService$cloud;const deploymentUrl=null===(_startService$cloud=Object(hooks.nb)().cloud)||void 0===_startService$cloud?void 0:_startService$cloud.deploymentUrl;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(fleet_server_requirement_page_ContentWrapper,{gutterSize:"l",justifyContent:"center",alignItems:"center",direction:"column"},external_kbnSharedDeps_React_default.a.createElement(FlexItemWithMinWidth,{grow:!1},deploymentUrl?external_kbnSharedDeps_React_default.a.createElement(CloudInstructions,{deploymentUrl:deploymentUrl}):external_kbnSharedDeps_React_default.a.createElement(OnPremInstructions,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingSpinner,{size:"m"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"s",color:"subdued"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.fleetServerSetup.waitingText",defaultMessage:"Waiting for a Fleet Server to connect..."})))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"xxl"}))},DefaultMissingRequirements=()=>{const{getHref:getHref}=Object(hooks.ib)();return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentEnrollment.agentsNotInitializedText",defaultMessage:"Before enrolling agents, {link}.",values:{link:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{href:getHref("fleet")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentEnrollment.setUpAgentsLink",defaultMessage:"set up central management for Elastic Agents"}))}}))},FleetServerMissingRequirements=()=>external_kbnSharedDeps_React_default.a.createElement(FleetServerRequirementPage,null),ManagedInstructions=external_kbnSharedDeps_React_default.a.memo(({agentPolicies:agentPolicies})=>{var _apiKey$data,_apiKey$data$item,_settings$data2,_settings$data2$item,_fleetStatus$missingR;const fleetStatus=Object(hooks.N)(),[selectedAPIKeyId,setSelectedAPIKeyId]=Object(external_kbnSharedDeps_React_.useState)(),[isFleetServerPolicySelected,setIsFleetServerPolicySelected]=Object(external_kbnSharedDeps_React_.useState)(!1),apiKey=Object(hooks.X)(selectedAPIKeyId),settings=Object(hooks.db)(),fleetServerInstructions=useFleetServerInstructions(null==apiKey||null===(_apiKey$data=apiKey.data)||void 0===_apiKey$data||null===(_apiKey$data$item=_apiKey$data.item)||void 0===_apiKey$data$item?void 0:_apiKey$data$item.policy_id),steps=Object(external_kbnSharedDeps_React_.useMemo)(()=>{var _settings$data,_settings$data$item;const{serviceToken:serviceToken,getServiceToken:getServiceToken,isLoadingServiceToken:isLoadingServiceToken,installCommand:installCommand,platform:platform,setPlatform:setPlatform}=fleetServerInstructions,fleetServerHosts=(null===(_settings$data=settings.data)||void 0===_settings$data||null===(_settings$data$item=_settings$data.item)||void 0===_settings$data$item?void 0:_settings$data$item.fleet_server_hosts)||[],baseSteps=[DownloadStep(),AgentPolicySelectionStep({agentPolicies:agentPolicies,setSelectedAPIKeyId:setSelectedAPIKeyId,setIsFleetServerPolicySelected:setIsFleetServerPolicySelected})];return isFleetServerPolicySelected?baseSteps.push(ServiceTokenStep({serviceToken:serviceToken,getServiceToken:getServiceToken,isLoadingServiceToken:isLoadingServiceToken}),FleetServerCommandStep({serviceToken:serviceToken,installCommand:installCommand,platform:platform,setPlatform:setPlatform})):baseSteps.push({title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentEnrollment.stepEnrollAndRunAgentTitle",{defaultMessage:"Enroll and start the Elastic Agent"}),children:apiKey.data&&external_kbnSharedDeps_React_default.a.createElement(ManualInstructions,{apiKey:apiKey.data.item,fleetServerHosts:fleetServerHosts})}),baseSteps},[agentPolicies,apiKey.data,isFleetServerPolicySelected,null===(_settings$data2=settings.data)||void 0===_settings$data2||null===(_settings$data2$item=_settings$data2.item)||void 0===_settings$data2$item?void 0:_settings$data2$item.fleet_server_hosts,fleetServerInstructions]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,fleetStatus.isReady?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentEnrollment.managedDescription",defaultMessage:"Enroll an Elastic Agent in Fleet to automatically deploy updates and centrally manage the agent."})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSteps,{steps:steps})):1===(null===(_fleetStatus$missingR=fleetStatus.missingRequirements)||void 0===_fleetStatus$missingR?void 0:_fleetStatus$missingR.length)&&"fleet_server"===fleetStatus.missingRequirements[0]?external_kbnSharedDeps_React_default.a.createElement(FleetServerMissingRequirements,null):external_kbnSharedDeps_React_default.a.createElement(DefaultMissingRequirements,null))}),StandaloneInstructions=external_kbnSharedDeps_React_default.a.memo(({agentPolicies:agentPolicies})=>{const{getHref:getHref}=Object(hooks.ib)(),core=Object(hooks.nb)(),{notifications:notifications}=core,[selectedPolicyId,setSelectedPolicyId]=Object(external_kbnSharedDeps_React_.useState)(),[fullAgentPolicy,setFullAgentPolicy]=Object(external_kbnSharedDeps_React_.useState)(),downloadLink=selectedPolicyId?core.http.basePath.prepend(services.b.getInfoFullDownloadPath(selectedPolicyId)+"?standalone=true"):void 0;Object(external_kbnSharedDeps_React_.useEffect)(()=>{!async function(){try{if(!selectedPolicyId)return;const res=await Object(hooks.q)(selectedPolicyId,{standalone:!0});if(res.error)throw res.error;if(!res.data)throw new Error("No data while fetching full agent policy");setFullAgentPolicy(res.data.item)}catch(error){notifications.toasts.addError(error,{title:"Error"})}}()},[selectedPolicyId,notifications.toasts]);const yaml=Object(external_kbnSharedDeps_React_.useMemo)(()=>Object(services.j)(fullAgentPolicy),[fullAgentPolicy]),steps=[DownloadStep(),AgentPolicySelectionStep({agentPolicies:agentPolicies,setSelectedPolicyId:setSelectedPolicyId,excludeFleetServer:!0}),{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentEnrollment.stepConfigureAgentTitle",{defaultMessage:"Configure the agent"}),children:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentEnrollment.stepConfigureAgentDescription",defaultMessage:"Copy this policy to the {fileName} on the host where the Elastic Agent is installed. Modify {ESUsernameVariable} and {ESPasswordVariable} in the {outputSection} section of {fileName} to use your Elasticsearch credentials.",values:{fileName:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCode,null,"elastic-agent.yml"),ESUsernameVariable:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCode,null,"ES_USERNAME"),ESPasswordVariable:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCode,null,"ES_PASSWORD"),outputSection:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCode,null,"outputs")}}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"m"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCopy,{textToCopy:yaml},copy=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{onClick:copy,iconType:"copyClipboard"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentEnrollment.copyPolicyButton",defaultMessage:"Copy to clipboard"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{iconType:"download",href:downloadLink,isDisabled:!downloadLink},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentEnrollment.downloadPolicyButton",defaultMessage:"Download policy"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCodeBlock,{language:"yaml",style:{maxHeight:300},fontSize:"m"},yaml)))},{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentEnrollment.stepRunAgentTitle",{defaultMessage:"Start the agent"}),children:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentEnrollment.stepRunAgentDescription",defaultMessage:"From the agent directory, run this command to install, enroll and start an Elastic Agent. You can reuse this command to set up agents on more than one host. Requires administrator privileges."}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCodeBlock,{fontSize:"m"},"./elastic-agent install"),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCopy,{textToCopy:"./elastic-agent install"},copy=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{onClick:copy,iconType:"copyClipboard"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentEnrollment.copyRunInstructionsButton",defaultMessage:"Copy to clipboard"})))))},{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentEnrollment.stepCheckForDataTitle",{defaultMessage:"Check for data"}),children:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentEnrollment.stepCheckForDataDescription",defaultMessage:"The agent should begin sending data. Go to {link} to view your data.",values:{link:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{href:getHref("data_streams")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentEnrollment.goToDataStreamsLink",defaultMessage:"data streams"}))}})))}];return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentEnrollment.standaloneDescription",defaultMessage:"Run an Elastic Agent standalone to configure and update the agent manually on the host where the agent is installed."})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSteps,{steps:steps}))}),MissingFleetServerHostCallout=()=>{const{setModal:setModal}=Object(hooks.ob)();return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentEnrollment.missingFleetHostCalloutTitle",{defaultMessage:"Missing URL for Fleet Server host"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentEnrollment.missingFleetHostCalloutText",defaultMessage:"A URL for your Fleet Server host is required to enroll agents with Fleet. You can add this information in Fleet Settings. For more information, see the {link}.",values:{link:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{href:"https://www.elastic.co/guide/en/fleet/current/index.html",target:"_blank",external:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentEnrollment.missingFleetHostGuideLink",defaultMessage:"Fleet User Guide"}))}}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{fill:!0,iconType:"gear",onClick:()=>{setModal("settings")}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentEnrollment.fleetSettingsLink",defaultMessage:"Fleet Settings"})))},AgentEnrollmentFlyout=({onClose:onClose,agentPolicies:agentPolicies})=>{var _settings$data,_settings$data$item;const[mode,setMode]=Object(external_kbnSharedDeps_React_.useState)("managed"),{modal:modal}=Object(hooks.ob)(),[lastModal,setLastModal]=Object(external_kbnSharedDeps_React_.useState)(modal),settings=Object(hooks.db)(),fleetServerHosts=(null===(_settings$data=settings.data)||void 0===_settings$data||null===(_settings$data$item=_settings$data.item)||void 0===_settings$data$item?void 0:_settings$data$item.fleet_server_hosts)||[];return Object(external_kbnSharedDeps_React_.useEffect)(()=>{modal!==lastModal&&(settings.resendRequest(),setLastModal(modal))},[modal,lastModal,settings]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyout,{onClose:onClose,size:"m"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyoutHeader,{hasBorder:!0,"aria-labelledby":"FleetAgentEnrollmentFlyoutTitle"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"m"},external_kbnSharedDeps_React_default.a.createElement("h2",{id:"FleetAgentEnrollmentFlyoutTitle"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentEnrollment.flyoutTitle",defaultMessage:"Add agent"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentEnrollment.agentDescription",defaultMessage:"Add Elastic Agents to your hosts to collect data and send it to the Elastic Stack."})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTabs,{style:{marginBottom:"-25px"}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTab,{isSelected:"managed"===mode,onClick:()=>setMode("managed")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentEnrollment.enrollFleetTabLabel",defaultMessage:"Enroll in Fleet"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTab,{isSelected:"standalone"===mode,onClick:()=>setMode("standalone")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentEnrollment.enrollStandaloneTabLabel",defaultMessage:"Run standalone"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyoutBody,{banner:0===fleetServerHosts.length&&"managed"===mode?external_kbnSharedDeps_React_default.a.createElement(MissingFleetServerHostCallout,null):void 0},0===fleetServerHosts.length&&"managed"===mode?null:"managed"===mode?external_kbnSharedDeps_React_default.a.createElement(ManagedInstructions,{agentPolicies:agentPolicies}):external_kbnSharedDeps_React_default.a.createElement(StandaloneInstructions,{agentPolicies:agentPolicies})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyoutFooter,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{onClick:onClose,flush:"left"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentEnrollment.cancelButtonLabel",defaultMessage:"Cancel"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{fill:!0,onClick:onClose},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentEnrollment.continueButtonLabel",defaultMessage:"Continue"}))))))},Status={Healthy:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBadge,{color:"secondary"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentHealth.healthyStatusText",defaultMessage:"Healthy"})),Offline:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBadge,{color:"default"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentHealth.offlineStatusText",defaultMessage:"Offline"})),Inactive:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBadge,{color:"default"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentHealth.inactiveStatusText",defaultMessage:"Inactive"})),Unhealthy:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBadge,{color:"warning"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentHealth.unhealthyStatusText",defaultMessage:"Unhealthy"})),Updating:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBadge,{color:"primary"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentHealth.updatingStatusText",defaultMessage:"Updating"}))};const AgentHealth=({agent:agent})=>{const{last_checkin:lastCheckIn}=agent,msLastCheckIn=new Date(lastCheckIn||0).getTime();return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{position:"top",content:msLastCheckIn?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentHealth.checkInTooltipText",defaultMessage:"Last checked in {lastCheckIn}",values:{lastCheckIn:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedRelative,{value:msLastCheckIn})}})):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentHealth.noCheckInTooltipText",defaultMessage:"Never checked in"})},function(agent){switch(agent.status){case"warning":case"error":case"degraded":return Status.Unhealthy;case"inactive":return Status.Inactive;case"offline":return Status.Offline;case"unenrolling":case"enrolling":case"updating":return Status.Updating;default:return Status.Healthy}}(agent))},AgentUnenrollAgentModal=({onClose:onClose,agents:agents,agentCount:agentCount,useForceUnenroll:useForceUnenroll})=>{const{notifications:notifications}=Object(hooks.nb)(),[forceUnenroll,setForceUnenroll]=Object(external_kbnSharedDeps_React_.useState)(useForceUnenroll||!1),[isSubmitting,setIsSubmitting]=Object(external_kbnSharedDeps_React_.useState)(!1),isSingleAgent=Array.isArray(agents)&&1===agents.length;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiConfirmModal,{title:isSingleAgent?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.unenrollAgents.deleteSingleTitle",defaultMessage:"Unenroll agent"}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.unenrollAgents.forceDeleteMultipleTitle",defaultMessage:"Unenroll {count} agents",values:{count:agentCount}}),onCancel:onClose,onConfirm:async function(){try{setIsSubmitting(!0);const{error:error}=isSingleAgent?await Object(hooks.x)(agents[0].id,{revoke:forceUnenroll}):await Object(hooks.A)({agents:Array.isArray(agents)?agents.map(agent=>agent.id):agents,revoke:forceUnenroll});if(error)throw error;if(setIsSubmitting(!1),forceUnenroll){const successMessage=isSingleAgent?external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.unenrollAgents.successForceSingleNotificationTitle",{defaultMessage:"Agent unenrolled"}):external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.unenrollAgents.successForceMultiNotificationTitle",{defaultMessage:"Agents unenrolled"});notifications.toasts.addSuccess(successMessage)}else{const successMessage=isSingleAgent?external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.unenrollAgents.successSingleNotificationTitle",{defaultMessage:"Unenrolling agent"}):external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.unenrollAgents.successMultiNotificationTitle",{defaultMessage:"Unenrolling agents"});notifications.toasts.addSuccess(successMessage)}onClose()}catch(error){setIsSubmitting(!1),notifications.toasts.addError(error,{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.unenrollAgents.fatalErrorNotificationTitle",{defaultMessage:"Error unenrolling {count, plural, one {agent} other {agents}}",values:{count:agentCount}})})}},cancelButtonText:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.unenrollAgents.cancelButtonLabel",defaultMessage:"Cancel"}),confirmButtonDisabled:isSubmitting,confirmButtonText:isSingleAgent?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.unenrollAgents.confirmSingleButtonLabel",defaultMessage:"Unenroll agent"}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.unenrollAgents.confirmMultipleButtonLabel",defaultMessage:"Unenroll {count} agents",values:{count:agentCount}}),buttonColor:"danger"},external_kbnSharedDeps_React_default.a.createElement("p",null,isSingleAgent?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.unenrollAgents.deleteSingleDescription",defaultMessage:'This action will remove the selected agent running on "{hostName}" from Fleet. Any data that was already sent by the agent will not be deleted. This action cannot be undone.',values:{hostName:agents[0].local_metadata.host.hostname}}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.unenrollAgents.deleteMultipleDescription",defaultMessage:"This action will remove multiple agents from Fleet and prevent new data from being ingested. Any data that was already sent by these agents will not be affected. This action cannot be undone."})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormFieldset,{legend:{children:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.unenrollAgents.forceUnenrollLegendText",defaultMessage:"Force unenroll {count, plural, one {agent} other {agents}}",values:{count:agentCount}})}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCheckbox,{id:"fleetForceUnenrollAgents",label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.unenrollAgents.forceUnenrollCheckboxLabel",defaultMessage:"Remove {count, plural, one {agent} other {agents}} immediately. Do not wait for agent to send any last data.",values:{count:agentCount}}),checked:forceUnenroll,onChange:e=>setForceUnenroll(e.target.checked),disabled:useForceUnenroll})))},AgentUpgradeAgentModal=({onClose:onClose,agents:agents,agentCount:agentCount,version:version})=>{const{notifications:notifications}=Object(hooks.nb)(),[isSubmitting,setIsSubmitting]=Object(external_kbnSharedDeps_React_.useState)(!1),isSingleAgent=Array.isArray(agents)&&1===agents.length,isAllAgents=""===agents;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiConfirmModal,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},isSingleAgent?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.upgradeAgents.upgradeSingleTitle",defaultMessage:"Upgrade agent to latest version"}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.upgradeAgents.upgradeMultipleTitle",defaultMessage:"Upgrade {count, plural, one {agent} other {{count} agents} =true {all selected agents}} to latest version",values:{count:isAllAgents||agentCount}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBetaBadge,{iconType:"beaker",label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.upgradeAgents.experimentalLabel",defaultMessage:"Experimental"}),tooltipContent:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.upgradeAgents.experimentalLabelTooltip",defaultMessage:"Upgrade agent might change or be removed in a future release and is not subject to the support SLA."})}))),onCancel:onClose,onConfirm:async function(){try{setIsSubmitting(!0);const{data:data,error:error}=isSingleAgent?await Object(hooks.y)(agents[0].id,{version:version}):await Object(hooks.B)({agents:Array.isArray(agents)?agents.map(agent=>agent.id):agents,version:version});if(error)throw error;const counts=Object.entries(data||{}).reduce((acc,[agentId,result])=>(++acc.total,++acc[result.success?"success":"error"],acc),{total:0,success:0,error:0});setIsSubmitting(!1);const successMessage=isSingleAgent?external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.upgradeAgents.successSingleNotificationTitle",{defaultMessage:"Upgraded {count} agent",values:{count:1}}):external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.upgradeAgents.successMultiNotificationTitle",{defaultMessage:"Upgraded {isMixed, select, true {{success} of {total}} other {{isAllAgents, select, true {all selected} other {{success}} }}} agents",values:{isMixed:counts.success!==counts.total,success:counts.success,total:counts.total,isAllAgents:isAllAgents}});counts.success===counts.total?notifications.toasts.addSuccess(successMessage):counts.error===counts.total?notifications.toasts.addDanger(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.upgradeAgents.bulkResultAllErrorsNotificationTitle",{defaultMessage:"Error upgrading {count, plural, one {agent} other {{count} agents} =true {all selected agents}}",values:{count:isAllAgents||agentCount}})):notifications.toasts.addWarning({title:successMessage,text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.upgradeAgents.bulkResultErrorResultsSummary",{defaultMessage:"{count} {count, plural, one {agent was} other {agents were}} not successful",values:{count:counts.error}})}),onClose()}catch(error){setIsSubmitting(!1),notifications.toasts.addError(error,{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.upgradeAgents.fatalErrorNotificationTitle",{defaultMessage:"Error upgrading {count, plural, one {agent} other {{count} agents} =true {all selected agents}}",values:{count:isAllAgents||agentCount}})})}},cancelButtonText:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.upgradeAgents.cancelButtonLabel",defaultMessage:"Cancel"}),confirmButtonDisabled:isSubmitting,confirmButtonText:isSingleAgent?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.upgradeAgents.confirmSingleButtonLabel",defaultMessage:"Upgrade agent"}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.upgradeAgents.confirmMultipleButtonLabel",defaultMessage:"Upgrade {count, plural, one {agent} other {{count} agents} =true {all selected agents}}",values:{count:isAllAgents||agentCount}})},external_kbnSharedDeps_React_default.a.createElement("p",null,isSingleAgent?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.upgradeAgents.upgradeSingleDescription",defaultMessage:"This action will upgrade the agent running on '{hostName}' to version {version}. This action can not be undone. Are you sure you wish to continue?",values:{hostName:agents[0].local_metadata.host.hostname,version:version}}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.upgradeAgents.upgradeMultipleDescription",defaultMessage:"This action will upgrade multiple agents to version {version}. This action can not be undone. Are you sure you wish to continue?",values:{version:version}})))},AgentPolicyActionMenu=Object(external_kbnSharedDeps_React_.memo)(({agentPolicy:agentPolicy,onCopySuccess:onCopySuccess,fullButton:fullButton=!1,enrollmentFlyoutOpenByDefault:enrollmentFlyoutOpenByDefault=!1,onCancelEnrollment:onCancelEnrollment})=>{const hasWriteCapabilities=Object(hooks.K)().write,[isYamlFlyoutOpen,setIsYamlFlyoutOpen]=Object(external_kbnSharedDeps_React_.useState)(!1),[isEnrollmentFlyoutOpen,setIsEnrollmentFlyoutOpen]=Object(external_kbnSharedDeps_React_.useState)(enrollmentFlyoutOpenByDefault),onClose=Object(external_kbnSharedDeps_React_.useMemo)(()=>onCancelEnrollment||(()=>setIsEnrollmentFlyoutOpen(!1)),[onCancelEnrollment,setIsEnrollmentFlyoutOpen]);return external_kbnSharedDeps_React_default.a.createElement(AgentPolicyCopyProvider,null,copyAgentPolicyPrompt=>{const viewPolicyItem=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenuItem,{icon:"inspect",onClick:()=>setIsYamlFlyoutOpen(!isYamlFlyoutOpen),key:"viewPolicy"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentPolicyActionMenu.viewPolicyText",defaultMessage:"View policy"})),menuItems=null!=agentPolicy&&agentPolicy.is_managed?[viewPolicyItem]:[external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenuItem,{disabled:!hasWriteCapabilities,icon:"plusInCircle",onClick:()=>setIsEnrollmentFlyoutOpen(!0),key:"enrollAgents"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentPolicyActionMenu.enrollAgentActionText",defaultMessage:"Add agent"})),viewPolicyItem,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenuItem,{disabled:!hasWriteCapabilities,icon:"copy",onClick:()=>{copyAgentPolicyPrompt(agentPolicy,onCopySuccess)},key:"copyPolicy"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentPolicyActionMenu.copyPolicyActionText",defaultMessage:"Copy policy"}))];return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,isYamlFlyoutOpen?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPortal,null,external_kbnSharedDeps_React_default.a.createElement(AgentPolicyYamlFlyout,{policyId:agentPolicy.id,onClose:()=>setIsYamlFlyoutOpen(!1)})):null,isEnrollmentFlyoutOpen&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPortal,null,external_kbnSharedDeps_React_default.a.createElement(AgentEnrollmentFlyout,{agentPolicies:[agentPolicy],onClose:onClose})),external_kbnSharedDeps_React_default.a.createElement(ContextMenuActions,{button:fullButton?{props:{iconType:"arrowDown",iconSide:"right"},children:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentPolicyActionMenu.buttonText",defaultMessage:"Actions"})}:void 0,items:menuItems}))})}),UIExtensionsContext=external_kbnSharedDeps_React_default.a.createContext({}),useUIExtension=(packageName,view)=>{var _registeredExtensions;const registeredExtensions=Object(external_kbnSharedDeps_React_.useContext)(UIExtensionsContext);if(!registeredExtensions)throw new Error("useUIExtension called outside of UIExtensionsContext");const extension=null==registeredExtensions||null===(_registeredExtensions=registeredExtensions[packageName])||void 0===_registeredExtensions?void 0:_registeredExtensions[view];if(extension)return extension.component},ExtensionWrapper=Object(external_kbnSharedDeps_React_.memo)(({children:children})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiErrorBoundary,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Suspense,{fallback:external_kbnSharedDeps_React_default.a.createElement(Loading,null)},children)));var pkg_key_from_package_info=__webpack_require__(24);const CreatePackagePolicyPageLayout=Object(external_kbnSharedDeps_React_.memo)(({from:from,cancelUrl:cancelUrl,onCancel:onCancel,agentPolicy:agentPolicy,packageInfo:packageInfo,children:children,"data-test-subj":dataTestSubj})=>{const pageTitle=Object(external_kbnSharedDeps_React_.useMemo)(()=>"package"!==from&&"package-edit"!==from&&"edit"!==from||!packageInfo?"edit"===from||"package-edit"===from?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement("h1",{"data-test-subj":dataTestSubj+"_pageTitle"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.editPackagePolicy.pageTitle",defaultMessage:"Edit integration"}))):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement("h1",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.createPackagePolicy.pageTitle",defaultMessage:"Add integration"}))):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",gutterSize:"m"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(PackageIcon,{packageName:(null==packageInfo?void 0:packageInfo.name)||"",version:(null==packageInfo?void 0:packageInfo.version)||"",icons:null==packageInfo?void 0:packageInfo.icons,size:"xl"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement("h1",{"data-test-subj":dataTestSubj+"_pageTitle"},"edit"===from||"package-edit"===from?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.editPackagePolicy.pageTitleWithPackageName",defaultMessage:"Edit {packageName} integration",values:{packageName:packageInfo.title}}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.createPackagePolicy.pageTitleWithPackageName",defaultMessage:"Add {packageName} integration",values:{packageName:packageInfo.title}}))))),[dataTestSubj,from,packageInfo]),pageDescription=Object(external_kbnSharedDeps_React_.useMemo)(()=>"edit"===from||"package-edit"===from?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.editPackagePolicy.pageDescription",defaultMessage:"Modify integration settings and deploy changes to the selected agent policy."}):"policy"===from?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.createPackagePolicy.pageDescriptionfromPolicy",defaultMessage:"Configure an integration for the selected agent policy."}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.createPackagePolicy.pageDescriptionfromPackage",defaultMessage:"Follow these instructions to add this integration to an agent policy."}),[from]),leftColumn=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"column",gutterSize:"s",alignItems:"flexStart"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{size:"xs",iconType:"arrowLeft",flush:"left",href:cancelUrl,onClick:onCancel,"data-test-subj":dataTestSubj+"_cancelBackLink"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.createPackagePolicy.cancelLinkText",defaultMessage:"Cancel"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,pageTitle),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{color:"subdued",size:"s"},pageDescription))),rightColumn=!agentPolicy||"policy"!==from&&"edit"!==from?void 0:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionList,{className:"eui-textRight",textStyle:"reverse"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionListTitle,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.createPackagePolicy.agentPolicyNameLabel",defaultMessage:"Agent policy"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionListDescription,{className:"eui-textBreakWord"},(null==agentPolicy?void 0:agentPolicy.name)||"-"));return external_kbnSharedDeps_React_default.a.createElement(WithHeaderLayout,{restrictHeaderWidth:770,restrictWidth:770,leftColumn:leftColumn,rightColumn:rightColumn,rightColumnGrow:!1,"data-test-subj":dataTestSubj},children)}),isAdvancedVar=varDef=>!(varDef.show_user||varDef.required&&void 0===varDef.default),hasInvalidButRequiredVar=(registryVars,packagePolicyVars)=>registryVars&&!packagePolicyVars||Boolean(registryVars&&registryVars.find(registryVar=>{var _validatePackagePolic;return registryVar.required&&(!packagePolicyVars||!packagePolicyVars[registryVar.name]||(null===(_validatePackagePolic=validatePackagePolicyConfig(packagePolicyVars[registryVar.name],registryVar))||void 0===_validatePackagePolic?void 0:_validatePackagePolic.length))})),validatePackagePolicy=(packagePolicy,packageInfo)=>{const validationResults={name:null,description:null,namespace:null,inputs:{}},namespaceValidation=Object(services.n)(packagePolicy.namespace);if(packagePolicy.name.trim()||(validationResults.name=[external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.packagePolicyValidation.nameRequiredErrorMessage",{defaultMessage:"Name is required"})]),!namespaceValidation.valid&&namespaceValidation.error&&(validationResults.namespace=[namespaceValidation.error]),!packageInfo.policy_templates||0===packageInfo.policy_templates.length||!packageInfo.policy_templates[0]||!packageInfo.policy_templates[0].inputs||0===packageInfo.policy_templates[0].inputs.length)return validationResults.inputs=null,validationResults;const registryInputsByType=packageInfo.policy_templates[0].inputs.reduce((inputs,registryInput)=>(inputs[registryInput.type]=registryInput,inputs),{}),registryStreamsByDataset=(packageInfo.data_streams||[]).reduce((dataStreams,registryDataStream)=>(dataStreams[registryDataStream.dataset]=registryDataStream.streams||[],dataStreams),{});return packagePolicy.inputs.forEach(input=>{if(!input.vars&&!input.streams)return;const inputValidationResults={vars:void 0,streams:{}},inputVarsByName=(registryInputsByType[input.type].vars||[]).reduce((vars,registryVar)=>(vars[registryVar.name]=registryVar,vars),{}),inputConfigs=Object.entries(input.vars||{});inputConfigs.length?inputValidationResults.vars=inputConfigs.reduce((results,[name,configEntry])=>(results[name]=input.enabled?validatePackagePolicyConfig(configEntry,inputVarsByName[name]):null,results),{}):delete inputValidationResults.vars,input.streams.length?input.streams.forEach(stream=>{const streamValidationResults={};if(stream.vars){const streamVarsByName=((registryStreamsByDataset[stream.data_stream.dataset].find(registryStream=>registryStream.input===input.type)||{}).vars||[]).reduce((vars,registryVar)=>(vars[registryVar.name]=registryVar,vars),{});streamValidationResults.vars=Object.entries(stream.vars).reduce((results,[name,configEntry])=>(results[name]=input.enabled&&stream.enabled?validatePackagePolicyConfig(configEntry,streamVarsByName[name]):null,results),{})}inputValidationResults.streams[stream.data_stream.dataset]=streamValidationResults}):delete inputValidationResults.streams,(inputValidationResults.vars||inputValidationResults.streams)&&(validationResults.inputs[input.type]=inputValidationResults)}),0===Object.entries(validationResults.inputs).length&&(validationResults.inputs=null),validationResults},validatePackagePolicyConfig=(configEntry,varDef)=>{const errors=[],{value:value}=configEntry;let parsedValue=value;if("string"==typeof value&&(parsedValue=value.trim()),varDef.required&&(void 0===parsedValue||"string"==typeof parsedValue&&!parsedValue)&&errors.push(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.packagePolicyValidation.requiredErrorMessage",{defaultMessage:"{fieldName} is required",values:{fieldName:varDef.title||varDef.name}})),"yaml"===varDef.type)try{parsedValue=Object(js_yaml.safeLoad)(value)}catch(e){errors.push(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.packagePolicyValidation.invalidYamlFormatErrorMessage",{defaultMessage:"Invalid YAML format"}))}if(varDef.multi&&(parsedValue&&!Array.isArray(parsedValue)&&errors.push(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.packagePolicyValidation.invalidArrayErrorMessage",{defaultMessage:"Invalid format"})),varDef.required&&(!parsedValue||Array.isArray(parsedValue)&&0===parsedValue.length)&&errors.push(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.packagePolicyValidation.requiredErrorMessage",{defaultMessage:"{fieldName} is required",values:{fieldName:varDef.title||varDef.name}})),"text"===varDef.type&&parsedValue&&Array.isArray(parsedValue))){parsedValue.filter(cand=>/^[*&]/.test(cand)).length>0&&errors.push(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.packagePolicyValidation.quoteStringErrorMessage",{defaultMessage:"Strings starting with special YAML characters like * or & need to be enclosed in double quotes."}))}return"text"===varDef.type&&parsedValue&&!Array.isArray(parsedValue)&&/^[*&]/.test(parsedValue)&&errors.push(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.packagePolicyValidation.quoteStringErrorMessage",{defaultMessage:"Strings starting with special YAML characters like * or & need to be enclosed in double quotes."})),errors.length?errors:null},countValidationErrors=validationResults=>{const flattenedValidation=Object(services.k)(validationResults);return(Object.values(flattenedValidation).filter(value=>Boolean(value))||[]).length},validationHasErrors=validationResults=>countValidationErrors(validationResults)>0;var react_markdown=__webpack_require__(122),react_markdown_default=__webpack_require__.n(react_markdown);const PackagePolicyInputVarField=Object(external_kbnSharedDeps_React_.memo)(({varDef:varDef,value:value,onChange:onChange,errors:varErrors,forceShowErrors:forceShowErrors,frozen:frozen})=>{const[isDirty,setIsDirty]=Object(external_kbnSharedDeps_React_.useState)(!1),{multi:multi,required:required,type:type,title:title,name:name,description:description}=varDef,isInvalid=(isDirty||forceShowErrors)&&!!varErrors,errors=isInvalid?varErrors:null,fieldLabel=title||name,field=Object(external_kbnSharedDeps_React_.useMemo)(()=>{if(multi)return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiComboBox,{noSuggestions:!0,isInvalid:isInvalid,selectedOptions:value.map(val=>({label:val})),onCreateOption:newVal=>{onChange([...value,newVal])},onChange:newVals=>{onChange(newVals.map(val=>val.label))},onBlur:()=>setIsDirty(!0),isDisabled:frozen});switch(type){case"yaml":return frozen?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTextArea,{className:"ace_editor",disabled:!0,value:value,style:{height:"175px",padding:"4px",whiteSpace:"pre",resize:"none"}}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCodeEditor,{width:"100%",mode:"yaml",theme:"textmate",setOptions:{minLines:10,maxLines:30,tabSize:2,showGutter:!1},value:value,onChange:newVal=>onChange(newVal),onBlur:()=>setIsDirty(!0)});case"bool":return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSwitch,{label:fieldLabel,checked:value,showLabel:!1,onChange:e=>onChange(e.target.checked),onBlur:()=>setIsDirty(!0),disabled:frozen});case"password":return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldPassword,{type:"dual",isInvalid:isInvalid,value:void 0===value?"":value,onChange:e=>onChange(e.target.value),onBlur:()=>setIsDirty(!0),disabled:frozen});default:return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldText,{isInvalid:isInvalid,value:void 0===value?"":value,onChange:e=>onChange(e.target.value),onBlur:()=>setIsDirty(!0),disabled:frozen})}},[isInvalid,multi,onChange,type,value,fieldLabel,frozen]),isOptional=Object(external_kbnSharedDeps_React_.useMemo)(()=>"bool"!==type&&!required,[required,type]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{isInvalid:isInvalid,error:errors,label:fieldLabel,labelAppend:isOptional?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs",color:"subdued"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.createPackagePolicy.stepConfigure.inputVarFieldOptionalLabel",defaultMessage:"Optional"})):null,helpText:external_kbnSharedDeps_React_default.a.createElement(react_markdown_default.a,{source:description})},field)}),FlexItemWithMaxWidth=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexItem).withConfig({displayName:"FlexItemWithMaxWidth",componentId:"sc-2lf3ki-0"})(["max-width:calc(50% - ",");"],props=>props.theme.eui.euiSizeL),PackagePolicyInputConfig=Object(external_kbnSharedDeps_React_.memo)(({hasInputStreams:hasInputStreams,packageInputVars:packageInputVars,packagePolicyInput:packagePolicyInput,updatePackagePolicyInput:updatePackagePolicyInput,inputVarsValidationResults:inputVarsValidationResults,forceShowErrors:forceShowErrors})=>{const[isShowingAdvanced,setIsShowingAdvanced]=Object(external_kbnSharedDeps_React_.useState)(!1),hasErrors=forceShowErrors&&validationHasErrors(inputVarsValidationResults),requiredVars=[],advancedVars=[];packageInputVars&&packageInputVars.forEach(varDef=>{isAdvancedVar(varDef)?advancedVars.push(varDef):requiredVars.push(varDef)});const advancedVarsWithErrorsCount=Object(external_kbnSharedDeps_React_.useMemo)(()=>advancedVars.filter(({name:varName})=>{var _inputVarsValidationR,_inputVarsValidationR2;return null===(_inputVarsValidationR=inputVarsValidationResults.vars)||void 0===_inputVarsValidationR||null===(_inputVarsValidationR2=_inputVarsValidationR[varName])||void 0===_inputVarsValidationR2?void 0:_inputVarsValidationR2.length}).length,[advancedVars,inputVarsValidationResults.vars]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGrid,{columns:2},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"none",alignItems:"flexStart"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:1}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:5},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement("h4",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.createPackagePolicy.stepConfigure.inputSettingsTitle",defaultMessage:"Settings"}))),hasInputStreams?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{color:"subdued",size:"s"},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.createPackagePolicy.stepConfigure.inputSettingsDescription",defaultMessage:"The following settings are applicable to all inputs below."})))):null))),external_kbnSharedDeps_React_default.a.createElement(FlexItemWithMaxWidth,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"column",gutterSize:"m"},requiredVars.map(varDef=>{const{name:varName,type:varType}=varDef,{value:value,frozen:frozen}=packagePolicyInput.vars[varName];return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{key:varName},external_kbnSharedDeps_React_default.a.createElement(PackagePolicyInputVarField,{varDef:varDef,value:value,frozen:frozen,onChange:newValue=>{updatePackagePolicyInput({vars:{...packagePolicyInput.vars,[varName]:{type:varType,value:newValue}}})},errors:inputVarsValidationResults.vars[varName],forceShowErrors:forceShowErrors}))}),advancedVars.length?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{size:"xs",iconType:isShowingAdvanced?"arrowDown":"arrowRight",onClick:()=>setIsShowingAdvanced(!isShowingAdvanced),flush:"left"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.createPackagePolicy.stepConfigure.toggleAdvancedOptionsButtonText",defaultMessage:"Advanced options"}))),!isShowingAdvanced&&hasErrors&&advancedVarsWithErrorsCount?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{color:"danger",size:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.createPackagePolicy.stepConfigure.errorCountText",defaultMessage:"{count, plural, one {# error} other {# errors}}",values:{count:advancedVarsWithErrorsCount}}))):null)),isShowingAdvanced?advancedVars.map(varDef=>{const{name:varName,type:varType}=varDef,value=packagePolicyInput.vars[varName].value;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{key:varName},external_kbnSharedDeps_React_default.a.createElement(PackagePolicyInputVarField,{varDef:varDef,value:value,onChange:newValue=>{updatePackagePolicyInput({vars:{...packagePolicyInput.vars,[varName]:{type:varType,value:newValue}}})},errors:inputVarsValidationResults.vars[varName],forceShowErrors:forceShowErrors}))}):null):null)))}),package_policy_input_stream_FlexItemWithMaxWidth=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexItem).withConfig({displayName:"FlexItemWithMaxWidth",componentId:"d6l6ns-0"})(["max-width:calc(50% - ",");"],props=>props.theme.eui.euiSizeL),PackagePolicyInputStreamConfig=Object(external_kbnSharedDeps_React_.memo)(({packageInputStream:packageInputStream,packagePolicyInputStream:packagePolicyInputStream,updatePackagePolicyInputStream:updatePackagePolicyInputStream,inputStreamValidationResults:inputStreamValidationResults,forceShowErrors:forceShowErrors})=>{const[isShowingAdvanced,setIsShowingAdvanced]=Object(external_kbnSharedDeps_React_.useState)(),hasErrors=forceShowErrors&&validationHasErrors(inputStreamValidationResults),requiredVars=[],advancedVars=[];packageInputStream.vars&&packageInputStream.vars.length&&packageInputStream.vars.forEach(varDef=>{isAdvancedVar(varDef)?advancedVars.push(varDef):requiredVars.push(varDef)});const advancedVarsWithErrorsCount=Object(external_kbnSharedDeps_React_.useMemo)(()=>advancedVars.filter(({name:varName})=>{var _inputStreamValidatio,_inputStreamValidatio2;return null===(_inputStreamValidatio=inputStreamValidationResults.vars)||void 0===_inputStreamValidatio||null===(_inputStreamValidatio2=_inputStreamValidatio[varName])||void 0===_inputStreamValidatio2?void 0:_inputStreamValidatio2.length}).length,[advancedVars,inputStreamValidationResults.vars]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGrid,{columns:2},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"none",alignItems:"flexStart"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:1}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:5},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSwitch,{label:packageInputStream.title,disabled:packagePolicyInputStream.keep_enabled,checked:packagePolicyInputStream.enabled,onChange:e=>{const enabled=e.target.checked;updatePackagePolicyInputStream({enabled:enabled})}}),packageInputStream.description?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"s",color:"subdued"},external_kbnSharedDeps_React_default.a.createElement(react_markdown_default.a,{source:packageInputStream.description}))):null))),external_kbnSharedDeps_React_default.a.createElement(package_policy_input_stream_FlexItemWithMaxWidth,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"column",gutterSize:"m"},requiredVars.map(varDef=>{const{name:varName,type:varType}=varDef,{value:value,frozen:frozen}=packagePolicyInputStream.vars[varName];return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{key:varName},external_kbnSharedDeps_React_default.a.createElement(PackagePolicyInputVarField,{varDef:varDef,value:value,frozen:frozen,onChange:newValue=>{updatePackagePolicyInputStream({vars:{...packagePolicyInputStream.vars,[varName]:{type:varType,value:newValue}}})},errors:inputStreamValidationResults.vars[varName],forceShowErrors:forceShowErrors}))}),advancedVars.length?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{size:"xs",iconType:isShowingAdvanced?"arrowDown":"arrowRight",onClick:()=>setIsShowingAdvanced(!isShowingAdvanced),flush:"left"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.createPackagePolicy.stepConfigure.toggleAdvancedOptionsButtonText",defaultMessage:"Advanced options"}))),!isShowingAdvanced&&hasErrors&&advancedVarsWithErrorsCount?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{color:"danger",size:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.createPackagePolicy.stepConfigure.errorCountText",defaultMessage:"{count, plural, one {# error} other {# errors}}",values:{count:advancedVarsWithErrorsCount}}))):null)),isShowingAdvanced?advancedVars.map(varDef=>{const{name:varName,type:varType}=varDef,value=packagePolicyInputStream.vars[varName].value;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{key:varName},external_kbnSharedDeps_React_default.a.createElement(PackagePolicyInputVarField,{varDef:varDef,value:value,onChange:newValue=>{updatePackagePolicyInputStream({vars:{...packagePolicyInputStream.vars,[varName]:{type:varType,value:newValue}}})},errors:inputStreamValidationResults.vars[varName],forceShowErrors:forceShowErrors}))}):null):null)))}),ShortenedHorizontalRule=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiHorizontalRule).withConfig({displayName:"ShortenedHorizontalRule",componentId:"sc-3olfkf-0"})(["&&&{width:","%;margin-left:auto;}"],11/12*100),PackagePolicyInputPanel=Object(external_kbnSharedDeps_React_.memo)(({packageInput:packageInput,packageInputStreams:packageInputStreams,packagePolicyInput:packagePolicyInput,updatePackagePolicyInput:updatePackagePolicyInput,inputValidationResults:inputValidationResults,forceShowErrors:forceShowErrors})=>{const[isShowingStreams,setIsShowingStreams]=Object(external_kbnSharedDeps_React_.useState)(((packageInput,packageInputStreams,packagePolicyInput)=>packagePolicyInput.enabled&&(hasInvalidButRequiredVar(packageInput.vars,packagePolicyInput.vars)||Boolean(packageInputStreams.find(stream=>{var _packagePolicyInput$s;return stream.enabled&&hasInvalidButRequiredVar(stream.vars,null===(_packagePolicyInput$s=packagePolicyInput.streams.find(pkgStream=>stream.data_stream.dataset===pkgStream.data_stream.dataset))||void 0===_packagePolicyInput$s?void 0:_packagePolicyInput$s.vars)}))))(packageInput,packageInputStreams,packagePolicyInput)),errorCount=countValidationErrors(inputValidationResults),hasErrors=forceShowErrors&&errorCount,hasInputStreams=Object(external_kbnSharedDeps_React_.useMemo)(()=>packageInputStreams.length>0,[packageInputStreams.length]),inputStreams=Object(external_kbnSharedDeps_React_.useMemo)(()=>packageInputStreams.map(packageInputStream=>({packageInputStream:packageInputStream,packagePolicyInputStream:packagePolicyInput.streams.find(stream=>stream.data_stream.dataset===packageInputStream.data_stream.dataset)})).filter(stream=>Boolean(stream.packagePolicyInputStream)),[packageInputStreams,packagePolicyInput.streams]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSwitch,{label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement("h4",null,packageInput.title||packageInput.type)))),checked:packagePolicyInput.enabled,disabled:packagePolicyInput.keep_enabled,onChange:e=>{const enabled=e.target.checked;updatePackagePolicyInput({enabled:enabled,streams:packagePolicyInput.streams.map(stream=>({...stream,enabled:enabled}))}),!enabled&&isShowingStreams&&setIsShowingStreams(!1)}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},hasErrors?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{color:"danger",size:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.createPackagePolicy.stepConfigure.errorCountText",defaultMessage:"{count, plural, one {# error} other {# errors}}",values:{count:errorCount}}))):null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{iconType:isShowingStreams?"arrowUp":"arrowDown",onClick:()=>setIsShowingStreams(!isShowingStreams),color:hasErrors?"danger":"text","aria-label":isShowingStreams?external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.createPackagePolicy.stepConfigure.hideStreamsAriaLabel",{defaultMessage:"Hide {type} inputs",values:{type:packageInput.type}}):external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.createPackagePolicy.stepConfigure.showStreamsAriaLabel",{defaultMessage:"Show {type} inputs",values:{type:packageInput.type}})}))))),isShowingStreams?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"}):null,isShowingStreams&&packageInput.vars&&packageInput.vars.length?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(PackagePolicyInputConfig,{hasInputStreams:hasInputStreams,packageInputVars:packageInput.vars,packagePolicyInput:packagePolicyInput,updatePackagePolicyInput:updatePackagePolicyInput,inputVarsValidationResults:{vars:inputValidationResults.vars},forceShowErrors:forceShowErrors}),hasInputStreams?external_kbnSharedDeps_React_default.a.createElement(ShortenedHorizontalRule,{margin:"m"}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"})):null,isShowingStreams?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"column"},inputStreams.map(({packageInputStream:packageInputStream,packagePolicyInputStream:packagePolicyInputStream},index)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{key:index},external_kbnSharedDeps_React_default.a.createElement(PackagePolicyInputStreamConfig,{packageInputStream:packageInputStream,packagePolicyInputStream:packagePolicyInputStream,updatePackagePolicyInputStream:updatedStream=>{const indexOfUpdatedStream=packagePolicyInput.streams.findIndex(stream=>stream.data_stream.dataset===packageInputStream.data_stream.dataset),newStreams=[...packagePolicyInput.streams];newStreams[indexOfUpdatedStream]={...newStreams[indexOfUpdatedStream],...updatedStream};const updatedInput={streams:newStreams};!packagePolicyInput.enabled&&updatedStream.enabled?updatedInput.enabled=!0:packagePolicyInput.enabled&&!newStreams.find(stream=>stream.enabled)&&(updatedInput.enabled=!1),updatePackagePolicyInput(updatedInput)},inputStreamValidationResults:inputValidationResults.streams[packagePolicyInputStream.data_stream.dataset],forceShowErrors:forceShowErrors}),index!==inputStreams.length-1?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(ShortenedHorizontalRule,{margin:"none"})):null))):null)}),StepSelectPackage=({agentPolicyId:agentPolicyId,updateAgentPolicy:updateAgentPolicy,packageInfo:packageInfo,updatePackageInfo:updatePackageInfo,setIsLoadingSecondStep:setIsLoadingSecondStep})=>{const[selectedPkgKey,setSelectedPkgKey]=Object(external_kbnSharedDeps_React_.useState)(packageInfo?Object(pkg_key_from_package_info.a)(packageInfo):void 0),[selectedPkgError,setSelectedPkgError]=Object(external_kbnSharedDeps_React_.useState)(),{data:agentPolicyData,error:agentPolicyError,isLoading:isAgentPoliciesLoading}=Object(hooks.V)(agentPolicyId),[packages,setPackages]=Object(external_kbnSharedDeps_React_.useState)([]),{data:packagesData,error:packagesError,isLoading:isPackagesLoading}=Object(hooks.cb)(),{data:limitedPackagesData,isLoading:isLimitedPackagesLoading}=Object(hooks.T)();return Object(external_kbnSharedDeps_React_.useEffect)(()=>{if(null!=packagesData&&packagesData.response&&null!=limitedPackagesData&&limitedPackagesData.response&&null!=agentPolicyData&&agentPolicyData.item){const allPackages=packagesData.response,limitedPackages=limitedPackagesData.response,usedLimitedPackages=agentPolicyData.item.package_policies.map(packagePolicy=>{var _packagePolicy$packag;return(null===(_packagePolicy$packag=packagePolicy.package)||void 0===_packagePolicy$packag?void 0:_packagePolicy$packag.name)||""}).filter(pkgName=>limitedPackages.includes(pkgName));setPackages(allPackages.filter(pkg=>!usedLimitedPackages.includes(pkg.name)))}},[packagesData,limitedPackagesData,agentPolicyData]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{agentPolicyData&&agentPolicyData.item&&updateAgentPolicy(agentPolicyData.item)},[agentPolicyData,updateAgentPolicy]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{packageInfo&&selectedPkgKey===Object(pkg_key_from_package_info.a)(packageInfo)||(async()=>{if(selectedPkgKey){setIsLoadingSecondStep(!0);const{data:data,error:error}=await Object(hooks.t)(selectedPkgKey);error?(setSelectedPkgError(error),updatePackageInfo(void 0)):data&&data.response&&(setSelectedPkgError(void 0),updatePackageInfo(data.response)),setIsLoadingSecondStep(!1)}else setSelectedPkgError(void 0),updatePackageInfo(void 0)})()},[selectedPkgKey,packageInfo,updatePackageInfo,setIsLoadingSecondStep]),agentPolicyError?external_kbnSharedDeps_React_default.a.createElement(error_Error,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.createPackagePolicy.stepSelectPackage.errorLoadingPolicyTitle",defaultMessage:"Error loading agent policy information"}),error:agentPolicyError}):packagesError?external_kbnSharedDeps_React_default.a.createElement(error_Error,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.createPackagePolicy.stepSelectPackage.errorLoadingPackagesTitle",defaultMessage:"Error loading integrations"}),error:packagesError}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"column"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSelectable,{searchable:!0,allowExclusions:!1,singleSelection:!0,isLoading:isPackagesLoading||isLimitedPackagesLoading||isAgentPoliciesLoading,options:packages.map(({title:title,name:name,version:version,icons:icons})=>{const pkgkey=`${name}-${version}`;return{label:title||name,key:pkgkey,prepend:external_kbnSharedDeps_React_default.a.createElement(PackageIcon,{packageName:name,version:version,icons:icons,size:"m"}),checked:selectedPkgKey===pkgkey?"on":void 0}}),listProps:{bordered:!0},searchProps:{placeholder:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.createPackagePolicy.stepSelectPackage.filterPackagesInputPlaceholder",{defaultMessage:"Search for integrations"})},height:240,onChange:options=>{const selectedOption=options.find(option=>"on"===option.checked);selectedOption?selectedOption.key!==selectedPkgKey&&setSelectedPkgKey(selectedOption.key):setSelectedPkgKey(void 0)}},(list,search)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,search,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),list))),selectedPkgError?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(error_Error,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.createPackagePolicy.stepSelectPackage.errorLoadingSelectedPackageTitle",defaultMessage:"Error loading selected integration"}),error:selectedPkgError})):null)};function create_agent_policy_extends(){return(create_agent_policy_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const FlyoutWithHigherZIndex=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlyout).withConfig({displayName:"FlyoutWithHigherZIndex",componentId:"sc-4bxzaq-0"})(["z-index:",";"],props=>props.theme.eui.euiZLevel5),CreateAgentPolicyFlyout=({onClose:onClose,...restOfProps})=>{const{notifications:notifications}=Object(hooks.nb)(),hasWriteCapabilites=Object(hooks.K)().write,[agentPolicy,setAgentPolicy]=Object(external_kbnSharedDeps_React_.useState)({name:"",description:"",namespace:"default",is_default:void 0,monitoring_enabled:Object.values(common.dataTypes)}),[isLoading,setIsLoading]=Object(external_kbnSharedDeps_React_.useState)(!1),[withSysMonitoring,setWithSysMonitoring]=Object(external_kbnSharedDeps_React_.useState)(!0),validation=agentPolicyFormValidation(agentPolicy),header=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyoutHeader,{hasBorder:!0,"aria-labelledby":"CreateAgentPolicyFlyoutTitle"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"m"},external_kbnSharedDeps_React_default.a.createElement("h2",{id:"CreateAgentPolicyFlyoutTitle"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.createAgentPolicy.flyoutTitle",defaultMessage:"Create agent policy"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"s"},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.createAgentPolicy.flyoutTitleDescription",defaultMessage:"Agent policies are used to manage settings across a group of agents. You can add integrations to your agent policy to specify what data your agents collect. When you edit an agent policy, you can use Fleet to deploy updates to a specified group of agents."})))),body=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyoutBody,null,external_kbnSharedDeps_React_default.a.createElement(AgentPolicyForm,{agentPolicy:agentPolicy,updateAgentPolicy:updatedFields=>{setAgentPolicy({...agentPolicy,...updatedFields})},withSysMonitoring:withSysMonitoring,updateSysMonitoring:newValue=>setWithSysMonitoring(newValue),validation:validation})),footer=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyoutFooter,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{onClick:()=>onClose(),flush:"left"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.createAgentPolicy.cancelButtonLabel",defaultMessage:"Cancel"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{fill:!0,isLoading:isLoading,isDisabled:!hasWriteCapabilites||isLoading||Object.keys(validation).length>0,onClick:async()=>{setIsLoading(!0);try{const{data:data,error:error}=await(async()=>await Object(hooks.f)(agentPolicy,{withSysMonitoring:withSysMonitoring}))();setIsLoading(!1),data?(notifications.toasts.addSuccess(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.createAgentPolicy.successNotificationTitle",{defaultMessage:"Agent policy '{name}' created",values:{name:agentPolicy.name}})),onClose(data.item)):notifications.toasts.addDanger(error?error.message:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.createAgentPolicy.errorNotificationTitle",{defaultMessage:"Unable to create agent policy"}))}catch(e){setIsLoading(!1),notifications.toasts.addDanger(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.createAgentPolicy.errorNotificationTitle",{defaultMessage:"Unable to create agent policy"}))}}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.createAgentPolicy.submitButtonLabel",defaultMessage:"Create agent policy"})))));return external_kbnSharedDeps_React_default.a.createElement(FlyoutWithHigherZIndex,create_agent_policy_extends({onClose:()=>onClose(),size:"l",maxWidth:400},restOfProps),header,body,footer)},AgentPolicyWrapper=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFormRow).withConfig({displayName:"AgentPolicyWrapper",componentId:"sc-1qoukpq-0"})([".euiFormRow__label{width:100%;}"]),AgentPolicyNameColumn=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexItem).withConfig({displayName:"AgentPolicyNameColumn",componentId:"sc-1qoukpq-1"})(["max-width:",";overflow:hidden;"],props=>props.grow/9*100+"%"),AgentPolicyDescriptionColumn=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexItem).withConfig({displayName:"AgentPolicyDescriptionColumn",componentId:"sc-1qoukpq-2"})(["max-width:",";overflow:hidden;"],props=>props.grow/9*100+"%"),StepSelectAgentPolicy=({pkgkey:pkgkey,updatePackageInfo:updatePackageInfo,agentPolicy:agentPolicy,updateAgentPolicy:updateAgentPolicy,setIsLoadingSecondStep:setIsLoadingSecondStep})=>{var _agentPoliciesById$se,_agentPoliciesById$se2;const{isReady:isFleetReady}=Object(hooks.N)(),[selectedPolicyId,setSelectedPolicyId]=Object(external_kbnSharedDeps_React_.useState)(agentPolicy?agentPolicy.id:void 0),[selectedAgentPolicyError,setSelectedAgentPolicyError]=Object(external_kbnSharedDeps_React_.useState)(),hasWriteCapabilites=Object(hooks.K)().write,[isCreateAgentPolicyFlyoutOpen,setIsCreateAgentPolicyFlyoutOpen]=Object(external_kbnSharedDeps_React_.useState)(!1),{data:packageInfoData,error:packageInfoError,isLoading:isPackageInfoLoading}=Object(hooks.Z)(pkgkey),isLimitedPackage=packageInfoData&&Object(services.m)(packageInfoData.response)||!1,{data:agentPoliciesData,error:agentPoliciesError,isLoading:isAgentPoliciesLoading,resendRequest:refreshAgentPolicies}=Object(hooks.O)({page:1,perPage:1e3,sortField:"name",sortOrder:"asc",full:!0}),agentPolicies=Object(external_kbnSharedDeps_React_.useMemo)(()=>(null==agentPoliciesData?void 0:agentPoliciesData.items.filter(policy=>!policy.is_managed))||[],[null==agentPoliciesData?void 0:agentPoliciesData.items]),agentPoliciesById=Object(external_kbnSharedDeps_React_.useMemo)(()=>agentPolicies.reduce((acc,policy)=>(acc[policy.id]=policy,acc),{}),[agentPolicies]);Object(external_kbnSharedDeps_React_.useEffect)(()=>{packageInfoData&&packageInfoData.response&&updatePackageInfo(packageInfoData.response)},[packageInfoData,updatePackageInfo]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{agentPolicy&&selectedPolicyId===agentPolicy.id||(async()=>{if(selectedPolicyId){setIsLoadingSecondStep(!0);const{data:data,error:error}=await Object(hooks.p)(selectedPolicyId);error?(setSelectedAgentPolicyError(error),updateAgentPolicy(void 0)):data&&data.item&&(setSelectedAgentPolicyError(void 0),updateAgentPolicy(data.item))}else setSelectedAgentPolicyError(void 0),updateAgentPolicy(void 0);setIsLoadingSecondStep(!1)})()},[selectedPolicyId,agentPolicy,updateAgentPolicy,setIsLoadingSecondStep]);const agentPolicyOptions=Object(external_kbnSharedDeps_React_.useMemo)(()=>packageInfoData?agentPolicies.map(agentConf=>{const alreadyHasLimitedPackage=isLimitedPackage&&Object(services.f)(agentConf,packageInfoData.response.name)||!1;return{label:agentConf.name,value:agentConf.id,disabled:alreadyHasLimitedPackage,"data-test-subj":"agentPolicyItem"}}):[],[agentPolicies,isLimitedPackage,packageInfoData]),selectedAgentPolicyOption=agentPolicyOptions.find(option=>option.value===selectedPolicyId);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{if(!selectedPolicyId&&agentPolicies.length&&agentPolicyOptions.length){const defaultAgentPolicy=agentPolicies.find(policy=>policy.is_default);if(defaultAgentPolicy){const defaultAgentPolicyOption=agentPolicyOptions.find(option=>option.value===defaultAgentPolicy.id);defaultAgentPolicyOption&&!defaultAgentPolicyOption.disabled&&setSelectedPolicyId(defaultAgentPolicy.id)}}},[agentPolicies,agentPolicyOptions,selectedPolicyId]),packageInfoError?external_kbnSharedDeps_React_default.a.createElement(error_Error,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.createPackagePolicy.StepSelectPolicy.errorLoadingPackageTitle",defaultMessage:"Error loading package information"}),error:packageInfoError}):agentPoliciesError?external_kbnSharedDeps_React_default.a.createElement(error_Error,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.createPackagePolicy.StepSelectPolicy.errorLoadingAgentPoliciesTitle",defaultMessage:"Error loading agent policies"}),error:agentPoliciesError}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,isCreateAgentPolicyFlyoutOpen?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPortal,null,external_kbnSharedDeps_React_default.a.createElement(CreateAgentPolicyFlyout,{onClose:newAgentPolicy=>{setIsCreateAgentPolicyFlyoutOpen(!1),newAgentPolicy&&(refreshAgentPolicies(),setSelectedPolicyId(newAgentPolicy.id))},ownFocus:!0})):null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"column",gutterSize:"m"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(AgentPolicyWrapper,{fullWidth:!0,label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.createPackagePolicy.StepSelectPolicy.agentPolicyLabel",defaultMessage:"Agent policy"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{disabled:!hasWriteCapabilites,onClick:()=>setIsCreateAgentPolicyFlyoutOpen(!0)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.createPackagePolicy.StepSelectPolicy.addButton",defaultMessage:"Create agent policy"}))))),helpText:isFleetReady&&selectedPolicyId?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.createPackagePolicy.StepSelectPolicy.agentPolicyAgentsDescriptionText",defaultMessage:"{count, plural, one {# agent} other {# agents}} are enrolled with the selected agent policy.",values:{count:null!==(_agentPoliciesById$se=null===(_agentPoliciesById$se2=agentPoliciesById[selectedPolicyId])||void 0===_agentPoliciesById$se2?void 0:_agentPoliciesById$se2.agents)&&void 0!==_agentPoliciesById$se?_agentPoliciesById$se:0}}):null},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiComboBox,{placeholder:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.createPackagePolicy.StepSelectPolicy.agentPolicyPlaceholderText",{defaultMessage:"Select an agent policy to add this integration to"}),singleSelection:{asPlainText:!0},isClearable:!1,fullWidth:!0,isLoading:isAgentPoliciesLoading||isPackageInfoLoading,options:agentPolicyOptions,renderOption:option=>{var _agentPoliciesById$ag,_agentPoliciesById;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(AgentPolicyNameColumn,{grow:2},external_kbnSharedDeps_React_default.a.createElement("span",{className:"eui-textTruncate"},option.label)),external_kbnSharedDeps_React_default.a.createElement(AgentPolicyDescriptionColumn,{grow:isFleetReady?5:7},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTextColor,{className:"eui-textTruncate",color:"subdued"},agentPoliciesById[option.value].description)),isFleetReady?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:2,className:"eui-textRight"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTextColor,{color:"subdued"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.createPackagePolicy.StepSelectPolicy.agentPolicyAgentsCountText",defaultMessage:"{count, plural, one {# agent} other {# agents}} enrolled",values:{count:null!==(_agentPoliciesById$ag=null===(_agentPoliciesById=agentPoliciesById[option.value])||void 0===_agentPoliciesById?void 0:_agentPoliciesById.agents)&&void 0!==_agentPoliciesById$ag?_agentPoliciesById$ag:0}}))):null)},selectedOptions:selectedAgentPolicyOption?[selectedAgentPolicyOption]:[],onChange:options=>{const selectedOption=options[0]||void 0;selectedOption?selectedOption.value!==selectedPolicyId&&setSelectedPolicyId(selectedOption.value):setSelectedPolicyId(void 0)}}))),selectedAgentPolicyError?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(error_Error,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.createPackagePolicy.StepSelectPolicy.errorLoadingSelectedAgentPolicyTitle",defaultMessage:"Error loading selected agent policy"}),error:selectedAgentPolicyError})):null))},StepConfigurePackagePolicy=({from:from="policy",packageInfo:packageInfo,packagePolicy:packagePolicy,packagePolicyId:packagePolicyId,updatePackagePolicy:updatePackagePolicy,validationResults:validationResults,submitAttempted:submitAttempted})=>validationResults?packageInfo.policy_templates&&packageInfo.policy_templates[0]&&packageInfo.policy_templates[0].inputs&&packageInfo.policy_templates[0].inputs.length?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHorizontalRule,{margin:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"column",gutterSize:"none"},packageInfo.policy_templates[0].inputs.map(packageInput=>{const packagePolicyInput=packagePolicy.inputs.find(input=>input.type===packageInput.type),packageInputStreams=((inputType,packageInfo)=>{const streams=[];return(packageInfo.data_streams||[]).forEach(dataStream=>{(dataStream.streams||[]).forEach(stream=>{stream.input===inputType&&streams.push({...stream,data_stream:{dataset:dataStream.dataset}})})}),streams})(packageInput.type,packageInfo);return packagePolicyInput?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{key:packageInput.type},external_kbnSharedDeps_React_default.a.createElement(PackagePolicyInputPanel,{packageInput:packageInput,packageInputStreams:packageInputStreams,packagePolicyInput:packagePolicyInput,updatePackagePolicyInput:updatedInput=>{const indexOfUpdatedInput=packagePolicy.inputs.findIndex(input=>input.type===packageInput.type),newInputs=[...packagePolicy.inputs];newInputs[indexOfUpdatedInput]={...newInputs[indexOfUpdatedInput],...updatedInput},updatePackagePolicy({inputs:newInputs})},inputValidationResults:validationResults.inputs[packagePolicyInput.type],forceShowErrors:submitAttempted}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHorizontalRule,{margin:"m"})):null}))):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiEmptyPrompt,{iconType:"checkInCircleFilled",iconColor:"secondary",body:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.createPackagePolicy.stepConfigure.noPolicyOptionsMessage",defaultMessage:"Nothing to configure"})))}):external_kbnSharedDeps_React_default.a.createElement(Loading,null),StepDefinePackagePolicy=({agentPolicy:agentPolicy,packageInfo:packageInfo,packagePolicy:packagePolicy,updatePackagePolicy:updatePackagePolicy,validationResults:validationResults})=>{const[isShowingAdvanced,setIsShowingAdvanced]=Object(external_kbnSharedDeps_React_.useState)(!1);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{const pkg=packagePolicy.package;if((pkg?Object(pkg_key_from_package_info.a)(pkg):"")!==Object(pkg_key_from_package_info.a)(packageInfo)){const pkgPoliciesNamePattern=new RegExp(packageInfo.name+"-(\\d+)"),pkgPoliciesWithMatchingNames=agentPolicy.package_policies.filter(ds=>Boolean(ds.name.match(pkgPoliciesNamePattern))).map(ds=>parseInt(ds.name.match(pkgPoliciesNamePattern)[1],10)).sort((a,b)=>a-b);updatePackagePolicy({name:`${packageInfo.name}-${pkgPoliciesWithMatchingNames.length?pkgPoliciesWithMatchingNames[pkgPoliciesWithMatchingNames.length-1]+1:1}`,package:{name:packageInfo.name,title:packageInfo.title,version:packageInfo.version},inputs:Object(services.q)(packageInfo)})}packagePolicy.policy_id!==agentPolicy.id&&updatePackagePolicy({policy_id:agentPolicy.id,namespace:agentPolicy.namespace})},[packagePolicy.package,packagePolicy.policy_id,agentPolicy,packageInfo,updatePackagePolicy]),validationResults?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescribedFormGroup,{title:external_kbnSharedDeps_React_default.a.createElement("h4",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.createPackagePolicy.stepConfigure.integrationSettingsSectionTitle",defaultMessage:"Integration settings"})),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.createPackagePolicy.stepConfigure.integrationSettingsSectionDescription",defaultMessage:"Choose a name and description to help identify how this integration will be used."})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{isInvalid:!!validationResults.name,error:validationResults.name,label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.createPackagePolicy.stepConfigure.packagePolicyNameInputLabel",defaultMessage:"Integration name"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldText,{value:packagePolicy.name,onChange:e=>updatePackagePolicy({name:e.target.value}),"data-test-subj":"packagePolicyNameInput"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.createPackagePolicy.stepConfigure.packagePolicyDescriptionInputLabel",defaultMessage:"Description"}),labelAppend:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs",color:"subdued"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.createPackagePolicy.stepConfigure.inputVarFieldOptionalLabel",defaultMessage:"Optional"})),isInvalid:!!validationResults.description,error:validationResults.description},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldText,{value:packagePolicy.description,onChange:e=>updatePackagePolicy({description:e.target.value}),"data-test-subj":"packagePolicyDescriptionInput"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{size:"xs",iconType:isShowingAdvanced?"arrowDown":"arrowRight",onClick:()=>setIsShowingAdvanced(!isShowingAdvanced),flush:"left"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.createPackagePolicy.stepConfigure.advancedOptionsToggleLinkText",defaultMessage:"Advanced options"}))),!isShowingAdvanced&&validationResults.namespace?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{color:"danger",size:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.createPackagePolicy.stepConfigure.errorCountText",defaultMessage:"{count, plural, one {# error} other {# errors}}",values:{count:1}}))):null),isShowingAdvanced?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{isInvalid:!!validationResults.namespace,error:validationResults.namespace,label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.createPackagePolicy.stepConfigure.packagePolicyNamespaceInputLabel",defaultMessage:"Namespace"}),helpText:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.createPackagePolicy.stepConfigure.packagePolicyNamespaceHelpLabel",defaultMessage:"Change the default namespace inherited from the selected Agent policy. This setting changes the name of the integration's data stream. {learnMore}.",values:{learnMore:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{href:"https://www.elastic.co/guide/en/fleet/current/data-streams.html#data-streams-naming-scheme",target:"_blank"},external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.createPackagePolicy.stepConfigure.packagePolicyNamespaceHelpLearnMoreLabel",{defaultMessage:"Learn more"}))}})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiComboBox,{noSuggestions:!0,singleSelection:!0,selectedOptions:packagePolicy.namespace?[{label:packagePolicy.namespace}]:[],onCreateOption:newNamespace=>{updatePackagePolicy({namespace:newNamespace})},onChange:newNamespaces=>{updatePackagePolicy({namespace:newNamespaces.length?newNamespaces[0].label:""})}}))):null)):external_kbnSharedDeps_React_default.a.createElement(Loading,null)};function create_package_policy_page_extends(){return(create_package_policy_page_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const StepsWithLessPadding=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiSteps).withConfig({displayName:"StepsWithLessPadding",componentId:"sc-1smjujo-0"})([".euiStep__content{padding-bottom:",";}"],props=>props.theme.eui.paddingSizes.m),CreatePackagePolicyPage=()=>{var _packagePolicy$packag,_packagePolicy$packag2;const{notifications:notifications}=Object(hooks.nb)(),{agents:{enabled:isFleetEnabled}}=Object(hooks.M)(),{params:{policyId:policyId,pkgkey:pkgkey}}=Object(external_kbnSharedDeps_ReactRouterDom_.useRouteMatch)(),{getHref:getHref,getPath:getPath}=Object(hooks.ib)(),history=Object(external_kbnSharedDeps_ReactRouterDom_.useHistory)(),handleNavigateTo=useNavigateToCallback(),routeState=useIntraAppState(),from=policyId?"policy":"package",[agentPolicy,setAgentPolicy]=Object(external_kbnSharedDeps_React_.useState)(),[packageInfo,setPackageInfo]=Object(external_kbnSharedDeps_React_.useState)(),[isLoadingSecondStep,setIsLoadingSecondStep]=Object(external_kbnSharedDeps_React_.useState)(!1),agentPolicyId=null==agentPolicy?void 0:agentPolicy.id;Object(external_kbnSharedDeps_React_.useEffect)(()=>{isFleetEnabled&&agentPolicyId&&(async()=>{const{data:data}=await Object(hooks.l)({policyId:agentPolicyId});void 0!==(null==data?void 0:data.results.total)&&setAgentCount(data.results.total)})()},[agentPolicyId,isFleetEnabled]);const[agentCount,setAgentCount]=Object(external_kbnSharedDeps_React_.useState)(0),[packagePolicy,setPackagePolicy]=Object(external_kbnSharedDeps_React_.useState)({name:"",description:"",namespace:"",policy_id:"",enabled:!0,output_id:"",inputs:[]}),[validationResults,setValidationResults]=Object(external_kbnSharedDeps_React_.useState)(),[formState,setFormState]=Object(external_kbnSharedDeps_React_.useState)("INVALID"),updatePackageInfo=Object(external_kbnSharedDeps_React_.useCallback)(updatedPackageInfo=>{updatedPackageInfo?(setPackageInfo(updatedPackageInfo),agentPolicy&&setFormState("VALID")):(setFormState("INVALID"),setPackageInfo(void 0)),console.debug("Package info updated",updatedPackageInfo)},[agentPolicy,setPackageInfo,setFormState]),updateAgentPolicy=Object(external_kbnSharedDeps_React_.useCallback)(updatedAgentPolicy=>{updatedAgentPolicy?(setAgentPolicy(updatedAgentPolicy),packageInfo&&setFormState("VALID")):(setFormState("INVALID"),setAgentPolicy(void 0)),console.debug("Agent policy updated",updatedAgentPolicy)},[packageInfo,setAgentPolicy,setFormState]),hasErrors=!!validationResults&&validationHasErrors(validationResults),updatePackagePolicyValidation=Object(external_kbnSharedDeps_React_.useCallback)(newPackagePolicy=>{if(packageInfo){const newValidationResult=validatePackagePolicy(newPackagePolicy||packagePolicy,packageInfo);return setValidationResults(newValidationResult),console.debug("Package policy validation results",newValidationResult),newValidationResult}},[packagePolicy,packageInfo]),updatePackagePolicy=Object(external_kbnSharedDeps_React_.useCallback)(updatedFields=>{const newPackagePolicy={...packagePolicy,...updatedFields};setPackagePolicy(newPackagePolicy),console.debug("Package policy updated",newPackagePolicy);const newValidationResults=updatePackagePolicyValidation(newPackagePolicy),hasPackage=newPackagePolicy.package,hasValidationErrors=!!newValidationResults&&validationHasErrors(newValidationResults),hasAgentPolicy=newPackagePolicy.policy_id&&""!==newPackagePolicy.policy_id;hasPackage&&hasAgentPolicy&&!hasValidationErrors&&setFormState("VALID")},[packagePolicy,updatePackagePolicyValidation]),handleExtensionViewOnChange=Object(external_kbnSharedDeps_React_.useCallback)(({isValid:isValid,updatedPolicy:updatedPolicy})=>{updatePackagePolicy(updatedPolicy),setFormState(prevState=>"VALID"!==prevState||isValid?prevState:"INVALID")},[updatePackagePolicy]),cancelUrl=Object(external_kbnSharedDeps_React_.useMemo)(()=>routeState&&routeState.onCancelUrl?routeState.onCancelUrl:"policy"===from?getHref("policy_details",{policyId:agentPolicyId||policyId}):getHref("integration_details_overview",{pkgkey:pkgkey}),[agentPolicyId,policyId,from,getHref,pkgkey,routeState]),cancelClickHandler=Object(external_kbnSharedDeps_React_.useCallback)(ev=>{routeState&&routeState.onCancelNavigateTo&&(ev.preventDefault(),handleNavigateTo(routeState.onCancelNavigateTo))},[routeState,handleNavigateTo]),onSubmit=async()=>{if("VALID"===formState&&hasErrors)return void setFormState("INVALID");if(0!==agentCount&&"CONFIRM"!==formState)return void setFormState("CONFIRM");const{error:error,data:data}=await(async()=>{setFormState("LOADING");const result=await Object(hooks.g)(packagePolicy);return setFormState("SUBMITTED"),result})();error?(notifications.toasts.addError(error,{title:"Error"}),setFormState("VALID")):(routeState&&routeState.onSaveNavigateTo?handleNavigateTo("function"==typeof routeState.onSaveNavigateTo?routeState.onSaveNavigateTo(data.item):routeState.onSaveNavigateTo):history.push(getPath("policy_details",{policyId:(null==agentPolicy?void 0:agentPolicy.id)||policyId})),notifications.toasts.addSuccess({title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.createPackagePolicy.addedNotificationTitle",{defaultMessage:"'{packagePolicyName}' integration added.",values:{packagePolicyName:packagePolicy.name}}),text:agentCount&&agentPolicy?external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.createPackagePolicy.addedNotificationMessage",{defaultMessage:"Fleet will deploy updates to all agents that use the '{agentPolicyName}' policy.",values:{agentPolicyName:agentPolicy.name}}):void 0,"data-test-subj":"packagePolicyCreateSuccessToast"}))},layoutProps={from:from,cancelUrl:cancelUrl,onCancel:cancelClickHandler,agentPolicy:agentPolicy,packageInfo:packageInfo},stepSelectAgentPolicy=Object(external_kbnSharedDeps_React_.useMemo)(()=>external_kbnSharedDeps_React_default.a.createElement(StepSelectAgentPolicy,{pkgkey:pkgkey,updatePackageInfo:updatePackageInfo,agentPolicy:agentPolicy,updateAgentPolicy:updateAgentPolicy,setIsLoadingSecondStep:setIsLoadingSecondStep}),[pkgkey,updatePackageInfo,agentPolicy,updateAgentPolicy]),ExtensionView=useUIExtension(null!==(_packagePolicy$packag=null===(_packagePolicy$packag2=packagePolicy.package)||void 0===_packagePolicy$packag2?void 0:_packagePolicy$packag2.name)&&void 0!==_packagePolicy$packag?_packagePolicy$packag:"","package-policy-create"),stepSelectPackage=Object(external_kbnSharedDeps_React_.useMemo)(()=>external_kbnSharedDeps_React_default.a.createElement(StepSelectPackage,{agentPolicyId:policyId,updateAgentPolicy:updateAgentPolicy,packageInfo:packageInfo,updatePackageInfo:updatePackageInfo,setIsLoadingSecondStep:setIsLoadingSecondStep}),[policyId,updateAgentPolicy,packageInfo,updatePackageInfo]),stepConfigurePackagePolicy=Object(external_kbnSharedDeps_React_.useMemo)(()=>{var _packagePolicy$packag3;return isLoadingSecondStep?external_kbnSharedDeps_React_default.a.createElement(Loading,null):agentPolicy&&packageInfo?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(StepDefinePackagePolicy,{agentPolicy:agentPolicy,packageInfo:packageInfo,packagePolicy:packagePolicy,updatePackagePolicy:updatePackagePolicy,validationResults:validationResults}),!ExtensionView&&external_kbnSharedDeps_React_default.a.createElement(StepConfigurePackagePolicy,{packageInfo:packageInfo,packagePolicy:packagePolicy,updatePackagePolicy:updatePackagePolicy,validationResults:validationResults,submitAttempted:"INVALID"===formState}),ExtensionView&&packagePolicy.policy_id&&(null===(_packagePolicy$packag3=packagePolicy.package)||void 0===_packagePolicy$packag3?void 0:_packagePolicy$packag3.name)&&external_kbnSharedDeps_React_default.a.createElement(ExtensionWrapper,null,external_kbnSharedDeps_React_default.a.createElement(ExtensionView,{newPolicy:packagePolicy,onChange:handleExtensionViewOnChange}))):external_kbnSharedDeps_React_default.a.createElement("div",null)},[isLoadingSecondStep,agentPolicy,packageInfo,packagePolicy,updatePackagePolicy,validationResults,formState,ExtensionView,handleExtensionViewOnChange]),steps=["package"===from?{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.createPackagePolicy.stepSelectAgentPolicyTitle",{defaultMessage:"Select an agent policy"}),children:stepSelectAgentPolicy}:{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.createPackagePolicy.stepSelectPackageTitle",{defaultMessage:"Select an integration"}),children:stepSelectPackage},{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.createPackagePolicy.stepConfigurePackagePolicyTitle",{defaultMessage:"Configure integration"}),status:packageInfo&&agentPolicy&&!isLoadingSecondStep?void 0:"disabled","data-test-subj":"dataCollectionSetupStep",children:stepConfigurePackagePolicy}];return external_kbnSharedDeps_React_default.a.createElement(CreatePackagePolicyPageLayout,create_package_policy_page_extends({},layoutProps,{"data-test-subj":"createPackagePolicy"}),"CONFIRM"===formState&&agentPolicy&&external_kbnSharedDeps_React_default.a.createElement(ConfirmDeployAgentPolicyModal,{agentCount:agentCount,agentPolicy:agentPolicy,onConfirm:onSubmit,onCancel:()=>setFormState("VALID")}),"package"===from?packageInfo&&external_kbnSharedDeps_React_default.a.createElement(IntegrationBreadcrumb,{pkgTitle:packageInfo.title,pkgkey:Object(pkg_key_from_package_info.a)(packageInfo)}):agentPolicy&&external_kbnSharedDeps_React_default.a.createElement(PolicyBreadcrumb,{policyName:agentPolicy.name,policyId:agentPolicy.id}),external_kbnSharedDeps_React_default.a.createElement(StepsWithLessPadding,{steps:steps}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBottomBar,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},!isLoadingSecondStep&&agentPolicy&&packageInfo&&"INVALID"===formState?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.createPackagePolicy.errorOnSaveText",defaultMessage:"Your integration policy has errors. Please fix them before saving."}):null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s",justifyContent:"flexEnd"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{color:"ghost",href:cancelUrl,onClick:cancelClickHandler,"data-test-subj":"createPackagePolicyCancelButton"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.createPackagePolicy.cancelButton",defaultMessage:"Cancel"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{onClick:onSubmit,isLoading:"LOADING"===formState,disabled:"VALID"!==formState,iconType:"save",color:"primary",fill:!0,"data-test-subj":"createPackagePolicySaveButton"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.createPackagePolicy.saveButton",defaultMessage:"Save integration"}))))))))},PolicyBreadcrumb=({policyName:policyName,policyId:policyId})=>(Object(hooks.J)("add_integration_from_policy",{policyName:policyName,policyId:policyId}),null),IntegrationBreadcrumb=({pkgTitle:pkgTitle,pkgkey:pkgkey})=>(Object(hooks.J)("add_integration_to_policy",{pkgTitle:pkgTitle,pkgkey:pkgkey}),null),useNavigateToCallback=()=>{const history=Object(external_kbnSharedDeps_ReactRouterDom_.useHistory)(),{application:{navigateToApp:navigateToApp}}=Object(hooks.nb)();return Object(external_kbnSharedDeps_React_.useCallback)(navigateToProps=>{if(navigateToProps[0]===common_constants.Z){const{path:path="",state:state}=navigateToProps[1]||{};history.push({pathname:"#"===path.charAt(0)?path.substr(1):path,state:state})}return navigateToApp(...navigateToProps)},[history,navigateToApp])},RELEASE_BADGE_LABEL={beta:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.epm.releaseBadge.betaLabel",{defaultMessage:"Beta"}),experimental:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.epm.releaseBadge.experimentalLabel",{defaultMessage:"Experimental"})},RELEASE_BADGE_DESCRIPTION={beta:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.epm.releaseBadge.betaDescription",{defaultMessage:"This integration is not recommended for use in production environments."}),experimental:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.epm.releaseBadge.experimentalDescription",{defaultMessage:"This integration may have breaking changes or be removed in a future release."})},Card=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiCard).withConfig({displayName:"Card",componentId:"c0wp03-0"})(["color:inherit;"]);function PackageCard({description:description,name:name,title:title,version:version,release:release,status:status,icons:icons,...restProps}){const{getHref:getHref}=Object(hooks.ib)();let urlVersion=version;return"savedObject"in restProps&&(urlVersion=restProps.savedObject.attributes.version||version),external_kbnSharedDeps_React_default.a.createElement(Card,{title:title||"",description:description,icon:external_kbnSharedDeps_React_default.a.createElement(PackageIcon,{icons:icons,packageName:name,version:version,size:"xl"}),href:getHref("integration_details_overview",{pkgkey:`${name}-${urlVersion}`}),betaBadgeLabel:release&&"ga"!==release?RELEASE_BADGE_LABEL[release]:void 0,betaBadgeTooltipContent:release&&"ga"!==release?RELEASE_BADGE_DESCRIPTION[release]:void 0})}function PackageListGrid({isLoading:isLoading,controls:controls,title:title,list:list}){const initialQuery=external_kbnSharedDeps_ElasticEui_.EuiSearchBar.Query.MATCH_ALL,[query,setQuery]=Object(external_kbnSharedDeps_React_.useState)(initialQuery),[searchTerm,setSearchTerm]=Object(external_kbnSharedDeps_React_.useState)(""),localSearchRef=Object(epm_hooks.f)(list),controlsContent=external_kbnSharedDeps_React_default.a.createElement(ControlsColumn,{title:title,controls:controls});let gridContent;if(isLoading||!localSearchRef.current)gridContent=external_kbnSharedDeps_React_default.a.createElement(Loading,null);else{const filteredList=searchTerm?list.filter(item=>localSearchRef.current.search(searchTerm).map(match=>match[epm_hooks.b]).includes(item[epm_hooks.b])):list;gridContent=external_kbnSharedDeps_React_default.a.createElement(GridColumn,{list:filteredList})}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"flexStart"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:1},controlsContent),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:3},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSearchBar,{query:query||void 0,box:{placeholder:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.epmList.searchPackagesPlaceholder",{defaultMessage:"Search for integrations"}),incremental:!0},onChange:({query:query,queryText:userInput,error:error})=>{error||(setQuery(query),setSearchTerm(userInput))}}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),gridContent))}function ControlsColumn({controls:controls,title:title}){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"s"},external_kbnSharedDeps_React_default.a.createElement("h2",null,title)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:4},controls),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:1})))}function GridColumn({list:list}){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGrid,{gutterSize:"l",columns:3},list.length?list.map(item=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{key:Object(pkg_key_from_package_info.a)(item)},external_kbnSharedDeps_React_default.a.createElement(PackageCard,item))):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.epmList.noPackagesFoundPlaceholder",defaultMessage:"No packages found"})))))}function CategoryFacets({isLoading:isLoading,categories:categories,selectedCategory:selectedCategory,onCategoryChange:onCategoryChange}){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFacetGroup,null,isLoading?external_kbnSharedDeps_React_default.a.createElement(Loading,null):categories.map(category=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFacetButton,{isSelected:category.id===selectedCategory,key:category.id,id:category.id,quantity:category.count,onClick:()=>onCategoryChange(category)},category.title)))}const HeroCopy=Object(external_kbnSharedDeps_React_.memo)(()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"column",gutterSize:"s",justifyContent:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement("h1",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.epm.pageTitle",defaultMessage:"Integrations"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{color:"subdued"},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.epm.pageSubtitle",defaultMessage:"Browse integrations for popular apps and services."})))))),Illustration=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiImage).withConfig({displayName:"Illustration",componentId:"jzfja-0"})(["margin-bottom:-68px;width:80%;"]),HeroImage=Object(external_kbnSharedDeps_React_.memo)(()=>{const{toAssets:toAssets}=Object(epm_hooks.e)(),{uiSettings:uiSettings}=Object(hooks.nb)(),IS_DARK_THEME=uiSettings.get("theme:darkMode");return external_kbnSharedDeps_React_default.a.createElement(Illustration,{alt:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.epm.illustrationAltText",{defaultMessage:"Illustration of an integration"}),url:toAssets(IS_DARK_THEME?"illustration_integrations_darkmode.svg":"illustration_integrations_lightmode.svg")})});function EPMHomePage(){const{params:{tabId:tabId}}=Object(external_kbnSharedDeps_ReactRouterDom_.useRouteMatch)(),{getHref:getHref}=Object(hooks.ib)();return external_kbnSharedDeps_React_default.a.createElement(WithHeaderLayout,{leftColumn:external_kbnSharedDeps_React_default.a.createElement(HeroCopy,null),rightColumn:external_kbnSharedDeps_React_default.a.createElement(HeroImage,null),tabs:[{id:"all_packages",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.epmList.allTabText",{defaultMessage:"All integrations"}),href:getHref("integrations_all"),isSelected:"installed"!==tabId},{id:"installed_packages",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.epmList.installedTabText",{defaultMessage:"Installed integrations"}),href:getHref("integrations_installed"),isSelected:"installed"===tabId}]},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Switch,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:constants.j.integrations_installed},external_kbnSharedDeps_React_default.a.createElement(InstalledPackages,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:constants.j.integrations_all},external_kbnSharedDeps_React_default.a.createElement(AvailablePackages,null))))}function InstalledPackages(){Object(hooks.J)("integrations_installed");const{data:allPackages,isLoading:isLoadingPackages}=Object(hooks.cb)({experimental:!0}),[selectedCategory,setSelectedCategory]=Object(external_kbnSharedDeps_React_.useState)(""),title=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.epmList.installedTitle",{defaultMessage:"Installed integrations"}),allInstalledPackages=allPackages&&allPackages.response?allPackages.response.filter(pkg=>pkg.status===common_constants.lb.Installed):[],updatablePackages=allInstalledPackages.filter(item=>"savedObject"in item&&item.version>item.savedObject.attributes.version),categories=[{id:"",title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.epmList.allFilterLinkText",{defaultMessage:"All"}),count:allInstalledPackages.length},{id:"updates_available",title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.epmList.updatesAvailableFilterLinkText",{defaultMessage:"Updates available"}),count:updatablePackages.length}],controls=external_kbnSharedDeps_React_default.a.createElement(CategoryFacets,{categories:categories,selectedCategory:selectedCategory,onCategoryChange:({id:id})=>setSelectedCategory(id)});return external_kbnSharedDeps_React_default.a.createElement(PackageListGrid,{isLoading:isLoadingPackages,controls:controls,title:title,list:"updates_available"===selectedCategory?updatablePackages:allInstalledPackages})}function AvailablePackages(){var _allPackagesRes$respo;Object(hooks.J)("integrations_all");const history=Object(external_kbnSharedDeps_ReactRouterDom_.useHistory)(),queryParams=new URLSearchParams(Object(external_kbnSharedDeps_ReactRouterDom_.useLocation)().search),initialCategory=queryParams.get("category")||"",[selectedCategory,setSelectedCategory]=Object(external_kbnSharedDeps_React_.useState)(initialCategory),{data:allPackagesRes,isLoading:isLoadingAllPackages}=Object(hooks.cb)(),{data:categoryPackagesRes,isLoading:isLoadingCategoryPackages}=Object(hooks.cb)({category:selectedCategory}),{data:categoriesRes,isLoading:isLoadingCategories}=Object(hooks.Q)(),packages=categoryPackagesRes&&categoryPackagesRes.response?categoryPackagesRes.response:[],title=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.epmList.allTitle",{defaultMessage:"Browse by category"}),categories=[{id:"",title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.epmList.allPackagesFilterLinkText",{defaultMessage:"All"}),count:(null==allPackagesRes||null===(_allPackagesRes$respo=allPackagesRes.response)||void 0===_allPackagesRes$respo?void 0:_allPackagesRes$respo.length)||0},...categoriesRes?categoriesRes.response:[]],controls=categories?external_kbnSharedDeps_React_default.a.createElement(CategoryFacets,{isLoading:isLoadingCategories||isLoadingAllPackages,categories:categories,selectedCategory:selectedCategory,onCategoryChange:({id:id})=>{queryParams.get("category")&&history.push({}),setSelectedCategory(id)}}):null;return external_kbnSharedDeps_React_default.a.createElement(PackageListGrid,{isLoading:isLoadingCategoryPackages,title:title,controls:controls,list:packages})}var lt=__webpack_require__(30),lt_default=__webpack_require__.n(lt),types=__webpack_require__(112);const UpdateIcon=({size:size="m"})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIconTip,{"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.epm.updateAvailableTooltip",{defaultMessage:"Update available"}),size:size,type:"alert",color:"warning",content:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.epm.updateAvailableTooltip",{defaultMessage:"Update available"})}),IntegrationAgentPolicyCount=Object(external_kbnSharedDeps_React_.memo)(({packageName:packageName})=>{var _data$response$agent_;const{data:data}=Object(hooks.bb)(packageName);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,null!==(_data$response$agent_=null==data?void 0:data.response.agent_policy_count)&&void 0!==_data$response$agent_?_data$response$agent_:0)}),PanelWrapper=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"PanelWrapper",componentId:"npech1-0"})(["width:","px;height:1px;z-index:1;"],props=>6*parseFloat(props.theme.eui.euiSize)+2*parseFloat(props.theme.eui.euiSizeXL)),Panel=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiPanel).withConfig({displayName:"Panel",componentId:"npech1-1"})(["padding:",";margin-bottom:-100%;svg,img{height:","px;width:","px;}.euiFlexItem{height:","px;justify-content:center;}"],props=>props.theme.eui.spacerSizes.xl,props=>6*parseFloat(props.theme.eui.euiSize),props=>6*parseFloat(props.theme.eui.euiSize),props=>6*parseFloat(props.theme.eui.euiSize));function IconPanel({packageName:packageName,version:version,icons:icons}){const iconType=Object(hooks.jb)({packageName:packageName,version:version,icons:icons});return external_kbnSharedDeps_React_default.a.createElement(PanelWrapper,null,external_kbnSharedDeps_React_default.a.createElement(Panel,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{type:iconType,size:"original"})))}function LoadingIconPanel(){return external_kbnSharedDeps_React_default.a.createElement(PanelWrapper,null,external_kbnSharedDeps_React_default.a.createElement(Panel,null,external_kbnSharedDeps_React_default.a.createElement(Loading,null)))}const Screenshots=Object(external_kbnSharedDeps_React_.memo)(({images:images,packageName:packageName,version:version})=>{const{toPackageImage:toPackageImage}=Object(epm_hooks.e)(),[currentImageIndex,setCurrentImageIndex]=Object(external_kbnSharedDeps_React_.useState)(0),maxImageIndex=Object(external_kbnSharedDeps_React_.useMemo)(()=>images.length-1,[images.length]),currentImageUrl=Object(external_kbnSharedDeps_React_.useMemo)(()=>toPackageImage(images[currentImageIndex],packageName,version),[currentImageIndex,images,packageName,toPackageImage,version]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"column",gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"row",alignItems:"center",gutterSize:"xs",justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement("h4",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.epm.screenshotsTitle",defaultMessage:"Screenshots"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPagination,{"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.epm.screenshotPaginationAriaLabel",{defaultMessage:"{packageName} screenshot pagination",values:{packageName:packageName}}),pageCount:maxImageIndex+1,activePage:currentImageIndex,onPageClick:activePage=>setCurrentImageIndex(activePage),compressed:!0})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,currentImageUrl?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiImage,{allowFullScreen:!0,hasShadow:!0,alt:images[currentImageIndex].title||external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.epm.screenshotAltText",{defaultMessage:"{packageName} screenshot #{imageNumber}",values:{packageName:packageName,imageNumber:currentImageIndex+1}}),title:images[currentImageIndex].title,url:currentImageUrl}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.epm.screenshotErrorText",defaultMessage:"Unable to load this screenshot"})))}),markdownRenderers={root:({children:children})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{grow:!0},children),table:({children:children})=>external_kbnSharedDeps_React_default.a.createElement("table",{className:"euiTable euiTable--responsive"},children),tableRow:({children:children})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTableRow,null,children),tableCell:({isHeader:isHeader,children:children})=>isHeader?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTableHeaderCell,null,children):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTableRowCell,null,children),heading:({level:level,children:children})=>{switch(level){case 1:return external_kbnSharedDeps_React_default.a.createElement("h3",null,children);case 2:return external_kbnSharedDeps_React_default.a.createElement("h4",null,children);case 3:return external_kbnSharedDeps_React_default.a.createElement("h5",null,children);default:return external_kbnSharedDeps_React_default.a.createElement("h6",null,children)}},link:({children:children,href:href})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{href:href,target:"_blank",rel:"noopener nofollow noreferrer"},children),code:({language:language,value:value})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCodeBlock,{language:language,isCopyable:!0},value)};function Readme({readmePath:readmePath,packageName:packageName,version:version}){const[markdown,setMarkdown]=Object(external_kbnSharedDeps_React_.useState)(void 0),{toRelativeImage:toRelativeImage}=Object(epm_hooks.e)(),handleImageUri=external_kbnSharedDeps_React_default.a.useCallback(uri=>0!==uri.indexOf("http://")&&0!==uri.indexOf("https://")?toRelativeImage({packageName:packageName,version:version,path:uri}):uri,[toRelativeImage,packageName,version]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{Object(hooks.o)(readmePath).then(res=>{setMarkdown(res.data||"")})},[readmePath]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,void 0!==markdown?external_kbnSharedDeps_React_default.a.createElement(react_markdown_default.a,{transformImageUri:handleImageUri,renderers:markdownRenderers,source:markdown}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingContent,{lines:5})),external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingContent,{lines:6})),external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingContent,{lines:4}))))}const DisplayedAssets={kibana:Object.values(types.KibanaAssetType),elasticsearch:Object.values(types.ElasticsearchAssetType)},AssetTitleMap={dashboard:"Dashboard",ilm_policy:"ILM Policy",ingest_pipeline:"Ingest Pipeline",transform:"Transform",index_pattern:"Index Pattern",index_template:"Index Template",component_template:"Component Template",search:"Saved Search",visualization:"Visualization",input:"Agent input",map:"Map",data_stream_ilm_policy:"Data Stream ILM Policy",lens:"Lens",security_rule:"Security Rule",ml_module:"ML Module"},ServiceTitleMap={kibana:"Kibana",elasticsearch:"Elasticsearch"},Details=Object(external_kbnSharedDeps_React_.memo)(({packageInfo:packageInfo})=>{const{data:categoriesData,isLoading:isLoadingCategories}=Object(hooks.Q)(),packageCategories=Object(external_kbnSharedDeps_React_.useMemo)(()=>!isLoadingCategories&&categoriesData&&categoriesData.response?categoriesData.response.filter(category=>{var _packageInfo$categori;return null===(_packageInfo$categori=packageInfo.categories)||void 0===_packageInfo$categori?void 0:_packageInfo$categori.includes(category.id)}).map(category=>category.title):[],[categoriesData,isLoadingCategories,packageInfo.categories]),listItems=Object(external_kbnSharedDeps_React_.useMemo)(()=>{var _packageInfo$data_str;const items=[{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTextColor,{color:"subdued"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.epm.versionLabel",defaultMessage:"Version"})),description:packageInfo.version},{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTextColor,{color:"subdued"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.epm.categoryLabel",defaultMessage:"Category"})),description:packageCategories.join(", ")}];Object(types.entries)(packageInfo.assets).forEach(([service,typeToParts])=>{const filteredTypes=Object(types.entries)(typeToParts).reduce((acc,[asset,value])=>(DisplayedAssets[service].includes(asset)&&(acc[asset]=value),acc),{});Object.entries(filteredTypes).length&&items.push({title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTextColor,{color:"subdued"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.epm.assetGroupTitle",defaultMessage:"{assetType} assets",values:{assetType:ServiceTitleMap[service]}})),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"column",gutterSize:"xs"},Object(types.entries)(filteredTypes).map(([_type,parts])=>{const type=_type;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"xs",alignItems:"center",justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},AssetTitleMap[type]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiNotificationBadge,{color:"subdued"},parts.length))))}))})});const dataStreamTypes=[...new Set((null===(_packageInfo$data_str=packageInfo.data_streams)||void 0===_packageInfo$data_str?void 0:_packageInfo$data_str.map(dataStream=>dataStream.type))||[])];return dataStreamTypes.length&&items.push({title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTextColor,{color:"subdued"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.epm.featuresLabel",defaultMessage:"Features"})),description:dataStreamTypes.join(", ")}),packageInfo.license&&items.push({title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTextColor,{color:"subdued"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.epm.licenseLabel",defaultMessage:"License"})),description:packageInfo.license}),items},[packageCategories,packageInfo.assets,packageInfo.data_streams,packageInfo.license,packageInfo.version]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"column",gutterSize:"m"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement("h4",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.epm.detailsTitle",defaultMessage:"Details"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionList,{type:"column",compressed:!0,listItems:listItems})))}),LeftColumn=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexItem).withConfig({displayName:"LeftColumn",componentId:"sc-1i2iwy9-0"})(["&&&{margin-top:77px;}"]),OverviewPage=Object(external_kbnSharedDeps_React_.memo)(({packageInfo:packageInfo})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"flexStart"},external_kbnSharedDeps_React_default.a.createElement(LeftColumn,{grow:2}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:9,className:"eui-textBreakWord"},packageInfo.readme?external_kbnSharedDeps_React_default.a.createElement(Readme,{readmePath:packageInfo.readme,packageName:packageInfo.name,version:packageInfo.version}):null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:3},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"column",gutterSize:"l",alignItems:"flexStart"},packageInfo.screenshots&&packageInfo.screenshots.length?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(Screenshots,{images:packageInfo.screenshots,packageName:packageInfo.name,version:packageInfo.version})):null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(Details,{packageInfo:packageInfo}))))));var use_request=__webpack_require__(23);function persona_extends(){return(persona_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const persona_MIN_WIDTH={minWidth:0},Persona=Object(external_kbnSharedDeps_React_.memo)(({name:name,className:className,"data-test-subj":dataTestSubj,title:title,...otherAvatarProps})=>{const getTestId=Object(external_kbnSharedDeps_React_.useCallback)(suffix=>{if(dataTestSubj)return`${dataTestSubj}-${suffix}`},[dataTestSubj]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s",alignItems:"baseline",style:persona_MIN_WIDTH,className:className,"data-test-subj":dataTestSubj,title:title,responsive:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiAvatar,persona_extends({name:name,"data-test-subj":getTestId("avatar")},otherAvatarProps))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,className:"eui-textTruncate"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"s",className:"eui-textTruncate","data-test-subj":getTestId("name")},name)))}),IntegrationDetailsLink=Object(external_kbnSharedDeps_React_.memo)(({packagePolicy:packagePolicy})=>{const{getHref:getHref}=Object(hooks.ib)();return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{className:"eui-textTruncate","data-test-subj":"integrationNameLink",title:packagePolicy.name,href:getHref("integration_policy_edit",{packagePolicyId:packagePolicy.id})},packagePolicy.name)}),PackagePoliciesPage=({name:name,version:version})=>{const{getPath:getPath}=Object(hooks.ib)(),packageInstallStatus=Object(epm_hooks.c)()(name),{pagination:pagination,pageSizeOptions:pageSizeOptions,setPagination:setPagination}=Object(hooks.pb)(),{data:data,isLoading:isLoading}=(query=>{const{data:packagePoliciesData,error:error,isLoading:isLoadingPackagePolicies}=Object(hooks.ab)(query),agentPoliciesFilter=Object(external_kbnSharedDeps_React_.useMemo)(()=>{if(null==packagePoliciesData||!packagePoliciesData.items.length)return"";const includedAgentPolicies=new Set;return`${constants.c}.package_policies: (${packagePoliciesData.items.filter(packagePolicy=>!includedAgentPolicies.has(packagePolicy.policy_id)&&(includedAgentPolicies.add(packagePolicy.policy_id),!0)).map(packagePolicy=>packagePolicy.id).join(" or ")}) `},[packagePoliciesData]),{data:agentPoliciesData,isLoading:isLoadingAgentPolicies}=Object(use_request.c)({path:services.b.getListPath(),method:"get",query:{perPage:100,kuery:agentPoliciesFilter},shouldSendRequest:!(null==packagePoliciesData||!packagePoliciesData.items.length)}),[enrichedData,setEnrichedData]=Object(external_kbnSharedDeps_React_.useState)();return Object(external_kbnSharedDeps_React_.useEffect)(()=>{if(isLoadingPackagePolicies||isLoadingAgentPolicies)return;if(null==packagePoliciesData||!packagePoliciesData.items)return void setEnrichedData(void 0);const agentPoliciesById={};if(null!=agentPoliciesData&&agentPoliciesData.items)for(const agentPolicy of agentPoliciesData.items)agentPoliciesById[agentPolicy.id]=agentPolicy;const updatedPackageData=packagePoliciesData.items.map(packagePolicy=>({packagePolicy:packagePolicy,agentPolicy:agentPoliciesById[packagePolicy.policy_id]}));setEnrichedData({...packagePoliciesData,items:updatedPackageData})},[isLoadingAgentPolicies,isLoadingPackagePolicies,packagePoliciesData,agentPoliciesData]),{data:enrichedData,error:error,isLoading:isLoadingPackagePolicies||isLoadingAgentPolicies}})({page:pagination.currentPage,perPage:pagination.pageSize,kuery:`${constants.i}.package.name: ${name}`}),handleTableOnChange=Object(external_kbnSharedDeps_React_.useCallback)(({page:page})=>{setPagination({currentPage:page.index+1,pageSize:page.size})},[setPagination]),columns=Object(external_kbnSharedDeps_React_.useMemo)(()=>[{field:"packagePolicy.name",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.epm.packageDetails.integrationList.name",{defaultMessage:"Integration"}),render:(_,{packagePolicy:packagePolicy})=>external_kbnSharedDeps_React_default.a.createElement(IntegrationDetailsLink,{packagePolicy:packagePolicy})},{field:"packagePolicy.package.version",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.epm.packageDetails.integrationList.version",{defaultMessage:"Version"})},{field:"packagePolicy.policy_id",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.epm.packageDetails.integrationList.agentPolicy",{defaultMessage:"Agent policy"}),truncateText:!0,render:(id,{agentPolicy:agentPolicy})=>external_kbnSharedDeps_React_default.a.createElement(AgentPolicySummaryLine,{policy:agentPolicy})},{field:"",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.epm.packageDetails.integrationList.agentCount",{defaultMessage:"Agents"}),truncateText:!0,align:"right",width:"8ch",render({packagePolicy:packagePolicy,agentPolicy:agentPolicy}){var _agentPolicy$agents;return external_kbnSharedDeps_React_default.a.createElement(LinkedAgentCount,{count:null!==(_agentPolicy$agents=null==agentPolicy?void 0:agentPolicy.agents)&&void 0!==_agentPolicy$agents?_agentPolicy$agents:0,agentPolicyId:packagePolicy.policy_id,className:"eui-textTruncate","data-test-subj":"rowAgentCount"})}},{field:"packagePolicy.updated_by",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.epm.packageDetails.integrationList.updatedBy",{defaultMessage:"Last Updated By"}),truncateText:!0,render:updatedBy=>external_kbnSharedDeps_React_default.a.createElement(Persona,{size:"s",name:updatedBy,title:updatedBy})},{field:"packagePolicy.updated_at",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.epm.packageDetails.integrationList.updatedAt",{defaultMessage:"Last Updated"}),truncateText:!0,render:updatedAt=>external_kbnSharedDeps_React_default.a.createElement("span",{className:"eui-textTruncate",title:updatedAt},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedRelative,{value:updatedAt}))}],[]),noItemsMessage=Object(external_kbnSharedDeps_React_.useMemo)(()=>isLoading?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.epm.packageDetails.integrationList.loadingPoliciesMessage",defaultMessage:"Loading integration policiesâ¦"}):void 0,[isLoading]),tablePagination=Object(external_kbnSharedDeps_React_.useMemo)(()=>{var _data$total;return{pageIndex:pagination.currentPage-1,pageSize:pagination.pageSize,totalItemCount:null!==(_data$total=null==data?void 0:data.total)&&void 0!==_data$total?_data$total:0,pageSizeOptions:pageSizeOptions}},[null==data?void 0:data.total,pageSizeOptions,pagination.currentPage,pagination.pageSize]);return packageInstallStatus.status!==types.InstallStatus.installed?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Redirect,{to:getPath("integration_details_overview",{pkgkey:`${name}-${version}`})}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"flexStart"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:1}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:6},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBasicTable,{items:(null==data?void 0:data.items)||[],columns:columns,loading:isLoading,"data-test-subj":"integrationPolicyTable",pagination:tablePagination,onChange:handleTableOnChange,noItemsMessage:noItemsMessage})))},ConfirmPackageUninstall=props=>{const{onCancel:onCancel,onConfirm:onConfirm,packageName:packageName,numOfAssets:numOfAssets}=props;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiConfirmModal,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.integrations.settings.confirmUninstallModal.uninstallTitle",defaultMessage:"Uninstall {packageName}",values:{packageName:packageName}}),onCancel:onCancel,onConfirm:onConfirm,cancelButtonText:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.integrations.settings.confirmUninstallModal.cancelButtonLabel",defaultMessage:"Cancel"}),confirmButtonText:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.integrations.settings.confirmUninstallModal.uninstallButtonLabel",defaultMessage:"Uninstall {packageName}",values:{packageName:packageName}}),defaultFocusedButton:"confirm",buttonColor:"danger"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{color:"danger",title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.integrations.settings.confirmUninstallModal.uninstallCallout.title",defaultMessage:"This action will remove {numOfAssets} assets",values:{numOfAssets:numOfAssets}})},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.integrations.settings.confirmUninstallModal.uninstallCallout.description",defaultMessage:"Kibana and Elasticsearch assets that were created by this integration will be removed. Agents policies and any data sent by your agents will not be effected."}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"}),external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.integrations.settings.confirmUninstallModal.uninstallDescription",defaultMessage:"This action cannot be undone. Are you sure you wish to continue?"})))},ConfirmPackageInstall=props=>{const{onCancel:onCancel,onConfirm:onConfirm,packageName:packageName,numOfAssets:numOfAssets}=props;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiConfirmModal,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.integrations.settings.confirmInstallModal.installTitle",defaultMessage:"Install {packageName}",values:{packageName:packageName}}),onCancel:onCancel,onConfirm:onConfirm,cancelButtonText:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.integrations.settings.confirmInstallModal.cancelButtonLabel",defaultMessage:"Cancel"}),confirmButtonText:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.integrations.settings.confirmInstallModal.installButtonLabel",defaultMessage:"Install {packageName}",values:{packageName:packageName}}),defaultFocusedButton:"confirm"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{iconType:"iInCircle",title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.integrations.settings.confirmInstallModal.installCalloutTitle",defaultMessage:"This action will install {numOfAssets} assets",values:{numOfAssets:numOfAssets}})}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"}),external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.integrations.settings.confirmInstallModal.installDescription",defaultMessage:"Kibana assets will be installed in the current Space (Default) and will only be accessible to users who have permission to view this Space. Elasticsearch assets are installed globally and will be accessible to all Kibana users."})))};function InstallationButton(props){const{assets:assets,name:name,title:title,version:version,disabled:disabled=!0,isUpdate:isUpdate=!1}=props,hasWriteCapabilites=Object(hooks.K)().write,installPackage=Object(epm_hooks.d)(),uninstallPackage=Object(epm_hooks.h)(),getPackageInstallStatus=Object(epm_hooks.c)(),{status:installationStatus}=getPackageInstallStatus(name),isInstalling=installationStatus===types.InstallStatus.installing,isRemoving=installationStatus===types.InstallStatus.uninstalling,isInstalled=installationStatus===types.InstallStatus.installed,showUninstallButton=isInstalled||isRemoving,[isModalVisible,setModalVisible]=Object(external_kbnSharedDeps_React_.useState)(!1),toggleModal=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setModalVisible(!isModalVisible)},[isModalVisible]),handleClickInstall=Object(external_kbnSharedDeps_React_.useCallback)(()=>{installPackage({name:name,version:version,title:title}),toggleModal()},[installPackage,name,title,toggleModal,version]),handleClickUpdate=Object(external_kbnSharedDeps_React_.useCallback)(()=>{installPackage({name:name,version:version,title:title,fromUpdate:!0})},[installPackage,name,title,version]),handleClickUninstall=Object(external_kbnSharedDeps_React_.useCallback)(()=>{uninstallPackage({name:name,version:version,title:title}),toggleModal()},[uninstallPackage,name,title,toggleModal,version]),numOfAssets=Object(external_kbnSharedDeps_React_.useMemo)(()=>Object.entries(assets).reduce((acc,[serviceName,serviceNameValue])=>acc+Object.entries(serviceNameValue).reduce((acc2,[assetName,assetNameValue])=>acc2+assetNameValue.length,0),0),[assets]),installButton=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{iconType:"importAction",isLoading:isInstalling,onClick:toggleModal},isInstalling?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.integrations.installPackage.installingPackageButtonLabel",defaultMessage:"Installing {title} assets",values:{title:title}}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.integrations.installPackage.installPackageButtonLabel",defaultMessage:"Install {title} assets",values:{title:title}})),updateButton=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{iconType:"refresh",isLoading:isInstalling,onClick:handleClickUpdate},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.integrations.updatePackage.updatePackageButtonLabel",defaultMessage:"Update to latest version"})),uninstallButton=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{iconType:"trash",isLoading:isRemoving,onClick:toggleModal,color:"danger",disabled:!(!disabled&&!isRemoving)},isRemoving?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.integrations.uninstallPackage.uninstallingPackageButtonLabel",defaultMessage:"Uninstalling {title}",values:{title:title}}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.integrations.uninstallPackage.uninstallPackageButtonLabel",defaultMessage:"Uninstall {title}",values:{title:title}})),uninstallModal=external_kbnSharedDeps_React_default.a.createElement(ConfirmPackageUninstall,{numOfAssets:numOfAssets,packageName:title,onCancel:toggleModal,onConfirm:handleClickUninstall}),installModal=external_kbnSharedDeps_React_default.a.createElement(ConfirmPackageInstall,{numOfAssets:numOfAssets,packageName:title,onCancel:toggleModal,onConfirm:handleClickInstall});return hasWriteCapabilites?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,isUpdate?updateButton:showUninstallButton?uninstallButton:installButton,isModalVisible&&(isInstalled?uninstallModal:installModal)):null}function settings_extends(){return(settings_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const SettingsTitleCell=external_kbnSharedDeps_StyledComponents_default.a.td.withConfig({displayName:"SettingsTitleCell",componentId:"sc-1sli6ff-0"})(["padding-right:",";padding-bottom:",";"],props=>props.theme.eui.spacerSizes.xl,props=>props.theme.eui.spacerSizes.m),UpdatesAvailableMsgContainer=external_kbnSharedDeps_StyledComponents_default.a.span.withConfig({displayName:"UpdatesAvailableMsgContainer",componentId:"sc-1sli6ff-1"})(["padding-left:",";"],props=>props.theme.eui.spacerSizes.s),NoteLabel=()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.integrations.settings.packageUninstallNoteDescription.packageUninstallNoteLabel",defaultMessage:"Note:"}),UpdatesAvailableMsg=()=>external_kbnSharedDeps_React_default.a.createElement(UpdatesAvailableMsgContainer,null,external_kbnSharedDeps_React_default.a.createElement(UpdateIcon,{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.integrations.settings.versionInfo.updatesAvailable",defaultMessage:"Updates are available"})),SettingsPage=Object(external_kbnSharedDeps_React_.memo)(({packageInfo:packageInfo})=>{const{name:name,title:title,removable:removable,latestVersion:latestVersion,version:version}=packageInfo,getPackageInstallStatus=Object(epm_hooks.c)(),{data:packagePoliciesData}=Object(hooks.ab)({perPage:0,page:1,kuery:`${constants.i}.package.name:${name}`}),{status:installationStatus,version:installedVersion}=getPackageInstallStatus(name),packageHasUsages=!(null==packagePoliciesData||!packagePoliciesData.total),updateAvailable=!(!installedVersion||!lt_default()(installedVersion,latestVersion)),isViewingOldPackage=version<latestVersion,hideInstallOptions=installationStatus===types.InstallStatus.notInstalled&&isViewingOldPackage||installationStatus===types.InstallStatus.installed&&installedVersion!==version,isUpdating=installationStatus===types.InstallStatus.installing&&installedVersion;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"flexStart"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:1}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:6},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,null,external_kbnSharedDeps_React_default.a.createElement("h3",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.integrations.settings.packageSettingsTitle",defaultMessage:"Settings"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),null!==installedVersion&&external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,null,external_kbnSharedDeps_React_default.a.createElement("h4",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.integrations.settings.packageVersionTitle",defaultMessage:"{title} version",values:{title:title}}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement("table",null,external_kbnSharedDeps_React_default.a.createElement("tbody",null,external_kbnSharedDeps_React_default.a.createElement("tr",null,external_kbnSharedDeps_React_default.a.createElement(SettingsTitleCell,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.integrations.settings.versionInfo.installedVersion",defaultMessage:"Installed version"})),external_kbnSharedDeps_React_default.a.createElement("td",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("span",null,installedVersion)),updateAvailable&&external_kbnSharedDeps_React_default.a.createElement(UpdatesAvailableMsg,null))),external_kbnSharedDeps_React_default.a.createElement("tr",null,external_kbnSharedDeps_React_default.a.createElement(SettingsTitleCell,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.integrations.settings.versionInfo.latestVersion",defaultMessage:"Latest version"})),external_kbnSharedDeps_React_default.a.createElement("td",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("span",null,latestVersion)))))),updateAvailable&&external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(InstallationButton,settings_extends({},packageInfo,{version:latestVersion,disabled:!1,isUpdate:!0})))),!hideInstallOptions&&!isUpdating&&external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),installationStatus===types.InstallStatus.notInstalled||installationStatus===types.InstallStatus.installing?external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,null,external_kbnSharedDeps_React_default.a.createElement("h4",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.integrations.settings.packageInstallTitle",defaultMessage:"Install {title}",values:{title:title}}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.integrations.settings.packageInstallDescription",defaultMessage:"Install this integration to setup Kibana and Elasticsearch assets designed for {title} data.",values:{title:title}}))):external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,null,external_kbnSharedDeps_React_default.a.createElement("h4",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.integrations.settings.packageUninstallTitle",defaultMessage:"Uninstall {title}",values:{title:title}}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.integrations.settings.packageUninstallDescription",defaultMessage:"Remove Kibana and Elasticsearch assets that were installed by this integration."}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(InstallationButton,settings_extends({},packageInfo,{disabled:!packagePoliciesData||!1===removable||packageHasUsages}))))),packageHasUsages&&!0===removable&&external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.integrations.settings.packageUninstallNoteDescription.packageUninstallNoteDetail",defaultMessage:"{strongNote} {title} cannot be uninstalled because there are active agents that use this integration. To uninstall, remove all {title} integrations from your agent policies.",values:{title:title,strongNote:external_kbnSharedDeps_React_default.a.createElement("strong",null,external_kbnSharedDeps_React_default.a.createElement(NoteLabel,null))}})),!1===removable&&external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.integrations.settings.packageUninstallNoteDescription.packageUninstallUninstallableNoteDetail",defaultMessage:"{strongNote} The {title} integration is installed by default and cannot be removed.",values:{title:title,strongNote:external_kbnSharedDeps_React_default.a.createElement("strong",null,external_kbnSharedDeps_React_default.a.createElement(NoteLabel,null))}}))))))}),CustomViewPage=Object(external_kbnSharedDeps_React_.memo)(({packageInfo:packageInfo})=>{const CustomView=useUIExtension(packageInfo.name,"package-detail-custom"),{getPath:getPath}=Object(hooks.ib)(),pkgkey=Object(external_kbnSharedDeps_React_.useMemo)(()=>Object(pkg_key_from_package_info.a)(packageInfo),[packageInfo]);return CustomView?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"flexStart"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:1}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:6},external_kbnSharedDeps_React_default.a.createElement(ExtensionWrapper,null,external_kbnSharedDeps_React_default.a.createElement(CustomView,{pkgkey:pkgkey,packageInfo:packageInfo})))):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Redirect,{to:getPath("integration_details_overview",{pkgkey:pkgkey})})});__webpack_require__(245);const Divider=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"Divider",componentId:"sc-9vnm9c-0"})(["width:0;height:100%;border-left:",";"],props=>props.theme.eui.euiBorderThin),detail_FlexItemWithMinWidth=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexItem).withConfig({displayName:"FlexItemWithMinWidth",componentId:"sc-9vnm9c-1"})(["min-width:0px;"]);function Breadcrumbs({packageTitle:packageTitle}){return Object(hooks.J)("integration_details_overview",{pkgTitle:packageTitle}),null}function Detail(){var _packageInfoData$resp;const{pkgkey:pkgkey,panel:panel}=Object(external_kbnSharedDeps_ReactRouterDom_.useParams)(),{getHref:getHref,getPath:getPath}=Object(hooks.ib)(),hasWriteCapabilites=Object(hooks.K)().write,history=Object(external_kbnSharedDeps_ReactRouterDom_.useHistory)(),location=Object(external_kbnSharedDeps_ReactRouterDom_.useLocation)(),[packageInfo,setPackageInfo]=Object(external_kbnSharedDeps_React_.useState)(null),setPackageInstallStatus=Object(epm_hooks.g)(),getPackageInstallStatus=Object(epm_hooks.c)(),packageInstallStatus=Object(external_kbnSharedDeps_React_.useMemo)(()=>{if(null!==packageInfo&&packageInfo.name)return getPackageInstallStatus(packageInfo.name).status},[packageInfo,getPackageInstallStatus]),updateAvailable=packageInfo&&"savedObject"in packageInfo&&packageInfo.savedObject&&lt_default()(packageInfo.savedObject.attributes.version,packageInfo.latestVersion),{data:packageInfoData,error:packageInfoError,isLoading:isLoading}=Object(hooks.Z)(pkgkey),showCustomTab=void 0!==useUIExtension(null!==(_packageInfoData$resp=null==packageInfoData?void 0:packageInfoData.response.name)&&void 0!==_packageInfoData$resp?_packageInfoData$resp:"","package-detail-custom");Object(external_kbnSharedDeps_React_.useEffect)(()=>{if(null!=packageInfoData&&packageInfoData.response){const packageInfoResponse=packageInfoData.response;let installedVersion;setPackageInfo(packageInfoResponse);const{name:name}=packageInfoData.response;"savedObject"in packageInfoResponse&&(installedVersion=packageInfoResponse.savedObject.attributes.version);const status=null==packageInfoResponse?void 0:packageInfoResponse.status;name&&setPackageInstallStatus({name:name,status:status,version:installedVersion||null})}},[packageInfoData,setPackageInstallStatus,setPackageInfo]);const headerLeftContent=Object(external_kbnSharedDeps_React_.useMemo)(()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"column",gutterSize:"m"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{iconType:"arrowLeft",size:"xs",flush:"left",href:getHref("integrations_all")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.epm.browseAllButtonText",defaultMessage:"Browse all integrations"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"l"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},isLoading||!packageInfo?external_kbnSharedDeps_React_default.a.createElement(LoadingIconPanel,null):external_kbnSharedDeps_React_default.a.createElement(IconPanel,{packageName:packageInfo.name,version:packageInfo.version,icons:packageInfo.icons})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",gutterSize:"m"},external_kbnSharedDeps_React_default.a.createElement(detail_FlexItemWithMinWidth,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement("h1",null,(null==packageInfo?void 0:packageInfo.title)||"Â "))),null!=packageInfo&&packageInfo.release&&"ga"!==packageInfo.release?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBetaBadge,{label:RELEASE_BADGE_LABEL[packageInfo.release],tooltipContent:RELEASE_BADGE_DESCRIPTION[packageInfo.release]})):null))))),[getHref,isLoading,packageInfo]),handleAddIntegrationPolicyClick=Object(external_kbnSharedDeps_React_.useCallback)(ev=>{ev.preventDefault();const currentPath=history.createHref({pathname:location.pathname,search:location.search,hash:location.hash}),redirectToPath=[constants.k,{path:currentPath}],redirectBackRouteState={onSaveNavigateTo:redirectToPath,onCancelNavigateTo:redirectToPath,onCancelUrl:currentPath};history.push({pathname:getPath("add_integration_to_policy",{pkgkey:pkgkey}),state:redirectBackRouteState})},[getPath,history,location.hash,location.pathname,location.search,pkgkey]),headerRightContent=Object(external_kbnSharedDeps_React_.useMemo)(()=>packageInfo?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"flexEnd",direction:"row"},[{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.epm.versionLabel",{defaultMessage:"Version"}),content:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,packageInfo.version),updateAvailable?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(UpdateIcon,null)):null)},..."installed"===packageInstallStatus?[{isDivider:!0},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.epm.usedByLabel",{defaultMessage:"Agent policies"}),"data-test-subj":"agentPolicyCount",content:external_kbnSharedDeps_React_default.a.createElement(IntegrationAgentPolicyCount,{packageName:packageInfo.name})}]:[],{isDivider:!0},{content:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{fill:!0,isDisabled:!hasWriteCapabilites,iconType:"plusInCircle",href:getHref("add_integration_to_policy",{pkgkey:pkgkey}),onClick:handleAddIntegrationPolicyClick,"data-test-subj":"addIntegrationPolicyButton"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.epm.addPackagePolicyButtonText",defaultMessage:"Add {packageName}",values:{packageName:packageInfo.title}}))}].map((item,index)=>{var _item$isDivider;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,key:index,"data-test-subj":item["data-test-subj"]},null!==(_item$isDivider=item.isDivider)&&void 0!==_item$isDivider&&_item$isDivider?external_kbnSharedDeps_React_default.a.createElement(Divider,null):item.label?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionList,{className:"eui-textRight",compressed:!0,textStyle:"reverse"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionListTitle,null,item.label),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionListDescription,null,item.content)):item.content)}))):void 0,[getHref,handleAddIntegrationPolicyClick,hasWriteCapabilites,packageInfo,packageInstallStatus,pkgkey,updateAvailable]),headerTabs=Object(external_kbnSharedDeps_React_.useMemo)(()=>{if(!packageInfo)return[];const packageInfoKey=Object(pkg_key_from_package_info.a)(packageInfo),tabs=[{id:"overview",name:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.epm.packageDetailsNav.overviewLinkText",defaultMessage:"Overview"}),isSelected:"overview"===panel,"data-test-subj":"tab-overview",href:getHref("integration_details_overview",{pkgkey:packageInfoKey})}];return packageInstallStatus===types.InstallStatus.installed&&tabs.push({id:"policies",name:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.epm.packageDetailsNav.packagePoliciesLinkText",defaultMessage:"Policies"}),isSelected:"policies"===panel,"data-test-subj":"tab-policies",href:getHref("integration_details_policies",{pkgkey:packageInfoKey})}),tabs.push({id:"settings",name:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.epm.packageDetailsNav.settingsLinkText",defaultMessage:"Settings"}),isSelected:"settings"===panel,"data-test-subj":"tab-settings",href:getHref("integration_details_settings",{pkgkey:packageInfoKey})}),showCustomTab&&tabs.push({id:"custom",name:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.epm.packageDetailsNav.packageCustomLinkText",defaultMessage:"Advanced"}),isSelected:"custom"===panel,"data-test-subj":"tab-custom",href:getHref("integration_details_custom",{pkgkey:packageInfoKey})}),tabs},[getHref,packageInfo,panel,showCustomTab,packageInstallStatus]);return external_kbnSharedDeps_React_default.a.createElement(WithHeaderLayout,{leftColumn:headerLeftContent,rightColumn:headerRightContent,rightColumnGrow:!1,tabs:headerTabs,tabsClassName:"fleet__epm__shiftNavTabs"},packageInfo?external_kbnSharedDeps_React_default.a.createElement(Breadcrumbs,{packageTitle:packageInfo.title}):null,packageInfoError?external_kbnSharedDeps_React_default.a.createElement(error_Error,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.epm.loadingIntegrationErrorTitle",defaultMessage:"Error loading integration details"}),error:packageInfoError}):isLoading||!packageInfo?external_kbnSharedDeps_React_default.a.createElement(Loading,null):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Switch,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:constants.j.integration_details_overview},external_kbnSharedDeps_React_default.a.createElement(OverviewPage,{packageInfo:packageInfo})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:constants.j.integration_details_settings},external_kbnSharedDeps_React_default.a.createElement(SettingsPage,{packageInfo:packageInfo})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:constants.j.integration_details_policies},external_kbnSharedDeps_React_default.a.createElement(PackagePoliciesPage,{name:packageInfo.name,version:packageInfo.version})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:constants.j.integration_details_custom},external_kbnSharedDeps_React_default.a.createElement(CustomViewPage,{packageInfo:packageInfo})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Redirect,{to:constants.j.integration_details_overview})))}function edit_package_policy_page_extends(){return(edit_package_policy_page_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const EditPackagePolicyPage=Object(external_kbnSharedDeps_React_.memo)(()=>{const{params:{packagePolicyId:packagePolicyId}}=Object(external_kbnSharedDeps_ReactRouterDom_.useRouteMatch)();return external_kbnSharedDeps_React_default.a.createElement(EditPackagePolicyForm,{packagePolicyId:packagePolicyId})}),EditPackagePolicyForm=Object(external_kbnSharedDeps_React_.memo)(({packagePolicyId:packagePolicyId,from:from="edit"})=>{var _agentPolicy$id,_packagePolicy$packag,_packagePolicy$packag2;const{notifications:notifications}=Object(hooks.nb)(),{agents:{enabled:isFleetEnabled}}=Object(hooks.M)(),history=Object(external_kbnSharedDeps_ReactRouterDom_.useHistory)(),{getHref:getHref,getPath:getPath}=Object(hooks.ib)(),[isLoadingData,setIsLoadingData]=Object(external_kbnSharedDeps_React_.useState)(!0),[loadingError,setLoadingError]=Object(external_kbnSharedDeps_React_.useState)(),[agentPolicy,setAgentPolicy]=Object(external_kbnSharedDeps_React_.useState)(),[packageInfo,setPackageInfo]=Object(external_kbnSharedDeps_React_.useState)(),[packagePolicy,setPackagePolicy]=Object(external_kbnSharedDeps_React_.useState)({name:"",description:"",namespace:"",policy_id:"",enabled:!0,output_id:"",inputs:[],version:""}),[originalPackagePolicy,setOriginalPackagePolicy]=Object(external_kbnSharedDeps_React_.useState)(),policyId=null!==(_agentPolicy$id=null==agentPolicy?void 0:agentPolicy.id)&&void 0!==_agentPolicy$id?_agentPolicy$id:"";Object(external_kbnSharedDeps_React_.useEffect)(()=>{(async()=>{setIsLoadingData(!0),setLoadingError(void 0);try{const{data:packagePolicyData,error:packagePolicyError}=await Object(hooks.s)(packagePolicyId);if(packagePolicyError)throw packagePolicyError;const{data:agentPolicyData,error:agentPolicyError}=await Object(hooks.p)(packagePolicyData.item.policy_id);if(agentPolicyError)throw agentPolicyError;if(null!=agentPolicyData&&agentPolicyData.item&&setAgentPolicy(agentPolicyData.item),null!=packagePolicyData&&packagePolicyData.item){setOriginalPackagePolicy(packagePolicyData.item);const{id:id,revision:revision,inputs:inputs,created_by:created_by,created_at:created_at,updated_by:updated_by,updated_at:updated_at,...restOfPackagePolicy}=packagePolicyData.item,newPackagePolicy={...restOfPackagePolicy,inputs:inputs.map(input=>{const{streams:streams,compiled_input:compiledInput,...restOfInput}=input;return{...restOfInput,streams:streams.map(stream=>{const{compiled_stream:compiled_stream,...restOfStream}=stream;return restOfStream})}})};if(setPackagePolicy(newPackagePolicy),packagePolicyData.item.package){const{data:packageData}=await Object(hooks.t)(Object(pkg_key_from_package_info.a)(packagePolicyData.item.package));null!=packageData&&packageData.response&&(setPackageInfo(packageData.response),setValidationResults(validatePackagePolicy(newPackagePolicy,packageData.response)),setFormState("VALID"))}}}catch(e){setLoadingError(e)}setIsLoadingData(!1)})()},[policyId,packagePolicyId]);const[agentCount,setAgentCount]=Object(external_kbnSharedDeps_React_.useState)(0);Object(external_kbnSharedDeps_React_.useEffect)(()=>{isFleetEnabled&&policyId&&(async()=>{const{data:data}=await Object(hooks.l)({policyId:policyId});null!=data&&data.results.total&&setAgentCount(data.results.total)})()},[policyId,isFleetEnabled]);const[validationResults,setValidationResults]=Object(external_kbnSharedDeps_React_.useState)(),hasErrors=!!validationResults&&validationHasErrors(validationResults),updatePackagePolicyValidation=Object(external_kbnSharedDeps_React_.useCallback)(newPackagePolicy=>{if(packageInfo){const newValidationResult=validatePackagePolicy(newPackagePolicy||packagePolicy,packageInfo);return setValidationResults(newValidationResult),console.debug("Package policy validation results",newValidationResult),newValidationResult}},[packagePolicy,packageInfo]),updatePackagePolicy=Object(external_kbnSharedDeps_React_.useCallback)(updatedFields=>{const newPackagePolicy={...packagePolicy,...updatedFields};setPackagePolicy(newPackagePolicy),console.debug("Package policy updated",newPackagePolicy);const newValidationResults=updatePackagePolicyValidation(newPackagePolicy);!!newValidationResults&&validationHasErrors(newValidationResults)||setFormState("VALID")},[packagePolicy,updatePackagePolicyValidation]),handleExtensionViewOnChange=Object(external_kbnSharedDeps_React_.useCallback)(({isValid:isValid,updatedPolicy:updatedPolicy})=>{updatePackagePolicy(updatedPolicy),setFormState(prevState=>"VALID"!==prevState||isValid?prevState:"INVALID")},[updatePackagePolicy]),cancelUrl=Object(external_kbnSharedDeps_React_.useMemo)(()=>packageInfo&&policyId?"package-edit"===from?getHref("integration_details_policies",{pkgkey:Object(pkg_key_from_package_info.a)(packageInfo)}):getHref("policy_details",{policyId:policyId}):"/",[from,getHref,packageInfo,policyId]),successRedirectPath=Object(external_kbnSharedDeps_React_.useMemo)(()=>packageInfo&&policyId?"package-edit"===from?getPath("integration_details_policies",{pkgkey:Object(pkg_key_from_package_info.a)(packageInfo)}):getPath("policy_details",{policyId:policyId}):"/",[from,getPath,packageInfo,policyId]),[formState,setFormState]=Object(external_kbnSharedDeps_React_.useState)("INVALID"),onSubmit=async()=>{if("VALID"===formState&&hasErrors)return void setFormState("INVALID");if(0!==agentCount&&"CONFIRM"!==formState)return void setFormState("CONFIRM");const{error:error}=await(async()=>{setFormState("LOADING");const result=await Object(hooks.I)(packagePolicyId,packagePolicy);return setFormState("SUBMITTED"),result})();error?(409===error.statusCode?notifications.toasts.addError(error,{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.editPackagePolicy.failedNotificationTitle",{defaultMessage:"Error updating '{packagePolicyName}'",values:{packagePolicyName:packagePolicy.name}}),toastMessage:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.editPackagePolicy.failedConflictNotificationMessage",{defaultMessage:"Data is out of date. Refresh the page to get the latest policy."})}):notifications.toasts.addError(error,{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.editPackagePolicy.failedNotificationTitle",{defaultMessage:"Error updating '{packagePolicyName}'",values:{packagePolicyName:packagePolicy.name}})}),setFormState("VALID")):(history.push(successRedirectPath),notifications.toasts.addSuccess({title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.editPackagePolicy.updatedNotificationTitle",{defaultMessage:"Successfully updated '{packagePolicyName}'",values:{packagePolicyName:packagePolicy.name}}),"data-test-subj":"policyUpdateSuccessToast",text:agentCount&&agentPolicy?external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.editPackagePolicy.updatedNotificationMessage",{defaultMessage:"Fleet will deploy updates to all agents that use the '{agentPolicyName}' policy",values:{agentPolicyName:agentPolicy.name}}):void 0}))},layoutProps={from:from,cancelUrl:cancelUrl,agentPolicy:agentPolicy,packageInfo:packageInfo},ExtensionView=useUIExtension(null!==(_packagePolicy$packag=null===(_packagePolicy$packag2=packagePolicy.package)||void 0===_packagePolicy$packag2?void 0:_packagePolicy$packag2.name)&&void 0!==_packagePolicy$packag?_packagePolicy$packag:"","package-policy-edit"),configurePackage=Object(external_kbnSharedDeps_React_.useMemo)(()=>{var _packagePolicy$packag3;return agentPolicy&&packageInfo?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(StepDefinePackagePolicy,{agentPolicy:agentPolicy,packageInfo:packageInfo,packagePolicy:packagePolicy,updatePackagePolicy:updatePackagePolicy,validationResults:validationResults}),!ExtensionView&&external_kbnSharedDeps_React_default.a.createElement(StepConfigurePackagePolicy,{from:"edit",packageInfo:packageInfo,packagePolicy:packagePolicy,packagePolicyId:packagePolicyId,updatePackagePolicy:updatePackagePolicy,validationResults:validationResults,submitAttempted:"INVALID"===formState}),ExtensionView&&packagePolicy.policy_id&&(null===(_packagePolicy$packag3=packagePolicy.package)||void 0===_packagePolicy$packag3?void 0:_packagePolicy$packag3.name)&&originalPackagePolicy&&external_kbnSharedDeps_React_default.a.createElement(ExtensionWrapper,null,external_kbnSharedDeps_React_default.a.createElement(ExtensionView,{policy:originalPackagePolicy,newPolicy:packagePolicy,onChange:handleExtensionViewOnChange}))):null},[agentPolicy,packageInfo,packagePolicy,updatePackagePolicy,validationResults,packagePolicyId,formState,originalPackagePolicy,ExtensionView,handleExtensionViewOnChange]);return external_kbnSharedDeps_React_default.a.createElement(CreatePackagePolicyPageLayout,edit_package_policy_page_extends({},layoutProps,{"data-test-subj":"editPackagePolicy"}),isLoadingData?external_kbnSharedDeps_React_default.a.createElement(Loading,null):!loadingError&&agentPolicy&&packageInfo?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,"package"===from||"package-edit"===from?external_kbnSharedDeps_React_default.a.createElement(IntegrationsBreadcrumb,{pkgkey:Object(pkg_key_from_package_info.a)(packageInfo),pkgTitle:packageInfo.title,policyName:packagePolicy.name}):external_kbnSharedDeps_React_default.a.createElement(PoliciesBreadcrumb,{policyName:agentPolicy.name,policyId:policyId}),"CONFIRM"===formState&&external_kbnSharedDeps_React_default.a.createElement(ConfirmDeployAgentPolicyModal,{agentCount:agentCount,agentPolicy:agentPolicy,onConfirm:onSubmit,onCancel:()=>setFormState("VALID")}),configurePackage,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBottomBar,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},agentPolicy&&packageInfo&&"INVALID"===formState?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.createPackagePolicy.errorOnSaveText",defaultMessage:"Your integration policy has errors. Please fix them before saving."}):null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s",justifyContent:"flexEnd"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{color:"ghost",href:cancelUrl},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.editPackagePolicy.cancelButton",defaultMessage:"Cancel"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{onClick:onSubmit,isLoading:"LOADING"===formState,disabled:"VALID"!==formState,iconType:"save",color:"primary",fill:!0,"data-test-subj":"saveIntegration"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.editPackagePolicy.saveButton",defaultMessage:"Save integration"})))))))):external_kbnSharedDeps_React_default.a.createElement(error_Error,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.editPackagePolicy.errorLoadingDataTitle",defaultMessage:"Error loading data"}),error:loadingError||external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.editPackagePolicy.errorLoadingDataMessage",{defaultMessage:"There was an error loading this integration information"})}))}),PoliciesBreadcrumb=({policyName:policyName,policyId:policyId})=>(Object(hooks.J)("edit_integration",{policyName:policyName,policyId:policyId}),null),IntegrationsBreadcrumb=Object(external_kbnSharedDeps_React_.memo)(({pkgTitle:pkgTitle,policyName:policyName,pkgkey:pkgkey})=>(Object(hooks.J)("integration_policy_edit",{policyName:policyName,pkgTitle:pkgTitle,pkgkey:pkgkey}),null)),Policy=Object(external_kbnSharedDeps_React_.memo)(()=>{const{params:{packagePolicyId:packagePolicyId}}=Object(external_kbnSharedDeps_ReactRouterDom_.useRouteMatch)();return external_kbnSharedDeps_React_default.a.createElement(EditPackagePolicyForm,{packagePolicyId:packagePolicyId,from:"package-edit"})}),EPMApp=()=>(Object(hooks.J)("integrations"),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Switch,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:constants.j.add_integration_to_policy},external_kbnSharedDeps_React_default.a.createElement(CreatePackagePolicyPage,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:constants.j.integration_policy_edit},external_kbnSharedDeps_React_default.a.createElement(Policy,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:constants.j.integration_details},external_kbnSharedDeps_React_default.a.createElement(Detail,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:constants.j.integrations},external_kbnSharedDeps_React_default.a.createElement(EPMHomePage,null)))),AgentPolicyListPageLayout=({children:children})=>external_kbnSharedDeps_React_default.a.createElement(WithHeaderLayout,{leftColumn:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"column",gutterSize:"m"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement("h1",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentPolicyList.pageTitle",defaultMessage:"Agent policies"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{color:"subdued"},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentPolicyList.pageSubtitle",defaultMessage:"Use agent policies to manage your agents and the data they collect."})))))},children),AgentPolicyListPage=()=>{var _urlParams$kuery,_agentPolicyData$tota;Object(hooks.J)("policies_list");const{getPath:getPath}=Object(hooks.ib)(),hasWriteCapabilites=Object(hooks.K)().write,{agents:{enabled:isFleetEnabled}}=Object(hooks.M)(),{urlParams:urlParams,toUrlParams:toUrlParams}=Object(hooks.qb)(),[search,setSearch]=Object(external_kbnSharedDeps_React_.useState)(Array.isArray(urlParams.kuery)?urlParams.kuery[urlParams.kuery.length-1]:null!==(_urlParams$kuery=urlParams.kuery)&&void 0!==_urlParams$kuery?_urlParams$kuery:""),{pagination:pagination,pageSizeOptions:pageSizeOptions,setPagination:setPagination}=Object(hooks.kb)(),{sorting:sorting,setSorting:setSorting}=Object(hooks.mb)({field:"updated_at",direction:"desc"}),history=Object(external_kbnSharedDeps_ReactRouterDom_.useHistory)(),isCreateAgentPolicyFlyoutOpen="create"in urlParams,setIsCreateAgentPolicyFlyoutOpen=Object(external_kbnSharedDeps_React_.useCallback)(isOpen=>{if(isOpen!==isCreateAgentPolicyFlyoutOpen)if(isOpen)history.push(`${getPath("policies_list")}?${toUrlParams({...urlParams,create:null})}`);else{const{create:create,...params}=urlParams;history.push(`${getPath("policies_list")}?${toUrlParams(params)}`)}},[getPath,history,isCreateAgentPolicyFlyoutOpen,toUrlParams,urlParams]),{isLoading:isLoading,data:agentPolicyData,resendRequest:resendRequest}=Object(hooks.O)({page:pagination.currentPage,perPage:pagination.pageSize,sortField:null==sorting?void 0:sorting.field,sortOrder:null==sorting?void 0:sorting.direction,kuery:search}),columns=Object(external_kbnSharedDeps_React_.useMemo)(()=>{const cols=[{field:"name",sortable:!0,name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentPolicyList.nameColumnTitle",{defaultMessage:"Name"}),width:"20%",render:(name,agentPolicy)=>external_kbnSharedDeps_React_default.a.createElement(AgentPolicySummaryLine,{policy:agentPolicy})},{field:"description",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentPolicyList.descriptionColumnTitle",{defaultMessage:"Description"}),width:"35%",render:value=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTextColor,{color:"subdued",className:"eui-textTruncate",title:value},value)},{field:"updated_at",sortable:!0,name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentPolicyList.updatedOnColumnTitle",{defaultMessage:"Last updated on"}),render:date=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedDate,{value:date,year:"numeric",month:"short",day:"2-digit"})},{field:"agents",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentPolicyList.agentsColumnTitle",{defaultMessage:"Agents"}),dataType:"number",render:(agents,agentPolicy)=>external_kbnSharedDeps_React_default.a.createElement(LinkedAgentCount,{count:agents,agentPolicyId:agentPolicy.id})},{field:"package_policies",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentPolicyList.packagePoliciesCountColumnTitle",{defaultMessage:"Integrations"}),dataType:"number",render:packagePolicies=>packagePolicies?packagePolicies.length:0},{name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentPolicyList.actionsColumnTitle",{defaultMessage:"Actions"}),actions:[{render:agentPolicy=>external_kbnSharedDeps_React_default.a.createElement(AgentPolicyActionMenu,{agentPolicy:agentPolicy,onCopySuccess:()=>resendRequest()})}]}];return isFleetEnabled?cols:cols.filter(col=>!("field"in col)||"agents"!==col.field)},[isFleetEnabled,resendRequest]),createAgentPolicyButton=Object(external_kbnSharedDeps_React_.useMemo)(()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{fill:!0,iconType:"plusInCircle",isDisabled:!hasWriteCapabilites,onClick:()=>setIsCreateAgentPolicyFlyoutOpen(!0)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentPolicyList.addButton",defaultMessage:"Create agent policy"})),[hasWriteCapabilites,setIsCreateAgentPolicyFlyoutOpen]),emptyPrompt=Object(external_kbnSharedDeps_React_.useMemo)(()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiEmptyPrompt,{title:external_kbnSharedDeps_React_default.a.createElement("h2",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentPolicyList.noAgentPoliciesPrompt",defaultMessage:"No agent policies"})),actions:createAgentPolicyButton}),[createAgentPolicyButton]);return external_kbnSharedDeps_React_default.a.createElement(AgentPolicyListPageLayout,null,isCreateAgentPolicyFlyoutOpen?external_kbnSharedDeps_React_default.a.createElement(CreateAgentPolicyFlyout,{onClose:()=>{setIsCreateAgentPolicyFlyoutOpen(!1),resendRequest()}}):null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",gutterSize:"m"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:4},external_kbnSharedDeps_React_default.a.createElement(SearchBar,{value:search,onChange:newSearch=>{setPagination({...pagination,currentPage:1}),setSearch(newSearch)},fieldPrefix:constants.c})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{color:"primary",iconType:"refresh",onClick:()=>resendRequest()},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentPolicyList.reloadAgentPoliciesButtonText",defaultMessage:"Reload"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},createAgentPolicyButton)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBasicTable,{loading:isLoading,hasActions:!0,noItemsMessage:isLoading?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentPolicyList.loadingAgentPoliciesMessage",defaultMessage:"Loading agent policiesâ¦"}):search.trim()||0!==(null!==(_agentPolicyData$tota=null==agentPolicyData?void 0:agentPolicyData.total)&&void 0!==_agentPolicyData$tota?_agentPolicyData$tota:0)?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentPolicyList.noFilteredAgentPoliciesPrompt",defaultMessage:"No agent policies found. {clearFiltersLink}",values:{clearFiltersLink:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{onClick:()=>setSearch("")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentPolicyList.clearFiltersLinkText",defaultMessage:"Clear filters"}))}}):emptyPrompt,items:agentPolicyData?agentPolicyData.items:[],itemId:"id",columns:columns,isSelectable:!1,pagination:{pageIndex:pagination.currentPage-1,pageSize:pagination.pageSize,totalItemCount:agentPolicyData?agentPolicyData.total:0,pageSizeOptions:pageSizeOptions},sorting:{sort:sorting},onChange:criteria=>{const newPagination={...pagination,currentPage:criteria.page.index+1,pageSize:criteria.page.size};setPagination(newPagination),setSorting(criteria.sort)}}))};const AgentStatusRefreshContext=external_kbnSharedDeps_React_default.a.createContext({refresh:()=>{}});const AgentPolicyRefreshContext=external_kbnSharedDeps_React_default.a.createContext({refresh:()=>{}});function useAgentPolicyRefresh(){return external_kbnSharedDeps_React_default.a.useContext(AgentPolicyRefreshContext).refresh}function package_policies_table_extends(){return(package_policies_table_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const stringSortAscending=(a,b)=>a.localeCompare(b),toFilterOption=value=>({name:value,value:value}),PackagePoliciesTable=({packagePolicies:originalPackagePolicies,agentPolicy:agentPolicy,...rest})=>{const{getHref:getHref}=Object(hooks.ib)(),hasWriteCapabilities=Object(hooks.K)().write,refreshAgentPolicy=useAgentPolicyRefresh(),[packagePolicies,namespaces]=Object(external_kbnSharedDeps_React_.useMemo)(()=>{const namespacesValues=[],mappedPackagePolicies=originalPackagePolicies.map(packagePolicy=>{var _packagePolicy$packag,_packagePolicy$packag2,_packagePolicy$packag3,_packagePolicy$packag4,_packagePolicy$packag5,_packagePolicy$packag6;return packagePolicy.namespace&&!namespacesValues.includes(packagePolicy.namespace)&&namespacesValues.push(packagePolicy.namespace),{...packagePolicy,packageName:null!==(_packagePolicy$packag=null===(_packagePolicy$packag2=packagePolicy.package)||void 0===_packagePolicy$packag2?void 0:_packagePolicy$packag2.name)&&void 0!==_packagePolicy$packag?_packagePolicy$packag:"",packageTitle:null!==(_packagePolicy$packag3=null===(_packagePolicy$packag4=packagePolicy.package)||void 0===_packagePolicy$packag4?void 0:_packagePolicy$packag4.title)&&void 0!==_packagePolicy$packag3?_packagePolicy$packag3:"",packageVersion:null!==(_packagePolicy$packag5=null===(_packagePolicy$packag6=packagePolicy.package)||void 0===_packagePolicy$packag6?void 0:_packagePolicy$packag6.version)&&void 0!==_packagePolicy$packag5?_packagePolicy$packag5:""}});return namespacesValues.sort(stringSortAscending),[].sort(stringSortAscending),[mappedPackagePolicies,namespacesValues.map(toFilterOption)]},[originalPackagePolicies]),columns=Object(external_kbnSharedDeps_React_.useMemo)(()=>[{field:"name",sortable:!0,name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.policyDetails.packagePoliciesTable.nameColumnTitle",{defaultMessage:"Name"}),render:value=>external_kbnSharedDeps_React_default.a.createElement("span",{className:"eui-textTruncate",title:value},value)},{field:"description",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.policyDetails.packagePoliciesTable.descriptionColumnTitle",{defaultMessage:"Description"}),render:value=>external_kbnSharedDeps_React_default.a.createElement("span",{className:"eui-textTruncate",title:value},value)},{field:"packageTitle",sortable:!0,name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.policyDetails.packagePoliciesTable.packageNameColumnTitle",{defaultMessage:"Integration"}),render:(packageTitle,packagePolicy)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},packagePolicy.package&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(PackageIcon,{packageName:packagePolicy.package.name,version:packagePolicy.package.version,size:"m",tryApi:!0})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},packageTitle),packagePolicy.package&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{color:"subdued",size:"xs",className:"eui-textNoWrap"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.policyDetails.packagePoliciesTable.packageVersion",defaultMessage:"v{version}",values:{version:packagePolicy.package.version}}))))},{field:"namespace",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.policyDetails.packagePoliciesTable.namespaceColumnTitle",{defaultMessage:"Namespace"}),render:namespace=>namespace?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBadge,{color:"hollow"},namespace):""},{name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.policyDetails.packagePoliciesTable.actionsColumnTitle",{defaultMessage:"Actions"}),actions:[{render:packagePolicy=>{const menuItems=[external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenuItem,{disabled:!hasWriteCapabilities,icon:"pencil",href:getHref("edit_integration",{policyId:agentPolicy.id,packagePolicyId:packagePolicy.id}),key:"packagePolicyEdit"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.policyDetails.packagePoliciesTable.editActionTitle",defaultMessage:"Edit integration"}))];return agentPolicy.is_managed||menuItems.push(external_kbnSharedDeps_React_default.a.createElement(PackagePolicyDeleteProvider,{agentPolicy:agentPolicy,key:"packagePolicyDelete"},deletePackagePoliciesPrompt=>external_kbnSharedDeps_React_default.a.createElement(DangerEuiContextMenuItem,{disabled:!hasWriteCapabilities,icon:"trash",onClick:()=>{deletePackagePoliciesPrompt([packagePolicy.id],refreshAgentPolicy)}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.policyDetails.packagePoliciesTable.deleteActionTitle",defaultMessage:"Delete integration"})))),external_kbnSharedDeps_React_default.a.createElement(ContextMenuActions,{items:menuItems})}}]}],[agentPolicy,getHref,hasWriteCapabilities,refreshAgentPolicy]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiInMemoryTable,package_policies_table_extends({itemId:"id",items:packagePolicies,columns:columns,sorting:{sort:{field:"name",direction:"asc"}}},rest,{search:{toolsRight:agentPolicy.is_managed?[]:[external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{key:"addPackagePolicyButton",isDisabled:!hasWriteCapabilities,iconType:"plusInCircle",href:getHref("add_integration_from_policy",{policyId:agentPolicy.id})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.policyDetails.addPackagePolicyButtonText",defaultMessage:"Add integration"}))],box:{incremental:!0,schema:!0},filters:[{type:"field_value_selection",field:"namespace",name:"Namespace",options:namespaces,multiSelect:"or",operator:"exact"}]},isSelectable:!1}))},NoPackagePolicies=Object(external_kbnSharedDeps_React_.memo)(({policyId:policyId})=>{const{getHref:getHref}=Object(hooks.ib)(),hasWriteCapabilities=Object(hooks.K)().write;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiEmptyPrompt,{iconType:"plusInCircle",title:external_kbnSharedDeps_React_default.a.createElement("h3",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.policyDetailsPackagePolicies.createFirstTitle",defaultMessage:"Add your first integration"})),body:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.policyDetailsPackagePolicies.createFirstMessage",defaultMessage:"This policy does not have any integrations yet."}),actions:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{isDisabled:!hasWriteCapabilities,fill:!0,href:getHref("add_integration_from_policy",{policyId:policyId})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.policyDetailsPackagePolicies.createFirstButtonText",defaultMessage:"Add integration"}))})}),PackagePoliciesView=Object(external_kbnSharedDeps_React_.memo)(({agentPolicy:agentPolicy})=>0===agentPolicy.package_policies.length?external_kbnSharedDeps_React_default.a.createElement(NoPackagePolicies,{policyId:agentPolicy.id}):external_kbnSharedDeps_React_default.a.createElement(PackagePoliciesTable,{agentPolicy:agentPolicy,packagePolicies:agentPolicy.package_policies||[]})),FormWrapper=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"FormWrapper",componentId:"sc-1b9jodr-0"})(["max-width:800px;margin-right:auto;margin-left:auto;"]),SettingsView=Object(external_kbnSharedDeps_React_.memo)(({agentPolicy:originalAgentPolicy})=>{const{notifications:notifications}=Object(hooks.nb)(),{agents:{enabled:isFleetEnabled}}=Object(hooks.M)(),history=Object(external_kbnSharedDeps_ReactRouterDom_.useHistory)(),{getPath:getPath}=Object(hooks.ib)(),hasWriteCapabilites=Object(hooks.K)().write,refreshAgentPolicy=useAgentPolicyRefresh(),[agentPolicy,setAgentPolicy]=Object(external_kbnSharedDeps_React_.useState)({...originalAgentPolicy}),[isLoading,setIsLoading]=Object(external_kbnSharedDeps_React_.useState)(!1),[hasChanges,setHasChanges]=Object(external_kbnSharedDeps_React_.useState)(!1),[agentCount,setAgentCount]=Object(external_kbnSharedDeps_React_.useState)(0),[withSysMonitoring,setWithSysMonitoring]=Object(external_kbnSharedDeps_React_.useState)(!0),validation=agentPolicyFormValidation(agentPolicy),submitUpdateAgentPolicy=async()=>{setIsLoading(!0);try{const{name:name,description:description,namespace:namespace,monitoring_enabled:monitoring_enabled}=agentPolicy,{data:data,error:error}=await Object(hooks.H)(agentPolicy.id,{name:name,description:description,namespace:namespace,monitoring_enabled:monitoring_enabled});data?(notifications.toasts.addSuccess(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.editAgentPolicy.successNotificationTitle",{defaultMessage:"Successfully updated '{name}' settings",values:{name:agentPolicy.name}})),refreshAgentPolicy(),setHasChanges(!1)):notifications.toasts.addDanger(error?error.message:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.editAgentPolicy.errorNotificationTitle",{defaultMessage:"Unable to update agent policy"}))}catch(e){notifications.toasts.addDanger(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.editAgentPolicy.errorNotificationTitle",{defaultMessage:"Unable to update agent policy"}))}setIsLoading(!1)};return external_kbnSharedDeps_React_default.a.createElement(FormWrapper,null,agentCount?external_kbnSharedDeps_React_default.a.createElement(ConfirmDeployAgentPolicyModal,{agentCount:agentCount,agentPolicy:agentPolicy,onConfirm:()=>{setAgentCount(0),submitUpdateAgentPolicy()},onCancel:()=>{setAgentCount(0),setIsLoading(!1)}}):null,external_kbnSharedDeps_React_default.a.createElement(AgentPolicyForm,{agentPolicy:agentPolicy,updateAgentPolicy:updatedFields=>{setAgentPolicy({...agentPolicy,...updatedFields}),setHasChanges(!0)},withSysMonitoring:withSysMonitoring,updateSysMonitoring:newValue=>setWithSysMonitoring(newValue),validation:validation,isEditing:!0,onDelete:()=>{history.push(getPath("policies_list"))}}),hasChanges?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBottomBar,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.editAgentPolicy.unsavedChangesText",defaultMessage:"You have unsaved changes"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s",justifyContent:"flexEnd"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{color:"ghost",onClick:()=>{setAgentPolicy({...originalAgentPolicy}),setHasChanges(!1)}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.editAgentPolicy.cancelButtonText",defaultMessage:"Cancel"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{onClick:async()=>{if(isFleetEnabled){setIsLoading(!0);const{data:data}=await Object(hooks.l)({policyId:agentPolicy.id});null!=data&&data.results.total?setAgentCount(data.results.total):await submitUpdateAgentPolicy()}else await submitUpdateAgentPolicy()},isLoading:isLoading,isDisabled:!hasWriteCapabilites||isLoading||Object.keys(validation).length>0,iconType:"save",color:"primary",fill:!0},isLoading?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.editAgentPolicy.savingButtonText",defaultMessage:"Savingâ¦"}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.editAgentPolicy.saveButtonText",defaultMessage:"Save changes"}))))))):null)}),details_page_Divider=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"Divider",componentId:"kgzhx1-0"})(["width:0;height:100%;border-left:",";"],props=>props.theme.eui.euiBorderThin),AgentPolicyDetailsPage=()=>{var _agentStatusRequest$d;const{params:{policyId:policyId,tabId:tabId=""}}=Object(external_kbnSharedDeps_ReactRouterDom_.useRouteMatch)(),history=Object(external_kbnSharedDeps_ReactRouterDom_.useHistory)(),{getHref:getHref,getPath:getPath}=Object(hooks.ib)(),agentPolicyRequest=Object(hooks.V)(policyId),agentPolicy=agentPolicyRequest.data?agentPolicyRequest.data.item:null,{isLoading:isLoading,error:error,sendRequest:refreshAgentPolicy}=agentPolicyRequest,[redirectToAgentPolicyList]=Object(external_kbnSharedDeps_React_.useState)(!1),agentStatusRequest=function(policyId,options){const agentStatusRequest=Object(hooks.lb)({path:services.c.getStatusPath(),query:{policyId:policyId},method:"get",...options});return{isLoading:agentStatusRequest.isLoading,data:agentStatusRequest.data,error:agentStatusRequest.error,refreshAgentStatus:()=>agentStatusRequest.resendRequest}}(policyId),{refreshAgentStatus:refreshAgentStatus}=agentStatusRequest,{application:{navigateToApp:navigateToApp}}=Object(hooks.nb)(),routeState=useIntraAppState(),agentStatus=null===(_agentStatusRequest$d=agentStatusRequest.data)||void 0===_agentStatusRequest$d?void 0:_agentStatusRequest$d.results,openEnrollmentFlyoutOpenByDefault="true"===new URLSearchParams(Object(external_kbnSharedDeps_ReactRouterDom_.useLocation)().search).get("openEnrollmentFlyout"),{isReady:isFleetReady}=Object(hooks.N)(),headerLeftContent=Object(external_kbnSharedDeps_React_.useMemo)(()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"column",gutterSize:"s",alignItems:"flexStart"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{iconType:"arrowLeft",href:getHref("policies_list"),flush:"left",size:"xs"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.policyDetails.viewAgentListTitle",defaultMessage:"View all agent policies"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,isLoading?external_kbnSharedDeps_React_default.a.createElement(Loading,null):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",wrap:!0,responsive:!1,gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,null,external_kbnSharedDeps_React_default.a.createElement("h1",null,agentPolicy&&agentPolicy.name||external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.policyDetails.policyDetailsTitle",defaultMessage:"Policy '{id}'",values:{id:policyId}})))),(null==agentPolicy?void 0:agentPolicy.is_managed)&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIconTip,{title:"Hosted agent policy",content:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.policyDetails.policyDetailsHostedPolicyTooltip",{defaultMessage:"This policy is managed outside of Fleet. Most actions related to this policy are unavailable."}),type:"lock",size:"l",color:"subdued"})))),agentPolicy&&agentPolicy.description?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{color:"subdued",size:"s",className:"eui-textBreakWord"},agentPolicy.description)):null),[getHref,isLoading,agentPolicy,policyId]),headerRightContent=Object(external_kbnSharedDeps_React_.useMemo)(()=>{var _agentPolicy$revision;return agentPolicy?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"flexEnd",direction:"row"},[{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.policyDetails.summary.revision",{defaultMessage:"Revision"}),content:null!==(_agentPolicy$revision=null==agentPolicy?void 0:agentPolicy.revision)&&void 0!==_agentPolicy$revision?_agentPolicy$revision:0},{isDivider:!0},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.policyDetails.summary.integrations",{defaultMessage:"Integrations"}),content:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiI18nNumber,{value:agentPolicy&&agentPolicy.package_policies&&agentPolicy.package_policies.length||0})},{isDivider:!0},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.policyDetails.summary.usedBy",{defaultMessage:"Used by"}),content:external_kbnSharedDeps_React_default.a.createElement(LinkedAgentCount,{count:agentStatus&&agentStatus.total||0,agentPolicyId:agentPolicy&&agentPolicy.id||""})},{isDivider:!0},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.policyDetails.summary.lastUpdated",{defaultMessage:"Last updated on"}),content:agentPolicy&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedDate,{value:null==agentPolicy?void 0:agentPolicy.updated_at,year:"numeric",month:"short",day:"2-digit"})||""},{isDivider:!0},{content:agentPolicy&&external_kbnSharedDeps_React_default.a.createElement(AgentPolicyActionMenu,{agentPolicy:agentPolicy,fullButton:!0,onCopySuccess:newAgentPolicy=>{history.push(getPath("policy_details",{policyId:newAgentPolicy.id}))},enrollmentFlyoutOpenByDefault:openEnrollmentFlyoutOpenByDefault,onCancelEnrollment:routeState&&routeState.onDoneNavigateTo&&isFleetReady?()=>navigateToApp(routeState.onDoneNavigateTo[0],routeState.onDoneNavigateTo[1]):void 0})}].map((item,index)=>{var _item$isDivider;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,key:index},null!==(_item$isDivider=item.isDivider)&&void 0!==_item$isDivider&&_item$isDivider?external_kbnSharedDeps_React_default.a.createElement(details_page_Divider,null):item.label?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionList,{compressed:!0,textStyle:"reverse",style:{textAlign:"right"}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionListTitle,{className:"eui-textNoWrap"},item.label),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionListDescription,{className:"eui-textNoWrap"},item.content)):item.content)})):void 0},[agentPolicy,policyId,agentStatus]),headerTabs=Object(external_kbnSharedDeps_React_.useMemo)(()=>[{id:"integrations",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.policyDetails.subTabs.packagePoliciesTabText",{defaultMessage:"Integrations"}),href:getHref("policy_details",{policyId:policyId,tabId:"integrations"}),isSelected:""===tabId||"integrations"===tabId},{id:"settings",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.policyDetails.subTabs.settingsTabText",{defaultMessage:"Settings"}),href:getHref("policy_details",{policyId:policyId,tabId:"settings"}),isSelected:"settings"===tabId}],[getHref,policyId,tabId]),content=Object(external_kbnSharedDeps_React_.useMemo)(()=>redirectToAgentPolicyList?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Redirect,{to:"/"}):isLoading?external_kbnSharedDeps_React_default.a.createElement(Loading,null):error?external_kbnSharedDeps_React_default.a.createElement(error_Error,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.policyDetails.unexceptedErrorTitle",defaultMessage:"An error happened while loading the agent policy"}),error:error}):agentPolicy?external_kbnSharedDeps_React_default.a.createElement(AgentPolicyDetailsContent,{agentPolicy:agentPolicy}):external_kbnSharedDeps_React_default.a.createElement(error_Error,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.policyDetails.unexceptedErrorTitle",defaultMessage:"An error happened while loading the agent policy"}),error:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.policyDetails.policyNotFoundErrorTitle",{defaultMessage:"Policy '{id}' not found",values:{id:policyId}})}),[agentPolicy,policyId,error,isLoading,redirectToAgentPolicyList]);return external_kbnSharedDeps_React_default.a.createElement(AgentPolicyRefreshContext.Provider,{value:{refresh:refreshAgentPolicy}},external_kbnSharedDeps_React_default.a.createElement(AgentStatusRefreshContext.Provider,{value:{refresh:refreshAgentStatus}},external_kbnSharedDeps_React_default.a.createElement(WithHeaderLayout,{leftColumn:headerLeftContent,rightColumn:headerRightContent,tabs:headerTabs},content)))},AgentPolicyDetailsContent=({agentPolicy:agentPolicy})=>(Object(hooks.J)("policy_details",{policyName:agentPolicy.name}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Switch,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:constants.j.policy_details_settings,render:()=>external_kbnSharedDeps_React_default.a.createElement(SettingsView,{agentPolicy:agentPolicy})}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:constants.j.policy_details,render:()=>external_kbnSharedDeps_React_default.a.createElement(PackagePoliciesView,{agentPolicy:agentPolicy})}))),AgentPolicyApp=()=>(Object(hooks.J)("policies"),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.HashRouter,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Switch,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:constants.j.edit_integration},external_kbnSharedDeps_React_default.a.createElement(EditPackagePolicyPage,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:constants.j.add_integration_from_policy},external_kbnSharedDeps_React_default.a.createElement(CreatePackagePolicyPage,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:constants.j.policy_details},external_kbnSharedDeps_React_default.a.createElement(AgentPolicyDetailsPage,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:constants.j.policies_list},external_kbnSharedDeps_React_default.a.createElement(AgentPolicyListPage,null))))),DataStreamRowActions=Object(external_kbnSharedDeps_React_.memo)(({datastream:datastream})=>{const{dashboards:dashboards}=datastream,panels=[],actionNameSingular=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.dataStreamList.viewDashboardActionText",defaultMessage:"View dashboard"}),actionNamePlural=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.dataStreamList.viewDashboardsActionText",defaultMessage:"View dashboards"}),panelTitle=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.dataStreamList.viewDashboardsPanelTitle",{defaultMessage:"View dashboards"});return dashboards&&0!==dashboards.length?1===dashboards.length?panels.push({id:0,items:[{icon:"dashboardApp",href:Object(hooks.fb)("/dashboard/"+(dashboards[0].id||"")),name:actionNameSingular}]}):(panels.push({id:0,items:[{icon:"dashboardApp",panel:1,name:actionNamePlural}]}),panels.push({id:1,title:panelTitle,items:dashboards.map(dashboard=>({icon:"dashboardApp",href:Object(hooks.fb)("/dashboard/"+(dashboard.id||"")),name:dashboard.title}))})):panels.push({id:0,items:[{icon:"dashboardApp",disabled:!0,name:actionNameSingular}]}),external_kbnSharedDeps_React_default.a.createElement(ContextMenuActions,{panels:panels})}),DataStreamListPageLayout=({children:children})=>external_kbnSharedDeps_React_default.a.createElement(WithHeaderLayout,{leftColumn:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"column",gutterSize:"m"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement("h1",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.dataStreamList.pageTitle",defaultMessage:"Data streams"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{color:"subdued"},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.dataStreamList.pageSubtitle",defaultMessage:"Manage the data created by your agents."})))))},children),DataStreamListPage=()=>{Object(hooks.J)("data_streams");const{data:{fieldFormats:fieldFormats}}=Object(hooks.nb)(),{pagination:pagination,pageSizeOptions:pageSizeOptions}=Object(hooks.kb)(),{isLoading:isLoading,data:dataStreamsData,resendRequest:resendRequest}=Object(hooks.R)(),columns=Object(external_kbnSharedDeps_React_.useMemo)(()=>[{field:"dataset",sortable:!0,width:"25%",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.dataStreamList.datasetColumnTitle",{defaultMessage:"Dataset"})},{field:"type",sortable:!0,name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.dataStreamList.typeColumnTitle",{defaultMessage:"Type"})},{field:"namespace",sortable:!0,name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.dataStreamList.namespaceColumnTitle",{defaultMessage:"Namespace"}),render:namespace=>namespace?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBadge,{color:"hollow"},namespace):""},{field:"package",sortable:!0,name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.dataStreamList.integrationColumnTitle",{defaultMessage:"Integration"}),render:(pkg,datastream)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},datastream.package_version&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(PackageIcon,{packageName:pkg,version:datastream.package_version,size:"m",tryApi:!0})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},pkg))},{field:"last_activity_ms",sortable:!0,width:"25%",dataType:"date",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.dataStreamList.lastActivityColumnTitle",{defaultMessage:"Last activity"}),render:date=>{try{return fieldFormats.getInstance("date").convert(date)}catch(e){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedDate,{value:date,year:"numeric",month:"short",day:"2-digit"})}}},{field:"size_in_bytes",sortable:!0,name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.dataStreamList.sizeColumnTitle",{defaultMessage:"Size"}),render:size=>{try{return fieldFormats.getInstance("bytes").convert(size)}catch(e){return size+"b"}}},{name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.dataStreamList.actionsColumnTitle",{defaultMessage:"Actions"}),actions:[{render:datastream=>external_kbnSharedDeps_React_default.a.createElement(DataStreamRowActions,{datastream:datastream})}]}],[fieldFormats]),emptyPrompt=Object(external_kbnSharedDeps_React_.useMemo)(()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiEmptyPrompt,{title:external_kbnSharedDeps_React_default.a.createElement("h2",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.dataStreamList.noDataStreamsPrompt",defaultMessage:"No data streams"}))}),[]),filterOptions={dataset:[],type:[],namespace:[],package:[]};if(dataStreamsData&&dataStreamsData.data_streams.length){const dataValues={dataset:[],type:[],namespace:[],package:[]};dataStreamsData.data_streams.forEach(stream=>{const{dataset:dataset,type:type,namespace:namespace,package:pkg}=stream;dataValues.dataset.includes(dataset)||dataValues.dataset.push(dataset),dataValues.type.includes(type)||dataValues.type.push(type),dataValues.namespace.includes(namespace)||dataValues.namespace.push(namespace),dataValues.package.includes(pkg)||dataValues.package.push(pkg)});for(const field in dataValues)filterOptions[field]&&(filterOptions[field]=dataValues[field].sort().map(option=>({value:option,name:option})))}return external_kbnSharedDeps_React_default.a.createElement(DataStreamListPageLayout,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiInMemoryTable,{loading:isLoading,hasActions:!0,message:isLoading?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.dataStreamList.loadingDataStreamsMessage",defaultMessage:"Loading data streamsâ¦"}):dataStreamsData&&!dataStreamsData.data_streams.length?emptyPrompt:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.dataStreamList.noFilteredDataStreamsMessage",defaultMessage:"No matching data streams found"}),items:dataStreamsData?dataStreamsData.data_streams:[],itemId:"index",columns:columns,pagination:{initialPageSize:pagination.pageSize,pageSizeOptions:pageSizeOptions},sorting:!0,search:{toolsRight:[external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{key:"reloadButton",color:"primary",iconType:"refresh",onClick:()=>resendRequest()},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.dataStreamList.reloadDataStreamsButtonText",defaultMessage:"Reload"}))],box:{placeholder:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.dataStreamList.searchPlaceholderTitle",{defaultMessage:"Filter data streams"}),incremental:!0},filters:[{type:"field_value_selection",field:"dataset",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.dataStreamList.datasetColumnTitle",{defaultMessage:"Dataset"}),multiSelect:"or",operator:"exact",options:filterOptions.dataset},{type:"field_value_selection",field:"type",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.dataStreamList.typeColumnTitle",{defaultMessage:"Type"}),multiSelect:"or",operator:"exact",options:filterOptions.type},{type:"field_value_selection",field:"namespace",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.dataStreamList.namespaceColumnTitle",{defaultMessage:"Namespace"}),multiSelect:"or",operator:"exact",options:filterOptions.namespace},{type:"field_value_selection",field:"package",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.dataStreamList.integrationColumnTitle",{defaultMessage:"Integration"}),multiSelect:"or",operator:"exact",options:filterOptions.package}]}}))},DataStreamApp=()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.HashRouter,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Switch,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:constants.j.data_streams},external_kbnSharedDeps_React_default.a.createElement(DataStreamListPage,null)))),visColors=Object(external_kbnSharedDeps_ElasticEui_.euiPaletteColorBlindBehindText)(),colorToHexMap={default:"#d3dae6",primary:visColors[1],secondary:visColors[0],accent:visColors[2],warning:visColors[5],danger:visColors[9]},AGENT_STATUSES=["healthy","unhealthy","updating","offline","inactive"];function getColorForAgentStatus(agentStatus){switch(agentStatus){case"healthy":return colorToHexMap.secondary;case"offline":case"inactive":return colorToHexMap.default;case"unhealthy":return colorToHexMap.warning;case"updating":return colorToHexMap.primary;default:throw new Error("Insuported Agent status "+agentStatus)}}const StyledEuiColorPaletteDisplay=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiColorPaletteDisplay).withConfig({displayName:"StyledEuiColorPaletteDisplay",componentId:"sc-147tmhq-0"})(["&.ingest-agent-status-bar{border:none;border-radius:0;&:after{border:none;}}"]),AgentStatusBar=({agentStatus:agentStatus})=>{const palette=Object(external_kbnSharedDeps_React_.useMemo)(()=>AGENT_STATUSES.reduce((acc,status)=>{const previousStop=acc.length>0?acc[acc.length-1].stop:0;return acc.push({stop:previousStop+(agentStatus[status]||0),color:getColorForAgentStatus(status)}),acc},[]),[agentStatus]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(StyledEuiColorPaletteDisplay,{className:"ingest-agent-status-bar",size:"s",palette:palette}))},bulk_actions_Divider=external_kbnSharedDeps_StyledComponents_default.a.div.withConfig({displayName:"Divider",componentId:"sc-1ynhme7-0"})(["width:0;height:",";border-left:",";"],props=>props.theme.eui.euiSizeL,props=>props.theme.eui.euiBorderThin),FlexItem=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexItem).withConfig({displayName:"FlexItem",componentId:"sc-1ynhme7-1"})(["height:",";"],props=>props.theme.eui.euiSizeL),Button=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty).withConfig({displayName:"Button",componentId:"sc-1ynhme7-2"})([".euiButtonEmpty__text{font-size:",";}"],props=>props.theme.eui.euiFontSizeXS),AgentBulkActions=({totalAgents:totalAgents,totalInactiveAgents:totalInactiveAgents,selectableAgents:selectableAgents,selectionMode:selectionMode,setSelectionMode:setSelectionMode,currentQuery:currentQuery,selectedAgents:selectedAgents,setSelectedAgents:setSelectedAgents,refreshAgents:refreshAgents})=>{const kibanaVersion=Object(hooks.gb)(),[isMenuOpen,setIsMenuOpen]=Object(external_kbnSharedDeps_React_.useState)(!1),closeMenu=()=>setIsMenuOpen(!1),[isReassignFlyoutOpen,setIsReassignFlyoutOpen]=Object(external_kbnSharedDeps_React_.useState)(!1),[isUnenrollModalOpen,setIsUnenrollModalOpen]=Object(external_kbnSharedDeps_React_.useState)(!1),[isUpgradeModalOpen,setIsUpgradeModalOpen]=Object(external_kbnSharedDeps_React_.useState)(!1),atLeastOneActiveAgentSelected="manual"===selectionMode?!!selectedAgents.find(agent=>agent.active):totalAgents>totalInactiveAgents,panels=[{id:0,items:[{name:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentBulkActions.reassignPolicy",defaultMessage:"Assign to new policy"}),icon:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{type:"pencil",size:"m"}),disabled:!atLeastOneActiveAgentSelected,onClick:()=>{closeMenu(),setIsReassignFlyoutOpen(!0)}},{name:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentBulkActions.unenrollAgents",defaultMessage:"Unenroll agents"}),icon:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{type:"trash",size:"m"}),disabled:!atLeastOneActiveAgentSelected,onClick:()=>{closeMenu(),setIsUnenrollModalOpen(!0)}},{name:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentBulkActions.upgradeAgents",defaultMessage:"Upgrade agents"}),icon:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{type:"refresh",size:"m"}),disabled:!atLeastOneActiveAgentSelected,onClick:()=>{closeMenu(),setIsUpgradeModalOpen(!0)}},{name:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentBulkActions.clearSelection",defaultMessage:"Clear selection"}),icon:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{type:"cross",size:"m"}),onClick:()=>{closeMenu(),setSelectionMode("manual"),setSelectedAgents([])}}]}],showSelectEverything="manual"===selectionMode&&selectedAgents.length===selectableAgents&&selectableAgents<totalAgents,totalActiveAgents=totalAgents-totalInactiveAgents,agentCount="manual"===selectionMode?selectedAgents.length:totalActiveAgents,agents="manual"===selectionMode?selectedAgents:currentQuery;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,isReassignFlyoutOpen&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPortal,null,external_kbnSharedDeps_React_default.a.createElement(AgentReassignAgentPolicyModal,{agents:agents,onClose:()=>{setIsReassignFlyoutOpen(!1),refreshAgents()}})),isUnenrollModalOpen&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPortal,null,external_kbnSharedDeps_React_default.a.createElement(AgentUnenrollAgentModal,{agents:agents,agentCount:agentCount,onClose:()=>{setIsUnenrollModalOpen(!1),refreshAgents()}})),isUpgradeModalOpen&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPortal,null,external_kbnSharedDeps_React_default.a.createElement(AgentUpgradeAgentModal,{version:kibanaVersion,agents:agents,agentCount:agentCount,onClose:()=>{setIsUpgradeModalOpen(!1),refreshAgents()}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"m",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs",color:"subdued"},totalAgents>constants.l?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentBulkActions.totalAgentsWithLimit",defaultMessage:"Showing {count} of {total} agents",values:{count:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedNumber,{value:constants.l}),total:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedNumber,{value:totalAgents})}}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentBulkActions.totalAgents",defaultMessage:"Showing {count, plural, one {# agent} other {# agents}}",values:{count:totalAgents}}))),"manual"===selectionMode&&selectedAgents.length||"query"===selectionMode&&totalAgents>0?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(FlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(bulk_actions_Divider,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopover,{id:"agentBulkActionsMenu",button:external_kbnSharedDeps_React_default.a.createElement(Button,{size:"xs",iconType:"arrowDown",iconSide:"right",flush:"left",onClick:()=>setIsMenuOpen(!0)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentBulkActions.agentsSelected",defaultMessage:"{count, plural, one {# agent} other {# agents} =all {All agents}} selected",values:{count:"manual"===selectionMode?selectedAgents.length:"all"}})),isOpen:isMenuOpen,closePopover:closeMenu,panelPaddingSize:"none",anchorPosition:"downLeft"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenu,{initialPanelId:0,panels:panels}))),showSelectEverything?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(Button,{size:"xs",iconType:"pagesSelect",iconSide:"left",flush:"left",onClick:()=>setSelectionMode("query")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentBulkActions.selectAll",defaultMessage:"Select everything on all pages"}))):null):external_kbnSharedDeps_React_default.a.createElement(FlexItem,{grow:!1})))},AgentStatusBadges=Object(external_kbnSharedDeps_React_.memo)(({agentStatus:agentStatus,showInactive:showInactive})=>{const agentStatuses=Object(external_kbnSharedDeps_React_.useMemo)(()=>AGENT_STATUSES.filter(status=>!!showInactive||"inactive"!==status),[showInactive]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"m"},agentStatuses.map(status=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{key:status,grow:!1},external_kbnSharedDeps_React_default.a.createElement(AgentStatusBadge,{status:status,count:agentStatus[status]||0}))))}),AgentStatusBadge=Object(external_kbnSharedDeps_React_.memo)(({status:status,count:count})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHealth,{color:getColorForAgentStatus(status)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},function(agentStatus){switch(agentStatus){case"healthy":return external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentStatus.healthyLabel",{defaultMessage:"Healthy"});case"offline":return external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentStatus.offlineLabel",{defaultMessage:"Offline"});case"inactive":return external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentStatus.inactiveLabel",{defaultMessage:"Inactive"});case"unhealthy":return external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentStatus.unhealthyLabel",{defaultMessage:"Unhealthy"});case"updating":return external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentStatus.updatingLabel",{defaultMessage:"Updating"});default:throw new Error("Insuported Agent status "+agentStatus)}}(status)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiNotificationBadge,{size:"s",color:"subdued"},count)))))),AgentTableHeader=({agentStatus:agentStatus,totalAgents:totalAgents,totalInactiveAgents:totalInactiveAgents,selectableAgents:selectableAgents,selectionMode:selectionMode,setSelectionMode:setSelectionMode,currentQuery:currentQuery,selectedAgents:selectedAgents,setSelectedAgents:setSelectedAgents,refreshAgents:refreshAgents,showInactive:showInactive})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(AgentBulkActions,{totalAgents:totalAgents,totalInactiveAgents:totalInactiveAgents,selectableAgents:selectableAgents,selectionMode:selectionMode,setSelectionMode:setSelectionMode,currentQuery:currentQuery,selectedAgents:selectedAgents,setSelectedAgents:setSelectedAgents,refreshAgents:refreshAgents})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},agentStatus&&external_kbnSharedDeps_React_default.a.createElement(AgentStatusBadges,{showInactive:showInactive,agentStatus:agentStatus}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),agentStatus&&external_kbnSharedDeps_React_default.a.createElement(AgentStatusBar,{agentStatus:agentStatus})),statusFilters=[{status:"healthy",label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentList.statusHealthyFilterText",{defaultMessage:"Healthy"})},{status:"unhealthy",label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentList.statusUnhealthyFilterText",{defaultMessage:"Unhealthy"})},{status:"updating",label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentList.statusUpdatingFilterText",{defaultMessage:"Updating"})},{status:"offline",label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentList.statusOfflineFilterText",{defaultMessage:"Offline"})},{status:"inactive",label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentList.statusInactiveFilterText",{defaultMessage:"Inactive"})}],SearchAndFilterBar=({agentPolicies:agentPolicies,draftKuery:draftKuery,onDraftKueryChange:onDraftKueryChange,onSubmitSearch:onSubmitSearch,selectedAgentPolicies:selectedAgentPolicies,onSelectedAgentPoliciesChange:onSelectedAgentPoliciesChange,selectedStatus:selectedStatus,onSelectedStatusChange:onSelectedStatusChange,showUpgradeable:showUpgradeable,onShowUpgradeableChange:onShowUpgradeableChange})=>{const[isAgentPoliciesFilterOpen,setIsAgentPoliciesFilterOpen]=Object(external_kbnSharedDeps_React_.useState)(!1),[isStatusFilterOpen,setIsStatutsFilterOpen]=Object(external_kbnSharedDeps_React_.useState)(!1);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:4},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:6},external_kbnSharedDeps_React_default.a.createElement(SearchBar,{value:draftKuery,onChange:(newSearch,submit)=>{onDraftKueryChange(newSearch),submit&&onSubmitSearch(newSearch)},indexPattern:constants.a})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:2},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFilterGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopover,{ownFocus:!0,button:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFilterButton,{iconType:"arrowDown",onClick:()=>setIsStatutsFilterOpen(!isStatusFilterOpen),isSelected:isStatusFilterOpen,hasActiveFilters:selectedStatus.length>0,numActiveFilters:selectedStatus.length,disabled:0===agentPolicies.length},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentList.statusFilterText",defaultMessage:"Status"})),isOpen:isStatusFilterOpen,closePopover:()=>setIsStatutsFilterOpen(!1),panelPaddingSize:"none"},external_kbnSharedDeps_React_default.a.createElement("div",{className:"euiFilterSelect__items"},statusFilters.map(({label:label,status:status},idx)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFilterSelectItem,{key:idx,checked:selectedStatus.includes(status)?"on":void 0,onClick:()=>{selectedStatus.includes(status)?onSelectedStatusChange([...selectedStatus.filter(s=>s!==status)]):onSelectedStatusChange([...selectedStatus,status])}},label)))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopover,{ownFocus:!0,button:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFilterButton,{iconType:"arrowDown",onClick:()=>setIsAgentPoliciesFilterOpen(!isAgentPoliciesFilterOpen),isSelected:isAgentPoliciesFilterOpen,hasActiveFilters:selectedAgentPolicies.length>0,numActiveFilters:selectedAgentPolicies.length,numFilters:agentPolicies.length,disabled:0===agentPolicies.length},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentList.policyFilterText",defaultMessage:"Agent policy"})),isOpen:isAgentPoliciesFilterOpen,closePopover:()=>setIsAgentPoliciesFilterOpen(!1),panelPaddingSize:"none"},external_kbnSharedDeps_React_default.a.createElement("div",{className:"euiFilterSelect__items"},agentPolicies.map((agentPolicy,index)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFilterSelectItem,{checked:selectedAgentPolicies.includes(agentPolicy.id)?"on":void 0,key:index,onClick:()=>{var policyId;selectedAgentPolicies.includes(agentPolicy.id)?(policyId=agentPolicy.id,onSelectedAgentPoliciesChange(selectedAgentPolicies.filter(agentPolicy=>agentPolicy!==policyId))):(policyId=>{onSelectedAgentPoliciesChange([...selectedAgentPolicies,policyId])})(agentPolicy.id)}},agentPolicy.name)))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFilterButton,{hasActiveFilters:showUpgradeable,onClick:()=>{onShowUpgradeableChange(!showUpgradeable)}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentList.showUpgradeableFilterLabel",defaultMessage:"Upgrade available"}))))))))},RowActions=external_kbnSharedDeps_React_default.a.memo(({agent:agent,agentPolicy:agentPolicy,refresh:refresh,onReassignClick:onReassignClick,onUnenrollClick:onUnenrollClick,onUpgradeClick:onUpgradeClick})=>{const{getHref:getHref}=Object(hooks.ib)(),hasWriteCapabilites=Object(hooks.K)().write,isUnenrolling="unenrolling"===agent.status,kibanaVersion=Object(hooks.gb)(),[isMenuOpen,setIsMenuOpen]=Object(external_kbnSharedDeps_React_.useState)(!1),menuItems=[external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenuItem,{icon:"inspect",href:getHref("fleet_agent_details",{agentId:agent.id}),key:"viewAgent"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentList.viewActionText",defaultMessage:"View agent"}))];return!1===(null==agentPolicy?void 0:agentPolicy.is_managed)&&menuItems.push(external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenuItem,{icon:"pencil",onClick:()=>{onReassignClick()},disabled:!agent.active,key:"reassignPolicy"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentList.reassignActionText",defaultMessage:"Assign to new policy"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenuItem,{disabled:!hasWriteCapabilites||!agent.active,icon:"trash",onClick:()=>{onUnenrollClick()}},isUnenrolling?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentList.forceUnenrollOneButton",defaultMessage:"Force unenroll"}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentList.unenrollOneButton",defaultMessage:"Unenroll agent"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenuItem,{icon:"refresh",disabled:!Object(services.l)(agent,kibanaVersion),onClick:()=>{onUpgradeClick()}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentList.upgradeOneButton",defaultMessage:"Upgrade agent"}))),external_kbnSharedDeps_React_default.a.createElement(ContextMenuActions,{isOpen:isMenuOpen,onChange:isOpen=>setIsMenuOpen(isOpen),items:menuItems})});function safeMetadata(val){return"string"!=typeof val?"-":val}const AgentListPage=()=>{const{notifications:notifications}=Object(hooks.nb)();Object(hooks.J)("fleet_agent_list");const{getHref:getHref}=Object(hooks.ib)(),defaultKuery=Object(hooks.qb)().urlParams.kuery||"",hasWriteCapabilites=Object(hooks.K)().write,isGoldPlus=Object(hooks.hb)().isGoldPlus(),kibanaVersion=Object(hooks.gb)(),[showUpgradeable,setShowUpgradeable]=Object(external_kbnSharedDeps_React_.useState)(!1),[draftKuery,setDraftKuery]=Object(external_kbnSharedDeps_React_.useState)(defaultKuery),[search,setSearch]=Object(external_kbnSharedDeps_React_.useState)(defaultKuery),[selectionMode,setSelectionMode]=Object(external_kbnSharedDeps_React_.useState)("manual"),[selectedAgents,setSelectedAgents]=Object(external_kbnSharedDeps_React_.useState)([]),tableRef=Object(external_kbnSharedDeps_React_.useRef)(null),{pagination:pagination,pageSizeOptions:pageSizeOptions,setPagination:setPagination}=Object(hooks.kb)(),onSubmitSearch=Object(external_kbnSharedDeps_React_.useCallback)(newKuery=>{setSearch(newKuery),setPagination({...pagination,currentPage:1})},[setSearch,pagination,setPagination]),[selectedAgentPolicies,setSelectedAgentPolicies]=Object(external_kbnSharedDeps_React_.useState)([]),[selectedStatus,setSelectedStatus]=Object(external_kbnSharedDeps_React_.useState)([]),isUsingFilter=search.trim()||selectedAgentPolicies.length||selectedStatus.length||showUpgradeable,clearFilters=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setDraftKuery(""),setSearch(""),setSelectedAgentPolicies([]),setSelectedStatus([]),setShowUpgradeable(!1)},[setSearch,setDraftKuery,setSelectedAgentPolicies,setSelectedStatus,setShowUpgradeable]),[isEnrollmentFlyoutOpen,setIsEnrollmentFlyoutOpen]=Object(external_kbnSharedDeps_React_.useState)(!1),[agentToReassign,setAgentToReassign]=Object(external_kbnSharedDeps_React_.useState)(void 0),[agentToUnenroll,setAgentToUnenroll]=Object(external_kbnSharedDeps_React_.useState)(void 0),[agentToUpgrade,setAgentToUpgrade]=Object(external_kbnSharedDeps_React_.useState)(void 0),kuery=Object(external_kbnSharedDeps_React_.useMemo)(()=>{let kueryBuilder=search.trim();if(selectedAgentPolicies.length&&(kueryBuilder&&(kueryBuilder=`(${kueryBuilder}) and`),kueryBuilder=`${kueryBuilder} ${constants.d}.policy_id : (${selectedAgentPolicies.map(agentPolicy=>`"${agentPolicy}"`).join(" or ")})`),selectedStatus.length){const kueryStatus=selectedStatus.map(status=>{switch(status){case"healthy":return services.a.buildKueryForOnlineAgents();case"unhealthy":return services.a.buildKueryForErrorAgents();case"offline":return services.a.buildKueryForOfflineAgents();case"updating":return services.a.buildKueryForUpdatingAgents();case"inactive":return services.a.buildKueryForInactiveAgents()}}).filter(statusKuery=>void 0!==statusKuery).join(" or ");kueryBuilder=kueryBuilder?`(${kueryBuilder}) and ${kueryStatus}`:kueryStatus}return kueryBuilder},[selectedStatus,selectedAgentPolicies,search]),showInactive=Object(external_kbnSharedDeps_React_.useMemo)(()=>selectedStatus.includes("inactive"),[selectedStatus]),[agents,setAgents]=Object(external_kbnSharedDeps_React_.useState)([]),[agentsStatus,setAgentsStatus]=Object(external_kbnSharedDeps_React_.useState)(),[isLoading,setIsLoading]=Object(external_kbnSharedDeps_React_.useState)(!1),[totalAgents,setTotalAgents]=Object(external_kbnSharedDeps_React_.useState)(0),[totalInactiveAgents,setTotalInactiveAgents]=Object(external_kbnSharedDeps_React_.useState)(0),currentRequestRef=Object(external_kbnSharedDeps_React_.useRef)(0),fetchData=Object(external_kbnSharedDeps_React_.useCallback)(()=>{!async function(){currentRequestRef.current++;const currentRequest=currentRequestRef.current;try{setIsLoading(!0);const[agentsRequest,agentsStatusRequest]=await Promise.all([Object(hooks.m)({page:pagination.currentPage,perPage:pagination.pageSize,kuery:kuery&&""!==kuery?kuery:void 0,showInactive:showInactive,showUpgradeable:showUpgradeable}),Object(hooks.l)({kuery:kuery&&""!==kuery?kuery:void 0})]);if(currentRequestRef.current!==currentRequest)return;if(agentsRequest.error)throw agentsRequest.error;if(!agentsRequest.data)throw new Error("Invalid GET /agents response");if(agentsStatusRequest.error)throw agentsStatusRequest.error;if(!agentsStatusRequest.data)throw new Error("Invalid GET /agents-status response");setAgentsStatus({healthy:agentsStatusRequest.data.results.online,unhealthy:agentsStatusRequest.data.results.error,offline:agentsStatusRequest.data.results.offline,updating:agentsStatusRequest.data.results.updating,inactive:agentsRequest.data.totalInactive}),setAgents(agentsRequest.data.list),setTotalAgents(agentsRequest.data.total),setTotalInactiveAgents(agentsRequest.data.totalInactive)}catch(error){notifications.toasts.addError(error,{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentList.errorFetchingDataTitle",{defaultMessage:"Error fetching agents"})})}setIsLoading(!1)}()},[pagination,kuery,showInactive,showUpgradeable,notifications.toasts]);Object(external_kbnSharedDeps_React_.useEffect)(()=>{fetchData();const interval=setInterval(()=>{fetchData()},3e4);return()=>clearInterval(interval)},[fetchData]);const agentPoliciesRequest=Object(hooks.O)({page:1,perPage:1e3}),agentPolicies=Object(external_kbnSharedDeps_React_.useMemo)(()=>agentPoliciesRequest.data?agentPoliciesRequest.data.items:[],[agentPoliciesRequest]),agentPoliciesIndexedById=Object(external_kbnSharedDeps_React_.useMemo)(()=>agentPolicies.reduce((acc,agentPolicy)=>(acc[agentPolicy.id]=agentPolicy,acc),{}),[agentPolicies]),isAgentSelectable=agent=>{if(!agent.active)return!1;if(!agent.policy_id)return!0;const agentPolicy=agentPoliciesIndexedById[agent.policy_id];return!(!0===(null==agentPolicy?void 0:agentPolicy.is_managed))},columns=[{field:"local_metadata.host.hostname",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentList.hostColumnTitle",{defaultMessage:"Host"}),render:(host,agent)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{href:getHref("fleet_agent_details",{agentId:agent.id})},safeMetadata(host))},{field:"active",width:"120px",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentList.statusColumnTitle",{defaultMessage:"Status"}),render:(active,agent)=>external_kbnSharedDeps_React_default.a.createElement(AgentHealth,{agent:agent})},{field:"policy_id",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentList.policyColumnTitle",{defaultMessage:"Agent policy"}),render:(policyId,agent)=>{const agentPolicy=agentPoliciesIndexedById[policyId],showWarning=agent.policy_revision&&(null==agentPolicy?void 0:agentPolicy.revision)>agent.policy_revision;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s",alignItems:"center",style:{minWidth:0}},agentPolicy&&external_kbnSharedDeps_React_default.a.createElement(AgentPolicySummaryLine,{policy:agentPolicy}),showWarning&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{color:"subdued",size:"xs",className:"eui-textNoWrap"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{size:"m",type:"alert",color:"warning"}),"Â ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentList.outOfDateLabel",defaultMessage:"Out-of-date"}))))}},{field:"local_metadata.elastic.agent.version",width:"200px",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentList.versionTitle",{defaultMessage:"Version"}),render:(version,agent)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s",alignItems:"center",style:{minWidth:0}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,className:"eui-textNoWrap"},safeMetadata(version)),isAgentSelectable(agent)&&Object(services.l)(agent,kibanaVersion)?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{color:"subdued",size:"xs",className:"eui-textNoWrap"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{size:"m",type:"alert",color:"warning"}),"Â ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentList.agentUpgradeLabel",defaultMessage:"Upgrade available"}))):null)},{field:"last_checkin",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentList.lastCheckinTitle",{defaultMessage:"Last activity"}),render:(lastCheckin,agent)=>lastCheckin?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedRelative,{value:lastCheckin}):null},{name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentList.actionsColumnTitle",{defaultMessage:"Actions"}),actions:[{render:agent=>{const agentPolicy="string"==typeof agent.policy_id?agentPoliciesIndexedById[agent.policy_id]:void 0;return external_kbnSharedDeps_React_default.a.createElement(RowActions,{agent:agent,agentPolicy:agentPolicy,refresh:()=>fetchData(),onReassignClick:()=>setAgentToReassign(agent),onUnenrollClick:()=>setAgentToUnenroll(agent),onUpgradeClick:()=>setAgentToUpgrade(agent)})}}],width:"100px"}],emptyPrompt=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiEmptyPrompt,{title:external_kbnSharedDeps_React_default.a.createElement("h2",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentList.noAgentsPrompt",defaultMessage:"No agents enrolled"})),actions:hasWriteCapabilites?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{fill:!0,iconType:"plusInCircle",onClick:()=>setIsEnrollmentFlyoutOpen(!0)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentList.addButton",defaultMessage:"Add agent"})):null});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,isEnrollmentFlyoutOpen?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPortal,null,external_kbnSharedDeps_React_default.a.createElement(AgentEnrollmentFlyout,{agentPolicies:agentPolicies,onClose:()=>setIsEnrollmentFlyoutOpen(!1)})):null,agentToReassign&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPortal,null,external_kbnSharedDeps_React_default.a.createElement(AgentReassignAgentPolicyModal,{agents:[agentToReassign],onClose:()=>{setAgentToReassign(void 0),fetchData()}})),agentToUnenroll&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPortal,null,external_kbnSharedDeps_React_default.a.createElement(AgentUnenrollAgentModal,{agents:[agentToUnenroll],agentCount:1,onClose:()=>{setAgentToUnenroll(void 0),fetchData()},useForceUnenroll:"unenrolling"===agentToUnenroll.status})),agentToUpgrade&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPortal,null,external_kbnSharedDeps_React_default.a.createElement(AgentUpgradeAgentModal,{agents:[agentToUpgrade],agentCount:1,onClose:()=>{setAgentToUpgrade(void 0),fetchData()},version:kibanaVersion})),external_kbnSharedDeps_React_default.a.createElement(SearchAndFilterBar,{agentPolicies:agentPolicies,draftKuery:draftKuery,onDraftKueryChange:setDraftKuery,onSubmitSearch:onSubmitSearch,selectedAgentPolicies:selectedAgentPolicies,onSelectedAgentPoliciesChange:setSelectedAgentPolicies,selectedStatus:selectedStatus,onSelectedStatusChange:setSelectedStatus,showUpgradeable:showUpgradeable,onShowUpgradeableChange:setShowUpgradeable}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(AgentTableHeader,{showInactive:showInactive,totalAgents:totalAgents,totalInactiveAgents:totalInactiveAgents,agentStatus:agentsStatus,selectableAgents:(null==agents?void 0:agents.filter(isAgentSelectable).length)||0,selectionMode:selectionMode,setSelectionMode:setSelectionMode,currentQuery:kuery,selectedAgents:selectedAgents,setSelectedAgents:newAgents=>{null!=tableRef&&tableRef.current&&(tableRef.current.setSelection(newAgents),setSelectionMode("manual"))},refreshAgents:()=>fetchData()}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBasicTable,{ref:tableRef,className:"fleet__agentList__table","data-test-subj":"fleetAgentListTable",loading:isLoading,hasActions:!0,noItemsMessage:isLoading&&1===currentRequestRef.current?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentList.loadingAgentsMessage",defaultMessage:"Loading agentsâ¦"}):isUsingFilter?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentList.noFilteredAgentsPrompt",defaultMessage:"No agents found. {clearFiltersLink}",values:{clearFiltersLink:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{onClick:()=>clearFilters()},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentList.clearFiltersLinkText",defaultMessage:"Clear filters"}))}}):emptyPrompt,items:totalAgents?showUpgradeable?agents.filter(agent=>isAgentSelectable(agent)&&Object(services.l)(agent,kibanaVersion)):agents:[],itemId:"id",columns:columns,pagination:{pageIndex:pagination.currentPage-1,pageSize:pagination.pageSize,totalItemCount:totalAgents,pageSizeOptions:pageSizeOptions},isSelectable:!0,selection:isGoldPlus?{onSelectionChange:newAgents=>{setSelectedAgents(newAgents),setSelectionMode("manual")},selectable:isAgentSelectable,selectableMessage:(selectable,agent)=>selectable?"":agent.active?agent.policy_id&&agentPoliciesIndexedById[agent.policy_id].is_managed?"This action is not available for agents enrolled in an externally managed agent policy":"":"This agent is not active"}:void 0,onChange:({page:page})=>{const newPagination={...pagination,currentPage:page.index+1,pageSize:page.size};setPagination(newPagination)}}))},AgentRefreshContext=external_kbnSharedDeps_React_default.a.createContext({refresh:()=>{}});var kibanaUtils_public_=__webpack_require__(28);const AGENT_LOG_INDEX_PATTERN="logs-elastic_agent-*,logs-elastic_agent.*-*",AGENT_ID_FIELD_name="elastic_agent.id",DATASET_FIELD={name:"data_stream.dataset",type:"string",aggregatable:!0},LOG_LEVEL_FIELD={name:"log.level",type:"string",aggregatable:!0},DEFAULT_DATE_RANGE_start="now-1d",DEFAULT_DATE_RANGE_end="now",DEFAULT_LOGS_STATE={start:DEFAULT_DATE_RANGE_start,end:DEFAULT_DATE_RANGE_end,logLevels:[],datasets:["elastic_agent"],query:""},AGENT_LOG_LEVELS={ERROR:"error",WARNING:"warning",INFO:"info",DEBUG:"debug"},ORDERED_FILTER_LOG_LEVELS=["error","warning","warn","notice","info","debug"],DEFAULT_LOG_LEVEL=AGENT_LOG_LEVELS.INFO;var url_url=__webpack_require__(254),url_default=__webpack_require__.n(url_url),external_kbnSharedDeps_RisonNode_=__webpack_require__(105),query_string=__webpack_require__(132),useMeasure=__webpack_require__(262),useMeasure_default=__webpack_require__.n(useMeasure),gte=__webpack_require__(261),gte_default=__webpack_require__.n(gte),coerce=__webpack_require__(21),coerce_default=__webpack_require__.n(coerce),infra_public_=__webpack_require__(106);const DatasetFilter=Object(external_kbnSharedDeps_React_.memo)(({selectedDatasets:selectedDatasets,onToggleDataset:onToggleDataset})=>{const{data:data}=Object(hooks.nb)(),[isOpen,setIsOpen]=Object(external_kbnSharedDeps_React_.useState)(!1),[isLoading,setIsLoading]=Object(external_kbnSharedDeps_React_.useState)(!1),[datasetValues,setDatasetValues]=Object(external_kbnSharedDeps_React_.useState)(["elastic_agent"]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{(async()=>{setIsLoading(!0);try{const values=await data.autocomplete.getValueSuggestions({indexPattern:{title:AGENT_LOG_INDEX_PATTERN,fields:[DATASET_FIELD]},field:DATASET_FIELD,query:""});setDatasetValues(values.sort())}catch(e){setDatasetValues(["elastic_agent"])}setIsLoading(!1)})()},[data.autocomplete]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopover,{button:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFilterButton,{iconType:"arrowDown",onClick:()=>setIsOpen(!0),isSelected:isOpen,isLoading:isLoading,numFilters:datasetValues.length,hasActiveFilters:selectedDatasets.length>0,numActiveFilters:selectedDatasets.length},external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentLogs.datasetSelectText",{defaultMessage:"Dataset"})),isOpen:isOpen,closePopover:()=>setIsOpen(!1),panelPaddingSize:"none"},datasetValues.map(dataset=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFilterSelectItem,{checked:selectedDatasets.includes(dataset)?"on":void 0,key:dataset,onClick:()=>onToggleDataset(dataset)},dataset)))});const LogLevelFilter=Object(external_kbnSharedDeps_React_.memo)(({selectedLevels:selectedLevels,onToggleLevel:onToggleLevel})=>{const{data:data}=Object(hooks.nb)(),[isOpen,setIsOpen]=Object(external_kbnSharedDeps_React_.useState)(!1),[isLoading,setIsLoading]=Object(external_kbnSharedDeps_React_.useState)(!1),[levelValues,setLevelValues]=Object(external_kbnSharedDeps_React_.useState)([]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{(async()=>{setIsLoading(!0);try{const values=await data.autocomplete.getValueSuggestions({indexPattern:{title:AGENT_LOG_INDEX_PATTERN,fields:[LOG_LEVEL_FIELD]},field:LOG_LEVEL_FIELD,query:""});setLevelValues((levels=values,[...new Set([...ORDERED_FILTER_LOG_LEVELS.filter(level=>levels.includes(level)),...levels.sort()])]))}catch(e){setLevelValues([])}var levels;setIsLoading(!1)})()},[data.autocomplete]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopover,{button:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFilterButton,{iconType:"arrowDown",onClick:()=>setIsOpen(!0),isSelected:isOpen,isLoading:isLoading,numFilters:levelValues.length,hasActiveFilters:selectedLevels.length>0,numActiveFilters:selectedLevels.length},external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentLogs.logLevelSelectText",{defaultMessage:"Log level"})),isOpen:isOpen,closePopover:()=>setIsOpen(!1),panelPaddingSize:"none"},levelValues.map(level=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFilterSelectItem,{checked:selectedLevels.includes(level)?"on":void 0,key:level,onClick:()=>onToggleLevel(level)},level)))}),EXCLUDED_FIELDS=[AGENT_ID_FIELD_name,DATASET_FIELD.name,LOG_LEVEL_FIELD.name],LogQueryBar=Object(external_kbnSharedDeps_React_.memo)(({query:query,isQueryValid:isQueryValid,onUpdateQuery:onUpdateQuery})=>{const{data:data}=Object(hooks.nb)(),[indexPatternFields,setIndexPatternFields]=Object(external_kbnSharedDeps_React_.useState)();return Object(external_kbnSharedDeps_React_.useEffect)(()=>{(async()=>{try{const fields=(await data.indexPatterns.getFieldsForWildcard({pattern:AGENT_LOG_INDEX_PATTERN})||[]).filter(field=>!EXCLUDED_FIELDS.includes(field.name));setIndexPatternFields(fields)}catch(err){setIndexPatternFields(void 0)}})()},[data.indexPatterns]),external_kbnSharedDeps_React_default.a.createElement(data_public_.QueryStringInput,{iconType:"search",disableLanguageSwitcher:!0,indexPatterns:indexPatternFields?[{title:AGENT_LOG_INDEX_PATTERN,fields:indexPatternFields}]:[],query:{query:query,language:"kuery"},isInvalid:!isQueryValid,disableAutoFocus:!0,placeholder:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentLogs.searchPlaceholderText",{defaultMessage:"Search logsâ¦"}),onChange:newQuery=>{onUpdateQuery(newQuery.query)},onSubmit:newQuery=>{onUpdateQuery(newQuery.query,!0)}})}),LEVEL_VALUES=Object.values(AGENT_LOG_LEVELS),SelectLogLevel=Object(external_kbnSharedDeps_React_.memo)(({agent:agent})=>{var _agent$local_metadata,_agent$local_metadata2,_agent$local_metadata3,_agent$local_metadata4;const{notifications:notifications}=Object(hooks.nb)(),[isLoading,setIsLoading]=Object(external_kbnSharedDeps_React_.useState)(!1),[agentLogLevel,setAgentLogLevel]=Object(external_kbnSharedDeps_React_.useState)(null!==(_agent$local_metadata=null===(_agent$local_metadata2=agent.local_metadata)||void 0===_agent$local_metadata2||null===(_agent$local_metadata3=_agent$local_metadata2.elastic)||void 0===_agent$local_metadata3||null===(_agent$local_metadata4=_agent$local_metadata3.agent)||void 0===_agent$local_metadata4?void 0:_agent$local_metadata4.log_level)&&void 0!==_agent$local_metadata?_agent$local_metadata:DEFAULT_LOG_LEVEL),[selectedLogLevel,setSelectedLogLevel]=Object(external_kbnSharedDeps_React_.useState)(agentLogLevel),onClickApply=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setIsLoading(!0),async function(){try{const res=await Object(hooks.w)(agent.id,{action:{type:"SETTINGS",data:{log_level:selectedLogLevel}}});if(res.error)throw res.error;setAgentLogLevel(selectedLogLevel),notifications.toasts.addSuccess(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentLogs.selectLogLevel.successText",{defaultMessage:"Changed agent logging level to '{logLevel}'.",values:{logLevel:selectedLogLevel}}))}catch(error){notifications.toasts.addError(error,{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentLogs.selectLogLevel.errorTitleText",{defaultMessage:"Error updating agent logging level"})})}setIsLoading(!1)}()},[notifications,selectedLogLevel,agent.id]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"m",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormLabel,{htmlFor:"selectAgentLogLevel"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentLogs.selectLogLevelLabelText",defaultMessage:"Agent logging level"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSelect,{disabled:isLoading,compressed:!0,id:"selectAgentLogLevel",value:selectedLogLevel,onChange:event=>{setSelectedLogLevel(event.target.value)},options:LEVEL_VALUES.map(level=>({text:level,value:level}))})),agentLogLevel!==selectedLogLevel&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{flush:"left",size:"xs",isLoading:isLoading,disabled:agentLogLevel===selectedLogLevel,iconType:"refresh",onClick:onClickApply},isLoading?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentLogs.updateButtonLoadingText",defaultMessage:"Applying changes..."}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentLogs.updateButtonText",defaultMessage:"Apply changes"}))))}),WrapperFlexGroup=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup).withConfig({displayName:"WrapperFlexGroup",componentId:"mjo9ba-0"})(["height:100%;"]),DatePickerFlexItem=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexItem).withConfig({displayName:"DatePickerFlexItem",componentId:"mjo9ba-1"})(["max-width:312px;"]),AgentLogsUrlStateHelper=Object(kibanaUtils_public_.createStateContainerReactHelpers)(),AgentLogsUI=Object(external_kbnSharedDeps_React_.memo)(({agent:agent,state:state})=>{var _agent$local_metadata,_agent$local_metadata2,_agent$local_metadata3;const{data:data,application:application,http:http}=Object(hooks.nb)(),{update:updateState}=AgentLogsUrlStateHelper.useTransitions(),getDateRangeTimestamps=Object(external_kbnSharedDeps_React_.useCallback)(timeRange=>{const{min:min,max:max}=data.query.timefilter.timefilter.calculateBounds(timeRange);return min&&max?{start:min.valueOf(),end:max.valueOf()}:void 0},[data.query.timefilter.timefilter]),tryUpdateDateRange=Object(external_kbnSharedDeps_React_.useCallback)(timeRange=>{getDateRangeTimestamps(timeRange)&&updateState({start:timeRange.from,end:timeRange.to})},[getDateRangeTimestamps,updateState]),[dateRangeTimestamps,setDateRangeTimestamps]=Object(external_kbnSharedDeps_React_.useState)(getDateRangeTimestamps({from:state.start,to:state.end})||getDateRangeTimestamps({from:DEFAULT_DATE_RANGE_start,to:DEFAULT_DATE_RANGE_end}));Object(external_kbnSharedDeps_React_.useEffect)(()=>{const timestampsFromDateRange=getDateRangeTimestamps({from:state.start,to:state.end});timestampsFromDateRange?setDateRangeTimestamps(timestampsFromDateRange):tryUpdateDateRange({from:DEFAULT_DATE_RANGE_start,to:DEFAULT_DATE_RANGE_end})},[state.start,state.end,getDateRangeTimestamps,tryUpdateDateRange]);const isQueryValid=Object(external_kbnSharedDeps_React_.useCallback)(testQuery=>{try{return data_public_.esKuery.fromKueryExpression(testQuery),!0}catch(err){return!1}},[]),[draftQuery,setDraftQuery]=Object(external_kbnSharedDeps_React_.useState)(state.query),[isDraftQueryValid,setIsDraftQueryValid]=Object(external_kbnSharedDeps_React_.useState)(isQueryValid(state.query)),onUpdateDraftQuery=Object(external_kbnSharedDeps_React_.useCallback)((newDraftQuery,runQuery)=>{setDraftQuery(newDraftQuery),isQueryValid(newDraftQuery)?(setIsDraftQueryValid(!0),runQuery&&updateState({query:newDraftQuery})):setIsDraftQueryValid(!1)},[isQueryValid,updateState]),logStreamQuery=Object(external_kbnSharedDeps_React_.useMemo)(()=>(({agentId:agentId,datasets:datasets,logLevels:logLevels,userQuery:userQuery})=>{const agentIdQuery=`${AGENT_ID_FIELD_name}:${agentId}`,datasetQuery=datasets.length?datasets.map(dataset=>`${DATASET_FIELD.name}:${dataset}`).join(" or "):`${DATASET_FIELD.name}:elastic_agent or ${DATASET_FIELD.name}:elastic_agent.*`,logLevelQuery=logLevels.map(level=>`${LOG_LEVEL_FIELD.name}:${level}`).join(" or "),agentQuery=`${agentIdQuery} and (${datasetQuery})`,baseQuery=logLevelQuery?`${agentQuery} and (${logLevelQuery})`:agentQuery;return userQuery?`(${baseQuery}) and (${userQuery})`:baseQuery})({agentId:agent.id,datasets:state.datasets,logLevels:state.logLevels,userQuery:state.query}),[agent.id,state.datasets,state.logLevels,state.query]),viewInLogsUrl=Object(external_kbnSharedDeps_React_.useMemo)(()=>http.basePath.prepend(url_default.a.format({pathname:"/app/logs/stream",search:Object(query_string.stringify)({logPosition:Object(external_kbnSharedDeps_RisonNode_.encode)({start:state.start,end:state.end,streamLive:!1}),logFilter:Object(external_kbnSharedDeps_RisonNode_.encode)({expression:logStreamQuery,kind:"kuery"})},{sort:!1,encode:!1})})),[http.basePath,state.start,state.end,logStreamQuery]),agentVersion=null===(_agent$local_metadata=agent.local_metadata)||void 0===_agent$local_metadata||null===(_agent$local_metadata2=_agent$local_metadata.elastic)||void 0===_agent$local_metadata2||null===(_agent$local_metadata3=_agent$local_metadata2.agent)||void 0===_agent$local_metadata3?void 0:_agent$local_metadata3.version,isLogFeatureAvailable=Object(external_kbnSharedDeps_React_.useMemo)(()=>{var _semverCoerce;if(!agentVersion)return!1;const agentVersionWithPrerelease=null===(_semverCoerce=coerce_default()(agentVersion))||void 0===_semverCoerce?void 0:_semverCoerce.version;return!!agentVersionWithPrerelease&&gte_default()(agentVersionWithPrerelease,"7.11.0")},[agentVersion]),[logsPanelRef,{height:measuredlogPanelHeight}]=useMeasure_default()(),logPanelHeight=Object(external_kbnSharedDeps_React_.useMemo)(()=>Math.max(measuredlogPanelHeight,600),[measuredlogPanelHeight]);return isLogFeatureAvailable?external_kbnSharedDeps_React_default.a.createElement(WrapperFlexGroup,{direction:"column",gutterSize:"m"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"m"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(LogQueryBar,{query:draftQuery,onUpdateQuery:onUpdateDraftQuery,isQueryValid:isDraftQueryValid})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFilterGroup,null,external_kbnSharedDeps_React_default.a.createElement(DatasetFilter,{selectedDatasets:state.datasets,onToggleDataset:dataset=>{const currentDatasets=[...state.datasets],datasetPosition=currentDatasets.indexOf(dataset);datasetPosition>=0?(currentDatasets.splice(datasetPosition,1),updateState({datasets:currentDatasets})):updateState({datasets:[...state.datasets,dataset]})}}),external_kbnSharedDeps_React_default.a.createElement(LogLevelFilter,{selectedLevels:state.logLevels,onToggleLevel:level=>{const currentLevels=[...state.logLevels],levelPosition=currentLevels.indexOf(level);levelPosition>=0?(currentLevels.splice(levelPosition,1),updateState({logLevels:currentLevels})):updateState({logLevels:[...state.logLevels,level]})}}))),external_kbnSharedDeps_React_default.a.createElement(DatePickerFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSuperDatePicker,{showUpdateButton:!1,start:state.start,end:state.end,onTimeChange:({start:start,end:end})=>{tryUpdateDateRange({from:start,to:end})}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(public_.RedirectAppLinks,{application:application},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{href:viewInLogsUrl,iconType:"popout",flush:"both"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentLogs.openInLogsUiLinkText",defaultMessage:"Open in Logs"})))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPanel,{paddingSize:"none",panelRef:logsPanelRef},external_kbnSharedDeps_React_default.a.createElement(infra_public_.LogStream,{height:logPanelHeight,startTimestamp:dateRangeTimestamps.start,endTimestamp:dateRangeTimestamps.end,query:logStreamQuery}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(SelectLogLevel,{agent:agent}))):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{size:"m",color:"warning",title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentLogs.oldAgentWarningTitle",defaultMessage:"The Logs view requires Elastic Agent 7.11 or higher. To upgrade an agent, go to the Actions menu, or {downloadLink} a newer version.",values:{downloadLink:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{href:"https://ela.st/download-elastic-agent",external:!0,target:"_blank"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentLogs.downloadLink",defaultMessage:"download"}))}})})}),AgentLogs=Object(external_kbnSharedDeps_React_.memo)(({agent:agent})=>{const stateContainer=Object(external_kbnSharedDeps_React_.useMemo)(()=>Object(kibanaUtils_public_.createStateContainer)({...DEFAULT_LOGS_STATE,...Object(kibanaUtils_public_.getStateFromKbnUrl)("_q",window.location.href)},{update:state=>updatedState=>({...state,...updatedState})}),[]),AgentLogsConnected=Object(external_kbnSharedDeps_React_.useMemo)(()=>AgentLogsUrlStateHelper.connect(state=>({state:state||DEFAULT_LOGS_STATE}))(AgentLogsUI),[]),[isSyncReady,setIsSyncReady]=Object(external_kbnSharedDeps_React_.useState)(!1);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{const stateStorage=Object(kibanaUtils_public_.createKbnUrlStateStorage)(),{start:start,stop:stop}=Object(kibanaUtils_public_.syncState)({storageKey:"_q",stateContainer:stateContainer,stateStorage:stateStorage});return start(),setIsSyncReady(!0),()=>{stop(),stateContainer.set(DEFAULT_LOGS_STATE)}},[stateContainer]),external_kbnSharedDeps_React_default.a.createElement(AgentLogsUrlStateHelper.Provider,{value:stateContainer},isSyncReady?external_kbnSharedDeps_React_default.a.createElement(AgentLogsConnected,{agent:agent}):null)}),AgentDetailsActionMenu=Object(external_kbnSharedDeps_React_.memo)(({agent:agent,assignFlyoutOpenByDefault:assignFlyoutOpenByDefault=!1,onCancelReassign:onCancelReassign})=>{const hasWriteCapabilites=Object(hooks.K)().write,kibanaVersion=Object(hooks.gb)(),refreshAgent=external_kbnSharedDeps_React_default.a.useContext(AgentRefreshContext).refresh,[isReassignFlyoutOpen,setIsReassignFlyoutOpen]=Object(external_kbnSharedDeps_React_.useState)(assignFlyoutOpenByDefault),[isUnenrollModalOpen,setIsUnenrollModalOpen]=Object(external_kbnSharedDeps_React_.useState)(!1),[isUpgradeModalOpen,setIsUpgradeModalOpen]=Object(external_kbnSharedDeps_React_.useState)(!1),isUnenrolling="unenrolling"===agent.status,onClose=Object(external_kbnSharedDeps_React_.useMemo)(()=>onCancelReassign||(()=>setIsReassignFlyoutOpen(!1)),[onCancelReassign,setIsReassignFlyoutOpen]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,isReassignFlyoutOpen&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPortal,null,external_kbnSharedDeps_React_default.a.createElement(AgentReassignAgentPolicyModal,{agents:[agent],onClose:onClose})),isUnenrollModalOpen&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPortal,null,external_kbnSharedDeps_React_default.a.createElement(AgentUnenrollAgentModal,{agents:[agent],agentCount:1,onClose:()=>{setIsUnenrollModalOpen(!1),refreshAgent()},useForceUnenroll:isUnenrolling})),isUpgradeModalOpen&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPortal,null,external_kbnSharedDeps_React_default.a.createElement(AgentUpgradeAgentModal,{agents:[agent],agentCount:1,version:kibanaVersion,onClose:()=>{setIsUpgradeModalOpen(!1),refreshAgent()}})),external_kbnSharedDeps_React_default.a.createElement(ContextMenuActions,{button:{props:{iconType:"arrowDown",iconSide:"right",color:"primary",fill:!0},children:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentDetails.actionsButton",defaultMessage:"Actions"})},items:[external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenuItem,{icon:"pencil",onClick:()=>{setIsReassignFlyoutOpen(!0)},disabled:!agent.active,key:"reassignPolicy"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentList.reassignActionText",defaultMessage:"Assign to new policy"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenuItem,{icon:"cross",disabled:!hasWriteCapabilites||!agent.active,onClick:()=>{setIsUnenrollModalOpen(!0)}},isUnenrolling?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentList.forceUnenrollOneButton",defaultMessage:"Force unenroll"}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentList.unenrollOneButton",defaultMessage:"Unenroll agent"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenuItem,{icon:"refresh",disabled:!Object(services.l)(agent,kibanaVersion),onClick:()=>{setIsUpgradeModalOpen(!0)}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentList.upgradeOneButton",defaultMessage:"Upgrade agent"}))]}))}),agent_details_overview_FlexItemWithMinWidth=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexItem).withConfig({displayName:"FlexItemWithMinWidth",componentId:"sc-19wc892-0"})(["min-width:0px;"]),AgentDetailsOverviewSection=Object(external_kbnSharedDeps_React_.memo)(({agent:agent,agentPolicy:agentPolicy})=>{var _agent$local_metadata,_agent$local_metadata2,_agent$local_metadata3,_agent$local_metadata4,_agent$local_metadata5,_agent$local_metadata6,_agent$local_metadata7,_agent$local_metadata8,_agent$local_metadata9,_agent$local_metadata10,_agent$local_metadata11,_agent$local_metadata12,_agent$local_metadata13,_agentPolicy$monitori,_agentPolicy$monitori2;const kibanaVersion=Object(hooks.gb)();return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPanel,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionList,{compressed:!0},[{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentDetails.hostIdLabel",{defaultMessage:"Agent ID"}),description:agent.id},{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentDetails.agentPolicyLabel",{defaultMessage:"Agent policy"}),description:agentPolicy?external_kbnSharedDeps_React_default.a.createElement(AgentPolicySummaryLine,{policy:agentPolicy}):agent.policy_id||"-"},{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentDetails.versionLabel",{defaultMessage:"Agent version"}),description:"string"==typeof(null===(_agent$local_metadata=agent.local_metadata)||void 0===_agent$local_metadata||null===(_agent$local_metadata2=_agent$local_metadata.elastic)||void 0===_agent$local_metadata2||null===(_agent$local_metadata3=_agent$local_metadata2.agent)||void 0===_agent$local_metadata3?void 0:_agent$local_metadata3.version)?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s",alignItems:"center",style:{minWidth:0}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,className:"eui-textNoWrap"},agent.local_metadata.elastic.agent.version),Object(services.l)(agent,kibanaVersion)?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{position:"right",content:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentList.agentUpgradeLabel",{defaultMessage:"Upgrade available"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{type:"alert",color:"warning"}))):null):"-"},{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentDetails.integrationsLabel",{defaultMessage:"Integrations"}),description:agent.policy_id?external_kbnSharedDeps_React_default.a.createElement(AgentPolicyPackageBadges,{agentPolicyId:agent.policy_id,hideTitle:!0}):null},{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentDetails.hostNameLabel",{defaultMessage:"Host name"}),description:"string"==typeof(null===(_agent$local_metadata4=agent.local_metadata)||void 0===_agent$local_metadata4||null===(_agent$local_metadata5=_agent$local_metadata4.host)||void 0===_agent$local_metadata5?void 0:_agent$local_metadata5.hostname)?agent.local_metadata.host.hostname:"-"},{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentDetails.logLevel",{defaultMessage:"Logging level"}),description:"string"==typeof(null===(_agent$local_metadata6=agent.local_metadata)||void 0===_agent$local_metadata6||null===(_agent$local_metadata7=_agent$local_metadata6.elastic)||void 0===_agent$local_metadata7||null===(_agent$local_metadata8=_agent$local_metadata7.agent)||void 0===_agent$local_metadata8?void 0:_agent$local_metadata8.log_level)?agent.local_metadata.elastic.agent.log_level:"-"},{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentDetails.releaseLabel",{defaultMessage:"Agent release"}),description:"boolean"==typeof(null===(_agent$local_metadata9=agent.local_metadata)||void 0===_agent$local_metadata9||null===(_agent$local_metadata10=_agent$local_metadata9.elastic)||void 0===_agent$local_metadata10||null===(_agent$local_metadata11=_agent$local_metadata10.agent)||void 0===_agent$local_metadata11?void 0:_agent$local_metadata11.snapshot)?!0===agent.local_metadata.elastic.agent.snapshot?"snapshot":"stable":"-"},{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentDetails.platformLabel",{defaultMessage:"Platform"}),description:"string"==typeof(null===(_agent$local_metadata12=agent.local_metadata)||void 0===_agent$local_metadata12||null===(_agent$local_metadata13=_agent$local_metadata12.os)||void 0===_agent$local_metadata13?void 0:_agent$local_metadata13.platform)?agent.local_metadata.os.platform:"-"},{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentDetails.monitorLogsLabel",{defaultMessage:"Monitor logs"}),description:null!=agentPolicy&&null!==(_agentPolicy$monitori=agentPolicy.monitoring_enabled)&&void 0!==_agentPolicy$monitori&&_agentPolicy$monitori.includes("logs")?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentList.monitorLogsEnabledText",defaultMessage:"True"}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentList.monitorLogsDisabledText",defaultMessage:"False"})},{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentDetails.monitorMetricsLabel",{defaultMessage:"Monitor metrics"}),description:null!=agentPolicy&&null!==(_agentPolicy$monitori2=agentPolicy.monitoring_enabled)&&void 0!==_agentPolicy$monitori2&&_agentPolicy$monitori2.includes("metrics")?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentList.monitorMetricsEnabledText",defaultMessage:"True"}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentList.monitorMetricsDisabledText",defaultMessage:"False"})}].map(({title:title,description:description})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(agent_details_overview_FlexItemWithMinWidth,{grow:3},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionListTitle,null,title)),external_kbnSharedDeps_React_default.a.createElement(agent_details_overview_FlexItemWithMinWidth,{grow:7},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionListDescription,{className:"eui-textTruncate"},description))))))});function getLogsQueryByInputType(inputType){return"logfile"===inputType?"(datasets:!(elastic_agent.filebeat))":inputType.match(/\/metrics$/)?"(datasets:!(elastic_agent.metricbeat))":""}const agent_details_integrations_StyledEuiAccordion=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiAccordion).withConfig({displayName:"StyledEuiAccordion",componentId:"sc-12a1xr8-0"})([".ingest-integration-title-button{padding:",";}&.euiAccordion-isOpen .ingest-integration-title-button{border-bottom:1px solid ",";}.euiTableRow:last-child .euiTableRowCell{border-bottom:none;}.euiIEFlexWrapFix{min-width:0;}"],props=>props.theme.eui.paddingSizes.m,props=>props.theme.eui.euiColorLightShade),CollapsablePanel=({id:id,title:title,children:children})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPanel,{paddingSize:"none"},external_kbnSharedDeps_React_default.a.createElement(agent_details_integrations_StyledEuiAccordion,{id:id,arrowDisplay:"right",buttonClassName:"ingest-integration-title-button",buttonContent:title},children)),AgentDetailsIntegration=Object(external_kbnSharedDeps_React_.memo)(({agent:agent,agentPolicy:agentPolicy,packagePolicy:packagePolicy})=>{const{getHref:getHref}=Object(hooks.ib)(),inputs=Object(external_kbnSharedDeps_React_.useMemo)(()=>packagePolicy.inputs.filter(input=>input.enabled),[packagePolicy.inputs]),columns=[{field:"type",width:"100%",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentDetailsIntegrations.inputTypeLabel",{defaultMessage:"Input"}),render:inputType=>function(inputType){return"logfile"===inputType?external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentDetailsIntegrations.inputTypeLogText",{defaultMessage:"Logs"}):"endpoint"===inputType?external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentDetailsIntegrations.inputTypeEndpointText",{defaultMessage:"Endpoint"}):inputType.match(/\/metrics$/)?external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentDetailsIntegrations.inputTypeMetricsText",{defaultMessage:"Metrics"}):inputType}(inputType)},{align:"right",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentDetailsIntegrations.actionsLabel",{defaultMessage:"Actions"}),field:"type",width:"auto",render:inputType=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{content:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentDetailsIntegrations.viewLogsButton",{defaultMessage:"View logs"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{href:getHref("fleet_agent_details",{agentId:agent.id,tabId:"logs",logQuery:getLogsQueryByInputType(inputType)}),iconType:"editorAlignLeft"}))}];return external_kbnSharedDeps_React_default.a.createElement(CollapsablePanel,{id:packagePolicy.id,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("h3",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},packagePolicy.package?external_kbnSharedDeps_React_default.a.createElement(PackageIcon,{packageName:packagePolicy.package.name,version:packagePolicy.package.version,size:"l",tryApi:!0}):external_kbnSharedDeps_React_default.a.createElement(PackageIcon,{size:"l",packageName:"default",version:"0"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{className:"eui-textTruncate"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{className:"eui-textTruncate",href:getHref("edit_integration",{policyId:agentPolicy.id,packagePolicyId:packagePolicy.id})},packagePolicy.name)))))},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBasicTable,{tableLayout:"auto",items:inputs,columns:columns}))}),AgentDetailsIntegrationsSection=Object(external_kbnSharedDeps_React_.memo)(({agent:agent,agentPolicy:agentPolicy})=>agentPolicy&&agentPolicy.package_policies?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"column",gutterSize:"m"},agentPolicy.package_policies.map(packagePolicy=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,key:packagePolicy.id},external_kbnSharedDeps_React_default.a.createElement(AgentDetailsIntegration,{agent:agent,agentPolicy:agentPolicy,packagePolicy:packagePolicy})))):null),agent_details_FlexItemWithMinWidth=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiFlexItem).withConfig({displayName:"FlexItemWithMinWidth",componentId:"sc-1svqtoc-0"})(["min-width:0px;"]),AgentDetailsContent=Object(external_kbnSharedDeps_React_.memo)(({agent:agent,agentPolicy:agentPolicy})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"flexStart"},external_kbnSharedDeps_React_default.a.createElement(agent_details_FlexItemWithMinWidth,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"s"},external_kbnSharedDeps_React_default.a.createElement("h3",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentDetails.overviewSectionTitle",defaultMessage:"Overview"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(AgentDetailsOverviewSection,{agent:agent,agentPolicy:agentPolicy})),external_kbnSharedDeps_React_default.a.createElement(agent_details_FlexItemWithMinWidth,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"s"},external_kbnSharedDeps_React_default.a.createElement("h3",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentDetails.integrationsSectionTitle",defaultMessage:"Integrations"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(AgentDetailsIntegrationsSection,{agent:agent,agentPolicy:agentPolicy}))))),AgentDetailsPage=()=>{var _agentData$item,_agentData$item2,_agentData$item2$loca;const{params:{agentId:agentId,tabId:tabId=""}}=Object(external_kbnSharedDeps_ReactRouterDom_.useRouteMatch)(),{getHref:getHref}=Object(hooks.ib)(),kibanaVersion=Object(hooks.gb)(),{isLoading:isLoading,isInitialRequest:isInitialRequest,error:error,data:agentData,resendRequest:sendAgentRequest}=Object(hooks.U)(agentId,{pollIntervalMs:5e3}),{isLoading:isAgentPolicyLoading,data:agentPolicyData,sendRequest:sendAgentPolicyRequest}=Object(hooks.V)(null==agentData||null===(_agentData$item=agentData.item)||void 0===_agentData$item?void 0:_agentData$item.policy_id),{application:{navigateToApp:navigateToApp}}=Object(hooks.nb)(),routeState=useIntraAppState(),openReassignFlyoutOpenByDefault="true"===new URLSearchParams(Object(external_kbnSharedDeps_ReactRouterDom_.useLocation)().search).get("openReassignFlyout"),reassignCancelClickHandler=Object(external_kbnSharedDeps_React_.useCallback)(()=>{routeState&&routeState.onDoneNavigateTo&&navigateToApp(routeState.onDoneNavigateTo[0],routeState.onDoneNavigateTo[1])},[routeState,navigateToApp]),host=null==agentData||null===(_agentData$item2=agentData.item)||void 0===_agentData$item2||null===(_agentData$item2$loca=_agentData$item2.local_metadata)||void 0===_agentData$item2$loca?void 0:_agentData$item2$loca.host,headerLeftContent=Object(external_kbnSharedDeps_React_.useMemo)(()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"column",gutterSize:"s",alignItems:"flexStart"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{iconType:"arrowLeft",href:getHref("fleet_agent_list"),flush:"left",size:"xs"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentDetails.viewAgentListTitle",defaultMessage:"View all agents"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{className:"eui-textBreakWord"},external_kbnSharedDeps_React_default.a.createElement("h1",null,isLoading&&isInitialRequest?external_kbnSharedDeps_React_default.a.createElement(Loading,null):"object"==typeof host&&"string"==typeof(null==host?void 0:host.hostname)?host.hostname:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentDetails.agentDetailsTitle",defaultMessage:"Agent '{id}'",values:{id:agentId}}))))),[host,agentId,getHref,isInitialRequest,isLoading]),headerRightContent=Object(external_kbnSharedDeps_React_.useMemo)(()=>{var _agentPolicyData$item;return agentData&&agentData.item?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceBetween",direction:"row"},[{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentDetails.statusLabel",{defaultMessage:"Status"}),content:external_kbnSharedDeps_React_default.a.createElement(AgentHealth,{agent:agentData.item})},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentDetails.lastActivityLabel",{defaultMessage:"Last activity"}),content:agentData.item.last_checkin?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedRelative,{value:new Date(agentData.item.last_checkin)}):"-"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentDetails.policyLabel",{defaultMessage:"Policy"}),content:isAgentPolicyLoading?external_kbnSharedDeps_React_default.a.createElement(Loading,{size:"m"}):null!=agentPolicyData&&agentPolicyData.item?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{href:getHref("policy_details",{policyId:agentData.item.policy_id}),className:"eui-textBreakWord"},agentPolicyData.item.name||agentData.item.policy_id):agentData.item.policy_id||"-"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentDetails.agentVersionLabel",{defaultMessage:"Agent version"}),content:"object"==typeof agentData.item.local_metadata.elastic&&"object"==typeof agentData.item.local_metadata.elastic.agent&&"string"==typeof agentData.item.local_metadata.elastic.agent.version?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,className:"eui-textNoWrap"},agentData.item.local_metadata.elastic.agent.version),Object(services.l)(agentData.item,kibanaVersion)?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIconTip,{"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentDetails.upgradeAvailableTooltip",{defaultMessage:"Upgrade available"}),size:"m",type:"alert",color:"warning",content:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentDetails.upgradeAvailableTooltip",{defaultMessage:"Upgrade available"})})):null):"-"},{content:isAgentPolicyLoading||null!=agentPolicyData&&null!==(_agentPolicyData$item=agentPolicyData.item)&&void 0!==_agentPolicyData$item&&_agentPolicyData$item.is_managed?void 0:external_kbnSharedDeps_React_default.a.createElement(AgentDetailsActionMenu,{agent:agentData.item,assignFlyoutOpenByDefault:openReassignFlyoutOpenByDefault,onCancelReassign:routeState&&routeState.onDoneNavigateTo?reassignCancelClickHandler:void 0})}].map((item,index)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,key:index},item.label?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionList,{compressed:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionListTitle,null,item.label),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionListDescription,null,item.content)):item.content))):void 0},[agentPolicyData,agentData,getHref,isAgentPolicyLoading]),headerTabs=Object(external_kbnSharedDeps_React_.useMemo)(()=>[{id:"details",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentDetails.subTabs.detailsTab",{defaultMessage:"Agent details"}),href:getHref("fleet_agent_details",{agentId:agentId,tabId:"details"}),isSelected:!tabId||"details"===tabId},{id:"logs",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentDetails.subTabs.logsTab",{defaultMessage:"Logs"}),href:getHref("fleet_agent_details",{agentId:agentId,tabId:"logs"}),isSelected:"logs"===tabId}],[getHref,agentId,tabId]);return external_kbnSharedDeps_React_default.a.createElement(AgentRefreshContext.Provider,{value:{refresh:()=>{sendAgentRequest(),sendAgentPolicyRequest()}}},external_kbnSharedDeps_React_default.a.createElement(WithHeaderLayout,{leftColumn:headerLeftContent,rightColumn:headerRightContent,tabs:headerTabs},isLoading&&isInitialRequest?external_kbnSharedDeps_React_default.a.createElement(Loading,null):error?external_kbnSharedDeps_React_default.a.createElement(error_Error,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentDetails.unexceptedErrorTitle",defaultMessage:"Error loading agent"}),error:error}):agentData&&agentData.item?external_kbnSharedDeps_React_default.a.createElement(AgentDetailsPageContent,{agent:agentData.item,agentPolicy:null==agentPolicyData?void 0:agentPolicyData.item}):external_kbnSharedDeps_React_default.a.createElement(error_Error,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentDetails.agentNotFoundErrorTitle",defaultMessage:"Agent not found"}),error:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.agentDetails.agentNotFoundErrorDescription",{defaultMessage:"Cannot find agent ID {agentId}",values:{agentId:agentId}})})))},AgentDetailsPageContent=({agent:agent,agentPolicy:agentPolicy})=>(Object(hooks.J)("fleet_agent_details",{agentHost:"object"==typeof agent.local_metadata.host&&"string"==typeof agent.local_metadata.host.hostname?agent.local_metadata.host.hostname:"-"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Switch,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:constants.j.fleet_agent_details_logs,render:()=>external_kbnSharedDeps_React_default.a.createElement(AgentLogs,{agent:agent})}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:constants.j.fleet_agent_details,render:()=>external_kbnSharedDeps_React_default.a.createElement(AgentDetailsContent,{agent:agent,agentPolicy:agentPolicy})}))),NoDataLayout=Object(external_kbnSharedDeps_ReactRouterDom_.withRouter)(({actionSection:actionSection,title:title,modalClosePath:modalClosePath,children:children})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceAround"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageContent,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiEmptyPrompt,{iconType:"logoBeats",title:external_kbnSharedDeps_React_default.a.createElement("h2",null,title),body:children,actions:actionSection}))))),NoAccessPage=Object(external_kbnSharedDeps_KbnI18nReact_.injectI18n)(({intl:intl})=>external_kbnSharedDeps_React_default.a.createElement(NoDataLayout,{title:intl.formatMessage({id:"xpack.fleet.noAccess.accessDeniedTitle",defaultMessage:"Access denied"}),actionSection:[]},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.noAccess.accessDeniedDescription",defaultMessage:"You are not authorized to access Elastic Fleet. To use Elastic Fleet, you need a user role that contains read or all permissions for this application."}))));function new_enrollment_key_flyout_extends(){return(new_enrollment_key_flyout_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const NewEnrollmentTokenFlyout=({onClose:onClose,agentPolicies:agentPolicies=[]})=>{var _agentPolicies$find;const policyIdDefaultValue=null===(_agentPolicies$find=agentPolicies.find(agentPolicy=>agentPolicy.is_default))||void 0===_agentPolicies$find?void 0:_agentPolicies$find.id,form=function(policyIdDefaultValue,onSuccess){const{notifications:notifications}=Object(hooks.nb)(),[isLoading,setIsLoading]=Object(external_kbnSharedDeps_React_.useState)(!1),apiKeyNameInput=Object(hooks.eb)(""),policyIdInput=Object(hooks.eb)(policyIdDefaultValue);return{isLoading:isLoading,onSubmit:async event=>{event.preventDefault(),setIsLoading(!0);try{const res=await Object(hooks.F)({method:"post",path:services.g.getCreatePath(),body:JSON.stringify({name:apiKeyNameInput.value,policy_id:policyIdInput.value})});if(res.error)throw res.error;policyIdInput.clear(),apiKeyNameInput.clear(),setIsLoading(!1),onSuccess(res.data.item.id),notifications.toasts.addSuccess(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.newEnrollmentKey.keyCreatedToasts",{defaultMessage:"Enrollment token created."}))}catch(err){notifications.toasts.addError(err,{title:"Error"}),setIsLoading(!1)}},policyIdInput:policyIdInput,apiKeyNameInput:apiKeyNameInput}}(policyIdDefaultValue,()=>{onClose()}),body=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiForm,null,external_kbnSharedDeps_React_default.a.createElement("form",{onSubmit:form.onSubmit},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.newEnrollmentKey.nameLabel",{defaultMessage:"Name"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldText,new_enrollment_key_flyout_extends({required:!0,name:"name",autoComplete:"off"},form.apiKeyNameInput.props))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.newEnrollmentKey.policyLabel",{defaultMessage:"Policy"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSelect,new_enrollment_key_flyout_extends({required:!0,defaultValue:policyIdDefaultValue},form.policyIdInput.props,{options:agentPolicies.filter(agentPolicy=>!agentPolicy.is_managed).map(agentPolicy=>({value:agentPolicy.id,text:agentPolicy.name}))}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{type:"submit",fill:!0,isLoading:form.isLoading},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.newEnrollmentKey.submitButton",defaultMessage:"Create enrollment token"}))));return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyout,{onClose:onClose,size:"l",maxWidth:640},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyoutHeader,{hasBorder:!0,"aria-labelledby":"FleetNewEnrollmentKeyFlyoutTitle"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"m"},external_kbnSharedDeps_React_default.a.createElement("h2",{id:"FleetNewEnrollmentKeyFlyoutTitle"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.newEnrollmentKey.flyoutTitle",defaultMessage:"Create enrollment token"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyoutBody,null,body),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyoutFooter,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{onClick:onClose,flush:"left"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.newEnrollmentKey.cancelButtonLabel",defaultMessage:"Cancel"}))))))},ConfirmEnrollmentTokenDelete=props=>{const{onCancel:onCancel,onConfirm:onConfirm,enrollmentKey:enrollmentKey}=props;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiConfirmModal,{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.enrollmentTokenDeleteModal.title",{defaultMessage:"Revoke enrollment token"}),onCancel:onCancel,onConfirm:onConfirm,cancelButtonText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.enrollmentTokenDeleteModal.cancelButton",{defaultMessage:"Cancel"}),confirmButtonText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.enrollmentTokenDeleteModal.deleteButton",{defaultMessage:"Revoke enrollment token"}),defaultFocusedButton:"confirm",buttonColor:"danger"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.enrollmentTokenDeleteModal.description",{defaultMessage:"Are your sure you want to revoke {keyName}? New agents will no longer be able to be enrolled using this token.",values:{keyName:enrollmentKey.name}}),color:"danger"}))},ApiKeyField=({apiKeyId:apiKeyId})=>{const{notifications:notifications}=Object(hooks.nb)(),[state,setState]=Object(external_kbnSharedDeps_React_.useState)("HIDDEN"),[key,setKey]=Object(external_kbnSharedDeps_React_.useState)();return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",gutterSize:"xs"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{color:"subdued",size:"xs"},"VISIBLE"===state?key:"â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢â¢")),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{content:"VISIBLE"===state?external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.enrollmentTokensList.hideTokenButtonLabel",{defaultMessage:"Hide token"}):external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.enrollmentTokensList.showTokenButtonLabel",{defaultMessage:"Show token"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{"aria-label":"VISIBLE"===state?external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.enrollmentTokensList.hideTokenButtonLabel",{defaultMessage:"Hide token"}):external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.enrollmentTokensList.showTokenButtonLabel",{defaultMessage:"Show token"}),color:"text",isDisabled:"LOADING"===state,onClick:async()=>{if("VISIBLE"===state)setState("HIDDEN");else if("HIDDEN"===state)try{var _res$data;setState("LOADING");const res=await Object(hooks.r)(apiKeyId);if(res.error)throw res.error;setKey(null===(_res$data=res.data)||void 0===_res$data?void 0:_res$data.item.api_key),setState("VISIBLE")}catch(err){notifications.toasts.addError(err,{title:"Error"}),setState("HIDDEN")}},iconType:"VISIBLE"===state?"eyeClosed":"eye"}))))},DeleteButton=({apiKey:apiKey,refresh:refresh})=>{const{notifications:notifications}=Object(hooks.nb)(),[state,setState]=Object(external_kbnSharedDeps_React_.useState)("CONFIRM_HIDDEN");return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,"CONFIRM_VISIBLE"===state&&external_kbnSharedDeps_React_default.a.createElement(ConfirmEnrollmentTokenDelete,{enrollmentKey:apiKey,onCancel:()=>setState("CONFIRM_HIDDEN"),onConfirm:async()=>{try{const res=await Object(hooks.i)(apiKey.id);if(res.error)throw res.error}catch(err){notifications.toasts.addError(err,{title:"Error"})}setState("CONFIRM_HIDDEN"),refresh()}}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{content:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.enrollmentTokensList.revokeTokenButtonLabel",{defaultMessage:"Revoke token"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.enrollmentTokensList.revokeTokenButtonLabel",{defaultMessage:"Revoke token"}),onClick:()=>setState("CONFIRM_VISIBLE"),iconType:"trash",color:"danger"})))},EnrollmentTokenListPage=()=>{var _enrollmentAPIKeysReq,_enrollmentAPIKeysReq2,_enrollmentAPIKeysReq3;Object(hooks.J)("fleet_enrollment_tokens");const[flyoutOpen,setFlyoutOpen]=Object(external_kbnSharedDeps_React_.useState)(!1),[search,setSearch]=Object(external_kbnSharedDeps_React_.useState)(""),{pagination:pagination,setPagination:setPagination,pageSizeOptions:pageSizeOptions}=Object(hooks.kb)(),enrollmentAPIKeysRequest=Object(hooks.S)({page:pagination.currentPage,perPage:pagination.pageSize,kuery:""!==search.trim()?search:void 0}),agentPoliciesRequest=Object(hooks.O)({page:1,perPage:1e3}),agentPolicies=agentPoliciesRequest.data?agentPoliciesRequest.data.items:[],agentPoliciesById=agentPolicies.reduce((acc,policy)=>(acc[policy.id]=policy,acc),{}),total=null!==(_enrollmentAPIKeysReq=null==enrollmentAPIKeysRequest||null===(_enrollmentAPIKeysReq2=enrollmentAPIKeysRequest.data)||void 0===_enrollmentAPIKeysReq2?void 0:_enrollmentAPIKeysReq2.total)&&void 0!==_enrollmentAPIKeysReq?_enrollmentAPIKeysReq:0,rowItems=(null==enrollmentAPIKeysRequest||null===(_enrollmentAPIKeysReq3=enrollmentAPIKeysRequest.data)||void 0===_enrollmentAPIKeysReq3?void 0:_enrollmentAPIKeysReq3.list.filter(enrollmentKey=>{if(!agentPolicies.length||!enrollmentKey.policy_id)return!1;const agentPolicy=agentPoliciesById[enrollmentKey.policy_id];return!(null!=agentPolicy&&agentPolicy.is_managed)}))||[],columns=[{field:"name",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.enrollmentTokensList.nameTitle",{defaultMessage:"Name"}),render:value=>external_kbnSharedDeps_React_default.a.createElement("span",{className:"eui-textTruncate",title:value},value)},{field:"id",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.enrollmentTokensList.secretTitle",{defaultMessage:"Secret"}),width:"215px",render:apiKeyId=>external_kbnSharedDeps_React_default.a.createElement(ApiKeyField,{apiKeyId:apiKeyId})},{field:"policy_id",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.enrollmentTokensList.policyTitle",{defaultMessage:"Agent policy"}),render:policyId=>{const agentPolicy=agentPoliciesById[policyId],value=agentPolicy?agentPolicy.name:policyId;return external_kbnSharedDeps_React_default.a.createElement("span",{className:"eui-textTruncate",title:value},value)}},{field:"created_at",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.enrollmentTokensList.createdAtTitle",{defaultMessage:"Created on"}),width:"150px",render:createdAt=>createdAt?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedDate,{year:"numeric",month:"short",day:"2-digit",value:createdAt}):null},{field:"active",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.enrollmentTokensList.activeTitle",{defaultMessage:"Active"}),width:"70px",align:"center",render:active=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{size:"m",color:active?"success":"danger",type:"dot"})},{field:"actions",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.enrollmentTokensList.actionsTitle",{defaultMessage:"Actions"}),width:"70px",render:(_,apiKey)=>{const agentPolicy=agentPolicies.find(c=>c.id===apiKey.policy_id);return apiKey.active&&!(null!=agentPolicy&&agentPolicy.is_managed)&&external_kbnSharedDeps_React_default.a.createElement(DeleteButton,{apiKey:apiKey,refresh:()=>enrollmentAPIKeysRequest.resendRequest()})}}];return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,flyoutOpen&&external_kbnSharedDeps_React_default.a.createElement(NewEnrollmentTokenFlyout,{agentPolicies:agentPolicies,onClose:()=>{setFlyoutOpen(!1),enrollmentAPIKeysRequest.resendRequest()}}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{color:"subdued"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.enrollmentTokensList.pageDescription",defaultMessage:"Create and revoke enrollment tokens. An enrollment token enables one or more agents to enroll in Fleet and send data."})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(SearchBar,{value:search,onChange:newSearch=>{setPagination({...pagination,currentPage:1}),setSearch(newSearch)},indexPattern:constants.f})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{iconType:"plusInCircle",onClick:()=>setFlyoutOpen(!0)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.enrollmentTokensList.newKeyButton",defaultMessage:"Create enrollment token"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBasicTable,{loading:enrollmentAPIKeysRequest.isLoading&&enrollmentAPIKeysRequest.isInitialRequest,hasActions:!0,noItemsMessage:enrollmentAPIKeysRequest.isLoading&&enrollmentAPIKeysRequest.isInitialRequest?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.enrollemntAPIKeyList.loadingTokensMessage",defaultMessage:"Loading enrollment tokens..."}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.enrollemntAPIKeyList.emptyMessage",defaultMessage:"No enrollment tokens found."}),items:total?rowItems:[],itemId:"id",columns:columns,pagination:{pageIndex:pagination.currentPage-1,pageSize:pagination.pageSize,totalItemCount:total,pageSizeOptions:pageSizeOptions},onChange:({page:page})=>{const newPagination={...pagination,currentPage:page.index+1,pageSize:page.size};setPagination(newPagination)}}))},ListLayout=({children:children})=>{const{getHref:getHref}=Object(hooks.ib)(),hasWriteCapabilites=Object(hooks.K)().write,[isEnrollmentFlyoutOpen,setIsEnrollmentFlyoutOpen]=external_kbnSharedDeps_React_default.a.useState(!1),headerRightColumn=hasWriteCapabilites?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"flexEnd"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{fill:!0,iconType:"plusInCircle",onClick:()=>setIsEnrollmentFlyoutOpen(!0)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentList.enrollButton",defaultMessage:"Add agent"})))):void 0,headerLeftColumn=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"column",gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement("h1",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agents.pageTitle",defaultMessage:"Agents"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{color:"subdued"},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agents.pageSubtitle",defaultMessage:"Manage and deploy policy updates to a group of agents of any size."}))))),agentPoliciesRequest=Object(hooks.O)({page:1,perPage:1e3}),agentPolicies=agentPoliciesRequest.data?agentPoliciesRequest.data.items:[],routeMatch=Object(external_kbnSharedDeps_ReactRouterDom_.useRouteMatch)();return external_kbnSharedDeps_React_default.a.createElement(WithHeaderLayout,{leftColumn:headerLeftColumn,rightColumn:headerRightColumn,tabs:[{name:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.listTabs.agentTitle",defaultMessage:"Agents"}),isSelected:routeMatch.path===constants.j.fleet_agent_list,href:getHref("fleet_agent_list")},{name:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.listTabs.enrollmentTokensTitle",defaultMessage:"Enrollment tokens"}),isSelected:routeMatch.path===constants.j.fleet_enrollment_tokens,href:getHref("fleet_enrollment_tokens")}]},isEnrollmentFlyoutOpen?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPortal,null,external_kbnSharedDeps_React_default.a.createElement(AgentEnrollmentFlyout,{agentPolicies:agentPolicies,onClose:()=>setIsEnrollmentFlyoutOpen(!1)})):null,children)},FleetServerUpgradeModal=({onClose:onClose})=>{const{getAssetsPath:getAssetsPath}=Object(hooks.ib)(),{notifications:notifications,cloud:cloud}=Object(hooks.nb)(),isCloud=!(null==cloud||!cloud.cloudId),[checked,setChecked]=Object(external_kbnSharedDeps_React_.useState)(!1),[isAgentsAndPoliciesLoaded,setAgentsAndPoliciesLoaded]=Object(external_kbnSharedDeps_React_.useState)(!1);Object(external_kbnSharedDeps_React_.useEffect)(()=>{!async function(){try{const agentPoliciesAlreadyChecked={},res=await Object(hooks.m)({page:1,perPage:10,showInactive:!1});if(res.error)throw res.error;for(const agent of null!==(_res$data$list=null===(_res$data=res.data)||void 0===_res$data?void 0:_res$data.list)&&void 0!==_res$data$list?_res$data$list:[]){var _res$data$list,_res$data,_some,_policyRes$data;if(!agent.policy_id||agentPoliciesAlreadyChecked[agent.policy_id])continue;agentPoliciesAlreadyChecked[agent.policy_id]=!0;const policyRes=await Object(hooks.p)(agent.policy_id);if(!(null!==(_some=(null===(_policyRes$data=policyRes.data)||void 0===_policyRes$data?void 0:_policyRes$data.item.package_policies).some(p=>{var _p$package;return(null===(_p$package=p.package)||void 0===_p$package?void 0:_p$package.name)===constants.g}))&&void 0!==_some&&_some))return await Object(hooks.D)({has_seen_fleet_migration_notice:!0}),void onClose()}setAgentsAndPoliciesLoaded(!0)}catch(err){notifications.toasts.addError(err,{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.fleetServerUpgradeModal.errorLoadingAgents",{defaultMessage:"Error loading agents"})})}}()},[notifications.toasts,onClose]);const onChange=Object(external_kbnSharedDeps_React_.useCallback)(async()=>{try{setChecked(!checked),await Object(hooks.D)({has_seen_fleet_migration_notice:!checked})}catch(error){notifications.toasts.addError(error,{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.fleetServerUpgradeModal.failedUpdateTitle",{defaultMessage:"Error saving settings"})})}},[checked,setChecked,notifications]);return isAgentsAndPoliciesLoaded?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModal,{onClose:onClose},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalHeader,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalHeaderTitle,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.fleetServerUpgradeModal.modalTitle",defaultMessage:"Enroll your agents into Fleet Server"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalBody,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiImage,{size:"fullWidth",src:getAssetsPath("./announcement.jpg"),alt:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.fleetServerUpgradeModal.announcementImageAlt",{defaultMessage:"Fleet Server upgrade announcement"})}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,isCloud?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.fleetServerUpgradeModal.cloudDescriptionMessage",defaultMessage:"Fleet Server is now available and it provides improved scalability and security. If you already had an APM instance on Elastic Cloud, we've upgraded it to APM & Fleet. If not, you can add one to your deployment for free. {existingAgentsMessage} To continue using Fleet, you must use Fleet Server and install the new version of Elastic Agent on each host.",values:{existingAgentsMessage:external_kbnSharedDeps_React_default.a.createElement("strong",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.fleetServerUpgradeModal.existingAgentText",defaultMessage:"Your existing Elastic Agents have been automatically unenrolled and have stopped sending data."}))}}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.fleetServerUpgradeModal.onPremDescriptionMessage",defaultMessage:"Fleet Server is now available and it provides improved scalability and security. {existingAgentsMessage} To continue using Fleet, you must install a Fleet Server and the new version of Elastic Agent on each host. Learn more in our {link}.",values:{existingAgentsMessage:external_kbnSharedDeps_React_default.a.createElement("strong",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.fleetServerUpgradeModal.existingAgentText",defaultMessage:"Your existing Elastic Agents have been automatically unenrolled and have stopped sending data."})),link:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{href:"https://ela.st/add-fleet-server",external:!0,target:"_blank"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.fleetServerUpgradeModal.fleetServerMigrationGuide",defaultMessage:"Fleet Server migration guide"}))}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.fleetServerUpgradeModal.breakingChangeMessage",defaultMessage:"This is a breaking change, which is why we are making it in a beta release. We are sorry for the inconvenience. Please share {link} if you have questions or need help.",values:{link:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{href:"https://ela.st/fleet-feedback",target:"_blank"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.fleetServerUpgradeModal.fleetFeedbackLink",defaultMessage:"feedback"}))}}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalFooter,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCheckbox,{id:"fleetServerModalCheckbox",label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.fleetServerUpgradeModal.checkboxLabel",{defaultMessage:"Do not show this message again"}),checked:checked,onChange:onChange})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{fill:!0,onClick:onClose},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.fleetServerUpgradeModal.closeButton",defaultMessage:"Close and get started"})))))):null},FleetApp=()=>{var _fleetStatus$missingR;Object(hooks.J)("fleet");const{agents:agents}=Object(hooks.M)(),capabilities=Object(hooks.K)(),fleetStatus=Object(hooks.N)(),settings=Object(hooks.db)(),[fleetServerModalVisible,setFleetServerModalVisible]=Object(external_kbnSharedDeps_React_.useState)(!1),onCloseFleetServerModal=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setFleetServerModalVisible(!1)},[setFleetServerModalVisible]);if(Object(external_kbnSharedDeps_React_.useEffect)(()=>{var _settings$data;settings.data&&!1===(null===(_settings$data=settings.data)||void 0===_settings$data?void 0:_settings$data.item.has_seen_fleet_migration_notice)&&setFleetServerModalVisible(!0)},[settings.data]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{if(!agents.enabled||fleetStatus.isLoading||!fleetStatus.missingRequirements||!fleetStatus.missingRequirements.includes("fleet_server"))return;const interval=setInterval(()=>{fleetStatus.refresh()},3e4);return()=>{clearInterval(interval)}},[fleetStatus,agents.enabled]),!agents.enabled)return null;if(!fleetStatus.missingRequirements&&fleetStatus.isLoading)return external_kbnSharedDeps_React_default.a.createElement(Loading,null);if(fleetStatus.error)return external_kbnSharedDeps_React_default.a.createElement(WithoutHeaderLayout,null,external_kbnSharedDeps_React_default.a.createElement(error_Error,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.agentsInitializationErrorMessageTitle",defaultMessage:"Unable to initialize central management for Elastic Agents"}),error:fleetStatus.error}));const hasOnlyFleetServerMissingRequirement=1===(null==fleetStatus||null===(_fleetStatus$missingR=fleetStatus.missingRequirements)||void 0===_fleetStatus$missingR?void 0:_fleetStatus$missingR.length)&&"fleet_server"===fleetStatus.missingRequirements[0];return!hasOnlyFleetServerMissingRequirement&&fleetStatus.missingRequirements&&fleetStatus.missingRequirements.length>0?external_kbnSharedDeps_React_default.a.createElement(MissingESRequirementsPage,{missingRequirements:fleetStatus.missingRequirements}):capabilities.read?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.HashRouter,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Switch,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:constants.j.fleet,exact:!0,render:()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Redirect,{to:constants.j.fleet_agent_list})}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:constants.j.fleet_agent_details},external_kbnSharedDeps_React_default.a.createElement(AgentDetailsPage,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:constants.j.fleet_agent_list},external_kbnSharedDeps_React_default.a.createElement(ListLayout,null,fleetServerModalVisible&&external_kbnSharedDeps_React_default.a.createElement(FleetServerUpgradeModal,{onClose:onCloseFleetServerModal}),hasOnlyFleetServerMissingRequirement?external_kbnSharedDeps_React_default.a.createElement(FleetServerRequirementPage,null):external_kbnSharedDeps_React_default.a.createElement(AgentListPage,null))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:constants.j.fleet_enrollment_tokens},external_kbnSharedDeps_React_default.a.createElement(ListLayout,null,external_kbnSharedDeps_React_default.a.createElement(EnrollmentTokenListPage,null))))):external_kbnSharedDeps_React_default.a.createElement(NoAccessPage,null)},StyledPanel=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiPanel).attrs(props=>({paddingSize:"m"})).withConfig({displayName:"StyledPanel",componentId:"sc-1s2ob2x-0"})(["header{display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid ",";margin:-"," -"," ",";padding:"," ",";}h2{padding:"," 0;}"],props=>props.theme.eui.euiColorLightShade,props=>props.theme.eui.paddingSizes.m,props=>props.theme.eui.paddingSizes.m,props=>props.theme.eui.paddingSizes.m,props=>props.theme.eui.paddingSizes.s,props=>props.theme.eui.paddingSizes.m,props=>props.theme.eui.paddingSizes.xs),OverviewPanel=({title:title,tooltip:tooltip,linkToText:linkToText,linkTo:linkTo,children:children})=>external_kbnSharedDeps_React_default.a.createElement(StyledPanel,null,external_kbnSharedDeps_React_default.a.createElement("header",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{responsive:!1,gutterSize:"xs",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("h2",null,title))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIconTip,{content:tooltip,position:"top",type:"iInCircle",color:"subdued"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{size:"xs",flush:"right",href:linkTo},linkToText)),children),OverviewStats=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiDescriptionList).attrs(props=>({compressed:!0,textStyle:"reverse",type:"column"})).withConfig({displayName:"OverviewStats",componentId:"pe4hxx-0"})(["& > *{margin-top:"," !important;&:first-child,&:nth-child(2){margin-top:0 !important;}}"],props=>props.theme.eui.paddingSizes.s),OverviewAgentSection=()=>{var _agentStatusRequest$d,_agentStatusRequest$d2,_agentStatusRequest$d3,_agentStatusRequest$d4,_agentStatusRequest$d5,_agentStatusRequest$d6,_agentStatusRequest$d7,_agentStatusRequest$d8,_agentStatusRequest$d9,_agentStatusRequest$d10,_agentStatusRequest$d11,_agentStatusRequest$d12;const{getHref:getHref}=Object(hooks.ib)(),agentStatusRequest=Object(hooks.P)({});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{component:"section","data-test-subj":"fleet-agent-section"},external_kbnSharedDeps_React_default.a.createElement(OverviewPanel,{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.overviewPageAgentsPanelTitle",{defaultMessage:"Agents"}),tooltip:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.overviewPageFleetPanelTooltip",{defaultMessage:"Use Fleet to enroll agents and manage their policies from a central location."}),linkTo:getHref("fleet_agent_list"),linkToText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.overviewPageFleetPanelAction",{defaultMessage:"View agents"})},external_kbnSharedDeps_React_default.a.createElement(OverviewStats,null,agentStatusRequest.isLoading?external_kbnSharedDeps_React_default.a.createElement(loading_Loading,null):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionListTitle,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.overviewAgentTotalTitle",defaultMessage:"Total agents"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionListDescription,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiI18nNumber,{value:null!==(_agentStatusRequest$d=null===(_agentStatusRequest$d2=agentStatusRequest.data)||void 0===_agentStatusRequest$d2||null===(_agentStatusRequest$d3=_agentStatusRequest$d2.results)||void 0===_agentStatusRequest$d3?void 0:_agentStatusRequest$d3.total)&&void 0!==_agentStatusRequest$d?_agentStatusRequest$d:0})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionListTitle,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.overviewAgentActiveTitle",defaultMessage:"Active"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionListDescription,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiI18nNumber,{value:null!==(_agentStatusRequest$d4=null===(_agentStatusRequest$d5=agentStatusRequest.data)||void 0===_agentStatusRequest$d5||null===(_agentStatusRequest$d6=_agentStatusRequest$d5.results)||void 0===_agentStatusRequest$d6?void 0:_agentStatusRequest$d6.online)&&void 0!==_agentStatusRequest$d4?_agentStatusRequest$d4:0})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionListTitle,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.overviewAgentOfflineTitle",defaultMessage:"Offline"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionListDescription,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiI18nNumber,{value:null!==(_agentStatusRequest$d7=null===(_agentStatusRequest$d8=agentStatusRequest.data)||void 0===_agentStatusRequest$d8||null===(_agentStatusRequest$d9=_agentStatusRequest$d8.results)||void 0===_agentStatusRequest$d9?void 0:_agentStatusRequest$d9.offline)&&void 0!==_agentStatusRequest$d7?_agentStatusRequest$d7:0})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionListTitle,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.overviewAgentErrorTitle",defaultMessage:"Error"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionListDescription,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiI18nNumber,{value:null!==(_agentStatusRequest$d10=null===(_agentStatusRequest$d11=agentStatusRequest.data)||void 0===_agentStatusRequest$d11||null===(_agentStatusRequest$d12=_agentStatusRequest$d11.results)||void 0===_agentStatusRequest$d12?void 0:_agentStatusRequest$d12.error)&&void 0!==_agentStatusRequest$d10?_agentStatusRequest$d10:0}))))))},OverviewPolicySection=({agentPolicies:agentPolicies})=>{var _packagePoliciesReque,_packagePoliciesReque2;const{getHref:getHref}=Object(hooks.ib)(),packagePoliciesRequest=Object(hooks.ab)({page:1,perPage:constants.l});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{component:"section","data-test-subj":"fleet-agent-policy-section"},external_kbnSharedDeps_React_default.a.createElement(OverviewPanel,{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.overviewPagePoliciesPanelTitle",{defaultMessage:"Agent policies"}),tooltip:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.overviewPagePoliciesPanelTooltip",{defaultMessage:"Use agent policies to control the data that your agents collect."}),linkTo:getHref("policies_list"),linkToText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.overviewPagePoliciesPanelAction",{defaultMessage:"View policies"})},external_kbnSharedDeps_React_default.a.createElement(OverviewStats,null,packagePoliciesRequest.isLoading?external_kbnSharedDeps_React_default.a.createElement(loading_Loading,null):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionListTitle,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.overviewPolicyTotalTitle",defaultMessage:"Total available"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionListDescription,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiI18nNumber,{value:agentPolicies.length})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionListTitle,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.overviewPackagePolicyTitle",defaultMessage:"Used integrations"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionListDescription,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiI18nNumber,{value:null!==(_packagePoliciesReque=null===(_packagePoliciesReque2=packagePoliciesRequest.data)||void 0===_packagePoliciesReque2?void 0:_packagePoliciesReque2.total)&&void 0!==_packagePoliciesReque?_packagePoliciesReque:0}))))))},OverviewIntegrationSection=()=>{var _packagesRequest$data,_res$length,_res$filter$length,_res$filter,_res$filter$length2,_res$filter2;const{getHref:getHref}=Object(hooks.ib)(),packagesRequest=Object(hooks.cb)(),res=null===(_packagesRequest$data=packagesRequest.data)||void 0===_packagesRequest$data?void 0:_packagesRequest$data.response,total=null!==(_res$length=null==res?void 0:res.length)&&void 0!==_res$length?_res$length:0,installed=null!==(_res$filter$length=null==res||null===(_res$filter=res.filter(p=>p.status===common_constants.lb.Installed))||void 0===_res$filter?void 0:_res$filter.length)&&void 0!==_res$filter$length?_res$filter$length:0,updatablePackages=null!==(_res$filter$length2=null==res||null===(_res$filter2=res.filter(item=>"savedObject"in item&&item.version>item.savedObject.attributes.version))||void 0===_res$filter2?void 0:_res$filter2.length)&&void 0!==_res$filter$length2?_res$filter$length2:0;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{component:"section","data-test-subj":"fleet-integrations-section"},external_kbnSharedDeps_React_default.a.createElement(OverviewPanel,{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.overviewPageIntegrationsPanelTitle",{defaultMessage:"Integrations"}),tooltip:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.overviewPageIntegrationsPanelTooltip",{defaultMessage:"Browse and install integrations for the Elastic Stack. Add integrations to your agent policies to start sending data."}),linkTo:getHref("integrations_all"),linkToText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.overviewPageIntegrationsPanelAction",{defaultMessage:"View integrations"})},external_kbnSharedDeps_React_default.a.createElement(OverviewStats,null,packagesRequest.isLoading?external_kbnSharedDeps_React_default.a.createElement(loading_Loading,null):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionListTitle,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.overviewIntegrationsTotalTitle",defaultMessage:"Total available"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionListDescription,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiI18nNumber,{value:total})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionListTitle,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.overviewIntegrationsInstalledTitle",defaultMessage:"Installed"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionListDescription,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiI18nNumber,{value:installed})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionListTitle,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.overviewIntegrationsUpdatesAvailableTitle",defaultMessage:"Updates available"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionListDescription,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiI18nNumber,{value:updatablePackages}))))))},OverviewDatastreamSection=()=>{var _datastreamRequest$da,_datastreamRequest$da2,_datastreamRequest$da3;const{getHref:getHref}=Object(hooks.ib)(),datastreamRequest=Object(hooks.R)(),{data:{fieldFormats:fieldFormats}}=Object(hooks.nb)(),total=null!==(_datastreamRequest$da=null===(_datastreamRequest$da2=datastreamRequest.data)||void 0===_datastreamRequest$da2||null===(_datastreamRequest$da3=_datastreamRequest$da2.data_streams)||void 0===_datastreamRequest$da3?void 0:_datastreamRequest$da3.length)&&void 0!==_datastreamRequest$da?_datastreamRequest$da:0;let sizeBytes=0;const namespaces=new Set;let size;datastreamRequest.data&&datastreamRequest.data.data_streams.forEach(val=>{namespaces.add(val.namespace),sizeBytes+=val.size_in_bytes});try{size=fieldFormats.getInstance("bytes").convert(sizeBytes)}catch(e){size=sizeBytes+"b"}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{component:"section","data-test-subj":"fleet-datastream-section"},external_kbnSharedDeps_React_default.a.createElement(OverviewPanel,{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.overviewPageDataStreamsPanelTitle",{defaultMessage:"Data streams"}),tooltip:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.overviewPageDataStreamsPanelTooltip",{defaultMessage:"Data that your agents collect are organized into various data streams."}),linkTo:getHref("data_streams"),linkToText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.overviewPageDataStreamsPanelAction",{defaultMessage:"View data streams"})},external_kbnSharedDeps_React_default.a.createElement(OverviewStats,null,datastreamRequest.isLoading?external_kbnSharedDeps_React_default.a.createElement(loading_Loading,null):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionListTitle,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.overviewDatastreamTotalTitle",defaultMessage:"Data streams"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionListDescription,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiI18nNumber,{value:total})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionListTitle,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.overviewDatastreamNamespacesTitle",defaultMessage:"Namespaces"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionListDescription,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiI18nNumber,{value:namespaces.size})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionListTitle,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.overviewDatastreamSizeTitle",defaultMessage:"Total size"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionListDescription,null,size)))))},IngestManagerOverview=()=>{Object(hooks.J)("overview");const[isEnrollmentFlyoutOpen,setIsEnrollmentFlyoutOpen]=Object(external_kbnSharedDeps_React_.useState)(!1),agentPoliciesRequest=Object(hooks.O)({page:1,perPage:1e3}),agentPolicies=agentPoliciesRequest.data?agentPoliciesRequest.data.items:[];return external_kbnSharedDeps_React_default.a.createElement(WithHeaderLayout,{leftColumn:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"column",gutterSize:"m"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{responsive:!1,gutterSize:"s",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"l"},external_kbnSharedDeps_React_default.a.createElement("h1",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.overviewPageTitle",defaultMessage:"Fleet"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBetaBadge,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.betaBadge.labelText",{defaultMessage:"Beta"}),tooltipContent:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.betaBadge.tooltipText",{defaultMessage:"This plugin is not recommended for production environments. Please report bugs in our Discuss forum."})})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{color:"subdued"},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.overviewPageSubtitle",defaultMessage:"Manage Elastic Agents and their policies in a central location."}))))),rightColumn:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"flexEnd"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{fill:!0,iconType:"plusInCircle",onClick:()=>setIsEnrollmentFlyoutOpen(!0)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.overviewPageEnrollAgentButton",defaultMessage:"Add agent"}))))},isEnrollmentFlyoutOpen&&external_kbnSharedDeps_React_default.a.createElement(AgentEnrollmentFlyout,{agentPolicies:agentPolicies,onClose:()=>setIsEnrollmentFlyoutOpen(!1)}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGrid,{gutterSize:"l",columns:2},external_kbnSharedDeps_React_default.a.createElement(OverviewIntegrationSection,null),external_kbnSharedDeps_React_default.a.createElement(OverviewPolicySection,{agentPolicies:agentPolicies}),external_kbnSharedDeps_React_default.a.createElement(OverviewAgentSection,null),external_kbnSharedDeps_React_default.a.createElement(OverviewDatastreamSection,null)))},ErrorLayout=({children:children})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiErrorBoundary,null,external_kbnSharedDeps_React_default.a.createElement(DefaultLayout,{showSettings:!1},external_kbnSharedDeps_React_default.a.createElement(WithoutHeaderLayout,null,children))),app_Panel=external_kbnSharedDeps_StyledComponents_default()(external_kbnSharedDeps_ElasticEui_.EuiPanel).withConfig({displayName:"Panel",componentId:"sc-11e0awm-0"})(["max-width:500px;margin-right:auto;margin-left:auto;"]),WithPermissionsAndSetup=Object(external_kbnSharedDeps_React_.memo)(({children:children})=>{Object(hooks.J)("base");const{notifications:notifications}=Object(hooks.nb)(),[isPermissionsLoading,setIsPermissionsLoading]=Object(external_kbnSharedDeps_React_.useState)(!1),[permissionsError,setPermissionsError]=Object(external_kbnSharedDeps_React_.useState)(),[isInitialized,setIsInitialized]=Object(external_kbnSharedDeps_React_.useState)(!1),[initializationError,setInitializationError]=Object(external_kbnSharedDeps_React_.useState)(null);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{(async()=>{setIsPermissionsLoading(!1),setPermissionsError(void 0),setIsInitialized(!1),setInitializationError(null);try{var _permissionsResponse$;setIsPermissionsLoading(!0);const permissionsResponse=await Object(hooks.u)();if(setIsPermissionsLoading(!1),null!==(_permissionsResponse$=permissionsResponse.data)&&void 0!==_permissionsResponse$&&_permissionsResponse$.success){try{var _setupResponse$data,_setupResponse$data$n;const setupResponse=await Object(hooks.G)();setupResponse.error&&setInitializationError(setupResponse.error),null!==(_setupResponse$data=setupResponse.data)&&void 0!==_setupResponse$data&&null!==(_setupResponse$data$n=_setupResponse$data.nonFatalErrors)&&void 0!==_setupResponse$data$n&&_setupResponse$data$n.length&&notifications.toasts.addError(setupResponse.data.nonFatalErrors[0],{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.setup.uiPreconfigurationErrorTitle",{defaultMessage:"Configuration error"})})}catch(err){setInitializationError(err)}setIsInitialized(!0)}else{var _permissionsResponse$2;setPermissionsError((null===(_permissionsResponse$2=permissionsResponse.data)||void 0===_permissionsResponse$2?void 0:_permissionsResponse$2.error)||"REQUEST_ERROR")}}catch(err){setPermissionsError("REQUEST_ERROR")}})()},[notifications.toasts]),isPermissionsLoading||permissionsError?external_kbnSharedDeps_React_default.a.createElement(ErrorLayout,null,isPermissionsLoading?external_kbnSharedDeps_React_default.a.createElement(Loading,null):"REQUEST_ERROR"===permissionsError?external_kbnSharedDeps_React_default.a.createElement(error_Error,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.permissionsRequestErrorMessageTitle",defaultMessage:"Unable to check permissions"}),error:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.fleet.permissionsRequestErrorMessageDescription",{defaultMessage:"There was a problem checking Fleet permissions"})}):external_kbnSharedDeps_React_default.a.createElement(app_Panel,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiEmptyPrompt,{iconType:"securityApp",title:external_kbnSharedDeps_React_default.a.createElement("h2",null,"MISSING_SUPERUSER_ROLE"===permissionsError?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.permissionDeniedErrorTitle",defaultMessage:"Permission denied"}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.securityRequiredErrorTitle",defaultMessage:"Security is not enabled"})),body:external_kbnSharedDeps_React_default.a.createElement("p",null,"MISSING_SUPERUSER_ROLE"===permissionsError?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.permissionDeniedErrorMessage",defaultMessage:"You are not authorized to access Fleet. Fleet requires {roleName} privileges.",values:{roleName:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCode,null,"superuser")}}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.securityRequiredErrorMessage",defaultMessage:"You must enable security in Kibana and Elasticsearch to use Fleet."}))}))):!isInitialized||initializationError?external_kbnSharedDeps_React_default.a.createElement(ErrorLayout,null,initializationError?external_kbnSharedDeps_React_default.a.createElement(error_Error,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.fleet.initializationErrorMessageTitle",defaultMessage:"Unable to initialize Fleet"}),error:initializationError}):external_kbnSharedDeps_React_default.a.createElement(Loading,null)):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,children)}),FleetAppContext=Object(external_kbnSharedDeps_React_.memo)(({children:children,startServices:startServices,config:config,history:history,kibanaVersion:kibanaVersion,extensions:extensions,routerHistory:routerHistory})=>{const isDarkMode=useObservable_default()(startServices.uiSettings.get$("theme:darkMode")),[routerHistoryInstance]=Object(external_kbnSharedDeps_React_.useState)(routerHistory||Object(node_modules_history.createHashHistory)());return external_kbnSharedDeps_React_default.a.createElement(startServices.i18n.Context,null,external_kbnSharedDeps_React_default.a.createElement(public_.KibanaContextProvider,{services:{...startServices}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiErrorBoundary,null,external_kbnSharedDeps_React_default.a.createElement(hooks.a.Provider,{value:config},external_kbnSharedDeps_React_default.a.createElement(hooks.c.Provider,{value:kibanaVersion},external_kbnSharedDeps_React_default.a.createElement(common_.EuiThemeProvider,{darkMode:isDarkMode},external_kbnSharedDeps_React_default.a.createElement(UIExtensionsContext.Provider,{value:extensions},external_kbnSharedDeps_React_default.a.createElement(hooks.b,null,external_kbnSharedDeps_React_default.a.createElement(IntraAppStateProvider,{kibanaScopedHistory:history},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Router,{history:routerHistoryInstance},external_kbnSharedDeps_React_default.a.createElement(epm_hooks.a,{notifications:startServices.notifications},children)))))))))))}),AppRoutes=Object(external_kbnSharedDeps_React_.memo)(()=>{const{agents:agents}=Object(hooks.M)();return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Switch,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:constants.j.integrations},external_kbnSharedDeps_React_default.a.createElement(DefaultLayout,{section:"epm"},external_kbnSharedDeps_React_default.a.createElement(EPMApp,null))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:constants.j.policies},external_kbnSharedDeps_React_default.a.createElement(DefaultLayout,{section:"agent_policy"},external_kbnSharedDeps_React_default.a.createElement(AgentPolicyApp,null))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{path:constants.j.data_streams},external_kbnSharedDeps_React_default.a.createElement(DefaultLayout,{section:"data_stream"},external_kbnSharedDeps_React_default.a.createElement(DataStreamApp,null))),external_kbnSharedDeps_React_default.a.createElement(ProtectedRoute,{path:constants.j.fleet,isAllowed:agents.enabled},external_kbnSharedDeps_React_default.a.createElement(DefaultLayout,{section:"fleet"},external_kbnSharedDeps_React_default.a.createElement(FleetApp,null))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{exact:!0,path:constants.j.overview},external_kbnSharedDeps_React_default.a.createElement(DefaultLayout,{section:"overview"},external_kbnSharedDeps_React_default.a.createElement(IngestManagerOverview,null))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Redirect,{to:"/"}))}),ProtectedRoute=({isAllowed:isAllowed=!1,restrictedPath:restrictedPath="/",...routeProps})=>isAllowed?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,routeProps):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Redirect,{to:{pathname:restrictedPath}}),fleet_FleetApp=({basepath:basepath,startServices:startServices,config:config,history:history,kibanaVersion:kibanaVersion,extensions:extensions})=>external_kbnSharedDeps_React_default.a.createElement(FleetAppContext,{basepath:basepath,startServices:startServices,config:config,history:history,kibanaVersion:kibanaVersion,extensions:extensions},external_kbnSharedDeps_React_default.a.createElement(WithPermissionsAndSetup,null,external_kbnSharedDeps_React_default.a.createElement(AppRoutes,null)));function renderApp(startServices,{element:element,appBasePath:appBasePath,history:history},config,kibanaVersion,extensions){return external_kbnSharedDeps_ReactDom_default.a.render(external_kbnSharedDeps_React_default.a.createElement(fleet_FleetApp,{basepath:appBasePath,startServices:startServices,config:config,history:history,kibanaVersion:kibanaVersion,extensions:extensions}),element),()=>{external_kbnSharedDeps_ReactDom_default.a.unmountComponentAtNode(element)}}const teardownFleet=coreStart=>{coreStart.chrome.docTitle.reset(),coreStart.chrome.setBreadcrumbs([]),hooks.d.stop()}}])]);