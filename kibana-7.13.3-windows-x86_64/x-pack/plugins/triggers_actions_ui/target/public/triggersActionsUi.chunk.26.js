/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.triggersActionsUi_bundle_jsonpfunction=window.triggersActionsUi_bundle_jsonpfunction||[]).push([[26],{277:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"default",(function(){return IndexActionConnectorFields}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),_elastic_eui__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(15),_kbn_i18n_react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(52),_kbn_i18n__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(0),_common_lib_get_time_options__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(22),_common_index_controls__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(28),_common_lib_kibana__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(72);const IndexActionConnectorFields=({action:action,editActionConfig:editActionConfig,errors:errors,readOnly:readOnly})=>{const{http:http,docLinks:docLinks}=Object(_common_lib_kibana__WEBPACK_IMPORTED_MODULE_6__.b)().services,{index:index,refresh:refresh,executionTimeField:executionTimeField}=action.config,[showTimeFieldCheckbox,setShowTimeFieldCheckboxState]=Object(react__WEBPACK_IMPORTED_MODULE_0__.useState)(null!=executionTimeField),[hasTimeFieldCheckbox,setHasTimeFieldCheckboxState]=Object(react__WEBPACK_IMPORTED_MODULE_0__.useState)(null!=executionTimeField),[indexPatterns,setIndexPatterns]=Object(react__WEBPACK_IMPORTED_MODULE_0__.useState)([]),[indexOptions,setIndexOptions]=Object(react__WEBPACK_IMPORTED_MODULE_0__.useState)([]),[timeFieldOptions,setTimeFieldOptions]=Object(react__WEBPACK_IMPORTED_MODULE_0__.useState)([]),[isIndiciesLoading,setIsIndiciesLoading]=Object(react__WEBPACK_IMPORTED_MODULE_0__.useState)(!1),setTimeFields=fields=>{fields.length>0?(setShowTimeFieldCheckboxState(!0),setTimeFieldOptions([_common_index_controls__WEBPACK_IMPORTED_MODULE_5__.a,...fields])):(setHasTimeFieldCheckboxState(!1),setShowTimeFieldCheckboxState(!1),setTimeFieldOptions([]))};return Object(react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>{(async()=>{if(setIndexPatterns(await Object(_common_index_controls__WEBPACK_IMPORTED_MODULE_5__.d)()),index){const currentEsFields=await Object(_common_index_controls__WEBPACK_IMPORTED_MODULE_5__.b)(http,[index]);setTimeFields(Object(_common_lib_get_time_options__WEBPACK_IMPORTED_MODULE_4__.a)(currentEsFields))}})()},[]),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__.EuiTitle,{size:"s"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("h5",null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_kbn_i18n_react__WEBPACK_IMPORTED_MODULE_2__.FormattedMessage,{defaultMessage:"Write to index",id:"xpack.triggersActionsUI.components.builtinActionTypes.indexAction.connectorSectionTitle"}))),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__.EuiSpacer,{size:"m"}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__.EuiFormRow,{id:"indexConnectorSelectSearchBox",fullWidth:!0,label:react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_kbn_i18n_react__WEBPACK_IMPORTED_MODULE_2__.FormattedMessage,{id:"xpack.triggersActionsUI.components.builtinActionTypes.indexAction.indicesToQueryLabel",defaultMessage:"Index"}),isInvalid:errors.index.length>0&&void 0!==index,error:errors.index,helpText:react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_kbn_i18n_react__WEBPACK_IMPORTED_MODULE_2__.FormattedMessage,{id:"xpack.triggersActionsUI.components.builtinActionTypes.indexAction.howToBroadenSearchQueryDescription",defaultMessage:"Use * to broaden your query."}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__.EuiSpacer,{size:"s"}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__.EuiLink,{href:docLinks.links.alerting.indexAction,target:"_blank"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_kbn_i18n_react__WEBPACK_IMPORTED_MODULE_2__.FormattedMessage,{id:"xpack.triggersActionsUI.components.builtinActionTypes.indexAction.configureIndexHelpLabel",defaultMessage:"Configuring index connector."})))},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__.EuiComboBox,{fullWidth:!0,singleSelection:{asPlainText:!0},async:!0,isLoading:isIndiciesLoading,isInvalid:errors.index.length>0&&void 0!==index,noSuggestions:!indexOptions.length,options:indexOptions,"data-test-subj":"connectorIndexesComboBox",selectedOptions:index?[{value:index,label:index}]:[],isDisabled:readOnly,onChange:async selected=>{editActionConfig("index",selected.length>0?selected[0].value:"");const indices=selected.map(s=>s.value);if(0===indices.length)return void setTimeFields([]);const currentEsFields=await Object(_common_index_controls__WEBPACK_IMPORTED_MODULE_5__.b)(http,indices);setTimeFields(Object(_common_lib_get_time_options__WEBPACK_IMPORTED_MODULE_4__.a)(currentEsFields))},onSearchChange:async search=>{setIsIndiciesLoading(!0),setIndexOptions(await Object(_common_index_controls__WEBPACK_IMPORTED_MODULE_5__.c)(http,search,indexPatterns)),setIsIndiciesLoading(!1)},onBlur:()=>{index||editActionConfig("index","")}})),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__.EuiSpacer,{size:"m"}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__.EuiSwitch,{"data-test-subj":"indexRefreshCheckbox",checked:refresh||!1,disabled:readOnly,onChange:e=>{editActionConfig("refresh",e.target.checked)},label:react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_kbn_i18n_react__WEBPACK_IMPORTED_MODULE_2__.FormattedMessage,{id:"xpack.triggersActionsUI.components.builtinActionTypes.indexAction.refreshLabel",defaultMessage:"Refresh index"})," ",react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__.EuiIconTip,{position:"right",type:"questionInCircle",content:_kbn_i18n__WEBPACK_IMPORTED_MODULE_3__.i18n.translate("xpack.triggersActionsUI.components.builtinActionTypes.indexAction.refreshTooltip",{defaultMessage:"Refresh the affected shards to make this operation visible to search."})}))}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__.EuiSpacer,{size:"m"}),showTimeFieldCheckbox&&react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__.EuiSwitch,{"data-test-subj":"hasTimeFieldCheckbox",checked:hasTimeFieldCheckbox||!1,disabled:readOnly,onChange:()=>{setHasTimeFieldCheckboxState(!hasTimeFieldCheckbox),hasTimeFieldCheckbox&&editActionConfig("executionTimeField",null)},label:react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_kbn_i18n_react__WEBPACK_IMPORTED_MODULE_2__.FormattedMessage,{id:"xpack.triggersActionsUI.components.builtinActionTypes.indexAction.defineTimeFieldLabel",defaultMessage:"Define time field for each document"}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__.EuiIconTip,{position:"right",type:"questionInCircle",content:_kbn_i18n__WEBPACK_IMPORTED_MODULE_3__.i18n.translate("xpack.triggersActionsUI.components.builtinActionTypes.indexAction.definedateFieldTooltip",{defaultMessage:"Set this time field to the time the document was indexed."})}))}),hasTimeFieldCheckbox&&react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__.EuiSpacer,{size:"m"}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__.EuiFormRow,{id:"executionTimeField",fullWidth:!0,label:react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_kbn_i18n_react__WEBPACK_IMPORTED_MODULE_2__.FormattedMessage,{id:"xpack.triggersActionsUI.components.builtinActionTypes.indexAction.executionTimeFieldLabel",defaultMessage:"Time field"})},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__.EuiSelect,{options:timeFieldOptions,fullWidth:!0,name:"executionTimeField","data-test-subj":"executionTimeFieldSelect",value:null!=executionTimeField?executionTimeField:"",onChange:e=>{var str;editActionConfig("executionTimeField",null==(str=e.target.value)||""===str.trim()?null:str)},onBlur:()=>{void 0===executionTimeField&&editActionConfig("executionTimeField",null)}}))))}},72:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return public_.KibanaContextProvider})),__webpack_require__.d(__webpack_exports__,"b",(function(){return useTypedKibana}));var public_=__webpack_require__(51);const useTypedKibana=()=>Object(public_.useKibana)()}}]);