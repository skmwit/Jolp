/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.triggersActionsUi_bundle_jsonpfunction=window.triggersActionsUi_bundle_jsonpfunction||[]).push([[22],{132:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return getAlertingSectionBreadcrumb})),__webpack_require__.d(__webpack_exports__,"a",(function(){return getAlertDetailsBreadcrumb}));var _kbn_i18n__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0),_constants__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(2);const getAlertingSectionBreadcrumb=type=>{switch(type){case"connectors":return{text:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.triggersActionsUI.connectors.breadcrumbTitle",{defaultMessage:"Connectors"}),href:""+_constants__WEBPACK_IMPORTED_MODULE_1__.h};case"rules":return{text:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.triggersActionsUI.rules.breadcrumbTitle",{defaultMessage:"Rules"}),href:""+_constants__WEBPACK_IMPORTED_MODULE_1__.k};default:return{text:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.triggersActionsUI.home.breadcrumbTitle",{defaultMessage:"Rules and Connectors"}),href:""+_constants__WEBPACK_IMPORTED_MODULE_1__.i}}},getAlertDetailsBreadcrumb=(id,name)=>({text:name,href:""+_constants__WEBPACK_IMPORTED_MODULE_1__.j.replace(":ruleId",id)})},133:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return getCurrentDocTitle}));var _kbn_i18n__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0);const getCurrentDocTitle=page=>{let updatedTitle;switch(page){case"connectors":updatedTitle=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.triggersActionsUI.connectors.breadcrumbTitle",{defaultMessage:"Connectors"});break;case"rules":updatedTitle=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.triggersActionsUI.rules.breadcrumbTitle",{defaultMessage:"Rules"});break;default:updatedTitle=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.triggersActionsUI.home.breadcrumbTitle",{defaultMessage:"Rules and Connectors"})}return updatedTitle}},260:function(module,exports,__webpack_require__){switch(window.__kbnThemeTag__){case"v7dark":return __webpack_require__(261);case"v7light":return __webpack_require__(263);case"v8dark":return __webpack_require__(265);case"v8light":return __webpack_require__(267)}},261:function(module,exports,__webpack_require__){var api=__webpack_require__(70),content=__webpack_require__(262);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},262:function(module,exports,__webpack_require__){(exports=__webpack_require__(71)(!1)).push([module.i,".actionsInstanceList__health{width:100%}.actionsInstanceList__health .euiFlexItem:last-of-type{max-width:100%;overflow:hidden !important;text-overflow:ellipsis !important;white-space:nowrap !important;word-wrap:normal !important;min-width:0;width:85%}\n",""]),module.exports=exports},263:function(module,exports,__webpack_require__){var api=__webpack_require__(70),content=__webpack_require__(264);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},264:function(module,exports,__webpack_require__){(exports=__webpack_require__(71)(!1)).push([module.i,".actionsInstanceList__health{width:100%}.actionsInstanceList__health .euiFlexItem:last-of-type{max-width:100%;overflow:hidden !important;text-overflow:ellipsis !important;white-space:nowrap !important;word-wrap:normal !important;min-width:0;width:85%}\n",""]),module.exports=exports},265:function(module,exports,__webpack_require__){var api=__webpack_require__(70),content=__webpack_require__(266);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},266:function(module,exports,__webpack_require__){(exports=__webpack_require__(71)(!1)).push([module.i,".actionsInstanceList__health{width:100%}.actionsInstanceList__health .euiFlexItem:last-of-type{max-width:100%;overflow:hidden !important;text-overflow:ellipsis !important;white-space:nowrap !important;word-wrap:normal !important;min-width:0;width:85%}\n",""]),module.exports=exports},267:function(module,exports,__webpack_require__){var api=__webpack_require__(70),content=__webpack_require__(268);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},268:function(module,exports,__webpack_require__){(exports=__webpack_require__(71)(!1)).push([module.i,".actionsInstanceList__health{width:100%}.actionsInstanceList__health .euiFlexItem:last-of-type{max-width:100%;overflow:hidden !important;text-overflow:ellipsis !important;white-space:nowrap !important;word-wrap:normal !important;min-width:0;width:85%}\n",""]),module.exports=exports},270:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"AlertDetailsRoute",(function(){return AlertDetailsRoute})),__webpack_require__.d(__webpack_exports__,"getAlertData",(function(){return getAlertData})),__webpack_require__.d(__webpack_exports__,"default",(function(){return AlertDetailsRouteWithApi}));var external_kbnSharedDeps_KbnI18n_=__webpack_require__(0),external_kbnSharedDeps_React_=__webpack_require__(1),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),external_kbnSharedDeps_Lodash_=__webpack_require__(3),external_kbnSharedDeps_ReactRouterDom_=__webpack_require__(54),external_kbnSharedDeps_ElasticEui_=__webpack_require__(15),external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(52),common_=__webpack_require__(6),lib_capabilities=__webpack_require__(84),breadcrumb=__webpack_require__(132),doc_title=__webpack_require__(133),with_bulk_alert_api_operations=__webpack_require__(93),external_kbnSharedDeps_Moment_=__webpack_require__(32),external_kbnSharedDeps_Moment_default=__webpack_require__.n(external_kbnSharedDeps_Moment_),external_kbnSharedDeps_ElasticEuiLibServices_=__webpack_require__(69),constants=__webpack_require__(2);__webpack_require__(260);const alertInstancesTableColumns=(onMuteAction,readOnly)=>[{field:"instance",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.triggersActionsUI.sections.alertDetails.alertInstancesList.columns.alert",{defaultMessage:"Alert"}),sortable:!1,truncateText:!0,width:"45%","data-test-subj":"alertInstancesTableCell-instance",render:value=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{anchorClassName:"eui-textTruncate",content:value},external_kbnSharedDeps_React_default.a.createElement("span",null,value))},{field:"status",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.triggersActionsUI.sections.alertDetails.alertInstancesList.columns.status",{defaultMessage:"Status"}),width:"15%",render:(value,instance)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHealth,{color:value.healthColor,className:"actionsInstanceList__health"},value.label,value.actionGroup?` (${value.actionGroup})`:""),sortable:!1,"data-test-subj":"alertInstancesTableCell-status"},{field:"start",width:"190px",render:(value,instance)=>value?external_kbnSharedDeps_Moment_default()(value).format("D MMM YYYY @ HH:mm:ss"):"",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.triggersActionsUI.sections.alertDetails.alertInstancesList.columns.start",{defaultMessage:"Start"}),sortable:!1,"data-test-subj":"alertInstancesTableCell-start"},{field:"duration",render:(value,instance)=>{return value?[(duration=external_kbnSharedDeps_Moment_default.a.duration(value)).hours(),duration.minutes(),duration.seconds()].map(value=>Object(external_kbnSharedDeps_Lodash_.padStart)(""+value,2,"0")).join(":"):"";var duration},name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.triggersActionsUI.sections.alertDetails.alertInstancesList.columns.duration",{defaultMessage:"Duration"}),sortable:!1,width:"80px","data-test-subj":"alertInstancesTableCell-duration"},{field:"",align:external_kbnSharedDeps_ElasticEuiLibServices_.RIGHT_ALIGNMENT,width:"60px",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.triggersActionsUI.sections.alertDetails.alertInstancesList.columns.mute",{defaultMessage:"Mute"}),render:alertInstance=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSwitch,{label:"mute",showLabel:!1,compressed:!0,checked:alertInstance.isMuted,disabled:readOnly,"data-test-subj":"muteAlertInstanceButton_"+alertInstance.instance,onChange:()=>onMuteAction(alertInstance)})),sortable:!1,"data-test-subj":"alertInstancesTableCell-actions"}];const AlertInstancesWithApi=Object(with_bulk_alert_api_operations.a)((function({alert:alert,alertType:alertType,readOnly:readOnly,alertInstanceSummary:alertInstanceSummary,muteAlertInstance:muteAlertInstance,unmuteAlertInstance:unmuteAlertInstance,requestRefresh:requestRefresh,durationEpoch:durationEpoch=Date.now()}){const[pagination,setPagination]=Object(external_kbnSharedDeps_React_.useState)({index:0,size:constants.c}),alertInstances=Object.entries(alertInstanceSummary.instances).map(([instanceId,instance])=>function(durationEpoch,alertType,instanceId,instance){const isMuted=!(null==instance||!instance.muted),status="Active"===(null==instance?void 0:instance.status)?{label:ACTIVE_LABEL,actionGroup:getActionGroupName(alertType,null==instance?void 0:instance.actionGroupId),healthColor:"primary"}:{label:INACTIVE_LABEL,healthColor:"subdued"},start=null!=instance&&instance.activeStartDate?new Date(instance.activeStartDate):void 0,duration=start?durationEpoch-start.valueOf():0,sortPriority=function(status){switch(status){case"Active":return 0;case"OK":return 1}return 2}(null==instance?void 0:instance.status);return{instance:instanceId,status:status,start:start,duration:duration,isMuted:isMuted,sortPriority:sortPriority}}(durationEpoch,alertType,instanceId,instance)).sort((leftInstance,rightInstance)=>leftInstance.sortPriority-rightInstance.sortPriority),pageOfAlertInstances=function(items,pagination){return Object(external_kbnSharedDeps_Lodash_.chunk)(items,pagination.size)[pagination.index]||[]}(alertInstances,pagination);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"xl"}),external_kbnSharedDeps_React_default.a.createElement("input",{type:"hidden","data-test-subj":"alertInstancesDurationEpoch",name:"alertInstancesDurationEpoch",value:durationEpoch}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBasicTable,{items:pageOfAlertInstances,pagination:{pageIndex:pagination.index,pageSize:pagination.size,totalItemCount:alertInstances.length},onChange:({page:changedPage})=>{setPagination(changedPage)},rowProps:()=>({"data-test-subj":"alert-instance-row"}),cellProps:()=>({"data-test-subj":"cell"}),columns:alertInstancesTableColumns(async instance=>{await(instance.isMuted?unmuteAlertInstance(alert,instance.instance):muteAlertInstance(alert,instance.instance)),requestRefresh()},readOnly),"data-test-subj":"alertInstancesList",tableLayout:"fixed",className:"alertInstancesList"}))}));const ACTIVE_LABEL=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.triggersActionsUI.sections.alertDetails.alertInstancesList.status.active",{defaultMessage:"Active"}),INACTIVE_LABEL=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.triggersActionsUI.sections.alertDetails.alertInstancesList.status.inactive",{defaultMessage:"OK"});function getActionGroupName(alertType,actionGroupId){var _alertType$actionGrou;actionGroupId=actionGroupId||alertType.defaultActionGroupId;const actionGroup=null==alertType||null===(_alertType$actionGrou=alertType.actionGroups)||void 0===_alertType$actionGrou?void 0:_alertType$actionGrou.find(group=>group.id===actionGroupId);return null==actionGroup?void 0:actionGroup.name}var kibana=__webpack_require__(72),center_justified_spinner=__webpack_require__(26);const AlertInstancesRouteWithApi=Object(with_bulk_alert_api_operations.a)(({alert:alert,alertType:alertType,readOnly:readOnly,requestRefresh:requestRefresh,loadAlertInstanceSummary:loadAlertInstanceSummary})=>{const{notifications:{toasts:toasts}}=Object(kibana.b)().services,[alertInstanceSummary,setAlertInstanceSummary]=Object(external_kbnSharedDeps_React_.useState)(null);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{!async function(alertId,loadAlertInstanceSummary,setAlertInstanceSummary,toasts){try{const loadedInstanceSummary=await loadAlertInstanceSummary(alertId);setAlertInstanceSummary(loadedInstanceSummary)}catch(e){toasts.addDanger({title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.triggersActionsUI.sections.alertDetails.unableToLoadAlertsMessage",{defaultMessage:"Unable to load alerts: {message}",values:{message:e.message}})})}}(alert.id,loadAlertInstanceSummary,setAlertInstanceSummary,toasts)},[alert]),alertInstanceSummary?external_kbnSharedDeps_React_default.a.createElement(AlertInstancesWithApi,{requestRefresh:requestRefresh,alert:alert,alertType:alertType,readOnly:readOnly,alertInstanceSummary:alertInstanceSummary}):external_kbnSharedDeps_React_default.a.createElement(center_justified_spinner.a,null)});var Option=__webpack_require__(89),pipeable=__webpack_require__(91);function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const ViewInApp=({alert:alert})=>{const{application:{navigateToApp:navigateToApp},alerting:maybeAlerting}=Object(kibana.b)().services,[alertNavigation,setAlertNavigation]=Object(external_kbnSharedDeps_React_.useState)(null);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{Object(pipeable.pipe)(Object(Option.fromNullable)(maybeAlerting),Object(Option.fold)(()=>setAlertNavigation(!1),alerting=>alerting.getNavigation(alert.id).then(nav=>setAlertNavigation(nav||!1)).catch(()=>{setAlertNavigation(!1)})))},[alert.id,maybeAlerting]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,_extends({"data-test-subj":"alertDetails-viewInApp",isLoading:null===alertNavigation,disabled:!hasNavigation(alertNavigation),iconType:"popout"},function(alertNavigation,alert,navigateToApp){return hasNavigation(alertNavigation)?{onClick:()=>{navigateToApp(alert.consumer,alertNavigation)}}:{}}(alertNavigation,alert,navigateToApp)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.triggersActionsUI.sections.alertDetails.viewAlertInAppButtonLabel",defaultMessage:"View in app"}))};function hasNavigation(alertNavigation){return!!alertNavigation&&(alertNavigation.hasOwnProperty("state")||alertNavigation.hasOwnProperty("path"))}var alert_form=__webpack_require__(27),translations=__webpack_require__(99),alert_reducer=__webpack_require__(98);const AlertDetailsWithApi=Object(with_bulk_alert_api_operations.a)(({alert:alert,alertType:alertType,actionTypes:actionTypes,disableAlert:disableAlert,enableAlert:enableAlert,unmuteAlert:unmuteAlert,muteAlert:muteAlert,requestRefresh:requestRefresh})=>{var _alert$executionStatu,_alert$executionStatu2;const history=Object(external_kbnSharedDeps_ReactRouterDom_.useHistory)(),{application:{capabilities:capabilities},alertTypeRegistry:alertTypeRegistry,actionTypeRegistry:actionTypeRegistry,setBreadcrumbs:setBreadcrumbs,chrome:chrome,http:http}=Object(kibana.b)().services,[{},dispatch]=Object(external_kbnSharedDeps_React_.useReducer)(alert_reducer.a,{alert:alert});Object(external_kbnSharedDeps_React_.useEffect)(()=>{setBreadcrumbs([Object(breadcrumb.b)("alerts"),Object(breadcrumb.a)(alert.id,alert.name)]),chrome.docTitle.change(Object(doc_title.a)("alerts"))},[]);const canExecuteActions=Object(lib_capabilities.c)(capabilities),canSaveAlert=Object(lib_capabilities.a)(alert,alertType)&&(canExecuteActions||!canExecuteActions&&0===alert.actions.length),actionTypesByTypeId=Object(external_kbnSharedDeps_Lodash_.keyBy)(actionTypes,"id"),hasEditButton=canSaveAlert&&!!alertTypeRegistry.has(alert.alertTypeId)&&!alertTypeRegistry.get(alert.alertTypeId).requiresAppContext,alertActions=alert.actions,uniqueActions=Array.from(new Set(alertActions.map(item=>item.actionTypeId))),[isEnabled,setIsEnabled]=Object(external_kbnSharedDeps_React_.useState)(alert.enabled),[isMuted,setIsMuted]=Object(external_kbnSharedDeps_React_.useState)(alert.muteAll),[editFlyoutVisible,setEditFlyoutVisibility]=Object(external_kbnSharedDeps_React_.useState)(!1),[dissmissAlertErrors,setDissmissAlertErrors]=Object(external_kbnSharedDeps_React_.useState)(!1);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPage,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageBody,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageContent,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageContentHeader,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageContentHeaderSection,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"m"},external_kbnSharedDeps_React_default.a.createElement("h1",null,external_kbnSharedDeps_React_default.a.createElement("span",{"data-test-subj":"alertDetailsTitle"},alert.name)))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageContentHeaderSection,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{responsive:!1,gutterSize:"xs"},hasEditButton?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null," ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{"data-test-subj":"openEditAlertFlyoutButton",iconType:"pencil",onClick:()=>setEditFlyoutVisibility(!0),name:"edit",disabled:!alertType.enabledInLicense},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.triggersActionsUI.sections.alertDetails.editAlertButtonLabel",defaultMessage:"Edit"})),editFlyoutVisible&&external_kbnSharedDeps_React_default.a.createElement(alert_form.b,{initialAlert:alert,onClose:()=>{dispatch({command:{type:"setAlert"},payload:{key:"alert",value:alert}}),setEditFlyoutVisibility(!1)},actionTypeRegistry:actionTypeRegistry,alertTypeRegistry:alertTypeRegistry,onSave:async()=>{history.push(constants.j.replace(":ruleId",alert.id))}}))):null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{"data-test-subj":"refreshAlertsButton",iconType:"refresh",onClick:requestRefresh,name:"refresh",color:"primary"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.triggersActionsUI.sections.alertsList.refreshAlertsButtonLabel",defaultMessage:"Refresh"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(ViewInApp,{alert:alert}))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageContentBody,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{wrap:!0,responsive:!1,gutterSize:"m"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"s"},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.triggersActionsUI.sections.alertsList.alertsListTable.columns.alertTypeTitle",defaultMessage:"Type"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBadge,{"data-test-subj":"alertTypeLabel"},alertType.name)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:1},uniqueActions&&uniqueActions.length?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"s"},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.triggersActionsUI.sections.alertsList.alertsListTable.columns.actionsTex",defaultMessage:"Actions"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{wrap:!0,gutterSize:"s"},uniqueActions.map((action,index)=>{var _actionTypesByTypeId$;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{key:index,grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBadge,{color:"hollow","data-test-subj":"actionTypeLabel"},null!==(_actionTypesByTypeId$=actionTypesByTypeId[action].name)&&void 0!==_actionTypesByTypeId$?_actionTypesByTypeId$:action))}))):null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"flexEnd",wrap:!0,responsive:!1,gutterSize:"m"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSwitch,{name:"disable",disabled:!canSaveAlert||!alertType.enabledInLicense,checked:!isEnabled,"data-test-subj":"disableSwitch",onChange:async()=>{isEnabled?(setIsEnabled(!1),await disableAlert(alert)):(setIsEnabled(!0),await enableAlert(alert)),requestRefresh()},label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.triggersActionsUI.sections.alertDetails.collapsedItemActons.disableTitle",defaultMessage:"Disable"})})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSwitch,{name:"mute",checked:isMuted,disabled:!canSaveAlert||!isEnabled||!alertType.enabledInLicense,"data-test-subj":"muteSwitch",onChange:async()=>{isMuted?(setIsMuted(!1),await unmuteAlert(alert)):(setIsMuted(!0),await muteAlert(alert)),requestRefresh()},label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.triggersActionsUI.sections.alertDetails.collapsedItemActons.muteTitle",defaultMessage:"Mute"})}))))),dissmissAlertErrors||"error"!==alert.executionStatus.status?null:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{color:"danger","data-test-subj":"alertErrorBanner",size:"s",title:alert.executionStatus.error&&alert.executionStatus.error.reason?translations.b[alert.executionStatus.error.reason]:translations.b.unknown,iconType:"alert"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"s",color:"danger","data-test-subj":"alertErrorMessageText"},null===(_alert$executionStatu=alert.executionStatus.error)||void 0===_alert$executionStatu?void 0:_alert$executionStatu.message),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s",wrap:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{color:"danger",onClick:()=>setDissmissAlertErrors(!0)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.triggersActionsUI.sections.alertDetails.dismissButtonTitle",defaultMessage:"Dismiss"}))),(null===(_alert$executionStatu2=alert.executionStatus.error)||void 0===_alert$executionStatu2?void 0:_alert$executionStatu2.reason)===common_.AlertExecutionStatusErrorReasons.License&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{href:http.basePath.get()+"/app/management/stack/license_management",color:"danger",target:"_blank"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.triggersActionsUI.sections.alertDetails.manageLicensePlanBannerLinkTitle",defaultMessage:"Manage license"}))))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,alert.enabled?external_kbnSharedDeps_React_default.a.createElement(AlertInstancesRouteWithApi,{requestRefresh:requestRefresh,alert:alert,alertType:alertType,readOnly:!canSaveAlert}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.triggersActionsUI.sections.alertDetails.alerts.disabledRuleTitle",{defaultMessage:"Disabled Rule"}),color:"warning",iconType:"help"},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.triggersActionsUI.sections.alertDetails.alertInstances.disabledRule",defaultMessage:"This rule is disabled and cannot be displayed. Toggle Disable ↑ to activate it."}))))))))))});var value_validators=__webpack_require__(5),action_connector_api=__webpack_require__(25);function with_actions_api_operations_extends(){return(with_actions_api_operations_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const AlertDetailsRoute=({match:{params:{ruleId:ruleId}},loadAlert:loadAlert,loadAlertTypes:loadAlertTypes,loadActionTypes:loadActionTypes})=>{const{http:http,notifications:{toasts:toasts}}=Object(kibana.b)().services,[alert,setAlert]=Object(external_kbnSharedDeps_React_.useState)(null),[alertType,setAlertType]=Object(external_kbnSharedDeps_React_.useState)(null),[actionTypes,setActionTypes]=Object(external_kbnSharedDeps_React_.useState)(null),[refreshToken,requestRefresh]=external_kbnSharedDeps_React_default.a.useState();return Object(external_kbnSharedDeps_React_.useEffect)(()=>{getAlertData(ruleId,loadAlert,loadAlertTypes,loadActionTypes,setAlert,setAlertType,setActionTypes,toasts)},[ruleId,http,loadActionTypes,loadAlert,loadAlertTypes,toasts,refreshToken]),alert&&alertType&&actionTypes?external_kbnSharedDeps_React_default.a.createElement(AlertDetailsWithApi,{alert:alert,alertType:alertType,actionTypes:actionTypes,requestRefresh:async()=>requestRefresh(Date.now())}):external_kbnSharedDeps_React_default.a.createElement(center_justified_spinner.a,null)};async function getAlertData(alertId,loadAlert,loadAlertTypes,loadActionTypes,setAlert,setAlertType,setActionTypes,toasts){try{const loadedAlert=await loadAlert(alertId);setAlert(loadedAlert);const[loadedAlertType,loadedActionTypes]=await Promise.all([loadAlertTypes().then(types=>types.find(type=>type.id===loadedAlert.alertTypeId)).then(Object(value_validators.d)("Invalid Alert Type: "+loadedAlert.alertTypeId)),loadActionTypes().then(Object(value_validators.e)(new Set(loadedAlert.actions.map(action=>action.actionTypeId)),requiredActionType=>"Invalid Action Type: "+requiredActionType,action=>action.id))]);setAlertType(loadedAlertType),setActionTypes(loadedActionTypes)}catch(e){toasts.addDanger({title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.triggersActionsUI.sections.alertDetails.unableToLoadAlertMessage",{defaultMessage:"Unable to load rule: {message}",values:{message:e.message}})})}}const AlertDetailsRouteWithApi=(WrappedComponent=Object(with_bulk_alert_api_operations.a)(AlertDetailsRoute),props=>{const{http:http}=Object(kibana.b)().services;return external_kbnSharedDeps_React_default.a.createElement(WrappedComponent,with_actions_api_operations_extends({},props,{loadActionTypes:async()=>Object(action_connector_api.d)({http:http})}))});var WrappedComponent},93:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return withBulkAlertOperations}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),_lib_alert_api__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(90),_common_lib_kibana__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(72);function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function withBulkAlertOperations(WrappedComponent){return props=>{const{http:http}=Object(_common_lib_kibana__WEBPACK_IMPORTED_MODULE_2__.b)().services;return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(WrappedComponent,_extends({},props,{muteAlerts:async items=>Object(_lib_alert_api__WEBPACK_IMPORTED_MODULE_1__.p)({http:http,ids:items.filter(item=>!isAlertMuted(item)).map(item=>item.id)}),unmuteAlerts:async items=>Object(_lib_alert_api__WEBPACK_IMPORTED_MODULE_1__.s)({http:http,ids:items.filter(isAlertMuted).map(item=>item.id)}),enableAlerts:async items=>Object(_lib_alert_api__WEBPACK_IMPORTED_MODULE_1__.g)({http:http,ids:items.filter(isAlertDisabled).map(item=>item.id)}),disableAlerts:async items=>Object(_lib_alert_api__WEBPACK_IMPORTED_MODULE_1__.e)({http:http,ids:items.filter(item=>!isAlertDisabled(item)).map(item=>item.id)}),deleteAlerts:async items=>Object(_lib_alert_api__WEBPACK_IMPORTED_MODULE_1__.c)({http:http,ids:items.map(item=>item.id)}),muteAlert:async alert=>{if(!isAlertMuted(alert))return await Object(_lib_alert_api__WEBPACK_IMPORTED_MODULE_1__.n)({http:http,id:alert.id})},unmuteAlert:async alert=>{if(isAlertMuted(alert))return await Object(_lib_alert_api__WEBPACK_IMPORTED_MODULE_1__.q)({http:http,id:alert.id})},muteAlertInstance:async(alert,instanceId)=>{if(!isAlertInstanceMuted(alert,instanceId))return Object(_lib_alert_api__WEBPACK_IMPORTED_MODULE_1__.o)({http:http,id:alert.id,instanceId:instanceId})},unmuteAlertInstance:async(alert,instanceId)=>{if(isAlertInstanceMuted(alert,instanceId))return Object(_lib_alert_api__WEBPACK_IMPORTED_MODULE_1__.r)({http:http,id:alert.id,instanceId:instanceId})},enableAlert:async alert=>{if(isAlertDisabled(alert))return await Object(_lib_alert_api__WEBPACK_IMPORTED_MODULE_1__.f)({http:http,id:alert.id})},disableAlert:async alert=>{if(!isAlertDisabled(alert))return await Object(_lib_alert_api__WEBPACK_IMPORTED_MODULE_1__.d)({http:http,id:alert.id})},deleteAlert:async alert=>Object(_lib_alert_api__WEBPACK_IMPORTED_MODULE_1__.c)({http:http,ids:[alert.id]}),loadAlert:async alertId=>Object(_lib_alert_api__WEBPACK_IMPORTED_MODULE_1__.h)({http:http,alertId:alertId}),loadAlertState:async alertId=>Object(_lib_alert_api__WEBPACK_IMPORTED_MODULE_1__.k)({http:http,alertId:alertId}),loadAlertInstanceSummary:async alertId=>Object(_lib_alert_api__WEBPACK_IMPORTED_MODULE_1__.j)({http:http,alertId:alertId}),loadAlertTypes:async()=>Object(_lib_alert_api__WEBPACK_IMPORTED_MODULE_1__.l)({http:http}),getHealth:async()=>Object(_lib_alert_api__WEBPACK_IMPORTED_MODULE_1__.a)({http:http})}))}}function isAlertDisabled(alert){return!1===alert.enabled}function isAlertMuted(alert){return!0===alert.muteAll}function isAlertInstanceMuted(alert,instanceId){return alert.mutedInstanceIds.findIndex(muted=>muted===instanceId)>=0}},98:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return alertReducer}));var lodash__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(3);const alertReducer=(state,action)=>{const{alert:alert}=state;switch(action.command.type){case"setAlert":{const{key:key,value:value}=action.payload;return"alert"===key?{...state,alert:value}:state}case"setProperty":{const{key:key,value:value}=action.payload;return Object(lodash__WEBPACK_IMPORTED_MODULE_0__.isEqual)(alert[key],value)?state:{...state,alert:{...alert,[key]:value}}}case"setScheduleProperty":{const{key:key,value:value}=action.payload;return alert.schedule&&Object(lodash__WEBPACK_IMPORTED_MODULE_0__.isEqual)(alert.schedule[key],value)?state:{...state,alert:{...alert,schedule:{...alert.schedule,[key]:value}}}}case"setAlertParams":{const{key:key,value:value}=action.payload;return Object(lodash__WEBPACK_IMPORTED_MODULE_0__.isEqual)(alert.params[key],value)?state:{...state,alert:{...alert,params:{...alert.params,[key]:value}}}}case"setAlertActionParams":{const{key:key,value:value,index:index}=action.payload;if(void 0===index||null==alert.actions[index]||Object(lodash__WEBPACK_IMPORTED_MODULE_0__.isEqual)(alert.actions[index][key],value))return state;{const oldAction=alert.actions.splice(index,1)[0],updatedAction={...oldAction,params:{...oldAction.params,[key]:value}};return alert.actions.splice(index,0,updatedAction),{...state,alert:{...alert,actions:[...alert.actions]}}}}case"setAlertActionProperty":{const{key:key,value:value,index:index}=action.payload;if(void 0===index||Object(lodash__WEBPACK_IMPORTED_MODULE_0__.isEqual)(alert.actions[index][key],value))return state;{const updatedAction={...alert.actions.splice(index,1)[0],[key]:value};return alert.actions.splice(index,0,updatedAction),{...state,alert:{...alert,actions:[...alert.actions]}}}}}}},99:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return ALERT_STATUS_LICENSE_ERROR})),__webpack_require__.d(__webpack_exports__,"c",(function(){return alertsStatusesTranslationsMapping})),__webpack_require__.d(__webpack_exports__,"b",(function(){return alertsErrorReasonTranslationsMapping}));var _kbn_i18n__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0);const ALERT_STATUS_OK=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.triggersActionsUI.sections.alertsList.alertStatusOk",{defaultMessage:"Ok"}),ALERT_STATUS_ACTIVE=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.triggersActionsUI.sections.alertsList.alertStatusActive",{defaultMessage:"Active"}),ALERT_STATUS_ERROR=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.triggersActionsUI.sections.alertsList.alertStatusError",{defaultMessage:"Error"}),ALERT_STATUS_LICENSE_ERROR=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.triggersActionsUI.sections.alertsList.alertStatusLicenseError",{defaultMessage:"License Error"}),alertsStatusesTranslationsMapping={ok:ALERT_STATUS_OK,active:ALERT_STATUS_ACTIVE,error:ALERT_STATUS_ERROR,pending:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.triggersActionsUI.sections.alertsList.alertStatusPending",{defaultMessage:"Pending"}),unknown:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.triggersActionsUI.sections.alertsList.alertStatusUnknown",{defaultMessage:"Unknown"})},ALERT_ERROR_UNKNOWN_REASON=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.triggersActionsUI.sections.alertsList.alertErrorReasonUnknown",{defaultMessage:"An error occurred for unknown reasons."}),alertsErrorReasonTranslationsMapping={read:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.triggersActionsUI.sections.alertsList.alertErrorReasonReading",{defaultMessage:"An error occurred when reading the rule."}),decrypt:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.triggersActionsUI.sections.alertsList.alertErrorReasonDecrypting",{defaultMessage:"An error occurred when decrypting the rule."}),execute:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.triggersActionsUI.sections.alertsList.alertErrorReasonRunning",{defaultMessage:"An error occurred when running the rule."}),unknown:ALERT_ERROR_UNKNOWN_REASON,license:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.triggersActionsUI.sections.alertsList.alertErrorReasonLicense",{defaultMessage:"Cannot run rule"})}}}]);