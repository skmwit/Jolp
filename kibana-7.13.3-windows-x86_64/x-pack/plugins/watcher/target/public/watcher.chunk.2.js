/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.watcher_bundle_jsonpfunction=window.watcher_bundle_jsonpfunction||[]).push([[2],{34:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.parse=exports.unitsAsc=exports.unitsDesc=exports.units=exports.unitsMap=void 0;const moment_1=__webpack_require__(24).__importDefault(__webpack_require__(25));exports.unitsMap={ms:{weight:1,type:"fixed",base:1},s:{weight:2,type:"fixed",base:1e3},m:{weight:3,type:"mixed",base:6e4},h:{weight:4,type:"mixed",base:36e5},d:{weight:5,type:"mixed",base:864e5},w:{weight:6,type:"calendar",base:NaN},M:{weight:7,type:"calendar",base:NaN},y:{weight:9,type:"calendar",base:NaN}},exports.units=Object.keys(exports.unitsMap).sort((a,b)=>exports.unitsMap[b].weight-exports.unitsMap[a].weight),exports.unitsDesc=[...exports.units],exports.unitsAsc=[...exports.units].reverse();const isDate=d=>"[object Date]"===Object.prototype.toString.call(d);function parse(input,options={}){const text=input,{roundUp:roundUp=!1,momentInstance:momentInstance=moment_1.default,forceNow:forceNow}=options;if(!text)return;if(momentInstance.isMoment(text))return text;if(isDate(text))return momentInstance(text);if(void 0!==forceNow&&(!isDate(d=forceNow)||isNaN(d.valueOf())))throw new Error("forceNow must be a valid Date");var d;let time,index,parseString,mathString="";return"now"===text.substring(0,3)?(time=momentInstance(forceNow),mathString=text.substring("now".length)):(index=text.indexOf("||"),-1===index?(parseString=text,mathString=""):(parseString=text.substring(0,index),mathString=text.substring(index+2)),time=momentInstance(parseString)),mathString.length?function(mathString,time,roundUp){const dateTime=time,len=mathString.length;let i=0;for(;i<len;){const c=mathString.charAt(i++);let type,num,unit;if("/"===c)type=0;else if("+"===c)type=1;else{if("-"!==c)return;type=2}if(isNaN(mathString.charAt(i)))num=1;else if(2===mathString.length)num=mathString.charAt(i);else{const numFrom=i;for(;!isNaN(mathString.charAt(i));)if(i++,i>=len)return;num=parseInt(mathString.substring(numFrom,i),10)}if(0===type&&1!==num)return;unit=mathString.charAt(i++);for(let j=i;j<len;j++){const unitChar=mathString.charAt(i);if(!/[a-z]/i.test(unitChar))break;unit+=unitChar,i++}if(-1===exports.units.indexOf(unit))return;0===type?roundUp?dateTime.endOf(unit):dateTime.startOf(unit):1===type?dateTime.add(num,unit):2===type&&dateTime.subtract(num,unit)}return dateTime}(mathString,time,roundUp):time}exports.parse=parse,exports.default={parse:parse,unitsMap:Object.freeze(exports.unitsMap),units:Object.freeze(exports.units),unitsAsc:Object.freeze(exports.unitsAsc),unitsDesc:Object.freeze(exports.unitsDesc)}},55:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"TimeBuckets",(function(){return TimeBuckets}));var external_kbnSharedDeps_Lodash_=__webpack_require__(21),external_kbnSharedDeps_Lodash_default=__webpack_require__.n(external_kbnSharedDeps_Lodash_),external_kbnSharedDeps_Moment_=__webpack_require__(25),external_kbnSharedDeps_Moment_default=__webpack_require__.n(external_kbnSharedDeps_Moment_),public_=__webpack_require__(32);const boundsDescending=[{bound:1/0,interval:Number(external_kbnSharedDeps_Moment_default.a.duration(1,"year"))},{bound:Number(external_kbnSharedDeps_Moment_default.a.duration(1,"year")),interval:Number(external_kbnSharedDeps_Moment_default.a.duration(1,"month"))},{bound:Number(external_kbnSharedDeps_Moment_default.a.duration(3,"week")),interval:Number(external_kbnSharedDeps_Moment_default.a.duration(1,"week"))},{bound:Number(external_kbnSharedDeps_Moment_default.a.duration(1,"week")),interval:Number(external_kbnSharedDeps_Moment_default.a.duration(1,"d"))},{bound:Number(external_kbnSharedDeps_Moment_default.a.duration(24,"hour")),interval:Number(external_kbnSharedDeps_Moment_default.a.duration(12,"hour"))},{bound:Number(external_kbnSharedDeps_Moment_default.a.duration(6,"hour")),interval:Number(external_kbnSharedDeps_Moment_default.a.duration(3,"hour"))},{bound:Number(external_kbnSharedDeps_Moment_default.a.duration(2,"hour")),interval:Number(external_kbnSharedDeps_Moment_default.a.duration(1,"hour"))},{bound:Number(external_kbnSharedDeps_Moment_default.a.duration(45,"minute")),interval:Number(external_kbnSharedDeps_Moment_default.a.duration(30,"minute"))},{bound:Number(external_kbnSharedDeps_Moment_default.a.duration(20,"minute")),interval:Number(external_kbnSharedDeps_Moment_default.a.duration(10,"minute"))},{bound:Number(external_kbnSharedDeps_Moment_default.a.duration(9,"minute")),interval:Number(external_kbnSharedDeps_Moment_default.a.duration(5,"minute"))},{bound:Number(external_kbnSharedDeps_Moment_default.a.duration(3,"minute")),interval:Number(external_kbnSharedDeps_Moment_default.a.duration(1,"minute"))},{bound:Number(external_kbnSharedDeps_Moment_default.a.duration(45,"second")),interval:Number(external_kbnSharedDeps_Moment_default.a.duration(30,"second"))},{bound:Number(external_kbnSharedDeps_Moment_default.a.duration(15,"second")),interval:Number(external_kbnSharedDeps_Moment_default.a.duration(10,"second"))},{bound:Number(external_kbnSharedDeps_Moment_default.a.duration(7.5,"second")),interval:Number(external_kbnSharedDeps_Moment_default.a.duration(5,"second"))},{bound:Number(external_kbnSharedDeps_Moment_default.a.duration(5,"second")),interval:Number(external_kbnSharedDeps_Moment_default.a.duration(1,"second"))},{bound:Number(external_kbnSharedDeps_Moment_default.a.duration(500,"ms")),interval:Number(external_kbnSharedDeps_Moment_default.a.duration(100,"ms"))}];function getPerBucketMs(count,duration){const ms=duration/count;return isFinite(ms)?ms:NaN}function normalizeMinimumInterval(targetMs){const value=isNaN(targetMs)?0:Math.max(Math.floor(targetMs),1);return external_kbnSharedDeps_Moment_default.a.duration(value)}var target=__webpack_require__(34);const unitsDesc=__webpack_require__.n(target).a.unitsDesc,largeMax=unitsDesc.indexOf("M");const{parseInterval:parseInterval}=public_.search.aggs;function isValidMoment(m){return m&&"isValid"in m&&m.isValid()}function TimeBuckets(uiSettings,data){return this.data=data,this.getConfig=(...args)=>uiSettings.get(...args),TimeBuckets.__cached__(this)}TimeBuckets.prototype.setBounds=function(input){if(!input)return this.clearBounds();let bounds;bounds=external_kbnSharedDeps_Lodash_default.a.isPlainObject(input)?[input.min,input.max]:Array.isArray(input)?input:[];const moments=external_kbnSharedDeps_Lodash_default()(bounds).map(external_kbnSharedDeps_Lodash_default.a.ary(external_kbnSharedDeps_Moment_default.a,1)).sortBy(Number);if(!(2===moments.size()&&moments.every(isValidMoment)))throw this.clearBounds(),new Error("invalid bounds set: "+input);if(this._lb=moments.shift(),this._ub=moments.pop(),this.getDuration().asSeconds()<0)throw new TypeError("Intervals must be positive")},TimeBuckets.prototype.clearBounds=function(){this._lb=this._ub=null},TimeBuckets.prototype.hasBounds=function(){return isValidMoment(this._ub)&&isValidMoment(this._lb)},TimeBuckets.prototype.getBounds=function(){if(this.hasBounds())return{min:this._lb,max:this._ub}},TimeBuckets.prototype.getDuration=function(){if(this.hasBounds())return external_kbnSharedDeps_Moment_default.a.duration(this._ub-this._lb,"ms")},TimeBuckets.prototype.setInterval=function(input){this.originalInterval=input;let interval=input;if(external_kbnSharedDeps_Lodash_default.a.isObject(input)&&(interval=input.val),interval&&"auto"!==interval){if(external_kbnSharedDeps_Lodash_default.a.isString(interval)&&(input=interval,interval=parseInterval(interval),0==+interval&&(interval=null)),!external_kbnSharedDeps_Moment_default.a.isDuration(interval))throw new TypeError('"'+input+'" is not a valid interval.');this._i=interval}else this._i="auto"},TimeBuckets.prototype.getInterval=function(useNormalizedEsInterval=!0){const self=this,duration=self.getDuration(),parsedInterval=function(){const interval=self._i;return external_kbnSharedDeps_Moment_default.a.isDuration(interval)?interval:function(targetBucketCount,duration){const targetPerBucketMs=getPerBucketMs(targetBucketCount,duration),lowerBoundIndex=boundsDescending.findIndex(({bound:bound})=>Number(bound)<=targetPerBucketMs);if(-1!==lowerBoundIndex){const nearestInterval=boundsDescending[lowerBoundIndex-1].interval;return external_kbnSharedDeps_Moment_default.a.duration(nearestInterval)}return normalizeMinimumInterval(targetPerBucketMs)}(self.getConfig(public_.UI_SETTINGS.HISTOGRAM_BAR_TARGET),Number(duration))}();return decorateInterval(useNormalizedEsInterval?function(interval){if(!self.hasBounds())return interval;const maxLength=self.getConfig(public_.UI_SETTINGS.HISTOGRAM_MAX_BARS);let scaled;if(!(duration/interval>maxLength))return interval;scaled=function(maxBucketCount,duration){const maxPerBucketMs=getPerBucketMs(maxBucketCount,duration);for(const{interval:interval}of boundsDescending)if(interval<=maxPerBucketMs)return external_kbnSharedDeps_Moment_default.a.duration(interval);return normalizeMinimumInterval(maxPerBucketMs)}(maxLength,Number(duration));return+scaled==+interval?interval:(decorateInterval(interval),external_kbnSharedDeps_Lodash_default.a.assign(scaled,{preScaled:interval,scale:interval/scaled,scaled:!0}))}(parsedInterval):parsedInterval);function decorateInterval(interval){const esInterval=useNormalizedEsInterval?function(duration){for(let i=0;i<unitsDesc.length;i++){const unit=unitsDesc[i],val=duration.as(unit);if(val>=1&&Math.floor(val)===val){if(i<=largeMax&&1!==val)continue;return{value:val,unit:unit,expression:val+unit}}}const ms=duration.as("ms");return{value:ms,unit:"ms",expression:ms+"ms"}}(interval):function(interval){const{value:value,unit:unit}=(void 0)(interval);return{value:value,unit:unit,expression:interval}}(self.originalInterval);interval.esValue=esInterval.value,interval.esUnit=esInterval.unit,interval.expression=esInterval.expression,interval.overflow=duration>interval&&external_kbnSharedDeps_Moment_default.a.duration(interval-duration);const prettyUnits=external_kbnSharedDeps_Moment_default.a.normalizeUnits(esInterval.unit);return 1===esInterval.value?interval.description=prettyUnits:interval.description=esInterval.value+" "+prettyUnits+"s",interval}},TimeBuckets.prototype.getScaledDateFormat=function(){const interval=this.getInterval(),rules=this.getConfig("dateFormat:scaled");for(let i=rules.length-1;i>=0;i--){const rule=rules[i];if(!rule[0]||interval>=external_kbnSharedDeps_Moment_default.a.duration(rule[0]))return rule[1]}return this.getConfig("dateFormat")},TimeBuckets.prototype.getScaledDateFormatter=function(){return new(this.data.fieldFormats.getType(public_.FIELD_FORMAT_IDS.DATE))({pattern:this.getScaledDateFormat()},this.getConfig.bind(this))},TimeBuckets.__cached__=function(self){let cache={};const sameMoment=same(external_kbnSharedDeps_Moment_default.a.isMoment),sameDuration=same(external_kbnSharedDeps_Moment_default.a.isDuration),desc={__cached__:{value:self}},breakers={setBounds:"bounds",clearBounds:"bounds",setInterval:"interval"},resources={bounds:{setup:function(){return[self._lb,self._ub]},changes:function(prev){return!sameMoment(prev[0],self._lb)||!sameMoment(prev[1],self._ub)}},interval:{setup:function(){return self._i},changes:function(prev){return!sameDuration(prev,this._i)}}};function same(checkType){return function(a,b){return a===b||checkType(a)===checkType(b)&&+a==+b}}return external_kbnSharedDeps_Lodash_default.a.forOwn(TimeBuckets.prototype,(function(fn,prop){"_"!==prop[0]&&(breakers.hasOwnProperty(prop)?desc[prop]=function(prop){const resource=resources[breakers[prop]],setup=resource.setup,changes=resource.changes,fn=self[prop];return{value:function(){const prev=setup.call(self),ret=fn.apply(self,arguments);return changes.call(self,prev)&&(cache={}),ret}}}(prop):desc[prop]=function(prop){return{value:function(...rest){return cache.hasOwnProperty(prop)?cache[prop]:cache[prop]=self[prop](...rest)}}}(prop))})),Object.create(self,desc)}}}]);