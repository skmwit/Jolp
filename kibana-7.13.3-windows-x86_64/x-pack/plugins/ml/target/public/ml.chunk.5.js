/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.ml_bundle_jsonpfunction=window.ml_bundle_jsonpfunction||[]).push([[5,19,20],Array(68).concat([function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"d",(function(){return checkGetManagementMlJobsResolver})),__webpack_require__.d(__webpack_exports__,"c",(function(){return checkGetJobsCapabilitiesResolver})),__webpack_require__.d(__webpack_exports__,"a",(function(){return checkCreateJobsCapabilitiesResolver})),__webpack_require__.d(__webpack_exports__,"b",(function(){return checkFindFileStructurePrivilegeResolver})),__webpack_require__.d(__webpack_exports__,"e",(function(){return checkPermission})),__webpack_require__.d(__webpack_exports__,"f",(function(){return createPermissionFailureMessage}));var external_kbnSharedDeps_KbnI18n_=__webpack_require__(2),license=__webpack_require__(96),capabilities=__webpack_require__(230),ml_api_service=__webpack_require__(64),upgrade_service=__webpack_require__(312);function getCapabilities(){return new Promise((resolve,reject)=>{ml_api_service.ml.checkMlCapabilities().then(resp=>{!0===resp.upgradeInProgress&&Object(upgrade_service.b)(!0),resolve(resp)}).catch(()=>{reject()})})}let _capabilities=Object(capabilities.d)();function checkGetManagementMlJobsResolver(){return new Promise((resolve,reject)=>{new Promise((resolve,reject)=>{ml_api_service.ml.checkManageMLCapabilities().then(resp=>{!0===resp.upgradeInProgress&&Object(upgrade_service.b)(!0),resolve(resp)}).catch(()=>{reject()})}).then(({capabilities:capabilities,isPlatinumOrTrialLicense:isPlatinumOrTrialLicense,mlFeatureEnabledInSpace:mlFeatureEnabledInSpace})=>{_capabilities=capabilities;return!0===Object.values(_capabilities).every(p=>!0===p)&&!0===isPlatinumOrTrialLicense?resolve({mlFeatureEnabledInSpace:mlFeatureEnabledInSpace}):reject({capabilities:capabilities,isPlatinumOrTrialLicense:isPlatinumOrTrialLicense,mlFeatureEnabledInSpace:mlFeatureEnabledInSpace})}).catch(e=>reject())})}function checkGetJobsCapabilitiesResolver(redirectToMlAccessDeniedPage){return new Promise((resolve,reject)=>{getCapabilities().then(async({capabilities:capabilities,isPlatinumOrTrialLicense:isPlatinumOrTrialLicense})=>(_capabilities=capabilities,_capabilities.canGetJobs||!1===isPlatinumOrTrialLicense?resolve(_capabilities):(await redirectToMlAccessDeniedPage(),reject()))).catch(async e=>(await redirectToMlAccessDeniedPage(),reject()))})}function checkCreateJobsCapabilitiesResolver(redirectToJobsManagementPage){return new Promise((resolve,reject)=>{getCapabilities().then(async({capabilities:capabilities,isPlatinumOrTrialLicense:isPlatinumOrTrialLicense})=>(_capabilities=capabilities,_capabilities.canCreateJob||!1===isPlatinumOrTrialLicense?resolve(_capabilities):(await redirectToJobsManagementPage(),reject()))).catch(async e=>(await redirectToJobsManagementPage(),reject()))})}function checkFindFileStructurePrivilegeResolver(redirectToMlAccessDeniedPage){return new Promise((resolve,reject)=>{getCapabilities().then(async({capabilities:capabilities})=>(_capabilities=capabilities,_capabilities.canFindFileStructure?resolve(_capabilities):(await redirectToMlAccessDeniedPage(),reject()))).catch(async e=>(await redirectToMlAccessDeniedPage(),reject()))})}function checkPermission(capability){const licenseHasExpired=Object(license.c)();return!0===_capabilities[capability]&&!0!==licenseHasExpired}function createPermissionFailureMessage(privilegeType){let message="";return Object(license.c)()?message=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.privilege.licenseHasExpiredTooltip",{defaultMessage:"Your license has expired."}):"canCreateJob"===privilegeType?message=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.privilege.noPermission.createMLJobsTooltip",{defaultMessage:"You do not have permission to create Machine Learning jobs."}):"canStartStopDatafeed"===privilegeType?message=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.privilege.noPermission.startOrStopDatafeedsTooltip",{defaultMessage:"You do not have permission to start or stop datafeeds."}):"canUpdateJob"===privilegeType?message=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.privilege.noPermission.editJobsTooltip",{defaultMessage:"You do not have permission to edit jobs."}):"canDeleteJob"===privilegeType?message=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.privilege.noPermission.deleteJobsTooltip",{defaultMessage:"You do not have permission to delete jobs."}):"canCreateCalendar"===privilegeType?message=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.privilege.noPermission.createCalendarsTooltip",{defaultMessage:"You do not have permission to create calendars."}):"canDeleteCalendar"===privilegeType?message=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.privilege.noPermission.deleteCalendarsTooltip",{defaultMessage:"You do not have permission to delete calendars."}):"canForecastJob"===privilegeType&&(message=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.privilege.noPermission.runForecastsTooltip",{defaultMessage:"You do not have permission to run forecasts."})),external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.privilege.pleaseContactAdministratorTooltip",{defaultMessage:"{message} Please contact your administrator.",values:{message:message}})}},,,,,,,,,,function(module,exports,__webpack_require__){var lodash;try{lodash={cloneDeep:__webpack_require__(635),constant:__webpack_require__(260),defaults:__webpack_require__(636),each:__webpack_require__(344),filter:__webpack_require__(347),find:__webpack_require__(637),flatten:__webpack_require__(374),forEach:__webpack_require__(345),forIn:__webpack_require__(644),has:__webpack_require__(358),isUndefined:__webpack_require__(359),last:__webpack_require__(645),map:__webpack_require__(360),mapValues:__webpack_require__(646),max:__webpack_require__(647),merge:__webpack_require__(649),min:__webpack_require__(655),minBy:__webpack_require__(656),now:__webpack_require__(657),pick:__webpack_require__(658),range:__webpack_require__(663),reduce:__webpack_require__(362),sortBy:__webpack_require__(666),uniqueId:__webpack_require__(671),values:__webpack_require__(367),zipObject:__webpack_require__(672)}}catch(e){}lodash||(lodash=window._),module.exports=lodash},,function(module,exports){var isArray=Array.isArray;module.exports=isArray},,,function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return checkMlNodesAvailable})),__webpack_require__.d(__webpack_exports__,"c",(function(){return getMlNodeCount})),__webpack_require__.d(__webpack_exports__,"e",(function(){return mlNodesAvailable})),__webpack_require__.d(__webpack_exports__,"b",(function(){return currentMlNodesAvailable})),__webpack_require__.d(__webpack_exports__,"d",(function(){return lazyMlNodesAvailable})),__webpack_require__.d(__webpack_exports__,"f",(function(){return permissionToViewMlNodeCount}));var _services_ml_api_service__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(64);let mlNodeCount=0,lazyMlNodeCount=0,userHasPermissionToViewMlNodeCount=!1;async function checkMlNodesAvailable(redirectToJobsManagementPage){try{const{count:count,lazyNodeCount:lazyNodeCount}=await getMlNodeCount();if(!(count>0||lazyNodeCount>0))throw Error("Cannot load count of ML nodes");Promise.resolve()}catch(error){console.error(error),await redirectToJobsManagementPage(),Promise.reject()}}async function getMlNodeCount(){try{const nodes=await _services_ml_api_service__WEBPACK_IMPORTED_MODULE_0__.ml.mlNodeCount();return mlNodeCount=nodes.count,lazyMlNodeCount=nodes.lazyNodeCount,userHasPermissionToViewMlNodeCount=!0,nodes}catch(error){return mlNodeCount=0,403===error.statusCode&&(userHasPermissionToViewMlNodeCount=!1),{count:0,lazyNodeCount:0}}}function mlNodesAvailable(){return 0!==mlNodeCount||0!==lazyMlNodeCount}function currentMlNodesAvailable(){return 0!==mlNodeCount}function lazyMlNodesAvailable(){return 0!==lazyMlNodeCount}function permissionToViewMlNodeCount(){return userHasPermissionToViewMlNodeCount}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"j",(function(){return getRichDetectors})),__webpack_require__.d(__webpack_exports__,"g",(function(){return createFieldOptions})),__webpack_require__.d(__webpack_exports__,"h",(function(){return createMlcategoryFieldOption})),__webpack_require__.d(__webpack_exports__,"f",(function(){return createDocCountFieldOption})),__webpack_require__.d(__webpack_exports__,"k",(function(){return isSparseDataJob})),__webpack_require__.d(__webpack_exports__,"e",(function(){return convertToMultiMetricJob})),__webpack_require__.d(__webpack_exports__,"d",(function(){return convertToAdvancedJob})),__webpack_require__.d(__webpack_exports__,"l",(function(){return resetJob})),__webpack_require__.d(__webpack_exports__,"a",(function(){return advancedStartDatafeed})),__webpack_require__.d(__webpack_exports__,"b",(function(){return aggFieldPairsCanBeCharted})),__webpack_require__.d(__webpack_exports__,"i",(function(){return getJobCreatorTitle})),__webpack_require__.d(__webpack_exports__,"c",(function(){return collectAggs}));var _kbn_i18n__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2),_services_new_job_capabilities_new_job_capabilities_service__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(98),_common_constants_aggregation_types__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(81),_common_constants_field_types__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(87),_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(41),_common_types_fields__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(112),_services_job_service__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(70),_common_constants_new_job__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(74);function getRichDetectors(job,datafeed,additionalFields,advanced=!1){const detectors=advanced?function(job,datafeed){return processFieldlessAggs(job.analysis_config.detectors)}(job):function(job,datafeed){let detectors=job.analysis_config.detectors;const sparseData=isSparseDataJob(job,datafeed);if(void 0!==datafeed.aggregations&&job.analysis_config.detectors[0].function===_common_constants_aggregation_types__WEBPACK_IMPORTED_MODULE_2__.b.NON_ZERO_COUNT&&!1===sparseData){var _datafeed$aggregation,_datafeed$aggregation2,_datafeed$aggregation3,_datafeed$aggregation4,_datafeed$aggregation5;const field=null==datafeed||null===(_datafeed$aggregation=datafeed.aggregations)||void 0===_datafeed$aggregation||null===(_datafeed$aggregation2=_datafeed$aggregation.buckets)||void 0===_datafeed$aggregation2||null===(_datafeed$aggregation3=_datafeed$aggregation2.aggregations)||void 0===_datafeed$aggregation3||null===(_datafeed$aggregation4=_datafeed$aggregation3.dc_region)||void 0===_datafeed$aggregation4||null===(_datafeed$aggregation5=_datafeed$aggregation4.cardinality)||void 0===_datafeed$aggregation5?void 0:_datafeed$aggregation5.field;void 0!==field&&(detectors=[{function:_common_constants_aggregation_types__WEBPACK_IMPORTED_MODULE_2__.b.DISTINCT_COUNT,field_name:field}])}else detectors=processFieldlessAggs(detectors),detectors=detectors.map(d=>{switch(d.function){case _common_constants_aggregation_types__WEBPACK_IMPORTED_MODULE_2__.b.NON_ZERO_COUNT:return{...d,field_name:_common_types_fields__WEBPACK_IMPORTED_MODULE_5__.a,function:_common_constants_aggregation_types__WEBPACK_IMPORTED_MODULE_2__.b.COUNT};case _common_constants_aggregation_types__WEBPACK_IMPORTED_MODULE_2__.b.HIGH_NON_ZERO_COUNT:return{...d,field_name:_common_types_fields__WEBPACK_IMPORTED_MODULE_5__.a,function:_common_constants_aggregation_types__WEBPACK_IMPORTED_MODULE_2__.b.HIGH_COUNT};case _common_constants_aggregation_types__WEBPACK_IMPORTED_MODULE_2__.b.LOW_NON_ZERO_COUNT:return{...d,field_name:_common_types_fields__WEBPACK_IMPORTED_MODULE_5__.a,function:_common_constants_aggregation_types__WEBPACK_IMPORTED_MODULE_2__.b.LOW_COUNT};case _common_constants_aggregation_types__WEBPACK_IMPORTED_MODULE_2__.b.NON_NULL_SUM:return{...d,function:_common_constants_aggregation_types__WEBPACK_IMPORTED_MODULE_2__.b.SUM};case _common_constants_aggregation_types__WEBPACK_IMPORTED_MODULE_2__.b.HIGH_NON_NULL_SUM:return{...d,function:_common_constants_aggregation_types__WEBPACK_IMPORTED_MODULE_2__.b.HIGH_SUM};case _common_constants_aggregation_types__WEBPACK_IMPORTED_MODULE_2__.b.LOW_NON_NULL_SUM:return{...d,function:_common_constants_aggregation_types__WEBPACK_IMPORTED_MODULE_2__.b.LOW_SUM};default:return d}});return detectors}(job,datafeed),getFieldById=(additionalFields=>id=>{let field=_services_new_job_capabilities_new_job_capabilities_service__WEBPACK_IMPORTED_MODULE_1__.b.getFieldById(id);return null===field&&(id===_common_constants_field_types__WEBPACK_IMPORTED_MODULE_3__.b?field=_common_types_fields__WEBPACK_IMPORTED_MODULE_5__.c:additionalFields.length&&(field=additionalFields.find(f=>f.id===id)||null)),field})(additionalFields);return detectors.map(d=>{let field=null,byField=null,overField=null,partitionField=null;return void 0!==d.field_name&&(field=getFieldById(d.field_name)),void 0!==d.by_field_name&&(byField=getFieldById(d.by_field_name)),void 0!==d.over_field_name&&(overField=getFieldById(d.over_field_name)),void 0!==d.partition_field_name&&(partitionField=getFieldById(d.partition_field_name)),{agg:_services_new_job_capabilities_new_job_capabilities_service__WEBPACK_IMPORTED_MODULE_1__.b.getAggById(d.function),field:field,byField:byField,overField:overField,partitionField:partitionField,excludeFrequent:d.exclude_frequent||null,description:d.detector_description||null}})}function createFieldOptions(fields,additionalFields){return[...fields.filter(f=>f.id!==_common_types_fields__WEBPACK_IMPORTED_MODULE_5__.a).map(f=>({label:f.name})),...additionalFields.filter(f=>!1===fields.some(f2=>f2.id===f.id)).map(f=>({label:f.id}))].sort((a,b)=>a.label.localeCompare(b.label))}function createMlcategoryFieldOption(categorizationFieldName){return null===categorizationFieldName?[]:[{label:_common_constants_field_types__WEBPACK_IMPORTED_MODULE_3__.b}]}function createDocCountFieldOption(usingAggregations){return usingAggregations?[{label:_common_constants_field_types__WEBPACK_IMPORTED_MODULE_3__.a}]:[{label:_common_constants_field_types__WEBPACK_IMPORTED_MODULE_3__.e}]}function processFieldlessAggs(detectors){return detectors.map(d=>{switch(d.function){case _common_constants_aggregation_types__WEBPACK_IMPORTED_MODULE_2__.b.COUNT:case _common_constants_aggregation_types__WEBPACK_IMPORTED_MODULE_2__.b.HIGH_COUNT:case _common_constants_aggregation_types__WEBPACK_IMPORTED_MODULE_2__.b.LOW_COUNT:case _common_constants_aggregation_types__WEBPACK_IMPORTED_MODULE_2__.b.NON_ZERO_COUNT:case _common_constants_aggregation_types__WEBPACK_IMPORTED_MODULE_2__.b.HIGH_NON_ZERO_COUNT:case _common_constants_aggregation_types__WEBPACK_IMPORTED_MODULE_2__.b.LOW_NON_ZERO_COUNT:case _common_constants_aggregation_types__WEBPACK_IMPORTED_MODULE_2__.b.RARE:case _common_constants_aggregation_types__WEBPACK_IMPORTED_MODULE_2__.b.FREQ_RARE:case _common_constants_aggregation_types__WEBPACK_IMPORTED_MODULE_2__.b.TIME_OF_DAY:case _common_constants_aggregation_types__WEBPACK_IMPORTED_MODULE_2__.b.TIME_OF_WEEK:return{...d,field_name:_common_types_fields__WEBPACK_IMPORTED_MODULE_5__.a};default:return d}})}function isSparseDataJob(job,datafeed){var _datafeed$aggregation6,_datafeed$aggregation7,_datafeed$aggregation8,_datafeed$aggregation9,_datafeed$aggregation10;const detectors=job.analysis_config.detectors;if(void 0===(null==datafeed||null===(_datafeed$aggregation6=datafeed.aggregations)||void 0===_datafeed$aggregation6||null===(_datafeed$aggregation7=_datafeed$aggregation6.buckets)||void 0===_datafeed$aggregation7||null===(_datafeed$aggregation8=_datafeed$aggregation7.aggregations)||void 0===_datafeed$aggregation8||null===(_datafeed$aggregation9=_datafeed$aggregation8.dc_region)||void 0===_datafeed$aggregation9||null===(_datafeed$aggregation10=_datafeed$aggregation9.cardinality)||void 0===_datafeed$aggregation10?void 0:_datafeed$aggregation10.field))for(const detector of detectors)if(_common_constants_aggregation_types__WEBPACK_IMPORTED_MODULE_2__.c.includes(detector.function))return!0;return!1}function stashJobForCloning(jobCreator,skipTimeRangeStep=!1,includeTimeRange=!1){var _jobCreator$createdBy;_services_job_service__WEBPACK_IMPORTED_MODULE_6__.a.tempJobCloningObjects.job=jobCreator.jobConfig,_services_job_service__WEBPACK_IMPORTED_MODULE_6__.a.tempJobCloningObjects.datafeed=jobCreator.datafeedConfig,_services_job_service__WEBPACK_IMPORTED_MODULE_6__.a.tempJobCloningObjects.createdBy=null!==(_jobCreator$createdBy=jobCreator.createdBy)&&void 0!==_jobCreator$createdBy?_jobCreator$createdBy:void 0,_services_job_service__WEBPACK_IMPORTED_MODULE_6__.a.tempJobCloningObjects.skipTimeRangeStep=skipTimeRangeStep,!0===includeTimeRange&&(_services_job_service__WEBPACK_IMPORTED_MODULE_6__.a.tempJobCloningObjects.start=jobCreator.start,_services_job_service__WEBPACK_IMPORTED_MODULE_6__.a.tempJobCloningObjects.end=jobCreator.end),_services_job_service__WEBPACK_IMPORTED_MODULE_6__.a.tempJobCloningObjects.calendars=jobCreator.calendars}function convertToMultiMetricJob(jobCreator,navigateToPath){jobCreator.createdBy=_common_constants_new_job__WEBPACK_IMPORTED_MODULE_7__.a.MULTI_METRIC,jobCreator.modelPlot=!1,stashJobForCloning(jobCreator,!0,!0),navigateToPath("jobs/new_job/"+_common_constants_new_job__WEBPACK_IMPORTED_MODULE_7__.f.MULTI_METRIC,!0)}function convertToAdvancedJob(jobCreator,navigateToPath){jobCreator.createdBy=null,stashJobForCloning(jobCreator,!0,!0),navigateToPath("jobs/new_job/"+_common_constants_new_job__WEBPACK_IMPORTED_MODULE_7__.f.ADVANCED,!0)}function resetJob(jobCreator,navigateToPath){jobCreator.jobId="",stashJobForCloning(jobCreator,!0,!0),navigateToPath("/jobs/new_job")}function advancedStartDatafeed(jobCreator,navigateToPath){null!==jobCreator&&stashJobForCloning(jobCreator,!1,!1),navigateToPath("/jobs")}function aggFieldPairsCanBeCharted(afs){return!1===afs.some(a=>null===a.agg.dslName)}function getJobCreatorTitle(jobCreator){switch(jobCreator.type){case _common_constants_new_job__WEBPACK_IMPORTED_MODULE_7__.f.SINGLE_METRIC:return _kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.ml.newJob.wizard.jobCreatorTitle.singleMetric",{defaultMessage:"Single metric"});case _common_constants_new_job__WEBPACK_IMPORTED_MODULE_7__.f.MULTI_METRIC:return _kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.ml.newJob.wizard.jobCreatorTitle.multiMetric",{defaultMessage:"Multi-metric"});case _common_constants_new_job__WEBPACK_IMPORTED_MODULE_7__.f.POPULATION:return _kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.ml.newJob.wizard.jobCreatorTitle.population",{defaultMessage:"Population"});case _common_constants_new_job__WEBPACK_IMPORTED_MODULE_7__.f.ADVANCED:return _kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.ml.newJob.wizard.jobCreatorTitle.advanced",{defaultMessage:"Advanced"});case _common_constants_new_job__WEBPACK_IMPORTED_MODULE_7__.f.CATEGORIZATION:return _kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.ml.newJob.wizard.jobCreatorTitle.categorization",{defaultMessage:"Categorization"});default:return""}}function collectAggs(o,aggFields){for(const i in o)null!==o[i]&&"object"==typeof o[i]&&("aggregations"!==i&&"aggs"!==i||Object.keys(o[i]).forEach(k=>{"aggregations"!==k&&"aggs"!==k&&aggFields.push({id:k,name:k,type:_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_4__.ES_FIELD_TYPES.KEYWORD,aggregatable:!0})}),collectAggs(o[i],aggFields))}},,,,function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"e",(function(){return loadMlServerInfo})),__webpack_require__.d(__webpack_exports__,"b",(function(){return getNewJobDefaults})),__webpack_require__.d(__webpack_exports__,"c",(function(){return getNewJobLimits})),__webpack_require__.d(__webpack_exports__,"d",(function(){return isCloud})),__webpack_require__.d(__webpack_exports__,"a",(function(){return getCloudDeploymentId}));var _ml_api_service__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(64);let defaults={anomaly_detectors:{},datafeeds:{}},limits={};const cloudInfo={cloudId:null,isCloud:!1};async function loadMlServerInfo(){try{const resp=await _ml_api_service__WEBPACK_IMPORTED_MODULE_0__.ml.mlInfo();return defaults=resp.defaults,limits=resp.limits,cloudInfo.cloudId=resp.cloudId||null,cloudInfo.isCloud=void 0!==resp.cloudId,{defaults:defaults,limits:limits,cloudId:cloudInfo}}catch(error){return{defaults:defaults,limits:limits,cloudId:cloudInfo}}}function getNewJobDefaults(){return defaults}function getNewJobLimits(){return limits}function isCloud(){return cloudInfo.isCloud}function getCloudDeploymentId(){return null===cloudInfo.cloudId?null:function(cloudId){const tempCloudId=cloudId.replace(/^(.+)?:/,"");try{const matches=atob(tempCloudId).match(/^.+\$(.+)(?=\$)/);return null!==matches&&2===matches.length?matches[1]:null}catch(error){return null}}(cloudInfo.cloudId)}},,,,,,,function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"e",(function(){return isSingleMetricJobCreator})),__webpack_require__.d(__webpack_exports__,"c",(function(){return isMultiMetricJobCreator})),__webpack_require__.d(__webpack_exports__,"d",(function(){return isPopulationJobCreator})),__webpack_require__.d(__webpack_exports__,"a",(function(){return isAdvancedJobCreator})),__webpack_require__.d(__webpack_exports__,"b",(function(){return isCategorizationJobCreator})),__webpack_require__.d(__webpack_exports__,"f",(function(){return jobCreatorFactory}));var external_kbnSharedDeps_Rxjs_=__webpack_require__(23),external_kbnSharedDeps_Lodash_=__webpack_require__(7),aggregation_types=__webpack_require__(81),public_=__webpack_require__(41),fields_utils=__webpack_require__(195),default_configs=__webpack_require__(139),job_service=__webpack_require__(70),ml_api_service=__webpack_require__(64),states=__webpack_require__(106);function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class job_runner_JobRunner{constructor(jobCreator){_defineProperty(this,"_jobId",void 0),_defineProperty(this,"_datafeedId",void 0),_defineProperty(this,"_start",0),_defineProperty(this,"_end",0),_defineProperty(this,"_datafeedState",states.a.STOPPED),_defineProperty(this,"_refreshInterval",250),_defineProperty(this,"_progress$",void 0),_defineProperty(this,"_percentageComplete",0),_defineProperty(this,"_stopRefreshPoll",void 0),_defineProperty(this,"_subscribers",void 0),_defineProperty(this,"_datafeedStartTime",0),_defineProperty(this,"_performRefreshRateAdjustment",!1),_defineProperty(this,"_jobAssignedToNode",!1),_defineProperty(this,"_jobAssignedToNode$",void 0),this._jobId=jobCreator.jobId,this._datafeedId=jobCreator.datafeedId,this._start=jobCreator.start,this._end=jobCreator.end,this._percentageComplete=0,this._stopRefreshPoll=jobCreator.stopAllRefreshPolls,this._progress$=new external_kbnSharedDeps_Rxjs_.BehaviorSubject(this._percentageComplete),this._jobAssignedToNode$=new external_kbnSharedDeps_Rxjs_.BehaviorSubject(this._jobAssignedToNode),this._subscribers=jobCreator.subscribers}get datafeedState(){return this._datafeedState}set refreshInterval(v){this._refreshInterval=v}resetInterval(){this._refreshInterval=250}async openJob(){try{const{node:node}=await job_service.a.openJob(this._jobId);this._jobAssignedToNode=void 0!==node&&node.length>0,this._jobAssignedToNode$.next(this._jobAssignedToNode)}catch(error){throw error}}async _startDatafeed(start,end,pollProgress){try{this._datafeedStartTime=Date.now();const subscriptions=!0===pollProgress?this._subscribers.map(s=>this._progress$.subscribe(s)):[];await this.openJob();const{started:started}=await job_service.a.startDatafeed(this._datafeedId,this._jobId,start,end);this._datafeedState=states.a.STARTED,this._percentageComplete=0;const checkProgress=async()=>{const{isRunning:isRunning,progress:prog,isJobClosed:isJobClosed}=await this.getProgress(),progress=100!==prog||!0!==isRunning&&!1!==isJobClosed?prog:prog-1;this._adjustRefreshInterval(progress),this._percentageComplete=progress,this._progress$.next(this._percentageComplete),!0!==isRunning&&!1!==isJobClosed||!1!==this._stopRefreshPoll.stop?(this._progress$.next(100),subscriptions.forEach(s=>s.unsubscribe())):setTimeout(async()=>{!1===this._stopRefreshPoll.stop&&await checkProgress()},this._refreshInterval)},checkJobIsAssigned=async()=>{this._jobAssignedToNode=await this._isJobAssigned(),this._jobAssignedToNode$.next(this._jobAssignedToNode),!0===this._jobAssignedToNode?await checkProgress():setTimeout(async()=>{!1===this._stopRefreshPoll.stop&&await checkJobIsAssigned()},2e3)};return!0===pollProgress&&(!0===this._jobAssignedToNode?await checkProgress():await checkJobIsAssigned()),started}catch(error){throw error}}_adjustRefreshInterval(progress){if(!1===this._performRefreshRateAdjustment){if(!(Date.now()-this._datafeedStartTime>2e3))return;this._performRefreshRateAdjustment=!0}const progressDelta=progress-this._percentageComplete;0!==progressDelta&&(this._refreshInterval=Math.floor(this._refreshInterval*(2/progressDelta)),this._refreshInterval<250&&(this._refreshInterval=250))}async _isJobAssigned(){const{jobs:jobs}=await ml_api_service.ml.getJobStats({jobId:this._jobId});return jobs.length>0&&void 0!==jobs[0].node}async startDatafeed(){return await this._startDatafeed(this._start,this._end,!0)}async startDatafeedInRealTime(continueJob){const start=continueJob?this._end:this._start;return await this._startDatafeed(start,void 0,!1)}async getProgress(){return await ml_api_service.ml.jobs.getLookBackProgress(this._jobId,this._start,this._end)}subscribeToProgress(func){this._progress$.subscribe(func)}async isRunning(){const{isRunning:isRunning}=await this.getProgress();return isRunning}isJobAssignedToNode(){return this._jobAssignedToNode}subscribeToJobAssignment(func){return this._jobAssignedToNode$.subscribe(func)}}var new_job=__webpack_require__(74),general=__webpack_require__(84),object_utils=__webpack_require__(4);function filterRuntimeMappings(job,datafeed){if(!Object(object_utils.b)(datafeed,["runtime_mappings"])||!Object(object_utils.b)(datafeed.runtime_mappings))return{runtime_mappings:{},discarded_mappings:{}};const usedFields=function(job,datafeed){var _datafeed$aggregation;const usedFields=new Set;job.analysis_config.detectors.forEach(d=>{void 0!==d.field_name&&usedFields.add(d.field_name),void 0!==d.by_field_name&&usedFields.add(d.by_field_name),void 0!==d.over_field_name&&usedFields.add(d.over_field_name),void 0!==d.partition_field_name&&usedFields.add(d.partition_field_name)}),void 0!==job.analysis_config.categorization_field_name&&usedFields.add(job.analysis_config.categorization_field_name);void 0!==job.analysis_config.summary_count_field_name&&usedFields.add(job.analysis_config.summary_count_field_name);void 0!==job.analysis_config.influencers&&job.analysis_config.influencers.forEach(i=>usedFields.add(i));const aggs=null!==(_datafeed$aggregation=datafeed.aggregations)&&void 0!==_datafeed$aggregation?_datafeed$aggregation:datafeed.aggs;void 0!==aggs&&function findFieldsInAgg(obj){const fields=[];return Object.entries(obj).forEach(([key,val])=>{Object(object_utils.b)(val)?fields.push(...findFieldsInAgg(val)):"string"==typeof val&&"field"===key&&fields.push(val)}),fields}(aggs).forEach(f=>usedFields.add(f));const query=datafeed.query;void 0!==query&&function findFieldsInQuery(obj){const fields=[];return Object.entries(obj).forEach(([key,val])=>{Object(object_utils.b)(val)?(fields.push(key),fields.push(...findFieldsInQuery(val))):"string"==typeof val?fields.push(val):fields.push(key)}),fields}(query).forEach(f=>usedFields.add(f));return[...usedFields]}(job,datafeed),{runtimeMappings:runtimeMappings,discardedMappings:discardedMappings}=(rm=datafeed.runtime_mappings,{runtimeMappings:(usedFieldNames=usedFields).reduce((acc,cur)=>(void 0!==rm[cur]&&(acc[cur]=rm[cur]),acc),{}),discardedMappings:Object.keys(rm).reduce((acc,cur)=>(!1===usedFieldNames.includes(cur)&&void 0!==rm[cur]&&(acc[cur]=rm[cur]),acc),{})});var rm,usedFieldNames;return{runtime_mappings:runtimeMappings,discarded_mappings:discardedMappings}}var parse_interval=__webpack_require__(26),calendar_service=__webpack_require__(313),datafeed_utils=__webpack_require__(234);function job_creator_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class job_creator_JobCreator{constructor(indexPattern,savedSearch,query){job_creator_defineProperty(this,"_type",new_job.f.SINGLE_METRIC),job_creator_defineProperty(this,"_indexPattern",void 0),job_creator_defineProperty(this,"_savedSearch",void 0),job_creator_defineProperty(this,"_indexPatternTitle",""),job_creator_defineProperty(this,"_job_config",void 0),job_creator_defineProperty(this,"_calendars",void 0),job_creator_defineProperty(this,"_datafeed_config",void 0),job_creator_defineProperty(this,"_detectors",void 0),job_creator_defineProperty(this,"_influencers",void 0),job_creator_defineProperty(this,"_bucketSpanMs",0),job_creator_defineProperty(this,"_useDedicatedIndex",!1),job_creator_defineProperty(this,"_start",0),job_creator_defineProperty(this,"_end",0),job_creator_defineProperty(this,"_subscribers",[]),job_creator_defineProperty(this,"_aggs",[]),job_creator_defineProperty(this,"_fields",[]),job_creator_defineProperty(this,"_scriptFields",[]),job_creator_defineProperty(this,"_runtimeFields",[]),job_creator_defineProperty(this,"_runtimeMappings",null),job_creator_defineProperty(this,"_filterRuntimeMappingsOnSave",!0),job_creator_defineProperty(this,"_aggregationFields",[]),job_creator_defineProperty(this,"_sparseData",!1),job_creator_defineProperty(this,"_stopAllRefreshPolls",{stop:!1}),job_creator_defineProperty(this,"_wizardInitialized$",new external_kbnSharedDeps_Rxjs_.BehaviorSubject(!1)),job_creator_defineProperty(this,"wizardInitialized$",this._wizardInitialized$.asObservable()),this._indexPattern=indexPattern,this._savedSearch=savedSearch,this._indexPatternTitle=indexPattern.title,this._job_config=Object(default_configs.c)(),this._calendars=[],this._datafeed_config=Object(default_configs.b)(this._indexPatternTitle),this._detectors=this._job_config.analysis_config.detectors,this._influencers=this._job_config.analysis_config.influencers,"string"==typeof indexPattern.timeFieldName&&(this._job_config.data_description.time_field=indexPattern.timeFieldName),this._extractRuntimeMappings(),this._datafeed_config.query=query}get type(){return this._type}get indexPatternTitle(){return this._indexPatternTitle}_addDetector(detector,agg,field){this._detectors.push(detector),this._aggs.push(agg),this._fields.push(field),this._updateSparseDataDetectors()}_editDetector(detector,agg,field,index){void 0!==this._detectors[index]&&(this._detectors[index]=detector,this._aggs[index]=agg,this._fields[index]=field,this._updateSparseDataDetectors())}_removeDetector(index){this._detectors.splice(index,1),this._aggs.splice(index,1),this._fields.splice(index,1)}removeAllDetectors(){this._detectors.length=0,this._aggs.length=0,this._fields.length=0}get detectors(){return this._detectors}get aggregationsInDetectors(){return this._aggs}getAggregation(index){const agg=this._aggs[index];return void 0!==agg?agg:null}get aggregations(){return this._aggs}getField(index){const field=this._fields[index];return void 0!==field?field:null}get fields(){return this._fields}set bucketSpan(bucketSpan){this._job_config.analysis_config.bucket_span=bucketSpan,this._setBucketSpanMs(bucketSpan)}get bucketSpan(){return this._job_config.analysis_config.bucket_span}_setBucketSpanMs(bucketSpan){const bs=Object(parse_interval.a)(bucketSpan,!0);this._bucketSpanMs=null===bs?0:bs.asMilliseconds()}get bucketSpanMs(){return this._bucketSpanMs}addInfluencer(influencer){!1===this._influencers.includes(influencer)&&this._influencers.push(influencer)}removeInfluencer(influencer){const idx=this._influencers.indexOf(influencer);-1!==idx&&this._influencers.splice(idx,1)}removeAllInfluencers(){this._influencers.length=0}get influencers(){return this._influencers}set jobId(jobId){this._job_config.job_id=jobId,this._datafeed_config.job_id=jobId,this._datafeed_config.datafeed_id="datafeed-"+jobId,this._useDedicatedIndex&&(this._job_config.results_index_name=jobId)}get jobId(){return this._job_config.job_id}get datafeedId(){return this._datafeed_config.datafeed_id}set description(description){this._job_config.description=description}get description(){return this._job_config.description}get groups(){return this._job_config.groups}set groups(groups){this._job_config.groups=groups}get calendars(){return this._calendars}set calendars(calendars){this._calendars=calendars}_initModelPlotConfig(){void 0===this._job_config.model_plot_config&&(this._job_config.model_plot_config={enabled:!1}),void 0!==this._job_config.model_plot_config&&void 0===this._job_config.model_plot_config.enabled&&(this._job_config.model_plot_config.enabled=!1),void 0!==this._job_config.model_plot_config&&void 0===this._job_config.model_plot_config.annotations_enabled&&(this._job_config.model_plot_config.annotations_enabled=!1)}set modelPlot(enable){this._initModelPlotConfig(),this._job_config.model_plot_config.enabled=enable}get modelPlot(){return void 0!==this._job_config.model_plot_config&&!0===this._job_config.model_plot_config.enabled}set modelChangeAnnotations(enable){this._initModelPlotConfig(),this._job_config.model_plot_config.annotations_enabled=enable}get modelChangeAnnotations(){var _this$_job_config$mod;return!0===(null===(_this$_job_config$mod=this._job_config.model_plot_config)||void 0===_this$_job_config$mod?void 0:_this$_job_config$mod.annotations_enabled)}set useDedicatedIndex(enable){this._useDedicatedIndex=enable,enable?this._job_config.results_index_name=this._job_config.job_id:delete this._job_config.results_index_name}get useDedicatedIndex(){return this._useDedicatedIndex}set modelMemoryLimit(mml){null!==mml?this._job_config.analysis_limits={model_memory_limit:mml}:delete this._job_config.analysis_limits}get modelMemoryLimit(){return this._job_config.analysis_limits&&void 0!==this._job_config.analysis_limits.model_memory_limit?this._job_config.analysis_limits.model_memory_limit:null}set summaryCountFieldName(fieldName){null!==fieldName?this._job_config.analysis_config.summary_count_field_name=fieldName:delete this._job_config.analysis_config.summary_count_field_name}get summaryCountFieldName(){return this._job_config.analysis_config.summary_count_field_name||null}set categorizationFieldName(fieldName){null!==fieldName?this._job_config.analysis_config.categorization_field_name=fieldName:delete this._job_config.analysis_config.categorization_field_name}get categorizationFieldName(){return this._job_config.analysis_config.categorization_field_name||null}addCategorizationFilter(filter){void 0===this._job_config.analysis_config.categorization_filters&&(this._job_config.analysis_config.categorization_filters=[]);const filters=this._job_config.analysis_config.categorization_filters;!1===filters.includes(filter)&&filters.push(filter)}removeCategorizationFilter(filter){const filters=this._job_config.analysis_config.categorization_filters;if(void 0!==filters){const idx=filters.indexOf(filter);-1!==idx&&filters.splice(idx,1),0===filters.length&&this.removeCategorizationFilters()}}removeCategorizationFilters(){delete this._job_config.analysis_config.categorization_filters}get categorizationFilters(){return this._job_config.analysis_config.categorization_filters||null}get timeFieldName(){return this._job_config.data_description.time_field}set timeFieldName(fieldName){this._job_config.data_description.time_field=fieldName}get sparseData(){return this._sparseData}set sparseData(sparseData){this._sparseData=sparseData,this._updateSparseDataDetectors()}_updateSparseDataDetectors(){this._detectors.forEach((d,i)=>{switch(this._aggs[i].id){case aggregation_types.b.COUNT:d.function=this._sparseData?aggregation_types.b.NON_ZERO_COUNT:aggregation_types.b.COUNT;break;case aggregation_types.b.HIGH_COUNT:d.function=this._sparseData?aggregation_types.b.HIGH_NON_ZERO_COUNT:aggregation_types.b.HIGH_COUNT;break;case aggregation_types.b.LOW_COUNT:d.function=this._sparseData?aggregation_types.b.LOW_NON_ZERO_COUNT:aggregation_types.b.LOW_COUNT;break;case aggregation_types.b.SUM:d.function=this._sparseData?aggregation_types.b.NON_NULL_SUM:aggregation_types.b.SUM;break;case aggregation_types.b.HIGH_SUM:d.function=this._sparseData?aggregation_types.b.HIGH_NON_NULL_SUM:aggregation_types.b.HIGH_SUM;break;case aggregation_types.b.LOW_SUM:d.function=this._sparseData?aggregation_types.b.LOW_NON_NULL_SUM:aggregation_types.b.LOW_SUM}})}async _updateCalendars(){if(0!==this._calendars.length)for(const calendar of this._calendars)await calendar_service.a.assignNewJobId(calendar,this.jobId)}setTimeRange(start,end){this._start=start,this._end=end}get start(){return this._start}get end(){return this._end}get query(){return this._datafeed_config.query}set query(query){this._datafeed_config.query=query}get queryDelay(){return this._datafeed_config.query_delay||null}set queryDelay(queryDelay){null!==queryDelay?this._datafeed_config.query_delay=queryDelay:delete this._datafeed_config.query_delay}get frequency(){return this._datafeed_config.frequency||null}set frequency(frequency){null!==frequency?this._datafeed_config.frequency=frequency:delete this._datafeed_config.frequency}get scrollSize(){return this._datafeed_config.scroll_size||null}set scrollSize(scrollSize){null!==scrollSize?this._datafeed_config.scroll_size=scrollSize:delete this._datafeed_config.scroll_size}get indices(){return this._datafeed_config.indices}get scriptFields(){return this._scriptFields}get runtimeMappings(){return this._runtimeMappings}get runtimeFields(){return this._runtimeFields}get aggregationFields(){return this._aggregationFields}get additionalFields(){return[...this._scriptFields,...this._runtimeFields,...this._aggregationFields]}get subscribers(){return this._subscribers}async createAndStartJob(){try{await this.createJob(),await this.createDatafeed();return await this.startDatafeed()}catch(error){throw error}}async createJob(){try{const{success:success,resp:resp}=await job_service.a.saveNewJob(this._job_config);if(await this._updateCalendars(),!0===success)return resp;throw resp}catch(error){throw error}}async createDatafeed(){try{const tempDatafeed=this._getDatafeedWithFilteredRuntimeMappings();return await job_service.a.saveNewDatafeed(tempDatafeed,this._job_config.job_id)}catch(error){throw error}}async startDatafeed(){const jobRunner=new job_runner_JobRunner(this);return await jobRunner.startDatafeed(),jobRunner}_getDatafeedWithFilteredRuntimeMappings(){if(!1===this._filterRuntimeMappingsOnSave)return this._datafeed_config;const{runtime_mappings:filteredRuntimeMappings}=filterRuntimeMappings(this._job_config,this._datafeed_config);return{...this._datafeed_config,runtime_mappings:Object.keys(filteredRuntimeMappings).length>0?filteredRuntimeMappings:void 0}}subscribeToProgress(func){this._subscribers.push(func)}get jobConfig(){return this._job_config}get datafeedConfig(){return this._datafeed_config}get stopAllRefreshPolls(){return this._stopAllRefreshPolls}forceStopRefreshPolls(){this._stopAllRefreshPolls.stop=!0}_setCustomSetting(setting,value){null===value?void 0!==this._job_config.custom_settings&&void 0!==this._job_config.custom_settings[setting]&&(delete this._job_config.custom_settings[setting],0===Object.keys(this._job_config.custom_settings).length&&delete this._job_config.custom_settings):void 0===this._job_config.custom_settings?this._job_config.custom_settings={[setting]:value}:this._job_config.custom_settings[setting]=value}_getCustomSetting(setting){return void 0!==this._job_config.custom_settings&&void 0!==this._job_config.custom_settings[setting]?this._job_config.custom_settings[setting]:null}set createdBy(createdBy){this._setCustomSetting("created_by",createdBy)}get createdBy(){return this._getCustomSetting("created_by")}set customUrls(customUrls){this._setCustomSetting("custom_urls",customUrls)}get customUrls(){return this._getCustomSetting("custom_urls")}get formattedJobJson(){return JSON.stringify(this._job_config,null,2)}get formattedDatafeedJson(){return JSON.stringify(this._datafeed_config,null,2)}set filterRuntimeMappingsOnSave(filter){this._filterRuntimeMappingsOnSave=filter}get filterRuntimeMappingsOnSave(){return this._filterRuntimeMappingsOnSave}_initPerPartitionCategorization(){var _this$_job_config$ana,_this$_job_config$ana2;void 0===this._job_config.analysis_config.per_partition_categorization&&(this._job_config.analysis_config.per_partition_categorization={}),void 0===(null===(_this$_job_config$ana=this._job_config.analysis_config.per_partition_categorization)||void 0===_this$_job_config$ana?void 0:_this$_job_config$ana.enabled)&&(this._job_config.analysis_config.per_partition_categorization.enabled=!1),void 0===(null===(_this$_job_config$ana2=this._job_config.analysis_config.per_partition_categorization)||void 0===_this$_job_config$ana2?void 0:_this$_job_config$ana2.stop_on_warn)&&(this._job_config.analysis_config.per_partition_categorization.stop_on_warn=!1)}get perPartitionCategorization(){var _this$_job_config$ana3;return!0===(null===(_this$_job_config$ana3=this._job_config.analysis_config.per_partition_categorization)||void 0===_this$_job_config$ana3?void 0:_this$_job_config$ana3.enabled)}set perPartitionCategorization(enabled){this._initPerPartitionCategorization(),this._job_config.analysis_config.per_partition_categorization.enabled=enabled}get perPartitionStopOnWarn(){var _this$_job_config$ana4;return!0===(null===(_this$_job_config$ana4=this._job_config.analysis_config.per_partition_categorization)||void 0===_this$_job_config$ana4?void 0:_this$_job_config$ana4.stop_on_warn)}set perPartitionStopOnWarn(enabled){this._initPerPartitionCategorization(),this._job_config.analysis_config.per_partition_categorization.stop_on_warn=enabled}_extractRuntimeMappings(){const runtimeFieldMap=this._indexPattern.toSpec().runtimeFieldMap;void 0!==runtimeFieldMap&&(void 0===this._datafeed_config.runtime_mappings&&(this._datafeed_config.runtime_mappings={}),Object.entries(runtimeFieldMap).forEach(([key,val])=>{this._datafeed_config.runtime_mappings[key]=val})),this._populateRuntimeFields()}_populateRuntimeFields(){var _this$_datafeed_confi;if(this._runtimeFields=[],this._runtimeMappings=null!==(_this$_datafeed_confi=this._datafeed_config.runtime_mappings)&&void 0!==_this$_datafeed_confi?_this$_datafeed_confi:null,null!==this._runtimeMappings){const tempRuntimeFields=Object.entries(this._runtimeMappings).map(([id,runtimeField])=>({id:id,name:id,type:runtimeField.type,aggregatable:!0,aggs:[],runtimeField:runtimeField})),aggs=Object(external_kbnSharedDeps_Lodash_.cloneDeep)([...aggregation_types.d,...aggregation_types.e]);this._runtimeFields=Object(fields_utils.a)(tempRuntimeFields,aggs,{}).fields}}_populateScriptFields(){this._scriptFields=[],void 0!==this._datafeed_config.script_fields&&(this._scriptFields=Object.keys(this._datafeed_config.script_fields).map(f=>({id:f,name:f,type:public_.ES_FIELD_TYPES.KEYWORD,aggregatable:!0})))}_overrideConfigs(job,datafeed){this._job_config=job,this._datafeed_config=datafeed,this._detectors=this._job_config.analysis_config.detectors,this._influencers=this._job_config.analysis_config.influencers,void 0===this._job_config.groups&&(this._job_config.groups=[]),void 0!==this._job_config.analysis_config.influencers&&this._job_config.analysis_config.influencers.forEach(i=>this.addInfluencer(i)),void 0!==this._job_config.results_index_name&&this._job_config.results_index_name!==new_job.g&&(this.useDedicatedIndex=!0),this._populateScriptFields(),this._populateRuntimeFields(),this._aggregationFields=[];const aggs=Object(datafeed_utils.b)(this._datafeed_config);if(void 0!==aggs){const aggBucketsName=Object(object_utils.a)(aggs);if(void 0!==aggBucketsName&&void 0!==aggs[aggBucketsName]){const buckets=aggs[aggBucketsName];Object(general.c)(buckets,this._aggregationFields)}}}}class single_metric_job_creator_SingleMetricJobCreator extends job_creator_JobCreator{constructor(indexPattern,savedSearch,query){var obj,key,value;super(indexPattern,savedSearch,query),obj=this,key="_type",value=new_job.f.SINGLE_METRIC,key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,this.createdBy=new_job.a.SINGLE_METRIC,this._wizardInitialized$.next(!0)}setDetector(agg,field){const dtr=Object(default_configs.a)(agg,field);0===this._detectors.length?this._addDetector(dtr,agg,field):this._editDetector(dtr,agg,field,0),this._createDatafeedAggregations()}set bucketSpan(bucketSpan){this._job_config.analysis_config.bucket_span=bucketSpan,this._setBucketSpanMs(bucketSpan),this._createDatafeedAggregations()}get bucketSpan(){return this._job_config.analysis_config.bucket_span}_createDatafeedAggregations(){if(this._detectors.length&&"string"==typeof this._job_config.analysis_config.bucket_span&&this._aggs.length>0){delete this._job_config.analysis_config.summary_count_field_name,delete this._datafeed_config.aggregations;const functionName=this._aggs[0].dslName,timeField=this._job_config.data_description.time_field,duration=Object(parse_interval.a)(this._job_config.analysis_config.bucket_span,!0);if(null===duration)return;const interval=1e3*duration.asSeconds();let field=null;switch(functionName){case aggregation_types.a.COUNT:this._job_config.analysis_config.summary_count_field_name="doc_count",this._datafeed_config.aggregations={buckets:{date_histogram:{field:timeField,fixed_interval:interval+"ms"},aggregations:{[timeField]:{max:{field:timeField}}}}};break;case aggregation_types.a.AVG:case aggregation_types.a.SUM:case aggregation_types.a.MIN:case aggregation_types.a.MAX:if(field=this._fields[0],null!==field){const fieldName=field.name;this._job_config.analysis_config.summary_count_field_name="doc_count",this._datafeed_config.aggregations={buckets:{date_histogram:{field:timeField,fixed_interval:.1*interval+"ms"},aggregations:{[fieldName]:{[functionName]:{field:fieldName}},[timeField]:{max:{field:timeField}}}}}}break;case aggregation_types.a.CARDINALITY:if(field=this._fields[0],null!==field){const fieldName=field.name;this._job_config.analysis_config.summary_count_field_name="dc_"+fieldName,this._datafeed_config.aggregations={buckets:{date_histogram:{field:timeField,fixed_interval:interval+"ms"},aggregations:{[timeField]:{max:{field:timeField}},[this._job_config.analysis_config.summary_count_field_name]:{[functionName]:{field:fieldName}}}}};const dtr=this._detectors[0];dtr.function=aggregation_types.b.NON_ZERO_COUNT,dtr.detector_description=`${functionName} (${fieldName})`,delete dtr.field_name}}}}get aggFieldPair(){return 0===this._aggs.length?null:{agg:this._aggs[0],field:this._fields[0]}}cloneFromExistingJob(job,datafeed){this._overrideConfigs(job,datafeed),this.createdBy=new_job.a.SINGLE_METRIC,this._sparseData=Object(general.k)(job,datafeed);const detectors=Object(general.j)(job,datafeed,this.additionalFields,!1);this.removeAllDetectors();const dtr=detectors[0];detectors.length&&null!==dtr.agg&&null!==dtr.field&&this.setDetector(dtr.agg,dtr.field)}}function multi_metric_job_creator_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class multi_metric_job_creator_MultiMetricJobCreator extends job_creator_JobCreator{constructor(indexPattern,savedSearch,query){super(indexPattern,savedSearch,query),multi_metric_job_creator_defineProperty(this,"_splitField",null),multi_metric_job_creator_defineProperty(this,"_type",new_job.f.MULTI_METRIC),this.createdBy=new_job.a.MULTI_METRIC,this._wizardInitialized$.next(!0)}setSplitField(field){if(this._splitField=field,null===this._splitField)this.removeSplitField();else for(let i=0;i<this._detectors.length;i++)this._detectors[i].partition_field_name=this._splitField.id}removeSplitField(){this._detectors.forEach(d=>{delete d.partition_field_name})}get splitField(){return this._splitField}addDetector(agg,field){const dtr=this._createDetector(agg,field);this._addDetector(dtr,agg,field)}editDetector(agg,field,index){const dtr=this._createDetector(agg,field);this._editDetector(dtr,agg,field,index)}_createDetector(agg,field){const dtr=Object(default_configs.a)(agg,field);return null!==this._splitField&&(dtr.partition_field_name=this._splitField.id),dtr}removeDetector(index){this._removeDetector(index)}get aggFieldPairs(){return this.detectors.map((d,i)=>({field:this._fields[i],agg:this._aggs[i]}))}cloneFromExistingJob(job,datafeed){this._overrideConfigs(job,datafeed),this.createdBy=new_job.a.MULTI_METRIC,this._sparseData=Object(general.k)(job,datafeed);const detectors=Object(general.j)(job,datafeed,this.additionalFields,!1);void 0!==datafeed.aggregations&&(delete datafeed.aggregations,delete job.analysis_config.summary_count_field_name),this.removeAllDetectors(),detectors.forEach((d,i)=>{const dtr=detectors[i];null!==dtr.agg&&null!==dtr.field&&this.addDetector(dtr.agg,dtr.field)}),detectors.length&&null!==detectors[0].partitionField&&this.setSplitField(detectors[0].partitionField)}}function population_job_creator_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class population_job_creator_PopulationJobCreator extends job_creator_JobCreator{constructor(indexPattern,savedSearch,query){super(indexPattern,savedSearch,query),population_job_creator_defineProperty(this,"_splitField",null),population_job_creator_defineProperty(this,"_byFields",[]),population_job_creator_defineProperty(this,"_type",new_job.f.POPULATION),this.createdBy=new_job.a.POPULATION,this._wizardInitialized$.next(!0)}setByField(field,index){null===field?this.removeByField(index):void 0!==this._detectors[index]&&(this._byFields[index]=field,this._detectors[index].by_field_name=field.id)}removeByField(index){void 0!==this._detectors[index]&&(this._byFields[index]=null,delete this._detectors[index].by_field_name)}getByField(index){return void 0===this._byFields[index]?null:this._byFields[index]}setSplitField(field){if(this._splitField=field,null===this._splitField)this.removeSplitField();else for(let i=0;i<this._detectors.length;i++)this._detectors[i].over_field_name=this._splitField.id}removeSplitField(){this._detectors.forEach(d=>{delete d.over_field_name})}get splitField(){return this._splitField}addDetector(agg,field){const dtr=this._createDetector(agg,field);this._addDetector(dtr,agg,field),this._byFields.push(null)}editDetector(agg,field,index){const dtr=this._createDetector(agg,field),sp=this._byFields[index];null!=sp&&(dtr.by_field_name=sp.id),this._editDetector(dtr,agg,field,index)}_createDetector(agg,field){const dtr=Object(default_configs.a)(agg,field);return null!==this._splitField&&(dtr.over_field_name=this._splitField.id),dtr}removeDetector(index){this._removeDetector(index),this._byFields.splice(index,1)}get aggFieldPairs(){return this.detectors.map((d,i)=>({field:this._fields[i],agg:this._aggs[i],by:{field:this._byFields[i],value:null}}))}cloneFromExistingJob(job,datafeed){this._overrideConfigs(job,datafeed),this.createdBy=new_job.a.POPULATION;const detectors=Object(general.j)(job,datafeed,this.additionalFields,!1);this.removeAllDetectors(),detectors.length&&null!==detectors[0].overField&&this.setSplitField(detectors[0].overField),detectors.forEach((d,i)=>{const dtr=detectors[i];null!==dtr.agg&&null!==dtr.field&&(this.addDetector(dtr.agg,dtr.field),null!==dtr.byField&&this.setByField(dtr.byField,i))})}}var validation_utils=__webpack_require__(133);function advanced_job_creator_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class advanced_job_creator_AdvancedJobCreator extends job_creator_JobCreator{constructor(indexPattern,savedSearch,query){super(indexPattern,savedSearch,query),advanced_job_creator_defineProperty(this,"_type",new_job.f.ADVANCED),advanced_job_creator_defineProperty(this,"_richDetectors",[]),advanced_job_creator_defineProperty(this,"_queryString",void 0),this._queryString=JSON.stringify(this._datafeed_config.query),this._wizardInitialized$.next(!0)}addDetector(agg,field,byField,overField,partitionField,excludeFrequent,description){const{detector:detector,richDetector:richDetector}=this._createDetector(agg,field,byField,overField,partitionField,excludeFrequent,description,null);this._addDetector(detector,agg,field),this._richDetectors.push(richDetector)}editDetector(agg,field,byField,overField,partitionField,excludeFrequent,description,index){const customRules=void 0!==this._detectors[index]&&this._detectors[index].custom_rules||null,{detector:detector,richDetector:richDetector}=this._createDetector(agg,field,byField,overField,partitionField,excludeFrequent,description,customRules);this._editDetector(detector,agg,field,index),void 0!==this._richDetectors[index]&&(this._richDetectors[index]=richDetector)}_createDetector(agg,field,byField,overField,partitionField,excludeFrequent,description,customRules){const detector=Object(default_configs.a)(agg,field);null!==byField&&(detector.by_field_name=byField.id),null!==overField&&(detector.over_field_name=overField.id),null!==partitionField&&(detector.partition_field_name=partitionField.id),null!==excludeFrequent&&(detector.exclude_frequent=excludeFrequent),null!==description&&(detector.detector_description=description),null!==customRules&&(detector.custom_rules=customRules);return{detector:detector,richDetector:{agg:agg,field:field,byField:byField,overField:overField,partitionField:partitionField,excludeFrequent:excludeFrequent,description:description,customRules:customRules}}}removeDetector(index){this._removeDetector(index),this._richDetectors.splice(index,1)}get richDetectors(){return this._richDetectors}get queryString(){return this._queryString}set queryString(qs){this._queryString=qs}get isValidQueryString(){return Object(validation_utils.c)(this._queryString)}async autoSetTimeRange(){const{start:start,end:end}=await ml_api_service.ml.getTimeFieldRange({index:this._indexPatternTitle,timeFieldName:this.timeFieldName,query:this.query,runtimeMappings:this.datafeedConfig.runtime_mappings,indicesOptions:this.datafeedConfig.indices_options});this.setTimeRange(start.epoch,end.epoch)}cloneFromExistingJob(job,datafeed){this._overrideConfigs(job,datafeed);const detectors=Object(general.j)(job,datafeed,this.additionalFields,!0),customRules=this._detectors.map(d=>d.custom_rules);this.removeAllDetectors(),this._richDetectors.length=0,detectors.forEach((d,i)=>{const dtr=detectors[i];null!==dtr.agg&&null!==dtr.field&&this.addDetector(dtr.agg,dtr.field,dtr.byField,dtr.overField,dtr.partitionField,dtr.excludeFrequent,dtr.description)}),customRules.forEach((cr,i)=>{void 0!==cr&&(this._detectors[i].custom_rules=cr)})}}var types_fields=__webpack_require__(112),categorization_job=__webpack_require__(150),categories=__webpack_require__(320),results_loader=__webpack_require__(414),ml_server_info=__webpack_require__(88),index_utils=__webpack_require__(82);function categorization_job_creator_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class categorization_job_creator_CategorizationJobCreator extends job_creator_JobCreator{constructor(indexPattern,savedSearch,query){super(indexPattern,savedSearch,query),categorization_job_creator_defineProperty(this,"_type",new_job.f.CATEGORIZATION),categorization_job_creator_defineProperty(this,"_createCountDetector",()=>{}),categorization_job_creator_defineProperty(this,"_createRareDetector",()=>{}),categorization_job_creator_defineProperty(this,"_examplesLoader",void 0),categorization_job_creator_defineProperty(this,"_categoryFieldExamples",[]),categorization_job_creator_defineProperty(this,"_validationChecks",[]),categorization_job_creator_defineProperty(this,"_overallValidStatus",categorization_job.a.INVALID),categorization_job_creator_defineProperty(this,"_detectorType",aggregation_types.b.COUNT),categorization_job_creator_defineProperty(this,"_categorizationAnalyzer",{}),categorization_job_creator_defineProperty(this,"_defaultCategorizationAnalyzer",void 0),categorization_job_creator_defineProperty(this,"_partitionFieldName",null),categorization_job_creator_defineProperty(this,"_ccsVersionFailure",!1),this.createdBy=new_job.a.CATEGORIZATION,this._examplesLoader=new results_loader.a(this,indexPattern,query);const{anomaly_detectors:anomalyDetectors}=Object(ml_server_info.b)();this._defaultCategorizationAnalyzer=anomalyDetectors.categorization_analyzer||{}}setDefaultDetectorProperties(count,rare,eventRate){null!==count&&null!==rare&&null!==eventRate&&(this._createCountDetector=()=>{this._createDetector(count,eventRate)},this._createRareDetector=()=>{this._createDetector(rare,eventRate)})}_createDetector(agg,field){const dtr=Object(default_configs.a)(agg,field);dtr.by_field_name=types_fields.c.id,this.perPartitionCategorization&&null!==this.categorizationPerPartitionField&&(dtr.partition_field_name=this.categorizationPerPartitionField),this._addDetector(dtr,agg,types_fields.c)}setDetectorType(type){this._detectorType=type,this.removeAllDetectors(),type===aggregation_types.b.COUNT?(this._createCountDetector(),this.bucketSpan=new_job.b):(this._createRareDetector(),this.bucketSpan=new_job.e,this.modelPlot=!1)}set categorizationFieldName(fieldName){null!==fieldName?(this._job_config.analysis_config.categorization_field_name=fieldName,this.setDetectorType(this._detectorType),this.addInfluencer(types_fields.c.id)):(delete this._job_config.analysis_config.categorization_field_name,this._categoryFieldExamples=[],this._validationChecks=[],this._overallValidStatus=categorization_job.a.INVALID)}get categorizationFieldName(){return this._job_config.analysis_config.categorization_field_name||null}async loadCategorizationFieldExamples(){const{examples:examples,sampleSize:sampleSize,overallValidStatus:overallValidStatus,validationChecks:validationChecks}=await this._examplesLoader.loadExamples();return this._categoryFieldExamples=examples,this._validationChecks=validationChecks,this._overallValidStatus=overallValidStatus,this._ccsVersionFailure=this._checkCcsFailure(examples,overallValidStatus,validationChecks),!0===this._ccsVersionFailure&&(this._overallValidStatus=categorization_job.a.VALID),this._wizardInitialized$.next(!0),{examples:examples,sampleSize:sampleSize,overallValidStatus:overallValidStatus,validationChecks:validationChecks,ccsVersionFailure:this._ccsVersionFailure}}_checkCcsFailure(examples,status,checks){var _checks$;return 0===examples.length&&status===categorization_job.a.INVALID&&(null===(_checks$=checks[0])||void 0===_checks$?void 0:_checks$.id)===categories.a.NO_EXAMPLES&&Object(index_utils.g)(this.indexPatternTitle)}get categoryFieldExamples(){return this._categoryFieldExamples}get validationChecks(){return this._validationChecks}get overallValidStatus(){return this._overallValidStatus}get selectedDetectorType(){return this._detectorType}set categorizationAnalyzer(analyzer){this._categorizationAnalyzer=analyzer,Object(external_kbnSharedDeps_Lodash_.isEqual)(this._categorizationAnalyzer,this._defaultCategorizationAnalyzer)?delete this._job_config.analysis_config.categorization_analyzer:this._job_config.analysis_config.categorization_analyzer=analyzer}get categorizationAnalyzer(){return this._categorizationAnalyzer}get categorizationPerPartitionField(){return this._partitionFieldName}set categorizationPerPartitionField(fieldName){null===fieldName?(this._detectors.forEach(detector=>{delete detector.partition_field_name}),null!==this._partitionFieldName&&this.removeInfluencer(this._partitionFieldName),this._partitionFieldName=null):this._partitionFieldName!==fieldName&&(null!==this._partitionFieldName&&this.removeInfluencer(this._partitionFieldName),this.addInfluencer(fieldName),this._partitionFieldName=fieldName,this._detectors.forEach(detector=>{detector.partition_field_name=fieldName}))}get perPartitionCategorization(){var _this$_job_config$ana;return!0===(null===(_this$_job_config$ana=this._job_config.analysis_config.per_partition_categorization)||void 0===_this$_job_config$ana?void 0:_this$_job_config$ana.enabled)}set perPartitionCategorization(enabled){this._initPerPartitionCategorization(),this._job_config.analysis_config.per_partition_categorization.enabled=enabled,!1===enabled&&(this.categorizationPerPartitionField=null)}cloneFromExistingJob(job,datafeed){this._overrideConfigs(job,datafeed),this.createdBy=new_job.a.CATEGORIZATION;const dtr=Object(general.j)(job,datafeed,this.additionalFields,!1)[0];if(void 0!==dtr&&null!==dtr.agg&&null!==dtr.field){const detectorType=dtr.agg.id===aggregation_types.b.COUNT?aggregation_types.b.COUNT:aggregation_types.b.RARE,bs=job.analysis_config.bucket_span;this.setDetectorType(detectorType),null!==dtr.partitionField&&(this.categorizationPerPartitionField=dtr.partitionField.id),this.bucketSpan=bs}}}function isSingleMetricJobCreator(jobCreator){return jobCreator.type===new_job.f.SINGLE_METRIC}function isMultiMetricJobCreator(jobCreator){return jobCreator.type===new_job.f.MULTI_METRIC}function isPopulationJobCreator(jobCreator){return jobCreator.type===new_job.f.POPULATION}function isAdvancedJobCreator(jobCreator){return jobCreator.type===new_job.f.ADVANCED}function isCategorizationJobCreator(jobCreator){return jobCreator.type===new_job.f.CATEGORIZATION}const jobCreatorFactory=jobType=>(indexPattern,savedSearch,query)=>{let jc;switch(jobType){case new_job.f.SINGLE_METRIC:jc=single_metric_job_creator_SingleMetricJobCreator;break;case new_job.f.MULTI_METRIC:jc=multi_metric_job_creator_MultiMetricJobCreator;break;case new_job.f.POPULATION:jc=population_job_creator_PopulationJobCreator;break;case new_job.f.ADVANCED:jc=advanced_job_creator_AdvancedJobCreator;break;case new_job.f.CATEGORIZATION:jc=categorization_job_creator_CategorizationJobCreator;break;default:jc=single_metric_job_creator_SingleMetricJobCreator}return new jc(indexPattern,savedSearch,query)}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return checkBasicLicense})),__webpack_require__.d(__webpack_exports__,"b",(function(){return checkFullLicense})),__webpack_require__.d(__webpack_exports__,"c",(function(){return hasLicenseExpired})),__webpack_require__.d(__webpack_exports__,"d",(function(){return isFullLicense})),__webpack_require__.d(__webpack_exports__,"e",(function(){return setLicenseCache}));var license=__webpack_require__(13),external_kbnSharedDeps_React_=__webpack_require__(14),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),external_kbnSharedDeps_KbnI18n_=__webpack_require__(2),external_kbnSharedDeps_ElasticEui_=__webpack_require__(39),public_=__webpack_require__(42),dependency_cache=__webpack_require__(22);let expiredLicenseBannerId;function showExpiredLicenseWarning(){if(void 0===expiredLicenseBannerId){const message=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.checkLicense.licenseHasExpiredMessage",{defaultMessage:"Your Machine Learning license has expired."}),overlays=Object(dependency_cache.f)();expiredLicenseBannerId=overlays.banners.add(Object(public_.toMountPoint)(external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{iconType:"iInCircle",color:"warning",title:message})))}}class ml_client_license_MlClientLicense extends license.b{fullLicenseResolver(){return!1===this.isMlEnabled()||!1===this.isMinimumLicense()?redirectToKibana():!1===this.isFullLicense()?(window.location.href="#/datavisualizer",Promise.reject()):(this.hasLicenseExpired()&&showExpiredLicenseWarning(),Promise.resolve())}basicLicenseResolver(){return!1===this.isMlEnabled()||!1===this.isMinimumLicense()?redirectToKibana():(this.hasLicenseExpired()&&showExpiredLicenseWarning(),Promise.resolve())}}function redirectToKibana(){return window.location.href="/",Promise.reject()}let mlLicense=null;function setLicenseCache(licensingSetup,postInitFunctions){return mlLicense=new ml_client_license_MlClientLicense,mlLicense.setup(licensingSetup.license$,postInitFunctions),mlLicense}async function checkFullLicense(){return null===mlLicense?(console.error("ML Licensing not initialized"),Promise.reject()):mlLicense.fullLicenseResolver()}async function checkBasicLicense(){return null===mlLicense?(console.error("ML Licensing not initialized"),Promise.reject()):mlLicense.basicLicenseResolver()}function hasLicenseExpired(){return null!==mlLicense&&mlLicense.hasLicenseExpired()}function isFullLicense(){return null!==mlLicense&&mlLicense.isFullLicense()}},,function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return filterCategoryFields})),__webpack_require__.d(__webpack_exports__,"b",(function(){return newJobCapsService}));var _common_types_fields__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(112),_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(41),_ml_api_service__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(64),_new_job_capabilities__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(309);function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}const categoryFieldTypes=[_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_1__.ES_FIELD_TYPES.TEXT,_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_1__.ES_FIELD_TYPES.KEYWORD,_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_1__.ES_FIELD_TYPES.IP];class NewJobCapsService extends _new_job_capabilities__WEBPACK_IMPORTED_MODULE_3__.a{constructor(...args){super(...args),_defineProperty(this,"_catFields",[]),_defineProperty(this,"_dateFields",[]),_defineProperty(this,"_includeEventRateField",!0),_defineProperty(this,"_removeTextFields",!0)}get catFields(){return this._catFields}get dateFields(){return this._dateFields}get categoryFields(){return filterCategoryFields(this._fields)}async initializeFromIndexPattern(indexPattern,includeEventRateField=!0,removeTextFields=!0){try{this._includeEventRateField=includeEventRateField,this._removeTextFields=removeTextFields;const resp=await _ml_api_service__WEBPACK_IMPORTED_MODULE_2__.ml.jobs.newJobCaps(indexPattern.title,"rollup"===indexPattern.type),{fields:allFields,aggs:aggs}=function(resp,indexPatternTitle){const results=resp[indexPatternTitle],fields=[],aggs=[],aggMap={},aggIdMap={};void 0!==results&&(results.aggs.forEach(a=>{const agg={...a,...void 0!==a.fieldIds?{fields:[]}:{}};aggMap[agg.id]=agg,aggs.push(agg)}),results.fields.forEach(f=>{const field={...f,aggs:[]};void 0!==field.aggIds&&(aggIdMap[field.id]=field.aggIds),fields.push(field)}),fields.forEach(field=>{aggIdMap[field.id].forEach(aggId=>{!function(field,agg){void 0===agg.fields&&(agg.fields=[]);void 0===field.aggs&&(field.aggs=[]);agg.fields.push(field),field.aggs.push(agg)}(field,aggMap[aggId])})}));return fields.forEach(f=>delete f.aggIds),aggs.forEach(a=>delete a.fieldIds),{fields:fields,aggs:aggs}}(resp,indexPattern.title);!0===this._includeEventRateField&&function(aggs,fields){const eventRateField={id:_common_types_fields__WEBPACK_IMPORTED_MODULE_0__.a,name:"Event rate",type:_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_1__.ES_FIELD_TYPES.INTEGER,aggregatable:!0,aggs:[]};aggs.forEach(a=>{void 0!==eventRateField.aggs&&void 0===a.fields&&(a.fields=[eventRateField],eventRateField.aggs.push(a))}),fields.splice(0,0,eventRateField)}(aggs,allFields);const{fieldsPreferringKeyword:fieldsPreferringKeyword,fieldsPreferringText:fieldsPreferringText}=Object(_new_job_capabilities__WEBPACK_IMPORTED_MODULE_3__.b)(allFields),catFields=fieldsPreferringText.filter(f=>f.type===_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_1__.ES_FIELD_TYPES.KEYWORD||f.type===_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_1__.ES_FIELD_TYPES.TEXT),dateFields=fieldsPreferringText.filter(f=>f.type===_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_1__.ES_FIELD_TYPES.DATE),fields=this._removeTextFields?fieldsPreferringKeyword:allFields;this._fields=fields,this._catFields=catFields,this._dateFields=dateFields,this._aggs=aggs}catch(error){console.error("Unable to load new job capabilities",error)}}}function filterCategoryFields(fields){return fields.filter(f=>categoryFieldTypes.includes(f.type))}const newJobCapsService=new NewJobCapsService},,function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return NavigationMenu}));var external_kbnSharedDeps_React_=__webpack_require__(14),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),external_kbnSharedDeps_ElasticEui_=__webpack_require__(39),license=__webpack_require__(96),external_kbnSharedDeps_KbnI18n_=__webpack_require__(2),kibana=__webpack_require__(63),url_state=__webpack_require__(77),app=__webpack_require__(5);const TAB_DATA={overview:{testSubject:"mlMainTab overview",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.overviewTabLabel",{defaultMessage:"Overview"})},anomaly_detection:{testSubject:"mlMainTab anomalyDetection",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.anomalyDetectionTabLabel",{defaultMessage:"Anomaly Detection"}),pathId:"jobs"},data_frame_analytics:{testSubject:"mlMainTab dataFrameAnalytics",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataFrameAnalyticsTabLabel",{defaultMessage:"Data Frame Analytics"})},datavisualizer:{testSubject:"mlMainTab dataVisualizer",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataVisualizerTabLabel",{defaultMessage:"Data Visualizer"})},settings:{testSubject:"mlMainTab settings",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.settingsTabLabel",{defaultMessage:"Settings"})},"access-denied":{testSubject:"mlMainTab overview",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.accessDeniedTabLabel",{defaultMessage:"Access Denied"})}},MainTabs=({tabId:tabId,disableLinks:disableLinks})=>{const{services:{chrome:{docTitle:docTitle}}}=Object(kibana.b)(),[globalState]=Object(url_state.c)("_g"),[selectedTabId,setSelectedTabId]=Object(external_kbnSharedDeps_React_.useState)(tabId);const tabs=function(disableLinks){return[{id:"overview",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.navMenu.overviewTabLinkText",{defaultMessage:"Overview"}),disabled:disableLinks},{id:"anomaly_detection",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.navMenu.anomalyDetectionTabLinkText",{defaultMessage:"Anomaly Detection"}),disabled:disableLinks},{id:"data_frame_analytics",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.navMenu.dataFrameAnalyticsTabLinkText",{defaultMessage:"Data Frame Analytics"}),disabled:disableLinks},{id:"datavisualizer",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.navMenu.dataVisualizerTabLinkText",{defaultMessage:"Data Visualizer"}),disabled:!1},{id:"settings",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.navMenu.settingsTabLinkText",{defaultMessage:"Settings"}),disabled:disableLinks}]}(disableLinks),mlUrlGenerator=Object(kibana.d)(),navigateToPath=Object(kibana.e)();return Object(external_kbnSharedDeps_React_.useEffect)(()=>{docTitle.change([TAB_DATA[selectedTabId].name,app.a])},[selectedTabId]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTabs,{display:"condensed"},tabs.map(tab=>{const{id:id,disabled:disabled}=tab,testSubject=TAB_DATA[id].testSubject,defaultPathId=TAB_DATA[id].pathId||id;return disabled?external_kbnSharedDeps_React_default.a.createElement("div",{className:"euiTab",key:`div-${id}-key`},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTab,{key:`tab-${id}-key`,className:"mlNavigationMenu__mainTab",disabled:!0,"data-test-subj":testSubject},tab.name)):external_kbnSharedDeps_React_default.a.createElement("div",{className:"euiTab",key:`div-${id}-key`},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTab,{"data-test-subj":testSubject+(id===selectedTabId?" selected":""),className:"mlNavigationMenu__mainTab",onClick:()=>{!function(id){setSelectedTabId(id)}(id),(async defaultPathId=>{const pageState=void 0!==(null==globalState?void 0:globalState.refreshInterval)?{globalState:{refreshInterval:globalState.refreshInterval}}:void 0,path=await mlUrlGenerator.createUrl({page:defaultPathId,pageState:pageState});await navigateToPath(path,!1)})(defaultPathId)},isSelected:id===selectedTabId,key:`tab-${id}-key`},tab.name))}))},NavigationMenu=({tabId:tabId})=>{const disableLinks=!1===Object(license.d)();return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceBetween",className:"mlNavigationMenu",gutterSize:"none"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(MainTabs,{tabId:tabId,disableLinks:disableLinks}))))}},,function(module,exports,__webpack_require__){"use strict";var _=__webpack_require__(78),Graph=__webpack_require__(113).Graph;function addDummyNode(g,type,attrs,name){var v;do{v=_.uniqueId(name)}while(g.hasNode(v));return attrs.dummy=type,g.setNode(v,attrs),v}function maxRank(g){return _.max(_.map(g.nodes(),(function(v){var rank=g.node(v).rank;if(!_.isUndefined(rank))return rank})))}module.exports={addDummyNode:addDummyNode,simplify:function(g){var simplified=(new Graph).setGraph(g.graph());return _.forEach(g.nodes(),(function(v){simplified.setNode(v,g.node(v))})),_.forEach(g.edges(),(function(e){var simpleLabel=simplified.edge(e.v,e.w)||{weight:0,minlen:1},label=g.edge(e);simplified.setEdge(e.v,e.w,{weight:simpleLabel.weight+label.weight,minlen:Math.max(simpleLabel.minlen,label.minlen)})})),simplified},asNonCompoundGraph:function(g){var simplified=new Graph({multigraph:g.isMultigraph()}).setGraph(g.graph());return _.forEach(g.nodes(),(function(v){g.children(v).length||simplified.setNode(v,g.node(v))})),_.forEach(g.edges(),(function(e){simplified.setEdge(e,g.edge(e))})),simplified},successorWeights:function(g){var weightMap=_.map(g.nodes(),(function(v){var sucs={};return _.forEach(g.outEdges(v),(function(e){sucs[e.w]=(sucs[e.w]||0)+g.edge(e).weight})),sucs}));return _.zipObject(g.nodes(),weightMap)},predecessorWeights:function(g){var weightMap=_.map(g.nodes(),(function(v){var preds={};return _.forEach(g.inEdges(v),(function(e){preds[e.v]=(preds[e.v]||0)+g.edge(e).weight})),preds}));return _.zipObject(g.nodes(),weightMap)},intersectRect:function(rect,point){var sx,sy,x=rect.x,y=rect.y,dx=point.x-x,dy=point.y-y,w=rect.width/2,h=rect.height/2;if(!dx&&!dy)throw new Error("Not possible to find intersection inside of the rectangle");Math.abs(dy)*w>Math.abs(dx)*h?(dy<0&&(h=-h),sx=h*dx/dy,sy=h):(dx<0&&(w=-w),sx=w,sy=w*dy/dx);return{x:x+sx,y:y+sy}},buildLayerMatrix:function(g){var layering=_.map(_.range(maxRank(g)+1),(function(){return[]}));return _.forEach(g.nodes(),(function(v){var node=g.node(v),rank=node.rank;_.isUndefined(rank)||(layering[rank][node.order]=v)})),layering},normalizeRanks:function(g){var min=_.min(_.map(g.nodes(),(function(v){return g.node(v).rank})));_.forEach(g.nodes(),(function(v){var node=g.node(v);_.has(node,"rank")&&(node.rank-=min)}))},removeEmptyRanks:function(g){var offset=_.min(_.map(g.nodes(),(function(v){return g.node(v).rank}))),layers=[];_.forEach(g.nodes(),(function(v){var rank=g.node(v).rank-offset;layers[rank]||(layers[rank]=[]),layers[rank].push(v)}));var delta=0,nodeRankFactor=g.graph().nodeRankFactor;_.forEach(layers,(function(vs,i){_.isUndefined(vs)&&i%nodeRankFactor!=0?--delta:delta&&_.forEach(vs,(function(v){g.node(v).rank+=delta}))}))},addBorderNode:function(g,prefix,rank,order){var node={width:0,height:0};arguments.length>=4&&(node.rank=rank,node.order=order);return addDummyNode(g,"border",node,prefix)},maxRank:maxRank,partition:function(collection,fn){var result={lhs:[],rhs:[]};return _.forEach(collection,(function(value){fn(value)?result.lhs.push(value):result.rhs.push(value)})),result},time:function(name,fn){var start=_.now();try{return fn()}finally{console.log(name+" time: "+(_.now()-start)+"ms")}},notime:function(name,fn){return fn()}}},,function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return HelpMenu}));var external_kbnSharedDeps_React_=__webpack_require__(14),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),external_kbnSharedDeps_KbnI18n_=__webpack_require__(2),kibana=__webpack_require__(63);const HelpMenu=external_kbnSharedDeps_React_default.a.memo(({docLink:docLink})=>{const{chrome:chrome}=Object(kibana.b)().services;return Object(external_kbnSharedDeps_React_.useEffect)(()=>{chrome.setHelpExtension({appName:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.chrome.help.appName",{defaultMessage:"Machine Learning"}),links:[{href:docLink,linkType:"documentation"}]})},[]),null});HelpMenu.displayName="HelpMenu"},,function(module,__webpack_exports__,__webpack_require__){"use strict";let DATAFEED_STATE,FORECAST_REQUEST_STATE,JOB_STATE;__webpack_require__.d(__webpack_exports__,"a",(function(){return DATAFEED_STATE})),__webpack_require__.d(__webpack_exports__,"b",(function(){return FORECAST_REQUEST_STATE})),__webpack_require__.d(__webpack_exports__,"c",(function(){return JOB_STATE})),function(DATAFEED_STATE){DATAFEED_STATE.STARTED="started",DATAFEED_STATE.STARTING="starting",DATAFEED_STATE.STOPPED="stopped",DATAFEED_STATE.STOPPING="stopping",DATAFEED_STATE.DELETED="deleted"}(DATAFEED_STATE||(DATAFEED_STATE={})),function(FORECAST_REQUEST_STATE){FORECAST_REQUEST_STATE.FAILED="failed",FORECAST_REQUEST_STATE.FINISHED="finished",FORECAST_REQUEST_STATE.SCHEDULED="scheduled",FORECAST_REQUEST_STATE.STARTED="started"}(FORECAST_REQUEST_STATE||(FORECAST_REQUEST_STATE={})),function(JOB_STATE){JOB_STATE.CLOSED="closed",JOB_STATE.CLOSING="closing",JOB_STATE.FAILED="failed",JOB_STATE.OPENED="opened",JOB_STATE.OPENING="opening",JOB_STATE.DELETED="deleted"}(JOB_STATE||(JOB_STATE={}))},function(module,exports,__webpack_require__){(function(Buffer){var format_value=__webpack_require__(170).format_value,schema=exports.schema={},properties=exports.properties={CALSCALE:{type:"TEXT"},METHOD:{type:"TEXT"},PRODID:{type:"TEXT"},VERSION:{type:"TEXT"},ATTACH:{type:"URI"},CATEGORIES:{type:"TEXT",list:!0},CLASS:{type:"TEXT"},COMMENT:{type:"TEXT"},DESCRIPTION:{type:"TEXT"},GEO:{type:"FLOAT",list:!0},LOCATION:{type:"TEXT"},"PERCENT-COMPLETE":{type:"INTEGER"},PRIORITY:{type:"INTEGER"},RESOURCES:{type:"TEXT"},STATUS:{type:"TEXT"},SUMMARY:{type:"TEXT"},COMPLETED:{type:"DATE-TIME"},DTEND:{type:"DATE-TIME"},DUE:{type:"DATE-TIME"},DTSTART:{type:"DATE-TIME"},DURATION:{type:"DURATION"},FREEBUSY:{type:"PERIOD"},TRANSP:{type:"TEXT"},TZID:{type:"TEXT"},TZNAME:{type:"TEXT"},TZOFFSETFROM:{type:"UTC-OFFSET"},TZOFFSETTO:{type:"UTC-OFFSET"},TZURL:{type:"URI"},ATTENDEE:{type:"CAL-ADDRESS"},CONTACT:{type:"TEXT"},ORGANIZER:{type:"CAL-ADDRESS"},"RECURRENCE-ID":{type:"DATE-TIME"},"RELATED-TO":{type:"TEXT"},URL:{type:"URI"},UID:{type:"TEXT"},EXDATE:{type:"DATE-TIME",list:!0},RDATE:{type:"DATE-TIME",list:!0},RRULE:{type:"RECUR"},ACTION:{type:"TEXT"},REPEAT:{type:"INTEGER"},TRIGGER:{type:"DURATION"},CREATED:{type:"DATE-TIME"},DTSTAMP:{type:"DATE-TIME"},"LAST-MODIFIED":{type:"DATE-TIME"},SEQUENCE:{type:"INTEGER"},"REQUEST-STATUS":{type:"TEXT"}},CalendarObject=exports.CalendarObject=function(calendar,element){this.calendar=calendar,this.element=element,this.components={},this.properties={}};CalendarObject.create=function(element,calendar){var factory=(schema[element]||{}).factory;return void 0!==factory?new factory(calendar):new CalendarObject(calendar,element)},CalendarObject.prototype.clone=function(){var obj=CalendarObject.create(this.element,this.calendar);for(var prop in this.properties)obj.addProperties(this.properties[prop]);for(var comp=this.getComponents(),i=0;i<comp.length;++i)obj.addComponent(comp[i]);return obj},CalendarObject.prototype.addProperties=function(props){props.forEach(this.addProperty.bind(this))},CalendarObject.prototype.addProperty=function(prop,value,parameters){if(prop instanceof CalendarProperty)prop=prop.clone();else{if(void 0===value)return;prop=new CalendarProperty(prop,value,parameters)}return this.properties[prop.name]=this.properties[prop.name]||[],this.properties[prop.name].push(prop),prop},CalendarObject.prototype.setProperty=function(prop,value,parameters){this.removeProperty(prop instanceof CalendarProperty?prop.name:prop),this.addProperty(prop,value,parameters)},CalendarObject.prototype.addComponent=function(comp){if(!(comp instanceof CalendarObject)){var factory=(schema[comp]||{}).factory;comp=void 0!==factory?new factory(this.calendar):new CalendarObject(this.calendar,comp)}return comp.calendar&&comp.calendar!==this.calendar&&(comp=comp.clone()),this.components[comp.element]=this.components[comp.element]||[],this.components[comp.element].push(comp),comp.calendar=this.calendar,comp},CalendarObject.prototype.addComponents=function(comps){comps.forEach(this.addComponent.bind(this))},CalendarObject.prototype.getComponents=function(type){if(void 0===type){var all=[];for(var c in this.components)all=all.concat(this.components[c]);return all}return this.components[type]||[]},CalendarObject.prototype.getProperty=function(prop,i){return(this.properties[prop]||[])[i||0]},CalendarObject.prototype.getProperties=function(prop){return this.properties[prop]||[]},CalendarObject.prototype.getPropertyValue=function(prop,i){return(this.getProperty(prop,i)||{}).value},CalendarObject.prototype.removeProperty=function(prop){delete this.properties[prop]},CalendarObject.prototype.validate=function(){var self=this,_schema=schema[self.element];for(var type in _schema&&_schema.required_properties&&_schema.required_properties.forEach((function(req){if(!self.getPropertyValue(req))throw new Error(req+" is a required property of "+self.element)})),self.components)self.components[type].forEach((function(comp){comp.validate()}))},CalendarObject.prototype.toString=function(){var output;if("VCALENDAR"==this.element)output=this.format();else{var ical=new(__webpack_require__(198).iCalendar);ical.addComponent(this),output=ical.format()}return output.push(""),output.join("\r\n")},CalendarObject.prototype.format=function(){var lines=["BEGIN:"+this.element];for(var i in this.properties)this.properties[i].forEach((function(prop){lines.push.apply(lines,prop.format())}));for(var comp in this.components)for(comp=this.components[comp],i=0;i<comp.length;++i)lines.push.apply(lines,comp[i].format());return lines.push("END:"+this.element),lines};var CalendarProperty=exports.CalendarProperty=function(name,value,parameters){var propdef=properties[name];this.type=propdef&&propdef.type?propdef.type:"TEXT",this.name=name,this.value=value,this.parameters=parameters||{}};CalendarProperty.prototype.clone=function(){var obj=new CalendarProperty(this.name,this.value);for(var param in obj.type=this.type,this.parameters)obj.parameters[param]=this.parameters[param];return obj},CalendarProperty.prototype.getParameter=function(param){return this.parameters[param]},CalendarProperty.prototype.setParameter=function(param,value){this.parameters[param]=value},CalendarProperty.prototype.format=function(){var params=[];for(var k in this.parameters)params.push(k+"="+this.parameters[k]);params.length&&(params=";"+params.join(";"));for(var len,data=new Buffer(this.name+params+":"+format_value(this.type,this.value,this.parameters)),pos=0,output=[];;){for(pos+(len=75)>=data.length&&(len=data.length-pos);128==(192&data[pos+len]);)len--;if(output.push(data.toString("utf8",pos,pos+len)),pos+len>=data.length)break;data[pos+=len-1]=32}return output}}).call(this,__webpack_require__(196).Buffer)},function(module,exports,__webpack_require__){var lodash;try{lodash={clone:__webpack_require__(523),constant:__webpack_require__(260),each:__webpack_require__(344),filter:__webpack_require__(347),has:__webpack_require__(358),isArray:__webpack_require__(80),isEmpty:__webpack_require__(599),isFunction:__webpack_require__(172),isUndefined:__webpack_require__(359),keys:__webpack_require__(127),map:__webpack_require__(360),reduce:__webpack_require__(362),size:__webpack_require__(602),transform:__webpack_require__(608),union:__webpack_require__(609),values:__webpack_require__(367)}}catch(e){}lodash||(lodash=window._),module.exports=lodash},function(module,exports){module.exports=function(value){var type=typeof value;return null!=value&&("object"==type||"function"==type)}},,,,function(module,exports,__webpack_require__){var graphlib;try{graphlib=__webpack_require__(521)}catch(e){}graphlib||(graphlib=window.graphlib),module.exports=graphlib},function(module,exports,__webpack_require__){var freeGlobal=__webpack_require__(327),freeSelf="object"==typeof self&&self&&self.Object===Object&&self,root=freeGlobal||freeSelf||Function("return this")();module.exports=root},,,,function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"d",(function(){return useChartColors})),__webpack_require__.d(__webpack_exports__,"a",(function(){return defaultChartSettings})),__webpack_require__.d(__webpack_exports__,"c",(function(){return seriesStyle})),__webpack_require__.d(__webpack_exports__,"b",(function(){return getChartSettings}));var _elastic_eui_dist_eui_theme_dark_json__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(54),_elastic_eui_dist_eui_theme_dark_json__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_elastic_eui_dist_eui_theme_dark_json__WEBPACK_IMPORTED_MODULE_0__),_elastic_eui_dist_eui_theme_light_json__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(50),_elastic_eui_dist_eui_theme_light_json__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_elastic_eui_dist_eui_theme_light_json__WEBPACK_IMPORTED_MODULE_1__),_common_job_creator__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(95),_util_time_buckets__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(90),_contexts_kibana_use_ui_settings_context__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(188);function useChartColors(){const themeName=Object(_contexts_kibana_use_ui_settings_context__WEBPACK_IMPORTED_MODULE_4__.a)().get("theme:darkMode")?_elastic_eui_dist_eui_theme_dark_json__WEBPACK_IMPORTED_MODULE_0___default.a:_elastic_eui_dist_eui_theme_light_json__WEBPACK_IMPORTED_MODULE_1___default.a;return{LINE_COLOR:themeName.euiColorPrimary,MODEL_COLOR:themeName.euiColorPrimary,EVENT_RATE_COLOR:themeName.euiColorPrimary,EVENT_RATE_COLOR_WITH_ANOMALIES:themeName.euiColorLightShade}}const defaultChartSettings={width:"100%",height:"300px",cols:1,intervalMs:0},seriesStyle={line:{strokeWidth:2,visible:!0,opacity:1},border:{visible:!1,strokeWidth:0},point:{visible:!1,radius:2,strokeWidth:4,opacity:.5},area:{opacity:.25,visible:!1}};function getChartSettings(jobCreator,chartInterval){const cs={...defaultChartSettings,intervalMs:chartInterval.getInterval().asMilliseconds()};if(Object(_common_job_creator__WEBPACK_IMPORTED_MODULE_2__.d)(jobCreator)){const interval=Object(_util_time_buckets__WEBPACK_IMPORTED_MODULE_3__.c)();interval.setInterval("auto"),interval.setBounds(chartInterval.getBounds()),cs.intervalMs=interval.getInterval().asMilliseconds()}return cs.intervalMs<jobCreator.bucketSpanMs&&(cs.intervalMs=jobCreator.bucketSpanMs),(Object(_common_job_creator__WEBPACK_IMPORTED_MODULE_2__.c)(jobCreator)||Object(_common_job_creator__WEBPACK_IMPORTED_MODULE_2__.d)(jobCreator))&&(jobCreator.aggFieldPairs.length>2&&Object(_common_job_creator__WEBPACK_IMPORTED_MODULE_2__.c)(jobCreator)?(cs.cols=3,cs.height="150px",cs.intervalMs=3*cs.intervalMs):jobCreator.aggFieldPairs.length>1&&(cs.cols=2,cs.height="200px",cs.intervalMs=2*cs.intervalMs)),cs}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return DEFAULT_MODEL_MEMORY_LIMIT})),__webpack_require__.d(__webpack_exports__,"b",(function(){return DEFAULT_NUM_TOP_FEATURE_IMPORTANCE_VALUES})),__webpack_require__.d(__webpack_exports__,"c",(function(){return UNSET_CONFIG_ITEM})),__webpack_require__.d(__webpack_exports__,"e",(function(){return getInitialState})),__webpack_require__.d(__webpack_exports__,"f",(function(){return getJobConfigFromFormState})),__webpack_require__.d(__webpack_exports__,"d",(function(){return getFormStateFromJobConfig}));var _capabilities_check_capabilities__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(68),_ml_nodes_check__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(125),_common_util_runtime_field_utils__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(18),_common_analytics__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(67),_common_util_analytics_utils__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(97),_common_constants_data_frame_analytics__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(79);let DEFAULT_MODEL_MEMORY_LIMIT;!function(DEFAULT_MODEL_MEMORY_LIMIT){DEFAULT_MODEL_MEMORY_LIMIT.regression="100mb",DEFAULT_MODEL_MEMORY_LIMIT.outlier_detection="50mb",DEFAULT_MODEL_MEMORY_LIMIT.classification="100mb"}(DEFAULT_MODEL_MEMORY_LIMIT||(DEFAULT_MODEL_MEMORY_LIMIT={}));const DEFAULT_NUM_TOP_FEATURE_IMPORTANCE_VALUES=0,UNSET_CONFIG_ITEM="--",getInitialState=()=>({advancedEditorMessages:[],advancedEditorRawString:"",disableSwitchToForm:!1,form:{alpha:void 0,computeFeatureInfluence:"true",createIndexPattern:!0,classAssignmentObjective:void 0,dependentVariable:"",description:"",destinationIndex:"",destinationIndexNameExists:!1,destinationIndexNameEmpty:!0,destinationIndexNameValid:!1,destinationIndexPatternTitleExists:!1,earlyStoppingEnabled:void 0,downsampleFactor:void 0,eta:void 0,etaGrowthRatePerTree:void 0,featureBagFraction:void 0,featureInfluenceThreshold:void 0,gamma:void 0,includes:[],jobId:"",jobIdExists:!1,jobIdEmpty:!0,jobIdInvalidMaxLength:!1,jobIdValid:!1,jobType:void 0,jobConfigQuery:_common_analytics__WEBPACK_IMPORTED_MODULE_3__.q,jobConfigQueryString:void 0,lambda:void 0,loadingFieldOptions:!1,maxNumThreads:1,maxOptimizationRoundsPerHyperparameter:void 0,maxTrees:void 0,method:void 0,modelMemoryLimit:void 0,modelMemoryLimitUnitValid:!0,modelMemoryLimitValidationResult:null,nNeighbors:void 0,numTopFeatureImportanceValues:DEFAULT_NUM_TOP_FEATURE_IMPORTANCE_VALUES,numTopFeatureImportanceValuesValid:!0,numTopClasses:-1,outlierFraction:void 0,predictionFieldName:void 0,previousJobType:null,requiredFieldsError:void 0,randomizeSeed:void 0,resultsField:void 0,runtimeMappings:void 0,runtimeMappingsUpdated:!1,previousRuntimeMapping:void 0,softTreeDepthLimit:void 0,softTreeDepthTolerance:void 0,sourceIndex:"",sourceIndexNameEmpty:!0,sourceIndexNameValid:!1,sourceIndexContainsNumericalFields:!0,sourceIndexFieldsCheckFailed:!1,standardizationEnabled:"true",trainingPercent:80,useEstimatedMml:!0},jobConfig:{},disabled:!Object(_ml_nodes_check__WEBPACK_IMPORTED_MODULE_1__.d)()||!Object(_capabilities_check_capabilities__WEBPACK_IMPORTED_MODULE_0__.e)("canCreateDataFrameAnalytics")||!Object(_capabilities_check_capabilities__WEBPACK_IMPORTED_MODULE_0__.e)("canStartStopDataFrameAnalytics"),indexPatternsMap:{},isAdvancedEditorEnabled:!1,isAdvancedEditorValidJson:!0,hasSwitchedToEditor:!1,isJobCreated:!1,isJobStarted:!1,isValid:!1,jobIds:[],requestMessages:[],estimatedModelMemoryLimit:""}),getJobConfigFromFormState=formState=>{const jobConfig={description:formState.description,source:{index:formState.sourceIndex.includes(",")?formState.sourceIndex.split(",").map(d=>d.trim()):formState.sourceIndex,query:formState.jobConfigQuery,...Object(_common_util_runtime_field_utils__WEBPACK_IMPORTED_MODULE_2__.b)(formState.runtimeMappings)?{runtime_mappings:formState.runtimeMappings}:{}},dest:{index:formState.destinationIndex},analyzed_fields:{includes:formState.includes},analysis:{outlier_detection:{}},model_memory_limit:formState.modelMemoryLimit};void 0!==formState.maxNumThreads&&(jobConfig.max_num_threads=formState.maxNumThreads);const resultsFieldEmpty="string"==typeof(null==formState?void 0:formState.resultsField)&&""===(null==formState?void 0:formState.resultsField.trim());if(jobConfig.dest&&!resultsFieldEmpty&&(jobConfig.dest.results_field=formState.resultsField),formState.jobType===_common_constants_data_frame_analytics__WEBPACK_IMPORTED_MODULE_5__.a.REGRESSION||formState.jobType===_common_constants_data_frame_analytics__WEBPACK_IMPORTED_MODULE_5__.a.CLASSIFICATION){let analysis={dependent_variable:formState.dependentVariable,num_top_feature_importance_values:formState.numTopFeatureImportanceValues,training_percent:formState.trainingPercent};analysis=Object.assign(analysis,formState.alpha&&{alpha:formState.alpha},formState.eta&&{eta:formState.eta},formState.etaGrowthRatePerTree&&{eta_growth_rate_per_tree:formState.etaGrowthRatePerTree},formState.downsampleFactor&&{downsample_factor:formState.downsampleFactor},formState.featureBagFraction&&{feature_bag_fraction:formState.featureBagFraction},formState.gamma&&{gamma:formState.gamma},formState.lambda&&{lambda:formState.lambda},formState.maxOptimizationRoundsPerHyperparameter&&{max_optimization_rounds_per_hyperparameter:formState.maxOptimizationRoundsPerHyperparameter},formState.maxTrees&&{max_trees:formState.maxTrees},formState.randomizeSeed&&{randomize_seed:formState.randomizeSeed},void 0!==formState.earlyStoppingEnabled&&{early_stopping_enabled:formState.earlyStoppingEnabled},formState.predictionFieldName&&{prediction_field_name:formState.predictionFieldName},formState.randomizeSeed&&{randomize_seed:formState.randomizeSeed},formState.softTreeDepthLimit&&{soft_tree_depth_limit:formState.softTreeDepthLimit},formState.softTreeDepthTolerance&&{soft_tree_depth_tolerance:formState.softTreeDepthTolerance}),jobConfig.analysis={[formState.jobType]:analysis}}if(void 0!==(null==jobConfig?void 0:jobConfig.analysis)&&Object(_common_util_analytics_utils__WEBPACK_IMPORTED_MODULE_4__.f)(null==jobConfig?void 0:jobConfig.analysis)&&(void 0!==formState.numTopClasses&&(jobConfig.analysis.classification.num_top_classes=formState.numTopClasses),void 0!==formState.classAssignmentObjective&&(jobConfig.analysis.classification.class_assignment_objective=formState.classAssignmentObjective)),formState.jobType===_common_constants_data_frame_analytics__WEBPACK_IMPORTED_MODULE_5__.a.OUTLIER_DETECTION){const analysis=Object.assign({},void 0!==formState.computeFeatureInfluence&&{compute_feature_influence:formState.computeFeatureInfluence},formState.method&&{method:formState.method},formState.nNeighbors&&{n_neighbors:formState.nNeighbors},formState.outlierFraction&&{outlier_fraction:formState.outlierFraction},formState.featureInfluenceThreshold&&{feature_influence_threshold:formState.featureInfluenceThreshold},void 0!==formState.standardizationEnabled&&{standardization_enabled:formState.standardizationEnabled});jobConfig.analysis.outlier_detection=analysis}return jobConfig};function getFormStateFromJobConfig(analyticsJobConfig,isClone=!0){var _analyticsJobConfig$d,_analyticsJobConfig$a,_analyticsJobConfig$a2;const jobType=Object(_common_analytics__WEBPACK_IMPORTED_MODULE_3__.r)(analyticsJobConfig.analysis),resultState={jobType:jobType,description:null!==(_analyticsJobConfig$d=analyticsJobConfig.description)&&void 0!==_analyticsJobConfig$d?_analyticsJobConfig$d:"",resultsField:analyticsJobConfig.dest.results_field,sourceIndex:Array.isArray(analyticsJobConfig.source.index)?analyticsJobConfig.source.index.join(","):analyticsJobConfig.source.index,runtimeMappings:analyticsJobConfig.source.runtime_mappings,modelMemoryLimit:analyticsJobConfig.model_memory_limit,maxNumThreads:analyticsJobConfig.max_num_threads,includes:null!==(_analyticsJobConfig$a=null===(_analyticsJobConfig$a2=analyticsJobConfig.analyzed_fields)||void 0===_analyticsJobConfig$a2?void 0:_analyticsJobConfig$a2.includes)&&void 0!==_analyticsJobConfig$a?_analyticsJobConfig$a:[],jobConfigQuery:analyticsJobConfig.source.query||_common_analytics__WEBPACK_IMPORTED_MODULE_3__.q};var _analyticsJobConfig$d2;!1===isClone&&(resultState.destinationIndex=null!==(_analyticsJobConfig$d2=null==analyticsJobConfig?void 0:analyticsJobConfig.dest.index)&&void 0!==_analyticsJobConfig$d2?_analyticsJobConfig$d2:"");const analysisConfig=analyticsJobConfig.analysis[jobType];for(const key in analysisConfig)if(analysisConfig.hasOwnProperty(key)){resultState[key.replace(/_([a-z])/g,(function(g){return g[1].toUpperCase()}))]=analysisConfig[key]}return resultState}},function(module,exports){module.exports=function(value){return null!=value&&"object"==typeof value}},,,function(module,exports,__webpack_require__){var isFunction=__webpack_require__(172),isLength=__webpack_require__(254);module.exports=function(value){return null!=value&&isLength(value.length)&&!isFunction(value)}},function(module,exports,__webpack_require__){var baseMatches=__webpack_require__(579),baseMatchesProperty=__webpack_require__(589),identity=__webpack_require__(144),isArray=__webpack_require__(80),property=__webpack_require__(596);module.exports=function(value){return"function"==typeof value?value:null==value?identity:"object"==typeof value?isArray(value)?baseMatchesProperty(value[0],value[1]):baseMatches(value):property(value)}},function(module,__webpack_exports__,__webpack_require__){"use strict";var _check_ml_nodes__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(83);__webpack_require__.d(__webpack_exports__,"a",(function(){return _check_ml_nodes__WEBPACK_IMPORTED_MODULE_0__.a})),__webpack_require__.d(__webpack_exports__,"b",(function(){return _check_ml_nodes__WEBPACK_IMPORTED_MODULE_0__.c})),__webpack_require__.d(__webpack_exports__,"d",(function(){return _check_ml_nodes__WEBPACK_IMPORTED_MODULE_0__.e})),__webpack_require__.d(__webpack_exports__,"c",(function(){return _check_ml_nodes__WEBPACK_IMPORTED_MODULE_0__.d})),__webpack_require__.d(__webpack_exports__,"e",(function(){return _check_ml_nodes__WEBPACK_IMPORTED_MODULE_0__.f}))},,function(module,exports,__webpack_require__){var arrayLikeKeys=__webpack_require__(330),baseKeys=__webpack_require__(256),isArrayLike=__webpack_require__(123);module.exports=function(object){return isArrayLike(object)?arrayLikeKeys(object):baseKeys(object)}},,function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return MLJobEditor})),__webpack_require__.d(__webpack_exports__,"b",(function(){return ML_EDITOR_MODE}));var external_kbnSharedDeps_React_=__webpack_require__(14),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),external_kbnSharedDeps_ElasticEui_=__webpack_require__(39),shared_imports=__webpack_require__(167);const ML_EDITOR_MODE={TEXT:"text",JSON:"json",XJSON:new shared_imports.a},MLJobEditor=({value:value,height:height="500px",width:width="100%",mode:mode=ML_EDITOR_MODE.JSON,readOnly:readOnly=!1,syntaxChecking:syntaxChecking=!0,theme:theme="textmate",onChange:onChange=(()=>{})})=>(mode===ML_EDITOR_MODE.XJSON&&(value=Object(shared_imports.c)(value)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCodeEditor,{value:value,width:width,height:height,mode:mode,readOnly:readOnly,wrapEnabled:!0,showPrintMargin:!1,theme:theme,editorProps:{$blockScrolling:!0},setOptions:{useWorker:syntaxChecking,tabSize:2,useSoftTabs:!0},onChange:onChange}))},,,,,,,function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return annotationsRefresh$})),__webpack_require__.d(__webpack_exports__,"c",(function(){return annotationsRefreshed})),__webpack_require__.d(__webpack_exports__,"a",(function(){return AnnotationUpdatesService}));var rxjs__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(23),rxjs_operators__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(25);new rxjs__WEBPACK_IMPORTED_MODULE_0__.BehaviorSubject(null);const annotationsRefresh$=new rxjs__WEBPACK_IMPORTED_MODULE_0__.BehaviorSubject(Date.now()),annotationsRefreshed=()=>annotationsRefresh$.next(Date.now());class AnnotationUpdatesService{constructor(){var obj,key,value;obj=this,key="_annotation$",value=new rxjs__WEBPACK_IMPORTED_MODULE_0__.BehaviorSubject(null),key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value}update$(){return this._annotation$.asObservable()}isAnnotationInitialized$(){return this._annotation$.asObservable().pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_1__.distinctUntilChanged)((prev,curr)=>null!==prev&&null!==curr))}setValue(annotation){this._annotation$.next(annotation)}}},,function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return MlAnnotationUpdatesContext}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(14),_services_annotations_service__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(136);const MlAnnotationUpdatesContext=Object(react__WEBPACK_IMPORTED_MODULE_0__.createContext)(new _services_annotations_service__WEBPACK_IMPORTED_MODULE_1__.a)},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"c",(function(){return createEmptyJob})),__webpack_require__.d(__webpack_exports__,"b",(function(){return createEmptyDatafeed})),__webpack_require__.d(__webpack_exports__,"a",(function(){return createBasicDetector}));var _common_types_fields__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(112),_common_util_job_utils__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(69);function createEmptyJob(){return{job_id:"",description:"",groups:[],analysis_config:{bucket_span:"",detectors:[],influencers:[]},data_description:{time_field:""}}}function createEmptyDatafeed(indexPatternTitle){return{datafeed_id:"",job_id:"",indices:Object(_common_util_job_utils__WEBPACK_IMPORTED_MODULE_1__.t)(indexPatternTitle),query:{}}}function createBasicDetector(agg,field){const dtr={function:agg.id};return field.id!==_common_types_fields__WEBPACK_IMPORTED_MODULE_0__.a&&(dtr.field_name=field.id),dtr}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"d",(function(){return isAdvancedConfig})),__webpack_require__.d(__webpack_exports__,"c",(function(){return extractCloningConfig})),__webpack_require__.d(__webpack_exports__,"b",(function(){return cloneActionNameText})),__webpack_require__.d(__webpack_exports__,"e",(function(){return useNavigateToWizardWithClonedJob})),__webpack_require__.d(__webpack_exports__,"a",(function(){return CloneActionName}));var _elastic_eui__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(39),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(14),react__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__),lodash__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(7),_kbn_i18n__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(2),_common__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(71),_common_analytics__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(67),_common_constants_data_frame_analytics__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(79),_contexts_kibana__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(63),_hooks_use_create_analytics_form__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(419),_common_util_errors__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(24);function isAdvancedConfig(config,meta=(config=>({allow_lazy_start:{optional:!0,defaultValue:!1},description:{optional:!0,formKey:"description"},analysis:{...Object(_common_analytics__WEBPACK_IMPORTED_MODULE_5__.A)(config.analysis)?{classification:{dependent_variable:{optional:!1,formKey:"dependentVariable"},training_percent:{optional:!0,formKey:"trainingPercent"},eta:{optional:!0,formKey:"eta"},feature_bag_fraction:{optional:!0,formKey:"featureBagFraction"},max_trees:{optional:!0,formKey:"maxTrees"},gamma:{optional:!0,formKey:"gamma"},lambda:{optional:!0,formKey:"lambda"},num_top_classes:{optional:!0,defaultValue:2,formKey:"numTopClasses"},prediction_field_name:{optional:!0,defaultValue:config.analysis.classification.dependent_variable+"_prediction",formKey:"predictionFieldName"},randomize_seed:{optional:!0,ignore:!0,formKey:"randomizeSeed"},num_top_feature_importance_values:{optional:!0,defaultValue:_hooks_use_create_analytics_form__WEBPACK_IMPORTED_MODULE_8__.a,formKey:"numTopFeatureImportanceValues"},class_assignment_objective:{optional:!0,defaultValue:"maximize_minimum_recall"},early_stopping_enabled:{optional:!0,ignore:!0},alpha:{optional:!0,formKey:"alpha"},downsample_factor:{optional:!0,formKey:"downsampleFactor"},eta_growth_rate_per_tree:{optional:!0,formKey:"etaGrowthRatePerTree"},max_optimization_rounds_per_hyperparameter:{optional:!0,formKey:"maxOptimizationRoundsPerHyperparameter"},soft_tree_depth_limit:{optional:!0,formKey:"softTreeDepthLimit"},soft_tree_depth_tolerance:{optional:!0,formKey:"softTreeDepthTolerance"}}}:{},...Object(_common__WEBPACK_IMPORTED_MODULE_4__.D)(config.analysis)?{outlier_detection:{standardization_enabled:{defaultValue:!0,optional:!0,formKey:"standardizationEnabled"},compute_feature_influence:{defaultValue:!0,optional:!0,formKey:"computeFeatureInfluence"},outlier_fraction:{defaultValue:.05,optional:!0,formKey:"outlierFraction"},feature_influence_threshold:{optional:!0,formKey:"featureInfluenceThreshold"},method:{optional:!0,formKey:"method"},n_neighbors:{optional:!0,formKey:"nNeighbors"}}}:{},...Object(_common_analytics__WEBPACK_IMPORTED_MODULE_5__.D)(config.analysis)?{regression:{dependent_variable:{optional:!1,formKey:"dependentVariable"},training_percent:{optional:!0,formKey:"trainingPercent"},eta:{optional:!0,formKey:"eta"},feature_bag_fraction:{optional:!0,formKey:"featureBagFraction"},max_trees:{optional:!0,formKey:"maxTrees"},gamma:{optional:!0,formKey:"gamma"},lambda:{optional:!0,formKey:"lambda"},prediction_field_name:{optional:!0,defaultValue:config.analysis.regression.dependent_variable+"_prediction",formKey:"predictionFieldName"},num_top_feature_importance_values:{optional:!0,defaultValue:_hooks_use_create_analytics_form__WEBPACK_IMPORTED_MODULE_8__.a,formKey:"numTopFeatureImportanceValues"},randomize_seed:{optional:!0,ignore:!0,formKey:"randomizeSeed"},loss_function:{optional:!0,defaultValue:"mse"},loss_function_parameter:{optional:!0},early_stopping_enabled:{optional:!0,ignore:!0},alpha:{optional:!0,formKey:"alpha"},downsample_factor:{optional:!0,formKey:"downsampleFactor"},eta_growth_rate_per_tree:{optional:!0,formKey:"etaGrowthRatePerTree"},max_optimization_rounds_per_hyperparameter:{optional:!0,formKey:"maxOptimizationRoundsPerHyperparameter"},soft_tree_depth_limit:{optional:!0,formKey:"softTreeDepthLimit"},soft_tree_depth_tolerance:{optional:!0,formKey:"softTreeDepthTolerance"}}}:{}},analyzed_fields:{excludes:{optional:!0,defaultValue:[]},includes:{optional:!0,formKey:"includes",defaultValue:[]}},source:{index:{formKey:"sourceIndex",optional:!1},query:{optional:!0,defaultValue:{match_all:{}}},runtime_mappings:{optional:!0,formKey:"runtimeMappings",defaultValue:void 0},_source:{optional:!0}},dest:{index:{optional:!1,formKey:"destinationIndex"},results_field:{optional:!0,formKey:"resultsField",defaultValue:_common_constants_data_frame_analytics__WEBPACK_IMPORTED_MODULE_6__.d}},model_memory_limit:{optional:!0,formKey:"modelMemoryLimit"},max_num_threads:{optional:!0,formKey:"maxNumThreads"}}))(config)){for(const configKey in config)if(config.hasOwnProperty(configKey)){const fieldConfig=config[configKey],fieldMeta=meta[configKey];if(!fieldMeta)return console.info(`Property "${configKey}" is unknown.`),!0;if(fieldMeta.hasOwnProperty("optional")){if(void 0===fieldMeta.formKey&&!0!==fieldMeta.ignore&&!Object(lodash__WEBPACK_IMPORTED_MODULE_2__.isEqual)(fieldMeta.defaultValue,fieldConfig))return console.info(`Property "${configKey}" is not supported by the form or has a different value to the default.`),!0}else if(isAdvancedConfig(fieldConfig,fieldMeta))return!0}return!1}function extractCloningConfig({id:id,...configToClone}){return Object(lodash__WEBPACK_IMPORTED_MODULE_2__.cloneDeep)({...configToClone,dest:{...configToClone.dest,index:""}})}const cloneActionNameText=_kbn_i18n__WEBPACK_IMPORTED_MODULE_3__.i18n.translate("xpack.ml.dataframe.analyticsList.cloneActionNameText",{defaultMessage:"Clone"}),useNavigateToWizardWithClonedJob=()=>{const{services:{notifications:{toasts:toasts},savedObjects:savedObjects}}=Object(_contexts_kibana__WEBPACK_IMPORTED_MODULE_7__.b)(),navigateToPath=Object(_contexts_kibana__WEBPACK_IMPORTED_MODULE_7__.e)(),savedObjectsClient=savedObjects.client;return async item=>{const sourceIndex=Array.isArray(item.config.source.index)?item.config.source.index.join(","):item.config.source.index;let sourceIndexId;try{const ip=(await savedObjectsClient.find({type:"index-pattern",perPage:10,search:`"${sourceIndex}"`,searchFields:["title"],fields:["title"]})).savedObjects.find(obj=>obj.attributes.title.toLowerCase()===sourceIndex.toLowerCase());void 0!==ip?sourceIndexId=ip.id:toasts.addDanger(_kbn_i18n__WEBPACK_IMPORTED_MODULE_3__.i18n.translate("xpack.ml.dataframe.analyticsList.noSourceIndexPatternForClone",{defaultMessage:"Unable to clone the analytics job. No index pattern exists for index {indexPattern}.",values:{indexPattern:sourceIndex}}))}catch(e){const error=Object(_common_util_errors__WEBPACK_IMPORTED_MODULE_9__.i)(e);toasts.addDanger(_kbn_i18n__WEBPACK_IMPORTED_MODULE_3__.i18n.translate("xpack.ml.dataframe.analyticsList.fetchSourceIndexPatternForCloneErrorMessage",{defaultMessage:"An error occurred checking if index pattern {indexPattern} exists: {error}",values:{indexPattern:sourceIndex,error:error}}))}sourceIndexId&&await navigateToPath(`/data_frame_analytics/new_job?index=${encodeURIComponent(sourceIndexId)}&jobId=${item.config.id}`)}},CloneActionName=({isDisabled:isDisabled})=>isDisabled?react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_0__.EuiToolTip,{position:"top",content:_kbn_i18n__WEBPACK_IMPORTED_MODULE_3__.i18n.translate("xpack.ml.dataframe.analyticsList.cloneActionPermissionTooltip",{defaultMessage:"You do not have permission to clone analytics jobs."})},react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_1___default.a.Fragment,null,cloneActionNameText)):react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_1___default.a.Fragment,null,cloneActionNameText)},function(module,exports,__webpack_require__){var baseIsNative=__webpack_require__(534),getValue=__webpack_require__(539);module.exports=function(object,key){var value=getValue(object,key);return baseIsNative(value)?value:void 0}},function(module,exports,__webpack_require__){var Symbol=__webpack_require__(153),getRawTag=__webpack_require__(535),objectToString=__webpack_require__(536),symToStringTag=Symbol?Symbol.toStringTag:void 0;module.exports=function(value){return null==value?void 0===value?"[object Undefined]":"[object Null]":symToStringTag&&symToStringTag in Object(value)?getRawTag(value):objectToString(value)}},function(module,exports,__webpack_require__){var arrayLikeKeys=__webpack_require__(330),baseKeysIn=__webpack_require__(559),isArrayLike=__webpack_require__(123);module.exports=function(object){return isArrayLike(object)?arrayLikeKeys(object,!0):baseKeysIn(object)}},function(module,exports){module.exports=function(value){return value}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"c",(function(){return ColorRangeLegend})),__webpack_require__.d(__webpack_exports__,"d",(function(){return useColorRange})),__webpack_require__.d(__webpack_exports__,"a",(function(){return COLOR_RANGE})),__webpack_require__.d(__webpack_exports__,"b",(function(){return COLOR_RANGE_SCALE})),__webpack_require__.d(__webpack_exports__,"e",(function(){return useCurrentEuiTheme}));var external_kbnSharedDeps_React_=__webpack_require__(14),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),d3=__webpack_require__(105),d3_default=__webpack_require__.n(d3),external_kbnSharedDeps_ElasticEui_=__webpack_require__(39);const ColorRangeLegend=({colorRange:colorRange,justifyTicks:justifyTicks=!1,showTicks:showTicks=!0,title:title,width:width=250})=>{const d3Container=Object(external_kbnSharedDeps_React_.useRef)(null),scale=d3_default.a.range(11).map(d=>({offset:d/10*100,stopColor:colorRange(d/10)}));return Object(external_kbnSharedDeps_React_.useEffect)(()=>{if(null===d3Container.current)return;const wrapperWidth=width,margin_top=2,margin_left=justifyTicks||!showTicks?1:4,legendWidth=wrapperWidth-margin_left-1,legendHeight=32-margin_top-20;d3_default.a.select(d3Container.current).selectAll("*").remove();const wrapper=d3_default.a.select(d3Container.current).classed("mlColorRangeLegend",!0).attr("width",wrapperWidth).attr("height",32).append("g").attr("transform","translate("+margin_left+","+margin_top+")"),gradient=wrapper.append("defs").append("linearGradient").attr("id","mlColorRangeGradient").attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","0%").attr("spreadMethod","pad");scale.forEach((function(d){gradient.append("stop").attr("offset",d.offset+"%").attr("stop-color",d.stopColor).attr("stop-opacity",1)})),wrapper.append("rect").attr("x1",0).attr("y1",0).attr("width",legendWidth).attr("height",legendHeight).style("fill","url(#mlColorRangeGradient)");const axisScale=d3_default.a.scale.linear().domain([0,1]).range([0,legendWidth]),tickFormat=d3_default.a.format(""),legendAxis=d3_default.a.svg.axis().scale(axisScale).orient("bottom").tickFormat(tickFormat).tickSize(legendHeight+4).ticks(legendWidth/40);if(wrapper.append("g").attr("class","legend axis").attr("transform","translate(0, 0)").call(legendAxis),justifyTicks||!showTicks){const text=wrapper.selectAll("text")[0];text.length>1&&(d3_default.a.select(text[0]).style("text-anchor","start"),d3_default.a.select(text[text.length-1]).style("text-anchor","end"))}showTicks||wrapper.selectAll(".axis line").style("display","none")},[JSON.stringify(scale),d3Container.current]),void 0===title?external_kbnSharedDeps_React_default.a.createElement("svg",{ref:d3Container}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs",color:"subdued"},external_kbnSharedDeps_React_default.a.createElement("p",null,title)),external_kbnSharedDeps_React_default.a.createElement("svg",{ref:d3Container}))};var external_kbnSharedDeps_Theme_euiLightVars_=__webpack_require__(50),external_kbnSharedDeps_Theme_euiLightVars_default=__webpack_require__.n(external_kbnSharedDeps_Theme_euiLightVars_),external_kbnSharedDeps_Theme_euiDarkVars_=__webpack_require__(54),external_kbnSharedDeps_Theme_euiDarkVars_default=__webpack_require__.n(external_kbnSharedDeps_Theme_euiDarkVars_),external_kbnSharedDeps_KbnI18n_=__webpack_require__(2),use_ui_settings_context=__webpack_require__(188);let COLOR_RANGE_SCALE;!function(COLOR_RANGE_SCALE){COLOR_RANGE_SCALE.LINEAR="linear",COLOR_RANGE_SCALE.INFLUENCER="influencer",COLOR_RANGE_SCALE.SQRT="sqrt"}(COLOR_RANGE_SCALE||(COLOR_RANGE_SCALE={}));COLOR_RANGE_SCALE.LINEAR,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.components.colorRangeLegend.linearScaleLabel",{defaultMessage:"Linear"}),COLOR_RANGE_SCALE.INFLUENCER,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.components.colorRangeLegend.influencerScaleLabel",{defaultMessage:"Influencer custom scale"}),COLOR_RANGE_SCALE.SQRT,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.components.colorRangeLegend.sqrtScaleLabel",{defaultMessage:"Sqrt"});let COLOR_RANGE;!function(COLOR_RANGE){COLOR_RANGE.BLUE="blue",COLOR_RANGE.RED="red",COLOR_RANGE.RED_GREEN="red-green",COLOR_RANGE.GREEN_RED="green-red",COLOR_RANGE.YELLOW_GREEN_BLUE="yellow-green-blue"}(COLOR_RANGE||(COLOR_RANGE={}));COLOR_RANGE.BLUE,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.components.colorRangeLegend.blueColorRangeLabel",{defaultMessage:"Blue"}),COLOR_RANGE.RED,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.components.colorRangeLegend.redColorRangeLabel",{defaultMessage:"Red"}),COLOR_RANGE.RED_GREEN,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.components.colorRangeLegend.redGreenColorRangeLabel",{defaultMessage:"Red - Green"}),COLOR_RANGE.GREEN_RED,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.components.colorRangeLegend.greenRedColorRangeLabel",{defaultMessage:"Green - Red"}),COLOR_RANGE.YELLOW_GREEN_BLUE,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.components.colorRangeLegend.yellowGreenBlueColorRangeLabel",{defaultMessage:"Yellow - Green - Blue"});const coloursYGB=["#FFFFDD","#AAF191","#80D385","#61B385","#3E9583","#217681","#285285","#1F2D86","#000086"],colourRangeYGB=d3_default.a.range(0,1,1/(coloursYGB.length-1));colourRangeYGB.push(1);const colorDomains={[COLOR_RANGE.BLUE]:[0,1],[COLOR_RANGE.RED]:[0,1],[COLOR_RANGE.RED_GREEN]:[0,1],[COLOR_RANGE.GREEN_RED]:[0,1],[COLOR_RANGE.YELLOW_GREEN_BLUE]:colourRangeYGB},useColorRange=(colorRange=COLOR_RANGE.BLUE,colorRangeScale=COLOR_RANGE_SCALE.LINEAR,featureCount=1)=>{const{euiTheme:euiTheme}=useCurrentEuiTheme(),colorRanges={[COLOR_RANGE.BLUE]:[d3_default.a.rgb(euiTheme.euiColorEmptyShade).toString(),d3_default.a.rgb(euiTheme.euiColorVis1).toString()],[COLOR_RANGE.RED]:[d3_default.a.rgb(euiTheme.euiColorEmptyShade).toString(),d3_default.a.rgb(euiTheme.euiColorDanger).toString()],[COLOR_RANGE.RED_GREEN]:["red","green"],[COLOR_RANGE.GREEN_RED]:["green","red"],[COLOR_RANGE.YELLOW_GREEN_BLUE]:coloursYGB},linearScale=d3_default.a.scale.linear().domain(colorDomains[colorRange]).range(colorRanges[colorRange]),influencerColorScale=(n=featureCount,t=>n<=1?t:t<1/n?0:t<3/n?n/4*(t-1/n):t-3/n+.5);var n;return{[COLOR_RANGE_SCALE.LINEAR]:linearScale,[COLOR_RANGE_SCALE.INFLUENCER]:n=>linearScale(influencerColorScale(n)),[COLOR_RANGE_SCALE.SQRT]:d3_default.a.scale.sqrt().domain(colorDomains[colorRange]).range(colorRanges[colorRange])}[colorRangeScale]};function useCurrentEuiTheme(){const uiSettings=Object(use_ui_settings_context.a)();return Object(external_kbnSharedDeps_React_.useMemo)(()=>({euiTheme:uiSettings.get("theme:darkMode")?external_kbnSharedDeps_Theme_euiDarkVars_default.a:external_kbnSharedDeps_Theme_euiLightVars_default.a}),[uiSettings])}},,,,function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return tabColor}));var _elastic_eui_dist_eui_theme_dark_json__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(54),_elastic_eui_dist_eui_theme_dark_json__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_elastic_eui_dist_eui_theme_dark_json__WEBPACK_IMPORTED_MODULE_0__),_string_utils__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(9);const COLORS=[_elastic_eui_dist_eui_theme_dark_json__WEBPACK_IMPORTED_MODULE_0___default.a.euiColorVis0,_elastic_eui_dist_eui_theme_dark_json__WEBPACK_IMPORTED_MODULE_0___default.a.euiColorVis1,_elastic_eui_dist_eui_theme_dark_json__WEBPACK_IMPORTED_MODULE_0___default.a.euiColorVis2,_elastic_eui_dist_eui_theme_dark_json__WEBPACK_IMPORTED_MODULE_0___default.a.euiColorVis3,_elastic_eui_dist_eui_theme_dark_json__WEBPACK_IMPORTED_MODULE_0___default.a.euiColorVis4,_elastic_eui_dist_eui_theme_dark_json__WEBPACK_IMPORTED_MODULE_0___default.a.euiColorVis5,_elastic_eui_dist_eui_theme_dark_json__WEBPACK_IMPORTED_MODULE_0___default.a.euiColorVis6,_elastic_eui_dist_eui_theme_dark_json__WEBPACK_IMPORTED_MODULE_0___default.a.euiColorVis7,_elastic_eui_dist_eui_theme_dark_json__WEBPACK_IMPORTED_MODULE_0___default.a.euiColorVis8,_elastic_eui_dist_eui_theme_dark_json__WEBPACK_IMPORTED_MODULE_0___default.a.euiColorVis9,_elastic_eui_dist_eui_theme_dark_json__WEBPACK_IMPORTED_MODULE_0___default.a.euiColorDarkShade,_elastic_eui_dist_eui_theme_dark_json__WEBPACK_IMPORTED_MODULE_0___default.a.euiColorPrimary],colorMap={};function tabColor(name){if(void 0===colorMap[name]){const n=Object(_string_utils__WEBPACK_IMPORTED_MODULE_1__.d)(name),color=COLORS[n%COLORS.length];return colorMap[name]=color,color}return colorMap[name]}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return NUMBER_OF_CATEGORY_EXAMPLES})),__webpack_require__.d(__webpack_exports__,"a",(function(){return CATEGORY_EXAMPLES_VALIDATION_STATUS})),__webpack_require__.d(__webpack_exports__,"c",(function(){return VALIDATION_CHECK_DESCRIPTION}));var _kbn_i18n__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2),_types_categories__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(320);const NUMBER_OF_CATEGORY_EXAMPLES=5;let CATEGORY_EXAMPLES_VALIDATION_STATUS;!function(CATEGORY_EXAMPLES_VALIDATION_STATUS){CATEGORY_EXAMPLES_VALIDATION_STATUS.VALID="valid",CATEGORY_EXAMPLES_VALIDATION_STATUS.PARTIALLY_VALID="partially_valid",CATEGORY_EXAMPLES_VALIDATION_STATUS.INVALID="invalid"}(CATEGORY_EXAMPLES_VALIDATION_STATUS||(CATEGORY_EXAMPLES_VALIDATION_STATUS={}));const VALIDATION_CHECK_DESCRIPTION={[_types_categories__WEBPACK_IMPORTED_MODULE_1__.a.NO_EXAMPLES]:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.ml.models.jobService.categorization.messages.validNoDataFound",{defaultMessage:"Examples  were successfully loaded."}),[_types_categories__WEBPACK_IMPORTED_MODULE_1__.a.FAILED_TO_TOKENIZE]:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.ml.models.jobService.categorization.messages.validFailureToGetTokens",{defaultMessage:"The examples loaded were tokenized successfully."}),[_types_categories__WEBPACK_IMPORTED_MODULE_1__.a.TOKEN_COUNT]:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.ml.models.jobService.categorization.messages.validTokenLength",{defaultMessage:"More than {tokenCount} tokens per example were found in over {percentage}% of the examples loaded.",values:{percentage:Math.floor(75),tokenCount:3}}),[_types_categories__WEBPACK_IMPORTED_MODULE_1__.a.MEDIAN_LINE_LENGTH]:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.ml.models.jobService.categorization.messages.validMedianLineLength",{defaultMessage:"The median line length of the examples loaded was less than {medianCharCount} characters.",values:{medianCharCount:400}}),[_types_categories__WEBPACK_IMPORTED_MODULE_1__.a.NULL_VALUES]:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.ml.models.jobService.categorization.messages.validNullValues",{defaultMessage:"Less than {percentage}% of the examples loaded were null.",values:{percentage:Math.floor(25)}}),[_types_categories__WEBPACK_IMPORTED_MODULE_1__.a.TOO_MANY_TOKENS]:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.ml.models.jobService.categorization.messages.validTooManyTokens",{defaultMessage:"Less than 10000 tokens were found in total in the examples loaded."}),[_types_categories__WEBPACK_IMPORTED_MODULE_1__.a.INSUFFICIENT_PRIVILEGES]:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.ml.models.jobService.categorization.messages.validUserPrivileges",{defaultMessage:"The user has sufficient privileges to perform the checks."})}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"e",(function(){return replaceTokensInUrlValue})),__webpack_require__.d(__webpack_exports__,"a",(function(){return getUrlForRecord})),__webpack_require__.d(__webpack_exports__,"d",(function(){return openCustomUrlWindow})),__webpack_require__.d(__webpack_exports__,"b",(function(){return isValidLabel})),__webpack_require__.d(__webpack_exports__,"c",(function(){return isValidTimeRange}));var lodash__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(7),moment__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(15),moment__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_1__),rison_node__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(51),rison_node__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(rison_node__WEBPACK_IMPORTED_MODULE_2__),_common_util_parse_interval__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(26),_string_utils__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(89);function replaceTokensInUrlValue(customUrlConfig,jobBucketSpanSecs,doc,timeFieldName){const urlValue=customUrlConfig.url_value,timestamp=doc[timeFieldName],timeRangeInterval="time_range"in customUrlConfig&&customUrlConfig.time_range?Object(_common_util_parse_interval__WEBPACK_IMPORTED_MODULE_3__.a)(customUrlConfig.time_range):null,record={...doc};if(urlValue.includes("$earliest$")){const earliestMoment=moment__WEBPACK_IMPORTED_MODULE_1___default()(timestamp);null!==timeRangeInterval?earliestMoment.subtract(timeRangeInterval):earliestMoment.subtract(jobBucketSpanSecs,"s"),record.earliest=earliestMoment.toISOString()}if(urlValue.includes("$latest$")){const latestMoment=moment__WEBPACK_IMPORTED_MODULE_1___default()(timestamp).add(jobBucketSpanSecs,"s");null!==timeRangeInterval?latestMoment.add(timeRangeInterval):latestMoment.add(jobBucketSpanSecs,"s"),record.latest=latestMoment.toISOString()}return getUrlForRecord(customUrlConfig,record)}function getUrlForRecord(urlConfig,record){if(!0===isKibanaUrl(urlConfig))return function(urlConfig,record){const urlValue=urlConfig.url_value,isLuceneQueryLanguage=urlValue.includes("language:lucene"),queryLanguageEscapeCallback=isLuceneQueryLanguage?_string_utils__WEBPACK_IMPORTED_MODULE_4__.c:escapeForKQL,commonEscapeCallback=Object(lodash__WEBPACK_IMPORTED_MODULE_0__.flow)(encodeURIComponent),replaceSingleTokenValues=str=>{const getResultTokenValue=Object(lodash__WEBPACK_IMPORTED_MODULE_0__.flow)(isLuceneQueryLanguage?v=>v:queryLanguageEscapeCallback,commonEscapeCallback);return str.replace(/\$([^?&$\'"]+)\$(\/)?/g,(match,name,slash="")=>{let tokenValue=Object(lodash__WEBPACK_IMPORTED_MODULE_0__.get)(record,name);return tokenValue=Array.isArray(tokenValue)?tokenValue[0]:tokenValue,void 0===tokenValue?"":getResultTokenValue(tokenValue)+slash})};return Object(lodash__WEBPACK_IMPORTED_MODULE_0__.flow)(str=>str.replace("$earliest$",record.earliest).replace("$latest$",record.latest),decodeURIComponent,str=>{const getResultTokenValue=Object(lodash__WEBPACK_IMPORTED_MODULE_0__.flow)(queryLanguageEscapeCallback,commonEscapeCallback),getQueryStringResult=((record,getResultTokenValue)=>(resultPrefix,queryString,resultPostfix)=>{let availableCharactersLeft=2e3-resultPrefix.length-resultPostfix.length;const queryFields=queryString.split(/\sand\s/i).map(v=>String(v.split(/:(.+)?\$/)[0]).trim()),queryParts=[];fieldsLoop:for(let i=0;i<queryFields.length;i++){const field=queryFields[i];let tokenValues=Object(lodash__WEBPACK_IMPORTED_MODULE_0__.get)(record,field)||null;if(null===tokenValues)continue;tokenValues=Array.isArray(tokenValues)?tokenValues:[tokenValues];let result="";for(let j=0;j<tokenValues.length;j++){const part=`${j>0?" OR ":""}${field}:"${getResultTokenValue(tokenValues[j])}"`;if(availableCharactersLeft<part.length){result.length>0&&queryParts.push(j>0?`(${result})`:result);break fieldsLoop}result+=part,availableCharactersLeft-=result.length}result.length>0&&queryParts.push(tokenValues.length>1?`(${result})`:result)}return queryParts.join(" AND ")})(record,getResultTokenValue),match=str.match(/(.+)(\(.*\blanguage:(?:lucene|kuery)\b.*?\))(.+)/);if(null!==match&&void 0!==match[2]){const[,prefix,queryDef,postfix]=match,q=rison_node__WEBPACK_IMPORTED_MODULE_2___default.a.decode(queryDef);if(null!==(value=q)&&"object"==typeof value&&q.hasOwnProperty("query")){const[resultPrefix,resultPostfix]=[prefix,postfix].map(replaceSingleTokenValues),resultQuery=getQueryStringResult(resultPrefix,q.query,resultPostfix);return`${resultPrefix}${rison_node__WEBPACK_IMPORTED_MODULE_2___default.a.encode({...q,query:resultQuery})}${resultPostfix}`}}var value;return str.replace(/(.+&kuery=)(.*?)[^!](&.+)/,(fullMatch,prefix,queryString,postfix)=>{const[resultPrefix,resultPostfix]=[prefix,postfix].map(replaceSingleTokenValues);return`${resultPrefix}${getQueryStringResult(resultPrefix,queryString,resultPostfix)}${resultPostfix}`})},replaceSingleTokenValues)(urlValue)}(urlConfig,record);return Object(_string_utils__WEBPACK_IMPORTED_MODULE_4__.e)(urlConfig.url_value,record,!1)}function openCustomUrlWindow(url,urlConfig,basePath){if(!1===/^(?:[a-z]+:)?\/\//i.test(urlConfig.url_value))"/"!==url.charAt(0)&&(url=`${basePath}${isKibanaUrl(urlConfig)?"/app/":"/"}${url}`),window.open(url,"_blank");else{const newWindow=window.open(url,"_blank","noopener,noreferrer");null!=newWindow&&(newWindow.opener=null)}}function isKibanaUrl(urlConfig){const urlValue=urlConfig.url_value;return urlValue.startsWith("discover#/")||urlValue.startsWith("dashboards#/")||urlValue.startsWith("apm#/")||urlValue.startsWith("metrics/")||urlValue.startsWith("security/")||urlValue.startsWith("siem#/")}function escapeForKQL(value){return String(value).replace(/\"/g,'\\"')}function isValidLabel(label,savedCustomUrls){let isValid=void 0!==label&&label.trim().length>0;if(!0===isValid&&void 0!==savedCustomUrls){isValid=!savedCustomUrls.map(customUrl=>customUrl.url_name).includes(label)}return isValid}function isValidTimeRange(timeRange){if(void 0===timeRange||0===timeRange.length||"auto"===timeRange)return!0;return null!==Object(_common_util_parse_interval__WEBPACK_IMPORTED_MODULE_3__.a)(timeRange)}},function(module,exports){module.exports=function(value,other){return value===other||value!=value&&other!=other}},function(module,exports,__webpack_require__){var Symbol=__webpack_require__(114).Symbol;module.exports=Symbol},function(module,exports,__webpack_require__){(function(module){var root=__webpack_require__(114),stubFalse=__webpack_require__(555),freeExports=exports&&!exports.nodeType&&exports,freeModule=freeExports&&"object"==typeof module&&module&&!module.nodeType&&module,Buffer=freeModule&&freeModule.exports===freeExports?root.Buffer:void 0,isBuffer=(Buffer?Buffer.isBuffer:void 0)||stubFalse;module.exports=isBuffer}).call(this,__webpack_require__(165)(module))},function(module,exports,__webpack_require__){var DataView=__webpack_require__(564),Map=__webpack_require__(251),Promise=__webpack_require__(565),Set=__webpack_require__(339),WeakMap=__webpack_require__(566),baseGetTag=__webpack_require__(142),toSource=__webpack_require__(328),dataViewCtorString=toSource(DataView),mapCtorString=toSource(Map),promiseCtorString=toSource(Promise),setCtorString=toSource(Set),weakMapCtorString=toSource(WeakMap),getTag=baseGetTag;(DataView&&"[object DataView]"!=getTag(new DataView(new ArrayBuffer(1)))||Map&&"[object Map]"!=getTag(new Map)||Promise&&"[object Promise]"!=getTag(Promise.resolve())||Set&&"[object Set]"!=getTag(new Set)||WeakMap&&"[object WeakMap]"!=getTag(new WeakMap))&&(getTag=function(value){var result=baseGetTag(value),Ctor="[object Object]"==result?value.constructor:void 0,ctorString=Ctor?toSource(Ctor):"";if(ctorString)switch(ctorString){case dataViewCtorString:return"[object DataView]";case mapCtorString:return"[object Map]";case promiseCtorString:return"[object Promise]";case setCtorString:return"[object Set]";case weakMapCtorString:return"[object WeakMap]"}return result}),module.exports=getTag},function(module,exports,__webpack_require__){var baseGetTag=__webpack_require__(142),isObjectLike=__webpack_require__(120);module.exports=function(value){return"symbol"==typeof value||isObjectLike(value)&&"[object Symbol]"==baseGetTag(value)}},,function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return EmbeddableLoading}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(14),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),_elastic_eui__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(39);const EmbeddableLoading=()=>react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__.EuiText,{textAlign:"center"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__.EuiSpacer,{size:"l"}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__.EuiLoadingSpinner,{size:"l"}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__.EuiSpacer,{size:"l"}))},,,,function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return JobsAwaitingNodeWarning})),__webpack_require__.d(__webpack_exports__,"b",(function(){return NewJobAwaitingNodeWarning}));var external_kbnSharedDeps_React_=__webpack_require__(14),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),external_kbnSharedDeps_ElasticEui_=__webpack_require__(39),external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(40),ml_nodes_check=__webpack_require__(125);const JobsAwaitingNodeWarning=({jobCount:jobCount})=>!1===Object(ml_nodes_check.c)()||0===jobCount?null:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsAwaitingNodeWarning.title",defaultMessage:"Awaiting machine learning node"}),color:"primary",iconType:"iInCircle"},external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsAwaitingNodeWarning.noMLNodesAvailableDescription",defaultMessage:"There {jobCount, plural, one {is} other {are}} {jobCount, plural, one {# job} other {# jobs}} waiting for machine learning nodes to start.",values:{jobCount:jobCount}}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"})),NewJobAwaitingNodeWarning=()=>!1===Object(ml_nodes_check.c)()?null:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsAwaitingNodeWarning.title",defaultMessage:"Awaiting machine learning node"}),color:"primary",iconType:"iInCircle"},external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJobAwaitingNodeWarning.noMLNodesAvailableDescription",defaultMessage:"There are currently no nodes that can run the job, therefore it will remain in OPENING state until an appropriate node becomes available."}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}))},,,,function(module,__webpack_exports__,__webpack_require__){"use strict";function roundToDecimalPlace(num,dp=2){if(void 0===num)return"";if(num%1==0)return num;if(Math.abs(num)<Math.pow(10,-dp))return Number.parseFloat(String(num)).toExponential(2);const m=Math.pow(10,dp);return Math.round(num*m)/m}__webpack_require__.d(__webpack_exports__,"a",(function(){return roundToDecimalPlace}))},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return collapseLiteralStrings})),__webpack_require__.d(__webpack_exports__,"c",(function(){return expandLiteralStrings}));var _src_plugins_es_ui_shared_public__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(55),_kbn_ace__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(245);__webpack_require__.d(__webpack_exports__,"a",(function(){return _kbn_ace__WEBPACK_IMPORTED_MODULE_1__.XJsonMode}));const{collapseLiteralStrings:collapseLiteralStrings,expandLiteralStrings:expandLiteralStrings}=_src_plugins_es_ui_shared_public__WEBPACK_IMPORTED_MODULE_0__.XJson},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return mlForecastService}));var lodash__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(7),rxjs_operators__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(25),_ml_api_service__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(64);const mlForecastService={getForecastsSummary:function(job,query,earliestMs,maxResults){return new Promise((resolve,reject)=>{const obj={success:!0,forecasts:[]},filterCriteria=[{term:{result_type:"model_forecast_request_stats"}},{term:{job_id:job.job_id}},{range:{timestamp:{gte:earliestMs,format:"epoch_millis"}}}];query&&filterCriteria.push(query),_ml_api_service__WEBPACK_IMPORTED_MODULE_2__.ml.results.anomalySearch({size:maxResults,body:{query:{bool:{filter:filterCriteria}},sort:[{forecast_create_timestamp:{order:"desc"}}]}},[job.job_id]).then(resp=>{resp.hits.total.value>0&&(obj.forecasts=resp.hits.hits.map(hit=>hit._source)),resolve(obj)}).catch(resp=>{reject(resp)})})},getForecastDateRange:function(job,forecastId){return new Promise((resolve,reject)=>{const obj={success:!0,earliest:null,latest:null},filterCriteria=[{query_string:{query:"result_type:model_forecast",analyze_wildcard:!0}},{term:{job_id:job.job_id}},{term:{forecast_id:forecastId}}];_ml_api_service__WEBPACK_IMPORTED_MODULE_2__.ml.results.anomalySearch({size:0,body:{query:{bool:{filter:filterCriteria}},aggs:{earliest:{min:{field:"timestamp"}},latest:{max:{field:"timestamp"}}}}},[job.job_id]).then(resp=>{obj.earliest=Object(lodash__WEBPACK_IMPORTED_MODULE_0__.get)(resp,"aggregations.earliest.value",null),obj.latest=Object(lodash__WEBPACK_IMPORTED_MODULE_0__.get)(resp,"aggregations.latest.value",null),null===obj.earliest||null===obj.latest?reject(resp):resolve(obj)}).catch(resp=>{reject(resp)})})},getForecastData:function(job,detectorIndex,forecastId,entityFields,earliestMs,latestMs,intervalMs,aggType){const criteriaFields=[],detector=job.analysis_config.detectors[detectorIndex];if(void 0!==detector.partition_field_name){const partitionEntity=Object(lodash__WEBPACK_IMPORTED_MODULE_0__.find)(entityFields,{fieldName:detector.partition_field_name});void 0!==partitionEntity&&criteriaFields.push({fieldName:"partition_field_name",fieldValue:partitionEntity.fieldName},{fieldName:"partition_field_value",fieldValue:partitionEntity.fieldValue})}if(void 0!==detector.over_field_name){const overEntity=Object(lodash__WEBPACK_IMPORTED_MODULE_0__.find)(entityFields,{fieldName:detector.over_field_name});void 0!==overEntity&&criteriaFields.push({fieldName:"over_field_name",fieldValue:overEntity.fieldName},{fieldName:"over_field_value",fieldValue:overEntity.fieldValue})}if(void 0!==detector.by_field_name){const byEntity=Object(lodash__WEBPACK_IMPORTED_MODULE_0__.find)(entityFields,{fieldName:detector.by_field_name});void 0!==byEntity&&criteriaFields.push({fieldName:"by_field_name",fieldValue:byEntity.fieldName},{fieldName:"by_field_value",fieldValue:byEntity.fieldValue})}const obj={success:!0,results:{}},filterCriteria=[{query_string:{query:"result_type:model_forecast",analyze_wildcard:!0}},{term:{job_id:job.job_id}},{term:{forecast_id:forecastId}},{term:{detector_index:detectorIndex}},{range:{timestamp:{gte:earliestMs,lte:latestMs,format:"epoch_millis"}}}];Object(lodash__WEBPACK_IMPORTED_MODULE_0__.each)(criteriaFields,criteria=>{filterCriteria.push({term:{[criteria.fieldName]:criteria.fieldValue}})});const forecastAggs=void 0===aggType?{avg:"avg",max:"max",min:"min"}:{avg:aggType.avg,max:aggType.max,min:aggType.min};return _ml_api_service__WEBPACK_IMPORTED_MODULE_2__.ml.results.anomalySearch$({size:0,body:{query:{bool:{filter:filterCriteria}},aggs:{times:{date_histogram:{field:"timestamp",fixed_interval:intervalMs+"ms",min_doc_count:1},aggs:{prediction:{[forecastAggs.avg]:{field:"forecast_prediction"}},forecastUpper:{[forecastAggs.max]:{field:"forecast_upper"}},forecastLower:{[forecastAggs.min]:{field:"forecast_lower"}}}}}}},[job.job_id]).pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_1__.map)(resp=>{const aggregationsByTime=Object(lodash__WEBPACK_IMPORTED_MODULE_0__.get)(resp,["aggregations","times","buckets"],[]);return Object(lodash__WEBPACK_IMPORTED_MODULE_0__.each)(aggregationsByTime,dataForTime=>{const time=dataForTime.key;obj.results[time]={prediction:Object(lodash__WEBPACK_IMPORTED_MODULE_0__.get)(dataForTime,["prediction","value"]),forecastUpper:Object(lodash__WEBPACK_IMPORTED_MODULE_0__.get)(dataForTime,["forecastUpper","value"]),forecastLower:Object(lodash__WEBPACK_IMPORTED_MODULE_0__.get)(dataForTime,["forecastLower","value"])}}),obj}))},runForecast:function(jobId,duration){return console.log("ML forecast service run forecast with duration:",duration),new Promise((resolve,reject)=>{_ml_api_service__WEBPACK_IMPORTED_MODULE_2__.ml.forecast({jobId:jobId,duration:duration}).then(resp=>{resolve(resp)}).catch(err=>{reject(err)})})},getForecastRequestStats:function(job,forecastId){return new Promise((resolve,reject)=>{const obj={success:!0,stats:{}},filterCriteria=[{query_string:{query:"result_type:model_forecast_request_stats",analyze_wildcard:!0}},{term:{job_id:job.job_id}},{term:{forecast_id:forecastId}}];_ml_api_service__WEBPACK_IMPORTED_MODULE_2__.ml.results.anomalySearch({size:1,body:{query:{bool:{filter:filterCriteria}}}},[job.job_id]).then(resp=>{resp.hits.total.value>0&&(obj.stats=resp.hits.hits[0]._source),resolve(obj)}).catch(resp=>{reject(resp)})})}}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return populateValidationMessages})),__webpack_require__.d(__webpack_exports__,"a",(function(){return invalidTimeIntervalMessage}));var _kbn_i18n__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2),_common_constants_validation__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(27),_services_ml_server_info__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(88);function populateValidationMessages(validationResults,basicValidations,jobConfig,datafeedConfig){const limits=Object(_services_ml_server_info__WEBPACK_IMPORTED_MODULE_2__.c)();if(validationResults.contains("job_id_empty"))basicValidations.jobId.valid=!1;else if(validationResults.contains("job_id_invalid")){basicValidations.jobId.valid=!1;const msg=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.ml.newJob.wizard.validateJob.jobNameAllowedCharactersDescription",{defaultMessage:"Job ID can contain lowercase alphanumeric (a-z and 0-9), hyphens or underscores; must start and end with an alphanumeric character"});basicValidations.jobId.message=msg}else if(validationResults.contains("job_id_invalid_max_length"))basicValidations.jobId.valid=!1,basicValidations.jobId.message=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.ml.newJob.wizard.validateJob.jobIdInvalidMaxLengthErrorMessage",{defaultMessage:"Job ID must be no more than {maxLength, plural, one {# character} other {# characters}} long.",values:{maxLength:_common_constants_validation__WEBPACK_IMPORTED_MODULE_1__.b}});else if(validationResults.contains("job_id_already_exists")){basicValidations.jobId.valid=!1;const msg=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.ml.newJob.wizard.validateJob.jobNameAlreadyExists",{defaultMessage:"Job ID already exists. A job ID cannot be the same as an existing job or group."});basicValidations.jobId.message=msg}if(validationResults.contains("job_group_id_invalid")){basicValidations.groupIds.valid=!1;const msg=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.ml.newJob.wizard.validateJob.jobGroupAllowedCharactersDescription",{defaultMessage:"Job group names can contain lowercase alphanumeric (a-z and 0-9), hyphens or underscores; must start and end with an alphanumeric character"});basicValidations.groupIds.message=msg}else if(validationResults.contains("job_group_id_invalid_max_length"))basicValidations.groupIds.valid=!1,basicValidations.groupIds.message=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.ml.newJob.wizard.validateJob.jobGroupMaxLengthDescription",{defaultMessage:"Job group name must be no more than {maxLength, plural, one {# character} other {# characters}} long.",values:{maxLength:_common_constants_validation__WEBPACK_IMPORTED_MODULE_1__.b}});else if(validationResults.contains("job_group_id_already_exists")){basicValidations.groupIds.valid=!1;const msg=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.ml.newJob.wizard.validateJob.groupNameAlreadyExists",{defaultMessage:"Group ID already exists. A group ID cannot be the same as an existing job or group."});basicValidations.groupIds.message=msg}if(validationResults.contains("model_memory_limit_units_invalid")){basicValidations.modelMemoryLimit.valid=!1;const str=`${_common_constants_validation__WEBPACK_IMPORTED_MODULE_1__.a.slice(0,_common_constants_validation__WEBPACK_IMPORTED_MODULE_1__.a.length-1).join(", ")} or ${[..._common_constants_validation__WEBPACK_IMPORTED_MODULE_1__.a].pop()}`,msg=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.ml.newJob.wizard.validateJob.modelMemoryLimitUnitsInvalidErrorMessage",{defaultMessage:"Model memory limit data unit unrecognized. It must be {str}",values:{str:str}});basicValidations.modelMemoryLimit.message=msg}if(validationResults.contains("model_memory_limit_invalid")){basicValidations.modelMemoryLimit.valid=!1;const maxModelMemoryLimit=(limits.max_model_memory_limit||"").toUpperCase(),msg=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.ml.newJob.wizard.validateJob.modelMemoryLimitRangeInvalidErrorMessage",{defaultMessage:"Model memory limit cannot be higher than the maximum value of {maxModelMemoryLimit}",values:{maxModelMemoryLimit:maxModelMemoryLimit}});basicValidations.modelMemoryLimit.message=msg}if(validationResults.contains("detectors_duplicates")){basicValidations.duplicateDetectors.valid=!1;const msg=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.ml.newJob.wizard.validateJob.duplicatedDetectorsErrorMessage",{defaultMessage:"Duplicate detectors were found."});basicValidations.duplicateDetectors.message=msg}if(validationResults.contains("categorizer_detector_missing_per_partition_field")){basicValidations.categorizerMissingPerPartition.valid=!1;const msg=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.ml.newJob.wizard.validateJob.categorizerMissingPerPartitionFieldMessage",{defaultMessage:'Partition field must be set for detectors that reference "mlcategory" when per-partition categorization is enabled.'});basicValidations.categorizerMissingPerPartition.message=msg}if(validationResults.contains("categorizer_varying_per_partition_fields")){basicValidations.categorizerVaryingPerPartitionField.valid=!1;const msg=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.ml.newJob.wizard.validateJob.categorizerVaryingPerPartitionFieldNamesMessage",{defaultMessage:'Detectors with keyword "mlcategory" cannot have different partition_field_name when per-partition categorization is enabled.'});basicValidations.categorizerVaryingPerPartitionField.message=msg}if(validationResults.contains("bucket_span_empty")){basicValidations.bucketSpan.valid=!1;const msg=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.ml.newJob.wizard.validateJob.bucketSpanMustBeSetErrorMessage",{defaultMessage:"Bucket span must be set"});basicValidations.bucketSpan.message=msg}else validationResults.contains("bucket_span_invalid")&&(basicValidations.bucketSpan.valid=!1,basicValidations.bucketSpan.message=invalidTimeIntervalMessage(jobConfig.analysis_config.bucket_span));if(validationResults.contains("query_empty")){basicValidations.query.valid=!1;const msg=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.ml.newJob.wizard.validateJob.queryCannotBeEmpty",{defaultMessage:"Datafeed query cannot be empty."});basicValidations.query.message=msg}else if(validationResults.contains("query_invalid")){basicValidations.query.valid=!1;const msg=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.ml.newJob.wizard.validateJob.queryIsInvalidEsQuery",{defaultMessage:"Datafeed query must be a valid elasticsearch query."});basicValidations.query.message=msg}validationResults.contains("query_delay_invalid")&&(basicValidations.queryDelay.valid=!1,basicValidations.queryDelay.message=invalidTimeIntervalMessage(datafeedConfig.query_delay)),validationResults.contains("frequency_invalid")&&(basicValidations.frequency.valid=!1,basicValidations.frequency.message=invalidTimeIntervalMessage(datafeedConfig.frequency)),validationResults.contains("missing_summary_count_field_name")&&(basicValidations.summaryCountField.valid=!1,basicValidations.summaryCountField.message=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.ml.newJob.wizard.validateJob.summaryCountFieldMissing",{defaultMessage:"Required field as the datafeed uses aggregations."}))}function invalidTimeIntervalMessage(value){return _kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.ml.newJob.wizard.validateJob.frequencyInvalidTimeIntervalFormatErrorMessage",{defaultMessage:"{value} is not a valid time interval format e.g. {thirtySeconds}, {tenMinutes}, {oneHour}, {sevenDays}. It also needs to be higher than zero.",values:{value:value,thirtySeconds:"30s",tenMinutes:"10m",oneHour:"1h",sevenDays:"7d"}})}},function(module,exports,__webpack_require__){(function(Buffer){var RRule=__webpack_require__(197).RRule;function pad(n,d){d=d||2;var neg=n<0;neg&&(n*=-1),n=n.toString();return(neg?"-":"")+"000000000000000000".substr(0,d-n.length)+n}var _types={BINARY:{format:function(value){return value.toString("base64")},parse:function(value){return new Buffer(value,"base64")}},BOOLEAN:{format:function(value){return value?"TRUE":"FALSE"},parse:function(value){return"TRUE"==value.toUpperCase()}},"CAL-ADDRESS":{format:function(value){var v=value.toString();return 0!=v.lastIndexOf("mailto:")&&(v="mailto:"+v),v}},DATE:{format:function(value){return value instanceof Date||(value=new Date(value)),value.getFullYear()+pad(value.getMonth()+1)+pad(value.getDate())},parse:function(value){var dt=new Date(parseInt(value.substr(0,4),10),parseInt(value.substr(4,2),10)-1,parseInt(value.substr(6,2),10),0,0,0);return dt.date_only=!0,dt}},"DATE-TIME":{format:function(value,parameters){return value instanceof Date||(value=new Date(value)),value.date_only||"DATE"===parameters.VALUE?format_value("DATE",value):value.getUTCFullYear()+pad(value.getUTCMonth()+1)+pad(value.getUTCDate())+"T"+format_value("TIME",value)},parse:function(value,parameters,calendar){if("DATE"===parameters.VALUE||value.length<=8)return _types.DATE.parse(value);var tz=parameters.TZID,d=[parseInt(value.substr(0,4),10),parseInt(value.substr(4,2),10),parseInt(value.substr(6,2),10),parseInt(value.substr(9,2),10),parseInt(value.substr(11,2),10),parseInt(value.substr(13,2),10)],utc=value.length>15&&"Z"===value[15];if(void 0!==tz){var tzobj=calendar.timezone(tz);if(!tzobj)throw new Error("Unable to load TZ data for "+tz);return tzobj.fromLocalTime(d)}return d[1]-=1,utc?new Date(Date.UTC.apply(null,d)):new Date(d[0],d[1],d[2],d[3],d[4],d[5])}},DURATION:{format:function(value){var neg=value<0;neg&&(value*=-1);var w=Math.floor(value/604800);value-=60*w*60*24*7;var d=Math.floor(value/86400);value-=60*d*60*24;var h=Math.floor(value/3600);value-=60*h*60;var m=Math.floor(value/60),s=value-=60*m,dur=["P"];return neg&&dur.unshift("-"),w&&dur.push(w+"W"),d&&dur.push(d+"D"),(h||m||s)&&dur.push("T"),h&&dur.push(h+"H"),m&&dur.push(m+"M"),s&&dur.push(s+"S"),dur.join("")},parse:function(value){for(var match=/(-)?P(\d+W)?(\d+D)?(?:T(\d+H)?(\d+M)?(\d+S)?)?/.exec(value).slice(1),mul=[-1,604800,86400,3600,60,1],dur=0,i=1;i<match.length;++i)void 0!==match[i]&&(dur+=parseInt(match[i],10)*mul[i]);return void 0!==match[0]&&(dur*=mul[0]),dur}},FLOAT:{format:function(value){return value.toString()}},INTEGER:{format:function(value){return value.toString()}},PERIOD:{format:function(value){return format_value("DATE-TIME",value[0])+"/"+format_value(value[1]instanceof Date?"DATE-TIME":"DURATION",value[1])}},RECUR:{format:function(value){return(value instanceof RRule?value:new RRule(value)).toString()},parse:function(value){return RRule.parse(value)}},TEXT:{format:function(value){return(value||"").toString().replace(/([\\,;])/g,"\\$1").replace(/\n/g,"\\n")},parse:function(value){return value.replace(/\\([\\,;])/g,"$1").replace(/\\[nN]/g,"\n")}},TIME:{format:function(value){return value instanceof Date||(value=new Date(value)),pad(value.getUTCHours())+pad(value.getUTCMinutes())+pad(value.getUTCSeconds())+"Z"},parse:function(value){return value.length>6&&"Z"===value[6]?new Date(Date.UTC(0,0,0,parseInt(value.substr(0,2),10),parseInt(value.substr(2,2),10),parseInt(value.substr(4,2),10))):new Date(0,0,0,parseInt(value.substr(0,2),10),parseInt(value.substr(2,2),10),parseInt(value.substr(4,2),10))}},URI:{format:function(value){return value.toString()}},"UTC-OFFSET":{format:function(value){var west=value<0;return west&&(value*=-1),(west?"-":"+")+pad(value,4)}}},format_value=exports.format_value=function(type,value,parameters){if(void 0===value)return"";var fmt=_types[type||"TEXT"];if(void 0===fmt)throw Error("Invalid iCalendar datatype: "+type);return Array.isArray(value)&&"PERIOD"!==type||"PERIOD"===type&&value[0]&&Array.isArray(value[0])?value.map((function(v){return fmt.format(v,parameters||{})})).join(","):fmt.format(value,parameters||{})},parse_value=exports.parse_value=function(type,value,parameters,calendar,expect_list){if(expect_list)return value.split(",").map((function(x){return parse_value(type,x,parameters,calendar)}));var fmt=_types[type||"TEXT"];if(void 0===fmt)throw Error("Invalid iCalendar datatype: "+type);var otherFmt=(parameters=parameters||{}).VALUE&&_types[parameters.VALUE];return otherFmt&&(fmt=otherFmt),fmt.parse?fmt.parse(value,parameters,calendar):value}}).call(this,__webpack_require__(196).Buffer)},function(module,exports,__webpack_require__){(function(process){var getOwnPropertyDescriptors=Object.getOwnPropertyDescriptors||function(obj){for(var keys=Object.keys(obj),descriptors={},i=0;i<keys.length;i++)descriptors[keys[i]]=Object.getOwnPropertyDescriptor(obj,keys[i]);return descriptors},formatRegExp=/%[sdj%]/g;exports.format=function(f){if(!isString(f)){for(var objects=[],i=0;i<arguments.length;i++)objects.push(inspect(arguments[i]));return objects.join(" ")}i=1;for(var args=arguments,len=args.length,str=String(f).replace(formatRegExp,(function(x){if("%%"===x)return"%";if(i>=len)return x;switch(x){case"%s":return String(args[i++]);case"%d":return Number(args[i++]);case"%j":try{return JSON.stringify(args[i++])}catch(_){return"[Circular]"}default:return x}})),x=args[i];i<len;x=args[++i])isNull(x)||!isObject(x)?str+=" "+x:str+=" "+inspect(x);return str},exports.deprecate=function(fn,msg){if(void 0!==process&&!0===process.noDeprecation)return fn;if(void 0===process)return function(){return exports.deprecate(fn,msg).apply(this,arguments)};var warned=!1;return function(){if(!warned){if(process.throwDeprecation)throw new Error(msg);process.traceDeprecation?console.trace(msg):console.error(msg),warned=!0}return fn.apply(this,arguments)}};var debugEnviron,debugs={};function inspect(obj,opts){var ctx={seen:[],stylize:stylizeNoColor};return arguments.length>=3&&(ctx.depth=arguments[2]),arguments.length>=4&&(ctx.colors=arguments[3]),isBoolean(opts)?ctx.showHidden=opts:opts&&exports._extend(ctx,opts),isUndefined(ctx.showHidden)&&(ctx.showHidden=!1),isUndefined(ctx.depth)&&(ctx.depth=2),isUndefined(ctx.colors)&&(ctx.colors=!1),isUndefined(ctx.customInspect)&&(ctx.customInspect=!0),ctx.colors&&(ctx.stylize=stylizeWithColor),formatValue(ctx,obj,ctx.depth)}function stylizeWithColor(str,styleType){var style=inspect.styles[styleType];return style?"["+inspect.colors[style][0]+"m"+str+"["+inspect.colors[style][1]+"m":str}function stylizeNoColor(str,styleType){return str}function formatValue(ctx,value,recurseTimes){if(ctx.customInspect&&value&&isFunction(value.inspect)&&value.inspect!==exports.inspect&&(!value.constructor||value.constructor.prototype!==value)){var ret=value.inspect(recurseTimes,ctx);return isString(ret)||(ret=formatValue(ctx,ret,recurseTimes)),ret}var primitive=function(ctx,value){if(isUndefined(value))return ctx.stylize("undefined","undefined");if(isString(value)){var simple="'"+JSON.stringify(value).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return ctx.stylize(simple,"string")}if(isNumber(value))return ctx.stylize(""+value,"number");if(isBoolean(value))return ctx.stylize(""+value,"boolean");if(isNull(value))return ctx.stylize("null","null")}(ctx,value);if(primitive)return primitive;var keys=Object.keys(value),visibleKeys=function(array){var hash={};return array.forEach((function(val,idx){hash[val]=!0})),hash}(keys);if(ctx.showHidden&&(keys=Object.getOwnPropertyNames(value)),isError(value)&&(keys.indexOf("message")>=0||keys.indexOf("description")>=0))return formatError(value);if(0===keys.length){if(isFunction(value)){var name=value.name?": "+value.name:"";return ctx.stylize("[Function"+name+"]","special")}if(isRegExp(value))return ctx.stylize(RegExp.prototype.toString.call(value),"regexp");if(isDate(value))return ctx.stylize(Date.prototype.toString.call(value),"date");if(isError(value))return formatError(value)}var output,base="",array=!1,braces=["{","}"];(isArray(value)&&(array=!0,braces=["[","]"]),isFunction(value))&&(base=" [Function"+(value.name?": "+value.name:"")+"]");return isRegExp(value)&&(base=" "+RegExp.prototype.toString.call(value)),isDate(value)&&(base=" "+Date.prototype.toUTCString.call(value)),isError(value)&&(base=" "+formatError(value)),0!==keys.length||array&&0!=value.length?recurseTimes<0?isRegExp(value)?ctx.stylize(RegExp.prototype.toString.call(value),"regexp"):ctx.stylize("[Object]","special"):(ctx.seen.push(value),output=array?function(ctx,value,recurseTimes,visibleKeys,keys){for(var output=[],i=0,l=value.length;i<l;++i)hasOwnProperty(value,String(i))?output.push(formatProperty(ctx,value,recurseTimes,visibleKeys,String(i),!0)):output.push("");return keys.forEach((function(key){key.match(/^\d+$/)||output.push(formatProperty(ctx,value,recurseTimes,visibleKeys,key,!0))})),output}(ctx,value,recurseTimes,visibleKeys,keys):keys.map((function(key){return formatProperty(ctx,value,recurseTimes,visibleKeys,key,array)})),ctx.seen.pop(),function(output,base,braces){if(output.reduce((function(prev,cur){return cur.indexOf("\n")>=0&&0,prev+cur.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60)return braces[0]+(""===base?"":base+"\n ")+" "+output.join(",\n  ")+" "+braces[1];return braces[0]+base+" "+output.join(", ")+" "+braces[1]}(output,base,braces)):braces[0]+base+braces[1]}function formatError(value){return"["+Error.prototype.toString.call(value)+"]"}function formatProperty(ctx,value,recurseTimes,visibleKeys,key,array){var name,str,desc;if((desc=Object.getOwnPropertyDescriptor(value,key)||{value:value[key]}).get?str=desc.set?ctx.stylize("[Getter/Setter]","special"):ctx.stylize("[Getter]","special"):desc.set&&(str=ctx.stylize("[Setter]","special")),hasOwnProperty(visibleKeys,key)||(name="["+key+"]"),str||(ctx.seen.indexOf(desc.value)<0?(str=isNull(recurseTimes)?formatValue(ctx,desc.value,null):formatValue(ctx,desc.value,recurseTimes-1)).indexOf("\n")>-1&&(str=array?str.split("\n").map((function(line){return"  "+line})).join("\n").substr(2):"\n"+str.split("\n").map((function(line){return"   "+line})).join("\n")):str=ctx.stylize("[Circular]","special")),isUndefined(name)){if(array&&key.match(/^\d+$/))return str;(name=JSON.stringify(""+key)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(name=name.substr(1,name.length-2),name=ctx.stylize(name,"name")):(name=name.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),name=ctx.stylize(name,"string"))}return name+": "+str}function isArray(ar){return Array.isArray(ar)}function isBoolean(arg){return"boolean"==typeof arg}function isNull(arg){return null===arg}function isNumber(arg){return"number"==typeof arg}function isString(arg){return"string"==typeof arg}function isUndefined(arg){return void 0===arg}function isRegExp(re){return isObject(re)&&"[object RegExp]"===objectToString(re)}function isObject(arg){return"object"==typeof arg&&null!==arg}function isDate(d){return isObject(d)&&"[object Date]"===objectToString(d)}function isError(e){return isObject(e)&&("[object Error]"===objectToString(e)||e instanceof Error)}function isFunction(arg){return"function"==typeof arg}function objectToString(o){return Object.prototype.toString.call(o)}function pad(n){return n<10?"0"+n.toString(10):n.toString(10)}exports.debuglog=function(set){if(isUndefined(debugEnviron)&&(debugEnviron=Object({IS_KIBANA_DISTRIBUTABLE:"true"}).NODE_DEBUG||""),set=set.toUpperCase(),!debugs[set])if(new RegExp("\\b"+set+"\\b","i").test(debugEnviron)){var pid=process.pid;debugs[set]=function(){var msg=exports.format.apply(exports,arguments);console.error("%s %d: %s",set,pid,msg)}}else debugs[set]=function(){};return debugs[set]},exports.inspect=inspect,inspect.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},inspect.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},exports.isArray=isArray,exports.isBoolean=isBoolean,exports.isNull=isNull,exports.isNullOrUndefined=function(arg){return null==arg},exports.isNumber=isNumber,exports.isString=isString,exports.isSymbol=function(arg){return"symbol"==typeof arg},exports.isUndefined=isUndefined,exports.isRegExp=isRegExp,exports.isObject=isObject,exports.isDate=isDate,exports.isError=isError,exports.isFunction=isFunction,exports.isPrimitive=function(arg){return null===arg||"boolean"==typeof arg||"number"==typeof arg||"string"==typeof arg||"symbol"==typeof arg||void 0===arg},exports.isBuffer=__webpack_require__(491);var months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function timestamp(){var d=new Date,time=[pad(d.getHours()),pad(d.getMinutes()),pad(d.getSeconds())].join(":");return[d.getDate(),months[d.getMonth()],time].join(" ")}function hasOwnProperty(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}exports.log=function(){console.log("%s - %s",timestamp(),exports.format.apply(exports,arguments))},exports.inherits=__webpack_require__(492),exports._extend=function(origin,add){if(!add||!isObject(add))return origin;for(var keys=Object.keys(add),i=keys.length;i--;)origin[keys[i]]=add[keys[i]];return origin};var kCustomPromisifiedSymbol="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function callbackifyOnRejected(reason,cb){if(!reason){var newReason=new Error("Promise was rejected with a falsy value");newReason.reason=reason,reason=newReason}return cb(reason)}exports.promisify=function(original){if("function"!=typeof original)throw new TypeError('The "original" argument must be of type Function');if(kCustomPromisifiedSymbol&&original[kCustomPromisifiedSymbol]){var fn;if("function"!=typeof(fn=original[kCustomPromisifiedSymbol]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(fn,kCustomPromisifiedSymbol,{value:fn,enumerable:!1,writable:!1,configurable:!0}),fn}function fn(){for(var promiseResolve,promiseReject,promise=new Promise((function(resolve,reject){promiseResolve=resolve,promiseReject=reject})),args=[],i=0;i<arguments.length;i++)args.push(arguments[i]);args.push((function(err,value){err?promiseReject(err):promiseResolve(value)}));try{original.apply(this,args)}catch(err){promiseReject(err)}return promise}return Object.setPrototypeOf(fn,Object.getPrototypeOf(original)),kCustomPromisifiedSymbol&&Object.defineProperty(fn,kCustomPromisifiedSymbol,{value:fn,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(fn,getOwnPropertyDescriptors(original))},exports.promisify.custom=kCustomPromisifiedSymbol,exports.callbackify=function(original){if("function"!=typeof original)throw new TypeError('The "original" argument must be of type Function');function callbackified(){for(var args=[],i=0;i<arguments.length;i++)args.push(arguments[i]);var maybeCb=args.pop();if("function"!=typeof maybeCb)throw new TypeError("The last argument must be of type Function");var self=this,cb=function(){return maybeCb.apply(self,arguments)};original.apply(this,args).then((function(ret){process.nextTick(cb,null,ret)}),(function(rej){process.nextTick(callbackifyOnRejected,rej,cb)}))}return Object.setPrototypeOf(callbackified,Object.getPrototypeOf(original)),Object.defineProperties(callbackified,getOwnPropertyDescriptors(original)),callbackified}}).call(this,__webpack_require__(233))},function(module,exports,__webpack_require__){var baseGetTag=__webpack_require__(142),isObject=__webpack_require__(109);module.exports=function(value){if(!isObject(value))return!1;var tag=baseGetTag(value);return"[object Function]"==tag||"[object GeneratorFunction]"==tag||"[object AsyncFunction]"==tag||"[object Proxy]"==tag}},function(module,exports,__webpack_require__){var assignValue=__webpack_require__(205),baseAssignValue=__webpack_require__(206);module.exports=function(source,props,object,customizer){var isNew=!object;object||(object={});for(var index=-1,length=props.length;++index<length;){var key=props[index],newValue=customizer?customizer(object[key],source[key],key,object,source):void 0;void 0===newValue&&(newValue=source[key]),isNew?baseAssignValue(object,key,newValue):assignValue(object,key,newValue)}return object}},function(module,exports,__webpack_require__){var baseIsArguments=__webpack_require__(554),isObjectLike=__webpack_require__(120),objectProto=Object.prototype,hasOwnProperty=objectProto.hasOwnProperty,propertyIsEnumerable=objectProto.propertyIsEnumerable,isArguments=baseIsArguments(function(){return arguments}())?baseIsArguments:function(value){return isObjectLike(value)&&hasOwnProperty.call(value,"callee")&&!propertyIsEnumerable.call(value,"callee")};module.exports=isArguments},function(module,exports,__webpack_require__){var baseIsTypedArray=__webpack_require__(556),baseUnary=__webpack_require__(208),nodeUtil=__webpack_require__(255),nodeIsTypedArray=nodeUtil&&nodeUtil.isTypedArray,isTypedArray=nodeIsTypedArray?baseUnary(nodeIsTypedArray):baseIsTypedArray;module.exports=isTypedArray},function(module,exports,__webpack_require__){var isSymbol=__webpack_require__(156);module.exports=function(value){if("string"==typeof value||isSymbol(value))return value;var result=value+"";return"0"==result&&1/value==-1/0?"-0":result}},,,,,,function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"d",(function(){return get_analytics.a})),__webpack_require__.d(__webpack_exports__,"b",(function(){return deleteAnalytics})),__webpack_require__.d(__webpack_exports__,"c",(function(){return deleteAnalyticsAndDestIndex})),__webpack_require__.d(__webpack_exports__,"a",(function(){return canDeleteIndex})),__webpack_require__.d(__webpack_exports__,"e",(function(){return startAnalytics})),__webpack_require__.d(__webpack_exports__,"f",(function(){return stopAnalytics}));var get_analytics=__webpack_require__(164),external_kbnSharedDeps_KbnI18n_=__webpack_require__(2),errors=__webpack_require__(24),ml_api_service=__webpack_require__(64),common=__webpack_require__(71),analytics_list_common=__webpack_require__(93);const deleteAnalytics=async(analyticsConfig,analyticsStats,toastNotificationService)=>{try{Object(analytics_list_common.f)(analyticsStats.state)&&await ml_api_service.ml.dataFrameAnalytics.stopDataFrameAnalytics(analyticsConfig.id,!0),await ml_api_service.ml.dataFrameAnalytics.deleteDataFrameAnalytics(analyticsConfig.id),toastNotificationService.displaySuccessToast(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.deleteAnalyticsSuccessMessage",{defaultMessage:"Request to delete data frame analytics job {analyticsId} acknowledged.",values:{analyticsId:analyticsConfig.id}}))}catch(e){toastNotificationService.displayErrorToast(e,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.deleteAnalyticsErrorMessage",{defaultMessage:"An error occurred deleting the data frame analytics job {analyticsId}",values:{analyticsId:analyticsConfig.id}}))}common.G.next(common.n.REFRESH)},deleteAnalyticsAndDestIndex=async(analyticsConfig,analyticsStats,deleteDestIndex,deleteDestIndexPattern,toastNotificationService)=>{const destinationIndex=Array.isArray(analyticsConfig.dest.index)?analyticsConfig.dest.index[0]:analyticsConfig.dest.index;try{var _status$analyticsJobD,_status$analyticsJobD2,_status$destIndexDele,_status$destIndexDele2,_status$destIndexPatt,_status$destIndexPatt2;Object(analytics_list_common.f)(analyticsStats.state)&&await ml_api_service.ml.dataFrameAnalytics.stopDataFrameAnalytics(analyticsConfig.id,!0);const status=await ml_api_service.ml.dataFrameAnalytics.deleteDataFrameAnalyticsAndDestIndex(analyticsConfig.id,deleteDestIndex,deleteDestIndexPattern);if(null!==(_status$analyticsJobD=status.analyticsJobDeleted)&&void 0!==_status$analyticsJobD&&_status$analyticsJobD.success&&toastNotificationService.displaySuccessToast(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.deleteAnalyticsSuccessMessage",{defaultMessage:"Request to delete data frame analytics job {analyticsId} acknowledged.",values:{analyticsId:analyticsConfig.id}})),null!==(_status$analyticsJobD2=status.analyticsJobDeleted)&&void 0!==_status$analyticsJobD2&&_status$analyticsJobD2.error&&toastNotificationService.displayErrorToast(status.analyticsJobDeleted.error,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.deleteAnalyticsErrorMessage",{defaultMessage:"An error occurred deleting the data frame analytics job {analyticsId}",values:{analyticsId:analyticsConfig.id}})),null!==(_status$destIndexDele=status.destIndexDeleted)&&void 0!==_status$destIndexDele&&_status$destIndexDele.success&&toastNotificationService.displaySuccessToast(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.deleteAnalyticsWithIndexSuccessMessage",{defaultMessage:"Request to delete destination index {destinationIndex} acknowledged.",values:{destinationIndex:destinationIndex}})),null!==(_status$destIndexDele2=status.destIndexDeleted)&&void 0!==_status$destIndexDele2&&_status$destIndexDele2.error&&toastNotificationService.displayErrorToast(status.destIndexDeleted.error,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.deleteAnalyticsWithIndexErrorMessage",{defaultMessage:"An error occurred deleting destination index {destinationIndex}",values:{destinationIndex:destinationIndex}})),null!==(_status$destIndexPatt=status.destIndexPatternDeleted)&&void 0!==_status$destIndexPatt&&_status$destIndexPatt.success&&toastNotificationService.displaySuccessToast(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.deleteAnalyticsWithIndexPatternSuccessMessage",{defaultMessage:"Request to delete index pattern {destinationIndex} acknowledged.",values:{destinationIndex:destinationIndex}})),null!==(_status$destIndexPatt2=status.destIndexPatternDeleted)&&void 0!==_status$destIndexPatt2&&_status$destIndexPatt2.error){const error=Object(errors.i)(status.destIndexPatternDeleted.error);toastNotificationService.displayDangerToast(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.deleteAnalyticsWithIndexPatternErrorMessage",{defaultMessage:"An error occurred deleting index pattern {destinationIndex}: {error}",values:{destinationIndex:destinationIndex,error:error}}))}}catch(e){toastNotificationService.displayErrorToast(e,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.deleteAnalyticsErrorMessage",{defaultMessage:"An error occurred deleting the data frame analytics job {analyticsId}",values:{analyticsId:analyticsConfig.id}}))}common.G.next(common.n.REFRESH)},canDeleteIndex=async(indexName,toastNotificationService)=>{try{const privilege=await ml_api_service.ml.hasPrivileges({index:[{names:[indexName],privileges:["delete_index"]}]});return!!privilege&&(!0===privilege.securityDisabled||!0===privilege.has_all_requested)}catch(e){const error=Object(errors.i)(e);toastNotificationService.displayDangerToast(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.deleteAnalyticsPrivilegeErrorMessage",{defaultMessage:"User does not have permission to delete index {indexName}: {error}",values:{indexName:indexName,error:error}}))}},startAnalytics=async(d,toastNotificationService)=>{try{await ml_api_service.ml.dataFrameAnalytics.startDataFrameAnalytics(d.config.id),toastNotificationService.displaySuccessToast(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.startAnalyticsSuccessMessage",{defaultMessage:"Request to start data frame analytics {analyticsId} acknowledged.",values:{analyticsId:d.config.id}}))}catch(e){toastNotificationService.displayErrorToast(e,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.startAnalyticsErrorTitle",{defaultMessage:"Error starting job"}))}common.G.next(common.n.REFRESH)};var dependency_cache=__webpack_require__(22);const stopAnalytics=async d=>{const toastNotifications=Object(dependency_cache.j)();try{await ml_api_service.ml.dataFrameAnalytics.stopDataFrameAnalytics(d.config.id,Object(analytics_list_common.f)(d.stats.state)),toastNotifications.addSuccess(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.stopAnalyticsSuccessMessage",{defaultMessage:"Request to stop data frame analytics {analyticsId} acknowledged.",values:{analyticsId:d.config.id}}))}catch(e){toastNotifications.addDanger(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.stopAnalyticsErrorMessage",{defaultMessage:"An error occurred stopping the data frame analytics {analyticsId}: {error}",values:{analyticsId:d.config.id,error:JSON.stringify(e)}}))}common.G.next(common.n.REFRESH)}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return StatsBar}));var external_kbnSharedDeps_React_=__webpack_require__(14),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_);const Stat=({stat:stat})=>external_kbnSharedDeps_React_default.a.createElement("span",{className:"stat"},external_kbnSharedDeps_React_default.a.createElement("span",null,stat.label),": ",external_kbnSharedDeps_React_default.a.createElement("strong",null,stat.value)),StatsBar=({stats:stats,dataTestSub:dataTestSub})=>{const statsList=Object.keys(stats).map(k=>stats[k]);return external_kbnSharedDeps_React_default.a.createElement("div",{className:"mlStatsBar","data-test-subj":dataTestSub},statsList.filter(s=>s.show).map(s=>external_kbnSharedDeps_React_default.a.createElement(Stat,{key:s.label,stat:s})))}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return DatePickerWrapper}));var external_kbnSharedDeps_React_=__webpack_require__(14),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),external_kbnSharedDeps_Rxjs_=__webpack_require__(23),external_kbnSharedDeps_Lodash_=__webpack_require__(7),external_kbnSharedDeps_ElasticEui_=__webpack_require__(39),common_=__webpack_require__(28),timefilter_refresh_service=__webpack_require__(192),url_state=__webpack_require__(77),kibana=__webpack_require__(63);function updateLastRefresh(timeRange){timefilter_refresh_service.a.next({lastRefresh:Date.now(),timeRange:timeRange})}const DatePickerWrapper=()=>{var _globalState$refreshI;const{services:services}=Object(kibana.b)(),config=services.uiSettings,{timefilter:timefilter,history:history}=services.data.query.timefilter,[globalState,setGlobalState]=Object(url_state.c)("_g"),getRecentlyUsedRanges=(timeHistory=history,function(){var _timeHistory$get$map,_timeHistory$get;return null!==(_timeHistory$get$map=null===(_timeHistory$get=timeHistory.get())||void 0===_timeHistory$get?void 0:_timeHistory$get.map(({from:from,to:to})=>({start:from,end:to})))&&void 0!==_timeHistory$get$map?_timeHistory$get$map:[]});var timeHistory;const refreshInterval=null!==(_globalState$refreshI=null==globalState?void 0:globalState.refreshInterval)&&void 0!==_globalState$refreshI?_globalState$refreshI:timefilter.getRefreshInterval(),setRefreshInterval=Object(external_kbnSharedDeps_React_.useCallback)(Object(external_kbnSharedDeps_Lodash_.debounce)(refreshIntervalUpdate=>{setGlobalState("refreshInterval",refreshIntervalUpdate,!0)},200),[setGlobalState]),[time,setTime]=Object(external_kbnSharedDeps_React_.useState)(timefilter.getTime()),[recentlyUsedRanges,setRecentlyUsedRanges]=Object(external_kbnSharedDeps_React_.useState)(getRecentlyUsedRanges()),[isAutoRefreshSelectorEnabled,setIsAutoRefreshSelectorEnabled]=Object(external_kbnSharedDeps_React_.useState)(timefilter.isAutoRefreshSelectorEnabled()),[isTimeRangeSelectorEnabled,setIsTimeRangeSelectorEnabled]=Object(external_kbnSharedDeps_React_.useState)(timefilter.isTimeRangeSelectorEnabled()),dateFormat=config.get("dateFormat"),timePickerQuickRanges=config.get(common_.UI_SETTINGS.TIMEPICKER_QUICK_RANGES),commonlyUsedRanges=Object(external_kbnSharedDeps_React_.useMemo)(()=>timePickerQuickRanges.map(({from:from,to:to,display:display})=>({start:from,end:to,label:display})),[timePickerQuickRanges]);Object(external_kbnSharedDeps_React_.useEffect)(()=>{const subscriptions=new external_kbnSharedDeps_Rxjs_.Subscription,refreshIntervalUpdate$=timefilter.getRefreshIntervalUpdate$();void 0!==refreshIntervalUpdate$&&subscriptions.add(refreshIntervalUpdate$.subscribe(r=>{setRefreshInterval(timefilter.getRefreshInterval())}));const timeUpdate$=timefilter.getTimeUpdate$();void 0!==timeUpdate$&&subscriptions.add(timeUpdate$.subscribe(v=>{setTime(timefilter.getTime())}));const enabledUpdated$=timefilter.getEnabledUpdated$();return void 0!==enabledUpdated$&&subscriptions.add(enabledUpdated$.subscribe(w=>{setIsAutoRefreshSelectorEnabled(timefilter.isAutoRefreshSelectorEnabled()),setIsTimeRangeSelectorEnabled(timefilter.isTimeRangeSelectorEnabled())})),function(){subscriptions.unsubscribe()}},[]);const isPaused=refreshInterval.pause||!refreshInterval.pause&&!refreshInterval.value;return isAutoRefreshSelectorEnabled||isTimeRangeSelectorEnabled?external_kbnSharedDeps_React_default.a.createElement("div",{className:"mlNavigationMenu__datePickerWrapper"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSuperDatePicker,{start:time.from,end:time.to,isPaused:isPaused,isAutoRefreshOnly:!isTimeRangeSelectorEnabled,refreshInterval:refreshInterval.value,onTimeChange:function({start:start,end:end}){const newTime={from:start,to:end};timefilter.setTime(newTime),setTime(newTime),setRecentlyUsedRanges(getRecentlyUsedRanges())},onRefresh:updateLastRefresh,onRefreshChange:function({isPaused:pause,refreshInterval:value}){setRefreshInterval({pause:pause,value:value})},recentlyUsedRanges:recentlyUsedRanges,dateFormat:dateFormat,commonlyUsedRanges:commonlyUsedRanges})):null}},,,,,,,function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return DEFAULT_REFRESH_INTERVAL_MS})),__webpack_require__.d(__webpack_exports__,"c",(function(){return MINIMUM_REFRESH_INTERVAL_MS})),__webpack_require__.d(__webpack_exports__,"b",(function(){return DELETING_JOBS_REFRESH_INTERVAL_MS}));const DEFAULT_REFRESH_INTERVAL_MS=3e4,MINIMUM_REFRESH_INTERVAL_MS=1e3,DELETING_JOBS_REFRESH_INTERVAL_MS=2e3},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return mlTimefilterRefresh$}));var rxjs__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(23);const mlTimefilterRefresh$=new rxjs__WEBPACK_IMPORTED_MODULE_0__.Subject},function(module,exports,__webpack_require__){!function(){var global=function(){return this}();global||"undefined"==typeof window||(global=window);var define=function(module,deps,payload){"string"==typeof module?(2==arguments.length&&(payload=deps),define.modules[module]||(define.payloads[module]=payload,define.modules[module]=null)):define.original?define.original.apply(this,arguments):(console.error("dropping module because define wasn't a string."),console.trace())};define.modules={},define.payloads={};var ns,root,_acequire=function(parentId,module,callback){if("string"==typeof module){var payload=lookup(parentId,module);if(null!=payload)return callback&&callback(),payload}else if("[object Array]"===Object.prototype.toString.call(module)){for(var params=[],i=0,l=module.length;i<l;++i){var dep=lookup(parentId,module[i]);if(null==dep&&acequire.original)return;params.push(dep)}return callback&&callback.apply(null,params)||!0}},acequire=function(module,callback){var packagedModule=_acequire("",module,callback);return null==packagedModule&&acequire.original?acequire.original.apply(this,arguments):packagedModule},normalizeModule=function(parentId,moduleName){if(-1!==moduleName.indexOf("!")){var chunks=moduleName.split("!");return normalizeModule(parentId,chunks[0])+"!"+normalizeModule(parentId,chunks[1])}if("."==moduleName.charAt(0))for(moduleName=parentId.split("/").slice(0,-1).join("/")+"/"+moduleName;-1!==moduleName.indexOf(".")&&previous!=moduleName;){var previous=moduleName;moduleName=moduleName.replace(/\/\.\//,"/").replace(/[^\/]+\/\.\.\//,"")}return moduleName},lookup=function(parentId,moduleName){moduleName=normalizeModule(parentId,moduleName);var module=define.modules[moduleName];if(!module){if("function"==typeof(module=define.payloads[moduleName])){var exports={},mod={id:moduleName,uri:"",exports:exports,packaged:!0};exports=module((function(module,callback){return _acequire(moduleName,module,callback)}),exports,mod)||mod.exports,define.modules[moduleName]=exports,delete define.payloads[moduleName]}module=define.modules[moduleName]=exports||module}return module};root=global,(ns="ace")&&(global[ns]||(global[ns]={}),root=global[ns]),root.define&&root.define.packaged||(define.original=root.define,root.define=define,root.define.packaged=!0),root.acequire&&root.acequire.packaged||(acequire.original=root.acequire,root.acequire=acequire,root.acequire.packaged=!0)}(),ace.define("ace/lib/regexp",["require","exports","module"],(function(acequire,exports,module){"use strict";var x,real={exec:RegExp.prototype.exec,test:RegExp.prototype.test,match:String.prototype.match,replace:String.prototype.replace,split:String.prototype.split},compliantExecNpcg=void 0===real.exec.call(/()??/,"")[1],compliantLastIndexIncrement=(x=/^/g,real.test.call(x,""),!x.lastIndex);function getNativeFlags(regex){return(regex.global?"g":"")+(regex.ignoreCase?"i":"")+(regex.multiline?"m":"")+(regex.extended?"x":"")+(regex.sticky?"y":"")}function indexOf(array,item,from){if(Array.prototype.indexOf)return array.indexOf(item,from);for(var i=from||0;i<array.length;i++)if(array[i]===item)return i;return-1}compliantLastIndexIncrement&&compliantExecNpcg||(RegExp.prototype.exec=function(str){var name,r2,match=real.exec.apply(this,arguments);if("string"==typeof str&&match){if(!compliantExecNpcg&&match.length>1&&indexOf(match,"")>-1&&(r2=RegExp(this.source,real.replace.call(getNativeFlags(this),"g","")),real.replace.call(str.slice(match.index),r2,(function(){for(var i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(match[i]=void 0)}))),this._xregexp&&this._xregexp.captureNames)for(var i=1;i<match.length;i++)(name=this._xregexp.captureNames[i-1])&&(match[name]=match[i]);!compliantLastIndexIncrement&&this.global&&!match[0].length&&this.lastIndex>match.index&&this.lastIndex--}return match},compliantLastIndexIncrement||(RegExp.prototype.test=function(str){var match=real.exec.call(this,str);return match&&this.global&&!match[0].length&&this.lastIndex>match.index&&this.lastIndex--,!!match}))})),ace.define("ace/lib/es5-shim",["require","exports","module"],(function(acequire,exports,module){function Empty(){}Function.prototype.bind||(Function.prototype.bind=function(that){var target=this;if("function"!=typeof target)throw new TypeError("Function.prototype.bind called on incompatible "+target);var args=slice.call(arguments,1),bound=function(){if(this instanceof bound){var result=target.apply(this,args.concat(slice.call(arguments)));return Object(result)===result?result:this}return target.apply(that,args.concat(slice.call(arguments)))};return target.prototype&&(Empty.prototype=target.prototype,bound.prototype=new Empty,Empty.prototype=null),bound});var defineGetter,defineSetter,lookupGetter,lookupSetter,supportsAccessors,call=Function.prototype.call,prototypeOfArray=Array.prototype,prototypeOfObject=Object.prototype,slice=prototypeOfArray.slice,_toString=call.bind(prototypeOfObject.toString),owns=call.bind(prototypeOfObject.hasOwnProperty);if((supportsAccessors=owns(prototypeOfObject,"__defineGetter__"))&&(defineGetter=call.bind(prototypeOfObject.__defineGetter__),defineSetter=call.bind(prototypeOfObject.__defineSetter__),lookupGetter=call.bind(prototypeOfObject.__lookupGetter__),lookupSetter=call.bind(prototypeOfObject.__lookupSetter__)),2!=[1,2].splice(0).length)if(function(){function makeArray(l){var a=new Array(l+2);return a[0]=a[1]=0,a}var lengthBefore,array=[];if(array.splice.apply(array,makeArray(20)),array.splice.apply(array,makeArray(26)),lengthBefore=array.length,array.splice(5,0,"XXX"),array.length,lengthBefore+1==array.length)return!0}()){var array_splice=Array.prototype.splice;Array.prototype.splice=function(start,deleteCount){return arguments.length?array_splice.apply(this,[void 0===start?0:start,void 0===deleteCount?this.length-start:deleteCount].concat(slice.call(arguments,2))):[]}}else Array.prototype.splice=function(pos,removeCount){var length=this.length;pos>0?pos>length&&(pos=length):null==pos?pos=0:pos<0&&(pos=Math.max(length+pos,0)),pos+removeCount<length||(removeCount=length-pos);var removed=this.slice(pos,pos+removeCount),insert=slice.call(arguments,2),add=insert.length;if(pos===length)add&&this.push.apply(this,insert);else{var remove=Math.min(removeCount,length-pos),tailOldPos=pos+remove,tailNewPos=tailOldPos+add-remove,tailCount=length-tailOldPos,lengthAfterRemove=length-remove;if(tailNewPos<tailOldPos)for(var i=0;i<tailCount;++i)this[tailNewPos+i]=this[tailOldPos+i];else if(tailNewPos>tailOldPos)for(i=tailCount;i--;)this[tailNewPos+i]=this[tailOldPos+i];if(add&&pos===lengthAfterRemove)this.length=lengthAfterRemove,this.push.apply(this,insert);else for(this.length=lengthAfterRemove+add,i=0;i<add;++i)this[pos+i]=insert[i]}return removed};Array.isArray||(Array.isArray=function(obj){return"[object Array]"==_toString(obj)});var createEmpty,freezeObject,boxedString=Object("a"),splitString="a"!=boxedString[0]||!(0 in boxedString);if(Array.prototype.forEach||(Array.prototype.forEach=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,thisp=arguments[1],i=-1,length=self.length>>>0;if("[object Function]"!=_toString(fun))throw new TypeError;for(;++i<length;)i in self&&fun.call(thisp,self[i],i,object)}),Array.prototype.map||(Array.prototype.map=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0,result=Array(length),thisp=arguments[1];if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");for(var i=0;i<length;i++)i in self&&(result[i]=fun.call(thisp,self[i],i,object));return result}),Array.prototype.filter||(Array.prototype.filter=function(fun){var value,object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0,result=[],thisp=arguments[1];if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");for(var i=0;i<length;i++)i in self&&(value=self[i],fun.call(thisp,value,i,object)&&result.push(value));return result}),Array.prototype.every||(Array.prototype.every=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0,thisp=arguments[1];if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");for(var i=0;i<length;i++)if(i in self&&!fun.call(thisp,self[i],i,object))return!1;return!0}),Array.prototype.some||(Array.prototype.some=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0,thisp=arguments[1];if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");for(var i=0;i<length;i++)if(i in self&&fun.call(thisp,self[i],i,object))return!0;return!1}),Array.prototype.reduce||(Array.prototype.reduce=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0;if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");if(!length&&1==arguments.length)throw new TypeError("reduce of empty array with no initial value");var result,i=0;if(arguments.length>=2)result=arguments[1];else for(;;){if(i in self){result=self[i++];break}if(++i>=length)throw new TypeError("reduce of empty array with no initial value")}for(;i<length;i++)i in self&&(result=fun.call(void 0,result,self[i],i,object));return result}),Array.prototype.reduceRight||(Array.prototype.reduceRight=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0;if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");if(!length&&1==arguments.length)throw new TypeError("reduceRight of empty array with no initial value");var result,i=length-1;if(arguments.length>=2)result=arguments[1];else for(;;){if(i in self){result=self[i--];break}if(--i<0)throw new TypeError("reduceRight of empty array with no initial value")}do{i in this&&(result=fun.call(void 0,result,self[i],i,object))}while(i--);return result}),Array.prototype.indexOf&&-1==[0,1].indexOf(1,2)||(Array.prototype.indexOf=function(sought){var self=splitString&&"[object String]"==_toString(this)?this.split(""):toObject(this),length=self.length>>>0;if(!length)return-1;var i=0;for(arguments.length>1&&(i=toInteger(arguments[1])),i=i>=0?i:Math.max(0,length+i);i<length;i++)if(i in self&&self[i]===sought)return i;return-1}),Array.prototype.lastIndexOf&&-1==[0,1].lastIndexOf(0,-3)||(Array.prototype.lastIndexOf=function(sought){var self=splitString&&"[object String]"==_toString(this)?this.split(""):toObject(this),length=self.length>>>0;if(!length)return-1;var i=length-1;for(arguments.length>1&&(i=Math.min(i,toInteger(arguments[1]))),i=i>=0?i:length-Math.abs(i);i>=0;i--)if(i in self&&sought===self[i])return i;return-1}),Object.getPrototypeOf||(Object.getPrototypeOf=function(object){return object.__proto__||(object.constructor?object.constructor.prototype:prototypeOfObject)}),!Object.getOwnPropertyDescriptor){Object.getOwnPropertyDescriptor=function(object,property){if("object"!=typeof object&&"function"!=typeof object||null===object)throw new TypeError("Object.getOwnPropertyDescriptor called on a non-object: "+object);if(owns(object,property)){var descriptor;if(descriptor={enumerable:!0,configurable:!0},supportsAccessors){var prototype=object.__proto__;object.__proto__=prototypeOfObject;var getter=lookupGetter(object,property),setter=lookupSetter(object,property);if(object.__proto__=prototype,getter||setter)return getter&&(descriptor.get=getter),setter&&(descriptor.set=setter),descriptor}return descriptor.value=object[property],descriptor}}}(Object.getOwnPropertyNames||(Object.getOwnPropertyNames=function(object){return Object.keys(object)}),Object.create)||(createEmpty=null===Object.prototype.__proto__?function(){return{__proto__:null}}:function(){var empty={};for(var i in empty)empty[i]=null;return empty.constructor=empty.hasOwnProperty=empty.propertyIsEnumerable=empty.isPrototypeOf=empty.toLocaleString=empty.toString=empty.valueOf=empty.__proto__=null,empty},Object.create=function(prototype,properties){var object;if(null===prototype)object=createEmpty();else{if("object"!=typeof prototype)throw new TypeError("typeof prototype["+typeof prototype+"] != 'object'");var Type=function(){};Type.prototype=prototype,(object=new Type).__proto__=prototype}return void 0!==properties&&Object.defineProperties(object,properties),object});function doesDefinePropertyWork(object){try{return Object.defineProperty(object,"sentinel",{}),"sentinel"in object}catch(exception){}}if(Object.defineProperty){var definePropertyWorksOnObject=doesDefinePropertyWork({}),definePropertyWorksOnDom="undefined"==typeof document||doesDefinePropertyWork(document.createElement("div"));if(!definePropertyWorksOnObject||!definePropertyWorksOnDom)var definePropertyFallback=Object.defineProperty}if(!Object.defineProperty||definePropertyFallback){Object.defineProperty=function(object,property,descriptor){if("object"!=typeof object&&"function"!=typeof object||null===object)throw new TypeError("Object.defineProperty called on non-object: "+object);if("object"!=typeof descriptor&&"function"!=typeof descriptor||null===descriptor)throw new TypeError("Property description must be an object: "+descriptor);if(definePropertyFallback)try{return definePropertyFallback.call(Object,object,property,descriptor)}catch(exception){}if(owns(descriptor,"value"))if(supportsAccessors&&(lookupGetter(object,property)||lookupSetter(object,property))){var prototype=object.__proto__;object.__proto__=prototypeOfObject,delete object[property],object[property]=descriptor.value,object.__proto__=prototype}else object[property]=descriptor.value;else{if(!supportsAccessors)throw new TypeError("getters & setters can not be defined on this javascript engine");owns(descriptor,"get")&&defineGetter(object,property,descriptor.get),owns(descriptor,"set")&&defineSetter(object,property,descriptor.set)}return object}}Object.defineProperties||(Object.defineProperties=function(object,properties){for(var property in properties)owns(properties,property)&&Object.defineProperty(object,property,properties[property]);return object}),Object.seal||(Object.seal=function(object){return object}),Object.freeze||(Object.freeze=function(object){return object});try{Object.freeze((function(){}))}catch(exception){Object.freeze=(freezeObject=Object.freeze,function(object){return"function"==typeof object?object:freezeObject(object)})}if(Object.preventExtensions||(Object.preventExtensions=function(object){return object}),Object.isSealed||(Object.isSealed=function(object){return!1}),Object.isFrozen||(Object.isFrozen=function(object){return!1}),Object.isExtensible||(Object.isExtensible=function(object){if(Object(object)===object)throw new TypeError;for(var name="";owns(object,name);)name+="?";object[name]=!0;var returnValue=owns(object,name);return delete object[name],returnValue}),!Object.keys){var hasDontEnumBug=!0,dontEnums=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],dontEnumsLength=dontEnums.length;for(var key in{toString:null})hasDontEnumBug=!1;Object.keys=function(object){if("object"!=typeof object&&"function"!=typeof object||null===object)throw new TypeError("Object.keys called on a non-object");var keys=[];for(var name in object)owns(object,name)&&keys.push(name);if(hasDontEnumBug)for(var i=0,ii=dontEnumsLength;i<ii;i++){var dontEnum=dontEnums[i];owns(object,dontEnum)&&keys.push(dontEnum)}return keys}}Date.now||(Date.now=function(){return(new Date).getTime()});var ws="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff";if(!String.prototype.trim||ws.trim()){ws="["+ws+"]";var trimBeginRegexp=new RegExp("^"+ws+ws+"*"),trimEndRegexp=new RegExp(ws+ws+"*$");String.prototype.trim=function(){return String(this).replace(trimBeginRegexp,"").replace(trimEndRegexp,"")}}function toInteger(n){return(n=+n)!=n?n=0:0!==n&&n!==1/0&&n!==-1/0&&(n=(n>0||-1)*Math.floor(Math.abs(n))),n}var toObject=function(o){if(null==o)throw new TypeError("can't convert "+o+" to object");return Object(o)}})),ace.define("ace/lib/fixoldbrowsers",["require","exports","module","ace/lib/regexp","ace/lib/es5-shim"],(function(acequire,exports,module){"use strict";acequire("./regexp"),acequire("./es5-shim")})),ace.define("ace/lib/dom",["require","exports","module"],(function(acequire,exports,module){"use strict";exports.getDocumentHead=function(doc){return doc||(doc=document),doc.head||doc.getElementsByTagName("head")[0]||doc.documentElement},exports.createElement=function(tag,ns){return document.createElementNS?document.createElementNS(ns||"http://www.w3.org/1999/xhtml",tag):document.createElement(tag)},exports.hasCssClass=function(el,name){return-1!==(el.className+"").split(/\s+/g).indexOf(name)},exports.addCssClass=function(el,name){exports.hasCssClass(el,name)||(el.className+=" "+name)},exports.removeCssClass=function(el,name){for(var classes=el.className.split(/\s+/g);;){var index=classes.indexOf(name);if(-1==index)break;classes.splice(index,1)}el.className=classes.join(" ")},exports.toggleCssClass=function(el,name){for(var classes=el.className.split(/\s+/g),add=!0;;){var index=classes.indexOf(name);if(-1==index)break;add=!1,classes.splice(index,1)}return add&&classes.push(name),el.className=classes.join(" "),add},exports.setCssClass=function(node,className,include){include?exports.addCssClass(node,className):exports.removeCssClass(node,className)},exports.hasCssString=function(id,doc){var sheets,index=0;if((doc=doc||document).createStyleSheet&&(sheets=doc.styleSheets)){for(;index<sheets.length;)if(sheets[index++].owningElement.id===id)return!0}else if(sheets=doc.getElementsByTagName("style"))for(;index<sheets.length;)if(sheets[index++].id===id)return!0;return!1},exports.importCssString=function(cssText,id,doc){if(doc=doc||document,id&&exports.hasCssString(id,doc))return null;var style;id&&(cssText+="\n/*# sourceURL=ace/css/"+id+" */"),doc.createStyleSheet?((style=doc.createStyleSheet()).cssText=cssText,id&&(style.owningElement.id=id)):((style=exports.createElement("style")).appendChild(doc.createTextNode(cssText)),id&&(style.id=id),exports.getDocumentHead(doc).appendChild(style))},exports.importCssStylsheet=function(uri,doc){if(doc.createStyleSheet)doc.createStyleSheet(uri);else{var link=exports.createElement("link");link.rel="stylesheet",link.href=uri,exports.getDocumentHead(doc).appendChild(link)}},exports.getInnerWidth=function(element){return parseInt(exports.computedStyle(element,"paddingLeft"),10)+parseInt(exports.computedStyle(element,"paddingRight"),10)+element.clientWidth},exports.getInnerHeight=function(element){return parseInt(exports.computedStyle(element,"paddingTop"),10)+parseInt(exports.computedStyle(element,"paddingBottom"),10)+element.clientHeight},exports.scrollbarWidth=function(document){var inner=exports.createElement("ace_inner");inner.style.width="100%",inner.style.minWidth="0px",inner.style.height="200px",inner.style.display="block";var outer=exports.createElement("ace_outer"),style=outer.style;style.position="absolute",style.left="-10000px",style.overflow="hidden",style.width="200px",style.minWidth="0px",style.height="150px",style.display="block",outer.appendChild(inner);var body=document.documentElement;body.appendChild(outer);var noScrollbar=inner.offsetWidth;style.overflow="scroll";var withScrollbar=inner.offsetWidth;return noScrollbar==withScrollbar&&(withScrollbar=outer.clientWidth),body.removeChild(outer),noScrollbar-withScrollbar},"undefined"!=typeof document?(void 0!==window.pageYOffset?(exports.getPageScrollTop=function(){return window.pageYOffset},exports.getPageScrollLeft=function(){return window.pageXOffset}):(exports.getPageScrollTop=function(){return document.body.scrollTop},exports.getPageScrollLeft=function(){return document.body.scrollLeft}),window.getComputedStyle?exports.computedStyle=function(element,style){return style?(window.getComputedStyle(element,"")||{})[style]||"":window.getComputedStyle(element,"")||{}}:exports.computedStyle=function(element,style){return style?element.currentStyle[style]:element.currentStyle},exports.setInnerHtml=function(el,innerHtml){var element=el.cloneNode(!1);return element.innerHTML=innerHtml,el.parentNode.replaceChild(element,el),element},"textContent"in document.documentElement?(exports.setInnerText=function(el,innerText){el.textContent=innerText},exports.getInnerText=function(el){return el.textContent}):(exports.setInnerText=function(el,innerText){el.innerText=innerText},exports.getInnerText=function(el){return el.innerText}),exports.getParentWindow=function(document){return document.defaultView||document.parentWindow}):exports.importCssString=function(){}})),ace.define("ace/lib/oop",["require","exports","module"],(function(acequire,exports,module){"use strict";exports.inherits=function(ctor,superCtor){ctor.super_=superCtor,ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:!1,writable:!0,configurable:!0}})},exports.mixin=function(obj,mixin){for(var key in mixin)obj[key]=mixin[key];return obj},exports.implement=function(proto,mixin){exports.mixin(proto,mixin)}})),ace.define("ace/lib/keys",["require","exports","module","ace/lib/fixoldbrowsers","ace/lib/oop"],(function(acequire,exports,module){"use strict";acequire("./fixoldbrowsers");var oop=acequire("./oop"),Keys=function(){var name,i,ret={MODIFIER_KEYS:{16:"Shift",17:"Ctrl",18:"Alt",224:"Meta"},KEY_MODS:{ctrl:1,alt:2,option:2,shift:4,super:8,meta:8,command:8,cmd:8},FUNCTION_KEYS:{8:"Backspace",9:"Tab",13:"Return",19:"Pause",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"Print",45:"Insert",46:"Delete",96:"Numpad0",97:"Numpad1",98:"Numpad2",99:"Numpad3",100:"Numpad4",101:"Numpad5",102:"Numpad6",103:"Numpad7",104:"Numpad8",105:"Numpad9","-13":"NumpadEnter",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"Numlock",145:"Scrolllock"},PRINTABLE_KEYS:{32:" ",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",59:";",61:"=",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",107:"+",109:"-",110:".",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",111:"/",106:"*"}};for(i in ret.FUNCTION_KEYS)name=ret.FUNCTION_KEYS[i].toLowerCase(),ret[name]=parseInt(i,10);for(i in ret.PRINTABLE_KEYS)name=ret.PRINTABLE_KEYS[i].toLowerCase(),ret[name]=parseInt(i,10);return oop.mixin(ret,ret.MODIFIER_KEYS),oop.mixin(ret,ret.PRINTABLE_KEYS),oop.mixin(ret,ret.FUNCTION_KEYS),ret.enter=ret.return,ret.escape=ret.esc,ret.del=ret.delete,ret[173]="-",function(){for(var mods=["cmd","ctrl","alt","shift"],i=Math.pow(2,mods.length);i--;)ret.KEY_MODS[i]=mods.filter((function(x){return i&ret.KEY_MODS[x]})).join("-")+"-"}(),ret.KEY_MODS[0]="",ret.KEY_MODS[-1]="input-",ret}();oop.mixin(exports,Keys),exports.keyCodeToString=function(keyCode){var keyString=Keys[keyCode];return"string"!=typeof keyString&&(keyString=String.fromCharCode(keyCode)),keyString.toLowerCase()}})),ace.define("ace/lib/useragent",["require","exports","module"],(function(acequire,exports,module){"use strict";if(exports.OS={LINUX:"LINUX",MAC:"MAC",WINDOWS:"WINDOWS"},exports.getOS=function(){return exports.isMac?exports.OS.MAC:exports.isLinux?exports.OS.LINUX:exports.OS.WINDOWS},"object"==typeof navigator){var os=(navigator.platform.match(/mac|win|linux/i)||["other"])[0].toLowerCase(),ua=navigator.userAgent;exports.isWin="win"==os,exports.isMac="mac"==os,exports.isLinux="linux"==os,exports.isIE="Microsoft Internet Explorer"==navigator.appName||navigator.appName.indexOf("MSAppHost")>=0?parseFloat((ua.match(/(?:MSIE |Trident\/[0-9]+[\.0-9]+;.*rv:)([0-9]+[\.0-9]+)/)||[])[1]):parseFloat((ua.match(/(?:Trident\/[0-9]+[\.0-9]+;.*rv:)([0-9]+[\.0-9]+)/)||[])[1]),exports.isOldIE=exports.isIE&&exports.isIE<9,exports.isGecko=exports.isMozilla=(window.Controllers||window.controllers)&&"Gecko"===window.navigator.product,exports.isOldGecko=exports.isGecko&&parseInt((ua.match(/rv:(\d+)/)||[])[1],10)<4,exports.isOpera=window.opera&&"[object Opera]"==Object.prototype.toString.call(window.opera),exports.isWebKit=parseFloat(ua.split("WebKit/")[1])||void 0,exports.isChrome=parseFloat(ua.split(" Chrome/")[1])||void 0,exports.isAIR=ua.indexOf("AdobeAIR")>=0,exports.isIPad=ua.indexOf("iPad")>=0,exports.isChromeOS=ua.indexOf(" CrOS ")>=0,exports.isIOS=/iPad|iPhone|iPod/.test(ua)&&!window.MSStream,exports.isIOS&&(exports.isMac=!0)}})),ace.define("ace/lib/event",["require","exports","module","ace/lib/keys","ace/lib/useragent"],(function(acequire,exports,module){"use strict";var keys=acequire("./keys"),useragent=acequire("./useragent"),pressedKeys=null,ts=0;exports.addListener=function(elem,type,callback){if(elem.addEventListener)return elem.addEventListener(type,callback,!1);if(elem.attachEvent){var wrapper=function(){callback.call(elem,window.event)};callback._wrapper=wrapper,elem.attachEvent("on"+type,wrapper)}},exports.removeListener=function(elem,type,callback){if(elem.removeEventListener)return elem.removeEventListener(type,callback,!1);elem.detachEvent&&elem.detachEvent("on"+type,callback._wrapper||callback)},exports.stopEvent=function(e){return exports.stopPropagation(e),exports.preventDefault(e),!1},exports.stopPropagation=function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},exports.preventDefault=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},exports.getButton=function(e){return"dblclick"==e.type?0:"contextmenu"==e.type||useragent.isMac&&e.ctrlKey&&!e.altKey&&!e.shiftKey?2:e.preventDefault?e.button:{1:0,2:2,4:1}[e.button]},exports.capture=function(el,eventHandler,releaseCaptureHandler){function onMouseUp(e){eventHandler&&eventHandler(e),releaseCaptureHandler&&releaseCaptureHandler(e),exports.removeListener(document,"mousemove",eventHandler,!0),exports.removeListener(document,"mouseup",onMouseUp,!0),exports.removeListener(document,"dragstart",onMouseUp,!0)}return exports.addListener(document,"mousemove",eventHandler,!0),exports.addListener(document,"mouseup",onMouseUp,!0),exports.addListener(document,"dragstart",onMouseUp,!0),onMouseUp},exports.addTouchMoveListener=function(el,callback){var startx,starty;exports.addListener(el,"touchstart",(function(e){var touchObj=e.touches[0];startx=touchObj.clientX,starty=touchObj.clientY})),exports.addListener(el,"touchmove",(function(e){var touches=e.touches;if(!(touches.length>1)){var touchObj=touches[0];e.wheelX=startx-touchObj.clientX,e.wheelY=starty-touchObj.clientY,startx=touchObj.clientX,starty=touchObj.clientY,callback(e)}}))},exports.addMouseWheelListener=function(el,callback){"onmousewheel"in el?exports.addListener(el,"mousewheel",(function(e){void 0!==e.wheelDeltaX?(e.wheelX=-e.wheelDeltaX/8,e.wheelY=-e.wheelDeltaY/8):(e.wheelX=0,e.wheelY=-e.wheelDelta/8),callback(e)})):"onwheel"in el?exports.addListener(el,"wheel",(function(e){switch(e.deltaMode){case e.DOM_DELTA_PIXEL:e.wheelX=.35*e.deltaX||0,e.wheelY=.35*e.deltaY||0;break;case e.DOM_DELTA_LINE:case e.DOM_DELTA_PAGE:e.wheelX=5*(e.deltaX||0),e.wheelY=5*(e.deltaY||0)}callback(e)})):exports.addListener(el,"DOMMouseScroll",(function(e){e.axis&&e.axis==e.HORIZONTAL_AXIS?(e.wheelX=5*(e.detail||0),e.wheelY=0):(e.wheelX=0,e.wheelY=5*(e.detail||0)),callback(e)}))},exports.addMultiMouseDownListener=function(elements,timeouts,eventHandler,callbackName){var startX,startY,timer,clicks=0,eventNames={2:"dblclick",3:"tripleclick",4:"quadclick"};function onMousedown(e){if(0!==exports.getButton(e)?clicks=0:e.detail>1?++clicks>4&&(clicks=1):clicks=1,useragent.isIE){var isNewClick=Math.abs(e.clientX-startX)>5||Math.abs(e.clientY-startY)>5;timer&&!isNewClick||(clicks=1),timer&&clearTimeout(timer),timer=setTimeout((function(){timer=null}),timeouts[clicks-1]||600),1==clicks&&(startX=e.clientX,startY=e.clientY)}if(e._clicks=clicks,eventHandler[callbackName]("mousedown",e),clicks>4)clicks=0;else if(clicks>1)return eventHandler[callbackName](eventNames[clicks],e)}function onDblclick(e){clicks=2,timer&&clearTimeout(timer),timer=setTimeout((function(){timer=null}),timeouts[clicks-1]||600),eventHandler[callbackName]("mousedown",e),eventHandler[callbackName](eventNames[clicks],e)}Array.isArray(elements)||(elements=[elements]),elements.forEach((function(el){exports.addListener(el,"mousedown",onMousedown),useragent.isOldIE&&exports.addListener(el,"dblclick",onDblclick)}))};var getModifierHash=useragent.isMac&&useragent.isOpera&&!("KeyboardEvent"in window)?function(e){return 0|(e.metaKey?1:0)|(e.altKey?2:0)|(e.shiftKey?4:0)|(e.ctrlKey?8:0)}:function(e){return 0|(e.ctrlKey?1:0)|(e.altKey?2:0)|(e.shiftKey?4:0)|(e.metaKey?8:0)};function normalizeCommandKeys(callback,e,keyCode){var hashId=getModifierHash(e);if(!useragent.isMac&&pressedKeys){if(e.getModifierState&&(e.getModifierState("OS")||e.getModifierState("Win"))&&(hashId|=8),pressedKeys.altGr){if(3==(3&hashId))return;pressedKeys.altGr=0}if(18===keyCode||17===keyCode){var location="location"in e?e.location:e.keyLocation;if(17===keyCode&&1===location)1==pressedKeys[keyCode]&&(ts=e.timeStamp);else if(18===keyCode&&3===hashId&&2===location){e.timeStamp-ts<50&&(pressedKeys.altGr=!0)}}}if((keyCode in keys.MODIFIER_KEYS&&(keyCode=-1),8&hashId&&keyCode>=91&&keyCode<=93&&(keyCode=-1),!hashId&&13===keyCode)&&(3===(location="location"in e?e.location:e.keyLocation)&&(callback(e,hashId,-keyCode),e.defaultPrevented)))return;if(useragent.isChromeOS&&8&hashId){if(callback(e,hashId,keyCode),e.defaultPrevented)return;hashId&=-9}return!!(hashId||keyCode in keys.FUNCTION_KEYS||keyCode in keys.PRINTABLE_KEYS)&&callback(e,hashId,keyCode)}function resetPressedKeys(){pressedKeys=Object.create(null)}if(exports.getModifierString=function(e){return keys.KEY_MODS[getModifierHash(e)]},exports.addCommandKeyListener=function(el,callback){var addListener=exports.addListener;if(useragent.isOldGecko||useragent.isOpera&&!("KeyboardEvent"in window)){var lastKeyDownKeyCode=null;addListener(el,"keydown",(function(e){lastKeyDownKeyCode=e.keyCode})),addListener(el,"keypress",(function(e){return normalizeCommandKeys(callback,e,lastKeyDownKeyCode)}))}else{var lastDefaultPrevented=null;addListener(el,"keydown",(function(e){pressedKeys[e.keyCode]=(pressedKeys[e.keyCode]||0)+1;var result=normalizeCommandKeys(callback,e,e.keyCode);return lastDefaultPrevented=e.defaultPrevented,result})),addListener(el,"keypress",(function(e){lastDefaultPrevented&&(e.ctrlKey||e.altKey||e.shiftKey||e.metaKey)&&(exports.stopEvent(e),lastDefaultPrevented=null)})),addListener(el,"keyup",(function(e){pressedKeys[e.keyCode]=null})),pressedKeys||(resetPressedKeys(),addListener(window,"focus",resetPressedKeys))}},"object"==typeof window&&window.postMessage&&!useragent.isOldIE){exports.nextTick=function(callback,win){win=win||window;exports.addListener(win,"message",(function listener(e){"zero-timeout-message-1"==e.data&&(exports.stopPropagation(e),exports.removeListener(win,"message",listener),callback())})),win.postMessage("zero-timeout-message-1","*")}}exports.nextFrame="object"==typeof window&&(window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame),exports.nextFrame?exports.nextFrame=exports.nextFrame.bind(window):exports.nextFrame=function(callback){setTimeout(callback,17)}})),ace.define("ace/lib/lang",["require","exports","module"],(function(acequire,exports,module){"use strict";exports.last=function(a){return a[a.length-1]},exports.stringReverse=function(string){return string.split("").reverse().join("")},exports.stringRepeat=function(string,count){for(var result="";count>0;)1&count&&(result+=string),(count>>=1)&&(string+=string);return result};var trimBeginRegexp=/^\s\s*/,trimEndRegexp=/\s\s*$/;exports.stringTrimLeft=function(string){return string.replace(trimBeginRegexp,"")},exports.stringTrimRight=function(string){return string.replace(trimEndRegexp,"")},exports.copyObject=function(obj){var copy={};for(var key in obj)copy[key]=obj[key];return copy},exports.copyArray=function(array){for(var copy=[],i=0,l=array.length;i<l;i++)array[i]&&"object"==typeof array[i]?copy[i]=this.copyObject(array[i]):copy[i]=array[i];return copy},exports.deepCopy=function deepCopy(obj){if("object"!=typeof obj||!obj)return obj;var copy;if(Array.isArray(obj)){copy=[];for(var key=0;key<obj.length;key++)copy[key]=deepCopy(obj[key]);return copy}if("[object Object]"!==Object.prototype.toString.call(obj))return obj;for(var key in copy={},obj)copy[key]=deepCopy(obj[key]);return copy},exports.arrayToMap=function(arr){for(var map={},i=0;i<arr.length;i++)map[arr[i]]=1;return map},exports.createMap=function(props){var map=Object.create(null);for(var i in props)map[i]=props[i];return map},exports.arrayRemove=function(array,value){for(var i=0;i<=array.length;i++)value===array[i]&&array.splice(i,1)},exports.escapeRegExp=function(str){return str.replace(/([.*+?^${}()|[\]\/\\])/g,"\\$1")},exports.escapeHTML=function(str){return str.replace(/&/g,"&#38;").replace(/"/g,"&#34;").replace(/'/g,"&#39;").replace(/</g,"&#60;")},exports.getMatchOffsets=function(string,regExp){var matches=[];return string.replace(regExp,(function(str){matches.push({offset:arguments[arguments.length-2],length:str.length})})),matches},exports.deferredCall=function(fcn){var timer=null,callback=function(){timer=null,fcn()},deferred=function(timeout){return deferred.cancel(),timer=setTimeout(callback,timeout||0),deferred};return deferred.schedule=deferred,deferred.call=function(){return this.cancel(),fcn(),deferred},deferred.cancel=function(){return clearTimeout(timer),timer=null,deferred},deferred.isPending=function(){return timer},deferred},exports.delayedCall=function(fcn,defaultTimeout){var timer=null,callback=function(){timer=null,fcn()},_self=function(timeout){null==timer&&(timer=setTimeout(callback,timeout||defaultTimeout))};return _self.delay=function(timeout){timer&&clearTimeout(timer),timer=setTimeout(callback,timeout||defaultTimeout)},_self.schedule=_self,_self.call=function(){this.cancel(),fcn()},_self.cancel=function(){timer&&clearTimeout(timer),timer=null},_self.isPending=function(){return timer},_self}})),ace.define("ace/keyboard/textinput_ios",["require","exports","module","ace/lib/event","ace/lib/useragent","ace/lib/dom","ace/lib/lang","ace/lib/keys"],(function(acequire,exports,module){"use strict";var event=acequire("../lib/event"),useragent=acequire("../lib/useragent"),dom=acequire("../lib/dom"),lang=acequire("../lib/lang"),KEYS=acequire("../lib/keys"),MODS=KEYS.KEY_MODS,BROKEN_SETDATA=useragent.isChrome<18,USE_IE_MIME_TYPE=useragent.isIE;exports.TextInput=function(parentNode,host){var text=dom.createElement("textarea");text.className=useragent.isIOS?"ace_text-input ace_text-input-ios":"ace_text-input",useragent.isTouchPad&&text.setAttribute("x-palm-disable-auto-cap",!0),text.setAttribute("wrap","off"),text.setAttribute("autocorrect","off"),text.setAttribute("autocapitalize","off"),text.setAttribute("spellcheck",!1),text.style.opacity="0",parentNode.insertBefore(text,parentNode.firstChild);var copied=!1,cut=!1,pasted=!1,inComposition=!1,tempStyle="",isSelectionEmpty=!0;try{var isFocused=document.activeElement===text}catch(e){}event.addListener(text,"blur",(function(e){host.onBlur(e),isFocused=!1})),event.addListener(text,"focus",(function(e){isFocused=!0,host.onFocus(e),resetSelection()})),this.focus=function(){if(tempStyle)return text.focus();text.style.position="fixed",text.focus()},this.blur=function(){text.blur()},this.isFocused=function(){return isFocused};var syncSelection=lang.delayedCall((function(){isFocused&&resetSelection(isSelectionEmpty)})),syncValue=lang.delayedCall((function(){inComposition||(text.value="\n aaaa a\n",isFocused&&resetSelection())}));function resetSelection(isEmpty){if(!inComposition){if(inComposition=!0,inputHandler)selectionStart=0,selectionEnd=isEmpty?0:text.value.length-1;else var selectionStart=4,selectionEnd=5;try{text.setSelectionRange(selectionStart,selectionEnd)}catch(e){}inComposition=!1}}function resetValue(){inComposition||(text.value="\n aaaa a\n",useragent.isWebKit&&syncValue.schedule())}useragent.isWebKit||host.addEventListener("changeSelection",(function(){host.selection.isEmpty()!=isSelectionEmpty&&(isSelectionEmpty=!isSelectionEmpty,syncSelection.schedule())})),resetValue(),isFocused&&host.onFocus();var inputHandler=null;this.setInputHandler=function(cb){inputHandler=cb},this.getInputHandler=function(){return inputHandler};var afterContextMenu=!1,sendText=function(data){4===text.selectionStart&&5===text.selectionEnd||(inputHandler&&(data=inputHandler(data),inputHandler=null),pasted?(resetSelection(),data&&host.onPaste(data),pasted=!1):data=="\n aaaa a\n".substr(0)&&4===text.selectionStart?afterContextMenu?host.execCommand("del",{source:"ace"}):host.execCommand("backspace",{source:"ace"}):copied||("\n aaaa a\n"==data.substring(0,9)&&data.length>"\n aaaa a\n".length?data=data.substr(9):data.substr(0,4)=="\n aaaa a\n".substr(0,4)?data=data.substr(4,data.length-"\n aaaa a\n".length+1):data.charAt(data.length-1)=="\n aaaa a\n".charAt(0)&&(data=data.slice(0,-1)),data=="\n aaaa a\n".charAt(0)||data.charAt(data.length-1)=="\n aaaa a\n".charAt(0)&&(data=data.slice(0,-1)),data&&host.onTextInput(data)),copied&&(copied=!1),afterContextMenu&&(afterContextMenu=!1))},onInput=function(e){if(!inComposition){var data=text.value;sendText(data),resetValue()}},handleClipboardData=function(e,data,forceIEMime){var clipboardData=e.clipboardData||window.clipboardData;if(clipboardData&&!BROKEN_SETDATA){var mime=USE_IE_MIME_TYPE||forceIEMime?"Text":"text/plain";try{return data?!1!==clipboardData.setData(mime,data):clipboardData.getData(mime)}catch(e){if(!forceIEMime)return handleClipboardData(e,data,!0)}}},doCopy=function(e,isCut){var data=host.getCopyText();if(!data)return event.preventDefault(e);handleClipboardData(e,data)?(useragent.isIOS&&(cut=isCut,text.value="\n aa"+data+"a a\n",text.setSelectionRange(4,4+data.length),copied={value:data}),isCut?host.onCut():host.onCopy(),useragent.isIOS||event.preventDefault(e)):(copied=!0,text.value=data,text.select(),setTimeout((function(){copied=!1,resetValue(),resetSelection(),isCut?host.onCut():host.onCopy()})))};event.addCommandKeyListener(text,host.onCommandKey.bind(host)),event.addListener(text,"select",(function(e){!function(text){return 0===text.selectionStart&&text.selectionEnd===text.value.length}(text)?inputHandler&&resetSelection(host.selection.isEmpty()):(host.selectAll(),resetSelection())})),event.addListener(text,"input",onInput),event.addListener(text,"cut",(function(e){doCopy(e,!0)})),event.addListener(text,"copy",(function(e){doCopy(e,!1)})),event.addListener(text,"paste",(function(e){var data=handleClipboardData(e);"string"==typeof data?(data&&host.onPaste(data,e),useragent.isIE&&setTimeout(resetSelection),event.preventDefault(e)):(text.value="",pasted=!0)}));var closeTimeout,onCompositionUpdate=function(){if(inComposition&&host.onCompositionUpdate&&!host.$readOnly){var val=text.value.replace(/\x01/g,"");if(inComposition.lastValue!==val&&(host.onCompositionUpdate(val),inComposition.lastValue&&host.undo(),inComposition.canUndo&&(inComposition.lastValue=val),inComposition.lastValue)){var r=host.selection.getRange();host.insert(inComposition.lastValue),host.session.markUndoGroup(),inComposition.range=host.selection.getRange(),host.selection.setRange(r),host.selection.clearSelection()}}},onCompositionEnd=function(e){if(host.onCompositionEnd&&!host.$readOnly){var c=inComposition;inComposition=!1;var timer=setTimeout((function(){timer=null;var str=text.value.replace(/\x01/g,"");inComposition||(str==c.lastValue?resetValue():!c.lastValue&&str&&(resetValue(),sendText(str)))}));inputHandler=function(str){return timer&&clearTimeout(timer),(str=str.replace(/\x01/g,""))==c.lastValue?"":(c.lastValue&&timer&&host.undo(),str)},host.onCompositionEnd(),host.removeListener("mousedown",onCompositionEnd),"compositionend"==e.type&&c.range&&host.selection.setRange(c.range),(!!useragent.isChrome&&useragent.isChrome>=53||!!useragent.isWebKit&&useragent.isWebKit>=603)&&onInput()}},syncComposition=lang.delayedCall(onCompositionUpdate,50);function onContextMenuClose(){clearTimeout(closeTimeout),closeTimeout=setTimeout((function(){tempStyle&&(text.style.cssText=tempStyle,tempStyle=""),null==host.renderer.$keepTextAreaAtCursor&&(host.renderer.$keepTextAreaAtCursor=!0,host.renderer.$moveTextAreaToCursor())}),0)}event.addListener(text,"compositionstart",(function(e){inComposition||!host.onCompositionStart||host.$readOnly||((inComposition={}).canUndo=host.session.$undoManager,host.onCompositionStart(),setTimeout(onCompositionUpdate,0),host.on("mousedown",onCompositionEnd),inComposition.canUndo&&!host.selection.isEmpty()&&(host.insert(""),host.session.markUndoGroup(),host.selection.clearSelection()),host.session.markUndoGroup())})),useragent.isGecko?event.addListener(text,"text",(function(){syncComposition.schedule()})):(event.addListener(text,"keyup",(function(){syncComposition.schedule()})),event.addListener(text,"keydown",(function(){syncComposition.schedule()}))),event.addListener(text,"compositionend",onCompositionEnd),this.getElement=function(){return text},this.setReadOnly=function(readOnly){text.readOnly=readOnly},this.onContextMenu=function(e){afterContextMenu=!0,resetSelection(host.selection.isEmpty()),host._emit("nativecontextmenu",{target:host,domEvent:e}),this.moveToMouse(e,!0)},this.moveToMouse=function(e,bringToFront){tempStyle||(tempStyle=text.style.cssText),text.style.cssText=(bringToFront?"z-index:100000;":"")+"height:"+text.style.height+";"+(useragent.isIE?"opacity:0.1;":"");var rect=host.container.getBoundingClientRect(),style=dom.computedStyle(host.container),top=rect.top+(parseInt(style.borderTopWidth)||0),left=rect.left+(parseInt(rect.borderLeftWidth)||0),maxTop=rect.bottom-top-text.clientHeight-2,move=function(e){text.style.left=e.clientX-left-2+"px",text.style.top=Math.min(e.clientY-top-2,maxTop)+"px"};move(e),"mousedown"==e.type&&(host.renderer.$keepTextAreaAtCursor&&(host.renderer.$keepTextAreaAtCursor=null),clearTimeout(closeTimeout),useragent.isWin&&event.capture(host.container,move,onContextMenuClose))},this.onContextMenuClose=onContextMenuClose;var onContextMenu=function(e){host.textInput.onContextMenu(e),onContextMenuClose()};if(event.addListener(text,"mouseup",onContextMenu),event.addListener(text,"mousedown",(function(e){e.preventDefault(),onContextMenuClose()})),event.addListener(host.renderer.scroller,"contextmenu",onContextMenu),event.addListener(text,"contextmenu",onContextMenu),useragent.isIOS){var typingResetTimeout=null,typing=!1;parentNode.addEventListener("keydown",(function(e){typingResetTimeout&&clearTimeout(typingResetTimeout),typing=!0})),parentNode.addEventListener("keyup",(function(e){typingResetTimeout=setTimeout((function(){typing=!1}),100)}));var detectArrowKeys=function(e){if(document.activeElement===text&&!typing){if(cut)return setTimeout((function(){cut=!1}),100);var selectionStart=text.selectionStart,selectionEnd=text.selectionEnd;if(text.setSelectionRange(4,5),selectionStart==selectionEnd)switch(selectionStart){case 0:host.onCommandKey(null,0,KEYS.up);break;case 1:host.onCommandKey(null,0,KEYS.home);break;case 2:host.onCommandKey(null,MODS.option,KEYS.left);break;case 4:host.onCommandKey(null,0,KEYS.left);break;case 5:host.onCommandKey(null,0,KEYS.right);break;case 7:host.onCommandKey(null,MODS.option,KEYS.right);break;case 8:host.onCommandKey(null,0,KEYS.end);break;case 9:host.onCommandKey(null,0,KEYS.down)}else{switch(selectionEnd){case 6:host.onCommandKey(null,MODS.shift,KEYS.right);break;case 7:host.onCommandKey(null,MODS.shift|MODS.option,KEYS.right);break;case 8:host.onCommandKey(null,MODS.shift,KEYS.end);break;case 9:host.onCommandKey(null,MODS.shift,KEYS.down)}switch(selectionStart){case 0:host.onCommandKey(null,MODS.shift,KEYS.up);break;case 1:host.onCommandKey(null,MODS.shift,KEYS.home);break;case 2:host.onCommandKey(null,MODS.shift|MODS.option,KEYS.left);break;case 3:host.onCommandKey(null,MODS.shift,KEYS.left)}}}};document.addEventListener("selectionchange",detectArrowKeys),host.on("destroy",(function(){document.removeEventListener("selectionchange",detectArrowKeys)}))}}})),ace.define("ace/keyboard/textinput",["require","exports","module","ace/lib/event","ace/lib/useragent","ace/lib/dom","ace/lib/lang","ace/keyboard/textinput_ios"],(function(acequire,exports,module){"use strict";var event=acequire("../lib/event"),useragent=acequire("../lib/useragent"),dom=acequire("../lib/dom"),lang=acequire("../lib/lang"),BROKEN_SETDATA=useragent.isChrome<18,USE_IE_MIME_TYPE=useragent.isIE,TextInputIOS=acequire("./textinput_ios").TextInput;exports.TextInput=function(parentNode,host){if(useragent.isIOS)return TextInputIOS.call(this,parentNode,host);var text=dom.createElement("textarea");text.className="ace_text-input",text.setAttribute("wrap","off"),text.setAttribute("autocorrect","off"),text.setAttribute("autocapitalize","off"),text.setAttribute("spellcheck",!1),text.style.opacity="0",parentNode.insertBefore(text,parentNode.firstChild);var copied=!1,pasted=!1,inComposition=!1,tempStyle="",isSelectionEmpty=!0;try{var isFocused=document.activeElement===text}catch(e){}event.addListener(text,"blur",(function(e){host.onBlur(e),isFocused=!1})),event.addListener(text,"focus",(function(e){isFocused=!0,host.onFocus(e),resetSelection()})),this.focus=function(){if(tempStyle)return text.focus();var top=text.style.top;text.style.position="fixed",text.style.top="0px",text.focus(),setTimeout((function(){text.style.position="","0px"==text.style.top&&(text.style.top=top)}),0)},this.blur=function(){text.blur()},this.isFocused=function(){return isFocused};var syncSelection=lang.delayedCall((function(){isFocused&&resetSelection(isSelectionEmpty)})),syncValue=lang.delayedCall((function(){inComposition||(text.value="\u2028\u2028",isFocused&&resetSelection())}));function resetSelection(isEmpty){if(!inComposition){if(inComposition=!0,inputHandler)var selectionStart=0,selectionEnd=isEmpty?0:text.value.length-1;else selectionStart=isEmpty?2:1,selectionEnd=2;try{text.setSelectionRange(selectionStart,selectionEnd)}catch(e){}inComposition=!1}}function resetValue(){inComposition||(text.value="\u2028\u2028",useragent.isWebKit&&syncValue.schedule())}useragent.isWebKit||host.addEventListener("changeSelection",(function(){host.selection.isEmpty()!=isSelectionEmpty&&(isSelectionEmpty=!isSelectionEmpty,syncSelection.schedule())})),resetValue(),isFocused&&host.onFocus();var inputHandler=null;this.setInputHandler=function(cb){inputHandler=cb},this.getInputHandler=function(){return inputHandler};var afterContextMenu=!1,sendText=function(data){inputHandler&&(data=inputHandler(data),inputHandler=null),pasted?(resetSelection(),data&&host.onPaste(data),pasted=!1):data=="\u2028\u2028".charAt(0)?afterContextMenu?host.execCommand("del",{source:"ace"}):host.execCommand("backspace",{source:"ace"}):("\u2028\u2028"==data.substring(0,2)?data=data.substr(2):data.charAt(0)=="\u2028\u2028".charAt(0)?data=data.substr(1):data.charAt(data.length-1)=="\u2028\u2028".charAt(0)&&(data=data.slice(0,-1)),data.charAt(data.length-1)=="\u2028\u2028".charAt(0)&&(data=data.slice(0,-1)),data&&host.onTextInput(data)),afterContextMenu&&(afterContextMenu=!1)},onInput=function(e){if(!inComposition){var data=text.value;sendText(data),resetValue()}},handleClipboardData=function(e,data,forceIEMime){var clipboardData=e.clipboardData||window.clipboardData;if(clipboardData&&!BROKEN_SETDATA){var mime=USE_IE_MIME_TYPE||forceIEMime?"Text":"text/plain";try{return data?!1!==clipboardData.setData(mime,data):clipboardData.getData(mime)}catch(e){if(!forceIEMime)return handleClipboardData(e,data,!0)}}},doCopy=function(e,isCut){var data=host.getCopyText();if(!data)return event.preventDefault(e);handleClipboardData(e,data)?(isCut?host.onCut():host.onCopy(),event.preventDefault(e)):(copied=!0,text.value=data,text.select(),setTimeout((function(){copied=!1,resetValue(),resetSelection(),isCut?host.onCut():host.onCopy()})))},onCut=function(e){doCopy(e,!0)},onCopy=function(e){doCopy(e,!1)},onPaste=function(e){var data=handleClipboardData(e);"string"==typeof data?(data&&host.onPaste(data,e),useragent.isIE&&setTimeout(resetSelection),event.preventDefault(e)):(text.value="",pasted=!0)};event.addCommandKeyListener(text,host.onCommandKey.bind(host)),event.addListener(text,"select",(function(e){copied?copied=!1:!function(text){return 0===text.selectionStart&&text.selectionEnd===text.value.length}(text)?inputHandler&&resetSelection(host.selection.isEmpty()):(host.selectAll(),resetSelection())})),event.addListener(text,"input",onInput),event.addListener(text,"cut",onCut),event.addListener(text,"copy",onCopy),event.addListener(text,"paste",onPaste),"oncut"in text&&"oncopy"in text&&"onpaste"in text||event.addListener(parentNode,"keydown",(function(e){if((!useragent.isMac||e.metaKey)&&e.ctrlKey)switch(e.keyCode){case 67:onCopy(e);break;case 86:onPaste(e);break;case 88:onCut(e)}}));var closeTimeout,onCompositionUpdate=function(){if(inComposition&&host.onCompositionUpdate&&!host.$readOnly){var val=text.value.replace(/\u2028/g,"");if(inComposition.lastValue!==val&&(host.onCompositionUpdate(val),inComposition.lastValue&&host.undo(),inComposition.canUndo&&(inComposition.lastValue=val),inComposition.lastValue)){var r=host.selection.getRange();host.insert(inComposition.lastValue),host.session.markUndoGroup(),inComposition.range=host.selection.getRange(),host.selection.setRange(r),host.selection.clearSelection()}}},onCompositionEnd=function(e){if(host.onCompositionEnd&&!host.$readOnly){var c=inComposition;inComposition=!1;var timer=setTimeout((function(){timer=null;var str=text.value.replace(/\u2028/g,"");inComposition||(str==c.lastValue?resetValue():!c.lastValue&&str&&(resetValue(),sendText(str)))}));inputHandler=function(str){return timer&&clearTimeout(timer),(str=str.replace(/\u2028/g,""))==c.lastValue?"":(c.lastValue&&timer&&host.undo(),str)},host.onCompositionEnd(),host.removeListener("mousedown",onCompositionEnd),"compositionend"==e.type&&c.range&&host.selection.setRange(c.range),(!!useragent.isChrome&&useragent.isChrome>=53||!!useragent.isWebKit&&useragent.isWebKit>=603)&&onInput()}},syncComposition=lang.delayedCall(onCompositionUpdate,50);function onContextMenuClose(){clearTimeout(closeTimeout),closeTimeout=setTimeout((function(){tempStyle&&(text.style.cssText=tempStyle,tempStyle=""),null==host.renderer.$keepTextAreaAtCursor&&(host.renderer.$keepTextAreaAtCursor=!0,host.renderer.$moveTextAreaToCursor())}),0)}event.addListener(text,"compositionstart",(function(e){inComposition||!host.onCompositionStart||host.$readOnly||((inComposition={}).canUndo=host.session.$undoManager,host.onCompositionStart(),setTimeout(onCompositionUpdate,0),host.on("mousedown",onCompositionEnd),inComposition.canUndo&&!host.selection.isEmpty()&&(host.insert(""),host.session.markUndoGroup(),host.selection.clearSelection()),host.session.markUndoGroup())})),useragent.isGecko?event.addListener(text,"text",(function(){syncComposition.schedule()})):(event.addListener(text,"keyup",(function(){syncComposition.schedule()})),event.addListener(text,"keydown",(function(){syncComposition.schedule()}))),event.addListener(text,"compositionend",onCompositionEnd),this.getElement=function(){return text},this.setReadOnly=function(readOnly){text.readOnly=readOnly},this.onContextMenu=function(e){afterContextMenu=!0,resetSelection(host.selection.isEmpty()),host._emit("nativecontextmenu",{target:host,domEvent:e}),this.moveToMouse(e,!0)},this.moveToMouse=function(e,bringToFront){tempStyle||(tempStyle=text.style.cssText),text.style.cssText=(bringToFront?"z-index:100000;":"")+"height:"+text.style.height+";"+(useragent.isIE?"opacity:0.1;":"");var rect=host.container.getBoundingClientRect(),style=dom.computedStyle(host.container),top=rect.top+(parseInt(style.borderTopWidth)||0),left=rect.left+(parseInt(rect.borderLeftWidth)||0),maxTop=rect.bottom-top-text.clientHeight-2,move=function(e){text.style.left=e.clientX-left-2+"px",text.style.top=Math.min(e.clientY-top-2,maxTop)+"px"};move(e),"mousedown"==e.type&&(host.renderer.$keepTextAreaAtCursor&&(host.renderer.$keepTextAreaAtCursor=null),clearTimeout(closeTimeout),useragent.isWin&&event.capture(host.container,move,onContextMenuClose))},this.onContextMenuClose=onContextMenuClose;var onContextMenu=function(e){host.textInput.onContextMenu(e),onContextMenuClose()};event.addListener(text,"mouseup",onContextMenu),event.addListener(text,"mousedown",(function(e){e.preventDefault(),onContextMenuClose()})),event.addListener(host.renderer.scroller,"contextmenu",onContextMenu),event.addListener(text,"contextmenu",onContextMenu)}})),ace.define("ace/mouse/default_handlers",["require","exports","module","ace/lib/dom","ace/lib/event","ace/lib/useragent"],(function(acequire,exports,module){"use strict";acequire("../lib/dom"),acequire("../lib/event");var useragent=acequire("../lib/useragent");function DefaultHandlers(mouseHandler){mouseHandler.$clickSelection=null;var editor=mouseHandler.editor;editor.setDefaultHandler("mousedown",this.onMouseDown.bind(mouseHandler)),editor.setDefaultHandler("dblclick",this.onDoubleClick.bind(mouseHandler)),editor.setDefaultHandler("tripleclick",this.onTripleClick.bind(mouseHandler)),editor.setDefaultHandler("quadclick",this.onQuadClick.bind(mouseHandler)),editor.setDefaultHandler("mousewheel",this.onMouseWheel.bind(mouseHandler)),editor.setDefaultHandler("touchmove",this.onTouchMove.bind(mouseHandler));["select","startSelect","selectEnd","selectAllEnd","selectByWordsEnd","selectByLinesEnd","dragWait","dragWaitEnd","focusWait"].forEach((function(x){mouseHandler[x]=this[x]}),this),mouseHandler.selectByLines=this.extendSelectionBy.bind(mouseHandler,"getLineRange"),mouseHandler.selectByWords=this.extendSelectionBy.bind(mouseHandler,"getWordRange")}function calcRangeOrientation(range,cursor){if(range.start.row==range.end.row)var cmp=2*cursor.column-range.start.column-range.end.column;else if(range.start.row!=range.end.row-1||range.start.column||range.end.column)cmp=2*cursor.row-range.start.row-range.end.row;else var cmp=cursor.column-4;return cmp<0?{cursor:range.start,anchor:range.end}:{cursor:range.end,anchor:range.start}}(function(){this.onMouseDown=function(ev){var inSelection=ev.inSelection(),pos=ev.getDocumentPosition();this.mousedownEvent=ev;var editor=this.editor,button=ev.getButton();if(0!==button){var selectionEmpty=editor.getSelectionRange().isEmpty();return editor.$blockScrolling++,(selectionEmpty||1==button)&&editor.selection.moveToPosition(pos),editor.$blockScrolling--,void(2==button&&(editor.textInput.onContextMenu(ev.domEvent),useragent.isMozilla||ev.preventDefault()))}return this.mousedownEvent.time=Date.now(),!inSelection||editor.isFocused()||(editor.focus(),!this.$focusTimout||this.$clickSelection||editor.inMultiSelectMode)?(this.captureMouse(ev),this.startSelect(pos,ev.domEvent._clicks>1),ev.preventDefault()):(this.setState("focusWait"),void this.captureMouse(ev))},this.startSelect=function(pos,waitForClickSelection){pos=pos||this.editor.renderer.screenToTextCoordinates(this.x,this.y);var editor=this.editor;editor.$blockScrolling++,this.mousedownEvent.getShiftKey()?editor.selection.selectToPosition(pos):waitForClickSelection||editor.selection.moveToPosition(pos),waitForClickSelection||this.select(),editor.renderer.scroller.setCapture&&editor.renderer.scroller.setCapture(),editor.setStyle("ace_selecting"),this.setState("select"),editor.$blockScrolling--},this.select=function(){var anchor,editor=this.editor,cursor=editor.renderer.screenToTextCoordinates(this.x,this.y);if(editor.$blockScrolling++,this.$clickSelection){var cmp=this.$clickSelection.comparePoint(cursor);if(-1==cmp)anchor=this.$clickSelection.end;else if(1==cmp)anchor=this.$clickSelection.start;else{var orientedRange=calcRangeOrientation(this.$clickSelection,cursor);cursor=orientedRange.cursor,anchor=orientedRange.anchor}editor.selection.setSelectionAnchor(anchor.row,anchor.column)}editor.selection.selectToPosition(cursor),editor.$blockScrolling--,editor.renderer.scrollCursorIntoView()},this.extendSelectionBy=function(unitName){var anchor,editor=this.editor,cursor=editor.renderer.screenToTextCoordinates(this.x,this.y),range=editor.selection[unitName](cursor.row,cursor.column);if(editor.$blockScrolling++,this.$clickSelection){var cmpStart=this.$clickSelection.comparePoint(range.start),cmpEnd=this.$clickSelection.comparePoint(range.end);if(-1==cmpStart&&cmpEnd<=0)anchor=this.$clickSelection.end,range.end.row==cursor.row&&range.end.column==cursor.column||(cursor=range.start);else if(1==cmpEnd&&cmpStart>=0)anchor=this.$clickSelection.start,range.start.row==cursor.row&&range.start.column==cursor.column||(cursor=range.end);else if(-1==cmpStart&&1==cmpEnd)cursor=range.end,anchor=range.start;else{var orientedRange=calcRangeOrientation(this.$clickSelection,cursor);cursor=orientedRange.cursor,anchor=orientedRange.anchor}editor.selection.setSelectionAnchor(anchor.row,anchor.column)}editor.selection.selectToPosition(cursor),editor.$blockScrolling--,editor.renderer.scrollCursorIntoView()},this.selectEnd=this.selectAllEnd=this.selectByWordsEnd=this.selectByLinesEnd=function(){this.$clickSelection=null,this.editor.unsetStyle("ace_selecting"),this.editor.renderer.scroller.releaseCapture&&this.editor.renderer.scroller.releaseCapture()},this.focusWait=function(){var ax,ay,bx,by,distance=(ax=this.mousedownEvent.x,ay=this.mousedownEvent.y,bx=this.x,by=this.y,Math.sqrt(Math.pow(bx-ax,2)+Math.pow(by-ay,2))),time=Date.now();(distance>0||time-this.mousedownEvent.time>this.$focusTimout)&&this.startSelect(this.mousedownEvent.getDocumentPosition())},this.onDoubleClick=function(ev){var pos=ev.getDocumentPosition(),editor=this.editor,range=editor.session.getBracketRange(pos);range?(range.isEmpty()&&(range.start.column--,range.end.column++),this.setState("select")):(range=editor.selection.getWordRange(pos.row,pos.column),this.setState("selectByWords")),this.$clickSelection=range,this.select()},this.onTripleClick=function(ev){var pos=ev.getDocumentPosition(),editor=this.editor;this.setState("selectByLines");var range=editor.getSelectionRange();range.isMultiLine()&&range.contains(pos.row,pos.column)?(this.$clickSelection=editor.selection.getLineRange(range.start.row),this.$clickSelection.end=editor.selection.getLineRange(range.end.row).end):this.$clickSelection=editor.selection.getLineRange(pos.row),this.select()},this.onQuadClick=function(ev){var editor=this.editor;editor.selectAll(),this.$clickSelection=editor.getSelectionRange(),this.setState("selectAll")},this.onMouseWheel=function(ev){if(!ev.getAccelKey()){ev.getShiftKey()&&ev.wheelY&&!ev.wheelX&&(ev.wheelX=ev.wheelY,ev.wheelY=0);var editor=this.editor;this.$lastScroll||(this.$lastScroll={t:0,vx:0,vy:0,allowed:0});var prevScroll=this.$lastScroll,t=ev.domEvent.timeStamp,dt=t-prevScroll.t,vx=ev.wheelX/dt,vy=ev.wheelY/dt;dt<250&&(vx=(vx+prevScroll.vx)/2,vy=(vy+prevScroll.vy)/2);var direction=Math.abs(vx/vy),canScroll=!1;if(direction>=1&&editor.renderer.isScrollableBy(ev.wheelX*ev.speed,0)&&(canScroll=!0),direction<=1&&editor.renderer.isScrollableBy(0,ev.wheelY*ev.speed)&&(canScroll=!0),canScroll)prevScroll.allowed=t;else if(t-prevScroll.allowed<250){Math.abs(vx)<=1.1*Math.abs(prevScroll.vx)&&Math.abs(vy)<=1.1*Math.abs(prevScroll.vy)?(canScroll=!0,prevScroll.allowed=t):prevScroll.allowed=0}return prevScroll.t=t,prevScroll.vx=vx,prevScroll.vy=vy,canScroll?(editor.renderer.scrollBy(ev.wheelX*ev.speed,ev.wheelY*ev.speed),ev.stop()):void 0}},this.onTouchMove=function(ev){this.editor._emit("mousewheel",ev)}}).call(DefaultHandlers.prototype),exports.DefaultHandlers=DefaultHandlers})),ace.define("ace/tooltip",["require","exports","module","ace/lib/oop","ace/lib/dom"],(function(acequire,exports,module){"use strict";acequire("./lib/oop");var dom=acequire("./lib/dom");function Tooltip(parentNode){this.isOpen=!1,this.$element=null,this.$parentNode=parentNode}(function(){this.$init=function(){return this.$element=dom.createElement("div"),this.$element.className="ace_tooltip",this.$element.style.display="none",this.$parentNode.appendChild(this.$element),this.$element},this.getElement=function(){return this.$element||this.$init()},this.setText=function(text){dom.setInnerText(this.getElement(),text)},this.setHtml=function(html){this.getElement().innerHTML=html},this.setPosition=function(x,y){this.getElement().style.left=x+"px",this.getElement().style.top=y+"px"},this.setClassName=function(className){dom.addCssClass(this.getElement(),className)},this.show=function(text,x,y){null!=text&&this.setText(text),null!=x&&null!=y&&this.setPosition(x,y),this.isOpen||(this.getElement().style.display="block",this.isOpen=!0)},this.hide=function(){this.isOpen&&(this.getElement().style.display="none",this.isOpen=!1)},this.getHeight=function(){return this.getElement().offsetHeight},this.getWidth=function(){return this.getElement().offsetWidth},this.destroy=function(){this.isOpen=!1,this.$element&&this.$element.parentNode&&this.$element.parentNode.removeChild(this.$element)}}).call(Tooltip.prototype),exports.Tooltip=Tooltip})),ace.define("ace/mouse/default_gutter_handler",["require","exports","module","ace/lib/dom","ace/lib/oop","ace/lib/event","ace/tooltip"],(function(acequire,exports,module){"use strict";var dom=acequire("../lib/dom"),oop=acequire("../lib/oop"),event=acequire("../lib/event"),Tooltip=acequire("../tooltip").Tooltip;function GutterTooltip(parentNode){Tooltip.call(this,parentNode)}oop.inherits(GutterTooltip,Tooltip),function(){this.setPosition=function(x,y){var windowWidth=window.innerWidth||document.documentElement.clientWidth,windowHeight=window.innerHeight||document.documentElement.clientHeight,width=this.getWidth(),height=this.getHeight();(x+=15)+width>windowWidth&&(x-=x+width-windowWidth),(y+=15)+height>windowHeight&&(y-=20+height),Tooltip.prototype.setPosition.call(this,x,y)}}.call(GutterTooltip.prototype),exports.GutterHandler=function(mouseHandler){var tooltipTimeout,mouseEvent,tooltipAnnotation,editor=mouseHandler.editor,gutter=editor.renderer.$gutterLayer,tooltip=new GutterTooltip(editor.container);function hideTooltip(){tooltipTimeout&&(tooltipTimeout=clearTimeout(tooltipTimeout)),tooltipAnnotation&&(tooltip.hide(),tooltipAnnotation=null,editor._signal("hideGutterTooltip",tooltip),editor.removeEventListener("mousewheel",hideTooltip))}function moveTooltip(e){tooltip.setPosition(e.x,e.y)}mouseHandler.editor.setDefaultHandler("guttermousedown",(function(e){if(editor.isFocused()&&0==e.getButton()&&"foldWidgets"!=gutter.getRegion(e)){var row=e.getDocumentPosition().row,selection=editor.session.selection;if(e.getShiftKey())selection.selectTo(row,0);else{if(2==e.domEvent.detail)return editor.selectAll(),e.preventDefault();mouseHandler.$clickSelection=editor.selection.getLineRange(row)}return mouseHandler.setState("selectByLines"),mouseHandler.captureMouse(e),e.preventDefault()}})),mouseHandler.editor.setDefaultHandler("guttermousemove",(function(e){var target=e.domEvent.target||e.domEvent.srcElement;if(dom.hasCssClass(target,"ace_fold-widget"))return hideTooltip();tooltipAnnotation&&mouseHandler.$tooltipFollowsMouse&&moveTooltip(e),mouseEvent=e,tooltipTimeout||(tooltipTimeout=setTimeout((function(){tooltipTimeout=null,mouseEvent&&!mouseHandler.isMousePressed?function(){var row=mouseEvent.getDocumentPosition().row,annotation=gutter.$annotations[row];if(!annotation)return hideTooltip();if(row==editor.session.getLength()){var screenRow=editor.renderer.pixelToScreenCoordinates(0,mouseEvent.y).row,pos=mouseEvent.$pos;if(screenRow>editor.session.documentToScreenRow(pos.row,pos.column))return hideTooltip()}if(tooltipAnnotation!=annotation)if(tooltipAnnotation=annotation.text.join("<br/>"),tooltip.setHtml(tooltipAnnotation),tooltip.show(),editor._signal("showGutterTooltip",tooltip),editor.on("mousewheel",hideTooltip),mouseHandler.$tooltipFollowsMouse)moveTooltip(mouseEvent);else{var rect=mouseEvent.domEvent.target.getBoundingClientRect(),style=tooltip.getElement().style;style.left=rect.right+"px",style.top=rect.bottom+"px"}}():hideTooltip()}),50))})),event.addListener(editor.renderer.$gutter,"mouseout",(function(e){mouseEvent=null,tooltipAnnotation&&!tooltipTimeout&&(tooltipTimeout=setTimeout((function(){tooltipTimeout=null,hideTooltip()}),50))})),editor.on("changeSession",hideTooltip)}})),ace.define("ace/mouse/mouse_event",["require","exports","module","ace/lib/event","ace/lib/useragent"],(function(acequire,exports,module){"use strict";var event=acequire("../lib/event"),useragent=acequire("../lib/useragent"),MouseEvent=exports.MouseEvent=function(domEvent,editor){this.domEvent=domEvent,this.editor=editor,this.x=this.clientX=domEvent.clientX,this.y=this.clientY=domEvent.clientY,this.$pos=null,this.$inSelection=null,this.propagationStopped=!1,this.defaultPrevented=!1};(function(){this.stopPropagation=function(){event.stopPropagation(this.domEvent),this.propagationStopped=!0},this.preventDefault=function(){event.preventDefault(this.domEvent),this.defaultPrevented=!0},this.stop=function(){this.stopPropagation(),this.preventDefault()},this.getDocumentPosition=function(){return this.$pos||(this.$pos=this.editor.renderer.screenToTextCoordinates(this.clientX,this.clientY)),this.$pos},this.inSelection=function(){if(null!==this.$inSelection)return this.$inSelection;var selectionRange=this.editor.getSelectionRange();if(selectionRange.isEmpty())this.$inSelection=!1;else{var pos=this.getDocumentPosition();this.$inSelection=selectionRange.contains(pos.row,pos.column)}return this.$inSelection},this.getButton=function(){return event.getButton(this.domEvent)},this.getShiftKey=function(){return this.domEvent.shiftKey},this.getAccelKey=useragent.isMac?function(){return this.domEvent.metaKey}:function(){return this.domEvent.ctrlKey}}).call(MouseEvent.prototype)})),ace.define("ace/mouse/dragdrop_handler",["require","exports","module","ace/lib/dom","ace/lib/event","ace/lib/useragent"],(function(acequire,exports,module){"use strict";var dom=acequire("../lib/dom"),event=acequire("../lib/event"),useragent=acequire("../lib/useragent");function DragdropHandler(mouseHandler){var editor=mouseHandler.editor,blankImage=dom.createElement("img");blankImage.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",useragent.isOpera&&(blankImage.style.cssText="width:1px;height:1px;position:fixed;top:0;left:0;z-index:2147483647;opacity:0;");["dragWait","dragWaitEnd","startDrag","dragReadyEnd","onMouseDrag"].forEach((function(x){mouseHandler[x]=this[x]}),this),editor.addEventListener("mousedown",this.onMouseDown.bind(mouseHandler));var dragSelectionMarker,x,y,timerId,range,dragCursor,dragOperation,isInternal,autoScrollStartTime,cursorMovedTime,cursorPointOnCaretMoved,mouseTarget=editor.container,counter=0;function onDragInterval(){var prevCursor=dragCursor;(function(cursor,prevCursor){var now=Date.now(),vMovement=!prevCursor||cursor.row!=prevCursor.row,hMovement=!prevCursor||cursor.column!=prevCursor.column;!cursorMovedTime||vMovement||hMovement?(editor.$blockScrolling+=1,editor.moveCursorToPosition(cursor),editor.$blockScrolling-=1,cursorMovedTime=now,cursorPointOnCaretMoved={x:x,y:y}):calcDistance(cursorPointOnCaretMoved.x,cursorPointOnCaretMoved.y,x,y)>5?cursorMovedTime=null:now-cursorMovedTime>=200&&(editor.renderer.scrollCursorIntoView(),cursorMovedTime=null)})(dragCursor=editor.renderer.screenToTextCoordinates(x,y),prevCursor),function(cursor,prevCursor){var now=Date.now(),lineHeight=editor.renderer.layerConfig.lineHeight,characterWidth=editor.renderer.layerConfig.characterWidth,editorRect=editor.renderer.scroller.getBoundingClientRect(),offsets={x:{left:x-editorRect.left,right:editorRect.right-x},y:{top:y-editorRect.top,bottom:editorRect.bottom-y}},nearestXOffset=Math.min(offsets.x.left,offsets.x.right),nearestYOffset=Math.min(offsets.y.top,offsets.y.bottom),scrollCursor={row:cursor.row,column:cursor.column};nearestXOffset/characterWidth<=2&&(scrollCursor.column+=offsets.x.left<offsets.x.right?-3:2),nearestYOffset/lineHeight<=1&&(scrollCursor.row+=offsets.y.top<offsets.y.bottom?-1:1);var vScroll=cursor.row!=scrollCursor.row,hScroll=cursor.column!=scrollCursor.column,vMovement=!prevCursor||cursor.row!=prevCursor.row;vScroll||hScroll&&!vMovement?autoScrollStartTime?now-autoScrollStartTime>=200&&editor.renderer.scrollCursorIntoView(scrollCursor):autoScrollStartTime=now:autoScrollStartTime=null}(dragCursor,prevCursor)}function addDragMarker(){range=editor.selection.toOrientedRange(),dragSelectionMarker=editor.session.addMarker(range,"ace_selection",editor.getSelectionStyle()),editor.clearSelection(),editor.isFocused()&&editor.renderer.$cursorLayer.setBlinking(!1),clearInterval(timerId),onDragInterval(),timerId=setInterval(onDragInterval,20),counter=0,event.addListener(document,"mousemove",onMouseMove)}function clearDragMarker(){clearInterval(timerId),editor.session.removeMarker(dragSelectionMarker),dragSelectionMarker=null,editor.$blockScrolling+=1,editor.selection.fromOrientedRange(range),editor.$blockScrolling-=1,editor.isFocused()&&!isInternal&&editor.renderer.$cursorLayer.setBlinking(!editor.getReadOnly()),range=null,dragCursor=null,counter=0,autoScrollStartTime=null,cursorMovedTime=null,event.removeListener(document,"mousemove",onMouseMove)}this.onDragStart=function(e){if(this.cancelDrag||!mouseTarget.draggable){var self=this;return setTimeout((function(){self.startSelect(),self.captureMouse(e)}),0),e.preventDefault()}range=editor.getSelectionRange();var dataTransfer=e.dataTransfer;dataTransfer.effectAllowed=editor.getReadOnly()?"copy":"copyMove",useragent.isOpera&&(editor.container.appendChild(blankImage),blankImage.scrollTop=0),dataTransfer.setDragImage&&dataTransfer.setDragImage(blankImage,0,0),useragent.isOpera&&editor.container.removeChild(blankImage),dataTransfer.clearData(),dataTransfer.setData("Text",editor.session.getTextRange()),isInternal=!0,this.setState("drag")},this.onDragEnd=function(e){if(mouseTarget.draggable=!1,isInternal=!1,this.setState(null),!editor.getReadOnly()){var dropEffect=e.dataTransfer.dropEffect;dragOperation||"move"!=dropEffect||editor.session.remove(editor.getSelectionRange()),editor.renderer.$cursorLayer.setBlinking(!0)}this.editor.unsetStyle("ace_dragging"),this.editor.renderer.setCursorStyle("")},this.onDragEnter=function(e){if(!editor.getReadOnly()&&canAccept(e.dataTransfer))return x=e.clientX,y=e.clientY,dragSelectionMarker||addDragMarker(),counter++,e.dataTransfer.dropEffect=dragOperation=getDropEffect(e),event.preventDefault(e)},this.onDragOver=function(e){if(!editor.getReadOnly()&&canAccept(e.dataTransfer))return x=e.clientX,y=e.clientY,dragSelectionMarker||(addDragMarker(),counter++),null!==onMouseMoveTimer&&(onMouseMoveTimer=null),e.dataTransfer.dropEffect=dragOperation=getDropEffect(e),event.preventDefault(e)},this.onDragLeave=function(e){if(--counter<=0&&dragSelectionMarker)return clearDragMarker(),dragOperation=null,event.preventDefault(e)},this.onDrop=function(e){if(dragCursor){var dataTransfer=e.dataTransfer;if(isInternal)switch(dragOperation){case"move":range=range.contains(dragCursor.row,dragCursor.column)?{start:dragCursor,end:dragCursor}:editor.moveText(range,dragCursor);break;case"copy":range=editor.moveText(range,dragCursor,!0)}else{var dropData=dataTransfer.getData("Text");range={start:dragCursor,end:editor.session.insert(dragCursor,dropData)},editor.focus(),dragOperation=null}return clearDragMarker(),event.preventDefault(e)}},event.addListener(mouseTarget,"dragstart",this.onDragStart.bind(mouseHandler)),event.addListener(mouseTarget,"dragend",this.onDragEnd.bind(mouseHandler)),event.addListener(mouseTarget,"dragenter",this.onDragEnter.bind(mouseHandler)),event.addListener(mouseTarget,"dragover",this.onDragOver.bind(mouseHandler)),event.addListener(mouseTarget,"dragleave",this.onDragLeave.bind(mouseHandler)),event.addListener(mouseTarget,"drop",this.onDrop.bind(mouseHandler));var onMouseMoveTimer=null;function onMouseMove(){null==onMouseMoveTimer&&(onMouseMoveTimer=setTimeout((function(){null!=onMouseMoveTimer&&dragSelectionMarker&&clearDragMarker()}),20))}function canAccept(dataTransfer){var types=dataTransfer.types;return!types||Array.prototype.some.call(types,(function(type){return"text/plain"==type||"Text"==type}))}function getDropEffect(e){var copyAllowed=["copy","copymove","all","uninitialized"],copyModifierState=useragent.isMac?e.altKey:e.ctrlKey,effectAllowed="uninitialized";try{effectAllowed=e.dataTransfer.effectAllowed.toLowerCase()}catch(e){}var dropEffect="none";return copyModifierState&&copyAllowed.indexOf(effectAllowed)>=0?dropEffect="copy":["move","copymove","linkmove","all","uninitialized"].indexOf(effectAllowed)>=0?dropEffect="move":copyAllowed.indexOf(effectAllowed)>=0&&(dropEffect="copy"),dropEffect}}function calcDistance(ax,ay,bx,by){return Math.sqrt(Math.pow(bx-ax,2)+Math.pow(by-ay,2))}(function(){this.dragWait=function(){Date.now()-this.mousedownEvent.time>this.editor.getDragDelay()&&this.startDrag()},this.dragWaitEnd=function(){this.editor.container.draggable=!1,this.startSelect(this.mousedownEvent.getDocumentPosition()),this.selectEnd()},this.dragReadyEnd=function(e){this.editor.renderer.$cursorLayer.setBlinking(!this.editor.getReadOnly()),this.editor.unsetStyle("ace_dragging"),this.editor.renderer.setCursorStyle(""),this.dragWaitEnd()},this.startDrag=function(){this.cancelDrag=!1;var editor=this.editor;editor.container.draggable=!0,editor.renderer.$cursorLayer.setBlinking(!1),editor.setStyle("ace_dragging");var cursorStyle=useragent.isWin?"default":"move";editor.renderer.setCursorStyle(cursorStyle),this.setState("dragReady")},this.onMouseDrag=function(e){var target=this.editor.container;useragent.isIE&&"dragReady"==this.state&&(calcDistance(this.mousedownEvent.x,this.mousedownEvent.y,this.x,this.y)>3&&target.dragDrop());"dragWait"===this.state&&(calcDistance(this.mousedownEvent.x,this.mousedownEvent.y,this.x,this.y)>0&&(target.draggable=!1,this.startSelect(this.mousedownEvent.getDocumentPosition())))},this.onMouseDown=function(e){if(this.$dragEnabled){this.mousedownEvent=e;var editor=this.editor,inSelection=e.inSelection(),button=e.getButton();if(1===(e.domEvent.detail||1)&&0===button&&inSelection){if(e.editor.inMultiSelectMode&&(e.getAccelKey()||e.getShiftKey()))return;this.mousedownEvent.time=Date.now();var eventTarget=e.domEvent.target||e.domEvent.srcElement;if("unselectable"in eventTarget&&(eventTarget.unselectable="on"),editor.getDragDelay()){if(useragent.isWebKit)this.cancelDrag=!0,editor.container.draggable=!0;this.setState("dragWait")}else this.startDrag();this.captureMouse(e,this.onMouseDrag.bind(this)),e.defaultPrevented=!0}}}}).call(DragdropHandler.prototype),exports.DragdropHandler=DragdropHandler})),ace.define("ace/lib/net",["require","exports","module","ace/lib/dom"],(function(acequire,exports,module){"use strict";var dom=acequire("./dom");exports.get=function(url,callback){var xhr=new XMLHttpRequest;xhr.open("GET",url,!0),xhr.onreadystatechange=function(){4===xhr.readyState&&callback(xhr.responseText)},xhr.send(null)},exports.loadScript=function(path,callback){var head=dom.getDocumentHead(),s=document.createElement("script");s.src=path,head.appendChild(s),s.onload=s.onreadystatechange=function(_,isAbort){!isAbort&&s.readyState&&"loaded"!=s.readyState&&"complete"!=s.readyState||(s=s.onload=s.onreadystatechange=null,isAbort||callback())}},exports.qualifyURL=function(url){var a=document.createElement("a");return a.href=url,a.href}})),ace.define("ace/lib/event_emitter",["require","exports","module"],(function(acequire,exports,module){"use strict";var EventEmitter={},stopPropagation=function(){this.propagationStopped=!0},preventDefault=function(){this.defaultPrevented=!0};EventEmitter._emit=EventEmitter._dispatchEvent=function(eventName,e){this._eventRegistry||(this._eventRegistry={}),this._defaultHandlers||(this._defaultHandlers={});var listeners=this._eventRegistry[eventName]||[],defaultHandler=this._defaultHandlers[eventName];if(listeners.length||defaultHandler){"object"==typeof e&&e||(e={}),e.type||(e.type=eventName),e.stopPropagation||(e.stopPropagation=stopPropagation),e.preventDefault||(e.preventDefault=preventDefault),listeners=listeners.slice();for(var i=0;i<listeners.length&&(listeners[i](e,this),!e.propagationStopped);i++);return defaultHandler&&!e.defaultPrevented?defaultHandler(e,this):void 0}},EventEmitter._signal=function(eventName,e){var listeners=(this._eventRegistry||{})[eventName];if(listeners){listeners=listeners.slice();for(var i=0;i<listeners.length;i++)listeners[i](e,this)}},EventEmitter.once=function(eventName,callback){var _self=this;callback&&this.addEventListener(eventName,(function newCallback(){_self.removeEventListener(eventName,newCallback),callback.apply(null,arguments)}))},EventEmitter.setDefaultHandler=function(eventName,callback){var handlers=this._defaultHandlers;if(handlers||(handlers=this._defaultHandlers={_disabled_:{}}),handlers[eventName]){var old=handlers[eventName],disabled=handlers._disabled_[eventName];disabled||(handlers._disabled_[eventName]=disabled=[]),disabled.push(old);var i=disabled.indexOf(callback);-1!=i&&disabled.splice(i,1)}handlers[eventName]=callback},EventEmitter.removeDefaultHandler=function(eventName,callback){var handlers=this._defaultHandlers;if(handlers){var disabled=handlers._disabled_[eventName];if(handlers[eventName]==callback){handlers[eventName];disabled&&this.setDefaultHandler(eventName,disabled.pop())}else if(disabled){var i=disabled.indexOf(callback);-1!=i&&disabled.splice(i,1)}}},EventEmitter.on=EventEmitter.addEventListener=function(eventName,callback,capturing){this._eventRegistry=this._eventRegistry||{};var listeners=this._eventRegistry[eventName];return listeners||(listeners=this._eventRegistry[eventName]=[]),-1==listeners.indexOf(callback)&&listeners[capturing?"unshift":"push"](callback),callback},EventEmitter.off=EventEmitter.removeListener=EventEmitter.removeEventListener=function(eventName,callback){this._eventRegistry=this._eventRegistry||{};var listeners=this._eventRegistry[eventName];if(listeners){var index=listeners.indexOf(callback);-1!==index&&listeners.splice(index,1)}},EventEmitter.removeAllListeners=function(eventName){this._eventRegistry&&(this._eventRegistry[eventName]=[])},exports.EventEmitter=EventEmitter})),ace.define("ace/lib/app_config",["require","exports","module","ace/lib/oop","ace/lib/event_emitter"],(function(acequire,exports,module){var oop=acequire("./oop"),EventEmitter=acequire("./event_emitter").EventEmitter,optionsProvider={setOptions:function(optList){Object.keys(optList).forEach((function(key){this.setOption(key,optList[key])}),this)},getOptions:function(optionNames){var result={};return optionNames?Array.isArray(optionNames)||(result=optionNames,optionNames=Object.keys(result)):optionNames=Object.keys(this.$options),optionNames.forEach((function(key){result[key]=this.getOption(key)}),this),result},setOption:function(name,value){if(this["$"+name]!==value){var opt=this.$options[name];if(!opt)return warn('misspelled option "'+name+'"');if(opt.forwardTo)return this[opt.forwardTo]&&this[opt.forwardTo].setOption(name,value);opt.handlesSet||(this["$"+name]=value),opt&&opt.set&&opt.set.call(this,value)}},getOption:function(name){var opt=this.$options[name];return opt?opt.forwardTo?this[opt.forwardTo]&&this[opt.forwardTo].getOption(name):opt&&opt.get?opt.get.call(this):this["$"+name]:warn('misspelled option "'+name+'"')}};function warn(message){"undefined"!=typeof console&&console.warn&&console.warn.apply(console,arguments)}function reportError(msg,data){var e=new Error(msg);e.data=data,"object"==typeof console&&console.error&&console.error(e),setTimeout((function(){throw e}))}var AppConfig=function(){this.$defaultOptions={}};(function(){oop.implement(this,EventEmitter),this.defineOptions=function(obj,path,options){return obj.$options||(this.$defaultOptions[path]=obj.$options={}),Object.keys(options).forEach((function(key){var opt=options[key];"string"==typeof opt&&(opt={forwardTo:opt}),opt.name||(opt.name=key),obj.$options[opt.name]=opt,"initialValue"in opt&&(obj["$"+opt.name]=opt.initialValue)})),oop.implement(obj,optionsProvider),this},this.resetOptions=function(obj){Object.keys(obj.$options).forEach((function(key){var opt=obj.$options[key];"value"in opt&&obj.setOption(key,opt.value)}))},this.setDefaultValue=function(path,name,value){var opts=this.$defaultOptions[path]||(this.$defaultOptions[path]={});opts[name]&&(opts.forwardTo?this.setDefaultValue(opts.forwardTo,name,value):opts[name].value=value)},this.setDefaultValues=function(path,optionHash){Object.keys(optionHash).forEach((function(key){this.setDefaultValue(path,key,optionHash[key])}),this)},this.warn=warn,this.reportError=reportError}).call(AppConfig.prototype),exports.AppConfig=AppConfig})),ace.define("ace/config",["require","exports","module","ace/lib/lang","ace/lib/oop","ace/lib/net","ace/lib/app_config"],(function(acequire,exports,module){var lang=acequire("./lib/lang"),net=(acequire("./lib/oop"),acequire("./lib/net")),AppConfig=acequire("./lib/app_config").AppConfig;module.exports=exports=new AppConfig;var global=function(){return this||"undefined"!=typeof window&&window}(),options={packaged:!1,workerPath:null,modePath:null,themePath:null,basePath:"",suffix:".js",$moduleUrls:{}};function init(packaged){if(global&&global.document){options.packaged=packaged||acequire.packaged||module.packaged||global.define&&__webpack_require__(316).packaged;for(var str,scriptOptions={},scriptUrl="",currentScript=document.currentScript||document._currentScript,scripts=(currentScript&&currentScript.ownerDocument||document).getElementsByTagName("script"),i=0;i<scripts.length;i++){var script=scripts[i],src=script.src||script.getAttribute("src");if(src){for(var attributes=script.attributes,j=0,l=attributes.length;j<l;j++){var attr=attributes[j];0===attr.name.indexOf("data-ace-")&&(scriptOptions[(str=attr.name.replace(/^data-ace-/,""),str.replace(/-(.)/g,(function(m,m1){return m1.toUpperCase()})))]=attr.value)}var m=src.match(/^(.*)\/ace(\-\w+)?\.js(\?|$)/);m&&(scriptUrl=m[1])}}for(var key in scriptUrl&&(scriptOptions.base=scriptOptions.base||scriptUrl,scriptOptions.packaged=!0),scriptOptions.basePath=scriptOptions.base,scriptOptions.workerPath=scriptOptions.workerPath||scriptOptions.base,scriptOptions.modePath=scriptOptions.modePath||scriptOptions.base,scriptOptions.themePath=scriptOptions.themePath||scriptOptions.base,delete scriptOptions.base,scriptOptions)void 0!==scriptOptions[key]&&exports.set(key,scriptOptions[key])}}exports.get=function(key){if(!options.hasOwnProperty(key))throw new Error("Unknown config key: "+key);return options[key]},exports.set=function(key,value){if(!options.hasOwnProperty(key))throw new Error("Unknown config key: "+key);options[key]=value},exports.all=function(){return lang.copyObject(options)},exports.moduleUrl=function(name,component){if(options.$moduleUrls[name])return options.$moduleUrls[name];var parts=name.split("/"),sep="snippets"==(component=component||parts[parts.length-2]||"")?"/":"-",base=parts[parts.length-1];if("worker"==component&&"-"==sep){var re=new RegExp("^"+component+"[\\-_]|[\\-_]"+component+"$","g");base=base.replace(re,"")}(!base||base==component)&&parts.length>1&&(base=parts[parts.length-2]);var path=options[component+"Path"];return null==path?path=options.basePath:"/"==sep&&(component=sep=""),path&&"/"!=path.slice(-1)&&(path+="/"),path+component+sep+base+this.get("suffix")},exports.setModuleUrl=function(name,subst){return options.$moduleUrls[name]=subst},exports.$loading={},exports.loadModule=function(moduleName,onLoad){var module,moduleType;Array.isArray(moduleName)&&(moduleType=moduleName[0],moduleName=moduleName[1]);try{module=acequire(moduleName)}catch(e){}if(module&&!exports.$loading[moduleName])return onLoad&&onLoad(module);if(exports.$loading[moduleName]||(exports.$loading[moduleName]=[]),exports.$loading[moduleName].push(onLoad),!(exports.$loading[moduleName].length>1)){var afterLoad=function(){acequire([moduleName],(function(module){exports._emit("load.module",{name:moduleName,module:module});var listeners=exports.$loading[moduleName];exports.$loading[moduleName]=null,listeners.forEach((function(onLoad){onLoad&&onLoad(module)}))}))};if(!exports.get("packaged"))return afterLoad();net.loadScript(exports.moduleUrl(moduleName,moduleType),afterLoad)}},init(!0),exports.init=init})),ace.define("ace/mouse/mouse_handler",["require","exports","module","ace/lib/event","ace/lib/useragent","ace/mouse/default_handlers","ace/mouse/default_gutter_handler","ace/mouse/mouse_event","ace/mouse/dragdrop_handler","ace/config"],(function(acequire,exports,module){"use strict";var event=acequire("../lib/event"),useragent=acequire("../lib/useragent"),DefaultHandlers=acequire("./default_handlers").DefaultHandlers,DefaultGutterHandler=acequire("./default_gutter_handler").GutterHandler,MouseEvent=acequire("./mouse_event").MouseEvent,DragdropHandler=acequire("./dragdrop_handler").DragdropHandler,config=acequire("../config"),MouseHandler=function(editor){var _self=this;this.editor=editor,new DefaultHandlers(this),new DefaultGutterHandler(this),new DragdropHandler(this);var focusEditor=function(e){(!document.hasFocus||!document.hasFocus()||!editor.isFocused()&&document.activeElement==(editor.textInput&&editor.textInput.getElement()))&&window.focus(),editor.focus()},mouseTarget=editor.renderer.getMouseEventTarget();event.addListener(mouseTarget,"click",this.onMouseEvent.bind(this,"click")),event.addListener(mouseTarget,"mousemove",this.onMouseMove.bind(this,"mousemove")),event.addMultiMouseDownListener([mouseTarget,editor.renderer.scrollBarV&&editor.renderer.scrollBarV.inner,editor.renderer.scrollBarH&&editor.renderer.scrollBarH.inner,editor.textInput&&editor.textInput.getElement()].filter(Boolean),[400,300,250],this,"onMouseEvent"),event.addMouseWheelListener(editor.container,this.onMouseWheel.bind(this,"mousewheel")),event.addTouchMoveListener(editor.container,this.onTouchMove.bind(this,"touchmove"));var gutterEl=editor.renderer.$gutter;event.addListener(gutterEl,"mousedown",this.onMouseEvent.bind(this,"guttermousedown")),event.addListener(gutterEl,"click",this.onMouseEvent.bind(this,"gutterclick")),event.addListener(gutterEl,"dblclick",this.onMouseEvent.bind(this,"gutterdblclick")),event.addListener(gutterEl,"mousemove",this.onMouseEvent.bind(this,"guttermousemove")),event.addListener(mouseTarget,"mousedown",focusEditor),event.addListener(gutterEl,"mousedown",focusEditor),useragent.isIE&&editor.renderer.scrollBarV&&(event.addListener(editor.renderer.scrollBarV.element,"mousedown",focusEditor),event.addListener(editor.renderer.scrollBarH.element,"mousedown",focusEditor)),editor.on("mousemove",(function(e){if(!_self.state&&!_self.$dragDelay&&_self.$dragEnabled){var character=editor.renderer.screenToTextCoordinates(e.x,e.y),range=editor.session.selection.getRange(),renderer=editor.renderer;!range.isEmpty()&&range.insideStart(character.row,character.column)?renderer.setCursorStyle("default"):renderer.setCursorStyle("")}}))};(function(){this.onMouseEvent=function(name,e){this.editor._emit(name,new MouseEvent(e,this.editor))},this.onMouseMove=function(name,e){var listeners=this.editor._eventRegistry&&this.editor._eventRegistry.mousemove;listeners&&listeners.length&&this.editor._emit(name,new MouseEvent(e,this.editor))},this.onMouseWheel=function(name,e){var mouseEvent=new MouseEvent(e,this.editor);mouseEvent.speed=2*this.$scrollSpeed,mouseEvent.wheelX=e.wheelX,mouseEvent.wheelY=e.wheelY,this.editor._emit(name,mouseEvent)},this.onTouchMove=function(name,e){var mouseEvent=new MouseEvent(e,this.editor);mouseEvent.speed=1,mouseEvent.wheelX=e.wheelX,mouseEvent.wheelY=e.wheelY,this.editor._emit(name,mouseEvent)},this.setState=function(state){this.state=state},this.captureMouse=function(ev,mouseMoveHandler){this.x=ev.x,this.y=ev.y,this.isMousePressed=!0;var renderer=this.editor.renderer;renderer.$keepTextAreaAtCursor&&(renderer.$keepTextAreaAtCursor=null);var self=this,onMouseMove=function(e){if(e){if(useragent.isWebKit&&!e.which&&self.releaseMouse)return self.releaseMouse();self.x=e.clientX,self.y=e.clientY,mouseMoveHandler&&mouseMoveHandler(e),self.mouseEvent=new MouseEvent(e,self.editor),self.$mouseMoved=!0}},onCaptureEnd=function(e){clearInterval(timerId),onCaptureInterval(),self[self.state+"End"]&&self[self.state+"End"](e),self.state="",null==renderer.$keepTextAreaAtCursor&&(renderer.$keepTextAreaAtCursor=!0,renderer.$moveTextAreaToCursor()),self.isMousePressed=!1,self.$onCaptureMouseMove=self.releaseMouse=null,e&&self.onMouseEvent("mouseup",e)},onCaptureInterval=function(){self[self.state]&&self[self.state](),self.$mouseMoved=!1};if(useragent.isOldIE&&"dblclick"==ev.domEvent.type)return setTimeout((function(){onCaptureEnd(ev)}));self.$onCaptureMouseMove=onMouseMove,self.releaseMouse=event.capture(this.editor.container,onMouseMove,onCaptureEnd);var timerId=setInterval(onCaptureInterval,20)},this.releaseMouse=null,this.cancelContextMenu=function(){var stop=function(e){e&&e.domEvent&&"contextmenu"!=e.domEvent.type||(this.editor.off("nativecontextmenu",stop),e&&e.domEvent&&event.stopEvent(e.domEvent))}.bind(this);setTimeout(stop,10),this.editor.on("nativecontextmenu",stop)}}).call(MouseHandler.prototype),config.defineOptions(MouseHandler.prototype,"mouseHandler",{scrollSpeed:{initialValue:2},dragDelay:{initialValue:useragent.isMac?150:0},dragEnabled:{initialValue:!0},focusTimout:{initialValue:0},tooltipFollowsMouse:{initialValue:!0}}),exports.MouseHandler=MouseHandler})),ace.define("ace/mouse/fold_handler",["require","exports","module"],(function(acequire,exports,module){"use strict";exports.FoldHandler=function(editor){editor.on("click",(function(e){var position=e.getDocumentPosition(),session=editor.session,fold=session.getFoldAt(position.row,position.column,1);fold&&(e.getAccelKey()?session.removeFold(fold):session.expandFold(fold),e.stop())})),editor.on("gutterclick",(function(e){if("foldWidgets"==editor.renderer.$gutterLayer.getRegion(e)){var row=e.getDocumentPosition().row,session=editor.session;session.foldWidgets&&session.foldWidgets[row]&&editor.session.onFoldWidgetClick(row,e),editor.isFocused()||editor.focus(),e.stop()}})),editor.on("gutterdblclick",(function(e){if("foldWidgets"==editor.renderer.$gutterLayer.getRegion(e)){var row=e.getDocumentPosition().row,session=editor.session,data=session.getParentFoldRangeData(row,!0),range=data.range||data.firstRange;if(range){row=range.start.row;var fold=session.getFoldAt(row,session.getLine(row).length,1);fold?session.removeFold(fold):(session.addFold("...",range),editor.renderer.scrollCursorIntoView({row:range.start.row,column:0}))}e.stop()}}))}})),ace.define("ace/keyboard/keybinding",["require","exports","module","ace/lib/keys","ace/lib/event"],(function(acequire,exports,module){"use strict";var keyUtil=acequire("../lib/keys"),event=acequire("../lib/event"),KeyBinding=function(editor){this.$editor=editor,this.$data={editor:editor},this.$handlers=[],this.setDefaultHandler(editor.commands)};(function(){this.setDefaultHandler=function(kb){this.removeKeyboardHandler(this.$defaultHandler),this.$defaultHandler=kb,this.addKeyboardHandler(kb,0)},this.setKeyboardHandler=function(kb){var h=this.$handlers;if(h[h.length-1]!=kb){for(;h[h.length-1]&&h[h.length-1]!=this.$defaultHandler;)this.removeKeyboardHandler(h[h.length-1]);this.addKeyboardHandler(kb,1)}},this.addKeyboardHandler=function(kb,pos){if(kb){"function"!=typeof kb||kb.handleKeyboard||(kb.handleKeyboard=kb);var i=this.$handlers.indexOf(kb);-1!=i&&this.$handlers.splice(i,1),null==pos?this.$handlers.push(kb):this.$handlers.splice(pos,0,kb),-1==i&&kb.attach&&kb.attach(this.$editor)}},this.removeKeyboardHandler=function(kb){var i=this.$handlers.indexOf(kb);return-1!=i&&(this.$handlers.splice(i,1),kb.detach&&kb.detach(this.$editor),!0)},this.getKeyboardHandler=function(){return this.$handlers[this.$handlers.length-1]},this.getStatusText=function(){var data=this.$data,editor=data.editor;return this.$handlers.map((function(h){return h.getStatusText&&h.getStatusText(editor,data)||""})).filter(Boolean).join(" ")},this.$callKeyboardHandlers=function(hashId,keyString,keyCode,e){for(var toExecute,success=!1,commands=this.$editor.commands,i=this.$handlers.length;i--&&!((toExecute=this.$handlers[i].handleKeyboard(this.$data,hashId,keyString,keyCode,e))&&toExecute.command&&((success="null"==toExecute.command||commands.exec(toExecute.command,this.$editor,toExecute.args,e))&&e&&-1!=hashId&&1!=toExecute.passEvent&&1!=toExecute.command.passEvent&&event.stopEvent(e),success)););return success||-1!=hashId||(toExecute={command:"insertstring"},success=commands.exec("insertstring",this.$editor,keyString)),success&&this.$editor._signal&&this.$editor._signal("keyboardActivity",toExecute),success},this.onCommandKey=function(e,hashId,keyCode){var keyString=keyUtil.keyCodeToString(keyCode);this.$callKeyboardHandlers(hashId,keyString,keyCode,e)},this.onTextInput=function(text){this.$callKeyboardHandlers(-1,text)}}).call(KeyBinding.prototype),exports.KeyBinding=KeyBinding})),ace.define("ace/lib/bidiutil",["require","exports","module"],(function(acequire,exports,module){"use strict";var dir=0,hiLevel=0,lastArabic=!1,hasUBAT_B=!1,hasUBAT_S=!1,impTab_LTR=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],impTab_RTL=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],UnicodeTBL00=[18,18,18,18,18,18,18,18,18,6,5,6,8,5,18,18,18,18,18,18,18,18,18,18,18,18,18,18,5,5,5,6,8,4,4,11,11,11,4,4,4,4,4,10,9,10,9,9,2,2,2,2,2,2,2,2,2,2,9,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,18,18,18,18,18,18,5,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,9,4,11,11,11,11,4,4,4,4,0,4,4,18,4,4,11,11,2,2,4,0,4,4,4,2,0,4,4,4,4,4],UnicodeTBL20=[8,8,8,8,8,8,8,8,8,8,8,18,18,18,0,1,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,8,5,13,14,15,16,17,9,11,11,11,11,11,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,9,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,8];function _invertLevel(lev,levels,_array){if(!(hiLevel<lev))if(1!=lev||1!=dir||hasUBAT_B)for(var end,lo,hi,tmp,len=_array.length,start=0;start<len;){if(levels[start]>=lev){for(end=start+1;end<len&&levels[end]>=lev;)end++;for(lo=start,hi=end-1;lo<hi;lo++,hi--)tmp=_array[lo],_array[lo]=_array[hi],_array[hi]=tmp;start=end}start++}else _array.reverse()}function _getCharClass(chars,types,classes,ix){var wType,nType,len,i,cType=types[ix];switch(cType){case 0:case 1:lastArabic=!1;case 4:case 3:return cType;case 2:return lastArabic?3:2;case 7:return lastArabic=!0,!0,1;case 8:return 4;case 9:return ix<1||ix+1>=types.length||2!=(wType=classes[ix-1])&&3!=wType||2!=(nType=types[ix+1])&&3!=nType?4:(lastArabic&&(nType=3),nType==wType?nType:4);case 10:return 2==(wType=ix>0?classes[ix-1]:5)&&ix+1<types.length&&2==types[ix+1]?2:4;case 11:if(ix>0&&2==classes[ix-1])return 2;if(lastArabic)return 4;for(i=ix+1,len=types.length;i<len&&11==types[i];)i++;return i<len&&2==types[i]?2:4;case 12:for(len=types.length,i=ix+1;i<len&&12==types[i];)i++;if(i<len){var c=chars[ix],rtlCandidate=c>=1425&&c<=2303||64286==c;if(wType=types[i],rtlCandidate&&(1==wType||7==wType))return 1}return ix<1||5==(wType=types[ix-1])?4:classes[ix-1];case 5:return lastArabic=!1,hasUBAT_B=!0,dir;case 6:return hasUBAT_S=!0,4;case 13:case 14:case 16:case 17:case 15:lastArabic=!1;case 18:return 4}}function _getCharacterType(ch){var uc=ch.charCodeAt(0),hi=uc>>8;return 0==hi?uc>191?0:UnicodeTBL00[uc]:5==hi?/[\u0591-\u05f4]/.test(ch)?1:0:6==hi?/[\u0610-\u061a\u064b-\u065f\u06d6-\u06e4\u06e7-\u06ed]/.test(ch)?12:/[\u0660-\u0669\u066b-\u066c]/.test(ch)?3:1642==uc?11:/[\u06f0-\u06f9]/.test(ch)?2:7:32==hi&&uc<=8287?UnicodeTBL20[255&uc]:254==hi&&uc>=65136?7:4}exports.L=0,exports.R=1,exports.EN=2,exports.ON_R=3,exports.AN=4,exports.R_H=5,exports.B=6,exports.DOT="·",exports.doBidiReorder=function(text,textCharTypes,isRtl){if(text.length<2)return{};var chars=text.split(""),logicalFromVisual=new Array(chars.length),bidiLevels=new Array(chars.length),levels=[];dir=isRtl?1:0,function(chars,levels,len,charTypes){var impTab=dir?impTab_RTL:impTab_LTR,prevState=null,newClass=null,newLevel=null,newState=0,action=null,condPos=-1,i=null,ix=null,classes=[];if(!charTypes)for(i=0,charTypes=[];i<len;i++)charTypes[i]=_getCharacterType(chars[i]);for(hiLevel=dir,lastArabic=!1,!1,hasUBAT_B=!1,hasUBAT_S=!1,ix=0;ix<len;ix++){if(prevState=newState,classes[ix]=newClass=_getCharClass(chars,charTypes,classes,ix),action=240&(newState=impTab[prevState][newClass]),newState&=15,levels[ix]=newLevel=impTab[newState][5],action>0)if(16==action){for(i=condPos;i<ix;i++)levels[i]=1;condPos=-1}else condPos=-1;if(impTab[newState][6])-1==condPos&&(condPos=ix);else if(condPos>-1){for(i=condPos;i<ix;i++)levels[i]=newLevel;condPos=-1}5==charTypes[ix]&&(levels[ix]=0),hiLevel|=newLevel}if(hasUBAT_S)for(i=0;i<len;i++)if(6==charTypes[i]){levels[i]=dir;for(var j=i-1;j>=0&&8==charTypes[j];j--)levels[j]=dir}}(chars,levels,chars.length,textCharTypes);for(var i=0;i<logicalFromVisual.length;logicalFromVisual[i]=i,i++);_invertLevel(2,levels,logicalFromVisual),_invertLevel(1,levels,logicalFromVisual);for(i=0;i<logicalFromVisual.length-1;i++)3===textCharTypes[i]?levels[i]=exports.AN:1===levels[i]&&(textCharTypes[i]>7&&textCharTypes[i]<13||4===textCharTypes[i]||18===textCharTypes[i])?levels[i]=exports.ON_R:i>0&&"ل"===chars[i-1]&&/\u0622|\u0623|\u0625|\u0627/.test(chars[i])&&(levels[i-1]=levels[i]=exports.R_H,i++);chars[chars.length-1]===exports.DOT&&(levels[chars.length-1]=exports.B);for(i=0;i<logicalFromVisual.length;i++)bidiLevels[i]=levels[logicalFromVisual[i]];return{logicalFromVisual:logicalFromVisual,bidiLevels:bidiLevels}},exports.hasBidiCharacters=function(text,textCharTypes){for(var ret=!1,i=0;i<text.length;i++)textCharTypes[i]=_getCharacterType(text.charAt(i)),ret||1!=textCharTypes[i]&&7!=textCharTypes[i]||(ret=!0);return ret},exports.getVisualFromLogicalIdx=function(logIdx,rowMap){for(var i=0;i<rowMap.logicalFromVisual.length;i++)if(rowMap.logicalFromVisual[i]==logIdx)return i;return 0}})),ace.define("ace/bidihandler",["require","exports","module","ace/lib/bidiutil","ace/lib/lang","ace/lib/useragent"],(function(acequire,exports,module){"use strict";var bidiUtil=acequire("./lib/bidiutil"),lang=acequire("./lib/lang"),useragent=acequire("./lib/useragent"),bidiRE=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,BidiHandler=function(session){this.session=session,this.bidiMap={},this.currentRow=null,this.bidiUtil=bidiUtil,this.charWidths=[],this.EOL="¬",this.showInvisibles=!0,this.isRtlDir=!1,this.line="",this.wrapIndent=0,this.isLastRow=!1,this.EOF="¶",this.seenBidi=!1};(function(){this.isBidiRow=function(screenRow,docRow,splitIndex){return!!this.seenBidi&&(screenRow!==this.currentRow&&(this.currentRow=screenRow,this.updateRowLine(docRow,splitIndex),this.updateBidiMap()),this.bidiMap.bidiLevels)},this.onChange=function(delta){this.seenBidi?this.currentRow=null:"insert"==delta.action&&bidiRE.test(delta.lines.join("\n"))&&(this.seenBidi=!0,this.currentRow=null)},this.getDocumentRow=function(){var docRow=0,rowCache=this.session.$screenRowCache;if(rowCache.length){var index=this.session.$getRowCacheIndex(rowCache,this.currentRow);index>=0&&(docRow=this.session.$docRowCache[index])}return docRow},this.getSplitIndex=function(){var splitIndex=0,rowCache=this.session.$screenRowCache;if(rowCache.length)for(var currentIndex,prevIndex=this.session.$getRowCacheIndex(rowCache,this.currentRow);this.currentRow-splitIndex>0&&(currentIndex=this.session.$getRowCacheIndex(rowCache,this.currentRow-splitIndex-1))===prevIndex;)prevIndex=currentIndex,splitIndex++;return splitIndex},this.updateRowLine=function(docRow,splitIndex){if(void 0===docRow&&(docRow=this.getDocumentRow()),this.wrapIndent=0,this.isLastRow=docRow===this.session.getLength()-1,this.line=this.session.getLine(docRow),this.session.$useWrapMode){var splits=this.session.$wrapData[docRow];splits&&(void 0===splitIndex&&(splitIndex=this.getSplitIndex()),splitIndex>0&&splits.length?(this.wrapIndent=splits.indent,this.line=splitIndex<splits.length?this.line.substring(splits[splitIndex-1],splits[splits.length-1]):this.line.substring(splits[splits.length-1])):this.line=this.line.substring(0,splits[splitIndex]))}var size,session=this.session,shift=0;this.line=this.line.replace(/\t|[\u1100-\u2029, \u202F-\uFFE6]/g,(function(ch,i){return"\t"===ch||session.isFullWidth(ch.charCodeAt(0))?(size="\t"===ch?session.getScreenTabSize(i+shift):2,shift+=size-1,lang.stringRepeat(bidiUtil.DOT,size)):ch}))},this.updateBidiMap=function(){var textCharTypes=[],endOfLine=this.isLastRow?this.EOF:this.EOL,line=this.line+(this.showInvisibles?endOfLine:bidiUtil.DOT);bidiUtil.hasBidiCharacters(line,textCharTypes)?this.bidiMap=bidiUtil.doBidiReorder(line,textCharTypes,this.isRtlDir):this.bidiMap={}},this.markAsDirty=function(){this.currentRow=null},this.updateCharacterWidths=function(fontMetrics){if(this.seenBidi&&this.characterWidth!==fontMetrics.$characterSize.width){var characterWidth=this.characterWidth=fontMetrics.$characterSize.width,bidiCharWidth=fontMetrics.$measureCharWidth("ה");this.charWidths[bidiUtil.L]=this.charWidths[bidiUtil.EN]=this.charWidths[bidiUtil.ON_R]=characterWidth,this.charWidths[bidiUtil.R]=this.charWidths[bidiUtil.AN]=bidiCharWidth,this.charWidths[bidiUtil.R_H]=useragent.isChrome?bidiCharWidth:.45*bidiCharWidth,this.charWidths[bidiUtil.B]=0,this.currentRow=null}},this.getShowInvisibles=function(){return this.showInvisibles},this.setShowInvisibles=function(showInvisibles){this.showInvisibles=showInvisibles,this.currentRow=null},this.setEolChar=function(eolChar){this.EOL=eolChar},this.setTextDir=function(isRtlDir){this.isRtlDir=isRtlDir},this.getPosLeft=function(col){col-=this.wrapIndent;var visualIdx=bidiUtil.getVisualFromLogicalIdx(col>0?col-1:0,this.bidiMap),levels=this.bidiMap.bidiLevels,left=0;0===col&&levels[visualIdx]%2!=0&&visualIdx++;for(var i=0;i<visualIdx;i++)left+=this.charWidths[levels[i]];return 0!==col&&levels[visualIdx]%2==0&&(left+=this.charWidths[levels[visualIdx]]),this.wrapIndent&&(left+=this.wrapIndent*this.charWidths[bidiUtil.L]),left},this.getSelections=function(startCol,endCol){for(var level,logIdx,map=this.bidiMap,levels=map.bidiLevels,offset=this.wrapIndent*this.charWidths[bidiUtil.L],selections=[],selColMin=Math.min(startCol,endCol)-this.wrapIndent,selColMax=Math.max(startCol,endCol)-this.wrapIndent,isSelected=!1,isSelectedPrev=!1,selectionStart=0,visIdx=0;visIdx<levels.length;visIdx++)logIdx=map.logicalFromVisual[visIdx],level=levels[visIdx],(isSelected=logIdx>=selColMin&&logIdx<selColMax)&&!isSelectedPrev?selectionStart=offset:!isSelected&&isSelectedPrev&&selections.push({left:selectionStart,width:offset-selectionStart}),offset+=this.charWidths[level],isSelectedPrev=isSelected;return isSelected&&visIdx===levels.length&&selections.push({left:selectionStart,width:offset-selectionStart}),selections},this.offsetToCol=function(posX){var logicalIdx=0,offset=(posX=Math.max(posX,0),0),visualIdx=0,levels=this.bidiMap.bidiLevels,charWidth=this.charWidths[levels[visualIdx]];for(this.wrapIndent&&(posX-=this.wrapIndent*this.charWidths[bidiUtil.L]);posX>offset+charWidth/2;){if(offset+=charWidth,visualIdx===levels.length-1){charWidth=0;break}charWidth=this.charWidths[levels[++visualIdx]]}return visualIdx>0&&levels[visualIdx-1]%2!=0&&levels[visualIdx]%2==0?(posX<offset&&visualIdx--,logicalIdx=this.bidiMap.logicalFromVisual[visualIdx]):visualIdx>0&&levels[visualIdx-1]%2==0&&levels[visualIdx]%2!=0?logicalIdx=1+(posX>offset?this.bidiMap.logicalFromVisual[visualIdx]:this.bidiMap.logicalFromVisual[visualIdx-1]):this.isRtlDir&&visualIdx===levels.length-1&&0===charWidth&&levels[visualIdx-1]%2==0||!this.isRtlDir&&0===visualIdx&&levels[visualIdx]%2!=0?logicalIdx=1+this.bidiMap.logicalFromVisual[visualIdx]:(visualIdx>0&&levels[visualIdx-1]%2!=0&&0!==charWidth&&visualIdx--,logicalIdx=this.bidiMap.logicalFromVisual[visualIdx]),logicalIdx+this.wrapIndent}}).call(BidiHandler.prototype),exports.BidiHandler=BidiHandler})),ace.define("ace/range",["require","exports","module"],(function(acequire,exports,module){"use strict";var Range=function(startRow,startColumn,endRow,endColumn){this.start={row:startRow,column:startColumn},this.end={row:endRow,column:endColumn}};(function(){this.isEqual=function(range){return this.start.row===range.start.row&&this.end.row===range.end.row&&this.start.column===range.start.column&&this.end.column===range.end.column},this.toString=function(){return"Range: ["+this.start.row+"/"+this.start.column+"] -> ["+this.end.row+"/"+this.end.column+"]"},this.contains=function(row,column){return 0==this.compare(row,column)},this.compareRange=function(range){var cmp,end=range.end,start=range.start;return 1==(cmp=this.compare(end.row,end.column))?1==(cmp=this.compare(start.row,start.column))?2:0==cmp?1:0:-1==cmp?-2:-1==(cmp=this.compare(start.row,start.column))?-1:1==cmp?42:0},this.comparePoint=function(p){return this.compare(p.row,p.column)},this.containsRange=function(range){return 0==this.comparePoint(range.start)&&0==this.comparePoint(range.end)},this.intersects=function(range){var cmp=this.compareRange(range);return-1==cmp||0==cmp||1==cmp},this.isEnd=function(row,column){return this.end.row==row&&this.end.column==column},this.isStart=function(row,column){return this.start.row==row&&this.start.column==column},this.setStart=function(row,column){"object"==typeof row?(this.start.column=row.column,this.start.row=row.row):(this.start.row=row,this.start.column=column)},this.setEnd=function(row,column){"object"==typeof row?(this.end.column=row.column,this.end.row=row.row):(this.end.row=row,this.end.column=column)},this.inside=function(row,column){return 0==this.compare(row,column)&&(!this.isEnd(row,column)&&!this.isStart(row,column))},this.insideStart=function(row,column){return 0==this.compare(row,column)&&!this.isEnd(row,column)},this.insideEnd=function(row,column){return 0==this.compare(row,column)&&!this.isStart(row,column)},this.compare=function(row,column){return this.isMultiLine()||row!==this.start.row?row<this.start.row?-1:row>this.end.row?1:this.start.row===row?column>=this.start.column?0:-1:this.end.row===row?column<=this.end.column?0:1:0:column<this.start.column?-1:column>this.end.column?1:0},this.compareStart=function(row,column){return this.start.row==row&&this.start.column==column?-1:this.compare(row,column)},this.compareEnd=function(row,column){return this.end.row==row&&this.end.column==column?1:this.compare(row,column)},this.compareInside=function(row,column){return this.end.row==row&&this.end.column==column?1:this.start.row==row&&this.start.column==column?-1:this.compare(row,column)},this.clipRows=function(firstRow,lastRow){if(this.end.row>lastRow)var end={row:lastRow+1,column:0};else if(this.end.row<firstRow)end={row:firstRow,column:0};if(this.start.row>lastRow)var start={row:lastRow+1,column:0};else if(this.start.row<firstRow)start={row:firstRow,column:0};return Range.fromPoints(start||this.start,end||this.end)},this.extend=function(row,column){var cmp=this.compare(row,column);if(0==cmp)return this;if(-1==cmp)var start={row:row,column:column};else var end={row:row,column:column};return Range.fromPoints(start||this.start,end||this.end)},this.isEmpty=function(){return this.start.row===this.end.row&&this.start.column===this.end.column},this.isMultiLine=function(){return this.start.row!==this.end.row},this.clone=function(){return Range.fromPoints(this.start,this.end)},this.collapseRows=function(){return 0==this.end.column?new Range(this.start.row,0,Math.max(this.start.row,this.end.row-1),0):new Range(this.start.row,0,this.end.row,0)},this.toScreenRange=function(session){var screenPosStart=session.documentToScreenPosition(this.start),screenPosEnd=session.documentToScreenPosition(this.end);return new Range(screenPosStart.row,screenPosStart.column,screenPosEnd.row,screenPosEnd.column)},this.moveBy=function(row,column){this.start.row+=row,this.start.column+=column,this.end.row+=row,this.end.column+=column}}).call(Range.prototype),Range.fromPoints=function(start,end){return new Range(start.row,start.column,end.row,end.column)},Range.comparePoints=function(p1,p2){return p1.row-p2.row||p1.column-p2.column},Range.comparePoints=function(p1,p2){return p1.row-p2.row||p1.column-p2.column},exports.Range=Range})),ace.define("ace/selection",["require","exports","module","ace/lib/oop","ace/lib/lang","ace/lib/event_emitter","ace/range"],(function(acequire,exports,module){"use strict";var oop=acequire("./lib/oop"),lang=acequire("./lib/lang"),EventEmitter=acequire("./lib/event_emitter").EventEmitter,Range=acequire("./range").Range,Selection=function(session){this.session=session,this.doc=session.getDocument(),this.clearSelection(),this.lead=this.selectionLead=this.doc.createAnchor(0,0),this.anchor=this.selectionAnchor=this.doc.createAnchor(0,0);var self=this;this.lead.on("change",(function(e){self._emit("changeCursor"),self.$isEmpty||self._emit("changeSelection"),self.$keepDesiredColumnOnChange||e.old.column==e.value.column||(self.$desiredColumn=null)})),this.selectionAnchor.on("change",(function(){self.$isEmpty||self._emit("changeSelection")}))};(function(){oop.implement(this,EventEmitter),this.isEmpty=function(){return this.$isEmpty||this.anchor.row==this.lead.row&&this.anchor.column==this.lead.column},this.isMultiLine=function(){return!this.isEmpty()&&this.getRange().isMultiLine()},this.getCursor=function(){return this.lead.getPosition()},this.setSelectionAnchor=function(row,column){this.anchor.setPosition(row,column),this.$isEmpty&&(this.$isEmpty=!1,this._emit("changeSelection"))},this.getSelectionAnchor=function(){return this.$isEmpty?this.getSelectionLead():this.anchor.getPosition()},this.getSelectionLead=function(){return this.lead.getPosition()},this.shiftSelection=function(columns){if(this.$isEmpty)this.moveCursorTo(this.lead.row,this.lead.column+columns);else{var anchor=this.getSelectionAnchor(),lead=this.getSelectionLead(),isBackwards=this.isBackwards();isBackwards&&0===anchor.column||this.setSelectionAnchor(anchor.row,anchor.column+columns),(isBackwards||0!==lead.column)&&this.$moveSelection((function(){this.moveCursorTo(lead.row,lead.column+columns)}))}},this.isBackwards=function(){var anchor=this.anchor,lead=this.lead;return anchor.row>lead.row||anchor.row==lead.row&&anchor.column>lead.column},this.getRange=function(){var anchor=this.anchor,lead=this.lead;return this.isEmpty()?Range.fromPoints(lead,lead):this.isBackwards()?Range.fromPoints(lead,anchor):Range.fromPoints(anchor,lead)},this.clearSelection=function(){this.$isEmpty||(this.$isEmpty=!0,this._emit("changeSelection"))},this.selectAll=function(){var lastRow=this.doc.getLength()-1;this.setSelectionAnchor(0,0),this.moveCursorTo(lastRow,this.doc.getLine(lastRow).length)},this.setRange=this.setSelectionRange=function(range,reverse){reverse?(this.setSelectionAnchor(range.end.row,range.end.column),this.selectTo(range.start.row,range.start.column)):(this.setSelectionAnchor(range.start.row,range.start.column),this.selectTo(range.end.row,range.end.column)),this.getRange().isEmpty()&&(this.$isEmpty=!0),this.$desiredColumn=null},this.$moveSelection=function(mover){var lead=this.lead;this.$isEmpty&&this.setSelectionAnchor(lead.row,lead.column),mover.call(this)},this.selectTo=function(row,column){this.$moveSelection((function(){this.moveCursorTo(row,column)}))},this.selectToPosition=function(pos){this.$moveSelection((function(){this.moveCursorToPosition(pos)}))},this.moveTo=function(row,column){this.clearSelection(),this.moveCursorTo(row,column)},this.moveToPosition=function(pos){this.clearSelection(),this.moveCursorToPosition(pos)},this.selectUp=function(){this.$moveSelection(this.moveCursorUp)},this.selectDown=function(){this.$moveSelection(this.moveCursorDown)},this.selectRight=function(){this.$moveSelection(this.moveCursorRight)},this.selectLeft=function(){this.$moveSelection(this.moveCursorLeft)},this.selectLineStart=function(){this.$moveSelection(this.moveCursorLineStart)},this.selectLineEnd=function(){this.$moveSelection(this.moveCursorLineEnd)},this.selectFileEnd=function(){this.$moveSelection(this.moveCursorFileEnd)},this.selectFileStart=function(){this.$moveSelection(this.moveCursorFileStart)},this.selectWordRight=function(){this.$moveSelection(this.moveCursorWordRight)},this.selectWordLeft=function(){this.$moveSelection(this.moveCursorWordLeft)},this.getWordRange=function(row,column){if(void 0===column){var cursor=row||this.lead;row=cursor.row,column=cursor.column}return this.session.getWordRange(row,column)},this.selectWord=function(){this.setSelectionRange(this.getWordRange())},this.selectAWord=function(){var cursor=this.getCursor(),range=this.session.getAWordRange(cursor.row,cursor.column);this.setSelectionRange(range)},this.getLineRange=function(row,excludeLastChar){var rowEnd,rowStart="number"==typeof row?row:this.lead.row,foldLine=this.session.getFoldLine(rowStart);return foldLine?(rowStart=foldLine.start.row,rowEnd=foldLine.end.row):rowEnd=rowStart,!0===excludeLastChar?new Range(rowStart,0,rowEnd,this.session.getLine(rowEnd).length):new Range(rowStart,0,rowEnd+1,0)},this.selectLine=function(){this.setSelectionRange(this.getLineRange())},this.moveCursorUp=function(){this.moveCursorBy(-1,0)},this.moveCursorDown=function(){this.moveCursorBy(1,0)},this.wouldMoveIntoSoftTab=function(cursor,tabSize,direction){var start=cursor.column,end=cursor.column+tabSize;return direction<0&&(start=cursor.column-tabSize,end=cursor.column),this.session.isTabStop(cursor)&&this.doc.getLine(cursor.row).slice(start,end).split(" ").length-1==tabSize},this.moveCursorLeft=function(){var fold,cursor=this.lead.getPosition();if(fold=this.session.getFoldAt(cursor.row,cursor.column,-1))this.moveCursorTo(fold.start.row,fold.start.column);else if(0===cursor.column)cursor.row>0&&this.moveCursorTo(cursor.row-1,this.doc.getLine(cursor.row-1).length);else{var tabSize=this.session.getTabSize();this.wouldMoveIntoSoftTab(cursor,tabSize,-1)&&!this.session.getNavigateWithinSoftTabs()?this.moveCursorBy(0,-tabSize):this.moveCursorBy(0,-1)}},this.moveCursorRight=function(){var fold,cursor=this.lead.getPosition();if(fold=this.session.getFoldAt(cursor.row,cursor.column,1))this.moveCursorTo(fold.end.row,fold.end.column);else if(this.lead.column==this.doc.getLine(this.lead.row).length)this.lead.row<this.doc.getLength()-1&&this.moveCursorTo(this.lead.row+1,0);else{var tabSize=this.session.getTabSize();cursor=this.lead;this.wouldMoveIntoSoftTab(cursor,tabSize,1)&&!this.session.getNavigateWithinSoftTabs()?this.moveCursorBy(0,tabSize):this.moveCursorBy(0,1)}},this.moveCursorLineStart=function(){var row=this.lead.row,column=this.lead.column,screenRow=this.session.documentToScreenRow(row,column),firstColumnPosition=this.session.screenToDocumentPosition(screenRow,0),leadingSpace=this.session.getDisplayLine(row,null,firstColumnPosition.row,firstColumnPosition.column).match(/^\s*/);leadingSpace[0].length==column||this.session.$useEmacsStyleLineStart||(firstColumnPosition.column+=leadingSpace[0].length),this.moveCursorToPosition(firstColumnPosition)},this.moveCursorLineEnd=function(){var lead=this.lead,lineEnd=this.session.getDocumentLastRowColumnPosition(lead.row,lead.column);if(this.lead.column==lineEnd.column){var line=this.session.getLine(lineEnd.row);if(lineEnd.column==line.length){var textEnd=line.search(/\s+$/);textEnd>0&&(lineEnd.column=textEnd)}}this.moveCursorTo(lineEnd.row,lineEnd.column)},this.moveCursorFileEnd=function(){var row=this.doc.getLength()-1,column=this.doc.getLine(row).length;this.moveCursorTo(row,column)},this.moveCursorFileStart=function(){this.moveCursorTo(0,0)},this.moveCursorLongWordRight=function(){var row=this.lead.row,column=this.lead.column,line=this.doc.getLine(row),rightOfCursor=line.substring(column);this.session.nonTokenRe.lastIndex=0,this.session.tokenRe.lastIndex=0;var fold=this.session.getFoldAt(row,column,1);if(fold)this.moveCursorTo(fold.end.row,fold.end.column);else{if(this.session.nonTokenRe.exec(rightOfCursor)&&(column+=this.session.nonTokenRe.lastIndex,this.session.nonTokenRe.lastIndex=0,rightOfCursor=line.substring(column)),column>=line.length)return this.moveCursorTo(row,line.length),this.moveCursorRight(),void(row<this.doc.getLength()-1&&this.moveCursorWordRight());this.session.tokenRe.exec(rightOfCursor)&&(column+=this.session.tokenRe.lastIndex,this.session.tokenRe.lastIndex=0),this.moveCursorTo(row,column)}},this.moveCursorLongWordLeft=function(){var fold,row=this.lead.row,column=this.lead.column;if(fold=this.session.getFoldAt(row,column,-1))this.moveCursorTo(fold.start.row,fold.start.column);else{var str=this.session.getFoldStringAt(row,column,-1);null==str&&(str=this.doc.getLine(row).substring(0,column));var leftOfCursor=lang.stringReverse(str);if(this.session.nonTokenRe.lastIndex=0,this.session.tokenRe.lastIndex=0,this.session.nonTokenRe.exec(leftOfCursor)&&(column-=this.session.nonTokenRe.lastIndex,leftOfCursor=leftOfCursor.slice(this.session.nonTokenRe.lastIndex),this.session.nonTokenRe.lastIndex=0),column<=0)return this.moveCursorTo(row,0),this.moveCursorLeft(),void(row>0&&this.moveCursorWordLeft());this.session.tokenRe.exec(leftOfCursor)&&(column-=this.session.tokenRe.lastIndex,this.session.tokenRe.lastIndex=0),this.moveCursorTo(row,column)}},this.$shortWordEndIndex=function(rightOfCursor){var ch,index=0,whitespaceRe=/\s/,tokenRe=this.session.tokenRe;if(tokenRe.lastIndex=0,this.session.tokenRe.exec(rightOfCursor))index=this.session.tokenRe.lastIndex;else{for(;(ch=rightOfCursor[index])&&whitespaceRe.test(ch);)index++;if(index<1)for(tokenRe.lastIndex=0;(ch=rightOfCursor[index])&&!tokenRe.test(ch);)if(tokenRe.lastIndex=0,index++,whitespaceRe.test(ch)){if(index>2){index--;break}for(;(ch=rightOfCursor[index])&&whitespaceRe.test(ch);)index++;if(index>2)break}}return tokenRe.lastIndex=0,index},this.moveCursorShortWordRight=function(){var row=this.lead.row,column=this.lead.column,line=this.doc.getLine(row),rightOfCursor=line.substring(column),fold=this.session.getFoldAt(row,column,1);if(fold)return this.moveCursorTo(fold.end.row,fold.end.column);if(column==line.length){var l=this.doc.getLength();do{row++,rightOfCursor=this.doc.getLine(row)}while(row<l&&/^\s*$/.test(rightOfCursor));/^\s+/.test(rightOfCursor)||(rightOfCursor=""),column=0}var index=this.$shortWordEndIndex(rightOfCursor);this.moveCursorTo(row,column+index)},this.moveCursorShortWordLeft=function(){var fold,row=this.lead.row,column=this.lead.column;if(fold=this.session.getFoldAt(row,column,-1))return this.moveCursorTo(fold.start.row,fold.start.column);var line=this.session.getLine(row).substring(0,column);if(0===column){do{row--,line=this.doc.getLine(row)}while(row>0&&/^\s*$/.test(line));column=line.length,/\s+$/.test(line)||(line="")}var leftOfCursor=lang.stringReverse(line),index=this.$shortWordEndIndex(leftOfCursor);return this.moveCursorTo(row,column-index)},this.moveCursorWordRight=function(){this.session.$selectLongWords?this.moveCursorLongWordRight():this.moveCursorShortWordRight()},this.moveCursorWordLeft=function(){this.session.$selectLongWords?this.moveCursorLongWordLeft():this.moveCursorShortWordLeft()},this.moveCursorBy=function(rows,chars){var offsetX,screenPos=this.session.documentToScreenPosition(this.lead.row,this.lead.column);0===chars&&(0!==rows&&(this.session.$bidiHandler.isBidiRow(screenPos.row,this.lead.row)?(offsetX=this.session.$bidiHandler.getPosLeft(screenPos.column),screenPos.column=Math.round(offsetX/this.session.$bidiHandler.charWidths[0])):offsetX=screenPos.column*this.session.$bidiHandler.charWidths[0]),this.$desiredColumn?screenPos.column=this.$desiredColumn:this.$desiredColumn=screenPos.column);var docPos=this.session.screenToDocumentPosition(screenPos.row+rows,screenPos.column,offsetX);0!==rows&&0===chars&&docPos.row===this.lead.row&&docPos.column===this.lead.column&&this.session.lineWidgets&&this.session.lineWidgets[docPos.row]&&(docPos.row>0||rows>0)&&docPos.row++,this.moveCursorTo(docPos.row,docPos.column+chars,0===chars)},this.moveCursorToPosition=function(position){this.moveCursorTo(position.row,position.column)},this.moveCursorTo=function(row,column,keepDesiredColumn){var fold=this.session.getFoldAt(row,column,1);fold&&(row=fold.start.row,column=fold.start.column),this.$keepDesiredColumnOnChange=!0;var line=this.session.getLine(row);/[\uDC00-\uDFFF]/.test(line.charAt(column))&&line.charAt(column-1)&&(this.lead.row==row&&this.lead.column==column+1?column-=1:column+=1),this.lead.setPosition(row,column),this.$keepDesiredColumnOnChange=!1,keepDesiredColumn||(this.$desiredColumn=null)},this.moveCursorToScreen=function(row,column,keepDesiredColumn){var pos=this.session.screenToDocumentPosition(row,column);this.moveCursorTo(pos.row,pos.column,keepDesiredColumn)},this.detach=function(){this.lead.detach(),this.anchor.detach(),this.session=this.doc=null},this.fromOrientedRange=function(range){this.setSelectionRange(range,range.cursor==range.start),this.$desiredColumn=range.desiredColumn||this.$desiredColumn},this.toOrientedRange=function(range){var r=this.getRange();return range?(range.start.column=r.start.column,range.start.row=r.start.row,range.end.column=r.end.column,range.end.row=r.end.row):range=r,range.cursor=this.isBackwards()?range.start:range.end,range.desiredColumn=this.$desiredColumn,range},this.getRangeOfMovements=function(func){var start=this.getCursor();try{func(this);var end=this.getCursor();return Range.fromPoints(start,end)}catch(e){return Range.fromPoints(start,start)}finally{this.moveCursorToPosition(start)}},this.toJSON=function(){if(this.rangeCount)var data=this.ranges.map((function(r){var r1=r.clone();return r1.isBackwards=r.cursor==r.start,r1}));else(data=this.getRange()).isBackwards=this.isBackwards();return data},this.fromJSON=function(data){if(null==data.start){if(this.rangeList){this.toSingleRange(data[0]);for(var i=data.length;i--;){var r=Range.fromPoints(data[i].start,data[i].end);data[i].isBackwards&&(r.cursor=r.start),this.addRange(r,!0)}return}data=data[0]}this.rangeList&&this.toSingleRange(data),this.setSelectionRange(data,data.isBackwards)},this.isEqual=function(data){if((data.length||this.rangeCount)&&data.length!=this.rangeCount)return!1;if(!data.length||!this.ranges)return this.getRange().isEqual(data);for(var i=this.ranges.length;i--;)if(!this.ranges[i].isEqual(data[i]))return!1;return!0}}).call(Selection.prototype),exports.Selection=Selection})),ace.define("ace/tokenizer",["require","exports","module","ace/config"],(function(acequire,exports,module){"use strict";var config=acequire("./config"),MAX_TOKEN_COUNT=2e3,Tokenizer=function(rules){for(var key in this.states=rules,this.regExps={},this.matchMappings={},this.states){for(var state=this.states[key],ruleRegExps=[],matchTotal=0,mapping=this.matchMappings[key]={defaultToken:"text"},flag="g",splitterRurles=[],i=0;i<state.length;i++){var rule=state[i];if(rule.defaultToken&&(mapping.defaultToken=rule.defaultToken),rule.caseInsensitive&&(flag="gi"),null!=rule.regex){rule.regex instanceof RegExp&&(rule.regex=rule.regex.toString().slice(1,-1));var adjustedregex=rule.regex,matchcount=new RegExp("(?:("+adjustedregex+")|(.))").exec("a").length-2;Array.isArray(rule.token)?1==rule.token.length||1==matchcount?rule.token=rule.token[0]:matchcount-1!=rule.token.length?(this.reportError("number of classes and regexp groups doesn't match",{rule:rule,groupCount:matchcount-1}),rule.token=rule.token[0]):(rule.tokenArray=rule.token,rule.token=null,rule.onMatch=this.$arrayTokens):"function"!=typeof rule.token||rule.onMatch||(rule.onMatch=matchcount>1?this.$applyToken:rule.token),matchcount>1&&(/\\\d/.test(rule.regex)?adjustedregex=rule.regex.replace(/\\([0-9]+)/g,(function(match,digit){return"\\"+(parseInt(digit,10)+matchTotal+1)})):(matchcount=1,adjustedregex=this.removeCapturingGroups(rule.regex)),rule.splitRegex||"string"==typeof rule.token||splitterRurles.push(rule)),mapping[matchTotal]=i,matchTotal+=matchcount,ruleRegExps.push(adjustedregex),rule.onMatch||(rule.onMatch=null)}}ruleRegExps.length||(mapping[0]=0,ruleRegExps.push("$")),splitterRurles.forEach((function(rule){rule.splitRegex=this.createSplitterRegexp(rule.regex,flag)}),this),this.regExps[key]=new RegExp("("+ruleRegExps.join(")|(")+")|($)",flag)}};(function(){this.$setMaxTokenCount=function(m){MAX_TOKEN_COUNT=0|m},this.$applyToken=function(str){var values=this.splitRegex.exec(str).slice(1),types=this.token.apply(this,values);if("string"==typeof types)return[{type:types,value:str}];for(var tokens=[],i=0,l=types.length;i<l;i++)values[i]&&(tokens[tokens.length]={type:types[i],value:values[i]});return tokens},this.$arrayTokens=function(str){if(!str)return[];var values=this.splitRegex.exec(str);if(!values)return"text";for(var tokens=[],types=this.tokenArray,i=0,l=types.length;i<l;i++)values[i+1]&&(tokens[tokens.length]={type:types[i],value:values[i+1]});return tokens},this.removeCapturingGroups=function(src){return src.replace(/\[(?:\\.|[^\]])*?\]|\\.|\(\?[:=!]|(\()/g,(function(x,y){return y?"(?:":x}))},this.createSplitterRegexp=function(src,flag){if(-1!=src.indexOf("(?=")){var stack=0,inChClass=!1,lastCapture={};src.replace(/(\\.)|(\((?:\?[=!])?)|(\))|([\[\]])/g,(function(m,esc,parenOpen,parenClose,square,index){return inChClass?inChClass="]"!=square:square?inChClass=!0:parenClose?(stack==lastCapture.stack&&(lastCapture.end=index+1,lastCapture.stack=-1),stack--):parenOpen&&(stack++,1!=parenOpen.length&&(lastCapture.stack=stack,lastCapture.start=index)),m})),null!=lastCapture.end&&/^\)*$/.test(src.substr(lastCapture.end))&&(src=src.substring(0,lastCapture.start)+src.substr(lastCapture.end))}return"^"!=src.charAt(0)&&(src="^"+src),"$"!=src.charAt(src.length-1)&&(src+="$"),new RegExp(src,(flag||"").replace("g",""))},this.getLineTokens=function(line,startState){if(startState&&"string"!=typeof startState){var stack=startState.slice(0);"#tmp"===(startState=stack[0])&&(stack.shift(),startState=stack.shift())}else stack=[];var currentState=startState||"start",state=this.states[currentState];state||(currentState="start",state=this.states[currentState]);var mapping=this.matchMappings[currentState],re=this.regExps[currentState];re.lastIndex=0;for(var match,tokens=[],lastIndex=0,matchAttempts=0,token={type:null,value:""};match=re.exec(line);){var type=mapping.defaultToken,rule=null,value=match[0],index=re.lastIndex;if(index-value.length>lastIndex){var skipped=line.substring(lastIndex,index-value.length);token.type==type?token.value+=skipped:(token.type&&tokens.push(token),token={type:type,value:skipped})}for(var i=0;i<match.length-2;i++)if(void 0!==match[i+1]){type=(rule=state[mapping[i]]).onMatch?rule.onMatch(value,currentState,stack,line):rule.token,rule.next&&(currentState="string"==typeof rule.next?rule.next:rule.next(currentState,stack),(state=this.states[currentState])||(this.reportError("state doesn't exist",currentState),currentState="start",state=this.states[currentState]),mapping=this.matchMappings[currentState],lastIndex=index,(re=this.regExps[currentState]).lastIndex=index),rule.consumeLineEnd&&(lastIndex=index);break}if(value)if("string"==typeof type)rule&&!1===rule.merge||token.type!==type?(token.type&&tokens.push(token),token={type:type,value:value}):token.value+=value;else if(type){token.type&&tokens.push(token),token={type:null,value:""};for(i=0;i<type.length;i++)tokens.push(type[i])}if(lastIndex==line.length)break;if(lastIndex=index,matchAttempts++>MAX_TOKEN_COUNT){for(matchAttempts>2*line.length&&this.reportError("infinite loop with in ace tokenizer",{startState:startState,line:line});lastIndex<line.length;)token.type&&tokens.push(token),token={value:line.substring(lastIndex,lastIndex+=2e3),type:"overflow"};currentState="start",stack=[];break}}return token.type&&tokens.push(token),stack.length>1&&stack[0]!==currentState&&stack.unshift("#tmp",currentState),{tokens:tokens,state:stack.length?stack:currentState}},this.reportError=config.reportError}).call(Tokenizer.prototype),exports.Tokenizer=Tokenizer})),ace.define("ace/mode/text_highlight_rules",["require","exports","module","ace/lib/lang"],(function(acequire,exports,module){"use strict";var lang=acequire("../lib/lang"),TextHighlightRules=function(){this.$rules={start:[{token:"empty_line",regex:"^$"},{defaultToken:"text"}]}};(function(){this.addRules=function(rules,prefix){if(prefix)for(var key in rules){for(var state=rules[key],i=0;i<state.length;i++){var rule=state[i];(rule.next||rule.onMatch)&&("string"==typeof rule.next&&0!==rule.next.indexOf(prefix)&&(rule.next=prefix+rule.next),rule.nextState&&0!==rule.nextState.indexOf(prefix)&&(rule.nextState=prefix+rule.nextState))}this.$rules[prefix+key]=state}else for(var key in rules)this.$rules[key]=rules[key]},this.getRules=function(){return this.$rules},this.embedRules=function(HighlightRules,prefix,escapeRules,states,append){var embedRules="function"==typeof HighlightRules?(new HighlightRules).getRules():HighlightRules;if(states)for(var i=0;i<states.length;i++)states[i]=prefix+states[i];else for(var key in states=[],embedRules)states.push(prefix+key);if(this.addRules(embedRules,prefix),escapeRules){var addRules=Array.prototype[append?"push":"unshift"];for(i=0;i<states.length;i++)addRules.apply(this.$rules[states[i]],lang.deepCopy(escapeRules))}this.$embeds||(this.$embeds=[]),this.$embeds.push(prefix)},this.getEmbeds=function(){return this.$embeds};var pushState=function(currentState,stack){return("start"!=currentState||stack.length)&&stack.unshift(this.nextState,currentState),this.nextState},popState=function(currentState,stack){return stack.shift(),stack.shift()||"start"};this.normalizeRules=function(){var id=0,rules=this.$rules;Object.keys(rules).forEach((function processState(key){var state=rules[key];state.processed=!0;for(var i=0;i<state.length;i++){var rule=state[i],toInsert=null;Array.isArray(rule)&&(toInsert=rule,rule={}),!rule.regex&&rule.start&&(rule.regex=rule.start,rule.next||(rule.next=[]),rule.next.push({defaultToken:rule.token},{token:rule.token+".end",regex:rule.end||rule.start,next:"pop"}),rule.token=rule.token+".start",rule.push=!0);var next=rule.next||rule.push;if(next&&Array.isArray(next)){var stateName=rule.stateName;stateName||("string"!=typeof(stateName=rule.token)&&(stateName=stateName[0]||""),rules[stateName]&&(stateName+=id++)),rules[stateName]=next,rule.next=stateName,processState(stateName)}else"pop"==next&&(rule.next=popState);if(rule.push&&(rule.nextState=rule.next||rule.push,rule.next=pushState,delete rule.push),rule.rules)for(var r in rule.rules)rules[r]?rules[r].push&&rules[r].push.apply(rules[r],rule.rules[r]):rules[r]=rule.rules[r];var includeName="string"==typeof rule?rule:rule.include;if(includeName&&(toInsert=Array.isArray(includeName)?includeName.map((function(x){return rules[x]})):rules[includeName]),toInsert){var args=[i,1].concat(toInsert);rule.noEscape&&(args=args.filter((function(x){return!x.next}))),state.splice.apply(state,args),i--}rule.keywordMap&&(rule.token=this.createKeywordMapper(rule.keywordMap,rule.defaultToken||"text",rule.caseInsensitive),delete rule.defaultToken)}}),this)},this.createKeywordMapper=function(map,defaultToken,ignoreCase,splitChar){var keywords=Object.create(null);return Object.keys(map).forEach((function(className){var a=map[className];ignoreCase&&(a=a.toLowerCase());for(var list=a.split(splitChar||"|"),i=list.length;i--;)keywords[list[i]]=className})),Object.getPrototypeOf(keywords)&&(keywords.__proto__=null),this.$keywordList=Object.keys(keywords),map=null,ignoreCase?function(value){return keywords[value.toLowerCase()]||defaultToken}:function(value){return keywords[value]||defaultToken}},this.getKeywords=function(){return this.$keywords}}).call(TextHighlightRules.prototype),exports.TextHighlightRules=TextHighlightRules})),ace.define("ace/mode/behaviour",["require","exports","module"],(function(acequire,exports,module){"use strict";var Behaviour=function(){this.$behaviours={}};(function(){this.add=function(name,action,callback){switch(void 0){case this.$behaviours:this.$behaviours={};case this.$behaviours[name]:this.$behaviours[name]={}}this.$behaviours[name][action]=callback},this.addBehaviours=function(behaviours){for(var key in behaviours)for(var action in behaviours[key])this.add(key,action,behaviours[key][action])},this.remove=function(name){this.$behaviours&&this.$behaviours[name]&&delete this.$behaviours[name]},this.inherit=function(mode,filter){if("function"==typeof mode)var behaviours=(new mode).getBehaviours(filter);else behaviours=mode.getBehaviours(filter);this.addBehaviours(behaviours)},this.getBehaviours=function(filter){if(filter){for(var ret={},i=0;i<filter.length;i++)this.$behaviours[filter[i]]&&(ret[filter[i]]=this.$behaviours[filter[i]]);return ret}return this.$behaviours}}).call(Behaviour.prototype),exports.Behaviour=Behaviour})),ace.define("ace/token_iterator",["require","exports","module","ace/range"],(function(acequire,exports,module){"use strict";var Range=acequire("./range").Range,TokenIterator=function(session,initialRow,initialColumn){this.$session=session,this.$row=initialRow,this.$rowTokens=session.getTokens(initialRow);var token=session.getTokenAt(initialRow,initialColumn);this.$tokenIndex=token?token.index:-1};(function(){this.stepBackward=function(){for(this.$tokenIndex-=1;this.$tokenIndex<0;){if(this.$row-=1,this.$row<0)return this.$row=0,null;this.$rowTokens=this.$session.getTokens(this.$row),this.$tokenIndex=this.$rowTokens.length-1}return this.$rowTokens[this.$tokenIndex]},this.stepForward=function(){var rowCount;for(this.$tokenIndex+=1;this.$tokenIndex>=this.$rowTokens.length;){if(this.$row+=1,rowCount||(rowCount=this.$session.getLength()),this.$row>=rowCount)return this.$row=rowCount-1,null;this.$rowTokens=this.$session.getTokens(this.$row),this.$tokenIndex=0}return this.$rowTokens[this.$tokenIndex]},this.getCurrentToken=function(){return this.$rowTokens[this.$tokenIndex]},this.getCurrentTokenRow=function(){return this.$row},this.getCurrentTokenColumn=function(){var rowTokens=this.$rowTokens,tokenIndex=this.$tokenIndex,column=rowTokens[tokenIndex].start;if(void 0!==column)return column;for(column=0;tokenIndex>0;)column+=rowTokens[tokenIndex-=1].value.length;return column},this.getCurrentTokenPosition=function(){return{row:this.$row,column:this.getCurrentTokenColumn()}},this.getCurrentTokenRange=function(){var token=this.$rowTokens[this.$tokenIndex],column=this.getCurrentTokenColumn();return new Range(this.$row,column,this.$row,column+token.value.length)}}).call(TokenIterator.prototype),exports.TokenIterator=TokenIterator})),ace.define("ace/mode/behaviour/cstyle",["require","exports","module","ace/lib/oop","ace/mode/behaviour","ace/token_iterator","ace/lib/lang"],(function(acequire,exports,module){"use strict";var context,oop=acequire("../../lib/oop"),Behaviour=acequire("../behaviour").Behaviour,TokenIterator=acequire("../../token_iterator").TokenIterator,lang=acequire("../../lib/lang"),SAFE_INSERT_IN_TOKENS=["text","paren.rparen","punctuation.operator"],SAFE_INSERT_BEFORE_TOKENS=["text","paren.rparen","punctuation.operator","comment"],contextCache={},defaultQuotes={'"':'"',"'":"'"},initContext=function(editor){var id=-1;if(editor.multiSelect&&(id=editor.selection.index,contextCache.rangeCount!=editor.multiSelect.rangeCount&&(contextCache={rangeCount:editor.multiSelect.rangeCount})),contextCache[id])return context=contextCache[id];context=contextCache[id]={autoInsertedBrackets:0,autoInsertedRow:-1,autoInsertedLineEnd:"",maybeInsertedBrackets:0,maybeInsertedRow:-1,maybeInsertedLineStart:"",maybeInsertedLineEnd:""}},getWrapped=function(selection,selected,opening,closing){var rowDiff=selection.end.row-selection.start.row;return{text:opening+selected+closing,selection:[0,selection.start.column+1,rowDiff,selection.end.column+(rowDiff?0:1)]}},CstyleBehaviour=function(options){this.add("braces","insertion",(function(state,action,editor,session,text){var cursor=editor.getCursorPosition(),line=session.doc.getLine(cursor.row);if("{"==text){initContext(editor);var selection=editor.getSelectionRange(),selected=session.doc.getTextRange(selection);if(""!==selected&&"{"!==selected&&editor.getWrapBehavioursEnabled())return getWrapped(selection,selected,"{","}");if(CstyleBehaviour.isSaneInsertion(editor,session))return/[\]\}\)]/.test(line[cursor.column])||editor.inMultiSelectMode||options&&options.braces?(CstyleBehaviour.recordAutoInsert(editor,session,"}"),{text:"{}",selection:[1,1]}):(CstyleBehaviour.recordMaybeInsert(editor,session,"{"),{text:"{",selection:[1,1]})}else if("}"==text){if(initContext(editor),"}"==line.substring(cursor.column,cursor.column+1))if(null!==session.$findOpeningBracket("}",{column:cursor.column+1,row:cursor.row})&&CstyleBehaviour.isAutoInsertedClosing(cursor,line,text))return CstyleBehaviour.popAutoInsertedClosing(),{text:"",selection:[1,1]}}else{if("\n"==text||"\r\n"==text){initContext(editor);var closing="";if(CstyleBehaviour.isMaybeInsertedClosing(cursor,line)&&(closing=lang.stringRepeat("}",context.maybeInsertedBrackets),CstyleBehaviour.clearMaybeInsertedClosing()),"}"===line.substring(cursor.column,cursor.column+1)){var openBracePos=session.findMatchingBracket({row:cursor.row,column:cursor.column+1},"}");if(!openBracePos)return null;var next_indent=this.$getIndent(session.getLine(openBracePos.row))}else{if(!closing)return void CstyleBehaviour.clearMaybeInsertedClosing();next_indent=this.$getIndent(line)}var indent=next_indent+session.getTabString();return{text:"\n"+indent+"\n"+next_indent+closing,selection:[1,indent.length,1,indent.length]}}CstyleBehaviour.clearMaybeInsertedClosing()}})),this.add("braces","deletion",(function(state,action,editor,session,range){var selected=session.doc.getTextRange(range);if(!range.isMultiLine()&&"{"==selected){if(initContext(editor),"}"==session.doc.getLine(range.start.row).substring(range.end.column,range.end.column+1))return range.end.column++,range;context.maybeInsertedBrackets--}})),this.add("parens","insertion",(function(state,action,editor,session,text){if("("==text){initContext(editor);var selection=editor.getSelectionRange(),selected=session.doc.getTextRange(selection);if(""!==selected&&editor.getWrapBehavioursEnabled())return getWrapped(selection,selected,"(",")");if(CstyleBehaviour.isSaneInsertion(editor,session))return CstyleBehaviour.recordAutoInsert(editor,session,")"),{text:"()",selection:[1,1]}}else if(")"==text){initContext(editor);var cursor=editor.getCursorPosition(),line=session.doc.getLine(cursor.row);if(")"==line.substring(cursor.column,cursor.column+1))if(null!==session.$findOpeningBracket(")",{column:cursor.column+1,row:cursor.row})&&CstyleBehaviour.isAutoInsertedClosing(cursor,line,text))return CstyleBehaviour.popAutoInsertedClosing(),{text:"",selection:[1,1]}}})),this.add("parens","deletion",(function(state,action,editor,session,range){var selected=session.doc.getTextRange(range);if(!range.isMultiLine()&&"("==selected&&(initContext(editor),")"==session.doc.getLine(range.start.row).substring(range.start.column+1,range.start.column+2)))return range.end.column++,range})),this.add("brackets","insertion",(function(state,action,editor,session,text){if("["==text){initContext(editor);var selection=editor.getSelectionRange(),selected=session.doc.getTextRange(selection);if(""!==selected&&editor.getWrapBehavioursEnabled())return getWrapped(selection,selected,"[","]");if(CstyleBehaviour.isSaneInsertion(editor,session))return CstyleBehaviour.recordAutoInsert(editor,session,"]"),{text:"[]",selection:[1,1]}}else if("]"==text){initContext(editor);var cursor=editor.getCursorPosition(),line=session.doc.getLine(cursor.row);if("]"==line.substring(cursor.column,cursor.column+1))if(null!==session.$findOpeningBracket("]",{column:cursor.column+1,row:cursor.row})&&CstyleBehaviour.isAutoInsertedClosing(cursor,line,text))return CstyleBehaviour.popAutoInsertedClosing(),{text:"",selection:[1,1]}}})),this.add("brackets","deletion",(function(state,action,editor,session,range){var selected=session.doc.getTextRange(range);if(!range.isMultiLine()&&"["==selected&&(initContext(editor),"]"==session.doc.getLine(range.start.row).substring(range.start.column+1,range.start.column+2)))return range.end.column++,range})),this.add("string_dquotes","insertion",(function(state,action,editor,session,text){var quotes=session.$mode.$quotes||defaultQuotes;if(1==text.length&&quotes[text]){if(this.lineCommentStart&&-1!=this.lineCommentStart.indexOf(text))return;initContext(editor);var quote=text,selection=editor.getSelectionRange(),selected=session.doc.getTextRange(selection);if(!(""===selected||1==selected.length&&quotes[selected])&&editor.getWrapBehavioursEnabled())return getWrapped(selection,selected,quote,quote);if(!selected){var cursor=editor.getCursorPosition(),line=session.doc.getLine(cursor.row),leftChar=line.substring(cursor.column-1,cursor.column),rightChar=line.substring(cursor.column,cursor.column+1),token=session.getTokenAt(cursor.row,cursor.column),rightToken=session.getTokenAt(cursor.row,cursor.column+1);if("\\"==leftChar&&token&&/escape/.test(token.type))return null;var pair,stringBefore=token&&/string|escape/.test(token.type),stringAfter=!rightToken||/string|escape/.test(rightToken.type);if(rightChar==quote)(pair=stringBefore!==stringAfter)&&/string\.end/.test(rightToken.type)&&(pair=!1);else{if(stringBefore&&!stringAfter)return null;if(stringBefore&&stringAfter)return null;var wordRe=session.$mode.tokenRe;wordRe.lastIndex=0;var isWordBefore=wordRe.test(leftChar);wordRe.lastIndex=0;var isWordAfter=wordRe.test(leftChar);if(isWordBefore||isWordAfter)return null;if(rightChar&&!/[\s;,.})\]\\]/.test(rightChar))return null;pair=!0}return{text:pair?quote+quote:"",selection:[1,1]}}}})),this.add("string_dquotes","deletion",(function(state,action,editor,session,range){var selected=session.doc.getTextRange(range);if(!range.isMultiLine()&&('"'==selected||"'"==selected)&&(initContext(editor),session.doc.getLine(range.start.row).substring(range.start.column+1,range.start.column+2)==selected))return range.end.column++,range}))};CstyleBehaviour.isSaneInsertion=function(editor,session){var cursor=editor.getCursorPosition(),iterator=new TokenIterator(session,cursor.row,cursor.column);if(!this.$matchTokenType(iterator.getCurrentToken()||"text",SAFE_INSERT_IN_TOKENS)){var iterator2=new TokenIterator(session,cursor.row,cursor.column+1);if(!this.$matchTokenType(iterator2.getCurrentToken()||"text",SAFE_INSERT_IN_TOKENS))return!1}return iterator.stepForward(),iterator.getCurrentTokenRow()!==cursor.row||this.$matchTokenType(iterator.getCurrentToken()||"text",SAFE_INSERT_BEFORE_TOKENS)},CstyleBehaviour.$matchTokenType=function(token,types){return types.indexOf(token.type||token)>-1},CstyleBehaviour.recordAutoInsert=function(editor,session,bracket){var cursor=editor.getCursorPosition(),line=session.doc.getLine(cursor.row);this.isAutoInsertedClosing(cursor,line,context.autoInsertedLineEnd[0])||(context.autoInsertedBrackets=0),context.autoInsertedRow=cursor.row,context.autoInsertedLineEnd=bracket+line.substr(cursor.column),context.autoInsertedBrackets++},CstyleBehaviour.recordMaybeInsert=function(editor,session,bracket){var cursor=editor.getCursorPosition(),line=session.doc.getLine(cursor.row);this.isMaybeInsertedClosing(cursor,line)||(context.maybeInsertedBrackets=0),context.maybeInsertedRow=cursor.row,context.maybeInsertedLineStart=line.substr(0,cursor.column)+bracket,context.maybeInsertedLineEnd=line.substr(cursor.column),context.maybeInsertedBrackets++},CstyleBehaviour.isAutoInsertedClosing=function(cursor,line,bracket){return context.autoInsertedBrackets>0&&cursor.row===context.autoInsertedRow&&bracket===context.autoInsertedLineEnd[0]&&line.substr(cursor.column)===context.autoInsertedLineEnd},CstyleBehaviour.isMaybeInsertedClosing=function(cursor,line){return context.maybeInsertedBrackets>0&&cursor.row===context.maybeInsertedRow&&line.substr(cursor.column)===context.maybeInsertedLineEnd&&line.substr(0,cursor.column)==context.maybeInsertedLineStart},CstyleBehaviour.popAutoInsertedClosing=function(){context.autoInsertedLineEnd=context.autoInsertedLineEnd.substr(1),context.autoInsertedBrackets--},CstyleBehaviour.clearMaybeInsertedClosing=function(){context&&(context.maybeInsertedBrackets=0,context.maybeInsertedRow=-1)},oop.inherits(CstyleBehaviour,Behaviour),exports.CstyleBehaviour=CstyleBehaviour})),ace.define("ace/unicode",["require","exports","module"],(function(acequire,exports,module){"use strict";exports.packages={},function(pack){var codePoint=/\w{4}/g;for(var name in pack)exports.packages[name]=pack[name].replace(codePoint,"\\u$&")}({L:"0041-005A0061-007A00AA00B500BA00C0-00D600D8-00F600F8-02C102C6-02D102E0-02E402EC02EE0370-037403760377037A-037D03860388-038A038C038E-03A103A3-03F503F7-0481048A-05250531-055605590561-058705D0-05EA05F0-05F20621-064A066E066F0671-06D306D506E506E606EE06EF06FA-06FC06FF07100712-072F074D-07A507B107CA-07EA07F407F507FA0800-0815081A082408280904-0939093D09500958-0961097109720979-097F0985-098C098F09900993-09A809AA-09B009B209B6-09B909BD09CE09DC09DD09DF-09E109F009F10A05-0A0A0A0F0A100A13-0A280A2A-0A300A320A330A350A360A380A390A59-0A5C0A5E0A72-0A740A85-0A8D0A8F-0A910A93-0AA80AAA-0AB00AB20AB30AB5-0AB90ABD0AD00AE00AE10B05-0B0C0B0F0B100B13-0B280B2A-0B300B320B330B35-0B390B3D0B5C0B5D0B5F-0B610B710B830B85-0B8A0B8E-0B900B92-0B950B990B9A0B9C0B9E0B9F0BA30BA40BA8-0BAA0BAE-0BB90BD00C05-0C0C0C0E-0C100C12-0C280C2A-0C330C35-0C390C3D0C580C590C600C610C85-0C8C0C8E-0C900C92-0CA80CAA-0CB30CB5-0CB90CBD0CDE0CE00CE10D05-0D0C0D0E-0D100D12-0D280D2A-0D390D3D0D600D610D7A-0D7F0D85-0D960D9A-0DB10DB3-0DBB0DBD0DC0-0DC60E01-0E300E320E330E40-0E460E810E820E840E870E880E8A0E8D0E94-0E970E99-0E9F0EA1-0EA30EA50EA70EAA0EAB0EAD-0EB00EB20EB30EBD0EC0-0EC40EC60EDC0EDD0F000F40-0F470F49-0F6C0F88-0F8B1000-102A103F1050-1055105A-105D106110651066106E-10701075-1081108E10A0-10C510D0-10FA10FC1100-1248124A-124D1250-12561258125A-125D1260-1288128A-128D1290-12B012B2-12B512B8-12BE12C012C2-12C512C8-12D612D8-13101312-13151318-135A1380-138F13A0-13F41401-166C166F-167F1681-169A16A0-16EA1700-170C170E-17111720-17311740-17511760-176C176E-17701780-17B317D717DC1820-18771880-18A818AA18B0-18F51900-191C1950-196D1970-19741980-19AB19C1-19C71A00-1A161A20-1A541AA71B05-1B331B45-1B4B1B83-1BA01BAE1BAF1C00-1C231C4D-1C4F1C5A-1C7D1CE9-1CEC1CEE-1CF11D00-1DBF1E00-1F151F18-1F1D1F20-1F451F48-1F4D1F50-1F571F591F5B1F5D1F5F-1F7D1F80-1FB41FB6-1FBC1FBE1FC2-1FC41FC6-1FCC1FD0-1FD31FD6-1FDB1FE0-1FEC1FF2-1FF41FF6-1FFC2071207F2090-209421022107210A-211321152119-211D212421262128212A-212D212F-2139213C-213F2145-2149214E218321842C00-2C2E2C30-2C5E2C60-2CE42CEB-2CEE2D00-2D252D30-2D652D6F2D80-2D962DA0-2DA62DA8-2DAE2DB0-2DB62DB8-2DBE2DC0-2DC62DC8-2DCE2DD0-2DD62DD8-2DDE2E2F300530063031-3035303B303C3041-3096309D-309F30A1-30FA30FC-30FF3105-312D3131-318E31A0-31B731F0-31FF3400-4DB54E00-9FCBA000-A48CA4D0-A4FDA500-A60CA610-A61FA62AA62BA640-A65FA662-A66EA67F-A697A6A0-A6E5A717-A71FA722-A788A78BA78CA7FB-A801A803-A805A807-A80AA80C-A822A840-A873A882-A8B3A8F2-A8F7A8FBA90A-A925A930-A946A960-A97CA984-A9B2A9CFAA00-AA28AA40-AA42AA44-AA4BAA60-AA76AA7AAA80-AAAFAAB1AAB5AAB6AAB9-AABDAAC0AAC2AADB-AADDABC0-ABE2AC00-D7A3D7B0-D7C6D7CB-D7FBF900-FA2DFA30-FA6DFA70-FAD9FB00-FB06FB13-FB17FB1DFB1F-FB28FB2A-FB36FB38-FB3CFB3EFB40FB41FB43FB44FB46-FBB1FBD3-FD3DFD50-FD8FFD92-FDC7FDF0-FDFBFE70-FE74FE76-FEFCFF21-FF3AFF41-FF5AFF66-FFBEFFC2-FFC7FFCA-FFCFFFD2-FFD7FFDA-FFDC",Ll:"0061-007A00AA00B500BA00DF-00F600F8-00FF01010103010501070109010B010D010F01110113011501170119011B011D011F01210123012501270129012B012D012F01310133013501370138013A013C013E014001420144014601480149014B014D014F01510153015501570159015B015D015F01610163016501670169016B016D016F0171017301750177017A017C017E-0180018301850188018C018D019201950199-019B019E01A101A301A501A801AA01AB01AD01B001B401B601B901BA01BD-01BF01C601C901CC01CE01D001D201D401D601D801DA01DC01DD01DF01E101E301E501E701E901EB01ED01EF01F001F301F501F901FB01FD01FF02010203020502070209020B020D020F02110213021502170219021B021D021F02210223022502270229022B022D022F02310233-0239023C023F0240024202470249024B024D024F-02930295-02AF037103730377037B-037D039003AC-03CE03D003D103D5-03D703D903DB03DD03DF03E103E303E503E703E903EB03ED03EF-03F303F503F803FB03FC0430-045F04610463046504670469046B046D046F04710473047504770479047B047D047F0481048B048D048F04910493049504970499049B049D049F04A104A304A504A704A904AB04AD04AF04B104B304B504B704B904BB04BD04BF04C204C404C604C804CA04CC04CE04CF04D104D304D504D704D904DB04DD04DF04E104E304E504E704E904EB04ED04EF04F104F304F504F704F904FB04FD04FF05010503050505070509050B050D050F05110513051505170519051B051D051F0521052305250561-05871D00-1D2B1D62-1D771D79-1D9A1E011E031E051E071E091E0B1E0D1E0F1E111E131E151E171E191E1B1E1D1E1F1E211E231E251E271E291E2B1E2D1E2F1E311E331E351E371E391E3B1E3D1E3F1E411E431E451E471E491E4B1E4D1E4F1E511E531E551E571E591E5B1E5D1E5F1E611E631E651E671E691E6B1E6D1E6F1E711E731E751E771E791E7B1E7D1E7F1E811E831E851E871E891E8B1E8D1E8F1E911E931E95-1E9D1E9F1EA11EA31EA51EA71EA91EAB1EAD1EAF1EB11EB31EB51EB71EB91EBB1EBD1EBF1EC11EC31EC51EC71EC91ECB1ECD1ECF1ED11ED31ED51ED71ED91EDB1EDD1EDF1EE11EE31EE51EE71EE91EEB1EED1EEF1EF11EF31EF51EF71EF91EFB1EFD1EFF-1F071F10-1F151F20-1F271F30-1F371F40-1F451F50-1F571F60-1F671F70-1F7D1F80-1F871F90-1F971FA0-1FA71FB0-1FB41FB61FB71FBE1FC2-1FC41FC61FC71FD0-1FD31FD61FD71FE0-1FE71FF2-1FF41FF61FF7210A210E210F2113212F21342139213C213D2146-2149214E21842C30-2C5E2C612C652C662C682C6A2C6C2C712C732C742C76-2C7C2C812C832C852C872C892C8B2C8D2C8F2C912C932C952C972C992C9B2C9D2C9F2CA12CA32CA52CA72CA92CAB2CAD2CAF2CB12CB32CB52CB72CB92CBB2CBD2CBF2CC12CC32CC52CC72CC92CCB2CCD2CCF2CD12CD32CD52CD72CD92CDB2CDD2CDF2CE12CE32CE42CEC2CEE2D00-2D25A641A643A645A647A649A64BA64DA64FA651A653A655A657A659A65BA65DA65FA663A665A667A669A66BA66DA681A683A685A687A689A68BA68DA68FA691A693A695A697A723A725A727A729A72BA72DA72F-A731A733A735A737A739A73BA73DA73FA741A743A745A747A749A74BA74DA74FA751A753A755A757A759A75BA75DA75FA761A763A765A767A769A76BA76DA76FA771-A778A77AA77CA77FA781A783A785A787A78CFB00-FB06FB13-FB17FF41-FF5A",Lu:"0041-005A00C0-00D600D8-00DE01000102010401060108010A010C010E01100112011401160118011A011C011E01200122012401260128012A012C012E01300132013401360139013B013D013F0141014301450147014A014C014E01500152015401560158015A015C015E01600162016401660168016A016C016E017001720174017601780179017B017D018101820184018601870189-018B018E-0191019301940196-0198019C019D019F01A001A201A401A601A701A901AC01AE01AF01B1-01B301B501B701B801BC01C401C701CA01CD01CF01D101D301D501D701D901DB01DE01E001E201E401E601E801EA01EC01EE01F101F401F6-01F801FA01FC01FE02000202020402060208020A020C020E02100212021402160218021A021C021E02200222022402260228022A022C022E02300232023A023B023D023E02410243-02460248024A024C024E03700372037603860388-038A038C038E038F0391-03A103A3-03AB03CF03D2-03D403D803DA03DC03DE03E003E203E403E603E803EA03EC03EE03F403F703F903FA03FD-042F04600462046404660468046A046C046E04700472047404760478047A047C047E0480048A048C048E04900492049404960498049A049C049E04A004A204A404A604A804AA04AC04AE04B004B204B404B604B804BA04BC04BE04C004C104C304C504C704C904CB04CD04D004D204D404D604D804DA04DC04DE04E004E204E404E604E804EA04EC04EE04F004F204F404F604F804FA04FC04FE05000502050405060508050A050C050E05100512051405160518051A051C051E0520052205240531-055610A0-10C51E001E021E041E061E081E0A1E0C1E0E1E101E121E141E161E181E1A1E1C1E1E1E201E221E241E261E281E2A1E2C1E2E1E301E321E341E361E381E3A1E3C1E3E1E401E421E441E461E481E4A1E4C1E4E1E501E521E541E561E581E5A1E5C1E5E1E601E621E641E661E681E6A1E6C1E6E1E701E721E741E761E781E7A1E7C1E7E1E801E821E841E861E881E8A1E8C1E8E1E901E921E941E9E1EA01EA21EA41EA61EA81EAA1EAC1EAE1EB01EB21EB41EB61EB81EBA1EBC1EBE1EC01EC21EC41EC61EC81ECA1ECC1ECE1ED01ED21ED41ED61ED81EDA1EDC1EDE1EE01EE21EE41EE61EE81EEA1EEC1EEE1EF01EF21EF41EF61EF81EFA1EFC1EFE1F08-1F0F1F18-1F1D1F28-1F2F1F38-1F3F1F48-1F4D1F591F5B1F5D1F5F1F68-1F6F1FB8-1FBB1FC8-1FCB1FD8-1FDB1FE8-1FEC1FF8-1FFB21022107210B-210D2110-211221152119-211D212421262128212A-212D2130-2133213E213F214521832C00-2C2E2C602C62-2C642C672C692C6B2C6D-2C702C722C752C7E-2C802C822C842C862C882C8A2C8C2C8E2C902C922C942C962C982C9A2C9C2C9E2CA02CA22CA42CA62CA82CAA2CAC2CAE2CB02CB22CB42CB62CB82CBA2CBC2CBE2CC02CC22CC42CC62CC82CCA2CCC2CCE2CD02CD22CD42CD62CD82CDA2CDC2CDE2CE02CE22CEB2CEDA640A642A644A646A648A64AA64CA64EA650A652A654A656A658A65AA65CA65EA662A664A666A668A66AA66CA680A682A684A686A688A68AA68CA68EA690A692A694A696A722A724A726A728A72AA72CA72EA732A734A736A738A73AA73CA73EA740A742A744A746A748A74AA74CA74EA750A752A754A756A758A75AA75CA75EA760A762A764A766A768A76AA76CA76EA779A77BA77DA77EA780A782A784A786A78BFF21-FF3A",Lt:"01C501C801CB01F21F88-1F8F1F98-1F9F1FA8-1FAF1FBC1FCC1FFC",Lm:"02B0-02C102C6-02D102E0-02E402EC02EE0374037A0559064006E506E607F407F507FA081A0824082809710E460EC610FC17D718431AA71C78-1C7D1D2C-1D611D781D9B-1DBF2071207F2090-20942C7D2D6F2E2F30053031-3035303B309D309E30FC-30FEA015A4F8-A4FDA60CA67FA717-A71FA770A788A9CFAA70AADDFF70FF9EFF9F",Lo:"01BB01C0-01C3029405D0-05EA05F0-05F20621-063F0641-064A066E066F0671-06D306D506EE06EF06FA-06FC06FF07100712-072F074D-07A507B107CA-07EA0800-08150904-0939093D09500958-096109720979-097F0985-098C098F09900993-09A809AA-09B009B209B6-09B909BD09CE09DC09DD09DF-09E109F009F10A05-0A0A0A0F0A100A13-0A280A2A-0A300A320A330A350A360A380A390A59-0A5C0A5E0A72-0A740A85-0A8D0A8F-0A910A93-0AA80AAA-0AB00AB20AB30AB5-0AB90ABD0AD00AE00AE10B05-0B0C0B0F0B100B13-0B280B2A-0B300B320B330B35-0B390B3D0B5C0B5D0B5F-0B610B710B830B85-0B8A0B8E-0B900B92-0B950B990B9A0B9C0B9E0B9F0BA30BA40BA8-0BAA0BAE-0BB90BD00C05-0C0C0C0E-0C100C12-0C280C2A-0C330C35-0C390C3D0C580C590C600C610C85-0C8C0C8E-0C900C92-0CA80CAA-0CB30CB5-0CB90CBD0CDE0CE00CE10D05-0D0C0D0E-0D100D12-0D280D2A-0D390D3D0D600D610D7A-0D7F0D85-0D960D9A-0DB10DB3-0DBB0DBD0DC0-0DC60E01-0E300E320E330E40-0E450E810E820E840E870E880E8A0E8D0E94-0E970E99-0E9F0EA1-0EA30EA50EA70EAA0EAB0EAD-0EB00EB20EB30EBD0EC0-0EC40EDC0EDD0F000F40-0F470F49-0F6C0F88-0F8B1000-102A103F1050-1055105A-105D106110651066106E-10701075-1081108E10D0-10FA1100-1248124A-124D1250-12561258125A-125D1260-1288128A-128D1290-12B012B2-12B512B8-12BE12C012C2-12C512C8-12D612D8-13101312-13151318-135A1380-138F13A0-13F41401-166C166F-167F1681-169A16A0-16EA1700-170C170E-17111720-17311740-17511760-176C176E-17701780-17B317DC1820-18421844-18771880-18A818AA18B0-18F51900-191C1950-196D1970-19741980-19AB19C1-19C71A00-1A161A20-1A541B05-1B331B45-1B4B1B83-1BA01BAE1BAF1C00-1C231C4D-1C4F1C5A-1C771CE9-1CEC1CEE-1CF12135-21382D30-2D652D80-2D962DA0-2DA62DA8-2DAE2DB0-2DB62DB8-2DBE2DC0-2DC62DC8-2DCE2DD0-2DD62DD8-2DDE3006303C3041-3096309F30A1-30FA30FF3105-312D3131-318E31A0-31B731F0-31FF3400-4DB54E00-9FCBA000-A014A016-A48CA4D0-A4F7A500-A60BA610-A61FA62AA62BA66EA6A0-A6E5A7FB-A801A803-A805A807-A80AA80C-A822A840-A873A882-A8B3A8F2-A8F7A8FBA90A-A925A930-A946A960-A97CA984-A9B2AA00-AA28AA40-AA42AA44-AA4BAA60-AA6FAA71-AA76AA7AAA80-AAAFAAB1AAB5AAB6AAB9-AABDAAC0AAC2AADBAADCABC0-ABE2AC00-D7A3D7B0-D7C6D7CB-D7FBF900-FA2DFA30-FA6DFA70-FAD9FB1DFB1F-FB28FB2A-FB36FB38-FB3CFB3EFB40FB41FB43FB44FB46-FBB1FBD3-FD3DFD50-FD8FFD92-FDC7FDF0-FDFBFE70-FE74FE76-FEFCFF66-FF6FFF71-FF9DFFA0-FFBEFFC2-FFC7FFCA-FFCFFFD2-FFD7FFDA-FFDC",M:"0300-036F0483-04890591-05BD05BF05C105C205C405C505C70610-061A064B-065E067006D6-06DC06DE-06E406E706E806EA-06ED07110730-074A07A6-07B007EB-07F30816-0819081B-08230825-08270829-082D0900-0903093C093E-094E0951-0955096209630981-098309BC09BE-09C409C709C809CB-09CD09D709E209E30A01-0A030A3C0A3E-0A420A470A480A4B-0A4D0A510A700A710A750A81-0A830ABC0ABE-0AC50AC7-0AC90ACB-0ACD0AE20AE30B01-0B030B3C0B3E-0B440B470B480B4B-0B4D0B560B570B620B630B820BBE-0BC20BC6-0BC80BCA-0BCD0BD70C01-0C030C3E-0C440C46-0C480C4A-0C4D0C550C560C620C630C820C830CBC0CBE-0CC40CC6-0CC80CCA-0CCD0CD50CD60CE20CE30D020D030D3E-0D440D46-0D480D4A-0D4D0D570D620D630D820D830DCA0DCF-0DD40DD60DD8-0DDF0DF20DF30E310E34-0E3A0E47-0E4E0EB10EB4-0EB90EBB0EBC0EC8-0ECD0F180F190F350F370F390F3E0F3F0F71-0F840F860F870F90-0F970F99-0FBC0FC6102B-103E1056-1059105E-10601062-10641067-106D1071-10741082-108D108F109A-109D135F1712-17141732-1734175217531772177317B6-17D317DD180B-180D18A91920-192B1930-193B19B0-19C019C819C91A17-1A1B1A55-1A5E1A60-1A7C1A7F1B00-1B041B34-1B441B6B-1B731B80-1B821BA1-1BAA1C24-1C371CD0-1CD21CD4-1CE81CED1CF21DC0-1DE61DFD-1DFF20D0-20F02CEF-2CF12DE0-2DFF302A-302F3099309AA66F-A672A67CA67DA6F0A6F1A802A806A80BA823-A827A880A881A8B4-A8C4A8E0-A8F1A926-A92DA947-A953A980-A983A9B3-A9C0AA29-AA36AA43AA4CAA4DAA7BAAB0AAB2-AAB4AAB7AAB8AABEAABFAAC1ABE3-ABEAABECABEDFB1EFE00-FE0FFE20-FE26",Mn:"0300-036F0483-04870591-05BD05BF05C105C205C405C505C70610-061A064B-065E067006D6-06DC06DF-06E406E706E806EA-06ED07110730-074A07A6-07B007EB-07F30816-0819081B-08230825-08270829-082D0900-0902093C0941-0948094D0951-095509620963098109BC09C1-09C409CD09E209E30A010A020A3C0A410A420A470A480A4B-0A4D0A510A700A710A750A810A820ABC0AC1-0AC50AC70AC80ACD0AE20AE30B010B3C0B3F0B41-0B440B4D0B560B620B630B820BC00BCD0C3E-0C400C46-0C480C4A-0C4D0C550C560C620C630CBC0CBF0CC60CCC0CCD0CE20CE30D41-0D440D4D0D620D630DCA0DD2-0DD40DD60E310E34-0E3A0E47-0E4E0EB10EB4-0EB90EBB0EBC0EC8-0ECD0F180F190F350F370F390F71-0F7E0F80-0F840F860F870F90-0F970F99-0FBC0FC6102D-10301032-10371039103A103D103E10581059105E-10601071-1074108210851086108D109D135F1712-17141732-1734175217531772177317B7-17BD17C617C9-17D317DD180B-180D18A91920-19221927192819321939-193B1A171A181A561A58-1A5E1A601A621A65-1A6C1A73-1A7C1A7F1B00-1B031B341B36-1B3A1B3C1B421B6B-1B731B801B811BA2-1BA51BA81BA91C2C-1C331C361C371CD0-1CD21CD4-1CE01CE2-1CE81CED1DC0-1DE61DFD-1DFF20D0-20DC20E120E5-20F02CEF-2CF12DE0-2DFF302A-302F3099309AA66FA67CA67DA6F0A6F1A802A806A80BA825A826A8C4A8E0-A8F1A926-A92DA947-A951A980-A982A9B3A9B6-A9B9A9BCAA29-AA2EAA31AA32AA35AA36AA43AA4CAAB0AAB2-AAB4AAB7AAB8AABEAABFAAC1ABE5ABE8ABEDFB1EFE00-FE0FFE20-FE26",Mc:"0903093E-09400949-094C094E0982098309BE-09C009C709C809CB09CC09D70A030A3E-0A400A830ABE-0AC00AC90ACB0ACC0B020B030B3E0B400B470B480B4B0B4C0B570BBE0BBF0BC10BC20BC6-0BC80BCA-0BCC0BD70C01-0C030C41-0C440C820C830CBE0CC0-0CC40CC70CC80CCA0CCB0CD50CD60D020D030D3E-0D400D46-0D480D4A-0D4C0D570D820D830DCF-0DD10DD8-0DDF0DF20DF30F3E0F3F0F7F102B102C10311038103B103C105610571062-10641067-106D108310841087-108C108F109A-109C17B617BE-17C517C717C81923-19261929-192B193019311933-193819B0-19C019C819C91A19-1A1B1A551A571A611A631A641A6D-1A721B041B351B3B1B3D-1B411B431B441B821BA11BA61BA71BAA1C24-1C2B1C341C351CE11CF2A823A824A827A880A881A8B4-A8C3A952A953A983A9B4A9B5A9BAA9BBA9BD-A9C0AA2FAA30AA33AA34AA4DAA7BABE3ABE4ABE6ABE7ABE9ABEAABEC",Me:"0488048906DE20DD-20E020E2-20E4A670-A672",N:"0030-003900B200B300B900BC-00BE0660-066906F0-06F907C0-07C90966-096F09E6-09EF09F4-09F90A66-0A6F0AE6-0AEF0B66-0B6F0BE6-0BF20C66-0C6F0C78-0C7E0CE6-0CEF0D66-0D750E50-0E590ED0-0ED90F20-0F331040-10491090-10991369-137C16EE-16F017E0-17E917F0-17F91810-18191946-194F19D0-19DA1A80-1A891A90-1A991B50-1B591BB0-1BB91C40-1C491C50-1C5920702074-20792080-20892150-21822185-21892460-249B24EA-24FF2776-27932CFD30073021-30293038-303A3192-31953220-32293251-325F3280-328932B1-32BFA620-A629A6E6-A6EFA830-A835A8D0-A8D9A900-A909A9D0-A9D9AA50-AA59ABF0-ABF9FF10-FF19",Nd:"0030-00390660-066906F0-06F907C0-07C90966-096F09E6-09EF0A66-0A6F0AE6-0AEF0B66-0B6F0BE6-0BEF0C66-0C6F0CE6-0CEF0D66-0D6F0E50-0E590ED0-0ED90F20-0F291040-10491090-109917E0-17E91810-18191946-194F19D0-19DA1A80-1A891A90-1A991B50-1B591BB0-1BB91C40-1C491C50-1C59A620-A629A8D0-A8D9A900-A909A9D0-A9D9AA50-AA59ABF0-ABF9FF10-FF19",Nl:"16EE-16F02160-21822185-218830073021-30293038-303AA6E6-A6EF",No:"00B200B300B900BC-00BE09F4-09F90BF0-0BF20C78-0C7E0D70-0D750F2A-0F331369-137C17F0-17F920702074-20792080-20892150-215F21892460-249B24EA-24FF2776-27932CFD3192-31953220-32293251-325F3280-328932B1-32BFA830-A835",P:"0021-00230025-002A002C-002F003A003B003F0040005B-005D005F007B007D00A100AB00B700BB00BF037E0387055A-055F0589058A05BE05C005C305C605F305F40609060A060C060D061B061E061F066A-066D06D40700-070D07F7-07F90830-083E0964096509700DF40E4F0E5A0E5B0F04-0F120F3A-0F3D0F850FD0-0FD4104A-104F10FB1361-13681400166D166E169B169C16EB-16ED1735173617D4-17D617D8-17DA1800-180A1944194519DE19DF1A1E1A1F1AA0-1AA61AA8-1AAD1B5A-1B601C3B-1C3F1C7E1C7F1CD32010-20272030-20432045-20512053-205E207D207E208D208E2329232A2768-277527C527C627E6-27EF2983-299829D8-29DB29FC29FD2CF9-2CFC2CFE2CFF2E00-2E2E2E302E313001-30033008-30113014-301F3030303D30A030FBA4FEA4FFA60D-A60FA673A67EA6F2-A6F7A874-A877A8CEA8CFA8F8-A8FAA92EA92FA95FA9C1-A9CDA9DEA9DFAA5C-AA5FAADEAADFABEBFD3EFD3FFE10-FE19FE30-FE52FE54-FE61FE63FE68FE6AFE6BFF01-FF03FF05-FF0AFF0C-FF0FFF1AFF1BFF1FFF20FF3B-FF3DFF3FFF5BFF5DFF5F-FF65",Pd:"002D058A05BE140018062010-20152E172E1A301C303030A0FE31FE32FE58FE63FF0D",Ps:"0028005B007B0F3A0F3C169B201A201E2045207D208D23292768276A276C276E27702772277427C527E627E827EA27EC27EE2983298529872989298B298D298F299129932995299729D829DA29FC2E222E242E262E283008300A300C300E3010301430163018301A301DFD3EFE17FE35FE37FE39FE3BFE3DFE3FFE41FE43FE47FE59FE5BFE5DFF08FF3BFF5BFF5FFF62",Pe:"0029005D007D0F3B0F3D169C2046207E208E232A2769276B276D276F27712773277527C627E727E927EB27ED27EF298429862988298A298C298E2990299229942996299829D929DB29FD2E232E252E272E293009300B300D300F3011301530173019301B301E301FFD3FFE18FE36FE38FE3AFE3CFE3EFE40FE42FE44FE48FE5AFE5CFE5EFF09FF3DFF5DFF60FF63",Pi:"00AB2018201B201C201F20392E022E042E092E0C2E1C2E20",Pf:"00BB2019201D203A2E032E052E0A2E0D2E1D2E21",Pc:"005F203F20402054FE33FE34FE4D-FE4FFF3F",Po:"0021-00230025-0027002A002C002E002F003A003B003F0040005C00A100B700BF037E0387055A-055F058905C005C305C605F305F40609060A060C060D061B061E061F066A-066D06D40700-070D07F7-07F90830-083E0964096509700DF40E4F0E5A0E5B0F04-0F120F850FD0-0FD4104A-104F10FB1361-1368166D166E16EB-16ED1735173617D4-17D617D8-17DA1800-18051807-180A1944194519DE19DF1A1E1A1F1AA0-1AA61AA8-1AAD1B5A-1B601C3B-1C3F1C7E1C7F1CD3201620172020-20272030-2038203B-203E2041-20432047-205120532055-205E2CF9-2CFC2CFE2CFF2E002E012E06-2E082E0B2E0E-2E162E182E192E1B2E1E2E1F2E2A-2E2E2E302E313001-3003303D30FBA4FEA4FFA60D-A60FA673A67EA6F2-A6F7A874-A877A8CEA8CFA8F8-A8FAA92EA92FA95FA9C1-A9CDA9DEA9DFAA5C-AA5FAADEAADFABEBFE10-FE16FE19FE30FE45FE46FE49-FE4CFE50-FE52FE54-FE57FE5F-FE61FE68FE6AFE6BFF01-FF03FF05-FF07FF0AFF0CFF0EFF0FFF1AFF1BFF1FFF20FF3CFF61FF64FF65",S:"0024002B003C-003E005E0060007C007E00A2-00A900AC00AE-00B100B400B600B800D700F702C2-02C502D2-02DF02E5-02EB02ED02EF-02FF03750384038503F604820606-0608060B060E060F06E906FD06FE07F609F209F309FA09FB0AF10B700BF3-0BFA0C7F0CF10CF20D790E3F0F01-0F030F13-0F170F1A-0F1F0F340F360F380FBE-0FC50FC7-0FCC0FCE0FCF0FD5-0FD8109E109F13601390-139917DB194019E0-19FF1B61-1B6A1B74-1B7C1FBD1FBF-1FC11FCD-1FCF1FDD-1FDF1FED-1FEF1FFD1FFE20442052207A-207C208A-208C20A0-20B8210021012103-21062108210921142116-2118211E-2123212521272129212E213A213B2140-2144214A-214D214F2190-2328232B-23E82400-24262440-244A249C-24E92500-26CD26CF-26E126E326E8-26FF2701-27042706-2709270C-27272729-274B274D274F-27522756-275E2761-276727942798-27AF27B1-27BE27C0-27C427C7-27CA27CC27D0-27E527F0-29822999-29D729DC-29FB29FE-2B4C2B50-2B592CE5-2CEA2E80-2E992E9B-2EF32F00-2FD52FF0-2FFB300430123013302030363037303E303F309B309C319031913196-319F31C0-31E33200-321E322A-32503260-327F328A-32B032C0-32FE3300-33FF4DC0-4DFFA490-A4C6A700-A716A720A721A789A78AA828-A82BA836-A839AA77-AA79FB29FDFCFDFDFE62FE64-FE66FE69FF04FF0BFF1C-FF1EFF3EFF40FF5CFF5EFFE0-FFE6FFE8-FFEEFFFCFFFD",Sm:"002B003C-003E007C007E00AC00B100D700F703F60606-060820442052207A-207C208A-208C2140-2144214B2190-2194219A219B21A021A321A621AE21CE21CF21D221D421F4-22FF2308-230B23202321237C239B-23B323DC-23E125B725C125F8-25FF266F27C0-27C427C7-27CA27CC27D0-27E527F0-27FF2900-29822999-29D729DC-29FB29FE-2AFF2B30-2B442B47-2B4CFB29FE62FE64-FE66FF0BFF1C-FF1EFF5CFF5EFFE2FFE9-FFEC",Sc:"002400A2-00A5060B09F209F309FB0AF10BF90E3F17DB20A0-20B8A838FDFCFE69FF04FFE0FFE1FFE5FFE6",Sk:"005E006000A800AF00B400B802C2-02C502D2-02DF02E5-02EB02ED02EF-02FF0375038403851FBD1FBF-1FC11FCD-1FCF1FDD-1FDF1FED-1FEF1FFD1FFE309B309CA700-A716A720A721A789A78AFF3EFF40FFE3",So:"00A600A700A900AE00B000B60482060E060F06E906FD06FE07F609FA0B700BF3-0BF80BFA0C7F0CF10CF20D790F01-0F030F13-0F170F1A-0F1F0F340F360F380FBE-0FC50FC7-0FCC0FCE0FCF0FD5-0FD8109E109F13601390-1399194019E0-19FF1B61-1B6A1B74-1B7C210021012103-21062108210921142116-2118211E-2123212521272129212E213A213B214A214C214D214F2195-2199219C-219F21A121A221A421A521A7-21AD21AF-21CD21D021D121D321D5-21F32300-2307230C-231F2322-2328232B-237B237D-239A23B4-23DB23E2-23E82400-24262440-244A249C-24E92500-25B625B8-25C025C2-25F72600-266E2670-26CD26CF-26E126E326E8-26FF2701-27042706-2709270C-27272729-274B274D274F-27522756-275E2761-276727942798-27AF27B1-27BE2800-28FF2B00-2B2F2B452B462B50-2B592CE5-2CEA2E80-2E992E9B-2EF32F00-2FD52FF0-2FFB300430123013302030363037303E303F319031913196-319F31C0-31E33200-321E322A-32503260-327F328A-32B032C0-32FE3300-33FF4DC0-4DFFA490-A4C6A828-A82BA836A837A839AA77-AA79FDFDFFE4FFE8FFEDFFEEFFFCFFFD",Z:"002000A01680180E2000-200A20282029202F205F3000",Zs:"002000A01680180E2000-200A202F205F3000",Zl:"2028",Zp:"2029",C:"0000-001F007F-009F00AD03780379037F-0383038B038D03A20526-05300557055805600588058B-059005C8-05CF05EB-05EF05F5-0605061C061D0620065F06DD070E070F074B074C07B2-07BF07FB-07FF082E082F083F-08FF093A093B094F095609570973-097809800984098D098E0991099209A909B109B3-09B509BA09BB09C509C609C909CA09CF-09D609D8-09DB09DE09E409E509FC-0A000A040A0B-0A0E0A110A120A290A310A340A370A3A0A3B0A3D0A43-0A460A490A4A0A4E-0A500A52-0A580A5D0A5F-0A650A76-0A800A840A8E0A920AA90AB10AB40ABA0ABB0AC60ACA0ACE0ACF0AD1-0ADF0AE40AE50AF00AF2-0B000B040B0D0B0E0B110B120B290B310B340B3A0B3B0B450B460B490B4A0B4E-0B550B58-0B5B0B5E0B640B650B72-0B810B840B8B-0B8D0B910B96-0B980B9B0B9D0BA0-0BA20BA5-0BA70BAB-0BAD0BBA-0BBD0BC3-0BC50BC90BCE0BCF0BD1-0BD60BD8-0BE50BFB-0C000C040C0D0C110C290C340C3A-0C3C0C450C490C4E-0C540C570C5A-0C5F0C640C650C70-0C770C800C810C840C8D0C910CA90CB40CBA0CBB0CC50CC90CCE-0CD40CD7-0CDD0CDF0CE40CE50CF00CF3-0D010D040D0D0D110D290D3A-0D3C0D450D490D4E-0D560D58-0D5F0D640D650D76-0D780D800D810D840D97-0D990DB20DBC0DBE0DBF0DC7-0DC90DCB-0DCE0DD50DD70DE0-0DF10DF5-0E000E3B-0E3E0E5C-0E800E830E850E860E890E8B0E8C0E8E-0E930E980EA00EA40EA60EA80EA90EAC0EBA0EBE0EBF0EC50EC70ECE0ECF0EDA0EDB0EDE-0EFF0F480F6D-0F700F8C-0F8F0F980FBD0FCD0FD9-0FFF10C6-10CF10FD-10FF1249124E124F12571259125E125F1289128E128F12B112B612B712BF12C112C612C712D7131113161317135B-135E137D-137F139A-139F13F5-13FF169D-169F16F1-16FF170D1715-171F1737-173F1754-175F176D17711774-177F17B417B517DE17DF17EA-17EF17FA-17FF180F181A-181F1878-187F18AB-18AF18F6-18FF191D-191F192C-192F193C-193F1941-1943196E196F1975-197F19AC-19AF19CA-19CF19DB-19DD1A1C1A1D1A5F1A7D1A7E1A8A-1A8F1A9A-1A9F1AAE-1AFF1B4C-1B4F1B7D-1B7F1BAB-1BAD1BBA-1BFF1C38-1C3A1C4A-1C4C1C80-1CCF1CF3-1CFF1DE7-1DFC1F161F171F1E1F1F1F461F471F4E1F4F1F581F5A1F5C1F5E1F7E1F7F1FB51FC51FD41FD51FDC1FF01FF11FF51FFF200B-200F202A-202E2060-206F20722073208F2095-209F20B9-20CF20F1-20FF218A-218F23E9-23FF2427-243F244B-245F26CE26E226E4-26E727002705270A270B2728274C274E2753-2755275F27602795-279727B027BF27CB27CD-27CF2B4D-2B4F2B5A-2BFF2C2F2C5F2CF2-2CF82D26-2D2F2D66-2D6E2D70-2D7F2D97-2D9F2DA72DAF2DB72DBF2DC72DCF2DD72DDF2E32-2E7F2E9A2EF4-2EFF2FD6-2FEF2FFC-2FFF3040309730983100-3104312E-3130318F31B8-31BF31E4-31EF321F32FF4DB6-4DBF9FCC-9FFFA48D-A48FA4C7-A4CFA62C-A63FA660A661A674-A67BA698-A69FA6F8-A6FFA78D-A7FAA82C-A82FA83A-A83FA878-A87FA8C5-A8CDA8DA-A8DFA8FC-A8FFA954-A95EA97D-A97FA9CEA9DA-A9DDA9E0-A9FFAA37-AA3FAA4EAA4FAA5AAA5BAA7C-AA7FAAC3-AADAAAE0-ABBFABEEABEFABFA-ABFFD7A4-D7AFD7C7-D7CAD7FC-F8FFFA2EFA2FFA6EFA6FFADA-FAFFFB07-FB12FB18-FB1CFB37FB3DFB3FFB42FB45FBB2-FBD2FD40-FD4FFD90FD91FDC8-FDEFFDFEFDFFFE1A-FE1FFE27-FE2FFE53FE67FE6C-FE6FFE75FEFD-FF00FFBF-FFC1FFC8FFC9FFD0FFD1FFD8FFD9FFDD-FFDFFFE7FFEF-FFFBFFFEFFFF",Cc:"0000-001F007F-009F",Cf:"00AD0600-060306DD070F17B417B5200B-200F202A-202E2060-2064206A-206FFEFFFFF9-FFFB",Co:"E000-F8FF",Cs:"D800-DFFF",Cn:"03780379037F-0383038B038D03A20526-05300557055805600588058B-059005C8-05CF05EB-05EF05F5-05FF06040605061C061D0620065F070E074B074C07B2-07BF07FB-07FF082E082F083F-08FF093A093B094F095609570973-097809800984098D098E0991099209A909B109B3-09B509BA09BB09C509C609C909CA09CF-09D609D8-09DB09DE09E409E509FC-0A000A040A0B-0A0E0A110A120A290A310A340A370A3A0A3B0A3D0A43-0A460A490A4A0A4E-0A500A52-0A580A5D0A5F-0A650A76-0A800A840A8E0A920AA90AB10AB40ABA0ABB0AC60ACA0ACE0ACF0AD1-0ADF0AE40AE50AF00AF2-0B000B040B0D0B0E0B110B120B290B310B340B3A0B3B0B450B460B490B4A0B4E-0B550B58-0B5B0B5E0B640B650B72-0B810B840B8B-0B8D0B910B96-0B980B9B0B9D0BA0-0BA20BA5-0BA70BAB-0BAD0BBA-0BBD0BC3-0BC50BC90BCE0BCF0BD1-0BD60BD8-0BE50BFB-0C000C040C0D0C110C290C340C3A-0C3C0C450C490C4E-0C540C570C5A-0C5F0C640C650C70-0C770C800C810C840C8D0C910CA90CB40CBA0CBB0CC50CC90CCE-0CD40CD7-0CDD0CDF0CE40CE50CF00CF3-0D010D040D0D0D110D290D3A-0D3C0D450D490D4E-0D560D58-0D5F0D640D650D76-0D780D800D810D840D97-0D990DB20DBC0DBE0DBF0DC7-0DC90DCB-0DCE0DD50DD70DE0-0DF10DF5-0E000E3B-0E3E0E5C-0E800E830E850E860E890E8B0E8C0E8E-0E930E980EA00EA40EA60EA80EA90EAC0EBA0EBE0EBF0EC50EC70ECE0ECF0EDA0EDB0EDE-0EFF0F480F6D-0F700F8C-0F8F0F980FBD0FCD0FD9-0FFF10C6-10CF10FD-10FF1249124E124F12571259125E125F1289128E128F12B112B612B712BF12C112C612C712D7131113161317135B-135E137D-137F139A-139F13F5-13FF169D-169F16F1-16FF170D1715-171F1737-173F1754-175F176D17711774-177F17DE17DF17EA-17EF17FA-17FF180F181A-181F1878-187F18AB-18AF18F6-18FF191D-191F192C-192F193C-193F1941-1943196E196F1975-197F19AC-19AF19CA-19CF19DB-19DD1A1C1A1D1A5F1A7D1A7E1A8A-1A8F1A9A-1A9F1AAE-1AFF1B4C-1B4F1B7D-1B7F1BAB-1BAD1BBA-1BFF1C38-1C3A1C4A-1C4C1C80-1CCF1CF3-1CFF1DE7-1DFC1F161F171F1E1F1F1F461F471F4E1F4F1F581F5A1F5C1F5E1F7E1F7F1FB51FC51FD41FD51FDC1FF01FF11FF51FFF2065-206920722073208F2095-209F20B9-20CF20F1-20FF218A-218F23E9-23FF2427-243F244B-245F26CE26E226E4-26E727002705270A270B2728274C274E2753-2755275F27602795-279727B027BF27CB27CD-27CF2B4D-2B4F2B5A-2BFF2C2F2C5F2CF2-2CF82D26-2D2F2D66-2D6E2D70-2D7F2D97-2D9F2DA72DAF2DB72DBF2DC72DCF2DD72DDF2E32-2E7F2E9A2EF4-2EFF2FD6-2FEF2FFC-2FFF3040309730983100-3104312E-3130318F31B8-31BF31E4-31EF321F32FF4DB6-4DBF9FCC-9FFFA48D-A48FA4C7-A4CFA62C-A63FA660A661A674-A67BA698-A69FA6F8-A6FFA78D-A7FAA82C-A82FA83A-A83FA878-A87FA8C5-A8CDA8DA-A8DFA8FC-A8FFA954-A95EA97D-A97FA9CEA9DA-A9DDA9E0-A9FFAA37-AA3FAA4EAA4FAA5AAA5BAA7C-AA7FAAC3-AADAAAE0-ABBFABEEABEFABFA-ABFFD7A4-D7AFD7C7-D7CAD7FC-D7FFFA2EFA2FFA6EFA6FFADA-FAFFFB07-FB12FB18-FB1CFB37FB3DFB3FFB42FB45FBB2-FBD2FD40-FD4FFD90FD91FDC8-FDEFFDFEFDFFFE1A-FE1FFE27-FE2FFE53FE67FE6C-FE6FFE75FEFDFEFEFF00FFBF-FFC1FFC8FFC9FFD0FFD1FFD8FFD9FFDD-FFDFFFE7FFEF-FFF8FFFEFFFF"})})),ace.define("ace/mode/text",["require","exports","module","ace/tokenizer","ace/mode/text_highlight_rules","ace/mode/behaviour/cstyle","ace/unicode","ace/lib/lang","ace/token_iterator","ace/range"],(function(acequire,exports,module){"use strict";var Tokenizer=acequire("../tokenizer").Tokenizer,TextHighlightRules=acequire("./text_highlight_rules").TextHighlightRules,CstyleBehaviour=acequire("./behaviour/cstyle").CstyleBehaviour,unicode=acequire("../unicode"),lang=acequire("../lib/lang"),TokenIterator=acequire("../token_iterator").TokenIterator,Range=acequire("../range").Range,Mode=function(){this.HighlightRules=TextHighlightRules};(function(){this.$defaultBehaviour=new CstyleBehaviour,this.tokenRe=new RegExp("^["+unicode.packages.L+unicode.packages.Mn+unicode.packages.Mc+unicode.packages.Nd+unicode.packages.Pc+"\\$_]+","g"),this.nonTokenRe=new RegExp("^(?:[^"+unicode.packages.L+unicode.packages.Mn+unicode.packages.Mc+unicode.packages.Nd+unicode.packages.Pc+"\\$_]|\\s])+","g"),this.getTokenizer=function(){return this.$tokenizer||(this.$highlightRules=this.$highlightRules||new this.HighlightRules(this.$highlightRuleConfig),this.$tokenizer=new Tokenizer(this.$highlightRules.getRules())),this.$tokenizer},this.lineCommentStart="",this.blockComment="",this.toggleCommentLines=function(state,session,startRow,endRow){var doc=session.doc,ignoreBlankLines=!0,shouldRemove=!0,minIndent=1/0,tabSize=session.getTabSize(),insertAtTabStop=!1;if(this.lineCommentStart){if(Array.isArray(this.lineCommentStart))regexpStart=this.lineCommentStart.map(lang.escapeRegExp).join("|"),lineCommentStart=this.lineCommentStart[0];else regexpStart=lang.escapeRegExp(this.lineCommentStart),lineCommentStart=this.lineCommentStart;regexpStart=new RegExp("^(\\s*)(?:"+regexpStart+") ?"),insertAtTabStop=session.getUseSoftTabs();uncomment=function(line,i){var m=line.match(regexpStart);if(m){var start=m[1].length,end=m[0].length;shouldInsertSpace(line,start,end)||" "!=m[0][end-1]||end--,doc.removeInLine(i,start,end)}};var commentWithSpace=lineCommentStart+" ",shouldInsertSpace=(comment=function(line,i){ignoreBlankLines&&!/\S/.test(line)||(shouldInsertSpace(line,minIndent,minIndent)?doc.insertInLine({row:i,column:minIndent},commentWithSpace):doc.insertInLine({row:i,column:minIndent},lineCommentStart))},testRemove=function(line,i){return regexpStart.test(line)},function(line,before,after){for(var spaces=0;before--&&" "==line.charAt(before);)spaces++;if(spaces%tabSize!=0)return!1;for(spaces=0;" "==line.charAt(after++);)spaces++;return tabSize>2?spaces%tabSize!=tabSize-1:spaces%tabSize==0})}else{if(!this.blockComment)return!1;var lineCommentStart=this.blockComment.start,lineCommentEnd=this.blockComment.end,regexpStart=new RegExp("^(\\s*)(?:"+lang.escapeRegExp(lineCommentStart)+")"),regexpEnd=new RegExp("(?:"+lang.escapeRegExp(lineCommentEnd)+")\\s*$"),comment=function(line,i){testRemove(line,i)||ignoreBlankLines&&!/\S/.test(line)||(doc.insertInLine({row:i,column:line.length},lineCommentEnd),doc.insertInLine({row:i,column:minIndent},lineCommentStart))},uncomment=function(line,i){var m;(m=line.match(regexpEnd))&&doc.removeInLine(i,line.length-m[0].length,line.length),(m=line.match(regexpStart))&&doc.removeInLine(i,m[1].length,m[0].length)},testRemove=function(line,row){if(regexpStart.test(line))return!0;for(var tokens=session.getTokens(row),i=0;i<tokens.length;i++)if("comment"===tokens[i].type)return!0}}function iter(fun){for(var i=startRow;i<=endRow;i++)fun(doc.getLine(i),i)}var minEmptyLength=1/0;iter((function(line,i){var indent=line.search(/\S/);-1!==indent?(indent<minIndent&&(minIndent=indent),shouldRemove&&!testRemove(line,i)&&(shouldRemove=!1)):minEmptyLength>line.length&&(minEmptyLength=line.length)})),minIndent==1/0&&(minIndent=minEmptyLength,ignoreBlankLines=!1,shouldRemove=!1),insertAtTabStop&&minIndent%tabSize!=0&&(minIndent=Math.floor(minIndent/tabSize)*tabSize),iter(shouldRemove?uncomment:comment)},this.toggleBlockComment=function(state,session,range,cursor){var comment=this.blockComment;if(comment){!comment.start&&comment[0]&&(comment=comment[0]);var startRow,colDiff,token=(iterator=new TokenIterator(session,cursor.row,cursor.column)).getCurrentToken(),initialRange=(session.selection,session.selection.toOrientedRange());if(token&&/comment/.test(token.type)){for(var startRange,endRange;token&&/comment/.test(token.type);){if(-1!=(i=token.value.indexOf(comment.start))){var row=iterator.getCurrentTokenRow(),column=iterator.getCurrentTokenColumn()+i;startRange=new Range(row,column,row,column+comment.start.length);break}token=iterator.stepBackward()}var iterator;for(token=(iterator=new TokenIterator(session,cursor.row,cursor.column)).getCurrentToken();token&&/comment/.test(token.type);){var i;if(-1!=(i=token.value.indexOf(comment.end))){row=iterator.getCurrentTokenRow(),column=iterator.getCurrentTokenColumn()+i;endRange=new Range(row,column,row,column+comment.end.length);break}token=iterator.stepForward()}endRange&&session.remove(endRange),startRange&&(session.remove(startRange),startRow=startRange.start.row,colDiff=-comment.start.length)}else colDiff=comment.start.length,startRow=range.start.row,session.insert(range.end,comment.end),session.insert(range.start,comment.start);initialRange.start.row==startRow&&(initialRange.start.column+=colDiff),initialRange.end.row==startRow&&(initialRange.end.column+=colDiff),session.selection.fromOrientedRange(initialRange)}},this.getNextLineIndent=function(state,line,tab){return this.$getIndent(line)},this.checkOutdent=function(state,line,input){return!1},this.autoOutdent=function(state,doc,row){},this.$getIndent=function(line){return line.match(/^\s*/)[0]},this.createWorker=function(session){return null},this.createModeDelegates=function(mapping){for(var i in this.$embeds=[],this.$modes={},mapping)mapping[i]&&(this.$embeds.push(i),this.$modes[i]=new mapping[i]);var delegations=["toggleBlockComment","toggleCommentLines","getNextLineIndent","checkOutdent","autoOutdent","transformAction","getCompletions"];for(i=0;i<delegations.length;i++)!function(scope){var functionName=delegations[i],defaultHandler=scope[functionName];scope[delegations[i]]=function(){return this.$delegator(functionName,arguments,defaultHandler)}}(this)},this.$delegator=function(method,args,defaultHandler){var state=args[0];"string"!=typeof state&&(state=state[0]);for(var i=0;i<this.$embeds.length;i++)if(this.$modes[this.$embeds[i]]){var split=state.split(this.$embeds[i]);if(!split[0]&&split[1]){args[0]=split[1];var mode=this.$modes[this.$embeds[i]];return mode[method].apply(mode,args)}}var ret=defaultHandler.apply(this,args);return defaultHandler?ret:void 0},this.transformAction=function(state,action,editor,session,param){if(this.$behaviour){var behaviours=this.$behaviour.getBehaviours();for(var key in behaviours)if(behaviours[key][action]){var ret=behaviours[key][action].apply(this,arguments);if(ret)return ret}}},this.getKeywords=function(append){if(!this.completionKeywords){var rules=this.$tokenizer.rules,completionKeywords=[];for(var rule in rules)for(var ruleItr=rules[rule],r=0,l=ruleItr.length;r<l;r++)if("string"==typeof ruleItr[r].token)/keyword|support|storage/.test(ruleItr[r].token)&&completionKeywords.push(ruleItr[r].regex);else if("object"==typeof ruleItr[r].token)for(var a=0,aLength=ruleItr[r].token.length;a<aLength;a++)if(/keyword|support|storage/.test(ruleItr[r].token[a])){rule=ruleItr[r].regex.match(/\(.+?\)/g)[a];completionKeywords.push(rule.substr(1,rule.length-2))}this.completionKeywords=completionKeywords}return append?completionKeywords.concat(this.$keywordList||[]):this.$keywordList},this.$createKeywordList=function(){return this.$highlightRules||this.getTokenizer(),this.$keywordList=this.$highlightRules.$keywordList||[]},this.getCompletions=function(state,session,pos,prefix){return(this.$keywordList||this.$createKeywordList()).map((function(word){return{name:word,value:word,score:0,meta:"keyword"}}))},this.$id="ace/mode/text"}).call(Mode.prototype),exports.Mode=Mode})),ace.define("ace/apply_delta",["require","exports","module"],(function(acequire,exports,module){"use strict";exports.applyDelta=function(docLines,delta,doNotValidate){var row=delta.start.row,startColumn=delta.start.column,line=docLines[row]||"";switch(delta.action){case"insert":if(1===delta.lines.length)docLines[row]=line.substring(0,startColumn)+delta.lines[0]+line.substring(startColumn);else{var args=[row,1].concat(delta.lines);docLines.splice.apply(docLines,args),docLines[row]=line.substring(0,startColumn)+docLines[row],docLines[row+delta.lines.length-1]+=line.substring(startColumn)}break;case"remove":var endColumn=delta.end.column,endRow=delta.end.row;row===endRow?docLines[row]=line.substring(0,startColumn)+line.substring(endColumn):docLines.splice(row,endRow-row+1,line.substring(0,startColumn)+docLines[endRow].substring(endColumn))}}})),ace.define("ace/anchor",["require","exports","module","ace/lib/oop","ace/lib/event_emitter"],(function(acequire,exports,module){"use strict";var oop=acequire("./lib/oop"),EventEmitter=acequire("./lib/event_emitter").EventEmitter,Anchor=exports.Anchor=function(doc,row,column){this.$onChange=this.onChange.bind(this),this.attach(doc),void 0===column?this.setPosition(row.row,row.column):this.setPosition(row,column)};(function(){function $pointsInOrder(point1,point2,equalPointsInOrder){var bColIsAfter=equalPointsInOrder?point1.column<=point2.column:point1.column<point2.column;return point1.row<point2.row||point1.row==point2.row&&bColIsAfter}oop.implement(this,EventEmitter),this.getPosition=function(){return this.$clipPositionToDocument(this.row,this.column)},this.getDocument=function(){return this.document},this.$insertRight=!1,this.onChange=function(delta){if(!(delta.start.row==delta.end.row&&delta.start.row!=this.row||delta.start.row>this.row)){var point=function(delta,point,moveIfEqual){var deltaIsInsert="insert"==delta.action,deltaRowShift=(deltaIsInsert?1:-1)*(delta.end.row-delta.start.row),deltaColShift=(deltaIsInsert?1:-1)*(delta.end.column-delta.start.column),deltaStart=delta.start,deltaEnd=deltaIsInsert?deltaStart:delta.end;if($pointsInOrder(point,deltaStart,moveIfEqual))return{row:point.row,column:point.column};if($pointsInOrder(deltaEnd,point,!moveIfEqual))return{row:point.row+deltaRowShift,column:point.column+(point.row==deltaEnd.row?deltaColShift:0)};return{row:deltaStart.row,column:deltaStart.column}}(delta,{row:this.row,column:this.column},this.$insertRight);this.setPosition(point.row,point.column,!0)}},this.setPosition=function(row,column,noClip){var pos;if(pos=noClip?{row:row,column:column}:this.$clipPositionToDocument(row,column),this.row!=pos.row||this.column!=pos.column){var old={row:this.row,column:this.column};this.row=pos.row,this.column=pos.column,this._signal("change",{old:old,value:pos})}},this.detach=function(){this.document.removeEventListener("change",this.$onChange)},this.attach=function(doc){this.document=doc||this.document,this.document.on("change",this.$onChange)},this.$clipPositionToDocument=function(row,column){var pos={};return row>=this.document.getLength()?(pos.row=Math.max(0,this.document.getLength()-1),pos.column=this.document.getLine(pos.row).length):row<0?(pos.row=0,pos.column=0):(pos.row=row,pos.column=Math.min(this.document.getLine(pos.row).length,Math.max(0,column))),column<0&&(pos.column=0),pos}}).call(Anchor.prototype)})),ace.define("ace/document",["require","exports","module","ace/lib/oop","ace/apply_delta","ace/lib/event_emitter","ace/range","ace/anchor"],(function(acequire,exports,module){"use strict";var oop=acequire("./lib/oop"),applyDelta=acequire("./apply_delta").applyDelta,EventEmitter=acequire("./lib/event_emitter").EventEmitter,Range=acequire("./range").Range,Anchor=acequire("./anchor").Anchor,Document=function(textOrLines){this.$lines=[""],0===textOrLines.length?this.$lines=[""]:Array.isArray(textOrLines)?this.insertMergedLines({row:0,column:0},textOrLines):this.insert({row:0,column:0},textOrLines)};(function(){oop.implement(this,EventEmitter),this.setValue=function(text){var len=this.getLength()-1;this.remove(new Range(0,0,len,this.getLine(len).length)),this.insert({row:0,column:0},text)},this.getValue=function(){return this.getAllLines().join(this.getNewLineCharacter())},this.createAnchor=function(row,column){return new Anchor(this,row,column)},0==="aaa".split(/a/).length?this.$split=function(text){return text.replace(/\r\n|\r/g,"\n").split("\n")}:this.$split=function(text){return text.split(/\r\n|\r|\n/)},this.$detectNewLine=function(text){var match=text.match(/^.*?(\r\n|\r|\n)/m);this.$autoNewLine=match?match[1]:"\n",this._signal("changeNewLineMode")},this.getNewLineCharacter=function(){switch(this.$newLineMode){case"windows":return"\r\n";case"unix":return"\n";default:return this.$autoNewLine||"\n"}},this.$autoNewLine="",this.$newLineMode="auto",this.setNewLineMode=function(newLineMode){this.$newLineMode!==newLineMode&&(this.$newLineMode=newLineMode,this._signal("changeNewLineMode"))},this.getNewLineMode=function(){return this.$newLineMode},this.isNewLine=function(text){return"\r\n"==text||"\r"==text||"\n"==text},this.getLine=function(row){return this.$lines[row]||""},this.getLines=function(firstRow,lastRow){return this.$lines.slice(firstRow,lastRow+1)},this.getAllLines=function(){return this.getLines(0,this.getLength())},this.getLength=function(){return this.$lines.length},this.getTextRange=function(range){return this.getLinesForRange(range).join(this.getNewLineCharacter())},this.getLinesForRange=function(range){var lines;if(range.start.row===range.end.row)lines=[this.getLine(range.start.row).substring(range.start.column,range.end.column)];else{(lines=this.getLines(range.start.row,range.end.row))[0]=(lines[0]||"").substring(range.start.column);var l=lines.length-1;range.end.row-range.start.row==l&&(lines[l]=lines[l].substring(0,range.end.column))}return lines},this.insertLines=function(row,lines){return console.warn("Use of document.insertLines is deprecated. Use the insertFullLines method instead."),this.insertFullLines(row,lines)},this.removeLines=function(firstRow,lastRow){return console.warn("Use of document.removeLines is deprecated. Use the removeFullLines method instead."),this.removeFullLines(firstRow,lastRow)},this.insertNewLine=function(position){return console.warn("Use of document.insertNewLine is deprecated. Use insertMergedLines(position, ['', '']) instead."),this.insertMergedLines(position,["",""])},this.insert=function(position,text){return this.getLength()<=1&&this.$detectNewLine(text),this.insertMergedLines(position,this.$split(text))},this.insertInLine=function(position,text){var start=this.clippedPos(position.row,position.column),end=this.pos(position.row,position.column+text.length);return this.applyDelta({start:start,end:end,action:"insert",lines:[text]},!0),this.clonePos(end)},this.clippedPos=function(row,column){var length=this.getLength();void 0===row?row=length:row<0?row=0:row>=length&&(row=length-1,column=void 0);var line=this.getLine(row);return null==column&&(column=line.length),{row:row,column:column=Math.min(Math.max(column,0),line.length)}},this.clonePos=function(pos){return{row:pos.row,column:pos.column}},this.pos=function(row,column){return{row:row,column:column}},this.$clipPosition=function(position){var length=this.getLength();return position.row>=length?(position.row=Math.max(0,length-1),position.column=this.getLine(length-1).length):(position.row=Math.max(0,position.row),position.column=Math.min(Math.max(position.column,0),this.getLine(position.row).length)),position},this.insertFullLines=function(row,lines){var column=0;(row=Math.min(Math.max(row,0),this.getLength()))<this.getLength()?(lines=lines.concat([""]),column=0):(lines=[""].concat(lines),row--,column=this.$lines[row].length),this.insertMergedLines({row:row,column:column},lines)},this.insertMergedLines=function(position,lines){var start=this.clippedPos(position.row,position.column),end={row:start.row+lines.length-1,column:(1==lines.length?start.column:0)+lines[lines.length-1].length};return this.applyDelta({start:start,end:end,action:"insert",lines:lines}),this.clonePos(end)},this.remove=function(range){var start=this.clippedPos(range.start.row,range.start.column),end=this.clippedPos(range.end.row,range.end.column);return this.applyDelta({start:start,end:end,action:"remove",lines:this.getLinesForRange({start:start,end:end})}),this.clonePos(start)},this.removeInLine=function(row,startColumn,endColumn){var start=this.clippedPos(row,startColumn),end=this.clippedPos(row,endColumn);return this.applyDelta({start:start,end:end,action:"remove",lines:this.getLinesForRange({start:start,end:end})},!0),this.clonePos(start)},this.removeFullLines=function(firstRow,lastRow){firstRow=Math.min(Math.max(0,firstRow),this.getLength()-1);var deleteFirstNewLine=(lastRow=Math.min(Math.max(0,lastRow),this.getLength()-1))==this.getLength()-1&&firstRow>0,deleteLastNewLine=lastRow<this.getLength()-1,startRow=deleteFirstNewLine?firstRow-1:firstRow,startCol=deleteFirstNewLine?this.getLine(startRow).length:0,endRow=deleteLastNewLine?lastRow+1:lastRow,endCol=deleteLastNewLine?0:this.getLine(endRow).length,range=new Range(startRow,startCol,endRow,endCol),deletedLines=this.$lines.slice(firstRow,lastRow+1);return this.applyDelta({start:range.start,end:range.end,action:"remove",lines:this.getLinesForRange(range)}),deletedLines},this.removeNewLine=function(row){row<this.getLength()-1&&row>=0&&this.applyDelta({start:this.pos(row,this.getLine(row).length),end:this.pos(row+1,0),action:"remove",lines:["",""]})},this.replace=function(range,text){return range instanceof Range||(range=Range.fromPoints(range.start,range.end)),0===text.length&&range.isEmpty()?range.start:text==this.getTextRange(range)?range.end:(this.remove(range),text?this.insert(range.start,text):range.start)},this.applyDeltas=function(deltas){for(var i=0;i<deltas.length;i++)this.applyDelta(deltas[i])},this.revertDeltas=function(deltas){for(var i=deltas.length-1;i>=0;i--)this.revertDelta(deltas[i])},this.applyDelta=function(delta,doNotValidate){var isInsert="insert"==delta.action;(isInsert?delta.lines.length<=1&&!delta.lines[0]:!Range.comparePoints(delta.start,delta.end))||(isInsert&&delta.lines.length>2e4&&this.$splitAndapplyLargeDelta(delta,2e4),applyDelta(this.$lines,delta,doNotValidate),this._signal("change",delta))},this.$splitAndapplyLargeDelta=function(delta,MAX){for(var lines=delta.lines,l=lines.length,row=delta.start.row,column=delta.start.column,from=0,to=0;;){from=to,to+=MAX-1;var chunk=lines.slice(from,to);if(to>l){delta.lines=chunk,delta.start.row=row+from,delta.start.column=column;break}chunk.push(""),this.applyDelta({start:this.pos(row+from,column),end:this.pos(row+to,column=0),action:delta.action,lines:chunk},!0)}},this.revertDelta=function(delta){this.applyDelta({start:this.clonePos(delta.start),end:this.clonePos(delta.end),action:"insert"==delta.action?"remove":"insert",lines:delta.lines.slice()})},this.indexToPosition=function(index,startRow){for(var lines=this.$lines||this.getAllLines(),newlineLength=this.getNewLineCharacter().length,i=startRow||0,l=lines.length;i<l;i++)if((index-=lines[i].length+newlineLength)<0)return{row:i,column:index+lines[i].length+newlineLength};return{row:l-1,column:lines[l-1].length}},this.positionToIndex=function(pos,startRow){for(var lines=this.$lines||this.getAllLines(),newlineLength=this.getNewLineCharacter().length,index=0,row=Math.min(pos.row,lines.length),i=startRow||0;i<row;++i)index+=lines[i].length+newlineLength;return index+pos.column}}).call(Document.prototype),exports.Document=Document})),ace.define("ace/background_tokenizer",["require","exports","module","ace/lib/oop","ace/lib/event_emitter"],(function(acequire,exports,module){"use strict";var oop=acequire("./lib/oop"),EventEmitter=acequire("./lib/event_emitter").EventEmitter,BackgroundTokenizer=function(tokenizer,editor){this.running=!1,this.lines=[],this.states=[],this.currentLine=0,this.tokenizer=tokenizer;var self=this;this.$worker=function(){if(self.running){for(var workerStart=new Date,currentLine=self.currentLine,endLine=-1,doc=self.doc,startLine=currentLine;self.lines[currentLine];)currentLine++;var len=doc.getLength(),processedLines=0;for(self.running=!1;currentLine<len;){self.$tokenizeRow(currentLine),endLine=currentLine;do{currentLine++}while(self.lines[currentLine]);if(++processedLines%5==0&&new Date-workerStart>20){self.running=setTimeout(self.$worker,20);break}}self.currentLine=currentLine,-1==endLine&&(endLine=currentLine),startLine<=endLine&&self.fireUpdateEvent(startLine,endLine)}}};(function(){oop.implement(this,EventEmitter),this.setTokenizer=function(tokenizer){this.tokenizer=tokenizer,this.lines=[],this.states=[],this.start(0)},this.setDocument=function(doc){this.doc=doc,this.lines=[],this.states=[],this.stop()},this.fireUpdateEvent=function(firstRow,lastRow){var data={first:firstRow,last:lastRow};this._signal("update",{data:data})},this.start=function(startRow){this.currentLine=Math.min(startRow||0,this.currentLine,this.doc.getLength()),this.lines.splice(this.currentLine,this.lines.length),this.states.splice(this.currentLine,this.states.length),this.stop(),this.running=setTimeout(this.$worker,700)},this.scheduleStart=function(){this.running||(this.running=setTimeout(this.$worker,700))},this.$updateOnChange=function(delta){var startRow=delta.start.row,len=delta.end.row-startRow;if(0===len)this.lines[startRow]=null;else if("remove"==delta.action)this.lines.splice(startRow,len+1,null),this.states.splice(startRow,len+1,null);else{var args=Array(len+1);args.unshift(startRow,1),this.lines.splice.apply(this.lines,args),this.states.splice.apply(this.states,args)}this.currentLine=Math.min(startRow,this.currentLine,this.doc.getLength()),this.stop()},this.stop=function(){this.running&&clearTimeout(this.running),this.running=!1},this.getTokens=function(row){return this.lines[row]||this.$tokenizeRow(row)},this.getState=function(row){return this.currentLine==row&&this.$tokenizeRow(row),this.states[row]||"start"},this.$tokenizeRow=function(row){var line=this.doc.getLine(row),state=this.states[row-1],data=this.tokenizer.getLineTokens(line,state,row);return this.states[row]+""!=data.state+""?(this.states[row]=data.state,this.lines[row+1]=null,this.currentLine>row+1&&(this.currentLine=row+1)):this.currentLine==row&&(this.currentLine=row+1),this.lines[row]=data.tokens}}).call(BackgroundTokenizer.prototype),exports.BackgroundTokenizer=BackgroundTokenizer})),ace.define("ace/search_highlight",["require","exports","module","ace/lib/lang","ace/lib/oop","ace/range"],(function(acequire,exports,module){"use strict";var lang=acequire("./lib/lang"),Range=(acequire("./lib/oop"),acequire("./range").Range),SearchHighlight=function(regExp,clazz,type){this.setRegexp(regExp),this.clazz=clazz,this.type=type||"text"};(function(){this.MAX_RANGES=500,this.setRegexp=function(regExp){this.regExp+""!=regExp+""&&(this.regExp=regExp,this.cache=[])},this.update=function(html,markerLayer,session,config){if(this.regExp)for(var start=config.firstRow,end=config.lastRow,i=start;i<=end;i++){var ranges=this.cache[i];null==ranges&&((ranges=lang.getMatchOffsets(session.getLine(i),this.regExp)).length>this.MAX_RANGES&&(ranges=ranges.slice(0,this.MAX_RANGES)),ranges=ranges.map((function(match){return new Range(i,match.offset,i,match.offset+match.length)})),this.cache[i]=ranges.length?ranges:"");for(var j=ranges.length;j--;)markerLayer.drawSingleLineMarker(html,ranges[j].toScreenRange(session),this.clazz,config)}}}).call(SearchHighlight.prototype),exports.SearchHighlight=SearchHighlight})),ace.define("ace/edit_session/fold_line",["require","exports","module","ace/range"],(function(acequire,exports,module){"use strict";var Range=acequire("../range").Range;function FoldLine(foldData,folds){this.foldData=foldData,Array.isArray(folds)?this.folds=folds:folds=this.folds=[folds];var last=folds[folds.length-1];this.range=new Range(folds[0].start.row,folds[0].start.column,last.end.row,last.end.column),this.start=this.range.start,this.end=this.range.end,this.folds.forEach((function(fold){fold.setFoldLine(this)}),this)}(function(){this.shiftRow=function(shift){this.start.row+=shift,this.end.row+=shift,this.folds.forEach((function(fold){fold.start.row+=shift,fold.end.row+=shift}))},this.addFold=function(fold){if(fold.sameRow){if(fold.start.row<this.startRow||fold.endRow>this.endRow)throw new Error("Can't add a fold to this FoldLine as it has no connection");this.folds.push(fold),this.folds.sort((function(a,b){return-a.range.compareEnd(b.start.row,b.start.column)})),this.range.compareEnd(fold.start.row,fold.start.column)>0?(this.end.row=fold.end.row,this.end.column=fold.end.column):this.range.compareStart(fold.end.row,fold.end.column)<0&&(this.start.row=fold.start.row,this.start.column=fold.start.column)}else if(fold.start.row==this.end.row)this.folds.push(fold),this.end.row=fold.end.row,this.end.column=fold.end.column;else{if(fold.end.row!=this.start.row)throw new Error("Trying to add fold to FoldRow that doesn't have a matching row");this.folds.unshift(fold),this.start.row=fold.start.row,this.start.column=fold.start.column}fold.foldLine=this},this.containsRow=function(row){return row>=this.start.row&&row<=this.end.row},this.walk=function(callback,endRow,endColumn){var fold,cmp,lastEnd=0,folds=this.folds,isNewRow=!0;null==endRow&&(endRow=this.end.row,endColumn=this.end.column);for(var i=0;i<folds.length;i++){if(-1==(cmp=(fold=folds[i]).range.compareStart(endRow,endColumn)))return void callback(null,endRow,endColumn,lastEnd,isNewRow);if(!callback(null,fold.start.row,fold.start.column,lastEnd,isNewRow)&&callback(fold.placeholder,fold.start.row,fold.start.column,lastEnd)||0===cmp)return;isNewRow=!fold.sameRow,lastEnd=fold.end.column}callback(null,endRow,endColumn,lastEnd,isNewRow)},this.getNextFoldTo=function(row,column){for(var fold,cmp,i=0;i<this.folds.length;i++){if(-1==(cmp=(fold=this.folds[i]).range.compareEnd(row,column)))return{fold:fold,kind:"after"};if(0===cmp)return{fold:fold,kind:"inside"}}return null},this.addRemoveChars=function(row,column,len){var fold,folds,ret=this.getNextFoldTo(row,column);if(ret)if(fold=ret.fold,"inside"==ret.kind&&fold.start.column!=column&&fold.start.row!=row)window.console&&window.console.log(row,column,fold);else if(fold.start.row==row){var i=(folds=this.folds).indexOf(fold);for(0===i&&(this.start.column+=len);i<folds.length;i++){if((fold=folds[i]).start.column+=len,!fold.sameRow)return;fold.end.column+=len}this.end.column+=len}},this.split=function(row,column){var pos=this.getNextFoldTo(row,column);if(!pos||"inside"==pos.kind)return null;var fold=pos.fold,folds=this.folds,foldData=this.foldData,i=folds.indexOf(fold),foldBefore=folds[i-1];this.end.row=foldBefore.end.row,this.end.column=foldBefore.end.column;var newFoldLine=new FoldLine(foldData,folds=folds.splice(i,folds.length-i));return foldData.splice(foldData.indexOf(this)+1,0,newFoldLine),newFoldLine},this.merge=function(foldLineNext){for(var folds=foldLineNext.folds,i=0;i<folds.length;i++)this.addFold(folds[i]);var foldData=this.foldData;foldData.splice(foldData.indexOf(foldLineNext),1)},this.toString=function(){var ret=[this.range.toString()+": ["];return this.folds.forEach((function(fold){ret.push("  "+fold.toString())})),ret.push("]"),ret.join("\n")},this.idxToPosition=function(idx){for(var lastFoldEndColumn=0,i=0;i<this.folds.length;i++){var fold=this.folds[i];if((idx-=fold.start.column-lastFoldEndColumn)<0)return{row:fold.start.row,column:fold.start.column+idx};if((idx-=fold.placeholder.length)<0)return fold.start;lastFoldEndColumn=fold.end.column}return{row:this.end.row,column:this.end.column+idx}}}).call(FoldLine.prototype),exports.FoldLine=FoldLine})),ace.define("ace/range_list",["require","exports","module","ace/range"],(function(acequire,exports,module){"use strict";var comparePoints=acequire("./range").Range.comparePoints,RangeList=function(){this.ranges=[]};(function(){this.comparePoints=comparePoints,this.pointIndex=function(pos,excludeEdges,startIndex){for(var list=this.ranges,i=startIndex||0;i<list.length;i++){var range=list[i],cmpEnd=comparePoints(pos,range.end);if(!(cmpEnd>0)){var cmpStart=comparePoints(pos,range.start);return 0===cmpEnd?excludeEdges&&0!==cmpStart?-i-2:i:cmpStart>0||0===cmpStart&&!excludeEdges?i:-i-1}}return-i-1},this.add=function(range){var excludeEdges=!range.isEmpty(),startIndex=this.pointIndex(range.start,excludeEdges);startIndex<0&&(startIndex=-startIndex-1);var endIndex=this.pointIndex(range.end,excludeEdges,startIndex);return endIndex<0?endIndex=-endIndex-1:endIndex++,this.ranges.splice(startIndex,endIndex-startIndex,range)},this.addList=function(list){for(var removed=[],i=list.length;i--;)removed.push.apply(removed,this.add(list[i]));return removed},this.substractPoint=function(pos){var i=this.pointIndex(pos);if(i>=0)return this.ranges.splice(i,1)},this.merge=function(){for(var range,removed=[],list=this.ranges,next=(list=list.sort((function(a,b){return comparePoints(a.start,b.start)})))[0],i=1;i<list.length;i++){range=next,next=list[i];var cmp=comparePoints(range.end,next.start);cmp<0||(0!=cmp||range.isEmpty()||next.isEmpty())&&(comparePoints(range.end,next.end)<0&&(range.end.row=next.end.row,range.end.column=next.end.column),list.splice(i,1),removed.push(next),next=range,i--)}return this.ranges=list,removed},this.contains=function(row,column){return this.pointIndex({row:row,column:column})>=0},this.containsPoint=function(pos){return this.pointIndex(pos)>=0},this.rangeAtPoint=function(pos){var i=this.pointIndex(pos);if(i>=0)return this.ranges[i]},this.clipRows=function(startRow,endRow){var list=this.ranges;if(list[0].start.row>endRow||list[list.length-1].start.row<startRow)return[];var startIndex=this.pointIndex({row:startRow,column:0});startIndex<0&&(startIndex=-startIndex-1);var endIndex=this.pointIndex({row:endRow,column:0},startIndex);endIndex<0&&(endIndex=-endIndex-1);for(var clipped=[],i=startIndex;i<endIndex;i++)clipped.push(list[i]);return clipped},this.removeAll=function(){return this.ranges.splice(0,this.ranges.length)},this.attach=function(session){this.session&&this.detach(),this.session=session,this.onChange=this.$onChange.bind(this),this.session.on("change",this.onChange)},this.detach=function(){this.session&&(this.session.removeListener("change",this.onChange),this.session=null)},this.$onChange=function(delta){if("insert"==delta.action)var start=delta.start,end=delta.end;else end=delta.start,start=delta.end;for(var startRow=start.row,lineDif=end.row-startRow,colDiff=-start.column+end.column,ranges=this.ranges,i=0,n=ranges.length;i<n;i++){if(!((r=ranges[i]).end.row<startRow)){if(r.start.row>startRow)break;if(r.start.row==startRow&&r.start.column>=start.column&&(r.start.column==start.column&&this.$insertRight||(r.start.column+=colDiff,r.start.row+=lineDif)),r.end.row==startRow&&r.end.column>=start.column){if(r.end.column==start.column&&this.$insertRight)continue;r.end.column==start.column&&colDiff>0&&i<n-1&&r.end.column>r.start.column&&r.end.column==ranges[i+1].start.column&&(r.end.column-=colDiff),r.end.column+=colDiff,r.end.row+=lineDif}}}if(0!=lineDif&&i<n)for(;i<n;i++){var r;(r=ranges[i]).start.row+=lineDif,r.end.row+=lineDif}}}).call(RangeList.prototype),exports.RangeList=RangeList})),ace.define("ace/edit_session/fold",["require","exports","module","ace/range","ace/range_list","ace/lib/oop"],(function(acequire,exports,module){"use strict";acequire("../range").Range;var RangeList=acequire("../range_list").RangeList,oop=acequire("../lib/oop"),Fold=exports.Fold=function(range,placeholder){this.foldLine=null,this.placeholder=placeholder,this.range=range,this.start=range.start,this.end=range.end,this.sameRow=range.start.row==range.end.row,this.subFolds=this.ranges=[]};function consumePoint(point,anchor){point.row-=anchor.row,0==point.row&&(point.column-=anchor.column)}function restorePoint(point,anchor){0==point.row&&(point.column+=anchor.column),point.row+=anchor.row}oop.inherits(Fold,RangeList),function(){this.toString=function(){return'"'+this.placeholder+'" '+this.range.toString()},this.setFoldLine=function(foldLine){this.foldLine=foldLine,this.subFolds.forEach((function(fold){fold.setFoldLine(foldLine)}))},this.clone=function(){var range=this.range.clone(),fold=new Fold(range,this.placeholder);return this.subFolds.forEach((function(subFold){fold.subFolds.push(subFold.clone())})),fold.collapseChildren=this.collapseChildren,fold},this.addSubFold=function(fold){if(!this.range.isEqual(fold)){if(!this.range.containsRange(fold))throw new Error("A fold can't intersect already existing fold"+fold.range+this.range);var range,anchor;range=fold,anchor=this.start,consumePoint(range.start,anchor),consumePoint(range.end,anchor);for(var row=fold.start.row,column=fold.start.column,i=0,cmp=-1;i<this.subFolds.length&&1==(cmp=this.subFolds[i].range.compare(row,column));i++);var afterStart=this.subFolds[i];if(0==cmp)return afterStart.addSubFold(fold);row=fold.range.end.row,column=fold.range.end.column;var j=i;for(cmp=-1;j<this.subFolds.length&&1==(cmp=this.subFolds[j].range.compare(row,column));j++);this.subFolds[j];if(0==cmp)throw new Error("A fold can't intersect already existing fold"+fold.range+this.range);this.subFolds.splice(i,j-i,fold);return fold.setFoldLine(this.foldLine),fold}},this.restoreRange=function(range){return function(range,anchor){restorePoint(range.start,anchor),restorePoint(range.end,anchor)}(range,this.start)}}.call(Fold.prototype)})),ace.define("ace/edit_session/folding",["require","exports","module","ace/range","ace/edit_session/fold_line","ace/edit_session/fold","ace/token_iterator"],(function(acequire,exports,module){"use strict";var Range=acequire("../range").Range,FoldLine=acequire("./fold_line").FoldLine,Fold=acequire("./fold").Fold,TokenIterator=acequire("../token_iterator").TokenIterator;exports.Folding=function(){this.getFoldAt=function(row,column,side){var foldLine=this.getFoldLine(row);if(!foldLine)return null;for(var folds=foldLine.folds,i=0;i<folds.length;i++){var fold=folds[i];if(fold.range.contains(row,column)){if(1==side&&fold.range.isEnd(row,column))continue;if(-1==side&&fold.range.isStart(row,column))continue;return fold}}},this.getFoldsInRange=function(range){var start=range.start,end=range.end,foldLines=this.$foldData,foundFolds=[];start.column+=1,end.column-=1;for(var i=0;i<foldLines.length;i++){var cmp=foldLines[i].range.compareRange(range);if(2!=cmp){if(-2==cmp)break;for(var folds=foldLines[i].folds,j=0;j<folds.length;j++){var fold=folds[j];if(-2==(cmp=fold.range.compareRange(range)))break;if(2!=cmp){if(42==cmp)break;foundFolds.push(fold)}}}}return start.column-=1,end.column+=1,foundFolds},this.getFoldsInRangeList=function(ranges){if(Array.isArray(ranges)){var folds=[];ranges.forEach((function(range){folds=folds.concat(this.getFoldsInRange(range))}),this)}else folds=this.getFoldsInRange(ranges);return folds},this.getAllFolds=function(){for(var folds=[],foldLines=this.$foldData,i=0;i<foldLines.length;i++)for(var j=0;j<foldLines[i].folds.length;j++)folds.push(foldLines[i].folds[j]);return folds},this.getFoldStringAt=function(row,column,trim,foldLine){if(!(foldLine=foldLine||this.getFoldLine(row)))return null;for(var str,fold,lastFold={end:{column:0}},i=0;i<foldLine.folds.length;i++){var cmp=(fold=foldLine.folds[i]).range.compareEnd(row,column);if(-1==cmp){str=this.getLine(fold.start.row).substring(lastFold.end.column,fold.start.column);break}if(0===cmp)return null;lastFold=fold}return str||(str=this.getLine(fold.start.row).substring(lastFold.end.column)),-1==trim?str.substring(0,column-lastFold.end.column):1==trim?str.substring(column-lastFold.end.column):str},this.getFoldLine=function(docRow,startFoldLine){var foldData=this.$foldData,i=0;for(startFoldLine&&(i=foldData.indexOf(startFoldLine)),-1==i&&(i=0);i<foldData.length;i++){var foldLine=foldData[i];if(foldLine.start.row<=docRow&&foldLine.end.row>=docRow)return foldLine;if(foldLine.end.row>docRow)return null}return null},this.getNextFoldLine=function(docRow,startFoldLine){var foldData=this.$foldData,i=0;for(startFoldLine&&(i=foldData.indexOf(startFoldLine)),-1==i&&(i=0);i<foldData.length;i++){var foldLine=foldData[i];if(foldLine.end.row>=docRow)return foldLine}return null},this.getFoldedRowCount=function(first,last){for(var foldData=this.$foldData,rowCount=last-first+1,i=0;i<foldData.length;i++){var foldLine=foldData[i],end=foldLine.end.row,start=foldLine.start.row;if(end>=last){start<last&&(start>=first?rowCount-=last-start:rowCount=0);break}end>=first&&(rowCount-=start>=first?end-start:end-first+1)}return rowCount},this.$addFoldLine=function(foldLine){return this.$foldData.push(foldLine),this.$foldData.sort((function(a,b){return a.start.row-b.start.row})),foldLine},this.addFold=function(placeholder,range){var fold,foldData=this.$foldData,added=!1;placeholder instanceof Fold?fold=placeholder:(fold=new Fold(range,placeholder)).collapseChildren=range.collapseChildren,this.$clipRangeToDocument(fold.range);var startRow=fold.start.row,startColumn=fold.start.column,endRow=fold.end.row,endColumn=fold.end.column;if(!(startRow<endRow||startRow==endRow&&startColumn<=endColumn-2))throw new Error("The range has to be at least 2 characters width");var startFold=this.getFoldAt(startRow,startColumn,1),endFold=this.getFoldAt(endRow,endColumn,-1);if(startFold&&endFold==startFold)return startFold.addSubFold(fold);startFold&&!startFold.range.isStart(startRow,startColumn)&&this.removeFold(startFold),endFold&&!endFold.range.isEnd(endRow,endColumn)&&this.removeFold(endFold);var folds=this.getFoldsInRange(fold.range);folds.length>0&&(this.removeFolds(folds),folds.forEach((function(subFold){fold.addSubFold(subFold)})));for(var i=0;i<foldData.length;i++){var foldLine=foldData[i];if(endRow==foldLine.start.row){foldLine.addFold(fold),added=!0;break}if(startRow==foldLine.end.row){if(foldLine.addFold(fold),added=!0,!fold.sameRow){var foldLineNext=foldData[i+1];if(foldLineNext&&foldLineNext.start.row==endRow){foldLine.merge(foldLineNext);break}}break}if(endRow<=foldLine.start.row)break}return added||(foldLine=this.$addFoldLine(new FoldLine(this.$foldData,fold))),this.$useWrapMode?this.$updateWrapData(foldLine.start.row,foldLine.start.row):this.$updateRowLengthCache(foldLine.start.row,foldLine.start.row),this.$modified=!0,this._signal("changeFold",{data:fold,action:"add"}),fold},this.addFolds=function(folds){folds.forEach((function(fold){this.addFold(fold)}),this)},this.removeFold=function(fold){var foldLine=fold.foldLine,startRow=foldLine.start.row,endRow=foldLine.end.row,foldLines=this.$foldData,folds=foldLine.folds;if(1==folds.length)foldLines.splice(foldLines.indexOf(foldLine),1);else if(foldLine.range.isEnd(fold.end.row,fold.end.column))folds.pop(),foldLine.end.row=folds[folds.length-1].end.row,foldLine.end.column=folds[folds.length-1].end.column;else if(foldLine.range.isStart(fold.start.row,fold.start.column))folds.shift(),foldLine.start.row=folds[0].start.row,foldLine.start.column=folds[0].start.column;else if(fold.sameRow)folds.splice(folds.indexOf(fold),1);else{var newFoldLine=foldLine.split(fold.start.row,fold.start.column);(folds=newFoldLine.folds).shift(),newFoldLine.start.row=folds[0].start.row,newFoldLine.start.column=folds[0].start.column}this.$updating||(this.$useWrapMode?this.$updateWrapData(startRow,endRow):this.$updateRowLengthCache(startRow,endRow)),this.$modified=!0,this._signal("changeFold",{data:fold,action:"remove"})},this.removeFolds=function(folds){for(var cloneFolds=[],i=0;i<folds.length;i++)cloneFolds.push(folds[i]);cloneFolds.forEach((function(fold){this.removeFold(fold)}),this),this.$modified=!0},this.expandFold=function(fold){this.removeFold(fold),fold.subFolds.forEach((function(subFold){fold.restoreRange(subFold),this.addFold(subFold)}),this),fold.collapseChildren>0&&this.foldAll(fold.start.row+1,fold.end.row,fold.collapseChildren-1),fold.subFolds=[]},this.expandFolds=function(folds){folds.forEach((function(fold){this.expandFold(fold)}),this)},this.unfold=function(location,expandInner){var range,folds;if(null==location?(range=new Range(0,0,this.getLength(),0),expandInner=!0):range="number"==typeof location?new Range(location,0,location,this.getLine(location).length):"row"in location?Range.fromPoints(location,location):location,folds=this.getFoldsInRangeList(range),expandInner)this.removeFolds(folds);else for(var subFolds=folds;subFolds.length;)this.expandFolds(subFolds),subFolds=this.getFoldsInRangeList(range);if(folds.length)return folds},this.isRowFolded=function(docRow,startFoldRow){return!!this.getFoldLine(docRow,startFoldRow)},this.getRowFoldEnd=function(docRow,startFoldRow){var foldLine=this.getFoldLine(docRow,startFoldRow);return foldLine?foldLine.end.row:docRow},this.getRowFoldStart=function(docRow,startFoldRow){var foldLine=this.getFoldLine(docRow,startFoldRow);return foldLine?foldLine.start.row:docRow},this.getFoldDisplayLine=function(foldLine,endRow,endColumn,startRow,startColumn){null==startRow&&(startRow=foldLine.start.row),null==startColumn&&(startColumn=0),null==endRow&&(endRow=foldLine.end.row),null==endColumn&&(endColumn=this.getLine(endRow).length);var doc=this.doc,textLine="";return foldLine.walk((function(placeholder,row,column,lastColumn){if(!(row<startRow)){if(row==startRow){if(column<startColumn)return;lastColumn=Math.max(startColumn,lastColumn)}textLine+=null!=placeholder?placeholder:doc.getLine(row).substring(lastColumn,column)}}),endRow,endColumn),textLine},this.getDisplayLine=function(row,endColumn,startRow,startColumn){var line,foldLine=this.getFoldLine(row);return foldLine?this.getFoldDisplayLine(foldLine,row,endColumn,startRow,startColumn):(line=this.doc.getLine(row)).substring(startColumn||0,endColumn||line.length)},this.$cloneFoldData=function(){var fd=[];return fd=this.$foldData.map((function(foldLine){var folds=foldLine.folds.map((function(fold){return fold.clone()}));return new FoldLine(fd,folds)}))},this.toggleFold=function(tryToUnfold){var fold,bracketPos,range=this.selection.getRange();if(range.isEmpty()){var cursor=range.start;if(fold=this.getFoldAt(cursor.row,cursor.column))return void this.expandFold(fold);(bracketPos=this.findMatchingBracket(cursor))?1==range.comparePoint(bracketPos)?range.end=bracketPos:(range.start=bracketPos,range.start.column++,range.end.column--):(bracketPos=this.findMatchingBracket({row:cursor.row,column:cursor.column+1}))?(1==range.comparePoint(bracketPos)?range.end=bracketPos:range.start=bracketPos,range.start.column++):range=this.getCommentFoldRange(cursor.row,cursor.column)||range}else{var folds=this.getFoldsInRange(range);if(tryToUnfold&&folds.length)return void this.expandFolds(folds);1==folds.length&&(fold=folds[0])}if(fold||(fold=this.getFoldAt(range.start.row,range.start.column)),fold&&fold.range.toString()==range.toString())this.expandFold(fold);else{var placeholder="...";if(!range.isMultiLine()){if((placeholder=this.getTextRange(range)).length<4)return;placeholder=placeholder.trim().substring(0,2)+".."}this.addFold(placeholder,range)}},this.getCommentFoldRange=function(row,column,dir){var iterator=new TokenIterator(this,row,column),token=iterator.getCurrentToken(),type=token.type;if(token&&/^comment|string/.test(type)){"comment"==(type=type.match(/comment|string/)[0])&&(type+="|doc-start");var re=new RegExp(type),range=new Range;if(1!=dir){do{token=iterator.stepBackward()}while(token&&re.test(token.type));iterator.stepForward()}if(range.start.row=iterator.getCurrentTokenRow(),range.start.column=iterator.getCurrentTokenColumn()+2,iterator=new TokenIterator(this,row,column),-1!=dir){var lastRow=-1;do{if(token=iterator.stepForward(),-1==lastRow){var state=this.getState(iterator.$row);re.test(state)||(lastRow=iterator.$row)}else if(iterator.$row>lastRow)break}while(token&&re.test(token.type));token=iterator.stepBackward()}else token=iterator.getCurrentToken();return range.end.row=iterator.getCurrentTokenRow(),range.end.column=iterator.getCurrentTokenColumn()+token.value.length-2,range}},this.foldAll=function(startRow,endRow,depth){null==depth&&(depth=1e5);var foldWidgets=this.foldWidgets;if(foldWidgets){endRow=endRow||this.getLength();for(var row=startRow=startRow||0;row<endRow;row++)if(null==foldWidgets[row]&&(foldWidgets[row]=this.getFoldWidget(row)),"start"==foldWidgets[row]){var range=this.getFoldWidgetRange(row);if(range&&range.isMultiLine()&&range.end.row<=endRow&&range.start.row>=startRow){row=range.end.row;try{var fold=this.addFold("...",range);fold&&(fold.collapseChildren=depth)}catch(e){}}}}},this.$foldStyles={manual:1,markbegin:1,markbeginend:1},this.$foldStyle="markbegin",this.setFoldStyle=function(style){if(!this.$foldStyles[style])throw new Error("invalid fold style: "+style+"["+Object.keys(this.$foldStyles).join(", ")+"]");if(this.$foldStyle!=style){this.$foldStyle=style,"manual"==style&&this.unfold();var mode=this.$foldMode;this.$setFolding(null),this.$setFolding(mode)}},this.$setFolding=function(foldMode){this.$foldMode!=foldMode&&(this.$foldMode=foldMode,this.off("change",this.$updateFoldWidgets),this.off("tokenizerUpdate",this.$tokenizerUpdateFoldWidgets),this._signal("changeAnnotation"),foldMode&&"manual"!=this.$foldStyle?(this.foldWidgets=[],this.getFoldWidget=foldMode.getFoldWidget.bind(foldMode,this,this.$foldStyle),this.getFoldWidgetRange=foldMode.getFoldWidgetRange.bind(foldMode,this,this.$foldStyle),this.$updateFoldWidgets=this.updateFoldWidgets.bind(this),this.$tokenizerUpdateFoldWidgets=this.tokenizerUpdateFoldWidgets.bind(this),this.on("change",this.$updateFoldWidgets),this.on("tokenizerUpdate",this.$tokenizerUpdateFoldWidgets)):this.foldWidgets=null)},this.getParentFoldRangeData=function(row,ignoreCurrent){var fw=this.foldWidgets;if(!fw||ignoreCurrent&&fw[row])return{};for(var firstRange,i=row-1;i>=0;){var c=fw[i];if(null==c&&(c=fw[i]=this.getFoldWidget(i)),"start"==c){var range=this.getFoldWidgetRange(i);if(firstRange||(firstRange=range),range&&range.end.row>=row)break}i--}return{range:-1!==i&&range,firstRange:firstRange}},this.onFoldWidgetClick=function(row,e){var options={children:(e=e.domEvent).shiftKey,all:e.ctrlKey||e.metaKey,siblings:e.altKey};if(!this.$toggleFoldWidget(row,options)){var el=e.target||e.srcElement;el&&/ace_fold-widget/.test(el.className)&&(el.className+=" ace_invalid")}},this.$toggleFoldWidget=function(row,options){if(this.getFoldWidget){var type=this.getFoldWidget(row),line=this.getLine(row),dir="end"===type?-1:1,fold=this.getFoldAt(row,-1===dir?0:line.length,dir);if(fold)return options.children||options.all?this.removeFold(fold):this.expandFold(fold),fold;var range=this.getFoldWidgetRange(row,!0);if(range&&!range.isMultiLine()&&(fold=this.getFoldAt(range.start.row,range.start.column,1))&&range.isEqual(fold.range))return this.removeFold(fold),fold;if(options.siblings){var data=this.getParentFoldRangeData(row);if(data.range)var startRow=data.range.start.row+1,endRow=data.range.end.row;this.foldAll(startRow,endRow,options.all?1e4:0)}else options.children?(endRow=range?range.end.row:this.getLength(),this.foldAll(row+1,endRow,options.all?1e4:0)):range&&(options.all&&(range.collapseChildren=1e4),this.addFold("...",range));return range}},this.toggleFoldWidget=function(toggleParent){var row=this.selection.getCursor().row;row=this.getRowFoldStart(row);var range=this.$toggleFoldWidget(row,{});if(!range){var data=this.getParentFoldRangeData(row,!0);if(range=data.range||data.firstRange){row=range.start.row;var fold=this.getFoldAt(row,this.getLine(row).length,1);fold?this.removeFold(fold):this.addFold("...",range)}}},this.updateFoldWidgets=function(delta){var firstRow=delta.start.row,len=delta.end.row-firstRow;if(0===len)this.foldWidgets[firstRow]=null;else if("remove"==delta.action)this.foldWidgets.splice(firstRow,len+1,null);else{var args=Array(len+1);args.unshift(firstRow,1),this.foldWidgets.splice.apply(this.foldWidgets,args)}},this.tokenizerUpdateFoldWidgets=function(e){var rows=e.data;rows.first!=rows.last&&this.foldWidgets.length>rows.first&&this.foldWidgets.splice(rows.first,this.foldWidgets.length)}}})),ace.define("ace/edit_session/bracket_match",["require","exports","module","ace/token_iterator","ace/range"],(function(acequire,exports,module){"use strict";var TokenIterator=acequire("../token_iterator").TokenIterator,Range=acequire("../range").Range;exports.BracketMatch=function(){this.findMatchingBracket=function(position,chr){if(0==position.column)return null;var charBeforeCursor=chr||this.getLine(position.row).charAt(position.column-1);if(""==charBeforeCursor)return null;var match=charBeforeCursor.match(/([\(\[\{])|([\)\]\}])/);return match?match[1]?this.$findClosingBracket(match[1],position):this.$findOpeningBracket(match[2],position):null},this.getBracketRange=function(pos){var range,line=this.getLine(pos.row),before=!0,chr=line.charAt(pos.column-1),match=chr&&chr.match(/([\(\[\{])|([\)\]\}])/);if(match||(chr=line.charAt(pos.column),pos={row:pos.row,column:pos.column+1},match=chr&&chr.match(/([\(\[\{])|([\)\]\}])/),before=!1),!match)return null;if(match[1]){if(!(bracketPos=this.$findClosingBracket(match[1],pos)))return null;range=Range.fromPoints(pos,bracketPos),before||(range.end.column++,range.start.column--),range.cursor=range.end}else{var bracketPos;if(!(bracketPos=this.$findOpeningBracket(match[2],pos)))return null;range=Range.fromPoints(bracketPos,pos),before||(range.start.column++,range.end.column--),range.cursor=range.start}return range},this.$brackets={")":"(","(":")","]":"[","[":"]","{":"}","}":"{"},this.$findOpeningBracket=function(bracket,position,typeRe){var openBracket=this.$brackets[bracket],depth=1,iterator=new TokenIterator(this,position.row,position.column),token=iterator.getCurrentToken();if(token||(token=iterator.stepForward()),token){typeRe||(typeRe=new RegExp("(\\.?"+token.type.replace(".","\\.").replace("rparen",".paren").replace(/\b(?:end)\b/,"(?:start|begin|end)")+")+"));for(var valueIndex=position.column-iterator.getCurrentTokenColumn()-2,value=token.value;;){for(;valueIndex>=0;){var chr=value.charAt(valueIndex);if(chr==openBracket){if(0==(depth-=1))return{row:iterator.getCurrentTokenRow(),column:valueIndex+iterator.getCurrentTokenColumn()}}else chr==bracket&&(depth+=1);valueIndex-=1}do{token=iterator.stepBackward()}while(token&&!typeRe.test(token.type));if(null==token)break;valueIndex=(value=token.value).length-1}return null}},this.$findClosingBracket=function(bracket,position,typeRe){var closingBracket=this.$brackets[bracket],depth=1,iterator=new TokenIterator(this,position.row,position.column),token=iterator.getCurrentToken();if(token||(token=iterator.stepForward()),token){typeRe||(typeRe=new RegExp("(\\.?"+token.type.replace(".","\\.").replace("lparen",".paren").replace(/\b(?:start|begin)\b/,"(?:start|begin|end)")+")+"));for(var valueIndex=position.column-iterator.getCurrentTokenColumn();;){for(var value=token.value,valueLength=value.length;valueIndex<valueLength;){var chr=value.charAt(valueIndex);if(chr==closingBracket){if(0==(depth-=1))return{row:iterator.getCurrentTokenRow(),column:valueIndex+iterator.getCurrentTokenColumn()}}else chr==bracket&&(depth+=1);valueIndex+=1}do{token=iterator.stepForward()}while(token&&!typeRe.test(token.type));if(null==token)break;valueIndex=0}return null}}}})),ace.define("ace/edit_session",["require","exports","module","ace/lib/oop","ace/lib/lang","ace/bidihandler","ace/config","ace/lib/event_emitter","ace/selection","ace/mode/text","ace/range","ace/document","ace/background_tokenizer","ace/search_highlight","ace/edit_session/folding","ace/edit_session/bracket_match"],(function(acequire,exports,module){"use strict";var oop=acequire("./lib/oop"),lang=acequire("./lib/lang"),BidiHandler=acequire("./bidihandler").BidiHandler,config=acequire("./config"),EventEmitter=acequire("./lib/event_emitter").EventEmitter,Selection=acequire("./selection").Selection,TextMode=acequire("./mode/text").Mode,Range=acequire("./range").Range,Document=acequire("./document").Document,BackgroundTokenizer=acequire("./background_tokenizer").BackgroundTokenizer,SearchHighlight=acequire("./search_highlight").SearchHighlight,EditSession=function(text,mode){this.$breakpoints=[],this.$decorations=[],this.$frontMarkers={},this.$backMarkers={},this.$markerId=1,this.$undoSelect=!0,this.$foldData=[],this.id="session"+ ++EditSession.$uid,this.$foldData.toString=function(){return this.join("\n")},this.on("changeFold",this.onChangeFold.bind(this)),this.$onChange=this.onChange.bind(this),"object"==typeof text&&text.getLine||(text=new Document(text)),this.$bidiHandler=new BidiHandler(this),this.setDocument(text),this.selection=new Selection(this),config.resetOptions(this),this.setMode(mode),config._signal("session",this)};EditSession.$uid=0,function(){oop.implement(this,EventEmitter),this.setDocument=function(doc){this.doc&&this.doc.removeListener("change",this.$onChange),this.doc=doc,doc.on("change",this.$onChange),this.bgTokenizer&&this.bgTokenizer.setDocument(this.getDocument()),this.resetCaches()},this.getDocument=function(){return this.doc},this.$resetRowCache=function(docRow){if(!docRow)return this.$docRowCache=[],void(this.$screenRowCache=[]);var l=this.$docRowCache.length,i=this.$getRowCacheIndex(this.$docRowCache,docRow)+1;l>i&&(this.$docRowCache.splice(i,l),this.$screenRowCache.splice(i,l))},this.$getRowCacheIndex=function(cacheArray,val){for(var low=0,hi=cacheArray.length-1;low<=hi;){var mid=low+hi>>1,c=cacheArray[mid];if(val>c)low=mid+1;else{if(!(val<c))return mid;hi=mid-1}}return low-1},this.resetCaches=function(){this.$modified=!0,this.$wrapData=[],this.$rowLengthCache=[],this.$resetRowCache(0),this.bgTokenizer&&this.bgTokenizer.start(0)},this.onChangeFold=function(e){var fold=e.data;this.$resetRowCache(fold.start.row)},this.onChange=function(delta){this.$modified=!0,this.$bidiHandler.onChange(delta),this.$resetRowCache(delta.start.row);var removedFolds=this.$updateInternalDataOnChange(delta);this.$fromUndo||!this.$undoManager||delta.ignore||(this.$deltasDoc.push(delta),removedFolds&&0!=removedFolds.length&&this.$deltasFold.push({action:"removeFolds",folds:removedFolds}),this.$informUndoManager.schedule()),this.bgTokenizer&&this.bgTokenizer.$updateOnChange(delta),this._signal("change",delta)},this.setValue=function(text){this.doc.setValue(text),this.selection.moveTo(0,0),this.$resetRowCache(0),this.$deltas=[],this.$deltasDoc=[],this.$deltasFold=[],this.setUndoManager(this.$undoManager),this.getUndoManager().reset()},this.getValue=this.toString=function(){return this.doc.getValue()},this.getSelection=function(){return this.selection},this.getState=function(row){return this.bgTokenizer.getState(row)},this.getTokens=function(row){return this.bgTokenizer.getTokens(row)},this.getTokenAt=function(row,column){var token,tokens=this.bgTokenizer.getTokens(row),c=0;if(null==column){var i=tokens.length-1;c=this.getLine(row).length}else for(i=0;i<tokens.length&&!((c+=tokens[i].value.length)>=column);i++);return(token=tokens[i])?(token.index=i,token.start=c-token.value.length,token):null},this.setUndoManager=function(undoManager){if(this.$undoManager=undoManager,this.$deltas=[],this.$deltasDoc=[],this.$deltasFold=[],this.$informUndoManager&&this.$informUndoManager.cancel(),undoManager){var self=this;this.$syncInformUndoManager=function(){self.$informUndoManager.cancel(),self.$deltasFold.length&&(self.$deltas.push({group:"fold",deltas:self.$deltasFold}),self.$deltasFold=[]),self.$deltasDoc.length&&(self.$deltas.push({group:"doc",deltas:self.$deltasDoc}),self.$deltasDoc=[]),self.$deltas.length>0&&undoManager.execute({action:"aceupdate",args:[self.$deltas,self],merge:self.mergeUndoDeltas}),self.mergeUndoDeltas=!1,self.$deltas=[]},this.$informUndoManager=lang.delayedCall(this.$syncInformUndoManager)}},this.markUndoGroup=function(){this.$syncInformUndoManager&&this.$syncInformUndoManager()},this.$defaultUndoManager={undo:function(){},redo:function(){},reset:function(){}},this.getUndoManager=function(){return this.$undoManager||this.$defaultUndoManager},this.getTabString=function(){return this.getUseSoftTabs()?lang.stringRepeat(" ",this.getTabSize()):"\t"},this.setUseSoftTabs=function(val){this.setOption("useSoftTabs",val)},this.getUseSoftTabs=function(){return this.$useSoftTabs&&!this.$mode.$indentWithTabs},this.setTabSize=function(tabSize){this.setOption("tabSize",tabSize)},this.getTabSize=function(){return this.$tabSize},this.isTabStop=function(position){return this.$useSoftTabs&&position.column%this.$tabSize==0},this.setNavigateWithinSoftTabs=function(navigateWithinSoftTabs){this.setOption("navigateWithinSoftTabs",navigateWithinSoftTabs)},this.getNavigateWithinSoftTabs=function(){return this.$navigateWithinSoftTabs},this.$overwrite=!1,this.setOverwrite=function(overwrite){this.setOption("overwrite",overwrite)},this.getOverwrite=function(){return this.$overwrite},this.toggleOverwrite=function(){this.setOverwrite(!this.$overwrite)},this.addGutterDecoration=function(row,className){this.$decorations[row]||(this.$decorations[row]=""),this.$decorations[row]+=" "+className,this._signal("changeBreakpoint",{})},this.removeGutterDecoration=function(row,className){this.$decorations[row]=(this.$decorations[row]||"").replace(" "+className,""),this._signal("changeBreakpoint",{})},this.getBreakpoints=function(){return this.$breakpoints},this.setBreakpoints=function(rows){this.$breakpoints=[];for(var i=0;i<rows.length;i++)this.$breakpoints[rows[i]]="ace_breakpoint";this._signal("changeBreakpoint",{})},this.clearBreakpoints=function(){this.$breakpoints=[],this._signal("changeBreakpoint",{})},this.setBreakpoint=function(row,className){void 0===className&&(className="ace_breakpoint"),className?this.$breakpoints[row]=className:delete this.$breakpoints[row],this._signal("changeBreakpoint",{})},this.clearBreakpoint=function(row){delete this.$breakpoints[row],this._signal("changeBreakpoint",{})},this.addMarker=function(range,clazz,type,inFront){var id=this.$markerId++,marker={range:range,type:type||"line",renderer:"function"==typeof type?type:null,clazz:clazz,inFront:!!inFront,id:id};return inFront?(this.$frontMarkers[id]=marker,this._signal("changeFrontMarker")):(this.$backMarkers[id]=marker,this._signal("changeBackMarker")),id},this.addDynamicMarker=function(marker,inFront){if(marker.update){var id=this.$markerId++;return marker.id=id,marker.inFront=!!inFront,inFront?(this.$frontMarkers[id]=marker,this._signal("changeFrontMarker")):(this.$backMarkers[id]=marker,this._signal("changeBackMarker")),marker}},this.removeMarker=function(markerId){var marker=this.$frontMarkers[markerId]||this.$backMarkers[markerId];if(marker){var markers=marker.inFront?this.$frontMarkers:this.$backMarkers;marker&&(delete markers[markerId],this._signal(marker.inFront?"changeFrontMarker":"changeBackMarker"))}},this.getMarkers=function(inFront){return inFront?this.$frontMarkers:this.$backMarkers},this.highlight=function(re){if(!this.$searchHighlight){var highlight=new SearchHighlight(null,"ace_selected-word","text");this.$searchHighlight=this.addDynamicMarker(highlight)}this.$searchHighlight.setRegexp(re)},this.highlightLines=function(startRow,endRow,clazz,inFront){"number"!=typeof endRow&&(clazz=endRow,endRow=startRow),clazz||(clazz="ace_step");var range=new Range(startRow,0,endRow,1/0);return range.id=this.addMarker(range,clazz,"fullLine",inFront),range},this.setAnnotations=function(annotations){this.$annotations=annotations,this._signal("changeAnnotation",{})},this.getAnnotations=function(){return this.$annotations||[]},this.clearAnnotations=function(){this.setAnnotations([])},this.$detectNewLine=function(text){var match=text.match(/^.*?(\r?\n)/m);this.$autoNewLine=match?match[1]:"\n"},this.getWordRange=function(row,column){var line=this.getLine(row),inToken=!1;if(column>0&&(inToken=!!line.charAt(column-1).match(this.tokenRe)),inToken||(inToken=!!line.charAt(column).match(this.tokenRe)),inToken)var re=this.tokenRe;else if(/^\s+$/.test(line.slice(column-1,column+1)))re=/\s/;else re=this.nonTokenRe;var start=column;if(start>0){do{start--}while(start>=0&&line.charAt(start).match(re));start++}for(var end=column;end<line.length&&line.charAt(end).match(re);)end++;return new Range(row,start,row,end)},this.getAWordRange=function(row,column){for(var wordRange=this.getWordRange(row,column),line=this.getLine(wordRange.end.row);line.charAt(wordRange.end.column).match(/[ \t]/);)wordRange.end.column+=1;return wordRange},this.setNewLineMode=function(newLineMode){this.doc.setNewLineMode(newLineMode)},this.getNewLineMode=function(){return this.doc.getNewLineMode()},this.setUseWorker=function(useWorker){this.setOption("useWorker",useWorker)},this.getUseWorker=function(){return this.$useWorker},this.onReloadTokenizer=function(e){var rows=e.data;this.bgTokenizer.start(rows.first),this._signal("tokenizerUpdate",e)},this.$modes={},this.$mode=null,this.$modeId=null,this.setMode=function(mode,cb){if(mode&&"object"==typeof mode){if(mode.getTokenizer)return this.$onChangeMode(mode);var options=mode,path=options.path}else path=mode||"ace/mode/text";if(this.$modes["ace/mode/text"]||(this.$modes["ace/mode/text"]=new TextMode),this.$modes[path]&&!options)return this.$onChangeMode(this.$modes[path]),void(cb&&cb());this.$modeId=path,config.loadModule(["mode",path],function(m){if(this.$modeId!==path)return cb&&cb();this.$modes[path]&&!options?this.$onChangeMode(this.$modes[path]):m&&m.Mode&&(m=new m.Mode(options),options||(this.$modes[path]=m,m.$id=path),this.$onChangeMode(m)),cb&&cb()}.bind(this)),this.$mode||this.$onChangeMode(this.$modes["ace/mode/text"],!0)},this.$onChangeMode=function(mode,$isPlaceholder){if($isPlaceholder||(this.$modeId=mode.$id),this.$mode!==mode){this.$mode=mode,this.$stopWorker(),this.$useWorker&&this.$startWorker();var tokenizer=mode.getTokenizer();if(void 0!==tokenizer.addEventListener){var onReloadTokenizer=this.onReloadTokenizer.bind(this);tokenizer.addEventListener("update",onReloadTokenizer)}if(this.bgTokenizer)this.bgTokenizer.setTokenizer(tokenizer);else{this.bgTokenizer=new BackgroundTokenizer(tokenizer);var _self=this;this.bgTokenizer.addEventListener("update",(function(e){_self._signal("tokenizerUpdate",e)}))}this.bgTokenizer.setDocument(this.getDocument()),this.tokenRe=mode.tokenRe,this.nonTokenRe=mode.nonTokenRe,$isPlaceholder||(mode.attachToSession&&mode.attachToSession(this),this.$options.wrapMethod.set.call(this,this.$wrapMethod),this.$setFolding(mode.foldingRules),this.bgTokenizer.start(0),this._emit("changeMode"))}},this.$stopWorker=function(){this.$worker&&(this.$worker.terminate(),this.$worker=null)},this.$startWorker=function(){try{this.$worker=this.$mode.createWorker(this)}catch(e){config.warn("Could not load worker",e),this.$worker=null}},this.getMode=function(){return this.$mode},this.$scrollTop=0,this.setScrollTop=function(scrollTop){this.$scrollTop===scrollTop||isNaN(scrollTop)||(this.$scrollTop=scrollTop,this._signal("changeScrollTop",scrollTop))},this.getScrollTop=function(){return this.$scrollTop},this.$scrollLeft=0,this.setScrollLeft=function(scrollLeft){this.$scrollLeft===scrollLeft||isNaN(scrollLeft)||(this.$scrollLeft=scrollLeft,this._signal("changeScrollLeft",scrollLeft))},this.getScrollLeft=function(){return this.$scrollLeft},this.getScreenWidth=function(){return this.$computeWidth(),this.lineWidgets?Math.max(this.getLineWidgetMaxWidth(),this.screenWidth):this.screenWidth},this.getLineWidgetMaxWidth=function(){if(null!=this.lineWidgetsWidth)return this.lineWidgetsWidth;var width=0;return this.lineWidgets.forEach((function(w){w&&w.screenWidth>width&&(width=w.screenWidth)})),this.lineWidgetWidth=width},this.$computeWidth=function(force){if(this.$modified||force){if(this.$modified=!1,this.$useWrapMode)return this.screenWidth=this.$wrapLimit;for(var lines=this.doc.getAllLines(),cache=this.$rowLengthCache,longestScreenLine=0,foldIndex=0,foldLine=this.$foldData[foldIndex],foldStart=foldLine?foldLine.start.row:1/0,len=lines.length,i=0;i<len;i++){if(i>foldStart){if((i=foldLine.end.row+1)>=len)break;foldStart=(foldLine=this.$foldData[foldIndex++])?foldLine.start.row:1/0}null==cache[i]&&(cache[i]=this.$getStringScreenWidth(lines[i])[0]),cache[i]>longestScreenLine&&(longestScreenLine=cache[i])}this.screenWidth=longestScreenLine}},this.getLine=function(row){return this.doc.getLine(row)},this.getLines=function(firstRow,lastRow){return this.doc.getLines(firstRow,lastRow)},this.getLength=function(){return this.doc.getLength()},this.getTextRange=function(range){return this.doc.getTextRange(range||this.selection.getRange())},this.insert=function(position,text){return this.doc.insert(position,text)},this.remove=function(range){return this.doc.remove(range)},this.removeFullLines=function(firstRow,lastRow){return this.doc.removeFullLines(firstRow,lastRow)},this.undoChanges=function(deltas,dontSelect){if(deltas.length){this.$fromUndo=!0;for(var lastUndoRange=null,i=deltas.length-1;-1!=i;i--){var delta=deltas[i];"doc"==delta.group?(this.doc.revertDeltas(delta.deltas),lastUndoRange=this.$getUndoSelection(delta.deltas,!0,lastUndoRange)):delta.deltas.forEach((function(foldDelta){this.addFolds(foldDelta.folds)}),this)}return this.$fromUndo=!1,lastUndoRange&&this.$undoSelect&&!dontSelect&&this.selection.setSelectionRange(lastUndoRange),lastUndoRange}},this.redoChanges=function(deltas,dontSelect){if(deltas.length){this.$fromUndo=!0;for(var lastUndoRange=null,i=0;i<deltas.length;i++){var delta=deltas[i];"doc"==delta.group&&(this.doc.applyDeltas(delta.deltas),lastUndoRange=this.$getUndoSelection(delta.deltas,!1,lastUndoRange))}return this.$fromUndo=!1,lastUndoRange&&this.$undoSelect&&!dontSelect&&this.selection.setSelectionRange(lastUndoRange),lastUndoRange}},this.setUndoSelect=function(enable){this.$undoSelect=enable},this.$getUndoSelection=function(deltas,isUndo,lastUndoRange){function isInsert(delta){return isUndo?"insert"!==delta.action:"insert"===delta.action}var range,point,delta=deltas[0];isInsert(delta)?range=Range.fromPoints(delta.start,delta.end):range=Range.fromPoints(delta.start,delta.start);for(var i=1;i<deltas.length;i++)isInsert(delta=deltas[i])?(point=delta.start,-1==range.compare(point.row,point.column)&&range.setStart(point),point=delta.end,1==range.compare(point.row,point.column)&&range.setEnd(point),!0):(point=delta.start,-1==range.compare(point.row,point.column)&&(range=Range.fromPoints(delta.start,delta.start)),!1);if(null!=lastUndoRange){0===Range.comparePoints(lastUndoRange.start,range.start)&&(lastUndoRange.start.column+=range.end.column-range.start.column,lastUndoRange.end.column+=range.end.column-range.start.column);var cmp=lastUndoRange.compareRange(range);1==cmp?range.setStart(lastUndoRange.start):-1==cmp&&range.setEnd(lastUndoRange.end)}return range},this.replace=function(range,text){return this.doc.replace(range,text)},this.moveText=function(fromRange,toPosition,copy){var text=this.getTextRange(fromRange),folds=this.getFoldsInRange(fromRange),toRange=Range.fromPoints(toPosition,toPosition);if(!copy){this.remove(fromRange);var rowDiff=fromRange.start.row-fromRange.end.row;(collDiff=rowDiff?-fromRange.end.column:fromRange.start.column-fromRange.end.column)&&(toRange.start.row==fromRange.end.row&&toRange.start.column>fromRange.end.column&&(toRange.start.column+=collDiff),toRange.end.row==fromRange.end.row&&toRange.end.column>fromRange.end.column&&(toRange.end.column+=collDiff)),rowDiff&&toRange.start.row>=fromRange.end.row&&(toRange.start.row+=rowDiff,toRange.end.row+=rowDiff)}if(toRange.end=this.insert(toRange.start,text),folds.length){var oldStart=fromRange.start,newStart=toRange.start,collDiff=(rowDiff=newStart.row-oldStart.row,newStart.column-oldStart.column);this.addFolds(folds.map((function(x){return(x=x.clone()).start.row==oldStart.row&&(x.start.column+=collDiff),x.end.row==oldStart.row&&(x.end.column+=collDiff),x.start.row+=rowDiff,x.end.row+=rowDiff,x})))}return toRange},this.indentRows=function(startRow,endRow,indentString){indentString=indentString.replace(/\t/g,this.getTabString());for(var row=startRow;row<=endRow;row++)this.doc.insertInLine({row:row,column:0},indentString)},this.outdentRows=function(range){for(var rowRange=range.collapseRows(),deleteRange=new Range(0,0,0,0),size=this.getTabSize(),i=rowRange.start.row;i<=rowRange.end.row;++i){var line=this.getLine(i);deleteRange.start.row=i,deleteRange.end.row=i;for(var j=0;j<size&&" "==line.charAt(j);++j);j<size&&"\t"==line.charAt(j)?(deleteRange.start.column=j,deleteRange.end.column=j+1):(deleteRange.start.column=0,deleteRange.end.column=j),this.remove(deleteRange)}},this.$moveLines=function(firstRow,lastRow,dir){if(firstRow=this.getRowFoldStart(firstRow),lastRow=this.getRowFoldEnd(lastRow),dir<0){if((row=this.getRowFoldStart(firstRow+dir))<0)return 0;var diff=row-firstRow}else if(dir>0){var row;if((row=this.getRowFoldEnd(lastRow+dir))>this.doc.getLength()-1)return 0;diff=row-lastRow}else{firstRow=this.$clipRowToDocument(firstRow);diff=(lastRow=this.$clipRowToDocument(lastRow))-firstRow+1}var range=new Range(firstRow,0,lastRow,Number.MAX_VALUE),folds=this.getFoldsInRange(range).map((function(x){return(x=x.clone()).start.row+=diff,x.end.row+=diff,x})),lines=0==dir?this.doc.getLines(firstRow,lastRow):this.doc.removeFullLines(firstRow,lastRow);return this.doc.insertFullLines(firstRow+diff,lines),folds.length&&this.addFolds(folds),diff},this.moveLinesUp=function(firstRow,lastRow){return this.$moveLines(firstRow,lastRow,-1)},this.moveLinesDown=function(firstRow,lastRow){return this.$moveLines(firstRow,lastRow,1)},this.duplicateLines=function(firstRow,lastRow){return this.$moveLines(firstRow,lastRow,0)},this.$clipRowToDocument=function(row){return Math.max(0,Math.min(row,this.doc.getLength()-1))},this.$clipColumnToRow=function(row,column){return column<0?0:Math.min(this.doc.getLine(row).length,column)},this.$clipPositionToDocument=function(row,column){if(column=Math.max(0,column),row<0)row=0,column=0;else{var len=this.doc.getLength();row>=len?(row=len-1,column=this.doc.getLine(len-1).length):column=Math.min(this.doc.getLine(row).length,column)}return{row:row,column:column}},this.$clipRangeToDocument=function(range){range.start.row<0?(range.start.row=0,range.start.column=0):range.start.column=this.$clipColumnToRow(range.start.row,range.start.column);var len=this.doc.getLength()-1;return range.end.row>len?(range.end.row=len,range.end.column=this.doc.getLine(len).length):range.end.column=this.$clipColumnToRow(range.end.row,range.end.column),range},this.$wrapLimit=80,this.$useWrapMode=!1,this.$wrapLimitRange={min:null,max:null},this.setUseWrapMode=function(useWrapMode){if(useWrapMode!=this.$useWrapMode){if(this.$useWrapMode=useWrapMode,this.$modified=!0,this.$resetRowCache(0),useWrapMode){var len=this.getLength();this.$wrapData=Array(len),this.$updateWrapData(0,len-1)}this._signal("changeWrapMode")}},this.getUseWrapMode=function(){return this.$useWrapMode},this.setWrapLimitRange=function(min,max){this.$wrapLimitRange.min===min&&this.$wrapLimitRange.max===max||(this.$wrapLimitRange={min:min,max:max},this.$modified=!0,this.$bidiHandler.markAsDirty(),this.$useWrapMode&&this._signal("changeWrapMode"))},this.adjustWrapLimit=function(desiredLimit,$printMargin){var limits=this.$wrapLimitRange;limits.max<0&&(limits={min:$printMargin,max:$printMargin});var wrapLimit=this.$constrainWrapLimit(desiredLimit,limits.min,limits.max);return wrapLimit!=this.$wrapLimit&&wrapLimit>1&&(this.$wrapLimit=wrapLimit,this.$modified=!0,this.$useWrapMode&&(this.$updateWrapData(0,this.getLength()-1),this.$resetRowCache(0),this._signal("changeWrapLimit")),!0)},this.$constrainWrapLimit=function(wrapLimit,min,max){return min&&(wrapLimit=Math.max(min,wrapLimit)),max&&(wrapLimit=Math.min(max,wrapLimit)),wrapLimit},this.getWrapLimit=function(){return this.$wrapLimit},this.setWrapLimit=function(limit){this.setWrapLimitRange(limit,limit)},this.getWrapLimitRange=function(){return{min:this.$wrapLimitRange.min,max:this.$wrapLimitRange.max}},this.$updateInternalDataOnChange=function(delta){var useWrapMode=this.$useWrapMode,action=delta.action,start=delta.start,end=delta.end,firstRow=start.row,lastRow=end.row,len=lastRow-firstRow,removedFolds=null;if(this.$updating=!0,0!=len)if("remove"===action){this[useWrapMode?"$wrapData":"$rowLengthCache"].splice(firstRow,len);var foldLines=this.$foldData;removedFolds=this.getFoldsInRange(delta),this.removeFolds(removedFolds);var idx=0;if(foldLine=this.getFoldLine(end.row)){foldLine.addRemoveChars(end.row,end.column,start.column-end.column),foldLine.shiftRow(-len);var foldLineBefore=this.getFoldLine(firstRow);foldLineBefore&&foldLineBefore!==foldLine&&(foldLineBefore.merge(foldLine),foldLine=foldLineBefore),idx=foldLines.indexOf(foldLine)+1}for(;idx<foldLines.length;idx++){(foldLine=foldLines[idx]).start.row>=end.row&&foldLine.shiftRow(-len)}lastRow=firstRow}else{var args=Array(len);args.unshift(firstRow,0);var arr=useWrapMode?this.$wrapData:this.$rowLengthCache;arr.splice.apply(arr,args);foldLines=this.$foldData,idx=0;if(foldLine=this.getFoldLine(firstRow)){var cmp=foldLine.range.compareInside(start.row,start.column);0==cmp?(foldLine=foldLine.split(start.row,start.column))&&(foldLine.shiftRow(len),foldLine.addRemoveChars(lastRow,0,end.column-start.column)):-1==cmp&&(foldLine.addRemoveChars(firstRow,0,end.column-start.column),foldLine.shiftRow(len)),idx=foldLines.indexOf(foldLine)+1}for(;idx<foldLines.length;idx++){var foldLine;(foldLine=foldLines[idx]).start.row>=firstRow&&foldLine.shiftRow(len)}}else len=Math.abs(delta.start.column-delta.end.column),"remove"===action&&(removedFolds=this.getFoldsInRange(delta),this.removeFolds(removedFolds),len=-len),(foldLine=this.getFoldLine(firstRow))&&foldLine.addRemoveChars(firstRow,start.column,len);return useWrapMode&&this.$wrapData.length!=this.doc.getLength()&&console.error("doc.getLength() and $wrapData.length have to be the same!"),this.$updating=!1,useWrapMode?this.$updateWrapData(firstRow,lastRow):this.$updateRowLengthCache(firstRow,lastRow),removedFolds},this.$updateRowLengthCache=function(firstRow,lastRow,b){this.$rowLengthCache[firstRow]=null,this.$rowLengthCache[lastRow]=null},this.$updateWrapData=function(firstRow,lastRow){var tokens,foldLine,lines=this.doc.getAllLines(),tabSize=this.getTabSize(),wrapData=this.$wrapData,wrapLimit=this.$wrapLimit,row=firstRow;for(lastRow=Math.min(lastRow,lines.length-1);row<=lastRow;)(foldLine=this.getFoldLine(row,foldLine))?(tokens=[],foldLine.walk(function(placeholder,row,column,lastColumn){var walkTokens;if(null!=placeholder){(walkTokens=this.$getDisplayTokens(placeholder,tokens.length))[0]=PLACEHOLDER_START;for(var i=1;i<walkTokens.length;i++)walkTokens[i]=PLACEHOLDER_BODY}else walkTokens=this.$getDisplayTokens(lines[row].substring(lastColumn,column),tokens.length);tokens=tokens.concat(walkTokens)}.bind(this),foldLine.end.row,lines[foldLine.end.row].length+1),wrapData[foldLine.start.row]=this.$computeWrapSplits(tokens,wrapLimit,tabSize),row=foldLine.end.row+1):(tokens=this.$getDisplayTokens(lines[row]),wrapData[row]=this.$computeWrapSplits(tokens,wrapLimit,tabSize),row++)};var PLACEHOLDER_START=3,PLACEHOLDER_BODY=4;function isFullWidth(c){return!(c<4352)&&(c>=4352&&c<=4447||c>=4515&&c<=4519||c>=4602&&c<=4607||c>=9001&&c<=9002||c>=11904&&c<=11929||c>=11931&&c<=12019||c>=12032&&c<=12245||c>=12272&&c<=12283||c>=12288&&c<=12350||c>=12353&&c<=12438||c>=12441&&c<=12543||c>=12549&&c<=12589||c>=12593&&c<=12686||c>=12688&&c<=12730||c>=12736&&c<=12771||c>=12784&&c<=12830||c>=12832&&c<=12871||c>=12880&&c<=13054||c>=13056&&c<=19903||c>=19968&&c<=42124||c>=42128&&c<=42182||c>=43360&&c<=43388||c>=44032&&c<=55203||c>=55216&&c<=55238||c>=55243&&c<=55291||c>=63744&&c<=64255||c>=65040&&c<=65049||c>=65072&&c<=65106||c>=65108&&c<=65126||c>=65128&&c<=65131||c>=65281&&c<=65376||c>=65504&&c<=65510)}this.$computeWrapSplits=function(tokens,wrapLimit,tabSize){if(0==tokens.length)return[];var splits=[],displayLength=tokens.length,lastSplit=0,lastDocSplit=0,isCode=this.$wrapAsCode,indentedSoftWrap=this.$indentedSoftWrap,maxIndent=wrapLimit<=Math.max(2*tabSize,8)||!1===indentedSoftWrap?0:Math.floor(wrapLimit/2);function addSplit(screenPos){var displayed=tokens.slice(lastSplit,screenPos),len=displayed.length;displayed.join("").replace(/12/g,(function(){len-=1})).replace(/2/g,(function(){len-=1})),splits.length||(indent=function(){var indentation=0;if(0===maxIndent)return indentation;if(indentedSoftWrap)for(var i=0;i<tokens.length;i++){var token=tokens[i];if(10==token)indentation+=1;else{if(11!=token){if(12==token)continue;break}indentation+=tabSize}}return isCode&&!1!==indentedSoftWrap&&(indentation+=tabSize),Math.min(indentation,maxIndent)}(),splits.indent=indent),lastDocSplit+=len,splits.push(lastDocSplit),lastSplit=screenPos}for(var indent=0;displayLength-lastSplit>wrapLimit-indent;){var split=lastSplit+wrapLimit-indent;if(tokens[split-1]>=10&&tokens[split]>=10)addSplit(split);else if(tokens[split]!=PLACEHOLDER_START&&tokens[split]!=PLACEHOLDER_BODY){for(var minSplit=Math.max(split-(wrapLimit-(wrapLimit>>2)),lastSplit-1);split>minSplit&&tokens[split]<PLACEHOLDER_START;)split--;if(isCode){for(;split>minSplit&&tokens[split]<PLACEHOLDER_START;)split--;for(;split>minSplit&&9==tokens[split];)split--}else for(;split>minSplit&&tokens[split]<10;)split--;split>minSplit?addSplit(++split):(2==tokens[split=lastSplit+wrapLimit]&&split--,addSplit(split-indent))}else{for(;split!=lastSplit-1&&tokens[split]!=PLACEHOLDER_START;split--);if(split>lastSplit){addSplit(split);continue}for(split=lastSplit+wrapLimit;split<tokens.length&&tokens[split]==PLACEHOLDER_BODY;split++);if(split==tokens.length)break;addSplit(split)}}return splits},this.$getDisplayTokens=function(str,offset){var tabSize,arr=[];offset=offset||0;for(var i=0;i<str.length;i++){var c=str.charCodeAt(i);if(9==c){tabSize=this.getScreenTabSize(arr.length+offset),arr.push(11);for(var n=1;n<tabSize;n++)arr.push(12)}else 32==c?arr.push(10):c>39&&c<48||c>57&&c<64?arr.push(9):c>=4352&&isFullWidth(c)?arr.push(1,2):arr.push(1)}return arr},this.$getStringScreenWidth=function(str,maxScreenColumn,screenColumn){if(0==maxScreenColumn)return[0,0];var c,column;for(null==maxScreenColumn&&(maxScreenColumn=1/0),screenColumn=screenColumn||0,column=0;column<str.length&&(9==(c=str.charCodeAt(column))?screenColumn+=this.getScreenTabSize(screenColumn):c>=4352&&isFullWidth(c)?screenColumn+=2:screenColumn+=1,!(screenColumn>maxScreenColumn));column++);return[screenColumn,column]},this.lineWidgets=null,this.getRowLength=function(row){if(this.lineWidgets)var h=this.lineWidgets[row]&&this.lineWidgets[row].rowCount||0;else h=0;return this.$useWrapMode&&this.$wrapData[row]?this.$wrapData[row].length+1+h:1+h},this.getRowLineCount=function(row){return this.$useWrapMode&&this.$wrapData[row]?this.$wrapData[row].length+1:1},this.getRowWrapIndent=function(screenRow){if(this.$useWrapMode){var pos=this.screenToDocumentPosition(screenRow,Number.MAX_VALUE),splits=this.$wrapData[pos.row];return splits.length&&splits[0]<pos.column?splits.indent:0}return 0},this.getScreenLastRowColumn=function(screenRow){var pos=this.screenToDocumentPosition(screenRow,Number.MAX_VALUE);return this.documentToScreenColumn(pos.row,pos.column)},this.getDocumentLastRowColumn=function(docRow,docColumn){var screenRow=this.documentToScreenRow(docRow,docColumn);return this.getScreenLastRowColumn(screenRow)},this.getDocumentLastRowColumnPosition=function(docRow,docColumn){var screenRow=this.documentToScreenRow(docRow,docColumn);return this.screenToDocumentPosition(screenRow,Number.MAX_VALUE/10)},this.getRowSplitData=function(row){return this.$useWrapMode?this.$wrapData[row]:void 0},this.getScreenTabSize=function(screenColumn){return this.$tabSize-screenColumn%this.$tabSize},this.screenToDocumentRow=function(screenRow,screenColumn){return this.screenToDocumentPosition(screenRow,screenColumn).row},this.screenToDocumentColumn=function(screenRow,screenColumn){return this.screenToDocumentPosition(screenRow,screenColumn).column},this.screenToDocumentPosition=function(screenRow,screenColumn,offsetX){if(screenRow<0)return{row:0,column:0};var line,column,docRow=0,docColumn=0,row=0,rowLength=0,rowCache=this.$screenRowCache,i=this.$getRowCacheIndex(rowCache,screenRow),l=rowCache.length;if(l&&i>=0){row=rowCache[i],docRow=this.$docRowCache[i];var doCache=screenRow>rowCache[l-1]}else doCache=!l;for(var maxRow=this.getLength()-1,foldLine=this.getNextFoldLine(docRow),foldStart=foldLine?foldLine.start.row:1/0;row<=screenRow&&!(row+(rowLength=this.getRowLength(docRow))>screenRow||docRow>=maxRow);)row+=rowLength,++docRow>foldStart&&(docRow=foldLine.end.row+1,foldStart=(foldLine=this.getNextFoldLine(docRow,foldLine))?foldLine.start.row:1/0),doCache&&(this.$docRowCache.push(docRow),this.$screenRowCache.push(row));if(foldLine&&foldLine.start.row<=docRow)line=this.getFoldDisplayLine(foldLine),docRow=foldLine.start.row;else{if(row+rowLength<=screenRow||docRow>maxRow)return{row:maxRow,column:this.getLine(maxRow).length};line=this.getLine(docRow),foldLine=null}var wrapIndent=0,splitIndex=Math.floor(screenRow-row);if(this.$useWrapMode){var splits=this.$wrapData[docRow];splits&&(column=splits[splitIndex],splitIndex>0&&splits.length&&(wrapIndent=splits.indent,docColumn=splits[splitIndex-1]||splits[splits.length-1],line=line.substring(docColumn)))}return void 0!==offsetX&&this.$bidiHandler.isBidiRow(row+splitIndex,docRow,splitIndex)&&(screenColumn=this.$bidiHandler.offsetToCol(offsetX)),docColumn+=this.$getStringScreenWidth(line,screenColumn-wrapIndent)[1],this.$useWrapMode&&docColumn>=column&&(docColumn=column-1),foldLine?foldLine.idxToPosition(docColumn):{row:docRow,column:docColumn}},this.documentToScreenPosition=function(docRow,docColumn){if(void 0===docColumn)var pos=this.$clipPositionToDocument(docRow.row,docRow.column);else pos=this.$clipPositionToDocument(docRow,docColumn);docRow=pos.row,docColumn=pos.column;var fold,screenRow=0,foldStartRow=null;(fold=this.getFoldAt(docRow,docColumn,1))&&(docRow=fold.start.row,docColumn=fold.start.column);var rowEnd,row=0,rowCache=this.$docRowCache,i=this.$getRowCacheIndex(rowCache,docRow),l=rowCache.length;if(l&&i>=0){row=rowCache[i],screenRow=this.$screenRowCache[i];var doCache=docRow>rowCache[l-1]}else doCache=!l;for(var foldLine=this.getNextFoldLine(row),foldStart=foldLine?foldLine.start.row:1/0;row<docRow;){if(row>=foldStart){if((rowEnd=foldLine.end.row+1)>docRow)break;foldStart=(foldLine=this.getNextFoldLine(rowEnd,foldLine))?foldLine.start.row:1/0}else rowEnd=row+1;screenRow+=this.getRowLength(row),row=rowEnd,doCache&&(this.$docRowCache.push(row),this.$screenRowCache.push(screenRow))}var textLine="";foldLine&&row>=foldStart?(textLine=this.getFoldDisplayLine(foldLine,docRow,docColumn),foldStartRow=foldLine.start.row):(textLine=this.getLine(docRow).substring(0,docColumn),foldStartRow=docRow);var wrapIndent=0;if(this.$useWrapMode){var wrapRow=this.$wrapData[foldStartRow];if(wrapRow){for(var screenRowOffset=0;textLine.length>=wrapRow[screenRowOffset];)screenRow++,screenRowOffset++;textLine=textLine.substring(wrapRow[screenRowOffset-1]||0,textLine.length),wrapIndent=screenRowOffset>0?wrapRow.indent:0}}return{row:screenRow,column:wrapIndent+this.$getStringScreenWidth(textLine)[0]}},this.documentToScreenColumn=function(row,docColumn){return this.documentToScreenPosition(row,docColumn).column},this.documentToScreenRow=function(docRow,docColumn){return this.documentToScreenPosition(docRow,docColumn).row},this.getScreenLength=function(){var screenRows=0,fold=null;if(this.$useWrapMode)for(var lastRow=this.$wrapData.length,row=0,foldStart=(i=0,(fold=this.$foldData[i++])?fold.start.row:1/0);row<lastRow;){var splits=this.$wrapData[row];screenRows+=splits?splits.length+1:1,++row>foldStart&&(row=fold.end.row+1,foldStart=(fold=this.$foldData[i++])?fold.start.row:1/0)}else{screenRows=this.getLength();for(var foldData=this.$foldData,i=0;i<foldData.length;i++)screenRows-=(fold=foldData[i]).end.row-fold.start.row}return this.lineWidgets&&(screenRows+=this.$getWidgetScreenLength()),screenRows},this.$setFontMetrics=function(fm){this.$enableVarChar&&(this.$getStringScreenWidth=function(str,maxScreenColumn,screenColumn){if(0===maxScreenColumn)return[0,0];var c,column;for(maxScreenColumn||(maxScreenColumn=1/0),screenColumn=screenColumn||0,column=0;column<str.length&&!((screenColumn+="\t"===(c=str.charAt(column))?this.getScreenTabSize(screenColumn):fm.getCharacterWidth(c))>maxScreenColumn);column++);return[screenColumn,column]})},this.destroy=function(){this.bgTokenizer&&(this.bgTokenizer.setDocument(null),this.bgTokenizer=null),this.$stopWorker()},this.isFullWidth=isFullWidth}.call(EditSession.prototype),acequire("./edit_session/folding").Folding.call(EditSession.prototype),acequire("./edit_session/bracket_match").BracketMatch.call(EditSession.prototype),config.defineOptions(EditSession.prototype,"session",{wrap:{set:function(value){if(value&&"off"!=value?"free"==value?value=!0:"printMargin"==value?value=-1:"string"==typeof value&&(value=parseInt(value,10)||!1):value=!1,this.$wrap!=value)if(this.$wrap=value,value){var col="number"==typeof value?value:null;this.setWrapLimitRange(col,col),this.setUseWrapMode(!0)}else this.setUseWrapMode(!1)},get:function(){return this.getUseWrapMode()?-1==this.$wrap?"printMargin":this.getWrapLimitRange().min?this.$wrap:"free":"off"},handlesSet:!0},wrapMethod:{set:function(val){(val="auto"==val?"text"!=this.$mode.type:"text"!=val)!=this.$wrapAsCode&&(this.$wrapAsCode=val,this.$useWrapMode&&(this.$modified=!0,this.$resetRowCache(0),this.$updateWrapData(0,this.getLength()-1)))},initialValue:"auto"},indentedSoftWrap:{initialValue:!0},firstLineNumber:{set:function(){this._signal("changeBreakpoint")},initialValue:1},useWorker:{set:function(useWorker){this.$useWorker=useWorker,this.$stopWorker(),useWorker&&this.$startWorker()},initialValue:!0},useSoftTabs:{initialValue:!0},tabSize:{set:function(tabSize){isNaN(tabSize)||this.$tabSize===tabSize||(this.$modified=!0,this.$rowLengthCache=[],this.$tabSize=tabSize,this._signal("changeTabSize"))},initialValue:4,handlesSet:!0},navigateWithinSoftTabs:{initialValue:!1},overwrite:{set:function(val){this._signal("changeOverwrite")},initialValue:!1},newLineMode:{set:function(val){this.doc.setNewLineMode(val)},get:function(){return this.doc.getNewLineMode()},handlesSet:!0},mode:{set:function(val){this.setMode(val)},get:function(){return this.$modeId}}}),exports.EditSession=EditSession})),ace.define("ace/search",["require","exports","module","ace/lib/lang","ace/lib/oop","ace/range"],(function(acequire,exports,module){"use strict";var lang=acequire("./lib/lang"),oop=acequire("./lib/oop"),Range=acequire("./range").Range,Search=function(){this.$options={}};(function(){this.set=function(options){return oop.mixin(this.$options,options),this},this.getOptions=function(){return lang.copyObject(this.$options)},this.setOptions=function(options){this.$options=options},this.find=function(session){var options=this.$options,iterator=this.$matchIterator(session,options);if(!iterator)return!1;var firstRange=null;return iterator.forEach((function(sr,sc,er,ec){return firstRange=new Range(sr,sc,er,ec),!(sc==ec&&options.start&&options.start.start&&0!=options.skipCurrent&&firstRange.isEqual(options.start))||(firstRange=null,!1)})),firstRange},this.findAll=function(session){var options=this.$options;if(!options.needle)return[];this.$assembleRegExp(options);var range=options.range,lines=range?session.getLines(range.start.row,range.end.row):session.doc.getAllLines(),ranges=[],re=options.re;if(options.$isMultiLine){var prevRange,len=re.length,maxRow=lines.length-len;outer:for(var row=re.offset||0;row<=maxRow;row++){for(var j=0;j<len;j++)if(-1==lines[row+j].search(re[j]))continue outer;var startLine=lines[row],line=lines[row+len-1],startIndex=startLine.length-startLine.match(re[0])[0].length,endIndex=line.match(re[len-1])[0].length;prevRange&&prevRange.end.row===row&&prevRange.end.column>startIndex||(ranges.push(prevRange=new Range(row,startIndex,row+len-1,endIndex)),len>2&&(row=row+len-2))}}else for(var i=0;i<lines.length;i++){var matches=lang.getMatchOffsets(lines[i],re);for(j=0;j<matches.length;j++){var match=matches[j];ranges.push(new Range(i,match.offset,i,match.offset+match.length))}}if(range){var startColumn=range.start.column,endColumn=range.start.column;for(i=0,j=ranges.length-1;i<j&&ranges[i].start.column<startColumn&&ranges[i].start.row==range.start.row;)i++;for(;i<j&&ranges[j].end.column>endColumn&&ranges[j].end.row==range.end.row;)j--;for(ranges=ranges.slice(i,j+1),i=0,j=ranges.length;i<j;i++)ranges[i].start.row+=range.start.row,ranges[i].end.row+=range.start.row}return ranges},this.replace=function(input,replacement){var options=this.$options,re=this.$assembleRegExp(options);if(options.$isMultiLine)return replacement;if(re){var match=re.exec(input);if(!match||match[0].length!=input.length)return null;if(replacement=input.replace(re,replacement),options.preserveCase){replacement=replacement.split("");for(var i=Math.min(input.length,input.length);i--;){var ch=input[i];ch&&ch.toLowerCase()!=ch?replacement[i]=replacement[i].toUpperCase():replacement[i]=replacement[i].toLowerCase()}replacement=replacement.join("")}return replacement}},this.$assembleRegExp=function(options,$disableFakeMultiline){if(options.needle instanceof RegExp)return options.re=options.needle;var needle=options.needle;if(!options.needle)return options.re=!1;options.regExp||(needle=lang.escapeRegExp(needle)),options.wholeWord&&(needle=function(needle,options){function wordBoundary(c){return/\w/.test(c)||options.regExp?"\\b":""}return wordBoundary(needle[0])+needle+wordBoundary(needle[needle.length-1])}(needle,options));var modifier=options.caseSensitive?"gm":"gmi";if(options.$isMultiLine=!$disableFakeMultiline&&/[\n\r]/.test(needle),options.$isMultiLine)return options.re=this.$assembleMultilineRegExp(needle,modifier);try{var re=new RegExp(needle,modifier)}catch(e){re=!1}return options.re=re},this.$assembleMultilineRegExp=function(needle,modifier){for(var parts=needle.replace(/\r\n|\r|\n/g,"$\n^").split("\n"),re=[],i=0;i<parts.length;i++)try{re.push(new RegExp(parts[i],modifier))}catch(e){return!1}return re},this.$matchIterator=function(session,options){var re=this.$assembleRegExp(options);if(!re)return!1;var backwards=1==options.backwards,skipCurrent=0!=options.skipCurrent,range=options.range,start=options.start;start||(start=range?range[backwards?"end":"start"]:session.selection.getRange()),start.start&&(start=start[skipCurrent!=backwards?"end":"start"]);var firstRow=range?range.start.row:0,lastRow=range?range.end.row:session.getLength()-1;if(backwards)var forEach=function(callback){var row=start.row;if(!forEachInLine(row,start.column,callback)){for(row--;row>=firstRow;row--)if(forEachInLine(row,Number.MAX_VALUE,callback))return;if(0!=options.wrap)for(row=lastRow,firstRow=start.row;row>=firstRow;row--)if(forEachInLine(row,Number.MAX_VALUE,callback))return}};else forEach=function(callback){var row=start.row;if(!forEachInLine(row,start.column,callback)){for(row+=1;row<=lastRow;row++)if(forEachInLine(row,0,callback))return;if(0!=options.wrap)for(row=firstRow,lastRow=start.row;row<=lastRow;row++)if(forEachInLine(row,0,callback))return}};if(options.$isMultiLine)var len=re.length,forEachInLine=function(row,offset,callback){var startRow=backwards?row-len+1:row;if(!(startRow<0)){var line=session.getLine(startRow),startIndex=line.search(re[0]);if(!(!backwards&&startIndex<offset||-1===startIndex)){for(var i=1;i<len;i++)if(-1==(line=session.getLine(startRow+i)).search(re[i]))return;var endIndex=line.match(re[len-1])[0].length;if(!(backwards&&endIndex>offset))return!!callback(startRow,startIndex,startRow+len-1,endIndex)||void 0}}};else if(backwards)forEachInLine=function(row,endIndex,callback){var m,line=session.getLine(row),matches=[],last=0;for(re.lastIndex=0;m=re.exec(line);){var length=m[0].length;if(last=m.index,!length){if(last>=line.length)break;re.lastIndex=last+=1}if(m.index+length>endIndex)break;matches.push(m.index,length)}for(var i=matches.length-1;i>=0;i-=2){var column=matches[i-1];if(callback(row,column,row,column+(length=matches[i])))return!0}};else forEachInLine=function(row,startIndex,callback){var m,line=session.getLine(row),last=startIndex;for(re.lastIndex=startIndex;m=re.exec(line);){var length=m[0].length;if(callback(row,last=m.index,row,last+length))return!0;if(!length&&(re.lastIndex=last+=1,last>=line.length))return!1}};return{forEach:forEach}}}).call(Search.prototype),exports.Search=Search})),ace.define("ace/keyboard/hash_handler",["require","exports","module","ace/lib/keys","ace/lib/useragent"],(function(acequire,exports,module){"use strict";var keyUtil=acequire("../lib/keys"),useragent=acequire("../lib/useragent"),KEY_MODS=keyUtil.KEY_MODS;function HashHandler(config,platform){this.platform=platform||(useragent.isMac?"mac":"win"),this.commands={},this.commandKeyBinding={},this.addCommands(config),this.$singleCommand=!0}function MultiHashHandler(config,platform){HashHandler.call(this,config,platform),this.$singleCommand=!1}MultiHashHandler.prototype=HashHandler.prototype,function(){function getPosition(command){return"object"==typeof command&&command.bindKey&&command.bindKey.position||(command.isDefault?-100:0)}this.addCommand=function(command){this.commands[command.name]&&this.removeCommand(command),this.commands[command.name]=command,command.bindKey&&this._buildKeyHash(command)},this.removeCommand=function(command,keepCommand){var name=command&&("string"==typeof command?command:command.name);command=this.commands[name],keepCommand||delete this.commands[name];var ckb=this.commandKeyBinding;for(var keyId in ckb){var cmdGroup=ckb[keyId];if(cmdGroup==command)delete ckb[keyId];else if(Array.isArray(cmdGroup)){var i=cmdGroup.indexOf(command);-1!=i&&(cmdGroup.splice(i,1),1==cmdGroup.length&&(ckb[keyId]=cmdGroup[0]))}}},this.bindKey=function(key,command,position){if("object"==typeof key&&key&&(null==position&&(position=key.position),key=key[this.platform]),key)return"function"==typeof command?this.addCommand({exec:command,bindKey:key,name:command.name||key}):void key.split("|").forEach((function(keyPart){var chain="";if(-1!=keyPart.indexOf(" ")){var parts=keyPart.split(/\s+/);keyPart=parts.pop(),parts.forEach((function(keyPart){var binding=this.parseKeys(keyPart),id=KEY_MODS[binding.hashId]+binding.key;chain+=(chain?" ":"")+id,this._addCommandToBinding(chain,"chainKeys")}),this),chain+=" "}var binding=this.parseKeys(keyPart),id=KEY_MODS[binding.hashId]+binding.key;this._addCommandToBinding(chain+id,command,position)}),this)},this._addCommandToBinding=function(keyId,command,position){var i,ckb=this.commandKeyBinding;if(command)if(!ckb[keyId]||this.$singleCommand)ckb[keyId]=command;else{Array.isArray(ckb[keyId])?-1!=(i=ckb[keyId].indexOf(command))&&ckb[keyId].splice(i,1):ckb[keyId]=[ckb[keyId]],"number"!=typeof position&&(position=getPosition(command));var commands=ckb[keyId];for(i=0;i<commands.length;i++){if(getPosition(commands[i])>position)break}commands.splice(i,0,command)}else delete ckb[keyId]},this.addCommands=function(commands){commands&&Object.keys(commands).forEach((function(name){var command=commands[name];if(command){if("string"==typeof command)return this.bindKey(command,name);"function"==typeof command&&(command={exec:command}),"object"==typeof command&&(command.name||(command.name=name),this.addCommand(command))}}),this)},this.removeCommands=function(commands){Object.keys(commands).forEach((function(name){this.removeCommand(commands[name])}),this)},this.bindKeys=function(keyList){Object.keys(keyList).forEach((function(key){this.bindKey(key,keyList[key])}),this)},this._buildKeyHash=function(command){this.bindKey(command.bindKey,command)},this.parseKeys=function(keys){var parts=keys.toLowerCase().split(/[\-\+]([\-\+])?/).filter((function(x){return x})),key=parts.pop(),keyCode=keyUtil[key];if(keyUtil.FUNCTION_KEYS[keyCode])key=keyUtil.FUNCTION_KEYS[keyCode].toLowerCase();else{if(!parts.length)return{key:key,hashId:-1};if(1==parts.length&&"shift"==parts[0])return{key:key.toUpperCase(),hashId:-1}}for(var hashId=0,i=parts.length;i--;){var modifier=keyUtil.KEY_MODS[parts[i]];if(null==modifier)return"undefined"!=typeof console&&console.error("invalid modifier "+parts[i]+" in "+keys),!1;hashId|=modifier}return{key:key,hashId:hashId}},this.findKeyCommand=function(hashId,keyString){var key=KEY_MODS[hashId]+keyString;return this.commandKeyBinding[key]},this.handleKeyboard=function(data,hashId,keyString,keyCode){if(!(keyCode<0)){var key=KEY_MODS[hashId]+keyString,command=this.commandKeyBinding[key];return data.$keyChain&&(data.$keyChain+=" "+key,command=this.commandKeyBinding[data.$keyChain]||command),!command||"chainKeys"!=command&&"chainKeys"!=command[command.length-1]?(data.$keyChain&&(hashId&&4!=hashId||1!=keyString.length?(-1==hashId||keyCode>0)&&(data.$keyChain=""):data.$keyChain=data.$keyChain.slice(0,-key.length-1)),{command:command}):(data.$keyChain=data.$keyChain||key,{command:"null"})}},this.getStatusText=function(editor,data){return data.$keyChain||""}}.call(HashHandler.prototype),exports.HashHandler=HashHandler,exports.MultiHashHandler=MultiHashHandler})),ace.define("ace/commands/command_manager",["require","exports","module","ace/lib/oop","ace/keyboard/hash_handler","ace/lib/event_emitter"],(function(acequire,exports,module){"use strict";var oop=acequire("../lib/oop"),MultiHashHandler=acequire("../keyboard/hash_handler").MultiHashHandler,EventEmitter=acequire("../lib/event_emitter").EventEmitter,CommandManager=function(platform,commands){MultiHashHandler.call(this,commands,platform),this.byName=this.commands,this.setDefaultHandler("exec",(function(e){return e.command.exec(e.editor,e.args||{})}))};oop.inherits(CommandManager,MultiHashHandler),function(){oop.implement(this,EventEmitter),this.exec=function(command,editor,args){if(Array.isArray(command)){for(var i=command.length;i--;)if(this.exec(command[i],editor,args))return!0;return!1}if("string"==typeof command&&(command=this.commands[command]),!command)return!1;if(editor&&editor.$readOnly&&!command.readOnly)return!1;if(command.isAvailable&&!command.isAvailable(editor))return!1;var e={editor:editor,command:command,args:args};return e.returnValue=this._emit("exec",e),this._signal("afterExec",e),!1!==e.returnValue},this.toggleRecording=function(editor){if(!this.$inReplay)return editor&&editor._emit("changeStatus"),this.recording?(this.macro.pop(),this.removeEventListener("exec",this.$addCommandToMacro),this.macro.length||(this.macro=this.oldMacro),this.recording=!1):(this.$addCommandToMacro||(this.$addCommandToMacro=function(e){this.macro.push([e.command,e.args])}.bind(this)),this.oldMacro=this.macro,this.macro=[],this.on("exec",this.$addCommandToMacro),this.recording=!0)},this.replay=function(editor){if(!this.$inReplay&&this.macro){if(this.recording)return this.toggleRecording(editor);try{this.$inReplay=!0,this.macro.forEach((function(x){"string"==typeof x?this.exec(x,editor):this.exec(x[0],editor,x[1])}),this)}finally{this.$inReplay=!1}}},this.trimMacro=function(m){return m.map((function(x){return"string"!=typeof x[0]&&(x[0]=x[0].name),x[1]||(x=x[0]),x}))}}.call(CommandManager.prototype),exports.CommandManager=CommandManager})),ace.define("ace/commands/default_commands",["require","exports","module","ace/lib/lang","ace/config","ace/range"],(function(acequire,exports,module){"use strict";var lang=acequire("../lib/lang"),config=acequire("../config"),Range=acequire("../range").Range;function bindKey(win,mac){return{win:win,mac:mac}}exports.commands=[{name:"showSettingsMenu",bindKey:bindKey("Ctrl-,","Command-,"),exec:function(editor){config.loadModule("ace/ext/settings_menu",(function(module){module.init(editor),editor.showSettingsMenu()}))},readOnly:!0},{name:"goToNextError",bindKey:bindKey("Alt-E","F4"),exec:function(editor){config.loadModule("ace/ext/error_marker",(function(module){module.showErrorMarker(editor,1)}))},scrollIntoView:"animate",readOnly:!0},{name:"goToPreviousError",bindKey:bindKey("Alt-Shift-E","Shift-F4"),exec:function(editor){config.loadModule("ace/ext/error_marker",(function(module){module.showErrorMarker(editor,-1)}))},scrollIntoView:"animate",readOnly:!0},{name:"selectall",bindKey:bindKey("Ctrl-A","Command-A"),exec:function(editor){editor.selectAll()},readOnly:!0},{name:"centerselection",bindKey:bindKey(null,"Ctrl-L"),exec:function(editor){editor.centerSelection()},readOnly:!0},{name:"gotoline",bindKey:bindKey("Ctrl-L","Command-L"),exec:function(editor){var line=parseInt(prompt("Enter line number:"),10);isNaN(line)||editor.gotoLine(line)},readOnly:!0},{name:"fold",bindKey:bindKey("Alt-L|Ctrl-F1","Command-Alt-L|Command-F1"),exec:function(editor){editor.session.toggleFold(!1)},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:!0},{name:"unfold",bindKey:bindKey("Alt-Shift-L|Ctrl-Shift-F1","Command-Alt-Shift-L|Command-Shift-F1"),exec:function(editor){editor.session.toggleFold(!0)},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:!0},{name:"toggleFoldWidget",bindKey:bindKey("F2","F2"),exec:function(editor){editor.session.toggleFoldWidget()},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:!0},{name:"toggleParentFoldWidget",bindKey:bindKey("Alt-F2","Alt-F2"),exec:function(editor){editor.session.toggleFoldWidget(!0)},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:!0},{name:"foldall",bindKey:bindKey(null,"Ctrl-Command-Option-0"),exec:function(editor){editor.session.foldAll()},scrollIntoView:"center",readOnly:!0},{name:"foldOther",bindKey:bindKey("Alt-0","Command-Option-0"),exec:function(editor){editor.session.foldAll(),editor.session.unfold(editor.selection.getAllRanges())},scrollIntoView:"center",readOnly:!0},{name:"unfoldall",bindKey:bindKey("Alt-Shift-0","Command-Option-Shift-0"),exec:function(editor){editor.session.unfold()},scrollIntoView:"center",readOnly:!0},{name:"findnext",bindKey:bindKey("Ctrl-K","Command-G"),exec:function(editor){editor.findNext()},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:!0},{name:"findprevious",bindKey:bindKey("Ctrl-Shift-K","Command-Shift-G"),exec:function(editor){editor.findPrevious()},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:!0},{name:"selectOrFindNext",bindKey:bindKey("Alt-K","Ctrl-G"),exec:function(editor){editor.selection.isEmpty()?editor.selection.selectWord():editor.findNext()},readOnly:!0},{name:"selectOrFindPrevious",bindKey:bindKey("Alt-Shift-K","Ctrl-Shift-G"),exec:function(editor){editor.selection.isEmpty()?editor.selection.selectWord():editor.findPrevious()},readOnly:!0},{name:"find",bindKey:bindKey("Ctrl-F","Command-F"),exec:function(editor){config.loadModule("ace/ext/searchbox",(function(e){e.Search(editor)}))},readOnly:!0},{name:"overwrite",bindKey:"Insert",exec:function(editor){editor.toggleOverwrite()},readOnly:!0},{name:"selecttostart",bindKey:bindKey("Ctrl-Shift-Home","Command-Shift-Home|Command-Shift-Up"),exec:function(editor){editor.getSelection().selectFileStart()},multiSelectAction:"forEach",readOnly:!0,scrollIntoView:"animate",aceCommandGroup:"fileJump"},{name:"gotostart",bindKey:bindKey("Ctrl-Home","Command-Home|Command-Up"),exec:function(editor){editor.navigateFileStart()},multiSelectAction:"forEach",readOnly:!0,scrollIntoView:"animate",aceCommandGroup:"fileJump"},{name:"selectup",bindKey:bindKey("Shift-Up","Shift-Up|Ctrl-Shift-P"),exec:function(editor){editor.getSelection().selectUp()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"golineup",bindKey:bindKey("Up","Up|Ctrl-P"),exec:function(editor,args){editor.navigateUp(args.times)},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selecttoend",bindKey:bindKey("Ctrl-Shift-End","Command-Shift-End|Command-Shift-Down"),exec:function(editor){editor.getSelection().selectFileEnd()},multiSelectAction:"forEach",readOnly:!0,scrollIntoView:"animate",aceCommandGroup:"fileJump"},{name:"gotoend",bindKey:bindKey("Ctrl-End","Command-End|Command-Down"),exec:function(editor){editor.navigateFileEnd()},multiSelectAction:"forEach",readOnly:!0,scrollIntoView:"animate",aceCommandGroup:"fileJump"},{name:"selectdown",bindKey:bindKey("Shift-Down","Shift-Down|Ctrl-Shift-N"),exec:function(editor){editor.getSelection().selectDown()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"golinedown",bindKey:bindKey("Down","Down|Ctrl-N"),exec:function(editor,args){editor.navigateDown(args.times)},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectwordleft",bindKey:bindKey("Ctrl-Shift-Left","Option-Shift-Left"),exec:function(editor){editor.getSelection().selectWordLeft()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotowordleft",bindKey:bindKey("Ctrl-Left","Option-Left"),exec:function(editor){editor.navigateWordLeft()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selecttolinestart",bindKey:bindKey("Alt-Shift-Left","Command-Shift-Left|Ctrl-Shift-A"),exec:function(editor){editor.getSelection().selectLineStart()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotolinestart",bindKey:bindKey("Alt-Left|Home","Command-Left|Home|Ctrl-A"),exec:function(editor){editor.navigateLineStart()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectleft",bindKey:bindKey("Shift-Left","Shift-Left|Ctrl-Shift-B"),exec:function(editor){editor.getSelection().selectLeft()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotoleft",bindKey:bindKey("Left","Left|Ctrl-B"),exec:function(editor,args){editor.navigateLeft(args.times)},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectwordright",bindKey:bindKey("Ctrl-Shift-Right","Option-Shift-Right"),exec:function(editor){editor.getSelection().selectWordRight()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotowordright",bindKey:bindKey("Ctrl-Right","Option-Right"),exec:function(editor){editor.navigateWordRight()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selecttolineend",bindKey:bindKey("Alt-Shift-Right","Command-Shift-Right|Shift-End|Ctrl-Shift-E"),exec:function(editor){editor.getSelection().selectLineEnd()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotolineend",bindKey:bindKey("Alt-Right|End","Command-Right|End|Ctrl-E"),exec:function(editor){editor.navigateLineEnd()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectright",bindKey:bindKey("Shift-Right","Shift-Right"),exec:function(editor){editor.getSelection().selectRight()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotoright",bindKey:bindKey("Right","Right|Ctrl-F"),exec:function(editor,args){editor.navigateRight(args.times)},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectpagedown",bindKey:"Shift-PageDown",exec:function(editor){editor.selectPageDown()},readOnly:!0},{name:"pagedown",bindKey:bindKey(null,"Option-PageDown"),exec:function(editor){editor.scrollPageDown()},readOnly:!0},{name:"gotopagedown",bindKey:bindKey("PageDown","PageDown|Ctrl-V"),exec:function(editor){editor.gotoPageDown()},readOnly:!0},{name:"selectpageup",bindKey:"Shift-PageUp",exec:function(editor){editor.selectPageUp()},readOnly:!0},{name:"pageup",bindKey:bindKey(null,"Option-PageUp"),exec:function(editor){editor.scrollPageUp()},readOnly:!0},{name:"gotopageup",bindKey:"PageUp",exec:function(editor){editor.gotoPageUp()},readOnly:!0},{name:"scrollup",bindKey:bindKey("Ctrl-Up",null),exec:function(e){e.renderer.scrollBy(0,-2*e.renderer.layerConfig.lineHeight)},readOnly:!0},{name:"scrolldown",bindKey:bindKey("Ctrl-Down",null),exec:function(e){e.renderer.scrollBy(0,2*e.renderer.layerConfig.lineHeight)},readOnly:!0},{name:"selectlinestart",bindKey:"Shift-Home",exec:function(editor){editor.getSelection().selectLineStart()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectlineend",bindKey:"Shift-End",exec:function(editor){editor.getSelection().selectLineEnd()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"togglerecording",bindKey:bindKey("Ctrl-Alt-E","Command-Option-E"),exec:function(editor){editor.commands.toggleRecording(editor)},readOnly:!0},{name:"replaymacro",bindKey:bindKey("Ctrl-Shift-E","Command-Shift-E"),exec:function(editor){editor.commands.replay(editor)},readOnly:!0},{name:"jumptomatching",bindKey:bindKey("Ctrl-P","Ctrl-P"),exec:function(editor){editor.jumpToMatching()},multiSelectAction:"forEach",scrollIntoView:"animate",readOnly:!0},{name:"selecttomatching",bindKey:bindKey("Ctrl-Shift-P","Ctrl-Shift-P"),exec:function(editor){editor.jumpToMatching(!0)},multiSelectAction:"forEach",scrollIntoView:"animate",readOnly:!0},{name:"expandToMatching",bindKey:bindKey("Ctrl-Shift-M","Ctrl-Shift-M"),exec:function(editor){editor.jumpToMatching(!0,!0)},multiSelectAction:"forEach",scrollIntoView:"animate",readOnly:!0},{name:"passKeysToBrowser",bindKey:bindKey(null,null),exec:function(){},passEvent:!0,readOnly:!0},{name:"copy",exec:function(editor){},readOnly:!0},{name:"cut",exec:function(editor){var range=editor.getSelectionRange();editor._emit("cut",range),editor.selection.isEmpty()||(editor.session.remove(range),editor.clearSelection())},scrollIntoView:"cursor",multiSelectAction:"forEach"},{name:"paste",exec:function(editor,args){editor.$handlePaste(args)},scrollIntoView:"cursor"},{name:"removeline",bindKey:bindKey("Ctrl-D","Command-D"),exec:function(editor){editor.removeLines()},scrollIntoView:"cursor",multiSelectAction:"forEachLine"},{name:"duplicateSelection",bindKey:bindKey("Ctrl-Shift-D","Command-Shift-D"),exec:function(editor){editor.duplicateSelection()},scrollIntoView:"cursor",multiSelectAction:"forEach"},{name:"sortlines",bindKey:bindKey("Ctrl-Alt-S","Command-Alt-S"),exec:function(editor){editor.sortLines()},scrollIntoView:"selection",multiSelectAction:"forEachLine"},{name:"togglecomment",bindKey:bindKey("Ctrl-/","Command-/"),exec:function(editor){editor.toggleCommentLines()},multiSelectAction:"forEachLine",scrollIntoView:"selectionPart"},{name:"toggleBlockComment",bindKey:bindKey("Ctrl-Shift-/","Command-Shift-/"),exec:function(editor){editor.toggleBlockComment()},multiSelectAction:"forEach",scrollIntoView:"selectionPart"},{name:"modifyNumberUp",bindKey:bindKey("Ctrl-Shift-Up","Alt-Shift-Up"),exec:function(editor){editor.modifyNumber(1)},scrollIntoView:"cursor",multiSelectAction:"forEach"},{name:"modifyNumberDown",bindKey:bindKey("Ctrl-Shift-Down","Alt-Shift-Down"),exec:function(editor){editor.modifyNumber(-1)},scrollIntoView:"cursor",multiSelectAction:"forEach"},{name:"replace",bindKey:bindKey("Ctrl-H","Command-Option-F"),exec:function(editor){config.loadModule("ace/ext/searchbox",(function(e){e.Search(editor,!0)}))}},{name:"undo",bindKey:bindKey("Ctrl-Z","Command-Z"),exec:function(editor){editor.undo()}},{name:"redo",bindKey:bindKey("Ctrl-Shift-Z|Ctrl-Y","Command-Shift-Z|Command-Y"),exec:function(editor){editor.redo()}},{name:"copylinesup",bindKey:bindKey("Alt-Shift-Up","Command-Option-Up"),exec:function(editor){editor.copyLinesUp()},scrollIntoView:"cursor"},{name:"movelinesup",bindKey:bindKey("Alt-Up","Option-Up"),exec:function(editor){editor.moveLinesUp()},scrollIntoView:"cursor"},{name:"copylinesdown",bindKey:bindKey("Alt-Shift-Down","Command-Option-Down"),exec:function(editor){editor.copyLinesDown()},scrollIntoView:"cursor"},{name:"movelinesdown",bindKey:bindKey("Alt-Down","Option-Down"),exec:function(editor){editor.moveLinesDown()},scrollIntoView:"cursor"},{name:"del",bindKey:bindKey("Delete","Delete|Ctrl-D|Shift-Delete"),exec:function(editor){editor.remove("right")},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"backspace",bindKey:bindKey("Shift-Backspace|Backspace","Ctrl-Backspace|Shift-Backspace|Backspace|Ctrl-H"),exec:function(editor){editor.remove("left")},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"cut_or_delete",bindKey:bindKey("Shift-Delete",null),exec:function(editor){if(!editor.selection.isEmpty())return!1;editor.remove("left")},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removetolinestart",bindKey:bindKey("Alt-Backspace","Command-Backspace"),exec:function(editor){editor.removeToLineStart()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removetolineend",bindKey:bindKey("Alt-Delete","Ctrl-K|Command-Delete"),exec:function(editor){editor.removeToLineEnd()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removetolinestarthard",bindKey:bindKey("Ctrl-Shift-Backspace",null),exec:function(editor){var range=editor.selection.getRange();range.start.column=0,editor.session.remove(range)},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removetolineendhard",bindKey:bindKey("Ctrl-Shift-Delete",null),exec:function(editor){var range=editor.selection.getRange();range.end.column=Number.MAX_VALUE,editor.session.remove(range)},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removewordleft",bindKey:bindKey("Ctrl-Backspace","Alt-Backspace|Ctrl-Alt-Backspace"),exec:function(editor){editor.removeWordLeft()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removewordright",bindKey:bindKey("Ctrl-Delete","Alt-Delete"),exec:function(editor){editor.removeWordRight()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"outdent",bindKey:bindKey("Shift-Tab","Shift-Tab"),exec:function(editor){editor.blockOutdent()},multiSelectAction:"forEach",scrollIntoView:"selectionPart"},{name:"indent",bindKey:bindKey("Tab","Tab"),exec:function(editor){editor.indent()},multiSelectAction:"forEach",scrollIntoView:"selectionPart"},{name:"blockoutdent",bindKey:bindKey("Ctrl-[","Ctrl-["),exec:function(editor){editor.blockOutdent()},multiSelectAction:"forEachLine",scrollIntoView:"selectionPart"},{name:"blockindent",bindKey:bindKey("Ctrl-]","Ctrl-]"),exec:function(editor){editor.blockIndent()},multiSelectAction:"forEachLine",scrollIntoView:"selectionPart"},{name:"insertstring",exec:function(editor,str){editor.insert(str)},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"inserttext",exec:function(editor,args){editor.insert(lang.stringRepeat(args.text||"",args.times||1))},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"splitline",bindKey:bindKey(null,"Ctrl-O"),exec:function(editor){editor.splitLine()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"transposeletters",bindKey:bindKey("Alt-Shift-X","Ctrl-T"),exec:function(editor){editor.transposeLetters()},multiSelectAction:function(editor){editor.transposeSelections(1)},scrollIntoView:"cursor"},{name:"touppercase",bindKey:bindKey("Ctrl-U","Ctrl-U"),exec:function(editor){editor.toUpperCase()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"tolowercase",bindKey:bindKey("Ctrl-Shift-U","Ctrl-Shift-U"),exec:function(editor){editor.toLowerCase()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"expandtoline",bindKey:bindKey("Ctrl-Shift-L","Command-Shift-L"),exec:function(editor){var range=editor.selection.getRange();range.start.column=range.end.column=0,range.end.row++,editor.selection.setRange(range,!1)},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"joinlines",bindKey:bindKey(null,null),exec:function(editor){for(var isBackwards=editor.selection.isBackwards(),selectionStart=isBackwards?editor.selection.getSelectionLead():editor.selection.getSelectionAnchor(),selectionEnd=isBackwards?editor.selection.getSelectionAnchor():editor.selection.getSelectionLead(),firstLineEndCol=editor.session.doc.getLine(selectionStart.row).length,selectedCount=editor.session.doc.getTextRange(editor.selection.getRange()).replace(/\n\s*/," ").length,insertLine=editor.session.doc.getLine(selectionStart.row),i=selectionStart.row+1;i<=selectionEnd.row+1;i++){var curLine=lang.stringTrimLeft(lang.stringTrimRight(editor.session.doc.getLine(i)));0!==curLine.length&&(curLine=" "+curLine),insertLine+=curLine}selectionEnd.row+1<editor.session.doc.getLength()-1&&(insertLine+=editor.session.doc.getNewLineCharacter()),editor.clearSelection(),editor.session.doc.replace(new Range(selectionStart.row,0,selectionEnd.row+2,0),insertLine),selectedCount>0?(editor.selection.moveCursorTo(selectionStart.row,selectionStart.column),editor.selection.selectTo(selectionStart.row,selectionStart.column+selectedCount)):(firstLineEndCol=editor.session.doc.getLine(selectionStart.row).length>firstLineEndCol?firstLineEndCol+1:firstLineEndCol,editor.selection.moveCursorTo(selectionStart.row,firstLineEndCol))},multiSelectAction:"forEach",readOnly:!0},{name:"invertSelection",bindKey:bindKey(null,null),exec:function(editor){var endRow=editor.session.doc.getLength()-1,endCol=editor.session.doc.getLine(endRow).length,ranges=editor.selection.rangeList.ranges,newRanges=[];ranges.length<1&&(ranges=[editor.selection.getRange()]);for(var i=0;i<ranges.length;i++)i==ranges.length-1&&(ranges[i].end.row===endRow&&ranges[i].end.column===endCol||newRanges.push(new Range(ranges[i].end.row,ranges[i].end.column,endRow,endCol))),0===i?0===ranges[i].start.row&&0===ranges[i].start.column||newRanges.push(new Range(0,0,ranges[i].start.row,ranges[i].start.column)):newRanges.push(new Range(ranges[i-1].end.row,ranges[i-1].end.column,ranges[i].start.row,ranges[i].start.column));editor.exitMultiSelectMode(),editor.clearSelection();for(i=0;i<newRanges.length;i++)editor.selection.addRange(newRanges[i],!1)},readOnly:!0,scrollIntoView:"none"}]})),ace.define("ace/editor",["require","exports","module","ace/lib/fixoldbrowsers","ace/lib/oop","ace/lib/dom","ace/lib/lang","ace/lib/useragent","ace/keyboard/textinput","ace/mouse/mouse_handler","ace/mouse/fold_handler","ace/keyboard/keybinding","ace/edit_session","ace/search","ace/range","ace/lib/event_emitter","ace/commands/command_manager","ace/commands/default_commands","ace/config","ace/token_iterator"],(function(acequire,exports,module){"use strict";acequire("./lib/fixoldbrowsers");var oop=acequire("./lib/oop"),dom=acequire("./lib/dom"),lang=acequire("./lib/lang"),useragent=acequire("./lib/useragent"),TextInput=acequire("./keyboard/textinput").TextInput,MouseHandler=acequire("./mouse/mouse_handler").MouseHandler,FoldHandler=acequire("./mouse/fold_handler").FoldHandler,KeyBinding=acequire("./keyboard/keybinding").KeyBinding,EditSession=acequire("./edit_session").EditSession,Search=acequire("./search").Search,Range=acequire("./range").Range,EventEmitter=acequire("./lib/event_emitter").EventEmitter,CommandManager=acequire("./commands/command_manager").CommandManager,defaultCommands=acequire("./commands/default_commands").commands,config=acequire("./config"),TokenIterator=acequire("./token_iterator").TokenIterator,Editor=function(renderer,session){var container=renderer.getContainerElement();this.container=container,this.renderer=renderer,this.id="editor"+ ++Editor.$uid,this.commands=new CommandManager(useragent.isMac?"mac":"win",defaultCommands),"object"==typeof document&&(this.textInput=new TextInput(renderer.getTextAreaContainer(),this),this.renderer.textarea=this.textInput.getElement(),this.$mouseHandler=new MouseHandler(this),new FoldHandler(this)),this.keyBinding=new KeyBinding(this),this.$blockScrolling=0,this.$search=(new Search).set({wrap:!0}),this.$historyTracker=this.$historyTracker.bind(this),this.commands.on("exec",this.$historyTracker),this.$initOperationListeners(),this._$emitInputEvent=lang.delayedCall(function(){this._signal("input",{}),this.session&&this.session.bgTokenizer&&this.session.bgTokenizer.scheduleStart()}.bind(this)),this.on("change",(function(_,_self){_self._$emitInputEvent.schedule(31)})),this.setSession(session||new EditSession("")),config.resetOptions(this),config._signal("editor",this)};Editor.$uid=0,function(){oop.implement(this,EventEmitter),this.$initOperationListeners=function(){this.selections=[],this.commands.on("exec",this.startOperation.bind(this),!0),this.commands.on("afterExec",this.endOperation.bind(this),!0),this.$opResetTimer=lang.delayedCall(this.endOperation.bind(this)),this.on("change",function(){this.curOp||this.startOperation(),this.curOp.docChanged=!0}.bind(this),!0),this.on("changeSelection",function(){this.curOp||this.startOperation(),this.curOp.selectionChanged=!0}.bind(this),!0)},this.curOp=null,this.prevOp={},this.startOperation=function(commadEvent){if(this.curOp){if(!commadEvent||this.curOp.command)return;this.prevOp=this.curOp}commadEvent||(this.previousCommand=null,commadEvent={}),this.$opResetTimer.schedule(),this.curOp={command:commadEvent.command||{},args:commadEvent.args,scrollTop:this.renderer.scrollTop},this.curOp.command.name&&void 0!==this.curOp.command.scrollIntoView&&this.$blockScrolling++},this.endOperation=function(e){if(this.curOp){if(e&&!1===e.returnValue)return this.curOp=null;this._signal("beforeEndOperation");var command=this.curOp.command;command.name&&this.$blockScrolling>0&&this.$blockScrolling--;var scrollIntoView=command&&command.scrollIntoView;if(scrollIntoView){switch(scrollIntoView){case"center-animate":scrollIntoView="animate";case"center":this.renderer.scrollCursorIntoView(null,.5);break;case"animate":case"cursor":this.renderer.scrollCursorIntoView();break;case"selectionPart":var range=this.selection.getRange(),config=this.renderer.layerConfig;(range.start.row>=config.lastRow||range.end.row<=config.firstRow)&&this.renderer.scrollSelectionIntoView(this.selection.anchor,this.selection.lead)}"animate"==scrollIntoView&&this.renderer.animateScrolling(this.curOp.scrollTop)}this.prevOp=this.curOp,this.curOp=null}},this.$mergeableCommands=["backspace","del","insertstring"],this.$historyTracker=function(e){if(this.$mergeUndoDeltas){var prev=this.prevOp,mergeableCommands=this.$mergeableCommands,shouldMerge=prev.command&&e.command.name==prev.command.name;if("insertstring"==e.command.name){var text=e.args;void 0===this.mergeNextCommand&&(this.mergeNextCommand=!0),shouldMerge=shouldMerge&&this.mergeNextCommand&&(!/\s/.test(text)||/\s/.test(prev.args)),this.mergeNextCommand=!0}else shouldMerge=shouldMerge&&-1!==mergeableCommands.indexOf(e.command.name);"always"!=this.$mergeUndoDeltas&&Date.now()-this.sequenceStartTime>2e3&&(shouldMerge=!1),shouldMerge?this.session.mergeUndoDeltas=!0:-1!==mergeableCommands.indexOf(e.command.name)&&(this.sequenceStartTime=Date.now())}},this.setKeyboardHandler=function(keyboardHandler,cb){if(keyboardHandler&&"string"==typeof keyboardHandler){this.$keybindingId=keyboardHandler;var _self=this;config.loadModule(["keybinding",keyboardHandler],(function(module){_self.$keybindingId==keyboardHandler&&_self.keyBinding.setKeyboardHandler(module&&module.handler),cb&&cb()}))}else this.$keybindingId=null,this.keyBinding.setKeyboardHandler(keyboardHandler),cb&&cb()},this.getKeyboardHandler=function(){return this.keyBinding.getKeyboardHandler()},this.setSession=function(session){if(this.session!=session){this.curOp&&this.endOperation(),this.curOp={};var oldSession=this.session;if(oldSession){this.session.off("change",this.$onDocumentChange),this.session.off("changeMode",this.$onChangeMode),this.session.off("tokenizerUpdate",this.$onTokenizerUpdate),this.session.off("changeTabSize",this.$onChangeTabSize),this.session.off("changeWrapLimit",this.$onChangeWrapLimit),this.session.off("changeWrapMode",this.$onChangeWrapMode),this.session.off("changeFold",this.$onChangeFold),this.session.off("changeFrontMarker",this.$onChangeFrontMarker),this.session.off("changeBackMarker",this.$onChangeBackMarker),this.session.off("changeBreakpoint",this.$onChangeBreakpoint),this.session.off("changeAnnotation",this.$onChangeAnnotation),this.session.off("changeOverwrite",this.$onCursorChange),this.session.off("changeScrollTop",this.$onScrollTopChange),this.session.off("changeScrollLeft",this.$onScrollLeftChange);var selection=this.session.getSelection();selection.off("changeCursor",this.$onCursorChange),selection.off("changeSelection",this.$onSelectionChange)}this.session=session,session?(this.$onDocumentChange=this.onDocumentChange.bind(this),session.on("change",this.$onDocumentChange),this.renderer.setSession(session),this.$onChangeMode=this.onChangeMode.bind(this),session.on("changeMode",this.$onChangeMode),this.$onTokenizerUpdate=this.onTokenizerUpdate.bind(this),session.on("tokenizerUpdate",this.$onTokenizerUpdate),this.$onChangeTabSize=this.renderer.onChangeTabSize.bind(this.renderer),session.on("changeTabSize",this.$onChangeTabSize),this.$onChangeWrapLimit=this.onChangeWrapLimit.bind(this),session.on("changeWrapLimit",this.$onChangeWrapLimit),this.$onChangeWrapMode=this.onChangeWrapMode.bind(this),session.on("changeWrapMode",this.$onChangeWrapMode),this.$onChangeFold=this.onChangeFold.bind(this),session.on("changeFold",this.$onChangeFold),this.$onChangeFrontMarker=this.onChangeFrontMarker.bind(this),this.session.on("changeFrontMarker",this.$onChangeFrontMarker),this.$onChangeBackMarker=this.onChangeBackMarker.bind(this),this.session.on("changeBackMarker",this.$onChangeBackMarker),this.$onChangeBreakpoint=this.onChangeBreakpoint.bind(this),this.session.on("changeBreakpoint",this.$onChangeBreakpoint),this.$onChangeAnnotation=this.onChangeAnnotation.bind(this),this.session.on("changeAnnotation",this.$onChangeAnnotation),this.$onCursorChange=this.onCursorChange.bind(this),this.session.on("changeOverwrite",this.$onCursorChange),this.$onScrollTopChange=this.onScrollTopChange.bind(this),this.session.on("changeScrollTop",this.$onScrollTopChange),this.$onScrollLeftChange=this.onScrollLeftChange.bind(this),this.session.on("changeScrollLeft",this.$onScrollLeftChange),this.selection=session.getSelection(),this.selection.on("changeCursor",this.$onCursorChange),this.$onSelectionChange=this.onSelectionChange.bind(this),this.selection.on("changeSelection",this.$onSelectionChange),this.onChangeMode(),this.$blockScrolling+=1,this.onCursorChange(),this.$blockScrolling-=1,this.onScrollTopChange(),this.onScrollLeftChange(),this.onSelectionChange(),this.onChangeFrontMarker(),this.onChangeBackMarker(),this.onChangeBreakpoint(),this.onChangeAnnotation(),this.session.getUseWrapMode()&&this.renderer.adjustWrapLimit(),this.renderer.updateFull()):(this.selection=null,this.renderer.setSession(session)),this._signal("changeSession",{session:session,oldSession:oldSession}),this.curOp=null,oldSession&&oldSession._signal("changeEditor",{oldEditor:this}),session&&session._signal("changeEditor",{editor:this}),session&&session.bgTokenizer&&session.bgTokenizer.scheduleStart()}},this.getSession=function(){return this.session},this.setValue=function(val,cursorPos){return this.session.doc.setValue(val),cursorPos?1==cursorPos?this.navigateFileEnd():-1==cursorPos&&this.navigateFileStart():this.selectAll(),val},this.getValue=function(){return this.session.getValue()},this.getSelection=function(){return this.selection},this.resize=function(force){this.renderer.onResize(force)},this.setTheme=function(theme,cb){this.renderer.setTheme(theme,cb)},this.getTheme=function(){return this.renderer.getTheme()},this.setStyle=function(style){this.renderer.setStyle(style)},this.unsetStyle=function(style){this.renderer.unsetStyle(style)},this.getFontSize=function(){return this.getOption("fontSize")||dom.computedStyle(this.container,"fontSize")},this.setFontSize=function(size){this.setOption("fontSize",size)},this.$highlightBrackets=function(){if(this.session.$bracketHighlight&&(this.session.removeMarker(this.session.$bracketHighlight),this.session.$bracketHighlight=null),!this.$highlightPending){var self=this;this.$highlightPending=!0,setTimeout((function(){self.$highlightPending=!1;var session=self.session;if(session&&session.bgTokenizer){var pos=session.findMatchingBracket(self.getCursorPosition());if(pos)var range=new Range(pos.row,pos.column,pos.row,pos.column+1);else if(session.$mode.getMatching)range=session.$mode.getMatching(self.session);range&&(session.$bracketHighlight=session.addMarker(range,"ace_bracket","text"))}}),50)}},this.$highlightTags=function(){if(!this.$highlightTagPending){var self=this;this.$highlightTagPending=!0,setTimeout((function(){self.$highlightTagPending=!1;var session=self.session;if(session&&session.bgTokenizer){var pos=self.getCursorPosition(),iterator=new TokenIterator(self.session,pos.row,pos.column),token=iterator.getCurrentToken();if(!token||!/\b(?:tag-open|tag-name)/.test(token.type))return session.removeMarker(session.$tagHighlight),void(session.$tagHighlight=null);if(-1==token.type.indexOf("tag-open")||(token=iterator.stepForward())){var tag=token.value,depth=0,prevToken=iterator.stepBackward();if("<"==prevToken.value)do{prevToken=token,(token=iterator.stepForward())&&token.value===tag&&-1!==token.type.indexOf("tag-name")&&("<"===prevToken.value?depth++:"</"===prevToken.value&&depth--)}while(token&&depth>=0);else{do{token=prevToken,prevToken=iterator.stepBackward(),token&&token.value===tag&&-1!==token.type.indexOf("tag-name")&&("<"===prevToken.value?depth++:"</"===prevToken.value&&depth--)}while(prevToken&&depth<=0);iterator.stepForward()}if(!token)return session.removeMarker(session.$tagHighlight),void(session.$tagHighlight=null);var row=iterator.getCurrentTokenRow(),column=iterator.getCurrentTokenColumn(),range=new Range(row,column,row,column+token.value.length),sbm=session.$backMarkers[session.$tagHighlight];session.$tagHighlight&&null!=sbm&&0!==range.compareRange(sbm.range)&&(session.removeMarker(session.$tagHighlight),session.$tagHighlight=null),range&&!session.$tagHighlight&&(session.$tagHighlight=session.addMarker(range,"ace_bracket","text"))}}}),50)}},this.focus=function(){var _self=this;setTimeout((function(){_self.textInput.focus()})),this.textInput.focus()},this.isFocused=function(){return this.textInput.isFocused()},this.blur=function(){this.textInput.blur()},this.onFocus=function(e){this.$isFocused||(this.$isFocused=!0,this.renderer.showCursor(),this.renderer.visualizeFocus(),this._emit("focus",e))},this.onBlur=function(e){this.$isFocused&&(this.$isFocused=!1,this.renderer.hideCursor(),this.renderer.visualizeBlur(),this._emit("blur",e))},this.$cursorChange=function(){this.renderer.updateCursor()},this.onDocumentChange=function(delta){var wrap=this.session.$useWrapMode,lastRow=delta.start.row==delta.end.row?delta.end.row:1/0;this.renderer.updateLines(delta.start.row,lastRow,wrap),this._signal("change",delta),this.$cursorChange(),this.$updateHighlightActiveLine()},this.onTokenizerUpdate=function(e){var rows=e.data;this.renderer.updateLines(rows.first,rows.last)},this.onScrollTopChange=function(){this.renderer.scrollToY(this.session.getScrollTop())},this.onScrollLeftChange=function(){this.renderer.scrollToX(this.session.getScrollLeft())},this.onCursorChange=function(){this.$cursorChange(),this.$blockScrolling||(config.warn("Automatically scrolling cursor into view after selection change","this will be disabled in the next version","set editor.$blockScrolling = Infinity to disable this message"),this.renderer.scrollCursorIntoView()),this.$highlightBrackets(),this.$highlightTags(),this.$updateHighlightActiveLine(),this._signal("changeSelection")},this.$updateHighlightActiveLine=function(){var highlight,session=this.getSession();if(this.$highlightActiveLine&&("line"==this.$selectionStyle&&this.selection.isMultiLine()||(highlight=this.getCursorPosition()),!this.renderer.$maxLines||1!==this.session.getLength()||this.renderer.$minLines>1||(highlight=!1)),session.$highlightLineMarker&&!highlight)session.removeMarker(session.$highlightLineMarker.id),session.$highlightLineMarker=null;else if(!session.$highlightLineMarker&&highlight){var range=new Range(highlight.row,highlight.column,highlight.row,1/0);range.id=session.addMarker(range,"ace_active-line","screenLine"),session.$highlightLineMarker=range}else highlight&&(session.$highlightLineMarker.start.row=highlight.row,session.$highlightLineMarker.end.row=highlight.row,session.$highlightLineMarker.start.column=highlight.column,session._signal("changeBackMarker"))},this.onSelectionChange=function(e){var session=this.session;if(session.$selectionMarker&&session.removeMarker(session.$selectionMarker),session.$selectionMarker=null,this.selection.isEmpty())this.$updateHighlightActiveLine();else{var range=this.selection.getRange(),style=this.getSelectionStyle();session.$selectionMarker=session.addMarker(range,"ace_selection",style)}var re=this.$highlightSelectedWord&&this.$getSelectionHighLightRegexp();this.session.highlight(re),this._signal("changeSelection")},this.$getSelectionHighLightRegexp=function(){var session=this.session,selection=this.getSelectionRange();if(!selection.isEmpty()&&!selection.isMultiLine()){var startOuter=selection.start.column-1,endOuter=selection.end.column+1,line=session.getLine(selection.start.row),lineCols=line.length,needle=line.substring(Math.max(startOuter,0),Math.min(endOuter,lineCols));if(!(startOuter>=0&&/^[\w\d]/.test(needle)||endOuter<=lineCols&&/[\w\d]$/.test(needle)))if(needle=line.substring(selection.start.column,selection.end.column),/^[\w\d]+$/.test(needle))return this.$search.$assembleRegExp({wholeWord:!0,caseSensitive:!0,needle:needle})}},this.onChangeFrontMarker=function(){this.renderer.updateFrontMarkers()},this.onChangeBackMarker=function(){this.renderer.updateBackMarkers()},this.onChangeBreakpoint=function(){this.renderer.updateBreakpoints()},this.onChangeAnnotation=function(){this.renderer.setAnnotations(this.session.getAnnotations())},this.onChangeMode=function(e){this.renderer.updateText(),this._emit("changeMode",e)},this.onChangeWrapLimit=function(){this.renderer.updateFull()},this.onChangeWrapMode=function(){this.renderer.onResize(!0)},this.onChangeFold=function(){this.$updateHighlightActiveLine(),this.renderer.updateFull()},this.getSelectedText=function(){return this.session.getTextRange(this.getSelectionRange())},this.getCopyText=function(){var text=this.getSelectedText();return this._signal("copy",text),text},this.onCopy=function(){this.commands.exec("copy",this)},this.onCut=function(){this.commands.exec("cut",this)},this.onPaste=function(text,event){var e={text:text,event:event};this.commands.exec("paste",this,e)},this.$handlePaste=function(e){"string"==typeof e&&(e={text:e}),this._signal("paste",e);var text=e.text;if(!this.inMultiSelectMode||this.inVirtualSelectionMode)this.insert(text);else{var lines=text.split(/\r\n|\r|\n/),ranges=this.selection.rangeList.ranges;if(lines.length>ranges.length||lines.length<2||!lines[1])return this.commands.exec("insertstring",this,text);for(var i=ranges.length;i--;){var range=ranges[i];range.isEmpty()||this.session.remove(range),this.session.insert(range.start,lines[i])}}},this.execCommand=function(command,args){return this.commands.exec(command,this,args)},this.insert=function(text,pasted){var session=this.session,mode=session.getMode(),cursor=this.getCursorPosition();if(this.getBehavioursEnabled()&&!pasted){var transform=mode.transformAction(session.getState(cursor.row),"insertion",this,session,text);transform&&(text!==transform.text&&(this.session.mergeUndoDeltas=!1,this.$mergeNextCommand=!1),text=transform.text)}if("\t"==text&&(text=this.session.getTabString()),this.selection.isEmpty()){if(this.session.getOverwrite()&&-1==text.indexOf("\n")){(range=new Range.fromPoints(cursor,cursor)).end.column+=text.length,this.session.remove(range)}}else{var range=this.getSelectionRange();cursor=this.session.remove(range),this.clearSelection()}if("\n"==text||"\r\n"==text){var line=session.getLine(cursor.row);if(cursor.column>line.search(/\S|$/)){var d=line.substr(cursor.column).search(/\S|$/);session.doc.removeInLine(cursor.row,cursor.column,cursor.column+d)}}this.clearSelection();var start=cursor.column,lineState=session.getState(cursor.row),shouldOutdent=(line=session.getLine(cursor.row),mode.checkOutdent(lineState,line,text));session.insert(cursor,text);if(transform&&transform.selection&&(2==transform.selection.length?this.selection.setSelectionRange(new Range(cursor.row,start+transform.selection[0],cursor.row,start+transform.selection[1])):this.selection.setSelectionRange(new Range(cursor.row+transform.selection[0],transform.selection[1],cursor.row+transform.selection[2],transform.selection[3]))),session.getDocument().isNewLine(text)){var lineIndent=mode.getNextLineIndent(lineState,line.slice(0,cursor.column),session.getTabString());session.insert({row:cursor.row+1,column:0},lineIndent)}shouldOutdent&&mode.autoOutdent(lineState,session,cursor.row)},this.onTextInput=function(text){this.keyBinding.onTextInput(text)},this.onCommandKey=function(e,hashId,keyCode){this.keyBinding.onCommandKey(e,hashId,keyCode)},this.setOverwrite=function(overwrite){this.session.setOverwrite(overwrite)},this.getOverwrite=function(){return this.session.getOverwrite()},this.toggleOverwrite=function(){this.session.toggleOverwrite()},this.setScrollSpeed=function(speed){this.setOption("scrollSpeed",speed)},this.getScrollSpeed=function(){return this.getOption("scrollSpeed")},this.setDragDelay=function(dragDelay){this.setOption("dragDelay",dragDelay)},this.getDragDelay=function(){return this.getOption("dragDelay")},this.setSelectionStyle=function(val){this.setOption("selectionStyle",val)},this.getSelectionStyle=function(){return this.getOption("selectionStyle")},this.setHighlightActiveLine=function(shouldHighlight){this.setOption("highlightActiveLine",shouldHighlight)},this.getHighlightActiveLine=function(){return this.getOption("highlightActiveLine")},this.setHighlightGutterLine=function(shouldHighlight){this.setOption("highlightGutterLine",shouldHighlight)},this.getHighlightGutterLine=function(){return this.getOption("highlightGutterLine")},this.setHighlightSelectedWord=function(shouldHighlight){this.setOption("highlightSelectedWord",shouldHighlight)},this.getHighlightSelectedWord=function(){return this.$highlightSelectedWord},this.setAnimatedScroll=function(shouldAnimate){this.renderer.setAnimatedScroll(shouldAnimate)},this.getAnimatedScroll=function(){return this.renderer.getAnimatedScroll()},this.setShowInvisibles=function(showInvisibles){this.renderer.setShowInvisibles(showInvisibles)},this.getShowInvisibles=function(){return this.renderer.getShowInvisibles()},this.setDisplayIndentGuides=function(display){this.renderer.setDisplayIndentGuides(display)},this.getDisplayIndentGuides=function(){return this.renderer.getDisplayIndentGuides()},this.setShowPrintMargin=function(showPrintMargin){this.renderer.setShowPrintMargin(showPrintMargin)},this.getShowPrintMargin=function(){return this.renderer.getShowPrintMargin()},this.setPrintMarginColumn=function(showPrintMargin){this.renderer.setPrintMarginColumn(showPrintMargin)},this.getPrintMarginColumn=function(){return this.renderer.getPrintMarginColumn()},this.setReadOnly=function(readOnly){this.setOption("readOnly",readOnly)},this.getReadOnly=function(){return this.getOption("readOnly")},this.setBehavioursEnabled=function(enabled){this.setOption("behavioursEnabled",enabled)},this.getBehavioursEnabled=function(){return this.getOption("behavioursEnabled")},this.setWrapBehavioursEnabled=function(enabled){this.setOption("wrapBehavioursEnabled",enabled)},this.getWrapBehavioursEnabled=function(){return this.getOption("wrapBehavioursEnabled")},this.setShowFoldWidgets=function(show){this.setOption("showFoldWidgets",show)},this.getShowFoldWidgets=function(){return this.getOption("showFoldWidgets")},this.setFadeFoldWidgets=function(fade){this.setOption("fadeFoldWidgets",fade)},this.getFadeFoldWidgets=function(){return this.getOption("fadeFoldWidgets")},this.remove=function(dir){this.selection.isEmpty()&&("left"==dir?this.selection.selectLeft():this.selection.selectRight());var range=this.getSelectionRange();if(this.getBehavioursEnabled()){var session=this.session,state=session.getState(range.start.row),new_range=session.getMode().transformAction(state,"deletion",this,session,range);if(0===range.end.column){var text=session.getTextRange(range);if("\n"==text[text.length-1]){var line=session.getLine(range.end.row);/^\s+$/.test(line)&&(range.end.column=line.length)}}new_range&&(range=new_range)}this.session.remove(range),this.clearSelection()},this.removeWordRight=function(){this.selection.isEmpty()&&this.selection.selectWordRight(),this.session.remove(this.getSelectionRange()),this.clearSelection()},this.removeWordLeft=function(){this.selection.isEmpty()&&this.selection.selectWordLeft(),this.session.remove(this.getSelectionRange()),this.clearSelection()},this.removeToLineStart=function(){this.selection.isEmpty()&&this.selection.selectLineStart(),this.session.remove(this.getSelectionRange()),this.clearSelection()},this.removeToLineEnd=function(){this.selection.isEmpty()&&this.selection.selectLineEnd();var range=this.getSelectionRange();range.start.column==range.end.column&&range.start.row==range.end.row&&(range.end.column=0,range.end.row++),this.session.remove(range),this.clearSelection()},this.splitLine=function(){this.selection.isEmpty()||(this.session.remove(this.getSelectionRange()),this.clearSelection());var cursor=this.getCursorPosition();this.insert("\n"),this.moveCursorToPosition(cursor)},this.transposeLetters=function(){if(this.selection.isEmpty()){var cursor=this.getCursorPosition(),column=cursor.column;if(0!==column){var swap,range,line=this.session.getLine(cursor.row);column<line.length?(swap=line.charAt(column)+line.charAt(column-1),range=new Range(cursor.row,column-1,cursor.row,column+1)):(swap=line.charAt(column-1)+line.charAt(column-2),range=new Range(cursor.row,column-2,cursor.row,column)),this.session.replace(range,swap),this.session.selection.moveToPosition(range.end)}}},this.toLowerCase=function(){var originalRange=this.getSelectionRange();this.selection.isEmpty()&&this.selection.selectWord();var range=this.getSelectionRange(),text=this.session.getTextRange(range);this.session.replace(range,text.toLowerCase()),this.selection.setSelectionRange(originalRange)},this.toUpperCase=function(){var originalRange=this.getSelectionRange();this.selection.isEmpty()&&this.selection.selectWord();var range=this.getSelectionRange(),text=this.session.getTextRange(range);this.session.replace(range,text.toUpperCase()),this.selection.setSelectionRange(originalRange)},this.indent=function(){var session=this.session,range=this.getSelectionRange();if(!(range.start.row<range.end.row)){if(range.start.column<range.end.column){var text=session.getTextRange(range);if(!/^\s+$/.test(text)){rows=this.$getSelectedRows();return void session.indentRows(rows.first,rows.last,"\t")}}var line=session.getLine(range.start.row),position=range.start,size=session.getTabSize(),column=session.documentToScreenColumn(position.row,position.column);if(this.session.getUseSoftTabs())var count=size-column%size,indentString=lang.stringRepeat(" ",count);else{for(count=column%size;" "==line[range.start.column-1]&&count;)range.start.column--,count--;this.selection.setSelectionRange(range),indentString="\t"}return this.insert(indentString)}var rows=this.$getSelectedRows();session.indentRows(rows.first,rows.last,"\t")},this.blockIndent=function(){var rows=this.$getSelectedRows();this.session.indentRows(rows.first,rows.last,"\t")},this.blockOutdent=function(){var selection=this.session.getSelection();this.session.outdentRows(selection.getRange())},this.sortLines=function(){for(var rows=this.$getSelectedRows(),session=this.session,lines=[],i=rows.first;i<=rows.last;i++)lines.push(session.getLine(i));lines.sort((function(a,b){return a.toLowerCase()<b.toLowerCase()?-1:a.toLowerCase()>b.toLowerCase()?1:0}));var deleteRange=new Range(0,0,0,0);for(i=rows.first;i<=rows.last;i++){var line=session.getLine(i);deleteRange.start.row=i,deleteRange.end.row=i,deleteRange.end.column=line.length,session.replace(deleteRange,lines[i-rows.first])}},this.toggleCommentLines=function(){var state=this.session.getState(this.getCursorPosition().row),rows=this.$getSelectedRows();this.session.getMode().toggleCommentLines(state,this.session,rows.first,rows.last)},this.toggleBlockComment=function(){var cursor=this.getCursorPosition(),state=this.session.getState(cursor.row),range=this.getSelectionRange();this.session.getMode().toggleBlockComment(state,this.session,range,cursor)},this.getNumberAt=function(row,column){var _numberRx=/[\-]?[0-9]+(?:\.[0-9]+)?/g;_numberRx.lastIndex=0;for(var s=this.session.getLine(row);_numberRx.lastIndex<column;){var m=_numberRx.exec(s);if(m.index<=column&&m.index+m[0].length>=column)return{value:m[0],start:m.index,end:m.index+m[0].length}}return null},this.modifyNumber=function(amount){var row=this.selection.getCursor().row,column=this.selection.getCursor().column,charRange=new Range(row,column-1,row,column),c=this.session.getTextRange(charRange);if(!isNaN(parseFloat(c))&&isFinite(c)){var nr=this.getNumberAt(row,column);if(nr){var fp=nr.value.indexOf(".")>=0?nr.start+nr.value.indexOf(".")+1:nr.end,decimals=nr.start+nr.value.length-fp,t=parseFloat(nr.value);t*=Math.pow(10,decimals),fp!==nr.end&&column<fp?amount*=Math.pow(10,nr.end-column-1):amount*=Math.pow(10,nr.end-column),t+=amount;var nnr=(t/=Math.pow(10,decimals)).toFixed(decimals),replaceRange=new Range(row,nr.start,row,nr.end);this.session.replace(replaceRange,nnr),this.moveCursorTo(row,Math.max(nr.start+1,column+nnr.length-nr.value.length))}}},this.removeLines=function(){var rows=this.$getSelectedRows();this.session.removeFullLines(rows.first,rows.last),this.clearSelection()},this.duplicateSelection=function(){var sel=this.selection,doc=this.session,range=sel.getRange(),reverse=sel.isBackwards();if(range.isEmpty()){var row=range.start.row;doc.duplicateLines(row,row)}else{var point=reverse?range.start:range.end,endPoint=doc.insert(point,doc.getTextRange(range),!1);range.start=point,range.end=endPoint,sel.setSelectionRange(range,reverse)}},this.moveLinesDown=function(){this.$moveLines(1,!1)},this.moveLinesUp=function(){this.$moveLines(-1,!1)},this.moveText=function(range,toPosition,copy){return this.session.moveText(range,toPosition,copy)},this.copyLinesUp=function(){this.$moveLines(-1,!0)},this.copyLinesDown=function(){this.$moveLines(1,!0)},this.$moveLines=function(dir,copy){var rows,moved,selection=this.selection;if(!selection.inMultiSelectMode||this.inVirtualSelectionMode){var range=selection.toOrientedRange();rows=this.$getSelectedRows(range),moved=this.session.$moveLines(rows.first,rows.last,copy?0:dir),copy&&-1==dir&&(moved=0),range.moveBy(moved,0),selection.fromOrientedRange(range)}else{var ranges=selection.rangeList.ranges;selection.rangeList.detach(this.session),this.inVirtualSelectionMode=!0;for(var diff=0,totalDiff=0,l=ranges.length,i=0;i<l;i++){var rangeIndex=i;ranges[i].moveBy(diff,0);for(var first=(rows=this.$getSelectedRows(ranges[i])).first,last=rows.last;++i<l;){totalDiff&&ranges[i].moveBy(totalDiff,0);var subRows=this.$getSelectedRows(ranges[i]);if(copy&&subRows.first!=last)break;if(!copy&&subRows.first>last+1)break;last=subRows.last}for(i--,diff=this.session.$moveLines(first,last,copy?0:dir),copy&&-1==dir&&(rangeIndex=i+1);rangeIndex<=i;)ranges[rangeIndex].moveBy(diff,0),rangeIndex++;copy||(diff=0),totalDiff+=diff}selection.fromOrientedRange(selection.ranges[0]),selection.rangeList.attach(this.session),this.inVirtualSelectionMode=!1}},this.$getSelectedRows=function(range){return range=(range||this.getSelectionRange()).collapseRows(),{first:this.session.getRowFoldStart(range.start.row),last:this.session.getRowFoldEnd(range.end.row)}},this.onCompositionStart=function(text){this.renderer.showComposition(this.getCursorPosition())},this.onCompositionUpdate=function(text){this.renderer.setCompositionText(text)},this.onCompositionEnd=function(){this.renderer.hideComposition()},this.getFirstVisibleRow=function(){return this.renderer.getFirstVisibleRow()},this.getLastVisibleRow=function(){return this.renderer.getLastVisibleRow()},this.isRowVisible=function(row){return row>=this.getFirstVisibleRow()&&row<=this.getLastVisibleRow()},this.isRowFullyVisible=function(row){return row>=this.renderer.getFirstFullyVisibleRow()&&row<=this.renderer.getLastFullyVisibleRow()},this.$getVisibleRowCount=function(){return this.renderer.getScrollBottomRow()-this.renderer.getScrollTopRow()+1},this.$moveByPage=function(dir,select){var renderer=this.renderer,config=this.renderer.layerConfig,rows=dir*Math.floor(config.height/config.lineHeight);this.$blockScrolling++,!0===select?this.selection.$moveSelection((function(){this.moveCursorBy(rows,0)})):!1===select&&(this.selection.moveCursorBy(rows,0),this.selection.clearSelection()),this.$blockScrolling--;var scrollTop=renderer.scrollTop;renderer.scrollBy(0,rows*config.lineHeight),null!=select&&renderer.scrollCursorIntoView(null,.5),renderer.animateScrolling(scrollTop)},this.selectPageDown=function(){this.$moveByPage(1,!0)},this.selectPageUp=function(){this.$moveByPage(-1,!0)},this.gotoPageDown=function(){this.$moveByPage(1,!1)},this.gotoPageUp=function(){this.$moveByPage(-1,!1)},this.scrollPageDown=function(){this.$moveByPage(1)},this.scrollPageUp=function(){this.$moveByPage(-1)},this.scrollToRow=function(row){this.renderer.scrollToRow(row)},this.scrollToLine=function(line,center,animate,callback){this.renderer.scrollToLine(line,center,animate,callback)},this.centerSelection=function(){var range=this.getSelectionRange(),pos={row:Math.floor(range.start.row+(range.end.row-range.start.row)/2),column:Math.floor(range.start.column+(range.end.column-range.start.column)/2)};this.renderer.alignCursor(pos,.5)},this.getCursorPosition=function(){return this.selection.getCursor()},this.getCursorPositionScreen=function(){return this.session.documentToScreenPosition(this.getCursorPosition())},this.getSelectionRange=function(){return this.selection.getRange()},this.selectAll=function(){this.$blockScrolling+=1,this.selection.selectAll(),this.$blockScrolling-=1},this.clearSelection=function(){this.selection.clearSelection()},this.moveCursorTo=function(row,column){this.selection.moveCursorTo(row,column)},this.moveCursorToPosition=function(pos){this.selection.moveCursorToPosition(pos)},this.jumpToMatching=function(select,expand){var cursor=this.getCursorPosition(),iterator=new TokenIterator(this.session,cursor.row,cursor.column),prevToken=iterator.getCurrentToken(),token=prevToken||iterator.stepForward();if(token){var matchType,bracketType,found=!1,depth={},i=cursor.column-token.start,brackets={")":"(","(":"(","]":"[","[":"[","{":"{","}":"{"};do{if(token.value.match(/[{}()\[\]]/g)){for(;i<token.value.length&&!found;i++)if(brackets[token.value[i]])switch(bracketType=brackets[token.value[i]]+"."+token.type.replace("rparen","lparen"),isNaN(depth[bracketType])&&(depth[bracketType]=0),token.value[i]){case"(":case"[":case"{":depth[bracketType]++;break;case")":case"]":case"}":depth[bracketType]--,-1===depth[bracketType]&&(matchType="bracket",found=!0)}}else token&&-1!==token.type.indexOf("tag-name")&&(isNaN(depth[token.value])&&(depth[token.value]=0),"<"===prevToken.value?depth[token.value]++:"</"===prevToken.value&&depth[token.value]--,-1===depth[token.value]&&(matchType="tag",found=!0));found||(prevToken=token,token=iterator.stepForward(),i=0)}while(token&&!found);if(matchType){var range,pos;if("bracket"===matchType)(range=this.session.getBracketRange(cursor))||(pos=(range=new Range(iterator.getCurrentTokenRow(),iterator.getCurrentTokenColumn()+i-1,iterator.getCurrentTokenRow(),iterator.getCurrentTokenColumn()+i-1)).start,(expand||pos.row===cursor.row&&Math.abs(pos.column-cursor.column)<2)&&(range=this.session.getBracketRange(pos)));else if("tag"===matchType){if(!token||-1===token.type.indexOf("tag-name"))return;var tag=token.value;if(0===(range=new Range(iterator.getCurrentTokenRow(),iterator.getCurrentTokenColumn()-2,iterator.getCurrentTokenRow(),iterator.getCurrentTokenColumn()-2)).compare(cursor.row,cursor.column)){found=!1;do{token=prevToken,(prevToken=iterator.stepBackward())&&(-1!==prevToken.type.indexOf("tag-close")&&range.setEnd(iterator.getCurrentTokenRow(),iterator.getCurrentTokenColumn()+1),token.value===tag&&-1!==token.type.indexOf("tag-name")&&("<"===prevToken.value?depth[tag]++:"</"===prevToken.value&&depth[tag]--,0===depth[tag]&&(found=!0)))}while(prevToken&&!found)}token&&token.type.indexOf("tag-name")&&(pos=range.start).row==cursor.row&&Math.abs(pos.column-cursor.column)<2&&(pos=range.end)}(pos=range&&range.cursor||pos)&&(select?range&&expand?this.selection.setRange(range):range&&range.isEqual(this.getSelectionRange())?this.clearSelection():this.selection.selectTo(pos.row,pos.column):this.selection.moveTo(pos.row,pos.column))}}},this.gotoLine=function(lineNumber,column,animate){this.selection.clearSelection(),this.session.unfold({row:lineNumber-1,column:column||0}),this.$blockScrolling+=1,this.exitMultiSelectMode&&this.exitMultiSelectMode(),this.moveCursorTo(lineNumber-1,column||0),this.$blockScrolling-=1,this.isRowFullyVisible(lineNumber-1)||this.scrollToLine(lineNumber-1,!0,animate)},this.navigateTo=function(row,column){this.selection.moveTo(row,column)},this.navigateUp=function(times){if(this.selection.isMultiLine()&&!this.selection.isBackwards()){var selectionStart=this.selection.anchor.getPosition();return this.moveCursorToPosition(selectionStart)}this.selection.clearSelection(),this.selection.moveCursorBy(-times||-1,0)},this.navigateDown=function(times){if(this.selection.isMultiLine()&&this.selection.isBackwards()){var selectionEnd=this.selection.anchor.getPosition();return this.moveCursorToPosition(selectionEnd)}this.selection.clearSelection(),this.selection.moveCursorBy(times||1,0)},this.navigateLeft=function(times){if(this.selection.isEmpty())for(times=times||1;times--;)this.selection.moveCursorLeft();else{var selectionStart=this.getSelectionRange().start;this.moveCursorToPosition(selectionStart)}this.clearSelection()},this.navigateRight=function(times){if(this.selection.isEmpty())for(times=times||1;times--;)this.selection.moveCursorRight();else{var selectionEnd=this.getSelectionRange().end;this.moveCursorToPosition(selectionEnd)}this.clearSelection()},this.navigateLineStart=function(){this.selection.moveCursorLineStart(),this.clearSelection()},this.navigateLineEnd=function(){this.selection.moveCursorLineEnd(),this.clearSelection()},this.navigateFileEnd=function(){this.selection.moveCursorFileEnd(),this.clearSelection()},this.navigateFileStart=function(){this.selection.moveCursorFileStart(),this.clearSelection()},this.navigateWordRight=function(){this.selection.moveCursorWordRight(),this.clearSelection()},this.navigateWordLeft=function(){this.selection.moveCursorWordLeft(),this.clearSelection()},this.replace=function(replacement,options){options&&this.$search.set(options);var range=this.$search.find(this.session),replaced=0;return range?(this.$tryReplace(range,replacement)&&(replaced=1),null!==range&&(this.selection.setSelectionRange(range),this.renderer.scrollSelectionIntoView(range.start,range.end)),replaced):replaced},this.replaceAll=function(replacement,options){options&&this.$search.set(options);var ranges=this.$search.findAll(this.session),replaced=0;if(!ranges.length)return replaced;this.$blockScrolling+=1;var selection=this.getSelectionRange();this.selection.moveTo(0,0);for(var i=ranges.length-1;i>=0;--i)this.$tryReplace(ranges[i],replacement)&&replaced++;return this.selection.setSelectionRange(selection),this.$blockScrolling-=1,replaced},this.$tryReplace=function(range,replacement){var input=this.session.getTextRange(range);return null!==(replacement=this.$search.replace(input,replacement))?(range.end=this.session.replace(range,replacement),range):null},this.getLastSearchOptions=function(){return this.$search.getOptions()},this.find=function(needle,options,animate){options||(options={}),"string"==typeof needle||needle instanceof RegExp?options.needle=needle:"object"==typeof needle&&oop.mixin(options,needle);var range=this.selection.getRange();null==options.needle&&((needle=this.session.getTextRange(range)||this.$search.$options.needle)||(range=this.session.getWordRange(range.start.row,range.start.column),needle=this.session.getTextRange(range)),this.$search.set({needle:needle})),this.$search.set(options),options.start||this.$search.set({start:range});var newRange=this.$search.find(this.session);return options.preventScroll?newRange:newRange?(this.revealRange(newRange,animate),newRange):(options.backwards?range.start=range.end:range.end=range.start,void this.selection.setRange(range))},this.findNext=function(options,animate){this.find({skipCurrent:!0,backwards:!1},options,animate)},this.findPrevious=function(options,animate){this.find(options,{skipCurrent:!0,backwards:!0},animate)},this.revealRange=function(range,animate){this.$blockScrolling+=1,this.session.unfold(range),this.selection.setSelectionRange(range),this.$blockScrolling-=1;var scrollTop=this.renderer.scrollTop;this.renderer.scrollSelectionIntoView(range.start,range.end,.5),!1!==animate&&this.renderer.animateScrolling(scrollTop)},this.undo=function(){this.$blockScrolling++,this.session.getUndoManager().undo(),this.$blockScrolling--,this.renderer.scrollCursorIntoView(null,.5)},this.redo=function(){this.$blockScrolling++,this.session.getUndoManager().redo(),this.$blockScrolling--,this.renderer.scrollCursorIntoView(null,.5)},this.destroy=function(){this.renderer.destroy(),this._signal("destroy",this),this.session&&this.session.destroy()},this.setAutoScrollEditorIntoView=function(enable){if(enable){var rect,self=this,shouldScroll=!1;this.$scrollAnchor||(this.$scrollAnchor=document.createElement("div"));var scrollAnchor=this.$scrollAnchor;scrollAnchor.style.cssText="position:absolute",this.container.insertBefore(scrollAnchor,this.container.firstChild);var onChangeSelection=this.on("changeSelection",(function(){shouldScroll=!0})),onBeforeRender=this.renderer.on("beforeRender",(function(){shouldScroll&&(rect=self.renderer.container.getBoundingClientRect())})),onAfterRender=this.renderer.on("afterRender",(function(){if(shouldScroll&&rect&&(self.isFocused()||self.searchBox&&self.searchBox.isFocused())){var renderer=self.renderer,pos=renderer.$cursorLayer.$pixelPos,config=renderer.layerConfig,top=pos.top-config.offset;null!=(shouldScroll=pos.top>=0&&top+rect.top<0||!(pos.top<config.height&&pos.top+rect.top+config.lineHeight>window.innerHeight)&&null)&&(scrollAnchor.style.top=top+"px",scrollAnchor.style.left=pos.left+"px",scrollAnchor.style.height=config.lineHeight+"px",scrollAnchor.scrollIntoView(shouldScroll)),shouldScroll=rect=null}}));this.setAutoScrollEditorIntoView=function(enable){enable||(delete this.setAutoScrollEditorIntoView,this.off("changeSelection",onChangeSelection),this.renderer.off("afterRender",onAfterRender),this.renderer.off("beforeRender",onBeforeRender))}}},this.$resetCursorStyle=function(){var style=this.$cursorStyle||"ace",cursorLayer=this.renderer.$cursorLayer;cursorLayer&&(cursorLayer.setSmoothBlinking(/smooth/.test(style)),cursorLayer.isBlinking=!this.$readOnly&&"wide"!=style,dom.setCssClass(cursorLayer.element,"ace_slim-cursors",/slim/.test(style)))}}.call(Editor.prototype),config.defineOptions(Editor.prototype,"editor",{selectionStyle:{set:function(style){this.onSelectionChange(),this._signal("changeSelectionStyle",{data:style})},initialValue:"line"},highlightActiveLine:{set:function(){this.$updateHighlightActiveLine()},initialValue:!0},highlightSelectedWord:{set:function(shouldHighlight){this.$onSelectionChange()},initialValue:!0},readOnly:{set:function(readOnly){this.$resetCursorStyle()},initialValue:!1},cursorStyle:{set:function(val){this.$resetCursorStyle()},values:["ace","slim","smooth","wide"],initialValue:"ace"},mergeUndoDeltas:{values:[!1,!0,"always"],initialValue:!0},behavioursEnabled:{initialValue:!0},wrapBehavioursEnabled:{initialValue:!0},autoScrollEditorIntoView:{set:function(val){this.setAutoScrollEditorIntoView(val)}},keyboardHandler:{set:function(val){this.setKeyboardHandler(val)},get:function(){return this.keybindingId},handlesSet:!0},hScrollBarAlwaysVisible:"renderer",vScrollBarAlwaysVisible:"renderer",highlightGutterLine:"renderer",animatedScroll:"renderer",showInvisibles:"renderer",showPrintMargin:"renderer",printMarginColumn:"renderer",printMargin:"renderer",fadeFoldWidgets:"renderer",showFoldWidgets:"renderer",showLineNumbers:"renderer",showGutter:"renderer",displayIndentGuides:"renderer",fontSize:"renderer",fontFamily:"renderer",maxLines:"renderer",minLines:"renderer",scrollPastEnd:"renderer",fixedWidthGutter:"renderer",theme:"renderer",scrollSpeed:"$mouseHandler",dragDelay:"$mouseHandler",dragEnabled:"$mouseHandler",focusTimout:"$mouseHandler",tooltipFollowsMouse:"$mouseHandler",firstLineNumber:"session",overwrite:"session",newLineMode:"session",useWorker:"session",useSoftTabs:"session",tabSize:"session",wrap:"session",indentedSoftWrap:"session",foldStyle:"session",mode:"session"}),exports.Editor=Editor})),ace.define("ace/undomanager",["require","exports","module"],(function(acequire,exports,module){"use strict";var UndoManager=function(){this.reset()};(function(){function $serializeDelta(delta){return{action:delta.action,start:delta.start,end:delta.end,lines:1==delta.lines.length?null:delta.lines,text:1==delta.lines.length?delta.lines[0]:null}}function $deserializeDelta(delta){return{action:delta.action,start:delta.start,end:delta.end,lines:delta.lines||[delta.text]}}function cloneDeltaSetsObj(deltaSets_old,fnGetModifiedDelta){for(var deltaSets_new=new Array(deltaSets_old.length),i=0;i<deltaSets_old.length;i++){for(var deltaSet_old=deltaSets_old[i],deltaSet_new={group:deltaSet_old.group,deltas:new Array(deltaSet_old.length)},j=0;j<deltaSet_old.deltas.length;j++){var delta_old=deltaSet_old.deltas[j];deltaSet_new.deltas[j]=fnGetModifiedDelta(delta_old)}deltaSets_new[i]=deltaSet_new}return deltaSets_new}this.execute=function(options){var deltaSets=options.args[0];this.$doc=options.args[1],options.merge&&this.hasUndo()&&(this.dirtyCounter--,deltaSets=this.$undoStack.pop().concat(deltaSets)),this.$undoStack.push(deltaSets),this.$redoStack=[],this.dirtyCounter<0&&(this.dirtyCounter=NaN),this.dirtyCounter++},this.undo=function(dontSelect){var deltaSets=this.$undoStack.pop(),undoSelectionRange=null;return deltaSets&&(undoSelectionRange=this.$doc.undoChanges(deltaSets,dontSelect),this.$redoStack.push(deltaSets),this.dirtyCounter--),undoSelectionRange},this.redo=function(dontSelect){var deltaSets=this.$redoStack.pop(),redoSelectionRange=null;return deltaSets&&(redoSelectionRange=this.$doc.redoChanges(this.$deserializeDeltas(deltaSets),dontSelect),this.$undoStack.push(deltaSets),this.dirtyCounter++),redoSelectionRange},this.reset=function(){this.$undoStack=[],this.$redoStack=[],this.dirtyCounter=0},this.hasUndo=function(){return this.$undoStack.length>0},this.hasRedo=function(){return this.$redoStack.length>0},this.markClean=function(){this.dirtyCounter=0},this.isClean=function(){return 0===this.dirtyCounter},this.$serializeDeltas=function(deltaSets){return cloneDeltaSetsObj(deltaSets,$serializeDelta)},this.$deserializeDeltas=function(deltaSets){return cloneDeltaSetsObj(deltaSets,$deserializeDelta)}}).call(UndoManager.prototype),exports.UndoManager=UndoManager})),ace.define("ace/layer/gutter",["require","exports","module","ace/lib/dom","ace/lib/oop","ace/lib/lang","ace/lib/event_emitter"],(function(acequire,exports,module){"use strict";var dom=acequire("../lib/dom"),oop=acequire("../lib/oop"),lang=acequire("../lib/lang"),EventEmitter=acequire("../lib/event_emitter").EventEmitter,Gutter=function(parentEl){this.element=dom.createElement("div"),this.element.className="ace_layer ace_gutter-layer",parentEl.appendChild(this.element),this.setShowFoldWidgets(this.$showFoldWidgets),this.gutterWidth=0,this.$annotations=[],this.$updateAnnotations=this.$updateAnnotations.bind(this),this.$cells=[]};(function(){oop.implement(this,EventEmitter),this.setSession=function(session){this.session&&this.session.removeEventListener("change",this.$updateAnnotations),this.session=session,session&&session.on("change",this.$updateAnnotations)},this.addGutterDecoration=function(row,className){window.console&&console.warn&&console.warn("deprecated use session.addGutterDecoration"),this.session.addGutterDecoration(row,className)},this.removeGutterDecoration=function(row,className){window.console&&console.warn&&console.warn("deprecated use session.removeGutterDecoration"),this.session.removeGutterDecoration(row,className)},this.setAnnotations=function(annotations){this.$annotations=[];for(var i=0;i<annotations.length;i++){var annotation=annotations[i],row=annotation.row,rowInfo=this.$annotations[row];rowInfo||(rowInfo=this.$annotations[row]={text:[]});var annoText=annotation.text;annoText=annoText?lang.escapeHTML(annoText):annotation.html||"",-1===rowInfo.text.indexOf(annoText)&&rowInfo.text.push(annoText);var type=annotation.type;"error"==type?rowInfo.className=" ace_error":"warning"==type&&" ace_error"!=rowInfo.className?rowInfo.className=" ace_warning":"info"!=type||rowInfo.className||(rowInfo.className=" ace_info")}},this.$updateAnnotations=function(delta){if(this.$annotations.length){var firstRow=delta.start.row,len=delta.end.row-firstRow;if(0===len);else if("remove"==delta.action)this.$annotations.splice(firstRow,len+1,null);else{var args=new Array(len+1);args.unshift(firstRow,1),this.$annotations.splice.apply(this.$annotations,args)}}},this.update=function(config){for(var session=this.session,firstRow=config.firstRow,lastRow=Math.min(config.lastRow+config.gutterOffset,session.getLength()-1),fold=session.getNextFoldLine(firstRow),foldStart=fold?fold.start.row:1/0,foldWidgets=this.$showFoldWidgets&&session.foldWidgets,breakpoints=session.$breakpoints,decorations=session.$decorations,firstLineNumber=session.$firstLineNumber,lastLineNumber=0,gutterRenderer=session.gutterRenderer||this.$renderer,cell=null,index=-1,row=firstRow;;){if(row>foldStart&&(row=fold.end.row+1,foldStart=(fold=session.getNextFoldLine(row,fold))?fold.start.row:1/0),row>lastRow){for(;this.$cells.length>index+1;)cell=this.$cells.pop(),this.element.removeChild(cell.element);break}(cell=this.$cells[++index])||((cell={element:null,textNode:null,foldWidget:null}).element=dom.createElement("div"),cell.textNode=document.createTextNode(""),cell.element.appendChild(cell.textNode),this.element.appendChild(cell.element),this.$cells[index]=cell);var className="ace_gutter-cell ";if(breakpoints[row]&&(className+=breakpoints[row]),decorations[row]&&(className+=decorations[row]),this.$annotations[row]&&(className+=this.$annotations[row].className),cell.element.className!=className&&(cell.element.className=className),(height=session.getRowLength(row)*config.lineHeight+"px")!=cell.element.style.height&&(cell.element.style.height=height),foldWidgets){var c=foldWidgets[row];null==c&&(c=foldWidgets[row]=session.getFoldWidget(row))}if(c){cell.foldWidget||(cell.foldWidget=dom.createElement("span"),cell.element.appendChild(cell.foldWidget));className="ace_fold-widget ace_"+c;"start"==c&&row==foldStart&&row<fold.end.row?className+=" ace_closed":className+=" ace_open",cell.foldWidget.className!=className&&(cell.foldWidget.className=className);var height=config.lineHeight+"px";cell.foldWidget.style.height!=height&&(cell.foldWidget.style.height=height)}else cell.foldWidget&&(cell.element.removeChild(cell.foldWidget),cell.foldWidget=null);var text=lastLineNumber=gutterRenderer?gutterRenderer.getText(session,row):row+firstLineNumber;text!==cell.textNode.data&&(cell.textNode.data=text),row++}this.element.style.height=config.minHeight+"px",(this.$fixedWidth||session.$useWrapMode)&&(lastLineNumber=session.getLength()+firstLineNumber);var gutterWidth=gutterRenderer?gutterRenderer.getWidth(session,lastLineNumber,config):lastLineNumber.toString().length*config.characterWidth,padding=this.$padding||this.$computePadding();(gutterWidth+=padding.left+padding.right)===this.gutterWidth||isNaN(gutterWidth)||(this.gutterWidth=gutterWidth,this.element.style.width=Math.ceil(this.gutterWidth)+"px",this._emit("changeGutterWidth",gutterWidth))},this.$fixedWidth=!1,this.$showLineNumbers=!0,this.$renderer="",this.setShowLineNumbers=function(show){this.$renderer=!show&&{getWidth:function(){return""},getText:function(){return""}}},this.getShowLineNumbers=function(){return this.$showLineNumbers},this.$showFoldWidgets=!0,this.setShowFoldWidgets=function(show){show?dom.addCssClass(this.element,"ace_folding-enabled"):dom.removeCssClass(this.element,"ace_folding-enabled"),this.$showFoldWidgets=show,this.$padding=null},this.getShowFoldWidgets=function(){return this.$showFoldWidgets},this.$computePadding=function(){if(!this.element.firstChild)return{left:0,right:0};var style=dom.computedStyle(this.element.firstChild);return this.$padding={},this.$padding.left=parseInt(style.paddingLeft)+1||0,this.$padding.right=parseInt(style.paddingRight)||0,this.$padding},this.getRegion=function(point){var padding=this.$padding||this.$computePadding(),rect=this.element.getBoundingClientRect();return point.x<padding.left+rect.left?"markers":this.$showFoldWidgets&&point.x>rect.right-padding.right?"foldWidgets":void 0}}).call(Gutter.prototype),exports.Gutter=Gutter})),ace.define("ace/layer/marker",["require","exports","module","ace/range","ace/lib/dom"],(function(acequire,exports,module){"use strict";var Range=acequire("../range").Range,dom=acequire("../lib/dom"),Marker=function(parentEl){this.element=dom.createElement("div"),this.element.className="ace_layer ace_marker-layer",parentEl.appendChild(this.element)};(function(){this.$padding=0,this.setPadding=function(padding){this.$padding=padding},this.setSession=function(session){this.session=session},this.setMarkers=function(markers){this.markers=markers},this.update=function(config){if(config){this.config=config;var html=[];for(var key in this.markers){var marker=this.markers[key];if(marker.range){var range=marker.range.clipRows(config.firstRow,config.lastRow);if(!range.isEmpty())if(range=range.toScreenRange(this.session),marker.renderer){var top=this.$getTop(range.start.row,config),left=this.$padding+(this.session.$bidiHandler.isBidiRow(range.start.row)?this.session.$bidiHandler.getPosLeft(range.start.column):range.start.column*config.characterWidth);marker.renderer(html,range,left,top,config)}else"fullLine"==marker.type?this.drawFullLineMarker(html,range,marker.clazz,config):"screenLine"==marker.type?this.drawScreenLineMarker(html,range,marker.clazz,config):range.isMultiLine()?"text"==marker.type?this.drawTextMarker(html,range,marker.clazz,config):this.drawMultiLineMarker(html,range,marker.clazz,config):this.session.$bidiHandler.isBidiRow(range.start.row)?this.drawBidiSingleLineMarker(html,range,marker.clazz+" ace_start ace_br15",config):this.drawSingleLineMarker(html,range,marker.clazz+" ace_start ace_br15",config)}else marker.update(html,this,this.session,config)}this.element.innerHTML=html.join("")}},this.$getTop=function(row,layerConfig){return(row-layerConfig.firstRowScreen)*layerConfig.lineHeight},this.drawTextMarker=function(stringBuilder,range,clazz,layerConfig,extraStyle){for(var session=this.session,start=range.start.row,end=range.end.row,row=start,prev=0,curr=0,next=session.getScreenLastRowColumn(row),clazzModified=null,lineRange=new Range(row,range.start.column,row,curr);row<=end;row++)lineRange.start.row=lineRange.end.row=row,lineRange.start.column=row==start?range.start.column:session.getRowWrapIndent(row),lineRange.end.column=next,prev=curr,curr=next,next=row+1<end?session.getScreenLastRowColumn(row+1):row==end?0:range.end.column,clazzModified=clazz+(row==start?" ace_start":"")+" ace_br"+((row==start||row==start+1&&range.start.column?1:0)|(prev<curr?2:0)|(curr>next?4:0)|(row==end?8:0)),this.session.$bidiHandler.isBidiRow(row)?this.drawBidiSingleLineMarker(stringBuilder,lineRange,clazzModified,layerConfig,row==end?0:1,extraStyle):this.drawSingleLineMarker(stringBuilder,lineRange,clazzModified,layerConfig,row==end?0:1,extraStyle)},this.drawMultiLineMarker=function(stringBuilder,range,clazz,config,extraStyle){var height,top,left,padding=this.$padding;(extraStyle=extraStyle||"",this.session.$bidiHandler.isBidiRow(range.start.row))?((range1=range.clone()).end.row=range1.start.row,range1.end.column=this.session.getLine(range1.start.row).length,this.drawBidiSingleLineMarker(stringBuilder,range1,clazz+" ace_br1 ace_start",config,null,extraStyle)):(height=config.lineHeight,top=this.$getTop(range.start.row,config),left=padding+range.start.column*config.characterWidth,stringBuilder.push("<div class='",clazz," ace_br1 ace_start' style='","height:",height,"px;","right:0;","top:",top,"px;","left:",left,"px;",extraStyle,"'></div>"));if(this.session.$bidiHandler.isBidiRow(range.end.row)){var range1;(range1=range.clone()).start.row=range1.end.row,range1.start.column=0,this.drawBidiSingleLineMarker(stringBuilder,range1,clazz+" ace_br12",config,null,extraStyle)}else{var width=range.end.column*config.characterWidth;height=config.lineHeight,top=this.$getTop(range.end.row,config),stringBuilder.push("<div class='",clazz," ace_br12' style='","height:",height,"px;","width:",width,"px;","top:",top,"px;","left:",padding,"px;",extraStyle,"'></div>")}if(!((height=(range.end.row-range.start.row-1)*config.lineHeight)<=0)){top=this.$getTop(range.start.row+1,config);var radiusClass=(range.start.column?1:0)|(range.end.column?0:8);stringBuilder.push("<div class='",clazz,radiusClass?" ace_br"+radiusClass:"","' style='","height:",height,"px;","right:0;","top:",top,"px;","left:",padding,"px;",extraStyle,"'></div>")}},this.drawSingleLineMarker=function(stringBuilder,range,clazz,config,extraLength,extraStyle){var height=config.lineHeight,width=(range.end.column+(extraLength||0)-range.start.column)*config.characterWidth,top=this.$getTop(range.start.row,config),left=this.$padding+range.start.column*config.characterWidth;stringBuilder.push("<div class='",clazz,"' style='","height:",height,"px;","width:",width,"px;","top:",top,"px;","left:",left,"px;",extraStyle||"","'></div>")},this.drawBidiSingleLineMarker=function(stringBuilder,range,clazz,config,extraLength,extraStyle){var height=config.lineHeight,top=this.$getTop(range.start.row,config),padding=this.$padding;this.session.$bidiHandler.getSelections(range.start.column,range.end.column).forEach((function(selection){stringBuilder.push("<div class='",clazz,"' style='","height:",height,"px;","width:",selection.width+(extraLength||0),"px;","top:",top,"px;","left:",padding+selection.left,"px;",extraStyle||"","'></div>")}))},this.drawFullLineMarker=function(stringBuilder,range,clazz,config,extraStyle){var top=this.$getTop(range.start.row,config),height=config.lineHeight;range.start.row!=range.end.row&&(height+=this.$getTop(range.end.row,config)-top),stringBuilder.push("<div class='",clazz,"' style='","height:",height,"px;","top:",top,"px;","left:0;right:0;",extraStyle||"","'></div>")},this.drawScreenLineMarker=function(stringBuilder,range,clazz,config,extraStyle){var top=this.$getTop(range.start.row,config),height=config.lineHeight;stringBuilder.push("<div class='",clazz,"' style='","height:",height,"px;","top:",top,"px;","left:0;right:0;",extraStyle||"","'></div>")}}).call(Marker.prototype),exports.Marker=Marker})),ace.define("ace/layer/text",["require","exports","module","ace/lib/oop","ace/lib/dom","ace/lib/lang","ace/lib/useragent","ace/lib/event_emitter"],(function(acequire,exports,module){"use strict";var oop=acequire("../lib/oop"),dom=acequire("../lib/dom"),lang=acequire("../lib/lang"),EventEmitter=(acequire("../lib/useragent"),acequire("../lib/event_emitter").EventEmitter),Text=function(parentEl){this.element=dom.createElement("div"),this.element.className="ace_layer ace_text-layer",parentEl.appendChild(this.element),this.$updateEolChar=this.$updateEolChar.bind(this)};(function(){oop.implement(this,EventEmitter),this.EOF_CHAR="¶",this.EOL_CHAR_LF="¬",this.EOL_CHAR_CRLF="¤",this.EOL_CHAR=this.EOL_CHAR_LF,this.TAB_CHAR="—",this.SPACE_CHAR="·",this.$padding=0,this.$updateEolChar=function(){var EOL_CHAR="\n"==this.session.doc.getNewLineCharacter()?this.EOL_CHAR_LF:this.EOL_CHAR_CRLF;if(this.EOL_CHAR!=EOL_CHAR)return this.EOL_CHAR=EOL_CHAR,!0},this.setPadding=function(padding){this.$padding=padding,this.element.style.padding="0 "+padding+"px"},this.getLineHeight=function(){return this.$fontMetrics.$characterSize.height||0},this.getCharacterWidth=function(){return this.$fontMetrics.$characterSize.width||0},this.$setFontMetrics=function(measure){this.$fontMetrics=measure,this.$fontMetrics.on("changeCharacterSize",function(e){this._signal("changeCharacterSize",e)}.bind(this)),this.$pollSizeChanges()},this.checkForSizeChanges=function(){this.$fontMetrics.checkForSizeChanges()},this.$pollSizeChanges=function(){return this.$pollSizeChangesTimer=this.$fontMetrics.$pollSizeChanges()},this.setSession=function(session){this.session=session,session&&this.$computeTabString()},this.showInvisibles=!1,this.setShowInvisibles=function(showInvisibles){return this.showInvisibles!=showInvisibles&&(this.showInvisibles=showInvisibles,this.$computeTabString(),!0)},this.displayIndentGuides=!0,this.setDisplayIndentGuides=function(display){return this.displayIndentGuides!=display&&(this.displayIndentGuides=display,this.$computeTabString(),!0)},this.$tabStrings=[],this.onChangeTabSize=this.$computeTabString=function(){var tabSize=this.session.getTabSize();this.tabSize=tabSize;for(var tabStr=this.$tabStrings=[0],i=1;i<tabSize+1;i++)this.showInvisibles?tabStr.push("<span class='ace_invisible ace_invisible_tab'>"+lang.stringRepeat(this.TAB_CHAR,i)+"</span>"):tabStr.push(lang.stringRepeat(" ",i));if(this.displayIndentGuides){this.$indentGuideRe=/\s\S| \t|\t |\s$/;var className="ace_indent-guide",spaceClass="",tabClass="";if(this.showInvisibles){className+=" ace_invisible",spaceClass=" ace_invisible_space",tabClass=" ace_invisible_tab";var spaceContent=lang.stringRepeat(this.SPACE_CHAR,this.tabSize),tabContent=lang.stringRepeat(this.TAB_CHAR,this.tabSize)}else tabContent=spaceContent=lang.stringRepeat(" ",this.tabSize);this.$tabStrings[" "]="<span class='"+className+spaceClass+"'>"+spaceContent+"</span>",this.$tabStrings["\t"]="<span class='"+className+tabClass+"'>"+tabContent+"</span>"}},this.updateLines=function(config,firstRow,lastRow){this.config.lastRow==config.lastRow&&this.config.firstRow==config.firstRow||this.scrollLines(config),this.config=config;for(var first=Math.max(firstRow,config.firstRow),last=Math.min(lastRow,config.lastRow),lineElements=this.element.childNodes,lineElementsIdx=0,row=config.firstRow;row<first;row++){if(foldLine=this.session.getFoldLine(row)){if(foldLine.containsRow(first)){first=foldLine.start.row;break}row=foldLine.end.row}lineElementsIdx++}row=first;for(var foldLine,foldStart=(foldLine=this.session.getNextFoldLine(row))?foldLine.start.row:1/0;row>foldStart&&(row=foldLine.end.row+1,foldStart=(foldLine=this.session.getNextFoldLine(row,foldLine))?foldLine.start.row:1/0),!(row>last);){var lineElement=lineElements[lineElementsIdx++];if(lineElement){var html=[];this.$renderLine(html,row,!this.$useLineGroups(),row==foldStart&&foldLine),lineElement.style.height=config.lineHeight*this.session.getRowLength(row)+"px",lineElement.innerHTML=html.join("")}row++}},this.scrollLines=function(config){var oldConfig=this.config;if(this.config=config,!oldConfig||oldConfig.lastRow<config.firstRow)return this.update(config);if(config.lastRow<oldConfig.firstRow)return this.update(config);var el=this.element;if(oldConfig.firstRow<config.firstRow)for(var row=this.session.getFoldedRowCount(oldConfig.firstRow,config.firstRow-1);row>0;row--)el.removeChild(el.firstChild);if(oldConfig.lastRow>config.lastRow)for(row=this.session.getFoldedRowCount(config.lastRow+1,oldConfig.lastRow);row>0;row--)el.removeChild(el.lastChild);if(config.firstRow<oldConfig.firstRow){var fragment=this.$renderLinesFragment(config,config.firstRow,oldConfig.firstRow-1);el.firstChild?el.insertBefore(fragment,el.firstChild):el.appendChild(fragment)}if(config.lastRow>oldConfig.lastRow){fragment=this.$renderLinesFragment(config,oldConfig.lastRow+1,config.lastRow);el.appendChild(fragment)}},this.$renderLinesFragment=function(config,firstRow,lastRow){for(var fragment=this.element.ownerDocument.createDocumentFragment(),row=firstRow,foldLine=this.session.getNextFoldLine(row),foldStart=foldLine?foldLine.start.row:1/0;row>foldStart&&(row=foldLine.end.row+1,foldStart=(foldLine=this.session.getNextFoldLine(row,foldLine))?foldLine.start.row:1/0),!(row>lastRow);){var container=dom.createElement("div"),html=[];if(this.$renderLine(html,row,!1,row==foldStart&&foldLine),container.innerHTML=html.join(""),this.$useLineGroups())container.className="ace_line_group",fragment.appendChild(container),container.style.height=config.lineHeight*this.session.getRowLength(row)+"px";else for(;container.firstChild;)fragment.appendChild(container.firstChild);row++}return fragment},this.update=function(config){this.config=config;for(var html=[],firstRow=config.firstRow,lastRow=config.lastRow,row=firstRow,foldLine=this.session.getNextFoldLine(row),foldStart=foldLine?foldLine.start.row:1/0;row>foldStart&&(row=foldLine.end.row+1,foldStart=(foldLine=this.session.getNextFoldLine(row,foldLine))?foldLine.start.row:1/0),!(row>lastRow);)this.$useLineGroups()&&html.push("<div class='ace_line_group' style='height:",config.lineHeight*this.session.getRowLength(row),"px'>"),this.$renderLine(html,row,!1,row==foldStart&&foldLine),this.$useLineGroups()&&html.push("</div>"),row++;this.element.innerHTML=html.join("")},this.$textToken={text:!0,rparen:!0,lparen:!0},this.$renderToken=function(stringBuilder,screenColumn,token,value){var self=this,output=value.replace(/\t|&|<|>|( +)|([\x00-\x1f\x80-\xa0\xad\u1680\u180E\u2000-\u200f\u2028\u2029\u202F\u205F\u3000\uFEFF\uFFF9-\uFFFC])|[\u1100-\u115F\u11A3-\u11A7\u11FA-\u11FF\u2329-\u232A\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFB\u3000-\u303E\u3041-\u3096\u3099-\u30FF\u3105-\u312D\u3131-\u318E\u3190-\u31BA\u31C0-\u31E3\u31F0-\u321E\u3220-\u3247\u3250-\u32FE\u3300-\u4DBF\u4E00-\uA48C\uA490-\uA4C6\uA960-\uA97C\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFAFF\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE66\uFE68-\uFE6B\uFF01-\uFF60\uFFE0-\uFFE6]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,(function(c,a,b,tabIdx,idx4){if(a)return self.showInvisibles?"<span class='ace_invisible ace_invisible_space'>"+lang.stringRepeat(self.SPACE_CHAR,c.length)+"</span>":c;if("&"==c)return"&#38;";if("<"==c)return"&#60;";if(">"==c)return"&#62;";if("\t"==c){var tabSize=self.session.getScreenTabSize(screenColumn+tabIdx);return screenColumn+=tabSize-1,self.$tabStrings[tabSize]}if("　"==c){var classToUse=self.showInvisibles?"ace_cjk ace_invisible ace_invisible_space":"ace_cjk",space=self.showInvisibles?self.SPACE_CHAR:"";return screenColumn+=1,"<span class='"+classToUse+"' style='width:"+2*self.config.characterWidth+"px'>"+space+"</span>"}return b?"<span class='ace_invisible ace_invisible_space ace_invalid'>"+self.SPACE_CHAR+"</span>":(screenColumn+=1,"<span class='ace_cjk' style='width:"+2*self.config.characterWidth+"px'>"+c+"</span>")}));if(this.$textToken[token.type])stringBuilder.push(output);else{var classes="ace_"+token.type.replace(/\./g," ace_"),style="";"fold"==token.type&&(style=" style='width:"+token.value.length*this.config.characterWidth+"px;' "),stringBuilder.push("<span class='",classes,"'",style,">",output,"</span>")}return screenColumn+value.length},this.renderIndentGuide=function(stringBuilder,value,max){var cols=value.search(this.$indentGuideRe);return cols<=0||cols>=max?value:" "==value[0]?(cols-=cols%this.tabSize,stringBuilder.push(lang.stringRepeat(this.$tabStrings[" "],cols/this.tabSize)),value.substr(cols)):"\t"==value[0]?(stringBuilder.push(lang.stringRepeat(this.$tabStrings["\t"],cols)),value.substr(cols)):value},this.$renderWrappedLine=function(stringBuilder,tokens,splits,onlyContents){for(var chars=0,split=0,splitChars=splits[0],screenColumn=0,i=0;i<tokens.length;i++){var token=tokens[i],value=token.value;if(0==i&&this.displayIndentGuides){if(chars=value.length,!(value=this.renderIndentGuide(stringBuilder,value,splitChars)))continue;chars-=value.length}if(chars+value.length<splitChars)screenColumn=this.$renderToken(stringBuilder,screenColumn,token,value),chars+=value.length;else{for(;chars+value.length>=splitChars;)screenColumn=this.$renderToken(stringBuilder,screenColumn,token,value.substring(0,splitChars-chars)),value=value.substring(splitChars-chars),chars=splitChars,onlyContents||stringBuilder.push("</div>","<div class='ace_line' style='height:",this.config.lineHeight,"px'>"),stringBuilder.push(lang.stringRepeat(" ",splits.indent)),screenColumn=0,splitChars=splits[++split]||Number.MAX_VALUE;0!=value.length&&(chars+=value.length,screenColumn=this.$renderToken(stringBuilder,screenColumn,token,value))}}},this.$renderSimpleLine=function(stringBuilder,tokens){var screenColumn=0,token=tokens[0],value=token.value;this.displayIndentGuides&&(value=this.renderIndentGuide(stringBuilder,value)),value&&(screenColumn=this.$renderToken(stringBuilder,screenColumn,token,value));for(var i=1;i<tokens.length;i++)value=(token=tokens[i]).value,screenColumn=this.$renderToken(stringBuilder,screenColumn,token,value)},this.$renderLine=function(stringBuilder,row,onlyContents,foldLine){if(foldLine||0==foldLine||(foldLine=this.session.getFoldLine(row)),foldLine)var tokens=this.$getFoldLineTokens(row,foldLine);else tokens=this.session.getTokens(row);if(onlyContents||stringBuilder.push("<div class='ace_line' style='height:",this.config.lineHeight*(this.$useLineGroups()?1:this.session.getRowLength(row)),"px'>"),tokens.length){var splits=this.session.getRowSplitData(row);splits&&splits.length?this.$renderWrappedLine(stringBuilder,tokens,splits,onlyContents):this.$renderSimpleLine(stringBuilder,tokens)}this.showInvisibles&&(foldLine&&(row=foldLine.end.row),stringBuilder.push("<span class='ace_invisible ace_invisible_eol'>",row==this.session.getLength()-1?this.EOF_CHAR:this.EOL_CHAR,"</span>")),onlyContents||stringBuilder.push("</div>")},this.$getFoldLineTokens=function(row,foldLine){var session=this.session,renderTokens=[];var tokens=session.getTokens(row);return foldLine.walk((function(placeholder,row,column,lastColumn,isNewRow){null!=placeholder?renderTokens.push({type:"fold",value:placeholder}):(isNewRow&&(tokens=session.getTokens(row)),tokens.length&&function(tokens,from,to){for(var idx=0,col=0;col+tokens[idx].value.length<from;)if(col+=tokens[idx].value.length,++idx==tokens.length)return;for(col!=from&&((value=tokens[idx].value.substring(from-col)).length>to-from&&(value=value.substring(0,to-from)),renderTokens.push({type:tokens[idx].type,value:value}),col=from+value.length,idx+=1);col<to&&idx<tokens.length;){var value;(value=tokens[idx].value).length+col>to?renderTokens.push({type:tokens[idx].type,value:value.substring(0,to-col)}):renderTokens.push(tokens[idx]),col+=value.length,idx+=1}}(tokens,lastColumn,column))}),foldLine.end.row,this.session.getLine(foldLine.end.row).length),renderTokens},this.$useLineGroups=function(){return this.session.getUseWrapMode()},this.destroy=function(){clearInterval(this.$pollSizeChangesTimer),this.$measureNode&&this.$measureNode.parentNode.removeChild(this.$measureNode),delete this.$measureNode}}).call(Text.prototype),exports.Text=Text})),ace.define("ace/layer/cursor",["require","exports","module","ace/lib/dom"],(function(acequire,exports,module){"use strict";var isIE8,dom=acequire("../lib/dom"),Cursor=function(parentEl){this.element=dom.createElement("div"),this.element.className="ace_layer ace_cursor-layer",parentEl.appendChild(this.element),void 0===isIE8&&(isIE8=!("opacity"in this.element.style)),this.isVisible=!1,this.isBlinking=!0,this.blinkInterval=1e3,this.smoothBlinking=!1,this.cursors=[],this.cursor=this.addCursor(),dom.addCssClass(this.element,"ace_hidden-cursors"),this.$updateCursors=(isIE8?this.$updateVisibility:this.$updateOpacity).bind(this)};(function(){this.$updateVisibility=function(val){for(var cursors=this.cursors,i=cursors.length;i--;)cursors[i].style.visibility=val?"":"hidden"},this.$updateOpacity=function(val){for(var cursors=this.cursors,i=cursors.length;i--;)cursors[i].style.opacity=val?"":"0"},this.$padding=0,this.setPadding=function(padding){this.$padding=padding},this.setSession=function(session){this.session=session},this.setBlinking=function(blinking){blinking!=this.isBlinking&&(this.isBlinking=blinking,this.restartTimer())},this.setBlinkInterval=function(blinkInterval){blinkInterval!=this.blinkInterval&&(this.blinkInterval=blinkInterval,this.restartTimer())},this.setSmoothBlinking=function(smoothBlinking){smoothBlinking==this.smoothBlinking||isIE8||(this.smoothBlinking=smoothBlinking,dom.setCssClass(this.element,"ace_smooth-blinking",smoothBlinking),this.$updateCursors(!0),this.$updateCursors=this.$updateOpacity.bind(this),this.restartTimer())},this.addCursor=function(){var el=dom.createElement("div");return el.className="ace_cursor",this.element.appendChild(el),this.cursors.push(el),el},this.removeCursor=function(){if(this.cursors.length>1){var el=this.cursors.pop();return el.parentNode.removeChild(el),el}},this.hideCursor=function(){this.isVisible=!1,dom.addCssClass(this.element,"ace_hidden-cursors"),this.restartTimer()},this.showCursor=function(){this.isVisible=!0,dom.removeCssClass(this.element,"ace_hidden-cursors"),this.restartTimer()},this.restartTimer=function(){var update=this.$updateCursors;if(clearInterval(this.intervalId),clearTimeout(this.timeoutId),this.smoothBlinking&&dom.removeCssClass(this.element,"ace_smooth-blinking"),update(!0),this.isBlinking&&this.blinkInterval&&this.isVisible){this.smoothBlinking&&setTimeout(function(){dom.addCssClass(this.element,"ace_smooth-blinking")}.bind(this));var blink=function(){this.timeoutId=setTimeout((function(){update(!1)}),.6*this.blinkInterval)}.bind(this);this.intervalId=setInterval((function(){update(!0),blink()}),this.blinkInterval),blink()}},this.getPixelPosition=function(position,onScreen){if(!this.config||!this.session)return{left:0,top:0};position||(position=this.session.selection.getCursor());var pos=this.session.documentToScreenPosition(position);return{left:this.$padding+(this.session.$bidiHandler.isBidiRow(pos.row,position.row)?this.session.$bidiHandler.getPosLeft(pos.column):pos.column*this.config.characterWidth),top:(pos.row-(onScreen?this.config.firstRowScreen:0))*this.config.lineHeight}},this.update=function(config){this.config=config;var selections=this.session.$selectionMarkers,i=0,cursorIndex=0;void 0!==selections&&0!==selections.length||(selections=[{cursor:null}]);i=0;for(var n=selections.length;i<n;i++){var pixelPos=this.getPixelPosition(selections[i].cursor,!0);if(!((pixelPos.top>config.height+config.offset||pixelPos.top<0)&&i>1)){var style=(this.cursors[cursorIndex++]||this.addCursor()).style;this.drawCursor?this.drawCursor(style,pixelPos,config,selections[i],this.session):(style.left=pixelPos.left+"px",style.top=pixelPos.top+"px",style.width=config.characterWidth+"px",style.height=config.lineHeight+"px")}}for(;this.cursors.length>cursorIndex;)this.removeCursor();var overwrite=this.session.getOverwrite();this.$setOverwrite(overwrite),this.$pixelPos=pixelPos,this.restartTimer()},this.drawCursor=null,this.$setOverwrite=function(overwrite){overwrite!=this.overwrite&&(this.overwrite=overwrite,overwrite?dom.addCssClass(this.element,"ace_overwrite-cursors"):dom.removeCssClass(this.element,"ace_overwrite-cursors"))},this.destroy=function(){clearInterval(this.intervalId),clearTimeout(this.timeoutId)}}).call(Cursor.prototype),exports.Cursor=Cursor})),ace.define("ace/scrollbar",["require","exports","module","ace/lib/oop","ace/lib/dom","ace/lib/event","ace/lib/event_emitter"],(function(acequire,exports,module){"use strict";var oop=acequire("./lib/oop"),dom=acequire("./lib/dom"),event=acequire("./lib/event"),EventEmitter=acequire("./lib/event_emitter").EventEmitter,ScrollBar=function(parent){this.element=dom.createElement("div"),this.element.className="ace_scrollbar ace_scrollbar"+this.classSuffix,this.inner=dom.createElement("div"),this.inner.className="ace_scrollbar-inner",this.element.appendChild(this.inner),parent.appendChild(this.element),this.setVisible(!1),this.skipEvent=!1,event.addListener(this.element,"scroll",this.onScroll.bind(this)),event.addListener(this.element,"mousedown",event.preventDefault)};(function(){oop.implement(this,EventEmitter),this.setVisible=function(isVisible){this.element.style.display=isVisible?"":"none",this.isVisible=isVisible,this.coeff=1}}).call(ScrollBar.prototype);var VScrollBar=function(parent,renderer){ScrollBar.call(this,parent),this.scrollTop=0,this.scrollHeight=0,renderer.$scrollbarWidth=this.width=dom.scrollbarWidth(parent.ownerDocument),this.inner.style.width=this.element.style.width=(this.width||15)+5+"px",this.$minWidth=0};oop.inherits(VScrollBar,ScrollBar),function(){this.classSuffix="-v",this.onScroll=function(){if(!this.skipEvent){if(this.scrollTop=this.element.scrollTop,1!=this.coeff){var h=this.element.clientHeight/this.scrollHeight;this.scrollTop=this.scrollTop*(1-h)/(this.coeff-h)}this._emit("scroll",{data:this.scrollTop})}this.skipEvent=!1},this.getWidth=function(){return Math.max(this.isVisible?this.width:0,this.$minWidth||0)},this.setHeight=function(height){this.element.style.height=height+"px"},this.setInnerHeight=this.setScrollHeight=function(height){this.scrollHeight=height,height>32768?(this.coeff=32768/height,height=32768):1!=this.coeff&&(this.coeff=1),this.inner.style.height=height+"px"},this.setScrollTop=function(scrollTop){this.scrollTop!=scrollTop&&(this.skipEvent=!0,this.scrollTop=scrollTop,this.element.scrollTop=scrollTop*this.coeff)}}.call(VScrollBar.prototype);var HScrollBar=function(parent,renderer){ScrollBar.call(this,parent),this.scrollLeft=0,this.height=renderer.$scrollbarWidth,this.inner.style.height=this.element.style.height=(this.height||15)+5+"px"};oop.inherits(HScrollBar,ScrollBar),function(){this.classSuffix="-h",this.onScroll=function(){this.skipEvent||(this.scrollLeft=this.element.scrollLeft,this._emit("scroll",{data:this.scrollLeft})),this.skipEvent=!1},this.getHeight=function(){return this.isVisible?this.height:0},this.setWidth=function(width){this.element.style.width=width+"px"},this.setInnerWidth=function(width){this.inner.style.width=width+"px"},this.setScrollWidth=function(width){this.inner.style.width=width+"px"},this.setScrollLeft=function(scrollLeft){this.scrollLeft!=scrollLeft&&(this.skipEvent=!0,this.scrollLeft=this.element.scrollLeft=scrollLeft)}}.call(HScrollBar.prototype),exports.ScrollBar=VScrollBar,exports.ScrollBarV=VScrollBar,exports.ScrollBarH=HScrollBar,exports.VScrollBar=VScrollBar,exports.HScrollBar=HScrollBar})),ace.define("ace/renderloop",["require","exports","module","ace/lib/event"],(function(acequire,exports,module){"use strict";var event=acequire("./lib/event"),RenderLoop=function(onRender,win){this.onRender=onRender,this.pending=!1,this.changes=0,this.window=win||window};(function(){this.schedule=function(change){if(this.changes=this.changes|change,!this.pending&&this.changes){this.pending=!0;var _self=this;event.nextFrame((function(){var changes;for(_self.pending=!1;changes=_self.changes;)_self.changes=0,_self.onRender(changes)}),this.window)}}}).call(RenderLoop.prototype),exports.RenderLoop=RenderLoop})),ace.define("ace/layer/font_metrics",["require","exports","module","ace/lib/oop","ace/lib/dom","ace/lib/lang","ace/lib/useragent","ace/lib/event_emitter"],(function(acequire,exports,module){var oop=acequire("../lib/oop"),dom=acequire("../lib/dom"),lang=acequire("../lib/lang"),useragent=acequire("../lib/useragent"),EventEmitter=acequire("../lib/event_emitter").EventEmitter,CHAR_COUNT=0,FontMetrics=exports.FontMetrics=function(parentEl){this.el=dom.createElement("div"),this.$setMeasureNodeStyles(this.el.style,!0),this.$main=dom.createElement("div"),this.$setMeasureNodeStyles(this.$main.style),this.$measureNode=dom.createElement("div"),this.$setMeasureNodeStyles(this.$measureNode.style),this.el.appendChild(this.$main),this.el.appendChild(this.$measureNode),parentEl.appendChild(this.el),CHAR_COUNT||this.$testFractionalRect(),this.$measureNode.innerHTML=lang.stringRepeat("X",CHAR_COUNT),this.$characterSize={width:0,height:0},this.checkForSizeChanges()};(function(){oop.implement(this,EventEmitter),this.$characterSize={width:0,height:0},this.$testFractionalRect=function(){var el=dom.createElement("div");this.$setMeasureNodeStyles(el.style),el.style.width="0.2px",document.documentElement.appendChild(el);var w=el.getBoundingClientRect().width;CHAR_COUNT=w>0&&w<1?50:100,el.parentNode.removeChild(el)},this.$setMeasureNodeStyles=function(style,isRoot){style.width=style.height="auto",style.left=style.top="0px",style.visibility="hidden",style.position="absolute",style.whiteSpace="pre",useragent.isIE<8?style["font-family"]="inherit":style.font="inherit",style.overflow=isRoot?"hidden":"visible"},this.checkForSizeChanges=function(){var size=this.$measureSizes();if(size&&(this.$characterSize.width!==size.width||this.$characterSize.height!==size.height)){this.$measureNode.style.fontWeight="bold";var boldSize=this.$measureSizes();this.$measureNode.style.fontWeight="",this.$characterSize=size,this.charSizes=Object.create(null),this.allowBoldFonts=boldSize&&boldSize.width===size.width&&boldSize.height===size.height,this._emit("changeCharacterSize",{data:size})}},this.$pollSizeChanges=function(){if(this.$pollSizeChangesTimer)return this.$pollSizeChangesTimer;var self=this;return this.$pollSizeChangesTimer=setInterval((function(){self.checkForSizeChanges()}),500)},this.setPolling=function(val){val?this.$pollSizeChanges():this.$pollSizeChangesTimer&&(clearInterval(this.$pollSizeChangesTimer),this.$pollSizeChangesTimer=0)},this.$measureSizes=function(){if(50===CHAR_COUNT){var rect=null;try{rect=this.$measureNode.getBoundingClientRect()}catch(e){rect={width:0,height:0}}var size={height:rect.height,width:rect.width/CHAR_COUNT}}else size={height:this.$measureNode.clientHeight,width:this.$measureNode.clientWidth/CHAR_COUNT};return 0===size.width||0===size.height?null:size},this.$measureCharWidth=function(ch){return this.$main.innerHTML=lang.stringRepeat(ch,CHAR_COUNT),this.$main.getBoundingClientRect().width/CHAR_COUNT},this.getCharacterWidth=function(ch){var w=this.charSizes[ch];return void 0===w&&(w=this.charSizes[ch]=this.$measureCharWidth(ch)/this.$characterSize.width),w},this.destroy=function(){clearInterval(this.$pollSizeChangesTimer),this.el&&this.el.parentNode&&this.el.parentNode.removeChild(this.el)}}).call(FontMetrics.prototype)})),ace.define("ace/virtual_renderer",["require","exports","module","ace/lib/oop","ace/lib/dom","ace/config","ace/lib/useragent","ace/layer/gutter","ace/layer/marker","ace/layer/text","ace/layer/cursor","ace/scrollbar","ace/scrollbar","ace/renderloop","ace/layer/font_metrics","ace/lib/event_emitter"],(function(acequire,exports,module){"use strict";var oop=acequire("./lib/oop"),dom=acequire("./lib/dom"),config=acequire("./config"),useragent=acequire("./lib/useragent"),GutterLayer=acequire("./layer/gutter").Gutter,MarkerLayer=acequire("./layer/marker").Marker,TextLayer=acequire("./layer/text").Text,CursorLayer=acequire("./layer/cursor").Cursor,HScrollBar=acequire("./scrollbar").HScrollBar,VScrollBar=acequire("./scrollbar").VScrollBar,RenderLoop=acequire("./renderloop").RenderLoop,FontMetrics=acequire("./layer/font_metrics").FontMetrics,EventEmitter=acequire("./lib/event_emitter").EventEmitter;dom.importCssString('.ace_editor {position: relative;overflow: hidden;font: 12px/normal \'Monaco\', \'Menlo\', \'Ubuntu Mono\', \'Consolas\', \'source-code-pro\', monospace;direction: ltr;text-align: left;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);}.ace_scroller {position: absolute;overflow: hidden;top: 0;bottom: 0;background-color: inherit;-ms-user-select: none;-moz-user-select: none;-webkit-user-select: none;user-select: none;cursor: text;}.ace_content {position: absolute;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;min-width: 100%;}.ace_dragging .ace_scroller:before{position: absolute;top: 0;left: 0;right: 0;bottom: 0;content: \'\';background: rgba(250, 250, 250, 0.01);z-index: 1000;}.ace_dragging.ace_dark .ace_scroller:before{background: rgba(0, 0, 0, 0.01);}.ace_selecting, .ace_selecting * {cursor: text !important;}.ace_gutter {position: absolute;overflow : hidden;width: auto;top: 0;bottom: 0;left: 0;cursor: default;z-index: 4;-ms-user-select: none;-moz-user-select: none;-webkit-user-select: none;user-select: none;}.ace_gutter-active-line {position: absolute;left: 0;right: 0;}.ace_scroller.ace_scroll-left {box-shadow: 17px 0 16px -16px rgba(0, 0, 0, 0.4) inset;}.ace_gutter-cell {padding-left: 19px;padding-right: 6px;background-repeat: no-repeat;}.ace_gutter-cell.ace_error {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAABOFBMVEX/////////QRswFAb/Ui4wFAYwFAYwFAaWGAfDRymzOSH/PxswFAb/SiUwFAYwFAbUPRvjQiDllog5HhHdRybsTi3/Tyv9Tir+Syj/UC3////XurebMBIwFAb/RSHbPx/gUzfdwL3kzMivKBAwFAbbvbnhPx66NhowFAYwFAaZJg8wFAaxKBDZurf/RB6mMxb/SCMwFAYwFAbxQB3+RB4wFAb/Qhy4Oh+4QifbNRcwFAYwFAYwFAb/QRzdNhgwFAYwFAbav7v/Uy7oaE68MBK5LxLewr/r2NXewLswFAaxJw4wFAbkPRy2PyYwFAaxKhLm1tMwFAazPiQwFAaUGAb/QBrfOx3bvrv/VC/maE4wFAbRPBq6MRO8Qynew8Dp2tjfwb0wFAbx6eju5+by6uns4uH9/f36+vr/GkHjAAAAYnRSTlMAGt+64rnWu/bo8eAA4InH3+DwoN7j4eLi4xP99Nfg4+b+/u9B/eDs1MD1mO7+4PHg2MXa347g7vDizMLN4eG+Pv7i5evs/v79yu7S3/DV7/498Yv24eH+4ufQ3Ozu/v7+y13sRqwAAADLSURBVHjaZc/XDsFgGIBhtDrshlitmk2IrbHFqL2pvXf/+78DPokj7+Fz9qpU/9UXJIlhmPaTaQ6QPaz0mm+5gwkgovcV6GZzd5JtCQwgsxoHOvJO15kleRLAnMgHFIESUEPmawB9ngmelTtipwwfASilxOLyiV5UVUyVAfbG0cCPHig+GBkzAENHS0AstVF6bacZIOzgLmxsHbt2OecNgJC83JERmePUYq8ARGkJx6XtFsdddBQgZE2nPR6CICZhawjA4Fb/chv+399kfR+MMMDGOQAAAABJRU5ErkJggg==");background-repeat: no-repeat;background-position: 2px center;}.ace_gutter-cell.ace_warning {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAmVBMVEX///8AAAD///8AAAAAAABPSzb/5sAAAAB/blH/73z/ulkAAAAAAAD85pkAAAAAAAACAgP/vGz/rkDerGbGrV7/pkQICAf////e0IsAAAD/oED/qTvhrnUAAAD/yHD/njcAAADuv2r/nz//oTj/p064oGf/zHAAAAA9Nir/tFIAAAD/tlTiuWf/tkIAAACynXEAAAAAAAAtIRW7zBpBAAAAM3RSTlMAABR1m7RXO8Ln31Z36zT+neXe5OzooRDfn+TZ4p3h2hTf4t3k3ucyrN1K5+Xaks52Sfs9CXgrAAAAjklEQVR42o3PbQ+CIBQFYEwboPhSYgoYunIqqLn6/z8uYdH8Vmdnu9vz4WwXgN/xTPRD2+sgOcZjsge/whXZgUaYYvT8QnuJaUrjrHUQreGczuEafQCO/SJTufTbroWsPgsllVhq3wJEk2jUSzX3CUEDJC84707djRc5MTAQxoLgupWRwW6UB5fS++NV8AbOZgnsC7BpEAAAAABJRU5ErkJggg==");background-position: 2px center;}.ace_gutter-cell.ace_info {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAAAAAA6mKC9AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAAJ0Uk5TAAB2k804AAAAPklEQVQY02NgIB68QuO3tiLznjAwpKTgNyDbMegwisCHZUETUZV0ZqOquBpXj2rtnpSJT1AEnnRmL2OgGgAAIKkRQap2htgAAAAASUVORK5CYII=");background-position: 2px center;}.ace_dark .ace_gutter-cell.ace_info {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAAJFBMVEUAAAChoaGAgIAqKiq+vr6tra1ZWVmUlJSbm5s8PDxubm56enrdgzg3AAAAAXRSTlMAQObYZgAAAClJREFUeNpjYMAPdsMYHegyJZFQBlsUlMFVCWUYKkAZMxZAGdxlDMQBAG+TBP4B6RyJAAAAAElFTkSuQmCC");}.ace_scrollbar {position: absolute;right: 0;bottom: 0;z-index: 6;}.ace_scrollbar-inner {position: absolute;cursor: text;left: 0;top: 0;}.ace_scrollbar-v{overflow-x: hidden;overflow-y: scroll;top: 0;}.ace_scrollbar-h {overflow-x: scroll;overflow-y: hidden;left: 0;}.ace_print-margin {position: absolute;height: 100%;}.ace_text-input {position: absolute;z-index: 0;width: 0.5em;height: 1em;opacity: 0;background: transparent;-moz-appearance: none;appearance: none;border: none;resize: none;outline: none;overflow: hidden;font: inherit;padding: 0 1px;margin: 0 -1px;text-indent: -1em;-ms-user-select: text;-moz-user-select: text;-webkit-user-select: text;user-select: text;white-space: pre!important;}.ace_text-input.ace_composition {background: inherit;color: inherit;z-index: 1000;opacity: 1;text-indent: 0;}.ace_layer {z-index: 1;position: absolute;overflow: hidden;word-wrap: normal;white-space: pre;height: 100%;width: 100%;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;pointer-events: none;}.ace_gutter-layer {position: relative;width: auto;text-align: right;pointer-events: auto;}.ace_text-layer {font: inherit !important;}.ace_cjk {display: inline-block;text-align: center;}.ace_cursor-layer {z-index: 4;}.ace_cursor {z-index: 4;position: absolute;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;border-left: 2px solid;transform: translatez(0);}.ace_multiselect .ace_cursor {border-left-width: 1px;}.ace_slim-cursors .ace_cursor {border-left-width: 1px;}.ace_overwrite-cursors .ace_cursor {border-left-width: 0;border-bottom: 1px solid;}.ace_hidden-cursors .ace_cursor {opacity: 0.2;}.ace_smooth-blinking .ace_cursor {-webkit-transition: opacity 0.18s;transition: opacity 0.18s;}.ace_marker-layer .ace_step, .ace_marker-layer .ace_stack {position: absolute;z-index: 3;}.ace_marker-layer .ace_selection {position: absolute;z-index: 5;}.ace_marker-layer .ace_bracket {position: absolute;z-index: 6;}.ace_marker-layer .ace_active-line {position: absolute;z-index: 2;}.ace_marker-layer .ace_selected-word {position: absolute;z-index: 4;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;}.ace_line .ace_fold {-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;display: inline-block;height: 11px;margin-top: -2px;vertical-align: middle;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAJCAYAAADU6McMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJpJREFUeNpi/P//PwOlgAXGYGRklAVSokD8GmjwY1wasKljQpYACtpCFeADcHVQfQyMQAwzwAZI3wJKvCLkfKBaMSClBlR7BOQikCFGQEErIH0VqkabiGCAqwUadAzZJRxQr/0gwiXIal8zQQPnNVTgJ1TdawL0T5gBIP1MUJNhBv2HKoQHHjqNrA4WO4zY0glyNKLT2KIfIMAAQsdgGiXvgnYAAAAASUVORK5CYII="),url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAA3CAYAAADNNiA5AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAACJJREFUeNpi+P//fxgTAwPDBxDxD078RSX+YeEyDFMCIMAAI3INmXiwf2YAAAAASUVORK5CYII=");background-repeat: no-repeat, repeat-x;background-position: center center, top left;color: transparent;border: 1px solid black;border-radius: 2px;cursor: pointer;pointer-events: auto;}.ace_dark .ace_fold {}.ace_fold:hover{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAJCAYAAADU6McMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJpJREFUeNpi/P//PwOlgAXGYGRklAVSokD8GmjwY1wasKljQpYACtpCFeADcHVQfQyMQAwzwAZI3wJKvCLkfKBaMSClBlR7BOQikCFGQEErIH0VqkabiGCAqwUadAzZJRxQr/0gwiXIal8zQQPnNVTgJ1TdawL0T5gBIP1MUJNhBv2HKoQHHjqNrA4WO4zY0glyNKLT2KIfIMAAQsdgGiXvgnYAAAAASUVORK5CYII="),url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAA3CAYAAADNNiA5AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAACBJREFUeNpi+P//fz4TAwPDZxDxD5X4i5fLMEwJgAADAEPVDbjNw87ZAAAAAElFTkSuQmCC");}.ace_tooltip {background-color: #FFF;background-image: -webkit-linear-gradient(top, transparent, rgba(0, 0, 0, 0.1));background-image: linear-gradient(to bottom, transparent, rgba(0, 0, 0, 0.1));border: 1px solid gray;border-radius: 1px;box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);color: black;max-width: 100%;padding: 3px 4px;position: fixed;z-index: 999999;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;cursor: default;white-space: pre;word-wrap: break-word;line-height: normal;font-style: normal;font-weight: normal;letter-spacing: normal;pointer-events: none;}.ace_folding-enabled > .ace_gutter-cell {padding-right: 13px;}.ace_fold-widget {-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;margin: 0 -12px 0 1px;display: none;width: 11px;vertical-align: top;background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAANElEQVR42mWKsQ0AMAzC8ixLlrzQjzmBiEjp0A6WwBCSPgKAXoLkqSot7nN3yMwR7pZ32NzpKkVoDBUxKAAAAABJRU5ErkJggg==");background-repeat: no-repeat;background-position: center;border-radius: 3px;border: 1px solid transparent;cursor: pointer;}.ace_folding-enabled .ace_fold-widget {display: inline-block;   }.ace_fold-widget.ace_end {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAANElEQVR42m3HwQkAMAhD0YzsRchFKI7sAikeWkrxwScEB0nh5e7KTPWimZki4tYfVbX+MNl4pyZXejUO1QAAAABJRU5ErkJggg==");}.ace_fold-widget.ace_closed {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAGCAYAAAAG5SQMAAAAOUlEQVR42jXKwQkAMAgDwKwqKD4EwQ26sSOkVWjgIIHAzPiCgaqiqnJHZnKICBERHN194O5b9vbLuAVRL+l0YWnZAAAAAElFTkSuQmCCXA==");}.ace_fold-widget:hover {border: 1px solid rgba(0, 0, 0, 0.3);background-color: rgba(255, 255, 255, 0.2);box-shadow: 0 1px 1px rgba(255, 255, 255, 0.7);}.ace_fold-widget:active {border: 1px solid rgba(0, 0, 0, 0.4);background-color: rgba(0, 0, 0, 0.05);box-shadow: 0 1px 1px rgba(255, 255, 255, 0.8);}.ace_dark .ace_fold-widget {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHklEQVQIW2P4//8/AzoGEQ7oGCaLLAhWiSwB146BAQCSTPYocqT0AAAAAElFTkSuQmCC");}.ace_dark .ace_fold-widget.ace_end {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAH0lEQVQIW2P4//8/AxQ7wNjIAjDMgC4AxjCVKBirIAAF0kz2rlhxpAAAAABJRU5ErkJggg==");}.ace_dark .ace_fold-widget.ace_closed {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAFCAYAAACAcVaiAAAAHElEQVQIW2P4//+/AxAzgDADlOOAznHAKgPWAwARji8UIDTfQQAAAABJRU5ErkJggg==");}.ace_dark .ace_fold-widget:hover {box-shadow: 0 1px 1px rgba(255, 255, 255, 0.2);background-color: rgba(255, 255, 255, 0.1);}.ace_dark .ace_fold-widget:active {box-shadow: 0 1px 1px rgba(255, 255, 255, 0.2);}.ace_fold-widget.ace_invalid {background-color: #FFB4B4;border-color: #DE5555;}.ace_fade-fold-widgets .ace_fold-widget {-webkit-transition: opacity 0.4s ease 0.05s;transition: opacity 0.4s ease 0.05s;opacity: 0;}.ace_fade-fold-widgets:hover .ace_fold-widget {-webkit-transition: opacity 0.05s ease 0.05s;transition: opacity 0.05s ease 0.05s;opacity:1;}.ace_underline {text-decoration: underline;}.ace_bold {font-weight: bold;}.ace_nobold .ace_bold {font-weight: normal;}.ace_italic {font-style: italic;}.ace_error-marker {background-color: rgba(255, 0, 0,0.2);position: absolute;z-index: 9;}.ace_highlight-marker {background-color: rgba(255, 255, 0,0.2);position: absolute;z-index: 8;}.ace_br1 {border-top-left-radius    : 3px;}.ace_br2 {border-top-right-radius   : 3px;}.ace_br3 {border-top-left-radius    : 3px; border-top-right-radius:    3px;}.ace_br4 {border-bottom-right-radius: 3px;}.ace_br5 {border-top-left-radius    : 3px; border-bottom-right-radius: 3px;}.ace_br6 {border-top-right-radius   : 3px; border-bottom-right-radius: 3px;}.ace_br7 {border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-right-radius: 3px;}.ace_br8 {border-bottom-left-radius : 3px;}.ace_br9 {border-top-left-radius    : 3px; border-bottom-left-radius:  3px;}.ace_br10{border-top-right-radius   : 3px; border-bottom-left-radius:  3px;}.ace_br11{border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-left-radius:  3px;}.ace_br12{border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}.ace_br13{border-top-left-radius    : 3px; border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}.ace_br14{border-top-right-radius   : 3px; border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}.ace_br15{border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px;}.ace_text-input-ios {position: absolute !important;top: -100000px !important;left: -100000px !important;}',"ace_editor.css");var VirtualRenderer=function(container,theme){var _self=this;this.container=container||dom.createElement("div"),this.$keepTextAreaAtCursor=!useragent.isOldIE,dom.addCssClass(this.container,"ace_editor"),this.setTheme(theme),this.$gutter=dom.createElement("div"),this.$gutter.className="ace_gutter",this.container.appendChild(this.$gutter),this.$gutter.setAttribute("aria-hidden",!0),this.scroller=dom.createElement("div"),this.scroller.className="ace_scroller",this.container.appendChild(this.scroller),this.content=dom.createElement("div"),this.content.className="ace_content",this.scroller.appendChild(this.content),this.$gutterLayer=new GutterLayer(this.$gutter),this.$gutterLayer.on("changeGutterWidth",this.onGutterResize.bind(this)),this.$markerBack=new MarkerLayer(this.content);var textLayer=this.$textLayer=new TextLayer(this.content);this.canvas=textLayer.element,this.$markerFront=new MarkerLayer(this.content),this.$cursorLayer=new CursorLayer(this.content),this.$horizScroll=!1,this.$vScroll=!1,this.scrollBar=this.scrollBarV=new VScrollBar(this.container,this),this.scrollBarH=new HScrollBar(this.container,this),this.scrollBarV.addEventListener("scroll",(function(e){_self.$scrollAnimation||_self.session.setScrollTop(e.data-_self.scrollMargin.top)})),this.scrollBarH.addEventListener("scroll",(function(e){_self.$scrollAnimation||_self.session.setScrollLeft(e.data-_self.scrollMargin.left)})),this.scrollTop=0,this.scrollLeft=0,this.cursorPos={row:0,column:0},this.$fontMetrics=new FontMetrics(this.container),this.$textLayer.$setFontMetrics(this.$fontMetrics),this.$textLayer.addEventListener("changeCharacterSize",(function(e){_self.updateCharacterSize(),_self.onResize(!0,_self.gutterWidth,_self.$size.width,_self.$size.height),_self._signal("changeCharacterSize",e)})),this.$size={width:0,height:0,scrollerHeight:0,scrollerWidth:0,$dirty:!0},this.layerConfig={width:1,padding:0,firstRow:0,firstRowScreen:0,lastRow:0,lineHeight:0,characterWidth:0,minHeight:1,maxHeight:1,offset:0,height:1,gutterOffset:1},this.scrollMargin={left:0,right:0,top:0,bottom:0,v:0,h:0},this.$loop=new RenderLoop(this.$renderChanges.bind(this),this.container.ownerDocument.defaultView),this.$loop.schedule(this.CHANGE_FULL),this.updateCharacterSize(),this.setPadding(4),config.resetOptions(this),config._emit("renderer",this)};(function(){this.CHANGE_CURSOR=1,this.CHANGE_MARKER=2,this.CHANGE_GUTTER=4,this.CHANGE_SCROLL=8,this.CHANGE_LINES=16,this.CHANGE_TEXT=32,this.CHANGE_SIZE=64,this.CHANGE_MARKER_BACK=128,this.CHANGE_MARKER_FRONT=256,this.CHANGE_FULL=512,this.CHANGE_H_SCROLL=1024,oop.implement(this,EventEmitter),this.updateCharacterSize=function(){this.$textLayer.allowBoldFonts!=this.$allowBoldFonts&&(this.$allowBoldFonts=this.$textLayer.allowBoldFonts,this.setStyle("ace_nobold",!this.$allowBoldFonts)),this.layerConfig.characterWidth=this.characterWidth=this.$textLayer.getCharacterWidth(),this.layerConfig.lineHeight=this.lineHeight=this.$textLayer.getLineHeight(),this.$updatePrintMargin()},this.setSession=function(session){this.session&&this.session.doc.off("changeNewLineMode",this.onChangeNewLineMode),this.session=session,session&&this.scrollMargin.top&&session.getScrollTop()<=0&&session.setScrollTop(-this.scrollMargin.top),this.$cursorLayer.setSession(session),this.$markerBack.setSession(session),this.$markerFront.setSession(session),this.$gutterLayer.setSession(session),this.$textLayer.setSession(session),session&&(this.$loop.schedule(this.CHANGE_FULL),this.session.$setFontMetrics(this.$fontMetrics),this.scrollBarH.scrollLeft=this.scrollBarV.scrollTop=null,this.onChangeNewLineMode=this.onChangeNewLineMode.bind(this),this.onChangeNewLineMode(),this.session.doc.on("changeNewLineMode",this.onChangeNewLineMode))},this.updateLines=function(firstRow,lastRow,force){if(void 0===lastRow&&(lastRow=1/0),this.$changedLines?(this.$changedLines.firstRow>firstRow&&(this.$changedLines.firstRow=firstRow),this.$changedLines.lastRow<lastRow&&(this.$changedLines.lastRow=lastRow)):this.$changedLines={firstRow:firstRow,lastRow:lastRow},this.$changedLines.lastRow<this.layerConfig.firstRow){if(!force)return;this.$changedLines.lastRow=this.layerConfig.lastRow}this.$changedLines.firstRow>this.layerConfig.lastRow||this.$loop.schedule(this.CHANGE_LINES)},this.onChangeNewLineMode=function(){this.$loop.schedule(this.CHANGE_TEXT),this.$textLayer.$updateEolChar(),this.session.$bidiHandler.setEolChar(this.$textLayer.EOL_CHAR)},this.onChangeTabSize=function(){this.$loop.schedule(this.CHANGE_TEXT|this.CHANGE_MARKER),this.$textLayer.onChangeTabSize()},this.updateText=function(){this.$loop.schedule(this.CHANGE_TEXT)},this.updateFull=function(force){force?this.$renderChanges(this.CHANGE_FULL,!0):this.$loop.schedule(this.CHANGE_FULL)},this.updateFontSize=function(){this.$textLayer.checkForSizeChanges()},this.$changes=0,this.$updateSizeAsync=function(){this.$loop.pending?this.$size.$dirty=!0:this.onResize()},this.onResize=function(force,gutterWidth,width,height){if(!(this.resizing>2)){this.resizing>0?this.resizing++:this.resizing=force?1:0;var el=this.container;height||(height=el.clientHeight||el.scrollHeight),width||(width=el.clientWidth||el.scrollWidth);var changes=this.$updateCachedSize(force,gutterWidth,width,height);if(!this.$size.scrollerHeight||!width&&!height)return this.resizing=0;force&&(this.$gutterLayer.$padding=null),force?this.$renderChanges(changes|this.$changes,!0):this.$loop.schedule(changes|this.$changes),this.resizing&&(this.resizing=0),this.scrollBarV.scrollLeft=this.scrollBarV.scrollTop=null}},this.$updateCachedSize=function(force,gutterWidth,width,height){height-=this.$extraHeight||0;var changes=0,size=this.$size,oldSize={width:size.width,height:size.height,scrollerHeight:size.scrollerHeight,scrollerWidth:size.scrollerWidth};return height&&(force||size.height!=height)&&(size.height=height,changes|=this.CHANGE_SIZE,size.scrollerHeight=size.height,this.$horizScroll&&(size.scrollerHeight-=this.scrollBarH.getHeight()),this.scrollBarV.element.style.bottom=this.scrollBarH.getHeight()+"px",changes|=this.CHANGE_SCROLL),width&&(force||size.width!=width)&&(changes|=this.CHANGE_SIZE,size.width=width,null==gutterWidth&&(gutterWidth=this.$showGutter?this.$gutter.offsetWidth:0),this.gutterWidth=gutterWidth,this.scrollBarH.element.style.left=this.scroller.style.left=gutterWidth+"px",size.scrollerWidth=Math.max(0,width-gutterWidth-this.scrollBarV.getWidth()),this.scrollBarH.element.style.right=this.scroller.style.right=this.scrollBarV.getWidth()+"px",this.scroller.style.bottom=this.scrollBarH.getHeight()+"px",(this.session&&this.session.getUseWrapMode()&&this.adjustWrapLimit()||force)&&(changes|=this.CHANGE_FULL)),size.$dirty=!width||!height,changes&&this._signal("resize",oldSize),changes},this.onGutterResize=function(){var gutterWidth=this.$showGutter?this.$gutter.offsetWidth:0;gutterWidth!=this.gutterWidth&&(this.$changes|=this.$updateCachedSize(!0,gutterWidth,this.$size.width,this.$size.height)),this.session.getUseWrapMode()&&this.adjustWrapLimit()||this.$size.$dirty?this.$loop.schedule(this.CHANGE_FULL):(this.$computeLayerConfig(),this.$loop.schedule(this.CHANGE_MARKER))},this.adjustWrapLimit=function(){var availableWidth=this.$size.scrollerWidth-2*this.$padding,limit=Math.floor(availableWidth/this.characterWidth);return this.session.adjustWrapLimit(limit,this.$showPrintMargin&&this.$printMarginColumn)},this.setAnimatedScroll=function(shouldAnimate){this.setOption("animatedScroll",shouldAnimate)},this.getAnimatedScroll=function(){return this.$animatedScroll},this.setShowInvisibles=function(showInvisibles){this.setOption("showInvisibles",showInvisibles),this.session.$bidiHandler.setShowInvisibles(showInvisibles)},this.getShowInvisibles=function(){return this.getOption("showInvisibles")},this.getDisplayIndentGuides=function(){return this.getOption("displayIndentGuides")},this.setDisplayIndentGuides=function(display){this.setOption("displayIndentGuides",display)},this.setShowPrintMargin=function(showPrintMargin){this.setOption("showPrintMargin",showPrintMargin)},this.getShowPrintMargin=function(){return this.getOption("showPrintMargin")},this.setPrintMarginColumn=function(showPrintMargin){this.setOption("printMarginColumn",showPrintMargin)},this.getPrintMarginColumn=function(){return this.getOption("printMarginColumn")},this.getShowGutter=function(){return this.getOption("showGutter")},this.setShowGutter=function(show){return this.setOption("showGutter",show)},this.getFadeFoldWidgets=function(){return this.getOption("fadeFoldWidgets")},this.setFadeFoldWidgets=function(show){this.setOption("fadeFoldWidgets",show)},this.setHighlightGutterLine=function(shouldHighlight){this.setOption("highlightGutterLine",shouldHighlight)},this.getHighlightGutterLine=function(){return this.getOption("highlightGutterLine")},this.$updateGutterLineHighlight=function(){var pos=this.$cursorLayer.$pixelPos,height=this.layerConfig.lineHeight;if(this.session.getUseWrapMode()){var cursor=this.session.selection.getCursor();cursor.column=0,pos=this.$cursorLayer.getPixelPosition(cursor,!0),height*=this.session.getRowLength(cursor.row)}this.$gutterLineHighlight.style.top=pos.top-this.layerConfig.offset+"px",this.$gutterLineHighlight.style.height=height+"px"},this.$updatePrintMargin=function(){if(this.$showPrintMargin||this.$printMarginEl){if(!this.$printMarginEl){var containerEl=dom.createElement("div");containerEl.className="ace_layer ace_print-margin-layer",this.$printMarginEl=dom.createElement("div"),this.$printMarginEl.className="ace_print-margin",containerEl.appendChild(this.$printMarginEl),this.content.insertBefore(containerEl,this.content.firstChild)}var style=this.$printMarginEl.style;style.left=this.characterWidth*this.$printMarginColumn+this.$padding+"px",style.visibility=this.$showPrintMargin?"visible":"hidden",this.session&&-1==this.session.$wrap&&this.adjustWrapLimit()}},this.getContainerElement=function(){return this.container},this.getMouseEventTarget=function(){return this.scroller},this.getTextAreaContainer=function(){return this.container},this.$moveTextAreaToCursor=function(){if(this.$keepTextAreaAtCursor){var config=this.layerConfig,posTop=this.$cursorLayer.$pixelPos.top,posLeft=this.$cursorLayer.$pixelPos.left;posTop-=config.offset;var style=this.textarea.style,h=this.lineHeight;if(posTop<0||posTop>config.height-h)style.top=style.left="0";else{var w=this.characterWidth;if(this.$composition){var val=this.textarea.value.replace(/^\x01+/,"");w*=this.session.$getStringScreenWidth(val)[0]+2,h+=2}(posLeft-=this.scrollLeft)>this.$size.scrollerWidth-w&&(posLeft=this.$size.scrollerWidth-w),posLeft+=this.gutterWidth,style.height=h+"px",style.width=w+"px",style.left=Math.min(posLeft,this.$size.scrollerWidth-w)+"px",style.top=Math.min(posTop,this.$size.height-h)+"px"}}},this.getFirstVisibleRow=function(){return this.layerConfig.firstRow},this.getFirstFullyVisibleRow=function(){return this.layerConfig.firstRow+(0===this.layerConfig.offset?0:1)},this.getLastFullyVisibleRow=function(){var config=this.layerConfig,lastRow=config.lastRow;return this.session.documentToScreenRow(lastRow,0)*config.lineHeight-this.session.getScrollTop()>config.height-config.lineHeight?lastRow-1:lastRow},this.getLastVisibleRow=function(){return this.layerConfig.lastRow},this.$padding=null,this.setPadding=function(padding){this.$padding=padding,this.$textLayer.setPadding(padding),this.$cursorLayer.setPadding(padding),this.$markerFront.setPadding(padding),this.$markerBack.setPadding(padding),this.$loop.schedule(this.CHANGE_FULL),this.$updatePrintMargin()},this.setScrollMargin=function(top,bottom,left,right){var sm=this.scrollMargin;sm.top=0|top,sm.bottom=0|bottom,sm.right=0|right,sm.left=0|left,sm.v=sm.top+sm.bottom,sm.h=sm.left+sm.right,sm.top&&this.scrollTop<=0&&this.session&&this.session.setScrollTop(-sm.top),this.updateFull()},this.getHScrollBarAlwaysVisible=function(){return this.$hScrollBarAlwaysVisible},this.setHScrollBarAlwaysVisible=function(alwaysVisible){this.setOption("hScrollBarAlwaysVisible",alwaysVisible)},this.getVScrollBarAlwaysVisible=function(){return this.$vScrollBarAlwaysVisible},this.setVScrollBarAlwaysVisible=function(alwaysVisible){this.setOption("vScrollBarAlwaysVisible",alwaysVisible)},this.$updateScrollBarV=function(){var scrollHeight=this.layerConfig.maxHeight,scrollerHeight=this.$size.scrollerHeight;!this.$maxLines&&this.$scrollPastEnd&&(scrollHeight-=(scrollerHeight-this.lineHeight)*this.$scrollPastEnd,this.scrollTop>scrollHeight-scrollerHeight&&(scrollHeight=this.scrollTop+scrollerHeight,this.scrollBarV.scrollTop=null)),this.scrollBarV.setScrollHeight(scrollHeight+this.scrollMargin.v),this.scrollBarV.setScrollTop(this.scrollTop+this.scrollMargin.top)},this.$updateScrollBarH=function(){this.scrollBarH.setScrollWidth(this.layerConfig.width+2*this.$padding+this.scrollMargin.h),this.scrollBarH.setScrollLeft(this.scrollLeft+this.scrollMargin.left)},this.$frozen=!1,this.freeze=function(){this.$frozen=!0},this.unfreeze=function(){this.$frozen=!1},this.$renderChanges=function(changes,force){if(this.$changes&&(changes|=this.$changes,this.$changes=0),this.session&&this.container.offsetWidth&&!this.$frozen&&(changes||force)){if(this.$size.$dirty)return this.$changes|=changes,this.onResize(!0);this.lineHeight||this.$textLayer.checkForSizeChanges(),this._signal("beforeRender"),this.session&&this.session.$bidiHandler&&this.session.$bidiHandler.updateCharacterWidths(this.$fontMetrics);var config=this.layerConfig;if(changes&this.CHANGE_FULL||changes&this.CHANGE_SIZE||changes&this.CHANGE_TEXT||changes&this.CHANGE_LINES||changes&this.CHANGE_SCROLL||changes&this.CHANGE_H_SCROLL){if(changes|=this.$computeLayerConfig(),config.firstRow!=this.layerConfig.firstRow&&config.firstRowScreen==this.layerConfig.firstRowScreen){var st=this.scrollTop+(config.firstRow-this.layerConfig.firstRow)*this.lineHeight;st>0&&(this.scrollTop=st,changes|=this.CHANGE_SCROLL,changes|=this.$computeLayerConfig())}config=this.layerConfig,this.$updateScrollBarV(),changes&this.CHANGE_H_SCROLL&&this.$updateScrollBarH(),this.$gutterLayer.element.style.marginTop=-config.offset+"px",this.content.style.marginTop=-config.offset+"px",this.content.style.width=config.width+2*this.$padding+"px",this.content.style.height=config.minHeight+"px"}if(changes&this.CHANGE_H_SCROLL&&(this.content.style.marginLeft=-this.scrollLeft+"px",this.scroller.className=this.scrollLeft<=0?"ace_scroller":"ace_scroller ace_scroll-left"),changes&this.CHANGE_FULL)return this.$textLayer.update(config),this.$showGutter&&this.$gutterLayer.update(config),this.$markerBack.update(config),this.$markerFront.update(config),this.$cursorLayer.update(config),this.$moveTextAreaToCursor(),this.$highlightGutterLine&&this.$updateGutterLineHighlight(),void this._signal("afterRender");if(changes&this.CHANGE_SCROLL)return changes&this.CHANGE_TEXT||changes&this.CHANGE_LINES?this.$textLayer.update(config):this.$textLayer.scrollLines(config),this.$showGutter&&this.$gutterLayer.update(config),this.$markerBack.update(config),this.$markerFront.update(config),this.$cursorLayer.update(config),this.$highlightGutterLine&&this.$updateGutterLineHighlight(),this.$moveTextAreaToCursor(),void this._signal("afterRender");changes&this.CHANGE_TEXT?(this.$textLayer.update(config),this.$showGutter&&this.$gutterLayer.update(config)):changes&this.CHANGE_LINES?(this.$updateLines()||changes&this.CHANGE_GUTTER&&this.$showGutter)&&this.$gutterLayer.update(config):(changes&this.CHANGE_TEXT||changes&this.CHANGE_GUTTER)&&this.$showGutter&&this.$gutterLayer.update(config),changes&this.CHANGE_CURSOR&&(this.$cursorLayer.update(config),this.$moveTextAreaToCursor(),this.$highlightGutterLine&&this.$updateGutterLineHighlight()),changes&(this.CHANGE_MARKER|this.CHANGE_MARKER_FRONT)&&this.$markerFront.update(config),changes&(this.CHANGE_MARKER|this.CHANGE_MARKER_BACK)&&this.$markerBack.update(config),this._signal("afterRender")}else this.$changes|=changes},this.$autosize=function(){var height=this.session.getScreenLength()*this.lineHeight,maxHeight=this.$maxLines*this.lineHeight,desiredHeight=Math.min(maxHeight,Math.max((this.$minLines||1)*this.lineHeight,height))+this.scrollMargin.v+(this.$extraHeight||0);this.$horizScroll&&(desiredHeight+=this.scrollBarH.getHeight()),this.$maxPixelHeight&&desiredHeight>this.$maxPixelHeight&&(desiredHeight=this.$maxPixelHeight);var vScroll=height>maxHeight;if(desiredHeight!=this.desiredHeight||this.$size.height!=this.desiredHeight||vScroll!=this.$vScroll){vScroll!=this.$vScroll&&(this.$vScroll=vScroll,this.scrollBarV.setVisible(vScroll));var w=this.container.clientWidth;this.container.style.height=desiredHeight+"px",this.$updateCachedSize(!0,this.$gutterWidth,w,desiredHeight),this.desiredHeight=desiredHeight,this._signal("autosize")}},this.$computeLayerConfig=function(){var session=this.session,size=this.$size,hideScrollbars=size.height<=2*this.lineHeight,maxHeight=this.session.getScreenLength()*this.lineHeight,longestLine=this.$getLongestLine(),horizScroll=!hideScrollbars&&(this.$hScrollBarAlwaysVisible||size.scrollerWidth-longestLine-2*this.$padding<0),hScrollChanged=this.$horizScroll!==horizScroll;hScrollChanged&&(this.$horizScroll=horizScroll,this.scrollBarH.setVisible(horizScroll));var vScrollBefore=this.$vScroll;this.$maxLines&&this.lineHeight>1&&this.$autosize();var offset=this.scrollTop%this.lineHeight,minHeight=size.scrollerHeight+this.lineHeight,scrollPastEnd=!this.$maxLines&&this.$scrollPastEnd?(size.scrollerHeight-this.lineHeight)*this.$scrollPastEnd:0;maxHeight+=scrollPastEnd;var sm=this.scrollMargin;this.session.setScrollTop(Math.max(-sm.top,Math.min(this.scrollTop,maxHeight-size.scrollerHeight+sm.bottom))),this.session.setScrollLeft(Math.max(-sm.left,Math.min(this.scrollLeft,longestLine+2*this.$padding-size.scrollerWidth+sm.right)));var vScroll=!hideScrollbars&&(this.$vScrollBarAlwaysVisible||size.scrollerHeight-maxHeight+scrollPastEnd<0||this.scrollTop>sm.top),vScrollChanged=vScrollBefore!==vScroll;vScrollChanged&&(this.$vScroll=vScroll,this.scrollBarV.setVisible(vScroll));var firstRowScreen,firstRowHeight,lineCount=Math.ceil(minHeight/this.lineHeight)-1,firstRow=Math.max(0,Math.round((this.scrollTop-offset)/this.lineHeight)),lastRow=firstRow+lineCount,lineHeight=this.lineHeight;firstRow=session.screenToDocumentRow(firstRow,0);var foldLine=session.getFoldLine(firstRow);foldLine&&(firstRow=foldLine.start.row),firstRowScreen=session.documentToScreenRow(firstRow,0),firstRowHeight=session.getRowLength(firstRow)*lineHeight,lastRow=Math.min(session.screenToDocumentRow(lastRow,0),session.getLength()-1),minHeight=size.scrollerHeight+session.getRowLength(lastRow)*lineHeight+firstRowHeight,offset=this.scrollTop-firstRowScreen*lineHeight;var changes=0;return this.layerConfig.width!=longestLine&&(changes=this.CHANGE_H_SCROLL),(hScrollChanged||vScrollChanged)&&(changes=this.$updateCachedSize(!0,this.gutterWidth,size.width,size.height),this._signal("scrollbarVisibilityChanged"),vScrollChanged&&(longestLine=this.$getLongestLine())),this.layerConfig={width:longestLine,padding:this.$padding,firstRow:firstRow,firstRowScreen:firstRowScreen,lastRow:lastRow,lineHeight:lineHeight,characterWidth:this.characterWidth,minHeight:minHeight,maxHeight:maxHeight,offset:offset,gutterOffset:lineHeight?Math.max(0,Math.ceil((offset+size.height-size.scrollerHeight)/lineHeight)):0,height:this.$size.scrollerHeight},changes},this.$updateLines=function(){if(this.$changedLines){var firstRow=this.$changedLines.firstRow,lastRow=this.$changedLines.lastRow;this.$changedLines=null;var layerConfig=this.layerConfig;if(!(firstRow>layerConfig.lastRow+1||lastRow<layerConfig.firstRow))return lastRow===1/0?(this.$showGutter&&this.$gutterLayer.update(layerConfig),void this.$textLayer.update(layerConfig)):(this.$textLayer.updateLines(layerConfig,firstRow,lastRow),!0)}},this.$getLongestLine=function(){var charCount=this.session.getScreenWidth();return this.showInvisibles&&!this.session.$useWrapMode&&(charCount+=1),Math.max(this.$size.scrollerWidth-2*this.$padding,Math.round(charCount*this.characterWidth))},this.updateFrontMarkers=function(){this.$markerFront.setMarkers(this.session.getMarkers(!0)),this.$loop.schedule(this.CHANGE_MARKER_FRONT)},this.updateBackMarkers=function(){this.$markerBack.setMarkers(this.session.getMarkers()),this.$loop.schedule(this.CHANGE_MARKER_BACK)},this.addGutterDecoration=function(row,className){this.$gutterLayer.addGutterDecoration(row,className)},this.removeGutterDecoration=function(row,className){this.$gutterLayer.removeGutterDecoration(row,className)},this.updateBreakpoints=function(rows){this.$loop.schedule(this.CHANGE_GUTTER)},this.setAnnotations=function(annotations){this.$gutterLayer.setAnnotations(annotations),this.$loop.schedule(this.CHANGE_GUTTER)},this.updateCursor=function(){this.$loop.schedule(this.CHANGE_CURSOR)},this.hideCursor=function(){this.$cursorLayer.hideCursor()},this.showCursor=function(){this.$cursorLayer.showCursor()},this.scrollSelectionIntoView=function(anchor,lead,offset){this.scrollCursorIntoView(anchor,offset),this.scrollCursorIntoView(lead,offset)},this.scrollCursorIntoView=function(cursor,offset,$viewMargin){if(0!==this.$size.scrollerHeight){var pos=this.$cursorLayer.getPixelPosition(cursor),left=pos.left,top=pos.top,topMargin=$viewMargin&&$viewMargin.top||0,bottomMargin=$viewMargin&&$viewMargin.bottom||0,scrollTop=this.$scrollAnimation?this.session.getScrollTop():this.scrollTop;scrollTop+topMargin>top?(offset&&scrollTop+topMargin>top+this.lineHeight&&(top-=offset*this.$size.scrollerHeight),0===top&&(top=-this.scrollMargin.top),this.session.setScrollTop(top)):scrollTop+this.$size.scrollerHeight-bottomMargin<top+this.lineHeight&&(offset&&scrollTop+this.$size.scrollerHeight-bottomMargin<top-this.lineHeight&&(top+=offset*this.$size.scrollerHeight),this.session.setScrollTop(top+this.lineHeight-this.$size.scrollerHeight));var scrollLeft=this.scrollLeft;scrollLeft>left?(left<this.$padding+2*this.layerConfig.characterWidth&&(left=-this.scrollMargin.left),this.session.setScrollLeft(left)):scrollLeft+this.$size.scrollerWidth<left+this.characterWidth?this.session.setScrollLeft(Math.round(left+this.characterWidth-this.$size.scrollerWidth)):scrollLeft<=this.$padding&&left-scrollLeft<this.characterWidth&&this.session.setScrollLeft(0)}},this.getScrollTop=function(){return this.session.getScrollTop()},this.getScrollLeft=function(){return this.session.getScrollLeft()},this.getScrollTopRow=function(){return this.scrollTop/this.lineHeight},this.getScrollBottomRow=function(){return Math.max(0,Math.floor((this.scrollTop+this.$size.scrollerHeight)/this.lineHeight)-1)},this.scrollToRow=function(row){this.session.setScrollTop(row*this.lineHeight)},this.alignCursor=function(cursor,alignment){"number"==typeof cursor&&(cursor={row:cursor,column:0});var pos=this.$cursorLayer.getPixelPosition(cursor),h=this.$size.scrollerHeight-this.lineHeight,offset=pos.top-h*(alignment||0);return this.session.setScrollTop(offset),offset},this.STEPS=8,this.$calcSteps=function(fromValue,toValue){var t,x_min,i=0,l=this.STEPS,steps=[];for(i=0;i<l;++i)steps.push((t=i/this.STEPS,x_min=fromValue,(toValue-fromValue)*(Math.pow(t-1,3)+1)+x_min));return steps},this.scrollToLine=function(line,center,animate,callback){var offset=this.$cursorLayer.getPixelPosition({row:line,column:0}).top;center&&(offset-=this.$size.scrollerHeight/2);var initialScroll=this.scrollTop;this.session.setScrollTop(offset),!1!==animate&&this.animateScrolling(initialScroll,callback)},this.animateScrolling=function(fromValue,callback){var toValue=this.scrollTop;if(this.$animatedScroll){var _self=this;if(fromValue!=toValue){if(this.$scrollAnimation){var oldSteps=this.$scrollAnimation.steps;if(oldSteps.length&&(fromValue=oldSteps[0])==toValue)return}var steps=_self.$calcSteps(fromValue,toValue);this.$scrollAnimation={from:fromValue,to:toValue,steps:steps},clearInterval(this.$timer),_self.session.setScrollTop(steps.shift()),_self.session.$scrollTop=toValue,this.$timer=setInterval((function(){steps.length?(_self.session.setScrollTop(steps.shift()),_self.session.$scrollTop=toValue):null!=toValue?(_self.session.$scrollTop=-1,_self.session.setScrollTop(toValue),toValue=null):(_self.$timer=clearInterval(_self.$timer),_self.$scrollAnimation=null,callback&&callback())}),10)}}},this.scrollToY=function(scrollTop){this.scrollTop!==scrollTop&&(this.$loop.schedule(this.CHANGE_SCROLL),this.scrollTop=scrollTop)},this.scrollToX=function(scrollLeft){this.scrollLeft!==scrollLeft&&(this.scrollLeft=scrollLeft),this.$loop.schedule(this.CHANGE_H_SCROLL)},this.scrollTo=function(x,y){this.session.setScrollTop(y),this.session.setScrollLeft(y)},this.scrollBy=function(deltaX,deltaY){deltaY&&this.session.setScrollTop(this.session.getScrollTop()+deltaY),deltaX&&this.session.setScrollLeft(this.session.getScrollLeft()+deltaX)},this.isScrollableBy=function(deltaX,deltaY){return deltaY<0&&this.session.getScrollTop()>=1-this.scrollMargin.top||(deltaY>0&&this.session.getScrollTop()+this.$size.scrollerHeight-this.layerConfig.maxHeight<-1+this.scrollMargin.bottom||(deltaX<0&&this.session.getScrollLeft()>=1-this.scrollMargin.left||(deltaX>0&&this.session.getScrollLeft()+this.$size.scrollerWidth-this.layerConfig.width<-1+this.scrollMargin.right||void 0)))},this.pixelToScreenCoordinates=function(x,y){var canvasPos=this.scroller.getBoundingClientRect(),offsetX=x+this.scrollLeft-canvasPos.left-this.$padding,offset=offsetX/this.characterWidth,row=Math.floor((y+this.scrollTop-canvasPos.top)/this.lineHeight),col=Math.round(offset);return{row:row,column:col,side:offset-col>0?1:-1,offsetX:offsetX}},this.screenToTextCoordinates=function(x,y){var canvasPos=this.scroller.getBoundingClientRect(),offsetX=x+this.scrollLeft-canvasPos.left-this.$padding,col=Math.round(offsetX/this.characterWidth),row=(y+this.scrollTop-canvasPos.top)/this.lineHeight;return this.session.screenToDocumentPosition(row,Math.max(col,0),offsetX)},this.textToScreenCoordinates=function(row,column){var canvasPos=this.scroller.getBoundingClientRect(),pos=this.session.documentToScreenPosition(row,column),x=this.$padding+(this.session.$bidiHandler.isBidiRow(pos.row,row)?this.session.$bidiHandler.getPosLeft(pos.column):Math.round(pos.column*this.characterWidth)),y=pos.row*this.lineHeight;return{pageX:canvasPos.left+x-this.scrollLeft,pageY:canvasPos.top+y-this.scrollTop}},this.visualizeFocus=function(){dom.addCssClass(this.container,"ace_focus")},this.visualizeBlur=function(){dom.removeCssClass(this.container,"ace_focus")},this.showComposition=function(position){this.$composition||(this.$composition={keepTextAreaAtCursor:this.$keepTextAreaAtCursor,cssText:this.textarea.style.cssText}),this.$keepTextAreaAtCursor=!0,dom.addCssClass(this.textarea,"ace_composition"),this.textarea.style.cssText="",this.$moveTextAreaToCursor()},this.setCompositionText=function(text){this.$moveTextAreaToCursor()},this.hideComposition=function(){this.$composition&&(dom.removeCssClass(this.textarea,"ace_composition"),this.$keepTextAreaAtCursor=this.$composition.keepTextAreaAtCursor,this.textarea.style.cssText=this.$composition.cssText,this.$composition=null)},this.setTheme=function(theme,cb){var _self=this;if(this.$themeId=theme,_self._dispatchEvent("themeChange",{theme:theme}),theme&&"string"!=typeof theme)afterLoad(theme);else{var moduleName=theme||this.$options.theme.initialValue;config.loadModule(["theme",moduleName],afterLoad)}function afterLoad(module){if(_self.$themeId!=theme)return cb&&cb();if(!module||!module.cssClass)throw new Error("couldn't load module "+theme+" or it didn't call define");dom.importCssString(module.cssText,module.cssClass,_self.container.ownerDocument),_self.theme&&dom.removeCssClass(_self.container,_self.theme.cssClass);var padding="padding"in module?module.padding:"padding"in(_self.theme||{})?4:_self.$padding;_self.$padding&&padding!=_self.$padding&&_self.setPadding(padding),_self.$theme=module.cssClass,_self.theme=module,dom.addCssClass(_self.container,module.cssClass),dom.setCssClass(_self.container,"ace_dark",module.isDark),_self.$size&&(_self.$size.width=0,_self.$updateSizeAsync()),_self._dispatchEvent("themeLoaded",{theme:module}),cb&&cb()}},this.getTheme=function(){return this.$themeId},this.setStyle=function(style,include){dom.setCssClass(this.container,style,!1!==include)},this.unsetStyle=function(style){dom.removeCssClass(this.container,style)},this.setCursorStyle=function(style){this.scroller.style.cursor!=style&&(this.scroller.style.cursor=style)},this.setMouseCursor=function(cursorStyle){this.scroller.style.cursor=cursorStyle},this.destroy=function(){this.$textLayer.destroy(),this.$cursorLayer.destroy()}}).call(VirtualRenderer.prototype),config.defineOptions(VirtualRenderer.prototype,"renderer",{animatedScroll:{initialValue:!1},showInvisibles:{set:function(value){this.$textLayer.setShowInvisibles(value)&&this.$loop.schedule(this.CHANGE_TEXT)},initialValue:!1},showPrintMargin:{set:function(){this.$updatePrintMargin()},initialValue:!0},printMarginColumn:{set:function(){this.$updatePrintMargin()},initialValue:80},printMargin:{set:function(val){"number"==typeof val&&(this.$printMarginColumn=val),this.$showPrintMargin=!!val,this.$updatePrintMargin()},get:function(){return this.$showPrintMargin&&this.$printMarginColumn}},showGutter:{set:function(show){this.$gutter.style.display=show?"block":"none",this.$loop.schedule(this.CHANGE_FULL),this.onGutterResize()},initialValue:!0},fadeFoldWidgets:{set:function(show){dom.setCssClass(this.$gutter,"ace_fade-fold-widgets",show)},initialValue:!1},showFoldWidgets:{set:function(show){this.$gutterLayer.setShowFoldWidgets(show)},initialValue:!0},showLineNumbers:{set:function(show){this.$gutterLayer.setShowLineNumbers(show),this.$loop.schedule(this.CHANGE_GUTTER)},initialValue:!0},displayIndentGuides:{set:function(show){this.$textLayer.setDisplayIndentGuides(show)&&this.$loop.schedule(this.CHANGE_TEXT)},initialValue:!0},highlightGutterLine:{set:function(shouldHighlight){if(!this.$gutterLineHighlight)return this.$gutterLineHighlight=dom.createElement("div"),this.$gutterLineHighlight.className="ace_gutter-active-line",void this.$gutter.appendChild(this.$gutterLineHighlight);this.$gutterLineHighlight.style.display=shouldHighlight?"":"none",this.$cursorLayer.$pixelPos&&this.$updateGutterLineHighlight()},initialValue:!1,value:!0},hScrollBarAlwaysVisible:{set:function(val){this.$hScrollBarAlwaysVisible&&this.$horizScroll||this.$loop.schedule(this.CHANGE_SCROLL)},initialValue:!1},vScrollBarAlwaysVisible:{set:function(val){this.$vScrollBarAlwaysVisible&&this.$vScroll||this.$loop.schedule(this.CHANGE_SCROLL)},initialValue:!1},fontSize:{set:function(size){"number"==typeof size&&(size+="px"),this.container.style.fontSize=size,this.updateFontSize()},initialValue:12},fontFamily:{set:function(name){this.container.style.fontFamily=name,this.updateFontSize()}},maxLines:{set:function(val){this.updateFull()}},minLines:{set:function(val){this.updateFull()}},maxPixelHeight:{set:function(val){this.updateFull()},initialValue:0},scrollPastEnd:{set:function(val){val=+val||0,this.$scrollPastEnd!=val&&(this.$scrollPastEnd=val,this.$loop.schedule(this.CHANGE_SCROLL))},initialValue:0,handlesSet:!0},fixedWidthGutter:{set:function(val){this.$gutterLayer.$fixedWidth=!!val,this.$loop.schedule(this.CHANGE_GUTTER)}},theme:{set:function(val){this.setTheme(val)},get:function(){return this.$themeId||this.theme},initialValue:"./theme/textmate",handlesSet:!0}}),exports.VirtualRenderer=VirtualRenderer})),ace.define("ace/worker/worker_client",["require","exports","module","ace/lib/oop","ace/lib/net","ace/lib/event_emitter","ace/config"],(function(acequire,exports,module){"use strict";var oop=acequire("../lib/oop"),net=acequire("../lib/net"),EventEmitter=acequire("../lib/event_emitter").EventEmitter,config=acequire("../config");function createWorker(workerUrl,mod){var blob=function(workerUrl,mod){var script=mod.src;net.qualifyURL(workerUrl);try{return new Blob([script],{type:"application/javascript"})}catch(e){var blobBuilder=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder);return blobBuilder.append(script),blobBuilder.getBlob("application/javascript")}}(workerUrl,mod),blobURL=(window.URL||window.webkitURL).createObjectURL(blob);return new Worker(blobURL)}var WorkerClient=function(topLevelNamespaces,mod,classname,workerUrl,importScripts){if(this.$sendDeltaQueue=this.$sendDeltaQueue.bind(this),this.changeListener=this.changeListener.bind(this),this.onMessage=this.onMessage.bind(this),acequire.nameToUrl&&!acequire.toUrl&&(acequire.toUrl=acequire.nameToUrl),config.get("packaged")||!acequire.toUrl)workerUrl=workerUrl||config.moduleUrl(mod.id,"worker");else{var normalizePath=this.$normalizePath;workerUrl=workerUrl||normalizePath(acequire.toUrl("ace/worker/worker.js",null,"_"));var tlns={};topLevelNamespaces.forEach((function(ns){tlns[ns]=normalizePath(acequire.toUrl(ns,null,"_").replace(/(\.js)?(\?.*)?$/,""))}))}this.$worker=createWorker(workerUrl,mod),importScripts&&this.send("importScripts",importScripts),this.$worker.postMessage({init:!0,tlns:tlns,module:mod.id,classname:classname}),this.callbackId=1,this.callbacks={},this.$worker.onmessage=this.onMessage};(function(){oop.implement(this,EventEmitter),this.onMessage=function(e){var msg=e.data;switch(msg.type){case"event":this._signal(msg.name,{data:msg.data});break;case"call":var callback=this.callbacks[msg.id];callback&&(callback(msg.data),delete this.callbacks[msg.id]);break;case"error":this.reportError(msg.data);break;case"log":window.console&&console.log&&console.log.apply(console,msg.data)}},this.reportError=function(err){window.console&&console.error&&console.error(err)},this.$normalizePath=function(path){return net.qualifyURL(path)},this.terminate=function(){this._signal("terminate",{}),this.deltaQueue=null,this.$worker.terminate(),this.$worker=null,this.$doc&&this.$doc.off("change",this.changeListener),this.$doc=null},this.send=function(cmd,args){this.$worker.postMessage({command:cmd,args:args})},this.call=function(cmd,args,callback){if(callback){var id=this.callbackId++;this.callbacks[id]=callback,args.push(id)}this.send(cmd,args)},this.emit=function(event,data){try{this.$worker.postMessage({event:event,data:{data:data.data}})}catch(ex){console.error(ex.stack)}},this.attachToDocument=function(doc){this.$doc&&this.terminate(),this.$doc=doc,this.call("setValue",[doc.getValue()]),doc.on("change",this.changeListener)},this.changeListener=function(delta){this.deltaQueue||(this.deltaQueue=[],setTimeout(this.$sendDeltaQueue,0)),"insert"==delta.action?this.deltaQueue.push(delta.start,delta.lines):this.deltaQueue.push(delta.start,delta.end)},this.$sendDeltaQueue=function(){var q=this.deltaQueue;q&&(this.deltaQueue=null,q.length>50&&q.length>this.$doc.getLength()>>1?this.call("setValue",[this.$doc.getValue()]):this.emit("change",{data:q}))}}).call(WorkerClient.prototype);var UIWorkerClient=function(topLevelNamespaces,mod,classname){this.$sendDeltaQueue=this.$sendDeltaQueue.bind(this),this.changeListener=this.changeListener.bind(this),this.callbackId=1,this.callbacks={},this.messageBuffer=[];var main=null,emitSync=!1,sender=Object.create(EventEmitter),_self=this;this.$worker={},this.$worker.terminate=function(){},this.$worker.postMessage=function(e){_self.messageBuffer.push(e),main&&(emitSync?setTimeout(processNext):processNext())},this.setEmitSync=function(val){emitSync=val};var processNext=function(){var msg=_self.messageBuffer.shift();msg.command?main[msg.command].apply(main,msg.args):msg.event&&sender._signal(msg.event,msg.data)};sender.postMessage=function(msg){_self.onMessage({data:msg})},sender.callback=function(data,callbackId){this.postMessage({type:"call",id:callbackId,data:data})},sender.emit=function(name,data){this.postMessage({type:"event",name:name,data:data})},config.loadModule(["worker",mod],(function(Main){for(main=new Main[classname](sender);_self.messageBuffer.length;)processNext()}))};UIWorkerClient.prototype=WorkerClient.prototype,exports.UIWorkerClient=UIWorkerClient,exports.WorkerClient=WorkerClient,exports.createWorker=createWorker})),ace.define("ace/placeholder",["require","exports","module","ace/range","ace/lib/event_emitter","ace/lib/oop"],(function(acequire,exports,module){"use strict";var Range=acequire("./range").Range,EventEmitter=acequire("./lib/event_emitter").EventEmitter,oop=acequire("./lib/oop"),PlaceHolder=function(session,length,pos,others,mainClass,othersClass){var _self=this;this.length=length,this.session=session,this.doc=session.getDocument(),this.mainClass=mainClass,this.othersClass=othersClass,this.$onUpdate=this.onUpdate.bind(this),this.doc.on("change",this.$onUpdate),this.$others=others,this.$onCursorChange=function(){setTimeout((function(){_self.onCursorChange()}))},this.$pos=pos;var undoStack=session.getUndoManager().$undoStack||session.getUndoManager().$undostack||{length:-1};this.$undoStackDepth=undoStack.length,this.setup(),session.selection.on("changeCursor",this.$onCursorChange)};(function(){oop.implement(this,EventEmitter),this.setup=function(){var _self=this,doc=this.doc,session=this.session;this.selectionBefore=session.selection.toJSON(),session.selection.inMultiSelectMode&&session.selection.toSingleRange(),this.pos=doc.createAnchor(this.$pos.row,this.$pos.column);var pos=this.pos;pos.$insertRight=!0,pos.detach(),pos.markerId=session.addMarker(new Range(pos.row,pos.column,pos.row,pos.column+this.length),this.mainClass,null,!1),this.others=[],this.$others.forEach((function(other){var anchor=doc.createAnchor(other.row,other.column);anchor.$insertRight=!0,anchor.detach(),_self.others.push(anchor)})),session.setUndoSelect(!1)},this.showOtherMarkers=function(){if(!this.othersActive){var session=this.session,_self=this;this.othersActive=!0,this.others.forEach((function(anchor){anchor.markerId=session.addMarker(new Range(anchor.row,anchor.column,anchor.row,anchor.column+_self.length),_self.othersClass,null,!1)}))}},this.hideOtherMarkers=function(){if(this.othersActive){this.othersActive=!1;for(var i=0;i<this.others.length;i++)this.session.removeMarker(this.others[i].markerId)}},this.onUpdate=function(delta){if(this.$updating)return this.updateAnchors(delta);var range=delta;if(range.start.row===range.end.row&&range.start.row===this.pos.row){this.$updating=!0;var lengthDiff="insert"===delta.action?range.end.column-range.start.column:range.start.column-range.end.column,inMainRange=range.start.column>=this.pos.column&&range.start.column<=this.pos.column+this.length+1,distanceFromStart=range.start.column-this.pos.column;if(this.updateAnchors(delta),inMainRange&&(this.length+=lengthDiff),inMainRange&&!this.session.$fromUndo)if("insert"===delta.action)for(var i=this.others.length-1;i>=0;i--){var newPos={row:(otherPos=this.others[i]).row,column:otherPos.column+distanceFromStart};this.doc.insertMergedLines(newPos,delta.lines)}else if("remove"===delta.action)for(i=this.others.length-1;i>=0;i--){var otherPos;newPos={row:(otherPos=this.others[i]).row,column:otherPos.column+distanceFromStart};this.doc.remove(new Range(newPos.row,newPos.column,newPos.row,newPos.column-lengthDiff))}this.$updating=!1,this.updateMarkers()}},this.updateAnchors=function(delta){this.pos.onChange(delta);for(var i=this.others.length;i--;)this.others[i].onChange(delta);this.updateMarkers()},this.updateMarkers=function(){if(!this.$updating){var _self=this,session=this.session,updateMarker=function(pos,className){session.removeMarker(pos.markerId),pos.markerId=session.addMarker(new Range(pos.row,pos.column,pos.row,pos.column+_self.length),className,null,!1)};updateMarker(this.pos,this.mainClass);for(var i=this.others.length;i--;)updateMarker(this.others[i],this.othersClass)}},this.onCursorChange=function(event){if(!this.$updating&&this.session){var pos=this.session.selection.getCursor();pos.row===this.pos.row&&pos.column>=this.pos.column&&pos.column<=this.pos.column+this.length?(this.showOtherMarkers(),this._emit("cursorEnter",event)):(this.hideOtherMarkers(),this._emit("cursorLeave",event))}},this.detach=function(){this.session.removeMarker(this.pos&&this.pos.markerId),this.hideOtherMarkers(),this.doc.removeEventListener("change",this.$onUpdate),this.session.selection.removeEventListener("changeCursor",this.$onCursorChange),this.session.setUndoSelect(!0),this.session=null},this.cancel=function(){if(-1!==this.$undoStackDepth){for(var undoManager=this.session.getUndoManager(),undosRequired=(undoManager.$undoStack||undoManager.$undostack).length-this.$undoStackDepth,i=0;i<undosRequired;i++)undoManager.undo(!0);this.selectionBefore&&this.session.selection.fromJSON(this.selectionBefore)}}}).call(PlaceHolder.prototype),exports.PlaceHolder=PlaceHolder})),ace.define("ace/mouse/multi_select_handler",["require","exports","module","ace/lib/event","ace/lib/useragent"],(function(acequire,exports,module){var event=acequire("../lib/event"),useragent=acequire("../lib/useragent");function isSamePoint(p1,p2){return p1.row==p2.row&&p1.column==p2.column}exports.onMouseDown=function(e){var ev=e.domEvent,alt=ev.altKey,shift=ev.shiftKey,ctrl=ev.ctrlKey,accel=e.getAccelKey(),button=e.getButton();if(ctrl&&useragent.isMac&&(button=ev.button),e.editor.inMultiSelectMode&&2==button)e.editor.textInput.onContextMenu(e.domEvent);else if(ctrl||alt||accel){if(0===button){var selectionMode,editor=e.editor,selection=editor.selection,isMultiSelect=editor.inMultiSelectMode,pos=e.getDocumentPosition(),cursor=selection.getCursor(),inSelection=e.inSelection()||selection.isEmpty()&&isSamePoint(pos,cursor),mouseX=e.x,mouseY=e.y,session=editor.session,screenAnchor=editor.renderer.pixelToScreenCoordinates(mouseX,mouseY),screenCursor=screenAnchor;if(editor.$mouseHandler.$enableJumpToDef)ctrl&&alt||accel&&alt?selectionMode=shift?"block":"add":alt&&editor.$blockSelectEnabled&&(selectionMode="block");else if(accel&&!alt){if(selectionMode="add",!isMultiSelect&&shift)return}else alt&&editor.$blockSelectEnabled&&(selectionMode="block");if(selectionMode&&useragent.isMac&&ev.ctrlKey&&editor.$mouseHandler.cancelContextMenu(),"add"==selectionMode){if(!isMultiSelect&&inSelection)return;if(!isMultiSelect){var range=selection.toOrientedRange();editor.addSelectionMarker(range)}var oldRange=selection.rangeList.rangeAtPoint(pos);editor.$blockScrolling++,editor.inVirtualSelectionMode=!0,shift&&(oldRange=null,range=selection.ranges[0]||range,editor.removeSelectionMarker(range)),editor.once("mouseup",(function(){var tmpSel=selection.toOrientedRange();oldRange&&tmpSel.isEmpty()&&isSamePoint(oldRange.cursor,tmpSel.cursor)?selection.substractPoint(tmpSel.cursor):(shift?selection.substractPoint(range.cursor):range&&(editor.removeSelectionMarker(range),selection.addRange(range)),selection.addRange(tmpSel)),editor.$blockScrolling--,editor.inVirtualSelectionMode=!1}))}else if("block"==selectionMode){var initialRange;e.stop(),editor.inVirtualSelectionMode=!0;var rectSel=[];editor.$blockScrolling++,isMultiSelect&&!accel?selection.toSingleRange():!isMultiSelect&&accel&&(initialRange=selection.toOrientedRange(),editor.addSelectionMarker(initialRange)),shift?screenAnchor=session.documentToScreenPosition(selection.lead):selection.moveToPosition(pos),editor.$blockScrolling--,screenCursor={row:-1,column:-1};var onSelectionInterval=function(){var newCursor=editor.renderer.pixelToScreenCoordinates(mouseX,mouseY),cursor=session.screenToDocumentPosition(newCursor.row,newCursor.column,newCursor.offsetX);isSamePoint(screenCursor,newCursor)&&isSamePoint(cursor,selection.lead)||(screenCursor=newCursor,editor.$blockScrolling++,editor.selection.moveToPosition(cursor),editor.renderer.scrollCursorIntoView(),editor.removeSelectionMarkers(rectSel),rectSel=selection.rectangularRangeBlock(screenCursor,screenAnchor),editor.$mouseHandler.$clickSelection&&1==rectSel.length&&rectSel[0].isEmpty()&&(rectSel[0]=editor.$mouseHandler.$clickSelection.clone()),rectSel.forEach(editor.addSelectionMarker,editor),editor.updateSelectionMarkers(),editor.$blockScrolling--)};event.capture(editor.container,(function(e){mouseX=e.clientX,mouseY=e.clientY}),(function(e){clearInterval(timerId),editor.removeSelectionMarkers(rectSel),rectSel.length||(rectSel=[selection.toOrientedRange()]),editor.$blockScrolling++,initialRange&&(editor.removeSelectionMarker(initialRange),selection.toSingleRange(initialRange));for(var i=0;i<rectSel.length;i++)selection.addRange(rectSel[i]);editor.inVirtualSelectionMode=!1,editor.$mouseHandler.$clickSelection=null,editor.$blockScrolling--}));var timerId=setInterval((function(){onSelectionInterval()}),20);return e.preventDefault()}}}else 0===button&&e.editor.inMultiSelectMode&&e.editor.exitMultiSelectMode()}})),ace.define("ace/commands/multi_select_commands",["require","exports","module","ace/keyboard/hash_handler"],(function(acequire,exports,module){exports.defaultCommands=[{name:"addCursorAbove",exec:function(editor){editor.selectMoreLines(-1)},bindKey:{win:"Ctrl-Alt-Up",mac:"Ctrl-Alt-Up"},scrollIntoView:"cursor",readOnly:!0},{name:"addCursorBelow",exec:function(editor){editor.selectMoreLines(1)},bindKey:{win:"Ctrl-Alt-Down",mac:"Ctrl-Alt-Down"},scrollIntoView:"cursor",readOnly:!0},{name:"addCursorAboveSkipCurrent",exec:function(editor){editor.selectMoreLines(-1,!0)},bindKey:{win:"Ctrl-Alt-Shift-Up",mac:"Ctrl-Alt-Shift-Up"},scrollIntoView:"cursor",readOnly:!0},{name:"addCursorBelowSkipCurrent",exec:function(editor){editor.selectMoreLines(1,!0)},bindKey:{win:"Ctrl-Alt-Shift-Down",mac:"Ctrl-Alt-Shift-Down"},scrollIntoView:"cursor",readOnly:!0},{name:"selectMoreBefore",exec:function(editor){editor.selectMore(-1)},bindKey:{win:"Ctrl-Alt-Left",mac:"Ctrl-Alt-Left"},scrollIntoView:"cursor",readOnly:!0},{name:"selectMoreAfter",exec:function(editor){editor.selectMore(1)},bindKey:{win:"Ctrl-Alt-Right",mac:"Ctrl-Alt-Right"},scrollIntoView:"cursor",readOnly:!0},{name:"selectNextBefore",exec:function(editor){editor.selectMore(-1,!0)},bindKey:{win:"Ctrl-Alt-Shift-Left",mac:"Ctrl-Alt-Shift-Left"},scrollIntoView:"cursor",readOnly:!0},{name:"selectNextAfter",exec:function(editor){editor.selectMore(1,!0)},bindKey:{win:"Ctrl-Alt-Shift-Right",mac:"Ctrl-Alt-Shift-Right"},scrollIntoView:"cursor",readOnly:!0},{name:"splitIntoLines",exec:function(editor){editor.multiSelect.splitIntoLines()},bindKey:{win:"Ctrl-Alt-L",mac:"Ctrl-Alt-L"},readOnly:!0},{name:"alignCursors",exec:function(editor){editor.alignCursors()},bindKey:{win:"Ctrl-Alt-A",mac:"Ctrl-Alt-A"},scrollIntoView:"cursor"},{name:"findAll",exec:function(editor){editor.findAll()},bindKey:{win:"Ctrl-Alt-K",mac:"Ctrl-Alt-G"},scrollIntoView:"cursor",readOnly:!0}],exports.multiSelectCommands=[{name:"singleSelection",bindKey:"esc",exec:function(editor){editor.exitMultiSelectMode()},scrollIntoView:"cursor",readOnly:!0,isAvailable:function(editor){return editor&&editor.inMultiSelectMode}}];var HashHandler=acequire("../keyboard/hash_handler").HashHandler;exports.keyboardHandler=new HashHandler(exports.multiSelectCommands)})),ace.define("ace/multi_select",["require","exports","module","ace/range_list","ace/range","ace/selection","ace/mouse/multi_select_handler","ace/lib/event","ace/lib/lang","ace/commands/multi_select_commands","ace/search","ace/edit_session","ace/editor","ace/config"],(function(acequire,exports,module){var RangeList=acequire("./range_list").RangeList,Range=acequire("./range").Range,Selection=acequire("./selection").Selection,onMouseDown=acequire("./mouse/multi_select_handler").onMouseDown,event=acequire("./lib/event"),lang=acequire("./lib/lang"),commands=acequire("./commands/multi_select_commands");exports.commands=commands.defaultCommands.concat(commands.multiSelectCommands);var search=new(0,acequire("./search").Search);var EditSession=acequire("./edit_session").EditSession;(function(){this.getSelectionMarkers=function(){return this.$selectionMarkers}}).call(EditSession.prototype),function(){this.ranges=null,this.rangeList=null,this.addRange=function(range,$blockChangeEvents){if(range){if(!this.inMultiSelectMode&&0===this.rangeCount){var oldRange=this.toOrientedRange();if(this.rangeList.add(oldRange),this.rangeList.add(range),2!=this.rangeList.ranges.length)return this.rangeList.removeAll(),$blockChangeEvents||this.fromOrientedRange(range);this.rangeList.removeAll(),this.rangeList.add(oldRange),this.$onAddRange(oldRange)}range.cursor||(range.cursor=range.end);var removed=this.rangeList.add(range);return this.$onAddRange(range),removed.length&&this.$onRemoveRange(removed),this.rangeCount>1&&!this.inMultiSelectMode&&(this._signal("multiSelect"),this.inMultiSelectMode=!0,this.session.$undoSelect=!1,this.rangeList.attach(this.session)),$blockChangeEvents||this.fromOrientedRange(range)}},this.toSingleRange=function(range){range=range||this.ranges[0];var removed=this.rangeList.removeAll();removed.length&&this.$onRemoveRange(removed),range&&this.fromOrientedRange(range)},this.substractPoint=function(pos){var removed=this.rangeList.substractPoint(pos);if(removed)return this.$onRemoveRange(removed),removed[0]},this.mergeOverlappingRanges=function(){var removed=this.rangeList.merge();removed.length?this.$onRemoveRange(removed):this.ranges[0]&&this.fromOrientedRange(this.ranges[0])},this.$onAddRange=function(range){this.rangeCount=this.rangeList.ranges.length,this.ranges.unshift(range),this._signal("addRange",{range:range})},this.$onRemoveRange=function(removed){if(this.rangeCount=this.rangeList.ranges.length,1==this.rangeCount&&this.inMultiSelectMode){var lastRange=this.rangeList.ranges.pop();removed.push(lastRange),this.rangeCount=0}for(var i=removed.length;i--;){var index=this.ranges.indexOf(removed[i]);this.ranges.splice(index,1)}this._signal("removeRange",{ranges:removed}),0===this.rangeCount&&this.inMultiSelectMode&&(this.inMultiSelectMode=!1,this._signal("singleSelect"),this.session.$undoSelect=!0,this.rangeList.detach(this.session)),(lastRange=lastRange||this.ranges[0])&&!lastRange.isEqual(this.getRange())&&this.fromOrientedRange(lastRange)},this.$initRangeList=function(){this.rangeList||(this.rangeList=new RangeList,this.ranges=[],this.rangeCount=0)},this.getAllRanges=function(){return this.rangeCount?this.rangeList.ranges.concat():[this.getRange()]},this.splitIntoLines=function(){if(this.rangeCount>1){var ranges=this.rangeList.ranges,lastRange=ranges[ranges.length-1],range=Range.fromPoints(ranges[0].start,lastRange.end);this.toSingleRange(),this.setSelectionRange(range,lastRange.cursor==lastRange.start)}else{range=this.getRange();var isBackwards=this.isBackwards(),startRow=range.start.row,endRow=range.end.row;if(startRow==endRow){if(isBackwards)var start=range.end,end=range.start;else start=range.start,end=range.end;return this.addRange(Range.fromPoints(end,end)),void this.addRange(Range.fromPoints(start,start))}var rectSel=[],r=this.getLineRange(startRow,!0);r.start.column=range.start.column,rectSel.push(r);for(var i=startRow+1;i<endRow;i++)rectSel.push(this.getLineRange(i,!0));(r=this.getLineRange(endRow,!0)).end.column=range.end.column,rectSel.push(r),rectSel.forEach(this.addRange,this)}},this.toggleBlockSelection=function(){if(this.rangeCount>1){var ranges=this.rangeList.ranges,lastRange=ranges[ranges.length-1],range=Range.fromPoints(ranges[0].start,lastRange.end);this.toSingleRange(),this.setSelectionRange(range,lastRange.cursor==lastRange.start)}else{var cursor=this.session.documentToScreenPosition(this.selectionLead),anchor=this.session.documentToScreenPosition(this.selectionAnchor);this.rectangularRangeBlock(cursor,anchor).forEach(this.addRange,this)}},this.rectangularRangeBlock=function(screenCursor,screenAnchor,includeEmptyLines){var rectSel=[],xBackwards=screenCursor.column<screenAnchor.column;if(xBackwards)var startColumn=screenCursor.column,endColumn=screenAnchor.column,startOffsetX=screenCursor.offsetX,endOffsetX=screenAnchor.offsetX;else startColumn=screenAnchor.column,endColumn=screenCursor.column,startOffsetX=screenAnchor.offsetX,endOffsetX=screenCursor.offsetX;var p1,p2,yBackwards=screenCursor.row<screenAnchor.row;if(yBackwards)var startRow=screenCursor.row,endRow=screenAnchor.row;else startRow=screenAnchor.row,endRow=screenCursor.row;startColumn<0&&(startColumn=0),startRow<0&&(startRow=0),startRow==endRow&&(includeEmptyLines=!0);for(var row=startRow;row<=endRow;row++){var range=Range.fromPoints(this.session.screenToDocumentPosition(row,startColumn,startOffsetX),this.session.screenToDocumentPosition(row,endColumn,endOffsetX));if(range.isEmpty()){if(docEnd&&(p1=range.end,p2=docEnd,p1.row==p2.row&&p1.column==p2.column))break;var docEnd=range.end}range.cursor=xBackwards?range.start:range.end,rectSel.push(range)}if(yBackwards&&rectSel.reverse(),!includeEmptyLines){for(var end=rectSel.length-1;rectSel[end].isEmpty()&&end>0;)end--;if(end>0)for(var start=0;rectSel[start].isEmpty();)start++;for(var i=end;i>=start;i--)rectSel[i].isEmpty()&&rectSel.splice(i,1)}return rectSel}}.call(Selection.prototype);var Editor=acequire("./editor").Editor;function MultiSelect(editor){editor.$multiselectOnSessionChange||(editor.$onAddRange=editor.$onAddRange.bind(editor),editor.$onRemoveRange=editor.$onRemoveRange.bind(editor),editor.$onMultiSelect=editor.$onMultiSelect.bind(editor),editor.$onSingleSelect=editor.$onSingleSelect.bind(editor),editor.$multiselectOnSessionChange=exports.onSessionChange.bind(editor),editor.$checkMultiselectChange=editor.$checkMultiselectChange.bind(editor),editor.$multiselectOnSessionChange(editor),editor.on("changeSession",editor.$multiselectOnSessionChange),editor.on("mousedown",onMouseDown),editor.commands.addCommands(commands.defaultCommands),function(editor){var el=editor.textInput.getElement(),altCursor=!1;function reset(e){altCursor&&(editor.renderer.setMouseCursor(""),altCursor=!1)}event.addListener(el,"keydown",(function(e){var altDown=18==e.keyCode&&!(e.ctrlKey||e.shiftKey||e.metaKey);editor.$blockSelectEnabled&&altDown?altCursor||(editor.renderer.setMouseCursor("crosshair"),altCursor=!0):altCursor&&reset()})),event.addListener(el,"keyup",reset),event.addListener(el,"blur",reset)}(editor))}(function(){this.updateSelectionMarkers=function(){this.renderer.updateCursor(),this.renderer.updateBackMarkers()},this.addSelectionMarker=function(orientedRange){orientedRange.cursor||(orientedRange.cursor=orientedRange.end);var style=this.getSelectionStyle();return orientedRange.marker=this.session.addMarker(orientedRange,"ace_selection",style),this.session.$selectionMarkers.push(orientedRange),this.session.selectionMarkerCount=this.session.$selectionMarkers.length,orientedRange},this.removeSelectionMarker=function(range){if(range.marker){this.session.removeMarker(range.marker);var index=this.session.$selectionMarkers.indexOf(range);-1!=index&&this.session.$selectionMarkers.splice(index,1),this.session.selectionMarkerCount=this.session.$selectionMarkers.length}},this.removeSelectionMarkers=function(ranges){for(var markerList=this.session.$selectionMarkers,i=ranges.length;i--;){var range=ranges[i];if(range.marker){this.session.removeMarker(range.marker);var index=markerList.indexOf(range);-1!=index&&markerList.splice(index,1)}}this.session.selectionMarkerCount=markerList.length},this.$onAddRange=function(e){this.addSelectionMarker(e.range),this.renderer.updateCursor(),this.renderer.updateBackMarkers()},this.$onRemoveRange=function(e){this.removeSelectionMarkers(e.ranges),this.renderer.updateCursor(),this.renderer.updateBackMarkers()},this.$onMultiSelect=function(e){this.inMultiSelectMode||(this.inMultiSelectMode=!0,this.setStyle("ace_multiselect"),this.keyBinding.addKeyboardHandler(commands.keyboardHandler),this.commands.setDefaultHandler("exec",this.$onMultiSelectExec),this.renderer.updateCursor(),this.renderer.updateBackMarkers())},this.$onSingleSelect=function(e){this.session.multiSelect.inVirtualMode||(this.inMultiSelectMode=!1,this.unsetStyle("ace_multiselect"),this.keyBinding.removeKeyboardHandler(commands.keyboardHandler),this.commands.removeDefaultHandler("exec",this.$onMultiSelectExec),this.renderer.updateCursor(),this.renderer.updateBackMarkers(),this._emit("changeSelection"))},this.$onMultiSelectExec=function(e){var command=e.command,editor=e.editor;if(editor.multiSelect){if(command.multiSelectAction)"forEach"==command.multiSelectAction?result=editor.forEachSelection(command,e.args):"forEachLine"==command.multiSelectAction?result=editor.forEachSelection(command,e.args,!0):"single"==command.multiSelectAction?(editor.exitMultiSelectMode(),result=command.exec(editor,e.args||{})):result=command.multiSelectAction(editor,e.args||{});else{var result=command.exec(editor,e.args||{});editor.multiSelect.addRange(editor.multiSelect.toOrientedRange()),editor.multiSelect.mergeOverlappingRanges()}return result}},this.forEachSelection=function(cmd,args,options){if(!this.inVirtualSelectionMode){var result,keepOrder=options&&options.keepOrder,$byLines=1==options||options&&options.$byLines,session=this.session,selection=this.selection,rangeList=selection.rangeList,ranges=(keepOrder?selection:rangeList).ranges;if(!ranges.length)return cmd.exec?cmd.exec(this,args||{}):cmd(this,args||{});var reg=selection._eventRegistry;selection._eventRegistry={};var tmpSel=new Selection(session);this.inVirtualSelectionMode=!0;for(var i=ranges.length;i--;){if($byLines)for(;i>0&&ranges[i].start.row==ranges[i-1].end.row;)i--;tmpSel.fromOrientedRange(ranges[i]),tmpSel.index=i,this.selection=session.selection=tmpSel;var cmdResult=cmd.exec?cmd.exec(this,args||{}):cmd(this,args||{});result||void 0===cmdResult||(result=cmdResult),tmpSel.toOrientedRange(ranges[i])}tmpSel.detach(),this.selection=session.selection=selection,this.inVirtualSelectionMode=!1,selection._eventRegistry=reg,selection.mergeOverlappingRanges();var anim=this.renderer.$scrollAnimation;return this.onCursorChange(),this.onSelectionChange(),anim&&anim.from==anim.to&&this.renderer.animateScrolling(anim.from),result}},this.exitMultiSelectMode=function(){this.inMultiSelectMode&&!this.inVirtualSelectionMode&&this.multiSelect.toSingleRange()},this.getSelectedText=function(){var text="";if(this.inMultiSelectMode&&!this.inVirtualSelectionMode){for(var ranges=this.multiSelect.rangeList.ranges,buf=[],i=0;i<ranges.length;i++)buf.push(this.session.getTextRange(ranges[i]));var nl=this.session.getDocument().getNewLineCharacter();(text=buf.join(nl)).length==(buf.length-1)*nl.length&&(text="")}else this.selection.isEmpty()||(text=this.session.getTextRange(this.getSelectionRange()));return text},this.$checkMultiselectChange=function(e,anchor){if(this.inMultiSelectMode&&!this.inVirtualSelectionMode){var range=this.multiSelect.ranges[0];if(this.multiSelect.isEmpty()&&anchor==this.multiSelect.anchor)return;var pos=anchor==this.multiSelect.anchor?range.cursor==range.start?range.end:range.start:range.cursor;pos.row==anchor.row&&this.session.$clipPositionToDocument(pos.row,pos.column).column==anchor.column||this.multiSelect.toSingleRange(this.multiSelect.toOrientedRange())}},this.findAll=function(needle,options,additive){if((options=options||{}).needle=needle||options.needle,null==options.needle){var range=this.selection.isEmpty()?this.selection.getWordRange():this.selection.getRange();options.needle=this.session.getTextRange(range)}this.$search.set(options);var ranges=this.$search.findAll(this.session);if(!ranges.length)return 0;this.$blockScrolling+=1;var selection=this.multiSelect;additive||selection.toSingleRange(ranges[0]);for(var i=ranges.length;i--;)selection.addRange(ranges[i],!0);return range&&selection.rangeList.rangeAtPoint(range.start)&&selection.addRange(range,!0),this.$blockScrolling-=1,ranges.length},this.selectMoreLines=function(dir,skip){var range=this.selection.toOrientedRange(),isBackwards=range.cursor==range.end,screenLead=this.session.documentToScreenPosition(range.cursor);this.selection.$desiredColumn&&(screenLead.column=this.selection.$desiredColumn);var newRange,lead=this.session.screenToDocumentPosition(screenLead.row+dir,screenLead.column);if(range.isEmpty())anchor=lead;else var screenAnchor=this.session.documentToScreenPosition(isBackwards?range.end:range.start),anchor=this.session.screenToDocumentPosition(screenAnchor.row+dir,screenAnchor.column);isBackwards?(newRange=Range.fromPoints(lead,anchor)).cursor=newRange.start:(newRange=Range.fromPoints(anchor,lead)).cursor=newRange.end;if(newRange.desiredColumn=screenLead.column,this.selection.inMultiSelectMode){if(skip)var toRemove=range.cursor}else this.selection.addRange(range);this.selection.addRange(newRange),toRemove&&this.selection.substractPoint(toRemove)},this.transposeSelections=function(dir){for(var session=this.session,sel=session.multiSelect,all=sel.ranges,i=all.length;i--;){if((range=all[i]).isEmpty()){var tmp=session.getWordRange(range.start.row,range.start.column);range.start.row=tmp.start.row,range.start.column=tmp.start.column,range.end.row=tmp.end.row,range.end.column=tmp.end.column}}sel.mergeOverlappingRanges();var words=[];for(i=all.length;i--;){var range=all[i];words.unshift(session.getTextRange(range))}dir<0?words.unshift(words.pop()):words.push(words.shift());for(i=all.length;i--;){tmp=(range=all[i]).clone();session.replace(range,words[i]),range.start.row=tmp.start.row,range.start.column=tmp.start.column}},this.selectMore=function(dir,skip,stopAtFirst){var session=this.session,range=session.multiSelect.toOrientedRange();if(!range.isEmpty()||((range=session.getWordRange(range.start.row,range.start.column)).cursor=-1==dir?range.start:range.end,this.multiSelect.addRange(range),!stopAtFirst)){var needle=session.getTextRange(range),newRange=function(session,needle,dir){return search.$options.wrap=!0,search.$options.needle=needle,search.$options.backwards=-1==dir,search.find(session)}(session,needle,dir);newRange&&(newRange.cursor=-1==dir?newRange.start:newRange.end,this.$blockScrolling+=1,this.session.unfold(newRange),this.multiSelect.addRange(newRange),this.$blockScrolling-=1,this.renderer.scrollCursorIntoView(null,.5)),skip&&this.multiSelect.substractPoint(range.cursor)}},this.alignCursors=function(){var session=this.session,sel=session.multiSelect,ranges=sel.ranges,row=-1,sameRowRanges=ranges.filter((function(r){if(r.cursor.row==row)return!0;row=r.cursor.row}));if(ranges.length&&sameRowRanges.length!=ranges.length-1){sameRowRanges.forEach((function(r){sel.substractPoint(r.cursor)}));var maxCol=0,minSpace=1/0,spaceOffsets=ranges.map((function(r){var p=r.cursor,spaceOffset=session.getLine(p.row).substr(p.column).search(/\S/g);return-1==spaceOffset&&(spaceOffset=0),p.column>maxCol&&(maxCol=p.column),spaceOffset<minSpace&&(minSpace=spaceOffset),spaceOffset}));ranges.forEach((function(r,i){var p=r.cursor,l=maxCol-p.column,d=spaceOffsets[i]-minSpace;l>d?session.insert(p,lang.stringRepeat(" ",l-d)):session.remove(new Range(p.row,p.column,p.row,p.column-l+d)),r.start.column=r.end.column=maxCol,r.start.row=r.end.row=p.row,r.cursor=r.end})),sel.fromOrientedRange(ranges[0]),this.renderer.updateCursor(),this.renderer.updateBackMarkers()}else{var range=this.selection.getRange(),fr=range.start.row,lr=range.end.row,guessRange=fr==lr;if(guessRange){var line,max=this.session.getLength();do{line=this.session.getLine(lr)}while(/[=:]/.test(line)&&++lr<max);do{line=this.session.getLine(fr)}while(/[=:]/.test(line)&&--fr>0);fr<0&&(fr=0),lr>=max&&(lr=max-1)}var lines=this.session.removeFullLines(fr,lr);lines=this.$reAlignText(lines,guessRange),this.session.insert({row:fr,column:0},lines.join("\n")+"\n"),guessRange||(range.start.column=0,range.end.column=lines[lines.length-1].length),this.selection.setRange(range)}},this.$reAlignText=function(lines,forceLeft){var startW,textW,endW,isLeftAligned=!0,isRightAligned=!0;return lines.map((function(line){var m=line.match(/(\s*)(.*?)(\s*)([=:].*)/);return m?null==startW?(startW=m[1].length,textW=m[2].length,endW=m[3].length,m):(startW+textW+endW!=m[1].length+m[2].length+m[3].length&&(isRightAligned=!1),startW!=m[1].length&&(isLeftAligned=!1),startW>m[1].length&&(startW=m[1].length),textW<m[2].length&&(textW=m[2].length),endW>m[3].length&&(endW=m[3].length),m):[line]})).map(forceLeft?alignLeft:isLeftAligned?isRightAligned?function(m){return m[2]?spaces(startW+textW-m[2].length)+m[2]+spaces(endW)+m[4].replace(/^([=:])\s+/,"$1 "):m[0]}:alignLeft:function(m){return m[2]?spaces(startW)+m[2]+spaces(endW)+m[4].replace(/^([=:])\s+/,"$1 "):m[0]});function spaces(n){return lang.stringRepeat(" ",n)}function alignLeft(m){return m[2]?spaces(startW)+m[2]+spaces(textW-m[2].length+endW)+m[4].replace(/^([=:])\s+/,"$1 "):m[0]}}}).call(Editor.prototype),exports.onSessionChange=function(e){var session=e.session;session&&!session.multiSelect&&(session.$selectionMarkers=[],session.selection.$initRangeList(),session.multiSelect=session.selection),this.multiSelect=session&&session.multiSelect;var oldSession=e.oldSession;oldSession&&(oldSession.multiSelect.off("addRange",this.$onAddRange),oldSession.multiSelect.off("removeRange",this.$onRemoveRange),oldSession.multiSelect.off("multiSelect",this.$onMultiSelect),oldSession.multiSelect.off("singleSelect",this.$onSingleSelect),oldSession.multiSelect.lead.off("change",this.$checkMultiselectChange),oldSession.multiSelect.anchor.off("change",this.$checkMultiselectChange)),session&&(session.multiSelect.on("addRange",this.$onAddRange),session.multiSelect.on("removeRange",this.$onRemoveRange),session.multiSelect.on("multiSelect",this.$onMultiSelect),session.multiSelect.on("singleSelect",this.$onSingleSelect),session.multiSelect.lead.on("change",this.$checkMultiselectChange),session.multiSelect.anchor.on("change",this.$checkMultiselectChange)),session&&this.inMultiSelectMode!=session.selection.inMultiSelectMode&&(session.selection.inMultiSelectMode?this.$onMultiSelect():this.$onSingleSelect())},exports.MultiSelect=MultiSelect,acequire("./config").defineOptions(Editor.prototype,"editor",{enableMultiselect:{set:function(val){MultiSelect(this),val?(this.on("changeSession",this.$multiselectOnSessionChange),this.on("mousedown",onMouseDown)):(this.off("changeSession",this.$multiselectOnSessionChange),this.off("mousedown",onMouseDown))},value:!0},enableBlockSelect:{set:function(val){this.$blockSelectEnabled=val},value:!0}})})),ace.define("ace/mode/folding/fold_mode",["require","exports","module","ace/range"],(function(acequire,exports,module){"use strict";var Range=acequire("../../range").Range,FoldMode=exports.FoldMode=function(){};(function(){this.foldingStartMarker=null,this.foldingStopMarker=null,this.getFoldWidget=function(session,foldStyle,row){var line=session.getLine(row);return this.foldingStartMarker.test(line)?"start":"markbeginend"==foldStyle&&this.foldingStopMarker&&this.foldingStopMarker.test(line)?"end":""},this.getFoldWidgetRange=function(session,foldStyle,row){return null},this.indentationBlock=function(session,row,column){var re=/\S/,line=session.getLine(row),startLevel=line.search(re);if(-1!=startLevel){for(var startColumn=column||line.length,maxRow=session.getLength(),startRow=row,endRow=row;++row<maxRow;){var level=session.getLine(row).search(re);if(-1!=level){if(level<=startLevel)break;endRow=row}}if(endRow>startRow){var endColumn=session.getLine(endRow).length;return new Range(startRow,startColumn,endRow,endColumn)}}},this.openingBracketBlock=function(session,bracket,row,column,typeRe){var start={row:row,column:column+1},end=session.$findClosingBracket(bracket,start,typeRe);if(end){var fw=session.foldWidgets[end.row];return null==fw&&(fw=session.getFoldWidget(end.row)),"start"==fw&&end.row>start.row&&(end.row--,end.column=session.getLine(end.row).length),Range.fromPoints(start,end)}},this.closingBracketBlock=function(session,bracket,row,column,typeRe){var end={row:row,column:column},start=session.$findOpeningBracket(bracket,end);if(start)return start.column++,end.column--,Range.fromPoints(start,end)}}).call(FoldMode.prototype)})),ace.define("ace/theme/textmate",["require","exports","module","ace/lib/dom"],(function(acequire,exports,module){"use strict";exports.isDark=!1,exports.cssClass="ace-tm",exports.cssText='.ace-tm .ace_gutter {background: #f0f0f0;color: #333;}.ace-tm .ace_print-margin {width: 1px;background: #e8e8e8;}.ace-tm .ace_fold {background-color: #6B72E6;}.ace-tm {background-color: #FFFFFF;color: black;}.ace-tm .ace_cursor {color: black;}.ace-tm .ace_invisible {color: rgb(191, 191, 191);}.ace-tm .ace_storage,.ace-tm .ace_keyword {color: blue;}.ace-tm .ace_constant {color: rgb(197, 6, 11);}.ace-tm .ace_constant.ace_buildin {color: rgb(88, 72, 246);}.ace-tm .ace_constant.ace_language {color: rgb(88, 92, 246);}.ace-tm .ace_constant.ace_library {color: rgb(6, 150, 14);}.ace-tm .ace_invalid {background-color: rgba(255, 0, 0, 0.1);color: red;}.ace-tm .ace_support.ace_function {color: rgb(60, 76, 114);}.ace-tm .ace_support.ace_constant {color: rgb(6, 150, 14);}.ace-tm .ace_support.ace_type,.ace-tm .ace_support.ace_class {color: rgb(109, 121, 222);}.ace-tm .ace_keyword.ace_operator {color: rgb(104, 118, 135);}.ace-tm .ace_string {color: rgb(3, 106, 7);}.ace-tm .ace_comment {color: rgb(76, 136, 107);}.ace-tm .ace_comment.ace_doc {color: rgb(0, 102, 255);}.ace-tm .ace_comment.ace_doc.ace_tag {color: rgb(128, 159, 191);}.ace-tm .ace_constant.ace_numeric {color: rgb(0, 0, 205);}.ace-tm .ace_variable {color: rgb(49, 132, 149);}.ace-tm .ace_xml-pe {color: rgb(104, 104, 91);}.ace-tm .ace_entity.ace_name.ace_function {color: #0000A2;}.ace-tm .ace_heading {color: rgb(12, 7, 255);}.ace-tm .ace_list {color:rgb(185, 6, 144);}.ace-tm .ace_meta.ace_tag {color:rgb(0, 22, 142);}.ace-tm .ace_string.ace_regex {color: rgb(255, 0, 0)}.ace-tm .ace_marker-layer .ace_selection {background: rgb(181, 213, 255);}.ace-tm.ace_multiselect .ace_selection.ace_start {box-shadow: 0 0 3px 0px white;}.ace-tm .ace_marker-layer .ace_step {background: rgb(252, 255, 0);}.ace-tm .ace_marker-layer .ace_stack {background: rgb(164, 229, 101);}.ace-tm .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid rgb(192, 192, 192);}.ace-tm .ace_marker-layer .ace_active-line {background: rgba(0, 0, 0, 0.07);}.ace-tm .ace_gutter-active-line {background-color : #dcdcdc;}.ace-tm .ace_marker-layer .ace_selected-word {background: rgb(250, 250, 255);border: 1px solid rgb(200, 200, 250);}.ace-tm .ace_indent-guide {background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") right repeat-y;}',acequire("../lib/dom").importCssString(exports.cssText,exports.cssClass)})),ace.define("ace/line_widgets",["require","exports","module","ace/lib/oop","ace/lib/dom","ace/range"],(function(acequire,exports,module){"use strict";acequire("./lib/oop");var dom=acequire("./lib/dom");acequire("./range").Range;function LineWidgets(session){this.session=session,this.session.widgetManager=this,this.session.getRowLength=this.getRowLength,this.session.$getWidgetScreenLength=this.$getWidgetScreenLength,this.updateOnChange=this.updateOnChange.bind(this),this.renderWidgets=this.renderWidgets.bind(this),this.measureWidgets=this.measureWidgets.bind(this),this.session._changedWidgets=[],this.$onChangeEditor=this.$onChangeEditor.bind(this),this.session.on("change",this.updateOnChange),this.session.on("changeFold",this.updateOnFold),this.session.on("changeEditor",this.$onChangeEditor)}(function(){this.getRowLength=function(row){var h;return h=this.lineWidgets&&this.lineWidgets[row]&&this.lineWidgets[row].rowCount||0,this.$useWrapMode&&this.$wrapData[row]?this.$wrapData[row].length+1+h:1+h},this.$getWidgetScreenLength=function(){var screenRows=0;return this.lineWidgets.forEach((function(w){w&&w.rowCount&&!w.hidden&&(screenRows+=w.rowCount)})),screenRows},this.$onChangeEditor=function(e){this.attach(e.editor)},this.attach=function(editor){editor&&editor.widgetManager&&editor.widgetManager!=this&&editor.widgetManager.detach(),this.editor!=editor&&(this.detach(),this.editor=editor,editor&&(editor.widgetManager=this,editor.renderer.on("beforeRender",this.measureWidgets),editor.renderer.on("afterRender",this.renderWidgets)))},this.detach=function(e){var editor=this.editor;if(editor){this.editor=null,editor.widgetManager=null,editor.renderer.off("beforeRender",this.measureWidgets),editor.renderer.off("afterRender",this.renderWidgets);var lineWidgets=this.session.lineWidgets;lineWidgets&&lineWidgets.forEach((function(w){w&&w.el&&w.el.parentNode&&(w._inDocument=!1,w.el.parentNode.removeChild(w.el))}))}},this.updateOnFold=function(e,session){var lineWidgets=session.lineWidgets;if(lineWidgets&&e.action){for(var fold=e.data,start=fold.start.row,end=fold.end.row,hide="add"==e.action,i=start+1;i<end;i++)lineWidgets[i]&&(lineWidgets[i].hidden=hide);lineWidgets[end]&&(hide?lineWidgets[start]?lineWidgets[end].hidden=hide:lineWidgets[start]=lineWidgets[end]:(lineWidgets[start]==lineWidgets[end]&&(lineWidgets[start]=void 0),lineWidgets[end].hidden=hide))}},this.updateOnChange=function(delta){var lineWidgets=this.session.lineWidgets;if(lineWidgets){var startRow=delta.start.row,len=delta.end.row-startRow;if(0===len);else if("remove"==delta.action){lineWidgets.splice(startRow+1,len).forEach((function(w){w&&this.removeLineWidget(w)}),this),this.$updateRows()}else{var args=new Array(len);args.unshift(startRow,0),lineWidgets.splice.apply(lineWidgets,args),this.$updateRows()}}},this.$updateRows=function(){var lineWidgets=this.session.lineWidgets;if(lineWidgets){var noWidgets=!0;lineWidgets.forEach((function(w,i){if(w)for(noWidgets=!1,w.row=i;w.$oldWidget;)w.$oldWidget.row=i,w=w.$oldWidget})),noWidgets&&(this.session.lineWidgets=null)}},this.addLineWidget=function(w){this.session.lineWidgets||(this.session.lineWidgets=new Array(this.session.getLength()));var old=this.session.lineWidgets[w.row];old&&(w.$oldWidget=old,old.el&&old.el.parentNode&&(old.el.parentNode.removeChild(old.el),old._inDocument=!1)),this.session.lineWidgets[w.row]=w,w.session=this.session;var renderer=this.editor.renderer;w.html&&!w.el&&(w.el=dom.createElement("div"),w.el.innerHTML=w.html),w.el&&(dom.addCssClass(w.el,"ace_lineWidgetContainer"),w.el.style.position="absolute",w.el.style.zIndex=5,renderer.container.appendChild(w.el),w._inDocument=!0),w.coverGutter||(w.el.style.zIndex=3),null==w.pixelHeight&&(w.pixelHeight=w.el.offsetHeight),null==w.rowCount&&(w.rowCount=w.pixelHeight/renderer.layerConfig.lineHeight);var fold=this.session.getFoldAt(w.row,0);if(w.$fold=fold,fold){var lineWidgets=this.session.lineWidgets;w.row!=fold.end.row||lineWidgets[fold.start.row]?w.hidden=!0:lineWidgets[fold.start.row]=w}return this.session._emit("changeFold",{data:{start:{row:w.row}}}),this.$updateRows(),this.renderWidgets(null,renderer),this.onWidgetChanged(w),w},this.removeLineWidget=function(w){if(w._inDocument=!1,w.session=null,w.el&&w.el.parentNode&&w.el.parentNode.removeChild(w.el),w.editor&&w.editor.destroy)try{w.editor.destroy()}catch(e){}if(this.session.lineWidgets){var w1=this.session.lineWidgets[w.row];if(w1==w)this.session.lineWidgets[w.row]=w.$oldWidget,w.$oldWidget&&this.onWidgetChanged(w.$oldWidget);else for(;w1;){if(w1.$oldWidget==w){w1.$oldWidget=w.$oldWidget;break}w1=w1.$oldWidget}}this.session._emit("changeFold",{data:{start:{row:w.row}}}),this.$updateRows()},this.getWidgetsAtRow=function(row){for(var lineWidgets=this.session.lineWidgets,w=lineWidgets&&lineWidgets[row],list=[];w;)list.push(w),w=w.$oldWidget;return list},this.onWidgetChanged=function(w){this.session._changedWidgets.push(w),this.editor&&this.editor.renderer.updateFull()},this.measureWidgets=function(e,renderer){var changedWidgets=this.session._changedWidgets,config=renderer.layerConfig;if(changedWidgets&&changedWidgets.length){for(var min=1/0,i=0;i<changedWidgets.length;i++){var w=changedWidgets[i];if(w&&w.el&&w.session==this.session){if(!w._inDocument){if(this.session.lineWidgets[w.row]!=w)continue;w._inDocument=!0,renderer.container.appendChild(w.el)}w.h=w.el.offsetHeight,w.fixedWidth||(w.w=w.el.offsetWidth,w.screenWidth=Math.ceil(w.w/config.characterWidth));var rowCount=w.h/config.lineHeight;w.coverLine&&(rowCount-=this.session.getRowLineCount(w.row))<0&&(rowCount=0),w.rowCount!=rowCount&&(w.rowCount=rowCount,w.row<min&&(min=w.row))}}min!=1/0&&(this.session._emit("changeFold",{data:{start:{row:min}}}),this.session.lineWidgetWidth=null),this.session._changedWidgets=[]}},this.renderWidgets=function(e,renderer){var config=renderer.layerConfig,lineWidgets=this.session.lineWidgets;if(lineWidgets){for(var first=Math.min(this.firstRow,config.firstRow),last=Math.max(this.lastRow,config.lastRow,lineWidgets.length);first>0&&!lineWidgets[first];)first--;this.firstRow=config.firstRow,this.lastRow=config.lastRow,renderer.$cursorLayer.config=config;for(var i=first;i<=last;i++){var w=lineWidgets[i];if(w&&w.el)if(w.hidden)w.el.style.top=-100-(w.pixelHeight||0)+"px";else{w._inDocument||(w._inDocument=!0,renderer.container.appendChild(w.el));var top=renderer.$cursorLayer.getPixelPosition({row:i,column:0},!0).top;w.coverLine||(top+=config.lineHeight*this.session.getRowLineCount(w.row)),w.el.style.top=top-config.offset+"px";var left=w.coverGutter?0:renderer.gutterWidth;w.fixedWidth||(left-=renderer.scrollLeft),w.el.style.left=left+"px",w.fullWidth&&w.screenWidth&&(w.el.style.minWidth=config.width+2*config.padding+"px"),w.fixedWidth?w.el.style.right=renderer.scrollBar.getWidth()+"px":w.el.style.right=""}}}}}).call(LineWidgets.prototype),exports.LineWidgets=LineWidgets})),ace.define("ace/ext/error_marker",["require","exports","module","ace/line_widgets","ace/lib/dom","ace/range"],(function(acequire,exports,module){"use strict";var LineWidgets=acequire("../line_widgets").LineWidgets,dom=acequire("../lib/dom"),Range=acequire("../range").Range;exports.showErrorMarker=function(editor,dir){var session=editor.session;session.widgetManager||(session.widgetManager=new LineWidgets(session),session.widgetManager.attach(editor));var pos=editor.getCursorPosition(),row=pos.row,oldWidget=session.widgetManager.getWidgetsAtRow(row).filter((function(w){return"errorMarker"==w.type}))[0];oldWidget?oldWidget.destroy():row-=dir;var gutterAnno,annotations=function(session,row,dir){var annotations=session.getAnnotations().sort(Range.comparePoints);if(annotations.length){var i=function(array,needle,comparator){for(var first=0,last=array.length-1;first<=last;){var mid=first+last>>1,c=comparator(needle,array[mid]);if(c>0)first=mid+1;else{if(!(c<0))return mid;last=mid-1}}return-(first+1)}(annotations,{row:row,column:-1},Range.comparePoints);i<0&&(i=-i-1),i>=annotations.length?i=dir>0?0:annotations.length-1:0===i&&dir<0&&(i=annotations.length-1);var annotation=annotations[i];if(annotation&&dir){if(annotation.row===row){do{annotation=annotations[i+=dir]}while(annotation&&annotation.row===row);if(!annotation)return annotations.slice()}var matched=[];row=annotation.row;do{matched[dir<0?"unshift":"push"](annotation),annotation=annotations[i+=dir]}while(annotation&&annotation.row==row);return matched.length&&matched}}}(session,row,dir);if(annotations){var annotation=annotations[0];pos.column=(annotation.pos&&"number"!=typeof annotation.column?annotation.pos.sc:annotation.column)||0,pos.row=annotation.row,gutterAnno=editor.renderer.$gutterLayer.$annotations[pos.row]}else{if(oldWidget)return;gutterAnno={text:["Looks good!"],className:"ace_ok"}}editor.session.unfold(pos.row),editor.selection.moveToPosition(pos);var w={row:pos.row,fixedWidth:!0,coverGutter:!0,el:dom.createElement("div"),type:"errorMarker"},el=w.el.appendChild(dom.createElement("div")),arrow=w.el.appendChild(dom.createElement("div"));arrow.className="error_widget_arrow "+gutterAnno.className;var left=editor.renderer.$cursorLayer.getPixelPosition(pos).left;arrow.style.left=left+editor.renderer.gutterWidth-5+"px",w.el.className="error_widget_wrapper",el.className="error_widget "+gutterAnno.className,el.innerHTML=gutterAnno.text.join("<br>"),el.appendChild(dom.createElement("div"));var kb=function(_,hashId,keyString){if(0===hashId&&("esc"===keyString||"return"===keyString))return w.destroy(),{command:"null"}};w.destroy=function(){editor.$mouseHandler.isMousePressed||(editor.keyBinding.removeKeyboardHandler(kb),session.widgetManager.removeLineWidget(w),editor.off("changeSelection",w.destroy),editor.off("changeSession",w.destroy),editor.off("mouseup",w.destroy),editor.off("change",w.destroy))},editor.keyBinding.addKeyboardHandler(kb),editor.on("changeSelection",w.destroy),editor.on("changeSession",w.destroy),editor.on("mouseup",w.destroy),editor.on("change",w.destroy),editor.session.widgetManager.addLineWidget(w),w.el.onmousedown=editor.focus.bind(editor),editor.renderer.scrollCursorIntoView(null,.5,{bottom:w.el.offsetHeight})},dom.importCssString("    .error_widget_wrapper {        background: inherit;        color: inherit;        border:none    }    .error_widget {        border-top: solid 2px;        border-bottom: solid 2px;        margin: 5px 0;        padding: 10px 40px;        white-space: pre-wrap;    }    .error_widget.ace_error, .error_widget_arrow.ace_error{        border-color: #ff5a5a    }    .error_widget.ace_warning, .error_widget_arrow.ace_warning{        border-color: #F1D817    }    .error_widget.ace_info, .error_widget_arrow.ace_info{        border-color: #5a5a5a    }    .error_widget.ace_ok, .error_widget_arrow.ace_ok{        border-color: #5aaa5a    }    .error_widget_arrow {        position: absolute;        border: solid 5px;        border-top-color: transparent!important;        border-right-color: transparent!important;        border-left-color: transparent!important;        top: -5px;    }","")})),ace.define("ace/ace",["require","exports","module","ace/lib/fixoldbrowsers","ace/lib/dom","ace/lib/event","ace/editor","ace/edit_session","ace/undomanager","ace/virtual_renderer","ace/worker/worker_client","ace/keyboard/hash_handler","ace/placeholder","ace/multi_select","ace/mode/folding/fold_mode","ace/theme/textmate","ace/ext/error_marker","ace/config"],(function(acequire,exports,module){"use strict";acequire("./lib/fixoldbrowsers");var dom=acequire("./lib/dom"),event=acequire("./lib/event"),Editor=acequire("./editor").Editor,EditSession=acequire("./edit_session").EditSession,UndoManager=acequire("./undomanager").UndoManager,Renderer=acequire("./virtual_renderer").VirtualRenderer;acequire("./worker/worker_client"),acequire("./keyboard/hash_handler"),acequire("./placeholder"),acequire("./multi_select"),acequire("./mode/folding/fold_mode"),acequire("./theme/textmate"),acequire("./ext/error_marker"),exports.config=acequire("./config"),exports.acequire=acequire,exports.define=__webpack_require__(316),exports.edit=function(el){if("string"==typeof el){var _id=el;if(!(el=document.getElementById(_id)))throw new Error("ace.edit can't find div #"+_id)}if(el&&el.env&&el.env.editor instanceof Editor)return el.env.editor;var value="";if(el&&/input|textarea/i.test(el.tagName)){var oldNode=el;value=oldNode.value,el=dom.createElement("pre"),oldNode.parentNode.replaceChild(el,oldNode)}else el&&(value=dom.getInnerText(el),el.innerHTML="");var doc=exports.createEditSession(value),editor=new Editor(new Renderer(el));editor.setSession(doc);var env={document:doc,editor:editor,onResize:editor.resize.bind(editor,null)};return oldNode&&(env.textarea=oldNode),event.addListener(window,"resize",env.onResize),editor.on("destroy",(function(){event.removeListener(window,"resize",env.onResize),env.editor.container.env=null})),editor.container.env=editor.env=env,editor},exports.createEditSession=function(text,mode){var doc=new EditSession(text,mode);return doc.setUndoManager(new UndoManager),doc},exports.EditSession=EditSession,exports.UndoManager=UndoManager,exports.version="1.2.9"})),ace.acequire(["ace/ace"],(function(a){for(var key in a&&(a.config.init(!0),a.define=ace.define),window.ace||(window.ace=a),a)a.hasOwnProperty(key)&&(window.ace[key]=a[key])})),module.exports=window.ace.acequire("ace/ace")},,function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return combineFieldsAndAggs})),__webpack_require__.d(__webpack_exports__,"b",(function(){return sortFields}));var _types_fields__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(112),_src_plugins_data_common__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(28),_constants_aggregation_types__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(81);function combineFieldsAndAggs(fields,aggs,rollupFields){const keywordFields=function(fields){return fields.filter(f=>f.type===_src_plugins_data_common__WEBPACK_IMPORTED_MODULE_1__.ES_FIELD_TYPES.KEYWORD)}(fields),textFields=function(fields){return fields.filter(f=>f.type===_src_plugins_data_common__WEBPACK_IMPORTED_MODULE_1__.ES_FIELD_TYPES.TEXT)}(fields),numericalFields=function(fields){return fields.filter(f=>f.type===_src_plugins_data_common__WEBPACK_IMPORTED_MODULE_1__.ES_FIELD_TYPES.LONG||f.type===_src_plugins_data_common__WEBPACK_IMPORTED_MODULE_1__.ES_FIELD_TYPES.UNSIGNED_LONG||f.type===_src_plugins_data_common__WEBPACK_IMPORTED_MODULE_1__.ES_FIELD_TYPES.INTEGER||f.type===_src_plugins_data_common__WEBPACK_IMPORTED_MODULE_1__.ES_FIELD_TYPES.SHORT||f.type===_src_plugins_data_common__WEBPACK_IMPORTED_MODULE_1__.ES_FIELD_TYPES.BYTE||f.type===_src_plugins_data_common__WEBPACK_IMPORTED_MODULE_1__.ES_FIELD_TYPES.DOUBLE||f.type===_src_plugins_data_common__WEBPACK_IMPORTED_MODULE_1__.ES_FIELD_TYPES.FLOAT||f.type===_src_plugins_data_common__WEBPACK_IMPORTED_MODULE_1__.ES_FIELD_TYPES.HALF_FLOAT||f.type===_src_plugins_data_common__WEBPACK_IMPORTED_MODULE_1__.ES_FIELD_TYPES.SCALED_FLOAT)}(fields),ipFields=function(fields){return fields.filter(f=>f.type===_src_plugins_data_common__WEBPACK_IMPORTED_MODULE_1__.ES_FIELD_TYPES.IP)}(fields),geoFields=function(fields){return fields.filter(f=>f.type===_src_plugins_data_common__WEBPACK_IMPORTED_MODULE_1__.ES_FIELD_TYPES.GEO_POINT||f.type===_src_plugins_data_common__WEBPACK_IMPORTED_MODULE_1__.ES_FIELD_TYPES.GEO_SHAPE)}(fields),isRollup=Object.keys(rollupFields).length>0,mix=function(isRollup,rollupFields){return function(field,agg){(!1===isRollup||rollupFields[field.id]&&rollupFields[field.id].find(f=>f.agg===agg.dslName))&&(void 0!==field.aggs&&field.aggs.push(agg),void 0!==agg.fields&&agg.fields.push(field))}}(isRollup,rollupFields);return aggs.forEach(a=>{if(a.type===_types_fields__WEBPACK_IMPORTED_MODULE_0__.b&&void 0!==a.fields)switch(a.id){case _constants_aggregation_types__WEBPACK_IMPORTED_MODULE_2__.b.LAT_LONG:geoFields.forEach(f=>mix(f,a));break;case _constants_aggregation_types__WEBPACK_IMPORTED_MODULE_2__.b.INFO_CONTENT:case _constants_aggregation_types__WEBPACK_IMPORTED_MODULE_2__.b.HIGH_INFO_CONTENT:case _constants_aggregation_types__WEBPACK_IMPORTED_MODULE_2__.b.LOW_INFO_CONTENT:textFields.forEach(f=>mix(f,a));case _constants_aggregation_types__WEBPACK_IMPORTED_MODULE_2__.b.DISTINCT_COUNT:case _constants_aggregation_types__WEBPACK_IMPORTED_MODULE_2__.b.HIGH_DISTINCT_COUNT:case _constants_aggregation_types__WEBPACK_IMPORTED_MODULE_2__.b.LOW_DISTINCT_COUNT:keywordFields.forEach(f=>mix(f,a)),ipFields.forEach(f=>mix(f,a));default:numericalFields.forEach(f=>{mix(f,a)})}}),{aggs:aggs,fields:isRollup?filterFields(fields):fields}}function filterFields(fields){return fields.filter(f=>f.aggs&&(f.aggs.length>0||0===f.aggs.length&&f.type===_src_plugins_data_common__WEBPACK_IMPORTED_MODULE_1__.ES_FIELD_TYPES.DATE))}function sortFields(fields){if(0===fields.length)return fields;let eventRate;return fields[0].id===_types_fields__WEBPACK_IMPORTED_MODULE_0__.a&&([eventRate]=fields.splice(0,1)),fields.sort((a,b)=>a.name.localeCompare(b.name)),void 0!==eventRate&&fields.splice(0,0,eventRate),fields}},function(module,exports,__webpack_require__){"use strict";(function(global){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var base64=__webpack_require__(488),ieee754=__webpack_require__(489),isArray=__webpack_require__(490);function kMaxLength(){return Buffer.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function createBuffer(that,length){if(kMaxLength()<length)throw new RangeError("Invalid typed array length");return Buffer.TYPED_ARRAY_SUPPORT?(that=new Uint8Array(length)).__proto__=Buffer.prototype:(null===that&&(that=new Buffer(length)),that.length=length),that}function Buffer(arg,encodingOrOffset,length){if(!(Buffer.TYPED_ARRAY_SUPPORT||this instanceof Buffer))return new Buffer(arg,encodingOrOffset,length);if("number"==typeof arg){if("string"==typeof encodingOrOffset)throw new Error("If encoding is specified then the first argument must be a string");return allocUnsafe(this,arg)}return from(this,arg,encodingOrOffset,length)}function from(that,value,encodingOrOffset,length){if("number"==typeof value)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&value instanceof ArrayBuffer?function(that,array,byteOffset,length){if(array.byteLength,byteOffset<0||array.byteLength<byteOffset)throw new RangeError("'offset' is out of bounds");if(array.byteLength<byteOffset+(length||0))throw new RangeError("'length' is out of bounds");array=void 0===byteOffset&&void 0===length?new Uint8Array(array):void 0===length?new Uint8Array(array,byteOffset):new Uint8Array(array,byteOffset,length);Buffer.TYPED_ARRAY_SUPPORT?(that=array).__proto__=Buffer.prototype:that=fromArrayLike(that,array);return that}(that,value,encodingOrOffset,length):"string"==typeof value?function(that,string,encoding){"string"==typeof encoding&&""!==encoding||(encoding="utf8");if(!Buffer.isEncoding(encoding))throw new TypeError('"encoding" must be a valid string encoding');var length=0|byteLength(string,encoding),actual=(that=createBuffer(that,length)).write(string,encoding);actual!==length&&(that=that.slice(0,actual));return that}(that,value,encodingOrOffset):function(that,obj){if(Buffer.isBuffer(obj)){var len=0|checked(obj.length);return 0===(that=createBuffer(that,len)).length||obj.copy(that,0,0,len),that}if(obj){if("undefined"!=typeof ArrayBuffer&&obj.buffer instanceof ArrayBuffer||"length"in obj)return"number"!=typeof obj.length||(val=obj.length)!=val?createBuffer(that,0):fromArrayLike(that,obj);if("Buffer"===obj.type&&isArray(obj.data))return fromArrayLike(that,obj.data)}var val;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(that,value)}function assertSize(size){if("number"!=typeof size)throw new TypeError('"size" argument must be a number');if(size<0)throw new RangeError('"size" argument must not be negative')}function allocUnsafe(that,size){if(assertSize(size),that=createBuffer(that,size<0?0:0|checked(size)),!Buffer.TYPED_ARRAY_SUPPORT)for(var i=0;i<size;++i)that[i]=0;return that}function fromArrayLike(that,array){var length=array.length<0?0:0|checked(array.length);that=createBuffer(that,length);for(var i=0;i<length;i+=1)that[i]=255&array[i];return that}function checked(length){if(length>=kMaxLength())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+kMaxLength().toString(16)+" bytes");return 0|length}function byteLength(string,encoding){if(Buffer.isBuffer(string))return string.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(string)||string instanceof ArrayBuffer))return string.byteLength;"string"!=typeof string&&(string=""+string);var len=string.length;if(0===len)return 0;for(var loweredCase=!1;;)switch(encoding){case"ascii":case"latin1":case"binary":return len;case"utf8":case"utf-8":case void 0:return utf8ToBytes(string).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*len;case"hex":return len>>>1;case"base64":return base64ToBytes(string).length;default:if(loweredCase)return utf8ToBytes(string).length;encoding=(""+encoding).toLowerCase(),loweredCase=!0}}function slowToString(encoding,start,end){var loweredCase=!1;if((void 0===start||start<0)&&(start=0),start>this.length)return"";if((void 0===end||end>this.length)&&(end=this.length),end<=0)return"";if((end>>>=0)<=(start>>>=0))return"";for(encoding||(encoding="utf8");;)switch(encoding){case"hex":return hexSlice(this,start,end);case"utf8":case"utf-8":return utf8Slice(this,start,end);case"ascii":return asciiSlice(this,start,end);case"latin1":case"binary":return latin1Slice(this,start,end);case"base64":return base64Slice(this,start,end);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,start,end);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(encoding+"").toLowerCase(),loweredCase=!0}}function swap(b,n,m){var i=b[n];b[n]=b[m],b[m]=i}function bidirectionalIndexOf(buffer,val,byteOffset,encoding,dir){if(0===buffer.length)return-1;if("string"==typeof byteOffset?(encoding=byteOffset,byteOffset=0):byteOffset>2147483647?byteOffset=2147483647:byteOffset<-2147483648&&(byteOffset=-2147483648),byteOffset=+byteOffset,isNaN(byteOffset)&&(byteOffset=dir?0:buffer.length-1),byteOffset<0&&(byteOffset=buffer.length+byteOffset),byteOffset>=buffer.length){if(dir)return-1;byteOffset=buffer.length-1}else if(byteOffset<0){if(!dir)return-1;byteOffset=0}if("string"==typeof val&&(val=Buffer.from(val,encoding)),Buffer.isBuffer(val))return 0===val.length?-1:arrayIndexOf(buffer,val,byteOffset,encoding,dir);if("number"==typeof val)return val&=255,Buffer.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?dir?Uint8Array.prototype.indexOf.call(buffer,val,byteOffset):Uint8Array.prototype.lastIndexOf.call(buffer,val,byteOffset):arrayIndexOf(buffer,[val],byteOffset,encoding,dir);throw new TypeError("val must be string, number or Buffer")}function arrayIndexOf(arr,val,byteOffset,encoding,dir){var i,indexSize=1,arrLength=arr.length,valLength=val.length;if(void 0!==encoding&&("ucs2"===(encoding=String(encoding).toLowerCase())||"ucs-2"===encoding||"utf16le"===encoding||"utf-16le"===encoding)){if(arr.length<2||val.length<2)return-1;indexSize=2,arrLength/=2,valLength/=2,byteOffset/=2}function read(buf,i){return 1===indexSize?buf[i]:buf.readUInt16BE(i*indexSize)}if(dir){var foundIndex=-1;for(i=byteOffset;i<arrLength;i++)if(read(arr,i)===read(val,-1===foundIndex?0:i-foundIndex)){if(-1===foundIndex&&(foundIndex=i),i-foundIndex+1===valLength)return foundIndex*indexSize}else-1!==foundIndex&&(i-=i-foundIndex),foundIndex=-1}else for(byteOffset+valLength>arrLength&&(byteOffset=arrLength-valLength),i=byteOffset;i>=0;i--){for(var found=!0,j=0;j<valLength;j++)if(read(arr,i+j)!==read(val,j)){found=!1;break}if(found)return i}return-1}function hexWrite(buf,string,offset,length){offset=Number(offset)||0;var remaining=buf.length-offset;length?(length=Number(length))>remaining&&(length=remaining):length=remaining;var strLen=string.length;if(strLen%2!=0)throw new TypeError("Invalid hex string");length>strLen/2&&(length=strLen/2);for(var i=0;i<length;++i){var parsed=parseInt(string.substr(2*i,2),16);if(isNaN(parsed))return i;buf[offset+i]=parsed}return i}function utf8Write(buf,string,offset,length){return blitBuffer(utf8ToBytes(string,buf.length-offset),buf,offset,length)}function asciiWrite(buf,string,offset,length){return blitBuffer(function(str){for(var byteArray=[],i=0;i<str.length;++i)byteArray.push(255&str.charCodeAt(i));return byteArray}(string),buf,offset,length)}function latin1Write(buf,string,offset,length){return asciiWrite(buf,string,offset,length)}function base64Write(buf,string,offset,length){return blitBuffer(base64ToBytes(string),buf,offset,length)}function ucs2Write(buf,string,offset,length){return blitBuffer(function(str,units){for(var c,hi,lo,byteArray=[],i=0;i<str.length&&!((units-=2)<0);++i)c=str.charCodeAt(i),hi=c>>8,lo=c%256,byteArray.push(lo),byteArray.push(hi);return byteArray}(string,buf.length-offset),buf,offset,length)}function base64Slice(buf,start,end){return 0===start&&end===buf.length?base64.fromByteArray(buf):base64.fromByteArray(buf.slice(start,end))}function utf8Slice(buf,start,end){end=Math.min(buf.length,end);for(var res=[],i=start;i<end;){var secondByte,thirdByte,fourthByte,tempCodePoint,firstByte=buf[i],codePoint=null,bytesPerSequence=firstByte>239?4:firstByte>223?3:firstByte>191?2:1;if(i+bytesPerSequence<=end)switch(bytesPerSequence){case 1:firstByte<128&&(codePoint=firstByte);break;case 2:128==(192&(secondByte=buf[i+1]))&&(tempCodePoint=(31&firstByte)<<6|63&secondByte)>127&&(codePoint=tempCodePoint);break;case 3:secondByte=buf[i+1],thirdByte=buf[i+2],128==(192&secondByte)&&128==(192&thirdByte)&&(tempCodePoint=(15&firstByte)<<12|(63&secondByte)<<6|63&thirdByte)>2047&&(tempCodePoint<55296||tempCodePoint>57343)&&(codePoint=tempCodePoint);break;case 4:secondByte=buf[i+1],thirdByte=buf[i+2],fourthByte=buf[i+3],128==(192&secondByte)&&128==(192&thirdByte)&&128==(192&fourthByte)&&(tempCodePoint=(15&firstByte)<<18|(63&secondByte)<<12|(63&thirdByte)<<6|63&fourthByte)>65535&&tempCodePoint<1114112&&(codePoint=tempCodePoint)}null===codePoint?(codePoint=65533,bytesPerSequence=1):codePoint>65535&&(codePoint-=65536,res.push(codePoint>>>10&1023|55296),codePoint=56320|1023&codePoint),res.push(codePoint),i+=bytesPerSequence}return function(codePoints){var len=codePoints.length;if(len<=4096)return String.fromCharCode.apply(String,codePoints);var res="",i=0;for(;i<len;)res+=String.fromCharCode.apply(String,codePoints.slice(i,i+=4096));return res}(res)}exports.Buffer=Buffer,exports.SlowBuffer=function(length){+length!=length&&(length=0);return Buffer.alloc(+length)},exports.INSPECT_MAX_BYTES=50,Buffer.TYPED_ARRAY_SUPPORT=void 0!==global.TYPED_ARRAY_SUPPORT?global.TYPED_ARRAY_SUPPORT:function(){try{var arr=new Uint8Array(1);return arr.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===arr.foo()&&"function"==typeof arr.subarray&&0===arr.subarray(1,1).byteLength}catch(e){return!1}}(),exports.kMaxLength=kMaxLength(),Buffer.poolSize=8192,Buffer._augment=function(arr){return arr.__proto__=Buffer.prototype,arr},Buffer.from=function(value,encodingOrOffset,length){return from(null,value,encodingOrOffset,length)},Buffer.TYPED_ARRAY_SUPPORT&&(Buffer.prototype.__proto__=Uint8Array.prototype,Buffer.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&Buffer[Symbol.species]===Buffer&&Object.defineProperty(Buffer,Symbol.species,{value:null,configurable:!0})),Buffer.alloc=function(size,fill,encoding){return function(that,size,fill,encoding){return assertSize(size),size<=0?createBuffer(that,size):void 0!==fill?"string"==typeof encoding?createBuffer(that,size).fill(fill,encoding):createBuffer(that,size).fill(fill):createBuffer(that,size)}(null,size,fill,encoding)},Buffer.allocUnsafe=function(size){return allocUnsafe(null,size)},Buffer.allocUnsafeSlow=function(size){return allocUnsafe(null,size)},Buffer.isBuffer=function(b){return!(null==b||!b._isBuffer)},Buffer.compare=function(a,b){if(!Buffer.isBuffer(a)||!Buffer.isBuffer(b))throw new TypeError("Arguments must be Buffers");if(a===b)return 0;for(var x=a.length,y=b.length,i=0,len=Math.min(x,y);i<len;++i)if(a[i]!==b[i]){x=a[i],y=b[i];break}return x<y?-1:y<x?1:0},Buffer.isEncoding=function(encoding){switch(String(encoding).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Buffer.concat=function(list,length){if(!isArray(list))throw new TypeError('"list" argument must be an Array of Buffers');if(0===list.length)return Buffer.alloc(0);var i;if(void 0===length)for(length=0,i=0;i<list.length;++i)length+=list[i].length;var buffer=Buffer.allocUnsafe(length),pos=0;for(i=0;i<list.length;++i){var buf=list[i];if(!Buffer.isBuffer(buf))throw new TypeError('"list" argument must be an Array of Buffers');buf.copy(buffer,pos),pos+=buf.length}return buffer},Buffer.byteLength=byteLength,Buffer.prototype._isBuffer=!0,Buffer.prototype.swap16=function(){var len=this.length;if(len%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var i=0;i<len;i+=2)swap(this,i,i+1);return this},Buffer.prototype.swap32=function(){var len=this.length;if(len%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var i=0;i<len;i+=4)swap(this,i,i+3),swap(this,i+1,i+2);return this},Buffer.prototype.swap64=function(){var len=this.length;if(len%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var i=0;i<len;i+=8)swap(this,i,i+7),swap(this,i+1,i+6),swap(this,i+2,i+5),swap(this,i+3,i+4);return this},Buffer.prototype.toString=function(){var length=0|this.length;return 0===length?"":0===arguments.length?utf8Slice(this,0,length):slowToString.apply(this,arguments)},Buffer.prototype.equals=function(b){if(!Buffer.isBuffer(b))throw new TypeError("Argument must be a Buffer");return this===b||0===Buffer.compare(this,b)},Buffer.prototype.inspect=function(){var str="",max=exports.INSPECT_MAX_BYTES;return this.length>0&&(str=this.toString("hex",0,max).match(/.{2}/g).join(" "),this.length>max&&(str+=" ... ")),"<Buffer "+str+">"},Buffer.prototype.compare=function(target,start,end,thisStart,thisEnd){if(!Buffer.isBuffer(target))throw new TypeError("Argument must be a Buffer");if(void 0===start&&(start=0),void 0===end&&(end=target?target.length:0),void 0===thisStart&&(thisStart=0),void 0===thisEnd&&(thisEnd=this.length),start<0||end>target.length||thisStart<0||thisEnd>this.length)throw new RangeError("out of range index");if(thisStart>=thisEnd&&start>=end)return 0;if(thisStart>=thisEnd)return-1;if(start>=end)return 1;if(this===target)return 0;for(var x=(thisEnd>>>=0)-(thisStart>>>=0),y=(end>>>=0)-(start>>>=0),len=Math.min(x,y),thisCopy=this.slice(thisStart,thisEnd),targetCopy=target.slice(start,end),i=0;i<len;++i)if(thisCopy[i]!==targetCopy[i]){x=thisCopy[i],y=targetCopy[i];break}return x<y?-1:y<x?1:0},Buffer.prototype.includes=function(val,byteOffset,encoding){return-1!==this.indexOf(val,byteOffset,encoding)},Buffer.prototype.indexOf=function(val,byteOffset,encoding){return bidirectionalIndexOf(this,val,byteOffset,encoding,!0)},Buffer.prototype.lastIndexOf=function(val,byteOffset,encoding){return bidirectionalIndexOf(this,val,byteOffset,encoding,!1)},Buffer.prototype.write=function(string,offset,length,encoding){if(void 0===offset)encoding="utf8",length=this.length,offset=0;else if(void 0===length&&"string"==typeof offset)encoding=offset,length=this.length,offset=0;else{if(!isFinite(offset))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");offset|=0,isFinite(length)?(length|=0,void 0===encoding&&(encoding="utf8")):(encoding=length,length=void 0)}var remaining=this.length-offset;if((void 0===length||length>remaining)&&(length=remaining),string.length>0&&(length<0||offset<0)||offset>this.length)throw new RangeError("Attempt to write outside buffer bounds");encoding||(encoding="utf8");for(var loweredCase=!1;;)switch(encoding){case"hex":return hexWrite(this,string,offset,length);case"utf8":case"utf-8":return utf8Write(this,string,offset,length);case"ascii":return asciiWrite(this,string,offset,length);case"latin1":case"binary":return latin1Write(this,string,offset,length);case"base64":return base64Write(this,string,offset,length);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this,string,offset,length);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(""+encoding).toLowerCase(),loweredCase=!0}},Buffer.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function asciiSlice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;i<end;++i)ret+=String.fromCharCode(127&buf[i]);return ret}function latin1Slice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;i<end;++i)ret+=String.fromCharCode(buf[i]);return ret}function hexSlice(buf,start,end){var len=buf.length;(!start||start<0)&&(start=0),(!end||end<0||end>len)&&(end=len);for(var out="",i=start;i<end;++i)out+=toHex(buf[i]);return out}function utf16leSlice(buf,start,end){for(var bytes=buf.slice(start,end),res="",i=0;i<bytes.length;i+=2)res+=String.fromCharCode(bytes[i]+256*bytes[i+1]);return res}function checkOffset(offset,ext,length){if(offset%1!=0||offset<0)throw new RangeError("offset is not uint");if(offset+ext>length)throw new RangeError("Trying to access beyond buffer length")}function checkInt(buf,value,offset,ext,max,min){if(!Buffer.isBuffer(buf))throw new TypeError('"buffer" argument must be a Buffer instance');if(value>max||value<min)throw new RangeError('"value" argument is out of bounds');if(offset+ext>buf.length)throw new RangeError("Index out of range")}function objectWriteUInt16(buf,value,offset,littleEndian){value<0&&(value=65535+value+1);for(var i=0,j=Math.min(buf.length-offset,2);i<j;++i)buf[offset+i]=(value&255<<8*(littleEndian?i:1-i))>>>8*(littleEndian?i:1-i)}function objectWriteUInt32(buf,value,offset,littleEndian){value<0&&(value=4294967295+value+1);for(var i=0,j=Math.min(buf.length-offset,4);i<j;++i)buf[offset+i]=value>>>8*(littleEndian?i:3-i)&255}function checkIEEE754(buf,value,offset,ext,max,min){if(offset+ext>buf.length)throw new RangeError("Index out of range");if(offset<0)throw new RangeError("Index out of range")}function writeFloat(buf,value,offset,littleEndian,noAssert){return noAssert||checkIEEE754(buf,0,offset,4),ieee754.write(buf,value,offset,littleEndian,23,4),offset+4}function writeDouble(buf,value,offset,littleEndian,noAssert){return noAssert||checkIEEE754(buf,0,offset,8),ieee754.write(buf,value,offset,littleEndian,52,8),offset+8}Buffer.prototype.slice=function(start,end){var newBuf,len=this.length;if((start=~~start)<0?(start+=len)<0&&(start=0):start>len&&(start=len),(end=void 0===end?len:~~end)<0?(end+=len)<0&&(end=0):end>len&&(end=len),end<start&&(end=start),Buffer.TYPED_ARRAY_SUPPORT)(newBuf=this.subarray(start,end)).__proto__=Buffer.prototype;else{var sliceLen=end-start;newBuf=new Buffer(sliceLen,void 0);for(var i=0;i<sliceLen;++i)newBuf[i]=this[i+start]}return newBuf},Buffer.prototype.readUIntLE=function(offset,byteLength,noAssert){offset|=0,byteLength|=0,noAssert||checkOffset(offset,byteLength,this.length);for(var val=this[offset],mul=1,i=0;++i<byteLength&&(mul*=256);)val+=this[offset+i]*mul;return val},Buffer.prototype.readUIntBE=function(offset,byteLength,noAssert){offset|=0,byteLength|=0,noAssert||checkOffset(offset,byteLength,this.length);for(var val=this[offset+--byteLength],mul=1;byteLength>0&&(mul*=256);)val+=this[offset+--byteLength]*mul;return val},Buffer.prototype.readUInt8=function(offset,noAssert){return noAssert||checkOffset(offset,1,this.length),this[offset]},Buffer.prototype.readUInt16LE=function(offset,noAssert){return noAssert||checkOffset(offset,2,this.length),this[offset]|this[offset+1]<<8},Buffer.prototype.readUInt16BE=function(offset,noAssert){return noAssert||checkOffset(offset,2,this.length),this[offset]<<8|this[offset+1]},Buffer.prototype.readUInt32LE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),(this[offset]|this[offset+1]<<8|this[offset+2]<<16)+16777216*this[offset+3]},Buffer.prototype.readUInt32BE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),16777216*this[offset]+(this[offset+1]<<16|this[offset+2]<<8|this[offset+3])},Buffer.prototype.readIntLE=function(offset,byteLength,noAssert){offset|=0,byteLength|=0,noAssert||checkOffset(offset,byteLength,this.length);for(var val=this[offset],mul=1,i=0;++i<byteLength&&(mul*=256);)val+=this[offset+i]*mul;return val>=(mul*=128)&&(val-=Math.pow(2,8*byteLength)),val},Buffer.prototype.readIntBE=function(offset,byteLength,noAssert){offset|=0,byteLength|=0,noAssert||checkOffset(offset,byteLength,this.length);for(var i=byteLength,mul=1,val=this[offset+--i];i>0&&(mul*=256);)val+=this[offset+--i]*mul;return val>=(mul*=128)&&(val-=Math.pow(2,8*byteLength)),val},Buffer.prototype.readInt8=function(offset,noAssert){return noAssert||checkOffset(offset,1,this.length),128&this[offset]?-1*(255-this[offset]+1):this[offset]},Buffer.prototype.readInt16LE=function(offset,noAssert){noAssert||checkOffset(offset,2,this.length);var val=this[offset]|this[offset+1]<<8;return 32768&val?4294901760|val:val},Buffer.prototype.readInt16BE=function(offset,noAssert){noAssert||checkOffset(offset,2,this.length);var val=this[offset+1]|this[offset]<<8;return 32768&val?4294901760|val:val},Buffer.prototype.readInt32LE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),this[offset]|this[offset+1]<<8|this[offset+2]<<16|this[offset+3]<<24},Buffer.prototype.readInt32BE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),this[offset]<<24|this[offset+1]<<16|this[offset+2]<<8|this[offset+3]},Buffer.prototype.readFloatLE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),ieee754.read(this,offset,!0,23,4)},Buffer.prototype.readFloatBE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),ieee754.read(this,offset,!1,23,4)},Buffer.prototype.readDoubleLE=function(offset,noAssert){return noAssert||checkOffset(offset,8,this.length),ieee754.read(this,offset,!0,52,8)},Buffer.prototype.readDoubleBE=function(offset,noAssert){return noAssert||checkOffset(offset,8,this.length),ieee754.read(this,offset,!1,52,8)},Buffer.prototype.writeUIntLE=function(value,offset,byteLength,noAssert){(value=+value,offset|=0,byteLength|=0,noAssert)||checkInt(this,value,offset,byteLength,Math.pow(2,8*byteLength)-1,0);var mul=1,i=0;for(this[offset]=255&value;++i<byteLength&&(mul*=256);)this[offset+i]=value/mul&255;return offset+byteLength},Buffer.prototype.writeUIntBE=function(value,offset,byteLength,noAssert){(value=+value,offset|=0,byteLength|=0,noAssert)||checkInt(this,value,offset,byteLength,Math.pow(2,8*byteLength)-1,0);var i=byteLength-1,mul=1;for(this[offset+i]=255&value;--i>=0&&(mul*=256);)this[offset+i]=value/mul&255;return offset+byteLength},Buffer.prototype.writeUInt8=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,1,255,0),Buffer.TYPED_ARRAY_SUPPORT||(value=Math.floor(value)),this[offset]=255&value,offset+1},Buffer.prototype.writeUInt16LE=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=255&value,this[offset+1]=value>>>8):objectWriteUInt16(this,value,offset,!0),offset+2},Buffer.prototype.writeUInt16BE=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value>>>8,this[offset+1]=255&value):objectWriteUInt16(this,value,offset,!1),offset+2},Buffer.prototype.writeUInt32LE=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[offset+3]=value>>>24,this[offset+2]=value>>>16,this[offset+1]=value>>>8,this[offset]=255&value):objectWriteUInt32(this,value,offset,!0),offset+4},Buffer.prototype.writeUInt32BE=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value>>>24,this[offset+1]=value>>>16,this[offset+2]=value>>>8,this[offset+3]=255&value):objectWriteUInt32(this,value,offset,!1),offset+4},Buffer.prototype.writeIntLE=function(value,offset,byteLength,noAssert){if(value=+value,offset|=0,!noAssert){var limit=Math.pow(2,8*byteLength-1);checkInt(this,value,offset,byteLength,limit-1,-limit)}var i=0,mul=1,sub=0;for(this[offset]=255&value;++i<byteLength&&(mul*=256);)value<0&&0===sub&&0!==this[offset+i-1]&&(sub=1),this[offset+i]=(value/mul>>0)-sub&255;return offset+byteLength},Buffer.prototype.writeIntBE=function(value,offset,byteLength,noAssert){if(value=+value,offset|=0,!noAssert){var limit=Math.pow(2,8*byteLength-1);checkInt(this,value,offset,byteLength,limit-1,-limit)}var i=byteLength-1,mul=1,sub=0;for(this[offset+i]=255&value;--i>=0&&(mul*=256);)value<0&&0===sub&&0!==this[offset+i+1]&&(sub=1),this[offset+i]=(value/mul>>0)-sub&255;return offset+byteLength},Buffer.prototype.writeInt8=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,1,127,-128),Buffer.TYPED_ARRAY_SUPPORT||(value=Math.floor(value)),value<0&&(value=255+value+1),this[offset]=255&value,offset+1},Buffer.prototype.writeInt16LE=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=255&value,this[offset+1]=value>>>8):objectWriteUInt16(this,value,offset,!0),offset+2},Buffer.prototype.writeInt16BE=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value>>>8,this[offset+1]=255&value):objectWriteUInt16(this,value,offset,!1),offset+2},Buffer.prototype.writeInt32LE=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,4,2147483647,-2147483648),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=255&value,this[offset+1]=value>>>8,this[offset+2]=value>>>16,this[offset+3]=value>>>24):objectWriteUInt32(this,value,offset,!0),offset+4},Buffer.prototype.writeInt32BE=function(value,offset,noAssert){return value=+value,offset|=0,noAssert||checkInt(this,value,offset,4,2147483647,-2147483648),value<0&&(value=4294967295+value+1),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value>>>24,this[offset+1]=value>>>16,this[offset+2]=value>>>8,this[offset+3]=255&value):objectWriteUInt32(this,value,offset,!1),offset+4},Buffer.prototype.writeFloatLE=function(value,offset,noAssert){return writeFloat(this,value,offset,!0,noAssert)},Buffer.prototype.writeFloatBE=function(value,offset,noAssert){return writeFloat(this,value,offset,!1,noAssert)},Buffer.prototype.writeDoubleLE=function(value,offset,noAssert){return writeDouble(this,value,offset,!0,noAssert)},Buffer.prototype.writeDoubleBE=function(value,offset,noAssert){return writeDouble(this,value,offset,!1,noAssert)},Buffer.prototype.copy=function(target,targetStart,start,end){if(start||(start=0),end||0===end||(end=this.length),targetStart>=target.length&&(targetStart=target.length),targetStart||(targetStart=0),end>0&&end<start&&(end=start),end===start)return 0;if(0===target.length||0===this.length)return 0;if(targetStart<0)throw new RangeError("targetStart out of bounds");if(start<0||start>=this.length)throw new RangeError("sourceStart out of bounds");if(end<0)throw new RangeError("sourceEnd out of bounds");end>this.length&&(end=this.length),target.length-targetStart<end-start&&(end=target.length-targetStart+start);var i,len=end-start;if(this===target&&start<targetStart&&targetStart<end)for(i=len-1;i>=0;--i)target[i+targetStart]=this[i+start];else if(len<1e3||!Buffer.TYPED_ARRAY_SUPPORT)for(i=0;i<len;++i)target[i+targetStart]=this[i+start];else Uint8Array.prototype.set.call(target,this.subarray(start,start+len),targetStart);return len},Buffer.prototype.fill=function(val,start,end,encoding){if("string"==typeof val){if("string"==typeof start?(encoding=start,start=0,end=this.length):"string"==typeof end&&(encoding=end,end=this.length),1===val.length){var code=val.charCodeAt(0);code<256&&(val=code)}if(void 0!==encoding&&"string"!=typeof encoding)throw new TypeError("encoding must be a string");if("string"==typeof encoding&&!Buffer.isEncoding(encoding))throw new TypeError("Unknown encoding: "+encoding)}else"number"==typeof val&&(val&=255);if(start<0||this.length<start||this.length<end)throw new RangeError("Out of range index");if(end<=start)return this;var i;if(start>>>=0,end=void 0===end?this.length:end>>>0,val||(val=0),"number"==typeof val)for(i=start;i<end;++i)this[i]=val;else{var bytes=Buffer.isBuffer(val)?val:utf8ToBytes(new Buffer(val,encoding).toString()),len=bytes.length;for(i=0;i<end-start;++i)this[i+start]=bytes[i%len]}return this};var INVALID_BASE64_RE=/[^+\/0-9A-Za-z-_]/g;function toHex(n){return n<16?"0"+n.toString(16):n.toString(16)}function utf8ToBytes(string,units){var codePoint;units=units||1/0;for(var length=string.length,leadSurrogate=null,bytes=[],i=0;i<length;++i){if((codePoint=string.charCodeAt(i))>55295&&codePoint<57344){if(!leadSurrogate){if(codePoint>56319){(units-=3)>-1&&bytes.push(239,191,189);continue}if(i+1===length){(units-=3)>-1&&bytes.push(239,191,189);continue}leadSurrogate=codePoint;continue}if(codePoint<56320){(units-=3)>-1&&bytes.push(239,191,189),leadSurrogate=codePoint;continue}codePoint=65536+(leadSurrogate-55296<<10|codePoint-56320)}else leadSurrogate&&(units-=3)>-1&&bytes.push(239,191,189);if(leadSurrogate=null,codePoint<128){if((units-=1)<0)break;bytes.push(codePoint)}else if(codePoint<2048){if((units-=2)<0)break;bytes.push(codePoint>>6|192,63&codePoint|128)}else if(codePoint<65536){if((units-=3)<0)break;bytes.push(codePoint>>12|224,codePoint>>6&63|128,63&codePoint|128)}else{if(!(codePoint<1114112))throw new Error("Invalid code point");if((units-=4)<0)break;bytes.push(codePoint>>18|240,codePoint>>12&63|128,codePoint>>6&63|128,63&codePoint|128)}}return bytes}function base64ToBytes(str){return base64.toByteArray(function(str){if((str=function(str){return str.trim?str.trim():str.replace(/^\s+|\s+$/g,"")}(str).replace(INVALID_BASE64_RE,"")).length<2)return"";for(;str.length%4!=0;)str+="=";return str}(str))}function blitBuffer(src,dst,offset,length){for(var i=0;i<length&&!(i+offset>=dst.length||i>=src.length);++i)dst[i+offset]=src[i];return i}}).call(this,__webpack_require__(117))},function(module,exports,__webpack_require__){var types=__webpack_require__(170),SUPPORTED_PARTS=["FREQ","INTERVAL","COUNT","UNTIL","BYDAY","BYMONTH","BYMONTHDAY"],WKDAYS=["SU","MO","TU","WE","TH","FR","SA"];function to_utc_date(dt){return Array.isArray(dt)?(dt=dt.slice(0))[1]--:dt=[dt.getFullYear(),dt.getMonth(),dt.getDate(),dt.getHours(),dt.getMinutes(),dt.getSeconds(),dt.getMilliseconds()],new Date(Date.UTC.apply(null,dt))}function from_utc_date(udt){return new Date(udt.getUTCFullYear(),udt.getUTCMonth(),udt.getUTCDate(),udt.getUTCHours(),udt.getUTCMinutes(),udt.getUTCSeconds(),udt.getUTCMilliseconds())}function trunc(n){return n<0?Math.ceil(n):Math.floor(n)}function y(dt){return dt.getUTCFullYear()}function m(dt){return dt.getUTCMonth()+1}function d(dt){return dt.getUTCDate()}function hr(dt){return dt.getUTCHours()}function min(dt){return dt.getUTCMinutes()}function sec(dt){return dt.getUTCSeconds()}function ms(dt){return dt.getUTCMilliseconds()}function set_m(dt,v){return dt.setUTCMonth(v-1),dt}function set_d(dt,v){return dt.setUTCDate(v),dt}function set_hr(dt,v){return dt.setUTCHours(v),dt}function set_min(dt,v){return dt.setUTCMinutes(v),dt}function set_sec(dt,v){return dt.setUTCSeconds(v),dt}function set_ms(dt,v){return dt.setUTCMilliseconds(v),dt}function add_y(dt,v){return function(dt,v){return dt.setUTCFullYear(v),dt}(dt,y(dt)+v)}function add_m(dt,v){return set_m(dt,m(dt)+v)}function add_d(dt,v){return set_d(dt,d(dt)+v)}function wkday(dt){return dt.getUTCDay()}function daydiff(dt1,dt2){return(dt2-dt1)/864e5}var RRule=exports.RRule=function(rule,options,dtend){for(var i in options instanceof Date&&(options={DTSTART:options,DTEND:dtend}),options=options||{},this.start=options.DTSTART?to_utc_date(options.DTSTART):null,this.end=options.DTEND?to_utc_date(options.DTEND):null,this.exceptions=options.EXDATE||[],"string"==typeof rule&&(rule=RRule.parse(rule)),this.rule={},rule||{}){if(-1==SUPPORTED_PARTS.indexOf(i))throw new Error(i+" is not currently supported!");this.rule[i]=RULE_PARTS[i]?RULE_PARTS[i].parse(rule[i]):rule[i]}};RRule.parse=function(value){for(var parts=value.split(/=|;/),rrule={},i=0;i<parts.length;i+=2)rrule[parts[i]]=parts[i+1];return rrule},RRule.prototype.setFrequency=function(freq){this.rule.FREQ=freq},RRule.prototype.valueOf=function(){return this.rule},RRule.prototype.toString=function(){var out=["FREQ="+this.rule.FREQ];for(var k in this.rule)"FREQ"!=k&&out.push(k+"="+((RULE_PARTS[k]||{}).format?RULE_PARTS[k].format(this.rule[k]):this.rule[k]));return out.join(";")},RRule.prototype.next=function(after){if((!(after=after&&to_utc_date(after))||after<this.start)&&(after=new Date(this.start.valueOf()-1)),this.until&&after>this.until)return null;var freq=FREQ[this.rule.FREQ];if(!freq)throw new Error(this.rule.FREQ+" recurrence is not supported");NextOccurs:for(;;){for(var next=freq.next(this.rule,this.start,after),nextInLocal=from_utc_date(next),i=0;i<this.exceptions.length;i++){var exdate=this.exceptions[i];if(exdate.valueOf()==nextInLocal.valueOf()||exdate.date_only&&y(to_utc_date(exdate))==y(nextInLocal)&&m(to_utc_date(exdate))==m(nextInLocal)&&d(to_utc_date(exdate))==d(nextInLocal)){after=next;continue NextOccurs}}break}return this.until&&next>this.until||this.rule.COUNT&&null!==this.count_end&&(void 0===this.count_end&&(this.count_end=null,this.count_end=this.nextOccurences(this.rule.COUNT).pop()),next>to_utc_date(this.count_end))||this.rule.UNTIL&&next>to_utc_date(this.rule.UNTIL)?null:from_utc_date(next)},RRule.prototype.nextOccurences=function(after,count_or_until){1===arguments.length&&(count_or_until=after,after=void 0);var arr=[];if(count_or_until instanceof Date)for(;(after=this.next(after))&&after<=count_or_until;)arr.push(after);else for(;count_or_until--&&null!==after;)(after=this.next(after))&&arr.push(after);return arr};var RULE_PARTS={INTERVAL:{parse:function(v){return parseInt(v,10)}},UNTIL:{parse:function(v){return v instanceof Date?v:types.parse_value("DATE-TIME",v)},format:function(v){return types.format_value("DATE-TIME",v)}},FREQ:{parse:function(v){return v}},BYMONTH:{parse:function(v){return"number"==typeof v?[v]:v.split(",").map((function(mo){return parseInt(mo,10)}))},format:function(v){return v.join(",")}},BYDAY:{parse:function(v){var days=v.split(",").map((function(day){var m=day.match(/([+-]?\d)?(SU|MO|TU|WE|TH|FR|SA)/);return[parseInt(m[1],10)||0,WKDAYS.indexOf(m[2])]}));return days.sort((function(d1,d2){return d1[0]==d2[0]?d1[1]-d2[1]:d1[0]-d2[0]})),days},format:function(v){return v.map((function(day){return(day[0]||"")+WKDAYS[day[1]]})).join(",")}},EXDATE:{parse:function(v){return v.split(",").map((function(dt){return 8==dt.length?types.parse_value("DATE",dt):types.parse_value("DATE-TIME",dt)}))},format:function(v){return v.map((function(dt){return types.format_value(dt.date_only?"DATE":"DATE-TIME",dt)})).join(",")}}};RULE_PARTS.BYMONTHDAY=RULE_PARTS.BYMONTH,RULE_PARTS.COUNT=RULE_PARTS.INTERVAL;var FREQ={DAILY:{next:function(rule,start,after){var next=new Date(after);set_hr(next,hr(start)),set_min(next,min(start)),set_sec(next,sec(start)),set_ms(next,ms(start));var interval=rule.INTERVAL||1,mod_days=trunc(daydiff(next,start))%interval;mod_days&&add_d(next,interval-mod_days);for(var i=0;i<2&&!((next=byday(rule.BYDAY,next,after)).valueOf()>after.valueOf());++i)add_d(next,interval);return next}},WEEKLY:{next:function(rule,start,after){var next=new Date(after);set_hr(next,hr(start)),set_min(next,min(start)),set_sec(next,sec(start)),set_ms(next,ms(start));var interval=rule.INTERVAL||1,mod_weeks=trunc(daydiff(start,next)/7)%interval;for(mod_weeks&&add_d(next,7*(interval-mod_weeks));next=byday(rule.BYDAY,next,after),rule.BYDAY&&rule.BYDAY.length||(startDayOfWeek=wkday(start),nextDayOfWeek=wkday(next),nextDayOfWeek>startDayOfWeek?add_d(next,startDayOfWeek-nextDayOfWeek):startDayOfWeek>nextDayOfWeek&&add_d(next,startDayOfWeek-nextDayOfWeek-7)),!(next.valueOf()>after.valueOf()&&check_bymonth(rule.BYMONTH,next));)add_d(next,7*interval);return next}},MONTHLY:{next:function(rule,start,after){var next=new Date(after);set_hr(next,hr(start)),set_min(next,min(start)),set_sec(next,sec(start)),set_ms(next,ms(start));var interval=rule.INTERVAL||1,delta=m(next)-m(start)+12*(y(next)-y(start));delta%interval&&add_m(next,interval-delta%interval);for(var i=0;i<2&&(i&&set_d(next,1),next=byday(rule.BYDAY,next,after),next=bymonthday(rule.BYMONTHDAY,next,after),rule.BYDAY&&rule.BYDAY.length||rule.BYMONTHDAY&&rule.BYMONTHDAY.length||set_d(next,d(start)),!(next.valueOf()>after.valueOf()));++i)add_m(next,interval);return next}},YEARLY:{next:function(rule,start,after){var next=new Date(after);set_hr(next,hr(start)),set_min(next,min(start)),set_sec(next,sec(start)),set_ms(next,ms(start));var interval=rule.INTERVAL||1,mod_year=(y(after)-y(start))%interval;mod_year&&add_y(next,interval-mod_year);for(var i=0;i<2&&(next=bymonth(rule.BYMONTH,next),next=bymonthday(rule.BYMONTHDAY,next,after),next=byday(rule.BYDAY,next,after),rule.BYMONTH&&rule.BYMONTH.length||set_m(next,m(start)),rule.BYDAY&&rule.BYDAY.length||rule.BYMONTHDAY&&rule.BYMONTHDAY.length||set_d(next,d(start)),!(next.valueOf()>after.valueOf()));++i)set_d(set_m(add_y(next,interval),1),1);return next}}};function sort_dates(dateary){return dateary.sort((function(dt1,dt2){return null===dt1&&null===dt2?0:null===dt1?1:null===dt2?-1:dt1.valueOf()-dt2.valueOf()}))}function check_bymonth(rules,dt){return!rules||!rules.length||-1!==rules.indexOf(m(dt))}function bymonth(rules,dt){return rules&&rules.length&&sort_dates(rules.map((function(rule){var delta=rule-m(dt);delta<0&&(delta+=12);var newdt=add_m(new Date(dt),delta);return set_d(newdt,1),newdt}))).shift()||dt}function bymonthday(rules,dt,after){return rules&&rules.length&&sort_dates(rules.map((function(rule){var newdt=set_d(new Date(dt),rule);return newdt.valueOf()<=after.valueOf()?null:newdt}))).shift()||dt}function byday(rules,dt,after){return rules&&rules.length&&sort_dates(rules.map((function(rule){(days=rule[1]-wkday(dt))<0&&(days+=7);var newdt=add_d(new Date(dt),days);if(rule[0]>0){var wk=0|(d(newdt)-1)/7+1;if(wk>rule[0])return null;add_d(newdt,7*(rule[0]-wk))}else if(rule[0]<0){for(var dt2=new Date(newdt),days=[];m(dt2)===m(newdt);)days.push(d(dt2)),add_d(dt2,7);set_d(newdt,days.reverse()[-rule[0]-1])}return newdt.valueOf()<=after.valueOf()?null:newdt}))).shift()||dt}},function(module,exports,__webpack_require__){__webpack_require__(249);var util=__webpack_require__(171),CalendarObject=__webpack_require__(107).CalendarObject,schema=(__webpack_require__(107).CalendarProperty,__webpack_require__(107).schema),iCalendar=exports.iCalendar=function(empty){CalendarObject.call(this,this,"VCALENDAR"),this.calendar=this,empty||(this.addProperty("VERSION","2.0"),this.addProperty("PRODID",__webpack_require__(323).PRODID))};util.inherits(iCalendar,CalendarObject),iCalendar.prototype.events=function(){return this.components.VEVENT||[]},iCalendar.prototype.timezone=function(tzid){for(var i=0;i<this.components.VTIMEZONE.length;++i){var tz=this.components.VTIMEZONE[i];if(tz.getPropertyValue("TZID")==tzid)return tz}},schema.VCALENDAR={factory:iCalendar,valid_properties:[],required_properties:["PRODID","VERSION"],valid_children:["VEVENT"],required_children:[]},schema.VTODO={required_properties:["DTSTAMP","UID"]},schema.VJOURNAL={required_properties:["DTSTAMP","UID"]},schema.VFREEBUSY={required_properties:["DTSTAMP","UID"]},schema.VALARM={required_properties:["ACTION","TRIGGER"]}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return getViewLinkStatus}));var _kbn_i18n__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2),_common_analytics__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(67),_analytics_list_common__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(93);const unknownJobTypeMessage=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.ml.dataframe.analyticsList.viewActionUnknownJobTypeToolTipContent",{defaultMessage:"There is no results page available for this type of data frame analytics job."}),jobNotStartedMessage=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.ml.dataframe.analyticsList.viewActionJobNotStartedToolTipContent",{defaultMessage:"The data frame analytics job did not start. There is no results page available."}),jobNotFinishedMessage=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.ml.dataframe.analyticsList.viewActionJobNotFinishedToolTipContent",{defaultMessage:"The data frame analytics job is not finished. There is no results page available."}),jobFailedMessage=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.ml.dataframe.analyticsList.viewActionJobFailedToolTipContent",{defaultMessage:"The data frame analytics job failed. There is no results page available."});function getViewLinkStatus(item){const viewLinkStatus={disabled:!1},progressStats=Object(_analytics_list_common__WEBPACK_IMPORTED_MODULE_2__.d)(item.stats),jobFailed=Object(_analytics_list_common__WEBPACK_IMPORTED_MODULE_2__.f)(item.stats.state),jobNotStarted=1===progressStats.currentPhase&&0===progressStats.progress,jobFinished=Object(_analytics_list_common__WEBPACK_IMPORTED_MODULE_2__.i)(item.stats.state)&&progressStats.currentPhase===progressStats.totalPhases&&100===progressStats.progress,isUnknownJobType=!Object(_common_analytics__WEBPACK_IMPORTED_MODULE_1__.D)(item.config.analysis)&&!Object(_common_analytics__WEBPACK_IMPORTED_MODULE_1__.C)(item.config.analysis)&&!Object(_common_analytics__WEBPACK_IMPORTED_MODULE_1__.A)(item.config.analysis);return(!jobFinished||jobFailed||isUnknownJobType)&&(viewLinkStatus.disabled=!0,isUnknownJobType?viewLinkStatus.tooltipContent=unknownJobTypeMessage:jobFailed?viewLinkStatus.tooltipContent=jobFailedMessage:jobNotStarted?viewLinkStatus.tooltipContent=jobNotStartedMessage:jobFinished||(viewLinkStatus.tooltipContent=jobNotFinishedMessage)),viewLinkStatus}},function(module,exports,__webpack_require__){var ListCache=__webpack_require__(201),stackClear=__webpack_require__(529),stackDelete=__webpack_require__(530),stackGet=__webpack_require__(531),stackHas=__webpack_require__(532),stackSet=__webpack_require__(533);function Stack(entries){var data=this.__data__=new ListCache(entries);this.size=data.size}Stack.prototype.clear=stackClear,Stack.prototype.delete=stackDelete,Stack.prototype.get=stackGet,Stack.prototype.has=stackHas,Stack.prototype.set=stackSet,module.exports=Stack},function(module,exports,__webpack_require__){var listCacheClear=__webpack_require__(524),listCacheDelete=__webpack_require__(525),listCacheGet=__webpack_require__(526),listCacheHas=__webpack_require__(527),listCacheSet=__webpack_require__(528);function ListCache(entries){var index=-1,length=null==entries?0:entries.length;for(this.clear();++index<length;){var entry=entries[index];this.set(entry[0],entry[1])}}ListCache.prototype.clear=listCacheClear,ListCache.prototype.delete=listCacheDelete,ListCache.prototype.get=listCacheGet,ListCache.prototype.has=listCacheHas,ListCache.prototype.set=listCacheSet,module.exports=ListCache},function(module,exports,__webpack_require__){var eq=__webpack_require__(152);module.exports=function(array,key){for(var length=array.length;length--;)if(eq(array[length][0],key))return length;return-1}},function(module,exports,__webpack_require__){var nativeCreate=__webpack_require__(141)(Object,"create");module.exports=nativeCreate},function(module,exports,__webpack_require__){var isKeyable=__webpack_require__(548);module.exports=function(map,key){var data=map.__data__;return isKeyable(key)?data["string"==typeof key?"string":"hash"]:data.map}},function(module,exports,__webpack_require__){var baseAssignValue=__webpack_require__(206),eq=__webpack_require__(152),hasOwnProperty=Object.prototype.hasOwnProperty;module.exports=function(object,key,value){var objValue=object[key];hasOwnProperty.call(object,key)&&eq(objValue,value)&&(void 0!==value||key in object)||baseAssignValue(object,key,value)}},function(module,exports,__webpack_require__){var defineProperty=__webpack_require__(329);module.exports=function(object,key,value){"__proto__"==key&&defineProperty?defineProperty(object,key,{configurable:!0,enumerable:!0,value:value,writable:!0}):object[key]=value}},function(module,exports){var reIsUint=/^(?:0|[1-9]\d*)$/;module.exports=function(value,length){var type=typeof value;return!!(length=null==length?9007199254740991:length)&&("number"==type||"symbol"!=type&&reIsUint.test(value))&&value>-1&&value%1==0&&value<length}},function(module,exports){module.exports=function(func){return function(value){return func(value)}}},function(module,exports){var objectProto=Object.prototype;module.exports=function(value){var Ctor=value&&value.constructor;return value===("function"==typeof Ctor&&Ctor.prototype||objectProto)}},function(module,exports,__webpack_require__){var getPrototype=__webpack_require__(331)(Object.getPrototypeOf,Object);module.exports=getPrototype},function(module,exports,__webpack_require__){var baseForOwn=__webpack_require__(261),baseEach=__webpack_require__(577)(baseForOwn);module.exports=baseEach},function(module,exports,__webpack_require__){var castPath=__webpack_require__(213),toKey=__webpack_require__(176);module.exports=function(object,path){for(var index=0,length=(path=castPath(path,object)).length;null!=object&&index<length;)object=object[toKey(path[index++])];return index&&index==length?object:void 0}},function(module,exports,__webpack_require__){var isArray=__webpack_require__(80),isKey=__webpack_require__(264),stringToPath=__webpack_require__(591),toString=__webpack_require__(354);module.exports=function(value,object){return isArray(value)?value:isKey(value,object)?[value]:stringToPath(toString(value))}},function(module,exports){module.exports=function(array,iteratee){for(var index=-1,length=null==array?0:array.length,result=Array(length);++index<length;)result[index]=iteratee(array[index],index,array);return result}},function(module,exports,__webpack_require__){var identity=__webpack_require__(144),overRest=__webpack_require__(363),setToString=__webpack_require__(364);module.exports=function(func,start){return setToString(overRest(func,start,identity),func+"")}},function(module,exports,__webpack_require__){var eq=__webpack_require__(152),isArrayLike=__webpack_require__(123),isIndex=__webpack_require__(207),isObject=__webpack_require__(109);module.exports=function(value,index,object){if(!isObject(object))return!1;var type=typeof index;return!!("number"==type?isArrayLike(object)&&isIndex(index,object.length):"string"==type&&index in object)&&eq(object[index],value)}},function(module,exports,__webpack_require__){"use strict";var _=__webpack_require__(78);module.exports={longestPath:function(g){var visited={};_.forEach(g.sources(),(function dfs(v){var label=g.node(v);if(_.has(visited,v))return label.rank;visited[v]=!0;var rank=_.min(_.map(g.outEdges(v),(function(e){return dfs(e.w)-g.edge(e).minlen})));return rank!==Number.POSITIVE_INFINITY&&null!=rank||(rank=0),label.rank=rank}))},slack:function(g,e){return g.node(e.w).rank-g.node(e.v).rank-g.edge(e).minlen}}},,,,,,,,,function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return getInitialGroupsMap})),__webpack_require__.d(__webpack_exports__,"a",(function(){return JobSelector}));var external_kbnSharedDeps_React_=__webpack_require__(14),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),external_kbnSharedDeps_ElasticEui_=__webpack_require__(39),external_kbnSharedDeps_KbnI18n_=__webpack_require__(2),url_state=__webpack_require__(77),prop_types=__webpack_require__(126),job_selector_badge=__webpack_require__(227);function IdBadges({limit:limit,maps:maps,onLinkClick:onLinkClick,selectedIds:selectedIds,showAllBarBadges:showAllBarBadges}){const badges=[],currentGroups=[];for(let i=0;i<selectedIds.length;i++){const currentId=selectedIds[i];void 0!==maps.groupsMap[currentId]&&(currentGroups.push(currentId),badges.push(external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,key:currentId},external_kbnSharedDeps_React_default.a.createElement(job_selector_badge.a,{id:currentId,isGroup:!0,numJobs:maps.groupsMap[currentId].length}))))}for(let i=0;i<selectedIds.length;i++){const currentId=selectedIds[i];if(void 0===maps.groupsMap[currentId]){if(!1!==(maps.jobsMap[currentId]||[]).some(g=>currentGroups.includes(g)))continue;badges.push(external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,key:currentId},external_kbnSharedDeps_React_default.a.createElement(job_selector_badge.a,{id:currentId})))}}if(showAllBarBadges||badges.length<=limit)return badges.length>limit&&badges.push(external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{key:"more-badges-bar-link",onClick:onLinkClick},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{grow:!1,size:"xs"},external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobSelector.hideBarBadges",{defaultMessage:"Hide"})))),badges;{const overFlow=badges.length-limit;return badges.splice(limit),badges.push(external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{key:"more-badges-bar-link",onClick:onLinkClick},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{grow:!1,size:"xs"},external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobSelector.showBarBadges",{defaultMessage:"And {overFlow} more",values:{overFlow:overFlow}})))),badges}}IdBadges.propTypes={limit:prop_types.PropTypes.number,maps:prop_types.PropTypes.shape({jobsMap:prop_types.PropTypes.object,groupsMap:prop_types.PropTypes.object}),onLinkClick:prop_types.PropTypes.func,selectedIds:prop_types.PropTypes.array,showAllBarBadges:prop_types.PropTypes.bool};var job_selector_flyout=__webpack_require__(285),use_storage=__webpack_require__(380),storage=__webpack_require__(381);function mergeSelection(jobIds,groupObjs,singleSelection){if(singleSelection)return jobIds;const selectedIds=[],alreadySelected=[];return groupObjs.forEach(group=>{selectedIds.push(group.groupId),alreadySelected.push(...group.jobIds)}),jobIds.forEach(jobId=>{!1===alreadySelected.includes(jobId)&&selectedIds.push(jobId)}),selectedIds}function getInitialGroupsMap(selectedGroups){const map={};return selectedGroups.length&&selectedGroups.forEach(group=>{map[group.groupId]=group.jobIds}),map}function JobSelector({dateFormatTz:dateFormatTz,singleSelection:singleSelection,timeseriesOnly:timeseriesOnly}){var _globalState$ml$jobId,_globalState$ml,_globalState$ml$group,_globalState$ml2;const[globalState,setGlobalState]=Object(url_state.c)("_g"),[applyTimeRangeConfig,setApplyTimeRangeConfig]=Object(use_storage.a)(storage.a,!0),selectedJobIds=null!==(_globalState$ml$jobId=null==globalState||null===(_globalState$ml=globalState.ml)||void 0===_globalState$ml?void 0:_globalState$ml.jobIds)&&void 0!==_globalState$ml$jobId?_globalState$ml$jobId:[],selectedGroups=null!==(_globalState$ml$group=null==globalState||null===(_globalState$ml2=globalState.ml)||void 0===_globalState$ml2?void 0:_globalState$ml2.groups)&&void 0!==_globalState$ml$group?_globalState$ml$group:[],[maps,setMaps]=Object(external_kbnSharedDeps_React_.useState)({groupsMap:getInitialGroupsMap(selectedGroups),jobsMap:{}}),[selectedIds,setSelectedIds]=Object(external_kbnSharedDeps_React_.useState)(mergeSelection(selectedJobIds,selectedGroups,singleSelection)),[showAllBarBadges,setShowAllBarBadges]=Object(external_kbnSharedDeps_React_.useState)(!1),[isFlyoutVisible,setIsFlyoutVisible]=Object(external_kbnSharedDeps_React_.useState)(!1);function closeFlyout(){setIsFlyoutVisible(!1)}function handleJobSelectionClick(){setIsFlyoutVisible(!0)}Object(external_kbnSharedDeps_React_.useEffect)(()=>{setSelectedIds(mergeSelection(selectedJobIds,selectedGroups,singleSelection))},[JSON.stringify([selectedJobIds,selectedGroups])]);const applySelection=Object(external_kbnSharedDeps_React_.useCallback)(({newSelection:newSelection,jobIds:jobIds,groups:newGroups,time:time})=>{setSelectedIds(newSelection),setGlobalState({ml:{jobIds:jobIds,groups:newGroups},...void 0!==time?{time:time}:{}}),closeFlyout()},[setGlobalState,setSelectedIds]);return external_kbnSharedDeps_React_default.a.createElement("div",{className:"mlJobSelectorBar"},selectedIds.length>0&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{responsive:!1,gutterSize:"xs",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{wrap:!0,responsive:!1,gutterSize:"xs",alignItems:"center","data-test-subj":"mlJobSelectionBadges"},external_kbnSharedDeps_React_default.a.createElement(IdBadges,{limit:job_selector_flyout.a,maps:maps,onLinkClick:()=>setShowAllBarBadges(!showAllBarBadges),selectedIds:selectedIds,showAllBarBadges:showAllBarBadges}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{size:"xs",iconType:"pencil",onClick:handleJobSelectionClick,"data-test-subj":"mlButtonEditJobSelection"},external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobSelector.jobSelectionButton",{defaultMessage:"Edit job selection"})))),function(){if(isFlyoutVisible)return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyout,{onClose:closeFlyout,"data-test-subj":"mlFlyoutJobSelector","aria-labelledby":"jobSelectorFlyout"},external_kbnSharedDeps_React_default.a.createElement(job_selector_flyout.b,{dateFormatTz:dateFormatTz,timeseriesOnly:timeseriesOnly,singleSelection:singleSelection,selectedIds:selectedIds,onSelectionConfirmed:applySelection,onJobsFetched:setMaps,onFlyoutClose:closeFlyout,maps:maps,applyTimeRangeConfig:applyTimeRangeConfig,onTimeRangeConfigChange:setApplyTimeRangeConfig}))}())}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return JobSelectorBadge}));var external_kbnSharedDeps_React_=__webpack_require__(14),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),external_kbnSharedDeps_ElasticEui_=__webpack_require__(39),external_kbnSharedDeps_KbnI18n_=__webpack_require__(2),group_color_utils=__webpack_require__(149);function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const JobSelectorBadge=({icon:icon,id:id,isGroup:isGroup=!1,numJobs:numJobs,removeId:removeId})=>{let jobCount,props={color:isGroup?Object(group_color_utils.a)(id):"hollow"};return!0===icon&&removeId&&(props={...props,iconType:"cross",iconSide:"right",onClick:()=>removeId(id),onClickAriaLabel:"Remove id"}),void 0!==numJobs&&(jobCount=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobSelector.selectedGroupJobs",{defaultMessage:"({jobsCount, plural, one {# job} other {# jobs}})",values:{jobsCount:numJobs}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBadge,_extends({key:id+"-id","data-test-subj":"mlJobSelectionBadge "+id},props),`${id}${jobCount||""}`)}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return EventRateChart}));var external_kbnSharedDeps_React_=__webpack_require__(14),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),external_kbnSharedDeps_ElasticCharts_=__webpack_require__(43),axes=__webpack_require__(318),settings=__webpack_require__(118),loading_wrapper=__webpack_require__(296),anomalies=__webpack_require__(321),external_kbnSharedDeps_ElasticEui_=__webpack_require__(39),date_utils=__webpack_require__(72);const OverlayRange=({overlayKey:overlayKey,start:start,end:end,color:color,showMarker:showMarker=!0})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_.RectAnnotation,{id:"rect_annotation_"+overlayKey,zIndex:1,hideTooltips:!0,dataValues:[{coordinates:{x0:start,x1:end}}],style:{fill:color,strokeWidth:0}}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_.LineAnnotation,{id:"annotation_1",domainType:external_kbnSharedDeps_ElasticCharts_.AnnotationDomainType.XDomain,dataValues:[{dataValue:start}],style:{line:{strokeWidth:1,stroke:"#343741",opacity:0}},markerPosition:external_kbnSharedDeps_ElasticCharts_.Position.Bottom,hideTooltips:!0,marker:showMarker?external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement("div",{style:{textAlign:"center"}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{type:"arrowUp"})),external_kbnSharedDeps_React_default.a.createElement("div",{style:{fontWeight:"normal",color:"#343741"}},Object(date_utils.d)(start))):void 0})),EventRateChart=({eventRateChartData:eventRateChartData,anomalyData:anomalyData,height:height,width:width,showAxis:showAxis,loading:loading=!1,fadeChart:fadeChart,overlayRanges:overlayRanges,onBrushEnd:onBrushEnd})=>{const{EVENT_RATE_COLOR_WITH_ANOMALIES:EVENT_RATE_COLOR_WITH_ANOMALIES,EVENT_RATE_COLOR:EVENT_RATE_COLOR}=Object(settings.d)(),barColor=fadeChart?EVENT_RATE_COLOR_WITH_ANOMALIES:EVENT_RATE_COLOR,theme={scales:{histogramPadding:.2}};return external_kbnSharedDeps_React_default.a.createElement("div",{style:{width:width,height:height},"data-test-subj":"mlEventRateChart "+(eventRateChartData.length?"withData":"empty")},external_kbnSharedDeps_React_default.a.createElement(loading_wrapper.a,{height:height,hasData:eventRateChartData.length>0,loading:loading},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_.Chart,null,!0===showAxis&&external_kbnSharedDeps_React_default.a.createElement(axes.a,null),void 0===onBrushEnd?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_.Settings,{tooltip:external_kbnSharedDeps_ElasticCharts_.TooltipType.None,theme:theme}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_.Settings,{tooltip:external_kbnSharedDeps_ElasticCharts_.TooltipType.None,onBrushEnd:onBrushEnd,theme:theme}),overlayRanges&&overlayRanges.map((range,i)=>external_kbnSharedDeps_React_default.a.createElement(OverlayRange,{key:i,overlayKey:i,start:range.start,end:range.end,color:range.color,showMarker:range.showMarker})),external_kbnSharedDeps_React_default.a.createElement(anomalies.a,{anomalyData:anomalyData}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_.HistogramBarSeries,{id:"event_rate",xScaleType:external_kbnSharedDeps_ElasticCharts_.ScaleType.Time,yScaleType:external_kbnSharedDeps_ElasticCharts_.ScaleType.Linear,xAccessor:"time",yAccessors:["value"],data:eventRateChartData,color:barColor}))))}},,,,,,,,,,,,,function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return getDefaultAnomalyDetectionJobsListState})),__webpack_require__.d(__webpack_exports__,"a",(function(){return JobsPage}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(14),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),_components_navigation_menu__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(100),_components_jobs_list_view_index__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(410),_util_url_state__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(77),_common_constants_ml_url_generator__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(0),_components_help_menu__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(104),_contexts_kibana__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(63);function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const getDefaultAnomalyDetectionJobsListState=()=>({pageIndex:0,pageSize:10,sortField:"id",sortDirection:"asc"}),JobsPage=props=>{const[pageState,setPageState]=Object(_util_url_state__WEBPACK_IMPORTED_MODULE_3__.b)(_common_constants_ml_url_generator__WEBPACK_IMPORTED_MODULE_4__.b.ANOMALY_DETECTION_JOBS_MANAGE,getDefaultAnomalyDetectionJobsListState()),{services:{docLinks:docLinks}}=Object(_contexts_kibana__WEBPACK_IMPORTED_MODULE_6__.b)(),helpLink=docLinks.links.ml.anomalyDetection;return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{"data-test-subj":"mlPageJobManagement"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_components_navigation_menu__WEBPACK_IMPORTED_MODULE_1__.a,{tabId:"anomaly_detection"}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_components_jobs_list_view_index__WEBPACK_IMPORTED_MODULE_2__.a,_extends({},props,{jobsViewState:pageState,onJobsViewStateUpdate:setPageState})),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_components_help_menu__WEBPACK_IMPORTED_MODULE_5__.a,{docLink:helpLink}))}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return useCreateADLinks}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(14),_contexts_kibana__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(63),_common_constants_settings__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(243),_services_job_service__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(70);const useCreateADLinks=()=>{const{services:{http:{basePath:basePath}}}=Object(_contexts_kibana__WEBPACK_IMPORTED_MODULE_1__.b)(),useUserTimeSettings=Object(_contexts_kibana__WEBPACK_IMPORTED_MODULE_1__.h)().get(_common_constants_settings__WEBPACK_IMPORTED_MODULE_2__.b),userTimeSettings=Object(_contexts_kibana__WEBPACK_IMPORTED_MODULE_1__.h)().get(_common_constants_settings__WEBPACK_IMPORTED_MODULE_2__.a);return{createLinkWithUserDefaults:Object(react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((location,jobList)=>{const resultsUrl=_services_job_service__WEBPACK_IMPORTED_MODULE_3__.a.createResultsUrlForJobs(jobList,location,!0===useUserTimeSettings&&void 0!==userTimeSettings?userTimeSettings:void 0);return`${basePath.get()}/app/ml/${resultsUrl}`},[basePath])}}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return ANOMALY_DETECTION_ENABLE_TIME_RANGE})),__webpack_require__.d(__webpack_exports__,"a",(function(){return ANOMALY_DETECTION_DEFAULT_TIME_RANGE}));const ANOMALY_DETECTION_ENABLE_TIME_RANGE="ml:anomalyDetection:results:enableTimeDefaults",ANOMALY_DETECTION_DEFAULT_TIME_RANGE="ml:anomalyDetection:results:timeDefaults"},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"c",(function(){return MlAnomalyAlertFlyout})),__webpack_require__.d(__webpack_exports__,"b",(function(){return JobListMlAnomalyAlertFlyout})),__webpack_require__.d(__webpack_exports__,"a",(function(){return EditAlertRule}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(14),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),_elastic_eui__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(39),_application_contexts_kibana__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(63),_common_constants_alerts__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(146),_common_constants_app__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(5);const MlAnomalyAlertFlyout=({initialAlert:initialAlert,jobIds:jobIds,onCloseFlyout:onCloseFlyout,onSave:onSave})=>{const{services:{triggersActionsUi:triggersActionsUi}}=Object(_application_contexts_kibana__WEBPACK_IMPORTED_MODULE_2__.b)(),AlertFlyout=Object(react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(()=>{if(!triggersActionsUi)return;const commonProps={onClose:()=>{onCloseFlyout()},onSave:async()=>{onSave&&onSave()}};return initialAlert?triggersActionsUi.getEditAlertFlyout({...commonProps,initialAlert:initialAlert}):triggersActionsUi.getAddAlertFlyout({...commonProps,consumer:_common_constants_app__WEBPACK_IMPORTED_MODULE_4__.e,canChangeTrigger:!1,alertTypeId:_common_constants_alerts__WEBPACK_IMPORTED_MODULE_3__.b.ANOMALY_DETECTION,metadata:{},initialValues:{params:{jobSelection:{jobIds:jobIds}}}})},[triggersActionsUi,null==initialAlert?void 0:initialAlert.id,jobIds]);return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0___default.a.Fragment,null,AlertFlyout)},JobListMlAnomalyAlertFlyout=({setShowFunction:setShowFunction,unsetShowFunction:unsetShowFunction,onSave:onSave})=>{const[isVisible,setIsVisible]=Object(react__WEBPACK_IMPORTED_MODULE_0__.useState)(!1),[jobIds,setJobIds]=Object(react__WEBPACK_IMPORTED_MODULE_0__.useState)(),showFlyoutCallback=Object(react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(jobIdsUpdate=>{setJobIds(jobIdsUpdate),setIsVisible(!0)},[]);return Object(react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>(setShowFunction(showFlyoutCallback),()=>{unsetShowFunction()}),[]),isVisible&&jobIds?react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(MlAnomalyAlertFlyout,{jobIds:jobIds,onCloseFlyout:()=>setIsVisible(!1),onSave:()=>{setIsVisible(!1),onSave()}}):null},EditAlertRule=({initialAlert:initialAlert,onSave:onSave})=>{const[isVisible,setIsVisible]=Object(react__WEBPACK_IMPORTED_MODULE_0__.useState)(!1);return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__.EuiButtonEmpty,{size:"xs",onClick:setIsVisible.bind(null,!isVisible)},initialAlert.name),isVisible?react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(MlAnomalyAlertFlyout,{initialAlert:initialAlert,onCloseFlyout:setIsVisible.bind(null,!1),onSave:()=>{setIsVisible(!1),onSave()}}):null)}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.installXJsonMode=exports.XJsonMode=exports.addXJsonToRules=exports.XJsonHighlightRules=exports.ScriptHighlightRules=exports.ElasticsearchSqlHighlightRules=void 0;var modes_1=__webpack_require__(314);Object.defineProperty(exports,"ElasticsearchSqlHighlightRules",{enumerable:!0,get:function(){return modes_1.ElasticsearchSqlHighlightRules}}),Object.defineProperty(exports,"ScriptHighlightRules",{enumerable:!0,get:function(){return modes_1.ScriptHighlightRules}}),Object.defineProperty(exports,"XJsonHighlightRules",{enumerable:!0,get:function(){return modes_1.XJsonHighlightRules}}),Object.defineProperty(exports,"addXJsonToRules",{enumerable:!0,get:function(){return modes_1.addXJsonToRules}}),Object.defineProperty(exports,"XJsonMode",{enumerable:!0,get:function(){return modes_1.XJsonMode}}),Object.defineProperty(exports,"installXJsonMode",{enumerable:!0,get:function(){return modes_1.installXJsonMode}})},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return mlTableService}));var rxjs__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(23);const mlTableService={rowMouseenter$:new rxjs__WEBPACK_IMPORTED_MODULE_0__.Subject,rowMouseleave$:new rxjs__WEBPACK_IMPORTED_MODULE_0__.Subject}},function(module,exports,__webpack_require__){"use strict";function areInputsEqual(newInputs,lastInputs){if(newInputs.length!==lastInputs.length)return!1;for(var i=0;i<newInputs.length;i++)if(newInputs[i]!==lastInputs[i])return!1;return!0}module.exports=function(resultFn,isEqual){var lastThis;void 0===isEqual&&(isEqual=areInputsEqual);var lastResult,lastArgs=[],calledOnce=!1;return function(){for(var newArgs=[],_i=0;_i<arguments.length;_i++)newArgs[_i]=arguments[_i];return calledOnce&&lastThis===this&&isEqual(newArgs,lastArgs)||(lastResult=resultFn.apply(this,newArgs),calledOnce=!0,lastThis=this,lastArgs=newArgs),lastResult}}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return useTableSettings}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(14);const PAGE_SIZE_OPTIONS=[10,25,50];function useTableSettings(items,pageState,updatePageState){const{pageIndex:pageIndex,pageSize:pageSize,sortField:sortField,sortDirection:sortDirection}=pageState;return{onTableChange:Object(react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(({page:page,sort:sort})=>{var _page$index,_page$size,_ref,_sort$direction;const result={pageIndex:null!==(_page$index=null==page?void 0:page.index)&&void 0!==_page$index?_page$index:pageState.pageIndex,pageSize:null!==(_page$size=null==page?void 0:page.size)&&void 0!==_page$size?_page$size:pageState.pageSize,sortField:null!==(_ref=null==sort?void 0:sort.field)&&void 0!==_ref?_ref:pageState.sortField,sortDirection:null!==(_sort$direction=null==sort?void 0:sort.direction)&&void 0!==_sort$direction?_sort$direction:pageState.sortDirection};updatePageState(result)},[pageState,updatePageState]),pagination:Object(react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(()=>({pageIndex:pageIndex,pageSize:pageSize,totalItemCount:items.length,pageSizeOptions:PAGE_SIZE_OPTIONS}),[items,pageIndex,pageSize]),sorting:Object(react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(()=>({sort:{field:sortField,direction:sortDirection}}),[sortField,sortDirection])}}},function(module,exports,__webpack_require__){"use strict";(function(global){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
function compare(a,b){if(a===b)return 0;for(var x=a.length,y=b.length,i=0,len=Math.min(x,y);i<len;++i)if(a[i]!==b[i]){x=a[i],y=b[i];break}return x<y?-1:y<x?1:0}function isBuffer(b){return global.Buffer&&"function"==typeof global.Buffer.isBuffer?global.Buffer.isBuffer(b):!(null==b||!b._isBuffer)}var util=__webpack_require__(171),hasOwn=Object.prototype.hasOwnProperty,pSlice=Array.prototype.slice,functionsHaveNames="foo"===function(){}.name;function pToString(obj){return Object.prototype.toString.call(obj)}function isView(arrbuf){return!isBuffer(arrbuf)&&("function"==typeof global.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(arrbuf):!!arrbuf&&(arrbuf instanceof DataView||!!(arrbuf.buffer&&arrbuf.buffer instanceof ArrayBuffer))))}var assert=module.exports=ok,regex=/\s*function\s+([^\(\s]*)\s*/;function getName(func){if(util.isFunction(func)){if(functionsHaveNames)return func.name;var match=func.toString().match(regex);return match&&match[1]}}function truncate(s,n){return"string"==typeof s?s.length<n?s:s.slice(0,n):s}function inspect(something){if(functionsHaveNames||!util.isFunction(something))return util.inspect(something);var rawname=getName(something);return"[Function"+(rawname?": "+rawname:"")+"]"}function fail(actual,expected,message,operator,stackStartFunction){throw new assert.AssertionError({message:message,actual:actual,expected:expected,operator:operator,stackStartFunction:stackStartFunction})}function ok(value,message){value||fail(value,!0,message,"==",assert.ok)}function _deepEqual(actual,expected,strict,memos){if(actual===expected)return!0;if(isBuffer(actual)&&isBuffer(expected))return 0===compare(actual,expected);if(util.isDate(actual)&&util.isDate(expected))return actual.getTime()===expected.getTime();if(util.isRegExp(actual)&&util.isRegExp(expected))return actual.source===expected.source&&actual.global===expected.global&&actual.multiline===expected.multiline&&actual.lastIndex===expected.lastIndex&&actual.ignoreCase===expected.ignoreCase;if(null!==actual&&"object"==typeof actual||null!==expected&&"object"==typeof expected){if(isView(actual)&&isView(expected)&&pToString(actual)===pToString(expected)&&!(actual instanceof Float32Array||actual instanceof Float64Array))return 0===compare(new Uint8Array(actual.buffer),new Uint8Array(expected.buffer));if(isBuffer(actual)!==isBuffer(expected))return!1;var actualIndex=(memos=memos||{actual:[],expected:[]}).actual.indexOf(actual);return-1!==actualIndex&&actualIndex===memos.expected.indexOf(expected)||(memos.actual.push(actual),memos.expected.push(expected),function(a,b,strict,actualVisitedObjects){if(null==a||null==b)return!1;if(util.isPrimitive(a)||util.isPrimitive(b))return a===b;if(strict&&Object.getPrototypeOf(a)!==Object.getPrototypeOf(b))return!1;var aIsArgs=isArguments(a),bIsArgs=isArguments(b);if(aIsArgs&&!bIsArgs||!aIsArgs&&bIsArgs)return!1;if(aIsArgs)return a=pSlice.call(a),b=pSlice.call(b),_deepEqual(a,b,strict);var key,i,ka=objectKeys(a),kb=objectKeys(b);if(ka.length!==kb.length)return!1;for(ka.sort(),kb.sort(),i=ka.length-1;i>=0;i--)if(ka[i]!==kb[i])return!1;for(i=ka.length-1;i>=0;i--)if(key=ka[i],!_deepEqual(a[key],b[key],strict,actualVisitedObjects))return!1;return!0}(actual,expected,strict,memos))}return strict?actual===expected:actual==expected}function isArguments(object){return"[object Arguments]"==Object.prototype.toString.call(object)}function expectedException(actual,expected){if(!actual||!expected)return!1;if("[object RegExp]"==Object.prototype.toString.call(expected))return expected.test(actual);try{if(actual instanceof expected)return!0}catch(e){}return!Error.isPrototypeOf(expected)&&!0===expected.call({},actual)}function _throws(shouldThrow,block,expected,message){var actual;if("function"!=typeof block)throw new TypeError('"block" argument must be a function');"string"==typeof expected&&(message=expected,expected=null),actual=function(block){var error;try{block()}catch(e){error=e}return error}(block),message=(expected&&expected.name?" ("+expected.name+").":".")+(message?" "+message:"."),shouldThrow&&!actual&&fail(actual,expected,"Missing expected exception"+message);var userProvidedMessage="string"==typeof message,isUnexpectedException=!shouldThrow&&actual&&!expected;if((!shouldThrow&&util.isError(actual)&&userProvidedMessage&&expectedException(actual,expected)||isUnexpectedException)&&fail(actual,expected,"Got unwanted exception"+message),shouldThrow&&actual&&expected&&!expectedException(actual,expected)||!shouldThrow&&actual)throw actual}assert.AssertionError=function(options){this.name="AssertionError",this.actual=options.actual,this.expected=options.expected,this.operator=options.operator,options.message?(this.message=options.message,this.generatedMessage=!1):(this.message=function(self){return truncate(inspect(self.actual),128)+" "+self.operator+" "+truncate(inspect(self.expected),128)}(this),this.generatedMessage=!0);var stackStartFunction=options.stackStartFunction||fail;if(Error.captureStackTrace)Error.captureStackTrace(this,stackStartFunction);else{var err=new Error;if(err.stack){var out=err.stack,fn_name=getName(stackStartFunction),idx=out.indexOf("\n"+fn_name);if(idx>=0){var next_line=out.indexOf("\n",idx+1);out=out.substring(next_line+1)}this.stack=out}}},util.inherits(assert.AssertionError,Error),assert.fail=fail,assert.ok=ok,assert.equal=function(actual,expected,message){actual!=expected&&fail(actual,expected,message,"==",assert.equal)},assert.notEqual=function(actual,expected,message){actual==expected&&fail(actual,expected,message,"!=",assert.notEqual)},assert.deepEqual=function(actual,expected,message){_deepEqual(actual,expected,!1)||fail(actual,expected,message,"deepEqual",assert.deepEqual)},assert.deepStrictEqual=function(actual,expected,message){_deepEqual(actual,expected,!0)||fail(actual,expected,message,"deepStrictEqual",assert.deepStrictEqual)},assert.notDeepEqual=function(actual,expected,message){_deepEqual(actual,expected,!1)&&fail(actual,expected,message,"notDeepEqual",assert.notDeepEqual)},assert.notDeepStrictEqual=function notDeepStrictEqual(actual,expected,message){_deepEqual(actual,expected,!0)&&fail(actual,expected,message,"notDeepStrictEqual",notDeepStrictEqual)},assert.strictEqual=function(actual,expected,message){actual!==expected&&fail(actual,expected,message,"===",assert.strictEqual)},assert.notStrictEqual=function(actual,expected,message){actual===expected&&fail(actual,expected,message,"!==",assert.notStrictEqual)},assert.throws=function(block,error,message){_throws(!0,block,error,message)},assert.doesNotThrow=function(block,error,message){_throws(!1,block,error,message)},assert.ifError=function(err){if(err)throw err};var objectKeys=Object.keys||function(obj){var keys=[];for(var key in obj)hasOwn.call(obj,key)&&keys.push(key);return keys}}).call(this,__webpack_require__(117))},function(module,exports,__webpack_require__){"use strict";var _=__webpack_require__(108);module.exports=Graph;function Graph(opts){this._isDirected=!_.has(opts,"directed")||opts.directed,this._isMultigraph=!!_.has(opts,"multigraph")&&opts.multigraph,this._isCompound=!!_.has(opts,"compound")&&opts.compound,this._label=void 0,this._defaultNodeLabelFn=_.constant(void 0),this._defaultEdgeLabelFn=_.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children["\0"]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}function incrementOrInitEntry(map,k){map[k]?map[k]++:map[k]=1}function decrementOrRemoveEntry(map,k){--map[k]||delete map[k]}function edgeArgsToId(isDirected,v_,w_,name){var v=""+v_,w=""+w_;if(!isDirected&&v>w){var tmp=v;v=w,w=tmp}return v+""+w+""+(_.isUndefined(name)?"\0":name)}function edgeArgsToObj(isDirected,v_,w_,name){var v=""+v_,w=""+w_;if(!isDirected&&v>w){var tmp=v;v=w,w=tmp}var edgeObj={v:v,w:w};return name&&(edgeObj.name=name),edgeObj}function edgeObjToId(isDirected,edgeObj){return edgeArgsToId(isDirected,edgeObj.v,edgeObj.w,edgeObj.name)}Graph.prototype._nodeCount=0,Graph.prototype._edgeCount=0,Graph.prototype.isDirected=function(){return this._isDirected},Graph.prototype.isMultigraph=function(){return this._isMultigraph},Graph.prototype.isCompound=function(){return this._isCompound},Graph.prototype.setGraph=function(label){return this._label=label,this},Graph.prototype.graph=function(){return this._label},Graph.prototype.setDefaultNodeLabel=function(newDefault){return _.isFunction(newDefault)||(newDefault=_.constant(newDefault)),this._defaultNodeLabelFn=newDefault,this},Graph.prototype.nodeCount=function(){return this._nodeCount},Graph.prototype.nodes=function(){return _.keys(this._nodes)},Graph.prototype.sources=function(){var self=this;return _.filter(this.nodes(),(function(v){return _.isEmpty(self._in[v])}))},Graph.prototype.sinks=function(){var self=this;return _.filter(this.nodes(),(function(v){return _.isEmpty(self._out[v])}))},Graph.prototype.setNodes=function(vs,value){var args=arguments,self=this;return _.each(vs,(function(v){args.length>1?self.setNode(v,value):self.setNode(v)})),this},Graph.prototype.setNode=function(v,value){return _.has(this._nodes,v)?(arguments.length>1&&(this._nodes[v]=value),this):(this._nodes[v]=arguments.length>1?value:this._defaultNodeLabelFn(v),this._isCompound&&(this._parent[v]="\0",this._children[v]={},this._children["\0"][v]=!0),this._in[v]={},this._preds[v]={},this._out[v]={},this._sucs[v]={},++this._nodeCount,this)},Graph.prototype.node=function(v){return this._nodes[v]},Graph.prototype.hasNode=function(v){return _.has(this._nodes,v)},Graph.prototype.removeNode=function(v){var self=this;if(_.has(this._nodes,v)){var removeEdge=function(e){self.removeEdge(self._edgeObjs[e])};delete this._nodes[v],this._isCompound&&(this._removeFromParentsChildList(v),delete this._parent[v],_.each(this.children(v),(function(child){self.setParent(child)})),delete this._children[v]),_.each(_.keys(this._in[v]),removeEdge),delete this._in[v],delete this._preds[v],_.each(_.keys(this._out[v]),removeEdge),delete this._out[v],delete this._sucs[v],--this._nodeCount}return this},Graph.prototype.setParent=function(v,parent){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(_.isUndefined(parent))parent="\0";else{for(var ancestor=parent+="";!_.isUndefined(ancestor);ancestor=this.parent(ancestor))if(ancestor===v)throw new Error("Setting "+parent+" as parent of "+v+" would create a cycle");this.setNode(parent)}return this.setNode(v),this._removeFromParentsChildList(v),this._parent[v]=parent,this._children[parent][v]=!0,this},Graph.prototype._removeFromParentsChildList=function(v){delete this._children[this._parent[v]][v]},Graph.prototype.parent=function(v){if(this._isCompound){var parent=this._parent[v];if("\0"!==parent)return parent}},Graph.prototype.children=function(v){if(_.isUndefined(v)&&(v="\0"),this._isCompound){var children=this._children[v];if(children)return _.keys(children)}else{if("\0"===v)return this.nodes();if(this.hasNode(v))return[]}},Graph.prototype.predecessors=function(v){var predsV=this._preds[v];if(predsV)return _.keys(predsV)},Graph.prototype.successors=function(v){var sucsV=this._sucs[v];if(sucsV)return _.keys(sucsV)},Graph.prototype.neighbors=function(v){var preds=this.predecessors(v);if(preds)return _.union(preds,this.successors(v))},Graph.prototype.isLeaf=function(v){return 0===(this.isDirected()?this.successors(v):this.neighbors(v)).length},Graph.prototype.filterNodes=function(filter){var copy=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});copy.setGraph(this.graph());var self=this;_.each(this._nodes,(function(value,v){filter(v)&&copy.setNode(v,value)})),_.each(this._edgeObjs,(function(e){copy.hasNode(e.v)&&copy.hasNode(e.w)&&copy.setEdge(e,self.edge(e))}));var parents={};return this._isCompound&&_.each(copy.nodes(),(function(v){copy.setParent(v,function findParent(v){var parent=self.parent(v);return void 0===parent||copy.hasNode(parent)?(parents[v]=parent,parent):parent in parents?parents[parent]:findParent(parent)}(v))})),copy},Graph.prototype.setDefaultEdgeLabel=function(newDefault){return _.isFunction(newDefault)||(newDefault=_.constant(newDefault)),this._defaultEdgeLabelFn=newDefault,this},Graph.prototype.edgeCount=function(){return this._edgeCount},Graph.prototype.edges=function(){return _.values(this._edgeObjs)},Graph.prototype.setPath=function(vs,value){var self=this,args=arguments;return _.reduce(vs,(function(v,w){return args.length>1?self.setEdge(v,w,value):self.setEdge(v,w),w})),this},Graph.prototype.setEdge=function(){var v,w,name,value,valueSpecified=!1,arg0=arguments[0];"object"==typeof arg0&&null!==arg0&&"v"in arg0?(v=arg0.v,w=arg0.w,name=arg0.name,2===arguments.length&&(value=arguments[1],valueSpecified=!0)):(v=arg0,w=arguments[1],name=arguments[3],arguments.length>2&&(value=arguments[2],valueSpecified=!0)),v=""+v,w=""+w,_.isUndefined(name)||(name=""+name);var e=edgeArgsToId(this._isDirected,v,w,name);if(_.has(this._edgeLabels,e))return valueSpecified&&(this._edgeLabels[e]=value),this;if(!_.isUndefined(name)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(v),this.setNode(w),this._edgeLabels[e]=valueSpecified?value:this._defaultEdgeLabelFn(v,w,name);var edgeObj=edgeArgsToObj(this._isDirected,v,w,name);return v=edgeObj.v,w=edgeObj.w,Object.freeze(edgeObj),this._edgeObjs[e]=edgeObj,incrementOrInitEntry(this._preds[w],v),incrementOrInitEntry(this._sucs[v],w),this._in[w][e]=edgeObj,this._out[v][e]=edgeObj,this._edgeCount++,this},Graph.prototype.edge=function(v,w,name){var e=1===arguments.length?edgeObjToId(this._isDirected,arguments[0]):edgeArgsToId(this._isDirected,v,w,name);return this._edgeLabels[e]},Graph.prototype.hasEdge=function(v,w,name){var e=1===arguments.length?edgeObjToId(this._isDirected,arguments[0]):edgeArgsToId(this._isDirected,v,w,name);return _.has(this._edgeLabels,e)},Graph.prototype.removeEdge=function(v,w,name){var e=1===arguments.length?edgeObjToId(this._isDirected,arguments[0]):edgeArgsToId(this._isDirected,v,w,name),edge=this._edgeObjs[e];return edge&&(v=edge.v,w=edge.w,delete this._edgeLabels[e],delete this._edgeObjs[e],decrementOrRemoveEntry(this._preds[w],v),decrementOrRemoveEntry(this._sucs[v],w),delete this._in[w][e],delete this._out[v][e],this._edgeCount--),this},Graph.prototype.inEdges=function(v,u){var inV=this._in[v];if(inV){var edges=_.values(inV);return u?_.filter(edges,(function(edge){return edge.v===u})):edges}},Graph.prototype.outEdges=function(v,w){var outV=this._out[v];if(outV){var edges=_.values(outV);return w?_.filter(edges,(function(edge){return edge.w===w})):edges}},Graph.prototype.nodeEdges=function(v,w){var inEdges=this.inEdges(v,w);if(inEdges)return inEdges.concat(this.outEdges(v,w))}},function(module,exports,__webpack_require__){var Map=__webpack_require__(141)(__webpack_require__(114),"Map");module.exports=Map},function(module,exports,__webpack_require__){var mapCacheClear=__webpack_require__(540),mapCacheDelete=__webpack_require__(547),mapCacheGet=__webpack_require__(549),mapCacheHas=__webpack_require__(550),mapCacheSet=__webpack_require__(551);function MapCache(entries){var index=-1,length=null==entries?0:entries.length;for(this.clear();++index<length;){var entry=entries[index];this.set(entry[0],entry[1])}}MapCache.prototype.clear=mapCacheClear,MapCache.prototype.delete=mapCacheDelete,MapCache.prototype.get=mapCacheGet,MapCache.prototype.has=mapCacheHas,MapCache.prototype.set=mapCacheSet,module.exports=MapCache},function(module,exports){module.exports=function(array,iteratee){for(var index=-1,length=null==array?0:array.length;++index<length&&!1!==iteratee(array[index],index,array););return array}},function(module,exports){module.exports=function(value){return"number"==typeof value&&value>-1&&value%1==0&&value<=9007199254740991}},function(module,exports,__webpack_require__){(function(module){var freeGlobal=__webpack_require__(327),freeExports=exports&&!exports.nodeType&&exports,freeModule=freeExports&&"object"==typeof module&&module&&!module.nodeType&&module,freeProcess=freeModule&&freeModule.exports===freeExports&&freeGlobal.process,nodeUtil=function(){try{var types=freeModule&&freeModule.require&&freeModule.require("util").types;return types||freeProcess&&freeProcess.binding&&freeProcess.binding("util")}catch(e){}}();module.exports=nodeUtil}).call(this,__webpack_require__(165)(module))},function(module,exports,__webpack_require__){var isPrototype=__webpack_require__(209),nativeKeys=__webpack_require__(557),hasOwnProperty=Object.prototype.hasOwnProperty;module.exports=function(object){if(!isPrototype(object))return nativeKeys(object);var result=[];for(var key in Object(object))hasOwnProperty.call(object,key)&&"constructor"!=key&&result.push(key);return result}},function(module,exports,__webpack_require__){var arrayFilter=__webpack_require__(334),stubArray=__webpack_require__(335),propertyIsEnumerable=Object.prototype.propertyIsEnumerable,nativeGetSymbols=Object.getOwnPropertySymbols,getSymbols=nativeGetSymbols?function(object){return null==object?[]:(object=Object(object),arrayFilter(nativeGetSymbols(object),(function(symbol){return propertyIsEnumerable.call(object,symbol)})))}:stubArray;module.exports=getSymbols},function(module,exports){module.exports=function(array,values){for(var index=-1,length=values.length,offset=array.length;++index<length;)array[offset+index]=values[index];return array}},function(module,exports,__webpack_require__){var Uint8Array=__webpack_require__(340);module.exports=function(arrayBuffer){var result=new arrayBuffer.constructor(arrayBuffer.byteLength);return new Uint8Array(result).set(new Uint8Array(arrayBuffer)),result}},function(module,exports){module.exports=function(value){return function(){return value}}},function(module,exports,__webpack_require__){var baseFor=__webpack_require__(262),keys=__webpack_require__(127);module.exports=function(object,iteratee){return object&&baseFor(object,iteratee,keys)}},function(module,exports,__webpack_require__){var baseFor=__webpack_require__(576)();module.exports=baseFor},function(module,exports){module.exports=function(set){var index=-1,result=Array(set.size);return set.forEach((function(value){result[++index]=value})),result}},function(module,exports,__webpack_require__){var isArray=__webpack_require__(80),isSymbol=__webpack_require__(156),reIsDeepProp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,reIsPlainProp=/^\w*$/;module.exports=function(value,object){if(isArray(value))return!1;var type=typeof value;return!("number"!=type&&"symbol"!=type&&"boolean"!=type&&null!=value&&!isSymbol(value))||(reIsPlainProp.test(value)||!reIsDeepProp.test(value)||null!=object&&value in Object(object))}},function(module,exports,__webpack_require__){var arrayPush=__webpack_require__(258),isFlattenable=__webpack_require__(610);module.exports=function baseFlatten(array,depth,predicate,isStrict,result){var index=-1,length=array.length;for(predicate||(predicate=isFlattenable),result||(result=[]);++index<length;){var value=array[index];depth>0&&predicate(value)?depth>1?baseFlatten(value,depth-1,predicate,isStrict,result):arrayPush(result,value):isStrict||(result[result.length]=value)}return result}},function(module,exports,__webpack_require__){var isSymbol=__webpack_require__(156);module.exports=function(array,iteratee,comparator){for(var index=-1,length=array.length;++index<length;){var value=array[index],current=iteratee(value);if(null!=current&&(void 0===computed?current==current&&!isSymbol(current):comparator(current,computed)))var computed=current,result=value}return result}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var react_1=__webpack_require__(14);exports.default=function(effect){react_1.useEffect(effect,[])}},,function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return getGroupsFromJobs})),__webpack_require__.d(__webpack_exports__,"b",(function(){return getTimeRangeFromSelection})),__webpack_require__.d(__webpack_exports__,"c",(function(){return normalizeTimes}));var _kbn_i18n__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2),moment__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(15),moment__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_1__),d3__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(105),d3__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(d3__WEBPACK_IMPORTED_MODULE_2__);function getGroupsFromJobs(jobs){const groups={},groupsMap={};return jobs.forEach(job=>{void 0!==job.groups&&job.groups.forEach(g=>{void 0===groups[g]?(groups[g]={id:g,jobIds:[job.job_id],timeRange:{to:job.timeRange.to,toMoment:null,from:job.timeRange.from,fromMoment:null,fromPx:job.timeRange.fromPx,toPx:job.timeRange.toPx,widthPx:null}},groupsMap[g]=[job.job_id]):(groups[g].jobIds.push(job.job_id),groupsMap[g].push(job.job_id),(null===groups[g].timeRange.to||job.timeRange.to>groups[g].timeRange.to)&&(groups[g].timeRange.to=job.timeRange.to,groups[g].timeRange.toMoment=job.timeRange.toMoment),(null===groups[g].timeRange.from||job.timeRange.from<groups[g].timeRange.from)&&(groups[g].timeRange.from=job.timeRange.from,groups[g].timeRange.fromMoment=job.timeRange.fromMoment),(null===groups[g].timeRange.toPx||job.timeRange.toPx>groups[g].timeRange.toPx)&&(groups[g].timeRange.toPx=job.timeRange.toPx),(null===groups[g].timeRange.fromPx||job.timeRange.fromPx<groups[g].timeRange.fromPx)&&(groups[g].timeRange.fromPx=job.timeRange.fromPx))})}),Object.keys(groups).forEach(groupId=>{const group=groups[groupId];group.timeRange.widthPx=group.timeRange.toPx-group.timeRange.fromPx,group.timeRange.toMoment=moment__WEBPACK_IMPORTED_MODULE_1___default()(group.timeRange.to),group.timeRange.fromMoment=moment__WEBPACK_IMPORTED_MODULE_1___default()(group.timeRange.from);const fromString=group.timeRange.fromMoment.format("MMM Do YYYY, HH:mm"),toString=group.timeRange.toMoment.format("MMM Do YYYY, HH:mm");group.timeRange.label=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.ml.jobSelectList.groupTimeRangeLabel",{defaultMessage:"{fromString} to {toString}",values:{fromString:fromString,toString:toString}})}),{groups:Object.keys(groups).map(g=>groups[g]),groupsMap:groupsMap}}function getTimeRangeFromSelection(jobs,selection){if(jobs.length>0){const times=[];if(jobs.forEach(job=>{selection.includes(job.job_id)&&(void 0!==job.timeRange.from&&times.push(job.timeRange.from),void 0!==job.timeRange.to&&times.push(job.timeRange.to))}),times.length){const extent=d3__WEBPACK_IMPORTED_MODULE_2___default.a.extent(times);return{from:moment__WEBPACK_IMPORTED_MODULE_1___default()(extent[0]).toISOString(),to:moment__WEBPACK_IMPORTED_MODULE_1___default()(extent[1]).toISOString()}}}}function normalizeTimes(jobs,dateFormatTz,ganttBarWidth){const jobsWithTimeRange=jobs.filter(job=>void 0!==job.timeRange.to&&void 0!==job.timeRange.from),min=Math.min(...jobsWithTimeRange.map(job=>+job.timeRange.from)),max=Math.max(...jobsWithTimeRange.map(job=>+job.timeRange.to)),ganttScale=d3__WEBPACK_IMPORTED_MODULE_2___default.a.scale.linear().domain([min,max]).range([1,ganttBarWidth]);return jobs.forEach(job=>{if(void 0!==job.timeRange.to&&void 0!==job.timeRange.from){job.timeRange.fromPx=ganttScale(job.timeRange.from),job.timeRange.toPx=ganttScale(job.timeRange.to),job.timeRange.widthPx=job.timeRange.toPx-job.timeRange.fromPx,job.timeRange.widthPx<1&&(job.timeRange.widthPx=1),job.timeRange.toMoment=moment__WEBPACK_IMPORTED_MODULE_1___default()(job.timeRange.to).tz(dateFormatTz),job.timeRange.fromMoment=moment__WEBPACK_IMPORTED_MODULE_1___default()(job.timeRange.from).tz(dateFormatTz);const fromString=job.timeRange.fromMoment.format("MMM Do YYYY, HH:mm"),toString=job.timeRange.toMoment.format("MMM Do YYYY, HH:mm");job.timeRange.label=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.ml.jobSelector.jobTimeRangeLabel",{defaultMessage:"{fromString} to {toString}",values:{fromString:fromString,toString:toString}})}else job.timeRange.widthPx=0,job.timeRange.fromPx=0,job.timeRange.toPx=0,job.timeRange.label=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.ml.jobSelector.noResultsForJobLabel",{defaultMessage:"No results"})}),jobs}},,,,,,,,,,,,,function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"getMlGlobalServices",(function(){return getMlGlobalServices})),__webpack_require__.d(__webpack_exports__,"renderApp",(function(){return renderApp}));var routes_namespaceObject={};__webpack_require__.r(routes_namespaceObject),__webpack_require__.d(routes_namespaceObject,"overviewRouteFactory",(function(){return overviewRouteFactory})),__webpack_require__.d(routes_namespaceObject,"appRootRouteFactory",(function(){return appRootRouteFactory})),__webpack_require__.d(routes_namespaceObject,"jobListRouteFactory",(function(){return jobListRouteFactory})),__webpack_require__.d(routes_namespaceObject,"indexOrSearchRouteFactory",(function(){return indexOrSearchRouteFactory})),__webpack_require__.d(routes_namespaceObject,"dataVizIndexOrSearchRouteFactory",(function(){return dataVizIndexOrSearchRouteFactory})),__webpack_require__.d(routes_namespaceObject,"jobTypeRouteFactory",(function(){return jobTypeRouteFactory})),__webpack_require__.d(routes_namespaceObject,"newJobRouteFactory",(function(){return newJobRouteFactory})),__webpack_require__.d(routes_namespaceObject,"singleMetricRouteFactory",(function(){return singleMetricRouteFactory})),__webpack_require__.d(routes_namespaceObject,"multiMetricRouteFactory",(function(){return multiMetricRouteFactory})),__webpack_require__.d(routes_namespaceObject,"populationRouteFactory",(function(){return populationRouteFactory})),__webpack_require__.d(routes_namespaceObject,"advancedRouteFactory",(function(){return advancedRouteFactory})),__webpack_require__.d(routes_namespaceObject,"categorizationRouteFactory",(function(){return categorizationRouteFactory})),__webpack_require__.d(routes_namespaceObject,"recognizeRouteFactory",(function(){return recognizeRouteFactory})),__webpack_require__.d(routes_namespaceObject,"checkViewOrCreateRouteFactory",(function(){return checkViewOrCreateRouteFactory})),__webpack_require__.d(routes_namespaceObject,"selectorRouteFactory",(function(){return selectorRouteFactory})),__webpack_require__.d(routes_namespaceObject,"indexBasedRouteFactory",(function(){return indexBasedRouteFactory})),__webpack_require__.d(routes_namespaceObject,"fileBasedRouteFactory",(function(){return fileBasedRouteFactory})),__webpack_require__.d(routes_namespaceObject,"settingsRouteFactory",(function(){return settingsRouteFactory})),__webpack_require__.d(routes_namespaceObject,"calendarListRouteFactory",(function(){return calendarListRouteFactory})),__webpack_require__.d(routes_namespaceObject,"newCalendarRouteFactory",(function(){return newCalendarRouteFactory})),__webpack_require__.d(routes_namespaceObject,"editCalendarRouteFactory",(function(){return editCalendarRouteFactory})),__webpack_require__.d(routes_namespaceObject,"filterListRouteFactory",(function(){return filterListRouteFactory})),__webpack_require__.d(routes_namespaceObject,"newFilterListRouteFactory",(function(){return newFilterListRouteFactory})),__webpack_require__.d(routes_namespaceObject,"editFilterListRouteFactory",(function(){return editFilterListRouteFactory})),__webpack_require__.d(routes_namespaceObject,"analyticsJobsListRouteFactory",(function(){return analyticsJobsListRouteFactory})),__webpack_require__.d(routes_namespaceObject,"analyticsJobExplorationRouteFactory",(function(){return analyticsJobExplorationRouteFactory})),__webpack_require__.d(routes_namespaceObject,"analyticsJobsCreationRouteFactory",(function(){return analyticsJobsCreationRouteFactory})),__webpack_require__.d(routes_namespaceObject,"modelsListRouteFactory",(function(){return modelsListRouteFactory})),__webpack_require__.d(routes_namespaceObject,"analyticsMapRouteFactory",(function(){return analyticsMapRouteFactory})),__webpack_require__.d(routes_namespaceObject,"timeSeriesExplorerRouteFactory",(function(){return timeSeriesExplorerRouteFactory})),__webpack_require__.d(routes_namespaceObject,"explorerRouteFactory",(function(){return explorerRouteFactory})),__webpack_require__.d(routes_namespaceObject,"accessDeniedRouteFactory",(function(){return accessDeniedRouteFactory}));var external_kbnSharedDeps_React_=__webpack_require__(14),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),external_kbnSharedDeps_ReactDom_=(__webpack_require__(453),__webpack_require__(46)),external_kbnSharedDeps_ReactDom_default=__webpack_require__.n(external_kbnSharedDeps_ReactDom_),public_=__webpack_require__(3),kibanaReact_public_=__webpack_require__(42),dependency_cache=__webpack_require__(22),license=__webpack_require__(96),external_kbnSharedDeps_ReactRouterDom_=__webpack_require__(44),contexts_kibana=__webpack_require__(63),ml=__webpack_require__(85),url_state=__webpack_require__(77),external_kbnSharedDeps_KbnI18n_=__webpack_require__(2),index_utils=__webpack_require__(82),external_kbnSharedDeps_Lodash_=__webpack_require__(7),data_public_=__webpack_require__(41),constants_search=__webpack_require__(101);const DEFAULT_QUERY={bool:{must:[{match_all:{}}]}};function getDefaultDatafeedQuery(){return Object(external_kbnSharedDeps_Lodash_.cloneDeep)(DEFAULT_QUERY)}var use_create_url=__webpack_require__(92),ml_url_generator=__webpack_require__(0);const useResolver=(indexPatternId,savedSearchId,config,resolvers)=>{const notifications=Object(contexts_kibana.f)(),funcNames=Object.keys(resolvers),funcs=Object.values(resolvers),tempResults=funcNames.reduce((p,c)=>(p[c]={},p),{}),[context,setContext]=Object(external_kbnSharedDeps_React_.useState)(null),[results,setResults]=Object(external_kbnSharedDeps_React_.useState)(tempResults),redirectToJobsManagementPage=Object(use_create_url.a)(ml_url_generator.b.ANOMALY_DETECTION_JOBS_MANAGE);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{(async()=>{try{(await Promise.all(funcs.map(r=>r()))).forEach((r,i)=>tempResults[funcNames[i]]=r),setResults(tempResults)}catch(error){return}try{if(""===indexPatternId)throw new Error(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.useResolver.errorIndexPatternIdEmptyString",{defaultMessage:"indexPatternId must not be empty string."}));let indexPatternAndSavedSearch={savedSearch:null,indexPattern:null};void 0!==savedSearchId?indexPatternAndSavedSearch=await Object(index_utils.a)(savedSearchId):void 0!==indexPatternId&&(indexPatternAndSavedSearch.indexPattern=await Object(index_utils.b)(indexPatternId));const{savedSearch:savedSearch,indexPattern:indexPattern}=indexPatternAndSavedSearch,{combinedQuery:combinedQuery}=function(kibanaConfig,indexPattern,savedSearch){let query={query:"",language:"lucene"},combinedQuery=getDefaultDatafeedQuery();if(null!==savedSearch){const data=Object(index_utils.f)(savedSearch);query=data.query;const filter=data.filter,filters=Array.isArray(filter)?filter:[];if(query.language===constants_search.c.KUERY){const ast=data_public_.esKuery.fromKueryExpression(query.query);""!==query.query&&(combinedQuery=data_public_.esKuery.toElasticsearchQuery(ast,indexPattern));const filterQuery=data_public_.esQuery.buildQueryFromFilters(filters,indexPattern);!1===Array.isArray(combinedQuery.bool.filter)&&(combinedQuery.bool.filter=void 0===combinedQuery.bool.filter?[]:[combinedQuery.bool.filter]),!1===Array.isArray(combinedQuery.bool.must_not)&&(combinedQuery.bool.must_not=void 0===combinedQuery.bool.must_not?[]:[combinedQuery.bool.must_not]),combinedQuery.bool.filter=[...combinedQuery.bool.filter,...filterQuery.filter],combinedQuery.bool.must_not=[...combinedQuery.bool.must_not,...filterQuery.must_not]}else{const esQueryConfigs=data_public_.esQuery.getEsQueryConfig(kibanaConfig);combinedQuery=data_public_.esQuery.buildEsQuery(indexPattern,[query],filters,esQueryConfigs)}}return{query:query,combinedQuery:combinedQuery}}(config,null!==indexPattern?indexPattern:void 0,savedSearch);setContext({combinedQuery:combinedQuery,currentIndexPattern:indexPattern,currentSavedSearch:savedSearch,indexPatterns:Object(index_utils.e)(),kibanaConfig:config})}catch(error){notifications.toasts.addError(new Error(error),{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.useResolver.errorTitle",{defaultMessage:"An error has occurred"})}),await redirectToJobsManagementPage()}})()},[]),{context:context,results:results}};var check_capabilities=__webpack_require__(68),ml_nodes_check=__webpack_require__(125),ml_server_info=__webpack_require__(88);const breadcrumbs={ML_BREADCRUMB:Object.freeze({text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.machineLearningBreadcrumbLabel",{defaultMessage:"Machine Learning"}),href:"/"}),SETTINGS_BREADCRUMB:Object.freeze({text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.settingsBreadcrumbLabel",{defaultMessage:"Settings"}),href:"/settings"}),ANOMALY_DETECTION_BREADCRUMB:Object.freeze({text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.anomalyDetectionBreadcrumbLabel",{defaultMessage:"Anomaly Detection"}),href:"/jobs"}),DATA_FRAME_ANALYTICS_BREADCRUMB:Object.freeze({text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataFrameAnalyticsLabel",{defaultMessage:"Data Frame Analytics"}),href:"/data_frame_analytics"}),DATA_VISUALIZER_BREADCRUMB:Object.freeze({text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.datavisualizerBreadcrumbLabel",{defaultMessage:"Data Visualizer"}),href:"/datavisualizer"}),CREATE_JOB_BREADCRUMB:Object.freeze({text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.createJobsBreadcrumbLabel",{defaultMessage:"Create job"}),href:"/jobs/new_job"}),CALENDAR_MANAGEMENT_BREADCRUMB:Object.freeze({text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.settings.breadcrumbs.calendarManagementLabel",{defaultMessage:"Calendar management"}),href:"/settings/calendars_list"}),FILTER_LISTS_BREADCRUMB:Object.freeze({text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.settings.breadcrumbs.filterListsLabel",{defaultMessage:"Filter lists"}),href:"/settings/filter_lists"})},breadcrumbOnClickFactory=(path,navigateToPath)=>e=>{e.preventDefault(),navigateToPath(path)},getBreadcrumbWithUrlForApp=(breadcrumbName,navigateToPath,basePath)=>({text:breadcrumbs[breadcrumbName].text,href:`${basePath}/app/ml${breadcrumbs[breadcrumbName].href}`,onClick:breadcrumbOnClickFactory(breadcrumbs[breadcrumbName].href,navigateToPath)});function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const OverviewPage=external_kbnSharedDeps_React_default.a.lazy(()=>__webpack_require__.e(21).then(__webpack_require__.bind(null,882))),overviewRouteFactory=(navigateToPath,basePath)=>({path:"/overview",render:(props,deps)=>external_kbnSharedDeps_React_default.a.createElement(PageWrapper,_extends({},props,{deps:deps})),breadcrumbs:[getBreadcrumbWithUrlForApp("ML_BREADCRUMB",navigateToPath,basePath),{text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.overview.overviewLabel",{defaultMessage:"Overview"}),onClick:breadcrumbOnClickFactory("/overview",navigateToPath)}]}),PageWrapper=({deps:deps})=>{const{redirectToMlAccessDeniedPage:redirectToMlAccessDeniedPage}=deps,{context:context}=useResolver(void 0,void 0,deps.config,{checkFullLicense:license.b,checkGetJobsCapabilities:()=>Object(check_capabilities.c)(redirectToMlAccessDeniedPage),getMlNodeCount:ml_nodes_check.b,loadMlServerInfo:ml_server_info.e});return Object(contexts_kibana.g)({timeRangeSelector:!1,autoRefreshSelector:!1}),external_kbnSharedDeps_React_default.a.createElement(PageLoader,{context:context},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Suspense,{fallback:null},external_kbnSharedDeps_React_default.a.createElement(OverviewPage,null)))},appRootRouteFactory=(navigateToPath,basePath)=>({path:"/",render:()=>external_kbnSharedDeps_React_default.a.createElement(Page,null),breadcrumbs:[]}),Page=()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Redirect,{to:"/overview"});var useObservable=__webpack_require__(134),useObservable_default=__webpack_require__.n(useObservable),jobs_list=__webpack_require__(191),timefilter_refresh_service=__webpack_require__(192),check_ml_nodes=__webpack_require__(83);const basicResolvers=({indexPatterns:indexPatterns,redirectToMlAccessDeniedPage:redirectToMlAccessDeniedPage})=>({checkFullLicense:license.b,getMlNodeCount:check_ml_nodes.c,loadMlServerInfo:ml_server_info.e,loadIndexPatterns:()=>Object(index_utils.h)(indexPatterns),checkGetJobsCapabilities:()=>Object(check_capabilities.c)(redirectToMlAccessDeniedPage),loadSavedSearches:index_utils.i});var jobs_list_jobs=__webpack_require__(241),annotations_service=__webpack_require__(136),ml_annotation_updates_context=__webpack_require__(138);function jobs_list_extends(){return(jobs_list_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const jobListRouteFactory=(navigateToPath,basePath)=>({path:"/jobs",render:(props,deps)=>external_kbnSharedDeps_React_default.a.createElement(jobs_list_PageWrapper,jobs_list_extends({},props,{deps:deps})),breadcrumbs:[getBreadcrumbWithUrlForApp("ML_BREADCRUMB",navigateToPath,basePath),getBreadcrumbWithUrlForApp("ANOMALY_DETECTION_BREADCRUMB",navigateToPath,basePath),{text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.anomalyDetection.jobManagementLabel",{defaultMessage:"Job Management"}),href:""}]}),jobs_list_PageWrapper=({deps:deps})=>{var _mlTimefilterRefresh$,_globalState$refreshI,_globalState$refreshI2,_globalState$refreshI3,_globalState$refreshI4;const{context:context}=useResolver(void 0,void 0,deps.config,basicResolvers(deps)),timefilter=Object(contexts_kibana.g)({timeRangeSelector:!1,autoRefreshSelector:!0}),[globalState,setGlobalState]=Object(url_state.c)("_g"),mlTimefilterRefresh=useObservable_default()(timefilter_refresh_service.a),lastRefresh=null!==(_mlTimefilterRefresh$=null==mlTimefilterRefresh?void 0:mlTimefilterRefresh.lastRefresh)&&void 0!==_mlTimefilterRefresh$?_mlTimefilterRefresh$:0,refreshValue=null!==(_globalState$refreshI=null==globalState||null===(_globalState$refreshI2=globalState.refreshInterval)||void 0===_globalState$refreshI2?void 0:_globalState$refreshI2.value)&&void 0!==_globalState$refreshI?_globalState$refreshI:0,refreshPause=null===(_globalState$refreshI3=null==globalState||null===(_globalState$refreshI4=globalState.refreshInterval)||void 0===_globalState$refreshI4?void 0:_globalState$refreshI4.pause)||void 0===_globalState$refreshI3||_globalState$refreshI3,blockRefresh=0===refreshValue||!0===refreshPause;Object(external_kbnSharedDeps_React_.useEffect)(()=>{const refreshInterval=0===refreshValue&&!0===refreshPause?{pause:!1,value:jobs_list.a}:{pause:refreshPause,value:refreshValue};setGlobalState({refreshInterval:refreshInterval},void 0,!0),timefilter.setRefreshInterval(refreshInterval)},[]);const annotationUpdatesService=Object(external_kbnSharedDeps_React_.useMemo)(()=>new annotations_service.a,[]);return external_kbnSharedDeps_React_default.a.createElement(PageLoader,{context:context},external_kbnSharedDeps_React_default.a.createElement(ml_annotation_updates_context.a.Provider,{value:annotationUpdatesService},external_kbnSharedDeps_React_default.a.createElement(jobs_list_jobs.a,{blockRefresh:blockRefresh,lastRefresh:lastRefresh})))};var external_kbnSharedDeps_ElasticEui_=__webpack_require__(39),external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(40),savedObjects_public_=__webpack_require__(57);const page_Page=({nextStepPath:nextStepPath})=>{const{uiSettings:uiSettings,savedObjects:savedObjects}=Object(contexts_kibana.b)().services,navigateToPath=Object(contexts_kibana.e)();return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPage,{"data-test-subj":"mlPageSourceSelection"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageBody,{restrictWidth:1200},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageHeader,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageHeaderSection,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"m"},external_kbnSharedDeps_React_default.a.createElement("h1",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.selectIndexPatternOrSavedSearch",defaultMessage:"Select index pattern or saved search"}))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageContent,null,external_kbnSharedDeps_React_default.a.createElement(savedObjects_public_.SavedObjectFinderUi,{key:"searchSavedObjectFinder",onChoose:(id,type)=>{navigateToPath(`${nextStepPath}?${"index-pattern"===type?"index":"savedSearchId"}=${encodeURIComponent(id)}`)},showFilter:!0,noItemsMessage:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.searchSelection.notFoundLabel",{defaultMessage:"No matching indices or saved searches found."}),savedObjectMetaData:[{type:"search",getIconForSavedObject:()=>"search",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.searchSelection.savedObjectType.search",{defaultMessage:"Saved search"})},{type:"index-pattern",getIconForSavedObject:()=>"indexPatternApp",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.searchSelection.savedObjectType.indexPattern",{defaultMessage:"Index pattern"})}],fixedPageSize:20,uiSettings:uiSettings,savedObjects:savedObjects}))))};var MODE,job_service=__webpack_require__(70),new_job=__webpack_require__(74);async function preConfiguredJobRedirect(indexPatterns,basePath,navigateToUrl){const{createdBy:createdBy,job:job,datafeed:datafeed}=job_service.a.tempJobCloningObjects;if(!job||!datafeed)return Promise.resolve();try{await Object(index_utils.h)(indexPatterns);const redirectUrl=function(createdBy,job,datafeed){let page="";switch(createdBy){case new_job.a.SINGLE_METRIC:page=new_job.f.SINGLE_METRIC;break;case new_job.a.MULTI_METRIC:page=new_job.f.MULTI_METRIC;break;case new_job.a.POPULATION:page=new_job.f.POPULATION;break;case new_job.a.CATEGORIZATION:page=new_job.f.CATEGORIZATION;break;default:page=new_job.f.ADVANCED}const indexPatternId=Object(index_utils.c)(datafeed.indices.join());return`jobs/new_job/${page}?index=${indexPatternId}&_g=()`}(createdBy,0,datafeed);return await navigateToUrl(`${basePath}/app/ml/${redirectUrl}`),Promise.reject()}catch(error){return Promise.resolve()}}function index_or_search_extends(){return(index_or_search_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}!function(MODE){MODE[MODE.NEW_JOB=0]="NEW_JOB",MODE[MODE.DATAVISUALIZER=1]="DATAVISUALIZER"}(MODE||(MODE={}));const getBreadcrumbs=(navigateToPath,basePath)=>[getBreadcrumbWithUrlForApp("ML_BREADCRUMB",navigateToPath,basePath),getBreadcrumbWithUrlForApp("ANOMALY_DETECTION_BREADCRUMB",navigateToPath,basePath),{text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsBreadcrumbs.selectIndexOrSearchLabel",{defaultMessage:"Create job"}),href:""}],indexOrSearchRouteFactory=(navigateToPath,basePath)=>({path:"/jobs/new_job/step/index_or_search",render:(props,deps)=>external_kbnSharedDeps_React_default.a.createElement(index_or_search_PageWrapper,index_or_search_extends({},props,{nextStepPath:"/jobs/new_job/step/job_type",deps:deps,mode:MODE.NEW_JOB})),breadcrumbs:getBreadcrumbs(navigateToPath,basePath)}),dataVizIndexOrSearchRouteFactory=(navigateToPath,basePath)=>({path:"/datavisualizer_index_select",render:(props,deps)=>external_kbnSharedDeps_React_default.a.createElement(index_or_search_PageWrapper,index_or_search_extends({},props,{nextStepPath:"/jobs/new_job/datavisualizer",deps:deps,mode:MODE.DATAVISUALIZER})),breadcrumbs:getBreadcrumbs(navigateToPath,basePath)}),index_or_search_PageWrapper=({nextStepPath:nextStepPath,deps:deps,mode:mode})=>{const{services:{http:{basePath:basePath},application:{navigateToUrl:navigateToUrl}}}=Object(contexts_kibana.b)(),{redirectToMlAccessDeniedPage:redirectToMlAccessDeniedPage}=deps,redirectToJobsManagementPage=Object(use_create_url.a)(ml_url_generator.b.ANOMALY_DETECTION_JOBS_MANAGE),newJobResolvers={...basicResolvers(deps),preConfiguredJobRedirect:()=>preConfiguredJobRedirect(deps.indexPatterns,basePath.get(),navigateToUrl)},dataVizResolvers={checkBasicLicense:license.a,loadIndexPatterns:()=>Object(index_utils.h)(deps.indexPatterns),checkGetJobsCapabilities:()=>Object(check_capabilities.c)(redirectToMlAccessDeniedPage),checkMlNodesAvailable:()=>Object(ml_nodes_check.a)(redirectToJobsManagementPage)},{context:context}=useResolver(void 0,void 0,deps.config,mode===MODE.NEW_JOB?newJobResolvers:dataVizResolvers);return external_kbnSharedDeps_React_default.a.createElement(PageLoader,{context:context},external_kbnSharedDeps_React_default.a.createElement(page_Page,{nextStepPath:nextStepPath}))};var query_string=__webpack_require__(148);function isSavedSearchSavedObject(ss){return null!==ss}function link_card_extends(){return(link_card_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const LinkCard=({icon:icon,iconAreaLabel:iconAreaLabel,title:title,description:description,onClick:onClick,href:href,isDisabled:isDisabled,"data-test-subj":dateTestSubj})=>{const linkHrefAndOnClickProps={...href?{href:href}:{},...onClick?{onClick:onClick}:{}};return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPanel,{style:{cursor:isDisabled?"not-allowed":void 0}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,link_card_extends({style:{display:"block",pointerEvents:isDisabled?"none":void 0,background:"transparent",outline:"none"},"data-test-subj":dateTestSubj,color:"subdued"},linkHrefAndOnClickProps),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"l",responsive:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,style:{paddingTop:"8px"}},"string"==typeof icon?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{size:"xl",type:icon,"aria-label":iconAreaLabel}):icon),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"s"},external_kbnSharedDeps_React_default.a.createElement("h3",null,title)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{color:"subdued"},external_kbnSharedDeps_React_default.a.createElement("p",null,description))))))},RecognizedResult=({config:config,indexPattern:indexPattern,savedSearch:savedSearch})=>{const{services:{http:{basePath:basePath}}}=Object(contexts_kibana.b)(),id=null===savedSearch?"index="+indexPattern.id:"savedSearchId="+savedSearch.id,href=`${basePath.get()}/app/ml/jobs/new_job/recognize?id=${config.id}&${id}`;let logo=null;return logo=config.logo&&config.logo.icon?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{type:config.logo.icon,size:"xl"}):config.logo&&config.logo.src?external_kbnSharedDeps_React_default.a.createElement("img",{alt:"",src:config.logo.src}):external_kbnSharedDeps_React_default.a.createElement("h3",{className:"euiTitle euiTitle--small"},config.id),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(LinkCard,{"data-test-subj":"mlRecognizerCard "+config.id,href:href,title:config.title,description:config.description,icon:logo}))};var ml_api_service=__webpack_require__(64);class data_recognizer_DataRecognizer extends external_kbnSharedDeps_React_.Component{constructor(props){super(props),this.state={results:[]},this.indexPattern=props.indexPattern,this.savedSearch=props.savedSearch,this.className=props.className,this.results=props.results}componentDidMount(){ml_api_service.ml.recognizeIndex({indexPatternTitle:this.indexPattern.title}).then(resp=>{resp.sort((res1,res2)=>res1.title.localeCompare(res2.title));const results=resp.map(r=>external_kbnSharedDeps_React_default.a.createElement(RecognizedResult,{key:r.id,config:r,indexPattern:this.indexPattern,savedSearch:this.savedSearch}));"object"==typeof this.results&&(this.results.count=results.length,"function"==typeof this.results.onChange&&this.results.onChange()),this.setState({results:results})}).catch(e=>{console.error("Error attempting to recognize index",e)})}render(){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,this.state.results)}}var recently_accessed=__webpack_require__(194);const CategorizationIcon=external_kbnSharedDeps_React_default.a.createElement("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"},external_kbnSharedDeps_React_default.a.createElement("path",{d:"M16 32C7.16344 32 0 24.8366 0 16C0 7.16344 7.16344 0 16 0C24.8366 0 32 7.16344 32 16H30C30 8.26801 23.732 2 16 2C8.26801 2 2 8.26801 2 16C2 23.732 8.26801 30 16 30V32Z",fill:"#343741"}),external_kbnSharedDeps_React_default.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M17 15H23V17H17V23H15V17H9V15H15V9H17V15ZM32 30V32H20V30H32ZM32 22L20 22V24L32 24V22ZM32 26V28H20V26H32Z",fill:"#017D73"})),job_type_page_Page=()=>{const mlContext=Object(ml.b)(),navigateToPath=Object(contexts_kibana.e)(),onSelectDifferentIndex=Object(use_create_url.a)(ml_url_generator.b.ANOMALY_DETECTION_CREATE_JOB_SELECT_INDEX),[recognizerResultsCount,setRecognizerResultsCount]=Object(external_kbnSharedDeps_React_.useState)(0),{currentSavedSearch:currentSavedSearch,currentIndexPattern:currentIndexPattern}=mlContext,isTimeBasedIndex=Object(index_utils.j)(currentIndexPattern),indexWarningTitle=!isTimeBasedIndex&&isSavedSearchSavedObject(currentSavedSearch)?external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.jobType.indexPatternFromSavedSearchNotTimeBasedMessage",{defaultMessage:"{savedSearchTitle} uses index pattern {indexPatternTitle} which is not time based",values:{savedSearchTitle:currentSavedSearch.attributes.title,indexPatternTitle:currentIndexPattern.title}}):external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.jobType.indexPatternNotTimeBasedMessage",{defaultMessage:"Index pattern {indexPatternTitle} is not time based",values:{indexPatternTitle:currentIndexPattern.title}}),pageTitleLabel=isSavedSearchSavedObject(currentSavedSearch)?external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.jobType.savedSearchPageTitleLabel",{defaultMessage:"saved search {savedSearchTitle}",values:{savedSearchTitle:currentSavedSearch.attributes.title}}):external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.jobType.indexPatternPageTitleLabel",{defaultMessage:"index pattern {indexPatternTitle}",values:{indexPatternTitle:currentIndexPattern.title}}),recognizerResults={count:0,onChange(){setRecognizerResultsCount(recognizerResults.count)}},getUrlParams=()=>isSavedSearchSavedObject(currentSavedSearch)?"?savedSearchId="+currentSavedSearch.id:"?index="+currentIndexPattern.id,jobTypes=[{onClick:()=>navigateToPath("/jobs/new_job/single_metric"+getUrlParams()),icon:{type:"createSingleMetricJob",ariaLabel:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.jobType.singleMetricAriaLabel",{defaultMessage:"Single metric job"})},title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.jobType.singleMetricTitle",{defaultMessage:"Single metric"}),description:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.jobType.singleMetricDescription",{defaultMessage:"Detect anomalies in a single time series."}),id:"mlJobTypeLinkSingleMetricJob"},{onClick:()=>navigateToPath("/jobs/new_job/multi_metric"+getUrlParams()),icon:{type:"createMultiMetricJob",ariaLabel:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.jobType.multiMetricAriaLabel",{defaultMessage:"Multi-metric job"})},title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.jobType.multiMetricTitle",{defaultMessage:"Multi-metric"}),description:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.jobType.multiMetricDescription",{defaultMessage:"Detect anomalies with one or more metrics and optionally split the analysis."}),id:"mlJobTypeLinkMultiMetricJob"},{onClick:()=>navigateToPath("/jobs/new_job/population"+getUrlParams()),icon:{type:"createPopulationJob",ariaLabel:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.jobType.populationAriaLabel",{defaultMessage:"Population job"})},title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.jobType.populationTitle",{defaultMessage:"Population"}),description:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.jobType.populationDescription",{defaultMessage:"Detect activity that is unusual compared to the behavior of the population."}),id:"mlJobTypeLinkPopulationJob"},{onClick:()=>navigateToPath("/jobs/new_job/advanced"+getUrlParams()),icon:{type:"createAdvancedJob",ariaLabel:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.jobType.advancedAriaLabel",{defaultMessage:"Advanced job"})},title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.jobType.advancedTitle",{defaultMessage:"Advanced"}),description:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.jobType.advancedDescription",{defaultMessage:"Use the full range of options to create a job for more advanced use cases."}),id:"mlJobTypeLinkAdvancedJob"},{onClick:()=>navigateToPath("/jobs/new_job/categorization"+getUrlParams()),icon:{type:CategorizationIcon,ariaLabel:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.jobType.categorizationAriaLabel",{defaultMessage:"Categorization job"})},title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.jobType.categorizationTitle",{defaultMessage:"Categorization"}),description:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.jobType.categorizationDescription",{defaultMessage:"Group log messages into categories and detect anomalies within them."}),id:"mlJobTypeLinkCategorizationJob"}];return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPage,{"data-test-subj":"mlPageJobTypeSelection"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageBody,{restrictWidth:1200},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"l"},external_kbnSharedDeps_React_default.a.createElement("h1",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobType.createJobFromTitle",defaultMessage:"Create a job from the {pageTitleLabel}",values:{pageTitleLabel:pageTitleLabel}}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),!1===isTimeBasedIndex&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:indexWarningTitle,color:"warning",iconType:"alert"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobType.howToRunAnomalyDetectionDescription",defaultMessage:"Anomaly detection can only be run over indices which are time based."}),external_kbnSharedDeps_React_default.a.createElement("br",null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{onClick:onSelectDifferentIndex},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobType.selectDifferentIndexLinkText",defaultMessage:"Select a different index"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"xxl"})),external_kbnSharedDeps_React_default.a.createElement("div",{hidden:0===recognizerResultsCount},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"s"},external_kbnSharedDeps_React_default.a.createElement("h2",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobType.useSuppliedConfigurationTitle",defaultMessage:"Use preconfigured jobs"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobType.useSuppliedConfigurationDescription",defaultMessage:"The fields in your data match known configurations. Create a set of preconfigured jobs."}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGrid,{gutterSize:"l",columns:4},external_kbnSharedDeps_React_default.a.createElement(data_recognizer_DataRecognizer,{indexPattern:currentIndexPattern,savedSearch:currentSavedSearch,results:recognizerResults})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"xxl"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"s"},external_kbnSharedDeps_React_default.a.createElement("h2",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobType.useWizardTitle",defaultMessage:"Use a wizard"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGrid,{gutterSize:"l",columns:4},jobTypes.map(({onClick:onClick,icon:icon,title:title,description:description,id:id})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{key:id},external_kbnSharedDeps_React_default.a.createElement(LinkCard,{"data-test-subj":id,onClick:onClick,icon:icon.type,iconAreaLabel:icon.ariaLabel,title:title,description:description,isDisabled:!isTimeBasedIndex})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"xxl"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"s"},external_kbnSharedDeps_React_default.a.createElement("h3",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobType.learnMoreAboutDataTitle",defaultMessage:"Learn more about your data"}))),external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobType.learnMoreAboutDataDescription",defaultMessage:"If you're not sure what type of job to create, first explore the fields and metrics in your data."}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGrid,{gutterSize:"l",columns:4},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(LinkCard,{icon:"dataVisualizer",iconAreaLabel:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.jobType.dataVisualizerAriaLabel",{defaultMessage:"Data Visualizer"}),title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobType.dataVisualizerTitle",defaultMessage:"Data Visualizer"}),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobType.dataVisualizerDescription",defaultMessage:"Learn more about the characteristics of your data and identify the fields for analysis with machine learning."}),onClick:()=>{const title=isSavedSearchSavedObject(currentSavedSearch)?currentSavedSearch.attributes.title:currentIndexPattern.title;Object(recently_accessed.a)("jobs/new_job/datavisualizer",title,""),navigateToPath("/jobs/new_job/datavisualizer"+getUrlParams())}})))))};function job_type_extends(){return(job_type_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const jobTypeRouteFactory=(navigateToPath,basePath)=>({path:"/jobs/new_job/step/job_type",render:(props,deps)=>external_kbnSharedDeps_React_default.a.createElement(job_type_PageWrapper,job_type_extends({},props,{deps:deps})),breadcrumbs:[getBreadcrumbWithUrlForApp("ML_BREADCRUMB",navigateToPath,basePath),getBreadcrumbWithUrlForApp("ANOMALY_DETECTION_BREADCRUMB",navigateToPath,basePath),{text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsBreadcrumbs.selectJobType",{defaultMessage:"Create job"}),href:""}]}),job_type_PageWrapper=({location:location,deps:deps})=>{const{index:index,savedSearchId:savedSearchId}=Object(query_string.parse)(location.search,{sort:!1}),{context:context}=useResolver(index,savedSearchId,deps.config,basicResolvers(deps));return external_kbnSharedDeps_React_default.a.createElement(PageLoader,{context:context},external_kbnSharedDeps_React_default.a.createElement(job_type_page_Page,null))},newJobRouteFactory=()=>({path:"/jobs/new_job",render:()=>external_kbnSharedDeps_React_default.a.createElement(new_job_Page,null),breadcrumbs:[]}),new_job_Page=()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Redirect,{to:"/jobs/new_job/step/index_or_search"});var external_kbnSharedDeps_Rxjs_=__webpack_require__(23),external_kbnSharedDeps_RxjsOperators_=__webpack_require__(25),job_utils=__webpack_require__(69),job_creator=__webpack_require__(95),util=__webpack_require__(169);let VALIDATOR_SEVERITY;!function(VALIDATOR_SEVERITY){VALIDATOR_SEVERITY[VALIDATOR_SEVERITY.ERROR=0]="ERROR",VALIDATOR_SEVERITY[VALIDATOR_SEVERITY.WARNING=1]="WARNING"}(VALIDATOR_SEVERITY||(VALIDATOR_SEVERITY={}));const jobExistsErrorMessage=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.validateJob.asyncJobNameAlreadyExists",{defaultMessage:"Job ID already exists. A job ID cannot be the same as an existing job or group."}),groupExistsErrorMessage=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.validateJob.asyncGroupNameAlreadyExists",{defaultMessage:"Group ID already exists. A group ID cannot be the same as an existing group or job."});function jobIdValidator(jobCreator$){return jobCreator$.pipe(Object(external_kbnSharedDeps_RxjsOperators_.map)(jobCreator=>jobCreator.jobId),Object(external_kbnSharedDeps_RxjsOperators_.distinctUntilChanged)((prevJobId,currJobId)=>prevJobId===currJobId),Object(external_kbnSharedDeps_RxjsOperators_.switchMap)(jobId=>ml_api_service.ml.jobs.jobsExist$([jobId],!0)),Object(external_kbnSharedDeps_RxjsOperators_.map)(jobExistsResults=>{const jobs=Object.values(jobExistsResults),valid=!1===(null==jobs?void 0:jobs[0].exists);return{jobIdExists:{valid:valid,...valid?{}:{message:jobExistsErrorMessage}}}}))}function groupIdsValidator(jobCreator$){return jobCreator$.pipe(Object(external_kbnSharedDeps_RxjsOperators_.map)(jobCreator=>jobCreator.groups),Object(external_kbnSharedDeps_RxjsOperators_.distinctUntilChanged)((prevGroups,currGroups)=>JSON.stringify(prevGroups)===JSON.stringify(currGroups)),Object(external_kbnSharedDeps_RxjsOperators_.switchMap)(groups=>ml_api_service.ml.jobs.jobsExist$(groups,!0)),Object(external_kbnSharedDeps_RxjsOperators_.map)(jobExistsResults=>{const valid=!1===Object.values(jobExistsResults).some(g=>!0===g.exists&&!1===g.isGroup);return{groupIdsExist:{valid:valid,...valid?{}:{message:groupExistsErrorMessage}}}}))}var categorization_job=__webpack_require__(150);function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class job_validator_JobValidator{constructor(jobCreator){var jobCreator$;_defineProperty(this,"_jobCreator",void 0),_defineProperty(this,"_validationSummary",void 0),_defineProperty(this,"_lastJobConfig",void 0),_defineProperty(this,"_lastDatafeedConfig",void 0),_defineProperty(this,"_validateTimeout",null),_defineProperty(this,"_asyncValidators$",[]),_defineProperty(this,"_asyncValidatorsResult$",void 0),_defineProperty(this,"_basicValidations",{jobId:{valid:!0},groupIds:{valid:!0},modelMemoryLimit:{valid:!0},bucketSpan:{valid:!0},duplicateDetectors:{valid:!0},query:{valid:!0},queryDelay:{valid:!0},frequency:{valid:!0},scrollSize:{valid:!0},categorizerMissingPerPartition:{valid:!0},categorizerVaryingPerPartitionField:{valid:!0},summaryCountField:{valid:!0}}),_defineProperty(this,"_advancedValidations",{categorizationFieldValid:{valid:!0}}),_defineProperty(this,"_validating",!1),_defineProperty(this,"_basicValidationResult$",new external_kbnSharedDeps_Rxjs_.ReplaySubject(2)),_defineProperty(this,"_jobCreatorSubject$",new external_kbnSharedDeps_Rxjs_.Subject),_defineProperty(this,"validationResult$",void 0),_defineProperty(this,"latestValidationResult",this._basicValidations),this._jobCreator=jobCreator,this._lastJobConfig=this._jobCreator.formattedJobJson,this._lastDatafeedConfig=this._jobCreator.formattedDatafeedJson,this._validationSummary={basic:!1,advanced:!1},this._asyncValidators$=[(jobCreator$=this._jobCreatorSubject$,Object(external_kbnSharedDeps_Rxjs_.combineLatest)([jobCreator$.pipe(Object(external_kbnSharedDeps_RxjsOperators_.pluck)("modelPlot")),jobCreator$.pipe(Object(external_kbnSharedDeps_RxjsOperators_.filter)(jobCreator=>null==jobCreator?void 0:jobCreator.modelPlot),Object(external_kbnSharedDeps_RxjsOperators_.map)(jobCreator=>({jobCreator:jobCreator,analysisConfigString:JSON.stringify(jobCreator.jobConfig.analysis_config,null,2)})),Object(external_kbnSharedDeps_RxjsOperators_.distinctUntilChanged)((prev,curr)=>prev.analysisConfigString===curr.analysisConfigString),Object(external_kbnSharedDeps_RxjsOperators_.switchMap)(({jobCreator:jobCreator})=>ml_api_service.ml.validateCardinality$({...jobCreator.jobConfig,datafeed_config:jobCreator.datafeedConfig}).pipe(Object(external_kbnSharedDeps_RxjsOperators_.map)(validationResults=>{for(const validationResult of validationResults)if(void 0!==validationResult.modelPlotCardinality)return{highCardinality:{value:validationResult.modelPlotCardinality,severity:VALIDATOR_SEVERITY.WARNING}};return null}))),Object(external_kbnSharedDeps_RxjsOperators_.startWith)(null))]).pipe(Object(external_kbnSharedDeps_RxjsOperators_.map)(([isModelPlotEnabled,cardinalityValidationResult])=>isModelPlotEnabled?cardinalityValidationResult:null))),jobIdValidator(this._jobCreatorSubject$),groupIdsValidator(this._jobCreatorSubject$)],this._asyncValidatorsResult$=Object(external_kbnSharedDeps_Rxjs_.combineLatest)(this._asyncValidators$).pipe(Object(external_kbnSharedDeps_RxjsOperators_.map)(res=>res.reduce((acc,curr)=>({...acc,...curr||{}}),{})),Object(external_kbnSharedDeps_RxjsOperators_.startWith)({})),this.validationResult$=Object(external_kbnSharedDeps_Rxjs_.combineLatest)([this._basicValidationResult$,this._asyncValidatorsResult$]).pipe(Object(external_kbnSharedDeps_RxjsOperators_.map)(([basicValidationResult,asyncValidatorsResult])=>({...basicValidationResult,...asyncValidatorsResult})),Object(external_kbnSharedDeps_RxjsOperators_.tap)(latestValidationResult=>{this.latestValidationResult=latestValidationResult}))}validate(callback,forceValidate=!1){this._validating=!0;const formattedJobConfig=this._jobCreator.formattedJobJson,formattedDatafeedConfig=this._jobCreator.formattedDatafeedJson;this._runAdvancedValidation(),forceValidate||formattedJobConfig!==this._lastJobConfig||formattedDatafeedConfig!==this._lastDatafeedConfig?(null!==this._validateTimeout&&clearTimeout(this._validateTimeout),this._lastJobConfig=formattedJobConfig,this._lastDatafeedConfig=formattedDatafeedConfig,this._validateTimeout=setTimeout(()=>{this._runBasicValidation(),this._jobCreatorSubject$.next(this._jobCreator),this._validating=!1,this._validateTimeout=null,callback()},500)):this._validating=null!==this._validateTimeout,callback()}_resetBasicValidations(){this._validationSummary.basic=!0,Object.values(this._basicValidations).forEach(v=>{v.valid=!0,delete v.message})}_runBasicValidation(){this._resetBasicValidations();const jobConfig=this._jobCreator.jobConfig,datafeedConfig=this._jobCreator.datafeedConfig,limits=Object(ml_server_info.c)(),basicJobResults=Object(job_utils.e)(jobConfig,void 0,limits);Object(util.b)(basicJobResults,this._basicValidations,jobConfig,datafeedConfig);const basicDatafeedResults=Object(job_utils.c)(datafeedConfig);Object(util.b)(basicDatafeedResults,this._basicValidations,jobConfig,datafeedConfig);const basicJobAndDatafeedResults=Object(job_utils.d)(jobConfig,datafeedConfig);Object(util.b)(basicJobAndDatafeedResults,this._basicValidations,jobConfig,datafeedConfig),this._validationSummary.basic=this._isOverallBasicValid(),this._basicValidationResult$.next(this._basicValidations)}_runAdvancedValidation(){Object(job_creator.b)(this._jobCreator)&&(this._advancedValidations.categorizationFieldValid.valid=this._jobCreator.overallValidStatus!==categorization_job.a.INVALID)}_isOverallBasicValid(){return!1===Object.values(this._basicValidations).some(v=>!1===v.valid)}get validationSummary(){return this._validationSummary}get bucketSpan(){return this._basicValidations.bucketSpan}get summaryCountField(){return this._basicValidations.summaryCountField}get duplicateDetectors(){return this._basicValidations.duplicateDetectors}get jobId(){return this._basicValidations.jobId}get groupIds(){return this._basicValidations.groupIds}get modelMemoryLimit(){return this._basicValidations.modelMemoryLimit}get query(){return this._basicValidations.query}get queryDelay(){return this._basicValidations.queryDelay}get frequency(){return this._basicValidations.frequency}get scrollSize(){return this._basicValidations.scrollSize}set advancedValid(valid){this._validationSummary.advanced=valid}get validating(){return this._validating}get categorizationField(){return this._advancedValidations.categorizationFieldValid.valid}set categorizationField(valid){this._advancedValidations.categorizationFieldValid.valid=valid}get categorizerMissingPerPartition(){return this._basicValidations.categorizerMissingPerPartition}get categorizerVaryingPerPartitionField(){return this._basicValidations.categorizerVaryingPerPartitionField}get isPickFieldsStepValid(){return this._jobCreator.detectors.length>0&&(this._jobCreator.type!==new_job.f.ADVANCED||this._jobCreator.type===new_job.f.ADVANCED&&this.modelMemoryLimit.valid)&&this.bucketSpan.valid&&this.duplicateDetectors.valid&&this.categorizerMissingPerPartition.valid&&this.categorizerVaryingPerPartitionField.valid&&this.summaryCountField.valid&&!this.validating&&(this._jobCreator.type!==new_job.f.CATEGORIZATION||this._jobCreator.type===new_job.f.CATEGORIZATION&&this.categorizationField)}get isModelMemoryEstimationPayloadValid(){return this._jobCreator.detectors.length>0&&this.bucketSpan.valid&&this.duplicateDetectors.valid&&(this._jobCreator.type!==new_job.f.CATEGORIZATION||this._jobCreator.type===new_job.f.CATEGORIZATION&&this.categorizationField)}}var util_errors=__webpack_require__(24);const useModelMemoryEstimator=(jobCreator,jobValidator,jobCreatorUpdate,jobCreatorUpdated)=>{const{services:{notifications:notifications}}=Object(contexts_kibana.b)(),modelMemoryEstimator=Object(external_kbnSharedDeps_React_.useMemo)(()=>((jobCreator,jobValidator)=>{const modelMemoryCheck$=new external_kbnSharedDeps_Rxjs_.Subject,error$=new external_kbnSharedDeps_Rxjs_.Subject;return{get error$(){return error$.asObservable()},get updates$(){return Object(external_kbnSharedDeps_Rxjs_.combineLatest)([jobCreator.wizardInitialized$.pipe(Object(external_kbnSharedDeps_RxjsOperators_.skipWhile)(wizardInitialized=>!1===wizardInitialized)),modelMemoryCheck$]).pipe(Object(external_kbnSharedDeps_RxjsOperators_.map)(([,payload])=>payload),Object(external_kbnSharedDeps_RxjsOperators_.debounceTime)(600),Object(external_kbnSharedDeps_RxjsOperators_.map)(external_kbnSharedDeps_Lodash_.cloneDeep),Object(external_kbnSharedDeps_RxjsOperators_.distinctUntilChanged)(external_kbnSharedDeps_Lodash_.isEqual),Object(external_kbnSharedDeps_RxjsOperators_.filter)(()=>jobValidator.isModelMemoryEstimationPayloadValid),Object(external_kbnSharedDeps_RxjsOperators_.switchMap)(payload=>ml_api_service.ml.calculateModelMemoryLimit$(payload).pipe(Object(external_kbnSharedDeps_RxjsOperators_.pluck)("modelMemoryLimit"),Object(external_kbnSharedDeps_RxjsOperators_.catchError)(error=>(console.error("Model memory limit could not be calculated",error.body),error$.next(error),Object(external_kbnSharedDeps_Rxjs_.of)(new_job.c))))))},update(payload){modelMemoryCheck$.next(payload)}}})(jobCreator,jobValidator),[]);Object(external_kbnSharedDeps_React_.useEffect)(()=>{const subscription=new external_kbnSharedDeps_Rxjs_.Subscription;return subscription.add(modelMemoryEstimator.updates$.pipe(Object(external_kbnSharedDeps_RxjsOperators_.startWith)(jobCreator.modelMemoryLimit),Object(external_kbnSharedDeps_RxjsOperators_.pairwise)()).subscribe(([previousEstimation,currentEstimation])=>{null!==jobCreator.modelMemoryLimit&&jobCreator.modelMemoryLimit!==previousEstimation||(jobCreator.modelMemoryLimit=currentEstimation,jobCreatorUpdate())})),subscription.add(modelMemoryEstimator.error$.subscribe(error=>{notifications.toasts.addWarning({title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.estimateModelMemoryError",{defaultMessage:"Model memory limit could not be calculated"}),text:Object(util_errors.i)(error)})})),()=>{subscription.unsubscribe()}},[]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{modelMemoryEstimator.update({datafeedConfig:jobCreator.datafeedConfig,analysisConfig:jobCreator.jobConfig.analysis_config,indexPattern:jobCreator.indexPatternTitle,query:jobCreator.datafeedConfig.query,timeFieldName:jobCreator.jobConfig.data_description.time_field,earliestMs:jobCreator.start,latestMs:jobCreator.end})},[jobCreatorUpdated])};let WIZARD_STEPS;!function(WIZARD_STEPS){WIZARD_STEPS[WIZARD_STEPS.TIME_RANGE=0]="TIME_RANGE",WIZARD_STEPS[WIZARD_STEPS.ADVANCED_CONFIGURE_DATAFEED=1]="ADVANCED_CONFIGURE_DATAFEED",WIZARD_STEPS[WIZARD_STEPS.PICK_FIELDS=2]="PICK_FIELDS",WIZARD_STEPS[WIZARD_STEPS.JOB_DETAILS=3]="JOB_DETAILS",WIZARD_STEPS[WIZARD_STEPS.VALIDATION=4]="VALIDATION",WIZARD_STEPS[WIZARD_STEPS.SUMMARY=5]="SUMMARY"}(WIZARD_STEPS||(WIZARD_STEPS={}));const JobCreatorContext=Object(external_kbnSharedDeps_React_.createContext)({jobCreatorUpdated:0,jobCreatorUpdate:()=>{},jobCreator:{},chartLoader:{},resultsLoader:{},chartInterval:{},jobValidator:{},jobValidatorUpdated:0,fields:[],aggs:[],existingJobsAndGroups:{}});var new_job_capabilities_service=__webpack_require__(98),external_kbnSharedDeps_Moment_=__webpack_require__(15),external_kbnSharedDeps_Moment_default=__webpack_require__.n(external_kbnSharedDeps_Moment_);const WizardNav=({previous:previous,previousActive:previousActive=!0,next:next,nextActive:nextActive=!0,children:children})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHorizontalRule,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,previous&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(PreviousButton,{previous:previous,previousActive:previousActive})),next&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(NextButton,{next:next,nextActive:nextActive})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},children),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null))),PreviousButton=({previous:previous,previousActive:previousActive=!0})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{disabled:!previousActive,onClick:previous,iconType:"arrowLeft",iconSide:"left","data-test-subj":"mlJobWizardNavButtonPrevious"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.previousStepButton",defaultMessage:"Previous"})),NextButton=({next:next,nextActive:nextActive=!0})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{fill:!0,disabled:!nextActive,onClick:next,iconSide:"right",iconType:"arrowRight","data-test-subj":"mlJobWizardNavButtonNext"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.nextStepButton",defaultMessage:"Next"}));var target=__webpack_require__(30),target_default=__webpack_require__.n(target),object_utils=__webpack_require__(4);function getTimeFilterRange(){const timefilter=Object(dependency_cache.i)(),fromMoment=target_default.a.parse(timefilter.getTime().from),toMoment=target_default.a.parse(timefilter.getTime().to),from=void 0!==fromMoment?fromMoment.valueOf():0;return{to:void 0!==toMoment?toMoment.valueOf():0,from:from}}const FullTimeRangeSelector=({indexPattern:indexPattern,query:query,disabled:disabled,callback:callback})=>{async function setRange(i,q){const fullTimeRange=await async function(indexPattern,query){try{const timefilter=Object(dependency_cache.i)(),runtimeMappings=indexPattern.getComputedFields().runtimeFields,resp=await ml_api_service.ml.getTimeFieldRange({index:indexPattern.title,timeFieldName:indexPattern.timeFieldName,query:query,...Object(object_utils.b)(runtimeMappings)?{runtimeMappings:runtimeMappings}:{}});return timefilter.setTime({from:external_kbnSharedDeps_Moment_default()(resp.start.epoch).toISOString(),to:external_kbnSharedDeps_Moment_default()(resp.end.epoch).toISOString()}),resp}catch(resp){return Object(dependency_cache.j)().addDanger(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.fullTimeRangeSelector.errorSettingTimeRangeNotification",{defaultMessage:"An error occurred setting the time range."})),resp}}(i,q);"function"==typeof callback&&callback(fullTimeRange)}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{isDisabled:disabled,onClick:()=>setRange(indexPattern,query),"data-test-subj":"mlButtonUseFullData"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.fullTimeRangeSelector.useFullDataButtonLabel",defaultMessage:"Use full {indexPatternTitle} data",values:{indexPatternTitle:indexPattern.title}}))};var event_rate_chart=__webpack_require__(228),group_color_utils=__webpack_require__(149);const Description=Object(external_kbnSharedDeps_React_.memo)(({children:children,validation:validation})=>{const title=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.jobGroupSelect.title",{defaultMessage:"Groups"});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescribedFormGroup,{title:external_kbnSharedDeps_React_default.a.createElement("h3",null,title),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobDetailsStep.jobGroupSelect.description",defaultMessage:" Optional grouping for jobs. New groups can be created or picked from the list of existing groups."})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:title,error:validation.message,isInvalid:!1===validation.valid},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,children)))}),JobGroupsInput=Object(external_kbnSharedDeps_React_.memo)(({existingGroups:existingGroups,selectedGroups:selectedGroups,onChange:onChange,validation:validation})=>{const options=existingGroups.map(g=>({label:g,color:Object(group_color_utils.a)(g)})),selectedOptions=selectedGroups.map(g=>({label:g,color:Object(group_color_utils.a)(g)}));function onChangeCallback(optionsIn){onChange(optionsIn.map(g=>g.label))}return external_kbnSharedDeps_React_default.a.createElement(Description,{validation:validation},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiComboBox,{placeholder:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.jobGroupSelect.placeholder",{defaultMessage:"Select or create groups"}),options:options,selectedOptions:selectedOptions,onChange:onChangeCallback,onCreateOption:function(input,flattenedOptions){const normalizedSearchValue=input.trim().toLowerCase();if(!normalizedSearchValue)return;const newGroup={label:input,color:Object(group_color_utils.a)(input)};-1===flattenedOptions.findIndex(option=>option.label.trim().toLowerCase()===normalizedSearchValue)&&options.push(newGroup),onChangeCallback([...selectedOptions,newGroup])},isClearable:!0,isInvalid:!validation.valid,"data-test-subj":"mlJobWizardComboBoxJobGroups"}))}),TimeRangePicker=({setTimeRange:setTimeRange,timeRange:timeRange})=>{const dateFormat=Object(ml.b)().kibanaConfig.get("dateFormat"),[startMoment,setStartMoment]=Object(external_kbnSharedDeps_React_.useState)(external_kbnSharedDeps_Moment_default()(timeRange.start)),[endMoment,setEndMoment]=Object(external_kbnSharedDeps_React_.useState)(external_kbnSharedDeps_Moment_default()(timeRange.end));return Object(external_kbnSharedDeps_React_.useEffect)(()=>{void 0!==startMoment&&void 0!==endMoment&&setTimeRange({start:startMoment.valueOf(),end:endMoment.valueOf()})},[startMoment,endMoment]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{setStartMoment(external_kbnSharedDeps_Moment_default()(timeRange.start)),setEndMoment(external_kbnSharedDeps_Moment_default()(timeRange.end))},[JSON.stringify(timeRange)]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement("div",{style:{minWidth:"512px"},"data-test-subj":"mlJobWizardDateRange"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDatePickerRange,{fullWidth:!0,startDateControl:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDatePicker,{selected:startMoment,onChange:function(date){setStartMoment(date||void 0)},startDate:startMoment,endDate:endMoment,"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.timeRangeStep.timeRangePicker.startDateLabel",{defaultMessage:"Start date"}),showTimeSelect:!0,dateFormat:dateFormat,maxDate:endMoment}),endDateControl:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDatePicker,{selected:endMoment,onChange:function(date){setEndMoment(date||void 0)},startDate:startMoment,endDate:endMoment,"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.timeRangeStep.timeRangePicker.endDateLabel",{defaultMessage:"End date"}),showTimeSelect:!0,dateFormat:dateFormat,minDate:startMoment})})))},TimeRangeStep=({setCurrentStep:setCurrentStep,isCurrentStep:isCurrentStep})=>{const{services:services}=Object(contexts_kibana.b)(),mlContext=Object(ml.b)(),{jobCreator:jobCreator,jobCreatorUpdate:jobCreatorUpdate,jobCreatorUpdated:jobCreatorUpdated,chartLoader:chartLoader,chartInterval:chartInterval}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext),[timeRange,setTimeRange]=Object(external_kbnSharedDeps_React_.useState)({start:jobCreator.start,end:jobCreator.end}),[eventRateChartData,setEventRateChartData]=Object(external_kbnSharedDeps_React_.useState)([]),[loadingData,setLoadingData]=Object(external_kbnSharedDeps_React_.useState)(!1);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{const{start:start,end:end}=timeRange;jobCreator.setTimeRange(start,end),chartInterval.setBounds({min:external_kbnSharedDeps_Moment_default()(start),max:external_kbnSharedDeps_Moment_default()(end)});const{timefilter:timefilter}=services.data.query.timefilter;timefilter.setTime({from:external_kbnSharedDeps_Moment_default()(start).toISOString(),to:external_kbnSharedDeps_Moment_default()(end).toISOString()}),jobCreatorUpdate(),async function(){setLoadingData(!0);try{var _jobCreator$runtimeMa;const resp=await chartLoader.loadEventRateChart(jobCreator.start,jobCreator.end,chartInterval.getInterval().asMilliseconds(),null!==(_jobCreator$runtimeMa=jobCreator.runtimeMappings)&&void 0!==_jobCreator$runtimeMa?_jobCreator$runtimeMa:void 0,jobCreator.datafeedConfig.indices_options);setEventRateChartData(resp)}catch(error){setEventRateChartData([])}setLoadingData(!1)}()},[JSON.stringify(timeRange)]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{setTimeRange({start:jobCreator.start,end:jobCreator.end})},[jobCreatorUpdated]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,isCurrentStep&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(TimeRangePicker,{setTimeRange:setTimeRange,timeRange:timeRange})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(FullTimeRangeSelector,{indexPattern:mlContext.currentIndexPattern,query:mlContext.combinedQuery,disabled:!1,callback:function(range){if(null!==range.start.epoch&&null!==range.end.epoch)setTimeRange({start:range.start.epoch,end:range.end.epoch});else{const{toasts:toasts}=services.notifications;toasts.addDanger(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.timeRangeStep.fullTimeRangeError",{defaultMessage:"An error occurred obtaining the time range for the index"}))}}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),external_kbnSharedDeps_React_default.a.createElement(event_rate_chart.a,{eventRateChartData:eventRateChartData,height:"300px",width:"100%",showAxis:!0,loading:loadingData}),external_kbnSharedDeps_React_default.a.createElement(WizardNav,{next:()=>setCurrentStep(jobCreator.type===new_job.f.ADVANCED?WIZARD_STEPS.ADVANCED_CONFIGURE_DATAFEED:WIZARD_STEPS.PICK_FIELDS),nextActive:!0})))},AggSelect=({fields:fields,changeHandler:changeHandler,selectedOptions:selectedOptions,removeOptions:removeOptions})=>{const{jobValidator:jobValidator,jobValidatorUpdated:jobValidatorUpdated}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext),[validation,setValidation]=Object(external_kbnSharedDeps_React_.useState)(jobValidator.duplicateDetectors),removeLabels=removeOptions.map(createLabel),options=fields.map(f=>{const aggOption={label:f.name,options:[]};return void 0!==f.aggs&&(aggOption.options=f.aggs.filter(a=>null!==a.dslName).map(a=>({label:`${a.title}(${f.name})`,agg:a,field:f})).filter(o=>!1===removeLabels.includes(o.label))),aggOption});return Object(external_kbnSharedDeps_React_.useEffect)(()=>{setValidation(jobValidator.duplicateDetectors)},[jobValidatorUpdated]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{error:validation.message,isInvalid:!1===validation.valid,"data-test-subj":"mlJobWizardAggSelection"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiComboBox,{singleSelection:{asPlainText:!0},options:options,selectedOptions:selectedOptions,onChange:changeHandler,isClearable:!1,isInvalid:!1===validation.valid}))};function createLabel(pair){return`${pair.agg.title}(${pair.field.name})`}var fields_utils=__webpack_require__(195),external_kbnSharedDeps_ElasticCharts_=__webpack_require__(43),common_anomalies=__webpack_require__(321),common_settings=__webpack_require__(118);const areaSeriesStyle={...common_settings.c,area:{...common_settings.c.area,visible:!0},line:{...common_settings.c.line,strokeWidth:1,opacity:.4}},ModelBounds=({modelData:modelData})=>{const{MODEL_COLOR:MODEL_COLOR}=Object(common_settings.d)(),model=void 0===modelData?[]:modelData;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_.AreaSeries,{id:"model",xScaleType:external_kbnSharedDeps_ElasticCharts_.ScaleType.Time,yScaleType:external_kbnSharedDeps_ElasticCharts_.ScaleType.Linear,xAccessor:"time",yAccessors:["modelUpper"],y0Accessors:["modelLower"],data:model,stackAccessors:["time"],yScaleToDataExtent:!1,curve:external_kbnSharedDeps_ElasticCharts_.CurveType.CURVE_MONOTONE_X,areaSeriesStyle:areaSeriesStyle,color:MODEL_COLOR})},lineSeriesStyle={...common_settings.c},Line=({chartData:chartData})=>{const{LINE_COLOR:LINE_COLOR}=Object(common_settings.d)();return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_.LineSeries,{id:"line",xScaleType:external_kbnSharedDeps_ElasticCharts_.ScaleType.Time,yScaleType:external_kbnSharedDeps_ElasticCharts_.ScaleType.Linear,xAccessor:"time",yAccessors:["value"],data:chartData,yScaleToDataExtent:!1,curve:external_kbnSharedDeps_ElasticCharts_.CurveType.CURVE_MONOTONE_X,lineSeriesStyle:lineSeriesStyle,color:LINE_COLOR})},scatterSeriesStyle={...common_settings.c,line:{...common_settings.c.line,visible:!1},point:{...common_settings.c.point,visible:!0}},Scatter=({chartData:chartData})=>{const{LINE_COLOR:LINE_COLOR}=Object(common_settings.d)();return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_.LineSeries,{id:"scatter",xScaleType:external_kbnSharedDeps_ElasticCharts_.ScaleType.Time,yScaleType:external_kbnSharedDeps_ElasticCharts_.ScaleType.Linear,xAccessor:"time",yAccessors:["value"],data:chartData,yScaleToDataExtent:!1,curve:external_kbnSharedDeps_ElasticCharts_.CurveType.CURVE_MONOTONE_X,lineSeriesStyle:scatterSeriesStyle,color:LINE_COLOR})};var common_axes=__webpack_require__(318),utils=__webpack_require__(319),loading_wrapper=__webpack_require__(296);let CHART_TYPE;!function(CHART_TYPE){CHART_TYPE[CHART_TYPE.LINE=0]="LINE",CHART_TYPE[CHART_TYPE.SCATTER=1]="SCATTER"}(CHART_TYPE||(CHART_TYPE={}));const AnomalyChart=({chartType:chartType,chartData:chartData=[],modelData:modelData,anomalyData:anomalyData,height:height,width:width,loading:loading=!1})=>{const data=chartType===CHART_TYPE.SCATTER?function(data){return data.reduce((p,c)=>(p.push(...c.values.map(v=>({time:c.time,value:v.value}))),p),[])}(chartData):chartData,xDomain=Object(utils.a)(data);return external_kbnSharedDeps_React_default.a.createElement("div",{style:{width:width,height:height},"data-test-subj":"mlAnomalyChart "+CHART_TYPE[chartType]},external_kbnSharedDeps_React_default.a.createElement(loading_wrapper.a,{height:height,hasData:data.length>0,loading:loading},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_.Chart,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_.Settings,{xDomain:xDomain,tooltip:external_kbnSharedDeps_ElasticCharts_.TooltipType.None}),external_kbnSharedDeps_React_default.a.createElement(common_axes.a,{chartData:data}),external_kbnSharedDeps_React_default.a.createElement(common_anomalies.a,{anomalyData:anomalyData}),external_kbnSharedDeps_React_default.a.createElement(ModelBounds,{modelData:modelData}),chartType===CHART_TYPE.LINE&&external_kbnSharedDeps_React_default.a.createElement(Line,{chartData:data}),chartType===CHART_TYPE.SCATTER&&external_kbnSharedDeps_React_default.a.createElement(Scatter,{chartData:data}))))};var toast_notification_service=__webpack_require__(73);const SingleMetricDetectors=({setIsValid:setIsValid})=>{const{jobCreator:jc,jobCreatorUpdate:jobCreatorUpdate,jobCreatorUpdated:jobCreatorUpdated,chartLoader:chartLoader,chartInterval:chartInterval}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext),jobCreator=jc,fields=Object(external_kbnSharedDeps_React_.useMemo)(()=>Object(fields_utils.b)([...new_job_capabilities_service.b.fields,...jobCreator.runtimeFields]),[]),[selectedOptions,setSelectedOptions]=Object(external_kbnSharedDeps_React_.useState)(null!==jobCreator.aggFieldPair?[{label:createLabel(jobCreator.aggFieldPair)}]:[]),[aggFieldPair,setAggFieldPair]=Object(external_kbnSharedDeps_React_.useState)(jobCreator.aggFieldPair),[lineChartsData,setLineChartData]=Object(external_kbnSharedDeps_React_.useState)({}),[loadingData,setLoadingData]=Object(external_kbnSharedDeps_React_.useState)(!1),[start,setStart]=Object(external_kbnSharedDeps_React_.useState)(jobCreator.start),[end,setEnd]=Object(external_kbnSharedDeps_React_.useState)(jobCreator.end),[bucketSpanMs,setBucketSpanMs]=Object(external_kbnSharedDeps_React_.useState)(jobCreator.bucketSpanMs);async function loadChart(){if(null!==aggFieldPair){setLoadingData(!0);try{const cs=Object(common_settings.b)(jobCreator,chartInterval),resp=await chartLoader.loadLineCharts(jobCreator.start,jobCreator.end,[aggFieldPair],null,null,cs.intervalMs,jobCreator.runtimeMappings,jobCreator.datafeedConfig.indices_options);void 0!==resp[0]&&setLineChartData(resp)}catch(error){Object(toast_notification_service.a)().displayErrorToast(error),setLineChartData({})}setLoadingData(!1)}}return Object(external_kbnSharedDeps_React_.useEffect)(()=>{null!==aggFieldPair&&(jobCreator.setDetector(aggFieldPair.agg,aggFieldPair.field),jobCreatorUpdate(),loadChart(),setIsValid(null!==aggFieldPair))},[aggFieldPair]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{jobCreator.start===start&&jobCreator.end===end||(setStart(jobCreator.start),setEnd(jobCreator.end),loadChart()),jobCreator.bucketSpanMs!==bucketSpanMs&&(setBucketSpanMs(jobCreator.bucketSpanMs),loadChart())},[jobCreatorUpdated]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(AggSelect,{fields:fields,changeHandler:function(selectedOptionsIn){if(setSelectedOptions(selectedOptionsIn),selectedOptionsIn.length){const option=selectedOptionsIn[0];setAggFieldPair(void 0!==option?{agg:option.agg,field:option.field}:null)}},selectedOptions:selectedOptions,removeOptions:[]}),(void 0!==lineChartsData[0]||!0===loadingData)&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(AnomalyChart,{chartType:CHART_TYPE.LINE,chartData:lineChartsData[0],modelData:[],anomalyData:[],height:"300px",width:"100%",loading:loadingData})))},SingleMetricDetectorsSummary=()=>{const{jobCreator:jc,chartLoader:chartLoader,resultsLoader:resultsLoader,chartInterval:chartInterval}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext),jobCreator=jc,[lineChartsData,setLineChartData]=Object(external_kbnSharedDeps_React_.useState)({}),[loadingData,setLoadingData]=Object(external_kbnSharedDeps_React_.useState)(!1),[modelData,setModelData]=Object(external_kbnSharedDeps_React_.useState)([]),[anomalyData,setAnomalyData]=Object(external_kbnSharedDeps_React_.useState)([]);function setResultsWrapper(results){const model=results.model[0];void 0!==model&&setModelData(model);const anomalies=results.anomalies[0];void 0!==anomalies&&setAnomalyData(anomalies)}return Object(external_kbnSharedDeps_React_.useEffect)(()=>{const subscription=resultsLoader.subscribeToResults(setResultsWrapper);return async function(){if(null!==jobCreator.aggFieldPair){setLoadingData(!0);try{const cs=Object(common_settings.b)(jobCreator,chartInterval),resp=await chartLoader.loadLineCharts(jobCreator.start,jobCreator.end,[jobCreator.aggFieldPair],null,null,cs.intervalMs,jobCreator.runtimeMappings,jobCreator.datafeedConfig.indices_options);void 0!==resp[0]&&setLineChartData(resp)}catch(error){Object(toast_notification_service.a)().displayErrorToast(error),setLineChartData({})}setLoadingData(!1)}}(),()=>{subscription.unsubscribe()}},[]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,(void 0!==lineChartsData[0]||!0===loadingData)&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(AnomalyChart,{chartType:CHART_TYPE.LINE,chartData:lineChartsData[0],modelData:modelData,anomalyData:anomalyData,height:"300px",width:"100%",loading:loadingData})))};var general=__webpack_require__(84);const BucketSpanInput=({bucketSpan:bucketSpan,setBucketSpan:setBucketSpan,isInvalid:isInvalid,disabled:disabled})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldText,{disabled:disabled,placeholder:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.bucketSpan.placeholder",{defaultMessage:"Bucket span"}),value:bucketSpan,onChange:e=>setBucketSpan(e.target.value),isInvalid:isInvalid,"data-test-subj":"mlJobWizardInputBucketSpan"}),description_Description=Object(external_kbnSharedDeps_React_.memo)(({children:children,validation:validation})=>{const title=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.bucketSpan.title",{defaultMessage:"Bucket span"});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescribedFormGroup,{title:external_kbnSharedDeps_React_default.a.createElement("h3",null,title),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.bucketSpan.description",defaultMessage:"Set the interval for time series analysis, typically between 15m to 1h."})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:title,error:validation.message,isInvalid:!1===validation.valid},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,children)))});var field_types=__webpack_require__(87),types_fields=__webpack_require__(112);let ESTIMATE_STATUS;!function(ESTIMATE_STATUS){ESTIMATE_STATUS[ESTIMATE_STATUS.NOT_RUNNING=0]="NOT_RUNNING",ESTIMATE_STATUS[ESTIMATE_STATUS.RUNNING=1]="RUNNING"}(ESTIMATE_STATUS||(ESTIMATE_STATUS={}));const BucketSpanEstimator=({setEstimating:setEstimating})=>{const{jobCreator:jobCreator,jobCreatorUpdate:jobCreatorUpdate}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext),{status:status,estimateBucketSpan:estimateBucketSpan}=function(){var _jobCreator$runtimeMa;const{jobCreator:jobCreator,jobCreatorUpdate:jobCreatorUpdate}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext),mlContext=Object(ml.b)(),[status,setStatus]=Object(external_kbnSharedDeps_React_.useState)(ESTIMATE_STATUS.NOT_RUNNING),data={aggTypes:jobCreator.aggregations.map(a=>a.dslName),duration:{start:jobCreator.start,end:jobCreator.end},fields:jobCreator.fields.map(f=>f.id===types_fields.a?null:f.id),index:mlContext.currentIndexPattern.title,query:mlContext.combinedQuery,splitField:void 0,timeField:mlContext.currentIndexPattern.timeFieldName,runtimeMappings:null!==(_jobCreator$runtimeMa=jobCreator.runtimeMappings)&&void 0!==_jobCreator$runtimeMa?_jobCreator$runtimeMa:void 0,indicesOptions:jobCreator.datafeedConfig.indices_options};return(Object(job_creator.c)(jobCreator)||Object(job_creator.d)(jobCreator))&&null!==jobCreator.splitField?data.splitField=jobCreator.splitField.id:Object(job_creator.a)(jobCreator)&&jobCreator.richDetectors.some(d=>null!==d.partitionField?(data.splitField=d.partitionField.id,!0):null!==d.overField?(data.splitField=d.overField.id,!0):null!==d.byField?(data.splitField=d.byField.id,!0):void 0),{status:status,estimateBucketSpan:async function(){setStatus(ESTIMATE_STATUS.RUNNING);const{name:name,error:error,message:message}=await ml_api_service.ml.estimateBucketSpan(data);setStatus(ESTIMATE_STATUS.NOT_RUNNING),!0===error?Object(toast_notification_service.a)().displayErrorToast(message):(jobCreator.bucketSpan=name,jobCreatorUpdate())}}}(),[noDetectors,setNoDetectors]=Object(external_kbnSharedDeps_React_.useState)(0===jobCreator.detectors.length),[isUsingMlCategory,setIsUsingMlCategory]=Object(external_kbnSharedDeps_React_.useState)(checkIsUsingMlCategory());function checkIsUsingMlCategory(){return Object(job_creator.a)(jobCreator)&&jobCreator.detectors.some(d=>{if(d.partition_field_name===field_types.b||d.over_field_name===field_types.b||d.by_field_name===field_types.b)return!0})}return Object(external_kbnSharedDeps_React_.useEffect)(()=>{setEstimating(status===ESTIMATE_STATUS.RUNNING)},[status]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{setNoDetectors(0===jobCreator.detectors.length),setIsUsingMlCategory(checkIsUsingMlCategory())},[jobCreatorUpdate]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{disabled:status===ESTIMATE_STATUS.RUNNING||!0===noDetectors||!0===isUsingMlCategory,onClick:estimateBucketSpan},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.bucketSpanEstimatorButton",defaultMessage:"Estimate bucket span"}))},BucketSpan=({setIsValid:setIsValid,hideEstimateButton:hideEstimateButton=!1})=>{const{jobCreator:jobCreator,jobCreatorUpdate:jobCreatorUpdate,jobCreatorUpdated:jobCreatorUpdated,jobValidator:jobValidator,jobValidatorUpdated:jobValidatorUpdated}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext),[bucketSpan,setBucketSpan]=Object(external_kbnSharedDeps_React_.useState)(jobCreator.bucketSpan),[validation,setValidation]=Object(external_kbnSharedDeps_React_.useState)(jobValidator.bucketSpan),[estimating,setEstimating]=Object(external_kbnSharedDeps_React_.useState)(!1);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{jobCreator.bucketSpan=bucketSpan,jobCreatorUpdate()},[bucketSpan]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{setBucketSpan(jobCreator.bucketSpan)},[jobCreatorUpdated]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{setValidation(jobValidator.bucketSpan)},[jobValidatorUpdated]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{setIsValid(!1===estimating)},[estimating]),external_kbnSharedDeps_React_default.a.createElement(description_Description,{validation:validation},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(BucketSpanInput,{setBucketSpan:setBucketSpan,bucketSpan:bucketSpan,isInvalid:!1===validation.valid,disabled:estimating})),!1===hideEstimateButton&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(BucketSpanEstimator,{setEstimating:setEstimating}))))},sparse_data_description_Description=Object(external_kbnSharedDeps_React_.memo)(({children:children})=>{const title=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.sparseData.title",{defaultMessage:"Sparse data"});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescribedFormGroup,{title:external_kbnSharedDeps_React_default.a.createElement("h3",null,title),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.sparseData.description",defaultMessage:"Select if you wish to ignore empty buckets from being considered anomalous. Available for count and sum analysis."})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:title},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,children)))});var aggregation_types=__webpack_require__(81);const SparseDataSwitch=()=>{const{jobCreator:jobCreator,jobCreatorUpdated:jobCreatorUpdated,jobCreatorUpdate:jobCreatorUpdate}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext),[sparseData,setSparseData]=Object(external_kbnSharedDeps_React_.useState)(jobCreator.sparseData),[enabled,setEnabled]=Object(external_kbnSharedDeps_React_.useState)(!1);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{jobCreator.sparseData=sparseData,jobCreatorUpdate()},[sparseData]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{const aggs=[aggregation_types.a.COUNT,aggregation_types.a.SUM],isCountOrSum=jobCreator.aggregations.some(agg=>null!==agg.dslName&&aggs.includes(agg.dslName));setEnabled(isCountOrSum),!1===isCountOrSum&&!0===sparseData&&setSparseData(!1)},[jobCreatorUpdated]),external_kbnSharedDeps_React_default.a.createElement(sparse_data_description_Description,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSwitch,{name:"switch",disabled:!1===enabled,checked:sparseData,onChange:function(){setSparseData(!sparseData)},"data-test-subj":"mlJobWizardSwitchSparseData",label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.sparseData.title",{defaultMessage:"Sparse data"})}))},SingleMetricSettings=({setIsValid:setIsValid})=>{const{jobCreator:jobCreator}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext),navigateToPath=Object(contexts_kibana.e)();return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"xl"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(BucketSpan,{setIsValid:setIsValid})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(SparseDataSwitch,null))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{onClick:()=>{Object(general.e)(jobCreator,navigateToPath)}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.singleMetricView.convertToMultiMetricButton",defaultMessage:"Convert to multi-metric job"})))))},SingleMetricView=({isActive:isActive,setCanProceed:setCanProceed})=>{const[metricsValid,setMetricValid]=Object(external_kbnSharedDeps_React_.useState)(!1),[settingsValid,setSettingsValid]=Object(external_kbnSharedDeps_React_.useState)(!1);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{"function"==typeof setCanProceed&&setCanProceed(metricsValid&&settingsValid)},[metricsValid,settingsValid]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,!1===isActive?external_kbnSharedDeps_React_default.a.createElement(SingleMetricDetectorsSummary,null):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(SingleMetricDetectors,{setIsValid:setMetricValid}),metricsValid&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHorizontalRule,{margin:"l"}),external_kbnSharedDeps_React_default.a.createElement(SingleMetricSettings,{setIsValid:setSettingsValid}))))},MetricSelector=({fields:fields,detectorChangeHandler:detectorChangeHandler,selectedOptions:selectedOptions,maxWidth:maxWidth,removeOptions:removeOptions})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{style:{maxWidth:void 0!==maxWidth?maxWidth:560}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.multiMetricView.addMetric",{defaultMessage:"Add metric"})},external_kbnSharedDeps_React_default.a.createElement(AggSelect,{fields:fields,changeHandler:detectorChangeHandler,selectedOptions:selectedOptions,removeOptions:removeOptions})))),SplitCards=Object(external_kbnSharedDeps_React_.memo)(({fieldValues:fieldValues,splitField:splitField,children:children,numberOfDetectors:numberOfDetectors,jobType:jobType,animate:animate=!1})=>{const panels=[];return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{"data-test-subj":"mlDataSplit"},(0===fieldValues.length||0===numberOfDetectors)&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,children),fieldValues.length>0&&numberOfDetectors>0&&null!==splitField&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,jobType===new_job.f.MULTI_METRIC&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement("div",{style:{fontSize:"small"},"data-test-subj":"mlDataSplitTitle "+splitField.name},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.splitCards.dataSplitBy",defaultMessage:"Data split by {field}",values:{field:splitField.name}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"})),function(){panels.length=0;const fieldValuesCopy=[...fieldValues];fieldValuesCopy.shift();let margin=5;const sideMargins=fieldValuesCopy.map((f,i)=>margin+=10-i).reverse();return!0===animate&&setTimeout(()=>{panels.forEach(p=>p.panel.style.marginBottom=p.marginBottom+"px")},100),fieldValuesCopy.map((fieldName,i)=>{const marginBottom=-100+(i+1)*(10/fieldValuesCopy.length*1.6),sideMargin=sideMargins[i],style={height:"100px",marginBottom:"-100px",marginLeft:sideMargin+"px",marginRight:sideMargin+"px",...animate?{transition:"margin 0.5s"}:{}};return external_kbnSharedDeps_React_default.a.createElement("div",{key:fieldName,ref:ref=>function(panel,marginBottom){null!==panel&&(!1===animate&&(panel.style.marginBottom=marginBottom+"px"),panels.push({panel:panel,marginBottom:marginBottom}))}(ref,marginBottom),style:style},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPanel,{paddingSize:"m",style:{paddingTop:"4px"},"data-test-subj":"mlSplitCard back"},external_kbnSharedDeps_React_default.a.createElement("div",{style:{fontWeight:"bold",fontSize:"small"},"data-test-subj":"mlSplitCardTitle"},fieldName)))})}(),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPanel,{paddingSize:"m",style:{paddingTop:"4px"},"data-test-subj":"mlSplitCard front"},external_kbnSharedDeps_React_default.a.createElement("div",{style:{fontWeight:"bold",fontSize:"small"},"data-test-subj":"mlSplitCardTitle"},fieldValues[0]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHorizontalRule,{margin:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,children)))))});function useAnimateSplit(){const[animateSplit,setAnimateSplit]=Object(external_kbnSharedDeps_React_.useState)(!1);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{setTimeout(()=>{setAnimateSplit(!0)},1e3)},[]),animateSplit}const DetectorTitle=({index:index,agg:agg,field:field,byField:byField,deleteDetector:deleteDetector,children:children})=>{const splitField=!1===children&&void 0!==byField?byField.field:null;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s",justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement("span",{style:{fontSize:"small"},"data-test-subj":"mlDetectorTitle"},function(agg,field,splitField){const title=`${agg.title}(${field.name})`;return null===splitField?title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.detectorTitle.placeholder",{defaultMessage:"{title} split by {field}",values:{title:title,field:splitField.name}})}(agg,field,splitField))),!1!==children&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{style:{width:"100%",maxWidth:"400px"}},children),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},void 0!==deleteDetector&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{color:"danger",onClick:()=>deleteDetector(index),iconType:"cross",size:"s","aria-label":"Next"})))};const ChartGrid=({aggFieldPairList:aggFieldPairList,chartSettings:chartSettings,splitField:splitField,fieldValues:fieldValues,lineChartsData:lineChartsData,modelData:modelData,anomalyData:anomalyData,deleteDetector:deleteDetector,jobType:jobType,loading:loading=!1})=>{const animateSplit=useAnimateSplit();return external_kbnSharedDeps_React_default.a.createElement(SplitCards,{fieldValues:fieldValues,splitField:splitField,numberOfDetectors:aggFieldPairList.length,jobType:jobType,animate:animateSplit},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGrid,{columns:chartSettings.cols},aggFieldPairList.map((af,i)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{key:i,"data-test-subj":"mlDetector "+i},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(DetectorTitle,{index:i,agg:aggFieldPairList[i].agg,field:aggFieldPairList[i].field,deleteDetector:deleteDetector}),external_kbnSharedDeps_React_default.a.createElement(AnomalyChart,{chartType:CHART_TYPE.LINE,chartData:lineChartsData[i],modelData:modelData[i],anomalyData:anomalyData[i],height:chartSettings.height,width:chartSettings.width,loading:loading}))))))},MultiMetricDetectors=({setIsValid:setIsValid})=>{const{jobCreator:jc,jobCreatorUpdate:jobCreatorUpdate,jobCreatorUpdated:jobCreatorUpdated,chartLoader:chartLoader,chartInterval:chartInterval}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext),jobCreator=jc,fields=Object(external_kbnSharedDeps_React_.useMemo)(()=>Object(fields_utils.b)([...new_job_capabilities_service.b.fields,...jobCreator.runtimeFields]),[]),[selectedOptions,setSelectedOptions]=Object(external_kbnSharedDeps_React_.useState)([]),[aggFieldPairList,setAggFieldPairList]=Object(external_kbnSharedDeps_React_.useState)(jobCreator.aggFieldPairs),[lineChartsData,setLineChartsData]=Object(external_kbnSharedDeps_React_.useState)({}),[loadingData,setLoadingData]=Object(external_kbnSharedDeps_React_.useState)(!1),[start,setStart]=Object(external_kbnSharedDeps_React_.useState)(jobCreator.start),[end,setEnd]=Object(external_kbnSharedDeps_React_.useState)(jobCreator.end),[bucketSpanMs,setBucketSpanMs]=Object(external_kbnSharedDeps_React_.useState)(jobCreator.bucketSpanMs),[chartSettings,setChartSettings]=Object(external_kbnSharedDeps_React_.useState)(common_settings.a),[splitField,setSplitField]=Object(external_kbnSharedDeps_React_.useState)(jobCreator.splitField),[fieldValues,setFieldValues]=Object(external_kbnSharedDeps_React_.useState)([]),[pageReady,setPageReady]=Object(external_kbnSharedDeps_React_.useState)(!1);async function loadCharts(){if(pageReady&&aggFieldPairList.length>0&&(null===splitField||null!==splitField&&fieldValues.length>0)){setLoadingData(!0);try{const cs=Object(common_settings.b)(jobCreator,chartInterval);setChartSettings(cs);const resp=await chartLoader.loadLineCharts(jobCreator.start,jobCreator.end,aggFieldPairList,jobCreator.splitField,fieldValues.length>0?fieldValues[0]:null,cs.intervalMs,jobCreator.runtimeMappings,jobCreator.datafeedConfig.indices_options);setLineChartsData(resp)}catch(error){Object(toast_notification_service.a)().displayErrorToast(error),setLineChartsData([])}setLoadingData(!1)}}return Object(external_kbnSharedDeps_React_.useEffect)(()=>{setPageReady(!0)},[]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{jobCreator.removeAllDetectors(),aggFieldPairList.forEach(pair=>{jobCreator.addDetector(pair.agg,pair.field)}),jobCreatorUpdate(),loadCharts(),setIsValid(aggFieldPairList.length>0)},[aggFieldPairList.length]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{jobCreator.start===start&&jobCreator.end===end||(setStart(jobCreator.start),setEnd(jobCreator.end),loadCharts()),jobCreator.bucketSpanMs!==bucketSpanMs&&(setBucketSpanMs(jobCreator.bucketSpanMs),loadCharts()),setSplitField(jobCreator.splitField)},[jobCreatorUpdated]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{null!==splitField?chartLoader.loadFieldExampleValues(splitField,jobCreator.runtimeMappings,jobCreator.datafeedConfig.indices_options).then(setFieldValues).catch(error=>{Object(toast_notification_service.a)().displayErrorToast(error)}):setFieldValues([])},[splitField]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{loadCharts()},[fieldValues]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(ChartGrid,{aggFieldPairList:aggFieldPairList,chartSettings:chartSettings,splitField:splitField,fieldValues:fieldValues,lineChartsData:lineChartsData,modelData:[],anomalyData:[],deleteDetector:function(index){aggFieldPairList.splice(index,1),setAggFieldPairList([...aggFieldPairList])},jobType:jobCreator.type,loading:loadingData}),external_kbnSharedDeps_React_default.a.createElement(MetricSelector,{fields:fields,detectorChangeHandler:function(selectedOptionsIn){!function(selectedOptionsIn){if(null!==selectedOptionsIn&&selectedOptionsIn.length){const option=selectedOptionsIn[0];if(void 0!==option){const newPair={agg:option.agg,field:option.field};setAggFieldPairList([...aggFieldPairList,newPair]),setSelectedOptions([])}else setAggFieldPairList([])}}(selectedOptionsIn)},selectedOptions:selectedOptions,removeOptions:aggFieldPairList}))},MultiMetricDetectorsSummary=()=>{const{jobCreator:jc,chartLoader:chartLoader,resultsLoader:resultsLoader,chartInterval:chartInterval}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext),jobCreator=jc,[lineChartsData,setLineChartsData]=Object(external_kbnSharedDeps_React_.useState)({}),[loadingData,setLoadingData]=Object(external_kbnSharedDeps_React_.useState)(!1),[modelData,setModelData]=Object(external_kbnSharedDeps_React_.useState)([]),[anomalyData,setAnomalyData]=Object(external_kbnSharedDeps_React_.useState)([]),[chartSettings,setChartSettings]=Object(external_kbnSharedDeps_React_.useState)(common_settings.a),[fieldValues,setFieldValues]=Object(external_kbnSharedDeps_React_.useState)([]);function setResultsWrapper(results){setModelData(results.model),setAnomalyData(results.anomalies)}function allDataReady(){return jobCreator.aggFieldPairs.length>0&&(null===jobCreator.splitField||null!==jobCreator.splitField&&fieldValues.length>0)}return Object(external_kbnSharedDeps_React_.useEffect)(()=>{const subscription=resultsLoader.subscribeToResults(setResultsWrapper);return(async()=>{if(null!==jobCreator.splitField)try{const tempFieldValues=await chartLoader.loadFieldExampleValues(jobCreator.splitField,jobCreator.runtimeMappings,jobCreator.datafeedConfig.indices_options);setFieldValues(tempFieldValues)}catch(error){Object(toast_notification_service.a)().displayErrorToast(error)}})(),()=>{subscription.unsubscribe()}},[]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{allDataReady()&&async function(){if(allDataReady()){setLoadingData(!0);try{const cs=Object(common_settings.b)(jobCreator,chartInterval);setChartSettings(cs);const resp=await chartLoader.loadLineCharts(jobCreator.start,jobCreator.end,jobCreator.aggFieldPairs,jobCreator.splitField,fieldValues.length>0?fieldValues[0]:null,cs.intervalMs,jobCreator.runtimeMappings,jobCreator.datafeedConfig.indices_options);setLineChartsData(resp)}catch(error){Object(toast_notification_service.a)().displayErrorToast(error),setLineChartsData({})}setLoadingData(!1)}}()},[fieldValues]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,Object.keys(lineChartsData).length&&external_kbnSharedDeps_React_default.a.createElement(ChartGrid,{aggFieldPairList:jobCreator.aggFieldPairs,chartSettings:chartSettings,splitField:jobCreator.splitField,fieldValues:fieldValues,lineChartsData:lineChartsData,modelData:modelData,anomalyData:anomalyData,deleteDetector:void 0,jobType:jobCreator.type,loading:loadingData}))},SplitFieldSelect=({fields:fields,changeHandler:changeHandler,selectedField:selectedField,isClearable:isClearable,testSubject:testSubject,placeholder:placeholder})=>{const options=fields.map(f=>({label:f.name,field:f})),selection=[];return null!==selectedField&&selection.push({label:selectedField.name,field:selectedField}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiComboBox,{singleSelection:{asPlainText:!0},options:options,selectedOptions:selection,onChange:function(selectedOptions){const option=selectedOptions[0];changeHandler(void 0!==option?option.field:null)},isClearable:isClearable,placeholder:placeholder,"data-test-subj":testSubject})},ByFieldSelector=({detectorIndex:detectorIndex})=>{const{jobCreator:jc,jobCreatorUpdate:jobCreatorUpdate,jobCreatorUpdated:jobCreatorUpdated}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext),jobCreator=jc,runtimeCategoryFields=Object(external_kbnSharedDeps_React_.useMemo)(()=>Object(new_job_capabilities_service.a)(jobCreator.runtimeFields),[]),allCategoryFields=Object(external_kbnSharedDeps_React_.useMemo)(()=>[...new_job_capabilities_service.b.categoryFields,...runtimeCategoryFields],[]),[byField,setByField]=Object(external_kbnSharedDeps_React_.useState)(jobCreator.getByField(detectorIndex)),categoryFields=function(allCategoryFields,jobCreator,jobCreatorUpdated){const[fields,setFields]=Object(external_kbnSharedDeps_React_.useState)(allCategoryFields);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{const sf=jobCreator.splitField;setFields(null!==sf?allCategoryFields.filter(f=>f.name!==sf.name):allCategoryFields)},[jobCreatorUpdated]),fields}(allCategoryFields,jobCreator,jobCreatorUpdated);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{jobCreator.setByField(byField,detectorIndex),null!==byField&&!1===jobCreator.influencers.includes(byField.name)&&jobCreator.addInfluencer(byField.name),jobCreatorUpdate()},[byField]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{const bf=jobCreator.getByField(detectorIndex);setByField(bf)},[jobCreatorUpdated]),external_kbnSharedDeps_React_default.a.createElement(SplitFieldSelect,{fields:categoryFields,changeHandler:setByField,selectedField:byField,isClearable:!0,testSubject:"mlByFieldSelect",placeholder:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.populationField.placeholder",{defaultMessage:"Split data"})})};const split_field_description_Description=Object(external_kbnSharedDeps_React_.memo)(({children:children,jobType:jobType})=>{if(jobType===new_job.f.MULTI_METRIC){const title=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.splitField.title",{defaultMessage:"Split field"});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescribedFormGroup,{title:external_kbnSharedDeps_React_default.a.createElement("h3",null,title),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.splitField.description",defaultMessage:"Select a field to partition analysis by. Each value of this field will be modeled independently individually."})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:title},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,children)))}if(jobType===new_job.f.POPULATION){const title=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.populationField.title",{defaultMessage:"Population field"});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescribedFormGroup,{title:external_kbnSharedDeps_React_default.a.createElement("h3",null,title),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.populationField.description",defaultMessage:"All values in the selected field will be modeled together as a population. This analysis type is recommended for high cardinality data."})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:title},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,children)))}return null}),SplitFieldSelector=()=>{const{jobCreator:jc,jobCreatorUpdate:jobCreatorUpdate,jobCreatorUpdated:jobCreatorUpdated}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext),jobCreator=jc,canClearSelection=Object(job_creator.c)(jc),runtimeCategoryFields=Object(external_kbnSharedDeps_React_.useMemo)(()=>Object(new_job_capabilities_service.a)(jobCreator.runtimeFields),[]),categoryFields=Object(external_kbnSharedDeps_React_.useMemo)(()=>[...new_job_capabilities_service.b.categoryFields,...runtimeCategoryFields],[]),[splitField,setSplitField]=Object(external_kbnSharedDeps_React_.useState)(jobCreator.splitField);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{jobCreator.setSplitField(splitField),null!==splitField&&!1===jobCreator.influencers.includes(splitField.name)&&jobCreator.addInfluencer(splitField.name),jobCreatorUpdate()},[splitField]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{setSplitField(jobCreator.splitField)},[jobCreatorUpdated]),external_kbnSharedDeps_React_default.a.createElement(split_field_description_Description,{jobType:jobCreator.type},external_kbnSharedDeps_React_default.a.createElement(SplitFieldSelect,{fields:categoryFields,changeHandler:setSplitField,selectedField:splitField,isClearable:canClearSelection,testSubject:Object(job_creator.c)(jc)?"mlMultiMetricSplitFieldSelect":Object(job_creator.d)(jc)?"mlPopulationSplitFieldSelect":void 0}))},InfluencersSelect=({fields:fields,changeHandler:changeHandler,selectedInfluencers:selectedInfluencers})=>{const{jobCreator:jobCreator}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext),options=[...Object(general.g)(fields,jobCreator.additionalFields),...Object(general.h)(jobCreator.categorizationFieldName)],selection=selectedInfluencers.map(i=>({label:i}));return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiComboBox,{options:options,selectedOptions:selection,onChange:function(selectedOptions){changeHandler(selectedOptions.map(o=>o.label))},isClearable:!1,"data-test-subj":"mlInfluencerSelect"})},influencers_description_Description=Object(external_kbnSharedDeps_React_.memo)(({children:children})=>{const title=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.influencers.title",{defaultMessage:"Influencers"});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescribedFormGroup,{title:external_kbnSharedDeps_React_default.a.createElement("h3",null,title),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.influencers.description",defaultMessage:"Select which categorical fields have influence on the results. Who/what might you 'blame' for an anomaly? Recommend 1-3 influencers."})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:title},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,children)))}),Influencers=()=>{const{jobCreator:jc,jobCreatorUpdate:jobCreatorUpdate,jobCreatorUpdated:jobCreatorUpdated}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext),jobCreator=jc,{fields:fields}=new_job_capabilities_service.b,[influencers,setInfluencers]=Object(external_kbnSharedDeps_React_.useState)([...jobCreator.influencers]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{jobCreator.removeAllInfluencers(),influencers.forEach(i=>jobCreator.addInfluencer(i)),jobCreatorUpdate()},[influencers.join()]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{setInfluencers([...jobCreator.influencers])},[jobCreatorUpdated]),external_kbnSharedDeps_React_default.a.createElement(influencers_description_Description,null,external_kbnSharedDeps_React_default.a.createElement(InfluencersSelect,{fields:fields,changeHandler:setInfluencers,selectedInfluencers:influencers}))},MultiMetricSettings=({setIsValid:setIsValid})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"xl"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(SplitFieldSelector,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(Influencers,null))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"xl"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(BucketSpan,{setIsValid:setIsValid})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(SparseDataSwitch,null)))),MultiMetricView=({isActive:isActive,setCanProceed:setCanProceed})=>{const[metricsValid,setMetricValid]=Object(external_kbnSharedDeps_React_.useState)(!1),[settingsValid,setSettingsValid]=Object(external_kbnSharedDeps_React_.useState)(!1);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{"function"==typeof setCanProceed&&setCanProceed(metricsValid&&settingsValid)},[metricsValid,settingsValid]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,!1===isActive?external_kbnSharedDeps_React_default.a.createElement(MultiMetricDetectorsSummary,null):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(MultiMetricDetectors,{setIsValid:setMetricValid}),metricsValid&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHorizontalRule,{margin:"l"}),external_kbnSharedDeps_React_default.a.createElement(MultiMetricSettings,{setIsValid:setSettingsValid}))))},metric_selector_MetricSelector=({fields:fields,detectorChangeHandler:detectorChangeHandler,selectedOptions:selectedOptions,maxWidth:maxWidth,removeOptions:removeOptions})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{style:{maxWidth:void 0!==maxWidth?maxWidth:560}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.populationView.addMetric",{defaultMessage:"Add metric"})},external_kbnSharedDeps_React_default.a.createElement(AggSelect,{fields:fields,changeHandler:detectorChangeHandler,selectedOptions:selectedOptions,removeOptions:removeOptions})))),chart_grid_ChartGrid=({aggFieldPairList:aggFieldPairList,chartSettings:chartSettings,splitField:splitField,lineChartsData:lineChartsData,modelData:modelData,anomalyData:anomalyData,deleteDetector:deleteDetector,jobType:jobType,fieldValuesPerDetector:fieldValuesPerDetector,loading:loading=!1})=>{const animateSplit=useAnimateSplit();return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGrid,{columns:chartSettings.cols},aggFieldPairList.map((af,i)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{key:i,"data-test-subj":"mlDetector "+i},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(DetectorTitle,{index:i,agg:aggFieldPairList[i].agg,field:aggFieldPairList[i].field,byField:aggFieldPairList[i].by,deleteDetector:deleteDetector},void 0!==deleteDetector&&external_kbnSharedDeps_React_default.a.createElement(ByFieldSelector,{detectorIndex:i})),jobType===new_job.f.POPULATION&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}))),external_kbnSharedDeps_React_default.a.createElement(SplitCards,{fieldValues:fieldValuesPerDetector[i]||[],splitField:splitField,numberOfDetectors:aggFieldPairList.length,jobType:jobType,animate:animateSplit},external_kbnSharedDeps_React_default.a.createElement(AnomalyChart,{chartType:CHART_TYPE.SCATTER,chartData:lineChartsData[i],modelData:modelData[i],anomalyData:anomalyData[i],height:chartSettings.height,width:chartSettings.width,loading:loading}))))))},PopulationDetectors=({setIsValid:setIsValid})=>{const{jobCreator:jc,jobCreatorUpdate:jobCreatorUpdate,jobCreatorUpdated:jobCreatorUpdated,chartLoader:chartLoader,chartInterval:chartInterval}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext),jobCreator=jc,fields=Object(external_kbnSharedDeps_React_.useMemo)(()=>Object(fields_utils.b)([...new_job_capabilities_service.b.fields,...jobCreator.runtimeFields]),[]),[selectedOptions,setSelectedOptions]=Object(external_kbnSharedDeps_React_.useState)([]),[aggFieldPairList,setAggFieldPairList]=Object(external_kbnSharedDeps_React_.useState)(jobCreator.aggFieldPairs),[lineChartsData,setLineChartsData]=Object(external_kbnSharedDeps_React_.useState)({}),[loadingData,setLoadingData]=Object(external_kbnSharedDeps_React_.useState)(!1),[start,setStart]=Object(external_kbnSharedDeps_React_.useState)(jobCreator.start),[end,setEnd]=Object(external_kbnSharedDeps_React_.useState)(jobCreator.end),[bucketSpanMs,setBucketSpanMs]=Object(external_kbnSharedDeps_React_.useState)(jobCreator.bucketSpanMs),[chartSettings,setChartSettings]=Object(external_kbnSharedDeps_React_.useState)(common_settings.a),[splitField,setSplitField]=Object(external_kbnSharedDeps_React_.useState)(jobCreator.splitField),[fieldValuesPerDetector,setFieldValuesPerDetector]=Object(external_kbnSharedDeps_React_.useState)({}),[byFieldsUpdated,setByFieldsUpdated]=Object(external_kbnSharedDeps_React_.useReducer)(s=>s+1,0),[pageReady,setPageReady]=Object(external_kbnSharedDeps_React_.useState)(!1),updateByFields=()=>setByFieldsUpdated(0);async function loadCharts(){if(function(){let ready=aggFieldPairList.length>0;return aggFieldPairList.forEach(af=>{void 0!==af.by&&null!==af.by.field&&(ready=ready&&null!==af.by.value)}),ready}()){setLoadingData(!0);try{const cs=Object(common_settings.b)(jobCreator,chartInterval);setChartSettings(cs);const resp=await chartLoader.loadPopulationCharts(jobCreator.start,jobCreator.end,aggFieldPairList,jobCreator.splitField,cs.intervalMs,jobCreator.runtimeMappings,jobCreator.datafeedConfig.indices_options);setLineChartsData(resp)}catch(error){Object(toast_notification_service.a)().displayErrorToast(error),setLineChartsData([])}setLoadingData(!1)}}return Object(external_kbnSharedDeps_React_.useEffect)(()=>{setPageReady(!0)},[]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{jobCreator.removeAllDetectors(),aggFieldPairList.forEach((pair,i)=>{jobCreator.addDetector(pair.agg,pair.field),void 0!==pair.by&&jobCreator.setByField(pair.by.field,i)}),jobCreatorUpdate(),loadCharts(),setIsValid(aggFieldPairList.length>0)},[aggFieldPairList.length]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{loadCharts()},[JSON.stringify(fieldValuesPerDetector),splitField,pageReady]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{jobCreator.start===start&&jobCreator.end===end||(setStart(jobCreator.start),setEnd(jobCreator.end),loadCharts()),jobCreator.bucketSpanMs!==bucketSpanMs&&(setBucketSpanMs(jobCreator.bucketSpanMs),loadCharts()),setSplitField(jobCreator.splitField);let update=!1;const newList=[...aggFieldPairList];newList.forEach((pair,i)=>{const bf=jobCreator.getByField(i);void 0!==pair.by&&pair.by.field!==bf&&(pair.by.field=bf,update=!0)}),update&&(setAggFieldPairList(newList),updateByFields())},[jobCreatorUpdated]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{!async function(){const promises=[];aggFieldPairList.forEach((af,i)=>{void 0!==af.by&&null!==af.by.field&&promises.push((async(index,field)=>({index:index,fields:await chartLoader.loadFieldExampleValues(field,jobCreator.runtimeMappings,jobCreator.datafeedConfig.indices_options)}))(i,af.by.field))});const fieldValues=(await Promise.all(promises)).reduce((p,c)=>(p[c.index]=c.fields,p),{}),newPairs=aggFieldPairList.map((pair,i)=>({...pair,...void 0===pair.by||null===pair.by.field?{}:{by:{...pair.by,value:fieldValues[i][0]}}}));setAggFieldPairList([...newPairs]),setFieldValuesPerDetector(fieldValues)}()},[splitField,byFieldsUpdated]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(SplitFieldSelector,null),null!==splitField&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHorizontalRule,{margin:"l"}),null!==splitField&&external_kbnSharedDeps_React_default.a.createElement(chart_grid_ChartGrid,{aggFieldPairList:aggFieldPairList,chartSettings:chartSettings,splitField:splitField,lineChartsData:lineChartsData,modelData:[],anomalyData:[],deleteDetector:function(index){aggFieldPairList.splice(index,1),setAggFieldPairList([...aggFieldPairList]),updateByFields()},jobType:jobCreator.type,fieldValuesPerDetector:fieldValuesPerDetector,loading:loadingData}),null!==splitField&&external_kbnSharedDeps_React_default.a.createElement(metric_selector_MetricSelector,{fields:fields,detectorChangeHandler:function(selectedOptionsIn){!function(selectedOptionsIn){if(null!==selectedOptionsIn&&selectedOptionsIn.length){const option=selectedOptionsIn[0];if(void 0!==option){const newPair={agg:option.agg,field:option.field,by:{field:null,value:null}};setAggFieldPairList([...aggFieldPairList,newPair]),setSelectedOptions([])}else setAggFieldPairList([])}}(selectedOptionsIn)},selectedOptions:selectedOptions,removeOptions:[]}))},PopulationDetectorsSummary=()=>{const{jobCreator:jc,chartLoader:chartLoader,resultsLoader:resultsLoader,chartInterval:chartInterval}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext),jobCreator=jc,[aggFieldPairList,setAggFieldPairList]=Object(external_kbnSharedDeps_React_.useState)(jobCreator.aggFieldPairs),[lineChartsData,setLineChartsData]=Object(external_kbnSharedDeps_React_.useState)({}),[loadingData,setLoadingData]=Object(external_kbnSharedDeps_React_.useState)(!1),[modelData,setModelData]=Object(external_kbnSharedDeps_React_.useState)([]),[anomalyData,setAnomalyData]=Object(external_kbnSharedDeps_React_.useState)([]),[chartSettings,setChartSettings]=Object(external_kbnSharedDeps_React_.useState)(common_settings.a),[fieldValuesPerDetector,setFieldValuesPerDetector]=Object(external_kbnSharedDeps_React_.useState)({});function setResultsWrapper(results){setModelData(results.model),setAnomalyData(results.anomalies)}function allDataReady(){let ready=aggFieldPairList.length>0;return aggFieldPairList.forEach(af=>{void 0!==af.by&&null!==af.by.field&&(ready=ready&&null!==af.by.value)}),ready}return Object(external_kbnSharedDeps_React_.useEffect)(()=>{const subscription=resultsLoader.subscribeToResults(setResultsWrapper);return()=>{subscription.unsubscribe()}},[]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{allDataReady()&&async function(){if(allDataReady()){setLoadingData(!0);try{const cs=Object(common_settings.b)(jobCreator,chartInterval);setChartSettings(cs);const resp=await chartLoader.loadPopulationCharts(jobCreator.start,jobCreator.end,aggFieldPairList,jobCreator.splitField,cs.intervalMs,jobCreator.runtimeMappings,jobCreator.datafeedConfig.indices_options);setLineChartsData(resp)}catch(error){Object(toast_notification_service.a)().displayErrorToast(error),setLineChartsData({})}setLoadingData(!1)}}()},[JSON.stringify(fieldValuesPerDetector),jobCreator.splitField]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{!async function(){const promises=[];aggFieldPairList.forEach((af,i)=>{void 0!==af.by&&null!==af.by.field&&promises.push((async(index,field)=>({index:index,fields:await chartLoader.loadFieldExampleValues(field,jobCreator.runtimeMappings,jobCreator.datafeedConfig.indices_options)}))(i,af.by.field))});const fieldValues=(await Promise.all(promises)).reduce((p,c)=>(p[c.index]=c.fields,p),{}),newPairs=aggFieldPairList.map((pair,i)=>({...pair,...void 0===pair.by||null===pair.by.field?{}:{by:{...pair.by,value:fieldValues[i][0]}}}));setAggFieldPairList([...newPairs]),setFieldValuesPerDetector(fieldValues)}()},[jobCreator.splitField]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,null!==jobCreator.splitField&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.populationView.splitFieldTitle",defaultMessage:"Population split by {field}",values:{field:jobCreator.splitField.name}}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),external_kbnSharedDeps_React_default.a.createElement(chart_grid_ChartGrid,{aggFieldPairList:jobCreator.aggFieldPairs,chartSettings:chartSettings,splitField:jobCreator.splitField,lineChartsData:lineChartsData,modelData:modelData,anomalyData:anomalyData,jobType:jobCreator.type,fieldValuesPerDetector:fieldValuesPerDetector,loading:loadingData})))},PopulationSettings=({setIsValid:setIsValid})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"xl"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(BucketSpan,{setIsValid:setIsValid})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(Influencers,null)))),PopulationView=({isActive:isActive,setCanProceed:setCanProceed})=>{const[metricsValid,setMetricValid]=Object(external_kbnSharedDeps_React_.useState)(!1),[settingsValid,setSettingsValid]=Object(external_kbnSharedDeps_React_.useState)(!1);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{"function"==typeof setCanProceed&&setCanProceed(metricsValid&&settingsValid)},[metricsValid,settingsValid]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,!1===isActive?external_kbnSharedDeps_React_default.a.createElement(PopulationDetectorsSummary,null):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(PopulationDetectors,{setIsValid:setMetricValid}),metricsValid&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHorizontalRule,{margin:"l"}),external_kbnSharedDeps_React_default.a.createElement(PopulationSettings,{setIsValid:setSettingsValid}))))},ModalWrapper=({onCreateClick:onCreateClick,closeModal:closeModal,saveEnabled:saveEnabled,children:children})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModal,{onClose:closeModal,maxWidth:1200,"data-test-subj":"mlCreateDetectorModal"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalHeader,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalHeaderTitle,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.title",defaultMessage:"Create detector"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalBody,null,children),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalFooter,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{onClick:closeModal,"data-test-subj":"mlCreateDetectorModalCancelButton"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.cancelButton",defaultMessage:"Cancel"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{onClick:onCreateClick,isDisabled:!1===saveEnabled,fill:!0,"data-test-subj":"mlCreateDetectorModalSaveButton"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.saveButton",defaultMessage:"Save"}))));var string_utils=__webpack_require__(89),default_configs=__webpack_require__(139);const AggDescription=Object(external_kbnSharedDeps_React_.memo)(({children:children})=>{const title=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.aggSelect.title",{defaultMessage:"Function"});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescribedFormGroup,{title:external_kbnSharedDeps_React_default.a.createElement("h3",null,title),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.aggSelect.description",defaultMessage:"Analysis functions to be performed e.g. sum, count."})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:title},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,children)))}),FieldDescription=Object(external_kbnSharedDeps_React_.memo)(({children:children})=>{const title=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.fieldSelect.title",{defaultMessage:"Field"});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescribedFormGroup,{title:external_kbnSharedDeps_React_default.a.createElement("h3",null,title),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.fieldSelect.description",defaultMessage:"Required for functions: sum, mean, median, max, min, info_content, distinct_count, lat_long."})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:title},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,children)))}),ByFieldDescription=Object(external_kbnSharedDeps_React_.memo)(({children:children})=>{const title=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.byFieldSelect.title",{defaultMessage:"By field"});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescribedFormGroup,{title:external_kbnSharedDeps_React_default.a.createElement("h3",null,title),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.byFieldSelect.description",defaultMessage:"Required for individual analysis where anomalies are detected compared to an entity's own past behavior."})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:title},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,children)))}),OverFieldDescription=Object(external_kbnSharedDeps_React_.memo)(({children:children})=>{const title=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.overFieldSelect.title",{defaultMessage:"Over field"});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescribedFormGroup,{title:external_kbnSharedDeps_React_default.a.createElement("h3",null,title),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.overFieldSelect.description",defaultMessage:"Required for population analysis where anomalies are detected compared to the behavior of the population."})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:title},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,children)))}),PartitionFieldDescription=Object(external_kbnSharedDeps_React_.memo)(({children:children})=>{const title=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.partitionFieldSelect.title",{defaultMessage:"Partition field"});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescribedFormGroup,{title:external_kbnSharedDeps_React_default.a.createElement("h3",null,title),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.partitionFieldSelect.description",defaultMessage:"Allows segmentation of modeling into logical groups."})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:title},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,children)))}),ExcludeFrequentDescription=Object(external_kbnSharedDeps_React_.memo)(({children:children})=>{const title=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.excludeFrequent.title",{defaultMessage:"Exclude frequent"});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescribedFormGroup,{title:external_kbnSharedDeps_React_default.a.createElement("h3",null,title),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.excludeFrequent.description",defaultMessage:"If set, it will automatically identify and exclude frequently occurring entities which may otherwise have dominated results."})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:title},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,children)))}),DescriptionDescription=Object(external_kbnSharedDeps_React_.memo)(({children:children})=>{const title=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.description.title",{defaultMessage:"Description"});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescribedFormGroup,{fullWidth:!0,title:external_kbnSharedDeps_React_default.a.createElement("h3",null,title),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.description.description",defaultMessage:"Override the default detector description with a meaningful description of what the detector is analyzing."})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:title,fullWidth:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,children)))}),emptyOption={label:""},excludeFrequentOptions=[{label:"all"},{label:"none"},{label:"by"},{label:"over"}],AdvancedDetectorModal=({payload:payload,fields:fields,aggs:aggs,detectorChangeHandler:detectorChangeHandler,closeModal:closeModal})=>{const{jobCreator:jc}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext),jobCreator=jc,[detector,setDetector]=Object(external_kbnSharedDeps_React_.useState)(payload.detector),[aggOption,setAggOption]=Object(external_kbnSharedDeps_React_.useState)(createAggOption(detector.agg)),[fieldOption,setFieldOption]=Object(external_kbnSharedDeps_React_.useState)(createFieldOption(detector.field)),[byFieldOption,setByFieldOption]=Object(external_kbnSharedDeps_React_.useState)(createFieldOption(detector.byField)),[overFieldOption,setOverFieldOption]=Object(external_kbnSharedDeps_React_.useState)(createFieldOption(detector.overField)),[partitionFieldOption,setPartitionFieldOption]=Object(external_kbnSharedDeps_React_.useState)(createFieldOption(detector.partitionField)),[excludeFrequentOption,setExcludeFrequentOption]=Object(external_kbnSharedDeps_React_.useState)(function(excludeFrequent){if(null===excludeFrequent)return emptyOption;return{label:excludeFrequent}}(detector.excludeFrequent)),[descriptionOption,setDescriptionOption]=Object(external_kbnSharedDeps_React_.useState)(detector.description||""),[splitFieldsEnabled,setSplitFieldsEnabled]=Object(external_kbnSharedDeps_React_.useState)(!0),[excludeFrequentEnabled,setExcludeFrequentEnabled]=Object(external_kbnSharedDeps_React_.useState)(!0),[fieldOptionEnabled,setFieldOptionEnabled]=Object(external_kbnSharedDeps_React_.useState)(!0),{descriptionPlaceholder:descriptionPlaceholder,setDescriptionPlaceholder:setDescriptionPlaceholder}=function(detector){const[descriptionPlaceholder,setDescriptionPlaceholderString]=Object(external_kbnSharedDeps_React_.useState)(createDefaultDescription(detector));return{descriptionPlaceholder:descriptionPlaceholder,setDescriptionPlaceholder:function(dtr){setDescriptionPlaceholderString(createDefaultDescription(dtr))}}}(detector),usingScriptFields=jobCreator.additionalFields.length>0,aggOptions=aggs.filter(agg=>function(agg,usingScriptFields){return void 0!==agg.fields&&(usingScriptFields||agg.fields.length)}(agg,usingScriptFields)).map(createAggOption),{currentFieldOptions:currentFieldOptions,setCurrentFieldOptions:setCurrentFieldOptions}=function(aggregation,additionalFields,fields){const[currentFieldOptions,setCurrentFieldOptions]=Object(external_kbnSharedDeps_React_.useState)(createFieldOptionsFromAgg(aggregation,additionalFields));return{currentFieldOptions:currentFieldOptions,setCurrentFieldOptions:agg=>setCurrentFieldOptions(createFieldOptionsFromAgg(agg,additionalFields))}}(detector.agg,jobCreator.additionalFields),splitFieldOptions=[...[...Object(general.g)(fields,jobCreator.additionalFields)].sort(comboBoxOptionsSort),...Object(general.h)(jobCreator.categorizationFieldName)].sort(comboBoxOptionsSort),eventRateField=fields.find(f=>f.id===types_fields.a),onOptionChange=func=>selectedOptions=>{func(selectedOptions[0]||emptyOption)};function getAgg(title){return aggs.find(a=>a.id===title)||null}function getField(title){return title===types_fields.c.id?types_fields.c:fields.find(f=>f.id===title)||jobCreator.additionalFields.find(f=>f.id===title)||null}return Object(external_kbnSharedDeps_React_.useEffect)(()=>{const agg=getAgg(aggOption.label);let field=getField(fieldOption.label);const byField=getField(byFieldOption.label),overField=getField(overFieldOption.label),partitionField=getField(partitionFieldOption.label);null!==agg?(setCurrentFieldOptions(agg),isFieldlessAgg(agg)&&void 0!==eventRateField?(setSplitFieldsEnabled(!0),setFieldOption(emptyOption),setFieldOptionEnabled(!1),field=eventRateField):(setSplitFieldsEnabled(null!==field),setFieldOptionEnabled(!0)),setExcludeFrequentEnabled(null!==byField||null!==overField)):(setSplitFieldsEnabled(!1),setFieldOptionEnabled(!1));const dtr={agg:agg,field:field,byField:byField,overField:overField,partitionField:partitionField,excludeFrequent:""!==excludeFrequentOption.label?excludeFrequentOption.label:null,description:""!==descriptionOption?descriptionOption:null,customRules:null};setDetector(dtr),setDescriptionPlaceholder(dtr)},[aggOption,fieldOption,byFieldOption,overFieldOption,partitionFieldOption,excludeFrequentOption,descriptionOption]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{const agg=getAgg(aggOption.label);if(setSplitFieldsEnabled(""!==aggOption.label),null!==agg){setFieldOptionEnabled(!1===isFieldlessAgg(agg));const byField=getField(byFieldOption.label),overField=getField(overFieldOption.label);setExcludeFrequentEnabled(null!==byField||null!==overField)}},[]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{!1===excludeFrequentEnabled&&setExcludeFrequentOption(emptyOption)},[excludeFrequentEnabled]),external_kbnSharedDeps_React_default.a.createElement(ModalWrapper,{onCreateClick:function(){detectorChangeHandler(detector,payload.index)},closeModal:closeModal,saveEnabled:splitFieldsEnabled&&(!1===fieldOptionEnabled||!0===fieldOptionEnabled&&""!==fieldOption.label)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{"data-test-subj":"mlAdvancedFunctionSelect"},external_kbnSharedDeps_React_default.a.createElement(AggDescription,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiComboBox,{singleSelection:{asPlainText:!0},options:aggOptions,selectedOptions:createSelectedOptions(aggOption,aggOptions),onChange:onOptionChange(setAggOption),isClearable:!0}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{"data-test-subj":"mlAdvancedFieldSelect"},external_kbnSharedDeps_React_default.a.createElement(FieldDescription,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiComboBox,{singleSelection:{asPlainText:!0},options:currentFieldOptions,selectedOptions:createSelectedOptions(fieldOption,currentFieldOptions),onChange:onOptionChange(setFieldOption),isClearable:!0,isDisabled:!1===fieldOptionEnabled})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHorizontalRule,{margin:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGrid,{columns:2},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{"data-test-subj":"mlAdvancedByFieldSelect"},external_kbnSharedDeps_React_default.a.createElement(ByFieldDescription,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiComboBox,{singleSelection:{asPlainText:!0},options:splitFieldOptions,selectedOptions:createSelectedOptions(byFieldOption,splitFieldOptions),onChange:onOptionChange(setByFieldOption),isClearable:!0,isDisabled:!1===splitFieldsEnabled}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{"data-test-subj":"mlAdvancedOverFieldSelect"},external_kbnSharedDeps_React_default.a.createElement(OverFieldDescription,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiComboBox,{singleSelection:{asPlainText:!0},options:splitFieldOptions,selectedOptions:createSelectedOptions(overFieldOption,splitFieldOptions),onChange:onOptionChange(setOverFieldOption),isClearable:!0,isDisabled:!1===splitFieldsEnabled}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{"data-test-subj":"mlAdvancedPartitionFieldSelect"},external_kbnSharedDeps_React_default.a.createElement(PartitionFieldDescription,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiComboBox,{singleSelection:{asPlainText:!0},options:splitFieldOptions,selectedOptions:createSelectedOptions(partitionFieldOption,splitFieldOptions),onChange:onOptionChange(setPartitionFieldOption),isClearable:!0,isDisabled:!1===splitFieldsEnabled}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{"data-test-subj":"mlAdvancedExcludeFrequentSelect"},external_kbnSharedDeps_React_default.a.createElement(ExcludeFrequentDescription,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiComboBox,{singleSelection:{asPlainText:!0},options:excludeFrequentOptions,selectedOptions:createSelectedOptions(excludeFrequentOption,excludeFrequentOptions),onChange:onOptionChange(setExcludeFrequentOption),isClearable:!0,isDisabled:!1===splitFieldsEnabled||!1===excludeFrequentEnabled})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHorizontalRule,{margin:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(DescriptionDescription,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTextArea,{rows:2,fullWidth:!0,placeholder:descriptionPlaceholder,value:descriptionOption,onChange:e=>setDescriptionOption(e.target.value),"data-test-subj":"mlAdvancedDetectorDescriptionInput"}))))))};function createAggOption(agg){return null===agg?emptyOption:{label:agg.id}}function createFieldOption(field){return null===field?emptyOption:{label:field.name}}function isFieldlessAgg(agg){return agg.fields&&1===agg.fields.length&&agg.fields[0].id===types_fields.a}function createFieldOptionsFromAgg(agg,additionalFields){return Object(general.g)(null!==agg&&void 0!==agg.fields?agg.fields:[],additionalFields)}function createDefaultDescription(dtr){if(null===dtr.agg||null===dtr.field)return"";const basicDetector=Object(default_configs.a)(dtr.agg,dtr.field);return basicDetector.by_field_name=dtr.byField?dtr.byField.id:void 0,basicDetector.over_field_name=dtr.overField?dtr.overField.id:void 0,basicDetector.partition_field_name=dtr.partitionField?dtr.partitionField.id:void 0,basicDetector.exclude_frequent=dtr.excludeFrequent?dtr.excludeFrequent:void 0,Object(string_utils.b)(basicDetector)}function createSelectedOptions(selectedOption,options){return 1===options.length&&options[0].label!==selectedOption.label||""===selectedOption.label?[]:[selectedOption]}function comboBoxOptionsSort(a,b){return a.label.localeCompare(b.label)}const advanced_view_metric_selector_MetricSelector=({payload:payload,fields:fields,aggs:aggs,detectorChangeHandler:detectorChangeHandler,closeModal:closeModal,showModal:showModal})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{style:{maxWidth:560}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{onClick:showModal,"data-test-subj":"mlAddDetectorButton"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.addDetectorButton",defaultMessage:"Add detector"}))))),null!==payload&&external_kbnSharedDeps_React_default.a.createElement(AdvancedDetectorModal,{payload:payload,fields:fields,aggs:aggs,detectorChangeHandler:detectorChangeHandler,closeModal:closeModal})),DetectorList=({isActive:isActive,onEditJob:onEditJob,onDeleteJob:onDeleteJob})=>{const{jobCreator:jc,jobCreatorUpdated:jobCreatorUpdated,jobValidator:jobValidator,jobValidatorUpdated:jobValidatorUpdated}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext),jobCreator=jc,[detectors,setDetectors]=Object(external_kbnSharedDeps_React_.useState)(jobCreator.detectors),[validation,setValidation]=Object(external_kbnSharedDeps_React_.useState)(jobValidator.duplicateDetectors);Object(external_kbnSharedDeps_React_.useEffect)(()=>{setDetectors(jobCreator.detectors)},[jobCreatorUpdated]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{jobValidator.duplicateDetectors.valid||setValidation(jobValidator.duplicateDetectors),jobValidator.categorizerVaryingPerPartitionField.valid||setValidation(jobValidator.categorizerVaryingPerPartitionField),jobValidator.categorizerMissingPerPartition.valid||setValidation(jobValidator.categorizerMissingPerPartition)},[jobValidatorUpdated]);const Buttons=({index:index})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{color:"primary",onClick:()=>onEditJob(index),iconType:"pencil","aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorList.editButton",{defaultMessage:"Edit"}),"data-test-subj":"mlAdvancedDetectorEditButton"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{color:"danger",onClick:()=>onDeleteJob(index),iconType:"trash","aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorList.deleteButton",{defaultMessage:"Delete"}),"data-test-subj":"mlAdvancedDetectorDeleteButton"})));return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("h3",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorList.title",defaultMessage:"Detectors"}))),external_kbnSharedDeps_React_default.a.createElement(NoDetectorsWarning,{show:0===detectors.length}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGrid,{columns:3},detectors.map((d,i)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{key:i,"data-test-subj":"mlAdvancedDetector "+i},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPanel,{paddingSize:"m"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,void 0!==d.detector_description?external_kbnSharedDeps_React_default.a.createElement("div",{style:{fontWeight:"bold"},"data-test-subj":"mlDetectorDescription"},d.detector_description):external_kbnSharedDeps_React_default.a.createElement(StringifiedDetector,{detector:d})),isActive&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,style:{margin:"8px"}},external_kbnSharedDeps_React_default.a.createElement(Buttons,{index:i}))),void 0!==d.detector_description&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHorizontalRule,{margin:"s"}),external_kbnSharedDeps_React_default.a.createElement(StringifiedDetector,{detector:d})))))),external_kbnSharedDeps_React_default.a.createElement(DetectorsValidationWarning,{validation:validation}))},NoDetectorsWarning=({show:show})=>!1===show?null:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.noDetectorsCallout.title",{defaultMessage:"No detectors"}),iconType:"alert","data-test-subj":"mlAdvancedNoDetectorsMessage"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.noDetectorsCallout.message",defaultMessage:"At least one detector is needed to create a job."})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"})),DetectorsValidationWarning=({validation:validation})=>!0===validation.valid?null:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{error:validation.message,isInvalid:!1===validation.valid},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"})),StringifiedDetector=({detector:detector})=>external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":"mlDetectorIdentifier"},Object(string_utils.b)(detector)),emptyRichDetector={agg:null,field:null,byField:null,overField:null,partitionField:null,excludeFrequent:null,description:null,customRules:null},AdvancedDetectors=({setIsValid:setIsValid})=>{const{jobCreator:jc,jobCreatorUpdate:jobCreatorUpdate}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext),jobCreator=jc,{fields:fields,aggs:aggs}=new_job_capabilities_service.b,[modalPayload,setModalPayload]=Object(external_kbnSharedDeps_React_.useState)(null);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(DetectorList,{isActive:!0,onEditJob:function(i){const dtr=jobCreator.richDetectors[i];void 0!==dtr&&setModalPayload({detector:dtr,index:i})},onDeleteJob:function(i){jobCreator.removeDetector(i),jobCreatorUpdate()}}),external_kbnSharedDeps_React_default.a.createElement(advanced_view_metric_selector_MetricSelector,{payload:modalPayload,fields:fields,aggs:aggs,detectorChangeHandler:function(dtr,index){void 0===index?jobCreator.addDetector(dtr.agg,dtr.field,dtr.byField,dtr.overField,dtr.partitionField,dtr.excludeFrequent,dtr.description):jobCreator.editDetector(dtr.agg,dtr.field,dtr.byField,dtr.overField,dtr.partitionField,dtr.excludeFrequent,dtr.description,index),jobCreatorUpdate(),setModalPayload(null)},showModal:function(){setModalPayload({detector:emptyRichDetector})},closeModal:function(){setModalPayload(null)}}))},AdvancedDetectorsSummary=()=>external_kbnSharedDeps_React_default.a.createElement(DetectorList,{isActive:!1,onEditJob:()=>{},onDeleteJob:()=>{}}),model_memory_limit_description_Description=Object(external_kbnSharedDeps_React_.memo)(({children:children,validation:validation})=>{const title=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.advancedSection.modelMemoryLimit.title",{defaultMessage:"Model memory limit"});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescribedFormGroup,{title:external_kbnSharedDeps_React_default.a.createElement("h3",null,title),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobDetailsStep.advancedSection.modelMemoryLimit.description",defaultMessage:"Set an approximate upper limit for the amount of memory that can be used by the analytical models."})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:title,error:validation.message,isInvalid:!1===validation.valid},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,children)))}),ModelMemoryLimitInput=()=>{const{jobCreator:jobCreator,jobCreatorUpdate:jobCreatorUpdate,jobCreatorUpdated:jobCreatorUpdated,jobValidator:jobValidator,jobValidatorUpdated:jobValidatorUpdated}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext),[validation,setValidation]=Object(external_kbnSharedDeps_React_.useState)(jobValidator.modelMemoryLimit),[modelMemoryLimit,setModelMemoryLimit]=Object(external_kbnSharedDeps_React_.useState)(null===jobCreator.modelMemoryLimit?"":jobCreator.modelMemoryLimit),{anomaly_detectors:anomalyDetectors}=Object(ml_server_info.b)(),{model_memory_limit:modelMemoryLimitDefault}=anomalyDetectors;return Object(external_kbnSharedDeps_React_.useEffect)(()=>{jobCreator.modelMemoryLimit=""===modelMemoryLimit?null:modelMemoryLimit,jobCreatorUpdate()},[modelMemoryLimit]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{setModelMemoryLimit(null===jobCreator.modelMemoryLimit?"":jobCreator.modelMemoryLimit)},[jobCreatorUpdated]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{setValidation(jobValidator.modelMemoryLimit)},[jobValidatorUpdated]),external_kbnSharedDeps_React_default.a.createElement(model_memory_limit_description_Description,{validation:validation},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldText,{value:modelMemoryLimit,placeholder:modelMemoryLimitDefault,onChange:e=>setModelMemoryLimit(e.target.value),isInvalid:!1===validation.valid,"data-test-subj":"mlJobWizardInputModelMemoryLimit"}))},AdvancedSettings=({setIsValid:setIsValid})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"xl"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(BucketSpan,{setIsValid:setIsValid})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(Influencers,null))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"xl"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(ModelMemoryLimitInput,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null))),SummaryCountFieldSelect=({fields:fields,changeHandler:changeHandler,selectedField:selectedField})=>{const{jobCreator:jobCreator}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext),options=[...Object(general.f)(jobCreator.aggregationFields.length>0),...Object(general.g)(fields,jobCreator.additionalFields)],selection=[];return null!==selectedField&&selection.push({label:selectedField}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiComboBox,{singleSelection:{asPlainText:!0},options:options,selectedOptions:selection,onChange:function(selectedOptions){const option=selectedOptions[0];changeHandler(void 0!==option?option.label:null)},isClearable:!0,"data-test-subj":"mlSummaryCountFieldNameSelect"})},summary_count_field_description_Description=Object(external_kbnSharedDeps_React_.memo)(({children:children,validation:validation})=>{const title=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.summaryCountField.title",{defaultMessage:"Summary count field"}),{services:{docLinks:docLinks}}=Object(contexts_kibana.b)(),docsUrl=docLinks.links.ml.aggregations;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescribedFormGroup,{title:external_kbnSharedDeps_React_default.a.createElement("h3",null,title),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.summaryCountField.description",defaultMessage:"If the input data is {aggregated}, specify the field that contains the document count.",values:{aggregated:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{href:docsUrl,target:"_blank"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.summaryCountField.aggregatedText",defaultMessage:"aggregated"}))}})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:title,error:validation.message,isInvalid:!1===validation.valid},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,children)))}),SummaryCountField=()=>{const{jobCreator:jc,jobCreatorUpdate:jobCreatorUpdate,jobCreatorUpdated:jobCreatorUpdated,jobValidator:jobValidator,jobValidatorUpdated:jobValidatorUpdated}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext),jobCreator=jc,{fields:fields}=new_job_capabilities_service.b,[summaryCountFieldName,setSummaryCountFieldName]=Object(external_kbnSharedDeps_React_.useState)(jobCreator.summaryCountFieldName),[validation,setValidation]=Object(external_kbnSharedDeps_React_.useState)(jobValidator.summaryCountField);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{setValidation(jobValidator.summaryCountField)},[jobValidatorUpdated]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{jobCreator.summaryCountFieldName=summaryCountFieldName,jobCreatorUpdate()},[summaryCountFieldName]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{setSummaryCountFieldName(jobCreator.summaryCountFieldName)},[jobCreatorUpdated]),external_kbnSharedDeps_React_default.a.createElement(summary_count_field_description_Description,{validation:validation},external_kbnSharedDeps_React_default.a.createElement(SummaryCountFieldSelect,{fields:fields,changeHandler:setSummaryCountFieldName,selectedField:summaryCountFieldName}))},CategorizationFieldSelect=({fields:fields,changeHandler:changeHandler,selectedField:selectedField})=>{const{jobCreator:jobCreator,jobCreatorUpdated:jobCreatorUpdated}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext),options=Object(external_kbnSharedDeps_React_.useMemo)(()=>[...Object(general.g)(fields,jobCreator.additionalFields)],[fields,jobCreatorUpdated]),selection=Object(external_kbnSharedDeps_React_.useMemo)(()=>{const selectedOptions=[];return null!==selectedField&&selectedOptions.push({label:selectedField}),selectedOptions},[selectedField]),onChange=Object(external_kbnSharedDeps_React_.useCallback)(selectedOptions=>{var _ref;return changeHandler(null!==(_ref=selectedOptions[0]&&selectedOptions[0].label)&&void 0!==_ref?_ref:null)},[changeHandler]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiComboBox,{singleSelection:{asPlainText:!0},options:options,selectedOptions:selection,onChange:onChange,isClearable:!0,"data-test-subj":"mlCategorizationFieldNameSelect"})},categorization_field_description_Description=Object(external_kbnSharedDeps_React_.memo)(({children:children,isOptional:isOptional})=>{const title=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.categorizationField.title",{defaultMessage:"Categorization field"});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescribedFormGroup,{title:external_kbnSharedDeps_React_default.a.createElement("h3",null,title),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,isOptional?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.categorizationFieldOptional.description",defaultMessage:"Optional, for use if analyzing unstructured log data. Using text data types is recommended."}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.categorizationField.description",defaultMessage:"Specifies which field will be categorized. Using text data types is recommended. Categorization works best on machine written log messages, typically logging written by a developer for the purpose of system troubleshooting."}))},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:title},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,children)))}),CategorizationField=()=>{const{jobCreator:jc,jobCreatorUpdate:jobCreatorUpdate,jobCreatorUpdated:jobCreatorUpdated}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext),jobCreator=jc,{catFields:catFields}=new_job_capabilities_service.b,[categorizationFieldName,setCategorizationFieldName]=Object(external_kbnSharedDeps_React_.useState)(jobCreator.categorizationFieldName),isCategorizationJob=Object(job_creator.b)(jobCreator);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{jobCreator.categorizationFieldName!==categorizationFieldName&&(jobCreator.categorizationFieldName=categorizationFieldName,jobCreatorUpdate())},[categorizationFieldName]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{setCategorizationFieldName(jobCreator.categorizationFieldName)},[jobCreatorUpdated]),external_kbnSharedDeps_React_default.a.createElement(categorization_field_description_Description,{isOptional:!1===isCategorizationJob},external_kbnSharedDeps_React_default.a.createElement(CategorizationFieldSelect,{fields:catFields,changeHandler:setCategorizationFieldName,selectedField:categorizationFieldName}))},categorization_partition_field_description_Description=Object(external_kbnSharedDeps_React_.memo)(({children:children})=>{const title=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.perPartitionCategorization.enable.title",{defaultMessage:"Enable per-partition categorization"});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescribedFormGroup,{title:external_kbnSharedDeps_React_default.a.createElement("h3",null,title),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.perPartitionCategorization.enable.description",defaultMessage:"If per-partition categorization is enabled then categories are determined independently for each value of the partition field."})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,children))}),CategorizationPerPartitionSwitch=()=>{const{jobCreator:jc,jobCreatorUpdate:jobCreatorUpdate,jobCreatorUpdated:jobCreatorUpdated}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext),jobCreator=jc,[enablePerPartitionCategorization,setEnablePerPartitionCategorization]=Object(external_kbnSharedDeps_React_.useState)(jobCreator.perPartitionCategorization),toggleEnablePerPartitionCategorization=Object(external_kbnSharedDeps_React_.useCallback)(()=>setEnablePerPartitionCategorization(!enablePerPartitionCategorization),[enablePerPartitionCategorization]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{setEnablePerPartitionCategorization(jobCreator.perPartitionCategorization)},[jobCreatorUpdated]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{!1===enablePerPartitionCategorization&&(jobCreator.perPartitionStopOnWarn=!1),jobCreator.perPartitionCategorization=enablePerPartitionCategorization,jobCreatorUpdate()},[enablePerPartitionCategorization]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSwitch,{name:"categorizationPerPartitionSwitch",disabled:!1,checked:enablePerPartitionCategorization,onChange:toggleEnablePerPartitionCategorization,"data-test-subj":"mlJobWizardSwitchCategorizationPerPartition",label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.perPartitionCategorizationSwitchLabel",defaultMessage:"Enable per-partition categorization"})})},CategorizationPerPartitionStopOnWarnSwitch=()=>{const{jobCreator:jc,jobCreatorUpdate:jobCreatorUpdate,jobCreatorUpdated:jobCreatorUpdated}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext),jobCreator=jc,[stopOnWarn,setStopOnWarn]=Object(external_kbnSharedDeps_React_.useState)(jobCreator.perPartitionStopOnWarn),toggleStopOnWarn=Object(external_kbnSharedDeps_React_.useCallback)(()=>setStopOnWarn(!stopOnWarn),[stopOnWarn]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{jobCreator.perPartitionStopOnWarn=stopOnWarn,jobCreatorUpdate()},[stopOnWarn]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{setStopOnWarn(jobCreator.perPartitionStopOnWarn)},[jobCreatorUpdated]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSwitch,{name:"categorizationPerPartitionStopOnWarnSwitch",disabled:!1,checked:stopOnWarn,onChange:toggleStopOnWarn,"data-test-subj":"mlJobWizardSwitchCategorizationPerPartitionStopOnWarn",label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.perPartitionCategorizationtopOnWarnSwitchLabel",defaultMessage:"Stop on warn"})})},CategorizationPerPartitionFieldSelect=({fields:fields,changeHandler:changeHandler,selectedField:selectedField})=>{const{jobCreator:jobCreator,jobCreatorUpdated:jobCreatorUpdated}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext),options=Object(external_kbnSharedDeps_React_.useMemo)(()=>[...Object(general.g)(fields,jobCreator.additionalFields)],[fields,jobCreatorUpdated]),selection=Object(external_kbnSharedDeps_React_.useMemo)(()=>{const selectedOptions=[];return null!==selectedField&&selectedOptions.push({label:selectedField}),selectedOptions},[selectedField]),onChange=Object(external_kbnSharedDeps_React_.useCallback)(selectedOptions=>{var _ref;return changeHandler(null!==(_ref=selectedOptions[0]&&selectedOptions[0].label)&&void 0!==_ref?_ref:null)},[changeHandler]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiComboBox,{singleSelection:{asPlainText:!0},options:options,selectedOptions:selection,onChange:onChange,isClearable:!0,"data-test-subj":"mlJobWizardCategorizationPerPartitionFieldNameSelect"})},CategorizationPerPartitionFieldDropdown=({setEnablePerPartitionCategorization:setEnablePerPartitionCategorization})=>{const{jobCreator:jc,jobCreatorUpdate:jobCreatorUpdate,jobCreatorUpdated:jobCreatorUpdated}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext),jobCreator=jc,[categorizationPartitionFieldName,setCategorizationPartitionFieldName]=Object(external_kbnSharedDeps_React_.useState)(jobCreator.categorizationPerPartitionField),{categoryFields:categoryFields}=new_job_capabilities_service.b,filteredCategories=Object(external_kbnSharedDeps_React_.useMemo)(()=>categoryFields.filter(c=>c.id!==jobCreator.categorizationFieldName),[categoryFields,jobCreatorUpdated]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{jobCreator.categorizationPerPartitionField=categorizationPartitionFieldName,jobCreatorUpdate()},[categorizationPartitionFieldName]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{jobCreator.perPartitionCategorization&&null===jobCreator.categorizationPerPartitionField&&filteredCategories.length>0&&(jobCreator.categorizationPerPartitionField=filteredCategories[0].id),setCategorizationPartitionFieldName(jobCreator.categorizationPerPartitionField),setEnablePerPartitionCategorization(jobCreator.perPartitionCategorization)},[jobCreatorUpdated]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.extraStep.categorizationJob.categorizationPerPartitionFieldLabel",defaultMessage:"Partition field"})},external_kbnSharedDeps_React_default.a.createElement(CategorizationPerPartitionFieldSelect,{fields:filteredCategories,changeHandler:setCategorizationPartitionFieldName,selectedField:categorizationPartitionFieldName||""}))},CategorizationPerPartitionField=()=>{const{jobCreator:jc,jobCreatorUpdated:jobCreatorUpdated}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext),jobCreator=jc,[enablePerPartitionCategorization,setEnablePerPartitionCategorization]=Object(external_kbnSharedDeps_React_.useState)(!1);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{setEnablePerPartitionCategorization(jobCreator.perPartitionCategorization)},[jobCreatorUpdated]),external_kbnSharedDeps_React_default.a.createElement(categorization_partition_field_description_Description,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.extraStep.categorizationJob.perPartitionCategorizationLabel",defaultMessage:"Enable per-partition categorization"})},external_kbnSharedDeps_React_default.a.createElement(CategorizationPerPartitionSwitch,null)),enablePerPartitionCategorization&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.extraStep.categorizationJob.stopOnWarnLabel",defaultMessage:"Stop on warn"})},external_kbnSharedDeps_React_default.a.createElement(CategorizationPerPartitionStopOnWarnSwitch,null))),Object(job_creator.b)(jobCreator)&&enablePerPartitionCategorization&&external_kbnSharedDeps_React_default.a.createElement(CategorizationPerPartitionFieldDropdown,{setEnablePerPartitionCategorization:setEnablePerPartitionCategorization}))},ExtraSettings=()=>{const{jobCreator:jobCreator}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext),showCategorizationPerPartitionField=Object(job_creator.a)(jobCreator)&&null!==jobCreator.categorizationFieldName;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"xl"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(CategorizationField,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(SummaryCountField,null))),showCategorizationPerPartitionField&&external_kbnSharedDeps_React_default.a.createElement(CategorizationPerPartitionField,null))},AdvancedView=({isActive:isActive,setCanProceed:setCanProceed})=>{const[metricsValid,setMetricValid]=Object(external_kbnSharedDeps_React_.useState)(!1),[settingsValid,setSettingsValid]=Object(external_kbnSharedDeps_React_.useState)(!1);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{"function"==typeof setCanProceed&&setCanProceed(metricsValid&&settingsValid)},[metricsValid,settingsValid]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,!1===isActive?external_kbnSharedDeps_React_default.a.createElement(AdvancedDetectorsSummary,null):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(ExtraSettings,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHorizontalRule,{margin:"l"}),external_kbnSharedDeps_React_default.a.createElement(AdvancedDetectors,{setIsValid:setMetricValid}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHorizontalRule,{margin:"l"}),external_kbnSharedDeps_React_default.a.createElement(AdvancedSettings,{setIsValid:setSettingsValid})))},CountCard=({onClick:onClick,isSelected:isSelected})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCard,{"data-test-subj":"mlJobWizardCategorizationDetectorCountCard"+(isSelected?" selected":""),title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.categorizationDetectorSelect.countCard.title",{defaultMessage:"Count"}),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.categorizationDetectorSelect.countCard.description",defaultMessage:"Look for anomalies in the event rate of a particular category."})),selectable:{onClick:onClick,isSelected:isSelected}})),RareCard=({onClick:onClick,isSelected:isSelected})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCard,{"data-test-subj":"mlJobWizardCategorizationDetectorRareCard"+(isSelected?" selected":""),title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.categorizationDetectorSelect.rareCard.title",{defaultMessage:"Rare"}),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.categorizationDetectorSelect.rareCard.description",defaultMessage:"Look for categories that occur rarely in time."})),selectable:{onClick:onClick,isSelected:isSelected}})),CategorizationDetector=()=>{const{jobCreator:jc,jobCreatorUpdate:jobCreatorUpdate,jobCreatorUpdated:jobCreatorUpdated}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext),jobCreator=jc,[categorizationDetectorType,setCategorizationDetectorType]=Object(external_kbnSharedDeps_React_.useState)(jobCreator.selectedDetectorType);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{categorizationDetectorType!==jobCreator.selectedDetectorType&&(jobCreator.setDetectorType(categorizationDetectorType),jobCreatorUpdate())},[categorizationDetectorType]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{setCategorizationDetectorType(jobCreator.selectedDetectorType)},[jobCreatorUpdated]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("h3",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.categorizationDetectorSelect.title",defaultMessage:"Categorization detector"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"l",style:{maxWidth:"824px"}},external_kbnSharedDeps_React_default.a.createElement(CountCard,{onClick:function(){setCategorizationDetectorType(aggregation_types.b.COUNT)},isSelected:categorizationDetectorType===aggregation_types.b.COUNT}),external_kbnSharedDeps_React_default.a.createElement(RareCard,{onClick:function(){setCategorizationDetectorType(aggregation_types.b.RARE)},isSelected:categorizationDetectorType===aggregation_types.b.RARE})))},FieldExamples=({fieldExamples:fieldExamples})=>{if(null===fieldExamples||0===fieldExamples.length)return null;const columns=[{field:"example",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.categorizationFieldExamples.title",{defaultMessage:"Examples"}),render:example=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"s"},external_kbnSharedDeps_React_default.a.createElement("code",null,example))}],items=fieldExamples.map((example,i)=>{const txt=[];let tokenCounter=0,buffer="",charCount=0;for(;charCount<example.text.length;){const token=example.tokens[tokenCounter];token&&charCount===token.start_offset?(txt.push(buffer),buffer="",txt.push(external_kbnSharedDeps_React_default.a.createElement(Token,{key:`${i}${charCount}`},token.token)),charCount+=token.end_offset-token.start_offset,tokenCounter++):(buffer+=example.text[charCount],charCount++)}return txt.push(buffer),{example:txt}});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBasicTable,{columns:columns,items:items,"data-test-subj":"mlJobWizardCategorizationExamplesTable"})},Token=({children:children})=>external_kbnSharedDeps_React_default.a.createElement("span",{style:{backgroundColor:"#b0ccf7"}},children);var ml_job_editor=__webpack_require__(129),validation_utils=__webpack_require__(133);const EditCategorizationAnalyzerFlyout=()=>{const{jobCreator:jc,jobCreatorUpdate:jobCreatorUpdate}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext),jobCreator=jc,[showJsonFlyout,setShowJsonFlyout]=Object(external_kbnSharedDeps_React_.useState)(!1),[saveable,setSaveable]=Object(external_kbnSharedDeps_React_.useState)(!1),[categorizationAnalyzerString,setCategorizationAnalyzerString]=Object(external_kbnSharedDeps_React_.useState)(JSON.stringify(jobCreator.categorizationAnalyzer,null,2));function onJSONChange(json){setCategorizationAnalyzerString(json);const valid=Object(validation_utils.c)(json);setSaveable(valid)}return Object(external_kbnSharedDeps_React_.useEffect)(()=>{!0===showJsonFlyout&&setCategorizationAnalyzerString(JSON.stringify(jobCreator.categorizationAnalyzer,null,2))},[showJsonFlyout]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(FlyoutButton,{onClick:function(){setSaveable(!1),setShowJsonFlyout(!showJsonFlyout)}}),!0===showJsonFlyout&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyout,{onClose:()=>setShowJsonFlyout(!1),hideCloseButton:!0,size:"m"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyoutBody,null,external_kbnSharedDeps_React_default.a.createElement(Contents,{onChange:onJSONChange,title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.categorizationAnalyzerFlyout.title",{defaultMessage:"Edit categorization analyzer JSON"}),value:categorizationAnalyzerString})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyoutFooter,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{iconType:"cross",onClick:()=>setShowJsonFlyout(!1),flush:"left"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.categorizationAnalyzerFlyout.closeButton",defaultMessage:"Close"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!0}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{onClick:function(){const{anomaly_detectors:anomalyDetectors}=Object(ml_server_info.b)();onJSONChange(JSON.stringify(anomalyDetectors.categorization_analyzer,null,2))}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.categorizationAnalyzerFlyout.useDefaultButton",defaultMessage:"Use default ML analyzer"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{onClick:function(){jobCreator.categorizationAnalyzer=JSON.parse(categorizationAnalyzerString),jobCreatorUpdate(),setShowJsonFlyout(!1)},fill:!0,isDisabled:!1===saveable},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.categorizationAnalyzerFlyout.saveButton",defaultMessage:"Save"})))))))},FlyoutButton=({onClick:onClick})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{onClick:onClick,flush:"left","data-test-subj":"mlJobWizardButtonPreviewJobJson"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.editCategorizationAnalyzerFlyoutButton",defaultMessage:"Edit categorization analyzer"})),Contents=({title:title,value:value,onChange:onChange})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"s"},external_kbnSharedDeps_React_default.a.createElement("h5",null,title)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(ml_job_editor.a,{value:value,height:"800px",readOnly:!1,onChange:onChange})),allChecksButtonContent=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.allChecksButton",{defaultMessage:"View all checks performed"}),ExamplesValidCallout=({overallValidStatus:overallValidStatus,validationChecks:validationChecks,categorizationAnalyzer:categorizationAnalyzer})=>{const analyzerUsed=external_kbnSharedDeps_React_default.a.createElement(AnalyzerUsed,{categorizationAnalyzer:categorizationAnalyzer});let color="success",title=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.categorizationFieldCalloutTitle.valid",{defaultMessage:"Selected category field is valid"});return overallValidStatus===categorization_job.a.INVALID?(color="danger",title=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.categorizationFieldCalloutTitle.invalid",{defaultMessage:"Selected category field is invalid"})):overallValidStatus===categorization_job.a.PARTIALLY_VALID&&(color="warning",title=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.categorizationFieldCalloutTitle.possiblyInvalid",{defaultMessage:"Selected category field is possibly invalid"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{color:color,title:title,"data-test-subj":"mlJobWizardCategorizationExamplesCallout "+overallValidStatus},validationChecks.map((v,i)=>external_kbnSharedDeps_React_default.a.createElement("div",{key:i},v.message)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),analyzerUsed,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiAccordion,{id:"all-checks",buttonContent:allChecksButtonContent},external_kbnSharedDeps_React_default.a.createElement(AllValidationChecks,{validationChecks:validationChecks})))},AnalyzerUsed=({categorizationAnalyzer:categorizationAnalyzer})=>{let analyzer="";return void 0!==(null==categorizationAnalyzer?void 0:categorizationAnalyzer.tokenizer)?analyzer=categorizationAnalyzer.tokenizer:void 0!==(null==categorizationAnalyzer?void 0:categorizationAnalyzer.analyzer)&&(analyzer=categorizationAnalyzer.analyzer),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.categorizationFieldAnalyzer",defaultMessage:"Analyzer used: {analyzer}",values:{analyzer:analyzer}})),external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(EditCategorizationAnalyzerFlyout,null)))},AllValidationChecks=({validationChecks:validationChecks})=>{const list=Object.keys(categorization_job.c).map((k,i)=>{const failedCheck=validationChecks.find(vc=>vc.id===i);return void 0!==failedCheck&&(null==failedCheck?void 0:failedCheck.valid)!==categorization_job.a.VALID?{iconType:"cross",label:failedCheck.message,size:"s"}:{iconType:"check",label:categorization_job.c[i],size:"s"}});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiListGroup,{listItems:list,maxWidth:!1})},InvalidCssVersionCallout=()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{color:"warning",title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.invalidCssVersionCallout.title",{defaultMessage:"The index pattern appears to be cross-cluster"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.invalidCssVersionCallout.mesage",defaultMessage:"No example categories could be found, this could be due to one of the clusters being an unsupported version."})),CategorizationDetectors=({setIsValid:setIsValid})=>{const{jobCreator:jc,jobCreatorUpdate:jobCreatorUpdate,jobCreatorUpdated:jobCreatorUpdated}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext),jobCreator=jc,[loadingData,setLoadingData]=Object(external_kbnSharedDeps_React_.useState)(!1),[ccsVersionFailure,setCcsVersionFailure]=Object(external_kbnSharedDeps_React_.useState)(!1),[start,setStart]=Object(external_kbnSharedDeps_React_.useState)(jobCreator.start),[end,setEnd]=Object(external_kbnSharedDeps_React_.useState)(jobCreator.end),[categorizationAnalyzerString,setCategorizationAnalyzerString]=Object(external_kbnSharedDeps_React_.useState)(JSON.stringify(jobCreator.categorizationAnalyzer)),[fieldExamples,setFieldExamples]=Object(external_kbnSharedDeps_React_.useState)(null),[overallValidStatus,setOverallValidStatus]=Object(external_kbnSharedDeps_React_.useState)(categorization_job.a.INVALID),[validationChecks,setValidationChecks]=Object(external_kbnSharedDeps_React_.useState)([]),[categorizationFieldName,setCategorizationFieldName]=Object(external_kbnSharedDeps_React_.useState)(jobCreator.categorizationFieldName);async function loadFieldExamples(){if(null!==categorizationFieldName){setLoadingData(!0);try{const{examples:examples,overallValidStatus:tempOverallValidStatus,validationChecks:tempValidationChecks,ccsVersionFailure:tempCcsVersionFailure}=await jobCreator.loadCategorizationFieldExamples();setFieldExamples(examples),setOverallValidStatus(tempOverallValidStatus),setValidationChecks(tempValidationChecks),setCcsVersionFailure(tempCcsVersionFailure),setLoadingData(!1)}catch(error){setLoadingData(!1),setFieldExamples(null),setValidationChecks([]),setOverallValidStatus(categorization_job.a.INVALID),Object(toast_notification_service.a)().displayErrorToast(error),setCcsVersionFailure(!1)}}else setFieldExamples(null),setValidationChecks([]),setOverallValidStatus(categorization_job.a.INVALID),setCcsVersionFailure(!1);setIsValid(null!==categorizationFieldName)}return Object(external_kbnSharedDeps_React_.useEffect)(()=>{jobCreator.categorizationFieldName!==categorizationFieldName&&(jobCreator.categorizationFieldName=categorizationFieldName,jobCreatorUpdate()),loadFieldExamples()},[categorizationFieldName]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{let updateExamples=!1;jobCreator.start===start&&jobCreator.end===end||(setStart(jobCreator.start),setEnd(jobCreator.end),updateExamples=!0);const tempCategorizationAnalyzerString=JSON.stringify(jobCreator.categorizationAnalyzer);tempCategorizationAnalyzerString!==categorizationAnalyzerString&&(setCategorizationAnalyzerString(tempCategorizationAnalyzerString),updateExamples=!0),updateExamples&&loadFieldExamples(),jobCreator.categorizationFieldName!==categorizationFieldName&&setCategorizationFieldName(jobCreator.categorizationFieldName)},[jobCreatorUpdated]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{jobCreatorUpdate()},[overallValidStatus]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(CategorizationDetector,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHorizontalRule,null),external_kbnSharedDeps_React_default.a.createElement(CategorizationField,null),!0===loadingData&&external_kbnSharedDeps_React_default.a.createElement(loading_wrapper.a,{hasData:!1,loading:!0},external_kbnSharedDeps_React_default.a.createElement("div",null)),!1===ccsVersionFailure&&null!==fieldExamples&&!1===loadingData&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(ExamplesValidCallout,{overallValidStatus:overallValidStatus,validationChecks:validationChecks,categorizationAnalyzer:jobCreator.categorizationAnalyzer}),external_kbnSharedDeps_React_default.a.createElement(FieldExamples,{fieldExamples:fieldExamples})),!0===ccsVersionFailure&&external_kbnSharedDeps_React_default.a.createElement(InvalidCssVersionCallout,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHorizontalRule,null),external_kbnSharedDeps_React_default.a.createElement(CategorizationPerPartitionField,null))},TopCategories=()=>{const{jobCreator:jc,resultsLoader:resultsLoader}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext),jobCreator=jc,[tableRow,setTableRow]=Object(external_kbnSharedDeps_React_.useState)([]),[totalCategories,setTotalCategories]=Object(external_kbnSharedDeps_React_.useState)(0);function setResultsWrapper(results){!async function(){const results=await ml_api_service.ml.jobs.topCategories(jobCreator.jobId,categorization_job.b);setTableRow(results.categories.map(c=>{var _c$category$examples;return{count:c.count,example:null!==(_c$category$examples=c.category.examples)&&void 0!==_c$category$examples&&_c$category$examples.length?c.category.examples[0]:""}})),setTotalCategories(results.total)}()}Object(external_kbnSharedDeps_React_.useEffect)(()=>{const resultsSubscription=resultsLoader.subscribeToResults(setResultsWrapper);return()=>{resultsSubscription.unsubscribe()}},[]);const columns=[...jobCreator.modelPlot?[{field:"count",name:"count",width:"100px",render:count=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"s"},external_kbnSharedDeps_React_default.a.createElement("code",null,count))}]:[],{field:"example",name:"Example",render:example=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"s"},external_kbnSharedDeps_React_default.a.createElement("code",null,example))}];return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,totalCategories>0&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.categorizationTotalCategories",defaultMessage:"Total categories: {totalCategories}",values:{totalCategories:totalCategories}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBasicTable,{columns:columns,items:tableRow})))},CategoryStoppedPartitions=()=>{const{jobCreator:jc,resultsLoader:resultsLoader}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext),jobCreator=jc,[tableRow,setTableRow]=Object(external_kbnSharedDeps_React_.useState)([]),[stoppedPartitionsError,setStoppedPartitionsError]=Object(external_kbnSharedDeps_React_.useState)(),columns=Object(external_kbnSharedDeps_React_.useMemo)(()=>[{field:"partitionName",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.stoppedPartitionsPreviewColumnName",{defaultMessage:"Stopped partition names"}),render:partition=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"s"},external_kbnSharedDeps_React_default.a.createElement("code",null,partition))}],[]),loadCategoryStoppedPartitions=Object(external_kbnSharedDeps_React_.useCallback)(async()=>{try{const{jobs:jobs}=await ml_api_service.ml.results.getCategoryStoppedPartitions([jobCreator.jobId]);if(!Array.isArray(jobs)&&Array.isArray(jobs[jobCreator.jobId])&&jobs[jobCreator.jobId].length>0)return jobs[jobCreator.jobId]}catch(e){const error=Object(util_errors.j)(e);404!==error.statusCode&&setStoppedPartitionsError(error.message)}},[jobCreator.jobId]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{if(jobCreator.perPartitionCategorization&&jobCreator.perPartitionStopOnWarn){const resultsSubscription=resultsLoader.results$.pipe(Object(external_kbnSharedDeps_RxjsOperators_.switchMap)(()=>Object(external_kbnSharedDeps_Rxjs_.from)(loadCategoryStoppedPartitions())),Object(external_kbnSharedDeps_RxjsOperators_.tap)(results=>{Array.isArray(results)&&setTableRow(results.slice(0,5).map(partitionName=>({partitionName:partitionName})))}),Object(external_kbnSharedDeps_RxjsOperators_.takeWhile)(results=>!results||Array.isArray(results)&&results.length<=5)).subscribe();return()=>resultsSubscription.unsubscribe()}},[]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,stoppedPartitionsError&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{color:"danger",size:"s",title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.stoppedPartitionsErrorCallout",defaultMessage:"An error occurred while fetching list of stopped partitions."})})),Array.isArray(tableRow)&&tableRow.length>0&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.categorizationStoppedPartitionsTitle",defaultMessage:"Stopped partitions"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{color:"warning",size:"s",title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.stoppedPartitionsExistCallout",defaultMessage:"Per-partition categorization and stop_on_warn settings are enabled. Some partitions in job '{jobId}' are unsuitable for categorization and have been excluded from further categorization or anomaly detection analysis.",values:{jobId:jobCreator.jobId}})}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBasicTable,{columns:columns,items:tableRow})))},CategorizationDetectorsSummary=()=>{const{jobCreator:jc,chartLoader:chartLoader,resultsLoader:resultsLoader,chartInterval:chartInterval}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext),jobCreator=jc,[loadingData,setLoadingData]=Object(external_kbnSharedDeps_React_.useState)(!1),[anomalyData,setAnomalyData]=Object(external_kbnSharedDeps_React_.useState)([]),[eventRateChartData,setEventRateChartData]=Object(external_kbnSharedDeps_React_.useState)([]),[jobIsRunning,setJobIsRunning]=Object(external_kbnSharedDeps_React_.useState)(!1);function setResultsWrapper(results){const anomalies=results.anomalies[0];void 0!==anomalies&&setAnomalyData(anomalies)}function watchProgress(progress){setJobIsRunning(progress>0)}return Object(external_kbnSharedDeps_React_.useEffect)(()=>{const resultsSubscription=resultsLoader.subscribeToResults(setResultsWrapper);return jobCreator.subscribeToProgress(watchProgress),async function(){setLoadingData(!0);try{var _jobCreator$runtimeMa;const resp=await chartLoader.loadEventRateChart(jobCreator.start,jobCreator.end,chartInterval.getInterval().asMilliseconds(),null!==(_jobCreator$runtimeMa=jobCreator.runtimeMappings)&&void 0!==_jobCreator$runtimeMa?_jobCreator$runtimeMa:void 0,jobCreator.datafeedConfig.indices_options);setEventRateChartData(resp)}catch(error){setEventRateChartData([])}setLoadingData(!1)}(),()=>{resultsSubscription.unsubscribe()}},[]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(event_rate_chart.a,{eventRateChartData:eventRateChartData,anomalyData:anomalyData,height:"300px",width:"100%",showAxis:!0,loading:loadingData,fadeChart:jobIsRunning}),external_kbnSharedDeps_React_default.a.createElement(TopCategories,null),external_kbnSharedDeps_React_default.a.createElement(CategoryStoppedPartitions,null))},CategorizationSettings=({setIsValid:setIsValid})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"xl"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(BucketSpan,{setIsValid:setIsValid,hideEstimateButton:!0})))),CategorizationView=({isActive:isActive,setCanProceed:setCanProceed})=>{const[categoryFieldValid,setCategoryFieldValid]=Object(external_kbnSharedDeps_React_.useState)(!1),[settingsValid,setSettingsValid]=Object(external_kbnSharedDeps_React_.useState)(!1);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{"function"==typeof setCanProceed&&setCanProceed(categoryFieldValid&&settingsValid)},[categoryFieldValid,settingsValid]),!1===isActive?external_kbnSharedDeps_React_default.a.createElement(CategorizationDetectorsSummary,null):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(CategorizationDetectors,{setIsValid:setCategoryFieldValid}),categoryFieldValid&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHorizontalRule,{margin:"l"}),external_kbnSharedDeps_React_default.a.createElement(CategorizationSettings,{setIsValid:setSettingsValid})))};var shared_imports=__webpack_require__(167),es_client=__webpack_require__(11);const DatafeedPreview=({combinedJob:combinedJob,heightOffset:heightOffset=0})=>{const editorHeight=Object(external_kbnSharedDeps_React_.useMemo)(()=>window.innerHeight-230-heightOffset+"px",[heightOffset]),[loading,setLoading]=Object(external_kbnSharedDeps_React_.useState)(!1),[previewJsonString,setPreviewJsonString]=Object(external_kbnSharedDeps_React_.useState)(""),[outOfDate,setOutOfDate]=Object(external_kbnSharedDeps_React_.useState)(!1),[combinedJobString,setCombinedJobString]=Object(external_kbnSharedDeps_React_.useState)("");Object(external_kbnSharedDeps_React_.useEffect)(()=>{try{null!==combinedJob&&(""===combinedJobString?loadDataPreview():setOutOfDate(JSON.stringify(combinedJob)!==combinedJobString))}catch(error){}},[combinedJob]);const loadDataPreview=Object(external_kbnSharedDeps_React_.useCallback)(async()=>{if(setPreviewJsonString(""),null!==combinedJob)if(setLoading(!0),setCombinedJobString(JSON.stringify(combinedJob)),combinedJob.datafeed_config&&combinedJob.datafeed_config.indices.length){try{const resp=await job_service.a.searchPreview(combinedJob);let data=resp.hits.hits;if(Object(object_utils.b)(resp.aggregations)){const accessor=Object.keys(resp.aggregations)[0],aggregate=resp.aggregations[accessor];Object(es_client.b)(aggregate)&&(data=aggregate.buckets.slice(0,job_utils.a))}setPreviewJsonString(JSON.stringify(data,null,2))}catch(error){setPreviewJsonString(JSON.stringify(error,null,2))}setLoading(!1),setOutOfDate(!1)}else{const errorText=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.datafeedPreviewFlyout.datafeedDoesNotExistLabel",{defaultMessage:"Datafeed does not exist"});setPreviewJsonString(errorText)}},[combinedJob]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"s"},external_kbnSharedDeps_React_default.a.createElement("h5",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.datafeedPreviewFlyout.title",defaultMessage:"Datafeed preview"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},outOfDate&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{size:"s",onClick:loadDataPreview,iconType:"refresh"},"Refresh"))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),!0===loading?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceAround"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"xxl"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingSpinner,{size:"l"}))):external_kbnSharedDeps_React_default.a.createElement(ml_job_editor.a,{value:previewJsonString,height:editorHeight,readOnly:!0}))};let EDITOR_MODE;!function(EDITOR_MODE){EDITOR_MODE[EDITOR_MODE.HIDDEN=0]="HIDDEN",EDITOR_MODE[EDITOR_MODE.READONLY=1]="READONLY",EDITOR_MODE[EDITOR_MODE.EDITABLE=2]="EDITABLE"}(EDITOR_MODE||(EDITOR_MODE={}));let json_editor_flyout_EDITOR_MODE;!function(EDITOR_MODE){EDITOR_MODE[EDITOR_MODE.HIDDEN=0]="HIDDEN",EDITOR_MODE[EDITOR_MODE.READONLY=1]="READONLY",EDITOR_MODE[EDITOR_MODE.EDITABLE=2]="EDITABLE"}(json_editor_flyout_EDITOR_MODE||(json_editor_flyout_EDITOR_MODE={}));const JsonEditorFlyout=({isDisabled:isDisabled,jobEditorMode:jobEditorMode,datafeedEditorMode:datafeedEditorMode})=>{const{jobCreator:jobCreator,jobCreatorUpdate:jobCreatorUpdate,jobCreatorUpdated:jobCreatorUpdated}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext),{displayErrorToast:displayErrorToast}=Object(toast_notification_service.c)(),[showJsonFlyout,setShowJsonFlyout]=Object(external_kbnSharedDeps_React_.useState)(!1),[showChangedIndicesWarning,setShowChangedIndicesWarning]=Object(external_kbnSharedDeps_React_.useState)(!1),[jobConfigString,setJobConfigString]=Object(external_kbnSharedDeps_React_.useState)(jobCreator.formattedJobJson),[datafeedConfigString,setDatafeedConfigString]=Object(external_kbnSharedDeps_React_.useState)(jobCreator.formattedDatafeedJson),[saveable,setSaveable]=Object(external_kbnSharedDeps_React_.useState)(!1),[tempCombinedJob,setTempCombinedJob]=Object(external_kbnSharedDeps_React_.useState)(null);Object(external_kbnSharedDeps_React_.useEffect)(()=>{setJobConfigString(jobCreator.formattedJobJson),setDatafeedConfigString(jobCreator.formattedDatafeedJson)},[jobCreatorUpdated]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{!0===showJsonFlyout?(setJobConfigString(jobCreator.formattedJobJson),setDatafeedConfigString(jobCreator.formattedDatafeedJson),setTempCombinedJob({...JSON.parse(jobCreator.formattedJobJson),datafeed_config:JSON.parse(jobCreator.formattedDatafeedJson)}),setShowChangedIndicesWarning(!1)):setTempCombinedJob(null)},[showJsonFlyout]);const editJsonMode=jobEditorMode===json_editor_flyout_EDITOR_MODE.EDITABLE||datafeedEditorMode===json_editor_flyout_EDITOR_MODE.EDITABLE,readOnlyMode=jobEditorMode===json_editor_flyout_EDITOR_MODE.READONLY&&datafeedEditorMode===json_editor_flyout_EDITOR_MODE.READONLY;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(json_editor_flyout_FlyoutButton,{onClick:function(){setSaveable(!1),setShowJsonFlyout(!showJsonFlyout)},isDisabled:isDisabled,editJsonMode:editJsonMode}),!0===showJsonFlyout&&!1===isDisabled&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyout,{onClose:()=>setShowJsonFlyout(!1),hideCloseButton:!0,size:"l"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyoutBody,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,jobEditorMode!==json_editor_flyout_EDITOR_MODE.HIDDEN&&external_kbnSharedDeps_React_default.a.createElement(json_editor_flyout_Contents,{editJson:jobEditorMode===json_editor_flyout_EDITOR_MODE.EDITABLE,onChange:function(json){setJobConfigString(json);const valid=Object(validation_utils.c)(json);setTempCombinedJob(valid?{...JSON.parse(json),datafeed_config:JSON.parse(datafeedConfigString)}:null),setSaveable(valid)},title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.jsonFlyout.job.title",{defaultMessage:"Job configuration JSON"}),value:jobConfigString,heightOffset:showChangedIndicesWarning?100:0}),datafeedEditorMode!==json_editor_flyout_EDITOR_MODE.HIDDEN&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(json_editor_flyout_Contents,{editJson:datafeedEditorMode===json_editor_flyout_EDITOR_MODE.EDITABLE,onChange:function(json){setDatafeedConfigString(json);const jsonValue=Object(shared_imports.b)(json);let valid=Object(validation_utils.c)(jsonValue);if(valid){const datafeed=JSON.parse(jsonValue),originalIndices=jobCreator.indices.sort();valid=originalIndices.length===datafeed.indices.length&&originalIndices.every((value,index)=>value===datafeed.indices[index]),setShowChangedIndicesWarning(!1===valid),setTempCombinedJob({...JSON.parse(jobConfigString),datafeed_config:datafeed})}else setShowChangedIndicesWarning(!1),setTempCombinedJob(null);setSaveable(valid)},title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.jsonFlyout.datafeed.title",{defaultMessage:"Datafeed configuration JSON"}),value:datafeedConfigString,heightOffset:showChangedIndicesWarning?100:0}),datafeedEditorMode===json_editor_flyout_EDITOR_MODE.EDITABLE&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(DatafeedPreview,{combinedJob:tempCombinedJob,heightOffset:showChangedIndicesWarning?100:0})))),showChangedIndicesWarning&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{color:"warning",size:"s",title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.jsonFlyout.indicesChange.calloutTitle",{defaultMessage:"Indices have changed"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.jsonFlyout.indicesChange.calloutText",defaultMessage:"It is not possible to alter the indices being used by the datafeed here. If you wish to select a different index pattern or saved search, please start the job creation again, selecting a different index pattern."})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyoutFooter,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{iconType:"cross",onClick:()=>setShowJsonFlyout(!1),flush:"left"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.jsonFlyout.closeButton",defaultMessage:"Close"}))),!1===readOnlyMode&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{onClick:async function(){const jobConfig=JSON.parse(jobConfigString),datafeedConfig=JSON.parse(Object(shared_imports.b)(datafeedConfigString));if(jobCreator.cloneFromExistingJob(jobConfig,datafeedConfig),Object(job_creator.a)(jobCreator))try{await jobCreator.autoSetTimeRange()}catch(error){const title=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.jsonFlyout.autoSetJobCreatorTimeRange.error",{defaultMessage:"Error retrieving beginning and end times of index"});displayErrorToast(error,title)}jobCreatorUpdate(),setShowJsonFlyout(!1)},fill:!0,isDisabled:!1===saveable},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.jsonFlyout.saveButton",defaultMessage:"Save"})))))))},json_editor_flyout_FlyoutButton=({isDisabled:isDisabled,onClick:onClick,editJsonMode:editJsonMode})=>{const previewJsonTitle=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.previewJsonButton",{defaultMessage:"Preview JSON"}),editJsonTitle=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.editJsonButton",{defaultMessage:"Edit JSON"});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{onClick:onClick,isDisabled:isDisabled,"data-test-subj":"mlJobWizardButtonPreviewJobJson"},editJsonMode?editJsonTitle:previewJsonTitle)},json_editor_flyout_Contents=({title:title,value:value,editJson:editJson,onChange:onChange,heightOffset:heightOffset=0})=>{const editorHeight=Object(external_kbnSharedDeps_React_.useMemo)(()=>window.innerHeight-230-heightOffset+"px",[heightOffset]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"s"},external_kbnSharedDeps_React_default.a.createElement("h5",null,title)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(ml_job_editor.a,{value:value,height:editorHeight,mode:ml_job_editor.b.XJSON,readOnly:!1===editJson,onChange:onChange}))},PickFieldsStep=({setCurrentStep:setCurrentStep,isCurrentStep:isCurrentStep})=>{const{jobCreator:jobCreator,jobValidator:jobValidator,jobValidatorUpdated:jobValidatorUpdated}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext),[nextActive,setNextActive]=Object(external_kbnSharedDeps_React_.useState)(!1);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{setNextActive(jobValidator.isPickFieldsStepValid)},[jobValidatorUpdated]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,isCurrentStep&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,Object(job_creator.e)(jobCreator)&&external_kbnSharedDeps_React_default.a.createElement(SingleMetricView,{isActive:isCurrentStep,setCanProceed:setNextActive}),Object(job_creator.c)(jobCreator)&&external_kbnSharedDeps_React_default.a.createElement(MultiMetricView,{isActive:isCurrentStep,setCanProceed:setNextActive}),Object(job_creator.d)(jobCreator)&&external_kbnSharedDeps_React_default.a.createElement(PopulationView,{isActive:isCurrentStep,setCanProceed:setNextActive}),Object(job_creator.a)(jobCreator)&&external_kbnSharedDeps_React_default.a.createElement(AdvancedView,{isActive:isCurrentStep,setCanProceed:setNextActive}),Object(job_creator.b)(jobCreator)&&external_kbnSharedDeps_React_default.a.createElement(CategorizationView,{isActive:isCurrentStep,setCanProceed:setNextActive}),external_kbnSharedDeps_React_default.a.createElement(WizardNav,{previous:()=>setCurrentStep(Object(job_creator.a)(jobCreator)?WIZARD_STEPS.ADVANCED_CONFIGURE_DATAFEED:WIZARD_STEPS.TIME_RANGE),next:()=>setCurrentStep(WIZARD_STEPS.JOB_DETAILS),nextActive:nextActive},Object(job_creator.a)(jobCreator)&&external_kbnSharedDeps_React_default.a.createElement(JsonEditorFlyout,{isDisabled:!1,jobEditorMode:json_editor_flyout_EDITOR_MODE.EDITABLE,datafeedEditorMode:json_editor_flyout_EDITOR_MODE.EDITABLE}))))},job_id_description_Description=Object(external_kbnSharedDeps_React_.memo)(({children:children,validation:validation})=>{const title=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.jobId.title",{defaultMessage:"Job ID"}),description=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.jobId.description",{defaultMessage:'A unique identifier for the job. Spaces and the characters  / ? , " < > | * are not allowed'});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescribedFormGroup,{title:external_kbnSharedDeps_React_default.a.createElement("h3",null,title),description:description},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:title,error:validation.message,isInvalid:!1===validation.valid},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,children)))}),JobIdInput=()=>{const{jobCreator:jobCreator,jobCreatorUpdate:jobCreatorUpdate,jobValidator:jobValidator,jobValidatorUpdated:jobValidatorUpdated}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext),[jobId,setJobId]=Object(external_kbnSharedDeps_React_.useState)(jobCreator.jobId),validation=Object(external_kbnSharedDeps_React_.useMemo)(()=>{var _jobValidator$latestV,_jobValidator$jobId$m,_jobValidator$latestV2;return{valid:!0===(""===jobId)||!0===jobValidator.jobId.valid&&!0===(null===(_jobValidator$latestV=jobValidator.latestValidationResult.jobIdExists)||void 0===_jobValidator$latestV?void 0:_jobValidator$latestV.valid),message:null!==(_jobValidator$jobId$m=jobValidator.jobId.message)&&void 0!==_jobValidator$jobId$m?_jobValidator$jobId$m:null===(_jobValidator$latestV2=jobValidator.latestValidationResult.jobIdExists)||void 0===_jobValidator$latestV2?void 0:_jobValidator$latestV2.message}},[jobValidatorUpdated]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{jobCreator.jobId=jobId,jobCreatorUpdate()},[jobId]),external_kbnSharedDeps_React_default.a.createElement(job_id_description_Description,{validation:validation},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldText,{value:jobId,onChange:e=>setJobId(e.target.value),isInvalid:!1===validation.valid,"data-test-subj":"mlJobWizardInputJobId"}))},job_description_description_Description=Object(external_kbnSharedDeps_React_.memo)(({children:children})=>{const title=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.jobDescription.title",{defaultMessage:"Job description"});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescribedFormGroup,{title:external_kbnSharedDeps_React_default.a.createElement("h3",null,title),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobDetailsStep.jobDescription.description",defaultMessage:"Optional descriptive text"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:title},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,children)))}),JobDescriptionInput=()=>{const{jobCreator:jobCreator,jobCreatorUpdate:jobCreatorUpdate}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext),[jobDescription,setJobDescription]=Object(external_kbnSharedDeps_React_.useState)(jobCreator.description);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{jobCreator.description=jobDescription,jobCreatorUpdate()},[jobDescription]),external_kbnSharedDeps_React_default.a.createElement(job_description_description_Description,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTextArea,{value:jobDescription,onChange:e=>setJobDescription(e.target.value),"data-test-subj":"mlJobWizardInputJobDescription"}))},GroupsInput=()=>{const{jobCreator:jobCreator,jobCreatorUpdate:jobCreatorUpdate,jobValidator:jobValidator,jobValidatorUpdated:jobValidatorUpdated}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext),{existingJobsAndGroups:existingJobsAndGroups}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext),[selectedGroups,setSelectedGroups]=Object(external_kbnSharedDeps_React_.useState)(jobCreator.groups),validation=Object(external_kbnSharedDeps_React_.useMemo)(()=>{var _jobValidator$latestV,_jobValidator$groupId,_jobValidator$latestV2;return{valid:!0===jobValidator.groupIds.valid&&!0===(null===(_jobValidator$latestV=jobValidator.latestValidationResult.groupIdsExist)||void 0===_jobValidator$latestV?void 0:_jobValidator$latestV.valid),message:null!==(_jobValidator$groupId=jobValidator.groupIds.message)&&void 0!==_jobValidator$groupId?_jobValidator$groupId:null===(_jobValidator$latestV2=jobValidator.latestValidationResult.groupIdsExist)||void 0===_jobValidator$latestV2?void 0:_jobValidator$latestV2.message}},[jobValidatorUpdated]);Object(external_kbnSharedDeps_React_.useEffect)(()=>{jobCreator.groups=selectedGroups,jobCreatorUpdate()},[selectedGroups.join()]);const options=existingJobsAndGroups.groupIds.map(g=>({label:g,color:Object(group_color_utils.a)(g)})),selectedOptions=selectedGroups.map(g=>({label:g,color:Object(group_color_utils.a)(g)}));return external_kbnSharedDeps_React_default.a.createElement(Description,{validation:validation},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiComboBox,{placeholder:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.jobGroupSelect.placeholder",{defaultMessage:"Select or create groups"}),options:options,selectedOptions:selectedOptions,onChange:function(optionsIn){setSelectedGroups(optionsIn.map(g=>g.label))},onCreateOption:function(input,flattenedOptions){const normalizedSearchValue=input.trim().toLowerCase();if(!normalizedSearchValue)return;const newGroup={label:input,color:Object(group_color_utils.a)(input)};-1===flattenedOptions.findIndex(option=>option.label.trim().toLowerCase()===normalizedSearchValue)&&options.push(newGroup),setSelectedGroups([...selectedOptions,newGroup].map(g=>g.label))},isClearable:!0,isInvalid:!1===validation.valid,"data-test-subj":"mlJobWizardComboBoxJobGroups"}))},model_plot_description_Description=Object(external_kbnSharedDeps_React_.memo)(({children:children})=>{const title=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.advancedSection.enableModelPlot.title",{defaultMessage:"Enable model plot"});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescribedFormGroup,{title:external_kbnSharedDeps_React_default.a.createElement("h3",null,title),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobDetailsStep.advancedSection.enableModelPlot.description",defaultMessage:"Select to store additional model information used for plotting model bounds. This will add overhead to the performance of the system and is not recommended for high cardinality data."})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:title},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,children)))}),MMLCallout=()=>{const{jobCreator:jobCreator,jobValidator:jobValidator,jobValidatorUpdated:jobValidatorUpdated}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext),[highCardinality,setHighCardinality]=Object(external_kbnSharedDeps_React_.useState)(null);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{var _jobValidator$latestV,_jobValidator$latestV2,_jobValidator$latestV3;const value=null!==(_jobValidator$latestV=null===(_jobValidator$latestV2=jobValidator.latestValidationResult)||void 0===_jobValidator$latestV2||null===(_jobValidator$latestV3=_jobValidator$latestV2.highCardinality)||void 0===_jobValidator$latestV3?void 0:_jobValidator$latestV3.value)&&void 0!==_jobValidator$latestV?_jobValidator$latestV:null;setHighCardinality(value)},[jobValidatorUpdated]),jobCreator.modelPlot&&null!==highCardinality?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobDetailsStep.advancedSection.mmlWarning.title",defaultMessage:"Proceed with caution!"}),color:"warning",iconType:"help"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobDetailsStep.advancedSection.mmlWarning.message",defaultMessage:"Creating model plots is resource intensive and not recommended where the cardinality of the selected fields is greater than 100. Estimated cardinality for this job is {highCardinality}. If you enable model plot with this configuration we recommend you use a dedicated results index.",values:{highCardinality:highCardinality}}))):null},ModelPlotSwitch=()=>{const{jobCreator:jobCreator,jobCreatorUpdate:jobCreatorUpdate,jobCreatorUpdated:jobCreatorUpdated}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext),[modelPlotEnabled,setModelPlotEnabled]=Object(external_kbnSharedDeps_React_.useState)(jobCreator.modelPlot),[enabled,setEnabled]=Object(external_kbnSharedDeps_React_.useState)(!1);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{jobCreator.modelPlot=modelPlotEnabled,jobCreatorUpdate()},[modelPlotEnabled]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{const aggs=[aggregation_types.b.RARE],isRareCategoryJob=Object(job_creator.b)(jobCreator)&&jobCreator.aggregations.some(agg=>aggs.includes(agg.id));setEnabled(!1===isRareCategoryJob)},[jobCreatorUpdated]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(model_plot_description_Description,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSwitch,{name:"switch",disabled:!1===enabled,checked:modelPlotEnabled,onChange:function(){setModelPlotEnabled(!modelPlotEnabled)},"data-test-subj":"mlJobWizardSwitchModelPlot",label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.advancedSection.enableModelPlot.title",{defaultMessage:"Enable model plot"})})),external_kbnSharedDeps_React_default.a.createElement(MMLCallout,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null))},annotations_description_Description=Object(external_kbnSharedDeps_React_.memo)(({children:children})=>{const title=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.advancedSection.enableModelPlotAnnotations.title",{defaultMessage:"Enable model change annotations"});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescribedFormGroup,{title:external_kbnSharedDeps_React_default.a.createElement("h3",null,title),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobDetailsStep.advancedSection.enableModelPlotAnnotations.description",defaultMessage:"Select to generate annotations when the model changes significantly. For example, when step changes, periodicity or trends are detected."})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:title},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,children)))}),AnnotationsSwitch=()=>{const{jobCreator:jobCreator,jobCreatorUpdate:jobCreatorUpdate,jobCreatorUpdated:jobCreatorUpdated}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext),[annotationsEnabled,setAnnotationsEnabled]=Object(external_kbnSharedDeps_React_.useState)(jobCreator.modelChangeAnnotations),[showCallOut,setShowCallout]=Object(external_kbnSharedDeps_React_.useState)(jobCreator.modelPlot&&!jobCreator.modelChangeAnnotations);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{jobCreator.modelChangeAnnotations=annotationsEnabled,jobCreatorUpdate()},[annotationsEnabled]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{setShowCallout(jobCreator.modelPlot&&!annotationsEnabled)},[jobCreatorUpdated,annotationsEnabled]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(annotations_description_Description,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSwitch,{name:"switch",checked:annotationsEnabled,onChange:function(){setAnnotationsEnabled(!annotationsEnabled)},"data-test-subj":"mlJobWizardSwitchAnnotations",label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.advancedSection.enableModelPlotAnnotations.title",{defaultMessage:"Enable model change annotations"})})),showCallOut&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobDetailsStep.advancedSection.annotationsSwitchCallout.title",defaultMessage:"If you enable model plot with this configuration, we recommend you also enable annotations."}),color:"primary",iconType:"help"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null))},dedicated_index_description_Description=Object(external_kbnSharedDeps_React_.memo)(({children:children})=>{const title=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.advancedSection.useDedicatedIndex.title",{defaultMessage:"Use dedicated index"});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescribedFormGroup,{title:external_kbnSharedDeps_React_default.a.createElement("h3",null,title),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobDetailsStep.advancedSection.useDedicatedIndex.description",defaultMessage:"Store results in a separate index for this job."})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:title},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,children)))}),DedicatedIndexSwitch=()=>{const{jobCreator:jobCreator,jobCreatorUpdate:jobCreatorUpdate}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext),[useDedicatedIndex,setUseDedicatedIndex]=Object(external_kbnSharedDeps_React_.useState)(jobCreator.useDedicatedIndex);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{jobCreator.useDedicatedIndex=useDedicatedIndex,jobCreatorUpdate()},[useDedicatedIndex]),external_kbnSharedDeps_React_default.a.createElement(dedicated_index_description_Description,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSwitch,{name:"switch",checked:useDedicatedIndex,onChange:function(){setUseDedicatedIndex(!useDedicatedIndex)},"data-test-subj":"mlJobWizardSwitchUseDedicatedIndex",label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.advancedSection.useDedicatedIndex.title",{defaultMessage:"Use dedicated index"})}))},buttonContent=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.advancedSectionButton",{defaultMessage:"Advanced"}),AdvancedSection=({advancedExpanded:advancedExpanded,setAdvancedExpanded:setAdvancedExpanded})=>{const{jobCreator:jobCreator}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext);return jobCreator.type===new_job.f.ADVANCED?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHorizontalRule,{margin:"xl"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"xl"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(ModelPlotSwitch,null),external_kbnSharedDeps_React_default.a.createElement(AnnotationsSwitch,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(DedicatedIndexSwitch,null)))):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"xl"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiAccordion,{id:"advanced-section",buttonContent:buttonContent,onToggle:setAdvancedExpanded,initialIsOpen:advancedExpanded,"data-test-subj":"mlJobWizardToggleAdvancedSection"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"xl",style:{marginLeft:"0px",marginRight:"0px"},"data-test-subj":"mlJobWizardAdvancedSection"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(ModelPlotSwitch,null),external_kbnSharedDeps_React_default.a.createElement(AnnotationsSwitch,null),external_kbnSharedDeps_React_default.a.createElement(ModelMemoryLimitInput,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(DedicatedIndexSwitch,null)))))},calendars_description_Description=Object(external_kbnSharedDeps_React_.memo)(({children:children})=>{const{services:{docLinks:docLinks}}=Object(contexts_kibana.b)(),docsUrl=docLinks.links.ml.calendars,title=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.additionalSection.calendarsSelection.title",{defaultMessage:"Calendars"});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescribedFormGroup,{title:external_kbnSharedDeps_React_default.a.createElement("h3",null,title),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobDetailsStep.additionalSection.calendarsSelection.description",defaultMessage:"Contains a list of scheduled events that you want to ignore, such as planned system outages or public holidays. {learnMoreLink}",values:{learnMoreLink:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{href:docsUrl,target:"_blank"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobDetailsStep.additionalSection.calendarsSelection.learnMoreLinkText",defaultMessage:"Learn more"}))}})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,children)))});var app=__webpack_require__(5);function calendars_selection_extends(){return(calendars_selection_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const CalendarsSelection=()=>{const{services:{application:{getUrlForApp:getUrlForApp}}}=Object(contexts_kibana.b)(),{jobCreator:jobCreator,jobCreatorUpdate:jobCreatorUpdate}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext),[selectedCalendars,setSelectedCalendars]=Object(external_kbnSharedDeps_React_.useState)(jobCreator.calendars),[selectedOptions,setSelectedOptions]=Object(external_kbnSharedDeps_React_.useState)([]),[options,setOptions]=Object(external_kbnSharedDeps_React_.useState)([]),[isLoading,setIsLoading]=Object(external_kbnSharedDeps_React_.useState)(!1);async function loadCalendars(){setIsLoading(!0);const calendars=(await ml_api_service.ml.calendars()).filter(c=>!1===c.job_ids.includes("_all"));setOptions(calendars.map(c=>({label:c.calendar_id,value:c}))),setSelectedOptions(selectedCalendars.map(c=>({label:c.calendar_id,value:c}))),setIsLoading(!1)}Object(external_kbnSharedDeps_React_.useEffect)(()=>{loadCalendars()},[]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{jobCreator.calendars=selectedCalendars,jobCreatorUpdate()},[selectedCalendars.join()]);const comboBoxProps={async:!0,options:options,selectedOptions:selectedOptions,isLoading:isLoading,onChange:optionsIn=>{setSelectedOptions(optionsIn),setSelectedCalendars(optionsIn.map(o=>o.value))}},manageCalendarsHref=getUrlForApp(app.e,{path:ml_url_generator.b.CALENDARS_MANAGE});return external_kbnSharedDeps_React_default.a.createElement(calendars_description_Description,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"xs",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiComboBox,calendars_selection_extends({},comboBoxProps,{"data-test-subj":"mlJobWizardComboBoxCalendars"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{position:"right",content:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobDetailsStep.additionalSection.calendarsSelection.refreshCalendarsButtonLabel",defaultMessage:"Refresh calendars"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{iconType:"refresh",color:"primary","aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.additionalSection.calendarsSelection.refreshCalendarsButtonLabel",{defaultMessage:"Refresh calendars"}),onClick:loadCalendars})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{href:manageCalendarsHref,target:"_blank",external:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobDetailsStep.additionalSection.calendarsSelection.manageCalendarsButtonLabel",defaultMessage:"Manage calendars"}))))};var custom_urls=__webpack_require__(286);const custom_urls_description_Description=Object(external_kbnSharedDeps_React_.memo)(({children:children})=>{const{services:{docLinks:docLinks}}=Object(contexts_kibana.b)(),docsUrl=docLinks.links.ml.customUrls,title=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.additionalSection.customUrls.title",{defaultMessage:"Custom URLs"});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescribedFormGroup,{fullWidth:!0,className:"ml-custom-urls-selection",title:external_kbnSharedDeps_React_default.a.createElement("h3",null,title),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobDetailsStep.additionalSection.customUrlsSelection.description",defaultMessage:"Provide links from anomalies to Kibana dashboards, the Discovery page, or other web pages. {learnMoreLink}",values:{learnMoreLink:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{href:docsUrl,target:"_blank"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobDetailsStep.additionalSection.customUrlsSelection.learnMoreLinkText",defaultMessage:"Learn more"}))}})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{fullWidth:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,children)))}),CustomUrlsSelection=()=>{var _jobCreator$customUrl;const{jobCreator:jobCreator,jobCreatorUpdate:jobCreatorUpdate}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext),combinedJob={...jobCreator.jobConfig,datafeed_config:jobCreator.datafeedConfig};return external_kbnSharedDeps_React_default.a.createElement(custom_urls_description_Description,null,external_kbnSharedDeps_React_default.a.createElement(custom_urls.a,{job:combinedJob,jobCustomUrls:null!==(_jobCreator$customUrl=jobCreator.customUrls)&&void 0!==_jobCreator$customUrl?_jobCreator$customUrl:[],setCustomUrls:customUrls=>{jobCreator.customUrls=customUrls,jobCreatorUpdate()},editMode:"modal"}))},additional_section_buttonContent=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.additionalSectionButton",{defaultMessage:"Additional settings"}),AdditionalSection=({additionalExpanded:additionalExpanded,setAdditionalExpanded:setAdditionalExpanded})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiAccordion,{id:"additional-section",buttonContent:additional_section_buttonContent,onToggle:setAdditionalExpanded,initialIsOpen:additionalExpanded,"data-test-subj":"mlJobWizardToggleAdditionalSettingsSection"},external_kbnSharedDeps_React_default.a.createElement("section",{"data-test-subj":"mlJobWizardAdditionalSettingsSection"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"xl",style:{marginLeft:"0px",marginRight:"0px"}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(CustomUrlsSelection,null))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"xl",style:{marginLeft:"0px",marginRight:"0px"}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(CalendarsSelection,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null))))),JobDetailsStep=({setCurrentStep:setCurrentStep,isCurrentStep:isCurrentStep,advancedExpanded:advancedExpanded,setAdvancedExpanded:setAdvancedExpanded,additionalExpanded:additionalExpanded,setAdditionalExpanded:setAdditionalExpanded})=>{const{jobCreator:jobCreator,jobValidator:jobValidator,jobValidatorUpdated:jobValidatorUpdated}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext),[nextActive,setNextActive]=Object(external_kbnSharedDeps_React_.useState)(!1);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{var _jobValidator$latestV,_jobValidator$latestV2;const active=jobValidator.jobId.valid&&jobValidator.modelMemoryLimit.valid&&jobValidator.groupIds.valid&&!0===(null===(_jobValidator$latestV=jobValidator.latestValidationResult.jobIdExists)||void 0===_jobValidator$latestV?void 0:_jobValidator$latestV.valid)&&!0===(null===(_jobValidator$latestV2=jobValidator.latestValidationResult.groupIdsExist)||void 0===_jobValidator$latestV2?void 0:_jobValidator$latestV2.valid)&&!1===jobValidator.validating;setNextActive(active)},[jobValidatorUpdated]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,isCurrentStep&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"xl"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(JobIdInput,null),external_kbnSharedDeps_React_default.a.createElement(GroupsInput,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(JobDescriptionInput,null))),external_kbnSharedDeps_React_default.a.createElement(AdditionalSection,{additionalExpanded:additionalExpanded,setAdditionalExpanded:setAdditionalExpanded}),external_kbnSharedDeps_React_default.a.createElement(AdvancedSection,{advancedExpanded:advancedExpanded,setAdvancedExpanded:setAdvancedExpanded}),external_kbnSharedDeps_React_default.a.createElement(WizardNav,{previous:()=>setCurrentStep(WIZARD_STEPS.PICK_FIELDS),next:()=>setCurrentStep(WIZARD_STEPS.VALIDATION),nextActive:nextActive},Object(job_creator.a)(jobCreator)&&external_kbnSharedDeps_React_default.a.createElement(JsonEditorFlyout,{isDisabled:!1,jobEditorMode:json_editor_flyout_EDITOR_MODE.EDITABLE,datafeedEditorMode:json_editor_flyout_EDITOR_MODE.EDITABLE}))))};var prop_types=__webpack_require__(126),prop_types_default=__webpack_require__.n(prop_types),constants_validation=__webpack_require__(27),util_string_utils=__webpack_require__(9);const getMessages=Object(external_kbnSharedDeps_Lodash_.once)(docLinks=>({categorizer_detector_missing_per_partition_field:{status:constants_validation.c.ERROR,text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.categorizerMissingPerPartitionFieldMessage",{defaultMessage:'Partition field must be set for detectors that reference "mlcategory" when per-partition categorization is enabled.'}),url:null==docLinks?void 0:docLinks.links.ml.anomalyDetectionConfiguringCategories},categorizer_varying_per_partition_fields:{status:constants_validation.c.ERROR,text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.categorizerVaryingPerPartitionFieldNamesMessage",{defaultMessage:'Detectors with keyword "mlcategory" cannot have different partition_field_name when per-partition categorization is enabled. Found [{fields}].',values:{fields:'"{{fields}}"'}}),url:null==docLinks?void 0:docLinks.links.ml.anomalyDetectionConfiguringCategories},field_not_aggregatable:{status:constants_validation.c.ERROR,text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.fieldNotAggregatableMessage",{defaultMessage:"Detector field {fieldName} is not an aggregatable field.",values:{fieldName:'"{{fieldName}}"'}}),url:null==docLinks?void 0:docLinks.links.ml.aggregrations},fields_not_aggregatable:{status:constants_validation.c.ERROR,text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.fieldsNotAggregatableMessage",{defaultMessage:"One of the detector fields is not an aggregatable field."}),url:null==docLinks?void 0:docLinks.links.ml.aggregrations},cardinality_no_results:{status:constants_validation.c.WARNING,heading:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.cardinalityNoResultsHeading",{defaultMessage:"Field cardinality"}),text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.cardinalityNoResultsMessage",{defaultMessage:"Cardinality checks could not be run. The query to validate fields didn't return any documents."})},cardinality_field_not_exists:{status:constants_validation.c.WARNING,heading:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.cardinalityFieldNotExistsHeading",{defaultMessage:"Field cardinality"}),text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.cardinalityFieldNotExistsMessage",{defaultMessage:"Cardinality checks could not be run for field {fieldName}. The query to validate the field didn't return any documents.",values:{fieldName:'"{{fieldName}}"'}}),url:null==docLinks?void 0:docLinks.links.ml.aggregrations},cardinality_by_field:{status:constants_validation.c.WARNING,text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.cardinalityByFieldMessage",{defaultMessage:"Cardinality of {fieldName} is above 1000 and might result in high memory usage.",values:{fieldName:'by_field "{{fieldName}}"'}}),url:null==docLinks?void 0:docLinks.links.ml.anomalyDetectionCardinality},cardinality_over_field_low:{status:constants_validation.c.WARNING,text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.cardinalityOverFieldLowMessage",{defaultMessage:"Cardinality of {fieldName} is below 10 and might not be suitable for population analysis.",values:{fieldName:'over_field "{{fieldName}}"'}}),url:null==docLinks?void 0:docLinks.links.ml.anomalyDetectionCardinality},cardinality_over_field_high:{status:constants_validation.c.WARNING,text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.cardinalityOverFieldHighMessage",{defaultMessage:"Cardinality of {fieldName} is above 1000000 and might result in high memory usage.",values:{fieldName:'over_field "{{fieldName}}"'}}),url:null==docLinks?void 0:docLinks.links.ml.anomalyDetectionCardinality},cardinality_partition_field:{status:constants_validation.c.WARNING,text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.cardinalityPartitionFieldMessage",{defaultMessage:"Cardinality of {fieldName} is above 1000 and might result in high memory usage.",values:{fieldName:'partition_field "{{fieldName}}"'}}),url:null==docLinks?void 0:docLinks.links.ml.anomalyDetectionCardinality},cardinality_model_plot_high:{status:constants_validation.c.WARNING,text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.cardinalityModelPlotHighMessage",{defaultMessage:"The estimated cardinality of {modelPlotCardinality} of fields relevant to creating model plots might result in resource intensive jobs.",values:{modelPlotCardinality:"{{modelPlotCardinality}}"}})},categorization_filters_valid:{status:constants_validation.c.SUCCESS,text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.categorizationFiltersValidMessage",{defaultMessage:"Categorization filters checks passed."}),url:null==docLinks?void 0:docLinks.links.ml.anomalyDetectionConfiguringCategories},categorization_filters_invalid:{status:constants_validation.c.ERROR,text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.categorizationFiltersInvalidMessage",{defaultMessage:"The categorization filters configuration is invalid. Make sure filters are valid regular expressions and {categorizationFieldName} is set.",values:{categorizationFieldName:'"categorization_field_name"'}}),url:null==docLinks?void 0:docLinks.links.ml.anomalyDetectionJobResourceAnalysisConfig},bucket_span_empty:{status:constants_validation.c.ERROR,text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.bucketSpanEmptyMessage",{defaultMessage:"The bucket span field must be specified."}),url:null==docLinks?void 0:docLinks.links.ml.anomalyDetectionJobResourceAnalysisConfig},bucket_span_estimation_mismatch:{status:constants_validation.c.INFO,heading:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.bucketSpanEstimationMismatchHeading",{defaultMessage:"Bucket span"}),text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.bucketSpanEstimationMismatchMessage",{defaultMessage:"Current bucket span is {currentBucketSpan}, but bucket span estimation returned {estimateBucketSpan}.",values:{currentBucketSpan:'"{{currentBucketSpan}}"',estimateBucketSpan:'"{{estimateBucketSpan}}"'}}),url:null==docLinks?void 0:docLinks.links.ml.anomalyDetectionBucketSpan},bucket_span_high:{status:constants_validation.c.INFO,heading:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.bucketSpanHighHeading",{defaultMessage:"Bucket span"}),text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.bucketSpanHighMessage",{defaultMessage:"Bucket span is 1 day or more. Be aware that days are considered as UTC days, not local days."}),url:null==docLinks?void 0:docLinks.links.ml.anomalyDetectionBucketSpan},bucket_span_valid:{status:constants_validation.c.SUCCESS,heading:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.bucketSpanValidHeading",{defaultMessage:"Bucket span"}),text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.bucketSpanValidMessage",{defaultMessage:"Format of {bucketSpan} is valid.",values:{bucketSpan:'"{{bucketSpan}}"'}}),url:null==docLinks?void 0:docLinks.links.ml.anomalyDetectionJobResourceAnalysisConfig},bucket_span_invalid:{status:constants_validation.c.ERROR,heading:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.bucketSpanInvalidHeading",{defaultMessage:"Bucket span"}),text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.bucketSpanInvalidMessage",{defaultMessage:"The specified bucket span is not a valid time interval format e.g. 10m, 1h. It also needs to be higher than zero."}),url:null==docLinks?void 0:docLinks.links.ml.anomalyDetectionJobResourceAnalysisConfig},detectors_duplicates:{status:constants_validation.c.ERROR,text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.detectorsDuplicatesMessage",{defaultMessage:"Duplicate detectors were found. Detectors having the same combined configuration for {functionParam}, {fieldNameParam}, {byFieldNameParam}, {overFieldNameParam} and {partitionFieldNameParam} are not allowed within the same job.",values:{functionParam:"'function'",fieldNameParam:"'field_name'",byFieldNameParam:"'by_field_name'",overFieldNameParam:"'over_field_name'",partitionFieldNameParam:"'partition_field_name'"}}),url:null==docLinks?void 0:docLinks.links.ml.anomalyDetectionDetectors},detectors_empty:{status:constants_validation.c.ERROR,text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.detectorsEmptyMessage",{defaultMessage:"No detectors were found. At least one detector must be specified."}),url:null==docLinks?void 0:docLinks.links.ml.anomalyDetectionDetectors},detectors_function_empty:{status:constants_validation.c.ERROR,text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.detectorsFunctionEmptyMessage",{defaultMessage:"One of the detector functions is empty."}),url:null==docLinks?void 0:docLinks.links.ml.anomalyDetectionDetectors},detectors_function_not_empty:{status:constants_validation.c.SUCCESS,heading:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.detectorsFunctionNotEmptyHeading",{defaultMessage:"Detector functions"}),text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.detectorsFunctionNotEmptyMessage",{defaultMessage:"Presence of detector functions validated in all detectors."}),url:null==docLinks?void 0:docLinks.links.ml.anomalyDetectionDetectors},index_fields_invalid:{status:constants_validation.c.ERROR,text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.indexFieldsInvalidMessage",{defaultMessage:"Could not load fields from index."})},index_fields_valid:{status:constants_validation.c.SUCCESS,text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.indexFieldsValidMessage",{defaultMessage:"Index fields are present in the datafeed."})},influencer_high:{status:constants_validation.c.WARNING,text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.influencerHighMessage",{defaultMessage:"The job configuration includes more than 3 influencers. Consider using fewer influencers or creating multiple jobs."}),url:null==docLinks?void 0:docLinks.links.ml.anomalyDetectionInfluencers},influencer_low:{status:constants_validation.c.WARNING,text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.influencerLowMessage",{defaultMessage:"No influencers have been configured. Picking an influencer is strongly recommended."}),url:null==docLinks?void 0:docLinks.links.ml.anomalyDetectionInfluencers},influencer_low_suggestion:{status:constants_validation.c.WARNING,text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.influencerLowSuggestionMessage",{defaultMessage:"No influencers have been configured. Consider using {influencerSuggestion} as an influencer.",values:{influencerSuggestion:"{{influencerSuggestion}}"}}),url:null==docLinks?void 0:docLinks.links.ml.anomalyDetectionInfluencers},influencer_low_suggestions:{status:constants_validation.c.WARNING,text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.influencerLowSuggestionsMessage",{defaultMessage:"No influencers have been configured. Consider using one or more of {influencerSuggestion}.",values:{influencerSuggestion:"{{influencerSuggestion}}"}}),url:null==docLinks?void 0:docLinks.links.ml.anomalyDetectionInfluencers},job_id_empty:{status:constants_validation.c.ERROR,text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.jobIdEmptyMessage",{defaultMessage:"Job ID field must not be empty."}),url:null==docLinks?void 0:docLinks.links.ml.anomalyDetectionJobResource},job_id_invalid:{status:constants_validation.c.ERROR,text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.jobIdInvalidMessage",{defaultMessage:"Job ID is invalid. It can contain lowercase alphanumeric (a-z and 0-9) characters, hyphens or underscores and must start and end with an alphanumeric character."}),url:null==docLinks?void 0:docLinks.links.ml.anomalyDetectionJobResource},job_id_invalid_max_length:{status:constants_validation.c.ERROR,text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.jobIdInvalidMaxLengthErrorMessage",{defaultMessage:"Job ID must be no more than {maxLength, plural, one {# character} other {# characters}} long.",values:{maxLength:constants_validation.b}}),url:null==docLinks?void 0:docLinks.links.ml.anomalyDetectionJobResource},job_id_valid:{status:constants_validation.c.SUCCESS,heading:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.jobIdValidHeading",{defaultMessage:"Job ID format is valid"}),text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.jobIdValidMessage",{defaultMessage:"Lowercase alphanumeric (a-z and 0-9) characters, hyphens or underscores, starts and ends with an alphanumeric character, and is no more than {maxLength, plural, one {# character} other {# characters}} long.",values:{maxLength:constants_validation.b}}),url:null==docLinks?void 0:docLinks.links.ml.anomalyDetectionJobResource},job_group_id_invalid:{status:constants_validation.c.ERROR,text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.jobGroupIdInvalidMessage",{defaultMessage:"One of the job group names is invalid. They can contain lowercase alphanumeric (a-z and 0-9) characters, hyphens or underscores and must start and end with an alphanumeric character."}),url:null==docLinks?void 0:docLinks.links.ml.anomalyDetectionJobResource},job_group_id_invalid_max_length:{status:constants_validation.c.ERROR,text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.jobGroupIdInvalidMaxLengthErrorMessage",{defaultMessage:"Job group name must be no more than {maxLength, plural, one {# character} other {# characters}} long.",values:{maxLength:constants_validation.b}}),url:null==docLinks?void 0:docLinks.links.ml.anomalyDetectionJobResource},job_group_id_valid:{status:constants_validation.c.SUCCESS,heading:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.jobGroupIdValidHeading",{defaultMessage:"Job group id formats are valid"}),text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.jobGroupIdValidMessage",{defaultMessage:"Lowercase alphanumeric (a-z and 0-9) characters, hyphens or underscores, starts and ends with an alphanumeric character, and is no more than {maxLength, plural, one {# character} other {# characters}} long.",values:{maxLength:constants_validation.b}}),url:null==docLinks?void 0:docLinks.links.ml.anomalyDetectionJobResource},missing_summary_count_field_name:{status:constants_validation.c.ERROR,text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.missingSummaryCountFieldNameMessage",{defaultMessage:"A job configured with a datafeed with aggregations must set summary_count_field_name; use doc_count or suitable alternative."})},skipped_extended_tests:{status:constants_validation.c.WARNING,text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.skippedExtendedTestsMessage",{defaultMessage:"Skipped additional checks because the basic requirements of the job configuration were not met."})},success_cardinality:{status:constants_validation.c.SUCCESS,heading:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.successCardinalityHeading",{defaultMessage:"Cardinality"}),text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.successCardinalityMessage",{defaultMessage:"Cardinality of detector fields is within recommended bounds."}),url:null==docLinks?void 0:docLinks.links.ml.anomalyDetectionCardinality},success_bucket_span:{status:constants_validation.c.SUCCESS,heading:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.successBucketSpanHeading",{defaultMessage:"Bucket span"}),text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.successBucketSpanMessage",{defaultMessage:"Format of {bucketSpan} is valid and passed validation checks.",values:{bucketSpan:'"{{bucketSpan}}"'}}),url:null==docLinks?void 0:docLinks.links.ml.anomalyDetectionBucketSpan},success_influencers:{status:constants_validation.c.SUCCESS,text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.successInfluencersMessage",{defaultMessage:"Influencer configuration passed the validation checks."}),url:null==docLinks?void 0:docLinks.links.ml.anomalyDetectionInfluencers},estimated_mml_greater_than_max_mml:{status:constants_validation.c.WARNING,text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.estimatedMmlGreaterThanMaxMmlMessage",{defaultMessage:"The estimated model memory limit is greater than the max model memory limit configured for this cluster."})},mml_greater_than_effective_max_mml:{status:constants_validation.c.WARNING,text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.mmlGreaterThanEffectiveMaxMmlMessage",{defaultMessage:"Job will not be able to run in the current cluster because model memory limit is higher than {effectiveMaxModelMemoryLimit}.",values:{effectiveMaxModelMemoryLimit:"{{effectiveMaxModelMemoryLimit}}"}})},mml_greater_than_max_mml:{status:constants_validation.c.ERROR,text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.mmlGreaterThanMaxMmlMessage",{defaultMessage:"The model memory limit is greater than the max model memory limit configured for this cluster."})},mml_value_invalid:{status:constants_validation.c.ERROR,text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.mmlValueInvalidMessage",{defaultMessage:"{mml} is not a valid value for model memory limit. The value needs to be at least 1MB and should be specified in bytes e.g. 10MB.",values:{mml:"{{mml}}"}}),url:null==docLinks?void 0:docLinks.links.ml.anomalyDetectionModelMemoryLimits},half_estimated_mml_greater_than_mml:{status:constants_validation.c.WARNING,text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.halfEstimatedMmlGreaterThanMmlMessage",{defaultMessage:"The specified model memory limit is less than half of the estimated model memory limit and will likely hit the hard limit."}),url:null==docLinks?void 0:docLinks.links.ml.anomalyDetectionModelMemoryLimits},estimated_mml_greater_than_mml:{status:constants_validation.c.INFO,text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.estimatedMmlGreaterThanMmlMessage",{defaultMessage:"The estimated model memory limit is greater than the model memory limit you have configured."}),url:null==docLinks?void 0:docLinks.links.ml.anomalyDetectionModelMemoryLimits},success_mml:{status:constants_validation.c.SUCCESS,heading:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.successMmlHeading",{defaultMessage:"Model memory limit"}),text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.successMmlMessage",{defaultMessage:"Valid and within the estimated model memory limit."}),url:null==docLinks?void 0:docLinks.links.ml.anomalyDetectionModelMemoryLimits},success_time_range:{status:constants_validation.c.SUCCESS,heading:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.successTimeRangeHeading",{defaultMessage:"Time range"}),text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.successTimeRangeMessage",{defaultMessage:"Valid and long enough to model patterns in the data."})},time_field_invalid:{status:constants_validation.c.ERROR,text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.timeFieldInvalidMessage",{defaultMessage:"{timeField} cannot be used as the time field because it is not a field of type 'date' or 'date_nanos'.",values:{timeField:"'{{timeField}}'"}})},time_range_short:{status:constants_validation.c.WARNING,heading:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.timeRangeShortHeading",{defaultMessage:"Time range"}),text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.timeRangeShortMessage",{defaultMessage:"The selected or available time range might be too short. The recommended minimum time range should be at least {minTimeSpanReadable} and {bucketSpanCompareFactor} times the bucket span.",values:{minTimeSpanReadable:"{{minTimeSpanReadable}}",bucketSpanCompareFactor:"{{bucketSpanCompareFactor}}"}})},time_range_before_epoch:{status:constants_validation.c.WARNING,heading:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.timeRangeBeforeEpochHeading",{defaultMessage:"Time range"}),text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.messages.timeRangeBeforeEpochMessage",{defaultMessage:"The selected or available time range contains data with timestamps before the UNIX epoch beginning. Timestamps before 01/01/1970 00:00:00 (UTC) are not supported for machine learning jobs."})}})),statusToEuiColor=status=>{switch(status){case constants_validation.c.INFO:return"primary";case constants_validation.c.ERROR:return"danger";default:return status}},statusToEuiIconType=status=>{switch(status){case constants_validation.c.INFO:return"iInCircle";case constants_validation.c.ERROR:return"cross";case constants_validation.c.SUCCESS:return"check";case constants_validation.c.WARNING:return"alert";default:return status}},Link=({url:url})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{href:url,target:"_BLANK"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.validateJob.learnMoreLinkText",defaultMessage:"Learn more"})),Message=({text:text,url:url})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,text," ",url&&external_kbnSharedDeps_React_default.a.createElement(Link,{url:url})),Callout=({heading:heading,status:status,text:text,url:url})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{"data-test-subj":"mlValidationCallout",color:statusToEuiColor(status),size:"s",title:heading||external_kbnSharedDeps_React_default.a.createElement(Message,{text:text,url:url}),iconType:status?statusToEuiIconType(status):"questionInCircle"},heading&&external_kbnSharedDeps_React_default.a.createElement(Message,{text:text,url:url})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}));function validate_job_view_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function validate_job_view_extends(){return(validate_job_view_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const MessageList=({messages:messages,idFilterList:idFilterList})=>{const callouts=messages.filter(m=>!1===idFilterList.includes(m.id)).map((m,i)=>external_kbnSharedDeps_React_default.a.createElement(Callout,validate_job_view_extends({key:`${m.id}_${i}`},m))),allPassedCallout=external_kbnSharedDeps_React_default.a.createElement(Callout,{text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.validateJob.allPassed",{defaultMessage:"All validation checks passed successfully"}),status:constants_validation.c.SUCCESS});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,callouts.length?callouts:allPassedCallout)},LoadingSpinner=()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceAround",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingSpinner,{size:"xl"}))),Modal=({close:close,title:title,children:children})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModal,{onClose:close,style:{width:"800px"}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalHeader,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalHeaderTitle,null,title)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalBody,null,children),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalFooter,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{onClick:close,size:"s",fill:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.validateJob.modal.closeButtonLabel",defaultMessage:"Close"}))));Modal.propType={close:prop_types_default.a.func.isRequired,title:prop_types_default.a.string};class validate_job_view_ValidateJobUI extends external_kbnSharedDeps_React_.Component{constructor(props){super(props),validate_job_view_defineProperty(this,"closeModal",()=>{const newState={ui:{iconType:"questionInCircle",isLoading:!0,isModalVisible:!1},data:{messages:[],success:!1},title:""};newState.ui.iconType=this.state.ui.iconType,this.setState(newState)}),validate_job_view_defineProperty(this,"validate",()=>{const job=this.props.getJobConfig(),getDuration=this.props.getDuration,duration="function"==typeof getDuration?getDuration():void 0,fields=this.props.fields;if("object"==typeof job)if("object"==typeof duration&&null!==duration.start&&null!==duration.end){let shouldShowLoadingIndicator=!0;this.props.ml.validateJob({duration:duration,fields:fields,job:job}).then(validationMessages=>{const messages=((validationMessages,docLinks)=>{const messages=getMessages(docLinks);return validationMessages.map(message=>{const messageId=message.id,messageDef=messages[messageId];return void 0!==messageDef?(void 0!==messageDef.heading&&(message.heading=Object(util_string_utils.c)(messageDef.heading,message)),message.text=Object(util_string_utils.c)(messageDef.text,message),void 0!==messageDef.url&&(message.url=messageDef.url),message.status=messageDef.status):message.text=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.models.jobValidation.unknownMessageIdErrorMessage",{defaultMessage:"{messageId} (unknown message id)",values:{messageId:messageId}}),message})})(validationMessages,Object(dependency_cache.b)());shouldShowLoadingIndicator=!1;const messagesContainError=messages.some(m=>m.status===constants_validation.c.ERROR);messagesContainError&&messages.push({id:"job_validation_includes_error",text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.validateJob.jobValidationIncludesErrorText",{defaultMessage:"Job validation has failed, but you can still continue and create the job. Please be aware the job may encounter problems when running."}),status:constants_validation.c.WARNING}),this.setState({...this.state,ui:{...this.state.ui,iconType:statusToEuiIconType(Object(validation_utils.b)(messages)),isLoading:!1,isModalVisible:!0},data:{messages:messages,success:!0},title:job.job_id}),"function"==typeof this.props.setIsValid&&this.props.setIsValid(!messagesContainError)}).catch(error=>{const{toasts:toasts}=this.props.kibana.services.notifications;Object(toast_notification_service.b)(toasts).displayErrorToast(error,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobService.validateJobErrorTitle",{defaultMessage:"Job Validation Error"}))});setTimeout(()=>{shouldShowLoadingIndicator&&this.setState({...this.state,ui:{...this.state.ui,isLoading:!0,isModalVisible:!1}})},250)}else this.setState({...this.state,ui:{...this.state.ui,iconType:statusToEuiIconType(constants_validation.c.WARNING),isLoading:!1,isModalVisible:!0},data:{messages:[{id:"job_validation_skipped",text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.validateJob.jobValidationSkippedText",{defaultMessage:"Job validation could not be run because of insufficient sample data. Please be aware the job may encounter problems when running."}),status:constants_validation.c.WARNING}],success:!0},title:job.job_id}),"function"==typeof this.props.setIsValid&&this.props.setIsValid(!0)}),this.state={ui:{iconType:"questionInCircle",isLoading:!0,isModalVisible:!1},data:{messages:[],success:!1},title:""}}componentDidMount(){!0===this.props.embedded&&this.validate()}render(){const jobTipsUrl=Object(dependency_cache.b)().links.ml.anomalyDetectionJobTips,fill=!1!==this.props.fill,isCurrentJobConfig=!0===this.props.isCurrentJobConfig,isDisabled=!0===this.props.isDisabled,embedded=!0===this.props.embedded,idFilterList=this.props.idFilterList||[],isLoading=this.state.ui.isLoading;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,!1===embedded?external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{onClick:this.validate,size:"s",fill:fill,iconType:isCurrentJobConfig?this.state.ui.iconType:"questionInCircle",iconSide:"right",isDisabled:isDisabled,isLoading:isLoading},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.validateJob.validateJobButtonLabel",defaultMessage:"Validate Job"})),!isDisabled&&this.state.ui.isModalVisible&&external_kbnSharedDeps_React_default.a.createElement(Modal,{close:this.closeModal,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.validateJob.modal.validateJobTitle",defaultMessage:"Validate job {title}",values:{title:this.state.title}})},isLoading?external_kbnSharedDeps_React_default.a.createElement(LoadingSpinner,null):external_kbnSharedDeps_React_default.a.createElement(MessageList,{messages:this.state.data.messages,idFilterList:idFilterList}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.validateJob.modal.jobValidationDescriptionText",defaultMessage:"Job validation performs certain checks against job configurations and underlying source data and provides specific advice on how to adjust settings that are more likely to produce insightful results."})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.validateJob.modal.linkToJobTipsText",defaultMessage:"For more information, see {mlJobTipsLink}.",values:{mlJobTipsLink:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{href:jobTipsUrl,target:"_blank"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.validateJob.modal.linkToJobTipsText.mlJobTipsLinkText",defaultMessage:"Machine Learning Job Tips"}))}})))):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,isLoading?external_kbnSharedDeps_React_default.a.createElement(LoadingSpinner,null):external_kbnSharedDeps_React_default.a.createElement(MessageList,{messages:this.state.data.messages,idFilterList:idFilterList})))}}const ValidateJob=Object(kibanaReact_public_.withKibana)(validate_job_view_ValidateJobUI),validation_idFilterList=["job_id_valid","job_group_id_valid","detectors_function_not_empty","success_bucket_span"],ValidationStep=({setCurrentStep:setCurrentStep,isCurrentStep:isCurrentStep})=>{const{jobCreator:jobCreator,jobCreatorUpdate:jobCreatorUpdate,jobValidator:jobValidator}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext);return jobCreator.type===new_job.f.ADVANCED&&validation_idFilterList.push("time_range_short","success_time_range"),Object(external_kbnSharedDeps_React_.useEffect)(()=>{jobValidator.validate(()=>{},!0),jobCreatorUpdate()},[]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,isCurrentStep&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(ValidateJob,{getJobConfig:function(){return{...jobCreator.jobConfig,datafeed_config:jobCreator.datafeedConfig}},getDuration:function(){return{start:jobCreator.start,end:jobCreator.end}},ml:ml_api_service.ml,embedded:!0,setIsValid:function(valid){jobValidator.advancedValid=valid},idFilterList:validation_idFilterList}),external_kbnSharedDeps_React_default.a.createElement(WizardNav,{previous:()=>setCurrentStep(WIZARD_STEPS.JOB_DETAILS),next:()=>setCurrentStep(WIZARD_STEPS.SUMMARY),nextActive:!0})),!1===isCurrentStep&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null))},trueLabel=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.summaryStep.trueLabel",{defaultMessage:"True"}),falseLabel=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.summaryStep.falseLabel",{defaultMessage:"False"}),defaultLabel=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.summaryStep.defaultString",{defaultMessage:"default"}),JobSectionTitle=()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"s"},external_kbnSharedDeps_React_default.a.createElement("h3",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.summaryStep.jobConfig.title",defaultMessage:"Job configuration"}))),DatafeedSectionTitle=()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"s"},external_kbnSharedDeps_React_default.a.createElement("h3",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.summaryStep.datafeedConfig.title",defaultMessage:"Datafeed configuration"}))),Italic=({children:children})=>external_kbnSharedDeps_React_default.a.createElement("span",{style:{fontStyle:"italic"}},children),JobDetails=()=>{const{jobCreator:jobCreator}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext),dateFormat=Object(ml.b)().kibanaConfig.get("dateFormat"),{anomaly_detectors:anomalyDetectors}=Object(ml_server_info.b)(),isAdvanced=Object(job_creator.a)(jobCreator),modelMemoryLimitDefault=anomalyDetectors.model_memory_limit||"",modelMemoryLimit=null!==jobCreator.modelMemoryLimit?jobCreator.modelMemoryLimit:external_kbnSharedDeps_React_default.a.createElement(Italic,null,`${modelMemoryLimitDefault} (${defaultLabel})`),jobDetails=[{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.summaryStep.jobDetails.jobDetails.title",{defaultMessage:"Job ID"}),description:jobCreator.jobId},{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.summaryStep.jobDetails.jobDescription.title",{defaultMessage:"Job description"}),description:jobCreator.description.length>0?jobCreator.description:external_kbnSharedDeps_React_default.a.createElement(Italic,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.summaryStep.jobDetails.jobDescription.placeholder",defaultMessage:"No description provided"}))},{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.summaryStep.jobDetails.groups.title",{defaultMessage:"Groups"}),description:jobCreator.groups.length>0?jobCreator.groups.join(", "):external_kbnSharedDeps_React_default.a.createElement(Italic,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.summaryStep.jobDetails.groups.placeholder",defaultMessage:"No groups selected"}))}],detectorDetails=[{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.summaryStep.jobDetails.bucketSpan.title",{defaultMessage:"Bucket span"}),description:jobCreator.bucketSpan}];Object(job_creator.c)(jobCreator)&&detectorDetails.push({title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.summaryStep.jobDetails.splitField.title",{defaultMessage:"Split field"}),description:Object(job_creator.c)(jobCreator)&&null!==jobCreator.splitField?jobCreator.splitField.name:external_kbnSharedDeps_React_default.a.createElement(Italic,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.summaryStep.jobDetails.splitField.placeholder",defaultMessage:"No split field selected"}))}),Object(job_creator.d)(jobCreator)&&detectorDetails.push({title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.summaryStep.jobDetails.populationField.title",{defaultMessage:"Population field"}),description:Object(job_creator.d)(jobCreator)&&null!==jobCreator.splitField?jobCreator.splitField.name:external_kbnSharedDeps_React_default.a.createElement("span",{style:{fontStyle:null!==jobCreator.splitField?"inherit":"italic"}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.summaryStep.jobDetails.populationField.placeholder",defaultMessage:"No population field selected"}))}),isAdvanced&&null!==jobCreator.categorizationFieldName&&detectorDetails.push({title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.summaryStep.jobDetails.categorizationField.title",{defaultMessage:"Categorization field"}),description:jobCreator.categorizationFieldName}),isAdvanced&&null!==jobCreator.summaryCountFieldName&&detectorDetails.push({title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.summaryStep.jobDetails.summaryCountField.title",{defaultMessage:"Summary count field"}),description:jobCreator.summaryCountFieldName}),detectorDetails.push({title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.summaryStep.jobDetails.influencers.title",{defaultMessage:"Influencers"}),description:jobCreator.influencers.length>0?jobCreator.influencers.join(", "):external_kbnSharedDeps_React_default.a.createElement(Italic,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.summaryStep.jobDetails.influencers.placeholder",defaultMessage:"No influencers selected"}))});const advancedDetails=[{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.summaryStep.jobDetails.enableModelPlot.title",{defaultMessage:"Enable model plot"}),description:jobCreator.modelPlot?trueLabel:falseLabel},{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.summaryStep.jobDetails.useDedicatedIndex.title",{defaultMessage:"Use dedicated index"}),description:jobCreator.useDedicatedIndex?trueLabel:falseLabel},{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.summaryStep.jobDetails.modelMemoryLimit.title",{defaultMessage:"Model memory limit"}),description:modelMemoryLimit}],timeRangeDetails=[{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.summaryStep.timeRange.start.title",{defaultMessage:"Start"}),description:external_kbnSharedDeps_Moment_default()(jobCreator.start).format(dateFormat)},{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.summaryStep.timeRange.end.title",{defaultMessage:"End"}),description:external_kbnSharedDeps_Moment_default()(jobCreator.end).format(dateFormat)}];return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionList,{compressed:!0,listItems:jobDetails})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionList,{compressed:!0,listItems:detectorDetails})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionList,{compressed:!0,listItems:advancedDetails})),!1===isAdvanced&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionList,{compressed:!0,listItems:timeRangeDetails})))},DatafeedDetails=()=>{const{jobCreator:jobCreator}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext),{datafeeds:datafeeds}=Object(ml_server_info.b)(),queryString=JSON.stringify(jobCreator.query,null,2),defaultFrequency=Object(job_utils.f)(jobCreator.bucketSpanMs/1e3),scrollSizeDefault=datafeeds.scroll_size||"",queryDelay=jobCreator.queryDelay||external_kbnSharedDeps_React_default.a.createElement(Italic,null,`${new_job.d} (${defaultLabel})`),frequency=jobCreator.frequency||external_kbnSharedDeps_React_default.a.createElement(Italic,null,`${defaultFrequency}s (${defaultLabel})`),scrollSize=null!==jobCreator.scrollSize?""+jobCreator.scrollSize:external_kbnSharedDeps_React_default.a.createElement(Italic,null,`${scrollSizeDefault} (${defaultLabel})`),datafeedDetails=[{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.summaryStep.datafeedDetails.timeField.title",{defaultMessage:"Time field"}),description:jobCreator.timeFieldName},{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.summaryStep.datafeedDetails.queryDelay.title",{defaultMessage:"Query delay"}),description:queryDelay},{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.summaryStep.datafeedDetails.frequency.title",{defaultMessage:"Frequency"}),description:frequency},{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.summaryStep.datafeedDetails.scrollSize.title",{defaultMessage:"Scroll size"}),description:scrollSize}],queryTitle=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.summaryStep.datafeedDetails.query.title",{defaultMessage:"Elasticsearch query"});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:queryTitle,fullWidth:!0},external_kbnSharedDeps_React_default.a.createElement(ml_job_editor.a,{value:queryString,height:"200px",readOnly:!0}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionList,{compressed:!0,listItems:datafeedDetails})))},DetectorChart=()=>{const{jobCreator:jobCreator}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,jobCreator.type===new_job.f.SINGLE_METRIC&&external_kbnSharedDeps_React_default.a.createElement(SingleMetricView,{isActive:!1}),jobCreator.type===new_job.f.MULTI_METRIC&&external_kbnSharedDeps_React_default.a.createElement(MultiMetricView,{isActive:!1}),jobCreator.type===new_job.f.POPULATION&&external_kbnSharedDeps_React_default.a.createElement(PopulationView,{isActive:!1}),jobCreator.type===new_job.f.ADVANCED&&external_kbnSharedDeps_React_default.a.createElement(AdvancedView,{isActive:!1}),jobCreator.type===new_job.f.CATEGORIZATION&&external_kbnSharedDeps_React_default.a.createElement(CategorizationView,{isActive:!1}))},JobProgress=({progress:progress})=>progress>0&&progress<100?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiProgress,{value:progress,color:"primary",size:"xs",max:100}):null;var states=__webpack_require__(106),ml_alerting_flyout=__webpack_require__(244);const PostSaveOptions=({jobRunner:jobRunner})=>{const{services:{notifications:notifications}}=Object(contexts_kibana.b)(),{jobCreator:jobCreator}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext),[datafeedState,setDatafeedState]=Object(external_kbnSharedDeps_React_.useState)(states.a.STOPPED),[alertFlyoutVisible,setAlertFlyoutVisible]=Object(external_kbnSharedDeps_React_.useState)(!1);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{isDisabled:datafeedState===states.a.STARTING||datafeedState===states.a.STARTED,onClick:async function(){const{toasts:toasts}=notifications;if(setDatafeedState(states.a.STARTING),null!==jobRunner)try{const started=await jobRunner.startDatafeedInRealTime(!0);setDatafeedState(!0===started?states.a.STARTED:states.a.STOPPED),toasts.addSuccess({title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.summaryStep.postSaveOptions.startJobInRealTimeSuccess",{defaultMessage:"Job {jobId} started",values:{jobId:jobCreator.jobId}})})}catch(error){setDatafeedState(states.a.STOPPED),toasts.addDanger({title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.summaryStep.postSaveOptions.startJobInRealTimeError",{defaultMessage:"Error starting job"}),text:Object(util_errors.i)(error)})}},"data-test-subj":"mlJobWizardButtonRunInRealTime"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.summaryStep.postSaveOptions.startJobInRealTime",defaultMessage:"Start job running in real time"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{isDisabled:datafeedState===states.a.STOPPED||datafeedState===states.a.STARTING,onClick:setAlertFlyoutVisible.bind(null,!0),"data-test-subj":"mlJobWizardButtonCreateAlert"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.summaryStep.postSaveOptions.createAlert",defaultMessage:"Create alert rule"}))),datafeedState===states.a.STARTED&&alertFlyoutVisible&&external_kbnSharedDeps_React_default.a.createElement(ml_alerting_flyout.c,{jobIds:[jobCreator.jobId],onCloseFlyout:setAlertFlyoutVisible.bind(null,!1)}))},StartDatafeedSwitch=({startDatafeed:startDatafeed,setStartDatafeed:setStartDatafeed,disabled:disabled=!1})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{helpText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.summaryStep.startDatafeedCheckboxHelpText",{defaultMessage:"If unselected, job can be started later from the jobs list."})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSwitch,{"data-test-subj":"mlJobWizardStartDatafeedCheckbox",label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.summaryStep.startDatafeedCheckbox",{defaultMessage:"Start immediately"}),checked:startDatafeed,onChange:e=>setStartDatafeed(e.target.checked),disabled:disabled})));var jobs_awaiting_node_warning=__webpack_require__(162);const SummaryStep=({setCurrentStep:setCurrentStep,isCurrentStep:isCurrentStep})=>{const{services:{notifications:notifications,http:{basePath:basePath}}}=Object(contexts_kibana.b)(),navigateToPath=Object(contexts_kibana.e)(),{jobCreator:jobCreator,jobValidator:jobValidator,jobValidatorUpdated:jobValidatorUpdated,resultsLoader:resultsLoader}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext),[progress,setProgress]=Object(external_kbnSharedDeps_React_.useState)(resultsLoader.progress),[creatingJob,setCreatingJob]=Object(external_kbnSharedDeps_React_.useState)(!1),[isValid,setIsValid]=Object(external_kbnSharedDeps_React_.useState)(jobValidator.validationSummary.basic),[jobRunner,setJobRunner]=Object(external_kbnSharedDeps_React_.useState)(null),[startDatafeed,setStartDatafeed]=Object(external_kbnSharedDeps_React_.useState)(!0),[showJobAssignWarning,setShowJobAssignWarning]=Object(external_kbnSharedDeps_React_.useState)(!1),isAdvanced=Object(job_creator.a)(jobCreator),jsonEditorMode=isAdvanced?json_editor_flyout_EDITOR_MODE.EDITABLE:json_editor_flyout_EDITOR_MODE.READONLY;async function createAdvancedJob(showStartModal=!0){try{await jobCreator.createJob(),await jobCreator.createDatafeed(),Object(general.a)(showStartModal?jobCreator:null,navigateToPath)}catch(error){handleJobCreationError(error)}}function handleJobCreationError(error){const{displayErrorToast:displayErrorToast}=Object(toast_notification_service.b)(notifications.toasts);displayErrorToast(error,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.summaryStep.createJobError",{defaultMessage:"Job creation error"})),setCreatingJob(!1)}Object(external_kbnSharedDeps_React_.useEffect)(()=>{jobCreator.subscribeToProgress(setProgress)},[]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{let s=null;return null!==jobRunner&&(s=jobRunner.subscribeToJobAssignment(assigned=>setShowJobAssignWarning(!assigned))),()=>{var _s;null!==s&&(null===(_s=s)||void 0===_s||_s.unsubscribe())}},[jobRunner]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{setIsValid(jobValidator.validationSummary.basic)},[jobValidatorUpdated]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,isCurrentStep&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,isAdvanced&&external_kbnSharedDeps_React_default.a.createElement(JobSectionTitle,null),external_kbnSharedDeps_React_default.a.createElement(DetectorChart,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(JobProgress,{progress:progress}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(JobDetails,null),!1===isAdvanced&&external_kbnSharedDeps_React_default.a.createElement(StartDatafeedSwitch,{startDatafeed:startDatafeed,setStartDatafeed:setStartDatafeed,disabled:creatingJob}),isAdvanced&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHorizontalRule,null),external_kbnSharedDeps_React_default.a.createElement(DatafeedSectionTitle,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(DatafeedDetails,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHorizontalRule,null),showJobAssignWarning&&external_kbnSharedDeps_React_default.a.createElement(jobs_awaiting_node_warning.b,{jobType:"anomaly-detector"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,progress<100&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(PreviousButton,{previous:()=>setCurrentStep(WIZARD_STEPS.VALIDATION),previousActive:!1===creatingJob&&!0===isValid})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{onClick:async function(){setCreatingJob(!0),isAdvanced?await createAdvancedJob():!0===startDatafeed?await async function(){try{const jr=await jobCreator.createAndStartJob();setJobRunner(jr)}catch(error){handleJobCreationError(error)}}():await createAdvancedJob(!1)},isDisabled:!0===creatingJob||!1===isValid,"data-test-subj":"mlJobWizardButtonCreateJob",fill:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.summaryStep.createJobButton",defaultMessage:"Create job"})))),!1===creatingJob&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(JsonEditorFlyout,{isDisabled:progress>0,jobEditorMode:jsonEditorMode,datafeedEditorMode:jsonEditorMode})),!1===isAdvanced&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{onClick:()=>{Object(general.d)(jobCreator,navigateToPath)}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.summaryStep.convertToAdvancedButton",defaultMessage:"Convert to advanced job"})))),progress>0&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{onClick:function(){const url=job_service.a.createResultsUrl([jobCreator.jobId],jobCreator.start,jobCreator.end,!0===Object(job_creator.e)(jobCreator)?"timeseriesexplorer":"explorer");navigateToPath(`${basePath.get()}/app/ml/${url}`)},"data-test-subj":"mlJobWizardButtonViewResults"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.summaryStep.viewResultsButton",defaultMessage:"View results"})))),100===progress&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{onClick:function(){Object(general.l)(jobCreator,navigateToPath)},"data-test-subj":"mlJobWizardButtonResetJob"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.summaryStep.resetJobButton",defaultMessage:"Reset job"}))),external_kbnSharedDeps_React_default.a.createElement(PostSaveOptions,{jobRunner:jobRunner})))))},query_description_Description=Object(external_kbnSharedDeps_React_.memo)(({children:children})=>{const title=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.datafeedStep.query.title",{defaultMessage:"Elasticsearch query"});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:title,describedByIds:["description"],fullWidth:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,children))}),QueryInput=({setIsValidQuery:setIsValidQuery})=>{const{jobCreator:jc,jobCreatorUpdate:jobCreatorUpdate,jobCreatorUpdated:jobCreatorUpdated}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext),jobCreator=jc,[queryString,setQueryString]=Object(external_kbnSharedDeps_React_.useState)(JSON.stringify(jobCreator.query,null,2));return Object(external_kbnSharedDeps_React_.useEffect)(()=>{const validJson=Object(validation_utils.c)(queryString);setIsValidQuery(validJson),validJson&&(jobCreator.query=JSON.parse(queryString),jobCreatorUpdate())},[queryString]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{if(Object(validation_utils.c)(queryString)){const query=JSON.parse(queryString),newQueryString=JSON.stringify(query,null,2),actualQuery=JSON.stringify(jobCreator.query,null,2);newQueryString!==actualQuery&&setQueryString(actualQuery)}},[jobCreatorUpdated]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{const validJson=Object(validation_utils.c)(queryString);setIsValidQuery(validJson)},[]),external_kbnSharedDeps_React_default.a.createElement(query_description_Description,null,external_kbnSharedDeps_React_default.a.createElement(ml_job_editor.a,{value:queryString,height:"400px",readOnly:!1,onChange:function(qs){setQueryString(qs)}}))},query_delay_description_Description=Object(external_kbnSharedDeps_React_.memo)(({children:children,validation:validation})=>{const title=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.datafeedStep.queryDelay.title",{defaultMessage:"Query delay"});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescribedFormGroup,{title:external_kbnSharedDeps_React_default.a.createElement("h3",null,title),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.datafeedStep.queryDelay.description",defaultMessage:"Time delay in seconds, between current time and latest input data time."})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:title,error:validation.message,isInvalid:!1===validation.valid},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,children)))});function useStringifiedValue(initialValue){const[value,setValueInner]=Object(external_kbnSharedDeps_React_.useState)(stringify(initialValue));function stringify(f){return null===f?"":f}return{value:value,setValue:function(f){setValueInner(stringify(f))}}}const QueryDelayInput=()=>{const{jobCreator:jobCreator,jobCreatorUpdate:jobCreatorUpdate,jobValidator:jobValidator,jobValidatorUpdated:jobValidatorUpdated}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext),[validation,setValidation]=Object(external_kbnSharedDeps_React_.useState)(jobValidator.queryDelay),{value:queryDelay,setValue:setQueryDelay}=useStringifiedValue(jobCreator.queryDelay);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{jobCreator.queryDelay=""===queryDelay?null:queryDelay,jobCreatorUpdate()},[queryDelay]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{setQueryDelay(null===jobCreator.queryDelay?"":jobCreator.queryDelay)},[jobCreatorUpdate]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{setValidation(jobValidator.queryDelay)},[jobValidatorUpdated]),external_kbnSharedDeps_React_default.a.createElement(query_delay_description_Description,{validation:validation},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldText,{value:queryDelay,placeholder:new_job.d,onChange:e=>setQueryDelay(e.target.value),isInvalid:!1===validation.valid,"data-test-subj":"mlJobWizardInputQueryDelay"}))},frequency_description_Description=Object(external_kbnSharedDeps_React_.memo)(({children:children,validation:validation})=>{const title=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.datafeedStep.frequency.title",{defaultMessage:"Frequency"});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescribedFormGroup,{title:external_kbnSharedDeps_React_default.a.createElement("h3",null,title),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.datafeedStep.frequency.description",defaultMessage:"The interval between searches."})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:title,error:validation.message,isInvalid:!1===validation.valid},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,children)))}),FrequencyInput=()=>{const{jobCreator:jobCreator,jobCreatorUpdate:jobCreatorUpdate,jobCreatorUpdated:jobCreatorUpdated,jobValidator:jobValidator,jobValidatorUpdated:jobValidatorUpdated}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext),[validation,setValidation]=Object(external_kbnSharedDeps_React_.useState)(jobValidator.frequency),{value:frequency,setValue:setFrequency}=useStringifiedValue(jobCreator.frequency),[defaultFrequency,setDefaultFrequency]=Object(external_kbnSharedDeps_React_.useState)(createDefaultFrequency());function createDefaultFrequency(){return Object(job_utils.f)(jobCreator.bucketSpanMs/1e3)+"s"}return Object(external_kbnSharedDeps_React_.useEffect)(()=>{jobCreator.frequency=""===frequency?null:frequency,jobCreatorUpdate()},[frequency]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{setFrequency(jobCreator.frequency);const df=createDefaultFrequency();setDefaultFrequency(df)},[jobCreatorUpdated]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{setValidation(jobValidator.frequency)},[jobValidatorUpdated]),external_kbnSharedDeps_React_default.a.createElement(frequency_description_Description,{validation:validation},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldText,{value:frequency,placeholder:defaultFrequency,onChange:e=>setFrequency(e.target.value),isInvalid:!1===validation.valid,"data-test-subj":"mlJobWizardInputFrequency"}))},scroll_size_description_Description=Object(external_kbnSharedDeps_React_.memo)(({children:children,validation:validation})=>{const title=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.datafeedStep.scrollSize.title",{defaultMessage:"Scroll size"});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescribedFormGroup,{title:external_kbnSharedDeps_React_default.a.createElement("h3",null,title),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.datafeedStep.scrollSize.description",defaultMessage:"The maximum number of documents to return in each search request."})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:title,error:validation.message,isInvalid:!1===validation.valid},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,children)))}),ScrollSizeInput=()=>{const{jobCreator:jobCreator,jobCreatorUpdate:jobCreatorUpdate,jobValidator:jobValidator,jobValidatorUpdated:jobValidatorUpdated}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext),[validation,setValidation]=Object(external_kbnSharedDeps_React_.useState)(jobValidator.scrollSize),[scrollSizeString,setScrollSize]=Object(external_kbnSharedDeps_React_.useState)(null===jobCreator.scrollSize?"":""+jobCreator.scrollSize),{datafeeds:datafeeds}=Object(ml_server_info.b)(),scrollSizeDefault=void 0!==datafeeds.scroll_size?""+datafeeds.scroll_size:"";return Object(external_kbnSharedDeps_React_.useEffect)(()=>{jobCreator.scrollSize=""===scrollSizeString?null:+scrollSizeString,jobCreatorUpdate()},[scrollSizeString]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{setScrollSize(null===jobCreator.scrollSize?"":""+jobCreator.scrollSize)},[jobCreatorUpdate]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{setValidation(jobValidator.scrollSize)},[jobValidatorUpdated]),external_kbnSharedDeps_React_default.a.createElement(scroll_size_description_Description,{validation:validation},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldNumber,{min:0,placeholder:scrollSizeDefault,value:""===scrollSizeString?scrollSizeString:+scrollSizeString,onChange:e=>setScrollSize(e.target.value),isInvalid:!1===validation.valid,"data-test-subj":"mlJobWizardInputScrollSize"}))},ResetQueryButton=()=>{const{jobCreator:jobCreator,jobCreatorUpdate:jobCreatorUpdate}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext),[confirmModalVisible,setConfirmModalVisible]=Object(external_kbnSharedDeps_React_.useState)(!1),[defaultQueryString]=Object(external_kbnSharedDeps_React_.useState)(JSON.stringify(getDefaultDatafeedQuery(),null,2)),closeModal=()=>setConfirmModalVisible(!1);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,confirmModalVisible&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiConfirmModal,{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.datafeedStep.resetQueryConfirm.title",{defaultMessage:"Reset datafeed query"}),onCancel:closeModal,onConfirm:function(){jobCreator.query=getDefaultDatafeedQuery(),jobCreatorUpdate(),closeModal()},cancelButtonText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.datafeedStep.resetQueryConfirm.cancel",{defaultMessage:"Cancel"}),confirmButtonText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.datafeedStep.resetQueryConfirm.confirm",{defaultMessage:"Confirm"}),defaultFocusedButton:"confirm"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.datafeedStep.resetQueryConfirm.description",defaultMessage:"Set the datafeed query to be the default."}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCodeBlock,{language:"js",fontSize:"m",paddingSize:"s"},defaultQueryString)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{size:"s",onClick:()=>setConfirmModalVisible(!0)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.datafeedStep.resetQueryButton",defaultMessage:"Reset datafeed query to default"})))},TimeFieldSelect=({fields:fields,changeHandler:changeHandler,selectedField:selectedField})=>{const{jobCreator:jobCreator}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext),options=Object(general.g)(fields,jobCreator.additionalFields),selection=[];return null!==selectedField&&selection.push({label:selectedField}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiComboBox,{singleSelection:{asPlainText:!0},options:options,selectedOptions:selection,onChange:function(selectedOptions){const option=selectedOptions[0];void 0!==option&&changeHandler(option.label)},isClearable:!1,"data-test-subj":"mlTimeFieldNameSelect"})},time_field_description_Description=Object(external_kbnSharedDeps_React_.memo)(({children:children})=>{const title=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.datafeedStep.timeField.title",{defaultMessage:"Time field"});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescribedFormGroup,{title:external_kbnSharedDeps_React_default.a.createElement("h3",null,title),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.datafeedStep.timeField.description",defaultMessage:"The default time field for the index pattern is automatically selected, but can be overridden."})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:title},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,children)))}),TimeField=()=>{const{jobCreator:jc,jobCreatorUpdate:jobCreatorUpdate,jobCreatorUpdated:jobCreatorUpdated}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext),jobCreator=jc,{dateFields:dateFields}=new_job_capabilities_service.b,[timeFieldName,setTimeFieldName]=Object(external_kbnSharedDeps_React_.useState)(jobCreator.timeFieldName);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{jobCreator.timeFieldName=timeFieldName,jobCreatorUpdate()},[timeFieldName]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{setTimeFieldName(jobCreator.timeFieldName)},[jobCreatorUpdated]),external_kbnSharedDeps_React_default.a.createElement(time_field_description_Description,null,external_kbnSharedDeps_React_default.a.createElement(TimeFieldSelect,{fields:dateFields,changeHandler:setTimeFieldName,selectedField:timeFieldName}))},DatafeedStep=({setCurrentStep:setCurrentStep,isCurrentStep:isCurrentStep})=>{const{jobValidator:jobValidator,jobValidatorUpdated:jobValidatorUpdated}=Object(external_kbnSharedDeps_React_.useContext)(JobCreatorContext),[nextActive,setNextActive]=Object(external_kbnSharedDeps_React_.useState)(!1),[isValidQuery,setIsValidQuery]=Object(external_kbnSharedDeps_React_.useState)(!1);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{const active=isValidQuery&&jobValidator.queryDelay.valid&&jobValidator.frequency.valid&&jobValidator.scrollSize.valid&&!1===jobValidator.validating;setNextActive(active)},[jobValidatorUpdated,isValidQuery]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,isCurrentStep&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"xl"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{"data-test-subj":"mlAdvancedDatafeedQueryEditor"},external_kbnSharedDeps_React_default.a.createElement(QueryInput,{setIsValidQuery:setIsValidQuery})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(QueryDelayInput,null),external_kbnSharedDeps_React_default.a.createElement(FrequencyInput,null),external_kbnSharedDeps_React_default.a.createElement(ScrollSizeInput,null),external_kbnSharedDeps_React_default.a.createElement(TimeField,null))),external_kbnSharedDeps_React_default.a.createElement(ResetQueryButton,null),external_kbnSharedDeps_React_default.a.createElement(WizardNav,{next:()=>setCurrentStep(WIZARD_STEPS.PICK_FIELDS),nextActive:nextActive},external_kbnSharedDeps_React_default.a.createElement(JsonEditorFlyout,{isDisabled:!1,jobEditorMode:json_editor_flyout_EDITOR_MODE.EDITABLE,datafeedEditorMode:json_editor_flyout_EDITOR_MODE.EDITABLE}))))},WizardSteps=({currentStep:currentStep,setCurrentStep:setCurrentStep})=>{const mlContext=Object(ml.b)(),[advancedExpanded,setAdvancedExpanded]=Object(external_kbnSharedDeps_React_.useState)(!1),[additionalExpanded,setAdditionalExpanded]=Object(external_kbnSharedDeps_React_.useState)(!1);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,currentStep===WIZARD_STEPS.TIME_RANGE&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(Title,{"data-test-subj":"mlJobWizardStepTitleTimeRange"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.stepComponentWrapper.timeRangeTitle",defaultMessage:"Time range"})),external_kbnSharedDeps_React_default.a.createElement(TimeRangeStep,{isCurrentStep:currentStep===WIZARD_STEPS.TIME_RANGE,setCurrentStep:setCurrentStep})),currentStep===WIZARD_STEPS.ADVANCED_CONFIGURE_DATAFEED&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(Title,{"data-test-subj":"mlJobWizardStepTitleConfigureDatafeed"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.stepComponentWrapper.configureDatafeedTitle",defaultMessage:"Configure datafeed"})),external_kbnSharedDeps_React_default.a.createElement(DatafeedStep,{isCurrentStep:currentStep===WIZARD_STEPS.ADVANCED_CONFIGURE_DATAFEED,setCurrentStep:setCurrentStep})),currentStep===WIZARD_STEPS.PICK_FIELDS&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(Title,{"data-test-subj":"mlJobWizardStepTitlePickFields"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.stepComponentWrapper.pickFieldsTitle",defaultMessage:"Pick fields"})),external_kbnSharedDeps_React_default.a.createElement(PickFieldsStep,{isCurrentStep:currentStep===WIZARD_STEPS.PICK_FIELDS,setCurrentStep:setCurrentStep})),currentStep===WIZARD_STEPS.JOB_DETAILS&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(Title,{"data-test-subj":"mlJobWizardStepTitleJobDetails"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.stepComponentWrapper.jobDetailsTitle",defaultMessage:"Job details"})),external_kbnSharedDeps_React_default.a.createElement(JobDetailsStep,{isCurrentStep:currentStep===WIZARD_STEPS.JOB_DETAILS,setCurrentStep:setCurrentStep,advancedExpanded:advancedExpanded,setAdvancedExpanded:setAdvancedExpanded,additionalExpanded:additionalExpanded,setAdditionalExpanded:setAdditionalExpanded})),currentStep===WIZARD_STEPS.VALIDATION&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(Title,{"data-test-subj":"mlJobWizardStepTitleValidation"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.stepComponentWrapper.validationTitle",defaultMessage:"Validation"})),external_kbnSharedDeps_React_default.a.createElement(ValidationStep,{isCurrentStep:currentStep===WIZARD_STEPS.VALIDATION,setCurrentStep:setCurrentStep})),currentStep===WIZARD_STEPS.SUMMARY&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(Title,{"data-test-subj":"mlJobWizardStepTitleSummary"},null!==mlContext.currentSavedSearch?external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.stepComponentWrapper.summaryTitleSavedSearch",{defaultMessage:"New job from saved search {title}",values:{title:mlContext.currentSavedSearch.attributes.title}}):void 0!==mlContext.currentIndexPattern.id?external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.stepComponentWrapper.summaryTitleIndexPattern",{defaultMessage:"New job from index pattern {title}",values:{title:mlContext.currentIndexPattern.title}}):""),external_kbnSharedDeps_React_default.a.createElement(SummaryStep,{isCurrentStep:currentStep===WIZARD_STEPS.SUMMARY,setCurrentStep:setCurrentStep})))},Title=({"data-test-subj":dataTestSubj,children:children})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"s"},external_kbnSharedDeps_React_default.a.createElement("h2",{"data-test-subj":dataTestSubj},children)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null)),WizardHorizontalSteps=({currentStep:currentStep,highestStep:highestStep,setCurrentStep:setCurrentStep,disableSteps:disableSteps,jobType:jobType})=>{const stepsConfig=[{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.step.timeRangeTitle",{defaultMessage:"Time range"}),...createStepProps(WIZARD_STEPS.TIME_RANGE)},{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.step.pickFieldsTitle",{defaultMessage:"Pick fields"}),...createStepProps(WIZARD_STEPS.PICK_FIELDS)},{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.step.jobDetailsTitle",{defaultMessage:"Job details"}),...createStepProps(WIZARD_STEPS.JOB_DETAILS)},{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.step.validationTitle",{defaultMessage:"Validation"}),...createStepProps(WIZARD_STEPS.VALIDATION)},{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.step.summaryTitle",{defaultMessage:"Summary"}),...createStepProps(WIZARD_STEPS.SUMMARY)}];function createStepProps(step){return{onClick:()=>function(step){step<=highestStep&&setCurrentStep(step)}(step),isSelected:currentStep===step,isComplete:currentStep>step,disabled:disableSteps||highestStep<step}}return jobType===new_job.f.ADVANCED&&stepsConfig.splice(0,1,{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.step.configureDatafeedTitle",{defaultMessage:"Configure datafeed"}),...createStepProps(WIZARD_STEPS.ADVANCED_CONFIGURE_DATAFEED)}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiStepsHorizontal,{steps:stepsConfig,style:{backgroundColor:"inherit"}})},Wizard=({jobCreator:jobCreator,chartLoader:chartLoader,resultsLoader:resultsLoader,chartInterval:chartInterval,jobValidator:jobValidator,existingJobsAndGroups:existingJobsAndGroups,firstWizardStep:firstWizardStep=WIZARD_STEPS.TIME_RANGE})=>{const[jobCreatorUpdated,setJobCreatorUpdate]=Object(external_kbnSharedDeps_React_.useReducer)(s=>s+1,0),jobCreatorUpdate=()=>setJobCreatorUpdate(jobCreatorUpdated),[jobValidatorUpdated,setJobValidatorUpdate]=Object(external_kbnSharedDeps_React_.useReducer)(s=>s+1,0),jobCreatorContext={jobCreatorUpdated:jobCreatorUpdated,jobCreatorUpdate:jobCreatorUpdate,jobCreator:jobCreator,chartLoader:chartLoader,resultsLoader:resultsLoader,chartInterval:chartInterval,jobValidator:jobValidator,jobValidatorUpdated:jobValidatorUpdated,fields:new_job_capabilities_service.b.fields,aggs:new_job_capabilities_service.b.aggs,existingJobsAndGroups:existingJobsAndGroups},firstStep=jobCreator.type===new_job.f.ADVANCED?WIZARD_STEPS.ADVANCED_CONFIGURE_DATAFEED:WIZARD_STEPS.TIME_RANGE,[currentStep,setCurrentStep]=Object(external_kbnSharedDeps_React_.useState)(firstStep),[highestStep,setHighestStep]=Object(external_kbnSharedDeps_React_.useState)(firstStep),[disableSteps,setDisableSteps]=Object(external_kbnSharedDeps_React_.useState)(!1),[progress,setProgress]=Object(external_kbnSharedDeps_React_.useState)(resultsLoader.progress),[stringifiedConfigs,setStringifiedConfigs]=Object(external_kbnSharedDeps_React_.useState)(stringifyConfigs(jobCreator.jobConfig,jobCreator.datafeedConfig));return Object(external_kbnSharedDeps_React_.useEffect)(()=>{const subscription=jobValidator.validationResult$.subscribe(()=>{setJobValidatorUpdate(jobValidatorUpdated)});return()=>subscription.unsubscribe()},[]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{jobValidator.validate(()=>{setJobValidatorUpdate(jobValidatorUpdated)});const tempConfigs=stringifyConfigs(jobCreator.jobConfig,jobCreator.datafeedConfig);tempConfigs!==stringifiedConfigs&&(setHighestStep(currentStep),setStringifiedConfigs(tempConfigs))},[jobCreatorUpdated]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{jobCreator.subscribeToProgress(setProgress),setCurrentStep(firstWizardStep)},[]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{setDisableSteps(progress>0)},[progress]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{currentStep>=highestStep&&setHighestStep(currentStep)},[currentStep]),useModelMemoryEstimator(jobCreator,jobValidator,jobCreatorUpdate,jobCreatorUpdated),external_kbnSharedDeps_React_default.a.createElement(JobCreatorContext.Provider,{value:jobCreatorContext},external_kbnSharedDeps_React_default.a.createElement(WizardHorizontalSteps,{currentStep:currentStep,highestStep:highestStep,setCurrentStep:setCurrentStep,disableSteps:disableSteps,jobType:jobCreator.type}),external_kbnSharedDeps_React_default.a.createElement(WizardSteps,{currentStep:currentStep,setCurrentStep:setCurrentStep}))};function stringifyConfigs(jobConfig,datafeedConfig){return JSON.stringify(jobConfig)+JSON.stringify(datafeedConfig)}var memoize_one_cjs=__webpack_require__(247),memoize_one_cjs_default=__webpack_require__.n(memoize_one_cjs),results_service=__webpack_require__(128);function chart_loader_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}const eq=(newArgs,lastArgs)=>Object(external_kbnSharedDeps_Lodash_.isEqual)(newArgs,lastArgs),newJobLineChart=memoize_one_cjs_default()(ml_api_service.ml.jobs.newJobLineChart,eq),newJobPopulationsChart=memoize_one_cjs_default()(ml_api_service.ml.jobs.newJobPopulationsChart,eq),getEventRateData=memoize_one_cjs_default()(results_service.mlResultsService.getEventRateData,eq),chart_loader_getCategoryFields=memoize_one_cjs_default()((function(indexPatternName,fieldName,size,query,runtimeMappings,indicesOptions){return new Promise((resolve,reject)=>{ml_api_service.ml.esSearch({index:indexPatternName,size:0,body:{query:query,aggs:{catFields:{terms:{field:fieldName,size:size}}},...void 0!==runtimeMappings?{runtime_mappings:runtimeMappings}:{}},...null!=indicesOptions?indicesOptions:{}}).then(resp=>{const catFields=Object(external_kbnSharedDeps_Lodash_.get)(resp,["aggregations","catFields","buckets"],[]);resolve({success:!0,results:catFields.map(f=>f.key)})}).catch(resp=>{reject(resp)})})}),eq);class chart_loader_ChartLoader{constructor(indexPattern,query){chart_loader_defineProperty(this,"_indexPatternTitle",""),chart_loader_defineProperty(this,"_timeFieldName",""),chart_loader_defineProperty(this,"_query",{}),this._indexPatternTitle=indexPattern.title,this._query=query,"string"==typeof indexPattern.timeFieldName&&(this._timeFieldName=indexPattern.timeFieldName)}async loadLineCharts(start,end,aggFieldPairs,splitField,splitFieldValue,intervalMs,runtimeMappings,indicesOptions){if(""!==this._timeFieldName){if(!1===Object(general.b)(aggFieldPairs))return{};const splitFieldName=null!==splitField?splitField.name:null,aggFieldPairNames=aggFieldPairs.map(getAggFieldPairNames);return(await newJobLineChart(this._indexPatternTitle,this._timeFieldName,start,end,intervalMs,this._query,aggFieldPairNames,splitFieldName,splitFieldValue,null!=runtimeMappings?runtimeMappings:void 0,indicesOptions)).results}return{}}async loadPopulationCharts(start,end,aggFieldPairs,splitField,intervalMs,runtimeMappings,indicesOptions){if(""!==this._timeFieldName){if(!1===Object(general.b)(aggFieldPairs))return{};const splitFieldName=null!==splitField?splitField.name:"",aggFieldPairNames=aggFieldPairs.map(getAggFieldPairNames);return(await newJobPopulationsChart(this._indexPatternTitle,this._timeFieldName,start,end,intervalMs,this._query,aggFieldPairNames,splitFieldName,null!=runtimeMappings?runtimeMappings:void 0,indicesOptions)).results}return{}}async loadEventRateChart(start,end,intervalMs,runtimeMappings,indicesOptions){if(""!==this._timeFieldName){const resp=await getEventRateData(this._indexPatternTitle,this._query,this._timeFieldName,start,end,3*intervalMs,runtimeMappings,indicesOptions);if(void 0!==resp.error)throw resp.error;return Object.entries(resp.results).map(([time,value])=>({time:+time,value:value}))}return[]}async loadFieldExampleValues(field,runtimeMappings,indicesOptions){const{results:results}=await chart_loader_getCategoryFields(this._indexPatternTitle,field.name,10,this._query,null!=runtimeMappings?runtimeMappings:void 0,indicesOptions);return results}}function getAggFieldPairNames(af){const by=void 0!==af.by&&null!==af.by.field&&null!==af.by.value?{field:af.by.field.id,value:af.by.value}:{field:null,value:null};return{agg:af.agg.dslName||"",field:af.field.id,by:by}}var results_loader=__webpack_require__(414),time_buckets=__webpack_require__(90);const new_job_page_Page=({existingJobsAndGroups:existingJobsAndGroups,jobType:jobType})=>{const mlContext=Object(ml.b)(),jobCreator=Object(job_creator.f)(jobType)(mlContext.currentIndexPattern,mlContext.currentSavedSearch,mlContext.combinedQuery),{displayErrorToast:displayErrorToast}=Object(toast_notification_service.c)(),{from:from,to:to}=getTimeFilterRange();jobCreator.setTimeRange(from,to);let firstWizardStep=jobType===new_job.f.ADVANCED?WIZARD_STEPS.ADVANCED_CONFIGURE_DATAFEED:WIZARD_STEPS.TIME_RANGE,autoSetTimeRange=!1;if(void 0!==job_service.a.tempJobCloningObjects.job&&void 0!==job_service.a.tempJobCloningObjects.datafeed){const clonedJob=job_service.a.tempJobCloningObjects.job,clonedDatafeed=job_service.a.cloneDatafeed(job_service.a.tempJobCloningObjects.datafeed);initCategorizationSettings(),jobCreator.cloneFromExistingJob(clonedJob,clonedDatafeed),!1===job_service.a.tempJobCloningObjects.skipTimeRangeStep?jobCreator.jobId="":jobType!==new_job.f.ADVANCED&&(firstWizardStep=WIZARD_STEPS.PICK_FIELDS),job_service.a.tempJobCloningObjects.skipTimeRangeStep=!1,job_service.a.tempJobCloningObjects.job=void 0,job_service.a.tempJobCloningObjects.datafeed=void 0,job_service.a.tempJobCloningObjects.createdBy=void 0,void 0!==job_service.a.tempJobCloningObjects.start&&void 0!==job_service.a.tempJobCloningObjects.end?(jobCreator.setTimeRange(job_service.a.tempJobCloningObjects.start,job_service.a.tempJobCloningObjects.end),job_service.a.tempJobCloningObjects.start=void 0,job_service.a.tempJobCloningObjects.end=void 0):autoSetTimeRange=Object(job_creator.a)(jobCreator),job_service.a.tempJobCloningObjects.calendars&&(jobCreator.calendars=job_service.a.tempJobCloningObjects.calendars,job_service.a.tempJobCloningObjects.calendars=void 0)}else if(jobCreator.bucketSpan=new_job.b,jobCreator.type!==new_job.f.POPULATION&&jobCreator.type!==new_job.f.ADVANCED&&jobCreator.type!==new_job.f.CATEGORIZATION&&(jobCreator.modelMemoryLimit=new_job.c),jobCreator.type===new_job.f.SINGLE_METRIC&&(jobCreator.modelPlot=!0,jobCreator.modelChangeAnnotations=!0),null!==mlContext.currentSavedSearch&&(jobCreator.createdBy=null),autoSetTimeRange=Object(job_creator.a)(jobCreator),initCategorizationSettings(),Object(job_creator.b)(jobCreator)){const{catFields:catFields}=new_job_capabilities_service.b;1===catFields.length&&(jobCreator.categorizationFieldName=catFields[0].name)}function initCategorizationSettings(){if(Object(job_creator.b)(jobCreator)){const count=new_job_capabilities_service.b.getAggById("count"),rare=new_job_capabilities_service.b.getAggById("rare"),eventRate=new_job_capabilities_service.b.getFieldById(types_fields.a);jobCreator.setDefaultDetectorProperties(count,rare,eventRate);const{anomaly_detectors:anomalyDetectors}=Object(ml_server_info.b)();jobCreator.categorizationAnalyzer=anomalyDetectors.categorization_analyzer}}autoSetTimeRange&&Object(job_creator.a)(jobCreator)&&jobCreator.autoSetTimeRange().catch(error=>{const title=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.autoSetJobCreatorTimeRange.error",{defaultMessage:"Error retrieving beginning and end times of index"});displayErrorToast(error,title)});const chartInterval=Object(time_buckets.c)();chartInterval.setBarTarget(600),chartInterval.setMaxBars(1200),chartInterval.setInterval("auto");const chartLoader=new chart_loader_ChartLoader(mlContext.currentIndexPattern,mlContext.combinedQuery),jobValidator=new job_validator_JobValidator(jobCreator),resultsLoader=new results_loader.b(jobCreator,chartInterval,chartLoader);Object(external_kbnSharedDeps_React_.useEffect)(()=>()=>{jobCreator.forceStopRefreshPolls()});const jobCreatorTitle=Object(general.i)(jobCreator);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPage,{style:{backgroundColor:"inherit"},"data-test-subj":"mlPageJobWizard "+jobType},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageBody,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageContent,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageContentHeader,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageContentHeaderSection,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,null,external_kbnSharedDeps_React_default.a.createElement("h1",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.page.createJob",defaultMessage:"Create job"}),": ",jobCreatorTitle)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.page.createJob.indexPatternTitle",defaultMessage:"Using index pattern {index}",values:{index:jobCreator.indexPatternTitle}}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageContentBody,null,external_kbnSharedDeps_React_default.a.createElement(Wizard,{jobCreator:jobCreator,chartLoader:chartLoader,resultsLoader:resultsLoader,chartInterval:chartInterval,jobValidator:jobValidator,existingJobsAndGroups:existingJobsAndGroups,firstWizardStep:firstWizardStep}))))))};var new_job_capabilities_service_analytics=__webpack_require__(131);function loadNewJobCapabilities(indexPatternId,savedSearchId,indexPatterns,jobType){return new Promise(async(resolve,reject)=>{const serviceToUse="anomaly-detector"===jobType?new_job_capabilities_service.b:new_job_capabilities_service_analytics.a;if(void 0!==indexPatternId){const indexPattern=await indexPatterns.get(indexPatternId);await serviceToUse.initializeFromIndexPattern(indexPattern),resolve(serviceToUse.newJobCaps)}else if(void 0!==savedSearchId){const{indexPattern:indexPattern}=await Object(index_utils.a)(savedSearchId);if(null===indexPattern)return console.error("Cannot retrieve index pattern from saved search"),void reject();await serviceToUse.initializeFromIndexPattern(indexPattern),resolve(serviceToUse.newJobCaps)}else reject()})}function wizard_extends(){return(wizard_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const getBaseBreadcrumbs=(navigateToPath,basePath)=>[getBreadcrumbWithUrlForApp("ML_BREADCRUMB",navigateToPath,basePath),getBreadcrumbWithUrlForApp("ANOMALY_DETECTION_BREADCRUMB",navigateToPath,basePath),getBreadcrumbWithUrlForApp("CREATE_JOB_BREADCRUMB",navigateToPath,basePath)],getSingleMetricBreadcrumbs=(navigateToPath,basePath)=>[...getBaseBreadcrumbs(navigateToPath,basePath),{text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsBreadcrumbs.singleMetricLabel",{defaultMessage:"Single metric"}),href:""}],getMultiMetricBreadcrumbs=(navigateToPath,basePath)=>[...getBaseBreadcrumbs(navigateToPath,basePath),{text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsBreadcrumbs.multiMetricLabel",{defaultMessage:"Multi-metric"}),href:""}],getPopulationBreadcrumbs=(navigateToPath,basePath)=>[...getBaseBreadcrumbs(navigateToPath,basePath),{text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsBreadcrumbs.populationLabel",{defaultMessage:"Population"}),href:""}],getAdvancedBreadcrumbs=(navigateToPath,basePath)=>[...getBaseBreadcrumbs(navigateToPath,basePath),{text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsBreadcrumbs.advancedConfigurationLabel",{defaultMessage:"Advanced configuration"}),href:""}],getCategorizationBreadcrumbs=(navigateToPath,basePath)=>[...getBaseBreadcrumbs(navigateToPath,basePath),{text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsBreadcrumbs.categorizationLabel",{defaultMessage:"Categorization"}),href:""}],singleMetricRouteFactory=(navigateToPath,basePath)=>({path:"/jobs/new_job/single_metric",render:(props,deps)=>external_kbnSharedDeps_React_default.a.createElement(wizard_PageWrapper,wizard_extends({},props,{jobType:new_job.f.SINGLE_METRIC,deps:deps})),breadcrumbs:getSingleMetricBreadcrumbs(navigateToPath,basePath)}),multiMetricRouteFactory=(navigateToPath,basePath)=>({path:"/jobs/new_job/multi_metric",render:(props,deps)=>external_kbnSharedDeps_React_default.a.createElement(wizard_PageWrapper,wizard_extends({},props,{jobType:new_job.f.MULTI_METRIC,deps:deps})),breadcrumbs:getMultiMetricBreadcrumbs(navigateToPath,basePath)}),populationRouteFactory=(navigateToPath,basePath)=>({path:"/jobs/new_job/population",render:(props,deps)=>external_kbnSharedDeps_React_default.a.createElement(wizard_PageWrapper,wizard_extends({},props,{jobType:new_job.f.POPULATION,deps:deps})),breadcrumbs:getPopulationBreadcrumbs(navigateToPath,basePath)}),advancedRouteFactory=(navigateToPath,basePath)=>({path:"/jobs/new_job/advanced",render:(props,deps)=>external_kbnSharedDeps_React_default.a.createElement(wizard_PageWrapper,wizard_extends({},props,{jobType:new_job.f.ADVANCED,deps:deps})),breadcrumbs:getAdvancedBreadcrumbs(navigateToPath,basePath)}),categorizationRouteFactory=(navigateToPath,basePath)=>({path:"/jobs/new_job/categorization",render:(props,deps)=>external_kbnSharedDeps_React_default.a.createElement(wizard_PageWrapper,wizard_extends({},props,{jobType:new_job.f.CATEGORIZATION,deps:deps})),breadcrumbs:getCategorizationBreadcrumbs(navigateToPath,basePath)}),wizard_PageWrapper=({location:location,jobType:jobType,deps:deps})=>{const redirectToJobsManagementPage=Object(use_create_url.a)(ml_url_generator.b.ANOMALY_DETECTION_JOBS_MANAGE),{index:index,savedSearchId:savedSearchId}=Object(query_string.parse)(location.search,{sort:!1}),{context:context,results:results}=useResolver(index,savedSearchId,deps.config,{...basicResolvers(deps),privileges:()=>Object(check_capabilities.a)(redirectToJobsManagementPage),jobCaps:()=>loadNewJobCapabilities(index,savedSearchId,deps.indexPatterns,"anomaly-detector"),existingJobsAndGroups:job_service.a.getJobAndGroupIds});return external_kbnSharedDeps_React_default.a.createElement(PageLoader,{context:context},external_kbnSharedDeps_React_default.a.createElement(new_job_page_Page,{jobType:jobType,existingJobsAndGroups:results.existingJobsAndGroups}))},CreateResultCallout=Object(external_kbnSharedDeps_React_.memo)(({saveState:saveState,resultsUrl:resultsUrl,onReset:onReset})=>saveState===SAVE_STATE.NOT_SAVED?null:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,saveState===SAVE_STATE.SAVED&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.recognize.jobsCreatedTitle",defaultMessage:"Jobs created"}),color:"success",iconType:"checkInCircleFilled"}),saveState===SAVE_STATE.FAILED&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.simple.recognize.jobsCreationFailedTitle",defaultMessage:"Jobs creation failed"}),color:"danger",iconType:"alert"}),saveState===SAVE_STATE.PARTIAL_FAILURE&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.recognize.someJobsCreationFailedTitle",defaultMessage:"Some jobs failed to be created"}),color:"warning",iconType:"alert"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"flexEnd",alignItems:"center"},saveState!==SAVE_STATE.SAVING&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{color:"primary",fill:!1,"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.recognize.jobsCreationFailed.resetButtonAriaLabel",{defaultMessage:"Reset"}),onClick:onReset},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.recognize.someJobsCreationFailed.resetButtonLabel",defaultMessage:"Reset"}))),(saveState===SAVE_STATE.SAVED||saveState===SAVE_STATE.PARTIAL_FAILURE)&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{color:"primary",fill:!0,href:resultsUrl,"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.recognize.viewResultsAriaLabel",{defaultMessage:"View results"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.recognize.viewResultsLinkText",defaultMessage:"View results"})))))),KibanaObjects=Object(external_kbnSharedDeps_React_.memo)(({objectType:objectType,kibanaObjects:kibanaObjects,isSaving:isSaving})=>{const kibanaObjectLabels={dashboard:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.recognize.dashboardsLabel",{defaultMessage:"Dashboards"}),search:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.recognize.searchesLabel",{defaultMessage:"Searches"}),visualization:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.recognize.visualizationsLabel",{defaultMessage:"Visualizations"})};return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"s"},external_kbnSharedDeps_React_default.a.createElement("h4",null,kibanaObjectLabels[objectType])),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement("ul",null,kibanaObjects.map(({id:id,title:title,success:success,exists:exists,error:error},i)=>external_kbnSharedDeps_React_default.a.createElement("li",{key:id},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"xs"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"s",color:exists?"subdued":"secondary"},title),!1===success&&void 0!==error&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs",color:"danger"},Object(util_errors.i)(error))),exists&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs",color:"default"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.recognize.alreadyExistsLabel",defaultMessage:"(already exists)"}))))),!exists&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,style:{width:"60px"}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{textAlign:"center"},isSaving?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingSpinner,{size:"m"}):null,void 0!==success?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{type:success?"check":"cross",color:success?"success":"danger","aria-label":success?external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.recognize.results.savedAriaLabel",{defaultMessage:"Saved"}):external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.recognize.results.saveFailedAriaLabel",{defaultMessage:"Save failed"})}):null))),(1===kibanaObjects.length||i<kibanaObjects.length-1)&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHorizontalRule,{margin:"s"})))))}),JobItem=Object(external_kbnSharedDeps_React_.memo)(({job:job,jobOverride:jobOverride,isSaving:isSaving,jobPrefix:jobPrefix,onEditRequest:onEditRequest})=>{const{id:id,config:{description:description,groups:groups},datafeedResult:datafeedResult,setupResult:setupResult}=job,jobGroups=jobOverride&&jobOverride.groups||groups;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",gutterSize:"s",justifyContent:"spaceBetween",responsive:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"s",color:"secondary"},jobPrefix,id)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{position:"right",content:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.recognize.job.overrideJobConfigurationLabel",defaultMessage:"Override job configuration"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.recognize.job.overrideJobConfigurationLabel",{defaultMessage:"Override job configuration"}),iconType:"pencil",onClick:()=>onEditRequest(job)})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"s",color:"subdued"},description),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{wrap:!0,responsive:!1,gutterSize:"xs"},jobGroups.map(group=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,key:group},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBadge,{color:Object(group_color_utils.a)(group)},group)))),setupResult&&setupResult.error&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs",color:"danger"},Object(util_errors.i)(setupResult.error)),datafeedResult&&datafeedResult.error&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs",color:"danger"},Object(util_errors.i)(datafeedResult.error))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,style:{width:SETUP_RESULTS_WIDTH}},isSaving&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingSpinner,{size:"m"}),setupResult&&datafeedResult&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s",wrap:!1,responsive:!1,justifyContent:"spaceAround"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{type:setupResult.success?"check":"cross",color:setupResult.success?"secondary":"danger",size:"m","aria-label":setupResult.success?external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.recognize.job.savedAriaLabel",{defaultMessage:"Saved"}):external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.recognize.job.saveFailedAriaLabel",{defaultMessage:"Save failed"})})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{type:datafeedResult.success?"check":"cross",color:datafeedResult.success?"secondary":"danger",size:"m","aria-label":setupResult.success?external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.recognize.datafeed.savedAriaLabel",{defaultMessage:"Saved"}):external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.recognize.datafeed.saveFailedAriaLabel",{defaultMessage:"Save failed"})})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{type:getDatafeedStartedIcon(datafeedResult).type,color:getDatafeedStartedIcon(datafeedResult).color,size:"m","aria-label":setupResult.success?external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.recognize.running.startedAriaLabel",{defaultMessage:"Started"}):external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.recognize.running.startFailedAriaLabel",{defaultMessage:"Start failed"})})))))});function getDatafeedStartedIcon({awaitingMlNodeAllocation:awaitingMlNodeAllocation,success:success}){return!0===awaitingMlNodeAllocation?{type:"alert",color:"warning"}:success?{type:"check",color:"secondary"}:{type:"cross",color:"danger"}}function usePartialState(initialValue){const[state,setState]=Object(external_kbnSharedDeps_React_.useState)(initialValue);return[state,update=>{setState({...state,...update})}]}var validators=__webpack_require__(17);const EditJob=({job:job,jobOverride:jobOverride,existingGroupIds:existingGroupIds,onClose:onClose})=>{const[formState,setFormState]=usePartialState({jobGroups:jobOverride&&jobOverride.groups||job.config.groups}),[validationResult,setValidationResult]=Object(external_kbnSharedDeps_React_.useState)({}),groupValidator=Object(validators.a)(value=>Object(job_utils.i)(value)?null:{pattern:!0},Object(validators.b)(constants_validation.b));Object(external_kbnSharedDeps_React_.useEffect)(()=>{(()=>{const jobGroupsValidationResult=formState.jobGroups.map(group=>groupValidator(group)).filter(result=>null!==result);setValidationResult({jobGroups:jobGroupsValidationResult,formValid:0===jobGroupsValidationResult.length})})()},[formState.jobGroups]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyout,{onClose:()=>onClose(null)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyoutHeader,{hasBorder:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"m"},external_kbnSharedDeps_React_default.a.createElement("h2",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.recognize.overrideConfigurationHeader",defaultMessage:"Override configuration for {jobID}",values:{jobID:job.id}})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyoutBody,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiForm,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{fullWidth:!0},external_kbnSharedDeps_React_default.a.createElement(JobGroupsInput,{existingGroups:existingGroupIds,selectedGroups:formState.jobGroups,onChange:value=>{setFormState({jobGroups:value})},validation:{valid:!validationResult.jobGroups||0===validationResult.jobGroups.length,message:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.recognize.jobGroupAllowedCharactersDescription",defaultMessage:"Job group names can contain lowercase alphanumeric (a-z and 0-9), hyphens or underscores; must start and end with an alphanumeric character"})}}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyoutFooter,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{iconType:"cross",onClick:()=>onClose(null),flush:"left"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.recognize.cancelJobOverrideLabel",defaultMessage:"Close"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{onClick:()=>(()=>{const result={job_id:job.id,groups:formState.jobGroups};onClose(result)})(),fill:!0,disabled:!validationResult.formValid},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.recognize.saveJobOverrideLabel",defaultMessage:"Save"}))))))},SETUP_RESULTS_WIDTH="200px",ModuleJobs=({jobs:jobs,jobPrefix:jobPrefix,jobOverrides:jobOverrides,saveState:saveState,existingGroupIds:existingGroupIds,onJobOverridesChange:onJobOverridesChange})=>{const isSaving=saveState===SAVE_STATE.SAVING,[jobToEdit,setJobToEdit]=Object(external_kbnSharedDeps_React_.useState)(null),getJobOverride=job=>jobOverrides[job.id],editJobFlyout=null!==jobToEdit?external_kbnSharedDeps_React_default.a.createElement(EditJob,{job:jobToEdit,jobOverride:getJobOverride(jobToEdit),onClose:result=>{setJobToEdit(null),null!==result&&onJobOverridesChange(result)},existingGroupIds:existingGroupIds}):null;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"s"},external_kbnSharedDeps_React_default.a.createElement("h4",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.recognize.jobsTitle",defaultMessage:"Jobs"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),saveState!==SAVE_STATE.SAVING&&saveState!==SAVE_STATE.NOT_SAVED&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"flexEnd",responsive:!1,gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{style:{width:SETUP_RESULTS_WIDTH},grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceAround",responsive:!1,gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"s",textAlign:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.recognize.jobLabel",defaultMessage:"Job"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"s",textAlign:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.recognize.datafeedLabel",defaultMessage:"Datafeed"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"s",textAlign:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.recognize.runningLabel",defaultMessage:"Running"})))))),external_kbnSharedDeps_React_default.a.createElement("ul",null,jobs.map((job,i)=>external_kbnSharedDeps_React_default.a.createElement("li",{key:job.id},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(JobItem,{jobPrefix:jobPrefix,job:job,jobOverride:getJobOverride(job),isSaving:isSaving,onEditRequest:()=>setJobToEdit(job)}))),i<jobs.length-1&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHorizontalRule,{margin:"s"})))),editJobFlyout)};const JobSettingsForm=({onSubmit:onSubmit,onChange:onChange,saveState:saveState,jobs:jobs})=>{const{from:from,to:to}=getTimeFilterRange(),{currentIndexPattern:indexPattern}=Object(ml.b)(),jobPrefixValidator=Object(validators.a)(Object(validators.e)(/^([a-z0-9]+[a-z0-9\-_]*)?$/),Object(validators.b)(constants_validation.b-Math.max(...jobs.map(({id:id})=>id.length)))),[formState,setFormState]=usePartialState({jobPrefix:"",startDatafeedAfterSave:!0,useFullIndexData:!0,timeRange:{start:from,end:to},useDedicatedIndex:!1}),[validationResult,setValidationResult]=Object(external_kbnSharedDeps_React_.useState)({});return Object(external_kbnSharedDeps_React_.useEffect)(()=>{(()=>{const jobPrefixValidationResult=jobPrefixValidator(formState.jobPrefix);setValidationResult({jobPrefix:jobPrefixValidationResult,formValid:!jobPrefixValidationResult})})()},[formState.jobPrefix]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{onChange(formState)},[formState]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiForm,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescribedFormGroup,{title:external_kbnSharedDeps_React_default.a.createElement("h4",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.recognize.jobIdPrefixLabel",defaultMessage:"Job ID prefix"})),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.tooltips.newJobRecognizerJobPrefixTooltip",defaultMessage:"The prefix is added to the beginning of each job ID."})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.recognize.jobIdPrefixLabel",defaultMessage:"Job ID prefix"}),isInvalid:!!validationResult.jobPrefix,error:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,validationResult.jobPrefix&&validationResult.jobPrefix.maxLength?external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.recognize.jobPrefixInvalidMaxLengthErrorMessage",defaultMessage:"Job ID prefix must be no more than {maxLength, plural, one {# character} other {# characters}} long.",values:{maxLength:validationResult.jobPrefix.maxLength.requiredLength}})):null,validationResult.jobPrefix&&validationResult.jobPrefix.pattern&&external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.recognize.jobLabelAllowedCharactersDescription",defaultMessage:"Job label can contain lowercase alphanumeric (a-z and 0-9), hyphens or underscores; must start and end with an alphanumeric character"})))},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldText,{name:"jobPrefix",value:formState.jobPrefix,onChange:({target:{value:value}})=>(value=>{setFormState({jobPrefix:value&&value.toLowerCase()})})(value),isInvalid:!!validationResult.jobPrefix}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSwitch,{id:"startDataFeed",name:"startDataFeed",label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.recognize.startDatafeedAfterSaveLabel",defaultMessage:"Start datafeed after save"}),checked:formState.startDatafeedAfterSave,onChange:({target:{checked:checked}})=>{setFormState({startDatafeedAfterSave:checked})}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSwitch,{id:"useFullData",name:"useFullData",label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.recognize.useFullDataLabel",defaultMessage:"Use full {indexPatternTitle} data",values:{indexPatternTitle:indexPattern.title}}),checked:formState.useFullIndexData,onChange:({target:{checked:checked}})=>{setFormState({useFullIndexData:checked})}})),!formState.useFullIndexData&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(TimeRangePicker,{setTimeRange:value=>{setFormState({timeRange:value})},timeRange:formState.timeRange})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiAccordion,{id:"advancedOptions","aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.recognize.advancedSettingsAriaLabel",{defaultMessage:"Advanced settings"}),buttonContent:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.recognize.advancedLabel",defaultMessage:"Advanced"}),paddingSize:"l"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescribedFormGroup,{title:external_kbnSharedDeps_React_default.a.createElement("h4",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.recognize.useDedicatedIndexLabel",defaultMessage:"Use dedicated index"})),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.tooltips.newJobDedicatedIndexTooltip",defaultMessage:"Store results in a separate index for this job."})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{describedByIds:["ml_aria_label_new_job_dedicated_index"]},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSwitch,{id:"useDedicatedIndex",name:"useDedicatedIndex",checked:formState.useDedicatedIndex,onChange:({target:{checked:checked}})=>{setFormState({useDedicatedIndex:checked})},label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.recognize.useDedicatedIndexLabel",{defaultMessage:"Use dedicated index"})})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTextAlign,{textAlign:"right"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{fill:!0,type:"submit",isLoading:saveState===SAVE_STATE.SAVING,disabled:!validationResult.formValid||saveState===SAVE_STATE.SAVING,onClick:()=>{onSubmit(formState)},"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.recognize.createJobButtonAriaLabel",{defaultMessage:"Create job"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.recognize.createJobButtonLabel",defaultMessage:"Create {numberOfJobs, plural, zero {Job} one {Job} other {Jobs}}",values:{numberOfJobs:jobs.length}}))))};var time_format=__webpack_require__(130);let SAVE_STATE;!function(SAVE_STATE){SAVE_STATE[SAVE_STATE.NOT_SAVED=0]="NOT_SAVED",SAVE_STATE[SAVE_STATE.SAVING=1]="SAVING",SAVE_STATE[SAVE_STATE.SAVED=2]="SAVED",SAVE_STATE[SAVE_STATE.FAILED=3]="FAILED",SAVE_STATE[SAVE_STATE.PARTIAL_FAILURE=4]="PARTIAL_FAILURE"}(SAVE_STATE||(SAVE_STATE={}));const recognize_page_Page=({moduleId:moduleId,existingGroupIds:existingGroupIds})=>{const{services:{notifications:notifications}}=Object(contexts_kibana.b)(),urlGenerator=Object(contexts_kibana.d)(),[jobPrefix,setJobPrefix]=Object(external_kbnSharedDeps_React_.useState)(""),[jobs,setJobs]=Object(external_kbnSharedDeps_React_.useState)([]),[jobOverrides,setJobOverrides]=Object(external_kbnSharedDeps_React_.useState)({}),[kibanaObjects,setKibanaObjects]=Object(external_kbnSharedDeps_React_.useState)({}),[saveState,setSaveState]=Object(external_kbnSharedDeps_React_.useState)(SAVE_STATE.NOT_SAVED),[resultsUrl,setResultsUrl]=Object(external_kbnSharedDeps_React_.useState)(""),[existingGroups,setExistingGroups]=Object(external_kbnSharedDeps_React_.useState)(existingGroupIds),[jobsAwaitingNodeCount,setJobsAwaitingNodeCount]=Object(external_kbnSharedDeps_React_.useState)(0),{currentSavedSearch:savedSearch,currentIndexPattern:indexPattern,combinedQuery:combinedQuery}=Object(ml.b)(),pageTitle=null!==savedSearch?external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.recognize.savedSearchPageTitle",{defaultMessage:"saved search {savedSearchTitle}",values:{savedSearchTitle:savedSearch.attributes.title}}):external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.recognize.indexPatternPageTitle",{defaultMessage:"index pattern {indexPatternTitle}",values:{indexPatternTitle:indexPattern.title}}),displayQueryWarning=null!==savedSearch,tempQuery=null===savedSearch?void 0:combinedQuery,loadModule=async()=>{try{const response=await ml_api_service.ml.getDataRecognizerModule({moduleId:moduleId});setJobs(response.jobs);const kibanaObjectsResult=await(async objects=>{const savedObjectsClient=Object(dependency_cache.h)();try{return await Object.keys(objects).reduce(async(prevPromise,type)=>{const acc=await prevPromise,{savedObjects:savedObjects}=await savedObjectsClient.find({type:type,perPage:1e3});return acc[type]=objects[type].map(obj=>{const find=savedObjects.find(savedObject=>savedObject.attributes.title===obj.title);return{...obj,exists:!!find,id:!!find&&find.id||obj.id}}),Promise.resolve(acc)},Promise.resolve({}))}catch(e){console.error("Could not load saved objects",e)}return Promise.resolve(objects)})(response.kibana);setKibanaObjects(kibanaObjectsResult),setSaveState(SAVE_STATE.NOT_SAVED);const moduleGroups=[...response.jobs.map(j=>j.config.groups||[])].flat();setExistingGroups([...new Set([...existingGroups,...moduleGroups])])}catch(e){console.error(e)}};Object(external_kbnSharedDeps_React_.useEffect)(()=>{loadModule()},[]);const isFormVisible=[SAVE_STATE.NOT_SAVED,SAVE_STATE.SAVING].includes(saveState);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPage,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageBody,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageHeader,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageHeaderSection,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"l"},external_kbnSharedDeps_React_default.a.createElement("h3",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.recognize.newJobFromTitle",defaultMessage:"New job from {pageTitle}",values:{pageTitle:pageTitle}}))))),displayQueryWarning&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.recognize.searchWillBeOverwrittenLabel",defaultMessage:"Search will be overwritten"}),color:"warning",iconType:"alert"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.recognize.usingSavedSearchDescription",defaultMessage:"Using a saved search will mean the query used in the datafeeds will be different from the default ones we supply in the {moduleId} module.",values:{moduleId:moduleId}}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"})),jobsAwaitingNodeCount>0&&external_kbnSharedDeps_React_default.a.createElement(jobs_awaiting_node_warning.a,{jobCount:jobsAwaitingNodeCount}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{wrap:!0,gutterSize:"m"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPanel,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"s"},external_kbnSharedDeps_React_default.a.createElement("h4",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.recognize.jobSettingsTitle",defaultMessage:"Job settings"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),isFormVisible&&external_kbnSharedDeps_React_default.a.createElement(JobSettingsForm,{onSubmit:async formValues=>{setSaveState(SAVE_STATE.SAVING);const{jobPrefix:resultJobPrefix,startDatafeedAfterSave:startDatafeedAfterSave,useDedicatedIndex:useDedicatedIndex,useFullIndexData:useFullIndexData,timeRange:timeRange}=formValues,resultTimeRange=await(async(useFullIndexData,timeRange)=>{if(useFullIndexData){const runtimeMappings=indexPattern.getComputedFields().runtimeFields,{start:start,end:end}=await ml_api_service.ml.getTimeFieldRange({index:indexPattern.title,timeFieldName:indexPattern.timeFieldName,query:combinedQuery,...Object(object_utils.b)(runtimeMappings)?{runtimeMappings:runtimeMappings}:{}});return{start:start.epoch,end:end.epoch}}return Promise.resolve(timeRange)})(useFullIndexData,timeRange);try{let jobOverridesPayload=Object.values(jobOverrides);jobOverridesPayload=jobOverridesPayload.length>0?jobOverridesPayload:null;const response=await ml_api_service.ml.setupDataRecognizerConfig({moduleId:moduleId,prefix:resultJobPrefix,query:tempQuery,indexPatternName:indexPattern.title,useDedicatedIndex:useDedicatedIndex,startDatafeed:startDatafeedAfterSave,...null!==jobOverridesPayload?{jobOverrides:jobOverridesPayload}:{},...resultTimeRange}),{datafeeds:datafeedsResponse,jobs:jobsResponse,kibana:kibanaResponse}=response;setJobs(jobs.map(job=>({...job,datafeedResult:datafeedsResponse.find(({id:id})=>id.endsWith(job.id)),setupResult:jobsResponse.find(({id:id})=>id===resultJobPrefix+job.id)}))),setKibanaObjects(Object(external_kbnSharedDeps_Lodash_.merge)(kibanaObjects,kibanaResponse));const url=await urlGenerator.createUrl({page:ml_url_generator.b.ANOMALY_EXPLORER,pageState:{jobIds:jobsResponse.filter(({success:success})=>success).map(({id:id})=>id),timeRange:{from:external_kbnSharedDeps_Moment_default()(resultTimeRange.start).format(time_format.a),to:external_kbnSharedDeps_Moment_default()(resultTimeRange.end).format(time_format.a),mode:"absolute"}}});setResultsUrl(url);const failedJobsCount=jobsResponse.reduce((count,{success:success})=>success?count:count+1,0),lazyJobsCount=datafeedsResponse.reduce((count,{awaitingMlNodeAllocation:awaitingMlNodeAllocation})=>!0===awaitingMlNodeAllocation?count+1:count,0);setJobsAwaitingNodeCount(lazyJobsCount),setSaveState(0===failedJobsCount?SAVE_STATE.SAVED:failedJobsCount===jobs.length?SAVE_STATE.FAILED:SAVE_STATE.PARTIAL_FAILURE)}catch(e){setSaveState(SAVE_STATE.FAILED),console.error("Error setting up module",e);const{toasts:toasts}=notifications;toasts.addDanger({title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.recognize.moduleSetupFailedWarningTitle",{defaultMessage:"Error setting up module {moduleId}",values:{moduleId:moduleId}}),text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.recognize.moduleSetupFailedWarningDescription",{defaultMessage:"An error occurred trying to create the {count, plural, one {job} other {jobs}} in the module.",values:{count:jobs.length}})})}},onChange:formValues=>{setJobPrefix(formValues.jobPrefix)},saveState:saveState,jobs:jobs}),external_kbnSharedDeps_React_default.a.createElement(CreateResultCallout,{saveState:saveState,resultsUrl:resultsUrl,onReset:loadModule}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:2},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPanel,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(ModuleJobs,{jobs:jobs,jobPrefix:jobPrefix,saveState:saveState,existingGroupIds:existingGroups,jobOverrides:jobOverrides,onJobOverridesChange:job=>{if(setJobOverrides({...jobOverrides,[job.job_id]:job}),void 0!==job.groups){const groups=[...new Set([...existingGroups,...job.groups])];setExistingGroups(groups)}}})),Object.keys(kibanaObjects).length>0&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPanel,{grow:!1},Object.keys(kibanaObjects).map((objectType,i)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,{key:objectType},external_kbnSharedDeps_React_default.a.createElement(KibanaObjects,{objectType:objectType,kibanaObjects:kibanaObjects[objectType],isSaving:saveState===SAVE_STATE.SAVING}),i<Object.keys(kibanaObjects).length-1&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}))))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"})))};var use_create_ad_links=__webpack_require__(242);function recognize_extends(){return(recognize_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const recognizeRouteFactory=(navigateToPath,basePath)=>({path:"/jobs/new_job/recognize",render:(props,deps)=>external_kbnSharedDeps_React_default.a.createElement(recognize_PageWrapper,recognize_extends({},props,{deps:deps})),breadcrumbs:[getBreadcrumbWithUrlForApp("ML_BREADCRUMB",navigateToPath,basePath),getBreadcrumbWithUrlForApp("ANOMALY_DETECTION_BREADCRUMB",navigateToPath,basePath),getBreadcrumbWithUrlForApp("CREATE_JOB_BREADCRUMB",navigateToPath,basePath),{text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsBreadcrumbs.selectIndexOrSearchLabelRecognize",{defaultMessage:"Recognized index"}),href:""}]}),checkViewOrCreateRouteFactory=()=>({path:"/modules/check_view_or_create",render:(props,deps)=>external_kbnSharedDeps_React_default.a.createElement(CheckViewOrCreateWrapper,recognize_extends({},props,{deps:deps})),breadcrumbs:[]}),recognize_PageWrapper=({location:location,deps:deps})=>{const{id:id,index:index,savedSearchId:savedSearchId}=Object(query_string.parse)(location.search,{sort:!1}),{context:context,results:results}=useResolver(index,savedSearchId,deps.config,{...basicResolvers(deps),existingJobsAndGroups:job_service.a.getJobAndGroupIds});return external_kbnSharedDeps_React_default.a.createElement(PageLoader,{context:context},external_kbnSharedDeps_React_default.a.createElement(recognize_page_Page,{moduleId:id,existingGroupIds:results.existingJobsAndGroups.groupIds}))},CheckViewOrCreateWrapper=({location:location,deps:deps})=>{const{id:moduleId,index:indexPatternId}=Object(query_string.parse)(location.search,{sort:!1}),{createLinkWithUserDefaults:createLinkWithUserDefaults}=Object(use_create_ad_links.a)(),navigateToPath=Object(contexts_kibana.e)();return useResolver(void 0,void 0,deps.config,{checkViewOrCreateJobs:()=>function(moduleId,indexPatternId,createLinkWithUserDefaults,navigateToPath){return new Promise((resolve,reject)=>{ml_api_service.ml.dataRecognizerModuleJobsExist({moduleId:moduleId}).then(async resp=>{if(!0===resp.jobsExist){const url=createLinkWithUserDefaults("explorer",resp.jobs);await navigateToPath(url),reject()}else await navigateToPath(`/jobs/new_job/recognize?id=${moduleId}&index=${indexPatternId}`),reject()}).catch(async err=>{console.error(`Error checking whether jobs in module ${moduleId} exists`,err);Object(dependency_cache.j)().addWarning({title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.recognize.moduleCheckJobsExistWarningTitle",{defaultMessage:"Error checking module {moduleId}",values:{moduleId:moduleId}}),text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.recognize.moduleCheckJobsExistWarningDescription",{defaultMessage:"An error occurred trying to check whether the jobs in the module have been created."})}),await navigateToPath("/jobs"),reject()})})}(moduleId,indexPatternId,createLinkWithUserDefaults,navigateToPath)}),null};var navigation_menu=__webpack_require__(100),help_menu=__webpack_require__(104);const DatavisualizerSelector=()=>{Object(contexts_kibana.g)({timeRangeSelector:!1,autoRefreshSelector:!1});const{services:{licenseManagement:licenseManagement,http:{basePath:basePath},docLinks:docLinks,fileDataVisualizer:fileDataVisualizer}}=Object(contexts_kibana.b)(),helpLink=docLinks.links.ml.guide,navigateToPath=Object(contexts_kibana.e)(),startTrialVisible=void 0!==licenseManagement&&!0===licenseManagement.enabled&&!1===Object(license.d)();if(void 0===fileDataVisualizer)return console.error("File data visualizer plugin not available"),null;const maxFileSize=fileDataVisualizer.getMaxBytesFormatted();return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(navigation_menu.a,{tabId:"datavisualizer"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPage,{restrictWidth:1e3,"data-test-subj":"mlPageDataVisualizerSelector"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageBody,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"xl"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"l"},external_kbnSharedDeps_React_default.a.createElement("h1",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.datavisualizer.selector.dataVisualizerTitle",defaultMessage:"Data Visualizer"}))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"xl"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"xl"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{color:"subdued"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.datavisualizer.selector.dataVisualizerDescription",defaultMessage:"The Machine Learning Data Visualizer tool helps you understand your data, by analyzing the metrics and fields in a log file or an existing Elasticsearch index."})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"xl"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceAround",gutterSize:"xl"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCard,{icon:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{size:"xxl",type:"addDataApp"}),title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.datavisualizer.selector.importDataTitle",defaultMessage:"Import data"}),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.datavisualizer.selector.importDataDescription",defaultMessage:"Import data from a log file. You can upload files up to {maxFileSize}.",values:{maxFileSize:maxFileSize}}),betaBadgeLabel:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.datavisualizer.selector.experimentalBadgeLabel",{defaultMessage:"Experimental"}),betaBadgeTooltipContent:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.datavisualizer.selector.experimentalBadgeTooltipLabel",defaultMessage:"Experimental feature. We'd love to hear your feedback."}),footer:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{target:"_self",onClick:()=>navigateToPath("/filedatavisualizer"),"data-test-subj":"mlDataVisualizerUploadFileButton"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.datavisualizer.selector.uploadFileButtonLabel",defaultMessage:"Select file"})),"data-test-subj":"mlDataVisualizerCardImportData"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCard,{icon:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{size:"xxl",type:"dataVisualizer"}),title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.datavisualizer.selector.selectIndexPatternTitle",defaultMessage:"Select an index pattern"}),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.datavisualizer.selector.selectIndexPatternDescription",defaultMessage:"Visualize the data in an existing Elasticsearch index."}),footer:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{target:"_self",onClick:()=>navigateToPath("/datavisualizer_index_select"),"data-test-subj":"mlDataVisualizerSelectIndexButton"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.datavisualizer.selector.selectIndexButtonLabel",defaultMessage:"Select index pattern"})),"data-test-subj":"mlDataVisualizerCardIndexData"}))),!0===startTrialVisible&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"xxl"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"xxl"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceAround",gutterSize:"xl"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,style:{width:"600px"}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCard,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.datavisualizer.selector.startTrialTitle",defaultMessage:"Start trial"}),description:external_kbnSharedDeps_React_default.a.createElement("span",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.datavisualizer.startTrial.fullMLFeaturesDescription",defaultMessage:"To experience the full Machine Learning features that a {subscriptionsLink} offers, start a 30-day trial.",values:{subscriptionsLink:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{href:"https://www.elastic.co/subscriptions",target:"_blank"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.datavisualizer.startTrial.subscriptionsLinkText",defaultMessage:"Platinum or Enterprise subscription"}))}})),footer:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{target:"_blank",href:basePath.get()+"/app/management/stack/license_management/home","data-test-subj":"mlDataVisualizerStartTrialButton"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.datavisualizer.selector.startTrialButtonLabel",defaultMessage:"Start trial"})),"data-test-subj":"mlDataVisualizerCardStartTrial"})))))),external_kbnSharedDeps_React_default.a.createElement(help_menu.a,{docLink:helpLink}))};function datavisualizer_extends(){return(datavisualizer_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const selectorRouteFactory=(navigateToPath,basePath)=>({path:"/datavisualizer",render:(props,deps)=>external_kbnSharedDeps_React_default.a.createElement(datavisualizer_PageWrapper,datavisualizer_extends({},props,{deps:deps})),breadcrumbs:[getBreadcrumbWithUrlForApp("ML_BREADCRUMB",navigateToPath,basePath),getBreadcrumbWithUrlForApp("DATA_VISUALIZER_BREADCRUMB",navigateToPath,basePath)]}),datavisualizer_PageWrapper=({location:location,deps:deps})=>{const{redirectToMlAccessDeniedPage:redirectToMlAccessDeniedPage}=deps,{context:context}=useResolver(void 0,void 0,deps.config,{checkBasicLicense:license.a,checkFindFileStructurePrivilege:()=>Object(check_capabilities.b)(redirectToMlAccessDeniedPage)});return external_kbnSharedDeps_React_default.a.createElement(PageLoader,{context:context},external_kbnSharedDeps_React_default.a.createElement(DatavisualizerSelector,null))};var date_picker_wrapper=__webpack_require__(184);function kbnTypeToMLJobType(field){let type;switch(field.type){case data_public_.KBN_FIELD_TYPES.STRING:type=field.aggregatable?field_types.c.KEYWORD:field_types.c.TEXT;break;case data_public_.KBN_FIELD_TYPES.NUMBER:type=field_types.c.NUMBER;break;case data_public_.KBN_FIELD_TYPES.DATE:type=field_types.c.DATE;break;case data_public_.KBN_FIELD_TYPES.IP:type=field_types.c.IP;break;case data_public_.KBN_FIELD_TYPES.BOOLEAN:type=field_types.c.BOOLEAN;break;case data_public_.KBN_FIELD_TYPES.GEO_POINT:type=field_types.c.GEO_POINT;break;case data_public_.KBN_FIELD_TYPES.GEO_SHAPE:type=field_types.c.GEO_SHAPE}return type}const mlJobTypeAriaLabels={BOOLEAN:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.fieldTypeIcon.booleanTypeAriaLabel",{defaultMessage:"boolean type"}),DATE:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.fieldTypeIcon.dateTypeAriaLabel",{defaultMessage:"date type"}),GEO_POINT:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.fieldTypeIcon.geoPointTypeAriaLabel",{defaultMessage:"{geoPointParam} type",values:{geoPointParam:"geo point"}}),IP:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.fieldTypeIcon.ipTypeAriaLabel",{defaultMessage:"ip type"}),KEYWORD:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.fieldTypeIcon.keywordTypeAriaLabel",{defaultMessage:"keyword type"}),NUMBER:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.fieldTypeIcon.numberTypeAriaLabel",{defaultMessage:"number type"}),TEXT:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.fieldTypeIcon.textTypeAriaLabel",{defaultMessage:"text type"}),UNKNOWN:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.fieldTypeIcon.unknownTypeAriaLabel",{defaultMessage:"unknown type"})};var discover_public_=__webpack_require__(60);const ActionsPanel=({indexPattern:indexPattern,searchString:searchString,searchQueryLanguage:searchQueryLanguage})=>{const[recognizerResultsCount,setRecognizerResultsCount]=Object(external_kbnSharedDeps_React_.useState)(0),[discoverLink,setDiscoverLink]=Object(external_kbnSharedDeps_React_.useState)(""),{services:{application:{capabilities:capabilities},share:{urlGenerators:{getUrlGenerator:getUrlGenerator}}}}=Object(contexts_kibana.b)(),[globalState]=Object(url_state.c)("_g"),recognizerResults={count:0,onChange(){setRecognizerResultsCount(recognizerResults.count)}},mlAvailable=Object(license.d)()&&Object(check_capabilities.e)("canCreateJob")&&Object(ml_nodes_check.d)(),showCreateAnomalyDetectionJob=mlAvailable&&void 0!==indexPattern.timeFieldName,createJobLink=Object(contexts_kibana.c)({page:ml_url_generator.b.ANOMALY_DETECTION_CREATE_JOB_ADVANCED,pageState:{index:indexPattern.id}}),createDataFrameAnalyticsLink=Object(contexts_kibana.c)({page:ml_url_generator.b.DATA_FRAME_ANALYTICS_CREATE_JOB,pageState:{index:indexPattern.id}});return Object(external_kbnSharedDeps_React_.useEffect)(()=>{let unmounted=!1;const indexPatternId=indexPattern.id;return(async()=>{var _capabilities$discove,_capabilities$discove2;if(!(null!==(_capabilities$discove=null===(_capabilities$discove2=capabilities.discover)||void 0===_capabilities$discove2?void 0:_capabilities$discove2.show)&&void 0!==_capabilities$discove&&_capabilities$discove))return;const state={indexPatternId:indexPatternId};let discoverUrlGenerator;searchString&&void 0!==searchQueryLanguage&&(state.query={query:searchString,language:searchQueryLanguage}),null!=globalState&&globalState.time&&(state.timeRange=globalState.time),null!=globalState&&globalState.refreshInterval&&(state.refreshInterval=globalState.refreshInterval);try{discoverUrlGenerator=getUrlGenerator(discover_public_.DISCOVER_APP_URL_GENERATOR)}catch(error){return}const discoverUrl=await discoverUrlGenerator.createUrl(state);unmounted||setDiscoverLink(discoverUrl)})(),()=>{unmounted=!0}},[indexPattern,searchString,searchQueryLanguage,globalState]),external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":"mlDataVisualizerActionsPanel"},mlAvailable&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"s"},external_kbnSharedDeps_React_default.a.createElement("h2",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.datavisualizer.actionsPanel.createJobTitle",defaultMessage:"Create job"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),showCreateAnomalyDetectionJob&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement("div",{hidden:0===recognizerResultsCount},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"l",responsive:!0,wrap:!0},external_kbnSharedDeps_React_default.a.createElement(data_recognizer_DataRecognizer,{indexPattern:indexPattern,savedSearch:null,results:recognizerResults})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(LinkCard,{href:createJobLink,icon:"createAdvancedJob",title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.datavisualizer.actionsPanel.advancedTitle",{defaultMessage:"Advanced anomaly detection"}),description:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.datavisualizer.actionsPanel.advancedDescription",{defaultMessage:"Create a job with the full range of options for more advanced use cases."}),"data-test-subj":"mlDataVisualizerCreateAdvancedJobCard"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}))),mlAvailable&&void 0!==indexPattern.id&&createDataFrameAnalyticsLink&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(LinkCard,{href:createDataFrameAnalyticsLink,icon:"classificationJob",description:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.datavisualizer.actionsPanel.dataframeTypesDescription",{defaultMessage:"Create outlier detection, regression, or classification analytics."}),title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.datavisualizer.actionsPanel.dataframeAnalyticsTitle",defaultMessage:"Data frame analytics"}),"data-test-subj":"mlDataVisualizerCreateDataFrameAnalyticsCard"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"})),discoverLink&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"s"},external_kbnSharedDeps_React_default.a.createElement("h2",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.datavisualizer.actionsPanel.exploreTitle",defaultMessage:"Explore your data"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(LinkCard,{href:discoverLink,icon:"discoverApp",description:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.datavisualizer.actionsPanel.viewIndexInDiscoverDescription",{defaultMessage:"Explore the documents in your index."}),title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.datavisualizer.actionsPanel.discoverAppTitle",defaultMessage:"Discover"}),"data-test-subj":"mlDataVisualizerViewInDiscoverCard"})))},searchSizeOptions=[1e3,5e3,1e4,1e5,-1].map(v=>({value:String(v),inputDisplay:v>0?external_kbnSharedDeps_React_default.a.createElement("span",{"data-test-subj":"mlDataVisualizerShardSizeOption "+v},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.datavisualizer.searchPanel.sampleSizeOptionLabel",defaultMessage:"Sample size (per shard): {wrappedValue}",values:{wrappedValue:external_kbnSharedDeps_React_default.a.createElement("b",null,v)}})):external_kbnSharedDeps_React_default.a.createElement("span",{"data-test-subj":"mlDataVisualizerShardSizeOption all"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.datavisualizer.searchPanel.allOptionLabel",defaultMessage:"Search all"}))})),ShardSizeFilter=({samplerShardSize:samplerShardSize,setSamplerShardSize:setSamplerShardSize})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,style:{width:270}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSuperSelect,{options:searchSizeOptions,valueOfSelected:String(samplerShardSize),onChange:value=>setSamplerShardSize(+value),"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.datavisualizer.searchPanel.sampleSizeAriaLabel",{defaultMessage:"Select number of documents to sample"}),"data-test-subj":"mlDataVisualizerShardSizeSelect"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIconTip,{content:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.datavisualizer.searchPanel.queryBarPlaceholder",{defaultMessage:"Selecting a smaller sample size will reduce query run times and the load on the cluster."}),position:"right"}))),NoFilterItems=()=>external_kbnSharedDeps_React_default.a.createElement("div",{className:"euiFilterSelect__note"},external_kbnSharedDeps_React_default.a.createElement("div",{className:"euiFilterSelect__noteContent"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{type:"minusInCircle"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.multiSelectPicker.NoFiltersFoundMessage",defaultMessage:"No filters found"})))),MultiSelectPicker=({options:options,onChange:onChange,title:title,checkedOptions:checkedOptions,dataTestSubj:dataTestSubj})=>{const[items,setItems]=Object(external_kbnSharedDeps_React_.useState)(options),[searchTerm,setSearchTerm]=Object(external_kbnSharedDeps_React_.useState)("");Object(external_kbnSharedDeps_React_.useEffect)(()=>{if(""===searchTerm)setItems(options);else{const filteredOptions=options.filter(o=>{var _o$value;return null==o||null===(_o$value=o.value)||void 0===_o$value?void 0:_o$value.includes(searchTerm)});setItems(filteredOptions)}},[options,searchTerm]);const[isPopoverOpen,setIsPopoverOpen]=Object(external_kbnSharedDeps_React_.useState)(!1),button=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFilterButton,{"data-test-subj":dataTestSubj+"-button",iconType:"arrowDown",onClick:()=>{setIsPopoverOpen(!isPopoverOpen)},isSelected:isPopoverOpen,numFilters:items.length,hasActiveFilters:checkedOptions&&checkedOptions.length>0,numActiveFilters:checkedOptions&&checkedOptions.length},title);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFilterGroup,{"data-test-subj":dataTestSubj},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopover,{ownFocus:!0,"data-test-subj":dataTestSubj+"-popover",button:button,isOpen:isPopoverOpen,closePopover:()=>{setIsPopoverOpen(!1)},panelPaddingSize:"none"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopoverTitle,{paddingSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldSearch,{compressed:!0,onChange:e=>setSearchTerm(e.target.value),"data-test-subj":dataTestSubj+"-searchInput"})),external_kbnSharedDeps_React_default.a.createElement("div",{style:{maxHeight:250,overflow:"auto"}},Array.isArray(items)&&items.length>0?items.map((item,index)=>{var _item$name;const checked=checkedOptions&&checkedOptions.findIndex(fieldValue=>fieldValue===item.value)>-1;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFilterSelectItem,{checked:checked?"on":void 0,key:index,onClick:()=>(index=>{if(!items[index]||!Array.isArray(checkedOptions)||void 0===onChange)return;const item=items[index],foundIndex=checkedOptions.findIndex(fieldValue=>fieldValue===item.value);onChange(foundIndex>-1?checkedOptions.filter((_,idx)=>idx!==foundIndex):[...checkedOptions,item.value])})(index),style:{flexDirection:"row"},"data-test-subj":`${dataTestSubj}-option-${item.value}${checked?"-checked":""}`},null!==(_item$name=item.name)&&void 0!==_item$name?_item$name:item.value)}):external_kbnSharedDeps_React_default.a.createElement(NoFilterItems,null))))},DataVisualizerFieldNamesFilter=({overallStats:overallStats,setVisibleFieldNames:setVisibleFieldNames,visibleFieldNames:visibleFieldNames,showEmptyFields:showEmptyFields})=>{const items=Object(external_kbnSharedDeps_React_.useMemo)(()=>{const options=[];return overallStats&&Object.keys(overallStats).forEach(key=>{const fieldsGroup=overallStats[key];Array.isArray(fieldsGroup)&&fieldsGroup.length>0&&fieldsGroup.forEach(field=>{!0!==field.existsInDocs&&!0!==showEmptyFields||void 0===field.fieldName||options.push({value:field.fieldName})})}),options},[overallStats]),fieldNameTitle=Object(external_kbnSharedDeps_React_.useMemo)(()=>external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataVisualizer.indexBased.fieldNameSelect",{defaultMessage:"Field name"}),[]);return external_kbnSharedDeps_React_default.a.createElement(MultiSelectPicker,{title:fieldNameTitle,options:items,onChange:setVisibleFieldNames,checkedOptions:visibleFieldNames,dataTestSubj:"mlDataVisualizerFieldNameSelect"})};function field_type_icon_extends(){return(field_type_icon_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const FieldTypeIcon=({tooltipEnabled:tooltipEnabled=!1,type:type,fieldName:fieldName,needsAria:needsAria=!0})=>{const ariaLabel=(type=>{const requestedFieldType=Object.keys(field_types.c).find(k=>field_types.c[k]===type);return void 0===requestedFieldType?null:mlJobTypeAriaLabels[requestedFieldType]})(type);let iconType="questionInCircle",color="euiColorVis6";switch(type){case field_types.c.BOOLEAN:iconType="tokenBoolean",color="euiColorVis5";break;case field_types.c.DATE:iconType="tokenDate",color="euiColorVis7";break;case field_types.c.GEO_POINT:case field_types.c.GEO_SHAPE:iconType="tokenGeo",color="euiColorVis8";break;case field_types.c.TEXT:iconType="document",color="euiColorVis9";break;case field_types.c.IP:iconType="tokenIP",color="euiColorVis3";break;case field_types.c.KEYWORD:iconType="tokenText",color="euiColorVis0";break;case field_types.c.NUMBER:iconType="tokenNumber",color=void 0!==fieldName?"euiColorVis1":"euiColorVis2";break;case field_types.c.UNKNOWN:}const containerProps={ariaLabel:ariaLabel,iconType:iconType,color:color,needsAria:needsAria};return!0===tooltipEnabled?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{position:"left",content:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.fieldTypeIcon.fieldTypeTooltip",{defaultMessage:"{type} type",values:{type:type}})},external_kbnSharedDeps_React_default.a.createElement(FieldTypeIconContainer,containerProps)):external_kbnSharedDeps_React_default.a.createElement(FieldTypeIconContainer,containerProps)},FieldTypeIconContainer=({ariaLabel:ariaLabel,iconType:iconType,color:color,needsAria:needsAria,...rest})=>{const wrapperProps={className:"field-type-icon"};return needsAria&&ariaLabel&&(wrapperProps["aria-label"]=ariaLabel),external_kbnSharedDeps_React_default.a.createElement("span",field_type_icon_extends({"data-test-subj":"mlFieldTypeIcon"},rest),external_kbnSharedDeps_React_default.a.createElement("span",wrapperProps,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToken,{iconType:iconType,shape:"square",size:"s",color:color})))},ML_JOB_FIELD_TYPES_OPTIONS={[field_types.c.BOOLEAN]:{name:"Boolean",icon:"tokenBoolean"},[field_types.c.DATE]:{name:"Date",icon:"tokenDate"},[field_types.c.GEO_POINT]:{name:"Geo point",icon:"tokenGeo"},[field_types.c.GEO_SHAPE]:{name:"Geo shape",icon:"tokenGeo"},[field_types.c.IP]:{name:"IP address",icon:"tokenIP"},[field_types.c.KEYWORD]:{name:"Keyword",icon:"tokenKeyword"},[field_types.c.NUMBER]:{name:"Number",icon:"tokenNumber"},[field_types.c.TEXT]:{name:"Text",icon:"tokenString"},[field_types.c.UNKNOWN]:{name:"Unknown"}},DatavisualizerFieldTypeFilter=({indexedFieldTypes:indexedFieldTypes,setVisibleFieldTypes:setVisibleFieldTypes,visibleFieldTypes:visibleFieldTypes})=>{const options=Object(external_kbnSharedDeps_React_.useMemo)(()=>indexedFieldTypes.map(indexedFieldName=>{const item=ML_JOB_FIELD_TYPES_OPTIONS[indexedFieldName];return{value:indexedFieldName,name:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!0}," ",item.name),indexedFieldName&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(FieldTypeIcon,{type:indexedFieldName,fieldName:item.name,tooltipEnabled:!1,needsAria:!0})))}}),[indexedFieldTypes]),fieldTypeTitle=Object(external_kbnSharedDeps_React_.useMemo)(()=>external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataVisualizer.indexBased.fieldTypeSelect",{defaultMessage:"Field type"}),[]);return external_kbnSharedDeps_React_default.a.createElement(MultiSelectPicker,{title:fieldTypeTitle,options:options,onChange:setVisibleFieldTypes,checkedOptions:visibleFieldTypes,dataTestSubj:"mlDataVisualizerFieldTypeSelect"})},SearchPanel=({indexPattern:indexPattern,searchString:searchString,searchQueryLanguage:searchQueryLanguage,samplerShardSize:samplerShardSize,setSamplerShardSize:setSamplerShardSize,overallStats:overallStats,indexedFieldTypes:indexedFieldTypes,setVisibleFieldTypes:setVisibleFieldTypes,visibleFieldTypes:visibleFieldTypes,setVisibleFieldNames:setVisibleFieldNames,visibleFieldNames:visibleFieldNames,setSearchParams:setSearchParams,showEmptyFields:showEmptyFields})=>{const[searchInput,setSearchInput]=Object(external_kbnSharedDeps_React_.useState)({query:searchString||"",language:searchQueryLanguage}),[errorMessage,setErrorMessage]=Object(external_kbnSharedDeps_React_.useState)(void 0);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"m",alignItems:"center","data-test-subj":"mlDataVisualizerSearchPanel"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiInputPopover,{style:{maxWidth:"100%"},closePopover:()=>setErrorMessage(void 0),input:external_kbnSharedDeps_React_default.a.createElement(data_public_.QueryStringInput,{bubbleSubmitEvent:!1,query:searchInput,indexPatterns:[indexPattern],onChange:query=>setSearchInput(query),onSubmit:query=>{let filterQuery;try{filterQuery=query.language===constants_search.c.KUERY?data_public_.esKuery.toElasticsearchQuery(data_public_.esKuery.fromKueryExpression(query.query),indexPattern):query.language===constants_search.c.LUCENE?data_public_.esQuery.luceneStringToDsl(query.query):{},setSearchParams({searchQuery:filterQuery,searchString:query.query,queryLanguage:query.language})}catch(e){console.log("Invalid syntax",JSON.stringify(e,null,2)),setErrorMessage({query:query.query,message:e.message})}},placeholder:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.datavisualizer.searchPanel.queryBarPlaceholderText",{defaultMessage:'Search… (e.g. status:200 AND extension:"PHP")'}),disableAutoFocus:!0,dataTestSubj:"mlDataVisualizerQueryInput",languageSwitcherPopoverAnchorPosition:"rightDown"}),isOpen:(null==errorMessage?void 0:errorMessage.query)===searchInput.query&&""!==(null==errorMessage?void 0:errorMessage.message)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCode,null,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.datavisualizer.searchPanel.invalidKuerySyntaxErrorMessageQueryBar",{defaultMessage:"Invalid query"}),": ",null==errorMessage?void 0:errorMessage.message.split("\n")[0]))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(ShardSizeFilter,{samplerShardSize:samplerShardSize,setSamplerShardSize:setSamplerShardSize})),external_kbnSharedDeps_React_default.a.createElement(DataVisualizerFieldNamesFilter,{overallStats:overallStats,setVisibleFieldNames:setVisibleFieldNames,visibleFieldNames:visibleFieldNames,showEmptyFields:showEmptyFields}),external_kbnSharedDeps_React_default.a.createElement(DatavisualizerFieldTypeFilter,{indexedFieldTypes:indexedFieldTypes,setVisibleFieldTypes:setVisibleFieldTypes,visibleFieldTypes:visibleFieldTypes}))},DocumentCountChart=({width:width,chartPoints:chartPoints,timeRangeEarliest:timeRangeEarliest,timeRangeLatest:timeRangeLatest,interval:interval})=>{const seriesName=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.fieldDataCard.documentCountChart.seriesLabel",{defaultMessage:"document count"}),xDomain={min:timeRangeEarliest,max:timeRangeLatest},dateFormatter=Object(external_kbnSharedDeps_ElasticCharts_.niceTimeFormatter)([timeRangeEarliest,timeRangeLatest]),adjustedChartPoints=Object(external_kbnSharedDeps_React_.useMemo)(()=>chartPoints.length<1?[{time:timeRangeEarliest,value:0}]:1===chartPoints.length?[...chartPoints,{time:interval?Number(chartPoints[0].time)+interval:timeRangeEarliest,value:0}]:chartPoints,[chartPoints,timeRangeEarliest,timeRangeLatest,interval]);return external_kbnSharedDeps_React_default.a.createElement("div",{style:{width:null!=width?width:"100%"},"data-test-subj":"mlFieldDataDocumentCountChart"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_.Chart,{size:{width:"100%",height:120}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_.Settings,{xDomain:xDomain}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_.Axis,{id:"bottom",position:external_kbnSharedDeps_ElasticCharts_.Position.Bottom,showOverlappingTicks:!0,tickFormat:dateFormatter}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_.Axis,{id:"left",position:external_kbnSharedDeps_ElasticCharts_.Position.Left}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_.BarSeries,{id:"document_count",name:seriesName,xScaleType:external_kbnSharedDeps_ElasticCharts_.ScaleType.Time,yScaleType:external_kbnSharedDeps_ElasticCharts_.ScaleType.Linear,xAccessor:"time",yAccessors:["value"],data:adjustedChartPoints})))},TotalCountHeader=({totalCount:totalCount})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"s","data-test-subj":"mlDataVisualizerTotalDocCountHeader"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.datavisualizer.searchPanel.totalDocCountLabel",defaultMessage:"Total documents: {strongTotalCount}",values:{strongTotalCount:external_kbnSharedDeps_React_default.a.createElement("strong",{"data-test-subj":"mlDataVisualizerTotalDocCount"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.datavisualizer.searchPanel.totalDocCountNumber",defaultMessage:"{totalCount, plural, one {#} other {#}}",values:{totalCount:totalCount}}))}}))),DocumentCountContent=({config:config,totalCount:totalCount})=>{if(void 0===(null==config?void 0:config.stats))return void 0!==totalCount?external_kbnSharedDeps_React_default.a.createElement(TotalCountHeader,{totalCount:totalCount}):null;const{documentCounts:documentCounts,timeRangeEarliest:timeRangeEarliest,timeRangeLatest:timeRangeLatest}=config.stats;if(void 0===documentCounts||void 0===timeRangeEarliest||void 0===timeRangeLatest)return null;let chartPoints=[];if(void 0!==documentCounts.buckets){const buckets=null==documentCounts?void 0:documentCounts.buckets;chartPoints=Object.entries(buckets).map(([time,value])=>({time:+time,value:value}))}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(TotalCountHeader,{totalCount:totalCount}),external_kbnSharedDeps_React_default.a.createElement(DocumentCountChart,{chartPoints:chartPoints,timeRangeEarliest:timeRangeEarliest,timeRangeLatest:timeRangeLatest,interval:documentCounts.interval}))};var round_to_decimal_place=__webpack_require__(166);const DocumentStat=({config:config})=>{const{stats:stats}=config;if(void 0===stats)return null;const{count:count,sampleCount:sampleCount}=stats;if(void 0===count||void 0===sampleCount)return null;const docsPercent=Object(round_to_decimal_place.a)(count/sampleCount*100);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{className:"mlDataVisualizerColumnHeaderIcon"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{type:"document",size:"s"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"s"},external_kbnSharedDeps_React_default.a.createElement("b",null,count)," (",docsPercent,"%)"))},DistinctValues=({cardinality:cardinality})=>void 0===cardinality?null:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{className:"mlDataVisualizerColumnHeaderIcon"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{type:"database",size:"s"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"s"},external_kbnSharedDeps_React_default.a.createElement("b",null,cardinality)));var classnames=__webpack_require__(189),classnames_default=__webpack_require__.n(classnames);function kibanaFieldFormat(value,fieldFormat){return null!=fieldFormat?fieldFormat.convert(value,"text"):value}const MetricDistributionChartTooltipHeader=({chartPoint:chartPoint,maxWidth:maxWidth,fieldFormat:fieldFormat})=>void 0===chartPoint?null:external_kbnSharedDeps_React_default.a.createElement("div",{style:{maxWidth:maxWidth}},chartPoint.dataMax>chartPoint.dataMin?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.fieldDataCard.metricDistributionChart.tooltipValueBetweenLabel",defaultMessage:"{percent}% of documents have values between {minValFormatted} and {maxValFormatted}",values:{percent:chartPoint.percent,minValFormatted:kibanaFieldFormat(chartPoint.dataMin,fieldFormat),maxValFormatted:kibanaFieldFormat(chartPoint.dataMax,fieldFormat)}}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.fieldDataCard.metricDistributionChart.tooltipValueEqualLabel",defaultMessage:"{percent}% of documents have a value of {valFormatted}",values:{percent:chartPoint.percent,valFormatted:kibanaFieldFormat(chartPoint.dataMin,fieldFormat)}}));var color_range_legend=__webpack_require__(145);const useDataVizChartTheme=()=>{const{euiTheme:euiTheme}=Object(color_range_legend.e)();return Object(external_kbnSharedDeps_React_.useMemo)(()=>{const AREA_SERIES_COLOR=euiTheme.euiColorVis0;return{axes:{tickLabel:{fontSize:parseInt(euiTheme.euiFontSizeXS,10),fontFamily:euiTheme.euiFontFamily,fontStyle:"italic"}},background:{color:"transparent"},chartMargins:{left:0,right:0,top:0,bottom:0},chartPaddings:{left:0,right:0,top:4,bottom:0},scales:{barsPadding:.1},colors:{vizColors:[AREA_SERIES_COLOR]},areaSeriesStyle:{line:{strokeWidth:1,visible:!0},point:{visible:!1,radius:0,opacity:0},area:{visible:!0,opacity:1}}}},[euiTheme])},MetricDistributionChart=({width:width,height:height,chartData:chartData,fieldFormat:fieldFormat,hideXAxis:hideXAxis})=>{const seriesName=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.fieldDataCard.metricDistributionChart.seriesName",{defaultMessage:"distribution"}),theme=useDataVizChartTheme();return external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":"mlFieldDataMetricDistributionChart"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_.Chart,{size:{width:width,height:height}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_.Settings,{theme:theme,tooltip:{headerFormatter:tooltipData=>{const xValue=tooltipData.value,chartPoint=chartData.find(data=>data.x===xValue);return external_kbnSharedDeps_React_default.a.createElement(MetricDistributionChartTooltipHeader,{chartPoint:chartPoint,maxWidth:width/2,fieldFormat:fieldFormat})}}}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_.Axis,{id:"bottom",position:external_kbnSharedDeps_ElasticCharts_.Position.Bottom,tickFormat:d=>kibanaFieldFormat(d,fieldFormat),hide:!0===hideXAxis}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_.Axis,{id:"left",position:external_kbnSharedDeps_ElasticCharts_.Position.Left,tickFormat:d=>d.toFixed(3),hide:!0}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_.AreaSeries,{id:"metric_distribution",name:seriesName,xScaleType:external_kbnSharedDeps_ElasticCharts_.ScaleType.Linear,yScaleType:external_kbnSharedDeps_ElasticCharts_.ScaleType.Linear,xAccessor:"x",yAccessors:["y"],data:chartData.length>0?chartData:[{x:0,y:0}],curve:external_kbnSharedDeps_ElasticCharts_.CurveType.CURVE_STEP_AFTER})))};function buildChartDataFromStats(stats,chartWidth){let chartData=[];const distribution=stats.distribution;if(void 0===distribution)return chartData;const percentiles=distribution.percentiles;if(0===percentiles.length)return chartData;const minX=percentiles[0].minValue,maxX=percentiles[percentiles.length-1].maxValue;let xAxisMin=minX,xAxisMax=maxX;maxX===minX&&(0!==minX?(xAxisMin=0,xAxisMax=2*minX):xAxisMax=1);const minBarWidth=3/chartWidth*(xAxisMax-xAxisMin),processedData=[];let lastBar;percentiles.forEach((data,index)=>{if(0===index){const bar={x0:data.minValue,x1:Math.max(data.minValue+minBarWidth,data.maxValue),y:0,dataMin:data.minValue,dataMax:data.maxValue,percent:data.percent,isMinWidth:!1};bar.y=data.percent/(bar.x1-bar.x0)*Math.max(1,minBarWidth/Math.max(data.maxValue-data.minValue,.5*minBarWidth)),bar.isMinWidth=data.maxValue<=data.minValue+minBarWidth,processedData.push(bar),lastBar=bar}else if(!1===lastBar.isMinWidth||data.maxValue>lastBar.x1){const bar={x0:lastBar.x1,x1:Math.max(lastBar.x1+minBarWidth,data.maxValue),y:0,dataMin:data.minValue,dataMax:data.maxValue,percent:data.percent,isMinWidth:!1};bar.y=data.percent/(bar.x1-bar.x0)*Math.max(1,minBarWidth/Math.max(data.maxValue-data.minValue,.5*minBarWidth)),bar.isMinWidth=data.maxValue<=lastBar.x1+minBarWidth,processedData.push(bar),lastBar=bar}else lastBar.percent=lastBar.percent+data.percent,lastBar.y=lastBar.percent/(lastBar.x1-lastBar.x0),lastBar.dataMax=data.maxValue}),maxX!==minX&&(xAxisMax=processedData[processedData.length-1].x1);let barHeights=processedData.map(data=>data.y);barHeights=barHeights.sort((a,b)=>a-b);let maxBarHeight=0;const processedDataLength=processedData.length;maxBarHeight=1===Math.abs(processedDataLength%2)?20*barHeights[Math.floor(processedDataLength/2)]:20*(barHeights[Math.floor(processedDataLength/2)-1]+barHeights[Math.floor(processedDataLength/2)])/2,processedData.forEach(data=>{data.y=Math.min(data.y,maxBarHeight)}),chartData=processedData.map(data=>{const{x0:x0,y:y,dataMin:dataMin,dataMax:dataMax,percent:percent}=data;return{x:x0,y:y,dataMin:dataMin,dataMax:dataMax,percent:percent}});const last=processedData[processedData.length-1];return chartData.push({x:last.x1,y:0,dataMin:last.dataMin,dataMax:last.dataMax,percent:last.percent}),chartData}var format_value=__webpack_require__(122);const IndexBasedNumberContentPreview=({config:config})=>{const{stats:stats,fieldFormat:fieldFormat,fieldName:fieldName}=config,[distributionChartData,setDistributionChartData]=Object(external_kbnSharedDeps_React_.useState)([]),[legendText,setLegendText]=Object(external_kbnSharedDeps_React_.useState)(),dataTestSubj="mlDataGridChart-"+fieldName;return Object(external_kbnSharedDeps_React_.useEffect)(()=>{const chartData=buildChartDataFromStats(stats,150);Array.isArray(chartData)&&void 0!==chartData[0].x&&void 0!==chartData[chartData.length-1].x&&(setDistributionChartData(chartData),setLegendText({min:Object(format_value.a)(chartData[0].x),max:Object(format_value.a)(chartData[chartData.length-1].x)}))},[]),external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":dataTestSubj},external_kbnSharedDeps_React_default.a.createElement("div",{className:"mlDataGridChart__histogram","data-test-subj":dataTestSubj+"-histogram"},external_kbnSharedDeps_React_default.a.createElement(MetricDistributionChart,{width:150,height:80,chartData:distributionChartData,fieldFormat:fieldFormat,hideXAxis:!0})),external_kbnSharedDeps_React_default.a.createElement("div",{className:"mlDataGridChart__legend","data-test-subj":dataTestSubj+"-legend"},legendText&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"row","data-test-subj":dataTestSubj+"-legend"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{className:"mlDataGridChart__legend"},kibanaFieldFormat(legendText.min,fieldFormat)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{className:classnames_default()("mlDataGridChart__legend","mlDataGridChart__legend--numeric")},kibanaFieldFormat(legendText.max,fieldFormat))))))};var use_table_settings=__webpack_require__(248),column_chart=__webpack_require__(239);const TopValuesPreview=({config:config})=>{const{stats:stats}=config;if(void 0===stats)return null;const{topValues:topValues,cardinality:cardinality}=stats;if(void 0===cardinality||void 0===topValues||void 0===config.fieldName)return null;const chartData={cardinality:cardinality,data:topValues.map(d=>({...d,key:d.key.toString()})),id:config.fieldName,type:"ordinal"},columnType={id:config.fieldName,schema:void 0};return external_kbnSharedDeps_React_default.a.createElement(column_chart.a,{chartData:chartData,columnType:columnType,dataTestSubj:"mlDataGridChart-"+config.fieldName,hideLabel:!0,maxChartColumns:10})};const getTFPercentage=config=>{const{stats:stats}=config;if(void 0===stats)return null;const{count:count}=stats;let{trueCount:trueCount,falseCount:falseCount}=stats;var _config$stats;void 0!==stats.trueCount&&void 0!==stats.falseCount||null!=config&&null!==(_config$stats=config.stats)&&void 0!==_config$stats&&_config$stats.topValues&&config.stats.topValues.forEach(doc=>{void 0!==doc.doc_count&&("false"===doc.key.toString().toLowerCase()&&(falseCount=doc.doc_count),"true"===doc.key.toString().toLowerCase()&&(trueCount=doc.doc_count))});return void 0===count||void 0===trueCount||void 0===falseCount?null:{count:count,trueCount:trueCount,falseCount:falseCount}},BooleanContentPreview=({config:config})=>{const chartData=Object(external_kbnSharedDeps_React_.useMemo)(()=>{const results=getTFPercentage(config);if(results){const data=[{key:"true",key_as_string:"true",doc_count:results.trueCount},{key:"false",key_as_string:"false",doc_count:results.falseCount}];return{id:config.fieldName,cardinality:2,data:data,type:"boolean"}}},[config]);if(!chartData||void 0===config.fieldName)return null;const columnType={id:config.fieldName,schema:void 0},dataTestSubj="mlDataGridChart-"+config.fieldName;return external_kbnSharedDeps_React_default.a.createElement(column_chart.a,{dataTestSubj:dataTestSubj,chartData:chartData,columnType:columnType,hideLabel:!0})},DataVisualizerTable=({items:items,pageState:pageState,updatePageState:updatePageState,getItemIdToExpandedRowMap:getItemIdToExpandedRowMap,extendedColumns:extendedColumns})=>{var _ref;const[expandedRowItemIds,setExpandedRowItemIds]=Object(external_kbnSharedDeps_React_.useState)([]),[expandAll,toggleExpandAll]=Object(external_kbnSharedDeps_React_.useState)(!1),{onTableChange:onTableChange,pagination:pagination,sorting:sorting}=Object(use_table_settings.a)(items,pageState,updatePageState),showDistributions=null===(_ref="showDistributions"in pageState&&pageState.showDistributions)||void 0===_ref||_ref;const columns=Object(external_kbnSharedDeps_React_.useMemo)(()=>{const baseColumns=[{name:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{"data-test-subj":"mlToggleDetailsForAllRowsButton "+(expandAll?"expanded":"collapsed"),onClick:()=>toggleExpandAll(!expandAll),"aria-label":expandAll?external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.datavisualizer.dataGrid.collapseDetailsForAllAriaLabel",{defaultMessage:"Collapse details for all fields"}):external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.datavisualizer.dataGrid.expandDetailsForAllAriaLabel",{defaultMessage:"Expand details for all fields"}),iconType:expandAll?"arrowUp":"arrowDown"}),align:external_kbnSharedDeps_ElasticEui_.RIGHT_ALIGNMENT,width:"40px",isExpander:!0,render:item=>{if(void 0===item.fieldName)return null;const direction=expandedRowItemIds.includes(item.fieldName)?"arrowUp":"arrowDown";return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{"data-test-subj":`mlDataVisualizerDetailsToggle-${item.fieldName}-${direction}`,onClick:()=>function(item){if(void 0===item.fieldName)return;const index=expandedRowItemIds.indexOf(item.fieldName);-1!==index?expandedRowItemIds.splice(index,1):expandedRowItemIds.push(item.fieldName),setExpandedRowItemIds([...expandedRowItemIds])}(item),"aria-label":expandedRowItemIds.includes(item.fieldName)?external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.datavisualizer.dataGrid.rowCollapse",{defaultMessage:"Hide details for {fieldName}",values:{fieldName:item.fieldName}}):external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.datavisualizer.dataGrid.rowExpand",{defaultMessage:"Show details for {fieldName}",values:{fieldName:item.fieldName}}),iconType:direction})},"data-test-subj":"mlDataVisualizerTableColumnDetailsToggle"},{field:"type",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.datavisualizer.dataGrid.typeColumnName",{defaultMessage:"Type"}),render:fieldType=>external_kbnSharedDeps_React_default.a.createElement(FieldTypeIcon,{type:fieldType,tooltipEnabled:!0,needsAria:!0}),width:"75px",sortable:!0,align:external_kbnSharedDeps_ElasticEui_.CENTER_ALIGNMENT,"data-test-subj":"mlDataVisualizerTableColumnType"},{field:"fieldName",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.datavisualizer.dataGrid.nameColumnName",{defaultMessage:"Name"}),sortable:!0,truncateText:!0,render:fieldName=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"s"},external_kbnSharedDeps_React_default.a.createElement("b",null,fieldName)),align:external_kbnSharedDeps_ElasticEui_.LEFT_ALIGNMENT,"data-test-subj":"mlDataVisualizerTableColumnName"},{field:"docCount",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.datavisualizer.dataGrid.documentsCountColumnName",{defaultMessage:"Documents (%)"}),render:(value,item)=>external_kbnSharedDeps_React_default.a.createElement(DocumentStat,{config:item}),sortable:item=>{var _item$stats;return null==item||null===(_item$stats=item.stats)||void 0===_item$stats?void 0:_item$stats.count},align:external_kbnSharedDeps_ElasticEui_.LEFT_ALIGNMENT,"data-test-subj":"mlDataVisualizerTableColumnDocumentsCount"},{field:"stats.cardinality",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.datavisualizer.dataGrid.distinctValuesColumnName",{defaultMessage:"Distinct values"}),render:cardinality=>external_kbnSharedDeps_React_default.a.createElement(DistinctValues,{cardinality:cardinality}),sortable:!0,align:external_kbnSharedDeps_ElasticEui_.LEFT_ALIGNMENT,"data-test-subj":"mlDataVisualizerTableColumnDistinctValues"},{name:external_kbnSharedDeps_React_default.a.createElement("div",{style:{display:"flex",alignItems:"center"}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{type:"visBarVertical",style:{paddingRight:4}}),external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.datavisualizer.dataGrid.distributionsColumnName",{defaultMessage:"Distributions"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{style:{marginLeft:4},size:"s",iconType:showDistributions?"eye":"eyeClosed",onClick:()=>{updatePageState({...pageState,showDistributions:!showDistributions})},"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.datavisualizer.dataGrid.showDistributionsAriaLabel",{defaultMessage:"Show distributions"})})),render:item=>{var _item$stats2,_item$stats3;if(void 0===item||!1===showDistributions)return null;if((item.type===field_types.c.KEYWORD||item.type===field_types.c.IP)&&void 0!==(null===(_item$stats2=item.stats)||void 0===_item$stats2?void 0:_item$stats2.topValues))return external_kbnSharedDeps_React_default.a.createElement(TopValuesPreview,{config:item});if(item.type===field_types.c.NUMBER&&(item.hasOwnProperty("existsInDocs")&&void 0!==(null===(_item$stats3=item.stats)||void 0===_item$stats3?void 0:_item$stats3.distribution)))return external_kbnSharedDeps_React_default.a.createElement(IndexBasedNumberContentPreview,{config:item});return item.type===field_types.c.BOOLEAN?external_kbnSharedDeps_React_default.a.createElement(BooleanContentPreview,{config:item}):null},align:external_kbnSharedDeps_ElasticEui_.LEFT_ALIGNMENT,"data-test-subj":"mlDataVisualizerTableColumnDistribution"}];return extendedColumns?[...baseColumns,...extendedColumns]:baseColumns},[expandAll,showDistributions,updatePageState,extendedColumns]),itemIdToExpandedRowMap=Object(external_kbnSharedDeps_React_.useMemo)(()=>{let itemIds=expandedRowItemIds;return expandAll&&(itemIds=items.map(i=>i.fieldName).filter(f=>void 0!==f)),getItemIdToExpandedRowMap(itemIds,items)},[expandAll,items,expandedRowItemIds]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{"data-test-subj":"mlDataVisualizerTableContainer"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiInMemoryTable,{className:"mlDataVisualizer",items:items,itemId:"fieldName",columns:columns,pagination:pagination,sorting:sorting,isExpandable:!0,itemIdToExpandedRowMap:itemIdToExpandedRowMap,isSelectable:!1,onTableChange:onTableChange,"data-test-subj":"mlDataVisualizerTable",rowProps:item=>({"data-test-subj":"mlDataVisualizerRow row-"+item.fieldName})}))},TotalFieldsCount=({fieldsCountStats:fieldsCountStats})=>fieldsCountStats&&void 0!==fieldsCountStats.visibleFieldsCount&&void 0!==fieldsCountStats.totalFieldsCount?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s",alignItems:"center",className:"mlDataVisualizerFieldCountContainer","data-test-subj":"mlDataVisualizerFieldsSummary"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement("h5",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataVisualizer.searchPanel.allFieldsLabel",defaultMessage:"All fields"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiNotificationBadge,{color:"subdued",size:"m","data-test-subj":"mlDataVisualizerVisibleFieldsCount"},external_kbnSharedDeps_React_default.a.createElement("strong",null,fieldsCountStats.visibleFieldsCount))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{color:"subdued",size:"s","data-test-subj":"mlDataVisualizerTotalFieldsCount"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataVisualizer.searchPanel.ofFieldsTotal",defaultMessage:"of {totalCount} total",values:{totalCount:fieldsCountStats.totalFieldsCount}})))):null,MetricFieldsCount=({metricsStats:metricsStats})=>metricsStats&&void 0!==metricsStats.visibleMetricsCount&&void 0!==metricsStats.totalMetricFieldsCount?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,metricsStats&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s",alignItems:"center",className:"mlDataVisualizerFieldCountContainer","data-test-subj":"mlDataVisualizerMetricFieldsSummary"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement("h5",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataVisualizer.searchPanel.numberFieldsLabel",defaultMessage:"Number fields"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiNotificationBadge,{color:"subdued",size:"m","data-test-subj":"mlDataVisualizerVisibleMetricFieldsCount"},external_kbnSharedDeps_React_default.a.createElement("strong",null,metricsStats.visibleMetricsCount))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{color:"subdued",size:"s","data-test-subj":"mlDataVisualizerMetricFieldsCount"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataVisualizer.searchPanel.ofFieldsTotal",defaultMessage:"of {totalCount} total",values:{totalCount:metricsStats.totalMetricFieldsCount}}))))):null,FieldCountPanel=({metricsStats:metricsStats,fieldsCountStats:fieldsCountStats,showEmptyFields:showEmptyFields,toggleShowEmptyFields:toggleShowEmptyFields})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",gutterSize:"xs",style:{marginLeft:4},"data-test-subj":"mlDataVisualizerFieldCountPanel"},external_kbnSharedDeps_React_default.a.createElement(TotalFieldsCount,{fieldsCountStats:fieldsCountStats}),external_kbnSharedDeps_React_default.a.createElement(MetricFieldsCount,{metricsStats:metricsStats}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSwitch,{"data-test-subj":"mlDataVisualizerShowEmptyFieldsSwitch",label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataVisualizer.searchPanel.showEmptyFields",defaultMessage:"Show empty fields"}),checked:showEmptyFields,onChange:toggleShowEmptyFields})));var field_histograms=__webpack_require__(240);function data_loader_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class data_loader_DataLoader{constructor(indexPattern,toastNotifications){data_loader_defineProperty(this,"_indexPattern",void 0),data_loader_defineProperty(this,"_runtimeMappings",void 0),data_loader_defineProperty(this,"_indexPatternTitle",""),data_loader_defineProperty(this,"_maxExamples",10),data_loader_defineProperty(this,"_toastNotificationsService",void 0),this._indexPattern=indexPattern,this._runtimeMappings=this._indexPattern.getComputedFields().runtimeFields,this._indexPatternTitle=indexPattern.title,this._toastNotificationsService=Object(toast_notification_service.b)(toastNotifications)}async loadOverallData(query,samplerShardSize,earliest,latest){const aggregatableFields=[],nonAggregatableFields=[];this._indexPattern.fields.forEach(field=>{const fieldName=void 0!==field.displayName?field.displayName:field.name;!0===this.isDisplayField(fieldName)&&(!0===field.aggregatable&&field.type!==data_public_.KBN_FIELD_TYPES.GEO_SHAPE?aggregatableFields.push(fieldName):nonAggregatableFields.push(fieldName))});return await ml_api_service.ml.getVisualizerOverallStats({indexPatternTitle:this._indexPatternTitle,query:query,timeFieldName:this._indexPattern.timeFieldName,samplerShardSize:samplerShardSize,earliest:earliest,latest:latest,aggregatableFields:aggregatableFields,nonAggregatableFields:nonAggregatableFields,runtimeMappings:this._runtimeMappings})}async loadFieldStats(query,samplerShardSize,earliest,latest,fields,interval){return await ml_api_service.ml.getVisualizerFieldStats({indexPatternTitle:this._indexPatternTitle,query:query,timeFieldName:this._indexPattern.timeFieldName,earliest:earliest,latest:latest,samplerShardSize:samplerShardSize,interval:interval,fields:fields,maxExamples:this._maxExamples,runtimeMappings:this._runtimeMappings})}async loadFieldHistograms(fields,query,samplerShardSize=field_histograms.a,editorRuntimeMappings){return await ml_api_service.ml.getVisualizerFieldHistograms({indexPatternTitle:this._indexPatternTitle,query:query,fields:fields,samplerShardSize:samplerShardSize,runtimeMappings:editorRuntimeMappings||this._runtimeMappings})}displayError(err){500===err.statusCode?this._toastNotificationsService.displayErrorToast(err,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.datavisualizer.dataLoader.internalServerErrorMessage",{defaultMessage:"Error loading data in index {index}. {message}. The request may have timed out. Try using a smaller sample size or narrowing the time range.",values:{index:this._indexPattern.title,message:err.message}})):this._toastNotificationsService.displayErrorToast(err,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.datavisualizer.page.errorLoadingDataMessage",{defaultMessage:"Error loading data in index {index}. {message}",values:{index:this._indexPattern.title,message:err.message}}))}set maxExamples(max){this._maxExamples=max}get maxExamples(){return this._maxExamples}isDisplayField(fieldName){return!field_types.d.includes(fieldName)}}const LoadingIndicator=()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"xxl"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceAround"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingSpinner,{size:"l"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceAround"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{color:"subdued"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.fieldDataCard.loadingLabel",defaultMessage:"Loading"}))))),NotInDocsContent=()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"xxl"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{textAlign:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{type:"alert"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{textAlign:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.fieldDataCard.fieldNotInDocsLabel",defaultMessage:"This field does not appear in any documents for the selected time range"}))),ExpandedRowFieldHeader=({children:children})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs",color:"subdued",className:"mlFieldDataCard__valuesTitle"},children),metaTableColumns=[{name:"",render:metaItem=>metaItem.display,width:"75px"},{field:"value",name:"",render:v=>external_kbnSharedDeps_React_default.a.createElement("strong",null,v)}],metaTableTitle=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.fieldDataCardExpandedRow.documentStatsTable.metaTableTitle",{defaultMessage:"Documents stats"}),DocumentStatsTable=({config:config})=>{if(void 0===(null==config?void 0:config.stats)||void 0===config.stats.cardinality||void 0===config.stats.count||void 0===config.stats.sampleCount)return null;const{cardinality:cardinality,count:count,sampleCount:sampleCount}=config.stats,metaTableItems=[{function:"count",display:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.fieldDataCardExpandedRow.documentStatsTable.countLabel",defaultMessage:"count"}),value:count},{function:"percentage",display:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.fieldDataCardExpandedRow.documentStatsTable.percentageLabel",defaultMessage:"percentage"}),value:Object(round_to_decimal_place.a)(count/sampleCount*100)+"%"},{function:"distinctValues",display:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.fieldDataCardExpandedRow.documentStatsTable.distinctValueLabel",defaultMessage:"distinct values"}),value:cardinality}];return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{"data-test-subj":"mlDVDocumentStatsContent",className:"mlDataVisualizerSummaryTableWrapper"},external_kbnSharedDeps_React_default.a.createElement(ExpandedRowFieldHeader,null,metaTableTitle),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBasicTable,{className:"mlDataVisualizerSummaryTable",compressed:!0,items:metaTableItems,columns:metaTableColumns,tableCaption:metaTableTitle}))},ExpandedRowContent=({children:children,dataTestSubj:dataTestSubj})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{"data-test-subj":dataTestSubj,gutterSize:"xl",className:"mlDataVisualizerExpandedRow"},children);function getFormattedValue(value,totalCount){return`${value} (${function(value){return 0===value?"0%":value>=.1?Object(round_to_decimal_place.a)(value)+"%":"< 0.1%"}(value/totalCount*100)})`}const BooleanContent=({config:config})=>{const fieldFormat="fieldFormat"in config?config.fieldFormat:void 0,formattedPercentages=Object(external_kbnSharedDeps_React_.useMemo)(()=>getTFPercentage(config),[config]),theme=useDataVizChartTheme();if(!formattedPercentages)return null;const{trueCount:trueCount,falseCount:falseCount,count:count}=formattedPercentages,summaryTableItems=[{function:"true",display:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.fieldDataCardExpandedRow.booleanContent.trueCountLabel",defaultMessage:"true"}),value:getFormattedValue(trueCount,count)},{function:"false",display:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.fieldDataCardExpandedRow.booleanContent.falseCountLabel",defaultMessage:"false"}),value:getFormattedValue(falseCount,count)}],summaryTableColumns=[{name:"",render:summaryItem=>summaryItem.display,width:"75px"},{field:"value",name:"",render:v=>external_kbnSharedDeps_React_default.a.createElement("strong",null,v)}],summaryTableTitle=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.fieldDataCardExpandedRow.booleanContent.summaryTableTitle",{defaultMessage:"Summary"});return external_kbnSharedDeps_React_default.a.createElement(ExpandedRowContent,{dataTestSubj:"mlDVBooleanContent"},external_kbnSharedDeps_React_default.a.createElement(DocumentStatsTable,{config:config}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{className:"mlDataVisualizerSummaryTableWrapper"},external_kbnSharedDeps_React_default.a.createElement(ExpandedRowFieldHeader,null,summaryTableTitle),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBasicTable,{className:"mlDataVisualizerSummaryTable",compressed:!0,items:summaryTableItems,columns:summaryTableColumns,tableCaption:summaryTableTitle})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(ExpandedRowFieldHeader,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.fieldDataCard.cardBoolean.valuesLabel",defaultMessage:"Values"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_.Chart,{renderer:"canvas",size:{height:100}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_.Axis,{id:"bottom",position:"bottom",showOverlappingTicks:!0}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_.Axis,{id:"left2",title:"Left axis",hide:!0,tickFormat:d=>getFormattedValue(d,count)}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_.Settings,{showLegend:!1,theme:theme}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_.BarSeries,{id:config.fieldName||fieldFormat,data:[{x:"true",count:formattedPercentages.trueCount},{x:"false",count:formattedPercentages.falseCount}],splitSeriesAccessors:["x"],stackAccessors:["x"],xAccessor:"x",xScaleType:"ordinal",yAccessors:["count"],yScaleType:"linear"}))))};var external_kbnSharedDeps_ElasticEuiLibServicesFormat_=__webpack_require__(56);const DateContent=({config:config})=>{const{stats:stats}=config;if(void 0===stats)return null;const{earliest:earliest,latest:latest}=stats,summaryTableTitle=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.fieldDataCard.cardDate.summaryTableTitle",{defaultMessage:"Summary"}),summaryTableItems=[{function:"earliest",display:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.fieldDataCard.cardDate.earliestLabel",defaultMessage:"earliest"}),value:"string"==typeof earliest?earliest:Object(external_kbnSharedDeps_ElasticEuiLibServicesFormat_.formatDate)(earliest,"MMM D YYYY, HH:mm:ss.SSS")},{function:"latest",display:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.fieldDataCard.cardDate.latestLabel",defaultMessage:"latest"}),value:"string"==typeof latest?latest:Object(external_kbnSharedDeps_ElasticEuiLibServicesFormat_.formatDate)(latest,"MMM D YYYY, HH:mm:ss.SSS")}],summaryTableColumns=[{name:"",render:summaryItem=>summaryItem.display,width:"75px"},{field:"value",name:"",render:v=>external_kbnSharedDeps_React_default.a.createElement("strong",null,v)}];return external_kbnSharedDeps_React_default.a.createElement(ExpandedRowContent,{dataTestSubj:"mlDVDateContent"},external_kbnSharedDeps_React_default.a.createElement(DocumentStatsTable,{config:config}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{className:"mlDataVisualizerSummaryTableWrapper"},external_kbnSharedDeps_React_default.a.createElement(ExpandedRowFieldHeader,null,summaryTableTitle),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBasicTable,{className:"mlDataVisualizerSummaryTable","data-test-subj":"mlDateSummaryTable",compressed:!0,items:summaryTableItems,columns:summaryTableColumns,tableCaption:summaryTableTitle,tableLayout:"auto"})))};const TopValues=({stats:stats,fieldFormat:fieldFormat,barColor:barColor,compressed:compressed})=>{if(void 0===stats)return null;const{topValues:topValues,topValuesSampleSize:topValuesSampleSize,topValuesSamplerShardSize:topValuesSamplerShardSize,count:count,isTopValuesSampled:isTopValuesSampled}=stats,progressBarMax=!0===isTopValuesSampled?topValuesSampleSize:count;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{"data-test-subj":"mlTopValues"},external_kbnSharedDeps_React_default.a.createElement(ExpandedRowFieldHeader,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.fieldDataCard.topValuesLabel",defaultMessage:"Top values"})),external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":"mlFieldDataTopValues",className:"mlFieldDataTopValuesContainer"},Array.isArray(topValues)&&topValues.map(value=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"xs",alignItems:"center",key:value.key},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,className:classnames_default()("eui-textTruncate","mlTopValuesValueLabelContainer","mlTopValuesValueLabelContainer--"+(!0===compressed?"small":"large"))},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{content:kibanaFieldFormat(value.key,fieldFormat),position:"right"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs",textAlign:"right",color:"subdued"},kibanaFieldFormat(value.key,fieldFormat)))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{"data-test-subj":"mlFieldDataTopValueBar"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiProgress,{value:value.doc_count,max:progressBarMax,color:barColor,size:"m"})),void 0!==progressBarMax&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,className:classnames_default()("eui-textTruncate","mlTopValuesPercentLabelContainer")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs",textAlign:"left",color:"subdued"},function(docCount,topValuesSampleSize){const percent=100*docCount/topValuesSampleSize;return percent>=.1?Object(round_to_decimal_place.a)(percent,1)+"%":"< 0.1%"}(value.doc_count,progressBarMax))))),!0===isTopValuesSampled&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs",textAlign:"left"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.fieldDataCard.topValues.calculatedFromSampleDescription",defaultMessage:"Calculated from sample of {topValuesSamplerShardSize} documents per shard",values:{topValuesSamplerShardSize:topValuesSamplerShardSize}})))))},KeywordContent=({config:config})=>{const{stats:stats}=config,fieldFormat="fieldFormat"in config?config.fieldFormat:void 0;return external_kbnSharedDeps_React_default.a.createElement(ExpandedRowContent,{dataTestSubj:"mlDVKeywordContent"},external_kbnSharedDeps_React_default.a.createElement(DocumentStatsTable,{config:config}),external_kbnSharedDeps_React_default.a.createElement(TopValues,{stats:stats,fieldFormat:fieldFormat,barColor:"secondary"}))},IpContent=({config:config})=>{const{stats:stats}=config;if(void 0===stats)return null;const{count:count,sampleCount:sampleCount,cardinality:cardinality}=stats;if(void 0===count||void 0===sampleCount||void 0===cardinality)return null;const fieldFormat="fieldFormat"in config?config.fieldFormat:void 0;return external_kbnSharedDeps_React_default.a.createElement(ExpandedRowContent,{dataTestSubj:"mlDVIPContent"},external_kbnSharedDeps_React_default.a.createElement(DocumentStatsTable,{config:config}),external_kbnSharedDeps_React_default.a.createElement(TopValues,{stats:stats,fieldFormat:fieldFormat,barColor:"secondary"}))};var external_kbnSharedDeps_ElasticNumeral_=__webpack_require__(49),external_kbnSharedDeps_ElasticNumeral_default=__webpack_require__.n(external_kbnSharedDeps_ElasticNumeral_);function numberAsOrdinal(num){const int=Math.floor(num);return""+external_kbnSharedDeps_ElasticNumeral_default()(int).format("0o")}const NumberContent=({config:config})=>{const{stats:stats}=config;Object(external_kbnSharedDeps_React_.useEffect)(()=>{const chartData=buildChartDataFromStats(stats,325);setDistributionChartData(chartData)},[]);const[distributionChartData,setDistributionChartData]=Object(external_kbnSharedDeps_React_.useState)([]);if(void 0===stats)return null;const{min:min,median:median,max:max,distribution:distribution}=stats,fieldFormat="fieldFormat"in config?config.fieldFormat:void 0,summaryTableItems=[{function:"min",display:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.fieldDataCardExpandedRow.numberContent.minLabel",defaultMessage:"min"}),value:kibanaFieldFormat(min,fieldFormat)},{function:"median",display:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.fieldDataCardExpandedRow.numberContent.medianLabel",defaultMessage:"median"}),value:kibanaFieldFormat(median,fieldFormat)},{function:"max",display:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.fieldDataCardExpandedRow.numberContent.maxLabel",defaultMessage:"max"}),value:kibanaFieldFormat(max,fieldFormat)}],summaryTableColumns=[{name:"",render:summaryItem=>summaryItem.display,width:"75px"},{field:"value",name:"",render:v=>external_kbnSharedDeps_React_default.a.createElement("strong",null,v)}],summaryTableTitle=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.fieldDataCardExpandedRow.numberContent.summaryTableTitle",{defaultMessage:"Summary"});return external_kbnSharedDeps_React_default.a.createElement(ExpandedRowContent,{dataTestSubj:"mlDVNumberContent"},external_kbnSharedDeps_React_default.a.createElement(DocumentStatsTable,{config:config}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{className:"mlDataVisualizerSummaryTableWrapper"},external_kbnSharedDeps_React_default.a.createElement(ExpandedRowFieldHeader,null,summaryTableTitle),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBasicTable,{className:"mlDataVisualizerSummaryTable",compressed:!0,items:summaryTableItems,columns:summaryTableColumns,tableCaption:summaryTableTitle,"data-test-subj":"mlNumberSummaryTable"})),stats&&external_kbnSharedDeps_React_default.a.createElement(TopValues,{stats:stats,fieldFormat:fieldFormat,barColor:"secondary",compressed:!0}),distribution&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{"data-test-subj":"mlMetricDistribution"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(ExpandedRowFieldHeader,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.fieldDataCardExpandedRow.numberContent.distributionTitle",defaultMessage:"Distribution"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{className:"mlMetricDistributionChartContainer"},external_kbnSharedDeps_React_default.a.createElement(MetricDistributionChart,{width:325,height:200,chartData:distributionChartData,fieldFormat:fieldFormat})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.fieldDataCardExpandedRow.numberContent.displayingPercentilesLabel",defaultMessage:"Displaying {minPercent} - {maxPercent} percentiles",values:{minPercent:numberAsOrdinal(distribution.minPercentile),maxPercent:numberAsOrdinal(distribution.maxPercentile)}})))))},ExamplesList=({examples:examples})=>{if(null==examples||!Array.isArray(examples))return null;let examplesContent;return examplesContent=0===examples.length?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.fieldDataCard.examplesList.noExamplesMessage",defaultMessage:"No examples were obtained for this field"}):examples.map((example,i)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiListGroupItem,{className:"mlFieldDataCard__codeContent",size:"s",key:"example_"+i,label:"string"==typeof example?example:JSON.stringify(example)})),external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":"mlFieldDataExamplesList"},external_kbnSharedDeps_React_default.a.createElement(ExpandedRowFieldHeader,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.fieldDataCard.examplesList.title",defaultMessage:"{numExamples, plural, one {Value} other {Examples}}",values:{numExamples:examples.length}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiListGroup,{showToolTips:!0,maxWidth:"s",gutterSize:"none",flush:!0},examplesContent))},OtherContent=({config:config})=>{const{stats:stats}=config;return void 0===stats?null:external_kbnSharedDeps_React_default.a.createElement(ExpandedRowContent,{dataTestSubj:"mlDVOtherContent"},external_kbnSharedDeps_React_default.a.createElement(DocumentStatsTable,{config:config}),Array.isArray(stats.examples)&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(ExamplesList,{examples:stats.examples})))},TextContent=({config:config})=>{const{stats:stats}=config;if(void 0===stats)return null;const{examples:examples}=stats;if(void 0===examples)return null;const numExamples=examples.length;return external_kbnSharedDeps_React_default.a.createElement(ExpandedRowContent,{dataTestSubj:"mlDVTextContent"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,numExamples>0&&external_kbnSharedDeps_React_default.a.createElement(ExamplesList,{examples:examples}),0===numExamples&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"xl"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.fieldDataCard.cardText.noExamplesForFieldsTitle",{defaultMessage:"No examples were obtained for this field"}),iconType:"alert"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.fieldDataCard.cardText.fieldNotPresentDescription",defaultMessage:"This field was not present in the {sourceParam} field of documents queried.",values:{sourceParam:external_kbnSharedDeps_React_default.a.createElement("span",{className:"mlFieldDataCard__codeContent"},"_source")}}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.fieldDataCard.cardText.fieldMayBePopulatedDescription",defaultMessage:"It may be populated, for example, using a {copyToParam} parameter in the document mapping, or be pruned from the {sourceParam} field after indexing through the use of {includesParam} and {excludesParam} parameters.",values:{copyToParam:external_kbnSharedDeps_React_default.a.createElement("span",{className:"mlFieldDataCard__codeContent"},"copy_to"),sourceParam:external_kbnSharedDeps_React_default.a.createElement("span",{className:"mlFieldDataCard__codeContent"},"_source"),includesParam:external_kbnSharedDeps_React_default.a.createElement("span",{className:"mlFieldDataCard__codeContent"},"includes"),excludesParam:external_kbnSharedDeps_React_default.a.createElement("span",{className:"mlFieldDataCard__codeContent"},"excludes")}})))))};var ml_embedded_map=__webpack_require__(422);const GeoPointContent=({config:config,indexPattern:indexPattern,combinedQuery:combinedQuery})=>{const{stats:stats}=config,[layerList,setLayerList]=Object(external_kbnSharedDeps_React_.useState)([]),{services:{maps:mapsPlugin}}=Object(contexts_kibana.b)();return Object(external_kbnSharedDeps_React_.useEffect)(()=>{!async function(){if(void 0!==(null==indexPattern?void 0:indexPattern.id)&&void 0!==config&&void 0!==config.fieldName&&(config.type===field_types.c.GEO_POINT||config.type===field_types.c.GEO_SHAPE)){const params={indexPatternId:indexPattern.id,geoFieldName:config.fieldName,geoFieldType:config.type,query:{query:combinedQuery.searchString,language:combinedQuery.searchQueryLanguage}},searchLayerDescriptor=mapsPlugin?await mapsPlugin.createLayerDescriptors.createESSearchSourceLayerDescriptor(params):null;searchLayerDescriptor&&setLayerList([...layerList,searchLayerDescriptor])}}()},[indexPattern,config.fieldName,combinedQuery]),void 0===(null==stats?void 0:stats.examples)?null:external_kbnSharedDeps_React_default.a.createElement(ExpandedRowContent,{dataTestSubj:"mlDVIndexBasedMapContent"},external_kbnSharedDeps_React_default.a.createElement(DocumentStatsTable,{config:config}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{style:{maxWidth:"50%"}},external_kbnSharedDeps_React_default.a.createElement(ExamplesList,{examples:stats.examples})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{className:"mlDataVisualizerMapWrapper"},external_kbnSharedDeps_React_default.a.createElement(ml_embedded_map.a,{layerList:layerList})))},IndexBasedDataVisualizerExpandedRow=({item:item,indexPattern:indexPattern,combinedQuery:combinedQuery})=>{const config=item,{loading:loading,type:type,existsInDocs:existsInDocs,fieldName:fieldName}=config;return external_kbnSharedDeps_React_default.a.createElement("div",{className:"mlDataVisualizerFieldExpandedRow","data-test-subj":"mlDataVisualizerFieldExpandedRow-"+fieldName},!0===loading?external_kbnSharedDeps_React_default.a.createElement(LoadingIndicator,null):function(){if(!1===existsInDocs)return external_kbnSharedDeps_React_default.a.createElement(NotInDocsContent,null);switch(type){case field_types.c.NUMBER:return external_kbnSharedDeps_React_default.a.createElement(NumberContent,{config:config});case field_types.c.BOOLEAN:return external_kbnSharedDeps_React_default.a.createElement(BooleanContent,{config:config});case field_types.c.DATE:return external_kbnSharedDeps_React_default.a.createElement(DateContent,{config:config});case field_types.c.GEO_POINT:case field_types.c.GEO_SHAPE:return external_kbnSharedDeps_React_default.a.createElement(GeoPointContent,{config:config,indexPattern:indexPattern,combinedQuery:combinedQuery});case field_types.c.IP:return external_kbnSharedDeps_React_default.a.createElement(IpContent,{config:config});case field_types.c.KEYWORD:return external_kbnSharedDeps_React_default.a.createElement(KeywordContent,{config:config});case field_types.c.TEXT:return external_kbnSharedDeps_React_default.a.createElement(TextContent,{config:config});default:return external_kbnSharedDeps_React_default.a.createElement(OtherContent,{config:config})}}())},TOP_VALUES_LABEL=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataVisualizer.lensChart.topValuesLabel",{defaultMessage:"Top values"}),COUNT=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataVisualizer.lensChart.countLabel",{defaultMessage:"Count"});function getColumnsAndLayer(fieldType,item,defaultIndexPattern){if(void 0!==item.fieldName)return fieldType===field_types.c.DATE?function(item){return{columns:{col2:{dataType:"number",isBucketed:!1,label:COUNT,operationType:"count",scale:"ratio",sourceField:"Records"},col1:{dataType:"date",isBucketed:!0,label:item.fieldName,operationType:"date_histogram",params:{interval:"auto"},scale:"interval",sourceField:item.fieldName}},layer:{accessors:["col2"],layerId:"layer1",seriesType:"line",xAccessor:"col1"}}}(item):fieldType===field_types.c.NUMBER?function(item,defaultIndexPattern){if(void 0===defaultIndexPattern.timeFieldName){return{columns:{col1:{label:item.fieldName,dataType:"number",isBucketed:!0,operationType:"range",params:{type:"histogram",maxBars:"auto",ranges:[]},sourceField:item.fieldName},col2:{label:COUNT,dataType:"number",isBucketed:!1,sourceField:"Records",operationType:"count"}},layer:{accessors:["col2"],layerId:"layer1",seriesType:"bar",xAccessor:"col1"}}}return{columns:{col2:{dataType:"number",isBucketed:!1,label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataVisualizer.lensChart.averageOfLabel",{defaultMessage:"Average of {fieldName}",values:{fieldName:item.fieldName}}),operationType:"average",sourceField:item.fieldName},col1:{dataType:"date",isBucketed:!0,label:defaultIndexPattern.timeFieldName,operationType:"date_histogram",params:{interval:"auto"},scale:"interval",sourceField:defaultIndexPattern.timeFieldName}},layer:{accessors:["col2"],layerId:"layer1",seriesType:"line",xAccessor:"col1"}}}(item,defaultIndexPattern):fieldType===field_types.c.IP||fieldType===field_types.c.KEYWORD?function(item){return{columns:{col1:{label:TOP_VALUES_LABEL,dataType:"string",isBucketed:!0,operationType:"terms",params:{orderBy:{type:"column",columnId:"col2"},size:10,orderDirection:"desc"},sourceField:item.fieldName},col2:{label:COUNT,dataType:"number",isBucketed:!1,sourceField:"Records",operationType:"count"}},layer:{accessors:["col2"],layerId:"layer1",seriesType:"bar",xAccessor:"col1"}}}(item):fieldType===field_types.c.BOOLEAN?function(item){return{columns:{col1:{label:TOP_VALUES_LABEL,dataType:"string",isBucketed:!0,operationType:"terms",params:{orderBy:{type:"alphabetical"},size:2,orderDirection:"desc"},sourceField:item.fieldName},col2:{label:COUNT,dataType:"number",isBucketed:!1,sourceField:"Records",operationType:"count"}},layer:{accessors:["col2"],layerId:"layer1",seriesType:"bar",xAccessor:"col1"}}}(item):void 0}function getActions(indexPattern,lensPlugin,combinedQuery){const canUseLensEditor=lensPlugin.canUseEditor();return[{name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataVisualizer.indexBasedDataGrid.exploreInLensTitle",{defaultMessage:"Explore in Lens"}),description:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataVisualizer.indexBasedDataGrid.exploreInLensDescription",{defaultMessage:"Explore in Lens"}),type:"icon",icon:"lensApp",available:item=>void 0!==function(type){let lensType;switch(type){case field_types.c.KEYWORD:lensType="string";break;case field_types.c.DATE:lensType="date";break;case field_types.c.NUMBER:lensType="number";break;case field_types.c.IP:lensType="ip";break;case field_types.c.BOOLEAN:lensType="string";break;default:lensType=void 0}return lensType}(item.type)&&canUseLensEditor,onClick:item=>{const lensAttributes=function(defaultIndexPattern,combinedQuery,item){if(void 0===defaultIndexPattern||void 0===item.type||void 0===item.fieldName)return;const presets=getColumnsAndLayer(item.type,item,defaultIndexPattern);return presets?{visualizationType:"lnsXY",title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataVisualizer.lensChart.chartTitle",{defaultMessage:"Lens for {fieldName}",values:{fieldName:item.fieldName}}),references:[{id:defaultIndexPattern.id,name:"indexpattern-datasource-current-indexpattern",type:"index-pattern"},{id:defaultIndexPattern.id,name:"indexpattern-datasource-layer-layer1",type:"index-pattern"}],state:{datasourceStates:{indexpattern:{layers:{layer1:{columnOrder:["col1","col2"],columns:presets.columns}}}},filters:[],query:{language:combinedQuery.searchQueryLanguage,query:combinedQuery.searchString},visualization:{axisTitlesVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},fittingFunction:"None",gridlinesVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},layers:[presets.layer],legend:{isVisible:!0,position:"right"},preferredSeriesType:"line",tickLabelsVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},valueLabels:"hide"}}}:void 0}(indexPattern,combinedQuery,item);lensAttributes&&lensPlugin.navigateToPrefilledEditor({id:"ml-dataVisualizer-"+item.fieldName,attributes:lensAttributes})},"data-test-subj":"mlActionButtonViewInLens"}]}const defaultSearchQuery={match_all:{}};const index_based_page_Page=()=>{var _globalState$time,_globalState$time2,_globalState$refreshI,_globalState$refreshI2,_dataVisualizerListSt,_dataVisualizerListSt2,_dataVisualizerListSt3,_dataVisualizerListSt4;const mlContext=Object(ml.b)(),restorableDefaults={pageIndex:0,pageSize:10,sortField:"fieldName",sortDirection:"asc",visibleFieldTypes:[],visibleFieldNames:[],samplerShardSize:5e3,searchString:"",searchQuery:defaultSearchQuery,searchQueryLanguage:constants_search.c.KUERY,showDistributions:!0,showAllFields:!1,showEmptyFields:!1},{services:{lens:lensPlugin,docLinks:docLinks}}=Object(contexts_kibana.b)(),[dataVisualizerListState,setDataVisualizerListState]=Object(url_state.b)(ml_url_generator.b.DATA_VISUALIZER_INDEX_VIEWER,restorableDefaults),[currentSavedSearch,setCurrentSavedSearch]=Object(external_kbnSharedDeps_React_.useState)(mlContext.currentSavedSearch),{combinedQuery:combinedQuery,currentIndexPattern:currentIndexPattern,kibanaConfig:kibanaConfig}=mlContext,timefilter=Object(contexts_kibana.g)({timeRangeSelector:void 0!==currentIndexPattern.timeFieldName,autoRefreshSelector:!0}),{toasts:toasts}=Object(contexts_kibana.f)(),dataLoader=Object(external_kbnSharedDeps_React_.useMemo)(()=>new data_loader_DataLoader(currentIndexPattern,toasts),[currentIndexPattern]),[globalState,setGlobalState]=Object(url_state.c)("_g");Object(external_kbnSharedDeps_React_.useEffect)(()=>{void 0!==(null==globalState?void 0:globalState.time)&&timefilter.setTime({from:globalState.time.from,to:globalState.time.to})},[null==globalState||null===(_globalState$time=globalState.time)||void 0===_globalState$time?void 0:_globalState$time.from,null==globalState||null===(_globalState$time2=globalState.time)||void 0===_globalState$time2?void 0:_globalState$time2.to]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{void 0!==(null==globalState?void 0:globalState.refreshInterval)&&timefilter.setRefreshInterval(globalState.refreshInterval)},[null==globalState||null===(_globalState$refreshI=globalState.refreshInterval)||void 0===_globalState$refreshI?void 0:_globalState$refreshI.pause,null==globalState||null===(_globalState$refreshI2=globalState.refreshInterval)||void 0===_globalState$refreshI2?void 0:_globalState$refreshI2.value]);const[lastRefresh,setLastRefresh]=Object(external_kbnSharedDeps_React_.useState)(0);Object(external_kbnSharedDeps_React_.useEffect)(()=>{Object(index_utils.j)(currentIndexPattern,!0)},[]);let indexedFieldTypes=[];const indexPatternFields=currentIndexPattern.fields;indexPatternFields.forEach(field=>{if(!0!==field.scripted){const dataVisualizerType=kbnTypeToMLJobType(field);void 0===dataVisualizerType||indexedFieldTypes.includes(dataVisualizerType)||indexedFieldTypes.push(dataVisualizerType)}}),indexedFieldTypes=indexedFieldTypes.sort();const defaults={overallStats:{totalCount:0,aggregatableExistsFields:[],aggregatableNotExistsFields:[],nonAggregatableExistsFields:[],nonAggregatableNotExistsFields:[]},metricConfigs:[],totalMetricFieldCount:0,populatedMetricFieldCount:0,metricsLoaded:!1,nonMetricConfigs:[],nonMetricsLoaded:!1,documentCountStats:void 0},{searchQueryLanguage:searchQueryLanguage,searchString:searchString,searchQuery:searchQuery}=Object(external_kbnSharedDeps_React_.useMemo)(()=>{const searchData=function(savedSearch){if(!savedSearch)return;const{query:query}=Object(index_utils.f)(savedSearch),queryLanguage=query.language,qryString=query.query;let qry;if(queryLanguage===constants_search.c.KUERY){const ast=data_public_.esKuery.fromKueryExpression(qryString);qry=data_public_.esKuery.toElasticsearchQuery(ast,currentIndexPattern)}else qry=data_public_.esQuery.luceneStringToDsl(qryString),data_public_.esQuery.decorateQuery(qry,kibanaConfig.get(data_public_.UI_SETTINGS.QUERY_STRING_OPTIONS));return{searchQuery:qry,searchString:qryString,queryLanguage:queryLanguage}}(currentSavedSearch);return void 0===searchData||""!==dataVisualizerListState.searchString?{searchQuery:dataVisualizerListState.searchQuery,searchString:dataVisualizerListState.searchString,searchQueryLanguage:dataVisualizerListState.searchQueryLanguage}:{searchQuery:searchData.searchQuery,searchString:searchData.searchString,searchQueryLanguage:searchData.queryLanguage}},[currentSavedSearch,dataVisualizerListState]),samplerShardSize=null!==(_dataVisualizerListSt=dataVisualizerListState.samplerShardSize)&&void 0!==_dataVisualizerListSt?_dataVisualizerListSt:restorableDefaults.samplerShardSize,visibleFieldTypes=null!==(_dataVisualizerListSt2=dataVisualizerListState.visibleFieldTypes)&&void 0!==_dataVisualizerListSt2?_dataVisualizerListSt2:restorableDefaults.visibleFieldTypes,visibleFieldNames=null!==(_dataVisualizerListSt3=dataVisualizerListState.visibleFieldNames)&&void 0!==_dataVisualizerListSt3?_dataVisualizerListSt3:restorableDefaults.visibleFieldNames,showEmptyFields=null!==(_dataVisualizerListSt4=dataVisualizerListState.showEmptyFields)&&void 0!==_dataVisualizerListSt4?_dataVisualizerListSt4:restorableDefaults.showEmptyFields,[overallStats,setOverallStats]=Object(external_kbnSharedDeps_React_.useState)(defaults.overallStats),[documentCountStats,setDocumentCountStats]=Object(external_kbnSharedDeps_React_.useState)(defaults.documentCountStats),[metricConfigs,setMetricConfigs]=Object(external_kbnSharedDeps_React_.useState)(defaults.metricConfigs),[metricsLoaded,setMetricsLoaded]=Object(external_kbnSharedDeps_React_.useState)(defaults.metricsLoaded),[metricsStats,setMetricsStats]=Object(external_kbnSharedDeps_React_.useState)(),[nonMetricConfigs,setNonMetricConfigs]=Object(external_kbnSharedDeps_React_.useState)(defaults.nonMetricConfigs),[nonMetricsLoaded,setNonMetricsLoaded]=Object(external_kbnSharedDeps_React_.useState)(defaults.nonMetricsLoaded);function createMetricCards(){const configs=[],aggregatableExistsFields=overallStats.aggregatableExistsFields||[],allMetricFields=indexPatternFields.filter(f=>f.type===data_public_.KBN_FIELD_TYPES.NUMBER&&void 0!==f.displayName&&!0===dataLoader.isDisplayField(f.displayName)),metricExistsFields=allMetricFields.filter(f=>aggregatableExistsFields.find(existsF=>existsF.fieldName===f.displayName));if(void 0!==currentIndexPattern.timeFieldName&&configs.push({type:field_types.c.NUMBER,existsInDocs:!0,loading:!0,aggregatable:!0}),!1===metricsLoaded)return void setMetricsLoaded(!0);let aggregatableFields=overallStats.aggregatableExistsFields;allMetricFields.length!==metricExistsFields.length&&!0===metricsLoaded&&(aggregatableFields=aggregatableFields.concat(overallStats.aggregatableNotExistsFields));const metricFieldsToShow=!0===metricsLoaded&&!0===showEmptyFields?allMetricFields:metricExistsFields;metricFieldsToShow.forEach(field=>{const fieldData=aggregatableFields.find(f=>f.fieldName===field.displayName),metricConfig={...fieldData||{},fieldFormat:currentIndexPattern.getFormatterForField(field),type:field_types.c.NUMBER,loading:!0,aggregatable:!0};configs.push(metricConfig)}),setMetricsStats({totalMetricFieldsCount:allMetricFields.length,visibleMetricsCount:metricFieldsToShow.length}),setMetricConfigs(configs)}function createNonMetricCards(){const allNonMetricFields=indexPatternFields.filter(f=>f.type!==data_public_.KBN_FIELD_TYPES.NUMBER&&void 0!==f.displayName&&!0===dataLoader.isDisplayField(f.displayName)),populatedNonMetricFields=[];let nonMetricFieldData=[];const aggregatableExistsFields=overallStats.aggregatableExistsFields||[],nonAggregatableExistsFields=overallStats.nonAggregatableExistsFields||[];if(allNonMetricFields.forEach(f=>{const checkAggregatableField=aggregatableExistsFields.find(existsField=>existsField.fieldName===f.displayName);if(void 0!==checkAggregatableField)populatedNonMetricFields.push(f),nonMetricFieldData.push(checkAggregatableField);else{const checkNonAggregatableField=nonAggregatableExistsFields.find(existsField=>existsField.fieldName===f.displayName);void 0!==checkNonAggregatableField&&(populatedNonMetricFields.push(f),nonMetricFieldData.push(checkNonAggregatableField))}}),!1===nonMetricsLoaded)return void setNonMetricsLoaded(!0);allNonMetricFields.length!==nonMetricFieldData.length&&!0===showEmptyFields&&(nonMetricFieldData=nonMetricFieldData.concat(overallStats.aggregatableNotExistsFields,overallStats.nonAggregatableNotExistsFields));const configs=[];(showEmptyFields?allNonMetricFields:populatedNonMetricFields).forEach(field=>{const fieldData=nonMetricFieldData.find(f=>f.fieldName===field.displayName),nonMetricConfig={...fieldData,fieldFormat:currentIndexPattern.getFormatterForField(field),aggregatable:field.aggregatable,scripted:field.scripted,loading:fieldData.existsInDocs},dataVisualizerType=kbnTypeToMLJobType(field);void 0!==dataVisualizerType?nonMetricConfig.type=dataVisualizerType:(nonMetricConfig.type=field.type,nonMetricConfig.isUnsupportedType=!0),configs.push(nonMetricConfig)}),setNonMetricConfigs(configs)}Object(external_kbnSharedDeps_React_.useEffect)(()=>{const timeUpdateSubscription=Object(external_kbnSharedDeps_Rxjs_.merge)(timefilter.getTimeUpdate$(),timefilter_refresh_service.a).subscribe(()=>{setGlobalState({time:timefilter.getTime(),refreshInterval:timefilter.getRefreshInterval()}),setLastRefresh(Date.now())});return()=>{timeUpdateSubscription.unsubscribe()}}),Object(external_kbnSharedDeps_React_.useEffect)(()=>{!async function(){let earliest,latest;const activeBounds=timefilter.getActiveBounds();if(void 0!==currentIndexPattern.timeFieldName&&void 0===activeBounds)return;void 0!==currentIndexPattern.timeFieldName&&(earliest=activeBounds.min.valueOf(),latest=activeBounds.max.valueOf());try{const allStats=await dataLoader.loadOverallData(searchQuery,samplerShardSize,earliest,latest);setOverallStats(allStats)}catch(err){dataLoader.displayError(err)}}()},[searchQuery,samplerShardSize,lastRefresh]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{createMetricCards(),createNonMetricCards()},[overallStats,showEmptyFields]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{!async function(){if(0===metricConfigs.length)return;const configsToLoad=metricConfigs.filter(config=>!0===config.existsInDocs&&!0===config.loading);if(0===configsToLoad.length)return;const existMetricFields=configsToLoad.map(config=>{const props={fieldName:config.fieldName,type:config.type,cardinality:0};return void 0!==config.stats&&void 0!==config.stats.cardinality&&(props.cardinality=config.stats.cardinality),props}),buckets=Object(time_buckets.c)(),tf=timefilter;let earliest,latest;void 0!==currentIndexPattern.timeFieldName&&(earliest=tf.getActiveBounds().min.valueOf(),latest=tf.getActiveBounds().max.valueOf());const bounds=tf.getActiveBounds();buckets.setInterval("auto"),buckets.setBounds(bounds),buckets.setBarTarget(75);const aggInterval=buckets.getInterval();try{const metricFieldStats=await dataLoader.loadFieldStats(searchQuery,samplerShardSize,earliest,latest,existMetricFields,aggInterval.asMilliseconds()),configs=[];metricConfigs.forEach(config=>{const configWithStats={...config};void 0!==config.fieldName?(configWithStats.stats={...configWithStats.stats,...metricFieldStats.find(fieldStats=>fieldStats.fieldName===config.fieldName)},configWithStats.loading=!1,configs.push(configWithStats)):(configWithStats.stats=metricFieldStats.find(fieldStats=>void 0===fieldStats.fieldName),void 0!==configWithStats.stats&&(configWithStats.stats.timeRangeEarliest=earliest,configWithStats.stats.timeRangeLatest=latest),setDocumentCountStats(configWithStats))}),setMetricConfigs(configs)}catch(err){dataLoader.displayError(err)}}()},[metricConfigs]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{!async function(){if(0===nonMetricConfigs.length)return;const configsToLoad=nonMetricConfigs.filter(config=>!0===config.existsInDocs&&!0===config.loading);if(0===configsToLoad.length)return;const existNonMetricFields=configsToLoad.map(config=>{const props={fieldName:config.fieldName,type:config.type,cardinality:0};return void 0!==config.stats&&void 0!==config.stats.cardinality&&(props.cardinality=config.stats.cardinality),props}),tf=timefilter;let earliest,latest;void 0!==currentIndexPattern.timeFieldName&&(earliest=tf.getActiveBounds().min.valueOf(),latest=tf.getActiveBounds().max.valueOf());try{const nonMetricFieldStats=await dataLoader.loadFieldStats(searchQuery,samplerShardSize,earliest,latest,existNonMetricFields),configs=[];nonMetricConfigs.forEach(config=>{const configWithStats={...config};void 0!==config.fieldName&&(configWithStats.stats={...configWithStats.stats,...nonMetricFieldStats.find(fieldStats=>fieldStats.fieldName===config.fieldName)}),configWithStats.loading=!1,configs.push(configWithStats)}),setNonMetricConfigs(configs)}catch(err){dataLoader.displayError(err)}}()},[nonMetricConfigs]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{createMetricCards()},[metricsLoaded]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{createNonMetricCards()},[nonMetricsLoaded]);const configs=Object(external_kbnSharedDeps_React_.useMemo)(()=>{let combinedConfigs=[...nonMetricConfigs,...metricConfigs];return visibleFieldTypes&&visibleFieldTypes.length>0&&(combinedConfigs=combinedConfigs.filter(config=>visibleFieldTypes.findIndex(field=>field===config.type)>-1)),visibleFieldNames&&visibleFieldNames.length>0&&(combinedConfigs=combinedConfigs.filter(config=>visibleFieldNames.findIndex(field=>field===config.fieldName)>-1)),combinedConfigs},[nonMetricConfigs,metricConfigs,visibleFieldTypes,visibleFieldNames]),fieldsCountStats=Object(external_kbnSharedDeps_React_.useMemo)(()=>{let _visibleFieldsCount=0,_totalFieldsCount=0;return Object.keys(overallStats).forEach(key=>{const fieldsGroup=overallStats[key];Array.isArray(fieldsGroup)&&fieldsGroup.length>0&&(_totalFieldsCount+=fieldsGroup.length)}),_visibleFieldsCount=!0===showEmptyFields?_totalFieldsCount:overallStats.aggregatableExistsFields.length+overallStats.nonAggregatableExistsFields.length,{visibleFieldsCount:_visibleFieldsCount,totalFieldsCount:_totalFieldsCount}},[overallStats,showEmptyFields]),getItemIdToExpandedRowMap=Object(external_kbnSharedDeps_React_.useCallback)((function(itemIds,items){return itemIds.reduce((m,fieldName)=>{const item=items.find(fieldVisConfig=>fieldVisConfig.fieldName===fieldName);return void 0!==item&&(m[fieldName]=external_kbnSharedDeps_React_default.a.createElement(IndexBasedDataVisualizerExpandedRow,{item:item,indexPattern:currentIndexPattern,combinedQuery:{searchQueryLanguage:searchQueryLanguage,searchString:searchString}})),m},{})}),[currentIndexPattern,searchQuery]),extendedColumns=Object(external_kbnSharedDeps_React_.useMemo)(()=>{if(void 0===lensPlugin)return void console.error("Lens plugin not available");return[{name:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataVisualizer.indexBasedDataGrid.actionsColumnLabel",defaultMessage:"Actions"}),actions:getActions(currentIndexPattern,lensPlugin,{searchQueryLanguage:searchQueryLanguage,searchString:searchString}),width:"100px"}]},[currentIndexPattern,lensPlugin,searchQueryLanguage,searchString]),helpLink=docLinks.links.ml.guide;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(navigation_menu.a,{tabId:"datavisualizer"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPage,{"data-test-subj":"mlPageIndexDataVisualizer"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageBody,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"m"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageContentHeader,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageContentHeaderSection,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"l"},external_kbnSharedDeps_React_default.a.createElement("h1",null,currentIndexPattern.title))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageContentHeaderSection,{"data-test-subj":"mlDataVisualizerTimeRangeSelectorSection"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",justifyContent:"flexEnd",gutterSize:"s"},void 0!==currentIndexPattern.timeFieldName&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(FullTimeRangeSelector,{indexPattern:currentIndexPattern,query:combinedQuery,disabled:!1})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(date_picker_wrapper.a,null))))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageContentBody,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"m"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPanel,null,void 0!==(null==overallStats?void 0:overallStats.totalCount)&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!0},external_kbnSharedDeps_React_default.a.createElement(DocumentCountContent,{config:documentCountStats,totalCount:overallStats.totalCount})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(SearchPanel,{indexPattern:currentIndexPattern,searchString:searchString,searchQuery:searchQuery,searchQueryLanguage:searchQueryLanguage,setSearchParams:searchParams=>{null!==currentSavedSearch&&setCurrentSavedSearch(null),setDataVisualizerListState({...dataVisualizerListState,searchQuery:searchParams.searchQuery,searchString:searchParams.searchString,searchQueryLanguage:searchParams.queryLanguage})},samplerShardSize:samplerShardSize,setSamplerShardSize:value=>{setDataVisualizerListState({...dataVisualizerListState,samplerShardSize:value})},overallStats:overallStats,indexedFieldTypes:indexedFieldTypes,setVisibleFieldTypes:values=>{setDataVisualizerListState({...dataVisualizerListState,visibleFieldTypes:values})},visibleFieldTypes:visibleFieldTypes,visibleFieldNames:visibleFieldNames,setVisibleFieldNames:values=>{setDataVisualizerListState({...dataVisualizerListState,visibleFieldNames:values})},showEmptyFields:showEmptyFields}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(FieldCountPanel,{showEmptyFields:showEmptyFields,toggleShowEmptyFields:()=>{setDataVisualizerListState({...dataVisualizerListState,showEmptyFields:!dataVisualizerListState.showEmptyFields})},fieldsCountStats:fieldsCountStats,metricsStats:metricsStats}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(DataVisualizerTable,{items:configs,pageState:dataVisualizerListState,updatePageState:setDataVisualizerListState,getItemIdToExpandedRowMap:getItemIdToExpandedRowMap,extendedColumns:extendedColumns}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,style:{width:"280px"}},external_kbnSharedDeps_React_default.a.createElement(ActionsPanel,{indexPattern:currentIndexPattern,searchQueryLanguage:searchQueryLanguage,searchString:searchString})))))),external_kbnSharedDeps_React_default.a.createElement(help_menu.a,{docLink:helpLink}))};function index_based_extends(){return(index_based_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const indexBasedRouteFactory=(navigateToPath,basePath)=>({path:"/jobs/new_job/datavisualizer",render:(props,deps)=>external_kbnSharedDeps_React_default.a.createElement(index_based_PageWrapper,index_based_extends({},props,{deps:deps})),breadcrumbs:[getBreadcrumbWithUrlForApp("ML_BREADCRUMB",navigateToPath,basePath),getBreadcrumbWithUrlForApp("DATA_VISUALIZER_BREADCRUMB",navigateToPath,basePath),{text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataFrameAnalyticsBreadcrumbs.indexLabel",{defaultMessage:"Index"}),href:""}]}),index_based_PageWrapper=({location:location,deps:deps})=>{const{redirectToMlAccessDeniedPage:redirectToMlAccessDeniedPage}=deps,redirectToJobsManagementPage=Object(use_create_url.a)(ml_url_generator.b.ANOMALY_DETECTION_JOBS_MANAGE),{index:index,savedSearchId:savedSearchId}=Object(query_string.parse)(location.search,{sort:!1}),{context:context}=useResolver(index,savedSearchId,deps.config,{checkBasicLicense:license.a,loadIndexPatterns:()=>Object(index_utils.h)(deps.indexPatterns),checkGetJobsCapabilities:()=>Object(check_capabilities.c)(redirectToMlAccessDeniedPage),checkMlNodesAvailable:()=>Object(ml_nodes_check.a)(redirectToJobsManagementPage)});return external_kbnSharedDeps_React_default.a.createElement(PageLoader,{context:context},external_kbnSharedDeps_React_default.a.createElement(index_based_page_Page,null))},FileDataVisualizerPage=()=>{Object(contexts_kibana.g)({timeRangeSelector:!1,autoRefreshSelector:!1});const{services:{docLinks:docLinks,fileDataVisualizer:fileDataVisualizer}}=Object(contexts_kibana.b)(),[FileDataVisualizer,setFileDataVisualizer]=Object(external_kbnSharedDeps_React_.useState)(null);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{if(void 0!==fileDataVisualizer){const{getFileDataVisualizerComponent:getFileDataVisualizerComponent}=fileDataVisualizer;getFileDataVisualizerComponent().then(setFileDataVisualizer)}},[]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(navigation_menu.a,{tabId:"datavisualizer"}),FileDataVisualizer,external_kbnSharedDeps_React_default.a.createElement(help_menu.a,{docLink:docLinks.links.ml.guide}))};function file_based_extends(){return(file_based_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const fileBasedRouteFactory=(navigateToPath,basePath)=>({path:"/filedatavisualizer",render:(props,deps)=>external_kbnSharedDeps_React_default.a.createElement(file_based_PageWrapper,file_based_extends({},props,{deps:deps})),breadcrumbs:[getBreadcrumbWithUrlForApp("ML_BREADCRUMB",navigateToPath,basePath),getBreadcrumbWithUrlForApp("DATA_VISUALIZER_BREADCRUMB",navigateToPath,basePath),{text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataVisualizer.fileBasedLabel",{defaultMessage:"File"}),href:""}]}),file_based_PageWrapper=({deps:deps})=>{const{redirectToMlAccessDeniedPage:redirectToMlAccessDeniedPage}=deps,{context:context}=useResolver(void 0,void 0,deps.config,{checkBasicLicense:license.a,loadIndexPatterns:()=>Object(index_utils.h)(deps.indexPatterns),checkFindFileStructurePrivilege:()=>Object(check_capabilities.b)(redirectToMlAccessDeniedPage)});return external_kbnSharedDeps_React_default.a.createElement(PageLoader,{context:context},external_kbnSharedDeps_React_default.a.createElement(FileDataVisualizerPage,null))},AnomalyDetectionSettingsContext=Object(external_kbnSharedDeps_React_.createContext)({canGetFilters:!1,canCreateFilter:!1,canGetCalendars:!1,canCreateCalendar:!1}),AnomalyDetectionSettings=()=>{const[calendarsCount,setCalendarsCount]=Object(external_kbnSharedDeps_React_.useState)(0),[filterListsCount,setFilterListsCount]=Object(external_kbnSharedDeps_React_.useState)(0),{canGetFilters:canGetFilters,canCreateFilter:canCreateFilter,canGetCalendars:canGetCalendars,canCreateCalendar:canCreateCalendar}=Object(external_kbnSharedDeps_React_.useContext)(AnomalyDetectionSettingsContext),{toasts:toasts}=Object(contexts_kibana.f)(),redirectToCalendarList=Object(use_create_url.a)(ml_url_generator.b.CALENDARS_MANAGE),redirectToNewCalendarPage=Object(use_create_url.a)(ml_url_generator.b.CALENDARS_NEW),redirectToFilterLists=Object(use_create_url.a)(ml_url_generator.b.FILTER_LISTS_MANAGE),redirectToNewFilterListPage=Object(use_create_url.a)(ml_url_generator.b.FILTER_LISTS_NEW);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{!async function(){if(!0===canGetCalendars)try{const calendars=await ml_api_service.ml.calendars();setCalendarsCount(calendars.length)}catch(e){toasts.addDanger(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.settings.anomalyDetection.loadingCalendarsCountErrorMessage",{defaultMessage:"An error occurred obtaining the count of calendars"}))}if(!0===canGetFilters)try{const filterLists=await ml_api_service.ml.filters.filtersStats();setFilterListsCount(filterLists.length)}catch(e){toasts.addDanger(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.settings.anomalyDetection.loadingFilterListCountErrorMessage",{defaultMessage:"An error occurred obtaining the count of filter lists"}))}}()},[]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageContent,{className:"mlSettingsPage__content",horizontalPosition:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageContentHeader,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,null,external_kbnSharedDeps_React_default.a.createElement("h2",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.settings.anomalyDetection.anomalyDetectionTitle",defaultMessage:"Anomaly Detection"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"xl"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:5},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"s"},external_kbnSharedDeps_React_default.a.createElement("h3",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.settings.anomalyDetection.calendarsTitle",defaultMessage:"Calendars"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTextColor,{color:"subdued"},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.settings.anomalyDetection.calendarsText",defaultMessage:"Calendars contain a list of scheduled events for which you do not want to generate anomalies, such as planned system outages or public holidays."})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center"},canGetCalendars&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,style:{display:"block"}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.settings.anomalyDetection.calendarsSummaryCount",defaultMessage:"You have {calendarsCountBadge} {calendarsCount, plural, one {calendar} other {calendars}}",values:{calendarsCountBadge:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBadge,null,calendarsCount),calendarsCount:calendarsCount}}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{"data-test-subj":"mlCalendarsMngButton",flush:"left",size:"l",color:"primary",onClick:redirectToCalendarList,isDisabled:!1===canGetCalendars},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.settings.anomalyDetection.manageCalendarsLink",defaultMessage:"Manage"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{"data-test-subj":"mlCalendarsCreateButton",flush:"left",size:"l",color:"primary",onClick:redirectToNewCalendarPage,isDisabled:!1===canCreateCalendar},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.settings.anomalyDetection.createCalendarLink",defaultMessage:"Create"}))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:5},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"s"},external_kbnSharedDeps_React_default.a.createElement("h3",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.settings.anomalyDetection.filterListsTitle",defaultMessage:"Filter Lists"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTextColor,{color:"subdued"},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.settings.anomalyDetection.filterListsText",defaultMessage:"Filter lists contain values that you can use to include or exclude events from the machine learning analysis."})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center"},canGetFilters&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.settings.anomalyDetection.filterListsSummaryCount",defaultMessage:"You have {filterListsCountBadge} {filterListsCount, plural, one {filter list} other {filter lists}}",values:{filterListsCountBadge:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBadge,null,filterListsCount),filterListsCount:filterListsCount}}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{"data-test-subj":"mlFilterListsMngButton",flush:"left",size:"l",color:"primary",onClick:redirectToFilterLists,isDisabled:!1===canGetFilters},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.settings.anomalyDetection.manageFilterListsLink",defaultMessage:"Manage"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{"data-test-subj":"mlFilterListsCreateButton",size:"l",color:"primary",onClick:redirectToNewFilterListPage,isDisabled:!1===canCreateFilter},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.settings.anomalyDetection.createFilterListsLink",defaultMessage:"Create"}))))))))},Settings=()=>{const{services:{docLinks:docLinks}}=Object(contexts_kibana.b)(),helpLink=docLinks.links.ml.guide;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(navigation_menu.a,{tabId:"settings"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPage,{className:"mlSettingsPage","data-test-subj":"mlPageSettings"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageBody,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageHeader,{className:"mlSettingsPage__header"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageHeaderSection,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,null,external_kbnSharedDeps_React_default.a.createElement("h1",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.settings.title",defaultMessage:"Settings"}))))),external_kbnSharedDeps_React_default.a.createElement(AnomalyDetectionSettings,null))),external_kbnSharedDeps_React_default.a.createElement(help_menu.a,{docLink:helpLink}))};function settings_extends(){return(settings_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const settingsRouteFactory=(navigateToPath,basePath)=>({path:"/settings",render:(props,deps)=>external_kbnSharedDeps_React_default.a.createElement(settings_PageWrapper,settings_extends({},props,{deps:deps})),breadcrumbs:[getBreadcrumbWithUrlForApp("ML_BREADCRUMB",navigateToPath,basePath),getBreadcrumbWithUrlForApp("SETTINGS_BREADCRUMB",navigateToPath,basePath)]}),settings_PageWrapper=({deps:deps})=>{const{redirectToMlAccessDeniedPage:redirectToMlAccessDeniedPage}=deps,{context:context}=useResolver(void 0,void 0,deps.config,{checkFullLicense:license.b,checkGetJobsCapabilities:()=>Object(check_capabilities.c)(redirectToMlAccessDeniedPage),getMlNodeCount:check_ml_nodes.c});Object(contexts_kibana.g)({timeRangeSelector:!1,autoRefreshSelector:!1});const canGetFilters=Object(check_capabilities.e)("canGetFilters"),canCreateFilter=Object(check_capabilities.e)("canCreateFilter"),canGetCalendars=Object(check_capabilities.e)("canGetCalendars"),canCreateCalendar=Object(check_capabilities.e)("canCreateCalendar");return external_kbnSharedDeps_React_default.a.createElement(PageLoader,{context:context},external_kbnSharedDeps_React_default.a.createElement(AnomalyDetectionSettingsContext.Provider,{value:{canGetFilters:canGetFilters,canCreateFilter:canCreateFilter,canGetCalendars:canGetCalendars,canCreateCalendar:canCreateCalendar}},external_kbnSharedDeps_React_default.a.createElement(Settings,null)))};function generateTempId(){return Math.random().toString(36).substr(2,9)}function DeleteButton({onClick:onClick,canDeleteCalendar:canDeleteCalendar,testSubj:testSubj}){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{size:"xs",color:"danger",onClick:onClick,isDisabled:!1===canDeleteCalendar,"data-test-subj":testSubj},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.calendarsEdit.eventsTable.deleteButtonLabel",defaultMessage:"Delete"})))}const EventsTable=({canCreateCalendar:canCreateCalendar,canDeleteCalendar:canDeleteCalendar,eventsList:eventsList,onDeleteClick:onDeleteClick,showSearchBar:showSearchBar,showImportModal:showImportModal,showNewEventModal:showNewEventModal})=>{const columns=[{field:"description",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.calendarsEdit.eventsTable.descriptionColumnName",{defaultMessage:"Description"}),sortable:!0,truncateText:!0,scope:"row"},{field:"start_time",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.calendarsEdit.eventsTable.startColumnName",{defaultMessage:"Start"}),sortable:!0,render:timeMs=>external_kbnSharedDeps_Moment_default()(timeMs).format(time_format.a)},{field:"end_time",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.calendarsEdit.eventsTable.endColumnName",{defaultMessage:"End"}),sortable:!0,render:timeMs=>external_kbnSharedDeps_Moment_default()(timeMs).format(time_format.a)},{field:"",name:"",render:event=>external_kbnSharedDeps_React_default.a.createElement(DeleteButton,{testSubj:"mlCalendarEventDeleteButton",canDeleteCalendar:canDeleteCalendar,onClick:()=>{onDeleteClick(event.event_id)}})}],search={toolsRight:[external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{isDisabled:!1===canCreateCalendar,key:"ml_new_event","data-test-subj":"mlCalendarNewEventButton",size:"s",iconType:"plusInCircle",onClick:showNewEventModal},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.calendarsEdit.eventsTable.newEventButtonLabel",defaultMessage:"New event"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{isDisabled:!1===canCreateCalendar,key:"ml_import_event","data-test-subj":"mlCalendarImportEventsButton",size:"s",iconType:"importAction",onClick:showImportModal},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.calendarsEdit.eventsTable.importEventsButtonLabel",defaultMessage:"Import events"}))],box:{incremental:!0},filters:[]};return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiInMemoryTable,{items:eventsList,itemId:"event_id",columns:columns,pagination:{initialPageSize:5,pageSizeOptions:[5,10]},sorting:{sort:{field:"description",direction:"asc"}},search:showSearchBar?search:void 0,"data-test-subj":"mlCalendarEventsTable",rowProps:item=>({"data-test-subj":"mlCalendarEventListRow row-"+item.description})}))};function EditHeader({calendarId:calendarId,description:description}){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{"data-test-subj":"mlCalendarTitle"},external_kbnSharedDeps_React_default.a.createElement("h1",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.calendarsEdit.calendarForm.calendarTitle",defaultMessage:"Calendar {calendarId}",values:{calendarId:calendarId}}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{"data-test-subj":"mlCalendarDescriptionText"},external_kbnSharedDeps_React_default.a.createElement("p",null,description)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"}))}EventsTable.defaultProps={showSearchBar:!1,canCreateCalendar:!0,canDeleteCalendar:!0};const CalendarForm=({calendarId:calendarId,canCreateCalendar:canCreateCalendar,canDeleteCalendar:canDeleteCalendar,description:description,eventsList:eventsList,groupIds:groupIds,isEdit:isEdit,isNewCalendarIdValid:isNewCalendarIdValid,jobIds:jobIds,onCalendarIdChange:onCalendarIdChange,onCreate:onCreate,onCreateGroupOption:onCreateGroupOption,onDescriptionChange:onDescriptionChange,onEdit:onEdit,onEventDelete:onEventDelete,onGroupSelection:onGroupSelection,showImportModal:showImportModal,onJobSelection:onJobSelection,saving:saving,selectedGroupOptions:selectedGroupOptions,selectedJobOptions:selectedJobOptions,showNewEventModal:showNewEventModal,isGlobalCalendar:isGlobalCalendar,onGlobalCalendarChange:onGlobalCalendarChange})=>{const msg=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.calendarsEdit.calendarForm.allowedCharactersDescription",{defaultMessage:"Use lowercase alphanumerics (a-z and 0-9), hyphens or underscores; must start and end with an alphanumeric character"}),helpText=!0!==isNewCalendarIdValid||isEdit?void 0:msg,error=!1!==isNewCalendarIdValid||isEdit?void 0:[msg],saveButtonDisabled=!1===canCreateCalendar||saving||!isNewCalendarIdValid||""===calendarId,redirectToCalendarsManagementPage=Object(use_create_url.a)(ml_url_generator.b.CALENDARS_MANAGE);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiForm,{"data-test-subj":"mlCalendarForm"+(!0===isEdit?"Edit":"New")},!0===isEdit?external_kbnSharedDeps_React_default.a.createElement(EditHeader,{calendarId:calendarId,description:description}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,null,external_kbnSharedDeps_React_default.a.createElement("h1",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.calendarsEdit.calendarForm.createCalendarTitle",defaultMessage:"Create new calendar"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.calendarsEdit.calendarForm.calendarIdLabel",defaultMessage:"Calendar ID"}),helpText:helpText,error:error,isInvalid:!isNewCalendarIdValid},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldText,{name:"calendarId",value:calendarId,onChange:onCalendarIdChange,disabled:!0===isEdit||!0===saving,"data-test-subj":"mlCalendarIdInput"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.calendarsEdit.calendarForm.descriptionLabel",defaultMessage:"Description"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldText,{name:"description",value:description,onChange:onDescriptionChange,disabled:!0===isEdit||!0===saving,"data-test-subj":"mlCalendarDescriptionInput"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"xl"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSwitch,{name:"switch",label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.calendarsEdit.calendarForm.allJobsLabel",defaultMessage:"Apply calendar to all jobs"}),checked:isGlobalCalendar,onChange:onGlobalCalendarChange,disabled:!0===saving||!1===canCreateCalendar,"data-test-subj":"mlCalendarApplyToAllJobsSwitch"}),!1===isGlobalCalendar&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.calendarsEdit.calendarForm.jobsLabel",defaultMessage:"Jobs"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiComboBox,{options:jobIds,selectedOptions:selectedJobOptions,onChange:onJobSelection,isDisabled:!0===saving||!1===canCreateCalendar,"data-test-subj":"mlCalendarJobSelection"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.calendarsEdit.calendarForm.groupsLabel",defaultMessage:"Groups"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiComboBox,{onCreateOption:onCreateGroupOption,options:groupIds,selectedOptions:selectedGroupOptions,onChange:onGroupSelection,isDisabled:!0===saving||!1===canCreateCalendar,"data-test-subj":"mlCalendarJobGroupSelection"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"xl"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.calendarsEdit.calendarForm.eventsLabel",defaultMessage:"Events"}),fullWidth:!0},external_kbnSharedDeps_React_default.a.createElement(EventsTable,{canCreateCalendar:canCreateCalendar,canDeleteCalendar:canDeleteCalendar,eventsList:eventsList,onDeleteClick:onEventDelete,showImportModal:showImportModal,showNewEventModal:showNewEventModal,showSearchBar:!0})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"flexEnd"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{isDisabled:saving,onClick:redirectToCalendarsManagementPage},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.calendarsEdit.calendarForm.cancelButtonLabel",defaultMessage:"Cancel"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{"data-test-subj":"mlSaveCalendarButton",fill:!0,onClick:isEdit?onEdit:onCreate,isDisabled:saveButtonDisabled},saving?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.calendarsEdit.calendarForm.savingButtonLabel",defaultMessage:"Saving…"}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.calendarsEdit.calendarForm.saveButtonLabel",defaultMessage:"Save"})))))};function new_event_modal_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class new_event_modal_NewEventModal extends external_kbnSharedDeps_React_.Component{constructor(props){super(props),new_event_modal_defineProperty(this,"onDescriptionChange",e=>{this.setState({description:e.target.value})}),new_event_modal_defineProperty(this,"handleAddEvent",()=>{const{description:description,startDate:startDate,endDate:endDate}=this.state,tempId=generateTempId(),event={description:description,start_time:startDate.valueOf(),end_time:endDate.valueOf(),event_id:tempId};this.props.addEvent(event)}),new_event_modal_defineProperty(this,"handleChangeStart",date=>{let start=null,end=this.state.endDate;const startMoment=external_kbnSharedDeps_Moment_default()(date),endMoment=external_kbnSharedDeps_Moment_default()(date);start=startMoment.startOf("day"),start>end&&(end=endMoment.startOf("day").add(1,"days")),this.setState({startDate:start,endDate:end,startDateString:start.format(time_format.a),endDateString:end.format(time_format.a)})}),new_event_modal_defineProperty(this,"handleChangeEnd",date=>{let start=this.state.startDate,end=null;const startMoment=external_kbnSharedDeps_Moment_default()(date);end=external_kbnSharedDeps_Moment_default()(date).startOf("day"),start>end&&(start=startMoment.startOf("day").subtract(1,"days")),this.setState({startDate:start,endDate:end,startDateString:start.format(time_format.a),endDateString:end.format(time_format.a)})}),new_event_modal_defineProperty(this,"handleTimeStartChange",event=>{const dateString=event.target.value;let isValidDate=!1;19===dateString.length?isValidDate=external_kbnSharedDeps_Moment_default()(dateString).isValid(time_format.a,!0):this.setState({startDateString:dateString}),isValidDate&&this.setState({startDateString:dateString,startDate:external_kbnSharedDeps_Moment_default()(dateString)})}),new_event_modal_defineProperty(this,"handleTimeEndChange",event=>{const dateString=event.target.value;let isValidDate=!1;19===dateString.length?isValidDate=external_kbnSharedDeps_Moment_default()(dateString).isValid(time_format.a,!0):this.setState({endDateString:dateString}),isValidDate&&this.setState({endDateString:dateString,endDate:external_kbnSharedDeps_Moment_default()(dateString)})}),new_event_modal_defineProperty(this,"renderRangedDatePicker",()=>{const{startDate:startDate,endDate:endDate,startDateString:startDateString,endDateString:endDateString}=this.state,timeInputs=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.calendarsEdit.newEventModal.fromLabel",defaultMessage:"From:"}),helpText:time_format.a},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldText,{name:"startTime",onChange:this.handleTimeStartChange,placeholder:time_format.a,value:startDateString}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.calendarsEdit.newEventModal.toLabel",defaultMessage:"To:"}),helpText:time_format.a},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldText,{name:"endTime",onChange:this.handleTimeEndChange,placeholder:time_format.a,value:endDateString})))));return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),timeInputs,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{fullWidth:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDatePickerRange,{fullWidth:!0,iconType:!1,startDateControl:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDatePicker,{fullWidth:!0,inline:!0,selected:startDate,onChange:this.handleChangeStart,startDate:startDate,endDate:endDate,isInvalid:startDate>endDate,"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.calendarsEdit.newEventModal.startDateAriaLabel",{defaultMessage:"Start date"}),timeFormat:time_format.a,dateFormat:time_format.a}),endDateControl:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDatePicker,{fullWidth:!0,inline:!0,selected:endDate,onChange:this.handleChangeEnd,startDate:startDate,endDate:endDate,isInvalid:startDate>endDate,"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.calendarsEdit.newEventModal.endDateAriaLabel",{defaultMessage:"End date"}),timeFormat:time_format.a,dateFormat:time_format.a})})))});const _startDate=external_kbnSharedDeps_Moment_default()().startOf("day"),_endDate=external_kbnSharedDeps_Moment_default()().startOf("day").add(1,"days");this.state={startDate:_startDate,endDate:_endDate,description:"",startDateString:_startDate.format(time_format.a),endDateString:_endDate.format(time_format.a)}}render(){const{closeModal:closeModal}=this.props,{description:description}=this.state;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModal,{onClose:closeModal,initialFocus:"[name=eventDescription]",maxWidth:!1,"data-test-subj":"mlCalendarEventForm"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalHeader,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalHeaderTitle,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.calendarsEdit.newEventModal.createNewEventTitle",defaultMessage:"Create new event"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalBody,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiForm,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.calendarsEdit.newEventModal.descriptionLabel",defaultMessage:"Description"}),fullWidth:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldText,{name:"eventDescription",onChange:this.onDescriptionChange,isInvalid:!description,fullWidth:!0,"data-test-subj":"mlCalendarEventDescriptionInput"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),this.renderRangedDatePicker())),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalFooter,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{onClick:closeModal,"data-test-subj":"mlCalendarCancelEventButton"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.calendarsEdit.newEventModal.cancelButtonLabel",defaultMessage:"Cancel"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{onClick:this.handleAddEvent,fill:!0,disabled:!description,"data-test-subj":"mlCalendarAddEventButton"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.calendarsEdit.newEventModal.addButtonLabel",defaultMessage:"Add"})))))}}function ImportedEvents({events:events,showRecurringWarning:showRecurringWarning,includePastEvents:includePastEvents,onCheckboxToggle:onCheckboxToggle,onEventDelete:onEventDelete}){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement("h4",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.calendarsEdit.importedEvents.eventsToImportTitle",defaultMessage:"Events to import: {eventsCount}",values:{eventsCount:events.length}})),showRecurringWarning&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{color:"danger"},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.calendarsEdit.importedEvents.recurringEventsNotSupportedDescription",defaultMessage:"Recurring events not supported. Only the first event will be imported."}))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(EventsTable,{eventsList:events,onDeleteClick:onEventDelete})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCheckbox,{id:"ml-include-past-events",label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.calendarsEdit.importedEvents.includePastEventsLabel",defaultMessage:"Include past events"}),checked:includePastEvents,onChange:onCheckboxToggle})))}var lib=__webpack_require__(323),lib_default=__webpack_require__.n(lib);function filterEvents(events){const now=external_kbnSharedDeps_Moment_default()().valueOf();return events.filter(e=>e.start_time>now)}function parseICSFile(data){return function(ical){const events=ical.events(),mlEvents=[];return events.forEach(e=>{if("VEVENT"===e.element){const description=e.properties.SUMMARY,start=e.properties.DTSTART,end=e.properties.DTEND,recurring=void 0!==e.properties.RRULE;if(description&&start&&end&&description.length&&start.length&&end.length){const tempId=generateTempId();mlEvents.push({event_id:tempId,description:description[0].value,start_time:start[0].value.valueOf(),end_time:end[0].value.valueOf(),asterisk:recurring})}}}),mlEvents}(lib_default.a.parse_calendar(data+"\n"))}function import_modal_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class import_modal_ImportModal extends external_kbnSharedDeps_React_.Component{constructor(props){super(props),import_modal_defineProperty(this,"handleImport",async loadedFile=>{const incomingFile=loadedFile[0],errorMessage=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.calendarsEdit.importModal.couldNotParseICSFileErrorMessage",{defaultMessage:"Could not parse ICS file."});let events=[];if(incomingFile&&incomingFile.size<=1e8){this.setState({fileLoading:!0,fileLoaded:!0});try{events=parseICSFile((await(file=incomingFile,new Promise((resolve,reject)=>{if(file&&file.size){const reader=new FileReader;reader.readAsText(file),reader.onload=()=>{const data=reader.result;""===data?reject():resolve({data:data})}}else reject()}))).data),this.setState({allImportedEvents:events,selectedEvents:filterEvents(events),fileLoading:!1,errorMessage:null,includePastEvents:!1})}catch(error){console.log(errorMessage,error),this.setState({errorMessage:errorMessage,fileLoading:!1})}}else incomingFile&&incomingFile.size>1e8?this.setState({fileLoading:!1,errorMessage:errorMessage}):this.setState({fileLoading:!1,errorMessage:null});var file}),import_modal_defineProperty(this,"onEventDelete",eventId=>{this.setState(prevState=>({allImportedEvents:prevState.allImportedEvents.filter(event=>event.event_id!==eventId),selectedEvents:prevState.selectedEvents.filter(event=>event.event_id!==eventId)}))}),import_modal_defineProperty(this,"onCheckboxToggle",e=>{this.setState({includePastEvents:e.target.checked})}),import_modal_defineProperty(this,"handleEventsAdd",()=>{const{allImportedEvents:allImportedEvents,selectedEvents:selectedEvents,includePastEvents:includePastEvents}=this.state,events=(includePastEvents?allImportedEvents:selectedEvents).map(event=>({description:event.description,start_time:event.start_time,end_time:event.end_time,event_id:event.event_id}));this.props.addImportedEvents(events)}),import_modal_defineProperty(this,"renderCallout",()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{color:"danger"},external_kbnSharedDeps_React_default.a.createElement("p",null,this.state.errorMessage))),this.state={includePastEvents:!1,allImportedEvents:[],selectedEvents:[],fileLoading:!1,fileLoaded:!1,errorMessage:null}}render(){const{closeImportModal:closeImportModal}=this.props,{fileLoading:fileLoading,fileLoaded:fileLoaded,allImportedEvents:allImportedEvents,selectedEvents:selectedEvents,errorMessage:errorMessage,includePastEvents:includePastEvents}=this.state;let importedEvents,showRecurringWarning=!1;return importedEvents=includePastEvents?allImportedEvents:selectedEvents,void 0!==importedEvents.find(e=>e.asterisk)&&(showRecurringWarning=!0),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModal,{onClose:closeImportModal,maxWidth:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalHeader,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"column",gutterSize:"none"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalHeaderTitle,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.calendarsEdit.eventsTable.importEventsTitle",defaultMessage:"Import events"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.calendarsEdit.eventsTable.importEventsDescription",defaultMessage:"Import events from an ICS file."}))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalBody,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"column"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFilePicker,{compressed:!0,initialPromptText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.calendarsEdit.importModal.selectOrDragAndDropFilePromptText",{defaultMessage:"Select or drag and drop a file"}),onChange:this.handleImport,disabled:fileLoading})),null!==errorMessage&&this.renderCallout(),allImportedEvents.length>0&&external_kbnSharedDeps_React_default.a.createElement(ImportedEvents,{events:importedEvents,showRecurringWarning:showRecurringWarning,includePastEvents:includePastEvents,onCheckboxToggle:this.onCheckboxToggle,onEventDelete:this.onEventDelete}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalFooter,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{onClick:closeImportModal},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.calendarsEdit.eventsTable.cancelButtonLabel",defaultMessage:"Cancel"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{onClick:this.handleEventsAdd,fill:!0,disabled:!1===fileLoaded||null!==errorMessage},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.calendarsEdit.eventsTable.importButtonLabel",defaultMessage:"Import"})))))}}function new_calendar_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class new_calendar_NewCalendarUI extends external_kbnSharedDeps_React_.Component{constructor(props){super(props),new_calendar_defineProperty(this,"returnToCalendarsManagementPage",async()=>{const{services:{http:{basePath:basePath},application:{navigateToUrl:navigateToUrl}}}=this.props.kibana;await navigateToUrl(`${basePath.get()}/app/ml/${ml_url_generator.b.CALENDARS_MANAGE}`,!0)}),new_calendar_defineProperty(this,"isDuplicateId",()=>{const{calendars:calendars,formCalendarId:formCalendarId}=this.state;for(let i=0;i<calendars.length;i++)if(calendars[i].calendar_id===formCalendarId)return!0;return!1}),new_calendar_defineProperty(this,"onCreate",async()=>{const{formCalendarId:formCalendarId}=this.state;if(this.isDuplicateId()){const{toasts:toasts}=this.props.kibana.services.notifications;toasts.addDanger(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.calendarsEdit.canNotCreateCalendarWithExistingIdErrorMessag",{defaultMessage:"Cannot create calendar with id [{formCalendarId}] as it already exists.",values:{formCalendarId:formCalendarId}}))}else{const calendar=this.setUpCalendarForApi();this.setState({saving:!0});try{await ml_api_service.ml.addCalendar(calendar),await this.returnToCalendarsManagementPage()}catch(error){console.log("Error saving calendar",error),this.setState({saving:!1});const{toasts:toasts}=this.props.kibana.services.notifications;toasts.addDanger(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.calendarsEdit.errorWithCreatingCalendarErrorMessage",{defaultMessage:"An error occurred creating calendar {calendarId}",values:{calendarId:calendar.calendarId}}))}}}),new_calendar_defineProperty(this,"onEdit",async()=>{const calendar=this.setUpCalendarForApi();this.setState({saving:!0});try{await ml_api_service.ml.updateCalendar(calendar),await this.returnToCalendarsManagementPage()}catch(error){console.log("Error saving calendar",error),this.setState({saving:!1});const{toasts:toasts}=this.props.kibana.services.notifications;toasts.addDanger(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.calendarsEdit.errorWithUpdatingCalendarErrorMessage",{defaultMessage:"An error occurred saving calendar {calendarId}. Try refreshing the page.",values:{calendarId:calendar.calendarId}}))}}),new_calendar_defineProperty(this,"setUpCalendarForApi",()=>{const{formCalendarId:formCalendarId,description:description,events:events,selectedGroupOptions:selectedGroupOptions,selectedJobOptions:selectedJobOptions,isGlobalCalendar:isGlobalCalendar}=this.state,allIds=isGlobalCalendar?["_all"]:[...selectedJobOptions.map(option=>option.label),...selectedGroupOptions.map(option=>option.label)];return{calendarId:formCalendarId,description:description,events:events.map(event=>({description:event.description,start_time:event.start_time,end_time:event.end_time})),job_ids:allIds}}),new_calendar_defineProperty(this,"onCreateGroupOption",newGroup=>{const newOption={label:newGroup};this.setState(prevState=>({selectedGroupOptions:prevState.selectedGroupOptions.concat(newOption)}))}),new_calendar_defineProperty(this,"onGlobalCalendarChange",({currentTarget:currentTarget})=>{this.setState({isGlobalCalendar:currentTarget.checked})}),new_calendar_defineProperty(this,"onJobSelection",selectedJobOptions=>{this.setState({selectedJobOptions:selectedJobOptions})}),new_calendar_defineProperty(this,"onGroupSelection",selectedGroupOptions=>{this.setState({selectedGroupOptions:selectedGroupOptions})}),new_calendar_defineProperty(this,"onCalendarIdChange",e=>{const isValid=function(calendarId){let valid=!0;return(""===calendarId||void 0===calendarId||!1===Object(job_utils.i)(calendarId))&&(valid=!1),valid}(e.target.value);this.setState({formCalendarId:e.target.value,isNewCalendarIdValid:isValid})}),new_calendar_defineProperty(this,"onDescriptionChange",e=>{this.setState({description:e.target.value})}),new_calendar_defineProperty(this,"showImportModal",()=>{this.setState(prevState=>({isImportModalVisible:!prevState.isImportModalVisible}))}),new_calendar_defineProperty(this,"closeImportModal",()=>{this.setState({isImportModalVisible:!1})}),new_calendar_defineProperty(this,"onEventDelete",eventId=>{this.setState(prevState=>({events:prevState.events.filter(event=>event.event_id!==eventId)}))}),new_calendar_defineProperty(this,"closeNewEventModal",()=>{this.setState({isNewEventModalVisible:!1})}),new_calendar_defineProperty(this,"showNewEventModal",()=>{this.setState({isNewEventModalVisible:!0})}),new_calendar_defineProperty(this,"addEvent",event=>{this.setState(prevState=>({events:[...prevState.events,event],isNewEventModalVisible:!1}))}),new_calendar_defineProperty(this,"addImportedEvents",events=>{this.setState(prevState=>({events:[...prevState.events,...events],isImportModalVisible:!1}))}),this.state={isNewEventModalVisible:!1,isImportModalVisible:!1,isNewCalendarIdValid:null,loading:!0,jobIds:[],jobIdOptions:[],groupIds:[],groupIdOptions:[],calendars:[],formCalendarId:"",description:"",selectedJobOptions:[],selectedGroupOptions:[],events:[],saving:!1,selectedCalendar:void 0,isGlobalCalendar:!1}}componentDidMount(){this.formSetup()}async formSetup(){try{const{jobIds:jobIds,groupIds:groupIds,calendars:calendars}=await new Promise(async(resolve,reject)=>{try{const[jobIds,groupIds,calendars]=await Promise.all([new Promise((resolve,reject)=>{ml_api_service.ml.jobs.jobsSummary().then(resp=>{resolve(resp.map(job=>job.id))}).catch(err=>{const errorMessage=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.calendarsEdit.errorWithFetchingJobSummariesErrorMessage",{defaultMessage:"Error fetching job summaries: {err}",values:{err:err}});console.log(errorMessage),reject(errorMessage)})}),new Promise((resolve,reject)=>{ml_api_service.ml.jobs.groups().then(resp=>{resolve(resp.map(group=>group.id))}).catch(err=>{const errorMessage=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.calendarsEdit.errorWithLoadingGroupsErrorMessage",{defaultMessage:"Error loading groups: {err}",values:{err:err}});console.log(errorMessage),reject(errorMessage)})}),new Promise((resolve,reject)=>{ml_api_service.ml.calendars().then(resp=>{resolve(resp)}).catch(err=>{const errorMessage=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.calendarsEdit.errorWithLoadingCalendarsErrorMessage",{defaultMessage:"Error loading calendars: {err}",values:{err:err}});console.log(errorMessage),reject(errorMessage)})})]);resolve({jobIds:jobIds,groupIds:groupIds,calendars:calendars})}catch(error){console.log(error),reject(error)}}),jobIdOptions=jobIds.map(jobId=>({label:jobId})),groupIdOptions=groupIds.map(groupId=>({label:groupId})),selectedJobOptions=[],selectedGroupOptions=[];let selectedCalendar,eventsList=[],formCalendarId="",isGlobalCalendar=!1;void 0!==this.props.calendarId&&(selectedCalendar=calendars.find(cal=>cal.calendar_id===this.props.calendarId),selectedCalendar&&(formCalendarId=selectedCalendar.calendar_id,eventsList=selectedCalendar.events,selectedCalendar.job_ids.includes("_all")?isGlobalCalendar=!0:selectedCalendar.job_ids.forEach(id=>{jobIds.find(jobId=>jobId===id)?selectedJobOptions.push({label:id}):groupIds.find(groupId=>groupId===id)&&selectedGroupOptions.push({label:id})}))),this.setState({events:eventsList,formCalendarId:formCalendarId,jobIds:jobIds,jobIdOptions:jobIdOptions,groupIds:groupIds,groupIdOptions:groupIdOptions,calendars:calendars,loading:!1,selectedJobOptions:selectedJobOptions,selectedGroupOptions:selectedGroupOptions,selectedCalendar:selectedCalendar,isGlobalCalendar:isGlobalCalendar})}catch(error){console.log(error),this.setState({loading:!1});const{toasts:toasts}=this.props.kibana.services.notifications;toasts.addDanger(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.calendarsEdit.errorWithLoadingCalendarFromDataErrorMessage",{defaultMessage:"An error occurred loading calendar form data. Try refreshing the page."}))}}render(){const{events:events,isNewEventModalVisible:isNewEventModalVisible,isImportModalVisible:isImportModalVisible,isNewCalendarIdValid:isNewCalendarIdValid,formCalendarId:formCalendarId,description:description,groupIdOptions:groupIdOptions,jobIdOptions:jobIdOptions,saving:saving,selectedCalendar:selectedCalendar,selectedJobOptions:selectedJobOptions,selectedGroupOptions:selectedGroupOptions,isGlobalCalendar:isGlobalCalendar}=this.state,helpLink=Object(dependency_cache.b)().links.ml.calendars;let modal="";return isNewEventModalVisible?modal=external_kbnSharedDeps_React_default.a.createElement(new_event_modal_NewEventModal,{addEvent:this.addEvent,closeModal:this.closeNewEventModal}):isImportModalVisible&&(modal=external_kbnSharedDeps_React_default.a.createElement(import_modal_ImportModal,{addImportedEvents:this.addImportedEvents,closeImportModal:this.closeImportModal})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(navigation_menu.a,{tabId:"settings"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPage,{className:"mlCalendarEditForm","data-test-subj":"mlPageCalendarEdit"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageBody,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageContent,{className:"mlCalendarEditForm__content",verticalPosition:"center",horizontalPosition:"center"},external_kbnSharedDeps_React_default.a.createElement(CalendarForm,{calendarId:selectedCalendar?selectedCalendar.calendar_id:formCalendarId,canCreateCalendar:this.props.canCreateCalendar,canDeleteCalendar:this.props.canDeleteCalendar,description:selectedCalendar?selectedCalendar.description:description,eventsList:events,groupIds:groupIdOptions,isEdit:void 0!==selectedCalendar,isNewCalendarIdValid:!(!selectedCalendar&&null!==isNewCalendarIdValid)||isNewCalendarIdValid,jobIds:jobIdOptions,onCalendarIdChange:this.onCalendarIdChange,onCreate:this.onCreate,onDescriptionChange:this.onDescriptionChange,onEdit:this.onEdit,onEventDelete:this.onEventDelete,onGroupSelection:this.onGroupSelection,showImportModal:this.showImportModal,onJobSelection:this.onJobSelection,saving:saving,selectedGroupOptions:selectedGroupOptions,selectedJobOptions:selectedJobOptions,onCreateGroupOption:this.onCreateGroupOption,showNewEventModal:this.showNewEventModal,isGlobalCalendar:isGlobalCalendar,onGlobalCalendarChange:this.onGlobalCalendarChange})),modal)),external_kbnSharedDeps_React_default.a.createElement(help_menu.a,{docLink:helpLink}))}}const NewCalendar=Object(kibanaReact_public_.withKibana)(new_calendar_NewCalendarUI);const CalendarsListHeader=Object(kibanaReact_public_.withKibana)((function({totalCount:totalCount,refreshCalendars:refreshCalendars,kibana:kibana}){const docsUrl=kibana.services.docLinks.links.ml.calendars;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"baseline"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"baseline",gutterSize:"m",responsive:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,null,external_kbnSharedDeps_React_default.a.createElement("h1",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.settings.calendars.listHeader.calendarsTitle",defaultMessage:"Calendars"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTextColor,{color:"subdued"},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.settings.calendars.listHeader.calendarsListTotalCount",defaultMessage:"{totalCount} in total",values:{totalCount:totalCount}})))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"baseline",gutterSize:"m",responsive:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{size:"s",iconType:"refresh",onClick:refreshCalendars,"data-test-subj":"mlCalendarListRefreshButton"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.settings.calendars.listHeader.refreshButtonLabel",defaultMessage:"Refresh"})))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTextColor,{color:"subdued"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.settings.calendars.listHeader.calendarsDescription",defaultMessage:"Calendars contain a list of scheduled events for which you do not want to generate anomalies, such as planned system outages or public holidays. The same calendar can be assigned to multiple jobs.{br}{learnMoreLink}",values:{br:external_kbnSharedDeps_React_default.a.createElement("br",null),learnMoreLink:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{href:docsUrl,target:"_blank"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.settings.calendars.listHeader.calendarsDescription.learnMoreLinkText",defaultMessage:"Learn more"}))}})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}))})),CalendarsListTable=({calendarsList:calendarsList,onDeleteClick:onDeleteClick,setSelectedCalendarList:setSelectedCalendarList,loading:loading,canCreateCalendar:canCreateCalendar,canDeleteCalendar:canDeleteCalendar,mlNodesAvailable:mlNodesAvailable,itemsSelected:itemsSelected})=>{const redirectToNewCalendarPage=Object(use_create_url.a)(ml_url_generator.b.CALENDARS_NEW),columns=[{field:"calendar_id",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.calendarsList.table.idColumnName",{defaultMessage:"ID"}),sortable:!0,truncateText:!0,scope:"row",render:id=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Link,{to:`/${ml_url_generator.b.CALENDARS_EDIT}/${id}`,"data-test-subj":"mlEditCalendarLink"},id),"data-test-subj":"mlCalendarListColumnId"},{field:"job_ids_string",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.calendarsList.table.jobsColumnName",{defaultMessage:"Jobs"}),sortable:!0,truncateText:!0,render:jobList=>"_all"===jobList?external_kbnSharedDeps_React_default.a.createElement("span",{style:{fontStyle:"italic"}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.calendarsList.table.allJobsLabel",defaultMessage:"Applies to all jobs"})):jobList,"data-test-subj":"mlCalendarListColumnJobs"},{field:"events_length",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.calendarsList.table.eventsColumnName",{defaultMessage:"Events"}),sortable:!0,render:eventsLength=>external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.calendarsList.table.eventsCountLabel",{defaultMessage:"{eventsLength, plural, one {# event} other {# events}}",values:{eventsLength:eventsLength}}),"data-test-subj":"mlCalendarListColumnEvents"}],tableSelection={onSelectionChange:selection=>setSelectedCalendarList(selection)},search={toolsRight:[external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{size:"s","data-test-subj":"mlCalendarButtonCreate",key:"new_calendar_button",onClick:redirectToNewCalendarPage,isDisabled:!1===canCreateCalendar||!1===mlNodesAvailable},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.calendarsList.table.newButtonLabel",defaultMessage:"New"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{size:"s",color:"danger",iconType:"trash",onClick:onDeleteClick,isDisabled:!1===canDeleteCalendar||!1===mlNodesAvailable||!1===itemsSelected,"data-test-subj":"mlCalendarButtonDelete",key:"delete_calendar_button"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.calendarsList.table.deleteButtonLabel",defaultMessage:"Delete"}))],box:{incremental:!0},filters:[]};return external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":"mlCalendarTableContainer"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiInMemoryTable,{items:calendarsList,itemId:"calendar_id",columns:columns,search:search,pagination:{initialPageSize:20,pageSizeOptions:[10,20]},sorting:{sort:{field:"calendar_id",direction:"asc"}},loading:loading,selection:tableSelection,isSelectable:!0,"data-test-subj":loading?"mlCalendarTable loading":"mlCalendarTable loaded",rowProps:item=>({"data-test-subj":"mlCalendarListRow row-"+item.calendar_id})}))};function calendars_list_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class calendars_list_CalendarsListUI extends external_kbnSharedDeps_React_.Component{constructor(props){super(props),calendars_list_defineProperty(this,"loadCalendars",async()=>{this.setState({loading:!0});try{const calendars=await ml_api_service.ml.calendars();this.setState({calendars:calendars,loading:!1,isDestroyModalVisible:!1})}catch(error){console.log(error),this.setState({loading:!1});const{toasts:toasts}=this.props.kibana.services.notifications;toasts.addDanger(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.calendarsList.errorWithLoadingListOfCalendarsErrorMessage",{defaultMessage:"An error occurred loading the list of calendars."}))}}),calendars_list_defineProperty(this,"closeDestroyModal",()=>{this.setState({isDestroyModalVisible:!1,calendarId:null})}),calendars_list_defineProperty(this,"showDestroyModal",()=>{this.setState({isDestroyModalVisible:!0})}),calendars_list_defineProperty(this,"setSelectedCalendarList",selectedCalendars=>{this.setState({selectedForDeletion:selectedCalendars})}),calendars_list_defineProperty(this,"deleteCalendars",()=>{const{selectedForDeletion:selectedForDeletion}=this.state;this.closeDestroyModal(),async function(calendarsToDelete,callback){if(void 0===calendarsToDelete||0===calendarsToDelete.length)return;const toastNotifications=Object(dependency_cache.j)(),messageId=calendarsToDelete.length>1?external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.calendarsList.deleteCalendars.calendarsLabel",{defaultMessage:"{calendarsToDeleteCount} calendars",values:{calendarsToDeleteCount:calendarsToDelete.length}}):""+calendarsToDelete[0].calendar_id;toastNotifications.add(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.calendarsList.deleteCalendars.deletingCalendarsNotificationMessage",{defaultMessage:"Deleting {messageId}",values:{messageId:messageId}}));for(const calendar of calendarsToDelete){const calendarId=calendar.calendar_id;try{await ml_api_service.ml.deleteCalendar({calendarId:calendarId})}catch(error){console.log("Error deleting calendar:",error),toastNotifications.addDanger({title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.calendarsList.deleteCalendars.deletingCalendarErrorMessage",{defaultMessage:"An error occurred deleting calendar {calendarId}",values:{calendarId:calendar.calendar_id}}),text:Object(util_errors.i)(error)})}}toastNotifications.addSuccess(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.calendarsList.deleteCalendars.deletingCalendarSuccessNotificationMessage",{defaultMessage:"{messageId} deleted",values:{messageId:messageId}})),callback()}(selectedForDeletion,this.loadCalendars)}),calendars_list_defineProperty(this,"addRequiredFieldsToList",(calendarsList=[])=>{for(let i=0;i<calendarsList.length;i++)calendarsList[i].job_ids_string=calendarsList[i].job_ids.join(", "),calendarsList[i].events_length=calendarsList[i].events.length;return calendarsList}),this.state={loading:!0,calendars:[],isDestroyModalVisible:!1,calendarId:null,selectedForDeletion:[],nodesAvailable:Object(check_ml_nodes.e)()}}componentDidMount(){this.loadCalendars()}render(){const{calendars:calendars,selectedForDeletion:selectedForDeletion,loading:loading,nodesAvailable:nodesAvailable}=this.state,{canCreateCalendar:canCreateCalendar,canDeleteCalendar:canDeleteCalendar}=this.props;let destroyModal="";const helpLink=Object(dependency_cache.b)().links.ml.calendars;return this.state.isDestroyModalVisible&&(destroyModal=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiConfirmModal,{"data-test-subj":"mlCalendarDeleteConfirmation",title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.calendarsList.deleteCalendarsModal.deleteMultipleCalendarsTitle",defaultMessage:"Delete {calendarsCount, plural, one {{calendarsList}} other {# calendars}}?",values:{calendarsCount:selectedForDeletion.length,calendarsList:selectedForDeletion.map(c=>c.calendar_id).join(", ")}}),onCancel:this.closeDestroyModal,onConfirm:this.deleteCalendars,cancelButtonText:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.calendarsList.deleteCalendarsModal.cancelButtonLabel",defaultMessage:"Cancel"}),confirmButtonText:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.calendarsList.deleteCalendarsModal.deleteButtonLabel",defaultMessage:"Delete"}),buttonColor:"danger",defaultFocusedButton:external_kbnSharedDeps_ElasticEui_.EUI_MODAL_CONFIRM_BUTTON})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(navigation_menu.a,{tabId:"settings"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPage,{className:"mlCalendarList","data-test-subj":"mlPageCalendarManagement"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageBody,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageContent,{className:"mlCalendarList__content",verticalPosition:"center",horizontalPosition:"center"},external_kbnSharedDeps_React_default.a.createElement(CalendarsListHeader,{totalCount:calendars.length,refreshCalendars:this.loadCalendars}),external_kbnSharedDeps_React_default.a.createElement(CalendarsListTable,{loading:loading,calendarsList:this.addRequiredFieldsToList(calendars),onDeleteClick:this.showDestroyModal,canCreateCalendar:canCreateCalendar,canDeleteCalendar:canDeleteCalendar,mlNodesAvailable:nodesAvailable,setSelectedCalendarList:this.setSelectedCalendarList,itemsSelected:selectedForDeletion.length>0})),destroyModal)),external_kbnSharedDeps_React_default.a.createElement(help_menu.a,{docLink:helpLink}))}}const CalendarsList=Object(kibanaReact_public_.withKibana)(calendars_list_CalendarsListUI);function calendar_list_extends(){return(calendar_list_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const calendarListRouteFactory=(navigateToPath,basePath)=>({path:"/settings/calendars_list",render:(props,deps)=>external_kbnSharedDeps_React_default.a.createElement(calendar_list_PageWrapper,calendar_list_extends({},props,{deps:deps})),breadcrumbs:[getBreadcrumbWithUrlForApp("ML_BREADCRUMB",navigateToPath,basePath),getBreadcrumbWithUrlForApp("SETTINGS_BREADCRUMB",navigateToPath,basePath),getBreadcrumbWithUrlForApp("CALENDAR_MANAGEMENT_BREADCRUMB",navigateToPath,basePath)]}),calendar_list_PageWrapper=({deps:deps})=>{const{redirectToMlAccessDeniedPage:redirectToMlAccessDeniedPage}=deps,{context:context}=useResolver(void 0,void 0,deps.config,{checkFullLicense:license.b,checkGetJobsCapabilities:()=>Object(check_capabilities.c)(redirectToMlAccessDeniedPage),getMlNodeCount:check_ml_nodes.c});Object(contexts_kibana.g)({timeRangeSelector:!1,autoRefreshSelector:!1});const canCreateCalendar=Object(check_capabilities.e)("canCreateCalendar"),canDeleteCalendar=Object(check_capabilities.e)("canDeleteCalendar");return external_kbnSharedDeps_React_default.a.createElement(PageLoader,{context:context},external_kbnSharedDeps_React_default.a.createElement(CalendarsList,{canCreateCalendar:canCreateCalendar,canDeleteCalendar:canDeleteCalendar}))};function calendar_new_edit_extends(){return(calendar_new_edit_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}var calendar_new_edit_MODE;!function(MODE){MODE[MODE.NEW=0]="NEW",MODE[MODE.EDIT=1]="EDIT"}(calendar_new_edit_MODE||(calendar_new_edit_MODE={}));const newCalendarRouteFactory=(navigateToPath,basePath)=>({path:"/settings/calendars_list/new_calendar",render:(props,deps)=>external_kbnSharedDeps_React_default.a.createElement(calendar_new_edit_PageWrapper,calendar_new_edit_extends({},props,{deps:deps,mode:calendar_new_edit_MODE.NEW})),breadcrumbs:[getBreadcrumbWithUrlForApp("ML_BREADCRUMB",navigateToPath,basePath),getBreadcrumbWithUrlForApp("SETTINGS_BREADCRUMB",navigateToPath,basePath),getBreadcrumbWithUrlForApp("CALENDAR_MANAGEMENT_BREADCRUMB",navigateToPath,basePath),{text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.settings.breadcrumbs.calendarManagement.createLabel",{defaultMessage:"Create"}),onClick:breadcrumbOnClickFactory("/settings/calendars_list/new_calendar",navigateToPath)}]}),editCalendarRouteFactory=(navigateToPath,basePath)=>({path:"/settings/calendars_list/edit_calendar/:calendarId",render:(props,deps)=>external_kbnSharedDeps_React_default.a.createElement(calendar_new_edit_PageWrapper,calendar_new_edit_extends({},props,{deps:deps,mode:calendar_new_edit_MODE.EDIT})),breadcrumbs:[getBreadcrumbWithUrlForApp("ML_BREADCRUMB",navigateToPath,basePath),getBreadcrumbWithUrlForApp("SETTINGS_BREADCRUMB",navigateToPath,basePath),getBreadcrumbWithUrlForApp("CALENDAR_MANAGEMENT_BREADCRUMB",navigateToPath,basePath),{text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.settings.breadcrumbs.calendarManagement.editLabel",{defaultMessage:"Edit"}),onClick:breadcrumbOnClickFactory("/settings/calendars_list/edit_calendar",navigateToPath)}]}),calendar_new_edit_PageWrapper=({location:location,mode:mode,deps:deps})=>{let calendarId;if(mode===calendar_new_edit_MODE.EDIT){const pathMatch=location.pathname.match(/.+\/(.+)$/);calendarId=pathMatch&&pathMatch.length>1?pathMatch[1]:void 0}const{redirectToMlAccessDeniedPage:redirectToMlAccessDeniedPage}=deps,redirectToJobsManagementPage=Object(use_create_url.a)(ml_url_generator.b.ANOMALY_DETECTION_JOBS_MANAGE),{context:context}=useResolver(void 0,void 0,deps.config,{checkFullLicense:license.b,checkGetJobsCapabilities:()=>Object(check_capabilities.c)(redirectToMlAccessDeniedPage),checkMlNodesAvailable:()=>Object(check_ml_nodes.a)(redirectToJobsManagementPage)});Object(contexts_kibana.g)({timeRangeSelector:!1,autoRefreshSelector:!1});const canCreateCalendar=Object(check_capabilities.e)("canCreateCalendar"),canDeleteCalendar=Object(check_capabilities.e)("canDeleteCalendar");return external_kbnSharedDeps_React_default.a.createElement(PageLoader,{context:context},external_kbnSharedDeps_React_default.a.createElement(NewCalendar,{calendarId:calendarId,canCreateCalendar:canCreateCalendar,canDeleteCalendar:canDeleteCalendar}))};function edit_description_popover_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class edit_description_popover_EditDescriptionPopover extends external_kbnSharedDeps_React_.Component{constructor(props){super(props),edit_description_popover_defineProperty(this,"onChange",e=>{this.setState({value:e.target.value})}),edit_description_popover_defineProperty(this,"onButtonClick",()=>{!1===this.state.isPopoverOpen?this.setState({isPopoverOpen:!this.state.isPopoverOpen,value:this.props.description}):this.closePopover()}),edit_description_popover_defineProperty(this,"closePopover",()=>{!0===this.state.isPopoverOpen&&(this.setState({isPopoverOpen:!1}),this.props.updateDescription(this.state.value))}),this.state={isPopoverOpen:!1,value:props.description}}render(){const{isPopoverOpen:isPopoverOpen,value:value}=this.state,button=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{size:"s",color:"primary",onClick:this.onButtonClick,iconType:"pencil","aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.settings.filterLists.editDescriptionPopover.editDescriptionAriaLabel",{defaultMessage:"Edit description"}),isDisabled:!1===this.props.canCreateFilter,"data-test-subj":"mlFilterListEditDescriptionButton"});return external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopover,{id:"filter_list_description_popover",ownFocus:!0,button:button,isOpen:isPopoverOpen,closePopover:this.closePopover},external_kbnSharedDeps_React_default.a.createElement("div",{style:{width:"300px"}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiForm,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.settings.filterLists.editDescriptionPopover.filterListDescriptionAriaLabel",defaultMessage:"Filter list description"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldText,{name:"filter_list_description",value:value,onChange:this.onChange,"data-test-subj":"mlFilterListDescriptionInput"}))))))}}function filter_list_usage_popover_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}edit_description_popover_defineProperty(edit_description_popover_EditDescriptionPopover,"displayName","EditDescriptionPopover");class filter_list_usage_popover_FilterListUsagePopover extends external_kbnSharedDeps_React_.Component{constructor(props){super(props),filter_list_usage_popover_defineProperty(this,"onButtonClick",()=>{this.setState({isPopoverOpen:!this.state.isPopoverOpen})}),filter_list_usage_popover_defineProperty(this,"closePopover",()=>{this.setState({isPopoverOpen:!1})}),this.state={isPopoverOpen:!1}}render(){const{entityType:entityType,entityValues:entityValues}=this.props,linkText=`${entityValues.length} ${entityType}${1!==entityValues.length?"s":""}`,listItems=entityValues.map(value=>external_kbnSharedDeps_React_default.a.createElement("li",{key:value},value)),button=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{size:"s",color:"primary",onClick:this.onButtonClick},linkText);return external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopover,{id:entityType+"_filter_list_usage",panelClassName:"ml-filter-list-usage-popover",ownFocus:!0,button:button,isOpen:this.state.isPopoverOpen,closePopover:this.closePopover},external_kbnSharedDeps_React_default.a.createElement("ul",null,listItems)))}}const EditFilterListHeader=({canCreateFilter:canCreateFilter,filterId:filterId,totalItemCount:totalItemCount,description:description,updateDescription:updateDescription,newFilterId:newFilterId,isNewFilterIdInvalid:isNewFilterIdInvalid,updateNewFilterId:updateNewFilterId,usedBy:usedBy})=>{const title=void 0!==filterId?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.settings.filterLists.editFilterHeader.filterListTitle",defaultMessage:"Filter list {filterId}",values:{filterId:filterId}}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.settings.filterLists.editFilterHeader.createFilterListTitle",defaultMessage:"Create new filter list"});let idField,descriptionField,usedByElement;if(void 0===filterId){const msg=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.settings.filterLists.editFilterHeader.allowedCharactersDescription",{defaultMessage:"Use lowercase alphanumerics (a-z and 0-9), hyphens or underscores; must start and end with an alphanumeric character"}),helpText=!1===isNewFilterIdInvalid?msg:void 0,error=!0===isNewFilterIdInvalid?[msg]:void 0;idField=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.settings.filterLists.editFilterHeader.filterListIdAriaLabel",defaultMessage:"Filter list ID"}),helpText:helpText,error:error,isInvalid:isNewFilterIdInvalid},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldText,{name:"new_filter_id",value:newFilterId,isInvalid:isNewFilterIdInvalid,onChange:e=>updateNewFilterId(e.target.value),"data-test-subj":"mlNewFilterListIdInput"}))}return descriptionField=void 0!==description&&description.length>0?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{"data-test-subj":"mlNewFilterListDescriptionText"},external_kbnSharedDeps_React_default.a.createElement("p",null,description)):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTextColor,{color:"subdued"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.settings.filterLists.editFilterList.addDescriptionText",defaultMessage:"Add a description"}))),void 0!==filterId&&(usedByElement=void 0!==usedBy&&usedBy.jobs.length>0?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement("div",{className:"ml-filter-list-usage"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.settings.filterLists.editFilterList.filterIsUsedInJobsDescription",defaultMessage:"This filter list is used in"})),external_kbnSharedDeps_React_default.a.createElement(filter_list_usage_popover_FilterListUsagePopover,{entityType:"detector",entityValues:usedBy.detectors}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.settings.filterLists.editFilterList.acrossText",defaultMessage:"across"})),external_kbnSharedDeps_React_default.a.createElement(filter_list_usage_popover_FilterListUsagePopover,{entityType:"job",entityValues:usedBy.jobs})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"})):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.settings.filterLists.editFilterList.filterIsNotUsedInJobsDescription",defaultMessage:"This filter list is not used by any jobs."}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"baseline"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"baseline",gutterSize:"m",responsive:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,null,external_kbnSharedDeps_React_default.a.createElement("h1",null,title))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTextColor,{color:"subdued"},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.settings.filterLists.editFilterList.totalItemsDescription",defaultMessage:"{totalItemCount, plural, one {# item} other {# items}} in total",values:{totalItemCount:totalItemCount}}))))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),idField,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"baseline",gutterSize:"s",responsive:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},descriptionField),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(edit_description_popover_EditDescriptionPopover,{canCreateFilter:canCreateFilter,description:description,updateDescription:updateDescription}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),usedByElement)};function add_item_popover_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}EditFilterListHeader.displayName="EditFilterListHeader";class add_item_popover_AddItemPopover extends external_kbnSharedDeps_React_.Component{constructor(props){super(props),add_item_popover_defineProperty(this,"onItemsTextChange",e=>{this.setState({itemsText:e.target.value})}),add_item_popover_defineProperty(this,"onButtonClick",()=>{this.setState({isPopoverOpen:!this.state.isPopoverOpen})}),add_item_popover_defineProperty(this,"closePopover",()=>{this.setState({isPopoverOpen:!1})}),add_item_popover_defineProperty(this,"onAddButtonClick",()=>{const items=this.state.itemsText.split("\n"),addItems=[];items.forEach(item=>{-1===addItems.indexOf(item)&&item.length>0&&addItems.push(item)}),this.props.addItems(addItems),this.setState({isPopoverOpen:!1,itemsText:""})}),this.state={isPopoverOpen:!1,itemsText:""}}render(){const button=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{size:"s",color:"primary",iconType:"arrowDown",iconSide:"right",onClick:this.onButtonClick,isDisabled:!1===this.props.canCreateFilter,"data-test-subj":"mlFilterListOpenNewItemsPopoverButton"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.settings.filterLists.addItemPopover.addItemButtonLabel",defaultMessage:"Add item"}));return external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopover,{id:"add_item_popover",panelClassName:"ml-add-filter-item-popover",ownFocus:!0,button:button,isOpen:this.state.isPopoverOpen,closePopover:this.closePopover},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiForm,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.settings.filterLists.addItemPopover.itemsLabel",defaultMessage:"Items"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTextArea,{value:this.state.itemsText,onChange:this.onItemsTextChange,"data-test-subj":"mlFilterListAddItemTextArea"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.settings.filterLists.addItemPopover.enterItemPerLineDescription",defaultMessage:"Enter one item per line"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"flexEnd"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{onClick:this.onAddButtonClick,disabled:0===this.state.itemsText.length,"data-test-subj":"mlFilterListAddItemsButton"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.settings.filterLists.addItemPopover.addButtonLabel",defaultMessage:"Add"}))))))}}function EditFilterListToolbar({canCreateFilter:canCreateFilter,canDeleteFilter:canDeleteFilter,onSearchChange:onSearchChange,addItems:addItems,deleteSelectedItems:deleteSelectedItems,selectedItemCount:selectedItemCount}){const toolsRight=function(canCreateFilter,canDeleteFilter,addItems,deleteSelectedItems,selectedItemCount){return[external_kbnSharedDeps_React_default.a.createElement(add_item_popover_AddItemPopover,{addItems:addItems,canCreateFilter:canCreateFilter,key:"add_item_btn"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{color:"danger",size:"s",disabled:0===selectedItemCount||!1===canDeleteFilter,onClick:deleteSelectedItems,key:"delete_item_btn","data-test-subj":"mlFilterListDeleteItemButton"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.settings.filterLists.toolbar.deleteItemButtonLabel",defaultMessage:"Delete item"}))]}(canCreateFilter,canDeleteFilter,addItems,deleteSelectedItems,selectedItemCount);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",gutterSize:"xl"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSearchBar,{toolsRight:toolsRight,onChange:onSearchChange,filters:[]}))))}function items_grid_pagination_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function getContextMenuItemIcon(menuItemSetting,itemsPerPage){return menuItemSetting===itemsPerPage?"check":"empty"}add_item_popover_defineProperty(add_item_popover_AddItemPopover,"displayName","AddItemPopover");class items_grid_pagination_ItemsGridPagination extends external_kbnSharedDeps_React_.Component{constructor(props){super(props),items_grid_pagination_defineProperty(this,"onButtonClick",()=>{this.setState({isPopoverOpen:!this.state.isPopoverOpen})}),items_grid_pagination_defineProperty(this,"closePopover",()=>{this.setState({isPopoverOpen:!1})}),items_grid_pagination_defineProperty(this,"onPageClick",pageNumber=>{this.props.setActivePage(pageNumber)}),items_grid_pagination_defineProperty(this,"onChangeItemsPerPage",pageSize=>{this.closePopover(),this.props.setItemsPerPage(pageSize)}),this.state={isPopoverOpen:!1}}render(){const{itemCount:itemCount,itemsPerPage:itemsPerPage,itemsPerPageOptions:itemsPerPageOptions,activePage:activePage}=this.props,button=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{size:"s",color:"text",iconType:"arrowDown",iconSide:"right",onClick:this.onButtonClick},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.itemsGrid.itemsPerPageButtonLabel",defaultMessage:"Items per page: {itemsPerPage}",values:{itemsPerPage:itemsPerPage}})),pageCount=Math.ceil(itemCount/itemsPerPage),items=itemsPerPageOptions.map(pageSize=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenuItem,{key:pageSize+" items",icon:getContextMenuItemIcon(pageSize,itemsPerPage),onClick:()=>{this.onChangeItemsPerPage(pageSize)}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.itemsGrid.itemsCountLabel",defaultMessage:"{pageSize} items",values:{pageSize:pageSize}})));return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopover,{id:"customizablePagination",button:button,isOpen:this.state.isPopoverOpen,closePopover:this.closePopover,panelPaddingSize:"none"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenuPanel,{items:items,className:"ml-items-grid-page-size-menu"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPagination,{pageCount:pageCount,activePage:activePage,onPageClick:this.onPageClick})))}}function ItemsGrid({numberColumns:numberColumns,totalItemCount:totalItemCount,items:items,selectedItems:selectedItems,itemsPerPage:itemsPerPage,itemsPerPageOptions:itemsPerPageOptions,setItemsPerPage:setItemsPerPage,setItemSelected:setItemSelected,activePage:activePage,setActivePage:setActivePage}){if(void 0===items||0===items.length)return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceAround"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement("h4",null,0===totalItemCount?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.itemsGrid.noItemsAddedTitle",defaultMessage:"No items have been added"}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.itemsGrid.noMatchingItemsTitle",defaultMessage:"No matching items"})))));const startIndex=activePage*itemsPerPage,gridItems=items.slice(startIndex,startIndex+itemsPerPage).map((item,index)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{key:"ml_grid_item_"+index,"data-test-subj":"mlGridItem "+item},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCheckbox,{id:"ml_grid_item_"+index,label:item,checked:selectedItems.indexOf(item)>=0,onChange:e=>{setItemSelected(item,e.target.checked)},"data-test-subj":"mlGridItemCheckbox"})));return external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGrid,{columns:numberColumns,className:"eui-textBreakWord",gutterSize:"m"},gridItems),external_kbnSharedDeps_React_default.a.createElement(items_grid_pagination_ItemsGridPagination,{itemCount:items.length,itemsPerPage:itemsPerPage,itemsPerPageOptions:itemsPerPageOptions,setItemsPerPage:setItemsPerPage,activePage:activePage,setActivePage:setActivePage}))}function saveFilterList(filterId,description,items,loadedFilterList){return new Promise((resolve,reject)=>{void 0===loadedFilterList||void 0===loadedFilterList.filter_id?function(filterId,description,items){const filterWithIdExistsErrorMessage=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.settings.filterLists.filterWithIdExistsErrorMessage",{defaultMessage:"A filter with id {filterId} already exists",values:{filterId:filterId}});return new Promise((resolve,reject)=>{ml_api_service.ml.filters.filtersStats().then(filterLists=>{if(-1===filterLists.map(filterList=>filterList.filter_id).indexOf(filterId))ml_api_service.ml.filters.addFilter(filterId,description,items).then(newFilter=>{resolve(newFilter)}).catch(error=>{reject(error)});else{Object(dependency_cache.j)().addDanger(filterWithIdExistsErrorMessage),reject(new Error(filterWithIdExistsErrorMessage))}}).catch(error=>{reject(error)})})}(filterId,description,items).then(newFilter=>{resolve(newFilter)}).catch(error=>{reject(error)}):function(loadedFilterList,description,items){return new Promise((resolve,reject)=>{const loadedItems=loadedFilterList.items,addItems=items.filter(item=>!1===loadedItems.includes(item)),removeItems=loadedItems.filter(item=>!1===items.includes(item));ml_api_service.ml.filters.updateFilter(loadedFilterList.filter_id,description,addItems,removeItems).then(updatedFilter=>{resolve(updatedFilter)}).catch(error=>{reject(error)})})}(loadedFilterList,description,items).then(updatedFilter=>{resolve(updatedFilter)}).catch(error=>{reject(error)})})}function edit_filter_list_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}ItemsGrid.defaultProps={numberColumns:4,itemsPerPage:50,itemsPerPageOptions:[50,100,500,1e3]};function getMatchingFilterItems(searchBarQuery,items){if(void 0===items)return[];if(void 0===searchBarQuery)return[...items];const allItems=items.map(item=>({value:item}));return external_kbnSharedDeps_ElasticEui_.EuiSearchBar.Query.execute(searchBarQuery,allItems,{defaultFields:["value"]}).map(item=>item.value)}function getActivePage(activePageState,itemsPerPage,numMatchingItems){let activePage=activePageState;return itemsPerPage*activePageState>numMatchingItems&&(activePage=Math.max(Math.ceil(numMatchingItems/itemsPerPage)-1,0)),activePage}class edit_filter_list_EditFilterListUI extends external_kbnSharedDeps_React_.Component{constructor(props){super(props),edit_filter_list_defineProperty(this,"returnToFiltersList",async()=>{const{services:{http:{basePath:basePath},application:{navigateToUrl:navigateToUrl}}}=this.props.kibana;await navigateToUrl(`${basePath.get()}/app/ml/${ml_url_generator.b.FILTER_LISTS_MANAGE}`,!0)}),edit_filter_list_defineProperty(this,"loadFilterList",filterId=>{ml_api_service.ml.filters.filters({filterId:filterId}).then(filter=>{this.setLoadedFilterState(filter)}).catch(resp=>{console.log(`Error loading filter ${filterId}:`,resp);const{toasts:toasts}=this.props.kibana.services.notifications;toasts.addDanger(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.settings.filterLists.editFilterList.loadingDetailsOfFilterErrorMessage",{defaultMessage:"An error occurred loading details of filter {filterId}",values:{filterId:filterId}}))})}),edit_filter_list_defineProperty(this,"setLoadedFilterState",loadedFilter=>{this.setState(prevState=>{const{itemsPerPage:itemsPerPage,searchQuery:searchQuery}=prevState,matchingItems=getMatchingFilterItems(searchQuery,loadedFilter.items),activePage=getActivePage(prevState.activePage,itemsPerPage,matchingItems.length);return{description:loadedFilter.description,items:void 0!==loadedFilter.items?[...loadedFilter.items]:[],matchingItems:matchingItems,selectedItems:[],loadedFilter:loadedFilter,isNewFilterIdInvalid:!1,activePage:activePage,searchQuery:searchQuery,saveInProgress:!1}})}),edit_filter_list_defineProperty(this,"updateNewFilterId",newFilterId=>{var id;this.setState({newFilterId:newFilterId,isNewFilterIdInvalid:(id=newFilterId,!(void 0!==id&&id.length>0&&Object(job_utils.i)(id)))})}),edit_filter_list_defineProperty(this,"updateDescription",description=>{this.setState({description:description})}),edit_filter_list_defineProperty(this,"addItems",itemsToAdd=>{this.setState(prevState=>{const{itemsPerPage:itemsPerPage,searchQuery:searchQuery}=prevState,items=[...prevState.items],alreadyInFilter=[];if(itemsToAdd.forEach(item=>{-1===items.indexOf(item)?items.push(item):alreadyInFilter.push(item)}),items.sort((str1,str2)=>str1.localeCompare(str2)),alreadyInFilter.length>0){const{toasts:toasts}=this.props.kibana.services.notifications;toasts.addWarning(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.settings.filterLists.editFilterList.duplicatedItemsInFilterListWarningMessage",{defaultMessage:"The following items were already in the filter list: {alreadyInFilter}",values:{alreadyInFilter:alreadyInFilter}}))}const matchingItems=getMatchingFilterItems(searchQuery,items),activePage=getActivePage(prevState.activePage,itemsPerPage,matchingItems.length);return{items:items,matchingItems:matchingItems,activePage:activePage,searchQuery:searchQuery}})}),edit_filter_list_defineProperty(this,"deleteSelectedItems",()=>{this.setState(prevState=>{const{selectedItems:selectedItems,itemsPerPage:itemsPerPage,searchQuery:searchQuery}=prevState,items=[...prevState.items];selectedItems.forEach(item=>{const index=items.indexOf(item);-1!==index&&items.splice(index,1)});const matchingItems=getMatchingFilterItems(searchQuery,items),activePage=getActivePage(prevState.activePage,itemsPerPage,matchingItems.length);return{items:items,matchingItems:matchingItems,selectedItems:[],activePage:activePage,searchQuery:searchQuery}})}),edit_filter_list_defineProperty(this,"onSearchChange",({query:query})=>{this.setState(prevState=>{const{items:items,itemsPerPage:itemsPerPage}=prevState,matchingItems=getMatchingFilterItems(query,items);return{matchingItems:matchingItems,activePage:getActivePage(prevState.activePage,itemsPerPage,matchingItems.length),searchQuery:query}})}),edit_filter_list_defineProperty(this,"setItemSelected",(item,isSelected)=>{this.setState(prevState=>{const selectedItems=[...prevState.selectedItems],index=selectedItems.indexOf(item);return!0===isSelected&&-1===index?selectedItems.push(item):!1===isSelected&&-1!==index&&selectedItems.splice(index,1),{selectedItems:selectedItems}})}),edit_filter_list_defineProperty(this,"setActivePage",activePage=>{this.setState({activePage:activePage})}),edit_filter_list_defineProperty(this,"setItemsPerPage",itemsPerPage=>{this.setState({itemsPerPage:itemsPerPage,activePage:0})}),edit_filter_list_defineProperty(this,"save",()=>{this.setState({saveInProgress:!0});const{loadedFilter:loadedFilter,newFilterId:newFilterId,description:description,items:items}=this.state,filterId=void 0!==this.props.filterId?this.props.filterId:newFilterId;saveFilterList(filterId,description,items,loadedFilter).then(savedFilter=>{this.setLoadedFilterState(savedFilter),this.returnToFiltersList()}).catch(resp=>{console.log(`Error saving filter ${filterId}:`,resp);const{toasts:toasts}=this.props.kibana.services.notifications;toasts.addDanger(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.settings.filterLists.editFilterList.savingFilterErrorMessage",{defaultMessage:"An error occurred saving filter {filterId}",values:{filterId:filterId}})),this.setState({saveInProgress:!1})})}),this.state={description:"",items:[],matchingItems:[],selectedItems:[],loadedFilter:{},newFilterId:"",isNewFilterIdInvalid:!0,activePage:0,itemsPerPage:50,saveInProgress:!1}}componentDidMount(){const filterId=this.props.filterId;void 0!==filterId?this.loadFilterList(filterId):this.setState({newFilterId:""})}render(){const{loadedFilter:loadedFilter,newFilterId:newFilterId,isNewFilterIdInvalid:isNewFilterIdInvalid,description:description,items:items,matchingItems:matchingItems,selectedItems:selectedItems,itemsPerPage:itemsPerPage,activePage:activePage,saveInProgress:saveInProgress}=this.state,{canCreateFilter:canCreateFilter,canDeleteFilter:canDeleteFilter}=this.props,totalItemCount=void 0!==items?items.length:0,helpLink=Object(dependency_cache.b)().links.ml.customRules;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(navigation_menu.a,{tabId:"settings"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPage,{className:"ml-edit-filter-lists","data-test-subj":"mlPageFilterListEdit"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageBody,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageContent,{className:"ml-edit-filter-lists-content",verticalPosition:"center",horizontalPosition:"center"},external_kbnSharedDeps_React_default.a.createElement(EditFilterListHeader,{canCreateFilter:canCreateFilter,filterId:this.props.filterId,newFilterId:newFilterId,isNewFilterIdInvalid:isNewFilterIdInvalid,updateNewFilterId:this.updateNewFilterId,description:description,updateDescription:this.updateDescription,totalItemCount:totalItemCount,usedBy:loadedFilter.used_by}),external_kbnSharedDeps_React_default.a.createElement(EditFilterListToolbar,{canCreateFilter:canCreateFilter,canDeleteFilter:canDeleteFilter,onSearchChange:this.onSearchChange,addItems:this.addItems,deleteSelectedItems:this.deleteSelectedItems,selectedItemCount:selectedItems.length}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"xl"}),external_kbnSharedDeps_React_default.a.createElement(ItemsGrid,{totalItemCount:totalItemCount,items:matchingItems,selectedItems:selectedItems,itemsPerPage:itemsPerPage,setItemsPerPage:this.setItemsPerPage,setItemSelected:this.setItemSelected,activePage:activePage,setActivePage:this.setActivePage}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"flexEnd"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{"data-test-subj":"mlFilterListCancelButton",onClick:()=>this.returnToFiltersList()},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.settings.filterLists.editFilterList.cancelButtonLabel",defaultMessage:"Cancel"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{onClick:this.save,disabled:!0===saveInProgress||!0===isNewFilterIdInvalid||!1===canCreateFilter,fill:!0,"data-test-subj":"mlFilterListSaveButton"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.settings.filterLists.editFilterList.saveButtonLabel",defaultMessage:"Save"}))))))),external_kbnSharedDeps_React_default.a.createElement(help_menu.a,{docLink:helpLink}))}}edit_filter_list_defineProperty(edit_filter_list_EditFilterListUI,"displayName","EditFilterList");const EditFilterList=Object(kibanaReact_public_.withKibana)(edit_filter_list_EditFilterListUI);const FilterListsHeader=Object(kibanaReact_public_.withKibana)((function({totalCount:totalCount,refreshFilterLists:refreshFilterLists,kibana:kibana}){const docsUrl=kibana.services.docLinks.links.ml.customRules;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"baseline"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"baseline",gutterSize:"m",responsive:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,null,external_kbnSharedDeps_React_default.a.createElement("h1",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.settings.filterLists.listHeader.filterListsTitle",defaultMessage:"Filter Lists"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTextColor,{color:"subdued"},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.settings.filterLists.listHeader.filterListsDescription",defaultMessage:"{totalCount} in total",values:{totalCount:totalCount}})))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"baseline",gutterSize:"m",responsive:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{size:"s",iconType:"refresh",onClick:()=>refreshFilterLists(),"data-test-subj":"mlFilterListRefreshButton"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.settings.filterLists.listHeader.refreshButtonLabel",defaultMessage:"Refresh"})))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTextColor,{color:"subdued"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.settings.filterLists.listHeader.filterListsContainsNotAllowedValuesDescription",defaultMessage:"Filter lists contain values that you can use to include or exclude events from the machine learning analysis.\nYou can use the same filter list in multiple jobs.{br}{learnMoreLink}",values:{br:external_kbnSharedDeps_React_default.a.createElement("br",null),learnMoreLink:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{href:docsUrl,target:"_blank"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.settings.filterLists.listHeader.filterListsContainsNotAllowedValuesDescription.learnMoreLinkText",defaultMessage:"Learn more"}))}})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}))}));function delete_filter_list_modal_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class delete_filter_list_modal_DeleteFilterListModal extends external_kbnSharedDeps_React_.Component{constructor(props){super(props),delete_filter_list_modal_defineProperty(this,"closeModal",()=>{this.setState({isModalVisible:!1})}),delete_filter_list_modal_defineProperty(this,"showModal",()=>{this.setState({isModalVisible:!0})}),delete_filter_list_modal_defineProperty(this,"onConfirmDelete",()=>{this.doDelete()}),this.state={isModalVisible:!1}}async doDelete(){const{selectedFilterLists:selectedFilterLists,refreshFilterLists:refreshFilterLists}=this.props;await async function(filterListsToDelete){if(void 0===filterListsToDelete||0===filterListsToDelete.length)return;const toastNotifications=Object(dependency_cache.j)();toastNotifications.add(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.settings.filterLists.deleteFilterLists.deletingNotificationMessage",{defaultMessage:"Deleting {filterListsToDeleteLength, plural, one {{filterListToDeleteId}} other {# filter lists}}",values:{filterListsToDeleteLength:filterListsToDelete.length,filterListToDeleteId:!!filterListsToDelete.length&&filterListsToDelete[0].filter_id}}));for(const filterList of filterListsToDelete){const filterId=filterList.filter_id;try{await ml_api_service.ml.filters.deleteFilter(filterId)}catch(resp){console.log("Error deleting filter list:",resp),toastNotifications.addDanger(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.settings.filterLists.deleteFilterLists.deletingErrorMessage",{defaultMessage:"An error occurred deleting filter list {filterListId}{respMessage}",values:{filterListId:filterList.filter_id,respMessage:resp.message?" : "+resp.message:""}}))}}toastNotifications.addSuccess(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.settings.filterLists.deleteFilterLists.filtersSuccessfullyDeletedNotificationMessage",{defaultMessage:"{filterListsToDeleteLength, plural, one {{filterListToDeleteId}} other {# filter lists}} deleted",values:{filterListsToDeleteLength:filterListsToDelete.length,filterListToDeleteId:!!filterListsToDelete.length&&filterListsToDelete[0].filter_id}}))}(selectedFilterLists),refreshFilterLists(),this.closeModal()}render(){const{selectedFilterLists:selectedFilterLists,canDeleteFilter:canDeleteFilter}=this.props;let modal;if(this.state.isModalVisible){const title=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.settings.filterLists.deleteFilterListModal.modalTitle",defaultMessage:"Delete {selectedFilterListsLength, plural, one {{selectedFilterId}} other {# filter lists}}?",values:{selectedFilterListsLength:selectedFilterLists.length,selectedFilterId:!!selectedFilterLists.length&&selectedFilterLists[0].filter_id}});modal=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiConfirmModal,{title:title,className:"eui-textBreakWord",onCancel:this.closeModal,onConfirm:this.onConfirmDelete,cancelButtonText:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.settings.filterLists.deleteFilterListModal.cancelButtonLabel",defaultMessage:"Cancel"}),confirmButtonText:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.settings.filterLists.deleteFilterListModal.confirmButtonLabel",defaultMessage:"Delete"}),buttonColor:"danger",defaultFocusedButton:external_kbnSharedDeps_ElasticEui_.EUI_MODAL_CONFIRM_BUTTON,"data-test-subj":"mlFilterListDeleteConfirmation"})}return external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{key:"delete_filter_list",iconType:"trash",color:"danger",onClick:this.showModal,isDisabled:void 0===selectedFilterLists||0===selectedFilterLists.length||!1===canDeleteFilter,"data-test-subj":"mlFilterListsDeleteButton"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.settings.filterLists.deleteFilterListModal.deleteButtonLabel",defaultMessage:"Delete"})),modal)}}function UsedByIcon({usedBy:usedBy}){let icon;return icon=void 0!==usedBy&&usedBy.jobs.length>0?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{type:"check","aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.settings.filterLists.table.inUseAriaLabel",{defaultMessage:"In use"}),"data-test-subj":"mlFilterListUsedByIcon inUse"}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{type:"cross","aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.settings.filterLists.table.notInUseAriaLabel",{defaultMessage:"Not in use"}),"data-test-subj":"mlFilterListUsedByIcon notInUse"}),icon}function NewFilterButton({canCreateFilter:canCreateFilter}){const redirectToNewFilterListPage=Object(use_create_url.a)(ml_url_generator.b.FILTER_LISTS_NEW);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{key:"new_filter_list",onClick:redirectToNewFilterListPage,isDisabled:!1===canCreateFilter,"data-test-subj":"mlFilterListsButtonCreate"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.settings.filterLists.table.newButtonLabel",defaultMessage:"New"}))}function table_renderToolsRight(canCreateFilter,canDeleteFilter,selectedFilterLists,refreshFilterLists){return[external_kbnSharedDeps_React_default.a.createElement(NewFilterButton,{key:"new_filter_list",canCreateFilter:canCreateFilter}),external_kbnSharedDeps_React_default.a.createElement(delete_filter_list_modal_DeleteFilterListModal,{canDeleteFilter:canDeleteFilter,selectedFilterLists:selectedFilterLists,refreshFilterLists:refreshFilterLists})]}function FilterListsTable({canCreateFilter:canCreateFilter,canDeleteFilter:canDeleteFilter,filterLists:filterLists,selectedFilterLists:selectedFilterLists,setSelectedFilterLists:setSelectedFilterLists,refreshFilterLists:refreshFilterLists}){const search={toolsRight:table_renderToolsRight(canCreateFilter,canDeleteFilter,selectedFilterLists,refreshFilterLists),box:{incremental:!0},filters:[]},tableSelection={selectable:filterList=>void 0===filterList.used_by||0===filterList.used_by.jobs.length,selectableMessage:()=>{},onSelectionChange:selection=>setSelectedFilterLists(selection)};return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,void 0===filterLists||0===filterLists.length?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"flexEnd",justifyContent:"flexEnd"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(NewFilterButton,null))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceAround"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement("h4",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.settings.filterLists.table.noFiltersCreatedTitle",defaultMessage:"No filters have been created"})))))):external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":"mlFilterListTableContainer"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiInMemoryTable,{className:"ml-filter-lists-table",items:filterLists,itemId:"filter_id",columns:[{field:"filter_id",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.settings.filterLists.table.idColumnName",{defaultMessage:"ID"}),render:id=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Link,{to:`/${ml_url_generator.b.FILTER_LISTS_EDIT}/${id}`,"data-test-subj":"mlEditFilterListLink"},id),sortable:!0,scope:"row","data-test-subj":"mlFilterListColumnId"},{field:"description",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.settings.filterLists.table.descriptionColumnName",{defaultMessage:"Description"}),sortable:!0,"data-test-subj":"mlFilterListColumnDescription"},{field:"item_count",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.settings.filterLists.table.itemCountColumnName",{defaultMessage:"Item count"}),sortable:!0,"data-test-subj":"mlFilterListColumnItemCount"},{field:"used_by",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.settings.filterLists.table.inUseColumnName",{defaultMessage:"In use"}),render:usedBy=>external_kbnSharedDeps_React_default.a.createElement(UsedByIcon,{usedBy:usedBy}),sortable:!0,"data-test-subj":"mlFilterListColumnInUse"}],search:search,pagination:!0,sorting:{sort:{field:"filter_id",direction:"asc"}},selection:tableSelection,isSelectable:!0,"data-test-subj":"mlFilterListsTable",rowProps:item=>({"data-test-subj":"mlFilterListRow row-"+item.filter_id})})))}function filter_lists_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}delete_filter_list_modal_defineProperty(delete_filter_list_modal_DeleteFilterListModal,"displayName","DeleteFilterListModal"),UsedByIcon.propTypes={usedBy:prop_types_default.a.object},UsedByIcon.displayName="UsedByIcon";class filter_lists_FilterListsUI extends external_kbnSharedDeps_React_.Component{constructor(props){super(props),filter_lists_defineProperty(this,"setFilterLists",filterLists=>{this.setState(prevState=>{const loadedFilterIds=filterLists.map(filterList=>filterList.filter_id),selectedFilterLists=prevState.selectedFilterLists.filter(filterList=>-1!==loadedFilterIds.indexOf(filterList.filter_id));return{filterLists:filterLists,selectedFilterLists:selectedFilterLists}})}),filter_lists_defineProperty(this,"setSelectedFilterLists",selectedFilterLists=>{this.setState({selectedFilterLists:selectedFilterLists})}),filter_lists_defineProperty(this,"refreshFilterLists",()=>{ml_api_service.ml.filters.filtersStats().then(filterLists=>{this.setFilterLists(filterLists)}).catch(resp=>{console.log("Error loading list of filters:",resp);const{toasts:toasts}=this.props.kibana.services.notifications;toasts.addDanger(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.settings.filterLists.filterLists.loadingFilterListsErrorMessage",{defaultMessage:"An error occurred loading the filter lists"}))})}),this.state={filterLists:[],selectedFilterLists:[]}}componentDidMount(){this.refreshFilterLists()}render(){const{filterLists:filterLists,selectedFilterLists:selectedFilterLists}=this.state,{canCreateFilter:canCreateFilter,canDeleteFilter:canDeleteFilter}=this.props,helpLink=Object(dependency_cache.b)().links.ml.customRules;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(navigation_menu.a,{tabId:"settings"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPage,{className:"ml-list-filter-lists","data-test-subj":"mlPageFilterListManagement"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageBody,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageContent,{className:"ml-list-filter-lists-content",verticalPosition:"center",horizontalPosition:"center"},external_kbnSharedDeps_React_default.a.createElement(FilterListsHeader,{totalCount:filterLists.length,refreshFilterLists:this.refreshFilterLists}),external_kbnSharedDeps_React_default.a.createElement(FilterListsTable,{canCreateFilter:canCreateFilter,canDeleteFilter:canDeleteFilter,filterLists:filterLists,selectedFilterLists:selectedFilterLists,setSelectedFilterLists:this.setSelectedFilterLists,refreshFilterLists:this.refreshFilterLists})))),external_kbnSharedDeps_React_default.a.createElement(help_menu.a,{docLink:helpLink}))}}filter_lists_defineProperty(filter_lists_FilterListsUI,"displayName","FilterLists");const FilterLists=Object(kibanaReact_public_.withKibana)(filter_lists_FilterListsUI);function filter_list_extends(){return(filter_list_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const filterListRouteFactory=(navigateToPath,basePath)=>({path:"/settings/filter_lists",render:(props,deps)=>external_kbnSharedDeps_React_default.a.createElement(filter_list_PageWrapper,filter_list_extends({},props,{deps:deps})),breadcrumbs:[getBreadcrumbWithUrlForApp("ML_BREADCRUMB",navigateToPath,basePath),getBreadcrumbWithUrlForApp("SETTINGS_BREADCRUMB",navigateToPath,basePath),getBreadcrumbWithUrlForApp("FILTER_LISTS_BREADCRUMB",navigateToPath,basePath)]}),filter_list_PageWrapper=({deps:deps})=>{const{redirectToMlAccessDeniedPage:redirectToMlAccessDeniedPage}=deps,{context:context}=useResolver(void 0,void 0,deps.config,{checkFullLicense:license.b,checkGetJobsCapabilities:()=>Object(check_capabilities.c)(redirectToMlAccessDeniedPage),getMlNodeCount:check_ml_nodes.c});Object(contexts_kibana.g)({timeRangeSelector:!1,autoRefreshSelector:!1});const canCreateFilter=Object(check_capabilities.e)("canCreateFilter"),canDeleteFilter=Object(check_capabilities.e)("canDeleteFilter");return external_kbnSharedDeps_React_default.a.createElement(PageLoader,{context:context},external_kbnSharedDeps_React_default.a.createElement(FilterLists,{canCreateFilter:canCreateFilter,canDeleteFilter:canDeleteFilter}))};function filter_list_new_edit_extends(){return(filter_list_new_edit_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}var filter_list_new_edit_MODE;!function(MODE){MODE[MODE.NEW=0]="NEW",MODE[MODE.EDIT=1]="EDIT"}(filter_list_new_edit_MODE||(filter_list_new_edit_MODE={}));const newFilterListRouteFactory=(navigateToPath,basePath)=>({path:"/settings/filter_lists/new_filter_list",render:(props,deps)=>external_kbnSharedDeps_React_default.a.createElement(filter_list_new_edit_PageWrapper,filter_list_new_edit_extends({},props,{mode:filter_list_new_edit_MODE.NEW,deps:deps})),breadcrumbs:[getBreadcrumbWithUrlForApp("ML_BREADCRUMB",navigateToPath,basePath),getBreadcrumbWithUrlForApp("SETTINGS_BREADCRUMB",navigateToPath,basePath),getBreadcrumbWithUrlForApp("FILTER_LISTS_BREADCRUMB",navigateToPath,basePath),{text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.settings.breadcrumbs.filterLists.createLabel",{defaultMessage:"Create"}),onClick:breadcrumbOnClickFactory("/settings/filter_lists/new",navigateToPath)}]}),editFilterListRouteFactory=(navigateToPath,basePath)=>({path:"/settings/filter_lists/edit_filter_list/:filterId",render:(props,deps)=>external_kbnSharedDeps_React_default.a.createElement(filter_list_new_edit_PageWrapper,filter_list_new_edit_extends({},props,{mode:filter_list_new_edit_MODE.EDIT,deps:deps})),breadcrumbs:[getBreadcrumbWithUrlForApp("ML_BREADCRUMB",navigateToPath,basePath),getBreadcrumbWithUrlForApp("SETTINGS_BREADCRUMB",navigateToPath,basePath),getBreadcrumbWithUrlForApp("FILTER_LISTS_BREADCRUMB",navigateToPath,basePath),{text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.settings.breadcrumbs.filterLists.editLabel",{defaultMessage:"Edit"}),onClick:breadcrumbOnClickFactory("/settings/filter_lists/edit",navigateToPath)}]}),filter_list_new_edit_PageWrapper=({location:location,mode:mode,deps:deps})=>{let filterId;if(mode===filter_list_new_edit_MODE.EDIT){const pathMatch=location.pathname.match(/.+\/(.+)$/);filterId=pathMatch&&pathMatch.length>1?pathMatch[1]:void 0}const{redirectToMlAccessDeniedPage:redirectToMlAccessDeniedPage}=deps,redirectToJobsManagementPage=Object(use_create_url.a)(ml_url_generator.b.ANOMALY_DETECTION_JOBS_MANAGE),{context:context}=useResolver(void 0,void 0,deps.config,{checkFullLicense:license.b,checkGetJobsCapabilities:()=>Object(check_capabilities.c)(redirectToMlAccessDeniedPage),checkMlNodesAvailable:()=>Object(check_ml_nodes.a)(redirectToJobsManagementPage)});Object(contexts_kibana.g)({timeRangeSelector:!1,autoRefreshSelector:!1});const canCreateFilter=Object(check_capabilities.e)("canCreateFilter"),canDeleteFilter=Object(check_capabilities.e)("canDeleteFilter");return external_kbnSharedDeps_React_default.a.createElement(PageLoader,{context:context},external_kbnSharedDeps_React_default.a.createElement(EditFilterList,{filterId:filterId,canCreateFilter:canCreateFilter,canDeleteFilter:canDeleteFilter}))};var analytics_management_page=__webpack_require__(284);function analytics_jobs_list_extends(){return(analytics_jobs_list_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const analyticsJobsListRouteFactory=(navigateToPath,basePath)=>({path:"/data_frame_analytics",render:(props,deps)=>external_kbnSharedDeps_React_default.a.createElement(analytics_jobs_list_PageWrapper,analytics_jobs_list_extends({},props,{deps:deps})),breadcrumbs:[getBreadcrumbWithUrlForApp("ML_BREADCRUMB",navigateToPath,basePath),getBreadcrumbWithUrlForApp("DATA_FRAME_ANALYTICS_BREADCRUMB",navigateToPath,basePath),{text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataFrameAnalyticsBreadcrumbs.dataFrameListLabel",{defaultMessage:"Job Management"}),href:""}]}),analytics_jobs_list_PageWrapper=({location:location,deps:deps})=>{const{context:context}=useResolver(void 0,void 0,deps.config,basicResolvers(deps));return external_kbnSharedDeps_React_default.a.createElement(PageLoader,{context:context},external_kbnSharedDeps_React_default.a.createElement(analytics_management_page.a,null))};var common_fields=__webpack_require__(86);const useScatterplotFieldOptions=(indexPattern,includes,excludes,resultsField="")=>Object(external_kbnSharedDeps_React_.useMemo)(()=>{const fields=[];return void 0===indexPattern||void 0===includes?fields:(includes.length>1?fields.push(...includes.filter(d=>indexPattern.fields.some(f=>f.name===d&&"number"===f.type))):fields.push(...indexPattern.fields.filter(f=>"number"===f.type&&!indexPattern.metaFields.includes(f.name)&&!f.name.startsWith(resultsField+".")&&f.name!==common_fields.i).map(f=>f.name)),Array.isArray(excludes)&&excludes.length>0?fields.filter(f=>!excludes.includes(f)):fields)},[indexPattern,includes,excludes]);var common=__webpack_require__(16),runtime_field_utils=__webpack_require__(18),data_grid=__webpack_require__(110);const VegaChartLoading=()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{textAlign:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingSpinner,{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"})),VegaChartView=external_kbnSharedDeps_React_default.a.lazy(()=>__webpack_require__.e(12).then(__webpack_require__.bind(null,879))),VegaChart=props=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiErrorBoundary,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Suspense,{fallback:external_kbnSharedDeps_React_default.a.createElement(VegaChartLoading,null)},external_kbnSharedDeps_React_default.a.createElement(VegaChartView,props)));var vega_chart_common=__webpack_require__(237);const DEFAULT_COLOR=Object(external_kbnSharedDeps_ElasticEui_.euiPaletteColorBlind)()[0],COLOR_OUTLIER=Object(external_kbnSharedDeps_ElasticEui_.euiPaletteNegative)(2)[1],COLOR_RANGE_NOMINAL=Object(external_kbnSharedDeps_ElasticEui_.euiPaletteColorBlind)({rotations:2}),COLOR_RANGE_QUANTITATIVE=Object(external_kbnSharedDeps_ElasticEui_.euiPalettePositive)(5);function getEscapedVegaFieldName(fieldName){return fieldName.replace(/([\.|\[|\]])/g,"\\$1")}const getScatterplotMatrixVegaLiteSpec=(values,columns,euiTheme,resultsField,color,legendType,dynamicSize)=>{const vegaValues=values,vegaColumns=columns.map(getEscapedVegaFieldName),outliers=void 0!==resultsField,escapedOutlierScoreField=resultsField+"\\.outlier_score",colorSpec=((euiTheme,escapedOutlierScoreField,color,legendType)=>"string"==typeof escapedOutlierScoreField?{condition:{value:COLOR_OUTLIER,test:`(datum['${escapedOutlierScoreField}'] >= mlOutlierScoreThreshold.cutoff)`},value:euiTheme.euiColorMediumShade}:void 0!==color&&void 0!==legendType?{field:getEscapedVegaFieldName(color),type:legendType,scale:{range:legendType===vega_chart_common.a.NOMINAL?COLOR_RANGE_NOMINAL:COLOR_RANGE_QUANTITATIVE}}:{value:DEFAULT_COLOR})(euiTheme,resultsField&&escapedOutlierScoreField,color,legendType);return{$schema:"https://vega.github.io/schema/vega-lite/v4.17.0.json",background:"transparent",view:{fill:"transparent",stroke:euiTheme.euiColorLightestShade},padding:10,config:{axis:{domainColor:euiTheme.euiColorLightShade,gridColor:euiTheme.euiColorLightestShade,tickColor:euiTheme.euiColorLightestShade,labelColor:euiTheme.euiTextSubduedColor,titleColor:euiTheme.euiTextSubduedColor}},repeat:{column:vegaColumns,row:vegaColumns.slice().reverse()},spec:{data:{values:[...vegaValues]},mark:{...outliers&&dynamicSize?{type:"circle",strokeWidth:1.2,strokeOpacity:.75,fillOpacity:.1}:{type:"circle",opacity:.75,size:8}},encoding:{color:colorSpec,...dynamicSize?{stroke:colorSpec,opacity:{condition:{value:1,test:`(datum['${escapedOutlierScoreField}'] >= mlOutlierScoreThreshold.cutoff)`},value:.5}}:{},...outliers?{order:{field:escapedOutlierScoreField},size:{...dynamicSize?{type:vega_chart_common.a.QUANTITATIVE,field:escapedOutlierScoreField,scale:{type:"linear",range:[8,200],domain:[0,1]}}:{condition:{value:40,test:`(datum['${escapedOutlierScoreField}'] >= mlOutlierScoreThreshold.cutoff)`},value:8}}}:{},x:{type:vega_chart_common.a.QUANTITATIVE,field:{repeat:"column"},scale:{zero:!1}},y:{type:vega_chart_common.a.QUANTITATIVE,field:{repeat:"row"},scale:{zero:!1}},tooltip:[...void 0!==color?[{type:colorSpec.type,field:getEscapedVegaFieldName(color)}]:[],...vegaColumns.map(d=>({type:vega_chart_common.a.QUANTITATIVE,field:d})),...outliers?[{type:vega_chart_common.a.QUANTITATIVE,field:escapedOutlierScoreField,format:".3f"}]:[]]},...outliers?{selection:{mlOutlierScoreThreshold:{type:"single",fields:["cutoff"],bind:{input:"range",max:1,min:0,name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.splomSpec.outlierScoreThresholdName",{defaultMessage:"Outlier score threshold: "}),step:.01},init:{cutoff:.99}}}}:{},width:125,height:125}}};__webpack_require__(705);const TOGGLE_ON=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.splom.toggleOn",{defaultMessage:"On"}),TOGGLE_OFF=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.splom.toggleOff",{defaultMessage:"Off"}),sampleSizeOptions=[100,1e3,1e4].map(d=>({value:d,text:""+d})),OptionLabelWithIconTip=({label:label,tooltip:tooltip})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,label,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIconTip,{content:tooltip,iconProps:{className:"eui-alignTop"},size:"s"})),ScatterplotMatrix=({fields:allFields,index:index,resultsField:resultsField,color:color,legendType:legendType,searchQuery:searchQuery,runtimeMappings:runtimeMappings,indexPattern:indexPattern})=>{const{esSearch:esSearch}=Object(contexts_kibana.a)(),[dynamicSize,setDynamicSize]=Object(external_kbnSharedDeps_React_.useState)(!1),[fields,setFields]=Object(external_kbnSharedDeps_React_.useState)([]);Object(external_kbnSharedDeps_React_.useEffect)(()=>{const defaultFields=allFields.length>4?allFields.slice(0,4):allFields;setFields(defaultFields)},[allFields]);const[fetchSize,setFetchSize]=Object(external_kbnSharedDeps_React_.useState)(1e3),[randomizeQuery,setRandomizeQuery]=Object(external_kbnSharedDeps_React_.useState)(!1),[isLoading,setIsLoading]=Object(external_kbnSharedDeps_React_.useState)(!1),[splom,setSplom]=Object(external_kbnSharedDeps_React_.useState)(),fieldOptions=Object(external_kbnSharedDeps_React_.useMemo)(()=>allFields.map(d=>({label:d})),[allFields]),{euiTheme:euiTheme}=Object(color_range_legend.e)();Object(external_kbnSharedDeps_React_.useEffect)(()=>{if(0===fields.length)return setSplom({columns:[],items:[],messages:[]}),void setIsLoading(!1);const options={didCancel:!1};return async function(options){setIsLoading(!0);const messages=[];try{const outlierScoreField=resultsField+".outlier_score",includeOutlierScoreField=void 0!==resultsField,queryFields=[...fields,...void 0!==color?[color]:[],...includeOutlierScoreField?[outlierScoreField]:[]],query=randomizeQuery?{function_score:{query:searchQuery,random_score:{seed:10,field:"_seq_no"}}}:searchQuery,combinedRuntimeMappings=indexPattern&&Object(data_grid.h)(indexPattern,runtimeMappings),resp=await esSearch({index:index,body:{fields:queryFields,_source:!1,query:query,from:0,size:fetchSize,...Object(runtime_field_utils.b)(combinedRuntimeMappings)?{runtime_mappings:combinedRuntimeMappings}:{}}});if(!options.didCancel){const items=resp.hits.hits.map(d=>{var _d$fields;return Object(data_grid.n)(null!==(_d$fields=d.fields)&&void 0!==_d$fields?_d$fields:{},key=>key.startsWith(resultsField+".feature_importance"))}).filter(d=>!Object.keys(d).some(field=>Array.isArray(d[field]))),originalDocsCount=resp.hits.hits.length,filteredDocsCount=originalDocsCount-items.length;originalDocsCount===filteredDocsCount?messages.push(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.splom.allDocsFilteredWarningMessage",{defaultMessage:"All fetched documents included fields with arrays of values and cannot be visualized."})):resp.hits.hits.length!==items.length&&messages.push(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.splom.arrayFieldsWarningMessage",{defaultMessage:"{filteredDocsCount} out of {originalDocsCount} fetched documents include fields with arrays of values and cannot be visualized.",values:{originalDocsCount:originalDocsCount,filteredDocsCount:filteredDocsCount}})),setSplom({columns:fields,items:items,messages:messages}),setIsLoading(!1)}}catch(e){setIsLoading(!1),setSplom({columns:[],items:[],messages:[Object(common.extractErrorMessage)(e)]})}}(options),()=>{options.didCancel=!0}},[fetchSize,JSON.stringify({fields:fields,searchQuery:searchQuery}),index,randomizeQuery,resultsField]);const vegaSpec=Object(external_kbnSharedDeps_React_.useMemo)(()=>{if(void 0===splom)return;const{items:items,columns:columns}=splom;return getScatterplotMatrixVegaLiteSpec(items,columns,euiTheme,resultsField,color,legendType,dynamicSize)},[resultsField,splom,color,legendType,dynamicSize]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,void 0===splom||void 0===vegaSpec?external_kbnSharedDeps_React_default.a.createElement(VegaChartLoading,null):external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":"mlScatterplotMatrix "+(isLoading?"loading":"loaded")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_React_default.a.createElement(OptionLabelWithIconTip,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.splom.fieldSelectionLabel",{defaultMessage:"Fields"}),tooltip:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.splom.fieldSelectionInfoTooltip",{defaultMessage:"Pick fields to explore their relationships."})}),display:"rowCompressed",fullWidth:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiComboBox,{compressed:!0,fullWidth:!0,placeholder:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.splom.fieldSelectionPlaceholder",{defaultMessage:"Select fields"}),options:fieldOptions,selectedOptions:fields.map(d=>({label:d})),onChange:newFields=>{setFields(newFields.map(d=>d.label))},isClearable:!0,"data-test-subj":"mlScatterplotMatrixFieldsComboBox"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{style:{width:"200px"},grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_React_default.a.createElement(OptionLabelWithIconTip,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.splom.sampleSizeLabel",{defaultMessage:"Sample size"}),tooltip:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.splom.sampleSizeInfoTooltip",{defaultMessage:"Amount of documents to display in the scatterplot matrix."})}),display:"rowCompressed",fullWidth:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSelect,{"data-test-subj":"mlScatterplotMatrixSampleSizeSelect",compressed:!0,options:sampleSizeOptions,value:fetchSize,onChange:e=>{setFetchSize(Math.min(Math.max(parseInt(e.target.value,10),1),1e4))}}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{style:{width:"120px"},grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_React_default.a.createElement(OptionLabelWithIconTip,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.splom.randomScoringLabel",{defaultMessage:"Random scoring"}),tooltip:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.splom.randomScoringInfoTooltip",{defaultMessage:"Uses a function score query to get randomly selected documents as the sample."})}),display:"rowCompressed",fullWidth:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSwitch,{"data-test-subj":"mlScatterplotMatrixRandomizeQuerySwitch",name:"mlScatterplotMatrixRandomizeQuery",label:randomizeQuery?TOGGLE_ON:TOGGLE_OFF,checked:randomizeQuery,onChange:()=>{setRandomizeQuery(!randomizeQuery)},disabled:isLoading}))),void 0!==resultsField&&void 0===legendType&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{style:{width:"120px"},grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_React_default.a.createElement(OptionLabelWithIconTip,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.splom.dynamicSizeLabel",{defaultMessage:"Dynamic size"}),tooltip:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.splom.dynamicSizeInfoTooltip",{defaultMessage:"Scales the size of each point by its outlier score."})}),display:"rowCompressed",fullWidth:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSwitch,{name:"mlScatterplotMatrixDynamicSize",label:dynamicSize?TOGGLE_ON:TOGGLE_OFF,checked:dynamicSize,onChange:()=>{setDynamicSize(!dynamicSize)},disabled:isLoading})))),splom.messages.length>0&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{color:"warning"},splom.messages.map(m=>external_kbnSharedDeps_React_default.a.createElement("span",{key:Object(util_string_utils.d)(m)},m,external_kbnSharedDeps_React_default.a.createElement("br",null))))),splom.items.length>0&&external_kbnSharedDeps_React_default.a.createElement(VegaChart,{vegaSpec:vegaSpec})))};var data_frame_analytics_common=__webpack_require__(71),constants=__webpack_require__(147);__webpack_require__(379);function getDefaultExplorationPageUrlState(overrides){return{queryText:"",queryLanguage:constants_search.c.KUERY,pageIndex:0,pageSize:25,analysis:!1,evaluation:!0,feature_importance:!0,results:!0,splom:!0,...Object(object_utils.b)(overrides)?overrides:{}}}function useExplorationUrlState(overrides){return Object(url_state.b)(ml_url_generator.b.DATA_FRAME_ANALYTICS_EXPLORATION,getDefaultExplorationPageUrlState(overrides))}const ExpandableSection=({headerItems:headerItems,content:content,isExpanded:isExpandedDefault,contentPadding:contentPadding=!1,dataTestId:dataTestId,title:title,docsLink:docsLink,urlStateKey:urlStateKey})=>{const overrides=Object(external_kbnSharedDeps_React_.useMemo)(()=>void 0!==isExpandedDefault?{[urlStateKey]:isExpandedDefault}:void 0,[urlStateKey,isExpandedDefault]),[pageUrlState,setPageUrlState]=useExplorationUrlState(overrides),isExpanded=void 0!==isExpandedDefault&&pageUrlState[urlStateKey]===getDefaultExplorationPageUrlState(overrides)[urlStateKey]?isExpandedDefault:pageUrlState[urlStateKey],toggleExpanded=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setPageUrlState({[urlStateKey]:!isExpanded})},[isExpanded,setPageUrlState,urlStateKey]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPanel,{paddingSize:"none","data-test-subj":"mlDFExpandableSection-"+dataTestId},external_kbnSharedDeps_React_default.a.createElement("div",{className:"mlExpandableSection"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceBetween",gutterSize:"none"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{onClick:toggleExpanded,iconType:isExpanded?"arrowUp":"arrowDown",size:"l",iconSide:"right",flush:"left"},title)),void 0!==docsLink&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},docsLink)),"header_items_loading"===headerItems&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingContent,{lines:1}),(arg=headerItems,Array.isArray(arg)&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,headerItems.map(({label:label,value:value,id:id})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,key:id,"data-test-subj":`mlDFExpandableSectionItem-${dataTestId}-${id}`},void 0!==label&&void 0!==value&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs",color:"subdued"},external_kbnSharedDeps_React_default.a.createElement("p",null,label)))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBadge,null,value)))),void 0===label&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs",color:"subdued"},value)))))),isExpanded&&external_kbnSharedDeps_React_default.a.createElement("div",{className:contentPadding?"mlExpandableSection-contentPadding":""},content));var arg};var get_analytics=__webpack_require__(164),analytics_list_common=__webpack_require__(93),expanded_row=__webpack_require__(413);const ExpandableSectionAnalytics=({jobId:jobId})=>{const[expandedRowItem,setExpandedRowItem]=Object(external_kbnSharedDeps_React_.useState)();Object(external_kbnSharedDeps_React_.useEffect)(()=>{(async()=>{const analyticsConfigs=await ml_api_service.ml.dataFrameAnalytics.getDataFrameAnalytics(jobId),analyticsStats=await ml_api_service.ml.dataFrameAnalytics.getDataFrameAnalyticsStats(jobId),config=analyticsConfigs.data_frame_analytics[0],stats=Object(get_analytics.b)(analyticsStats)?analyticsStats.data_frame_analytics[0]:void 0;if(void 0===stats)return;const newExpandedRowItem={checkpointing:{},config:config,id:config.id,job_type:Object(data_frame_analytics_common.t)(config.analysis),mode:analytics_list_common.a.BATCH,state:stats.state,stats:stats};setExpandedRowItem(newExpandedRowItem)})()},[jobId]);const analyticsSectionHeaderItems=(expandedRowItem=>{if(void 0===expandedRowItem)return"header_items_loading";const sourceIndex=Array.isArray(expandedRowItem.config.source.index)?expandedRowItem.config.source.index.join():expandedRowItem.config.source.index;return[{id:"analysisTypeLabel",label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataframe.analytics.exploration.analysisTypeLabel",defaultMessage:"Type"}),value:expandedRowItem.job_type},{id:"analysisSourceIndexLabel",label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataframe.analytics.exploration.analysisSourceIndexLabel",defaultMessage:"Source index"}),value:sourceIndex},{id:"analysisDestinationIndexLabel",label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataframe.analytics.exploration.analysisDestinationIndexLabel",defaultMessage:"Destination index"}),value:expandedRowItem.config.dest.index}]})(expandedRowItem),analyticsSectionContent=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHorizontalRule,{size:"full",margin:"none"}),void 0===expandedRowItem&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{textAlign:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingSpinner,{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"})),void 0!==expandedRowItem&&external_kbnSharedDeps_React_default.a.createElement(expanded_row.a,{item:expandedRowItem}));return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(ExpandableSection,{dataTestId:"analysis",content:analyticsSectionContent,headerItems:analyticsSectionHeaderItems,urlStateKey:"analysis",title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataframe.analytics.exploration.analysisSectionTitle",defaultMessage:"Analysis"})}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}))};var analytics_utils=__webpack_require__(97);const IndexPatternPrompt=({destIndex:destIndex})=>{const{services:{http:{basePath:basePath}}}=Object(contexts_kibana.b)();return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs",color:"warning"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataframe.analytics.indexPatternPromptMessage",defaultMessage:"No index pattern exists for index {destIndex}. {linkToIndexPatternManagement} for {destIndex}.",values:{destIndex:destIndex,linkToIndexPatternManagement:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{href:basePath.get()+"/app/management/kibana/indexPatterns/create",target:"_blank"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataframe.analytics.indexPatternPromptLinkText",defaultMessage:"Create an index pattern"}))}})))};function expandable_section_results_extends(){return(expandable_section_results_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const showingDocs=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.explorationResults.documentsShownHelpText",{defaultMessage:"Showing documents for which predictions exist"}),showingFirstDocs=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.explorationResults.firstDocumentsShownHelpText",{defaultMessage:"Showing first {searchSize} documents for which predictions exist",values:{searchSize:data_frame_analytics_common.p}}),ExpandableSectionResults=({colorRange:colorRange,indexData:indexData,indexPattern:indexPattern,jobConfig:jobConfig,needsDestIndexPattern:needsDestIndexPattern,searchQuery:searchQuery})=>{const{columnsWithCharts:columnsWithCharts,status:status,tableItems:tableItems}=indexData,resultsSectionHeaderItems=((columnsWithCharts,status,tableItems,rowCount,rowCountRelation,colorRange)=>columnsWithCharts.length>0&&(tableItems.length>0||status===data_frame_analytics_common.i.LOADED)?[{id:"explorationTableTotalDocs",label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataframe.analytics.exploration.explorationTableTotalDocsLabel",defaultMessage:"Total docs"}),value:`${rowCountRelation===es_client.a.GTE?">":""}${rowCount}`},...void 0!==colorRange?[{id:"colorRangeLegend",value:external_kbnSharedDeps_React_default.a.createElement(color_range_legend.c,{colorRange:colorRange,title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.exploration.colorRangeLegendTitle",{defaultMessage:"Feature influence score"})})}]:[]]:"header_items_loading")(columnsWithCharts,status,tableItems,indexData.rowCount,indexData.rowCountRelation,colorRange),analysisType=jobConfig&&jobConfig.analysis?Object(data_frame_analytics_common.t)(jobConfig.analysis):void 0,resultsSectionContent=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,void 0!==jobConfig&&needsDestIndexPattern&&external_kbnSharedDeps_React_default.a.createElement("div",{className:"mlExpandableSection-contentPadding"},external_kbnSharedDeps_React_default.a.createElement(IndexPatternPrompt,{destIndex:jobConfig.dest.index})),void 0!==jobConfig&&(Object(analytics_utils.h)(jobConfig.analysis)||Object(analytics_utils.f)(jobConfig.analysis))&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs",color:"subdued",className:"mlExpandableSection-contentPadding"},tableItems.length===data_frame_analytics_common.p?showingFirstDocs:showingDocs),(columnsWithCharts.length>0||searchQuery!==data_frame_analytics_common.s)&&void 0!==indexPattern&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,columnsWithCharts.length>0&&(tableItems.length>0||status===data_frame_analytics_common.i.LOADED)&&external_kbnSharedDeps_React_default.a.createElement(data_grid.a,expandable_section_results_extends({},indexData,{analysisType:analysisType,dataTestSubj:"mlExplorationDataGrid",toastNotifications:Object(dependency_cache.j)()}))));return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(ExpandableSection,{urlStateKey:"results",dataTestId:"results",content:resultsSectionContent,headerItems:resultsSectionHeaderItems,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataframe.analytics.exploration.explorationTableTitle",defaultMessage:"Results"})}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}))},ExpandableSectionSplom=props=>{const splomSectionContent=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHorizontalRule,{size:"full",margin:"none"}),external_kbnSharedDeps_React_default.a.createElement("div",{className:"mlExpandableSection-contentPadding"},external_kbnSharedDeps_React_default.a.createElement(ScatterplotMatrix,props)));return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(ExpandableSection,{dataTestId:"splom",urlStateKey:"splom",content:splomSectionContent,headerItems:void 0,isExpanded:!0,title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataframe.analytics.exploration.splomSectionTitle",defaultMessage:"Scatterplot matrix"})}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}))};var explorer_utils=__webpack_require__(99);const ExplorationQueryBar=({indexPattern:indexPattern,setSearchQuery:setSearchQuery,filters:filters,query:query})=>{const[searchInput,setSearchInput]=Object(external_kbnSharedDeps_React_.useState)(query),[idToSelectedMap,setIdToSelectedMap]=Object(external_kbnSharedDeps_React_.useState)({}),[errorMessage,setErrorMessage]=Object(external_kbnSharedDeps_React_.useState)(void 0),regex=Object(external_kbnSharedDeps_React_.useMemo)(()=>new RegExp((null==filters?void 0:filters.columnId)+"\\s*:\\s*(true|false)","g"),[null==filters?void 0:filters.columnId]);Object(external_kbnSharedDeps_React_.useEffect)((function(){if(void 0!==filters){const match=query.query.match(regex);let filterKeyInEffect;null!==match&&match[0].includes("true")?filterKeyInEffect=Object.keys(filters.key).find(i=>!0===filters.key[i]):null!==match&&match[0].includes("false")&&(filterKeyInEffect=Object.keys(filters.key).find(i=>!1===filters.key[i])),filterKeyInEffect&&setIdToSelectedMap({[filterKeyInEffect]:!0})}}),[]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{try{let convertedQuery;switch(query.language){case constants_search.c.KUERY:convertedQuery=data_public_.esKuery.toElasticsearchQuery(data_public_.esKuery.fromKueryExpression(query.query),indexPattern);break;case constants_search.c.LUCENE:convertedQuery=data_public_.esQuery.luceneStringToDsl(query.query);break;default:return void setErrorMessage({query:query.query,message:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.queryBar.queryLanguageNotSupported",{defaultMessage:"Query language is not supported"})})}setSearchQuery({queryString:query.query,query:convertedQuery,language:query.language})}catch(e){setErrorMessage({query:query.query,message:e.message})}},[query.query]);const searchSubmitHandler=(q,filtering)=>{void 0===filtering&&setIdToSelectedMap({}),setSearchQuery({queryString:q.query,language:q.language})},debouncedHandleFilterUpdate=Object(external_kbnSharedDeps_Lodash_.debounce)((optionId,currentIdToSelectedMap)=>{let newQuery="";const filterValue=null==filters?void 0:filters.key[optionId],filterQueryString=`${null==filters?void 0:filters.columnId}:${filterValue}`;!1===currentIdToSelectedMap[optionId]?newQuery=""!==searchInput.query?Object(explorer_utils.s)(searchInput.query,null==filters?void 0:filters.columnId,String(filterValue)):"":!0===currentIdToSelectedMap[optionId]&&(newQuery=""===searchInput.query?filterQueryString:null!==searchInput.query.match(regex)?searchInput.query.replace(regex,filterQueryString):`${searchInput.query} and ${filterQueryString}`);const newSearchInput={...searchInput,query:newQuery};setSearchInput(newSearchInput),searchSubmitHandler(newSearchInput,!0)},200);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiInputPopover,{style:{maxWidth:"100%"},closePopover:()=>setErrorMessage(void 0),input:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(data_public_.QueryStringInput,{bubbleSubmitEvent:!1,query:searchInput,indexPatterns:[indexPattern],onChange:q=>setSearchInput(q),onSubmit:searchSubmitHandler,placeholder:searchInput.language===constants_search.c.KUERY?external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.stepDefineForm.queryPlaceholderKql",{defaultMessage:"Search for e.g. {example}",values:{example:'method : "GET" or status : "404"'}}):external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.stepDefineForm.queryPlaceholderLucene",{defaultMessage:"Search for e.g. {example}",values:{example:"method:GET OR status:404"}}),disableAutoFocus:!0,dataTestSubj:"transformQueryInput",languageSwitcherPopoverAnchorPosition:"rightDown"})),filters&&filters.options&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,"data-test-subj":"mlDFAnalyticsExplorationQueryBarFilterButtons"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonGroup,{legend:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.explorationQueryBar.buttonGroupLegend",{defaultMessage:"Analytics query bar filter buttons"}),options:filters.options,type:"multi",idToSelectedMap:idToSelectedMap,onChange:optionId=>{const newIdToSelectedMap={[optionId]:!idToSelectedMap[optionId]};setIdToSelectedMap(newIdToSelectedMap),debouncedHandleFilterUpdate(optionId,newIdToSelectedMap)}}))),isOpen:(null==errorMessage?void 0:errorMessage.query)===searchInput.query&&""!==(null==errorMessage?void 0:errorMessage.message)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCode,null,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.stepDefineForm.invalidQuery",{defaultMessage:"Invalid Query"}),": ",null==errorMessage?void 0:errorMessage.message.split("\n")[0]))},getOutlierScoreFieldName=jobConfig=>`${jobConfig.dest.results_field}.${constants.c}`,getFeatureCount=(resultsField,tableItems=[])=>{if(0===tableItems.length)return 0;const fullItem=tableItems[0];return Array.isArray(fullItem[`${resultsField}.${constants.b}`])?fullItem[`${resultsField}.${constants.b}`].length:0};var data_frame_analytics=__webpack_require__(79),useUpdateEffect=__webpack_require__(722),useUpdateEffect_default=__webpack_require__.n(useUpdateEffect),data_grid_common=__webpack_require__(91);const useExplorationDataGrid=(columns,defaultVisibleColumnsCount=data_grid_common.b,defaultVisibleColumnsFilter)=>{const[pageUrlState,setPageUrlState]=useExplorationUrlState(),dataGrid=Object(data_grid.q)(columns,25,defaultVisibleColumnsCount,defaultVisibleColumnsFilter);return dataGrid.pagination=Object(external_kbnSharedDeps_React_.useMemo)(()=>({pageSize:pageUrlState.pageSize,pageIndex:pageUrlState.pageIndex}),[pageUrlState.pageSize,pageUrlState.pageIndex]),dataGrid.setPagination=Object(external_kbnSharedDeps_React_.useCallback)(u=>{setPageUrlState({...u})},[setPageUrlState]),dataGrid.onChangePage=Object(external_kbnSharedDeps_React_.useCallback)(pageIndex=>{setPageUrlState({pageIndex:pageIndex})},[setPageUrlState]),dataGrid.onChangeItemsPerPage=Object(external_kbnSharedDeps_React_.useCallback)(pageSize=>{setPageUrlState({pageSize:pageSize})},[setPageUrlState]),dataGrid.resetPagination=Object(external_kbnSharedDeps_React_.useCallback)(()=>{const a=getDefaultExplorationPageUrlState();setPageUrlState({pageSize:a.pageSize,pageIndex:a.pageIndex})},[setPageUrlState]),useUpdateEffect_default()((function(){dataGrid.resetPagination()}),[pageUrlState.queryText]),dataGrid},useOutlierData=(indexPattern,jobConfig,searchQuery)=>{var _jobConfig$dest$resul;const needsDestIndexFields=void 0!==indexPattern&&indexPattern.title===(null==jobConfig?void 0:jobConfig.source.index[0]),columns=Object(external_kbnSharedDeps_React_.useMemo)(()=>{const newColumns=[];if(void 0!==jobConfig&&void 0!==indexPattern){const resultsField=jobConfig.dest.results_field,{fieldTypes:fieldTypes}=Object(data_frame_analytics_common.y)(jobConfig,needsDestIndexFields);newColumns.push(...Object(data_grid.k)(fieldTypes,resultsField).sort((a,b)=>Object(common_fields.l)(a.id,b.id,jobConfig)))}return newColumns},[jobConfig,indexPattern]),dataGrid=useExplorationDataGrid(columns,8,d=>!d.includes(`.${constants.b}.`)&&d!==common_fields.h&&d!==common_fields.i);Object(external_kbnSharedDeps_React_.useEffect)(()=>{void 0!==jobConfig&&dataGrid.setSortingColumns([{id:getOutlierScoreFieldName(jobConfig),direction:"desc"}])},[jobConfig&&jobConfig.id]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{const options={didCancel:!1};return Object(data_frame_analytics_common.x)(jobConfig,dataGrid,searchQuery,options),()=>{options.didCancel=!0}},[jobConfig&&jobConfig.id,dataGrid.pagination,searchQuery,dataGrid.sortingColumns]);const dataLoader=Object(external_kbnSharedDeps_React_.useMemo)(()=>void 0!==indexPattern?new data_loader_DataLoader(indexPattern,Object(dependency_cache.j)()):void 0,[indexPattern]);Object(external_kbnSharedDeps_React_.useEffect)(()=>{dataGrid.chartsVisible&&async function(){try{if(void 0!==jobConfig&&void 0!==dataLoader){const columnChartsData=await dataLoader.loadFieldHistograms(columns.filter(cT=>dataGrid.visibleColumns.includes(cT.id)).map(cT=>({fieldName:cT.id,type:Object(data_grid.l)(cT.schema)})),searchQuery);dataGrid.setColumnCharts(columnChartsData)}}catch(e){Object(data_grid.p)(e,Object(dependency_cache.j)())}}()},[dataGrid.chartsVisible,null==jobConfig?void 0:jobConfig.dest.index,JSON.stringify([searchQuery,[...dataGrid.visibleColumns].sort()])]);const colorRange=Object(color_range_legend.d)(color_range_legend.a.BLUE,color_range_legend.b.INFLUENCER,void 0!==jobConfig?getFeatureCount(jobConfig.dest.results_field,dataGrid.tableItems):1),renderCellValue=Object(data_grid.r)(indexPattern,dataGrid.pagination,dataGrid.tableItems,null!==(_jobConfig$dest$resul=null==jobConfig?void 0:jobConfig.dest.results_field)&&void 0!==_jobConfig$dest$resul?_jobConfig$dest$resul:data_frame_analytics.d,(columnId,cellValue,fullItem,setCellProps)=>{var _jobConfig$dest$resul2;let backgroundColor;const featureNames=fullItem[`${null!==(_jobConfig$dest$resul2=null==jobConfig?void 0:jobConfig.dest.results_field)&&void 0!==_jobConfig$dest$resul2?_jobConfig$dest$resul2:""}.${constants.b}`];if(Array.isArray(featureNames)){const featureForColumn=featureNames.find(feature=>columnId===feature.feature_name[0]);featureForColumn&&(backgroundColor=colorRange(featureForColumn.influence[0]))}void 0!==backgroundColor&&setCellProps({style:{backgroundColor:String(backgroundColor)}})});return{...dataGrid,renderCellValue:renderCellValue}},OutlierExploration=external_kbnSharedDeps_React_default.a.memo(({jobId:jobId})=>{var _jobConfig$dest,_jobConfig$dest$resul;const{indexPattern:indexPattern,indexPatternErrorMessage:indexPatternErrorMessage,jobConfig:jobConfig,needsDestIndexPattern:needsDestIndexPattern}=Object(data_frame_analytics_common.J)(jobId),[pageUrlState,setPageUrlState]=useExplorationUrlState(),[searchQuery,setSearchQuery]=Object(external_kbnSharedDeps_React_.useState)(data_frame_analytics_common.s),outlierData=useOutlierData(indexPattern,jobConfig,searchQuery),searchQueryUpdateHandler=Object(external_kbnSharedDeps_React_.useCallback)(update=>{update.query&&setSearchQuery(update.query),update.queryString!==pageUrlState.queryText&&setPageUrlState({queryText:update.queryString,queryLanguage:update.language})},[pageUrlState,setPageUrlState]),query={query:pageUrlState.queryText,language:pageUrlState.queryLanguage},{columnsWithCharts:columnsWithCharts,tableItems:tableItems}=outlierData,featureCount=getFeatureCount((null==jobConfig||null===(_jobConfig$dest=jobConfig.dest)||void 0===_jobConfig$dest?void 0:_jobConfig$dest.results_field)||"",tableItems),colorRange=Object(color_range_legend.d)(color_range_legend.a.BLUE,color_range_legend.b.INFLUENCER,featureCount),showColorRange=featureCount>0&&Object(data_frame_analytics_common.D)(null==jobConfig?void 0:jobConfig.analysis)&&!0===(null==jobConfig?void 0:jobConfig.analysis.outlier_detection.compute_feature_influence),resultsField=null!==(_jobConfig$dest$resul=null==jobConfig?void 0:jobConfig.dest.results_field)&&void 0!==_jobConfig$dest$resul?_jobConfig$dest$resul:"",showLegacyFeatureInfluenceFormatCallout=!needsDestIndexPattern&&Object(data_frame_analytics_common.D)(null==jobConfig?void 0:jobConfig.analysis)&&!0===(null==jobConfig?void 0:jobConfig.analysis.outlier_detection.compute_feature_influence)&&-1===columnsWithCharts.findIndex(d=>d.id===`${resultsField}.${constants.b}`),scatterplotFieldOptions=useScatterplotFieldOptions(indexPattern,null==jobConfig?void 0:jobConfig.analyzed_fields.includes,null==jobConfig?void 0:jobConfig.analyzed_fields.excludes,resultsField);return void 0!==indexPatternErrorMessage?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPanel,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.exploration.indexError",{defaultMessage:"An error occurred loading the index data."}),color:"danger",iconType:"cross"},external_kbnSharedDeps_React_default.a.createElement("p",null,indexPatternErrorMessage))):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,void 0!==(null==jobConfig?void 0:jobConfig.description)&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,null==jobConfig?void 0:jobConfig.description),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"})),(columnsWithCharts.length>0||searchQuery!==data_frame_analytics_common.s)&&void 0!==indexPattern&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(ExplorationQueryBar,{indexPattern:indexPattern,setSearchQuery:searchQueryUpdateHandler,query:query}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"})),"string"==typeof(null==jobConfig?void 0:jobConfig.id)&&external_kbnSharedDeps_React_default.a.createElement(ExpandableSectionAnalytics,{jobId:null==jobConfig?void 0:jobConfig.id}),"string"==typeof(null==jobConfig?void 0:jobConfig.id)&&scatterplotFieldOptions.length>1&&external_kbnSharedDeps_React_default.a.createElement(ExpandableSectionSplom,{fields:scatterplotFieldOptions,index:null==jobConfig?void 0:jobConfig.dest.index,resultsField:null==jobConfig?void 0:jobConfig.dest.results_field,searchQuery:searchQuery}),showLegacyFeatureInfluenceFormatCallout&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{size:"s",title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.outlierExploration.legacyFeatureInfluenceFormatCalloutTitle",{defaultMessage:"Color coded table cells based on feature influence are not available because the results index uses an unsupported legacy format. Please clone and rerun the job."}),iconType:"pin"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"})),external_kbnSharedDeps_React_default.a.createElement(ExpandableSectionResults,{colorRange:showColorRange&&!showLegacyFeatureInfluenceFormatCallout?colorRange:void 0,indexData:outlierData,indexPattern:indexPattern,jobConfig:jobConfig,needsDestIndexPattern:needsDestIndexPattern,searchQuery:searchQuery}))});var analytics=__webpack_require__(67),trained_models=__webpack_require__(238);const useExplorationResults=(indexPattern,jobConfig,searchQuery,toastNotifications,mlApiServices)=>{var _jobConfig$dest$resul;const[baseline,setBaseLine]=Object(external_kbnSharedDeps_React_.useState)(),trainedModelsApiService=Object(trained_models.a)(),needsDestIndexFields=void 0!==indexPattern&&indexPattern.title===(null==jobConfig?void 0:jobConfig.source.index[0]),columns=[];if(void 0!==jobConfig){const resultsField=jobConfig.dest.results_field,{fieldTypes:fieldTypes}=Object(data_frame_analytics_common.y)(jobConfig,needsDestIndexFields);columns.push(...Object(data_grid.k)(fieldTypes,resultsField).sort((a,b)=>Object(common_fields.l)(a.id,b.id,jobConfig)))}const dataGrid=useExplorationDataGrid(columns,8,d=>!d.includes(`.${constants.a}.`)&&!d.includes(`.${constants.d}.`)&&d!==common_fields.h);Object(external_kbnSharedDeps_React_.useEffect)(()=>{const options={didCancel:!1};return Object(data_frame_analytics_common.x)(jobConfig,dataGrid,searchQuery,options),()=>{options.didCancel=!0}},[jobConfig&&jobConfig.id,dataGrid.pagination,searchQuery,dataGrid.sortingColumns]);const dataLoader=Object(external_kbnSharedDeps_React_.useMemo)(()=>void 0!==indexPattern?new data_loader_DataLoader(indexPattern,toastNotifications):void 0,[indexPattern]);Object(external_kbnSharedDeps_React_.useEffect)(()=>{dataGrid.chartsVisible&&async function(){try{if(void 0!==jobConfig&&void 0!==dataLoader){const columnChartsData=await dataLoader.loadFieldHistograms(columns.filter(cT=>dataGrid.visibleColumns.includes(cT.id)).map(cT=>({fieldName:cT.id,type:Object(data_grid.l)(cT.schema)})),searchQuery);dataGrid.setColumnCharts(columnChartsData)}}catch(e){Object(data_grid.p)(e,toastNotifications)}}()},[dataGrid.chartsVisible,null==jobConfig?void 0:jobConfig.dest.index,JSON.stringify([searchQuery,dataGrid.visibleColumns])]);const predictionFieldName=Object(external_kbnSharedDeps_React_.useMemo)(()=>{var _getPredictionFieldNa;if(jobConfig)return null!==(_getPredictionFieldNa=Object(analytics_utils.e)(jobConfig.analysis))&&void 0!==_getPredictionFieldNa?_getPredictionFieldNa:Object(analytics_utils.b)(jobConfig.analysis)},[jobConfig]),getAnalyticsBaseline=Object(external_kbnSharedDeps_React_.useCallback)(async()=>{try{if(void 0!==jobConfig&&void 0!==jobConfig.analysis&&(Object(analytics.D)(jobConfig.analysis)||Object(analytics_utils.f)(jobConfig.analysis))){var _inferenceModel$metad;const jobId=jobConfig.id,inferenceModel=(await trainedModelsApiService.getTrainedModels(jobId+"*",{include:"feature_importance_baseline"})).find(model=>{var _model$metadata,_model$metadata$analy;return(null===(_model$metadata=model.metadata)||void 0===_model$metadata||null===(_model$metadata$analy=_model$metadata.analytics_config)||void 0===_model$metadata$analy?void 0:_model$metadata$analy.id)===jobId});var _inferenceModel$metad2;if(void 0!==(null==inferenceModel||null===(_inferenceModel$metad=inferenceModel.metadata)||void 0===_inferenceModel$metad?void 0:_inferenceModel$metad.feature_importance_baseline))setBaseLine(null==inferenceModel||null===(_inferenceModel$metad2=inferenceModel.metadata)||void 0===_inferenceModel$metad2?void 0:_inferenceModel$metad2.feature_importance_baseline)}}catch(e){const error=Object(util_errors.i)(e);toastNotifications.addDanger({title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.explorationResults.baselineErrorMessageToast",{defaultMessage:"An error occurred getting feature importance baseline"}),text:error})}},[mlApiServices,jobConfig]);Object(external_kbnSharedDeps_React_.useEffect)(()=>{getAnalyticsBaseline()},[jobConfig]);const resultsField=null!==(_jobConfig$dest$resul=null==jobConfig?void 0:jobConfig.dest.results_field)&&void 0!==_jobConfig$dest$resul?_jobConfig$dest$resul:data_frame_analytics.d,renderCellValue=Object(data_grid.r)(indexPattern,dataGrid.pagination,dataGrid.tableItems,resultsField);return{...dataGrid,renderCellValue:renderCellValue,baseline:baseline,predictionFieldName:predictionFieldName,resultsField:resultsField}},ExplorationResultsTable=external_kbnSharedDeps_React_default.a.memo(({indexPattern:indexPattern,jobConfig:jobConfig,needsDestIndexPattern:needsDestIndexPattern,searchQuery:searchQuery})=>{const{services:{mlServices:{mlApiServices:mlApiServices}}}=Object(contexts_kibana.b)(),classificationData=useExplorationResults(indexPattern,jobConfig,searchQuery,Object(dependency_cache.j)(),mlApiServices);return void 0===jobConfig||void 0===classificationData?null:external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":"mlDFAnalyticsExplorationTablePanel"},external_kbnSharedDeps_React_default.a.createElement(ExpandableSectionResults,{indexData:classificationData,indexPattern:indexPattern,jobConfig:jobConfig,needsDestIndexPattern:needsDestIndexPattern,searchQuery:searchQuery}))}),jobConfigErrorTitle=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.jobConfig.errorTitle",{defaultMessage:"Unable to fetch results. An error occurred loading the job configuration data."}),jobCapsErrorTitle=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.jobCaps.errorTitle",{defaultMessage:"Unable to fetch results. An error occurred loading the index's field data."}),JobConfigErrorCallout=({jobCapsServiceErrorMessage:jobCapsServiceErrorMessage,jobConfigErrorMessage:jobConfigErrorMessage,title:title})=>{const{services:{application:{getUrlForApp:getUrlForApp}}}=Object(contexts_kibana.b)(),containsIndexPatternLink="string"==typeof jobCapsServiceErrorMessage&&jobCapsServiceErrorMessage.includes("locate that index-pattern")&&jobCapsServiceErrorMessage.includes("click here to re-create"),message=external_kbnSharedDeps_React_default.a.createElement("p",null,jobConfigErrorMessage||jobCapsServiceErrorMessage),newIndexPatternUrl=Object(external_kbnSharedDeps_React_.useMemo)(()=>getUrlForApp("management",{path:"kibana/indexPatterns"}),[]),calloutBody=containsIndexPatternLink?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{href:newIndexPatternUrl,target:"_blank"},message):message;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPanel,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:jobConfigErrorMessage?jobConfigErrorTitle:jobCapsErrorTitle,color:"danger",iconType:"cross"},calloutBody))},LoadingPanel=()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPanel,{className:"eui-textCenter"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingSpinner,{size:"xl"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}));function getFilters(resultsField){return{options:[{id:"training",label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.explorationResults.trainingSubsetLabel",{defaultMessage:"Training"})},{id:"testing",label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.explorationResults.testingSubsetLabel",{defaultMessage:"Testing"})}],columnId:resultsField+".is_training",key:{training:!0,testing:!1}}}const ExplorationPageWrapper=({jobId:jobId,title:title,EvaluatePanel:EvaluatePanel,FeatureImportanceSummaryPanel:FeatureImportanceSummaryPanel})=>{var _jobConfig$dest$resul;const{indexPattern:indexPattern,indexPatternErrorMessage:indexPatternErrorMessage,isInitialized:isInitialized,isLoadingJobConfig:isLoadingJobConfig,jobCapsServiceErrorMessage:jobCapsServiceErrorMessage,jobConfig:jobConfig,jobConfigErrorMessage:jobConfigErrorMessage,jobStatus:jobStatus,needsDestIndexPattern:needsDestIndexPattern,totalFeatureImportance:totalFeatureImportance}=Object(data_frame_analytics_common.J)(jobId),[pageUrlState,setPageUrlState]=useExplorationUrlState(),[searchQuery,setSearchQuery]=Object(external_kbnSharedDeps_React_.useState)(data_frame_analytics_common.s),searchQueryUpdateHandler=Object(external_kbnSharedDeps_React_.useCallback)(update=>{update.query&&setSearchQuery(update.query),update.queryString!==pageUrlState.queryText&&setPageUrlState({queryText:update.queryString,queryLanguage:update.language})},[pageUrlState,setPageUrlState]),query={query:pageUrlState.queryText,language:pageUrlState.queryLanguage},resultsField=null!==(_jobConfig$dest$resul=null==jobConfig?void 0:jobConfig.dest.results_field)&&void 0!==_jobConfig$dest$resul?_jobConfig$dest$resul:"",scatterplotFieldOptions=useScatterplotFieldOptions(indexPattern,null==jobConfig?void 0:jobConfig.analyzed_fields.includes,null==jobConfig?void 0:jobConfig.analyzed_fields.excludes,resultsField);if(void 0!==indexPatternErrorMessage)return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPanel,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.exploration.indexError",{defaultMessage:"An error occurred loading the index data."}),color:"danger",iconType:"cross"},external_kbnSharedDeps_React_default.a.createElement("p",null,indexPatternErrorMessage)));if(void 0!==jobConfigErrorMessage||void 0!==jobCapsServiceErrorMessage)return external_kbnSharedDeps_React_default.a.createElement(JobConfigErrorCallout,{jobCapsServiceErrorMessage:jobCapsServiceErrorMessage,jobConfigErrorMessage:jobConfigErrorMessage,title:title});const jobType=jobConfig&&jobConfig.analysis?Object(analytics_utils.a)(null==jobConfig?void 0:jobConfig.analysis):void 0;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,void 0!==(null==jobConfig?void 0:jobConfig.description)&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,null==jobConfig?void 0:jobConfig.description),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"})),void 0!==indexPattern&&jobConfig&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"column"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(ExplorationQueryBar,{indexPattern:indexPattern,setSearchQuery:searchQueryUpdateHandler,query:query,filters:getFilters(jobConfig.dest.results_field)}))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"})),!0===isLoadingJobConfig&&void 0===jobConfig&&external_kbnSharedDeps_React_default.a.createElement(LoadingPanel,null),!1===isLoadingJobConfig&&void 0!==jobConfig&&!0===isInitialized&&external_kbnSharedDeps_React_default.a.createElement(ExpandableSectionAnalytics,{jobId:jobConfig.id}),!0===isLoadingJobConfig&&void 0===jobConfig&&external_kbnSharedDeps_React_default.a.createElement(LoadingPanel,null),!1===isLoadingJobConfig&&void 0!==jobConfig&&!0===isInitialized&&external_kbnSharedDeps_React_default.a.createElement(EvaluatePanel,{jobConfig:jobConfig,jobStatus:jobStatus,searchQuery:searchQuery}),!0===isLoadingJobConfig&&void 0!==jobConfig&&void 0===totalFeatureImportance&&external_kbnSharedDeps_React_default.a.createElement(LoadingPanel,null),!1===isLoadingJobConfig&&void 0!==jobConfig&&void 0!==totalFeatureImportance&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(FeatureImportanceSummaryPanel,{totalFeatureImportance:totalFeatureImportance,jobConfig:jobConfig})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),!0===isLoadingJobConfig&&void 0===jobConfig&&external_kbnSharedDeps_React_default.a.createElement(LoadingPanel,null),!1===isLoadingJobConfig&&void 0!==jobConfig&&!0===isInitialized&&"string"==typeof(null==jobConfig?void 0:jobConfig.id)&&scatterplotFieldOptions.length>1&&void 0!==(null==jobConfig?void 0:jobConfig.analysis)&&external_kbnSharedDeps_React_default.a.createElement(ExpandableSectionSplom,{fields:scatterplotFieldOptions,index:null==jobConfig?void 0:jobConfig.dest.index,color:jobType===analytics.b.REGRESSION||jobType===analytics.b.CLASSIFICATION?Object(analytics_utils.c)(jobConfig.analysis):void 0,legendType:Object(data_frame_analytics_common.B)(jobType),searchQuery:searchQuery}),!0===isLoadingJobConfig&&void 0===jobConfig&&external_kbnSharedDeps_React_default.a.createElement(LoadingPanel,null),!1===isLoadingJobConfig&&void 0!==jobConfig&&void 0!==indexPattern&&!0===isInitialized&&external_kbnSharedDeps_React_default.a.createElement(ExplorationResultsTable,{indexPattern:indexPattern,jobConfig:jobConfig,jobStatus:jobStatus,needsDestIndexPattern:needsDestIndexPattern,searchQuery:searchQuery}))},statDescriptions={[analytics.j.MSE]:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.meanSquaredErrorText",{defaultMessage:"Mean squared error"}),[analytics.j.MSLE]:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.msleText",{defaultMessage:"Mean squared logarithmic error"}),[analytics.j.R_SQUARED]:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.rSquaredText",{defaultMessage:"R squared"}),[analytics.j.HUBER]:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataframe.analytics.regressionExploration.huberText",defaultMessage:"{wikiLink}",values:{wikiLink:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{href:"https://en.wikipedia.org/wiki/Huber_loss#Pseudo-Huber_loss_function",target:"_blank",external:!0},external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.huberLinkText",{defaultMessage:"Pseudo Huber loss function"}))}})},evaluate_stat_tooltipContent={[analytics.j.MSE]:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.meanSquaredErrorTooltipContent",{defaultMessage:"Measures how well the regression analysis model is performing. Mean squared sum of the difference between true and predicted values."}),[analytics.j.MSLE]:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.msleTooltipContent",{defaultMessage:"Average squared difference between the logarithm of the predicted values and the logarithm of the actual (ground truth) value"}),[analytics.j.R_SQUARED]:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.rSquaredTooltipContent",{defaultMessage:"Represents the goodness of fit. Measures how well the observed outcomes are replicated by the model."})},EvaluateStat=({isLoading:isLoading,statType:statType,title:title,dataTestSubj:dataTestSubj})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"xs","data-test-subj":dataTestSubj},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiStat,{reverse:!0,isLoading:isLoading,title:title,description:statDescriptions[statType],titleSize:"xxs"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},statType!==analytics.j.HUBER&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIconTip,{anchorClassName:"mlDataFrameAnalyticsRegression__evaluateStat",content:evaluate_stat_tooltipContent[statType]}))),EMPTY_STATS={mse:analytics.c,msle:analytics.c,huber:analytics.c,rSquared:analytics.c},defaultEval={...EMPTY_STATS,error:null},evaluate_panel_EvaluatePanel=({jobConfig:jobConfig,jobStatus:jobStatus,searchQuery:searchQuery})=>{const{services:{docLinks:docLinks}}=Object(contexts_kibana.b)(),docLink=docLinks.links.ml.regressionEvaluation,[trainingEval,setTrainingEval]=Object(external_kbnSharedDeps_React_.useState)(defaultEval),[generalizationEval,setGeneralizationEval]=Object(external_kbnSharedDeps_React_.useState)(defaultEval),[isLoadingTraining,setIsLoadingTraining]=Object(external_kbnSharedDeps_React_.useState)(!1),[isLoadingGeneralization,setIsLoadingGeneralization]=Object(external_kbnSharedDeps_React_.useState)(!1),[isTrainingFilter,setIsTrainingFilter]=Object(external_kbnSharedDeps_React_.useState)(void 0),[trainingDocsCount,setTrainingDocsCount]=Object(external_kbnSharedDeps_React_.useState)(null),[generalizationDocsCount,setGeneralizationDocsCount]=Object(external_kbnSharedDeps_React_.useState)(null),index=jobConfig.dest.index,dependentVariable=Object(data_frame_analytics_common.w)(jobConfig.analysis),predictionFieldName=Object(data_frame_analytics_common.A)(jobConfig.analysis),resultsField=jobConfig.dest.results_field,loadData=async()=>{(async(ignoreDefaultQuery=!0)=>{setIsLoadingGeneralization(!0);const genErrorEval=await Object(data_frame_analytics_common.F)({isTraining:!1,index:index,dependentVariable:dependentVariable,resultsField:resultsField,predictionFieldName:predictionFieldName,searchQuery:searchQuery,ignoreDefaultQuery:ignoreDefaultQuery,jobType:analytics.b.REGRESSION});if(!0===genErrorEval.success&&genErrorEval.eval&&Object(analytics.E)(genErrorEval.eval)){const{mse:mse,msle:msle,huber:huber,r_squared:r_squared}=Object(data_frame_analytics_common.C)(genErrorEval.eval);setGeneralizationEval({mse:mse,msle:msle,huber:huber,rSquared:r_squared,error:null}),setIsLoadingGeneralization(!1)}else setIsLoadingGeneralization(!1),setGeneralizationEval({...EMPTY_STATS,error:genErrorEval.error})})(!1);const genDocsCountResp=await Object(data_frame_analytics_common.E)({ignoreDefaultQuery:!1,isTraining:!1,searchQuery:searchQuery,resultsField:resultsField,destIndex:jobConfig.dest.index});!0===genDocsCountResp.success?setGeneralizationDocsCount(genDocsCountResp.docsCount):setGeneralizationDocsCount(null),(async(ignoreDefaultQuery=!0)=>{setIsLoadingTraining(!0);const trainingErrorEval=await Object(data_frame_analytics_common.F)({isTraining:!0,index:index,dependentVariable:dependentVariable,resultsField:resultsField,predictionFieldName:predictionFieldName,searchQuery:searchQuery,ignoreDefaultQuery:ignoreDefaultQuery,jobType:analytics.b.REGRESSION});if(!0===trainingErrorEval.success&&trainingErrorEval.eval&&Object(analytics.E)(trainingErrorEval.eval)){const{mse:mse,msle:msle,huber:huber,r_squared:r_squared}=Object(data_frame_analytics_common.C)(trainingErrorEval.eval);setTrainingEval({mse:mse,msle:msle,huber:huber,rSquared:r_squared,error:null}),setIsLoadingTraining(!1)}else setIsLoadingTraining(!1),setTrainingEval({...EMPTY_STATS,error:trainingErrorEval.error})})(!1);const trainDocsCountResp=await Object(data_frame_analytics_common.E)({ignoreDefaultQuery:!1,isTraining:!0,searchQuery:searchQuery,resultsField:resultsField,destIndex:jobConfig.dest.index});!0===trainDocsCountResp.success?setTrainingDocsCount(trainDocsCountResp.docsCount):setTrainingDocsCount(null)};return Object(external_kbnSharedDeps_React_.useEffect)(()=>{let isTraining;const query=Object(analytics.F)(searchQuery)&&(searchQuery.bool.should||searchQuery.bool.filter);if(void 0!==query&&!1!==query)for(let i=0;i<query.length;i++){const clause=query[i];if(clause.match&&void 0!==clause.match[resultsField+".is_training"]){isTraining=clause.match[resultsField+".is_training"];break}if(clause.bool&&(void 0!==clause.bool.should||void 0!==clause.bool.filter)){const innerQuery=clause.bool.should||clause.bool.filter;if(void 0!==innerQuery)for(let j=0;j<innerQuery.length;j++){const innerClause=innerQuery[j];if(innerClause.match&&void 0!==innerClause.match[resultsField+".is_training"]){isTraining=innerClause.match[resultsField+".is_training"];break}}}}setIsTrainingFilter(isTraining),loadData()},[JSON.stringify(searchQuery)]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(ExpandableSection,{urlStateKey:"evaluation",dataTestId:"RegressionEvaluation",title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataframe.analytics.regressionExploration.evaluateSectionTitle",defaultMessage:"Model evaluation"}),docsLink:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{target:"_blank",iconType:"help",iconSide:"left",color:"primary",href:docLink},external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.regressionDocsLink",{defaultMessage:"Regression evaluation docs "})),headerItems:void 0!==jobStatus?[{id:"jobStatus",label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.evaluateJobStatusLabel",{defaultMessage:"Job status"}),value:jobStatus}]:[],contentPadding:!0,content:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"xxs"},external_kbnSharedDeps_React_default.a.createElement("span",null,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.generalizationErrorTitle",{defaultMessage:"Generalization error"}))),null!==generalizationDocsCount&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs",color:"subdued"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataframe.analytics.regressionExploration.generalizationDocsCount",defaultMessage:"{docsCount, plural, one {# doc} other {# docs}} evaluated",values:{docsCount:generalizationDocsCount}}),!0===isTrainingFilter&&0===generalizationDocsCount&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataframe.analytics.regressionExploration.generalizationFilterText",defaultMessage:". Filtering for training data."})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"column",gutterSize:"none"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"column",gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(EvaluateStat,{dataTestSubj:"mlDFAnalyticsRegressionGenMSEstat",isLoading:isLoadingGeneralization,title:generalizationEval.mse,statType:analytics.j.MSE})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(EvaluateStat,{dataTestSubj:"mlDFAnalyticsRegressionGenRSquaredStat",isLoading:isLoadingGeneralization,title:generalizationEval.rSquared,statType:analytics.j.R_SQUARED})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(EvaluateStat,{dataTestSubj:"mlDFAnalyticsRegressionGenMsleStat",isLoading:isLoadingGeneralization,title:generalizationEval.msle,statType:analytics.j.MSLE})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(EvaluateStat,{dataTestSubj:"mlDFAnalyticsRegressionGenHuberStat",isLoading:isLoadingGeneralization,title:generalizationEval.huber,statType:analytics.j.HUBER})))))),null!==generalizationEval.error&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs",color:"danger"},!0===isTrainingFilter&&0===generalizationDocsCount&&generalizationEval.error.includes("No documents found")?external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.evaluateNoTestingDocsError",{defaultMessage:"No testing documents found"}):generalizationEval.error)))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"xxs"},external_kbnSharedDeps_React_default.a.createElement("span",null,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.trainingErrorTitle",{defaultMessage:"Training error"}))),null!==trainingDocsCount&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs",color:"subdued"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataframe.analytics.regressionExploration.trainingDocsCount",defaultMessage:"{docsCount, plural, one {# doc} other {# docs}} evaluated",values:{docsCount:trainingDocsCount}}),!1===isTrainingFilter&&0===trainingDocsCount&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataframe.analytics.regressionExploration.trainingFilterText",defaultMessage:". Filtering for testing data."})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"column",gutterSize:"none"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"column",gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(EvaluateStat,{dataTestSubj:"mlDFAnalyticsRegressionTrainingMSEstat",isLoading:isLoadingTraining,title:trainingEval.mse,statType:analytics.j.MSE})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(EvaluateStat,{dataTestSubj:"mlDFAnalyticsRegressionTrainingRSquaredStat",isLoading:isLoadingTraining,title:trainingEval.rSquared,statType:analytics.j.R_SQUARED})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(EvaluateStat,{dataTestSubj:"mlDFAnalyticsRegressionTrainingMsleStat",isLoading:isLoadingTraining,title:trainingEval.msle,statType:analytics.j.MSLE})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(EvaluateStat,{dataTestSubj:"mlDFAnalyticsRegressionTrainingHuberStat",isLoading:isLoadingTraining,title:trainingEval.huber,statType:analytics.j.HUBER})))))),null!==trainingEval.error&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs",color:"danger"},!1===isTrainingFilter&&0===trainingDocsCount&&trainingEval.error.includes("No documents found")?external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.evaluateNoTrainingDocsError",{defaultMessage:"No training documents found"}):trainingEval.error)))))}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}))};var external_kbnSharedDeps_Theme_euiLightVars_=__webpack_require__(50),external_kbnSharedDeps_Theme_euiLightVars_default=__webpack_require__.n(external_kbnSharedDeps_Theme_euiLightVars_),feature_importance=__webpack_require__(190);function feature_importance_summary_extends(){return(feature_importance_summary_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const{euiColorMediumShade:euiColorMediumShade}=external_kbnSharedDeps_Theme_euiLightVars_default.a,feature_importance_summary_theme={axes:{axisLine:{stroke:euiColorMediumShade},tickLabel:{fontSize:12,fill:euiColorMediumShade},tickLine:{stroke:euiColorMediumShade},gridLine:{horizontal:{dash:[1,2]},vertical:{strokeWidth:0}}},legend:{spacingBuffer:100}},feature_importance_summary_tooltipContent=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.exploration.featureImportanceSummaryTooltipContent",{defaultMessage:"Total feature importance values indicate how significantly a field affects the predictions across all the training data."}),calculateTotalMeanImportance=featureClass=>featureClass.classes.reduce((runningSum,fc)=>runningSum+fc.importance.mean_magnitude,0),feature_importance_summary_FeatureImportanceSummaryPanel=({totalFeatureImportance:totalFeatureImportance,jobConfig:jobConfig})=>{const{services:{docLinks:docLinks}}=Object(contexts_kibana.b)(),[plotData,barSeriesSpec,showLegend,chartHeight]=Object(external_kbnSharedDeps_React_.useMemo)(()=>{let sortedData=[],_barSeriesSpec={xAccessor:"featureName",yAccessors:["meanImportance"],name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.exploration.featureImportanceYSeriesName",{defaultMessage:"magnitude"})},classificationType="";if(totalFeatureImportance.length<1)return[sortedData,_barSeriesSpec];Object(feature_importance.b)(totalFeatureImportance[0])&&(2===totalFeatureImportance[0].classes.length&&(classificationType="binary_classification",sortedData=totalFeatureImportance.map(d=>({featureName:d.feature_name,meanImportance:d.classes[0].importance.mean_magnitude})).sort((a,b)=>b.meanImportance-a.meanImportance)),totalFeatureImportance[0].classes.length>2&&(classificationType="multiclass_classification",totalFeatureImportance.sort((prevFeature,currentFeature)=>calculateTotalMeanImportance(currentFeature)-calculateTotalMeanImportance(prevFeature)).forEach(feature=>{const sortedFeatureClass=feature.classes.sort((a,b)=>b.importance.mean_magnitude-a.importance.mean_magnitude);sortedData.push(...sortedFeatureClass.map(featureClass=>({featureName:feature.feature_name,meanImportance:featureClass.importance.mean_magnitude,className:featureClass.class_name})))}),_barSeriesSpec={xAccessor:"featureName",yAccessors:["meanImportance"],splitSeriesAccessors:["className"],stackAccessors:["featureName"]})),Object(feature_importance.d)(totalFeatureImportance[0])&&(classificationType="regression",sortedData=totalFeatureImportance.map(d=>({featureName:d.feature_name,meanImportance:d.importance.mean_magnitude})).sort((a,b)=>b.meanImportance-a.meanImportance));const _showLegend="multiclass_classification"===classificationType,_chartHeight=totalFeatureImportance.length*(totalFeatureImportance.length<5?40:20)+50;return[sortedData,_barSeriesSpec,_showLegend,_chartHeight]},[totalFeatureImportance]),docLink=docLinks.links.ml.featureImportance,tickFormatter=Object(external_kbnSharedDeps_React_.useCallback)(d=>Number(d.toPrecision(3)).toString(),[]),noDataCallOut=Object(external_kbnSharedDeps_React_.useMemo)(()=>{if(0===totalFeatureImportance.length&&(null!=jobConfig&&jobConfig.analysis&&Object(analytics.D)(null==jobConfig?void 0:jobConfig.analysis)||Object(analytics.A)(null==jobConfig?void 0:jobConfig.analysis))){const analysisType=Object(data_frame_analytics_common.t)(jobConfig.analysis);return"unknown"!==analysisType&&0===jobConfig.analysis[analysisType].num_top_feature_importance_values?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{"data-test-subj":"mlTotalFeatureImportanceNotCalculatedCallout",size:"s",title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataframe.analytics.exploration.totalFeatureImportanceNotCalculatedCalloutMessage",defaultMessage:"Feature importance was not calculated because num_top_feature_importance values is set to 0."})}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{"data-test-subj":"mlNoTotalFeatureImportanceCallout",size:"s",title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataframe.analytics.exploration.noTotalFeatureImportanceCalloutMessage",defaultMessage:"Total feature importance data is not available; the data set is uniform and the features have no significant impact on the prediction."})})}},[totalFeatureImportance,jobConfig]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(ExpandableSection,{urlStateKey:"feature_importance",isExpanded:void 0===noDataCallOut,dataTestId:"FeatureImportanceSummary",title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataframe.analytics.exploration.featureImportanceSummaryTitle",defaultMessage:"Total feature importance"}),docsLink:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{target:"_blank",iconType:"help",iconSide:"left",color:"primary",href:docLink},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataframe.analytics.exploration.featureImportanceDocsLink",defaultMessage:"Feature importance docs"})),headerItems:[{id:"FeatureImportanceSummary",value:feature_importance_summary_tooltipContent}],content:noDataCallOut||external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":"mlTotalFeatureImportanceChart"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_.Chart,{size:{width:"100%",height:chartHeight}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_.Settings,{rotation:90,theme:feature_importance_summary_theme,showLegend:showLegend}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_.Axis,{id:"x-axis",title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.exploration.featureImportanceXAxisTitle",{defaultMessage:"Feature importance average magnitude"}),position:external_kbnSharedDeps_ElasticCharts_.Position.Bottom,tickFormat:tickFormatter}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_.Axis,{id:"y-axis",title:"",position:external_kbnSharedDeps_ElasticCharts_.Position.Left}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_.BarSeries,feature_importance_summary_extends({id:"magnitude",xScaleType:external_kbnSharedDeps_ElasticCharts_.ScaleType.Ordinal,yScaleType:external_kbnSharedDeps_ElasticCharts_.ScaleType.Linear,data:plotData},barSeriesSpec))))}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}))},RegressionExploration=({jobId:jobId})=>external_kbnSharedDeps_React_default.a.createElement(ExplorationPageWrapper,{jobId:jobId,title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.tableJobIdTitle",{defaultMessage:"Destination index for regression job ID {jobId}",values:{jobId:jobId}}),EvaluatePanel:evaluate_panel_EvaluatePanel,FeatureImportanceSummaryPanel:feature_importance_summary_FeatureImportanceSummaryPanel});__webpack_require__(724);const ErrorCallout=({error:error})=>{let errorCallout=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.errorCallout.generalErrorTitle",{defaultMessage:"An error occurred loading the data."}),color:"danger",iconType:"cross"},external_kbnSharedDeps_React_default.a.createElement("p",null,error));return"string"==typeof error&&error.includes("index_not_found")?errorCallout=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.errorCallout.evaluateErrorTitle",{defaultMessage:"An error occurred loading the data."}),color:"danger",iconType:"cross"},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.errorCallout.noIndexCalloutBody",{defaultMessage:"The query for the index returned no results. Please make sure the destination index exists and contains documents."}))):"string"==typeof error&&error.includes("No documents found")?errorCallout=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.errorCallout.noDataCalloutTitle",{defaultMessage:"Empty index query result."}),color:"primary"},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.errorCallout.noDataCalloutBody",{defaultMessage:"The query for the index returned no results. Please make sure the job has completed and the index contains documents."}))):"string"==typeof error&&error.includes("userProvidedQueryBuilder")&&(errorCallout=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.errorCallout.queryParsingErrorTitle",{defaultMessage:"Unable to parse query."}),color:"primary"},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.errorCallout.queryParsingErrorBody",{defaultMessage:"The query syntax is invalid and returned no results. Please check the query syntax and try again."})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,errorCallout)},evaluate_stat_EvaluateStat=({isLoading:isLoading,title:title,description:description,dataTestSubj:dataTestSubj,tooltipContent:tooltipContent})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"xs","data-test-subj":dataTestSubj},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiStat,{reverse:!0,isLoading:isLoading,title:null!==title?Math.round(1e3*title)/1e3:analytics.c,description:description,titleSize:"xs"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIconTip,{anchorClassName:"mlDataFrameAnalyticsRegression__evaluateStat",content:tooltipContent}))),GRAY=Object(external_kbnSharedDeps_ElasticEui_.euiPaletteGray)(1)[0],BASELINE="baseline";const getRocCurveChartVegaLiteSpec=(classificationClasses,data,legendTitle)=>{data.push({tpr:0,fpr:0,threshold:1,class_name:BASELINE}),data.push({tpr:1,fpr:1,threshold:1,class_name:BASELINE});const colorRangeNominal=function(classificationClasses){const baselineIndex=[...classificationClasses,BASELINE].sort().indexOf(BASELINE),colorRangeNominal=Object(external_kbnSharedDeps_ElasticEui_.euiPaletteColorBlind)({rotations:2}).slice(0,classificationClasses.length);return colorRangeNominal.splice(baselineIndex,0,GRAY),colorRangeNominal}(classificationClasses);return{$schema:"https://vega.github.io/schema/vega-lite/v4.8.1.json",background:"transparent",padding:{left:45,top:0,right:0,bottom:0},config:{legend:{orient:"right"},view:{continuousHeight:300,continuousWidth:300}},data:{name:"roc-curve-data"},datasets:{"roc-curve-data":data},encoding:{color:{field:"class_name",type:vega_chart_common.a.NOMINAL,scale:{range:colorRangeNominal},legend:{title:legendTitle}},size:{value:2},strokeDash:{condition:{test:`(datum.class_name === '${BASELINE}')`,value:[5,5]},value:[0]},x:{field:"fpr",sort:null,title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.rocChartSpec.xAxisTitle",{defaultMessage:"False Positive Rate (FPR)"}),type:"quantitative",axis:{tickColor:GRAY,labelColor:GRAY,domainColor:GRAY,titleColor:GRAY}},y:{field:"tpr",title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.rocChartSpec.yAxisTitle",{defaultMessage:"True Positive Rate (TPR) (a.k.a Recall)"}),type:"quantitative",axis:{tickColor:GRAY,labelColor:GRAY,domainColor:GRAY,titleColor:GRAY}},tooltip:[{type:vega_chart_common.a.NOMINAL,field:"class_name"},{type:vega_chart_common.a.QUANTITATIVE,field:"fpr"},{type:vega_chart_common.a.QUANTITATIVE,field:"tpr"}]},height:300,width:300,mark:{type:"line",strokeCap:"round",strokeJoin:"round"}}};function getTrailingControlColumns(numColumns,setShowFullColumns){return[{id:"actions",width:60,headerCellRender:()=>external_kbnSharedDeps_React_default.a.createElement("span",null,numColumns+" more"),rowCellRender:function(){const[isPopoverOpen,setIsPopoverOpen]=Object(external_kbnSharedDeps_React_.useState)(!1);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopover,{isOpen:isPopoverOpen,anchorPosition:"upCenter",button:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.showActions",{defaultMessage:"Show actions"}),iconType:"boxesHorizontal",color:"text",onClick:()=>setIsPopoverOpen(!isPopoverOpen)}),closePopover:()=>setIsPopoverOpen(!1),ownFocus:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{onClick:()=>setShowFullColumns(!0)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"s",grow:!1,textAlign:"center"},external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.showAllColumns",{defaultMessage:"Show all columns"}))))}}]}function is_training_filter_isTrainingFilter(searchQuery,resultsField){let isTraining;const query=Object(analytics.F)(searchQuery)&&(searchQuery.bool.should||searchQuery.bool.filter);if(void 0!==query&&!1!==query)for(let i=0;i<query.length;i++){const clause=query[i];if(clause.match&&void 0!==clause.match[resultsField+".is_training"]){isTraining=clause.match[resultsField+".is_training"];break}if(clause.bool&&(void 0!==clause.bool.should||void 0!==clause.bool.filter)){const innerQuery=clause.bool.should||clause.bool.filter;if(void 0!==innerQuery)for(let j=0;j<innerQuery.length;j++){const innerClause=innerQuery[j];if(innerClause.match&&void 0!==innerClause.match[resultsField+".is_training"]){isTraining=innerClause.match[resultsField+".is_training"];break}}}}return isTraining}var SUBSET_TITLE;!function(SUBSET_TITLE){SUBSET_TITLE.TRAINING="training",SUBSET_TITLE.TESTING="testing",SUBSET_TITLE.ENTIRE="entire"}(SUBSET_TITLE||(SUBSET_TITLE={}));const entireDatasetHelpText=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.confusionMatrixEntireHelpText",{defaultMessage:"Normalized confusion matrix for entire dataset"}),testingDatasetHelpText=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.confusionMatrixTestingHelpText",{defaultMessage:"Normalized confusion matrix for testing dataset"}),trainingDatasetHelpText=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.confusionMatrixTrainingHelpText",{defaultMessage:"Normalized confusion matrix for training dataset"});function getHelpText(dataSubsetTitle){let helpText=entireDatasetHelpText;return dataSubsetTitle===SUBSET_TITLE.TESTING?helpText=testingDatasetHelpText:dataSubsetTitle===SUBSET_TITLE.TRAINING&&(helpText=trainingDatasetHelpText),helpText}const classification_exploration_evaluate_panel_EvaluatePanel=({jobConfig:jobConfig,jobStatus:jobStatus,searchQuery:searchQuery})=>{const{services:{docLinks:docLinks}}=Object(contexts_kibana.b)(),[columns,setColumns]=Object(external_kbnSharedDeps_React_.useState)([]),[columnsData,setColumnsData]=Object(external_kbnSharedDeps_React_.useState)([]),[showFullColumns,setShowFullColumns]=Object(external_kbnSharedDeps_React_.useState)(!1),[popoverContents,setPopoverContents]=Object(external_kbnSharedDeps_React_.useState)({}),[dataSubsetTitle,setDataSubsetTitle]=Object(external_kbnSharedDeps_React_.useState)(SUBSET_TITLE.ENTIRE),[visibleColumns,setVisibleColumns]=Object(external_kbnSharedDeps_React_.useState)(()=>columns.map(({id:id})=>id)),isTraining=is_training_filter_isTrainingFilter(searchQuery,jobConfig.dest.results_field),{avgRecall:avgRecall,confusionMatrixData:confusionMatrixData,docsCount:docsCount,error:errorConfusionMatrix,isLoading:isLoadingConfusionMatrix,overallAccuracy:overallAccuracy}=((jobConfig,searchQuery)=>{const[confusionMatrixData,setConfusionMatrixData]=Object(external_kbnSharedDeps_React_.useState)([]),[overallAccuracy,setOverallAccuracy]=Object(external_kbnSharedDeps_React_.useState)(null),[avgRecall,setAvgRecall]=Object(external_kbnSharedDeps_React_.useState)(null),[isLoading,setIsLoading]=Object(external_kbnSharedDeps_React_.useState)(!1),[docsCount,setDocsCount]=Object(external_kbnSharedDeps_React_.useState)(null),[error,setError]=Object(external_kbnSharedDeps_React_.useState)(null);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{!async function(){setIsLoading(!0);let requiresKeyword=!1;const dependentVariable=Object(data_frame_analytics_common.w)(jobConfig.analysis),resultsField=jobConfig.dest.results_field,isTraining=is_training_filter_isTrainingFilter(searchQuery,resultsField);try{requiresKeyword=Object(common_fields.k)(dependentVariable)}catch(e){console.error("Unable to load new field types",e)}const evalData=await Object(data_frame_analytics_common.F)({isTraining:isTraining,index:jobConfig.dest.index,dependentVariable:dependentVariable,resultsField:resultsField,predictionFieldName:Object(data_frame_analytics_common.A)(jobConfig.analysis),searchQuery:searchQuery,jobType:analytics.b.CLASSIFICATION,requiresKeyword:requiresKeyword}),docsCountResp=await Object(data_frame_analytics_common.E)({isTraining:isTraining,searchQuery:searchQuery,resultsField:resultsField,destIndex:jobConfig.dest.index});if(!0===evalData.success&&evalData.eval&&Object(analytics.B)(evalData.eval)){var _evalData$eval,_evalData$eval$classi,_evalData$eval$classi2,_evalData$eval2,_evalData$eval2$class,_evalData$eval2$class2,_evalData$eval3,_evalData$eval3$class,_evalData$eval3$class2;const confusionMatrix=null===(_evalData$eval=evalData.eval)||void 0===_evalData$eval||null===(_evalData$eval$classi=_evalData$eval.classification)||void 0===_evalData$eval$classi||null===(_evalData$eval$classi2=_evalData$eval$classi.multiclass_confusion_matrix)||void 0===_evalData$eval$classi2?void 0:_evalData$eval$classi2.confusion_matrix;setError(null),setConfusionMatrixData(confusionMatrix||[]),setAvgRecall((null===(_evalData$eval2=evalData.eval)||void 0===_evalData$eval2||null===(_evalData$eval2$class=_evalData$eval2.classification)||void 0===_evalData$eval2$class||null===(_evalData$eval2$class2=_evalData$eval2$class.recall)||void 0===_evalData$eval2$class2?void 0:_evalData$eval2$class2.avg_recall)||null),setOverallAccuracy((null===(_evalData$eval3=evalData.eval)||void 0===_evalData$eval3||null===(_evalData$eval3$class=_evalData$eval3.classification)||void 0===_evalData$eval3$class||null===(_evalData$eval3$class2=_evalData$eval3$class.accuracy)||void 0===_evalData$eval3$class2?void 0:_evalData$eval3$class2.overall_accuracy)||null),setIsLoading(!1)}else setIsLoading(!1),setConfusionMatrixData([]),setError(evalData.error);!0===docsCountResp.success?setDocsCount(docsCountResp.docsCount):setDocsCount(null)}()},[JSON.stringify([jobConfig,searchQuery])]),{avgRecall:avgRecall,confusionMatrixData:confusionMatrixData,docsCount:docsCount,error:error,isLoading:isLoading,overallAccuracy:overallAccuracy}})(jobConfig,searchQuery);Object(external_kbnSharedDeps_React_.useEffect)(()=>{setDataSubsetTitle(void 0===isTraining?SUBSET_TITLE.ENTIRE:isTraining&&!0===isTraining?SUBSET_TITLE.TRAINING:SUBSET_TITLE.TESTING)},[isTraining]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{if(confusionMatrixData.length>0){const{columns:derivedColumns,columnData:columnData}=function(confusionMatrixData){const colData=[],columns=[{id:"actual_class",display:external_kbnSharedDeps_React_default.a.createElement("span",null),initialWidth:165}];let showOther=!1;for(const classData of confusionMatrixData){const otherCount=classData.other_predicted_class_doc_count;otherCount>0&&(showOther=!0);const col={actual_class:classData.actual_class,actual_class_doc_count:classData.actual_class_doc_count,other:otherCount,predicted_classes_count:{}},predictedClasses=classData.predicted_classes||[];columns.push({id:classData.actual_class,initialWidth:165});for(let i=0;i<predictedClasses.length;i++){const predictedClass=predictedClasses[i].predicted_class,predictedClassCount=predictedClasses[i].count;col.predicted_classes_count[predictedClass]=predictedClassCount}colData.push(col)}return showOther&&columns.push({id:"other",initialWidth:165}),{columns:columns,columnData:colData}}(confusionMatrixData);setVisibleColumns(()=>derivedColumns.map(({id:id})=>id)),setColumns(derivedColumns),setColumnsData(columnData),setPopoverContents({numeric:({cellContentsElement:cellContentsElement,children:children})=>{var _children$props,_children$props2;const rowIndex=null==children||null===(_children$props=children.props)||void 0===_children$props?void 0:_children$props.rowIndex,colId=null==children||null===(_children$props2=children.props)||void 0===_children$props2?void 0:_children$props2.columnId,gridItem=columnData[rowIndex];if(void 0!==gridItem&&"actual_class"!==colId){return`${gridItem.predicted_classes_count[colId]} / ${gridItem.actual_class_doc_count} * 100 = ${cellContentsElement.textContent}`}return cellContentsElement.textContent}})}},[confusionMatrixData]);const{rocCurveData:rocCurveData,classificationClasses:classificationClasses,error:errorRocCurve,isLoading:isLoadingRocCurve}=((jobConfig,searchQuery,columns)=>{const classificationClasses=columns.filter(d=>"actual_class"!==d&&"other"!==d);classificationClasses.length<=2&&classificationClasses.splice(1);const[rocCurveData,setRocCurveData]=Object(external_kbnSharedDeps_React_.useState)([]),[isLoading,setIsLoading]=Object(external_kbnSharedDeps_React_.useState)(!1),[error,setError]=Object(external_kbnSharedDeps_React_.useState)(null);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{!async function(){setIsLoading(!0);const dependentVariable=Object(data_frame_analytics_common.w)(jobConfig.analysis),resultsField=jobConfig.dest.results_field,newRocCurveData=[];let requiresKeyword=!1;const errors=[];try{requiresKeyword=Object(common_fields.k)(dependentVariable)}catch(e){console.error("Unable to load new field types",e)}for(let i=0;i<classificationClasses.length;i++){const rocCurveClassName=classificationClasses[i],evalData=await Object(data_frame_analytics_common.F)({isTraining:is_training_filter_isTrainingFilter(searchQuery,resultsField),index:jobConfig.dest.index,dependentVariable:dependentVariable,resultsField:resultsField,predictionFieldName:Object(data_frame_analytics_common.A)(jobConfig.analysis),searchQuery:searchQuery,jobType:analytics.b.CLASSIFICATION,requiresKeyword:requiresKeyword,rocCurveClassName:rocCurveClassName,includeMulticlassConfusionMatrix:!1});if(!0===evalData.success&&evalData.eval&&Object(analytics.B)(evalData.eval)){var _evalData$eval,_evalData$eval$classi,_evalData$eval$classi2,_evalData$eval2,_evalData$eval2$class,_evalData$eval2$class2;const auc=(null===(_evalData$eval=evalData.eval)||void 0===_evalData$eval||null===(_evalData$eval$classi=_evalData$eval.classification)||void 0===_evalData$eval$classi||null===(_evalData$eval$classi2=_evalData$eval$classi.auc_roc)||void 0===_evalData$eval$classi2?void 0:_evalData$eval$classi2.value)||0,rocCurveClassLabel=classificationClasses.length>2?classificationClasses[i]:"ROC",rocCurveDataForClass=((null===(_evalData$eval2=evalData.eval)||void 0===_evalData$eval2||null===(_evalData$eval2$class=_evalData$eval2.classification)||void 0===_evalData$eval2$class||null===(_evalData$eval2$class2=_evalData$eval2$class.auc_roc)||void 0===_evalData$eval2$class2?void 0:_evalData$eval2$class2.curve)||[]).map(d=>({class_name:`${rocCurveClassLabel} (AUC: ${Math.round(1e5*auc)/1e5})`,...d}));newRocCurveData.push(...rocCurveDataForClass)}else null!==evalData.error&&errors.push(evalData.error)}setError(errors.length>0?errors:null),setRocCurveData(newRocCurveData),setIsLoading(!1)}()},[JSON.stringify([jobConfig,searchQuery,columns])]),{rocCurveData:rocCurveData,classificationClasses:classificationClasses.length>2?classificationClasses:["ROC"],error:error,isLoading:isLoading}})(jobConfig,searchQuery,columns.map(d=>d.id)),docLink=docLinks.links.ml.classificationEvaluation,showTrailingColumns=columnsData.length>6,extraColumns=columnsData.length-6,shownColumns=!0===showTrailingColumns&&!1===showFullColumns?columns.slice(0,7):columns,rowCount=!0===showTrailingColumns&&!1===showFullColumns?6:columnsData.length;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(ExpandableSection,{urlStateKey:"evaluation",dataTestId:"ClassificationEvaluation",title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataframe.analytics.classificationExploration.evaluateSectionTitle",defaultMessage:"Model evaluation"}),docsLink:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{target:"_blank",iconType:"help",iconSide:"left",color:"primary",href:docLink},external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.classificationDocsLink",{defaultMessage:"Classification evaluation docs "})),headerItems:isLoadingConfusionMatrix?"header_items_loading":[...void 0!==jobStatus?[{id:"jobStatus",label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.evaluateJobStatusLabel",{defaultMessage:"Job status"}),value:jobStatus}]:[],...null!==docsCount?[{id:"docsEvaluated",label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.generalizationDocsCount",{defaultMessage:"{docsCount, plural, one {doc} other {docs}} evaluated",values:{docsCount:docsCount}}),value:docsCount}]:[]],contentPadding:!0,content:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,isLoadingConfusionMatrix?null:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,null!==errorConfusionMatrix&&external_kbnSharedDeps_React_default.a.createElement(ErrorCallout,{error:errorConfusionMatrix}),null===errorConfusionMatrix&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"none"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"xxs"},external_kbnSharedDeps_React_default.a.createElement("span",null,getHelpText(dataSubsetTitle))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIconTip,{anchorClassName:"mlDataFrameAnalyticsClassificationInfoTooltip",content:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.confusionMatrixTooltip",{defaultMessage:"The multi-class confusion matrix contains the number of occurrences where the analysis classified data points correctly with their actual class as well as the number of occurrences where it misclassified them with another class"})}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement("div",{className:"mlDataFrameAnalyticsClassification__evaluateSectionContent"},external_kbnSharedDeps_React_default.a.createElement("div",{className:"mlDataFrameAnalyticsClassification__actualLabel"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs",color:"subdued"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataframe.analytics.classificationExploration.confusionMatrixActualLabel",defaultMessage:"Actual class"}))),external_kbnSharedDeps_React_default.a.createElement("div",{className:"mlDataFrameAnalyticsClassification__dataGridMinWidth"},columns.length>0&&columnsData.length>0&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs",color:"subdued"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataframe.analytics.classificationExploration.confusionMatrixPredictedLabel",defaultMessage:"Predicted class"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDataGrid,{"data-test-subj":"mlDFAnalyticsClassificationExplorationConfusionMatrix","aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.confusionMatrixLabel",{defaultMessage:"Classification confusion matrix"}),columns:shownColumns,columnVisibility:{visibleColumns:visibleColumns,setVisibleColumns:setVisibleColumns},rowCount:rowCount,renderCellValue:({rowIndex:rowIndex,columnId:columnId,setCellProps:setCellProps})=>{const cellValue="actual_class"===columnId?columnsData[rowIndex][columnId]:columnsData[rowIndex].predicted_classes_count[columnId],actualCount=columnsData[rowIndex]&&columnsData[rowIndex].actual_class_doc_count;let accuracy="0%";if("actual_class"!==columnId&&actualCount&&"number"==typeof cellValue){let accuracyNumber=cellValue/actualCount;accuracyNumber=Math.round(100*accuracyNumber)/100,accuracy=Math.round(100*accuracyNumber)+"%"}return Object(external_kbnSharedDeps_React_.useEffect)(()=>{"actual_class"!==columnId&&setCellProps({style:{backgroundColor:`rgba(0, 179, 164, ${accuracy})`}})},[rowIndex,columnId,setCellProps]),external_kbnSharedDeps_React_default.a.createElement("span",null,"actual_class"===columnId?cellValue:accuracy)},inMemory:{level:"sorting"},toolbarVisibility:{showColumnSelector:!0,showStyleSelector:!1,showFullScreenSelector:!1,showSortSelector:!1},popoverContents:popoverContents,gridStyle:{border:"all",fontSize:"s",cellPadding:"s",stripes:!1,rowHover:"none",header:"shade"},trailingControlColumns:!0===showTrailingColumns&&!1===showFullColumns?getTrailingControlColumns(extraColumns,setShowFullColumns):void 0})))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"xl"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"l"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(evaluate_stat_EvaluateStat,{dataTestSubj:"mlDFAEvaluateSectionOverallAccuracyStat",title:overallAccuracy,isLoading:isLoadingConfusionMatrix,description:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.evaluateSectionOverallAccuracyStat",{defaultMessage:"Overall accuracy"}),tooltipContent:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.evaluateSectionOverallAccuracyTooltip",{defaultMessage:"The ratio of the number of correct class predictions to the total number of predictions."})})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(evaluate_stat_EvaluateStat,{dataTestSubj:"mlDFAEvaluateSectionAvgRecallStat",title:avgRecall,isLoading:isLoadingConfusionMatrix,description:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.evaluateSectionMeanRecallStat",{defaultMessage:"Mean recall"}),tooltipContent:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.evaluateSectionAvgRecallTooltip",{defaultMessage:"Mean recall shows how many of the data points that are actual class members were identified correctly as class members."})}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"none"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"xxs"},external_kbnSharedDeps_React_default.a.createElement("span",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataframe.analytics.classificationExploration.evaluateSectionRocTitle",defaultMessage:"Receiver operating characteristic (ROC) curve"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIconTip,{anchorClassName:"mlDataFrameAnalyticsClassificationInfoTooltip",content:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.evaluateSectionRocInfoTooltip",{defaultMessage:"The receiver operating characteristic (ROC) curve is a plot that represents the performance of the classification process at different predicted probability thresholds."})}))),Array.isArray(errorRocCurve)&&external_kbnSharedDeps_React_default.a.createElement(ErrorCallout,{error:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,errorRocCurve.map(e=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,e,external_kbnSharedDeps_React_default.a.createElement("br",null))))}),!isLoadingRocCurve&&null===errorRocCurve&&rocCurveData.length>0&&external_kbnSharedDeps_React_default.a.createElement("div",{className:"mlDataFrameAnalyticsClassification__evaluateSectionContent","data-test-subj":"mlDFAnalyticsClassificationExplorationRocCurveChart"},external_kbnSharedDeps_React_default.a.createElement(VegaChart,{vegaSpec:getRocCurveChartVegaLiteSpec(classificationClasses,rocCurveData,Object(data_frame_analytics_common.w)(jobConfig.analysis))})),isLoadingRocCurve&&external_kbnSharedDeps_React_default.a.createElement(VegaChartLoading,null))}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}))},ClassificationExploration=({jobId:jobId})=>external_kbnSharedDeps_React_default.a.createElement("div",{className:"mlDataFrameAnalyticsClassification"},external_kbnSharedDeps_React_default.a.createElement(ExplorationPageWrapper,{jobId:jobId,title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.tableJobIdTitle",{defaultMessage:"Destination index for classification job ID {jobId}",values:{jobId:jobId}}),EvaluatePanel:classification_exploration_evaluate_panel_EvaluatePanel,FeatureImportanceSummaryPanel:feature_importance_summary_FeatureImportanceSummaryPanel})),analytics_exploration_page_Page=({jobId:jobId,analysisType:analysisType})=>{const{services:{docLinks:docLinks}}=Object(contexts_kibana.b)(),helpLink=docLinks.links.ml.dataFrameAnalytics;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(navigation_menu.a,{tabId:"data_frame_analytics"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPage,{"data-test-subj":"mlPageDataFrameAnalyticsExploration"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageBody,{style:{maxWidth:"calc(100% - 0px)"}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageContentHeader,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageContentHeaderSection,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,null,external_kbnSharedDeps_React_default.a.createElement("h1",null,jobId)))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageContentBody,{style:{maxWidth:"calc(100% - 0px)"}},analysisType===data_frame_analytics.a.OUTLIER_DETECTION&&external_kbnSharedDeps_React_default.a.createElement(OutlierExploration,{jobId:jobId}),analysisType===data_frame_analytics.a.REGRESSION&&external_kbnSharedDeps_React_default.a.createElement(RegressionExploration,{jobId:jobId}),analysisType===data_frame_analytics.a.CLASSIFICATION&&external_kbnSharedDeps_React_default.a.createElement(ClassificationExploration,{jobId:jobId})))),external_kbnSharedDeps_React_default.a.createElement(help_menu.a,{docLink:helpLink}))};function analytics_job_exploration_extends(){return(analytics_job_exploration_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const analyticsJobExplorationRouteFactory=(navigateToPath,basePath)=>({path:"/data_frame_analytics/exploration",render:(props,deps)=>external_kbnSharedDeps_React_default.a.createElement(analytics_job_exploration_PageWrapper,analytics_job_exploration_extends({},props,{deps:deps})),breadcrumbs:[getBreadcrumbWithUrlForApp("ML_BREADCRUMB",navigateToPath,basePath),getBreadcrumbWithUrlForApp("DATA_FRAME_ANALYTICS_BREADCRUMB",navigateToPath,basePath),{text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataFrameAnalyticsBreadcrumbs.dataFrameExplorationLabel",{defaultMessage:"Exploration"}),href:""}]}),analytics_job_exploration_PageWrapper=({location:location,deps:deps})=>{const{context:context}=useResolver(void 0,void 0,deps.config,basicResolvers(deps)),[globalState]=Object(url_state.c)("_g"),urlGenerator=Object(contexts_kibana.d)(),{services:{application:{navigateToUrl:navigateToUrl}}}=Object(contexts_kibana.b)(),jobId=globalState.ml.jobId,analysisType=globalState.ml.analysisType;return analysisType||(async()=>{const url=await urlGenerator.createUrl({page:ml_url_generator.b.DATA_FRAME_ANALYTICS_JOBS_MANAGE});await navigateToUrl(url)})(),external_kbnSharedDeps_React_default.a.createElement(PageLoader,{context:context},external_kbnSharedDeps_React_default.a.createElement(analytics_exploration_page_Page,{jobId:jobId,analysisType:analysisType}))};var use_create_analytics_form=__webpack_require__(419);const Messages=({messages:messages})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,messages.map((requestMessage,i)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,{key:i},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{"data-test-subj":"analyticsWizardCreationCallout_"+i,title:requestMessage.message,color:void 0!==requestMessage.error?"danger":"primary",iconType:void 0!==requestMessage.error?"alert":"checkInCircleFilled",size:"s"},void 0!==requestMessage.error&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCodeBlock,{language:"json",fontSize:"s",paddingSize:"s",isCopyable:!0},requestMessage.error)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}))));var use_create_analytics_form_state=__webpack_require__(119);const fetchExplainData=async formState=>{const jobConfig=Object(use_create_analytics_form_state.f)(formState);let errorMessage="",errorReason="",success=!0,expectedMemory="",fieldSelection=[];try{var _resp$memory_estimati;delete jobConfig.dest,delete jobConfig.model_memory_limit;const resp=await ml_api_service.ml.dataFrameAnalytics.explainDataFrameAnalytics(jobConfig);expectedMemory=null===(_resp$memory_estimati=resp.memory_estimation)||void 0===_resp$memory_estimati?void 0:_resp$memory_estimati.expected_memory_without_disk,fieldSelection=resp.field_selection||[]}catch(error){const errObj=Object(util_errors.j)(error);success=!1,errorMessage=errObj.message,errObj.causedBy&&(errorReason=errObj.causedBy)}return{success:success,expectedMemory:expectedMemory,fieldSelection:fieldSelection,errorMessage:errorMessage,errorReason:errorReason}},BackToListPanel=()=>{const analyticsManagementPageLink=Object(contexts_kibana.c)({page:ml_url_generator.b.DATA_FRAME_ANALYTICS_JOBS_MANAGE});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCard,{className:"dfAnalyticsCreationWizard__card",icon:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{size:"xxl",type:"list"}),title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.analyticsListCardTitle",{defaultMessage:"Data Frame Analytics"}),description:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.analyticsListCardDescription",{defaultMessage:"Return to the analytics management page."}),href:analyticsManagementPageLink,"data-test-subj":"analyticsWizardCardManagement"}))},ViewResultsPanel=({jobId:jobId,analysisType:analysisType})=>{const analyticsExplorationPageLink=Object(contexts_kibana.c)({page:ml_url_generator.b.DATA_FRAME_ANALYTICS_EXPLORATION,pageState:{jobId:jobId,analysisType:analysisType}});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCard,{className:"dfAnalyticsCreationWizard__card",icon:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{size:"xxl",type:"visTable"}),title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.viewResultsCardTitle",{defaultMessage:"View Results"}),description:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.viewResultsCardDescription",{defaultMessage:"View results for the analytics job."}),href:analyticsExplorationPageLink,"data-test-subj":"analyticsWizardViewResultsCard"}))},ProgressStats=({currentProgress:currentProgress,failedJobMessage:failedJobMessage})=>void 0===currentProgress?null:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),void 0!==failedJobMessage&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{"data-test-subj":"analyticsWizardProgressCallout",title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.analyticsProgressCalloutTitle",{defaultMessage:"Job failed"}),color:"danger",iconType:"alert",size:"s"},external_kbnSharedDeps_React_default.a.createElement("p",null,failedJobMessage)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"m"},external_kbnSharedDeps_React_default.a.createElement("strong",null,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.analyticsProgressTitle",{defaultMessage:"Progress"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"s"},external_kbnSharedDeps_React_default.a.createElement("strong",null,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.analyticsProgressPhaseTitle",{defaultMessage:"Phase"})," ",currentProgress.currentPhase,"/",currentProgress.totalPhases))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{style:{width:"400px"},grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiProgress,{value:currentProgress.progress,max:100,color:"primary",size:"l","data-test-subj":"mlAnalyticsCreationWizardProgress"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"s"},currentProgress.progress+"%")))),CreateStepFooter=({jobId:jobId,jobType:jobType,showProgress:showProgress})=>{const[initialized,setInitialized]=Object(external_kbnSharedDeps_React_.useState)(!1),[failedJobMessage,setFailedJobMessage]=Object(external_kbnSharedDeps_React_.useState)(void 0),[jobFinished,setJobFinished]=Object(external_kbnSharedDeps_React_.useState)(!1),[currentProgress,setCurrentProgress]=Object(external_kbnSharedDeps_React_.useState)(void 0),[showJobAssignWarning,setShowJobAssignWarning]=Object(external_kbnSharedDeps_React_.useState)(!1),{services:{notifications:notifications}}=Object(contexts_kibana.b)();return Object(external_kbnSharedDeps_React_.useEffect)(()=>{setInitialized(!0)},[]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{const interval=setInterval(async()=>{try{const analyticsStats=await ml_api_service.ml.dataFrameAnalytics.getDataFrameAnalyticsStats(jobId),jobStats=Object(get_analytics.b)(analyticsStats)?analyticsStats.data_frame_analytics[0]:void 0;if(setShowJobAssignWarning((null==jobStats?void 0:jobStats.state)===analytics_list_common.b.STARTING&&void 0===(null==jobStats?void 0:jobStats.node)),void 0!==jobStats){const progressStats=Object(analytics_list_common.d)(jobStats);jobStats.state===analytics_list_common.b.FAILED&&(clearInterval(interval),setFailedJobMessage(jobStats.failure_reason||external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.analyticsProgressCalloutMessage",{defaultMessage:"Analytics job {jobId} has failed.",values:{jobId:jobId}}))),setCurrentProgress(progressStats),(progressStats.currentPhase===progressStats.totalPhases&&100===progressStats.progress||jobStats.state===analytics_list_common.b.STOPPED&&(1!==progressStats.currentPhase||0!==progressStats.progress))&&(clearInterval(interval),setJobFinished(progressStats.currentPhase===progressStats.totalPhases&&100===progressStats.progress))}else clearInterval(interval)}catch(e){notifications.toasts.addDanger(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.analyticsProgressErrorMessage",{defaultMessage:"An error occurred getting progress stats for analytics job {jobId}",values:{jobId:jobId}})),clearInterval(interval)}},1e3);return()=>clearInterval(interval)},[initialized]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,showJobAssignWarning&&external_kbnSharedDeps_React_default.a.createElement(jobs_awaiting_node_warning.b,{jobType:"data-frame-analytics"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"column"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},showProgress&&external_kbnSharedDeps_React_default.a.createElement(ProgressStats,{currentProgress:currentProgress,failedJobMessage:failedJobMessage})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHorizontalRule,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(BackToListPanel,null)),!0===jobFinished&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(ViewResultsPanel,{jobId:jobId,analysisType:jobType}))))))},CreateStep=({actions:actions,state:state,step:step})=>{const{createAnalyticsJob:createAnalyticsJob,startAnalyticsJob:startAnalyticsJob}=actions,{isAdvancedEditorValidJson:isAdvancedEditorValidJson,isJobCreated:isJobCreated,isJobStarted:isJobStarted,isValid:isValid,requestMessages:requestMessages}=state,{jobId:jobId,jobType:jobType}=state.form,[checked,setChecked]=Object(external_kbnSharedDeps_React_.useState)(!0),[creationTriggered,setCreationTriggered]=Object(external_kbnSharedDeps_React_.useState)(!1),[showProgress,setShowProgress]=Object(external_kbnSharedDeps_React_.useState)(!1);if(step!==ANALYTICS_STEPS.CREATE)return null;return external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":"mlAnalyticsCreateJobWizardCreateStep active"},!isJobCreated&&!isJobStarted&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{helpText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.startCheckboxHelpText",{defaultMessage:"If unselected, job can be started later by returning to the jobs list."})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCheckbox,{"data-test-subj":"mlAnalyticsCreateJobWizardStartJobCheckbox",id:"dataframe-create-start-checkbox",label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.wizardStartCheckbox",{defaultMessage:"Start immediately"}),checked:checked,onChange:e=>setChecked(e.target.checked)}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{className:"mlAnalyticsCreateWizard__footerButton",disabled:!isValid||!isAdvancedEditorValidJson,onClick:async()=>{setCreationTriggered(!0);const creationSuccess=await createAnalyticsJob();!1===creationSuccess&&setCreationTriggered(!1),checked&&!0===creationSuccess&&(setShowProgress(!0),startAnalyticsJob())},fill:!0,isLoading:creationTriggered,"data-test-subj":"mlAnalyticsCreateJobWizardCreateButton"},external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.wizardCreateButton",{defaultMessage:"Create"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(Messages,{messages:requestMessages}),!0===isJobCreated&&external_kbnSharedDeps_React_default.a.createElement(CreateStepFooter,{jobId:jobId,jobType:jobType,showProgress:showProgress}))};function create_analytics_advanced_editor_extends(){return(create_analytics_advanced_editor_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const create_analytics_advanced_editor_xJsonMode=new shared_imports.a,CreateAnalyticsAdvancedEditor=props=>{const{actions:actions,state:state}=props,{setAdvancedEditorRawString:setAdvancedEditorRawString,setFormState:setFormState}=actions,{advancedEditorMessages:advancedEditorMessages,advancedEditorRawString:advancedEditorRawString,isJobCreated:isJobCreated}=state,{createIndexPattern:createIndexPattern,destinationIndexPatternTitleExists:destinationIndexPatternTitleExists,jobId:jobId,jobIdEmpty:jobIdEmpty,jobIdExists:jobIdExists,jobIdValid:jobIdValid}=state.form,forceInput=Object(external_kbnSharedDeps_React_.useRef)(null),{toasts:toasts}=Object(contexts_kibana.f)(),debouncedJobIdCheck=Object(external_kbnSharedDeps_React_.useMemo)(()=>Object(external_kbnSharedDeps_Lodash_.debounce)(async()=>{try{const{results:results}=await ml_api_service.ml.dataFrameAnalytics.jobsExists([jobId],!0);setFormState({jobIdExists:results[jobId]})}catch(e){toasts.addDanger(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditor.errorCheckingJobIdExists",{defaultMessage:"The following error occurred checking if job id exists: {error}",values:{error:Object(util_errors.i)(e)}}))}},400),[jobId]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{if(null===forceInput.current)return;const evt=document.createEvent("MouseEvents");evt.initEvent("mouseup",!0,!0),forceInput.current.dispatchEvent(evt)},[]),Object(external_kbnSharedDeps_React_.useEffect)(()=>(!0===jobIdValid?debouncedJobIdCheck():"string"==typeof jobId&&""===jobId.trim()&&!0===jobIdExists&&setFormState({jobIdExists:!1}),()=>{debouncedJobIdCheck.cancel()}),[jobId]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiForm,{className:"mlDataFrameAnalyticsCreateForm"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditor.jobIdLabel",{defaultMessage:"Analytics job ID"}),isInvalid:!jobIdEmpty&&!jobIdValid||jobIdExists,error:[...jobIdEmpty||jobIdValid?[]:[external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditor.jobIdInvalidError",{defaultMessage:"Must contain lowercase alphanumeric characters (a-z and 0-9), hyphens, and underscores only and must start and end with alphanumeric characters."})],...jobIdExists?[external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditor.jobIdExistsError",{defaultMessage:"An analytics job with this ID already exists."})]:[]]},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldText,{inputRef:input=>{input&&(forceInput.current=input)},disabled:isJobCreated,placeholder:"analytics job ID",value:jobId,onChange:e=>setFormState({jobId:e.target.value}),"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditor.jobIdInputAriaLabel",{defaultMessage:"Choose a unique analytics job ID."}),isInvalid:!jobIdEmpty&&!jobIdValid||jobIdExists})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditor.configRequestBody",{defaultMessage:"Configuration request body"}),style:{maxWidth:"100%"}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCodeEditor,{isReadOnly:isJobCreated,mode:create_analytics_advanced_editor_xJsonMode,width:"100%",value:advancedEditorRawString,onChange:str=>{setAdvancedEditorRawString(str)},setOptions:{fontSize:"12px"},theme:"textmate","aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditor.codeEditorAriaLabel",{defaultMessage:"Advanced analytics job editor"})})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),advancedEditorMessages.map((advancedEditorMessage,i)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,{key:i},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:""!==advancedEditorMessage.message?advancedEditorMessage.message:advancedEditorMessage.error,color:void 0!==advancedEditorMessage.error?"danger":"primary",iconType:void 0!==advancedEditorMessage.error?"alert":"checkInCircleFilled",size:"s"},""!==advancedEditorMessage.message&&void 0!==advancedEditorMessage.error?external_kbnSharedDeps_React_default.a.createElement("p",null,advancedEditorMessage.error):null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null))),!isJobCreated&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{isInvalid:createIndexPattern&&destinationIndexPatternTitleExists,error:createIndexPattern&&destinationIndexPatternTitleExists&&[external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.indexPatternAlreadyExistsError",{defaultMessage:"An index pattern with this title already exists."})]},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSwitch,{disabled:isJobCreated,name:"mlDataFrameAnalyticsCreateIndexPattern",label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.createIndexPatternLabel",{defaultMessage:"Create index pattern"}),checked:!0===createIndexPattern,onChange:()=>setFormState({createIndexPattern:!createIndexPattern})}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),external_kbnSharedDeps_React_default.a.createElement(CreateStep,create_analytics_advanced_editor_extends({},props,{step:ANALYTICS_STEPS.CREATE})))},ConfigurationStepDetails=({setCurrentStep:setCurrentStep,state:state})=>{const mlContext=Object(ml.b)(),{currentIndexPattern:currentIndexPattern}=mlContext,{form:form,isJobCreated:isJobCreated}=state,{dependentVariable:dependentVariable,includes:includes,jobConfigQueryString:jobConfigQueryString,jobType:jobType,trainingPercent:trainingPercent}=form,isJobTypeWithDepVar=jobType===analytics.b.REGRESSION||jobType===analytics.b.CLASSIFICATION,detailsFirstCol=[{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.sourceIndex",{defaultMessage:"Source index"}),description:currentIndexPattern.title||use_create_analytics_form_state.c},{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.Query",{defaultMessage:"Query"}),description:jobConfigQueryString||use_create_analytics_form_state.c}],detailsSecondCol=[{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.jobType",{defaultMessage:"Job type"}),description:jobType}],detailsThirdCol=[{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.includedFields",{defaultMessage:"Included fields"}),description:includes.length>5?external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.includedFieldsAndMoreDescription",{defaultMessage:"{includedFields} ... (and {extraCount} more)",values:{extraCount:includes.length-5,includedFields:includes.slice(0,5).join(", ")}}):includes.join(", ")}];return isJobTypeWithDepVar&&(detailsSecondCol.push({title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.trainingPercent",{defaultMessage:"Training percent"}),description:""+trainingPercent}),detailsThirdCol.unshift({title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.dependentVariable",{defaultMessage:"Dependent variable"}),description:dependentVariable})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{style:{width:"70%"},justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionList,{compressed:!0,listItems:detailsFirstCol})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionList,{compressed:!0,listItems:detailsSecondCol})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionList,{compressed:!0,listItems:detailsThirdCol}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),!isJobCreated&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{iconType:"pencil",size:"s",onClick:()=>{setCurrentStep(ANALYTICS_STEPS.CONFIGURATION)}},external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.editButtonText",{defaultMessage:"Edit"})))};var get_scatterplot_matrix_legend_type=__webpack_require__(236);const CATEGORICAL_TYPES=new Set(["ip","keyword"]),shouldAddAsDepVarOption=(fieldId,fieldType,jobType)=>{if(fieldId===types_fields.a)return!1;const isBasicNumerical=common_fields.a.has(fieldType),isSupportedByClassification=isBasicNumerical||CATEGORICAL_TYPES.has(fieldType)||fieldType===data_public_.ES_FIELD_TYPES.BOOLEAN;return jobType===analytics.b.REGRESSION?isBasicNumerical||common_fields.b.has(fieldType):jobType===analytics.b.CLASSIFICATION?isSupportedByClassification:void 0},handleExplainErrorMessage=(errorMessage,sourceIndex,jobType)=>{let maxDistinctValuesErrorMessage,unsupportedFieldsErrorMessage,toastNotificationWarning,toastNotificationDanger;return jobType===analytics.b.CLASSIFICATION&&(errorMessage.includes("must have at most")||errorMessage.includes("must have at least"))?maxDistinctValuesErrorMessage=errorMessage:errorMessage.includes("status_exception")&&errorMessage.includes("unsupported type")?unsupportedFieldsErrorMessage=errorMessage:errorMessage.includes("status_exception")&&errorMessage.includes("Unable to estimate memory usage as no documents")?toastNotificationWarning=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.allDocsMissingFieldsErrorMessage",{defaultMessage:"Unable to estimate memory usage. There are mapped fields for source index [{index}] that do not exist in any indexed documents. You will have to switch to the JSON editor for explicit field selection and include only fields that exist in indexed documents.",values:{index:sourceIndex}}):toastNotificationDanger={title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.unableToFetchExplainDataMessage",{defaultMessage:"An error occurred fetching analysis fields data."}),text:errorMessage},{maxDistinctValuesErrorMessage:maxDistinctValuesErrorMessage,unsupportedFieldsErrorMessage:unsupportedFieldsErrorMessage,toastNotificationDanger:toastNotificationDanger,toastNotificationWarning:toastNotificationWarning}},continueButtonText=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.creation.continueButtonText",{defaultMessage:"Continue"}),ContinueButton=({isDisabled:isDisabled,onClick:onClick})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{"data-test-subj":"mlAnalyticsCreateJobWizardContinueButton",isDisabled:isDisabled,size:"s",onClick:onClick},continueButtonText))),job_type_jobDetails={[data_frame_analytics.a.OUTLIER_DETECTION]:{helpText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.outlierDetectionHelpText",{defaultMessage:"Outlier detection identifies unusual data points in the data set."}),icon:"outlierDetectionJob",title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.outlierDetectionTitle",{defaultMessage:"Outlier detection"})},[data_frame_analytics.a.REGRESSION]:{helpText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.regressionHelpText",{defaultMessage:"Regression predicts numerical values in the data set."}),icon:"regressionJob",title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.regressionTitle",{defaultMessage:"Regression"})},[data_frame_analytics.a.CLASSIFICATION]:{helpText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.classificationHelpText",{defaultMessage:"Classification predicts classes of data points in the data set."}),icon:"classificationJob",title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.classificationTitle",{defaultMessage:"Classification"})}},JobType=({type:type,setFormState:setFormState})=>{const[selectedCard,setSelectedCard]=Object(external_kbnSharedDeps_React_.useState)({});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"m","data-test-subj":"mlAnalyticsCreateJobWizardJobTypeSelect"},Object.keys(job_type_jobDetails).map(jobType=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{key:jobType,grow:1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCard,{icon:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{size:"xl",type:job_type_jobDetails[jobType].icon}),title:job_type_jobDetails[jobType].title,description:job_type_jobDetails[jobType].helpText,"data-test-subj":`mlAnalyticsCreation-${jobType}-option${type===jobType?" selectedJobType":""}`,selectable:{onClick:()=>{!0!==selectedCard[jobType]&&(setFormState({previousJobType:type,jobType:jobType,includes:[],requiredFieldsError:void 0}),setSelectedCard({[jobType]:!selectedCard[jobType]}))},isSelected:!0===selectedCard[jobType]||type===jobType}})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}))},callbacks={[analytics.b.CLASSIFICATION]:({name:name,type:type})=>!field_types.d.includes(name)&&name!==types_fields.a&&(common_fields.a.has(type)||CATEGORICAL_TYPES.has(type)||type===data_public_.ES_FIELD_TYPES.BOOLEAN),[analytics.b.REGRESSION]:({name:name,type:type})=>!field_types.d.includes(name)&&name!==types_fields.a&&(common_fields.a.has(type)||common_fields.b.has(type)),[analytics.b.OUTLIER_DETECTION]:({name:name,type:type})=>!field_types.d.includes(name)&&name!==types_fields.a&&(common_fields.a.has(type)||common_fields.b.has(type))},supported_fields_message_messages={[analytics.b.CLASSIFICATION]:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataframe.analytics.create.sourceObjectClassificationHelpText",defaultMessage:"This index pattern does not contain any supported fields. Classification jobs require categorical, numeric, or boolean fields."}),[analytics.b.REGRESSION]:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataframe.analytics.create.sourceObjectRegressionHelpText",defaultMessage:"This index pattern does not contain any supported fields. Regression jobs require numeric fields."}),[analytics.b.OUTLIER_DETECTION]:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataframe.analytics.create.sourceObjectHelpText",defaultMessage:"This index pattern does not contain any numeric type fields. The analytics job may not be able to come up with any outliers."})},SupportedFieldsMessage=({jobType:jobType})=>{const[sourceIndexContainsSupportedFields,setSourceIndexContainsSupportedFields]=Object(external_kbnSharedDeps_React_.useState)(!0),[sourceIndexFieldsCheckFailed,setSourceIndexFieldsCheckFailed]=Object(external_kbnSharedDeps_React_.useState)(!1),{fields:fields}=new_job_capabilities_service_analytics.a;return Object(external_kbnSharedDeps_React_.useEffect)(()=>{void 0!==jobType&&(()=>{if(fields&&void 0!==jobType)try{const containsSupportedFields=fields.some(callbacks[jobType]);setSourceIndexContainsSupportedFields(containsSupportedFields),setSourceIndexFieldsCheckFailed(!1)}catch(e){setSourceIndexFieldsCheckFailed(!0)}})()},[jobType]),!0===sourceIndexContainsSupportedFields?null:!0===sourceIndexFieldsCheckFailed?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataframe.analytics.create.sourceIndexFieldsCheckError",defaultMessage:"There was a problem checking for supported fields for job type. Please refresh the page and try again."}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"})):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs",color:"danger"},void 0!==jobType&&supported_fields_message_messages[jobType]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}))};var external_kbnSharedDeps_ElasticEuiLibServices_=__webpack_require__(52),custom_selection_table=__webpack_require__(424);const minimumFieldsMessage=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.analysisFieldsTable.minimumFieldsMessage",{defaultMessage:"At least one field must be selected."}),analysis_fields_table_columns=[{id:"checkbox",isCheckbox:!0,textOnly:!1,width:"32px"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.analysisFieldsTable.fieldNameColumn",{defaultMessage:"Field name"}),id:"name",isSortable:!0,alignment:external_kbnSharedDeps_ElasticEuiLibServices_.LEFT_ALIGNMENT},{id:"mapping_types",label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.analyticsTable.mappingColumn",{defaultMessage:"Mapping"}),isSortable:!1,alignment:external_kbnSharedDeps_ElasticEuiLibServices_.LEFT_ALIGNMENT},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.analyticsTable.isIncludedColumn",{defaultMessage:"Is included"}),id:"is_included",alignment:external_kbnSharedDeps_ElasticEuiLibServices_.LEFT_ALIGNMENT,isSortable:!0,render:({is_included:is_included})=>is_included?"Yes":"No"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.analyticsTable.isRequiredColumn",{defaultMessage:"Is required"}),id:"is_required",alignment:external_kbnSharedDeps_ElasticEuiLibServices_.LEFT_ALIGNMENT,isSortable:!0,render:({is_required:is_required})=>is_required?"Yes":"No"},{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.analyticsTable.reasonColumn",{defaultMessage:"Reason"}),id:"reason",alignment:external_kbnSharedDeps_ElasticEuiLibServices_.LEFT_ALIGNMENT,isSortable:!1}],checkboxDisabledCheck=item=>!0===item.is_required||item.reason&&item.reason.includes("unsupported type"),AnalysisFieldsTable=({dependentVariable:dependentVariable,includes:includes,loadingItems:loadingItems,setFormState:setFormState,minimumFieldsRequiredMessage:minimumFieldsRequiredMessage,setMinimumFieldsRequiredMessage:setMinimumFieldsRequiredMessage,tableItems:tableItems,unsupportedFieldsError:unsupportedFieldsError,setUnsupportedFieldsError:setUnsupportedFieldsError})=>{const[sortableProperties,setSortableProperties]=Object(external_kbnSharedDeps_React_.useState)(),[currentPaginationData,setCurrentPaginationData]=Object(external_kbnSharedDeps_React_.useState)({pageIndex:0,itemsPerPage:5});Object(external_kbnSharedDeps_React_.useEffect)(()=>{if(0===includes.length&&tableItems.length>0){const includedFields=[];tableItems.forEach(field=>{!0===field.is_included&&includedFields.push(field.name)}),setFormState({includes:includedFields})}else includes.length>0&&setFormState({includes:includes});setMinimumFieldsRequiredMessage(void 0)},[tableItems]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{let sortablePropertyItems=[];sortablePropertyItems=[{name:"name",getValue:item=>item.name.toLowerCase(),isAscending:!0},{name:"is_included",getValue:item=>item.is_included,isAscending:!0},{name:"is_required",getValue:item=>item.is_required,isAscending:!0}];const sortableProps=new external_kbnSharedDeps_ElasticEuiLibServices_.SortableProperties(sortablePropertyItems,"name");setSortableProperties(sortableProps)},[]);const filters=[{type:"field_value_toggle_group",field:"is_included",items:[{value:!0,name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.isIncludedOption",{defaultMessage:"Is included"})},{value:!1,name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.isNotIncludedOption",{defaultMessage:"Is not included"})}]}];return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{"data-test-subj":"mlAnalyticsCreateJobWizardIncludesTable",label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.includedFieldsLabel",{defaultMessage:"Included fields"}),fullWidth:!0,isInvalid:void 0!==minimumFieldsRequiredMessage||void 0!==unsupportedFieldsError,error:[...void 0!==minimumFieldsRequiredMessage?[minimumFieldsRequiredMessage]:[],...void 0!==unsupportedFieldsError?[external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.unsupportedFieldsError",{defaultMessage:"Invalid. {message}",values:{message:unsupportedFieldsError}})]:[]]},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null)),tableItems.length>0&&void 0===minimumFieldsRequiredMessage&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs"},external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.includedFieldsCount",{defaultMessage:"{numFields, plural, one {# field} other {# fields}} included in the analysis",values:{numFields:includes.length}})),0===tableItems.length&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.calloutTitle",{defaultMessage:"Analysis fields not available"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataframe.analytics.create.calloutMessage",defaultMessage:"Additional data required to load analysis fields."})),tableItems.length>0&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPanel,{paddingSize:"m","data-test-subj":"mlAnalyticsCreateJobWizardIncludesSelect"},external_kbnSharedDeps_React_default.a.createElement(custom_selection_table.a,{currentPage:currentPaginationData.pageIndex,"data-test-subj":"mlAnalyticsCreationAnalysisFieldsTable",checkboxDisabledCheck:checkboxDisabledCheck,columns:analysis_fields_table_columns,filters:filters,items:tableItems,itemsPerPage:currentPaginationData.itemsPerPage,onTableChange:selection=>{void 0!==dependentVariable&&""!==dependentVariable&&0===selection.length&&(selection=[dependentVariable]),0===selection.length?(setMinimumFieldsRequiredMessage(minimumFieldsMessage),setUnsupportedFieldsError(void 0)):(setMinimumFieldsRequiredMessage(void 0),setFormState({includes:selection}))},selectedIds:includes,setCurrentPaginationData:setCurrentPaginationData,singleSelection:!1,sortableProperties:sortableProperties,tableItemId:"name"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null))};function getRuntimeFieldColumns(runtimeMappings){return Object.keys(runtimeMappings).map(id=>{const field=runtimeMappings[id],schema=Object(data_grid.i)(field.type);return{id:id,schema:schema,isExpandable:"boolean"!==schema,isRuntimeFieldColumn:!0}})}function getIndexPatternColumns(indexPattern,fieldsFilter){const{fields:fields}=new_job_capabilities_service_analytics.a;return fields.filter(field=>fieldsFilter.includes(field.name)).map(field=>{const schema=Object(data_grid.i)(field.type)||Object(data_grid.j)(field);return{id:field.name,schema:schema,isExpandable:"boolean"!==schema,isRuntimeFieldColumn:!1}})}function useSavedSearch(){const[savedSearchQuery,setSavedSearchQuery]=Object(external_kbnSharedDeps_React_.useState)(void 0),[savedSearchQueryStr,setSavedSearchQueryStr]=Object(external_kbnSharedDeps_React_.useState)(void 0),mlContext=Object(ml.b)(),{currentSavedSearch:currentSavedSearch,currentIndexPattern:currentIndexPattern,kibanaConfig:kibanaConfig}=mlContext;return Object(external_kbnSharedDeps_React_.useEffect)(()=>{(()=>{let qry,qryString;if(null!==currentSavedSearch){const{query:query}=Object(index_utils.f)(currentSavedSearch),queryLanguage=query.language;if(qryString=query.query,queryLanguage===constants_search.c.KUERY){const ast=data_public_.esKuery.fromKueryExpression(qryString);qry=data_public_.esKuery.toElasticsearchQuery(ast,currentIndexPattern)}else qry=data_public_.esQuery.luceneStringToDsl(qryString),data_public_.esQuery.decorateQuery(qry,kibanaConfig.get("query:queryString:options"));setSavedSearchQuery(qry),setSavedSearchQueryStr(qryString)}else setSavedSearchQuery(null),setSavedSearchQueryStr(null)})()},[]),{savedSearchQuery:savedSearchQuery,savedSearchQueryStr:savedSearchQueryStr}}var ace_target=__webpack_require__(245),esUiShared_public_=__webpack_require__(55);const RuntimeMappingsEditor=Object(external_kbnSharedDeps_React_.memo)(({convertToJson:convertToJson,xJsonMode:xJsonMode,setAdvancedRuntimeMappingsConfig:setAdvancedRuntimeMappingsConfig,setIsRuntimeMappingsEditorApplyButtonEnabled:setIsRuntimeMappingsEditorApplyButtonEnabled,advancedEditorRuntimeMappingsLastApplied:advancedEditorRuntimeMappingsLastApplied,advancedRuntimeMappingsConfig:advancedRuntimeMappingsConfig})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCodeEditor,{"data-test-subj":"mlDataFrameAnalyticsAdvancedRuntimeMappingsEditor",style:{border:"1px solid #e3e6ef"},height:"250px",width:"100%",mode:xJsonMode,value:advancedRuntimeMappingsConfig,onChange:d=>{if(setAdvancedRuntimeMappingsConfig(d),advancedEditorRuntimeMappingsLastApplied!==d)if(""!==d)try{const parsedJson=JSON.parse(convertToJson(d));setIsRuntimeMappingsEditorApplyButtonEnabled(Object(runtime_field_utils.b)(parsedJson))}catch(e){setIsRuntimeMappingsEditorApplyButtonEnabled(!1)}else setIsRuntimeMappingsEditorApplyButtonEnabled(!0);else setIsRuntimeMappingsEditorApplyButtonEnabled(!1)},setOptions:{fontSize:"12px"},theme:"textmate","aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.createWizard.runtimeMappings.advancedEditorAriaLabel",{defaultMessage:"Advanced runtime editor"})}),(prevProps,nextProps)=>Object(external_kbnSharedDeps_Lodash_.isEqual)(pickProps(prevProps),pickProps(nextProps)));function pickProps(props){return[props.advancedEditorRuntimeMappingsLastApplied,props.advancedRuntimeMappingsConfig]}const modalTitle=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.createWizard.runtimeEditorSwitchModalTitle",{defaultMessage:"Edits will be lost"}),cancelButtonText=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.createWizard.runtimeEditorSwitchModalCancelButtonText",{defaultMessage:"Cancel"}),applyChangesText=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.createWizard.runtimeEditorSwitchModalConfirmButtonText",{defaultMessage:"Close editor"}),modalMessage=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.createWizard.runtimeEditorSwitchModalBodyText",{defaultMessage:"The changes in the editor haven't been applied yet. By closing the editor you will lose your edits."}),SwitchModal=({onCancel:onCancel,onConfirm:onConfirm})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiConfirmModal,{title:modalTitle,onCancel:onCancel,onConfirm:onConfirm,cancelButtonText:cancelButtonText,confirmButtonText:applyChangesText,buttonColor:"danger",defaultFocusedButton:"confirm"},external_kbnSharedDeps_React_default.a.createElement("p",null,modalMessage)),COPY_RUNTIME_FIELDS_TO_CLIPBOARD_TEXT=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.createWizard.indexPreview.copyRuntimeMappingsClipboardTooltip",{defaultMessage:"Copy Dev Console statement of the runtime fields to the clipboard."}),APPLY_CHANGES_TEXT=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.createWizard.advancedSourceEditorApplyButtonText",{defaultMessage:"Apply changes"}),RUNTIME_FIELDS_EDITOR_HELP_TEXT=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.createWizard.advancedRuntimeFieldsEditorHelpText",{defaultMessage:"The advanced editor allows you to edit the runtime fields of the source."}),EDIT_SWITCH_LABEL_TEXT=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.createWizard.advancedEditorRuntimeFieldsSwitchLabel",{defaultMessage:"Edit runtime fields"}),RUNTIME_FIELDS_LABEL_TEXT=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.createWizard.runtimeFieldsLabel",{defaultMessage:"Runtime fields"}),{useXJsonMode:useXJsonMode}=esUiShared_public_.XJson,runtime_mappings_xJsonMode=new ace_target.XJsonMode,RuntimeMappings=({actions:actions,state:state})=>{const[isRuntimeMappingsEditorEnabled,setIsRuntimeMappingsEditorEnabled]=Object(external_kbnSharedDeps_React_.useState)(!1),[isRuntimeMappingsEditorSwitchModalVisible,setRuntimeMappingsEditorSwitchModalVisible]=Object(external_kbnSharedDeps_React_.useState)(!1),[isRuntimeMappingsEditorApplyButtonEnabled,setIsRuntimeMappingsEditorApplyButtonEnabled]=Object(external_kbnSharedDeps_React_.useState)(!1),[advancedEditorRuntimeMappingsLastApplied,setAdvancedEditorRuntimeMappingsLastApplied]=Object(external_kbnSharedDeps_React_.useState)(),{setFormState:setFormState}=actions,{jobType:jobType,previousRuntimeMapping:previousRuntimeMapping,runtimeMappings:runtimeMappings}=state.form,{convertToJson:convertToJson,setXJson:setAdvancedRuntimeMappingsConfig,xJson:advancedRuntimeMappingsConfig}=useXJsonMode(runtimeMappings||""),mlContext=Object(ml.b)(),{currentIndexPattern:currentIndexPattern}=mlContext,toggleEditorHandler=(reset=!1)=>{!0===reset&&(setFormState({runtimeMappingsUpdated:!1}),setAdvancedRuntimeMappingsConfig(null!=advancedEditorRuntimeMappingsLastApplied?advancedEditorRuntimeMappingsLastApplied:"")),setIsRuntimeMappingsEditorEnabled(!isRuntimeMappingsEditorEnabled),setIsRuntimeMappingsEditorApplyButtonEnabled(Object(common.isRuntimeMappings)(runtimeMappings))};return Object(external_kbnSharedDeps_React_.useEffect)((function(){const combinedRuntimeMappings=Object(data_grid_common.f)(currentIndexPattern,runtimeMappings),prettySourceConfig=JSON.stringify(combinedRuntimeMappings,null,2);combinedRuntimeMappings&&(setAdvancedRuntimeMappingsConfig(prettySourceConfig),setAdvancedEditorRuntimeMappingsLastApplied(prettySourceConfig),setFormState({runtimeMappings:combinedRuntimeMappings}))}),[]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{fullWidth:!0,label:RUNTIME_FIELDS_LABEL_TEXT},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"baseline",justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!0},Object(object_utils.b)(runtimeMappings)?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"s",grow:!1},Object.keys(runtimeMappings).join(",")):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataframe.analytics.createWizard.noRuntimeFieldLabel",defaultMessage:"No runtime field"}),isRuntimeMappingsEditorEnabled&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(RuntimeMappingsEditor,{advancedEditorRuntimeMappingsLastApplied:advancedEditorRuntimeMappingsLastApplied,advancedRuntimeMappingsConfig:advancedRuntimeMappingsConfig,setIsRuntimeMappingsEditorApplyButtonEnabled:setIsRuntimeMappingsEditorApplyButtonEnabled,setAdvancedRuntimeMappingsConfig:setAdvancedRuntimeMappingsConfig,convertToJson:convertToJson,xJsonMode:runtime_mappings_xJsonMode}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,style:{width:"220px"}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"xs",direction:"column",justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSwitch,{disabled:void 0===jobType,label:EDIT_SWITCH_LABEL_TEXT,checked:isRuntimeMappingsEditorEnabled,onChange:()=>{isRuntimeMappingsEditorEnabled&&advancedRuntimeMappingsConfig!==advancedEditorRuntimeMappingsLastApplied?setRuntimeMappingsEditorSwitchModalVisible(!0):toggleEditorHandler()},"data-test-subj":"mlDataFrameAnalyticsRuntimeMappingsEditorSwitch"}),isRuntimeMappingsEditorSwitchModalVisible&&external_kbnSharedDeps_React_default.a.createElement(SwitchModal,{onCancel:()=>setRuntimeMappingsEditorSwitchModalVisible(!1),onConfirm:()=>{setRuntimeMappingsEditorSwitchModalVisible(!1),toggleEditorHandler(!0)}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCopy,{beforeMessage:COPY_RUNTIME_FIELDS_TO_CLIPBOARD_TEXT,textToCopy:null!=advancedRuntimeMappingsConfig?advancedRuntimeMappingsConfig:""},copy=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{onClick:copy,iconType:"copyClipboard","aria-label":COPY_RUNTIME_FIELDS_TO_CLIPBOARD_TEXT}))))),isRuntimeMappingsEditorEnabled&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{style:{width:"220px"}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs"},RUNTIME_FIELDS_EDITOR_HELP_TEXT),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{style:{width:"fit-content"},size:"s",fill:!0,onClick:()=>{const removeRuntimeMappings=""===advancedRuntimeMappingsConfig,parsedRuntimeMappings=removeRuntimeMappings?void 0:JSON.parse(advancedRuntimeMappingsConfig),prettySourceConfig=removeRuntimeMappings?"":JSON.stringify(parsedRuntimeMappings,null,2);setFormState({runtimeMappings:parsedRuntimeMappings,runtimeMappingsUpdated:!0,previousRuntimeMapping:void 0===previousRuntimeMapping&&void 0===runtimeMappings?parsedRuntimeMappings:runtimeMappings}),setAdvancedRuntimeMappingsConfig(prettySourceConfig),setAdvancedEditorRuntimeMappingsLastApplied(prettySourceConfig),setIsRuntimeMappingsEditorApplyButtonEnabled(!1)},disabled:!isRuntimeMappingsEditorApplyButtonEnabled,"data-test-subj":"mlDataFrameAnalyticsRuntimeMappingsApplyButton"},APPLY_CHANGES_TEXT)))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}))},requiredFieldsErrorText=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.createWizard.requiredFieldsErrorMessage",{defaultMessage:"At least one field must be included in the analysis in addition to the dependent variable."});function getRuntimeDepVarOptions(jobType,runtimeMappings){const runtimeOptions=[];return Object.keys(runtimeMappings).forEach(id=>{const field=runtimeMappings[id];Object(runtime_field_utils.a)(field)&&shouldAddAsDepVarOption(id,field.type,jobType)&&runtimeOptions.push({label:id,key:"runtime_mapping_"+id})}),runtimeOptions}const ConfigurationStepForm=({actions:actions,isClone:isClone,state:state,setCurrentStep:setCurrentStep})=>{const mlContext=Object(ml.b)(),{currentSavedSearch:currentSavedSearch,currentIndexPattern:currentIndexPattern}=mlContext,{savedSearchQuery:savedSearchQuery,savedSearchQueryStr:savedSearchQueryStr}=useSavedSearch(),[loadingFieldOptions,setLoadingFieldOptions]=Object(external_kbnSharedDeps_React_.useState)(!1),[fieldOptionsFetchFail,setFieldOptionsFetchFail]=Object(external_kbnSharedDeps_React_.useState)(!1),[loadingDepVarOptions,setLoadingDepVarOptions]=Object(external_kbnSharedDeps_React_.useState)(!1),[dependentVariableFetchFail,setDependentVariableFetchFail]=Object(external_kbnSharedDeps_React_.useState)(!1),[dependentVariableOptions,setDependentVariableOptions]=Object(external_kbnSharedDeps_React_.useState)([]),[includesTableItems,setIncludesTableItems]=Object(external_kbnSharedDeps_React_.useState)([]),[fetchingExplainData,setFetchingExplainData]=Object(external_kbnSharedDeps_React_.useState)(!1),[maxDistinctValuesError,setMaxDistinctValuesError]=Object(external_kbnSharedDeps_React_.useState)(),[unsupportedFieldsError,setUnsupportedFieldsError]=Object(external_kbnSharedDeps_React_.useState)(),[minimumFieldsRequiredMessage,setMinimumFieldsRequiredMessage]=Object(external_kbnSharedDeps_React_.useState)(),{setEstimatedModelMemoryLimit:setEstimatedModelMemoryLimit,setFormState:setFormState}=actions,{cloneJob:cloneJob,estimatedModelMemoryLimit:estimatedModelMemoryLimit,form:form,isJobCreated:isJobCreated,requestMessages:requestMessages}=state,firstUpdate=Object(external_kbnSharedDeps_React_.useRef)(!0),{dependentVariable:dependentVariable,includes:includes,jobConfigQuery:jobConfigQuery,jobConfigQueryString:jobConfigQueryString,jobType:jobType,modelMemoryLimit:modelMemoryLimit,previousJobType:previousJobType,requiredFieldsError:requiredFieldsError,runtimeMappings:runtimeMappings,previousRuntimeMapping:previousRuntimeMapping,runtimeMappingsUpdated:runtimeMappingsUpdated,sourceIndex:sourceIndex,trainingPercent:trainingPercent,useEstimatedMml:useEstimatedMml}=form,isJobTypeWithDepVar=jobType===analytics.b.REGRESSION||jobType===analytics.b.CLASSIFICATION,dependentVariableEmpty=isJobTypeWithDepVar&&""===dependentVariable,hasBasicRequiredFields=void 0!==jobType,hasRequiredAnalysisFields=isJobTypeWithDepVar&&""!==dependentVariable||jobType===analytics.b.OUTLIER_DETECTION,[query,setQuery]=Object(external_kbnSharedDeps_React_.useState)({query:null!=jobConfigQueryString?jobConfigQueryString:"",language:constants_search.c.KUERY}),toastNotifications=Object(dependency_cache.j)(),indexPreviewProps={...((indexPattern,query,toastNotifications,runtimeMappings)=>{const[indexPatternFields,setIndexPatternFields]=Object(external_kbnSharedDeps_React_.useState)();Object(external_kbnSharedDeps_React_.useEffect)(()=>{!async function(){setErrorMessage(""),setStatus(analytics.e.LOADING);const esSearchRequest={index:indexPattern.title,body:{fields:["*"],_source:!1,query:{function_score:{query:{match_all:{}},random_score:{}}},size:500}};try{const docs=(await ml_api_service.ml.esSearch(esSearchRequest)).hits.hits.map(d=>{var _d$fields;return Object(data_grid.n)(null!==(_d$fields=d.fields)&&void 0!==_d$fields?_d$fields:{})}),allKibanaIndexPatternFields=Object(data_grid.m)(indexPattern),populatedFields=[...new Set(docs.map(Object.keys).flat(1))].filter(d=>allKibanaIndexPatternFields.includes(d)).sort();setStatus(analytics.e.LOADED),setIndexPatternFields(populatedFields)}catch(e){setErrorMessage(Object(util_errors.i)(e)),setStatus(analytics.e.ERROR)}}()},[]);const combinedRuntimeMappings=Object(external_kbnSharedDeps_React_.useMemo)(()=>Object(data_grid.h)(indexPattern,runtimeMappings),[indexPattern,runtimeMappings]),[columns,setColumns]=Object(external_kbnSharedDeps_React_.useState)([]);Object(external_kbnSharedDeps_React_.useEffect)(()=>{Array.isArray(indexPatternFields)&&setColumns([...getIndexPatternColumns(0,indexPatternFields),...combinedRuntimeMappings?getRuntimeFieldColumns(combinedRuntimeMappings):[]])},[indexPattern,indexPatternFields,combinedRuntimeMappings]);const dataGrid=Object(data_grid.q)(columns),{pagination:pagination,resetPagination:resetPagination,setErrorMessage:setErrorMessage,setRowCount:setRowCount,setRowCountRelation:setRowCountRelation,setStatus:setStatus,setTableItems:setTableItems,sortingColumns:sortingColumns,tableItems:tableItems}=dataGrid;Object(external_kbnSharedDeps_React_.useEffect)(()=>{resetPagination()},[JSON.stringify(query)]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{void 0!==indexPatternFields&&void 0!==query&&async function(){setErrorMessage(""),setStatus(analytics.e.LOADING);const sort=sortingColumns.reduce((s,column)=>(s[column.id]={order:column.direction},s),{}),esSearchRequest={index:indexPattern.title,body:{query:query,from:pagination.pageIndex*pagination.pageSize,size:pagination.pageSize,fields:[...null!=indexPatternFields?indexPatternFields:[],...Object(runtime_field_utils.b)(combinedRuntimeMappings)?Object.keys(combinedRuntimeMappings):[]],_source:!1,...Object.keys(sort).length>0?{sort:sort}:{},...Object(runtime_field_utils.b)(combinedRuntimeMappings)?{runtime_mappings:combinedRuntimeMappings}:{}}};try{const resp=await ml_api_service.ml.esSearch(esSearchRequest),docs=resp.hits.hits.map(d=>{var _d$fields2;return Object(data_grid.n)(null!==(_d$fields2=d.fields)&&void 0!==_d$fields2?_d$fields2:{})});setRowCount("number"==typeof resp.hits.total?resp.hits.total:resp.hits.total.value),setRowCountRelation("number"==typeof resp.hits.total?"eq":resp.hits.total.relation),setTableItems(docs),setStatus(analytics.e.LOADED)}catch(e){setErrorMessage(Object(util_errors.i)(e)),setStatus(analytics.e.ERROR)}}()},[indexPattern.title,indexPatternFields,JSON.stringify([query,pagination,sortingColumns,combinedRuntimeMappings])]);const dataLoader=Object(external_kbnSharedDeps_React_.useMemo)(()=>new data_loader_DataLoader(indexPattern,toastNotifications),[indexPattern]);Object(external_kbnSharedDeps_React_.useEffect)(()=>{dataGrid.chartsVisible&&void 0!==query&&async function(fieldHistogramsQuery){try{const columnChartsData=await dataLoader.loadFieldHistograms(columns.filter(cT=>dataGrid.visibleColumns.includes(cT.id)).map(cT=>({fieldName:cT.id,type:Object(data_grid.l)(cT.schema)})),fieldHistogramsQuery,field_histograms.a,combinedRuntimeMappings);dataGrid.setColumnCharts(columnChartsData)}catch(e){Object(data_grid.p)(e,toastNotifications)}}(query)},[dataGrid.chartsVisible,indexPattern.title,JSON.stringify([query,dataGrid.visibleColumns,runtimeMappings])]);const renderCellValue=Object(data_grid.r)(indexPattern,pagination,tableItems);return{...dataGrid,renderCellValue:renderCellValue}})(currentIndexPattern,function(savedSearchQuery,jobConfigQuery){if(void 0!==savedSearchQuery)return null!==savedSearchQuery?savedSearchQuery:jobConfigQuery}(savedSearchQuery,jobConfigQuery),toastNotifications,runtimeMappings),dataTestSubj:"mlAnalyticsCreationDataGrid",toastNotifications:toastNotifications},isStepInvalid=dependentVariableEmpty||void 0===jobType||void 0!==maxDistinctValuesError||void 0!==minimumFieldsRequiredMessage||void 0!==requiredFieldsError||void 0!==unsupportedFieldsError||fetchingExplainData,debouncedGetExplainData=Object(external_kbnSharedDeps_Lodash_.debounce)(async()=>{setFetchingExplainData(!0);const jobTypeChanged=previousJobType!==jobType,shouldUpdateModelMemoryLimit=!(firstUpdate.current&&modelMemoryLimit||!0!==useEstimatedMml),shouldUpdateEstimatedMml=!firstUpdate.current||!modelMemoryLimit||""===estimatedModelMemoryLimit;firstUpdate.current&&(firstUpdate.current=!1),jobTypeChanged&&setLoadingFieldOptions(!0);const depVarIsRuntimeField=isJobTypeWithDepVar&&runtimeMappings&&Object.keys(runtimeMappings).includes(dependentVariable)&&includes.length>0&&!1===includes.includes(dependentVariable);let formToUse=form;depVarIsRuntimeField&&(formToUse=Object(external_kbnSharedDeps_Lodash_.cloneDeep)(form),formToUse.includes=[...includes,dependentVariable]);const{success:success,expectedMemory:expectedMemory,fieldSelection:fieldSelection,errorMessage:errorMessage}=await fetchExplainData(formToUse);if(success){shouldUpdateEstimatedMml&&setEstimatedModelMemoryLimit(expectedMemory);const hasRequiredFields=fieldSelection.some(field=>!0===field.is_included&&!1===field.is_required);jobTypeChanged?(setLoadingFieldOptions(!1),setFieldOptionsFetchFail(!1),setMaxDistinctValuesError(void 0),setUnsupportedFieldsError(void 0),setFormState({...shouldUpdateModelMemoryLimit?{modelMemoryLimit:expectedMemory}:{},requiredFieldsError:hasRequiredFields?void 0:requiredFieldsErrorText,includes:formToUse.includes}),setIncludesTableItems(fieldSelection||[])):setFormState({...shouldUpdateModelMemoryLimit?{modelMemoryLimit:expectedMemory}:{},requiredFieldsError:hasRequiredFields?void 0:requiredFieldsErrorText,includes:formToUse.includes}),setFetchingExplainData(!1)}else{const{maxDistinctValuesErrorMessage:maxDistinctValuesErrorMessage,unsupportedFieldsErrorMessage:unsupportedFieldsErrorMessage,toastNotificationDanger:toastNotificationDanger,toastNotificationWarning:toastNotificationWarning}=handleExplainErrorMessage(errorMessage,sourceIndex,jobType);toastNotificationDanger&&toastNotifications.addDanger(toastNotificationDanger),toastNotificationWarning&&toastNotifications.addWarning(toastNotificationWarning);const fallbackModelMemoryLimit=void 0!==jobType?use_create_analytics_form_state.a[jobType]:use_create_analytics_form_state.a.outlier_detection;setEstimatedModelMemoryLimit(fallbackModelMemoryLimit),setLoadingFieldOptions(!1),setFieldOptionsFetchFail(!0),setMaxDistinctValuesError(maxDistinctValuesErrorMessage),setUnsupportedFieldsError(unsupportedFieldsErrorMessage),setFetchingExplainData(!1),setFormState({...shouldUpdateModelMemoryLimit?{modelMemoryLimit:fallbackModelMemoryLimit}:{}})}},300);Object(external_kbnSharedDeps_React_.useEffect)(()=>{setFormState({sourceIndex:currentIndexPattern.title})},[]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{"string"==typeof savedSearchQueryStr&&setFormState({jobConfigQuery:savedSearchQuery,jobConfigQueryString:savedSearchQueryStr})},[JSON.stringify(savedSearchQuery),savedSearchQueryStr]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{if(isJobTypeWithDepVar){const indexPatternRuntimeFields=Object(data_grid_common.f)(currentIndexPattern);let runtimeOptions;indexPatternRuntimeFields&&(runtimeOptions=getRuntimeDepVarOptions(jobType,indexPatternRuntimeFields)),(async(formState,runtimeOptions=[])=>{setLoadingDepVarOptions(!0),setMaxDistinctValuesError(void 0);try{if(void 0!==currentIndexPattern){const depVarOptions=[];let depVarUpdate=formState.dependentVariable;const{fields:fields}=new_job_capabilities_service_analytics.a;let resetDependentVariable=!0;for(const field of fields)shouldAddAsDepVarOption(field.id,field.type,jobType)&&(depVarOptions.push({label:field.id}),formState.dependentVariable===field.id&&(resetDependentVariable=!1));Object(runtime_field_utils.b)(formState.runtimeMappings)&&Object.keys(formState.runtimeMappings).includes(form.dependentVariable)&&(resetDependentVariable=!1,depVarOptions.push({label:form.dependentVariable,key:"runtime_mapping_"+form.dependentVariable})),resetDependentVariable&&(depVarUpdate=""),setDependentVariableOptions([...runtimeOptions,...depVarOptions]),setLoadingDepVarOptions(!1),setDependentVariableFetchFail(!1),setFormState({dependentVariable:depVarUpdate})}}catch(e){setLoadingDepVarOptions(!1),setDependentVariableFetchFail(!0)}})(form,runtimeOptions)}},[jobType]);const handleRuntimeUpdate=Object(external_kbnSharedDeps_React_.useCallback)(async()=>{if(runtimeMappingsUpdated){let resetDepVar=!1;if(isJobTypeWithDepVar){const filteredOptions=dependentVariableOptions.filter(option=>{var _option$key,_option$key2;return option.label===dependentVariable&&null!==(_option$key=option.key)&&void 0!==_option$key&&_option$key.includes("runtime_mapping")&&(resetDepVar=!0),!(null!==(_option$key2=option.key)&&void 0!==_option$key2&&_option$key2.includes("runtime_mapping"))});if(void 0===runtimeMappings&&!0===runtimeMappingsUpdated)setDependentVariableOptions(filteredOptions);else if(runtimeMappings){const runtimeOptions=getRuntimeDepVarOptions(jobType,runtimeMappings);setDependentVariableOptions([...filteredOptions,...runtimeOptions])}}const updatedIncludes=includes.filter(field=>!(previousRuntimeMapping&&previousRuntimeMapping[field]));if(resetDepVar&&(setFormState({dependentVariable:"",includes:updatedIncludes}),setIncludesTableItems(includesTableItems.filter(({name:name})=>!(previousRuntimeMapping&&previousRuntimeMapping[name])))),!resetDepVar&&hasBasicRequiredFields&&hasRequiredAnalysisFields){const formCopy=Object(external_kbnSharedDeps_Lodash_.cloneDeep)(form),depVarIsRuntimeField=isJobTypeWithDepVar&&runtimeMappings&&Object.keys(runtimeMappings).includes(dependentVariable)&&formCopy.includes.length>0&&!1===formCopy.includes.includes(dependentVariable);formCopy.includes=depVarIsRuntimeField?[...updatedIncludes,dependentVariable]:updatedIncludes;const{success:success,fieldSelection:fieldSelection,errorMessage:errorMessage}=await fetchExplainData(formCopy);if(success){const hasRequiredFields=fieldSelection.some(field=>!0===field.is_included&&!1===field.is_required);let updatedFieldSelection;Object(runtime_field_utils.b)(runtimeMappings)&&(updatedFieldSelection=fieldSelection.map(field=>{var _field$reason;return void 0!==runtimeMappings[field.name]&&!1===field.is_included&&null!==(_field$reason=field.reason)&&void 0!==_field$reason&&_field$reason.includes("field not in includes list")&&(updatedIncludes.push(field.name),field.is_included=!0),field})),setIncludesTableItems(updatedFieldSelection||fieldSelection),setMaxDistinctValuesError(void 0),setUnsupportedFieldsError(void 0),setFormState({includes:updatedIncludes,requiredFieldsError:hasRequiredFields?void 0:requiredFieldsErrorText})}else{const{maxDistinctValuesErrorMessage:maxDistinctValuesErrorMessage,unsupportedFieldsErrorMessage:unsupportedFieldsErrorMessage,toastNotificationDanger:toastNotificationDanger,toastNotificationWarning:toastNotificationWarning}=handleExplainErrorMessage(errorMessage,sourceIndex,jobType);toastNotificationDanger&&toastNotifications.addDanger(toastNotificationDanger),toastNotificationWarning&&toastNotifications.addWarning(toastNotificationWarning),setMaxDistinctValuesError(maxDistinctValuesErrorMessage),setUnsupportedFieldsError(unsupportedFieldsErrorMessage)}}}},[JSON.stringify(runtimeMappings)]);Object(external_kbnSharedDeps_React_.useEffect)(()=>{handleRuntimeUpdate()},[JSON.stringify(runtimeMappings)]),Object(external_kbnSharedDeps_React_.useEffect)(()=>(hasBasicRequiredFields&&hasRequiredAnalysisFields&&debouncedGetExplainData(),()=>{debouncedGetExplainData.cancel()}),[jobType,dependentVariable,trainingPercent,JSON.stringify(includes),jobConfigQueryString]);const scatterplotMatrixProps=Object(external_kbnSharedDeps_React_.useMemo)(()=>({color:isJobTypeWithDepVar?dependentVariable:void 0,fields:includesTableItems.filter(d=>"numerical"===d.feature_type&&d.is_included).map(d=>d.name),index:currentIndexPattern.title,legendType:Object(get_scatterplot_matrix_legend_type.a)(jobType),searchQuery:jobConfigQuery,runtimeMappings:runtimeMappings,indexPattern:currentIndexPattern}),[currentIndexPattern.title,dependentVariable,includesTableItems,isJobTypeWithDepVar,jobConfigQuery,jobType]),showScatterplotMatrix=Object(external_kbnSharedDeps_React_.useMemo)(()=>(jobType===analytics.b.OUTLIER_DETECTION||isJobTypeWithDepVar&&!dependentVariableEmpty)&&scatterplotMatrixProps.fields.length>1,[dependentVariableEmpty,jobType,scatterplotMatrixProps.fields.length]);return void 0===savedSearchQuery?null:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(Messages,{messages:requestMessages}),external_kbnSharedDeps_React_default.a.createElement(SupportedFieldsMessage,{jobType:jobType}),external_kbnSharedDeps_React_default.a.createElement(JobType,{type:jobType,setFormState:setFormState}),null===savedSearchQuery&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.sourceQueryLabel",{defaultMessage:"Query"}),fullWidth:!0},external_kbnSharedDeps_React_default.a.createElement(ExplorationQueryBar,{indexPattern:currentIndexPattern,setSearchQuery:update=>{update.query&&setFormState({jobConfigQuery:update.query,jobConfigQueryString:update.queryString}),setQuery({query:update.queryString,language:update.language})},query:query})),(isClone&&cloneJob||!isClone)&&external_kbnSharedDeps_React_default.a.createElement(RuntimeMappings,{actions:actions,state:state}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,null!==savedSearchQuery&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.savedSearchLabel",{defaultMessage:"Saved search"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBadge,{color:"hollow"},null!==savedSearchQuery?null==currentSavedSearch?void 0:currentSavedSearch.attributes.title:currentIndexPattern.title)),fullWidth:!0},external_kbnSharedDeps_React_default.a.createElement(data_grid.a,indexPreviewProps)),isJobTypeWithDepVar&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{fullWidth:!0,label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.dependentVariableLabel",{defaultMessage:"Dependent variable"}),helpText:0===dependentVariableOptions.length&&!1===dependentVariableFetchFail&&currentIndexPattern&&external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.dependentVariableOptionsNoNumericalFields",{defaultMessage:"No numeric type fields were found for this index pattern."}),isInvalid:void 0!==maxDistinctValuesError,error:[...!0===dependentVariableFetchFail?[external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.dependentVariableOptionsFetchError",{defaultMessage:"There was a problem fetching fields. Please refresh the page and try again."}))]:[],...!0===fieldOptionsFetchFail&&void 0!==maxDistinctValuesError?[external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.dependentVariableMaxDistictValuesError",{defaultMessage:"Invalid. {message}",values:{message:maxDistinctValuesError}}))]:[]]},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiComboBox,{fullWidth:!0,"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.dependentVariableInputAriaLabel",{defaultMessage:"Enter field to be used as dependent variable."}),placeholder:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.dependentVariablePlaceholder",{defaultMessage:"dependent variable"}),isDisabled:isJobCreated,isLoading:loadingDepVarOptions,singleSelection:!0,options:dependentVariableOptions,selectedOptions:dependentVariable?[{label:dependentVariable}]:[],onChange:selectedOptions=>{setFormState({dependentVariable:selectedOptions[0].label||""})},isClearable:!1,isInvalid:""===dependentVariable,"data-test-subj":"mlAnalyticsCreateJobWizardDependentVariableSelect"+(loadingDepVarOptions?" loading":" loaded")}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{fullWidth:!0,isInvalid:void 0!==requiredFieldsError,error:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.requiredFieldsError",{defaultMessage:"Invalid. {message}",values:{message:requiredFieldsError}})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null)),external_kbnSharedDeps_React_default.a.createElement(AnalysisFieldsTable,{dependentVariable:dependentVariable,includes:includes,minimumFieldsRequiredMessage:minimumFieldsRequiredMessage,setMinimumFieldsRequiredMessage:setMinimumFieldsRequiredMessage,tableItems:includesTableItems,unsupportedFieldsError:unsupportedFieldsError,setUnsupportedFieldsError:setUnsupportedFieldsError,loadingItems:loadingFieldOptions,setFormState:setFormState}),showScatterplotMatrix&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{"data-test-subj":"mlAnalyticsCreateJobWizardScatterplotMatrixFormRow",label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.scatterplotMatrixLabel",{defaultMessage:"Scatterplot matrix"}),helpText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.scatterplotMatrixLabelHelpText",{defaultMessage:"Visualizes the relationships between pairs of selected included fields."}),fullWidth:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPanel,{paddingSize:"m","data-test-subj":"mlAnalyticsCreateJobWizardScatterplotMatrixPanel"},external_kbnSharedDeps_React_default.a.createElement(ScatterplotMatrix,scatterplotMatrixProps)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null)),isJobTypeWithDepVar&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{fullWidth:!0,label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.trainingPercentLabel",{defaultMessage:"Training percent"}),helpText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.trainingPercentHelpText",{defaultMessage:"Defines the percentage of eligible documents that will be used for training."})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiRange,{fullWidth:!0,min:analytics.o,max:analytics.n,step:1,showLabels:!0,showRange:!0,showValue:!0,value:trainingPercent,onChange:e=>setFormState({trainingPercent:+e.target.value}),"data-test-subj":"mlAnalyticsCreateJobWizardTrainingPercentSlider"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),external_kbnSharedDeps_React_default.a.createElement(ContinueButton,{isDisabled:isStepInvalid,onClick:()=>{setCurrentStep(ANALYTICS_STEPS.ADVANCED)}}))},ConfigurationStep=({actions:actions,state:state,setCurrentStep:setCurrentStep,step:step,stepActivated:stepActivated,isClone:isClone})=>{const showForm=step===ANALYTICS_STEPS.CONFIGURATION,showDetails=step!==ANALYTICS_STEPS.CONFIGURATION&&!0===stepActivated,dataTestSubj=`mlAnalyticsCreateJobWizardConfigurationStep${showForm?" active":""}${showDetails?" summary":""}`;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiForm,{className:"mlDataFrameAnalyticsCreateForm","data-test-subj":dataTestSubj},showForm&&external_kbnSharedDeps_React_default.a.createElement(ConfigurationStepForm,{actions:actions,isClone:isClone,state:state,setCurrentStep:setCurrentStep}),showDetails&&external_kbnSharedDeps_React_default.a.createElement(ConfigurationStepDetails,{setCurrentStep:setCurrentStep,state:state}))},HyperParameters=({actions:actions,state:state,advancedParamErrors:advancedParamErrors})=>{const{setFormState:setFormState}=actions,{alpha:alpha,downsampleFactor:downsampleFactor,eta:eta,etaGrowthRatePerTree:etaGrowthRatePerTree,featureBagFraction:featureBagFraction,gamma:gamma,lambda:lambda,maxOptimizationRoundsPerHyperparameter:maxOptimizationRoundsPerHyperparameter,maxTrees:maxTrees,softTreeDepthLimit:softTreeDepthLimit,softTreeDepthTolerance:softTreeDepthTolerance}=state.form;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.lambdaLabel",{defaultMessage:"Lambda"}),helpText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.lambdaHelpText",{defaultMessage:"A multiplier of the leaf weights in loss calculations. Must be a nonnegative value."}),isInvalid:void 0!==advancedParamErrors[analytics.a.LAMBDA],error:advancedParamErrors[analytics.a.LAMBDA]},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldNumber,{"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.lambdaInputAriaLabel",{defaultMessage:"A multiplier of leaf weights in loss calculations."}),"data-test-subj":"mlAnalyticsCreateJobFlyoutLambdaInput",onChange:e=>setFormState({lambda:""===e.target.value?void 0:+e.target.value}),step:.001,min:0,value:getNumberValue(lambda)}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.maxTreesLabel",{defaultMessage:"Max trees"}),helpText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.maxTreesText",{defaultMessage:"The maximum number of decision trees in the forest."}),isInvalid:void 0!==advancedParamErrors[analytics.a.MAX_TREES],error:advancedParamErrors[analytics.a.MAX_TREES]},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldNumber,{"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.maxTreesInputAriaLabel",{defaultMessage:"The maximum number of decision trees in the forest."}),"data-test-subj":"mlAnalyticsCreateJobFlyoutMaxTreesInput",onChange:e=>setFormState({maxTrees:""===e.target.value?void 0:+e.target.value}),isInvalid:void 0!==maxTrees&&!Number.isInteger(maxTrees),step:1,min:1,max:2e3,value:getNumberValue(maxTrees)}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.gammaLabel",{defaultMessage:"Gamma"}),helpText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.gammaText",{defaultMessage:"A multiplier of the tree size in loss calcuations. Must be nonnegative value."}),isInvalid:void 0!==advancedParamErrors[analytics.a.GAMMA],error:advancedParamErrors[analytics.a.GAMMA]},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldNumber,{"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.gammaInputAriaLabel",{defaultMessage:"A multiplier of the tree size in loss calculations."}),"data-test-subj":"mlAnalyticsCreateJobWizardGammaInput",onChange:e=>setFormState({gamma:""===e.target.value?void 0:+e.target.value}),step:.001,min:0,value:getNumberValue(gamma)}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.etaLabel",{defaultMessage:"Eta"}),helpText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.etaText",{defaultMessage:"The shrinkage applied to the weights. Must be between 0.001 and 1."}),isInvalid:void 0!==advancedParamErrors[analytics.a.ETA],error:advancedParamErrors[analytics.a.ETA]},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldNumber,{"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.etaInputAriaLabel",{defaultMessage:"The shrinkage applied to the weights."}),"data-test-subj":"mlAnalyticsCreateJobWizardEtaInput",onChange:e=>setFormState({eta:""===e.target.value?void 0:+e.target.value}),step:.001,min:.001,max:1,value:getNumberValue(eta)}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.featureBagFractionLabel",{defaultMessage:"Feature bag fraction"}),helpText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.featureBagFractionText",{defaultMessage:"The fraction of features used when selecting a random bag for each candidate split."}),isInvalid:void 0!==advancedParamErrors[analytics.a.FEATURE_BAG_FRACTION],error:advancedParamErrors[analytics.a.FEATURE_BAG_FRACTION]},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldNumber,{"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.featureBagFractionInputAriaLabel",{defaultMessage:"The fraction of features used when selecting a random bag for each candidate split"}),"data-test-subj":"mlAnalyticsCreateJobWizardFeatureBagFractionInput",onChange:e=>setFormState({featureBagFraction:""===e.target.value?void 0:+e.target.value}),isInvalid:void 0!==featureBagFraction&&(featureBagFraction>1||featureBagFraction<=0),step:.001,max:1,value:getNumberValue(featureBagFraction)}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.alphaLabel",{defaultMessage:"Alpha"}),helpText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.alphaText",{defaultMessage:"A multiplier of the tree depth in loss calculations. Must be greater than or equal to 0."}),isInvalid:void 0!==advancedParamErrors[analytics.a.ALPHA],error:advancedParamErrors[analytics.a.ALPHA]},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldNumber,{"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.alphaInputAriaLabel",{defaultMessage:"A multiplier of the tree depth in loss calculations."}),"data-test-subj":"mlAnalyticsCreateJobWizardAlphaInput",onChange:e=>setFormState({alpha:""===e.target.value?void 0:+e.target.value}),step:.001,min:0,value:getNumberValue(alpha)}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.downsampleFactorLabel",{defaultMessage:"Downsample factor"}),helpText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.downsampleFactorText",{defaultMessage:"The fraction of data used to compute derivatives of the loss function for tree training. Must be between 0 and 1."}),isInvalid:void 0!==advancedParamErrors[analytics.a.DOWNSAMPLE_FACTOR],error:advancedParamErrors[analytics.a.DOWNSAMPLE_FACTOR]},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldNumber,{"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.downsampleFactorInputAriaLabel",{defaultMessage:"The fraction of data used to compute derivatives of the loss function for tree training."}),"data-test-subj":"mlAnalyticsCreateJobWizardDownsampleFactorInput",onChange:e=>setFormState({downsampleFactor:""===e.target.value?void 0:+e.target.value}),step:.001,min:0,max:1,value:getNumberValue(downsampleFactor)}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.etaGrowthRatePerTreeLabel",{defaultMessage:"Eta growth rate per tree"}),helpText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.etaGrowthRatePerTreeText",{defaultMessage:"The rate at which eta increases for each new tree that is added to the forest. Must be between 0.5 and 2."}),isInvalid:void 0!==advancedParamErrors[analytics.a.ETA_GROWTH_RATE_PER_TREE],error:advancedParamErrors[analytics.a.ETA_GROWTH_RATE_PER_TREE]},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldNumber,{"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.etaGrowthRatePerTreeInputAriaLabel",{defaultMessage:"The rate at which eta increases for each new tree that is added to the forest."}),"data-test-subj":"mlAnalyticsCreateJobWizardEtaGrowthRatePerTreeInput",onChange:e=>setFormState({etaGrowthRatePerTree:""===e.target.value?void 0:+e.target.value}),step:.001,min:.5,max:2,value:getNumberValue(etaGrowthRatePerTree)}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.maxOptimizationRoundsPerHyperparameterLabel",{defaultMessage:"Max optimization rounds per hyperparameter"}),helpText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.maxOptimizationRoundsPerHyperparameterText",{defaultMessage:"The maximum number of optimization rounds for each undefined hyperparameter."}),isInvalid:void 0!==advancedParamErrors[analytics.a.MAX_OPTIMIZATION_ROUNDS_PER_HYPERPARAMETER],error:advancedParamErrors[analytics.a.MAX_OPTIMIZATION_ROUNDS_PER_HYPERPARAMETER]},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldNumber,{"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.maxOptimizationRoundsPerHyperparameterInputAriaLabel",{defaultMessage:"The maximum number of optimization rounds for each undefined hyperparameter. Must be an integer between 0 and 20."}),"data-test-subj":"mlAnalyticsCreateJobWizardMaxOptimizationRoundsPerHyperparameterInput",onChange:e=>setFormState({maxOptimizationRoundsPerHyperparameter:""===e.target.value?void 0:+e.target.value}),min:0,max:20,step:1,value:getNumberValue(maxOptimizationRoundsPerHyperparameter)}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.softTreeDepthLimitLabel",{defaultMessage:"Soft tree depth limit"}),helpText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.softTreeDepthLimitText",{defaultMessage:"Decision trees that exceed this depth are penalized in loss calculations. Must be greater than or equal to 0. "}),isInvalid:void 0!==advancedParamErrors[analytics.a.SOFT_TREE_DEPTH_LIMIT],error:advancedParamErrors[analytics.a.SOFT_TREE_DEPTH_LIMIT]},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldNumber,{"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.softTreeDepthLimitInputAriaLabel",{defaultMessage:"Decision trees that exceed this depth are penalized in loss calculations."}),"data-test-subj":"mlAnalyticsCreateJobWizardSoftTreeDepthLimitInput",onChange:e=>setFormState({softTreeDepthLimit:""===e.target.value?void 0:+e.target.value}),step:.001,min:0,value:getNumberValue(softTreeDepthLimit)}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.softTreeDepthToleranceLabel",{defaultMessage:"Soft tree depth tolerance"}),helpText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.softTreeDepthToleranceText",{defaultMessage:"Controls how quickly the loss increases when tree depths exceed soft limits. The smaller the value, the faster the loss increases. Must be greater than or equal to 0.01. "}),isInvalid:void 0!==advancedParamErrors[analytics.a.SOFT_TREE_DEPTH_TOLERANCE],error:advancedParamErrors[analytics.a.SOFT_TREE_DEPTH_TOLERANCE]},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldNumber,{"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.softTreeDepthToleranceInputAriaLabel",{defaultMessage:"Decision trees that exceed this depth are penalized in loss calculations."}),"data-test-subj":"mlAnalyticsCreateJobWizardSoftTreeDepthToleranceInput",onChange:e=>setFormState({softTreeDepthTolerance:""===e.target.value?void 0:+e.target.value}),step:.001,min:.01,value:getNumberValue(softTreeDepthTolerance)}))))};var reducer=__webpack_require__(425);const OutlierHyperParameters=({actions:actions,state:state,advancedParamErrors:advancedParamErrors})=>{const{setFormState:setFormState}=actions,{method:method,nNeighbors:nNeighbors,outlierFraction:outlierFraction,standardizationEnabled:standardizationEnabled}=state.form;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.methodLabel",{defaultMessage:"Method"}),helpText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.methodHelpText",{defaultMessage:"Sets the method that outlier detection uses. If not set, uses an ensemble of different methods, normalizes and combines their individual outlier scores to obtain the overall outlier score. It is recommended to use the ensemble method."}),isInvalid:void 0!==advancedParamErrors[analytics.a.METHOD],error:advancedParamErrors[analytics.a.METHOD]},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSelect,{options:Object.values(analytics.h).map(outlierMethod=>({value:outlierMethod,text:outlierMethod})),value:method,hasNoInitialSelection:!0,onChange:e=>{setFormState({method:e.target.value})},"data-test-subj":"mlAnalyticsCreateJobWizardMethodInput"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.nNeighborsLabel",{defaultMessage:"N neighbors"}),helpText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.nNeighborsHelpText",{defaultMessage:"The value for how many nearest neighbors each method of outlier detection uses to calculate its outlier score. When not set, different values are used for different ensemble members. Must be a positive integer."}),isInvalid:void 0!==advancedParamErrors[analytics.a.N_NEIGHBORS],error:advancedParamErrors[analytics.a.N_NEIGHBORS]},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldNumber,{"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.nNeighborsInputAriaLabel",{defaultMessage:"The value for how many nearest neighbors each method of outlier detection uses to calculate its outlier score."}),"data-test-subj":"mlAnalyticsCreateJobWizardnNeighborsInput",onChange:e=>setFormState({nNeighbors:""===e.target.value?void 0:+e.target.value}),step:1,min:1,value:getNumberValue(nNeighbors)}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.outlierFractionLabel",{defaultMessage:"Outlier fraction"}),helpText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.outlierFractionHelpText",{defaultMessage:"Sets the proportion of the data set that is assumed to be outlying prior to outlier detection."}),isInvalid:void 0!==advancedParamErrors[analytics.a.OUTLIER_FRACTION],error:advancedParamErrors[analytics.a.OUTLIER_FRACTION]},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldNumber,{"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.outlierFractionInputAriaLabel",{defaultMessage:"Sets the proportion of the data set that is assumed to be outlying prior to outlier detection."}),"data-test-subj":"mlAnalyticsCreateJobWizardoutlierFractionInput",onChange:e=>setFormState({outlierFraction:""===e.target.value?void 0:+e.target.value}),step:.001,min:0,max:1,value:getNumberValue(outlierFraction)}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.standardizationEnabledLabel",{defaultMessage:"Standardization enabled"}),helpText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.standardizationEnabledHelpText",{defaultMessage:"If true, the following operation is performed on the columns before computing outlier scores: (x_i - mean(x_i)) / sd(x_i)."})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSelect,{"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.standardizationEnabledInputAriaLabel",{defaultMessage:"Sets standardization enabled setting."}),"data-test-subj":"mlAnalyticsCreateJobWizardStandardizationEnabledInput",options:[{value:"true",text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.standardizationEnabledTrueValue",{defaultMessage:"True"})},{value:"false",text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.standardizationEnabledFalseValue",{defaultMessage:"False"})}],value:standardizationEnabled,hasNoInitialSelection:!0,onChange:e=>{setFormState({standardizationEnabled:e.target.value})}}))))},defaultNumTopClassesOption={label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.allClassesLabel",{defaultMessage:"All classes"}),value:-1},numClassesTypeMessage=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataframe.analytics.create.numTopClassTypeWarning",defaultMessage:"Value must be an integer of -1 or greater, where -1 indicates all classes."});function getTopClassesHelpText(currentNumTopClasses){return-1===currentNumTopClasses?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataframe.analytics.create.numTopClassesHelpText",defaultMessage:"The number of categories for which the predicted probabilities are reported."})," ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataframe.analytics.create.allClassesMessage",defaultMessage:"If you have a large number of classes there could be a significant effect on the size of your destination index."})):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataframe.analytics.create.numTopClassesHelpText",defaultMessage:"The number of categories for which the predicted probabilities are reported."})}function getNumberValue(value){return void 0===value?"":+value}const AdvancedStepForm=({actions:actions,state:state,setCurrentStep:setCurrentStep})=>{var _numTopClassesSelecte;const[advancedParamErrors,setAdvancedParamErrors]=Object(external_kbnSharedDeps_React_.useState)({}),[fetchingAdvancedParamErrors,setFetchingAdvancedParamErrors]=Object(external_kbnSharedDeps_React_.useState)(!1),{services:{docLinks:docLinks}}=Object(contexts_kibana.b)(),classAucRocDocLink=docLinks.links.ml.classificationAucRoc,{setEstimatedModelMemoryLimit:setEstimatedModelMemoryLimit,setFormState:setFormState}=actions,{form:form,isJobCreated:isJobCreated,estimatedModelMemoryLimit:estimatedModelMemoryLimit}=state,{alpha:alpha,computeFeatureInfluence:computeFeatureInfluence,downsampleFactor:downsampleFactor,eta:eta,etaGrowthRatePerTree:etaGrowthRatePerTree,featureBagFraction:featureBagFraction,featureInfluenceThreshold:featureInfluenceThreshold,gamma:gamma,jobType:jobType,lambda:lambda,maxNumThreads:maxNumThreads,maxOptimizationRoundsPerHyperparameter:maxOptimizationRoundsPerHyperparameter,maxTrees:maxTrees,method:method,modelMemoryLimit:modelMemoryLimit,modelMemoryLimitValidationResult:modelMemoryLimitValidationResult,nNeighbors:nNeighbors,numTopClasses:numTopClasses,numTopFeatureImportanceValues:numTopFeatureImportanceValues,numTopFeatureImportanceValuesValid:numTopFeatureImportanceValuesValid,outlierFraction:outlierFraction,predictionFieldName:predictionFieldName,randomizeSeed:randomizeSeed,softTreeDepthLimit:softTreeDepthLimit,softTreeDepthTolerance:softTreeDepthTolerance,useEstimatedMml:useEstimatedMml}=form,[numTopClassesOptions,setNumTopClassesOptions]=Object(external_kbnSharedDeps_React_.useState)([defaultNumTopClassesOption]),[numTopClassesSelectedOptions,setNumTopClassesSelectedOptions]=Object(external_kbnSharedDeps_React_.useState)(function(currentNumTopClasses){const option=[];return-1===currentNumTopClasses?option.push(defaultNumTopClassesOption):void 0!==currentNumTopClasses&&option.push({label:""+currentNumTopClasses}),option}(numTopClasses)),selectedNumTopClasses=numTopClassesSelectedOptions[0]&&(null!==(_numTopClassesSelecte=numTopClassesSelectedOptions[0].value)&&void 0!==_numTopClassesSelecte?_numTopClassesSelecte:Number(numTopClassesSelectedOptions[0].label)),selectedNumTopClassesIsInvalid=void 0!==(currentNumTopClasses=selectedNumTopClasses)&&(isNaN(currentNumTopClasses)||currentNumTopClasses<-1||currentNumTopClasses-Math.floor(currentNumTopClasses)!=0);var currentNumTopClasses;const mmlErrors=Object(external_kbnSharedDeps_React_.useMemo)(()=>Object(reducer.a)(modelMemoryLimitValidationResult),[modelMemoryLimitValidationResult]),isRegOrClassJob=jobType===analytics.b.REGRESSION||jobType===analytics.b.CLASSIFICATION,mmlInvalid=null!==modelMemoryLimitValidationResult&&(void 0!==modelMemoryLimitValidationResult.invalidUnits||!0===modelMemoryLimitValidationResult.required),isStepInvalid=selectedNumTopClassesIsInvalid||mmlInvalid||Object.keys(advancedParamErrors).length>0||!0===fetchingAdvancedParamErrors||0===maxNumThreads;Object(external_kbnSharedDeps_React_.useEffect)(()=>{setFetchingAdvancedParamErrors(!0),async function(){const{success:success,errorMessage:errorMessage,errorReason:errorReason,expectedMemory:expectedMemory}=await fetchExplainData(form),paramErrors={};success?modelMemoryLimit!==expectedMemory&&(setEstimatedModelMemoryLimit(expectedMemory),!0===useEstimatedMml&&setFormState({modelMemoryLimit:expectedMemory})):Object.values(analytics.a).forEach(param=>{errorMessage.includes(`[${param}]`)?paramErrors[param]=errorMessage:null!=errorReason&&errorReason.includes(`[${param}]`)&&(paramErrors[param]=errorReason)}),setFetchingAdvancedParamErrors(!1),setAdvancedParamErrors(paramErrors)}()},[alpha,downsampleFactor,eta,etaGrowthRatePerTree,featureBagFraction,featureInfluenceThreshold,gamma,lambda,maxNumThreads,maxOptimizationRoundsPerHyperparameter,maxTrees,method,nNeighbors,numTopClasses,numTopFeatureImportanceValues,outlierFraction,randomizeSeed,softTreeDepthLimit,softTreeDepthTolerance]);const outlierDetectionAdvancedConfig=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.computeFeatureInfluenceLabel",{defaultMessage:"Compute feature influence"}),helpText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.computeFeatureInfluenceLabelHelpText",{defaultMessage:"Specifies whether the feature influence calculation is enabled. Defaults to true."})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSelect,{"data-test-subj":"mlAnalyticsCreateJobWizardComputeFeatureInfluenceLabelInput",options:[{value:"true",text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.computeFeatureInfluenceTrueValue",{defaultMessage:"True"})},{value:"false",text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.computeFeatureInfluenceFalseValue",{defaultMessage:"False"})}],value:computeFeatureInfluence,hasNoInitialSelection:!1,onChange:e=>{setFormState({computeFeatureInfluence:e.target.value})}}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.featureInfluenceThresholdLabel",{defaultMessage:"Feature influence threshold"}),helpText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.featureInfluenceThresholdHelpText",{defaultMessage:"The minimum outlier score that a document needs to have in order to calculate its feature influence score. Value range: 0-1. Defaults to 0.1."}),isInvalid:void 0!==advancedParamErrors[analytics.a.FEATURE_INFLUENCE_THRESHOLD],error:advancedParamErrors[analytics.a.FEATURE_INFLUENCE_THRESHOLD]},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldNumber,{onChange:e=>setFormState({featureInfluenceThreshold:""===e.target.value?void 0:+e.target.value}),"data-test-subj":"mlAnalyticsCreateJobWizardFeatureInfluenceThresholdInput",min:0,max:1,step:.001,value:getNumberValue(featureInfluenceThreshold)})))),regAndClassAdvancedConfig=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.numTopFeatureImportanceValuesLabel",{defaultMessage:"Feature importance values"}),helpText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.numTopFeatureImportanceValuesHelpText",{defaultMessage:"Specify the maximum number of feature importance values per document to return."}),isInvalid:!1===numTopFeatureImportanceValuesValid,error:[...!1===numTopFeatureImportanceValuesValid?[external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.numTopFeatureImportanceValuesErrorText",{defaultMessage:"Invalid maximum number of feature importance values."}))]:[]]},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldNumber,{"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.numTopFeatureImportanceValuesInputAriaLabel",{defaultMessage:"Maximum number of feature importance values per document."}),"data-test-subj":"mlAnalyticsCreateJobFlyoutnumTopFeatureImportanceValuesInput",isInvalid:!1===numTopFeatureImportanceValuesValid,min:analytics.g,onChange:e=>setFormState({numTopFeatureImportanceValues:""===e.target.value?void 0:+e.target.value}),step:1,value:getNumberValue(numTopFeatureImportanceValues)}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.predictionFieldNameLabel",{defaultMessage:"Prediction field name"}),helpText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.predictionFieldNameHelpText",{defaultMessage:"Defines the name of the prediction field in the results. Defaults to <dependent_variable>_prediction."})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldText,{disabled:isJobCreated,value:predictionFieldName,onChange:e=>setFormState({predictionFieldName:e.target.value}),"data-test-subj":"mlAnalyticsCreateJobWizardPredictionFieldNameInput"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.randomizeSeedLabel",{defaultMessage:"Randomize seed"}),helpText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.randomizeSeedText",{defaultMessage:"The seed for the random generator used to pick training data."}),isInvalid:void 0!==advancedParamErrors[analytics.a.RANDOMIZE_SEED],error:advancedParamErrors[analytics.a.RANDOMIZE_SEED]},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldNumber,{"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.randomizeSeedInputAriaLabel",{defaultMessage:"The seed for the random generator used to pick training data."}),"data-test-subj":"mlAnalyticsCreateJobWizardRandomizeSeedInput",onChange:e=>setFormState({randomizeSeed:""===e.target.value?void 0:+e.target.value}),isInvalid:void 0!==randomizeSeed&&"number"!=typeof randomizeSeed,value:getNumberValue(randomizeSeed),step:1}))));return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("h3",null,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.advancedConfigSectionTitle",{defaultMessage:"Advanced configuration"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGrid,{columns:3},jobType===analytics.b.OUTLIER_DETECTION&&outlierDetectionAdvancedConfig,isRegOrClassJob&&regAndClassAdvancedConfig,jobType===analytics.b.CLASSIFICATION&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.numTopClassesLabel",{defaultMessage:"Top classes"}),helpText:getTopClassesHelpText(selectedNumTopClasses),isInvalid:0===selectedNumTopClasses||selectedNumTopClassesIsInvalid,error:[...0===selectedNumTopClasses?[(elasticUrl=classAucRocDocLink,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataframe.analytics.create.zeroClassesMessage",defaultMessage:"To evaluate the {wikiLink}, select all classes or a value greater than the total number of categories.",values:{wikiLink:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{href:elasticUrl,target:"_blank",external:!0},external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.aucRocLabel",{defaultMessage:"AUC ROC"}))}}))]:[],...selectedNumTopClassesIsInvalid?[numClassesTypeMessage]:[]]},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiComboBox,{"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.numTopClassesInputAriaLabel",{defaultMessage:"The number of categories for which the predicted probabilities are reported"}),singleSelection:!0,options:numTopClassesOptions,selectedOptions:numTopClassesSelectedOptions,onCreateOption:(input,flattenedOptions=[])=>{const normalizedInput=input.trim().toLowerCase();if(""===normalizedInput)return;const newOption={label:input};-1===flattenedOptions.findIndex(option=>option.label.trim().toLowerCase()===normalizedInput)&&setNumTopClassesOptions([...numTopClassesOptions,newOption]),setNumTopClassesSelectedOptions([newOption])},onChange:selectedOptions=>{setNumTopClassesSelectedOptions(selectedOptions)},isClearable:!0,isInvalid:void 0!==selectedNumTopClasses&&selectedNumTopClasses<-1,"data-test-subj":"mlAnalyticsCreateJobWizardnumTopClassesInput"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.modelMemoryLimitLabel",{defaultMessage:"Model memory limit"}),isInvalid:null!==modelMemoryLimitValidationResult,error:mmlErrors,helpText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.modelMemoryLimitHelpText",{defaultMessage:"The approximate maximum amount of memory resources that are permitted for analytical processing."})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldText,{placeholder:void 0!==jobType?use_create_analytics_form_state.a[jobType]:use_create_analytics_form_state.a.outlier_detection,disabled:isJobCreated||useEstimatedMml,value:useEstimatedMml?estimatedModelMemoryLimit:modelMemoryLimit||"",onChange:e=>setFormState({modelMemoryLimit:e.target.value}),isInvalid:null!==modelMemoryLimitValidationResult,"data-test-subj":"mlAnalyticsCreateJobWizardModelMemoryInput"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSwitch,{disabled:isJobCreated,name:"mlDataFrameAnalyticsUseEstimatedMml",label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.useEstimatedMmlLabel",{defaultMessage:"Use estimated model memory limit"}),checked:!0===useEstimatedMml,onChange:()=>setFormState({useEstimatedMml:!useEstimatedMml}),"data-test-subj":"mlAnalyticsCreateJobWizardUseEstimatedMml"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.maxNumThreadsLabel",{defaultMessage:"Maximum number of threads"}),helpText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.maxNumThreadsHelpText",{defaultMessage:"The maximum number of threads to be used by the analysis. The default value is 1."}),isInvalid:0===maxNumThreads,error:0===maxNumThreads&&external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.maxNumThreadsError",{defaultMessage:"The minimum value is 1."})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldNumber,{"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.maxNumThreadsInputAriaLabel",{defaultMessage:"The maximum number of threads to be used by the analysis."}),"data-test-subj":"mlAnalyticsCreateJobWizardMaxNumThreadsInput",min:1,onChange:e=>setFormState({maxNumThreads:""===e.target.value?void 0:+e.target.value}),step:1,value:getNumberValue(maxNumThreads)})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiAccordion,{id:"hyper-parameters",buttonContent:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("h3",null,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.hyperParametersSectionTitle",{defaultMessage:"Hyperparameters"}))),initialIsOpen:!1,"data-test-subj":"mlAnalyticsCreateJobWizardHyperParametersSection"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGrid,{columns:3},jobType===analytics.b.OUTLIER_DETECTION&&external_kbnSharedDeps_React_default.a.createElement(OutlierHyperParameters,{actions:actions,state:state,advancedParamErrors:advancedParamErrors}),isRegOrClassJob&&external_kbnSharedDeps_React_default.a.createElement(HyperParameters,{actions:actions,state:state,advancedParamErrors:advancedParamErrors}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),external_kbnSharedDeps_React_default.a.createElement(ContinueButton,{isDisabled:isStepInvalid,onClick:()=>{setFormState({numTopClasses:!1===selectedNumTopClassesIsInvalid?selectedNumTopClasses:void 0}),setCurrentStep(ANALYTICS_STEPS.DETAILS)}}));var elasticUrl};function getStringValue(value){return"number"==typeof value?""+value:use_create_analytics_form_state.c}const AdvancedStepDetails=({setCurrentStep:setCurrentStep,state:state})=>{const{form:form,isJobCreated:isJobCreated}=state,{computeFeatureInfluence:computeFeatureInfluence,dependentVariable:dependentVariable,eta:eta,featureBagFraction:featureBagFraction,featureInfluenceThreshold:featureInfluenceThreshold,gamma:gamma,jobType:jobType,lambda:lambda,method:method,maxNumThreads:maxNumThreads,maxTrees:maxTrees,modelMemoryLimit:modelMemoryLimit,nNeighbors:nNeighbors,numTopClasses:numTopClasses,numTopFeatureImportanceValues:numTopFeatureImportanceValues,outlierFraction:outlierFraction,predictionFieldName:predictionFieldName,randomizeSeed:randomizeSeed,standardizationEnabled:standardizationEnabled}=form,isRegOrClassJob=jobType===analytics.b.REGRESSION||jobType===analytics.b.CLASSIFICATION,advancedFirstCol=[],advancedSecondCol=[],advancedThirdCol=[],hyperFirstCol=[],hyperSecondCol=[],hyperThirdCol=[];return jobType===analytics.b.OUTLIER_DETECTION&&(advancedFirstCol.push({title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.computeFeatureInfluence",{defaultMessage:"Compute feature influence"}),description:computeFeatureInfluence}),advancedSecondCol.push({title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.featureInfluenceThreshold",{defaultMessage:"Feature influence threshold"}),description:getStringValue(featureInfluenceThreshold)}),advancedThirdCol.push({title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.modelMemoryLimit",{defaultMessage:"Model memory limit"}),description:""+modelMemoryLimit}),hyperFirstCol.push({title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.nNeighbors",{defaultMessage:"N neighbors"}),description:getStringValue(nNeighbors)},{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.outlierFraction",{defaultMessage:"Outlier fraction"}),description:getStringValue(outlierFraction)}),hyperSecondCol.push({title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.method",{defaultMessage:"Method"}),description:void 0!==method?method:use_create_analytics_form_state.c}),hyperThirdCol.push({title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.standardizationEnabled",{defaultMessage:"Standardization enabled"}),description:""+standardizationEnabled})),isRegOrClassJob&&(advancedFirstCol.push({title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.numTopFeatureImportanceValues",{defaultMessage:"Top feature importance values"}),description:""+numTopFeatureImportanceValues}),hyperFirstCol.push({title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.lambdaFields",{defaultMessage:"Lambda"}),description:getStringValue(lambda)},{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.eta",{defaultMessage:"Eta"}),description:getStringValue(eta)}),advancedSecondCol.push({title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.predictionFieldName",{defaultMessage:"Prediction field name"}),description:predictionFieldName||dependentVariable+"_prediction"},{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.randomizedSeed",{defaultMessage:"Randomized seed"}),description:getStringValue(randomizeSeed)}),hyperSecondCol.push({title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.maxTreesFields",{defaultMessage:"Max trees"}),description:getStringValue(maxTrees)},{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.featureBagFraction",{defaultMessage:"Feature bag fraction"}),description:getStringValue(featureBagFraction)}),advancedThirdCol.push({title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.modelMemoryLimit",{defaultMessage:"Model memory limit"}),description:""+modelMemoryLimit}),hyperThirdCol.push({title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.gamma",{defaultMessage:"Gamma"}),description:getStringValue(gamma)})),jobType===analytics.b.CLASSIFICATION&&advancedThirdCol.push({title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.numTopClasses",{defaultMessage:"Top classes"}),description:-1===numTopClasses?external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.allClasses",{defaultMessage:"All classes"}):getStringValue(numTopClasses)}),void 0!==maxNumThreads&&advancedFirstCol.push({title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.maxNumThreads",{defaultMessage:"Maximum number of threads"}),description:""+maxNumThreads}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("h3",null,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.advancedConfigDetailsTitle",{defaultMessage:"Advanced configuration"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{style:{width:"70%"},justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionList,{compressed:!0,listItems:advancedFirstCol})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionList,{compressed:!0,listItems:advancedSecondCol})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionList,{compressed:!0,listItems:advancedThirdCol}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("h3",null,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.hyperParametersDetailsTitle",{defaultMessage:"Hyperparameters"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{style:{width:"70%"},justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionList,{compressed:!0,listItems:hyperFirstCol})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionList,{compressed:!0,listItems:hyperSecondCol})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionList,{compressed:!0,listItems:hyperThirdCol}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),!isJobCreated&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{iconType:"pencil",size:"s",onClick:()=>{setCurrentStep(ANALYTICS_STEPS.ADVANCED)}},external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.advancedDetails.editButtonText",{defaultMessage:"Edit"})))},AdvancedStep=({actions:actions,state:state,step:step,setCurrentStep:setCurrentStep,stepActivated:stepActivated})=>{const showForm=step===ANALYTICS_STEPS.ADVANCED,showDetails=step!==ANALYTICS_STEPS.ADVANCED&&!0===stepActivated,dataTestSubj=`mlAnalyticsCreateJobWizardAdvancedStep${showForm?" active":""}${showDetails?" summary":""}`;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiForm,{"data-test-subj":dataTestSubj},showForm&&external_kbnSharedDeps_React_default.a.createElement(AdvancedStepForm,{actions:actions,state:state,setCurrentStep:setCurrentStep}),showDetails&&external_kbnSharedDeps_React_default.a.createElement(AdvancedStepDetails,{setCurrentStep:setCurrentStep,state:state}))},DetailsStepDetails=({setCurrentStep:setCurrentStep,state:state})=>{const{form:form,isJobCreated:isJobCreated}=state,{description:description,jobId:jobId,destinationIndex:destinationIndex,resultsField:resultsField}=form,detailsFirstCol=[{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.jobId",{defaultMessage:"Job ID"}),description:jobId}];void 0!==resultsField&&"string"==typeof resultsField&&""!==resultsField.trim()&&detailsFirstCol.push({title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.resultsField",{defaultMessage:"Results field"}),description:resultsField});const detailsSecondCol=[{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.jobDescription",{defaultMessage:"Job description"}),description:description}],detailsThirdCol=[{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.destIndex",{defaultMessage:"Destination index"}),description:destinationIndex||""}];return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{style:{width:"70%"},justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionList,{compressed:!0,listItems:detailsFirstCol})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionList,{style:{wordBreak:"break-word"},compressed:!0,listItems:detailsSecondCol})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionList,{compressed:!0,listItems:detailsThirdCol}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),!isJobCreated&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{iconType:"pencil",size:"s",onClick:()=>{setCurrentStep(ANALYTICS_STEPS.DETAILS)}},external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.detailsDetails.editButtonText",{defaultMessage:"Edit"})))},indexNameExistsMessage=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.destinationIndexHelpText",{defaultMessage:"An index with this name already exists. Be aware that running this analytics job will modify this destination index."}),DetailsStepForm=({actions:actions,state:state,setCurrentStep:setCurrentStep})=>{const{services:{docLinks:docLinks,notifications:notifications}}=Object(contexts_kibana.b)(),createIndexLink=docLinks.links.apis.createIndex,{setFormState:setFormState}=actions,{form:form,cloneJob:cloneJob,hasSwitchedToEditor:hasSwitchedToEditor,isJobCreated:isJobCreated}=state,{createIndexPattern:createIndexPattern,description:description,destinationIndex:destinationIndex,destinationIndexNameEmpty:destinationIndexNameEmpty,destinationIndexNameExists:destinationIndexNameExists,destinationIndexNameValid:destinationIndexNameValid,destinationIndexPatternTitleExists:destinationIndexPatternTitleExists,jobId:jobId,jobIdEmpty:jobIdEmpty,jobIdExists:jobIdExists,jobIdInvalidMaxLength:jobIdInvalidMaxLength,jobIdValid:jobIdValid,resultsField:resultsField}=form,[destIndexSameAsId,setDestIndexSameAsId]=Object(external_kbnSharedDeps_React_.useState)(void 0===cloneJob&&!1===hasSwitchedToEditor),[useResultsFieldDefault,setUseResultsFieldDefault]=Object(external_kbnSharedDeps_React_.useState)(void 0===cloneJob&&!1===hasSwitchedToEditor&&void 0===resultsField||void 0!==cloneJob&&"ml"===resultsField),forceInput=Object(external_kbnSharedDeps_React_.useRef)(null),isStepInvalid=!0===jobIdEmpty||!0===jobIdExists||!1===jobIdValid||!0===destinationIndexNameEmpty||!1===destinationIndexNameValid||!0===destinationIndexPatternTitleExists&&!0===createIndexPattern,debouncedIndexCheck=Object(external_kbnSharedDeps_Lodash_.debounce)(async()=>{try{const{exists:exists}=await ml_api_service.ml.checkIndexExists({index:destinationIndex});setFormState({destinationIndexNameExists:exists})}catch(e){notifications.toasts.addDanger(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.errorCheckingIndexExists",{defaultMessage:"The following error occurred getting the existing index names: {error}",values:{error:Object(util_errors.i)(e)}}))}},400),debouncedJobIdCheck=Object(external_kbnSharedDeps_React_.useMemo)(()=>Object(external_kbnSharedDeps_Lodash_.debounce)(async()=>{try{const{results:results}=await ml_api_service.ml.dataFrameAnalytics.jobsExists([jobId],!0);setFormState({jobIdExists:results[jobId]})}catch(e){notifications.toasts.addDanger(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.errorCheckingJobIdExists",{defaultMessage:"The following error occurred checking if job id exists: {error}",values:{error:Object(util_errors.i)(e)}}))}},400),[jobId]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>(!0===jobIdValid?debouncedJobIdCheck():"string"==typeof jobId&&""===jobId.trim()&&!0===jobIdExists&&setFormState({jobIdExists:!1}),()=>{debouncedJobIdCheck.cancel()}),[jobId]),Object(external_kbnSharedDeps_React_.useEffect)(()=>(!0===destinationIndexNameValid?debouncedIndexCheck():"string"==typeof destinationIndex&&""===destinationIndex.trim()&&!0===destinationIndexNameExists&&setFormState({destinationIndexNameExists:!1}),()=>{debouncedIndexCheck.cancel()}),[destinationIndex]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{!0===destIndexSameAsId&&!jobIdEmpty&&jobIdValid?setFormState({destinationIndex:jobId}):!1===destIndexSameAsId&&!1===hasSwitchedToEditor&&setFormState({destinationIndex:""})},[destIndexSameAsId,jobId]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{fullWidth:!0,label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.jobIdLabel",{defaultMessage:"Job ID"}),isInvalid:!jobIdEmpty&&!jobIdValid||jobIdExists||jobIdInvalidMaxLength,error:[...jobIdEmpty||jobIdValid?[]:[external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.jobIdInvalidError",{defaultMessage:"Must contain lowercase alphanumeric characters (a-z and 0-9), hyphens, and underscores only and must start and end with alphanumeric characters."})],...jobIdExists?[external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.jobIdExistsError",{defaultMessage:"An analytics job with this ID already exists."})]:[],...jobIdInvalidMaxLength?[external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.jobIdInvalidMaxLengthErrorMessage",{defaultMessage:"Job ID must be no more than {maxLength, plural, one {# character} other {# characters}} long.",values:{maxLength:constants_validation.b}})]:[]]},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldText,{fullWidth:!0,inputRef:input=>{input&&(forceInput.current=input)},disabled:isJobCreated,placeholder:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.jobIdPlaceholder",{defaultMessage:"Job ID"}),value:jobId,onChange:e=>setFormState({jobId:e.target.value}),"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.jobIdInputAriaLabel",{defaultMessage:"Choose a unique analytics job ID."}),isInvalid:!jobIdEmpty&&!jobIdValid||jobIdExists||jobIdEmpty,"data-test-subj":"mlAnalyticsCreateJobFlyoutJobIdInput"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{fullWidth:!0,label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.jobDescription.label",{defaultMessage:"Job description"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTextArea,{fullWidth:!0,value:description,placeholder:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.jobDescription.helpText",{defaultMessage:"Optional descriptive text"}),rows:2,onChange:e=>{const value=e.target.value;setFormState({description:value})},"data-test-subj":"mlDFAnalyticsJobCreationJobDescription"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{fullWidth:!0,helpText:!0===destIndexSameAsId&&destinationIndexNameExists&&indexNameExistsMessage},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSwitch,{disabled:isJobCreated,name:"mlDataFrameAnalyticsDestIndexSameAsId",label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.DestIndexSameAsIdLabel",{defaultMessage:"Destination index same as job ID"}),checked:!0===destIndexSameAsId,onChange:()=>setDestIndexSameAsId(!destIndexSameAsId),"data-test-subj":"mlAnalyticsCreateJobWizardDestIndexSameAsIdSwitch"})),!1===destIndexSameAsId&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{fullWidth:!0,label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.destinationIndexLabel",{defaultMessage:"Destination index"}),isInvalid:destinationIndexNameEmpty||!destinationIndexNameEmpty&&!destinationIndexNameValid,helpText:destinationIndexNameExists&&indexNameExistsMessage,error:!destinationIndexNameEmpty&&!destinationIndexNameValid&&[external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.destinationIndexInvalidError",{defaultMessage:"Invalid destination index name."}),external_kbnSharedDeps_React_default.a.createElement("br",null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{href:createIndexLink,target:"_blank"},external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.stepDetailsForm.destinationIndexInvalidErrorLink",{defaultMessage:"Learn more about index name limitations."})))]},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldText,{fullWidth:!0,disabled:isJobCreated,placeholder:"destination index",value:destinationIndex,onChange:e=>setFormState({destinationIndex:e.target.value}),"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.destinationIndexInputAriaLabel",{defaultMessage:"Choose a unique destination index name."}),isInvalid:!destinationIndexNameEmpty&&!destinationIndexNameValid,"data-test-subj":"mlAnalyticsCreateJobFlyoutDestinationIndexInput"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{fullWidth:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSwitch,{disabled:isJobCreated,name:"mlDataFrameAnalyticsUseResultsFieldDefault",label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.UseResultsFieldDefaultLabel",{defaultMessage:'Use results field default value "{defaultValue}"',values:{defaultValue:"ml"}}),checked:!0===useResultsFieldDefault,onChange:()=>setUseResultsFieldDefault(!useResultsFieldDefault),"data-test-subj":"mlAnalyticsCreateJobWizardUseResultsFieldDefault"})),!1===useResultsFieldDefault&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{fullWidth:!0,label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.resultsFieldLabel",{defaultMessage:"Results field"}),helpText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.resultsFieldHelpText",{defaultMessage:"Defines the name of the field in which to store the results of the analysis. Defaults to ml."})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldText,{disabled:isJobCreated,placeholder:"results field",value:resultsField,onChange:e=>setFormState({resultsField:e.target.value}),"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.resultsFieldInputAriaLabel",{defaultMessage:"The name of the field in which to store the results of the analysis."}),"data-test-subj":"mlAnalyticsCreateJobWizardResultsFieldInput"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{fullWidth:!0,isInvalid:createIndexPattern&&destinationIndexPatternTitleExists||!createIndexPattern,error:[...createIndexPattern&&destinationIndexPatternTitleExists?[external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.indexPatternExistsError",{defaultMessage:"An index pattern with this title already exists."})]:[],...createIndexPattern?[]:[external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs",color:"warning"},external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.shouldCreateIndexPatternMessage",{defaultMessage:"You may not be able to view job results if an index pattern is not created for the destination index."}))]]},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSwitch,{disabled:isJobCreated,name:"mlDataFrameAnalyticsCreateIndexPattern",label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.createIndexPatternLabel",{defaultMessage:"Create index pattern"}),checked:!0===createIndexPattern,onChange:()=>setFormState({createIndexPattern:!createIndexPattern}),"data-test-subj":"mlAnalyticsCreateJobWizardCreateIndexPatternSwitch"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),external_kbnSharedDeps_React_default.a.createElement(ContinueButton,{isDisabled:isStepInvalid,onClick:()=>{setCurrentStep(ANALYTICS_STEPS.VALIDATION)}}))},DetailsStep=({actions:actions,state:state,setCurrentStep:setCurrentStep,step:step,stepActivated:stepActivated})=>{const showForm=step===ANALYTICS_STEPS.DETAILS,showDetails=step!==ANALYTICS_STEPS.DETAILS&&!0===stepActivated,dataTestSubj=`mlAnalyticsCreateJobWizardDetailsStep${showForm?" active":""}${showDetails?" summary":""}`;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiForm,{className:"mlDataFrameAnalyticsCreateForm","data-test-subj":dataTestSubj},showForm&&external_kbnSharedDeps_React_default.a.createElement(DetailsStepForm,{actions:actions,state:state,setCurrentStep:setCurrentStep}),showDetails&&external_kbnSharedDeps_React_default.a.createElement(DetailsStepDetails,{setCurrentStep:setCurrentStep,state:state}))};function validation_step_extends(){return(validation_step_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const validation_step_ValidationStep=({checksInProgress:checksInProgress,validationMessages:validationMessages,setCurrentStep:setCurrentStep})=>{const callouts=validationMessages.map((m,i)=>external_kbnSharedDeps_React_default.a.createElement(Callout,validation_step_extends({key:`${m.id}_${i}`},m)));return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,checksInProgress&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingSpinner,{size:"xl"}),!checksInProgress&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,callouts,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),external_kbnSharedDeps_React_default.a.createElement(ContinueButton,{isDisabled:!1,onClick:()=>{setCurrentStep(ANALYTICS_STEPS.CREATE)}})))},ValidationStepDetails=({setCurrentStep:setCurrentStep,state:state,validationSummary:validationSummary})=>{const{isJobCreated:isJobCreated}=state,detailsFirstCol=[{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.validatioinDetails.successfulChecks",{defaultMessage:"Successful checks"}),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"xs",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"s"},validationSummary.success)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{type:"check"}))))}],detailsSecondCol=[{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.validatioinDetails.warnings",{defaultMessage:"Warnings"}),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"xs"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"s"},validationSummary.warning)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{type:"alert"}))))}];return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{style:{width:"70%"}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionList,{compressed:!0,listItems:detailsFirstCol})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionList,{style:{wordBreak:"break-word"},compressed:!0,listItems:detailsSecondCol}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),!isJobCreated&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{size:"s",onClick:()=>{setCurrentStep(ANALYTICS_STEPS.VALIDATION)}},external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.validationDetails.viewButtonText",{defaultMessage:"View"})))},ValidationStepWrapper=({state:state,setCurrentStep:setCurrentStep,step:step,stepActivated:stepActivated})=>{const[checksInProgress,setChecksInProgress]=Object(external_kbnSharedDeps_React_.useState)(!1),[validationMessages,setValidationMessages]=Object(external_kbnSharedDeps_React_.useState)([]),[errorMessage,setErrorMessage]=Object(external_kbnSharedDeps_React_.useState)(),{form:form,jobConfig:jobConfig,isAdvancedEditorEnabled:isAdvancedEditorEnabled}=state,{dependentVariable:dependentVariable,jobType:jobType,trainingPercent:trainingPercent,numTopFeatureImportanceValues:numTopFeatureImportanceValues,numTopClasses:numTopClasses,includes:includes}=form,showValidationStep=step===ANALYTICS_STEPS.VALIDATION,showDetails=step!==ANALYTICS_STEPS.VALIDATION&&!0===stepActivated,{dataFrameAnalytics:{validateDataFrameAnalytics:validateDataFrameAnalytics}}=Object(contexts_kibana.a)(),dataTestSubj=`mlAnalyticsCreateJobWizardValidationStepWrapper${showValidationStep?" active":""}${showDetails?" summary":""}`,debouncedValidationChecks=Object(external_kbnSharedDeps_Lodash_.debounce)(async()=>{setChecksInProgress(!0);try{const analyticsJobConfig=isAdvancedEditorEnabled?jobConfig:Object(use_create_analytics_form_state.f)(form),validationResults=await validateDataFrameAnalytics(analyticsJobConfig);setValidationMessages(validationResults),setErrorMessage(void 0),setChecksInProgress(!1)}catch(err){setErrorMessage({heading:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.validation.validationFetchErrorMessage",{defaultMessage:"Error validating job"}),id:"error",status:constants_validation.c.ERROR,text:Object(util_errors.i)(err)}),setChecksInProgress(!1)}},500);Object(external_kbnSharedDeps_React_.useEffect)((function(){void 0===jobType||!showValidationStep&&!0!==stepActivated||debouncedValidationChecks()}),[showValidationStep,dependentVariable,trainingPercent,numTopFeatureImportanceValues,numTopClasses,includes]),void 0!==errorMessage&&validationMessages.push(errorMessage);const validationSummary=Object(external_kbnSharedDeps_React_.useMemo)(()=>validationMessages.reduce((acc,message)=>((null==message?void 0:message.status)===constants_validation.c.WARNING?acc.warning+=1:(null==message?void 0:message.status)===constants_validation.c.SUCCESS&&(acc.success+=1),acc),{warning:0,success:0}),[validationMessages]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiForm,{className:"mlDataFrameAnalyticsCreateForm","data-test-subj":dataTestSubj},showValidationStep&&external_kbnSharedDeps_React_default.a.createElement(validation_step_ValidationStep,{checksInProgress:checksInProgress,validationMessages:validationMessages,setCurrentStep:setCurrentStep}),showDetails&&external_kbnSharedDeps_React_default.a.createElement(ValidationStepDetails,{setCurrentStep:setCurrentStep,state:state,validationSummary:validationSummary}))};function page_extends(){return(page_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}let ANALYTICS_STEPS;!function(ANALYTICS_STEPS){ANALYTICS_STEPS[ANALYTICS_STEPS.CONFIGURATION=0]="CONFIGURATION",ANALYTICS_STEPS[ANALYTICS_STEPS.ADVANCED=1]="ADVANCED",ANALYTICS_STEPS[ANALYTICS_STEPS.DETAILS=2]="DETAILS",ANALYTICS_STEPS[ANALYTICS_STEPS.VALIDATION=3]="VALIDATION",ANALYTICS_STEPS[ANALYTICS_STEPS.CREATE=4]="CREATE"}(ANALYTICS_STEPS||(ANALYTICS_STEPS={}));const analytics_creation_page_Page=({jobId:jobId})=>{const[currentStep,setCurrentStep]=Object(external_kbnSharedDeps_React_.useState)(ANALYTICS_STEPS.CONFIGURATION),[activatedSteps,setActivatedSteps]=Object(external_kbnSharedDeps_React_.useState)([!0,!1,!1,!1,!1]),mlContext=Object(ml.b)(),{currentIndexPattern:currentIndexPattern}=mlContext,createAnalyticsForm=Object(use_create_analytics_form.b)(),{state:state}=createAnalyticsForm,{isAdvancedEditorEnabled:isAdvancedEditorEnabled,disableSwitchToForm:disableSwitchToForm,isJobCreated:isJobCreated}=state,{jobType:jobType}=state.form,{initiateWizard:initiateWizard,setJobClone:setJobClone,switchToAdvancedEditor:switchToAdvancedEditor,switchToForm:switchToForm}=createAnalyticsForm.actions;Object(external_kbnSharedDeps_React_.useEffect)(()=>{initiateWizard(),currentIndexPattern&&async function(){if(void 0!==jobId){const analyticsConfigs=await ml_api_service.ml.dataFrameAnalytics.getDataFrameAnalytics(jobId,!0);if(Array.isArray(analyticsConfigs.data_frame_analytics)&&analyticsConfigs.data_frame_analytics.length>0){const clonedJobConfig=analyticsConfigs.data_frame_analytics[0];await setJobClone(clonedJobConfig)}}}()},[]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{!1===activatedSteps[currentStep]&&(activatedSteps.splice(currentStep,1,!0),setActivatedSteps(activatedSteps))},[currentStep]);const analyticsWizardSteps=[{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.creation.configurationStepTitle",{defaultMessage:"Configuration"}),children:external_kbnSharedDeps_React_default.a.createElement(ConfigurationStep,page_extends({},createAnalyticsForm,{isClone:void 0!==jobId,setCurrentStep:setCurrentStep,step:currentStep,stepActivated:activatedSteps[ANALYTICS_STEPS.CONFIGURATION]})),status:currentStep>=ANALYTICS_STEPS.CONFIGURATION?void 0:"incomplete"},{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.creation.advancedStepTitle",{defaultMessage:"Additional options"}),children:external_kbnSharedDeps_React_default.a.createElement(AdvancedStep,page_extends({},createAnalyticsForm,{setCurrentStep:setCurrentStep,step:currentStep,stepActivated:activatedSteps[ANALYTICS_STEPS.ADVANCED]})),status:currentStep>=ANALYTICS_STEPS.ADVANCED?void 0:"incomplete"},{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.creation.detailsStepTitle",{defaultMessage:"Job details"}),children:external_kbnSharedDeps_React_default.a.createElement(DetailsStep,page_extends({},createAnalyticsForm,{setCurrentStep:setCurrentStep,step:currentStep,stepActivated:activatedSteps[ANALYTICS_STEPS.DETAILS]})),status:currentStep>=ANALYTICS_STEPS.DETAILS?void 0:"incomplete"},{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.creation.validationStepTitle",{defaultMessage:"Validation"}),children:external_kbnSharedDeps_React_default.a.createElement(ValidationStepWrapper,page_extends({},createAnalyticsForm,{setCurrentStep:setCurrentStep,step:currentStep,stepActivated:activatedSteps[ANALYTICS_STEPS.VALIDATION]})),status:currentStep>=ANALYTICS_STEPS.VALIDATION?void 0:"incomplete"},{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.creation.createStepTitle",{defaultMessage:"Create"}),children:external_kbnSharedDeps_React_default.a.createElement(CreateStep,page_extends({},createAnalyticsForm,{step:currentStep})),status:currentStep>=ANALYTICS_STEPS.CREATE?void 0:"incomplete"}];return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPage,{"data-test-subj":"mlAnalyticsCreationContainer"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageBody,{restrictWidth:1200},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageContent,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"column",gutterSize:"none"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"m","data-test-subj":"mlDataFrameAnalyticsWizardHeaderTitle"},external_kbnSharedDeps_React_default.a.createElement("h1",null,void 0===jobId&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataframe.analytics.creationPageTitle",defaultMessage:"Create job"}),void 0!==jobId&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataframe.analytics.clone.creationPageTitle",defaultMessage:"Clone job from {jobId}",values:{jobId:jobId}})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement("h2",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataframe.analytics.creationPageSourceIndexTitle",defaultMessage:"Source index pattern: {indexTitle}",values:{indexTitle:currentIndexPattern.title}}))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{helpText:disableSwitchToForm&&external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.jsonEditorDisabledSwitchText",{defaultMessage:"Configuration contains advanced fields not supported by the form. You cannot switch back to the form."})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSwitch,{disabled:void 0===jobType||disableSwitchToForm||isJobCreated,label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.switchToJsonEditorSwitch",{defaultMessage:"Switch to json editor"}),checked:isAdvancedEditorEnabled,onChange:e=>{!0===e.target.checked?switchToAdvancedEditor():switchToForm()},"data-test-subj":"mlAnalyticsCreateJobWizardAdvancedEditorSwitch"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),!0===isAdvancedEditorEnabled&&external_kbnSharedDeps_React_default.a.createElement(CreateAnalyticsAdvancedEditor,createAnalyticsForm),!1===isAdvancedEditorEnabled&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSteps,{"data-test-subj":"mlAnalyticsCreateJobWizardSteps",steps:analyticsWizardSteps}))))};function analytics_job_creation_extends(){return(analytics_job_creation_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const analyticsJobsCreationRouteFactory=(navigateToPath,basePath)=>({path:"/data_frame_analytics/new_job",render:(props,deps)=>external_kbnSharedDeps_React_default.a.createElement(analytics_job_creation_PageWrapper,analytics_job_creation_extends({},props,{deps:deps})),breadcrumbs:[getBreadcrumbWithUrlForApp("ML_BREADCRUMB",navigateToPath,basePath),{text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataFrameAnalyticsBreadcrumbs.dataFrameManagementLabel",{defaultMessage:"Data Frame Analytics"}),onClick:breadcrumbOnClickFactory("/data_frame_analytics",navigateToPath)}]}),analytics_job_creation_PageWrapper=({location:location,deps:deps})=>{const{index:index,jobId:jobId,savedSearchId:savedSearchId}=Object(query_string.parse)(location.search,{sort:!1}),{context:context}=useResolver(index,savedSearchId,deps.config,{...basicResolvers(deps),analyticsFields:()=>loadNewJobCapabilities(index,savedSearchId,deps.indexPatterns,"data-frame-analytics")});return external_kbnSharedDeps_React_default.a.createElement(PageLoader,{context:context},external_kbnSharedDeps_React_default.a.createElement(analytics_creation_page_Page,{jobId:jobId}))};function models_list_extends(){return(models_list_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const modelsListRouteFactory=(navigateToPath,basePath)=>({path:"/data_frame_analytics/models",render:(props,deps)=>external_kbnSharedDeps_React_default.a.createElement(models_list_PageWrapper,models_list_extends({},props,{deps:deps})),breadcrumbs:[getBreadcrumbWithUrlForApp("ML_BREADCRUMB",navigateToPath,basePath),getBreadcrumbWithUrlForApp("DATA_FRAME_ANALYTICS_BREADCRUMB",navigateToPath,basePath),{text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataFrameAnalyticsBreadcrumbs.modelsListLabel",{defaultMessage:"Model Management"}),href:""}]}),models_list_PageWrapper=({location:location,deps:deps})=>{const{context:context}=useResolver(void 0,void 0,deps.config,basicResolvers(deps));return external_kbnSharedDeps_React_default.a.createElement(PageLoader,{context:context},external_kbnSharedDeps_React_default.a.createElement(analytics_management_page.a,null))};function analytics_map_extends(){return(analytics_map_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const analyticsMapRouteFactory=(navigateToPath,basePath)=>({path:"/data_frame_analytics/map",render:(props,deps)=>external_kbnSharedDeps_React_default.a.createElement(analytics_map_PageWrapper,analytics_map_extends({},props,{deps:deps})),breadcrumbs:[getBreadcrumbWithUrlForApp("ML_BREADCRUMB",navigateToPath,basePath),getBreadcrumbWithUrlForApp("DATA_FRAME_ANALYTICS_BREADCRUMB",navigateToPath,basePath),{text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataFrameAnalyticsBreadcrumbs.analyticsMapLabel",{defaultMessage:"Analytics Map"}),href:""}]}),analytics_map_PageWrapper=({deps:deps})=>{const{context:context}=useResolver(void 0,void 0,deps.config,basicResolvers(deps));return external_kbnSharedDeps_React_default.a.createElement(PageLoader,{context:context},external_kbnSharedDeps_React_default.a.createElement(analytics_management_page.a,null))};var usePrevious=__webpack_require__(765),usePrevious_default=__webpack_require__.n(usePrevious),external_kbnSharedDeps_MomentTimezone_=__webpack_require__(48),external_kbnSharedDeps_MomentTimezone_default=__webpack_require__.n(external_kbnSharedDeps_MomentTimezone_),annotation_flyout=__webpack_require__(287),annotations_table=__webpack_require__(294),date_utils=__webpack_require__(72),metric_change_description=__webpack_require__(231);function DescriptionCell({actual:actual,typical:typical}){const{iconType:iconType,message:message}=Object(metric_change_description.a)(actual,typical);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},void 0!==iconType&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{type:iconType,size:"s"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs"},message)))}function DetectorCell({detectorDescription:detectorDescription,numberOfRules:numberOfRules}){let rulesIcon;return void 0!==numberOfRules&&numberOfRules>0&&(rulesIcon=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{content:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.anomaliesTable.detectorCell.rulesConfiguredTooltip",defaultMessage:"rules have been configured for this detector"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{type:"controlsHorizontal",className:"detector-rules-icon"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,detectorDescription,rulesIcon)}var entity_control=__webpack_require__(185),anomaly_utils=__webpack_require__(6);function getAddFilter({entityName:entityName,entityValue:entityValue,filter:filter}){if(void 0!==filter)return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{content:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.anomaliesTable.entityCell.addFilterTooltip",defaultMessage:"Add filter"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{size:"s",className:"filter-button",onClick:()=>filter(entityName,entityValue,anomaly_utils.a.ADD),iconType:"plusInCircle","aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.anomaliesTable.entityCell.addFilterAriaLabel",{defaultMessage:"Add filter"})}))}function getRemoveFilter({entityName:entityName,entityValue:entityValue,filter:filter}){if(void 0!==filter)return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{content:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.anomaliesTable.entityCell.removeFilterTooltip",defaultMessage:"Remove filter"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{size:"s",className:"filter-button",onClick:()=>filter(entityName,entityValue,anomaly_utils.a.REMOVE),iconType:"minusInCircle","aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.anomaliesTable.entityCell.removeFilterAriaLabel",{defaultMessage:"Remove filter"})}))}const EntityCell=({entityName:entityName,entityValue:entityValue,filter:filter,wrapText:wrapText=!1})=>{let valueText=""===entityValue?external_kbnSharedDeps_React_default.a.createElement("i",null,entity_control.a):entityValue;entityName===field_types.b&&(valueText=`${field_types.b} ${valueText}`);const textStyle={maxWidth:"100%"},textWrapperClass=wrapText?"field-value-long":"field-value-short",shouldDisplayIcons=void 0!==filter&&void 0!==entityName&&void 0!==entityValue;return!0===wrapText?external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement("span",{className:textWrapperClass},valueText),shouldDisplayIcons&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,getAddFilter({entityName:entityName,entityValue:entityValue,filter:filter}),getRemoveFilter({entityName:entityName,entityValue:entityValue,filter:filter}))):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"row",alignItems:"center",gutterSize:"none"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,style:textStyle},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs",className:textWrapperClass},valueText)),shouldDisplayIcons&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"row",alignItems:"center",gutterSize:"none"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},getAddFilter({entityName:entityName,entityValue:entityValue,filter:filter})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},getRemoveFilter({entityName:entityName,entityValue:entityValue,filter:filter})))))};class influencers_cell_InfluencersCell extends external_kbnSharedDeps_React_.Component{constructor(props){super(props),this.state={showAll:!1}}toggleAllInfluencers(){this.setState({showAll:!this.state.showAll})}renderInfluencers(influencers){const numberToDisplay=!1===this.state.showAll?this.props.limit:influencers.length,displayInfluencers=influencers.slice(0,numberToDisplay),{influencerFilter:influencerFilter}=this.props;let othersCount=Math.max(influencers.length-numberToDisplay,0);1===othersCount&&(displayInfluencers.push(influencers[this.props.limit]),othersCount=0);const displayRows=displayInfluencers.map((influencer,index)=>external_kbnSharedDeps_React_default.a.createElement("div",{key:index},influencer.influencerFieldName,": ",influencer.influencerFieldValue,void 0!==influencerFilter&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{content:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.anomaliesTable.influencersCell.addFilterTooltip",defaultMessage:"Add filter"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{size:"s",className:"filter-button",onClick:()=>influencerFilter(influencer.influencerFieldName,influencer.influencerFieldValue,"+"),iconType:"plusInCircle","aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.anomaliesTable.influencersCell.addFilterAriaLabel",{defaultMessage:"Add filter"})})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{content:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.anomaliesTable.influencersCell.removeFilterTooltip",defaultMessage:"Remove filter"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{size:"s",className:"filter-button",onClick:()=>influencerFilter(influencer.influencerFieldName,influencer.influencerFieldValue,"-"),iconType:"minusInCircle","aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.anomaliesTable.influencersCell.removeFilterAriaLabel",{defaultMessage:"Remove filter"})})))));return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,displayRows,this.renderOthers(influencers.length,othersCount))}renderOthers(totalCount,othersCount){return othersCount>0?external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{onClick:()=>this.toggleAllInfluencers()},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.anomaliesTable.influencersCell.moreInfluencersLinkText",defaultMessage:"and {othersCount} more",values:{othersCount:othersCount}}))):totalCount>this.props.limit+1?external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{onClick:()=>this.toggleAllInfluencers()},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.anomaliesTable.influencersCell.showLessInfluencersLinkText",defaultMessage:"show less"}))):void 0}render(){const recordInfluencers=this.props.influencers||[],influencers=[];return recordInfluencers.forEach(influencer=>{Object(external_kbnSharedDeps_Lodash_.each)(influencer,(influencerFieldValue,influencerFieldName)=>{influencers.push({influencerFieldName:influencerFieldName,influencerFieldValue:influencerFieldValue})})}),external_kbnSharedDeps_React_default.a.createElement("div",null,this.renderInfluencers(influencers),this.renderOthers(influencers))}}var external_kbnSharedDeps_RisonNode_=__webpack_require__(51),external_kbnSharedDeps_RisonNode_default=__webpack_require__.n(external_kbnSharedDeps_RisonNode_),parse_interval=__webpack_require__(26);var custom_url_utils=__webpack_require__(151);function links_menu_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class links_menu_LinksMenuUI extends external_kbnSharedDeps_React_.Component{constructor(props){super(props),links_menu_defineProperty(this,"openCustomUrl",customUrl=>{const{anomaly:anomaly,interval:interval,isAggregatedData:isAggregatedData}=this.props;console.log("Anomalies Table - open customUrl for record:",anomaly);const record=Object(external_kbnSharedDeps_Lodash_.cloneDeep)(anomaly.source),timestamp=record.timestamp,configuredUrlValue=customUrl.url_value,timeRangeInterval=Object(parse_interval.a)(customUrl.time_range),basePath=this.props.kibana.services.http.basePath.get();if(configuredUrlValue.includes("$earliest$")){let earliestMoment=external_kbnSharedDeps_Moment_default()(timestamp);null!==timeRangeInterval?earliestMoment.subtract(timeRangeInterval):(earliestMoment=external_kbnSharedDeps_Moment_default()(timestamp).startOf(interval),"hour"===interval&&earliestMoment.subtract(1,"h")),record.earliest=earliestMoment.toISOString()}if(configuredUrlValue.includes("$latest$")){let latestMoment=external_kbnSharedDeps_Moment_default()(timestamp).add(record.bucket_span,"s");null!==timeRangeInterval?latestMoment.add(timeRangeInterval):!0===isAggregatedData&&(latestMoment=external_kbnSharedDeps_Moment_default()(timestamp).endOf(interval),"hour"===interval&&latestMoment.add(1,"h")),record.latest=latestMoment.toISOString()}if((configuredUrlValue.includes("$mlcategoryterms$")||configuredUrlValue.includes("$mlcategoryregex$"))&&void 0!==record.mlcategory){const jobId=record.job_id,categoryId=record.mlcategory[0];ml_api_service.ml.results.getCategoryDefinition(jobId,categoryId).then(resp=>{const termsArray=resp.terms.split(" ").map(term=>"+"+term);record.mlcategoryterms=termsArray.join(" "),record.mlcategoryregex=resp.regex;const urlPath=Object(string_utils.e)(customUrl.url_value,record,!0);Object(custom_url_utils.d)(urlPath,customUrl,basePath)}).catch(resp=>{console.log("openCustomUrl(): error loading categoryDefinition:",resp);const{toasts:toasts}=this.props.kibana.services.notifications;toasts.addDanger(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.anomaliesTable.linksMenu.unableToOpenLinkErrorMessage",{defaultMessage:"Unable to open link as an error occurred loading details on category ID {categoryId}",values:{categoryId:categoryId}}))})}else{const urlPath=Object(custom_url_utils.a)(customUrl,record);Object(custom_url_utils.d)(urlPath,customUrl,basePath)}}),links_menu_defineProperty(this,"viewSeries",async()=>{const{services:{share:{urlGenerators:{getUrlGenerator:getUrlGenerator}}}}=this.props.kibana,mlUrlGenerator=getUrlGenerator(ml_url_generator.a),record=this.props.anomaly.source,bounds=this.props.bounds,from=bounds.min.toISOString(),to=bounds.max.toISOString(),recordTime=external_kbnSharedDeps_Moment_default()(record.timestamp),zoomFrom=recordTime.subtract(50*record.bucket_span,"s").toISOString(),zoomTo=recordTime.add(100*record.bucket_span,"s").toISOString(),entityCondition={};void 0!==record.partition_field_value&&(entityCondition[record.partition_field_name]=record.partition_field_value),void 0!==record.over_field_value&&(entityCondition[record.over_field_name]=record.over_field_value),void 0!==record.by_field_value&&(entityCondition[record.by_field_name]=record.by_field_value);const singleMetricViewerLink=await mlUrlGenerator.createUrl({excludeBasePath:!1,page:ml_url_generator.b.SINGLE_METRIC_VIEWER,pageState:{jobIds:[record.job_id],refreshInterval:{display:"Off",pause:!0,value:0},timeRange:{from:from,to:to,mode:"absolute"},zoom:{from:zoomFrom,to:zoomTo},detectorIndex:record.detector_index,entities:entityCondition,query_string:{analyze_wildcard:!0,query:"*"}}});window.open(singleMetricViewerLink,"_blank")}),links_menu_defineProperty(this,"viewExamples",()=>{const categoryId=this.props.anomaly.entityValue,record=this.props.anomaly.source,job=job_service.a.getJob(this.props.anomaly.jobId);if(void 0===job){console.log("viewExamples(): no job found with ID: "+this.props.anomaly.jobId);const{toasts:toasts}=this.props.kibana.services.notifications;return void toasts.addDanger(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.anomaliesTable.linksMenu.unableToViewExamplesErrorMessage",{defaultMessage:"Unable to view examples as no details could be found for job ID {jobId}",values:{jobId:this.props.anomaly.jobId}}))}const categorizationFieldName=job.analysis_config.categorization_field_name,datafeedIndices=job.datafeed_config.indices;let i=0;!function findFieldType(index){(function(index,fieldName){return new Promise((resolve,reject)=>{""!==index?ml_api_service.ml.getFieldCaps({index:index,fields:[fieldName]}).then(resp=>{let fieldType="";Object(external_kbnSharedDeps_Lodash_.each)(resp.fields,field=>{Object(external_kbnSharedDeps_Lodash_.each)(field,type=>{""===fieldType&&(fieldType=type.type)})}),resolve(fieldType)}).catch(error=>{reject(error)}):reject()})})(index,categorizationFieldName).then(resp=>{""!==resp?createAndOpenUrl(index,resp):(i++,i<datafeedIndices.length?findFieldType(datafeedIndices[i]):error())}).catch(()=>{error()})}(datafeedIndices[i]);const error=()=>{console.log(`viewExamples(): error finding type of field ${categorizationFieldName} in indices:`,datafeedIndices);const{toasts:toasts}=this.props.kibana.services.notifications;toasts.addDanger(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.anomaliesTable.linksMenu.noMappingCouldBeFoundErrorMessage",{defaultMessage:"Unable to view examples of documents with mlcategory {categoryId} as no mapping could be found for the categorization field {categorizationFieldName}",values:{categoryId:categoryId,categorizationFieldName:categorizationFieldName}}))},createAndOpenUrl=(index,categorizationFieldType)=>{const indexPatternId=Object(index_utils.c)(index)||index;ml_api_service.ml.results.getCategoryDefinition(record.job_id,categoryId).then(resp=>{let query=null;if(categorizationFieldType===data_public_.ES_FIELD_TYPES.KEYWORD)resp.regex&&(query={language:constants_search.c.LUCENE,query:`${categorizationFieldName}:/${resp.regex}/`});else if(resp.terms){const escapedTerms=Object(explorer_utils.b)(resp.terms);query={language:constants_search.c.KUERY,query:categorizationFieldName+':"'+escapedTerms.split(" ").join(`" and ${categorizationFieldName}:"`)+'"'}}const recordTime=external_kbnSharedDeps_Moment_default()(record.timestamp),from=recordTime.toISOString(),to=recordTime.add(record.bucket_span,"s").toISOString(),_g=external_kbnSharedDeps_RisonNode_default.a.encode({refreshInterval:{display:"Off",pause:!0,value:0},time:{from:from,to:to,mode:"absolute"}}),appStateProps={index:indexPatternId,filters:[]};null!==query&&(appStateProps.query=query);const _a=external_kbnSharedDeps_RisonNode_default.a.encode(appStateProps),{basePath:basePath}=this.props.kibana.services.http;let path=basePath.get();path+="/app/discover#/",path+="?_g="+_g,path+="&_a="+encodeURIComponent(_a),window.open(path,"_blank")}).catch(resp=>{console.log("viewExamples(): error loading categoryDefinition:",resp);const{toasts:toasts}=this.props.kibana.services.notifications;toasts.addDanger(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.anomaliesTable.linksMenu.loadingDetailsErrorMessage",{defaultMessage:"Unable to view examples as an error occurred loading details on category ID {categoryId}",values:{categoryId:categoryId}}))})}}),links_menu_defineProperty(this,"onButtonClick",()=>{this.setState(prevState=>({isPopoverOpen:!prevState.isPopoverOpen}))}),links_menu_defineProperty(this,"closePopover",()=>{this.setState({isPopoverOpen:!1})}),this.state={isPopoverOpen:!1,toasts:[]}}render(){const{anomaly:anomaly,showViewSeriesLink:showViewSeriesLink}=this.props,canConfigureRules=Object(anomaly_utils.m)(anomaly.source)&&Object(check_capabilities.e)("canUpdateJob"),button=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{size:"s",color:"text",onClick:this.onButtonClick,iconType:"gear","aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.anomaliesTable.linksMenu.selectActionAriaLabel",{defaultMessage:"Select action for anomaly at {time}",values:{time:Object(date_utils.c)(anomaly.time)}}),"data-test-subj":"mlAnomaliesListRowActionsButton"}),items=[];return void 0!==anomaly.customUrls&&anomaly.customUrls.forEach((customUrl,index)=>{items.push(external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenuItem,{key:"custom_url_"+index,icon:"popout",onClick:()=>{this.closePopover(),this.openCustomUrl(customUrl)},"data-test-subj":"mlAnomaliesListRowActionCustomUrlButton_"+index},customUrl.url_name))}),!0===showViewSeriesLink&&!0===anomaly.isTimeSeriesViewRecord&&items.push(external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenuItem,{key:"view_series",icon:"visLine",onClick:()=>{this.closePopover(),this.viewSeries()},"data-test-subj":"mlAnomaliesListRowActionViewSeriesButton"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.anomaliesTable.linksMenu.viewSeriesLabel",defaultMessage:"View series"}))),"mlcategory"===anomaly.entityName&&items.push(external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenuItem,{key:"view_examples",icon:"popout",onClick:()=>{this.closePopover(),this.viewExamples()},"data-test-subj":"mlAnomaliesListRowActionViewExamplesButton"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.anomaliesTable.linksMenu.viewExamplesLabel",defaultMessage:"View examples"}))),canConfigureRules&&items.push(external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenuItem,{key:"create_rule",icon:"controlsHorizontal",onClick:()=>{this.closePopover(),this.props.showRuleEditorFlyout(anomaly)},"data-test-subj":"mlAnomaliesListRowActionConfigureRulesButton"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.anomaliesTable.linksMenu.configureRulesLabel",defaultMessage:"Configure job rules"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopover,{button:button,isOpen:this.state.isPopoverOpen,closePopover:this.closePopover,panelPaddingSize:"none",anchorPosition:"downLeft"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenuPanel,{items:items,"data-test-subj":"mlAnomaliesListRowActionsMenu"}))}}const LinksMenu=Object(kibanaReact_public_.withKibana)(links_menu_LinksMenuUI);var field_format_service=__webpack_require__(132);const ANOMALIES_TABLE_TABS_DETAILS=0,ANOMALIES_TABLE_TABS_CATEGORY_EXAMPLES=1;var multi_bucket_impact=__webpack_require__(12);const SeverityCell=Object(external_kbnSharedDeps_React_.memo)(({score:score,multiBucketImpact:multiBucketImpact})=>{const severity=Object(anomaly_utils.g)(score),color=Object(anomaly_utils.j)(score);return multiBucketImpact>=multi_bucket_impact.a.MEDIUM?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"xs",alignItems:"center",responsive:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement("svg",{width:"16",height:"16",viewBox:"-2 -2 20 20",fill:color},external_kbnSharedDeps_React_default.a.createElement("path",{d:"M-6.708203932499369,-2.23606797749979H-2.23606797749979V-6.708203932499369H2.23606797749979V-2.23606797749979H6.708203932499369V2.23606797749979H2.23606797749979V6.708203932499369H-2.23606797749979V2.23606797749979H-6.708203932499369Z",transform:"translate(8,8)"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},severity)):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHealth,{color:color},severity)});function showLinksMenuForItem(item,showViewSeriesLink){return Object(anomaly_utils.m)(item.source)&&Object(check_capabilities.e)("canUpdateJob")||showViewSeriesLink&&item.isTimeSeriesViewRecord||"mlcategory"===item.entityName||void 0!==item.customUrls}function anomalies_table_columns_getColumns(items,jobIds,examplesByJobId,isAggregatedData,interval,bounds,showViewSeriesLink,showRuleEditorFlyout,itemIdToExpandedRowMap,toggleRow,filter,influencerFilter){const columns=[{name:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiScreenReaderOnly,null,external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.anomaliesTable.showDetailsColumn.screenReaderDescription",defaultMessage:"This column contains clickable controls for showing more details on each anomaly"}))),render:item=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{onClick:()=>toggleRow(item),iconType:itemIdToExpandedRowMap[item.rowId]?"arrowDown":"arrowRight","aria-label":itemIdToExpandedRowMap[item.rowId]?external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.anomaliesTable.hideDetailsAriaLabel",{defaultMessage:"Hide details"}):external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.anomaliesTable.showDetailsAriaLabel",{defaultMessage:"Show details"}),"data-row-id":item.rowId,"data-test-subj":"mlJobListRowDetailsToggle"})},{field:"time","data-test-subj":"mlAnomaliesListColumnTime",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.anomaliesTable.timeColumnName",{defaultMessage:"Time"}),dataType:"date",scope:"row",render:date=>function(date,aggregationInterval){return"hour"===aggregationInterval?Object(date_utils.b)(date):"second"===aggregationInterval?Object(date_utils.c)(date):Object(date_utils.a)(date)}(date,interval),textOnly:!0,sortable:!0},{field:"severity","data-test-subj":"mlAnomaliesListColumnSeverity",name:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{content:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.overview.anomalyDetection.tableSeverityTooltip",{defaultMessage:"A normalized score between 0-100, which indicates the relative significance of the anomaly record results."})},external_kbnSharedDeps_React_default.a.createElement("span",null,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.anomaliesTable.severityColumnName",{defaultMessage:"Severity"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{size:"s",color:"subdued",type:"questionInCircle",className:"eui-alignTop"}))),render:(score,item)=>external_kbnSharedDeps_React_default.a.createElement(SeverityCell,{score:score,multiBucketImpact:item.source.multi_bucket_impact}),sortable:!0},{field:"detector","data-test-subj":"mlAnomaliesListColumnDetector",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.anomaliesTable.detectorColumnName",{defaultMessage:"Detector"}),render:(detectorDescription,item)=>external_kbnSharedDeps_React_default.a.createElement(DetectorCell,{detectorDescription:detectorDescription,numberOfRules:item.rulesLength}),textOnly:!0,sortable:!0}];if(items.some(item=>void 0!==item.entityValue)&&columns.push({field:"entityValue","data-test-subj":"mlAnomaliesListColumnFoundFor",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.anomaliesTable.entityValueColumnName",{defaultMessage:"Found for"}),render:(entityValue,item)=>external_kbnSharedDeps_React_default.a.createElement(EntityCell,{entityName:item.entityName,entityValue:entityValue,filter:filter,wrapText:!0}),textOnly:!0,sortable:!0}),items.some(item=>void 0!==item.influencers)&&columns.push({field:"influencers","data-test-subj":"mlAnomaliesListColumnInfluencers",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.anomaliesTable.influencersColumnName",{defaultMessage:"Influenced by"}),render:influencers=>external_kbnSharedDeps_React_default.a.createElement(influencers_cell_InfluencersCell,{limit:5,influencers:influencers,influencerFilter:influencerFilter}),textOnly:!0,sortable:!0}),items.some(item=>void 0!==item.actual)&&columns.push({field:"actualSort","data-test-subj":"mlAnomaliesListColumnActual",name:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{content:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.overview.anomalyDetection.tableActualTooltip",{defaultMessage:"The actual values in the anomaly record results."})},external_kbnSharedDeps_React_default.a.createElement("span",null,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.anomaliesTable.actualSortColumnName",{defaultMessage:"Actual"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{size:"s",color:"subdued",type:"questionInCircle",className:"eui-alignTop"}))),render:(actual,item)=>{const fieldFormat=field_format_service.a.getFieldFormat(item.jobId,item.source.detector_index);return Object(format_value.b)(item.actual,item.source.function,fieldFormat,item.source)},sortable:!0}),items.some(item=>void 0!==item.typical)){columns.push({field:"typicalSort","data-test-subj":"mlAnomaliesListColumnTypical",name:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{content:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.overview.anomalyDetection.tableTypicalTooltip",{defaultMessage:"The typical values in the anomaly record results."})},external_kbnSharedDeps_React_default.a.createElement("span",null,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.anomaliesTable.typicalSortColumnName",{defaultMessage:"Typical"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{size:"s",color:"subdued",type:"questionInCircle",className:"eui-alignTop"}))),render:(typical,item)=>{const fieldFormat=field_format_service.a.getFieldFormat(item.jobId,item.source.detector_index);return Object(format_value.b)(item.typical,item.source.function,fieldFormat,item.source)},sortable:!0});!0===items.some(item=>{const summaryRecFunc=item.source.function;return"time_of_day"!==summaryRecFunc&&"time_of_week"!==summaryRecFunc})&&columns.push({field:"metricDescriptionSort","data-test-subj":"mlAnomaliesListColumnDescription",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.anomaliesTable.metricDescriptionSortColumnName",{defaultMessage:"Description"}),render:(metricDescriptionSort,item)=>external_kbnSharedDeps_React_default.a.createElement(DescriptionCell,{actual:item.actual,typical:item.typical}),textOnly:!0,sortable:!0})}jobIds&&jobIds.length>1&&columns.push({field:"jobId","data-test-subj":"mlAnomaliesListColumnJobID",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.anomaliesTable.jobIdColumnName",{defaultMessage:"Job ID"}),sortable:!0});!0===items.some(item=>"mlcategory"===item.entityName)&&columns.push({"data-test-subj":"mlAnomaliesListColumnCategoryExamples",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.anomaliesTable.categoryExamplesColumnName",{defaultMessage:"Category examples"}),truncateText:!0,render:item=>{const examples=Object(external_kbnSharedDeps_Lodash_.get)(examplesByJobId,[item.jobId,item.entityValue],[]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{className:"mlAnomalyCategoryExamples__link",onClick:()=>toggleRow(item,ANOMALIES_TABLE_TABS_CATEGORY_EXAMPLES)},examples.map((example,i)=>external_kbnSharedDeps_React_default.a.createElement("span",{key:"example"+i,className:"category-example"},example)))},width:"13%"});return!0===items.some(item=>showLinksMenuForItem(item,showViewSeriesLink))&&columns.push({"data-test-subj":"mlAnomaliesListColumnAction",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.anomaliesTable.actionsColumnName",{defaultMessage:"Actions"}),render:item=>!0===showLinksMenuForItem(item,showViewSeriesLink)?external_kbnSharedDeps_React_default.a.createElement(LinksMenu,{anomaly:item,bounds:bounds,showViewSeriesLink:showViewSeriesLink,isAggregatedData:isAggregatedData,interval:interval,showRuleEditorFlyout:showRuleEditorFlyout}):null}),columns}function getFilterEntity(entityName,entityValue,filter){return external_kbnSharedDeps_React_default.a.createElement(EntityCell,{entityName:entityName,entityValue:entityValue,filter:filter})}class anomaly_details_AnomalyDetails extends external_kbnSharedDeps_React_.Component{constructor(props){super(props),this.state={showAllInfluencers:!1},void 0!==this.props.examples&&this.props.examples.length>0&&(this.tabs=[{id:"Details",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.detailsTitle",{defaultMessage:"Details"}),content:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement("div",{className:"ml-anomalies-table-details"},this.renderDescription(),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),this.renderDetails(),this.renderInfluencers()))},{id:"category-examples",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.categoryExamplesTitle",{defaultMessage:"Category examples"}),content:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,this.renderCategoryExamples())}])}toggleAllInfluencers(){this.setState({showAllInfluencers:!this.state.showAllInfluencers})}renderCategoryExamples(){const{examples:examples,definition:definition}=this.props;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"column",justifyContent:"center",gutterSize:"m",className:"mlAnomalyCategoryExamples"},void 0!==definition&&definition.terms&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{key:"example-terms"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("h4",{className:"mlAnomalyCategoryExamples__header"},external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.termsTitle",{defaultMessage:"Terms"}))," ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIconTip,{"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.termsDescriptionAriaLabel",{defaultMessage:"Description"}),type:"questionInCircle",color:"subdued",size:"s",content:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.anomaliesTable.anomalyDetails.termsDescriptionTooltip",defaultMessage:"A space separated list of the common tokens that are matched in values of the category (may have been truncated to a max character limit of {maxChars})",values:{maxChars:500}})})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs"},definition.terms)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"xs"})),void 0!==definition&&definition.regex&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{key:"example-regex"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("h4",{className:"mlAnomalyCategoryExamples__header"},external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.regexTitle",{defaultMessage:"Regex"}))," ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIconTip,{"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.regexDescriptionAriaLabel",{defaultMessage:"Description"}),type:"questionInCircle",color:"subdued",size:"s",content:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.anomaliesTable.anomalyDetails.regexDescriptionTooltip",defaultMessage:"The regular expression that is used to search for values that match the category (may have been truncated to a max character limit of {maxChars})",values:{maxChars:500}})})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs"},definition.regex)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"xs"})),examples.map((example,i)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{key:"example"+i},0===i&&void 0!==definition&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"s"},external_kbnSharedDeps_React_default.a.createElement("h4",null,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.examplesTitle",{defaultMessage:"Examples"}))),external_kbnSharedDeps_React_default.a.createElement("span",{className:"mlAnomalyCategoryExamples__item"},example))))}renderDescription(){const anomaly=this.props.anomaly,source=anomaly.source;let anomalyDescription=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.anomalyInLabel",{defaultMessage:"{anomalySeverity} anomaly in {anomalyDetector}",values:{anomalySeverity:Object(anomaly_utils.i)(anomaly.severity).label,anomalyDetector:anomaly.detector}});void 0!==anomaly.entityName&&(anomalyDescription+=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.foundForLabel",{defaultMessage:" found for {anomalyEntityName} {anomalyEntityValue}",values:{anomalyEntityName:anomaly.entityName,anomalyEntityValue:anomaly.entityValue}})),void 0!==source.partition_field_name&&source.partition_field_name!==anomaly.entityName&&(anomalyDescription+=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.detectedInLabel",{defaultMessage:" detected in {sourcePartitionFieldName} {sourcePartitionFieldValue}",values:{sourcePartitionFieldName:source.partition_field_name,sourcePartitionFieldValue:source.partition_field_value}}));let mvDescription=void 0;return void 0!==source.correlated_by_field_value&&(mvDescription=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.multivariateDescription",{defaultMessage:"multivariate correlations found in {sourceByFieldName}; {sourceByFieldValue} is considered anomalous given {sourceCorrelatedByFieldValue}",values:{sourceByFieldName:source.by_field_name,sourceByFieldValue:source.by_field_value,sourceCorrelatedByFieldValue:source.correlated_by_field_value}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("h4",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.anomaliesTable.anomalyDetails.descriptionTitle",defaultMessage:"Description"})),anomalyDescription),void 0!==mvDescription&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs"},mvDescription))}renderDetails(){const detailItems=function(anomaly,examples,filter){const source=anomaly.source;let causes=[];const sourceCauses=source.causes||[];let singleCauseByFieldName=void 0,singleCauseByFieldValue=void 0;1===sourceCauses.length?void 0!==sourceCauses[0].by_field_name&&(singleCauseByFieldName=sourceCauses[0].by_field_name,singleCauseByFieldValue=sourceCauses[0].by_field_value):causes=sourceCauses.map(cause=>{const simplified=Object(external_kbnSharedDeps_Lodash_.pick)(cause,"typical","actual","probability");return simplified.entityName=cause.by_field_name?cause.by_field_name:cause.over_field_name,simplified.entityValue=cause.by_field_value?cause.by_field_value:cause.over_field_value,simplified});const items=[];void 0!==source.partition_field_value&&items.push({title:source.partition_field_name,description:getFilterEntity(source.partition_field_name,source.partition_field_value,filter)}),void 0!==source.by_field_value&&items.push({title:source.by_field_name,description:getFilterEntity(source.by_field_name,source.by_field_value,filter)}),void 0!==singleCauseByFieldName&&items.push({title:singleCauseByFieldName,description:getFilterEntity(singleCauseByFieldName,singleCauseByFieldValue,filter)}),void 0!==source.over_field_value&&items.push({title:source.over_field_name,description:getFilterEntity(source.over_field_name,source.over_field_value,filter)});const anomalyTime=source.timestamp;let timeDesc=""+Object(date_utils.c)(anomalyTime);if(void 0!==source.bucket_span){const anomalyEndTime=anomalyTime+1e3*source.bucket_span;timeDesc=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.anomalyTimeRangeLabel",{defaultMessage:"{anomalyTime} to {anomalyEndTime}",values:{anomalyTime:Object(date_utils.c)(anomalyTime),anomalyEndTime:Object(date_utils.c)(anomalyEndTime)}})}items.push({title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.timeTitle",{defaultMessage:"Time"}),description:timeDesc}),items.push({title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.functionTitle",{defaultMessage:"Function"}),description:source.function!==aggregation_types.b.METRIC?source.function:source.function_description}),void 0!==source.field_name&&items.push({title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.fieldNameTitle",{defaultMessage:"Field name"}),description:source.field_name});const functionDescription=source.function_description||"";return void 0!==anomaly.actual&&!0===Object(anomaly_utils.n)(functionDescription)&&items.push({title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.actualTitle",{defaultMessage:"Actual"}),description:Object(format_value.b)(anomaly.actual,source.function,void 0,source)}),void 0!==anomaly.typical&&!0===Object(anomaly_utils.o)(functionDescription)&&items.push({title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.typicalTitle",{defaultMessage:"Typical"}),description:Object(format_value.b)(anomaly.typical,source.function,void 0,source)}),items.push({title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.jobIdTitle",{defaultMessage:"Job ID"}),description:anomaly.jobId}),void 0!==source.multi_bucket_impact&&source.multi_bucket_impact>=multi_bucket_impact.a.LOW&&items.push({title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.multiBucketImpactTitle",{defaultMessage:"Multi-bucket impact"}),description:Object(anomaly_utils.h)(source.multi_bucket_impact)}),items.push({title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.probabilityTitle",{defaultMessage:"Probability"}),description:source.probability}),causes.length>1&&causes.forEach((cause,index)=>{const title=0===index?external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.causeValuesTitle",{defaultMessage:"{causeEntityName} values",values:{causeEntityName:cause.entityName}}):"",description=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.causeValuesDescription",{defaultMessage:"{causeEntityValue} (actual {actualValue}, typical {typicalValue}, probability {probabilityValue})",values:{causeEntityValue:cause.entityValue,actualValue:Object(format_value.b)(cause.actual,source.function),typicalValue:Object(format_value.b)(cause.typical,source.function),probabilityValue:cause.probability}});items.push({title:title,description:description})}),items}(this.props.anomaly,this.props.examples,this.props.filter),isInterimResult=Object(external_kbnSharedDeps_Lodash_.get)(this.props.anomaly,"source.is_interim",!1);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs"},!0===this.props.isAggregatedData?external_kbnSharedDeps_React_default.a.createElement("h4",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.anomaliesTable.anomalyDetails.detailsOnHighestSeverityAnomalyTitle",defaultMessage:"Details on highest severity anomaly"})):external_kbnSharedDeps_React_default.a.createElement("h4",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.anomaliesTable.anomalyDetails.anomalyDetailsTitle",defaultMessage:"Anomaly details"})),!0===isInterimResult&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{type:"alert"}),external_kbnSharedDeps_React_default.a.createElement("span",{className:"interim-result"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.anomaliesTable.anomalyDetails.interimResultLabel",defaultMessage:"Interim result"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionList,{type:"column",listItems:detailItems,className:"anomaly-description-list"}))}renderInfluencers(){const anomalyInfluencers=this.props.anomaly.influencers;let listItems=[],othersCount=0,numToDisplay=0;if(void 0!==anomalyInfluencers&&(numToDisplay=!0===this.state.showAllInfluencers?anomalyInfluencers.length:Math.min(this.props.influencersLimit,anomalyInfluencers.length),othersCount=Math.max(anomalyInfluencers.length-numToDisplay,0),1===othersCount&&(numToDisplay++,othersCount=0),listItems=function(anomalyInfluencers,influencerFilter,numToDisplay){const items=[];for(let i=0;i<numToDisplay;i++)Object.keys(anomalyInfluencers[i]).forEach(influencerFieldName=>{const value=anomalyInfluencers[i][influencerFieldName];items.push({title:influencerFieldName,description:getFilterEntity(influencerFieldName,value,influencerFilter)})});return items}(anomalyInfluencers,this.props.influencerFilter,numToDisplay)),listItems.length>0)return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("h4",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.anomaliesTable.anomalyDetails.influencersTitle",defaultMessage:"Influencers"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionList,{type:"column",listItems:listItems,className:"anomaly-description-list"}),othersCount>0&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{onClick:()=>this.toggleAllInfluencers()},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.anomaliesTable.anomalyDetails.anomalyDescriptionListMoreLinkText",defaultMessage:"and {othersCount} more",values:{othersCount:othersCount}})),numToDisplay>this.props.influencersLimit+1&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{onClick:()=>this.toggleAllInfluencers()},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.anomaliesTable.anomalyDetails.anomalyDescriptionShowLessLinkText",defaultMessage:"Show less"})))}render(){const{tabIndex:tabIndex}=this.props;return void 0!==this.tabs?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTabbedContent,{tabs:this.tabs,size:"s",initialSelectedTab:this.tabs[tabIndex],onTabClick:()=>{}}):external_kbnSharedDeps_React_default.a.createElement("div",{className:"ml-anomalies-table-details"},this.renderDescription(),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),this.renderDetails(),this.renderInfluencers())}}var table_service=__webpack_require__(246);function DetectorDescriptionList({job:job,detector:detector,anomaly:anomaly}){const listItems=[{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.ruleEditor.detectorDescriptionList.jobIdTitle",defaultMessage:"Job ID"}),description:job.job_id},{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.ruleEditor.detectorDescriptionList.detectorTitle",defaultMessage:"Detector"}),description:detector.detector_description}];if(void 0!==anomaly.actual){const actual=Object(format_value.b)(anomaly.actual,anomaly.source.function),typical=Object(format_value.b)(anomaly.typical,anomaly.source.function);listItems.push({title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.ruleEditor.detectorDescriptionList.selectedAnomalyTitle",defaultMessage:"Selected anomaly"}),description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.ruleEditor.detectorDescriptionList.selectedAnomalyDescription",defaultMessage:"actual {actual}, typical {typical}",values:{actual:actual,typical:typical}})})}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionList,{className:"rule-detector-description-list",type:"column",listItems:listItems})}var detector_rule=__webpack_require__(29);function ActionsSection({actions:actions,onSkipResultChange:onSkipResultChange,onSkipModelUpdateChange:onSkipModelUpdateChange}){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.ruleEditor.actionsSection.chooseActionsDescription",defaultMessage:"Choose the actions to take when the job rule matches an anomaly."}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCheckbox,{id:"skip_result_cb",label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.ruleEditor.actionsSection.skipResultLabel",defaultMessage:"Skip result (recommended)"}),checked:actions.indexOf(detector_rule.a.SKIP_RESULT)>-1,onChange:onSkipResultChange})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIconTip,{content:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.ruleEditor.actionsSection.resultWillNotBeCreatedTooltip",defaultMessage:"The result will not be created."}),size:"s",position:"right"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCheckbox,{id:"skip_model_update_cb",label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.ruleEditor.actionsSection.skipModelUpdateLabel",defaultMessage:"Skip model update"}),checked:actions.indexOf(detector_rule.a.SKIP_MODEL_UPDATE)>-1,onChange:onSkipModelUpdateChange})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIconTip,{content:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.ruleEditor.actionsSection.valueWillNotBeUsedToUpdateModelTooltip",defaultMessage:"The value for that series will not be used to update the model."}),size:"s",position:"right"}))))}function getNewConditionDefaults(){return{applies_to:detector_rule.b.ACTUAL,operator:detector_rule.e.LESS_THAN,value:1}}function getNewRuleDefaults(){return{actions:[detector_rule.a.SKIP_RESULT],conditions:[]}}function isValidRule(rule){let isValid=!1;if(rule.actions.length>0){const conditions=rule.conditions;if(void 0!==conditions&&conditions.length>0)isValid=!0;else{const scope=rule.scope;void 0!==scope&&(isValid=Object.keys(scope).some(field=>!0===scope[field].enabled))}}return isValid}function updateJobRules(job,detectorIndex,rules){const jobId=job.job_id,jobData={detectors:[{detector_index:detectorIndex,custom_rules:rules}]};let customSettings={};return void 0!==job.custom_settings&&(customSettings={...job.custom_settings},Object(job_utils.r)(customSettings),jobData.custom_settings=customSettings),new Promise((resolve,reject)=>{ml_api_service.ml.updateJob({jobId:jobId,job:jobData}).then(()=>{job_service.a.refreshJob(jobId).then(()=>{resolve({success:!0})}).catch(refreshResp=>{reject(refreshResp)})}).catch(resp=>{reject(resp)})})}function buildRuleDescription(rule){const{actions:actions,conditions:conditions,scope:scope}=rule;let actionsText="",conditionsText="",filtersText="";if(actions.forEach((action,i)=>{switch(i>0&&(actionsText+=" AND "),action){case detector_rule.a.SKIP_RESULT:actionsText+=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.ruleEditor.ruleDescription.resultActionTypeText",{defaultMessage:"result",description:"Part of composite text: xpack.ml.ruleEditor.ruleDescription.[actionName]ActionTypeText +xpack.ml.ruleEditor.ruleDescription.conditionsText + xpack.ml.ruleEditor.ruleDescription.filtersText"});break;case detector_rule.a.SKIP_MODEL_UPDATE:actionsText+=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.ruleEditor.ruleDescription.modelUpdateActionTypeText",{defaultMessage:"model update",description:"Part of composite text: xpack.ml.ruleEditor.ruleDescription.[actionName]ActionTypeText + xpack.ml.ruleEditor.ruleDescription.conditionsText + xpack.ml.ruleEditor.ruleDescription.filtersText"})}}),void 0!==conditions&&conditions.forEach((condition,i)=>{i>0&&(conditionsText+=" AND "),conditionsText+=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.ruleEditor.ruleDescription.conditionsText",{defaultMessage:"{appliesTo} is {operator} {value}",values:{appliesTo:appliesToText(condition.applies_to),operator:operatorToText(condition.operator),value:condition.value},description:"Part of composite text: xpack.ml.ruleEditor.ruleDescription.[actionName]ActionTypeText + xpack.ml.ruleEditor.ruleDescription.conditionsText + xpack.ml.ruleEditor.ruleDescription.filtersText"})}),void 0!==scope){void 0!==conditions&&conditions.length>0&&(filtersText+=" AND ");Object.keys(scope).forEach((fieldName,i)=>{i>0&&(filtersText+=" AND ");const filter=scope[fieldName];filtersText+=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.ruleEditor.ruleDescription.filtersText",{defaultMessage:"{fieldName} is {filterType} {filterId}",values:{fieldName:fieldName,filterType:filterTypeToText(filter.filter_type),filterId:filter.filter_id},description:"Part of composite text: xpack.ml.ruleEditor.ruleDescription.[actionName]ActionTypeText + xpack.ml.ruleEditor.ruleDescription.conditionsText + xpack.ml.ruleEditor.ruleDescription.filtersText"})})}return external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.ruleEditor.ruleDescription",{defaultMessage:"skip {actions} when {conditions}{filters}",values:{actions:actionsText,conditions:conditionsText,filters:filtersText},description:"Composite text: xpack.ml.ruleEditor.ruleDescription.[actionName]ActionTypeText + xpack.ml.ruleEditor.ruleDescription.conditionsText + xpack.ml.ruleEditor.ruleDescription.filtersText. (Example: skip model update when actual is less than 1 AND ip is in xxx)"})}function filterTypeToText(filterType){switch(filterType){case detector_rule.d.INCLUDE:return external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.ruleEditor.includeFilterTypeText",{defaultMessage:"in"});case detector_rule.d.EXCLUDE:return external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.ruleEditor.excludeFilterTypeText",{defaultMessage:"not in"});default:return void 0!==filterType?filterType:""}}function appliesToText(appliesTo){switch(appliesTo){case detector_rule.b.ACTUAL:return external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.ruleEditor.actualAppliesTypeText",{defaultMessage:"actual"});case detector_rule.b.TYPICAL:return external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.ruleEditor.typicalAppliesTypeText",{defaultMessage:"typical"});case detector_rule.b.DIFF_FROM_TYPICAL:return external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.ruleEditor.diffFromTypicalAppliesTypeText",{defaultMessage:"diff from typical"});default:return void 0!==appliesTo?appliesTo:""}}function operatorToText(operator){switch(operator){case detector_rule.e.LESS_THAN:return external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.ruleEditor.lessThanOperatorTypeText",{defaultMessage:"less than"});case detector_rule.e.LESS_THAN_OR_EQUAL:return external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.ruleEditor.lessThanOrEqualToOperatorTypeText",{defaultMessage:"less than or equal to"});case detector_rule.e.GREATER_THAN:return external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.ruleEditor.greaterThanOperatorTypeText",{defaultMessage:"greater than"});case detector_rule.e.GREATER_THAN_OR_EQUAL:return external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.ruleEditor.greaterThanOrEqualToOperatorTypeText",{defaultMessage:"greater than or equal to"});default:return void 0!==operator?operator:""}}function condition_expression_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}const POPOVER_STYLE={zIndex:"200"};class condition_expression_ConditionExpression extends external_kbnSharedDeps_React_.Component{constructor(props){super(props),condition_expression_defineProperty(this,"openAppliesTo",()=>{this.setState({isAppliesToOpen:!0,isOperatorValueOpen:!1})}),condition_expression_defineProperty(this,"closeAppliesTo",()=>{this.setState({isAppliesToOpen:!1})}),condition_expression_defineProperty(this,"openOperatorValue",()=>{this.setState({isAppliesToOpen:!1,isOperatorValueOpen:!0})}),condition_expression_defineProperty(this,"closeOperatorValue",()=>{this.setState({isOperatorValueOpen:!1})}),condition_expression_defineProperty(this,"changeAppliesTo",event=>{const{index:index,operator:operator,value:value,updateCondition:updateCondition}=this.props;updateCondition(index,event.target.value,operator,value)}),condition_expression_defineProperty(this,"changeOperator",event=>{const{index:index,appliesTo:appliesTo,value:value,updateCondition:updateCondition}=this.props;updateCondition(index,appliesTo,event.target.value,value)}),condition_expression_defineProperty(this,"changeValue",event=>{const{index:index,appliesTo:appliesTo,operator:operator,updateCondition:updateCondition}=this.props;updateCondition(index,appliesTo,operator,+event.target.value)}),this.state={isAppliesToOpen:!1,isOperatorValueOpen:!1}}renderAppliesToPopover(){return external_kbnSharedDeps_React_default.a.createElement("div",{style:POPOVER_STYLE},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopoverTitle,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.ruleEditor.conditionExpression.appliesToPopoverTitle",defaultMessage:"When"})),external_kbnSharedDeps_React_default.a.createElement("div",{className:"euiExpression",style:{width:200}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSelect,{value:this.props.appliesTo,onChange:this.changeAppliesTo,options:[{value:detector_rule.b.ACTUAL,text:appliesToText(detector_rule.b.ACTUAL)},{value:detector_rule.b.TYPICAL,text:appliesToText(detector_rule.b.TYPICAL)},{value:detector_rule.b.DIFF_FROM_TYPICAL,text:appliesToText(detector_rule.b.DIFF_FROM_TYPICAL)}]})))}renderOperatorValuePopover(){return external_kbnSharedDeps_React_default.a.createElement("div",{style:POPOVER_STYLE},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopoverTitle,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.ruleEditor.conditionExpression.operatorValuePopoverTitle",defaultMessage:"Is"})),external_kbnSharedDeps_React_default.a.createElement("div",{className:"euiExpression"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{style:{maxWidth:450}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,style:{width:250}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSelect,{value:this.props.operator,onChange:this.changeOperator,options:[{value:detector_rule.e.LESS_THAN,text:operatorToText(detector_rule.e.LESS_THAN)},{value:detector_rule.e.LESS_THAN_OR_EQUAL,text:operatorToText(detector_rule.e.LESS_THAN_OR_EQUAL)},{value:detector_rule.e.GREATER_THAN,text:operatorToText(detector_rule.e.GREATER_THAN)},{value:detector_rule.e.GREATER_THAN_OR_EQUAL,text:operatorToText(detector_rule.e.GREATER_THAN_OR_EQUAL)}]})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,style:{width:200}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldNumber,{value:+this.props.value,onChange:this.changeValue})))))}render(){const{index:index,appliesTo:appliesTo,operator:operator,value:value,deleteCondition:deleteCondition}=this.props;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"m"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopover,{id:"appliesToPopover",button:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiExpression,{description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.ruleEditor.conditionExpression.appliesToButtonLabel",defaultMessage:"when"}),value:appliesToText(appliesTo),isActive:this.state.isAppliesToOpen,onClick:this.openAppliesTo}),isOpen:this.state.isAppliesToOpen,closePopover:this.closeAppliesTo,panelPaddingSize:"none",ownFocus:!0,anchorPosition:"downLeft"},this.renderAppliesToPopover())),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopover,{id:"operatorValuePopover",button:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiExpression,{description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.ruleEditor.conditionExpression.operatorValueButtonLabel",defaultMessage:"is {operator}",values:{operator:operatorToText(operator)}}),value:""+value,isActive:this.state.isOperatorValueOpen,onClick:this.openOperatorValue}),isOpen:this.state.isOperatorValueOpen,closePopover:this.closeOperatorValue,panelPaddingSize:"none",ownFocus:!0,withTitle:!0,anchorPosition:"downLeft"},this.renderOperatorValuePopover())),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{size:"s",color:"danger",onClick:()=>deleteCondition(index),iconType:"trash","aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.ruleEditor.conditionExpression.deleteConditionButtonAriaLabel",{defaultMessage:"Delete condition"})})))}}function ConditionsSection({isEnabled:isEnabled,conditions:conditions,addCondition:addCondition,updateCondition:updateCondition,deleteCondition:deleteCondition}){if(!1===isEnabled)return null;let expressions=[];return void 0!==conditions&&(expressions=conditions.map((condition,index)=>external_kbnSharedDeps_React_default.a.createElement(condition_expression_ConditionExpression,{key:index,index:index,appliesTo:condition.applies_to,operator:condition.operator,value:condition.value,updateCondition:updateCondition,deleteCondition:deleteCondition}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,expressions,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{onClick:()=>addCondition()},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.ruleEditor.conditionsSection.addNewConditionButtonLabel",defaultMessage:"Add new condition"})))}function scope_expression_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}const scope_expression_POPOVER_STYLE={zIndex:"200"};function getFilterListOptions(filterListIds){return filterListIds.map(filterId=>({value:filterId,text:filterId}))}class scope_expression_ScopeExpression extends external_kbnSharedDeps_React_.Component{constructor(props){super(props),scope_expression_defineProperty(this,"openFilterList",()=>{this.setState({isFilterListOpen:!0})}),scope_expression_defineProperty(this,"closeFilterList",()=>{this.setState({isFilterListOpen:!1})}),scope_expression_defineProperty(this,"onChangeFilterType",event=>{const{fieldName:fieldName,filterId:filterId,enabled:enabled,updateScope:updateScope}=this.props;updateScope(fieldName,filterId,event.target.value,enabled)}),scope_expression_defineProperty(this,"onChangeFilterId",event=>{const{fieldName:fieldName,filterType:filterType,enabled:enabled,updateScope:updateScope}=this.props;updateScope(fieldName,event.target.value,filterType,enabled)}),scope_expression_defineProperty(this,"onEnableChange",event=>{const{fieldName:fieldName,filterId:filterId,filterType:filterType,updateScope:updateScope}=this.props;updateScope(fieldName,filterId,filterType,event.target.checked)}),this.state={isFilterListOpen:!1}}renderFilterListPopover(){const{filterId:filterId,filterType:filterType,filterListIds:filterListIds}=this.props;return external_kbnSharedDeps_React_default.a.createElement("div",{style:scope_expression_POPOVER_STYLE},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopoverTitle,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.ruleEditor.scopeExpression.scopeFilterTypePopoverTitle",defaultMessage:"Is"})),external_kbnSharedDeps_React_default.a.createElement("div",{className:"euiExpression"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{style:{maxWidth:450}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,style:{width:150}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSelect,{value:filterType,onChange:this.onChangeFilterType,options:[{value:detector_rule.d.INCLUDE,text:filterTypeToText(detector_rule.d.INCLUDE)},{value:detector_rule.d.EXCLUDE,text:filterTypeToText(detector_rule.d.EXCLUDE)}]})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,style:{width:300}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSelect,{value:filterId,onChange:this.onChangeFilterId,options:getFilterListOptions(filterListIds)})))))}render(){const{fieldName:fieldName,filterId:filterId,filterType:filterType,enabled:enabled,filterListIds:filterListIds}=this.props;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"m"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,className:"scope-field-checkbox"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCheckbox,{id:"scope_cb_"+fieldName,checked:enabled,onChange:this.onEnableChange})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiExpression,{className:"scope-field-button",description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.ruleEditor.scopeExpression.scopeFieldWhenLabel",defaultMessage:"when"}),value:fieldName,isActive:!1,onClick:event=>event.preventDefault()})),void 0!==filterListIds&&filterListIds.length>0&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopover,{id:"operatorValuePopover",button:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiExpression,{description:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.ruleEditor.scopeExpression.scopeFilterTypeButtonLabel",defaultMessage:"is {filterType}",values:{filterType:filterTypeToText(filterType)}}),value:filterId||"",isActive:this.state.isFilterListOpen,onClick:this.openFilterList}),isOpen:this.state.isFilterListOpen,closePopover:this.closeFilterList,panelPaddingSize:"none",ownFocus:!0,anchorPosition:"downLeft"},this.renderFilterListPopover())))}}function NoFilterListsCallOut(){const mlUrlGenerator=Object(contexts_kibana.d)(),navigateToPath=Object(contexts_kibana.e)();return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.ruleEditor.scopeSection.noFilterListsConfiguredTitle",defaultMessage:"No filter lists configured"}),iconType:"gear"},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.ruleEditor.scopeSection.createFilterListsDescription",defaultMessage:"To configure scope, you must first use the {filterListsLink} settings page to create the list of values you want to include or exclude in the job rule.",values:{filterListsLink:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{onClick:async()=>{const path=await mlUrlGenerator.createUrl({page:ml_url_generator.b.FILTER_LISTS_MANAGE});await navigateToPath(path,!0)}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.ruleEditor.scopeSection.createFilterListsDescription.filterListsLinkText",defaultMessage:"Filter Lists"}))}})))}function NoPermissionCallOut(){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.ruleEditor.scopeSection.noPermissionToViewFilterListsTitle",defaultMessage:"You do not have permission to view filter lists"}),iconType:"gear"})}function ScopeSection({isEnabled:isEnabled,onEnabledChange:onEnabledChange,partitioningFieldNames:partitioningFieldNames,filterListIds:filterListIds,scope:scope,updateScope:updateScope}){const canGetFilters=Object(check_capabilities.e)("canGetFilters");if(null===partitioningFieldNames||0===partitioningFieldNames.length)return null;let content;return content=filterListIds.length>0?partitioningFieldNames.map((fieldName,index)=>{let filterValues;return filterValues=void 0!==scope&&void 0!==scope[fieldName]?scope[fieldName]:function(filterListIds){const defaults={filter_type:detector_rule.d.INCLUDE,enabled:!1};return void 0!==filterListIds&&filterListIds.length>0&&(defaults.filter_id=filterListIds[0]),defaults}(filterListIds),external_kbnSharedDeps_React_default.a.createElement(scope_expression_ScopeExpression,{key:index,fieldName:fieldName,filterId:filterValues.filter_id,filterType:filterValues.filter_type,enabled:filterValues.enabled,filterListIds:filterListIds,updateScope:updateScope})}):!1===canGetFilters?external_kbnSharedDeps_React_default.a.createElement(NoPermissionCallOut,null):external_kbnSharedDeps_React_default.a.createElement(NoFilterListsCallOut,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,null,external_kbnSharedDeps_React_default.a.createElement("h2",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.ruleEditor.scopeSection.scopeTitle",defaultMessage:"Scope"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCheckbox,{id:"enable_scope_checkbox",label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.ruleEditor.scopeSection.addFilterListLabel",defaultMessage:"Add a filter list to limit where the job rule applies."}),checked:isEnabled,onChange:onEnabledChange}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),isEnabled&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,content),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"xxl"}))}function AddToFilterListLink({fieldValue:fieldValue,filterId:filterId,addItemToFilterList:addItemToFilterList}){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{onClick:()=>addItemToFilterList(fieldValue,filterId,!0)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.ruleEditor.addValueToFilterListLinkText",defaultMessage:"Add {fieldValue} to {filterId}",values:{fieldValue:fieldValue,filterId:filterId}}))}function delete_rule_modal_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class delete_rule_modal_DeleteRuleModal extends external_kbnSharedDeps_React_.Component{constructor(props){super(props),delete_rule_modal_defineProperty(this,"deleteRule",()=>{const{ruleIndex:ruleIndex,deleteRuleAtIndex:deleteRuleAtIndex}=this.props;deleteRuleAtIndex(ruleIndex),this.closeModal()}),delete_rule_modal_defineProperty(this,"closeModal",()=>{this.setState({isModalVisible:!1})}),delete_rule_modal_defineProperty(this,"showModal",()=>{this.setState({isModalVisible:!0})}),this.state={isModalVisible:!1}}render(){let modal;return this.state.isModalVisible&&(modal=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiConfirmModal,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.ruleEditor.deleteRuleModal.deleteRuleTitle",defaultMessage:"Delete rule?"}),onCancel:this.closeModal,onConfirm:this.deleteRule,buttonColor:"danger",cancelButtonText:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.ruleEditor.deleteRuleModal.cancelButtonLabel",defaultMessage:"Cancel"}),confirmButtonText:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.ruleEditor.deleteRuleModal.deleteButtonLabel",defaultMessage:"Delete"}),defaultFocusedButton:external_kbnSharedDeps_ElasticEui_.EUI_MODAL_CONFIRM_BUTTON})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{color:"danger",onClick:()=>this.showModal()},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.ruleEditor.deleteRuleModal.deleteRuleLinkText",defaultMessage:"Delete rule"})),modal)}}function edit_condition_link_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class edit_condition_link_EditConditionLink extends external_kbnSharedDeps_React_.Component{constructor(props){super(props),edit_condition_link_defineProperty(this,"onChangeValue",event=>{const enteredValue=event.target.value;this.setState({value:""!==enteredValue?+enteredValue:""})}),edit_condition_link_defineProperty(this,"onUpdateClick",()=>{const{conditionIndex:conditionIndex,updateConditionValue:updateConditionValue}=this.props;updateConditionValue(conditionIndex,this.state.value)});let value="";const anomaly=this.props.anomaly,anomalyValue=function(anomaly,appliesTo){let actualValue,typicalValue;const actual=anomaly.actual;void 0!==actual&&(actualValue=Array.isArray(actual)?actual[0]:actual);const typical=anomaly.typical;switch(void 0!==typical&&(typicalValue=Array.isArray(typical)?typical[0]:typical),appliesTo){case detector_rule.b.ACTUAL:return actualValue;case detector_rule.b.TYPICAL:return typicalValue;case detector_rule.b.DIFF_FROM_TYPICAL:if(void 0!==actual&&void 0!==typical)return Math.abs(actualValue-typicalValue)}}(anomaly,props.appliesTo);void 0!==anomalyValue&&(value=+Object(format_value.b)(anomalyValue,anomaly.source.function)),this.state={value:value}}render(){const value=this.state.value;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.ruleEditor.editConditionLink.updateRuleConditionFromText",defaultMessage:"Update rule condition from {conditionValue} to",values:{conditionValue:this.props.conditionValue}}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,className:"condition-edit-value-field"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldNumber,{placeholder:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.ruleEditor.editConditionLink.enterValuePlaceholder",{defaultMessage:"Enter value"}),compressed:!0,value:value,onChange:this.onChangeValue,"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.ruleEditor.editConditionLink.enterNumericValueForConditionAriaLabel",{defaultMessage:"Enter numeric value for condition"})})),""!==value&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{size:"s",onClick:()=>this.onUpdateClick()},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.ruleEditor.editConditionLink.updateLinkText",defaultMessage:"Update"}))))}}function rule_action_panel_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class rule_action_panel_RuleActionPanel extends external_kbnSharedDeps_React_.Component{constructor(props){super(props),rule_action_panel_defineProperty(this,"getEditRuleLink",()=>{const{ruleIndex:ruleIndex,setEditRuleIndex:setEditRuleIndex}=this.props;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{onClick:()=>setEditRuleIndex(ruleIndex)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleActionPanel.editRuleLinkText",defaultMessage:"Edit rule"}))}),rule_action_panel_defineProperty(this,"getDeleteRuleLink",()=>{const{ruleIndex:ruleIndex,deleteRuleAtIndex:deleteRuleAtIndex}=this.props;return external_kbnSharedDeps_React_default.a.createElement(delete_rule_modal_DeleteRuleModal,{ruleIndex:ruleIndex,deleteRuleAtIndex:deleteRuleAtIndex})}),rule_action_panel_defineProperty(this,"getQuickEditConditionLink",()=>{const conditions=this.rule.conditions;let link=null;return void 0!==this.rule.conditions&&1===conditions.length&&(link=external_kbnSharedDeps_React_default.a.createElement(edit_condition_link_EditConditionLink,{conditionIndex:0,conditionValue:conditions[0].value,appliesTo:conditions[0].applies_to,anomaly:this.props.anomaly,updateConditionValue:this.updateConditionValue})),link}),rule_action_panel_defineProperty(this,"getQuickAddToFilterListLink",()=>{const{anomaly:anomaly,addItemToFilterList:addItemToFilterList}=this.props,scope=this.rule.scope,partitionFieldName=Object.keys(scope)[0],partitionFieldValue=anomaly.source[partitionFieldName],filterId=scope[partitionFieldName].filter_id;return external_kbnSharedDeps_React_default.a.createElement(AddToFilterListLink,{fieldValue:partitionFieldValue[0],filterId:filterId,addItemToFilterList:addItemToFilterList})}),rule_action_panel_defineProperty(this,"updateConditionValue",(conditionIndex,value)=>{const{job:job,anomaly:anomaly,ruleIndex:ruleIndex,updateRuleAtIndex:updateRuleAtIndex}=this.props,detector=job.analysis_config.detectors[anomaly.detectorIndex],editedRule=Object(external_kbnSharedDeps_Lodash_.cloneDeep)(detector.custom_rules[ruleIndex]),conditions=editedRule.conditions;conditionIndex<conditions.length&&(conditions[conditionIndex].value=value),updateRuleAtIndex(ruleIndex,editedRule)});const{job:_job,anomaly:_anomaly,ruleIndex:_ruleIndex}=this.props,rules=_job.analysis_config.detectors[_anomaly.detectorIndex].custom_rules;void 0!==rules&&_ruleIndex<rules.length&&(this.rule=rules[_ruleIndex]),this.state={showAddToFilterListLink:!1}}componentDidMount(){const scope=this.rule.scope;if(void 0!==scope&&1===Object.keys(scope).length){const partitionFieldName=Object.keys(scope)[0],partitionFieldValue=this.props.anomaly.source[partitionFieldName];if(void 0!==scope[partitionFieldName]&&void 0!==partitionFieldValue&&1===partitionFieldValue.length&&partitionFieldValue[0].length>0){const filterId=scope[partitionFieldName].filter_id;ml_api_service.ml.filters.filters({filterId:filterId}).then(filter=>{-1===filter.items.indexOf(partitionFieldValue[0])&&this.setState({showAddToFilterListLink:!0})}).catch(resp=>{console.log(`Error loading filter ${filterId}:`,resp)})}}}render(){if(void 0===this.rule)return null;const descriptionListItems=[{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleActionPanel.ruleTitle",defaultMessage:"Rule"}),description:buildRuleDescription(this.rule,this.props.anomaly)},{title:"",description:this.getEditRuleLink()},{title:"",description:this.getDeleteRuleLink()}],quickConditionLink=this.getQuickEditConditionLink();if(null!==quickConditionLink&&descriptionListItems.splice(1,0,{title:"",description:quickConditionLink}),!0===this.state.showAddToFilterListLink){const quickAddToFilterListLink=this.getQuickAddToFilterListLink();descriptionListItems.splice(descriptionListItems.length-2,0,{title:"",description:quickAddToFilterListLink})}return descriptionListItems[1].title=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleActionPanel.actionsTitle",defaultMessage:"Actions"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPanel,{paddingSize:"m",className:"select-rule-action-panel"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionList,{type:"column",listItems:descriptionListItems}))}}function SelectRuleAction({job:job,anomaly:anomaly,setEditRuleIndex:setEditRuleIndex,updateRuleAtIndex:updateRuleAtIndex,deleteRuleAtIndex:deleteRuleAtIndex,addItemToFilterList:addItemToFilterList}){const detectorIndex=anomaly.detectorIndex,detector=job.analysis_config.detectors[detectorIndex],rules=detector.custom_rules||[];let ruleActionPanels;return rules.length>0&&(ruleActionPanels=rules.map((rule,index)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,{key:`rule_panel_${index}_${rules.length}`},external_kbnSharedDeps_React_default.a.createElement(rule_action_panel_RuleActionPanel,{job:job,ruleIndex:index,anomaly:anomaly,setEditRuleIndex:setEditRuleIndex,updateRuleAtIndex:updateRuleAtIndex,deleteRuleAtIndex:deleteRuleAtIndex,addItemToFilterList:addItemToFilterList}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"})))),external_kbnSharedDeps_React_default.a.createElement("div",{className:"select-rule-action"},rules.length>0&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(DetectorDescriptionList,{job:job,detector:detector,anomaly:anomaly}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),ruleActionPanels,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{style:{display:"inline"}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.ruleEditor.selectRuleAction.orText",defaultMessage:"Or "}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{onClick:()=>setEditRuleIndex(rules.length)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.ruleEditor.selectRuleAction.createRuleLinkText",defaultMessage:"create a rule"})))}function rule_editor_flyout_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class rule_editor_flyout_RuleEditorFlyoutUI extends external_kbnSharedDeps_React_.Component{constructor(props){super(props),rule_editor_flyout_defineProperty(this,"showFlyout",anomaly=>{let ruleIndex=-1;const job=job_service.a.getJob(anomaly.jobId);if(void 0===job){const{toasts:toasts}=this.props.kibana.services.notifications;return toasts.addDanger(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.ruleEditor.ruleEditorFlyout.unableToConfigureRulesNotificationMesssage",{defaultMessage:"Unable to configure job rules as an error occurred obtaining details for job ID {jobId}",values:{jobId:anomaly.jobId}})),void this.setState({job:job,isFlyoutVisible:!1})}this.partitioningFieldNames=Object(job_utils.h)(job,anomaly.detectorIndex);const detectorIndex=anomaly.detectorIndex;void 0===job.analysis_config.detectors[detectorIndex].custom_rules&&(ruleIndex=0);let isConditionsEnabled=!1;0===ruleIndex&&(isConditionsEnabled=0===this.partitioningFieldNames.length),this.setState({anomaly:anomaly,job:job,ruleIndex:ruleIndex,isConditionsEnabled:isConditionsEnabled,isScopeEnabled:!1,isFlyoutVisible:!0}),this.partitioningFieldNames.length>0&&this.canGetFilters&&ml_api_service.ml.filters.filters().then(filters=>{const filterListIds=filters.map(filter=>filter.filter_id);this.setState({filterListIds:filterListIds})}).catch(resp=>{console.log("Error loading list of filters:",resp);const{toasts:toasts}=this.props.kibana.services.notifications;toasts.addDanger(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.ruleEditor.ruleEditorFlyout.errorWithLoadingFilterListsNotificationMesssage",{defaultMessage:"Error loading the filter lists used in the job rule scope"}))})}),rule_editor_flyout_defineProperty(this,"closeFlyout",()=>{this.setState({isFlyoutVisible:!1})}),rule_editor_flyout_defineProperty(this,"setEditRuleIndex",ruleIndex=>{const detectorIndex=this.state.anomaly.detectorIndex,rules=this.state.job.analysis_config.detectors[detectorIndex].custom_rules,rule=void 0===rules||ruleIndex>=rules.length?getNewRuleDefaults():rules[ruleIndex],isConditionsEnabled=0===this.partitioningFieldNames.length||void 0!==rule.conditions&&rule.conditions.length>0,isScopeEnabled=void 0!==rule.scope&&Object.keys(rule.scope).length>0;!0===isScopeEnabled&&Object.keys(rule.scope).forEach(field=>{rule.scope[field].enabled=!0}),this.setState({ruleIndex:ruleIndex,rule:rule,isConditionsEnabled:isConditionsEnabled,isScopeEnabled:isScopeEnabled})}),rule_editor_flyout_defineProperty(this,"onSkipResultChange",e=>{const checked=e.target.checked;this.setState(prevState=>{const actions=[...prevState.rule.actions],idx=actions.indexOf(detector_rule.a.SKIP_RESULT);return-1===idx&&checked?actions.push(detector_rule.a.SKIP_RESULT):idx>-1&&!checked&&actions.splice(idx,1),{rule:{...prevState.rule,actions:actions}}})}),rule_editor_flyout_defineProperty(this,"onSkipModelUpdateChange",e=>{const checked=e.target.checked;this.setState(prevState=>{const actions=[...prevState.rule.actions],idx=actions.indexOf(detector_rule.a.SKIP_MODEL_UPDATE);return-1===idx&&checked?actions.push(detector_rule.a.SKIP_MODEL_UPDATE):idx>-1&&!checked&&actions.splice(idx,1),{rule:{...prevState.rule,actions:actions}}})}),rule_editor_flyout_defineProperty(this,"onConditionsEnabledChange",e=>{const isConditionsEnabled=e.target.checked;this.setState(prevState=>{let conditions;return conditions=!1===isConditionsEnabled?[]:[getNewConditionDefaults()],{rule:{...prevState.rule,conditions:conditions},isConditionsEnabled:isConditionsEnabled}})}),rule_editor_flyout_defineProperty(this,"addCondition",()=>{this.setState(prevState=>{const conditions=[...prevState.rule.conditions];return conditions.push(getNewConditionDefaults()),{rule:{...prevState.rule,conditions:conditions}}})}),rule_editor_flyout_defineProperty(this,"updateCondition",(index,appliesTo,operator,value)=>{this.setState(prevState=>{const conditions=[...prevState.rule.conditions];return index<conditions.length&&(conditions[index]={applies_to:appliesTo,operator:operator,value:value}),{rule:{...prevState.rule,conditions:conditions}}})}),rule_editor_flyout_defineProperty(this,"deleteCondition",index=>{this.setState(prevState=>{const conditions=[...prevState.rule.conditions];return index<conditions.length&&conditions.splice(index,1),{rule:{...prevState.rule,conditions:conditions}}})}),rule_editor_flyout_defineProperty(this,"onScopeEnabledChange",e=>{const isScopeEnabled=e.target.checked;this.setState(prevState=>{const rule={...prevState.rule};return!1===isScopeEnabled&&delete rule.scope,{rule:rule,isScopeEnabled:isScopeEnabled}})}),rule_editor_flyout_defineProperty(this,"updateScope",(fieldName,filterId,filterType,enabled)=>{this.setState(prevState=>{let scope={...prevState.rule.scope};return void 0===scope&&(scope={}),scope[fieldName]={filter_id:filterId,filter_type:filterType,enabled:enabled},{rule:{...prevState.rule,scope:scope}}})}),rule_editor_flyout_defineProperty(this,"saveEdit",()=>{const{rule:rule,ruleIndex:ruleIndex}=this.state;this.updateRuleAtIndex(ruleIndex,rule)}),rule_editor_flyout_defineProperty(this,"updateRuleAtIndex",(ruleIndex,editedRule)=>{const{toasts:toasts}=this.props.kibana.services.notifications,{job:job,anomaly:anomaly}=this.state,jobId=job.job_id;(function(job,detectorIndex,ruleIndex,editedRule){const detector=job.analysis_config.detectors[detectorIndex],clonedRule=Object(external_kbnSharedDeps_Lodash_.cloneDeep)(editedRule),scope=clonedRule.scope;void 0!==scope&&Object.keys(scope).forEach(field=>{!1===scope[field].enabled?delete scope[field]:delete scope[field].enabled});let rules=[];return void 0===detector.custom_rules?rules=[clonedRule]:(rules=Object(external_kbnSharedDeps_Lodash_.cloneDeep)(detector.custom_rules),ruleIndex<rules.length?rules[ruleIndex]=clonedRule:rules.push(clonedRule)),updateJobRules(job,detectorIndex,rules)})(job,anomaly.detectorIndex,ruleIndex,editedRule).then(resp=>{resp.success?(toasts.add({title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.ruleEditor.ruleEditorFlyout.changesToJobDetectorRulesSavedNotificationMessageTitle",{defaultMessage:"Changes to {jobId} detector rules saved",values:{jobId:jobId}}),color:"success",iconType:"check",text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.ruleEditor.ruleEditorFlyout.changesToJobDetectorRulesSavedNotificationMessageDescription",{defaultMessage:"Note that changes will take effect for new results only."})}),this.closeFlyout()):toasts.addDanger(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.ruleEditor.ruleEditorFlyout.errorWithSavingChangesToJobDetectorRulesNotificationMessage",{defaultMessage:"Error saving changes to {jobId} detector rules",values:{jobId:jobId}}))}).catch(error=>{console.error(error),toasts.addDanger(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.ruleEditor.ruleEditorFlyout.errorWithSavingChangesToJobDetectorRulesNotificationMessage",{defaultMessage:"Error saving changes to {jobId} detector rules",values:{jobId:jobId}}))})}),rule_editor_flyout_defineProperty(this,"deleteRuleAtIndex",index=>{const{toasts:toasts}=this.props.kibana.services.notifications,{job:job,anomaly:anomaly}=this.state,jobId=job.job_id,detectorIndex=anomaly.detectorIndex;(function(job,detectorIndex,ruleIndex){const detector=job.analysis_config.detectors[detectorIndex];let customRules=[];return void 0!==detector.custom_rules&&ruleIndex<detector.custom_rules.length?(customRules=Object(external_kbnSharedDeps_Lodash_.cloneDeep)(detector.custom_rules),customRules.splice(ruleIndex,1),updateJobRules(job,detectorIndex,customRules)):Promise.reject(new Error(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.ruleEditor.deleteJobRule.ruleNoLongerExistsErrorMessage",{defaultMessage:"Rule no longer exists for detector index {detectorIndex} in job {jobId}",values:{detectorIndex:detectorIndex,jobId:job.job_id}})))})(job,detectorIndex,index).then(resp=>{if(resp.success){toasts.addSuccess(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.ruleEditor.ruleEditorFlyout.ruleDeletedFromJobDetectorNotificationMessage",{defaultMessage:"Rule deleted from {jobId} detector",values:{jobId:jobId}}));const updatedJob=job_service.a.getJob(anomaly.jobId);updatedJob.analysis_config.detectors[detectorIndex].custom_rules?this.setState({job:{...updatedJob}}):this.closeFlyout()}else toasts.addDanger(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.ruleEditor.ruleEditorFlyout.errorWithDeletingRuleFromJobDetectorNotificationMessage",{defaultMessage:"Error deleting rule from {jobId} detector",values:{jobId:jobId}}))}).catch(error=>{console.error(error);let errorMessage=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.ruleEditor.ruleEditorFlyout.errorWithDeletingRuleFromJobDetectorNotificationMessage",{defaultMessage:"Error deleting rule from {jobId} detector",values:{jobId:jobId}});error.error&&(errorMessage+=" : "+Object(util_errors.i)(error.error)),toasts.addDanger(errorMessage)})}),rule_editor_flyout_defineProperty(this,"addItemToFilterList",(item,filterId,closeFlyoutOnAdd)=>{const{toasts:toasts}=this.props.kibana.services.notifications;(function(item,filterId){return new Promise((resolve,reject)=>{ml_api_service.ml.filters.updateFilter(filterId,void 0,[item],void 0).then(updatedFilter=>{resolve(updatedFilter)}).catch(error=>{reject(error)})})})(item,filterId).then(()=>{!0===closeFlyoutOnAdd&&(toasts.add({title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.ruleEditor.ruleEditorFlyout.addedItemToFilterListNotificationMessageTitle",{defaultMessage:"Added {item} to {filterId}",values:{item:item,filterId:filterId}}),color:"success",iconType:"check",text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.ruleEditor.ruleEditorFlyout.addedItemToFilterListNotificationMessageDescription",{defaultMessage:"Note that changes will take effect for new results only."})}),this.closeFlyout())}).catch(error=>{console.log(`Error adding ${item} to filter ${filterId}:`,error),toasts.addDanger(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.ruleEditor.ruleEditorFlyout.errorWithAddingItemToFilterListNotificationMessage",{defaultMessage:"An error occurred adding {item} to filter {filterId}",values:{item:item,filterId:filterId}}))})}),this.state={anomaly:{},job:{},ruleIndex:-1,rule:getNewRuleDefaults(),skipModelUpdate:!1,isConditionsEnabled:!1,isScopeEnabled:!1,filterListIds:[],isFlyoutVisible:!1},this.partitioningFieldNames=[],this.canGetFilters=Object(check_capabilities.e)("canGetFilters")}componentDidMount(){"function"==typeof this.props.setShowFunction&&this.props.setShowFunction(this.showFlyout)}componentWillUnmount(){"function"==typeof this.props.unsetShowFunction&&this.props.unsetShowFunction()}render(){const docsUrl=this.props.kibana.services.docLinks.links.ml.customRules,{isFlyoutVisible:isFlyoutVisible,job:job,anomaly:anomaly,ruleIndex:ruleIndex,rule:rule,filterListIds:filterListIds,isConditionsEnabled:isConditionsEnabled,isScopeEnabled:isScopeEnabled}=this.state;if(!1===isFlyoutVisible)return null;let flyout;if(-1===ruleIndex)flyout=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyout,{className:"ml-rule-editor-flyout",onClose:this.closeFlyout,"aria-labelledby":"flyoutTitle"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyoutHeader,{hasBorder:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"m"},external_kbnSharedDeps_React_default.a.createElement("h1",{id:"flyoutTitle"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.editRulesTitle",defaultMessage:"Edit job rules"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyoutBody,null,external_kbnSharedDeps_React_default.a.createElement(SelectRuleAction,{job:job,anomaly:anomaly,setEditRuleIndex:this.setEditRuleIndex,updateRuleAtIndex:this.updateRuleAtIndex,deleteRuleAtIndex:this.deleteRuleAtIndex,addItemToFilterList:this.addItemToFilterList})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyoutFooter,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{iconType:"cross",onClick:this.closeFlyout,flush:"left"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.closeButtonLabel",defaultMessage:"Close"}))))));else{const detectorIndex=anomaly.detectorIndex,detector=job.analysis_config.detectors[detectorIndex],rules=detector.custom_rules,isCreate=void 0===rules||ruleIndex>=rules.length,hasPartitioningFields=this.partitioningFieldNames&&this.partitioningFieldNames.length>0,conditionSupported=-1===detector_rule.c.indexOf(anomaly.source.function),conditionsText=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.ruleEditor.ruleEditorFlyout.conditionsDescription",{defaultMessage:"Add numeric conditions for when the job rule applies. Multiple conditions are combined using AND."});flyout=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyout,{className:"ml-rule-editor-flyout",onClose:this.closeFlyout,"aria-labelledby":"flyoutTitle"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyoutHeader,{hasBorder:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"m"},external_kbnSharedDeps_React_default.a.createElement("h1",{id:"flyoutTitle"},!0===isCreate?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.createRuleTitle",defaultMessage:"Create job rule"}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.editRuleTitle",defaultMessage:"Edit job rule"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyoutBody,null,external_kbnSharedDeps_React_default.a.createElement(DetectorDescriptionList,{job:job,detector:detector,anomaly:anomaly}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.rulesDescription",defaultMessage:"Job rules instruct anomaly detectors to change their behavior based on domain-specific knowledge that you provide. When you create a job rule, you can specify conditions, scope, and actions. When the conditions of a job rule are satisfied, its actions are triggered. {learnMoreLink}",values:{learnMoreLink:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{href:docsUrl,target:"_blank"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.rulesDescription.learnMoreLinkText",defaultMessage:"Learn more"}))}}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,null,external_kbnSharedDeps_React_default.a.createElement("h2",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.actionTitle",defaultMessage:"Action"}))),external_kbnSharedDeps_React_default.a.createElement(ActionsSection,{actions:rule.actions,onSkipResultChange:this.onSkipResultChange,onSkipModelUpdateChange:this.onSkipModelUpdateChange}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"xl"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,null,external_kbnSharedDeps_React_default.a.createElement("h2",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.conditionsTitle",defaultMessage:"Conditions"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),!0===conditionSupported?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCheckbox,{id:"enable_conditions_checkbox",className:"scope-enable-checkbox",label:conditionsText,checked:isConditionsEnabled,onChange:this.onConditionsEnabledChange,disabled:!conditionSupported||!hasPartitioningFields}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.conditionsNotSupportedTitle",defaultMessage:"Conditions are not supported for detectors using the {functionName} function",values:{functionName:anomaly.source.function}}),iconType:"iInCircle"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(ConditionsSection,{isEnabled:isConditionsEnabled,conditions:rule.conditions,addCondition:this.addCondition,updateCondition:this.updateCondition,deleteCondition:this.deleteCondition}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"xl"}),external_kbnSharedDeps_React_default.a.createElement(ScopeSection,{isEnabled:isScopeEnabled,onEnabledChange:this.onScopeEnabledChange,partitioningFieldNames:this.partitioningFieldNames,filterListIds:filterListIds,scope:rule.scope,updateScope:this.updateScope}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.rerunJobTitle",defaultMessage:"Rerun job"}),color:"warning",iconType:"help"},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.whenChangesTakeEffectDescription",defaultMessage:"Changes to job rules take effect for new results only."})),external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.howToApplyChangesToExistingResultsDescription",defaultMessage:"To apply these changes to existing results you must clone and rerun the job. Note rerunning the job may take some time and should only be done once you have completed all your changes to the rules for this job."})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyoutFooter,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{iconType:"cross",onClick:this.closeFlyout,flush:"left"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.closeButtonLabel",defaultMessage:"Close"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{onClick:this.saveEdit,isDisabled:!isValidRule(rule),fill:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.saveButtonLabel",defaultMessage:"Save"}))))))}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,flyout)}}const RuleEditorFlyout=Object(kibanaReact_public_.withKibana)(rule_editor_flyout_RuleEditorFlyoutUI);function anomalies_table_extends(){return(anomalies_table_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function anomalies_table_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class anomalies_table_AnomaliesTableInternal extends external_kbnSharedDeps_React_.Component{constructor(props){super(props),anomalies_table_defineProperty(this,"isShowingAggregatedData",()=>"second"!==this.props.tableData.interval),anomalies_table_defineProperty(this,"toggleRow",async(item,tab=ANOMALIES_TABLE_TABS_DETAILS)=>{const itemIdToExpandedRowMap={...this.state.itemIdToExpandedRowMap};if(itemIdToExpandedRowMap[item.rowId])delete itemIdToExpandedRowMap[item.rowId];else{const examples="mlcategory"===item.entityName?Object(external_kbnSharedDeps_Lodash_.get)(this.props.tableData,["examplesByJobId",item.jobId,item.entityValue]):void 0;let definition=void 0;if(void 0!==examples)try{definition=await ml_api_service.ml.results.getCategoryDefinition(item.jobId,item.source.mlcategory[0]),definition.terms&&definition.terms.length>500&&(definition.terms=definition.terms.substring(0,500)+"..."),definition.regex&&definition.regex.length>500&&(definition.terms=definition.regex.substring(0,500)+"...")}catch(error){console.log("Error fetching category definition for row item.",error)}itemIdToExpandedRowMap[item.rowId]=external_kbnSharedDeps_React_default.a.createElement(anomaly_details_AnomalyDetails,{tabIndex:tab,anomaly:item,examples:examples,definition:definition,isAggregatedData:this.isShowingAggregatedData(),filter:this.props.filter,influencerFilter:this.props.influencerFilter,influencersLimit:5})}this.setState({itemIdToExpandedRowMap:itemIdToExpandedRowMap})}),anomalies_table_defineProperty(this,"onMouseOverRow",record=>{void 0!==this.mouseOverRecord?this.mouseOverRecord.rowId!==record.rowId&&(table_service.a.rowMouseleave$.next({record:this.mouseOverRecord}),table_service.a.rowMouseenter$.next({record:record})):table_service.a.rowMouseenter$.next({record:record}),this.mouseOverRecord=record}),anomalies_table_defineProperty(this,"onMouseLeaveRow",()=>{void 0!==this.mouseOverRecord&&(table_service.a.rowMouseleave$.next({record:this.mouseOverRecord}),this.mouseOverRecord=void 0)}),anomalies_table_defineProperty(this,"setShowRuleEditorFlyoutFunction",func=>{this.setState({showRuleEditorFlyout:func})}),anomalies_table_defineProperty(this,"unsetShowRuleEditorFlyoutFunction",()=>{this.setState({showRuleEditorFlyout:()=>{}})}),anomalies_table_defineProperty(this,"onTableChange",({page:page,sort:sort})=>{const{tableState:tableState,updateTableState:updateTableState}=this.props;updateTableState({pageIndex:page&&void 0!==page.index?page.index:tableState.pageIndex,pageSize:page&&void 0!==page.size?page.size:tableState.pageSize,sortField:sort&&void 0!==sort.field&&"string"==typeof sort.field?sort.field:tableState.sortField,sortDirection:sort&&void 0!==sort.direction?sort.direction:tableState.sortDirection})}),this.state={itemIdToExpandedRowMap:{},showRuleEditorFlyout:()=>{}}}static getDerivedStateFromProps(nextProps,prevState){const itemIdToExpandedRowMap=prevState.itemIdToExpandedRowMap;return void 0!==Object.keys(itemIdToExpandedRowMap).find(rowId=>void 0===nextProps.tableData.anomalies.find(anomaly=>anomaly.rowId===rowId))?{itemIdToExpandedRowMap:{}}:null}render(){const{bounds:bounds,tableData:tableData,filter:filter,influencerFilter:influencerFilter,tableState:tableState}=this.props;if(void 0===tableData||void 0===tableData.anomalies||0===tableData.anomalies.length)return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceAround"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement("h4",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.anomaliesTable.noMatchingAnomaliesFoundTitle",defaultMessage:"No matching anomalies found"})))));const columns=anomalies_table_columns_getColumns(tableData.anomalies,tableData.jobIds,tableData.examplesByJobId,this.isShowingAggregatedData(),tableData.interval,bounds,tableData.showViewSeriesLink,this.state.showRuleEditorFlyout,this.state.itemIdToExpandedRowMap,this.toggleRow,filter,influencerFilter),sorting={sort:{field:tableState.sortField,direction:tableState.sortDirection}},pagination={pageIndex:tableState.pageIndex,pageSize:tableState.pageSize,totalItemCount:tableData.anomalies.length,pageSizeOptions:[10,25,100]};return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(RuleEditorFlyout,{setShowFunction:this.setShowRuleEditorFlyoutFunction,unsetShowFunction:this.unsetShowRuleEditorFlyoutFunction}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiInMemoryTable,{className:"ml-anomalies-table eui-textOverflowWrap",items:tableData.anomalies,columns:columns,pagination:pagination,sorting:sorting,itemId:"rowId",itemIdToExpandedRowMap:this.state.itemIdToExpandedRowMap,compressed:!0,rowProps:item=>({onMouseOver:()=>this.onMouseOverRow(item),onMouseLeave:()=>this.onMouseLeaveRow(),"data-test-subj":"mlAnomaliesListRow row-"+item.rowId}),"data-test-subj":"mlAnomaliesTable",onTableChange:this.onTableChange}))}}const AnomaliesTable=props=>{const[tableState,updateTableState]=Object(url_state.b)("mlAnomaliesTable",{pageIndex:0,pageSize:25,sortField:"severity",sortDirection:"desc"});return external_kbnSharedDeps_React_default.a.createElement(anomalies_table_AnomaliesTableInternal,anomalies_table_extends({},props,{tableState:tableState,updateTableState:updateTableState}))},MESSAGE_LEVEL_ERROR="error",MESSAGE_LEVEL_INFO="info",MESSAGE_LEVEL_SUCCESS="success",MESSAGE_LEVEL_WARNING="warning";function message_call_out_extends(){return(message_call_out_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function MessageCallOut({message:message,status:status,...rest}){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,message_call_out_extends({size:"s"},function(message,status){switch(status){case MESSAGE_LEVEL_ERROR:return{title:message,iconType:"cross",color:"danger"};case MESSAGE_LEVEL_WARNING:return{title:message,iconType:"alert",color:"warning"};case MESSAGE_LEVEL_SUCCESS:return{title:message,iconType:"check",color:"success"};case MESSAGE_LEVEL_INFO:return{title:message,iconType:"iInCircle",color:"primary"}}}(message,status),rest))}function forecasts_list_getColumns(viewForecast){return[{field:"forecast_create_timestamp",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.forecastsList.createdColumnName",{defaultMessage:"Created"}),dataType:"date",render:date=>Object(date_utils.c)(date),sortable:!0},{field:"forecast_start_timestamp",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.forecastsList.fromColumnName",{defaultMessage:"From"}),dataType:"date",render:date=>Object(date_utils.c)(date),sortable:!0},{field:"forecast_end_timestamp",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.forecastsList.toColumnName",{defaultMessage:"To"}),dataType:"date",render:date=>Object(date_utils.c)(date),sortable:!0},{name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.forecastsList.viewColumnName",{defaultMessage:"View"}),width:"60px",render:forecast=>{const viewForecastAriaLabel=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.forecastsList.viewForecastAriaLabel",{defaultMessage:"View forecast created at {createdDate}",values:{createdDate:Object(date_utils.c)(forecast.forecast_create_timestamp)}});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{onClick:()=>viewForecast(forecast.forecast_id),iconType:"visLine","aria-label":viewForecastAriaLabel})}}]}function ForecastsList({forecasts:forecasts,viewForecast:viewForecast}){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement("h3",{"aria-describedby":"ml_aria_description_forecasting_modal_view_list",style:{display:"inline",paddingRight:"5px"}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.forecastsList.previousForecastsTitle",defaultMessage:"Previous forecasts"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{position:"right",content:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.forecastsList.listsOfFiveRecentlyRunForecastsTooltip",defaultMessage:"Lists a maximum of five of the most recently run forecasts."})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{type:"questionInCircle",size:"s"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiInMemoryTable,{items:forecasts,columns:forecasts_list_getColumns(viewForecast),pagination:!1,"data-test-subj":"mlModalForecastTable"}))}ForecastsList.propType={forecasts:prop_types_default.a.array,viewForecast:prop_types_default.a.func.isRequired};const PROGRESS_STATES_UNSET=-1,PROGRESS_STATES_WAITING=0,PROGRESS_STATES_DONE=1,PROGRESS_STATES_ERROR=-10;function ProgressIcon({state:state}){return state===PROGRESS_STATES_WAITING?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingSpinner,{size:"m"}):state===PROGRESS_STATES_DONE?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{type:"check",size:"m",color:"primary"}):state===PROGRESS_STATES_ERROR?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{type:"cross",size:"m",color:"danger"}):void 0}function ForecastProgress({forecastProgress:forecastProgress,jobOpeningState:jobOpeningState,jobClosingState:jobClosingState}){return external_kbnSharedDeps_React_default.a.createElement("div",null,jobOpeningState!==PROGRESS_STATES_UNSET&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("h3",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.forecastingModal.openingJobTitle",defaultMessage:"Opening job…"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(ProgressIcon,{state:jobOpeningState}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"})),forecastProgress!==PROGRESS_STATES_UNSET&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("h3",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.forecastingModal.runningForecastTitle",defaultMessage:"Running forecast…"})))),forecastProgress>=0&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{position:"top",content:forecastProgress+"%"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiProgress,{size:"l",value:forecastProgress,max:100}))),forecastProgress===PROGRESS_STATES_ERROR&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(ProgressIcon,{state:PROGRESS_STATES_ERROR}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"})),jobClosingState!==PROGRESS_STATES_UNSET&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("h3",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.forecastingModal.closingJobTitle",defaultMessage:"Closing job…"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(ProgressIcon,{state:jobClosingState})))))}function RunControls({job:job,newForecastDuration:newForecastDuration,isNewForecastDurationValid:isNewForecastDurationValid,newForecastDurationErrors:newForecastDurationErrors,onNewForecastDurationChange:onNewForecastDurationChange,runForecast:runForecast,isForecastRequested:isForecastRequested,forecastProgress:forecastProgress,jobOpeningState:jobOpeningState,jobClosingState:jobClosingState}){const disabledState=function(job,isForecastRequested){return!1===Object(check_ml_nodes.b)()?{isDisabled:!0,isDisabledToolTipText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.runControls.noMLNodesAvailableTooltip",{defaultMessage:"There are no ML nodes available."})}:!1===Object(check_capabilities.e)("canForecastJob")?{isDisabled:!0,isDisabledToolTipText:Object(check_capabilities.f)("canForecastJob")}:job.state!==states.c.OPENED&&job.state!==states.c.CLOSED?{isDisabled:!0,isDisabledToolTipText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.runControls.forecastsCanNotBeRunOnJobsTooltip",{defaultMessage:"Forecasts cannot be run on {jobState} jobs",values:{jobState:job.state}})}:{isDisabled:isForecastRequested}}(job,isForecastRequested),durationInput=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldText,{name:"forecastDuration",value:newForecastDuration,disabled:disabledState.isDisabled,isInvalid:!isNewForecastDurationValid,onChange:onNewForecastDurationChange,fullWidth:!0}),runButton=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{onClick:runForecast,isDisabled:disabledState.isDisabled||!isNewForecastDurationValid,"data-test-subj":"mlModalForecastButtonRun"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.runControls.runButtonLabel",defaultMessage:"Run"}));return external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement("h3",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.runControls.runNewForecastTitle",defaultMessage:"Run a new forecast"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiForm,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.runControls.durationLabel",defaultMessage:"Duration"}),fullWidth:!0,isInvalid:!isNewForecastDurationValid,error:newForecastDurationErrors,helpText:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.runControls.forecastMaximumLengthHelpText",defaultMessage:"Length of forecast, up to a maximum of {maximumForecastDurationDays} days. Use s for seconds, m for minutes, h for hours, d for days, w for weeks.",values:{maximumForecastDurationDays:FORECAST_DURATION_MAX_DAYS}})},void 0===disabledState.isDisabledToolTipText?durationInput:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{position:"right",content:disabledState.isDisabledToolTipText},durationInput))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{hasEmptyLabelSpace:!0},void 0===disabledState.isDisabledToolTipText?runButton:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{position:"left",content:disabledState.isDisabledToolTipText},runButton))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),!0===isForecastRequested&&external_kbnSharedDeps_React_default.a.createElement(ForecastProgress,{forecastProgress:forecastProgress,jobOpeningState:jobOpeningState,jobClosingState:jobClosingState}))}function modal_Modal(props){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModal,{onClose:props.close,maxWidth:860,"data-test-subj":"mlModalForecast"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalHeader,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalHeaderTitle,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.forecastingModal.forecastingTitle",defaultMessage:"Forecasting"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalBody,null,props.messages.map((message,i)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,{key:i},external_kbnSharedDeps_React_default.a.createElement(MessageCallOut,message),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}))),props.forecasts.length>0&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(ForecastsList,{forecasts:props.forecasts,viewForecast:props.viewForecast}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null)),external_kbnSharedDeps_React_default.a.createElement(RunControls,props)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalFooter,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{onClick:props.close,size:"s","data-test-subj":"mlModalForecastButtonClose"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.forecastingModal.closeButtonLabel",defaultMessage:"Close"}))))}ForecastProgress.propType={forecastProgress:prop_types_default.a.number,jobOpeningState:prop_types_default.a.number,jobClosingState:prop_types_default.a.number},RunControls.propType={job:prop_types_default.a.object,newForecastDuration:prop_types_default.a.string,isNewForecastDurationValid:prop_types_default.a.bool,newForecastDurationErrors:prop_types_default.a.array,onNewForecastDurationChange:prop_types_default.a.func.isRequired,runForecast:prop_types_default.a.func.isRequired,isForecastRequested:prop_types_default.a.bool,forecastProgress:prop_types_default.a.number,jobOpeningState:prop_types_default.a.number,jobClosingState:prop_types_default.a.number},modal_Modal.propType={job:prop_types_default.a.object,forecasts:prop_types_default.a.array,close:prop_types_default.a.func.isRequired,viewForecast:prop_types_default.a.func.isRequired,runForecast:prop_types_default.a.func.isRequired,newForecastDuration:prop_types_default.a.string,isNewForecastDurationValid:prop_types_default.a.bool,newForecastDurationErrors:prop_types_default.a.array,onNewForecastDurationChange:prop_types_default.a.func.isRequired,isForecastRequested:prop_types_default.a.bool,forecastProgress:prop_types_default.a.number,jobOpeningState:prop_types_default.a.number,jobClosingState:prop_types_default.a.number,messages:prop_types_default.a.array};var forecast_service=__webpack_require__(168);function forecasting_modal_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}const FORECAST_DURATION_MAX_DAYS=3650,FORECAST_DURATION_MAX_MS=864e5*FORECAST_DURATION_MAX_DAYS;function forecasting_modal_getDefaultState(){return{isModalVisible:!1,previousForecasts:[],isForecastRequested:!1,forecastProgress:PROGRESS_STATES_UNSET,jobOpeningState:PROGRESS_STATES_UNSET,jobClosingState:PROGRESS_STATES_UNSET,newForecastDuration:"1d",isNewForecastDurationValid:!0,newForecastDurationErrors:[],messages:[]}}class forecasting_modal_ForecastingModalUI extends external_kbnSharedDeps_React_.Component{constructor(props){super(props),forecasting_modal_defineProperty(this,"addMessage",(message,status,clearFirst=!1)=>{const msg={message:message,status:status};this.setState(prevState=>({messages:clearFirst?[msg]:[...prevState.messages,msg]}))}),forecasting_modal_defineProperty(this,"viewForecast",forecastId=>{this.props.setForecastId(forecastId),this.closeModal()}),forecasting_modal_defineProperty(this,"onNewForecastDurationChange",event=>{const newForecastDurationErrors=[];let isNewForecastDurationValid=!0;const duration=Object(parse_interval.a)(event.target.value);null===duration?(isNewForecastDurationValid=!1,newForecastDurationErrors.push(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.forecastingModal.invalidDurationFormatErrorMessage",{defaultMessage:"Invalid duration format"}))):duration.asMilliseconds()>FORECAST_DURATION_MAX_MS?(isNewForecastDurationValid=!1,newForecastDurationErrors.push(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.forecastingModal.forecastDurationMustNotBeGreaterThanMaximumErrorMessage",{defaultMessage:"Forecast duration must not be greater than {maximumForecastDurationDays} days",values:{maximumForecastDurationDays:FORECAST_DURATION_MAX_DAYS}}))):0===duration.asMilliseconds()&&(isNewForecastDurationValid=!1,newForecastDurationErrors.push(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.forecastingModal.forecastDurationMustNotBeZeroErrorMessage",{defaultMessage:"Forecast duration must not be zero"}))),this.setState({newForecastDuration:event.target.value,isNewForecastDurationValid:isNewForecastDurationValid,newForecastDurationErrors:newForecastDurationErrors})}),forecasting_modal_defineProperty(this,"checkJobStateAndRunForecast",()=>{this.setState({isForecastRequested:!0,messages:[]}),this.props.job.state===states.c.CLOSED?this.openJobAndRunForecast():this.runForecast(!1)}),forecasting_modal_defineProperty(this,"openJobAndRunForecast",()=>{this.setState({jobOpeningState:PROGRESS_STATES_WAITING}),job_service.a.openJob(this.props.job.job_id).then(()=>{this.setState({jobOpeningState:PROGRESS_STATES_DONE}),this.runForecast(!0)}).catch(resp=>{console.log("Time series forecast modal - could not open job:",resp),this.addMessage(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.forecastingModal.errorWithOpeningJobBeforeRunningForecastErrorMessage",{defaultMessage:"Error opening job before running forecast"}),MESSAGE_LEVEL_ERROR),this.setState({jobOpeningState:PROGRESS_STATES_ERROR})})}),forecasting_modal_defineProperty(this,"runForecastErrorHandler",(resp,closeJob)=>{this.setState({forecastProgress:PROGRESS_STATES_ERROR}),console.log("Time series forecast modal - error running forecast:",resp),resp&&resp.message?this.addMessage(resp.message,MESSAGE_LEVEL_ERROR,!0):this.addMessage(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.forecastingModal.unexpectedResponseFromRunningForecastErrorMessage",{defaultMessage:"Unexpected response from running forecast. The request may have failed."}),MESSAGE_LEVEL_ERROR,!0),!0===closeJob&&(this.setState({jobClosingState:PROGRESS_STATES_WAITING}),job_service.a.closeJob(this.props.job.job_id).then(()=>{this.setState({jobClosingState:PROGRESS_STATES_DONE})}).catch(response=>{console.log("Time series forecast modal - could not close job:",response),this.addMessage(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.forecastingModal.errorWithClosingJobErrorMessage",{defaultMessage:"Error closing job"}),MESSAGE_LEVEL_ERROR),this.setState({jobClosingState:PROGRESS_STATES_ERROR})}))}),forecasting_modal_defineProperty(this,"runForecast",closeJobAfterRunning=>{this.setState({forecastProgress:0});const durationInSeconds=Object(parse_interval.a)(this.state.newForecastDuration).asSeconds();forecast_service.a.runForecast(this.props.job.job_id,durationInSeconds+"s").then(resp=>{void 0!==resp.forecast_id?this.waitForForecastResults(resp.forecast_id,closeJobAfterRunning):this.runForecastErrorHandler(resp,closeJobAfterRunning)}).catch(resp=>this.runForecastErrorHandler(resp,closeJobAfterRunning))}),forecasting_modal_defineProperty(this,"waitForForecastResults",(forecastId,closeJobAfterRunning)=>{let previousProgress=0,noProgressMs=0;this.forecastChecker=setInterval(()=>{forecast_service.a.getForecastRequestStats(this.props.job,forecastId).then(resp=>{const progress=Object(external_kbnSharedDeps_Lodash_.get)(resp,["stats","forecast_progress"],previousProgress),status=Object(external_kbnSharedDeps_Lodash_.get)(resp,["stats","forecast_status"]);progress>previousProgress&&this.setState({forecastProgress:Math.round(100*progress)});let messages=Object(external_kbnSharedDeps_Lodash_.get)(resp,["stats","forecast_messages"],[]);messages=messages.map(message=>({message:message,status:MESSAGE_LEVEL_WARNING})),this.setState({messages:messages}),status===states.b.FINISHED?(clearInterval(this.forecastChecker),!0===closeJobAfterRunning?(this.setState({jobClosingState:PROGRESS_STATES_WAITING}),job_service.a.closeJob(this.props.job.job_id).then(()=>{this.setState({jobClosingState:PROGRESS_STATES_DONE}),this.props.setForecastId(forecastId),this.closeAfterRunningForecast()}).catch(response=>{console.log("Time series forecast modal - could not close job:",response),this.addMessage(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.forecastingModal.errorWithClosingJobAfterRunningForecastErrorMessage",{defaultMessage:"Error closing job after running forecast"}),MESSAGE_LEVEL_ERROR),this.setState({jobClosingState:PROGRESS_STATES_ERROR}),this.props.setForecastId(forecastId)})):(this.props.setForecastId(forecastId),this.closeAfterRunningForecast())):progress===previousProgress?(noProgressMs+=250,noProgressMs>12e4&&(console.log("Forecast request has not progressed for 120000ms. Cancelling check."),this.addMessage(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.forecastingModal.noProgressReportedForNewForecastErrorMessage",{defaultMessage:"No progress reported for the new forecast for {WarnNoProgressMs}ms.An error may have occurred whilst running the forecast.",values:{WarnNoProgressMs:12e4}}),MESSAGE_LEVEL_ERROR),this.props.setForecastId(forecastId),this.setState({forecastProgress:PROGRESS_STATES_ERROR}),clearInterval(this.forecastChecker))):(progress>previousProgress&&(previousProgress=progress),noProgressMs=0)}).catch(resp=>{console.log("Time series forecast modal - error loading stats of forecast from elasticsearch:",resp),this.addMessage(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.forecastingModal.errorWithLoadingStatsOfRunningForecastErrorMessage",{defaultMessage:"Error loading stats of running forecast."}),MESSAGE_LEVEL_ERROR),this.setState({forecastProgress:PROGRESS_STATES_ERROR}),clearInterval(this.forecastChecker)})},250)}),forecasting_modal_defineProperty(this,"openModal",()=>{const job=this.props.job;if("object"==typeof job){const{timefilter:timefilter}=this.props.kibana.services.data.query.timefilter,bounds=timefilter.getActiveBounds(),statusFinishedQuery={term:{forecast_status:states.b.FINISHED}};forecast_service.a.getForecastsSummary(job,statusFinishedQuery,bounds.min.valueOf(),5).then(resp=>{this.setState({previousForecasts:resp.forecasts})}).catch(resp=>{console.log("Time series forecast modal - error obtaining forecasts summary:",resp),this.addMessage(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.forecastingModal.errorWithObtainingListOfPreviousForecastsErrorMessage",{defaultMessage:"Error obtaining list of previous forecasts"}),MESSAGE_LEVEL_ERROR)});const entityFieldNames=this.props.entities.map(entity=>entity.fieldName);entityFieldNames.length>0&&ml_api_service.ml.getCardinalityOfFields({index:job.datafeed_config.indices,fieldNames:entityFieldNames,query:job.datafeed_config.query,timeFieldName:job.data_description.time_field,earliestMs:job.data_counts.earliest_record_timestamp,latestMs:job.data_counts.latest_record_timestamp}).then(results=>{let numPartitions=1;Object.values(results).forEach(cardinality=>{numPartitions*=cardinality}),numPartitions>100&&this.addMessage(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.forecastingModal.dataContainsMorePartitionsMessage",{defaultMessage:"Note that this data contains more than {warnNumPartitions} partitions so running a forecast may take a long time and consume a high amount of resource",values:{warnNumPartitions:100}}),MESSAGE_LEVEL_WARNING)}).catch(resp=>{console.log("Time series forecast modal - error obtaining cardinality of fields:",resp)}),this.setState({isModalVisible:!0})}}),forecasting_modal_defineProperty(this,"closeAfterRunningForecast",()=>{0===this.state.messages.length&&setTimeout(()=>{this.closeModal()},1e3)}),forecasting_modal_defineProperty(this,"closeModal",()=>{null!==this.forecastChecker&&clearInterval(this.forecastChecker),this.setState(forecasting_modal_getDefaultState())}),this.state=forecasting_modal_getDefaultState(),this.forecastChecker=null}render(){let isForecastingDisabled=!1,forecastingDisabledMessage=null;const{job:job}=this.props;if(void 0!==job){void 0!==job.analysis_config.detectors[this.props.detectorIndex].over_field_name?(isForecastingDisabled=!0,forecastingDisabledMessage=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.forecastingModal.forecastingNotAvailableForPopulationDetectorsMessage",{defaultMessage:"Forecasting is not available for population detectors with an over field"})):!1===Object(job_utils.j)(job,"6.1.0")&&(isForecastingDisabled=!0,forecastingDisabledMessage=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.forecastingModal.forecastingOnlyAvailableForJobsCreatedInSpecifiedVersionMessage",{defaultMessage:"Forecasting is only available for jobs created in version {minVersion} or later",values:{minVersion:"6.1.0"}}))}const forecastButton=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{onClick:this.openModal,isDisabled:isForecastingDisabled,"data-test-subj":"mlSingleMetricViewerButtonForecast"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.forecastingModal.forecastButtonLabel",defaultMessage:"Forecast"}));return external_kbnSharedDeps_React_default.a.createElement("div",null,isForecastingDisabled?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{position:"left",content:forecastingDisabledMessage},forecastButton):forecastButton,this.state.isModalVisible&&external_kbnSharedDeps_React_default.a.createElement(modal_Modal,{job:this.props.job,forecasts:this.state.previousForecasts,close:this.closeModal,viewForecast:this.viewForecast,runForecast:this.checkJobStateAndRunForecast,newForecastDuration:this.state.newForecastDuration,onNewForecastDurationChange:this.onNewForecastDurationChange,isNewForecastDurationValid:this.state.isNewForecastDurationValid,newForecastDurationErrors:this.state.newForecastDurationErrors,isForecastRequested:this.state.isForecastRequested,forecastProgress:this.state.forecastProgress,jobOpeningState:this.state.jobOpeningState,jobClosingState:this.state.jobClosingState,messages:this.state.messages}))}}const ForecastingModal=Object(kibanaReact_public_.withKibana)(forecasting_modal_ForecastingModalUI);var loading_indicator=__webpack_require__(268);const OPTIONS=[{value:"auto",text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.controls.selectInterval.autoLabel",{defaultMessage:"Auto"})},{value:"hour",text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.controls.selectInterval.hourLabel",{defaultMessage:"1 hour"})},{value:"day",text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.controls.selectInterval.dayLabel",{defaultMessage:"1 day"})},{value:"second",text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.controls.selectInterval.showAllLabel",{defaultMessage:"Show all"})}];function optionValueToInterval(value){const option=OPTIONS.find(opt=>opt.value===value);let interval={display:OPTIONS[0].text,val:OPTIONS[0].value};return void 0!==option&&(interval={display:option.text,val:option.value}),interval}const TABLE_INTERVAL_DEFAULT=optionValueToInterval("auto"),useTableInterval=()=>Object(url_state.b)("mlSelectInterval",TABLE_INTERVAL_DEFAULT),SelectInterval=()=>{const[interval,setInterval]=useTableInterval();return external_kbnSharedDeps_React_default.a.createElement(SelectIntervalUI,{interval:interval,onChange:setInterval})},SelectIntervalUI=({interval:interval,onChange:onChange})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSelect,{options:OPTIONS,className:"ml-select-interval",value:interval.val,onChange:e=>{onChange(optionValueToInterval(e.target.value))}});var select_severity=__webpack_require__(121);const TimeseriesexplorerNoChartData=({dataNotChartable:dataNotChartable,entities:entities})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiEmptyPrompt,{iconType:"iInCircle",title:external_kbnSharedDeps_React_default.a.createElement("h2",null,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.noResultsFoundLabel",{defaultMessage:"No results found"})),body:dataNotChartable?external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.dataNotChartableDescription",{defaultMessage:"Model plot is not collected for the selected {entityCount, plural, one {entity} other {entities}}\nand the source data cannot be plotted for this detector.",values:{entityCount:entities.length}})):external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.tryWideningTheTimeSelectionDescription",{defaultMessage:"Try widening the time selection or moving further back in time."}))}),AnomalyResultsViewSelector=({viewId:viewId})=>{const urlGenerator=Object(contexts_kibana.d)(),navigateToPath=Object(contexts_kibana.e)(),toggleButtonsIcons=Object(external_kbnSharedDeps_React_.useMemo)(()=>[{id:"timeseriesexplorer",label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.anomalyResultsViewSelector.singleMetricViewerLabel",{defaultMessage:"View results in the Single Metric Viewer"}),iconType:"visLine",value:ml_url_generator.b.SINGLE_METRIC_VIEWER,"data-test-subj":"mlAnomalyResultsViewSelectorSingleMetricViewer"},{id:"explorer",label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.anomalyResultsViewSelector.anomalyExplorerLabel",{defaultMessage:"View results in the Anomaly Explorer"}),iconType:"visTable",value:ml_url_generator.b.ANOMALY_EXPLORER,"data-test-subj":"mlAnomalyResultsViewSelectorExplorer"}],[]),[globalState]=Object(url_state.c)("_g");return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonGroup,{legend:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.anomalyResultsViewSelector.buttonGroupLegend",{defaultMessage:"Anomaly results view selector"}),name:"anomalyResultsViewSelector","data-test-subj":"mlAnomalyResultsViewSelector",options:toggleButtonsIcons,idSelected:viewId,onChange:newViewId=>(async newViewId=>{const url=await urlGenerator.createUrl({page:newViewId,pageState:{globalState:globalState}});await navigateToPath(url)})(newViewId),isIconOnly:!0})};var job_selector=__webpack_require__(226);const TimeSeriesExplorerPage=({children:children,dateFormatTz:dateFormatTz,resizeRef:resizeRef})=>{const{services:{docLinks:docLinks}}=Object(contexts_kibana.b)(),helpLink=docLinks.links.ml.anomalyDetection;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(navigation_menu.a,{tabId:"anomaly_detection"}),external_kbnSharedDeps_React_default.a.createElement("div",{className:"ml-time-series-explorer",ref:resizeRef,"data-test-subj":"mlPageSingleMetricViewer"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPage,{style:{background:"none"}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageBody,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageHeader,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageHeaderSection,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(AnomalyResultsViewSelector,{viewId:"timeseriesexplorer"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{className:"eui-textNoWrap"},external_kbnSharedDeps_React_default.a.createElement("h1",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.pageTitle",defaultMessage:"Single Metric Viewer"})))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageHeaderSection,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(date_picker_wrapper.a,null))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHorizontalRule,{margin:"none"}),external_kbnSharedDeps_React_default.a.createElement(job_selector.a,{dateFormatTz:dateFormatTz,singleSelection:!0,timeseriesOnly:!0}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHorizontalRule,{margin:"none"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),children)),external_kbnSharedDeps_React_default.a.createElement(help_menu.a,{docLink:helpLink})))},APP_STATE_ACTION_CLEAR="CLEAR",APP_STATE_ACTION_SET_DETECTOR_INDEX="SET_DETECTOR_INDEX",APP_STATE_ACTION_SET_ENTITIES="SET_ENTITIES",APP_STATE_ACTION_SET_FORECAST_ID="SET_FORECAST_ID",APP_STATE_ACTION_SET_ZOOM="SET_ZOOM",APP_STATE_ACTION_UNSET_ZOOM="UNSET_ZOOM",APP_STATE_ACTION_SET_FUNCTION_DESCRIPTION="SET_FUNCTION_DESCRIPTION";function buildConfigFromDetector(job,detectorIndex){const analysisConfig=job.analysis_config,detector=analysisConfig.detectors[detectorIndex],config={jobId:job.job_id,detectorIndex:detectorIndex,metricFunction:detector.function===aggregation_types.b.LAT_LONG?aggregation_types.b.LAT_LONG:Object(job_utils.q)(detector.function),timeField:job.data_description.time_field,interval:job.analysis_config.bucket_span,datafeedConfig:job.datafeed_config,summaryCountFieldName:job.analysis_config.summary_count_field_name};void 0!==detector.field_name&&(config.metricFieldName=detector.field_name);const summaryCountFieldName=analysisConfig.summary_count_field_name;if(config.metricFunction===aggregation_types.a.COUNT&&void 0!==summaryCountFieldName&&summaryCountFieldName!==field_types.a&&summaryCountFieldName!==field_types.e){let cardinalityField=void 0;const topAgg=Object(external_kbnSharedDeps_Lodash_.get)(job.datafeed_config,"aggregations")||Object(external_kbnSharedDeps_Lodash_.get)(job.datafeed_config,"aggs");void 0!==topAgg&&Object.values(topAgg).length>0&&(cardinalityField=Object(external_kbnSharedDeps_Lodash_.get)(Object.values(topAgg)[0],["aggregations",summaryCountFieldName,aggregation_types.a.CARDINALITY,"field"])||Object(external_kbnSharedDeps_Lodash_.get)(Object.values(topAgg)[0],["aggs",summaryCountFieldName,aggregation_types.a.CARDINALITY,"field"])),detector.function!==aggregation_types.b.NON_ZERO_COUNT&&detector.function!==aggregation_types.b.LOW_NON_ZERO_COUNT&&detector.function!==aggregation_types.b.HIGH_NON_ZERO_COUNT&&detector.function!==aggregation_types.b.COUNT&&detector.function!==aggregation_types.b.HIGH_COUNT&&detector.function!==aggregation_types.b.LOW_COUNT||void 0===cardinalityField?(config.metricFunction=aggregation_types.a.SUM,config.metricFieldName=summaryCountFieldName):(config.metricFunction=aggregation_types.a.CARDINALITY,config.metricFieldName=void 0)}return config}const mlTimeSeriesSearchService={getMetricData:function(job,detectorIndex,entityFields,earliestMs,latestMs,intervalMs,esMetricFunction){if(Object(job_utils.l)(job,detectorIndex)&&Object(job_utils.m)(job,detectorIndex,entityFields)){const criteriaFields=[],detector=job.analysis_config.detectors[detectorIndex];if(void 0!==detector.partition_field_name){const partitionEntity=Object(external_kbnSharedDeps_Lodash_.find)(entityFields,{fieldName:detector.partition_field_name});void 0!==partitionEntity&&criteriaFields.push({fieldName:"partition_field_name",fieldValue:partitionEntity.fieldName},{fieldName:"partition_field_value",fieldValue:partitionEntity.fieldValue})}if(void 0!==detector.over_field_name){const overEntity=Object(external_kbnSharedDeps_Lodash_.find)(entityFields,{fieldName:detector.over_field_name});void 0!==overEntity&&criteriaFields.push({fieldName:"over_field_name",fieldValue:overEntity.fieldName},{fieldName:"over_field_value",fieldValue:overEntity.fieldValue})}if(void 0!==detector.by_field_name){const byEntity=Object(external_kbnSharedDeps_Lodash_.find)(entityFields,{fieldName:detector.by_field_name});void 0!==byEntity&&criteriaFields.push({fieldName:"by_field_name",fieldValue:byEntity.fieldName},{fieldName:"by_field_value",fieldValue:byEntity.fieldValue})}return results_service.mlResultsService.getModelPlotOutput(job.job_id,detectorIndex,criteriaFields,earliestMs,latestMs,intervalMs)}{const obj={success:!0,results:{}},chartConfig=buildConfigFromDetector(job,detectorIndex);return results_service.mlResultsService.getMetricData(chartConfig.datafeedConfig.indices,entityFields,chartConfig.datafeedConfig.query,null!=esMetricFunction?esMetricFunction:chartConfig.metricFunction,chartConfig.metricFieldName,chartConfig.summaryCountFieldName,chartConfig.timeField,earliestMs,latestMs,intervalMs,null==chartConfig?void 0:chartConfig.datafeedConfig).pipe(Object(external_kbnSharedDeps_RxjsOperators_.map)(resp=>(Object(external_kbnSharedDeps_Lodash_.each)(resp.results,(value,time)=>{obj.results[time]={actual:value}}),obj)))}},getChartDetails:function(job,detectorIndex,entityFields,earliestMs,latestMs){return new Promise((resolve,reject)=>{const obj={success:!0,results:{functionLabel:"",entityData:{entities:[]}}},chartConfig=buildConfigFromDetector(job,detectorIndex);let functionLabel=chartConfig.metricFunction;void 0!==chartConfig.metricFieldName&&(functionLabel+=" ",functionLabel+=chartConfig.metricFieldName),obj.results.functionLabel=functionLabel;const blankEntityFields=Object(external_kbnSharedDeps_Lodash_.filter)(entityFields,entity=>null===entity.fieldValue);if(0===blankEntityFields.length)obj.results.entityData.count=1,obj.results.entityData.entities=entityFields,resolve(obj);else{const entityFieldNames=blankEntityFields.map(f=>f.fieldName);ml_api_service.ml.getCardinalityOfFields({index:chartConfig.datafeedConfig.indices,fieldNames:entityFieldNames,query:chartConfig.datafeedConfig.query,timeFieldName:chartConfig.timeField,earliestMs:earliestMs,latestMs:latestMs}).then(results=>{Object(external_kbnSharedDeps_Lodash_.each)(blankEntityFields,field=>{obj.results.entityData.entities.push({fieldName:field.fieldName,cardinality:Object(external_kbnSharedDeps_Lodash_.get)(results,field.fieldName,0)})}),resolve(obj)}).catch(resp=>{reject(resp)})}})}};function createTimeSeriesJobData(jobs){return jobs.filter(job_utils.p).map(job=>{const bucketSpan=Object(parse_interval.a)(job.analysis_config.bucket_span);return{id:job.job_id,selected:!1,bucketSpanSeconds:bucketSpan.asSeconds()}})}function processMetricPlotResults(metricPlotData,modelPlotEnabled){const metricPlotChartData=[];return!0===modelPlotEnabled?Object(external_kbnSharedDeps_Lodash_.each)(metricPlotData,(dataForTime,time)=>{metricPlotChartData.push({date:new Date(+time),lower:dataForTime.modelLower,value:dataForTime.actual,upper:dataForTime.modelUpper})}):Object(external_kbnSharedDeps_Lodash_.each)(metricPlotData,(dataForTime,time)=>{metricPlotChartData.push({date:new Date(+time),value:dataForTime.actual})}),metricPlotChartData}function processForecastResults(forecastData){const forecastPlotChartData=[];return Object(external_kbnSharedDeps_Lodash_.each)(forecastData,(dataForTime,time)=>{forecastPlotChartData.push({date:new Date(+time),isForecast:!0,lower:dataForTime.forecastLower,value:dataForTime.prediction,upper:dataForTime.forecastUpper})}),forecastPlotChartData}function processScheduledEventsForChart(chartData,scheduledEvents){return void 0!==scheduledEvents&&Object(external_kbnSharedDeps_Lodash_.each)(scheduledEvents,(events,time)=>{const chartPoint=function(chartData,time){let chartPoint;if(void 0===chartData)return chartPoint;for(let i=0;i<chartData.length;i++)if(chartData[i].date.getTime()===time){chartPoint=chartData[i];break}if(void 0===chartPoint){let foundItem;for(let i=0;i<chartData.length;i++){const itemTime=chartData[i].date.getTime();if(itemTime>time){const item=chartData[i],previousItem=chartData[i-1],diff1=Math.abs(time-previousItem.date.getTime()),diff2=Math.abs(time-itemTime);foundItem=void 0===previousItem||diff1>diff2?item:previousItem;break}}chartPoint=foundItem}return chartPoint}(chartData,time);void 0!==chartPoint&&(chartPoint.scheduledEvents=events)}),chartData}function findChartPointForAnomalyTime(chartData,anomalyTime,aggregationInterval){let chartPoint;if(void 0===chartData)return chartPoint;for(let i=0;i<chartData.length;i++)if(chartData[i].date.getTime()===anomalyTime){chartPoint=chartData[i];break}if(void 0===chartPoint){let foundItem;const intervalMs=aggregationInterval.asMilliseconds();for(let i=0;i<chartData.length;i++){if(anomalyTime-chartData[i].date.getTime()<intervalMs){foundItem=chartData[i];break}}chartPoint=foundItem}return chartPoint}function calculateAggregationInterval(bounds,bucketsTarget,jobs,selectedJob){const barTarget=void 0!==bucketsTarget?bucketsTarget:100,maxBars=Math.floor(1.1*barTarget),buckets=Object(time_buckets.c)();buckets.setInterval("auto"),buckets.setBounds(bounds),buckets.setBarTarget(Math.floor(barTarget)),buckets.setMaxBars(maxBars);const bucketSpanSeconds=Object(external_kbnSharedDeps_Lodash_.find)(jobs,{id:selectedJob.job_id}).bucketSpanSeconds;let aggInterval=buckets.getIntervalToNearestMultiple(bucketSpanSeconds);return aggInterval.asSeconds()<bucketSpanSeconds&&(buckets.setInterval(bucketSpanSeconds+"s"),aggInterval=buckets.getInterval()),aggInterval}var constants_annotations=__webpack_require__(137);function getFocusData(criteriaFields,detectorIndex,focusAggregationInterval,forecastId,modelPlotEnabled,nonBlankEntities,searchBounds,selectedJob,functionDescription){const esFunctionToPlotIfMetric=void 0!==functionDescription?anomaly_utils.c.toES(functionDescription):functionDescription;return Object(external_kbnSharedDeps_Rxjs_.forkJoin)([mlTimeSeriesSearchService.getMetricData(selectedJob,detectorIndex,nonBlankEntities,searchBounds.min.valueOf(),searchBounds.max.valueOf(),focusAggregationInterval.asMilliseconds(),esFunctionToPlotIfMetric),results_service.mlResultsService.getRecordsForCriteria([selectedJob.job_id],criteriaFields,0,searchBounds.min.valueOf(),searchBounds.max.valueOf(),constants_search.b,functionDescription),results_service.mlResultsService.getScheduledEventsByBucket([selectedJob.job_id],searchBounds.min.valueOf(),searchBounds.max.valueOf(),focusAggregationInterval.asMilliseconds(),1,10),ml_api_service.ml.annotations.getAnnotations$({jobIds:[selectedJob.job_id],earliestMs:searchBounds.min.valueOf(),latestMs:searchBounds.max.valueOf(),maxAnnotations:constants_search.a,fields:[{field:"event",missing:constants_annotations.b}],detectorIndex:detectorIndex,entities:nonBlankEntities}).pipe(Object(external_kbnSharedDeps_RxjsOperators_.catchError)(resp=>Object(external_kbnSharedDeps_Rxjs_.of)({annotations:{},aggregations:{},error:Object(util_errors.i)(resp),success:!1}))),void 0!==forecastId?(()=>{let aggType;const detector=selectedJob.analysis_config.detectors[detectorIndex],esAgg=Object(job_utils.q)(detector.function);return modelPlotEnabled||"sum"!==esAgg&&"count"!==esAgg||(aggType={avg:"sum",max:"sum",min:"sum"}),forecast_service.a.getForecastData(selectedJob,detectorIndex,forecastId,nonBlankEntities,searchBounds.min.valueOf(),searchBounds.max.valueOf(),focusAggregationInterval.asMilliseconds(),aggType)})():Object(external_kbnSharedDeps_Rxjs_.of)(null)]).pipe(Object(external_kbnSharedDeps_RxjsOperators_.map)(([metricData,recordsForCriteria,scheduledEventsByBucket,annotations,forecastData])=>{const anomalyRecords=recordsForCriteria.records.sort((a,b)=>a.timestamp-b.timestamp).reverse(),scheduledEvents=scheduledEventsByBucket.events[selectedJob.job_id];let focusChartData=processMetricPlotResults(metricData.results,modelPlotEnabled);focusChartData=function(chartData,anomalyRecords,aggregationInterval,modelPlotEnabled,functionDescription){const timesToAddPointsFor=[],intervalMs=aggregationInterval.asMilliseconds();let lastChartDataPointTime=void 0;return void 0!==chartData&&chartData.length>0&&(lastChartDataPointTime=chartData[chartData.length-1].date.getTime()),anomalyRecords.forEach(record=>{const recordTime=record.timestamp;if(void 0===findChartPointForAnomalyTime(chartData,recordTime,aggregationInterval)){const timeToAdd=Math.floor(recordTime/intervalMs)*intervalMs;-1===timesToAddPointsFor.indexOf(timeToAdd)&&timeToAdd!==lastChartDataPointTime&&timesToAddPointsFor.push(timeToAdd)}}),timesToAddPointsFor.sort((a,b)=>a-b),timesToAddPointsFor.forEach(time=>{const pointToAdd={date:new Date(time),value:null};!0===modelPlotEnabled&&(pointToAdd.upper=null,pointToAdd.lower=null),chartData.push(pointToAdd)}),anomalyRecords.forEach(record=>{const recordTime=record.timestamp;if(record.function===aggregation_types.b.METRIC&&record.function_description!==functionDescription)return;const chartPoint=findChartPointForAnomalyTime(chartData,recordTime,aggregationInterval);if(void 0!==chartPoint){const recordScore=record.record_score,pointScore=chartPoint.anomalyScore;if(void 0===pointScore||pointScore<recordScore){if(chartPoint.anomalyScore=recordScore,chartPoint.function=record.function,void 0!==record.actual)null===chartPoint.value&&(chartPoint.value=record.actual),record.function===aggregation_types.b.METRIC&&(chartPoint.value=Array.isArray(record.actual)?record.actual[0]:record.actual),chartPoint.actual=record.actual,chartPoint.typical=record.typical;else{const causes=Object(external_kbnSharedDeps_Lodash_.get)(record,"causes",[]);if(causes.length>0&&(chartPoint.byFieldName=record.by_field_name,chartPoint.numberOfCauses=causes.length,1===causes.length)){const cause=record.causes[0];chartPoint.actual=cause.actual,chartPoint.typical=cause.typical,null===chartPoint.value&&(chartPoint.value=cause.actual)}}void 0!==record.multi_bucket_impact&&(chartPoint.multiBucketImpact=record.multi_bucket_impact)}}}),chartData}(focusChartData,anomalyRecords,focusAggregationInterval,modelPlotEnabled,functionDescription),focusChartData=processScheduledEventsForChart(focusChartData,scheduledEvents);const refreshFocusData={scheduledEvents:scheduledEvents,anomalyRecords:anomalyRecords,focusChartData:focusChartData};var _annotations$annotati;annotations&&(void 0!==annotations.error?(refreshFocusData.focusAnnotationError=annotations.error,refreshFocusData.focusAnnotationData=[],refreshFocusData.focusAggregations={}):(refreshFocusData.focusAnnotationData=(null!==(_annotations$annotati=annotations.annotations[selectedJob.job_id])&&void 0!==_annotations$annotati?_annotations$annotati:[]).sort((a,b)=>a.timestamp-b.timestamp).map((d,i)=>(d.key=(i+1).toString(),d)),refreshFocusData.focusAggregations=annotations.aggregations));return forecastData&&(refreshFocusData.focusForecastData=processForecastResults(forecastData.results),refreshFocusData.showForecastCheckbox=refreshFocusData.focusForecastData.length>0),refreshFocusData}))}var job_select_service_utils=__webpack_require__(269);var constants_settings=__webpack_require__(243);function getControlsForDetector(selectedDetectorIndex,selectedEntities,selectedJobId){const selectedJob=job_service.a.getJob(selectedJobId),entities=[];if(void 0===selectedJob)return entities;const detectorIndex=selectedDetectorIndex,detector=selectedJob.analysis_config.detectors[detectorIndex],entitiesState=selectedEntities,partitionFieldName=null==detector?void 0:detector.partition_field_name,overFieldName=null==detector?void 0:detector.over_field_name,byFieldName=null==detector?void 0:detector.by_field_name;if(void 0!==partitionFieldName){var _entitiesState$partit;const partitionFieldValue=null!==(_entitiesState$partit=null==entitiesState?void 0:entitiesState[partitionFieldName])&&void 0!==_entitiesState$partit?_entitiesState$partit:null;entities.push({fieldType:"partition_field",fieldName:partitionFieldName,fieldValue:partitionFieldValue})}if(void 0!==overFieldName){var _entitiesState$overFi;const overFieldValue=null!==(_entitiesState$overFi=null==entitiesState?void 0:entitiesState[overFieldName])&&void 0!==_entitiesState$overFi?_entitiesState$overFi:null;entities.push({fieldType:"over_field",fieldName:overFieldName,fieldValue:overFieldValue})}if(void 0!==byFieldName&&void 0===overFieldName){var _entitiesState$byFiel;const byFieldValue=null!==(_entitiesState$byFiel=null==entitiesState?void 0:entitiesState[byFieldName])&&void 0!==_entitiesState$byFiel?_entitiesState$byFiel:null;entities.push({fieldType:"by_field",fieldName:byFieldName,fieldValue:byFieldValue})}return entities}var storage=__webpack_require__(381),use_storage=__webpack_require__(380);function getViewableDetectors(selectedJob){const jobDetectors=selectedJob.analysis_config.detectors,viewableDetectors=[];return jobDetectors.forEach((dtr,index)=>{Object(job_utils.o)(selectedJob,index)&&viewableDetectors.push({index:index,detector_description:dtr.detector_description,function:dtr.function})}),viewableDetectors}function isMetricDetector(selectedJob,selectedDetectorIndex){const detectors=getViewableDetectors(selectedJob);if(Array.isArray(detectors)&&detectors.length>=selectedDetectorIndex){const detector=selectedJob.analysis_config.detectors[selectedDetectorIndex];if((null==detector?void 0:detector.function)===aggregation_types.b.METRIC)return!0}return!1}const plotByFunctionOptions=[{value:"mean",text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.plotByAvgOptionLabel",{defaultMessage:"mean"})},{value:"min",text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.plotByMinOptionLabel",{defaultMessage:"min"})},{value:"max",text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.plotByMaxOptionLabel",{defaultMessage:"max"})}],PlotByFunctionControls=({functionDescription:functionDescription,setFunctionDescription:setFunctionDescription,selectedDetectorIndex:selectedDetectorIndex,selectedJobId:selectedJobId,selectedEntities:selectedEntities,entityControlsCount:entityControlsCount})=>{const toastNotificationService=Object(toast_notification_service.c)(),getFunctionDescriptionToPlot=Object(external_kbnSharedDeps_React_.useCallback)(async(_selectedDetectorIndex,_selectedEntities,_selectedJobId,_selectedJob)=>{const functionToPlot=await(async({selectedDetectorIndex:selectedDetectorIndex,selectedEntities:selectedEntities,selectedJobId:selectedJobId,selectedJob:selectedJob},toastNotificationService)=>{if(!isMetricDetector(selectedJob,selectedDetectorIndex))return;const entityControls=getControlsForDetector(selectedDetectorIndex,selectedEntities,selectedJobId),criteriaFields=[{fieldName:"detector_index",fieldValue:selectedDetectorIndex},...entityControls.filter(entity=>null!==entity.fieldValue)];try{const resp=await results_service.mlResultsService.getRecordsForCriteria([selectedJob.job_id],criteriaFields,0,null,null,1).toPromise();if(Array.isArray(null==resp?void 0:resp.records)&&1===resp.records.length){const highestScoringAnomaly=resp.records[0];return null==highestScoringAnomaly?void 0:highestScoringAnomaly.function_description}return aggregation_types.a.AVG}catch(error){toastNotificationService.displayErrorToast(error,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.highestAnomalyScoreErrorToastTitle",{defaultMessage:"An error occurred getting record with the highest anomaly score"}))}})({selectedDetectorIndex:_selectedDetectorIndex,selectedEntities:_selectedEntities,selectedJobId:_selectedJobId,selectedJob:_selectedJob},toastNotificationService);setFunctionDescription(functionToPlot)},[setFunctionDescription,toastNotificationService]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{if(void 0!==functionDescription)return;const selectedJob=job_service.a.getJob(selectedJobId);if((0===entityControlsCount||entityControlsCount>0&&void 0!==selectedEntities)&&void 0===functionDescription&&isMetricDetector(selectedJob,selectedDetectorIndex)){const detector=selectedJob.analysis_config.detectors[selectedDetectorIndex];(null==detector?void 0:detector.function)===aggregation_types.b.METRIC&&getFunctionDescriptionToPlot(selectedDetectorIndex,selectedEntities,selectedJobId,selectedJob)}},[setFunctionDescription,selectedDetectorIndex,selectedEntities,selectedJobId,functionDescription,entityControlsCount]),void 0===functionDescription?null:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.metricPlotByOption",{defaultMessage:"Function"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSelect,{options:plotByFunctionOptions,value:functionDescription,onChange:e=>setFunctionDescription(e.target.value),"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.metricPlotByOptionLabel",{defaultMessage:"Pick function to plot by (min, max, or average) if metric function"})})))};const SeriesControls=({bounds:bounds,selectedDetectorIndex:selectedDetectorIndex,selectedJobId:selectedJobId,appStateHandler:appStateHandler,children:children,selectedEntities:selectedEntities,functionDescription:functionDescription,setFunctionDescription:setFunctionDescription})=>{var _selectedJob$model_pl;const{services:{mlServices:{mlApiServices:{results:mlResultsService}}}}=Object(contexts_kibana.b)(),selectedJob=Object(external_kbnSharedDeps_React_.useMemo)(()=>job_service.a.getJob(selectedJobId),[selectedJobId]),isModelPlotEnabled=!(null===(_selectedJob$model_pl=selectedJob.model_plot_config)||void 0===_selectedJob$model_pl||!_selectedJob$model_pl.enabled),[entitiesLoading,setEntitiesLoading]=Object(external_kbnSharedDeps_React_.useState)(!1),[entityValues,setEntityValues]=Object(external_kbnSharedDeps_React_.useState)({}),detectors=Object(external_kbnSharedDeps_React_.useMemo)(()=>getViewableDetectors(selectedJob),[selectedJob]),entityControls=Object(external_kbnSharedDeps_React_.useMemo)(()=>getControlsForDetector(selectedDetectorIndex,selectedEntities,selectedJobId),[selectedDetectorIndex,selectedEntities,selectedJobId]),[storageFieldsConfig,setStorageFieldsConfig]=Object(use_storage.a)(storage.b),resultFieldsConfig=Object(external_kbnSharedDeps_React_.useMemo)(()=>{return{...(fieldTypes=entityControls.map(v=>v.fieldType),isAnomalousOnly=!storageFieldsConfig||Object.values(storageFieldsConfig).some(v=>!(null==v||!v.anomalousOnly)),applyTimeRange=!storageFieldsConfig||Object.values(storageFieldsConfig).some(v=>!(null==v||!v.applyTimeRange)),fieldTypes.reduce((acc,f)=>(acc[f]={applyTimeRange:applyTimeRange,anomalousOnly:isAnomalousOnly,sort:{by:"anomaly_score",order:"desc"}},acc),{})),...storageFieldsConfig||{}};var fieldTypes,isAnomalousOnly,applyTimeRange},[entityControls,storageFieldsConfig]),loadEntityValues=async(searchTerm={})=>{setEntitiesLoading(!0);const detectorIndex=selectedDetectorIndex,fieldsConfig=resultFieldsConfig?Object.fromEntries(Object.entries(resultFieldsConfig).filter(([k])=>entityControls.some(v=>v.fieldType===k))):void 0,{partition_field:partitionField,over_field:overField,by_field:byField}=await mlResultsService.fetchPartitionFieldsValues(selectedJob.job_id,searchTerm,[{fieldName:"detector_index",fieldValue:detectorIndex}],bounds.min.valueOf(),bounds.max.valueOf(),fieldsConfig).toPromise(),entityValuesUpdate={};entityControls.forEach(entity=>{let fieldValues;(null==partitionField?void 0:partitionField.name)===entity.fieldName&&(fieldValues=partitionField.values),(null==overField?void 0:overField.name)===entity.fieldName&&(fieldValues=overField.values),(null==byField?void 0:byField.name)===entity.fieldName&&(fieldValues=byField.values),entityValuesUpdate[entity.fieldName]=fieldValues}),setEntitiesLoading(!1),setEntityValues(entityValuesUpdate)};Object(external_kbnSharedDeps_React_.useEffect)(()=>{loadEntityValues()},[selectedJobId,selectedDetectorIndex,JSON.stringify(selectedEntities),resultFieldsConfig]);const entityFieldSearchChanged=Object(external_kbnSharedDeps_Lodash_.debounce)(async(entity,queryTerm)=>{await loadEntityValues({[entity.fieldType]:queryTerm})},500),entityFieldValueChanged=(entity,fieldValue)=>{const resultEntities={...entityControls.reduce((appStateEntities,appStateEntity)=>(appStateEntities[appStateEntity.fieldName]=appStateEntity.fieldValue,appStateEntities),{}),[entity.fieldName]:fieldValue};appStateHandler(APP_STATE_ACTION_SET_ENTITIES,resultEntities)},detectorIndexChangeHandler=Object(external_kbnSharedDeps_React_.useCallback)(e=>{const id=e.target.value;void 0!==id&&appStateHandler(APP_STATE_ACTION_SET_DETECTOR_INDEX,+id)},[appStateHandler]),detectorSelectOptions=detectors.map(d=>({value:d.index,text:d.detector_description})),onFieldConfigChange=Object(external_kbnSharedDeps_React_.useCallback)((fieldType,config)=>{var _resultFieldsConfig$f,_resultFieldsConfig$f2;const updatedFieldConfig={...resultFieldsConfig[fieldType]?resultFieldsConfig[fieldType]:{},...config},updatedResultConfig={...resultFieldsConfig};if((null===(_resultFieldsConfig$f=resultFieldsConfig[fieldType])||void 0===_resultFieldsConfig$f?void 0:_resultFieldsConfig$f.anomalousOnly)!==updatedFieldConfig.anomalousOnly)for(const c in updatedResultConfig)updatedResultConfig.hasOwnProperty(c)&&(updatedResultConfig[c].anomalousOnly=updatedFieldConfig.anomalousOnly);if((null===(_resultFieldsConfig$f2=resultFieldsConfig[fieldType])||void 0===_resultFieldsConfig$f2?void 0:_resultFieldsConfig$f2.applyTimeRange)!==updatedFieldConfig.applyTimeRange)for(const c in updatedResultConfig)updatedResultConfig.hasOwnProperty(c)&&(updatedResultConfig[c].applyTimeRange=updatedFieldConfig.applyTimeRange);setStorageFieldsConfig({...updatedResultConfig,[fieldType]:updatedFieldConfig})},[resultFieldsConfig,setStorageFieldsConfig]);let hasEmptyFieldValues=!1;return external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":"mlSingleMetricViewerSeriesControls"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.detectorLabel",defaultMessage:"Detector"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSelect,{onChange:detectorIndexChangeHandler,value:selectedDetectorIndex,options:detectorSelectOptions,"data-test-subj":"mlSingleMetricViewerDetectorSelect"}))),entityControls.map(entity=>{const entityKey=""+entity.fieldName,forceSelection=!hasEmptyFieldValues&&null===entity.fieldValue;return hasEmptyFieldValues=!hasEmptyFieldValues&&forceSelection,external_kbnSharedDeps_React_default.a.createElement(entity_control.b,{entity:entity,entityFieldValueChanged:entityFieldValueChanged,isLoading:entitiesLoading,onSearchChange:entityFieldSearchChanged,config:resultFieldsConfig[entity.fieldType],onConfigChange:onFieldConfigChange,forceSelection:forceSelection,key:entityKey,options:(fieldValues=entityValues[entity.fieldName],Array.isArray(fieldValues)?fieldValues.map(value=>({label:""===value.value?entity_control.a:value.value,value:value})):[]),isModelPlotEnabled:isModelPlotEnabled});var fieldValues}),external_kbnSharedDeps_React_default.a.createElement(PlotByFunctionControls,{selectedJobId:selectedJobId,selectedDetectorIndex:selectedDetectorIndex,selectedEntities:selectedEntities,functionDescription:functionDescription,setFunctionDescription:setFunctionDescription,entityControlsCount:entityControls.length}),children))};var chart_tooltip=__webpack_require__(382),d3=__webpack_require__(105),d3_default=__webpack_require__.n(d3),chart_utils=__webpack_require__(157);function ContextChartMask(contextGroup,data,drawBounds,swimlaneHeight){this.contextGroup=contextGroup,this.data=data,this.drawBounds=drawBounds,this.swimlaneHeight=swimlaneHeight,this.mask=this.contextGroup.append("g").attr("class","mask"),this.leftGroup=this.mask.append("g").attr("class","left-mask"),this.rightGroup=this.mask.append("g").attr("class","right-mask"),this.leftPolygon=this.leftGroup.append("polygon"),this.rightPolygon=this.rightGroup.append("polygon"),!0===this.drawBounds&&(this.leftGroup.append("path").attr("class","left area bounds"),this.rightGroup.append("path").attr("class","right area bounds")),this.leftGroup.append("path").attr("class","left values-line"),this.rightGroup.append("path").attr("class","right values-line"),this._x=null,this._y=null}ContextChartMask.prototype.style=function(prop,val){return this.leftGroup.style(prop,val),this.rightGroup.style(prop,val),this},ContextChartMask.prototype.x=function(f){return null==f?this._x:(this._x=f,this)},ContextChartMask.prototype.y=function(f){return null==f?this._y:(this._y=f,this)},ContextChartMask.prototype.redraw=function(){const yDomain=this._y.domain(),minY=yDomain[0],maxY=yDomain[1],xDomain=this._x.domain(),minX=xDomain[0],maxX=xDomain[1],that=this,leftData=this.data.filter((function(d){return d.date<that.from})),rightData=this.data.filter((function(d){return d.date>that.to}));if(!0===this.drawBounds){const boundedArea=d3_default.a.svg.area().x((function(d){return that._x(d.date)||1})).y0((function(d){return that._y(Math.min(maxY,Math.max(d.lower,minY)))})).y1((function(d){return that._y(Math.max(minY,Math.min(d.upper,maxY)))})).defined(d=>null!==d.lower&&null!==d.upper);this.leftGroup.select(".left.area.bounds").attr("d",boundedArea(leftData)),this.rightGroup.select(".right.area.bounds").attr("d",boundedArea(rightData))}const valuesLine=d3_default.a.svg.line().x((function(d){return that._x(d.date)})).y((function(d){return that._y(d.value)})).defined(d=>null!==d.value);this.leftGroup.select(".left.values-line").attr("d",valuesLine(leftData)),Object(chart_utils.g)(leftData,this.leftGroup,valuesLine,1),this.rightGroup.select(".right.values-line").attr("d",valuesLine(rightData)),Object(chart_utils.g)(rightData,this.rightGroup,valuesLine,1);const leftPoly_l=this._x(minX),leftPoly_t=this._y(minY)+this.swimlaneHeight,leftPoly_r=this._x(this.from),leftPoly_b=0,rightPoly_l=this._x(this.to),rightPoly_t=this._y(minY)+this.swimlaneHeight,rightPoly_r=this._x(maxX),rightPoly_b=0;return this.leftPolygon.attr("points",leftPoly_l+","+leftPoly_t+"  "+leftPoly_r+","+leftPoly_t+"  "+leftPoly_r+","+leftPoly_b+"  "+leftPoly_l+","+leftPoly_b),this.rightPolygon.attr("points",rightPoly_l+","+rightPoly_t+"  "+rightPoly_r+","+rightPoly_t+"  "+rightPoly_r+","+rightPoly_b+"  "+rightPoly_l+","+rightPoly_b),this},ContextChartMask.prototype.reveal=function(extent){return this.from=extent[0],this.to=extent[1],this.redraw(),this};function getAnnotationBrush(){const{annotationUpdatesService:annotationUpdatesService}=this.props,focusXScale=this.focusXScale,annotateBrush=d3_default.a.svg.brush().x(focusXScale).on("brushend",function(){const{selectedJob:selectedJob}=this.props,extent=annotateBrush.extent(),timestamp=extent[0].getTime(),endTimestamp=extent[1].getTime();if(timestamp===endTimestamp)return void annotationUpdatesService.setValue(null);const annotation={timestamp:timestamp,end_timestamp:endTimestamp,annotation:"",job_id:selectedJob.job_id,type:constants_annotations.d.ANNOTATION};annotationUpdatesService.setValue(annotation)}.bind(this));return annotateBrush}function getAnnotationLevels(focusAnnotationData){const levels={};return focusAnnotationData.forEach((d,i)=>{if(void 0!==d.key){const longerAnnotations=focusAnnotationData.filter((d2,i2)=>i2<i);levels[d.key]=longerAnnotations.reduce((level,d2)=>void 0===d.end_timestamp||void 0===d2.end_timestamp||void 0===d2.key||d2.timestamp<d.timestamp&&d2.end_timestamp<d.timestamp||d2.timestamp>d.end_timestamp&&d2.end_timestamp>d.end_timestamp?level:levels[d2.key]+1,0)}}),levels}function highlightFocusChartAnnotation(annotation){d3_default.a.selectAll(".mlAnnotation").each((function(d){const element=d3_default.a.select(this);d._id===annotation._id?element.selectAll(".mlAnnotationRect").classed("mlAnnotationRect-isHighlight",!0):(element.selectAll(".mlAnnotationTextRect").classed("mlAnnotationTextRect-isBlur",!0),element.selectAll(".mlAnnotationText").classed("mlAnnotationText-isBlur",!0),element.selectAll(".mlAnnotationRect").classed("mlAnnotationRect-isBlur",!0))}))}function unhighlightFocusChartAnnotation(){d3_default.a.selectAll(".mlAnnotation").each((function(){const element=d3_default.a.select(this);element.selectAll(".mlAnnotationTextRect").classed("mlAnnotationTextRect-isBlur",!1),element.selectAll(".mlAnnotationRect").classed("mlAnnotationRect-isHighlight",!1).classed("mlAnnotationRect-isBlur",!1),element.selectAll(".mlAnnotationText").classed("mlAnnotationText-isBlur",!1)}))}function timeseries_chart_extends(){return(timeseries_chart_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function timeseries_chart_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}const annotationHeight=chart_utils.a+4,timeseries_chart_margin={top:10,right:10,bottom:15,left:40},ZOOM_INTERVAL_OPTIONS=[{duration:external_kbnSharedDeps_Moment_default.a.duration(1,"h"),label:"1h"},{duration:external_kbnSharedDeps_Moment_default.a.duration(12,"h"),label:"12h"},{duration:external_kbnSharedDeps_Moment_default.a.duration(1,"d"),label:"1d"},{duration:external_kbnSharedDeps_Moment_default.a.duration(1,"w"),label:"1w"},{duration:external_kbnSharedDeps_Moment_default.a.duration(2,"w"),label:"2w"},{duration:external_kbnSharedDeps_Moment_default.a.duration(1,"M"),label:"1M"}],anomalyColorScale=d3_default.a.scale.threshold().domain([3,25,50,75,100]).range(["#d2e9f7","#8bc8fb","#ffdd00","#ff7e00","#fe5050"]),anomalyGrayScale=d3_default.a.scale.threshold().domain([3,25,50,75,100]).range(["#dce7ed","#b0c5d6","#b1a34e","#b17f4e","#c88686"]);class timeseries_chart_TimeseriesChartIntl extends external_kbnSharedDeps_React_.Component{constructor(...args){super(...args),timeseries_chart_defineProperty(this,"rowMouseenterSubscriber",null),timeseries_chart_defineProperty(this,"rowMouseleaveSubscriber",null),timeseries_chart_defineProperty(this,"contextChartInitialized",!1),timeseries_chart_defineProperty(this,"drawContextBrush",contextGroup=>{const{contextChartSelected:contextChartSelected}=this.props,brush=this.brush,contextXScale=this.contextXScale,mask=this.mask;brush.x(contextXScale).on("brush",brushing).on("brushend",(function(){const selectedBounds=brush.empty()?contextXScale.domain():brush.extent(),selectionMin=selectedBounds[0].getTime(),selectionMax=selectedBounds[1].getTime();if(void 0!==that.selectedBounds&&that.selectedBounds.min.valueOf()===selectionMin&&that.selectedBounds.max.valueOf()===selectionMax)return;contextGroup.selectAll(".swimlane-cell").style("fill",d=>{const cellMs=d.date.getTime();return cellMs<selectionMin||cellMs>selectionMax?anomalyGrayScale(d.score):anomalyColorScale(d.score)}),that.selectedBounds={min:external_kbnSharedDeps_Moment_default()(selectionMin),max:external_kbnSharedDeps_Moment_default()(selectionMax)},contextChartSelected({from:selectedBounds[0],to:selectedBounds[1]})})),contextGroup.append("g").attr("class","x brush").call(brush).selectAll("rect").attr("y",-1).attr("height",91),contextGroup.selectAll(".w rect").attr("x",-10).attr("width",10),contextGroup.selectAll(".e rect").attr("x",0).attr("width",10);const handleBrushExtent=brush.extent(),topBorder=contextGroup.append("rect").attr("class","top-border").attr("y",-2).attr("height",3),leftHandle=contextGroup.append("foreignObject").attr("width",10).attr("height",90).attr("class","brush-handle").attr("x",contextXScale(handleBrushExtent[0])-10).html('\n        <div class="brush-handle-inner brush-handle-inner-left" style="padding-top: 27px">\n          <svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="6" height="9">\n            <polygon points="5,0 5,8 0,4" />\n          </svg>\n        </div>'),rightHandle=contextGroup.append("foreignObject").attr("width",10).attr("height",90).attr("class","brush-handle").attr("x",contextXScale(handleBrushExtent[1])+0).html('\n        <div class="brush-handle-inner brush-handle-inner-right" style="padding-top: 27px">\n          <svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="6" height="9">\n            <polygon points="0,0 0,8 5,4" />\n          </svg>\n        </div>');function brushing(){const brushExtent=brush.extent();mask.reveal(brushExtent),leftHandle.attr("x",contextXScale(brushExtent[0])-10),rightHandle.attr("x",contextXScale(brushExtent[1])+0),topBorder.attr("x",contextXScale(brushExtent[0])+1);const topBorderWidth=Math.max(0,contextXScale(brushExtent[1])-contextXScale(brushExtent[0])-2);topBorder.attr("width",topBorderWidth);const isEmpty=brush.empty();d3_default.a.selectAll(".brush-handle").style("visibility",isEmpty?"hidden":"visible")}brushing();const that=this}),timeseries_chart_defineProperty(this,"drawSwimlane",(swlGroup,swlWidth,swlHeight)=>{const{contextAggregationInterval:contextAggregationInterval,swimlaneData:swimlaneData}=this.props,data=swimlaneData;if(void 0===data)return;const xAxisDomain=this.calculateContextXAxisDomain(),x=d3_default.a.time.scale().range([0,swlWidth]).domain(xAxisDomain),y=d3_default.a.scale.linear().range([swlHeight,0]).domain([0,swlHeight]),xAxis=d3_default.a.svg.axis().scale(x).orient("bottom").innerTickSize(-swlHeight).outerTickSize(0),yAxis=d3_default.a.svg.axis().scale(y).orient("left").tickValues(y.domain()).innerTickSize(-swlWidth).outerTickSize(0),axes=swlGroup.append("g");axes.append("g").attr("class","x axis").attr("transform","translate(0,"+swlHeight+")").call(xAxis),axes.append("g").attr("class","y axis").call(yAxis);const earliest=xAxisDomain[0].getTime();let cellWidth=swlWidth/((xAxisDomain[1].getTime()-earliest)/contextAggregationInterval.asMilliseconds());cellWidth<1&&(cellWidth=1);swlGroup.append("g").attr("class","swimlane-cells").selectAll("rect").data(data).enter().append("rect").attr("x",d=>x(d.date)).attr("y",0).attr("rx",0).attr("ry",0).attr("class",d=>d.score>0?"swimlane-cell":"swimlane-cell-hidden").attr("width",cellWidth).attr("height",swlHeight).style("fill",d=>anomalyColorScale(d.score))}),timeseries_chart_defineProperty(this,"calculateContextXAxisDomain",()=>{const{bounds:bounds,contextAggregationInterval:contextAggregationInterval,swimlaneData:swimlaneData}=this.props;let earliest=bounds.min.valueOf();void 0!==swimlaneData&&swimlaneData.length>0&&(earliest=Math.min(swimlaneData[0].date.getTime(),bounds.min.valueOf()));const contextAggMs=contextAggregationInterval.asMilliseconds(),earliestMs=Math.floor(earliest/contextAggMs)*contextAggMs,latestMs=Math.ceil(bounds.max.valueOf()/contextAggMs)*contextAggMs;return[new Date(earliestMs),new Date(latestMs)]}),timeseries_chart_defineProperty(this,"setContextBrushExtent",(from,to)=>{const brush=this.brush,brushExtent=brush.extent(),newExtent=[from,to];brush.extent(newExtent),brush(d3_default.a.select(".brush")),newExtent[0].getTime()===brushExtent[0].getTime()&&newExtent[1].getTime()===brushExtent[1].getTime()||brush.event(d3_default.a.select(".brush"))})}componentWillUnmount(){d3_default.a.select(this.rootNode).html(""),null!==this.rowMouseenterSubscriber&&this.rowMouseenterSubscriber.unsubscribe(),null!==this.rowMouseleaveSubscriber&&this.rowMouseleaveSubscriber.unsubscribe()}componentDidMount(){const{svgWidth:svgWidth}=this.props;this.vizWidth=svgWidth-timeseries_chart_margin.left-timeseries_chart_margin.right;const vizWidth=this.vizWidth;this.focusXScale=d3_default.a.time.scale().range([0,vizWidth]),this.focusYScale=d3_default.a.scale.linear().range([335,25]);const focusXScale=this.focusXScale,focusYScale=this.focusYScale;this.focusXAxis=d3_default.a.svg.axis().scale(focusXScale).orient("bottom").innerTickSize(-310).outerTickSize(0).tickPadding(10),this.focusYAxis=d3_default.a.svg.axis().scale(focusYScale).orient("left").innerTickSize(-vizWidth).outerTickSize(0).tickPadding(10),this.focusValuesLine=d3_default.a.svg.line().x((function(d){return focusXScale(d.date)})).y((function(d){return focusYScale(d.value)})).defined(d=>null!==d.value),this.focusBoundedArea=d3_default.a.svg.area().x((function(d){return focusXScale(d.date)||1})).y0((function(d){return focusYScale(d.upper)})).y1((function(d){return focusYScale(d.lower)})).defined(d=>null!==d.lower&&null!==d.upper),this.contextXScale=d3_default.a.time.scale().range([0,vizWidth]),this.contextYScale=d3_default.a.scale.linear().range([60,3]),this.fieldFormat=void 0,this.annotateBrush=getAnnotationBrush.call(this),this.brush=d3_default.a.svg.brush(),this.mask=void 0;const highlightFocusChartAnomaly=this.highlightFocusChartAnomaly.bind(this),boundHighlightFocusChartAnnotation=highlightFocusChartAnnotation.bind(this);const unhighlightFocusChartAnomaly=this.unhighlightFocusChartAnomaly.bind(this),boundUnhighlightFocusChartAnnotation=unhighlightFocusChartAnnotation.bind(this);this.rowMouseenterSubscriber=table_service.a.rowMouseenter$.subscribe((function({record:record,type:type="anomaly"}){"anomaly"===type?highlightFocusChartAnomaly(record):"annotation"===type&&boundHighlightFocusChartAnnotation(record)})),this.rowMouseleaveSubscriber=table_service.a.rowMouseleave$.subscribe((function({record:record,type:type="anomaly"}){"anomaly"===type?unhighlightFocusChartAnomaly(record):boundUnhighlightFocusChartAnnotation(record)})),this.renderChart(),this.drawContextChartSelection(),this.renderFocusChart()}componentDidUpdate(prevProps){if(!1!==this.props.renderFocusChartOnly&&prevProps.svgWidth===this.props.svgWidth&&prevProps.showAnnotations===this.props.showAnnotations&&prevProps.annotationData===this.props.annotationData||(this.renderChart(),this.drawContextChartSelection()),this.renderFocusChart(),null===this.props.annotation){d3_default.a.select(this.rootNode).select("g.mlAnnotationBrush").call(this.annotateBrush.extent([0,0]))}}renderChart(){const{contextChartData:contextChartData,contextForecastData:contextForecastData,detectorIndex:detectorIndex,modelPlotEnabled:modelPlotEnabled,selectedJob:selectedJob,svgWidth:svgWidth,showAnnotations:showAnnotations}=this.props,createFocusChart=this.createFocusChart.bind(this),drawContextElements=this.drawContextElements.bind(this),focusXScale=this.focusXScale,focusYAxis=this.focusYAxis,focusYScale=this.focusYScale,svgHeight=function(showAnnotations){return 425+(showAnnotations?annotationHeight:0)+25+timeseries_chart_margin.top+timeseries_chart_margin.bottom}(showAnnotations),chartElement=d3_default.a.select(this.rootNode);if(chartElement.selectAll("*").remove(),void 0===selectedJob)return;if(this.fieldFormat=field_format_service.a.getFieldFormat(selectedJob.job_id,detectorIndex),void 0===contextChartData)return;const fieldFormat=this.fieldFormat,svg=chartElement.append("svg").attr("width",svgWidth).attr("height",svgHeight);let contextDataMin,contextDataMax;if(!0===modelPlotEnabled||void 0!==contextForecastData&&contextForecastData.length>0){const combinedData=void 0===contextForecastData?contextChartData:contextChartData.concat(contextForecastData);contextDataMin=d3_default.a.min(combinedData,d=>Math.min(d.value,d.lower)),contextDataMax=d3_default.a.max(combinedData,d=>Math.max(d.value,d.upper))}else contextDataMin=d3_default.a.min(contextChartData,d=>d.value),contextDataMax=d3_default.a.max(contextChartData,d=>d.value);const ceiledMax=contextDataMax>0?Math.pow(10,Math.ceil(Math.log10(Math.abs(contextDataMax)))):contextDataMax,flooredMin=contextDataMin>=0?contextDataMin:-1*Math.pow(10,Math.ceil(Math.log10(Math.abs(contextDataMin))));focusYScale.domain([flooredMin,ceiledMax]);let maxYAxisLabelWidth=0;svg.append("g").attr("class","temp-axis-label tick").selectAll("text.temp.axis").data(focusYScale.ticks()).enter().append("text").text(d=>void 0!==fieldFormat?fieldFormat.convert(d,"text"):focusYScale.tickFormat()(d)).each((function(){maxYAxisLabelWidth=Math.max(this.getBBox().width+focusYAxis.tickPadding(),maxYAxisLabelWidth)})).remove(),d3_default.a.select(".temp-axis-label").remove(),timeseries_chart_margin.left=Math.max(maxYAxisLabelWidth,40),this.vizWidth=Math.max(svgWidth-timeseries_chart_margin.left-timeseries_chart_margin.right,0),focusXScale.range([0,this.vizWidth]),focusYAxis.innerTickSize(-this.vizWidth);const focus=svg.append("g").attr("class","focus-chart").attr("transform","translate("+timeseries_chart_margin.left+","+timeseries_chart_margin.top+")"),context=svg.append("g").attr("class","context-chart").attr("transform","translate("+timeseries_chart_margin.left+","+(335+timeseries_chart_margin.top+25)+")");svg.append("defs").append("mask").attr("id","mlAnnotationMask").append("rect").attr("x",0).attr("y",0).attr("width",this.vizWidth).attr("height",335).style("fill","white"),createFocusChart(focus,this.vizWidth,335),drawContextElements(context,this.vizWidth,60,30,annotationHeight)}drawContextChartSelection(){const{contextChartData:contextChartData,contextForecastData:contextForecastData,zoomFrom:zoomFrom,zoomTo:zoomTo}=this.props;if(void 0===contextChartData)return;let focusLoadFrom,focusLoadTo;const contextXMin=this.contextXScale.domain()[0].getTime(),contextXMax=this.contextXScale.domain()[1].getTime();let combinedData=contextChartData;if(void 0!==contextForecastData&&(combinedData=combinedData.concat(contextForecastData)),focusLoadFrom=zoomFrom?zoomFrom.getTime():Object(external_kbnSharedDeps_Lodash_.reduce)(combinedData,(memo,point)=>Math.min(memo,point.date.getTime()),new Date(2099,12,31).getTime()),focusLoadFrom=Math.max(focusLoadFrom,contextXMin),focusLoadTo=zoomTo?zoomTo.getTime():Object(external_kbnSharedDeps_Lodash_.reduce)(combinedData,(memo,point)=>Math.max(memo,point.date.getTime()),0),focusLoadTo=Math.min(focusLoadTo,contextXMax),focusLoadFrom!==contextXMin||focusLoadTo!==contextXMax){this.setContextBrushExtent(new Date(focusLoadFrom),new Date(focusLoadTo));const newSelectedBounds={min:external_kbnSharedDeps_Moment_default()(new Date(focusLoadFrom)),max:external_kbnSharedDeps_Moment_default()(focusLoadFrom)};this.selectedBounds=newSelectedBounds}else{const contextXScaleDomain=this.contextXScale.domain(),newSelectedBounds={min:external_kbnSharedDeps_Moment_default()(new Date(contextXScaleDomain[0])),max:external_kbnSharedDeps_Moment_default()(contextXScaleDomain[1])};Object(external_kbnSharedDeps_Lodash_.isEqual)(newSelectedBounds,this.selectedBounds)||(this.selectedBounds=newSelectedBounds,this.setContextBrushExtent(new Date(contextXScaleDomain[0]),new Date(contextXScaleDomain[1])))}}createFocusChart(fcsGroup,fcsWidth,fcsHeight){const{contextForecastData:contextForecastData}=this.props,zoomGroup=fcsGroup.append("g").attr("class","focus-zoom");zoomGroup.append("rect").attr("x",0).attr("y",0).attr("width",fcsWidth).attr("height",25).attr("class","chart-border"),this.createZoomInfoElements(zoomGroup,fcsWidth);const annotateBrush=this.annotateBrush.bind(this);let brushX=0,brushWidth=0;null!==this.props.annotation&&(brushX=this.focusXScale(this.props.annotation.timestamp),brushWidth=function(annotation,focusXScale){const start=focusXScale(annotation.timestamp)+1,end=void 0!==annotation.end_timestamp?focusXScale(annotation.end_timestamp)-1:start+8;return Math.max(8,end-start)}(this.props.annotation,this.focusXScale)),fcsGroup.append("g").attr("class","mlAnnotationBrush").call(annotateBrush).selectAll("rect").attr("x",brushX).attr("y",25).attr("width",brushWidth).attr("height",310),fcsGroup.append("g").classed("mlAnnotations",!0),fcsGroup.append("rect").attr("x",0).attr("y",25).attr("width",fcsWidth).attr("height",310).attr("class","chart-border");const xAxisBg=fcsGroup.append("g").attr("class","x-axis-background");xAxisBg.append("rect").attr("x",0).attr("y",fcsHeight).attr("width",fcsWidth).attr("height",25),xAxisBg.append("line").attr("x1",0).attr("y1",fcsHeight).attr("x2",0).attr("y2",fcsHeight+25),xAxisBg.append("line").attr("x1",fcsWidth).attr("y1",fcsHeight).attr("x2",fcsWidth).attr("y2",fcsHeight+25),xAxisBg.append("line").attr("x1",0).attr("y1",fcsHeight+25).attr("x2",fcsWidth).attr("y2",fcsHeight+25);const axes=fcsGroup.append("g");axes.append("g").attr("class","x axis").attr("transform","translate(0,"+fcsHeight+")"),axes.append("g").attr("class","y axis"),fcsGroup.append("path").attr("class","area bounds"),fcsGroup.append("path").attr("class","values-line"),fcsGroup.append("g").attr("class","focus-chart-markers"),contextForecastData&&(fcsGroup.append("path").attr("class","area forecast"),fcsGroup.append("path").attr("class","values-line forecast"),fcsGroup.append("g").attr("class","focus-chart-markers forecast")),fcsGroup.append("rect").attr("x",0).attr("y",0).attr("width",fcsWidth).attr("height",fcsHeight+24).attr("class","chart-border chart-border-highlight")}renderFocusChart(){const{focusAggregationInterval:focusAggregationInterval,focusAnnotationData:focusAnnotationDataOriginalPropValue,focusChartData:focusChartData,focusForecastData:focusForecastData,modelPlotEnabled:modelPlotEnabled,selectedJob:selectedJob,showAnnotations:showAnnotations,showForecast:showForecast,showModelBounds:showModelBounds,zoomFromFocusLoaded:zoomFromFocusLoaded,zoomToFocusLoaded:zoomToFocusLoaded}=this.props,focusAnnotationData=Array.isArray(focusAnnotationDataOriginalPropValue)?focusAnnotationDataOriginalPropValue:[];if(void 0===focusChartData)return;const data=focusChartData,contextYScale=this.contextYScale,showFocusChartTooltip=this.showFocusChartTooltip.bind(this),hideFocusChartTooltip=this.props.tooltipService.hide.bind(this.props.tooltipService),focusChart=d3_default.a.select(".focus-chart"),focusAggInt=focusAggregationInterval.expression,bucketSpan=selectedJob.analysis_config.bucket_span;if(d3_default.a.select(this.rootNode).select(".zoom-aggregation-interval").text(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.zoomAggregationIntervalLabel",{defaultMessage:"(aggregation interval: {focusAggInt}, bucket span: {bucketSpan})",values:{focusAggInt:focusAggInt,bucketSpan:bucketSpan}})),void 0===zoomFromFocusLoaded||void 0===zoomToFocusLoaded)return;const bounds={min:external_kbnSharedDeps_Moment_default()(zoomFromFocusLoaded.getTime()),max:external_kbnSharedDeps_Moment_default()(zoomToFocusLoaded.getTime())},aggMs=focusAggregationInterval.asMilliseconds(),earliest=external_kbnSharedDeps_Moment_default()(Math.floor(bounds.min.valueOf()/aggMs)*aggMs),latest=external_kbnSharedDeps_Moment_default()(Math.ceil(bounds.max.valueOf()/aggMs)*aggMs);if(this.focusXScale.domain([earliest.toDate(),latest.toDate()]),focusChartData.length>0||void 0!==focusForecastData&&focusForecastData.length>0){void 0!==this.fieldFormat?this.focusYAxis.tickFormat(d=>this.fieldFormat.convert(d,"text")):this.focusYAxis.tickFormat(null);let yMin=0,yMax=0,combinedData=data;if(showForecast&&void 0!==focusForecastData&&focusForecastData.length>0&&(combinedData=data.concat(focusForecastData)),yMin=d3_default.a.min(combinedData,d=>{let metricValue=d.value;return null===metricValue&&void 0!==d.anomalyScore&&void 0!==d.actual&&(metricValue=Array.isArray(d.actual)?d.actual[0]:d.actual),void 0!==d.lower?null!=metricValue?Math.min(metricValue,d.lower):d.lower:metricValue}),yMax=d3_default.a.max(combinedData,d=>{let metricValue=d.value;return null===metricValue&&void 0!==d.anomalyScore&&void 0!==d.actual&&(metricValue=Array.isArray(d.actual)?d.actual[0]:d.actual),void 0!==d.upper?Math.max(metricValue,d.upper):metricValue}),yMax===yMin&&(this.contextYScale.domain()[0]!==contextYScale.domain()[1]&&yMin>=contextYScale.domain()[0]&&yMax<=contextYScale.domain()[1]?(yMin=contextYScale.domain()[0],yMax=contextYScale.domain()[1]):(yMin-=.05*yMin,yMax+=.05*yMax)),showAnnotations&&focusAnnotationData&&focusAnnotationData.length>0){const levels=getAnnotationLevels(focusAnnotationData),maxLevel=d3_default.a.max(Object.keys(levels).map(key=>levels[key]));yMax+=Math.abs(yMax-yMin)*((maxLevel+1)/5)}this.focusYScale.domain([yMin,yMax])}else this.focusYScale.domain([0,10]),this.focusYAxis.tickFormat("");const timeBuckets=Object(time_buckets.c)();timeBuckets.setInterval("auto"),timeBuckets.setBounds(bounds);const xAxisTickFormat=timeBuckets.getScaledDateFormat();focusChart.select(".x.axis").call(this.focusXAxis.ticks(Object(chart_utils.m)(this.vizWidth),xAxisTickFormat).tickFormat(d=>external_kbnSharedDeps_Moment_default()(d).format(xAxisTickFormat))),focusChart.select(".y.axis").call(this.focusYAxis),Object(chart_utils.h)(focusChart.select(".x.axis"),this.vizWidth),!0===modelPlotEnabled&&focusChart.select(".area.bounds").attr("d",this.focusBoundedArea(data)).classed("hidden",!showModelBounds),function(focusChart,focusAnnotationData,focusZoomPanelHeight,focusChartHeight,focusXScale,showAnnotations,showFocusChartTooltip,hideFocusChartTooltip,annotationUpdatesService){const durations={};focusAnnotationData.forEach(d=>{if(void 0!==d.key){const duration=(d.end_timestamp||0)-d.timestamp;durations[d.key]=duration}}),focusAnnotationData.sort((a,b)=>void 0===a.key||void 0===b.key?0:durations[b.key]-durations[a.key]);const levels=getAnnotationLevels(focusAnnotationData),onAnnotationMouseOver=function(d){showFocusChartTooltip(d,this)},onAnnotationClick=d=>{annotationUpdatesService.setValue(null),annotationUpdatesService.setValue(d)},annotations=focusChart.select(".mlAnnotations").selectAll("g.mlAnnotation").data(focusAnnotationData||[],d=>d._id||"");annotations.enter().append("g").classed("mlAnnotation",!0);const rects=annotations.selectAll(".mlAnnotationRect").data(d=>[d]);rects.enter().append("rect").classed("mlAnnotationRect",!0).attr("mask","url(#mlAnnotationMask)").on("mouseover",onAnnotationMouseOver).on("mouseout",hideFocusChartTooltip).on("click",onAnnotationClick),rects.attr("x",d=>{const date=external_kbnSharedDeps_Moment_default()(d.timestamp);return focusXScale(date)}).attr("y",d=>{const level=void 0!==d.key?levels[d.key]:1;return focusZoomPanelHeight+1+0+28*level}).attr("height",d=>{const level=void 0!==d.key?levels[d.key]:1;return focusChartHeight-2-0-28*level}).attr("width",d=>{const s=focusXScale(external_kbnSharedDeps_Moment_default()(d.timestamp))+1,e=void 0!==d.end_timestamp?focusXScale(external_kbnSharedDeps_Moment_default()(d.end_timestamp))-1:s+8;return Math.max(8,e-s)}),rects.exit().remove();const textRects=annotations.selectAll(".mlAnnotationTextRect").data(d=>[d]),texts=annotations.selectAll(".mlAnnotationText").data(d=>[d]);function labelXOffset(ts){const earliestMs=focusXScale.domain()[0],latestMs=focusXScale.domain()[1],date=external_kbnSharedDeps_Moment_default()(ts),minX=Math.max(focusXScale(earliestMs),focusXScale(date));return Math.min(focusXScale(latestMs)-32,minX)}textRects.enter().append("rect").classed("mlAnnotationTextRect",!0).attr("width",24).attr("height",20).on("mouseover",onAnnotationMouseOver).on("mouseout",hideFocusChartTooltip).on("click",onAnnotationClick),texts.enter().append("text").classed("mlAnnotationText",!0).on("mouseover",onAnnotationMouseOver).on("mouseout",hideFocusChartTooltip).on("click",onAnnotationClick),texts.attr("x",d=>labelXOffset(d.timestamp)+17).attr("y",d=>{const level=void 0!==d.key?levels[d.key]:1;return focusZoomPanelHeight+-7+26+28*level}).text(d=>d.key),textRects.attr("x",d=>labelXOffset(d.timestamp)+5).attr("y",d=>{const level=void 0!==d.key?levels[d.key]:1;return focusZoomPanelHeight+-7+12+28*level}),textRects.exit().remove(),texts.exit().remove(),annotations.classed("mlAnnotationHidden",!showAnnotations),annotations.exit().remove()}(focusChart,focusAnnotationData,25,310,this.focusXScale,showAnnotations,showFocusChartTooltip,hideFocusChartTooltip,this.props.annotationUpdatesService),focusChart.select(".mlAnnotationBrush").style("display",showAnnotations?null:"none"),focusChart.select(".values-line").attr("d",this.focusValuesLine(data)),Object(chart_utils.g)(data,focusChart,this.focusValuesLine);const dots=d3_default.a.select(".focus-chart-markers").selectAll(".metric-value").data(data.filter(d=>(null!==d.value||"number"==typeof d.anomalyScore)&&!Object(chart_utils.o)(d)));dots.exit().remove(),dots.enter().append("circle").attr("r",chart_utils.b).on("mouseover",(function(d){showFocusChartTooltip(d,this)})).on("mouseout",()=>this.props.tooltipService.hide()),dots.attr("cx",d=>this.focusXScale(d.date)).attr("cy",d=>this.focusYScale(d.value)).attr("class",d=>{let markerClass="metric-value";return void 0!==d.anomalyScore&&(markerClass+=" anomaly-marker "+Object(anomaly_utils.l)(d.anomalyScore).id),markerClass});const multiBucketMarkers=d3_default.a.select(".focus-chart-markers").selectAll(".multi-bucket").data(data.filter(d=>null!==d.anomalyScore&&!0===Object(chart_utils.o)(d)));multiBucketMarkers.exit().remove(),multiBucketMarkers.enter().append("path").attr("d",d3_default.a.svg.symbol().size(chart_utils.c).type("cross")).on("mouseover",(function(d){showFocusChartTooltip(d,this)})).on("mouseout",()=>this.props.tooltipService.hide()),multiBucketMarkers.attr("transform",d=>`translate(${this.focusXScale(d.date)}, ${this.focusYScale(d.value)})`).attr("class",d=>"anomaly-marker multi-bucket "+Object(anomaly_utils.l)(d.anomalyScore).id);const scheduledEventMarkers=d3_default.a.select(".focus-chart-markers").selectAll(".scheduled-event-marker").data(data.filter(d=>void 0!==d.scheduledEvents));if(scheduledEventMarkers.exit().remove(),scheduledEventMarkers.enter().append("rect").attr("width",2*chart_utils.b).attr("height",chart_utils.d).attr("class","scheduled-event-marker").attr("rx",1).attr("ry",1),scheduledEventMarkers.attr("x",d=>this.focusXScale(d.date)-chart_utils.b).attr("y",d=>this.focusYScale(d.value)-3),void 0!==focusForecastData){focusChart.select(".area.forecast").attr("d",this.focusBoundedArea(focusForecastData)).classed("hidden",!showForecast),focusChart.select(".values-line.forecast").attr("d",this.focusValuesLine(focusForecastData)).classed("hidden",!showForecast);const forecastDots=d3_default.a.select(".focus-chart-markers.forecast").selectAll(".metric-value").data(focusForecastData);forecastDots.exit().remove(),forecastDots.enter().append("circle").attr("r",chart_utils.b).on("mouseover",(function(d){showFocusChartTooltip(d,this)})).on("mouseout",()=>this.props.tooltipService.hide()),forecastDots.attr("cx",d=>this.focusXScale(d.date)).attr("cy",d=>this.focusYScale(d.value)).attr("class","metric-value").classed("hidden",!showForecast)}}createZoomInfoElements(zoomGroup,fcsWidth){const{autoZoomDuration:autoZoomDuration,bounds:bounds,modelPlotEnabled:modelPlotEnabled}=this.props,setZoomInterval=this.setZoomInterval.bind(this),boundsSecs=bounds.max.unix()-bounds.min.unix(),minSecs=10/this.vizWidth*boundsSecs;let xPos=10;const zoomLabel=zoomGroup.append("text").attr("x",xPos).attr("y",17).attr("class","zoom-info-text").text(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.zoomLabel",{defaultMessage:"Zoom:"})),zoomOptions=[{durationMs:autoZoomDuration,label:"auto"}];if(Object(external_kbnSharedDeps_Lodash_.each)(ZOOM_INTERVAL_OPTIONS,option=>{option.duration.asSeconds()>minSecs&&option.duration.asSeconds()<boundsSecs&&zoomOptions.push({durationMs:option.duration.asMilliseconds(),label:option.label})}),xPos+=zoomLabel.node().getBBox().width+4,Object(external_kbnSharedDeps_Lodash_.each)(zoomOptions,option=>{const text=zoomGroup.append("a").attr("data-ms",option.durationMs).attr("href","").append("text").attr("x",xPos).attr("y",17).attr("class","zoom-info-text").text(option.label);xPos+=text.node().getBBox().width+4}),zoomGroup.append("text").attr("x",xPos+6).attr("y",17).attr("class","zoom-info-text zoom-aggregation-interval").text(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.zoomGroupAggregationIntervalLabel",{defaultMessage:"(aggregation interval: , bucket span: )"})),!1===modelPlotEnabled){const modelPlotLabel=zoomGroup.append("text").attr("x",300).attr("y",17).attr("class","zoom-info-text").text(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.modelBoundsNotAvailableLabel",{defaultMessage:"Model bounds are not available"}));modelPlotLabel.attr("x",fcsWidth-(modelPlotLabel.node().getBBox().width+10))}d3_default.a.select(this.rootNode).selectAll(".focus-zoom a").on("click",(function(){d3_default.a.event.preventDefault(),setZoomInterval(d3_default.a.select(this).attr("data-ms"))}))}drawContextElements(cxtGroup,cxtWidth,cxtChartHeight,swlHeight){const{bounds:bounds,contextChartData:contextChartData,contextForecastData:contextForecastData,modelPlotEnabled:modelPlotEnabled,annotationData:annotationData}=this.props,data=contextChartData,showFocusChartTooltip=this.showFocusChartTooltip.bind(this),hideFocusChartTooltip=this.props.tooltipService.hide.bind(this.props.tooltipService);this.contextXScale=d3_default.a.time.scale().range([0,cxtWidth]).domain(this.calculateContextXAxisDomain());const combinedData=void 0===contextForecastData?data:data.concat(contextForecastData),valuesRange={min:Number.MAX_VALUE,max:Number.MIN_VALUE};Object(external_kbnSharedDeps_Lodash_.each)(combinedData,item=>{var _item$lower,_item$upper;const lowerBound=null!==(_item$lower=item.lower)&&void 0!==_item$lower?_item$lower:Number.MAX_VALUE,upperBound=null!==(_item$upper=item.upper)&&void 0!==_item$upper?_item$upper:Number.MIN_VALUE;valuesRange.min=Math.min(item.value,lowerBound,valuesRange.min),valuesRange.max=Math.max(item.value,upperBound,valuesRange.max)});let dataMin=valuesRange.min,dataMax=valuesRange.max;const chartLimits={min:dataMin,max:dataMax};if(!0===modelPlotEnabled||void 0!==contextForecastData&&contextForecastData.length>0){const boundsRange={min:Number.MAX_VALUE,max:Number.MIN_VALUE};Object(external_kbnSharedDeps_Lodash_.each)(combinedData,item=>{boundsRange.min=Math.min(item.lower,boundsRange.min),boundsRange.max=Math.max(item.upper,boundsRange.max)}),dataMin=Math.min(dataMin,boundsRange.min),dataMax=Math.max(dataMax,boundsRange.max),valuesRange.max-valuesRange.min<.5*(dataMax-dataMin)&&(valuesRange.min>dataMin&&(chartLimits.min=valuesRange.min-.5*(valuesRange.max-valuesRange.min)),valuesRange.max<dataMax&&(chartLimits.max=valuesRange.max+.5*(valuesRange.max-valuesRange.min)))}this.contextYScale=d3_default.a.scale.linear().range([cxtChartHeight,3]).domain([chartLimits.min,chartLimits.max]);const borders=cxtGroup.append("g").attr("class","axis"),brushChartHeight=cxtChartHeight+swlHeight+annotationHeight;borders.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",brushChartHeight),borders.append("line").attr("x1",cxtWidth).attr("y1",0).attr("x2",cxtWidth).attr("y2",brushChartHeight),borders.append("line").attr("x1",0).attr("y1",brushChartHeight).attr("x2",cxtWidth).attr("y2",brushChartHeight);const timeBuckets=Object(time_buckets.c)();timeBuckets.setInterval("auto"),timeBuckets.setBounds(bounds);const xAxisTickFormat=timeBuckets.getScaledDateFormat(),xAxis=d3_default.a.svg.axis().scale(this.contextXScale).orient("top").innerTickSize(-cxtChartHeight).outerTickSize(0).tickPadding(0).ticks(Object(chart_utils.m)(cxtWidth,xAxisTickFormat)).tickFormat(d=>external_kbnSharedDeps_Moment_default()(d).format(xAxisTickFormat));cxtGroup.datum(data);const contextBoundsArea=d3_default.a.svg.area().x(d=>this.contextXScale(d.date)).y0(d=>this.contextYScale(Math.min(chartLimits.max,Math.max(d.lower,chartLimits.min)))).y1(d=>this.contextYScale(Math.max(chartLimits.min,Math.min(d.upper,chartLimits.max)))).defined(d=>null!==d.lower&&null!==d.upper);!0===modelPlotEnabled&&cxtGroup.append("path").datum(data).attr("class","area bounds").attr("d",contextBoundsArea);const contextValuesLine=d3_default.a.svg.line().x(d=>this.contextXScale(d.date)).y(d=>this.contextYScale(d.value)).defined(d=>null!==d.value);cxtGroup.append("path").datum(data).attr("class","values-line").attr("d",contextValuesLine),Object(chart_utils.g)(data,cxtGroup,contextValuesLine,1),cxtGroup.append("g").classed("mlContextAnnotations",!0);const[contextXRangeStart,contextXRangeEnd]=this.contextXScale.range(),ctxAnnotations=cxtGroup.select(".mlContextAnnotations").selectAll("g.mlContextAnnotation").data(annotationData,d=>d._id||"");ctxAnnotations.enter().append("g").classed("mlContextAnnotation",!0);const ctxAnnotationRects=ctxAnnotations.selectAll(".mlContextAnnotationRect").data(d=>[d]);ctxAnnotationRects.enter().append("rect").on("mouseover",(function(d){showFocusChartTooltip(d,this)})).on("mouseout",()=>hideFocusChartTooltip()).classed("mlContextAnnotationRect",!0),ctxAnnotationRects.attr("x",d=>{const date=external_kbnSharedDeps_Moment_default()(d.timestamp);let xPos=this.contextXScale(date);return xPos-chart_utils.a<=contextXRangeStart&&(xPos=0),xPos+chart_utils.a>=contextXRangeEnd&&(xPos=contextXRangeEnd-chart_utils.a),xPos}).attr("y",cxtChartHeight+swlHeight+2).attr("height",chart_utils.a).attr("width",d=>{const start=Math.max(this.contextXScale(external_kbnSharedDeps_Moment_default()(d.timestamp))+1,contextXRangeStart),end=void 0!==d.end_timestamp?this.contextXScale(external_kbnSharedDeps_Moment_default()(d.end_timestamp))-1:start+8;return Math.max(8,end-start)}),ctxAnnotationRects.exit().remove(),void 0!==contextForecastData&&(cxtGroup.append("path").datum(contextForecastData).attr("class","area forecast").attr("d",contextBoundsArea),cxtGroup.append("path").datum(contextForecastData).attr("class","values-line forecast").attr("d",contextValuesLine));const swimlane=cxtGroup.append("g").attr("class","swimlane").attr("transform","translate(0,"+cxtChartHeight+")");this.drawSwimlane(swimlane,cxtWidth,swlHeight),this.mask=new ContextChartMask(cxtGroup,contextChartData,modelPlotEnabled,swlHeight).x(this.contextXScale).y(this.contextYScale),cxtGroup.append("g").attr("class","x axis context-chart-axis").call(xAxis),cxtGroup.selectAll(".x.context-chart-axis text").attr("dy",cxtChartHeight-5),Object(chart_utils.h)(cxtGroup.selectAll(".x.context-chart-axis"),cxtWidth),this.drawContextBrush(cxtGroup)}setZoomInterval(ms){const{bounds:bounds,zoomTo:zoomTo}=this.props,minBoundsMs=bounds.min.valueOf(),maxBoundsMs=bounds.max.valueOf(),millis=+ms;let to=zoomTo.getTime(),from=to-millis;from<minBoundsMs&&(from=minBoundsMs,to=Math.min(minBoundsMs+millis,maxBoundsMs)),this.setContextBrushExtent(new Date(from),new Date(to))}showFocusChartTooltip(marker,circle){const{modelPlotEnabled:modelPlotEnabled}=this.props,fieldFormat=this.fieldFormat,seriesKey="single_metric_viewer",tooltipData=[{label:Object(date_utils.c)(marker.date)}];if(void 0!==marker.anomalyScore){const score=parseInt(marker.anomalyScore);if(tooltipData.push({label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.anomalyScoreLabel",{defaultMessage:"anomaly score"}),value:Object(anomaly_utils.g)(score),color:anomalyColorScale(score),seriesIdentifier:{key:seriesKey},valueAccessor:"anomaly_score"}),!0===Object(chart_utils.p)(marker)&&tooltipData.push({label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.multiBucketImpactLabel",{defaultMessage:"multi-bucket impact"}),value:Object(anomaly_utils.h)(marker.multiBucketImpact),seriesIdentifier:{key:seriesKey},valueAccessor:"multi_bucket_impact"}),marker.metricFunction&&tooltipData.push({label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.metricActualPlotFunctionLabel",{defaultMessage:"function"}),value:marker.metricFunction,seriesIdentifier:{key:seriesKey},valueAccessor:"metric_function"}),!1===modelPlotEnabled){if(void 0!==marker.actual&&"rare"!==marker.function)tooltipData.push({label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.actualLabel",{defaultMessage:"actual"}),value:Object(format_value.b)(marker.actual,marker.function,fieldFormat),seriesIdentifier:{key:seriesKey},valueAccessor:"actual"}),tooltipData.push({label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.typicalLabel",{defaultMessage:"typical"}),value:Object(format_value.b)(marker.typical,marker.function,fieldFormat),seriesIdentifier:{key:seriesKey},valueAccessor:"typical"});else if(tooltipData.push({label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.valueLabel",{defaultMessage:"value"}),value:Object(format_value.b)(marker.value,marker.function,fieldFormat),seriesIdentifier:{key:seriesKey},valueAccessor:"value"}),void 0!==marker.byFieldName&&void 0!==marker.numberOfCauses){const numberOfCauses=marker.numberOfCauses,byFieldName=Object(string_utils.d)(marker.byFieldName);tooltipData.push({label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.moreThanOneUnusualByFieldValuesLabel",{defaultMessage:"{numberOfCauses}{plusSign} unusual {byFieldName} values",values:{numberOfCauses:numberOfCauses,byFieldName:byFieldName,plusSign:numberOfCauses<10?"":"+"}}),seriesIdentifier:{key:seriesKey},valueAccessor:"numberOfCauses"})}}else tooltipData.push({label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.modelPlotEnabled.actualLabel",{defaultMessage:"actual"}),value:Object(format_value.b)(marker.actual,marker.function,fieldFormat),seriesIdentifier:{key:seriesKey},valueAccessor:"actual"}),tooltipData.push({label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.modelPlotEnabled.upperBoundsLabel",{defaultMessage:"upper bounds"}),value:Object(format_value.b)(marker.upper,marker.function,fieldFormat),seriesIdentifier:{key:seriesKey},valueAccessor:"upper_bounds"}),tooltipData.push({label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.modelPlotEnabled.lowerBoundsLabel",{defaultMessage:"lower bounds"}),value:Object(format_value.b)(marker.lower,marker.function,fieldFormat),seriesIdentifier:{key:seriesKey},valueAccessor:"lower_bounds"})}else!0===Object(external_kbnSharedDeps_Lodash_.get)(marker,"isForecast",!1)?tooltipData.push({label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.withoutAnomalyScore.predictionLabel",{defaultMessage:"prediction"}),value:Object(format_value.b)(marker.value,marker.function,fieldFormat),seriesIdentifier:{key:seriesKey},valueAccessor:"prediction"}):tooltipData.push({label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.withoutAnomalyScore.valueLabel",{defaultMessage:"value"}),value:Object(format_value.b)(marker.value,marker.function,fieldFormat),seriesIdentifier:{key:seriesKey},valueAccessor:"value"}),!0===modelPlotEnabled&&(tooltipData.push({label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.withoutAnomalyScoreAndModelPlotEnabled.upperBoundsLabel",{defaultMessage:"upper bounds"}),value:Object(format_value.b)(marker.upper,marker.function,fieldFormat),seriesIdentifier:{key:seriesKey},valueAccessor:"upper_bounds"}),tooltipData.push({label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.withoutAnomalyScoreAndModelPlotEnabled.lowerBoundsLabel",{defaultMessage:"lower bounds"}),value:Object(format_value.b)(marker.lower,marker.function,fieldFormat),seriesIdentifier:{key:seriesKey},valueAccessor:"lower_bounds"}));if(void 0!==marker.scheduledEvents&&marker.scheduledEvents.forEach((scheduledEvent,i)=>{tooltipData.push({label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.scheduledEventsLabel",{defaultMessage:"scheduled event{counter}",values:{counter:marker.scheduledEvents.length>1?" #"+(i+1):""}}),value:scheduledEvent,seriesIdentifier:{key:seriesKey},valueAccessor:"scheduled_events_"+(i+1)})}),void 0!==marker.annotation){tooltipData.length=0,tooltipData.push({label:marker.annotation});let timespan=external_kbnSharedDeps_Moment_default()(marker.timestamp).format("MMMM Do YYYY, HH:mm");void 0!==marker.end_timestamp&&(timespan+=" - "+external_kbnSharedDeps_Moment_default()(marker.end_timestamp).format("MMMM Do YYYY, HH:mm")),tooltipData.push({label:timespan,seriesIdentifier:{key:seriesKey},valueAccessor:"timespan"})}let xOffset=2*chart_utils.b;if("rect"===circle.tagName.toLowerCase()){const x=Number(circle.getAttribute("x"));x<0&&(xOffset=Math.abs(x))}this.props.tooltipService.show(tooltipData,circle,{x:xOffset,y:0})}highlightFocusChartAnomaly(record){const{focusChartData:focusChartData,focusAggregationInterval:focusAggregationInterval}=this.props,focusXScale=this.focusXScale,focusYScale=this.focusYScale,showFocusChartTooltip=this.showFocusChartTooltip.bind(this),markerToSelect=findChartPointForAnomalyTime(focusChartData,record.source.timestamp,focusAggregationInterval);if(void 0!==markerToSelect){const selectedMarker=d3_default.a.select(".focus-chart-markers").selectAll(".focus-chart-highlighted-marker").data([markerToSelect]);!0===Object(chart_utils.o)(markerToSelect)?selectedMarker.enter().append("path").attr("d",d3_default.a.svg.symbol().size(chart_utils.c).type("cross")).attr("transform",d=>`translate(${focusXScale(d.date)}, ${focusYScale(d.value)})`).attr("class",d=>`anomaly-marker multi-bucket ${Object(anomaly_utils.l)(d.anomalyScore).id} highlighted`):selectedMarker.enter().append("circle").attr("r",chart_utils.b).attr("cx",d=>focusXScale(d.date)).attr("cy",d=>focusYScale(d.value)).attr("class",d=>`anomaly-marker metric-value ${Object(anomaly_utils.l)(d.anomalyScore).id} highlighted`);const anomalyMarker=d3_default.a.select(this.rootNode).selectAll(".focus-chart-markers .anomaly-marker.highlighted");anomalyMarker.length&&showFocusChartTooltip(markerToSelect,anomalyMarker[0][0])}}unhighlightFocusChartAnomaly(){d3_default.a.select(".focus-chart-markers").selectAll(".anomaly-marker.highlighted").remove(),this.props.tooltipService.hide()}shouldComponentUpdate(){return!0}setRef(componentNode){this.rootNode=componentNode}render(){return external_kbnSharedDeps_React_default.a.createElement("div",{className:"ml-timeseries-chart-react",ref:this.setRef.bind(this)})}}const TimeseriesChart=props=>{const annotationUpdatesService=Object(external_kbnSharedDeps_React_.useContext)(ml_annotation_updates_context.a),annotationProp=useObservable_default()(annotationUpdatesService.isAnnotationInitialized$());return void 0===annotationProp?null:external_kbnSharedDeps_React_default.a.createElement(timeseries_chart_TimeseriesChartIntl,timeseries_chart_extends({annotation:annotationProp},props,{annotationUpdatesService:annotationUpdatesService}))};function timeseries_chart_with_tooltip_extends(){return(timeseries_chart_with_tooltip_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const TimeSeriesChartWithTooltips=({bounds:bounds,detectorIndex:detectorIndex,renderFocusChartOnly:renderFocusChartOnly,selectedJob:selectedJob,selectedEntities:selectedEntities,showAnnotations:showAnnotations,showForecast:showForecast,showModelBounds:showModelBounds,chartProps:chartProps,lastRefresh:lastRefresh,contextAggregationInterval:contextAggregationInterval})=>{const{toasts:toastNotifications}=Object(contexts_kibana.f)(),{services:{mlServices:{mlApiServices:mlApiServices}}}=Object(contexts_kibana.b)(),annotationUpdatesService=Object(external_kbnSharedDeps_React_.useContext)(ml_annotation_updates_context.a),[annotationData,setAnnotationData]=Object(external_kbnSharedDeps_React_.useState)([]),showAnnotationErrorToastNotification=Object(external_kbnSharedDeps_React_.useCallback)(error=>{toastNotifications.addDanger({title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.mlSingleMetricViewerChart.annotationsErrorTitle",{defaultMessage:"An error occurred fetching annotations"}),...error?{text:Object(util_errors.i)(error)}:{}})},[]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{let unmounted=!1;const entities=getControlsForDetector(detectorIndex,selectedEntities,selectedJob.job_id),nonBlankEntities=Array.isArray(entities)?entities.filter(entity=>null!==entity.fieldValue):void 0,searchBounds=Object(time_buckets.b)(bounds,contextAggregationInterval,!1);return(async jobId=>{try{const resp=await mlApiServices.annotations.getAnnotations({jobIds:[jobId],earliestMs:searchBounds.min.valueOf(),latestMs:searchBounds.max.valueOf(),maxAnnotations:constants_search.a,fields:[{field:"event",missing:constants_annotations.b}],detectorIndex:detectorIndex,entities:nonBlankEntities});unmounted||Array.isArray(resp.annotations[jobId])&&setAnnotationData(resp.annotations[jobId])}catch(error){showAnnotationErrorToastNotification(error)}})(selectedJob.job_id),()=>{unmounted=!0}},[selectedJob.job_id,detectorIndex,lastRefresh,selectedEntities,bounds,contextAggregationInterval]),external_kbnSharedDeps_React_default.a.createElement("div",{className:"ml-timeseries-chart","data-test-subj":"mlSingleMetricViewerChart"},external_kbnSharedDeps_React_default.a.createElement(chart_tooltip.a,null,tooltipService=>external_kbnSharedDeps_React_default.a.createElement(TimeseriesChart,timeseries_chart_with_tooltip_extends({},chartProps,{annotationUpdatesService:annotationUpdatesService,annotationData:annotationData,bounds:bounds,detectorIndex:detectorIndex,renderFocusChartOnly:renderFocusChartOnly,selectedJob:selectedJob,showAnnotations:showAnnotations,showForecast:showForecast,showModelBounds:showModelBounds,tooltipService:tooltipService}))))},TimeseriesexplorerChartDataError=({errorMsg:errorMsg})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiEmptyPrompt,{iconType:"alert",title:external_kbnSharedDeps_React_default.a.createElement("h2",null,errorMsg)});function timeseriesexplorer_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}const allValuesLabel=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.allPartitionValuesLabel",{defaultMessage:"all"});class timeseriesexplorer_TimeSeriesExplorer extends external_kbnSharedDeps_React_default.a.Component{constructor(...args){super(...args),timeseriesexplorer_defineProperty(this,"state",{chartDetails:void 0,contextAggregationInterval:void 0,contextChartData:void 0,contextForecastData:void 0,dataNotChartable:!1,entitiesLoading:!1,entityValues:{},focusAnnotationData:[],focusAggregations:{},focusAggregationInterval:{},focusChartData:void 0,focusForecastData:void 0,fullRefresh:!0,hasResults:!1,loadCounter:0,loading:!1,modelPlotEnabled:!1,showAnnotations:!0,showAnnotationsCheckbox:!0,showForecast:!0,showForecastCheckbox:!1,showModelBounds:!0,showModelBoundsCheckbox:!1,svgWidth:0,tableData:void 0,zoomFrom:void 0,zoomTo:void 0,zoomFromFocusLoaded:void 0,zoomToFocusLoaded:void 0,chartDataError:void 0}),timeseriesexplorer_defineProperty(this,"subscriptions",new external_kbnSharedDeps_Rxjs_.Subscription),timeseriesexplorer_defineProperty(this,"resizeRef",Object(external_kbnSharedDeps_React_.createRef)()),timeseriesexplorer_defineProperty(this,"resizeChecker",void 0),timeseriesexplorer_defineProperty(this,"resizeHandler",()=>{this.setState({svgWidth:null!==this.resizeRef.current?this.resizeRef.current.offsetWidth-34:0})}),timeseriesexplorer_defineProperty(this,"unmounted",!1),timeseriesexplorer_defineProperty(this,"contextChart$",new external_kbnSharedDeps_Rxjs_.Subject),timeseriesexplorer_defineProperty(this,"getFieldNamesWithEmptyValues",()=>this.getControlsForDetector().filter(({fieldValue:fieldValue})=>null===fieldValue).map(({fieldName:fieldName})=>fieldName)),timeseriesexplorer_defineProperty(this,"arePartitioningFieldsProvided",()=>0===this.getFieldNamesWithEmptyValues().length),timeseriesexplorer_defineProperty(this,"toggleShowAnnotationsHandler",()=>{this.setState(prevState=>({showAnnotations:!prevState.showAnnotations}))}),timeseriesexplorer_defineProperty(this,"toggleShowForecastHandler",()=>{this.setState(prevState=>({showForecast:!prevState.showForecast}))}),timeseriesexplorer_defineProperty(this,"toggleShowModelBoundsHandler",()=>{this.setState({showModelBounds:!this.state.showModelBounds})}),timeseriesexplorer_defineProperty(this,"setFunctionDescription",selectedFuction=>{this.props.appStateHandler(APP_STATE_ACTION_SET_FUNCTION_DESCRIPTION,selectedFuction)}),timeseriesexplorer_defineProperty(this,"previousChartProps",{}),timeseriesexplorer_defineProperty(this,"previousShowAnnotations",void 0),timeseriesexplorer_defineProperty(this,"previousShowForecast",void 0),timeseriesexplorer_defineProperty(this,"previousShowModelBounds",void 0),timeseriesexplorer_defineProperty(this,"tableFilter",(field,value,operator)=>{const entities=this.getControlsForDetector(),entity=entities.find(({fieldName:fieldName})=>fieldName===field);if(void 0===entity)return;const{appStateHandler:appStateHandler}=this.props;let resultValue="";if("+"===operator&&entity.fieldValue!==value)resultValue=value;else{if("-"!==operator||entity.fieldValue!==value)return;resultValue=null}const resultEntities={...entities.reduce((appStateEntities,appStateEntity)=>(appStateEntities[appStateEntity.fieldName]=appStateEntity.fieldValue,appStateEntities),{}),[entity.fieldName]:resultValue};appStateHandler(APP_STATE_ACTION_SET_ENTITIES,resultEntities)}),timeseriesexplorer_defineProperty(this,"contextChartSelectedInitCallDone",!1),timeseriesexplorer_defineProperty(this,"contextChartSelected",selection=>{const zoomState={from:selection.from.toISOString(),to:selection.to.toISOString()};Object(external_kbnSharedDeps_Lodash_.isEqual)(this.props.zoom,zoomState)&&void 0!==this.state.focusChartData&&this.props.previousRefresh===this.props.lastRefresh||(this.contextChart$.next(selection),this.props.appStateHandler(APP_STATE_ACTION_SET_ZOOM,zoomState))}),timeseriesexplorer_defineProperty(this,"loadAnomaliesTableData",(earliestMs,latestMs)=>{const{dateFormatTz:dateFormatTz,selectedDetectorIndex:selectedDetectorIndex,selectedJobId:selectedJobId,tableInterval:tableInterval,tableSeverity:tableSeverity,functionDescription:functionDescription}=this.props,selectedJob=job_service.a.getJob(selectedJobId),entityControls=this.getControlsForDetector();return ml_api_service.ml.results.getAnomaliesTableData([selectedJob.job_id],this.getCriteriaFields(selectedDetectorIndex,entityControls),[],tableInterval,tableSeverity,earliestMs,latestMs,dateFormatTz,constants_search.b,void 0,void 0,functionDescription).pipe(Object(external_kbnSharedDeps_RxjsOperators_.map)(resp=>{const anomalies=resp.anomalies,detectorsByJob=job_service.a.detectorsByJob;return anomalies.forEach(anomaly=>{const jobId=anomaly.jobId,detector=Object(external_kbnSharedDeps_Lodash_.get)(detectorsByJob,[jobId,anomaly.detectorIndex]);anomaly.detector=Object(external_kbnSharedDeps_Lodash_.get)(detector,["detector_description"],anomaly.source.function_description);const customRules=detector.custom_rules;void 0!==customRules&&(anomaly.rulesLength=customRules.length),Object(external_kbnSharedDeps_Lodash_.has)(job_service.a.customUrlsByJob,jobId)&&(anomaly.customUrls=job_service.a.customUrlsByJob[jobId])}),{tableData:{anomalies:anomalies,interval:resp.interval,examplesByJobId:resp.examplesByJobId,showViewSeriesLink:!1}}}))}),timeseriesexplorer_defineProperty(this,"setForecastId",forecastId=>{this.props.appStateHandler(APP_STATE_ACTION_SET_FORECAST_ID,forecastId)}),timeseriesexplorer_defineProperty(this,"displayErrorToastMessages",(error,errorMsg)=>{this.props.toastNotificationService&&this.props.toastNotificationService.displayErrorToast(error,errorMsg,2e3),this.setState({loading:!1,chartDataError:errorMsg})}),timeseriesexplorer_defineProperty(this,"loadSingleMetricData",(fullRefresh=!0)=>{const{autoZoomDuration:autoZoomDuration,bounds:bounds,selectedDetectorIndex:selectedDetectorIndex,selectedForecastId:selectedForecastId,selectedJobId:selectedJobId,zoom:zoom,functionDescription:functionDescription}=this.props,{loadCounter:currentLoadCounter}=this.state,currentSelectedJob=job_service.a.getJob(selectedJobId);if(void 0===currentSelectedJob)return;if(isMetricDetector(currentSelectedJob,selectedDetectorIndex)&&void 0===functionDescription)return;const functionToPlotByIfMetric=anomaly_utils.c.toES(functionDescription);this.contextChartSelectedInitCallDone=!1;const entityControls=this.getControlsForDetector();this.setState({fullRefresh:fullRefresh,loadCounter:currentLoadCounter+1,loading:!0,chartDataError:void 0,...fullRefresh?{chartDetails:void 0,contextChartData:void 0,contextForecastData:void 0,focusChartData:void 0,focusForecastData:void 0,modelPlotEnabled:Object(job_utils.l)(currentSelectedJob,selectedDetectorIndex)&&Object(job_utils.m)(currentSelectedJob,selectedDetectorIndex,entityControls),hasResults:!1,dataNotChartable:!1}:{}},()=>{const{loadCounter:loadCounter,modelPlotEnabled:modelPlotEnabled}=this.state,jobs=createTimeSeriesJobData(job_service.a.jobs),selectedJob=job_service.a.getJob(selectedJobId),detectorIndex=selectedDetectorIndex;let awaitingCount=3;const stateUpdate={},finish=counterVar=>{if(awaitingCount--,0===awaitingCount&&counterVar===loadCounter){if(stateUpdate.hasResults=Array.isArray(stateUpdate.contextChartData)&&stateUpdate.contextChartData.length>0||Array.isArray(stateUpdate.contextForecastData)&&stateUpdate.contextForecastData.length>0,stateUpdate.loading=!1,stateUpdate.contextChartData.length&&!0===this.arePartitioningFieldsProvided()){let focusRange=function(zoomState,contextAggregationInterval,bounds){if(void 0!==zoomState){const zoomFrom=external_kbnSharedDeps_MomentTimezone_default()(zoomState.from,"YYYY-MM-DDTHH:mm:ss.SSSZ",!0),zoomTo=external_kbnSharedDeps_MomentTimezone_default()(zoomState.to,"YYYY-MM-DDTHH:mm:ss.SSSZ",!0),searchBounds=Object(time_buckets.b)(bounds,contextAggregationInterval,!0),earliest=searchBounds.min,latest=searchBounds.max;if(zoomFrom.isValid()&&zoomTo.isValid&&zoomTo.isAfter(zoomFrom)&&zoomFrom.isBetween(earliest,latest,null,"[]")&&zoomTo.isBetween(earliest,latest,null,"[]"))return[zoomFrom.toDate(),zoomTo.toDate()]}}(zoom,stateUpdate.contextAggregationInterval,bounds);void 0!==focusRange&&this.previousSelectedForecastId===this.props.selectedForecastId||(focusRange=function(autoZoomDuration,contextAggregationInterval,contextChartData,contextForecastData){const isForecastData=void 0!==contextForecastData&&contextForecastData.length>0,combinedData=!1===isForecastData?contextChartData:contextChartData.concat(contextForecastData),earliestDataDate=combinedData[0].date,latestDataDate=combinedData[combinedData.length-1].date;let rangeEarliestMs,rangeLatestMs;if(!0===isForecastData){const earliestForecastDataDate=contextForecastData[0].date,latestForecastDataDate=contextForecastData[contextForecastData.length-1].date;rangeLatestMs=Math.min(earliestForecastDataDate.getTime()+autoZoomDuration/2,latestForecastDataDate.getTime()),rangeEarliestMs=Math.max(rangeLatestMs-autoZoomDuration,earliestDataDate.getTime())}else rangeLatestMs=latestDataDate.getTime()+contextAggregationInterval.asMilliseconds(),rangeEarliestMs=Math.max(earliestDataDate.getTime(),rangeLatestMs-autoZoomDuration);return[new Date(rangeEarliestMs),new Date(rangeLatestMs)]}(autoZoomDuration,stateUpdate.contextAggregationInterval,stateUpdate.contextChartData,stateUpdate.contextForecastData),this.previousSelectedForecastId=this.props.selectedForecastId),this.contextChartSelected({from:focusRange[0],to:focusRange[1]})}this.setState(stateUpdate)}},nonBlankEntities=entityControls.filter(entity=>null!==entity.fieldValue);if(!1===modelPlotEnabled&&!1===Object(job_utils.n)(selectedJob,detectorIndex)&&nonBlankEntities.length>0)return stateUpdate.hasResults=!1,stateUpdate.loading=!1,stateUpdate.dataNotChartable=!0,void this.setState(stateUpdate);stateUpdate.contextAggregationInterval=calculateAggregationInterval(bounds,500,jobs,selectedJob);const searchBounds=Object(time_buckets.b)(bounds,stateUpdate.contextAggregationInterval,!1),counter=loadCounter;if(mlTimeSeriesSearchService.getMetricData(selectedJob,detectorIndex,nonBlankEntities,searchBounds.min.valueOf(),searchBounds.max.valueOf(),stateUpdate.contextAggregationInterval.asMilliseconds(),functionToPlotByIfMetric).toPromise().then(resp=>{const fullRangeChartData=processMetricPlotResults(resp.results,modelPlotEnabled);stateUpdate.contextChartData=fullRangeChartData,finish(counter)}).catch(err=>{const errorMsg=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.metricDataErrorMessage",{defaultMessage:"Error getting metric data"});this.displayErrorToastMessages(err,errorMsg)}),results_service.mlResultsService.getRecordMaxScoreByTime(selectedJob.job_id,this.getCriteriaFields(detectorIndex,entityControls),searchBounds.min.valueOf(),searchBounds.max.valueOf(),stateUpdate.contextAggregationInterval.asMilliseconds(),functionToPlotByIfMetric).then(resp=>{const fullRangeRecordScoreData=function(scoreData){const bucketScoreData=[];return Object(external_kbnSharedDeps_Lodash_.each)(scoreData,(dataForTime,time)=>{bucketScoreData.push({date:new Date(+time),score:dataForTime.score})}),bucketScoreData}(resp.results);stateUpdate.swimlaneData=fullRangeRecordScoreData,finish(counter)}).catch(err=>{const errorMsg=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.bucketAnomalyScoresErrorMessage",{defaultMessage:"Error getting bucket anomaly scores"});this.displayErrorToastMessages(err,errorMsg)}),mlTimeSeriesSearchService.getChartDetails(selectedJob,detectorIndex,entityControls,searchBounds.min.valueOf(),searchBounds.max.valueOf()).then(resp=>{stateUpdate.chartDetails=resp.results,finish(counter)}).catch(err=>{this.displayErrorToastMessages(err,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.entityCountsErrorMessage",{defaultMessage:"Error getting entity counts"}))}),void 0!==selectedForecastId){awaitingCount++;let aggType=void 0;const detector=selectedJob.analysis_config.detectors[detectorIndex],esAgg=Object(job_utils.q)(detector.function);!1!==modelPlotEnabled||"sum"!==esAgg&&"count"!==esAgg||(aggType={avg:"sum",max:"sum",min:"sum"}),forecast_service.a.getForecastData(selectedJob,detectorIndex,selectedForecastId,nonBlankEntities,searchBounds.min.valueOf(),searchBounds.max.valueOf(),stateUpdate.contextAggregationInterval.asMilliseconds(),aggType).toPromise().then(resp=>{stateUpdate.contextForecastData=processForecastResults(resp.results),finish(counter)}).catch(err=>{this.displayErrorToastMessages(err,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.forecastDataErrorMessage",{defaultMessage:"Error loading forecast data for forecast ID {forecastId}",values:{forecastId:selectedForecastId}}))})}})}),timeseriesexplorer_defineProperty(this,"getControlsForDetector",()=>{const{selectedDetectorIndex:selectedDetectorIndex,selectedEntities:selectedEntities,selectedJobId:selectedJobId}=this.props;return getControlsForDetector(selectedDetectorIndex,selectedEntities,selectedJobId)})}getFocusAggregationInterval(selection){const{selectedJobId:selectedJobId}=this.props,jobs=createTimeSeriesJobData(job_service.a.jobs),selectedJob=job_service.a.getJob(selectedJobId);return calculateAggregationInterval({min:external_kbnSharedDeps_MomentTimezone_default()(selection.from),max:external_kbnSharedDeps_MomentTimezone_default()(selection.to)},500,jobs,selectedJob)}getFocusData(selection){const{selectedJobId:selectedJobId,selectedForecastId:selectedForecastId,selectedDetectorIndex:selectedDetectorIndex,functionDescription:functionDescription}=this.props,{modelPlotEnabled:modelPlotEnabled}=this.state,selectedJob=job_service.a.getJob(selectedJobId);if(isMetricDetector(selectedJob,selectedDetectorIndex)&&void 0===functionDescription)return;const entityControls=this.getControlsForDetector(),bounds={min:external_kbnSharedDeps_MomentTimezone_default()(selection.from),max:external_kbnSharedDeps_MomentTimezone_default()(selection.to)},focusAggregationInterval=this.getFocusAggregationInterval(selection),searchBounds=Object(time_buckets.b)(bounds,focusAggregationInterval,!1);return getFocusData(this.getCriteriaFields(selectedDetectorIndex,entityControls),selectedDetectorIndex,focusAggregationInterval,selectedForecastId,modelPlotEnabled,entityControls.filter(entity=>null!==entity.fieldValue),searchBounds,selectedJob,functionDescription)}getCriteriaFields(detectorIndex,entities){return[{fieldName:"detector_index",fieldValue:detectorIndex},...entities.filter(entity=>null!==entity.fieldValue)]}loadForJobId(jobId){const{appStateHandler:appStateHandler,selectedDetectorIndex:selectedDetectorIndex}=this.props,selectedJob=job_service.a.getJob(jobId);if(void 0===selectedJob)return;const detectors=getViewableDetectors(selectedJob);let detectorIndex=void 0!==selectedDetectorIndex?selectedDetectorIndex:detectors[0].index;if(void 0===Object(external_kbnSharedDeps_Lodash_.find)(detectors,{index:detectorIndex})){const warningText=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.requestedDetectorIndexNotValidWarningMessage",{defaultMessage:"Requested detector index {detectorIndex} is not valid for job {jobId}",values:{detectorIndex:detectorIndex,jobId:selectedJob.job_id}});this.props.toastNotificationService&&this.props.toastNotificationService.displayWarningToast(warningText),detectorIndex=detectors[0].index}detectorIndex!==selectedDetectorIndex&&appStateHandler(APP_STATE_ACTION_SET_DETECTOR_INDEX,detectorIndex),field_format_service.a.populateFormats([jobId]).catch(err=>{console.log("Error populating field formats:",err)})}componentDidMount(){const{invalidTimeRangeError:invalidTimeRangeError}=this.props;invalidTimeRangeError&&this.props.toastNotificationService&&this.props.toastNotificationService.displayWarningToast(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.invalidTimeRangeInUrlCallout",{defaultMessage:"The time filter was changed to the full range for this job due to an invalid default time filter. Check the advanced settings for {field}.",values:{field:constants_settings.a}})),this.resizeChecker=new public_.ResizeChecker(this.resizeRef.current),this.resizeChecker.on("resize",()=>{this.resizeHandler()}),this.resizeHandler(),this.subscriptions.add(this.contextChart$.pipe(Object(external_kbnSharedDeps_RxjsOperators_.tap)(selection=>{this.setState({zoomFrom:selection.from,zoomTo:selection.to})}),Object(external_kbnSharedDeps_RxjsOperators_.debounceTime)(500),Object(external_kbnSharedDeps_RxjsOperators_.tap)(selection=>{const{contextChartData:contextChartData,contextForecastData:contextForecastData,focusChartData:focusChartData,zoomFromFocusLoaded:zoomFromFocusLoaded,zoomToFocusLoaded:zoomToFocusLoaded}=this.state;(void 0!==contextChartData&&0!==contextChartData.length||void 0!==contextForecastData&&0!==contextForecastData.length)&&(!1===this.contextChartSelectedInitCallDone&&void 0===focusChartData||zoomFromFocusLoaded.getTime()!==selection.from.getTime()||zoomToFocusLoaded.getTime()!==selection.to.getTime())&&(this.contextChartSelectedInitCallDone=!0,this.setState({loading:!0,fullRefresh:!1}))}),Object(external_kbnSharedDeps_RxjsOperators_.switchMap)(selection=>{const{selectedJobId:selectedJobId}=this.props,jobs=createTimeSeriesJobData(job_service.a.jobs),selectedJob=job_service.a.getJob(selectedJobId),bounds={min:external_kbnSharedDeps_MomentTimezone_default()(selection.from),max:external_kbnSharedDeps_MomentTimezone_default()(selection.to)},focusAggregationInterval=calculateAggregationInterval(bounds,500,jobs,selectedJob),searchBounds=Object(time_buckets.b)(bounds,focusAggregationInterval,!1);return Object(external_kbnSharedDeps_Rxjs_.forkJoin)([this.getFocusData(selection),this.loadAnomaliesTableData(searchBounds.min.valueOf(),searchBounds.max.valueOf())])}),Object(external_kbnSharedDeps_RxjsOperators_.withLatestFrom)(this.contextChart$)).subscribe(([[refreshFocusData,tableData],selection])=>{const{modelPlotEnabled:modelPlotEnabled}=this.state;this.setState({focusAggregationInterval:this.getFocusAggregationInterval({from:selection.from,to:selection.to}),loading:!1,showModelBoundsCheckbox:modelPlotEnabled&&refreshFocusData.focusChartData.length>0,zoomFromFocusLoaded:selection.from,zoomToFocusLoaded:selection.to,...refreshFocusData,...tableData})})),this.componentDidUpdate()}componentDidUpdate(previousProps){if(void 0!==previousProps&&previousProps.selectedJobId===this.props.selectedJobId||(this.contextChartSelectedInitCallDone=!1,this.setState({fullRefresh:!1,loading:!0},()=>{this.loadForJobId(this.props.selectedJobId)})),void 0!==previousProps&&previousProps.selectedForecastId===this.props.selectedForecastId||void 0!==this.props.selectedForecastId&&(this.setState({showForecast:!0}),void 0!==previousProps&&(this.previousSelectedForecastId=previousProps.selectedForecastId)),void 0===previousProps||!Object(external_kbnSharedDeps_Lodash_.isEqual)(previousProps.bounds,this.props.bounds)||!Object(external_kbnSharedDeps_Lodash_.isEqual)(previousProps.lastRefresh,this.props.lastRefresh)&&0!==previousProps.lastRefresh||!Object(external_kbnSharedDeps_Lodash_.isEqual)(previousProps.selectedDetectorIndex,this.props.selectedDetectorIndex)||!Object(external_kbnSharedDeps_Lodash_.isEqual)(previousProps.selectedEntities,this.props.selectedEntities)||previousProps.selectedForecastId!==this.props.selectedForecastId||previousProps.selectedJobId!==this.props.selectedJobId||previousProps.functionDescription!==this.props.functionDescription){const fullRefresh=void 0===previousProps||!Object(external_kbnSharedDeps_Lodash_.isEqual)(previousProps.bounds,this.props.bounds)||!Object(external_kbnSharedDeps_Lodash_.isEqual)(previousProps.selectedDetectorIndex,this.props.selectedDetectorIndex)||!Object(external_kbnSharedDeps_Lodash_.isEqual)(previousProps.selectedEntities,this.props.selectedEntities)||previousProps.selectedForecastId!==this.props.selectedForecastId||previousProps.selectedJobId!==this.props.selectedJobId||previousProps.functionDescription!==this.props.functionDescription;this.loadSingleMetricData(fullRefresh)}if(void 0===previousProps)return;const tableControlsListener=()=>{const{zoomFrom:zoomFrom,zoomTo:zoomTo}=this.state;void 0!==zoomFrom&&void 0!==zoomTo&&this.loadAnomaliesTableData(zoomFrom.getTime(),zoomTo.getTime()).subscribe(res=>this.setState(res))};previousProps.tableInterval===this.props.tableInterval&&previousProps.tableSeverity===this.props.tableSeverity||tableControlsListener()}componentWillUnmount(){this.subscriptions.unsubscribe(),this.resizeChecker.destroy(),this.unmounted=!0}render(){const{autoZoomDuration:autoZoomDuration,bounds:bounds,dateFormatTz:dateFormatTz,lastRefresh:lastRefresh,selectedDetectorIndex:selectedDetectorIndex,selectedJobId:selectedJobId}=this.props,{chartDetails:chartDetails,contextAggregationInterval:contextAggregationInterval,contextChartData:contextChartData,contextForecastData:contextForecastData,dataNotChartable:dataNotChartable,focusAggregationInterval:focusAggregationInterval,focusAnnotationError:focusAnnotationError,focusAnnotationData:focusAnnotationData,focusAggregations:focusAggregations,focusChartData:focusChartData,focusForecastData:focusForecastData,fullRefresh:fullRefresh,hasResults:hasResults,loading:loading,modelPlotEnabled:modelPlotEnabled,showAnnotations:showAnnotations,showAnnotationsCheckbox:showAnnotationsCheckbox,showForecast:showForecast,showForecastCheckbox:showForecastCheckbox,showModelBounds:showModelBounds,showModelBoundsCheckbox:showModelBoundsCheckbox,svgWidth:svgWidth,swimlaneData:swimlaneData,tableData:tableData,zoomFrom:zoomFrom,zoomTo:zoomTo,zoomFromFocusLoaded:zoomFromFocusLoaded,zoomToFocusLoaded:zoomToFocusLoaded,chartDataError:chartDataError}=this.state,chartProps={modelPlotEnabled:modelPlotEnabled,contextChartData:contextChartData,contextChartSelected:this.contextChartSelected,contextForecastData:contextForecastData,contextAggregationInterval:contextAggregationInterval,swimlaneData:swimlaneData,focusAnnotationData:focusAnnotationData,focusChartData:focusChartData,focusForecastData:focusForecastData,focusAggregationInterval:focusAggregationInterval,svgWidth:svgWidth,zoomFrom:zoomFrom,zoomTo:zoomTo,zoomFromFocusLoaded:zoomFromFocusLoaded,zoomToFocusLoaded:zoomToFocusLoaded,autoZoomDuration:autoZoomDuration},jobs=createTimeSeriesJobData(job_service.a.jobs);if(void 0===selectedDetectorIndex||void 0===job_service.a.getJob(selectedJobId))return external_kbnSharedDeps_React_default.a.createElement(TimeSeriesExplorerPage,{dateFormatTz:dateFormatTz,resizeRef:this.resizeRef});const selectedJob=job_service.a.getJob(selectedJobId),entityControls=this.getControlsForDetector(),fieldNamesWithEmptyValues=this.getFieldNamesWithEmptyValues(),arePartitioningFieldsProvided=this.arePartitioningFieldsProvided(),detectors=getViewableDetectors(selectedJob);let renderFocusChartOnly=!0;return Object(external_kbnSharedDeps_Lodash_.isEqual)(this.previousChartProps.focusForecastData,chartProps.focusForecastData)&&Object(external_kbnSharedDeps_Lodash_.isEqual)(this.previousChartProps.focusChartData,chartProps.focusChartData)&&Object(external_kbnSharedDeps_Lodash_.isEqual)(this.previousChartProps.focusAnnotationData,chartProps.focusAnnotationData)&&this.previousShowForecast===showForecast&&this.previousShowModelBounds===showModelBounds&&this.props.previousRefresh===lastRefresh&&(renderFocusChartOnly=!1),this.previousChartProps=chartProps,this.previousShowForecast=showForecast,this.previousShowModelBounds=showModelBounds,external_kbnSharedDeps_React_default.a.createElement(TimeSeriesExplorerPage,{dateFormatTz:dateFormatTz,resizeRef:this.resizeRef},fieldNamesWithEmptyValues.length>0&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.singleMetricRequiredMessage",defaultMessage:"To view a single metric, select {missingValuesCount, plural, one {a value for {fieldName1}} other {values for {fieldName1} and {fieldName2}}}.",values:{missingValuesCount:fieldNamesWithEmptyValues.length,fieldName1:fieldNamesWithEmptyValues[0],fieldName2:fieldNamesWithEmptyValues[1]}}),iconType:"help",size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"})),external_kbnSharedDeps_React_default.a.createElement(SeriesControls,{selectedJobId:selectedJobId,appStateHandler:this.props.appStateHandler,selectedDetectorIndex:selectedDetectorIndex,selectedEntities:this.props.selectedEntities,bounds:bounds,functionDescription:this.props.functionDescription,setFunctionDescription:this.setFunctionDescription},arePartitioningFieldsProvided&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{style:{textAlign:"right"}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{hasEmptyLabelSpace:!0,style:{maxWidth:"100%"}},external_kbnSharedDeps_React_default.a.createElement(ForecastingModal,{job:selectedJob,detectorIndex:selectedDetectorIndex,entities:entityControls,setForecastId:this.setForecastId,className:"forecast-controls"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),fullRefresh&&!0===loading&&external_kbnSharedDeps_React_default.a.createElement(loading_indicator.a,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.loadingLabel",{defaultMessage:"Loading"})}),!1===loading&&void 0!==chartDataError&&external_kbnSharedDeps_React_default.a.createElement(TimeseriesexplorerChartDataError,{errorMsg:chartDataError}),arePartitioningFieldsProvided&&jobs.length>0&&(!1===fullRefresh||!1===loading)&&!1===hasResults&&void 0===chartDataError&&external_kbnSharedDeps_React_default.a.createElement(TimeseriesexplorerNoChartData,{dataNotChartable:dataNotChartable,entities:entityControls}),arePartitioningFieldsProvided&&jobs.length>0&&(!1===fullRefresh||!1===loading)&&!0===hasResults&&external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement("div",{className:"results-container"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{className:"panel-title"},external_kbnSharedDeps_React_default.a.createElement("h2",{style:{display:"inline"}},external_kbnSharedDeps_React_default.a.createElement("span",null,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.singleTimeSeriesAnalysisTitle",{defaultMessage:"Single time series analysis of {functionLabel}",values:{functionLabel:chartDetails.functionLabel}}))," ",1===chartDetails.entityData.count&&external_kbnSharedDeps_React_default.a.createElement("span",{className:"entity-count-text"},chartDetails.entityData.entities.length>0&&"(",chartDetails.entityData.entities.map(entity=>`${entity.fieldName}: ${entity.fieldValue}`).join(", "),chartDetails.entityData.entities.length>0&&")"),1!==chartDetails.entityData.count&&external_kbnSharedDeps_React_default.a.createElement("span",{className:"entity-count-text"},chartDetails.entityData.entities.map((countData,i)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,{key:countData.fieldName},external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.countDataInChartDetailsDescription",{defaultMessage:"{openBrace}{cardinalityValue} distinct {fieldName} {cardinality, plural, one {} other { values}}{closeBrace}",values:{openBrace:0===i?"(":"",closeBrace:i===chartDetails.entityData.entities.length-1?")":"",cardinalityValue:0===countData.cardinality?allValuesLabel:countData.cardinality,cardinality:countData.cardinality,fieldName:countData.fieldName}}),i!==chartDetails.entityData.entities.length-1?", ":""))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{style:{float:"right"}},showModelBoundsCheckbox&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCheckbox,{id:"toggleModelBoundsCheckbox",label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.showModelBoundsLabel",{defaultMessage:"show model bounds"}),checked:showModelBounds,onChange:this.toggleShowModelBoundsHandler})),showAnnotationsCheckbox&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCheckbox,{id:"toggleAnnotationsCheckbox",label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.annotationsLabel",{defaultMessage:"annotations"}),checked:showAnnotations,onChange:this.toggleShowAnnotationsHandler})),showForecastCheckbox&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCheckbox,{id:"toggleShowForecastCheckbox",label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.showForecastLabel",{defaultMessage:"show forecast"}),checked:showForecast,onChange:this.toggleShowForecastHandler}))),external_kbnSharedDeps_React_default.a.createElement(TimeSeriesChartWithTooltips,{chartProps:chartProps,contextAggregationInterval:contextAggregationInterval,bounds:bounds,detectorIndex:selectedDetectorIndex,renderFocusChartOnly:renderFocusChartOnly,selectedJob:selectedJob,selectedEntities:this.props.selectedEntities,showAnnotations:showAnnotations,showForecast:showForecast,showModelBounds:showModelBounds,lastRefresh:lastRefresh}),void 0!==focusAnnotationError&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{className:"panel-title","data-test-subj":"mlAnomalyExplorerAnnotations error"},external_kbnSharedDeps_React_default.a.createElement("h2",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.annotationsErrorTitle",defaultMessage:"Annotations"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPanel,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.annotationsErrorCallOutTitle",{defaultMessage:"An error occurred loading annotations:"}),color:"danger",iconType:"alert"},external_kbnSharedDeps_React_default.a.createElement("p",null,focusAnnotationError))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"})),focusAnnotationData&&focusAnnotationData.length>0&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiAccordion,{id:"EuiAccordion-blah",buttonContent:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{className:"panel-title"},external_kbnSharedDeps_React_default.a.createElement("h2",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.annotationsTitle",defaultMessage:"Annotations {badge}",values:{badge:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBadge,{color:"hollow"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.explorer.annotationsTitleTotalCount",defaultMessage:"Total: {count}",values:{count:focusAnnotationData.length}}))}}))),"data-test-subj":"mlAnomalyExplorerAnnotations loaded"},external_kbnSharedDeps_React_default.a.createElement(annotations_table.a,{chartDetails:chartDetails,detectorIndex:selectedDetectorIndex,detectors:detectors,jobIds:[this.props.selectedJobId],annotations:focusAnnotationData,aggregations:focusAggregations,isSingleMetricViewerLinkVisible:!1,isNumberBadgeVisible:!0}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"})),external_kbnSharedDeps_React_default.a.createElement(annotation_flyout.a,{chartDetails:chartDetails,detectorIndex:selectedDetectorIndex,detectors:detectors}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{className:"panel-title"},external_kbnSharedDeps_React_default.a.createElement("h2",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.anomaliesTitle",defaultMessage:"Anomalies"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"row",gutterSize:"l",responsive:!0,className:"ml-anomalies-controls"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,style:{width:"170px"}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.severityThresholdLabel",{defaultMessage:"Severity threshold"})},external_kbnSharedDeps_React_default.a.createElement(select_severity.b,null))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,style:{width:"170px"}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{content:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.intervalTooltip",{defaultMessage:"Show only the highest severity anomaly for each interval (such as hour or day) or show all anomalies in the selected time period."})},external_kbnSharedDeps_React_default.a.createElement("span",null,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.intervalLabel",{defaultMessage:"Interval"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{type:"questionInCircle",color:"subdued"})))},external_kbnSharedDeps_React_default.a.createElement(SelectInterval,null)))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}))),arePartitioningFieldsProvided&&jobs.length>0&&!0===hasResults&&external_kbnSharedDeps_React_default.a.createElement(AnomaliesTable,{bounds:bounds,tableData:tableData,filter:this.tableFilter}))}}const TimeseriesexplorerNoJobsFound=()=>{const mlUrlGenerator=Object(contexts_kibana.d)(),navigateToPath=Object(contexts_kibana.e)();return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiEmptyPrompt,{"data-test-subj":"mlNoSingleMetricJobsFound",iconType:"alert",title:external_kbnSharedDeps_React_default.a.createElement("h2",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.noSingleMetricJobsFoundLabel",defaultMessage:"No single metric jobs found"})),actions:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{color:"primary",fill:!0,onClick:async()=>{const path=await mlUrlGenerator.createUrl({page:ml_url_generator.b.ANOMALY_DETECTION_JOBS_MANAGE});await navigateToPath(path,!0)}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.createNewSingleMetricJobLinkText",defaultMessage:"Create new single metric job"}))})},useRefresh=()=>{const timefilter=Object(contexts_kibana.g)(),refresh$=Object(external_kbnSharedDeps_React_.useMemo)(()=>Object(external_kbnSharedDeps_Rxjs_.merge)(timefilter_refresh_service.a,timefilter.getTimeUpdate$().pipe(Object(external_kbnSharedDeps_RxjsOperators_.map)(()=>{const{from:from,to:to}=timefilter.getTime();return{lastRefresh:Date.now(),timeRange:{start:from,end:to}}})),annotations_service.b.pipe(Object(external_kbnSharedDeps_RxjsOperators_.map)(d=>({lastRefresh:d})))),[]);return useObservable_default()(refresh$)};function timeseriesexplorer_extends(){return(timeseriesexplorer_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const timeSeriesExplorerRouteFactory=(navigateToPath,basePath)=>({path:"/timeseriesexplorer",render:(props,deps)=>external_kbnSharedDeps_React_default.a.createElement(timeseriesexplorer_PageWrapper,timeseriesexplorer_extends({},props,{deps:deps})),breadcrumbs:[getBreadcrumbWithUrlForApp("ML_BREADCRUMB",navigateToPath,basePath),getBreadcrumbWithUrlForApp("ANOMALY_DETECTION_BREADCRUMB",navigateToPath,basePath),{text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.anomalyDetection.singleMetricViewerLabel",{defaultMessage:"Single Metric Viewer"}),href:""}]}),timeseriesexplorer_PageWrapper=({deps:deps})=>{const{context:context,results:results}=useResolver(void 0,void 0,deps.config,{...basicResolvers(deps),jobs:job_service.a.loadJobsWrapper,jobsWithTimeRange:()=>ml_api_service.ml.jobs.jobsWithTimerange(Object(explorer_utils.e)())}),annotationUpdatesService=Object(external_kbnSharedDeps_React_.useMemo)(()=>new annotations_service.a,[]);return external_kbnSharedDeps_React_default.a.createElement(PageLoader,{context:context},external_kbnSharedDeps_React_default.a.createElement(ml_annotation_updates_context.a.Provider,{value:annotationUpdatesService},external_kbnSharedDeps_React_default.a.createElement(TimeSeriesExplorerUrlStateManager,{config:deps.config,jobsWithTimeRange:results.jobsWithTimeRange.jobs})))},TimeSeriesExplorerUrlStateManager=({config:config,jobsWithTimeRange:jobsWithTimeRange})=>{var _globalState$time,_globalState$time2,_globalState$ml,_timeSeriesExplorerUr,_timeSeriesExplorerUr2,_timeSeriesExplorerUr3,_timeSeriesExplorerUr4,_timeSeriesExplorerUr5,_timeSeriesExplorerUr6,_bounds$min,_bounds$max,_timeSeriesExplorerUr8;const{toasts:toasts}=Object(contexts_kibana.f)(),toastNotificationService=Object(toast_notification_service.c)(),[timeSeriesExplorerUrlState,setTimeSeriesExplorerUrlState]=Object(url_state.b)(ml_url_generator.b.SINGLE_METRIC_VIEWER),[globalState,setGlobalState]=Object(url_state.c)("_g"),[lastRefresh,setLastRefresh]=Object(external_kbnSharedDeps_React_.useState)(0),previousRefresh=usePrevious_default()(lastRefresh),[selectedJobId,setSelectedJobId]=Object(external_kbnSharedDeps_React_.useState)(),timefilter=Object(contexts_kibana.g)({timeRangeSelector:!0,autoRefreshSelector:!0}),[invalidTimeRangeError,setInValidTimeRangeError]=Object(external_kbnSharedDeps_React_.useState)(!1),refresh=useRefresh();Object(external_kbnSharedDeps_React_.useEffect)(()=>{if(void 0!==refresh&&refresh.lastRefresh!==lastRefresh&&(setLastRefresh(null==refresh?void 0:refresh.lastRefresh),void 0!==refresh.timeRange)){const{start:start,end:end}=refresh.timeRange;setGlobalState("time",{from:start,to:end})}},[null==refresh?void 0:refresh.lastRefresh,lastRefresh,setGlobalState]);const[bounds,setBounds]=Object(external_kbnSharedDeps_React_.useState)(void 0);Object(external_kbnSharedDeps_React_.useEffect)(()=>{if(void 0!==(null==globalState?void 0:globalState.time)){"invalid"===globalState.time.mode&&setInValidTimeRangeError(!0),timefilter.setTime({from:globalState.time.from,to:globalState.time.to});const timefilterBounds=timefilter.getBounds();void 0!==(null==timefilterBounds?void 0:timefilterBounds.min)&&void 0!==(null==timefilterBounds?void 0:timefilterBounds.max)&&setBounds(timefilter.getBounds())}},[null==globalState||null===(_globalState$time=globalState.time)||void 0===_globalState$time?void 0:_globalState$time.from,null==globalState||null===(_globalState$time2=globalState.time)||void 0===_globalState$time2?void 0:_globalState$time2.to]);const selectedJobIds=null==globalState||null===(_globalState$ml=globalState.ml)||void 0===_globalState$ml?void 0:_globalState$ml.jobIds;Array.isArray(selectedJobIds)&&selectedJobIds.sort();const previousSelectedJobIds=usePrevious_default()(selectedJobIds),isJobChange=!Object(external_kbnSharedDeps_Lodash_.isEqual)(previousSelectedJobIds,selectedJobIds),selectedDetectorIndex=isJobChange?0:null!==(_timeSeriesExplorerUr=null==timeSeriesExplorerUrlState||null===(_timeSeriesExplorerUr2=timeSeriesExplorerUrlState.mlTimeSeriesExplorer)||void 0===_timeSeriesExplorerUr2?void 0:_timeSeriesExplorerUr2.detectorIndex)&&void 0!==_timeSeriesExplorerUr?_timeSeriesExplorerUr:0,selectedEntities=isJobChange||null==timeSeriesExplorerUrlState||null===(_timeSeriesExplorerUr3=timeSeriesExplorerUrlState.mlTimeSeriesExplorer)||void 0===_timeSeriesExplorerUr3?void 0:_timeSeriesExplorerUr3.entities,selectedForecastId=isJobChange||null==timeSeriesExplorerUrlState||null===(_timeSeriesExplorerUr4=timeSeriesExplorerUrlState.mlTimeSeriesExplorer)||void 0===_timeSeriesExplorerUr4?void 0:_timeSeriesExplorerUr4.forecastId,selectedFunctionDescription=isJobChange||null==timeSeriesExplorerUrlState||null===(_timeSeriesExplorerUr5=timeSeriesExplorerUrlState.mlTimeSeriesExplorer)||void 0===_timeSeriesExplorerUr5?void 0:_timeSeriesExplorerUr5.functionDescription,zoom=isJobChange||null==timeSeriesExplorerUrlState||null===(_timeSeriesExplorerUr6=timeSeriesExplorerUrlState.mlTimeSeriesExplorer)||void 0===_timeSeriesExplorerUr6?void 0:_timeSeriesExplorerUr6.zoom,selectedJob=void 0!==selectedJobId?job_service.a.getJob(selectedJobId):void 0,timeSeriesJobs=createTimeSeriesJobData(job_service.a.jobs);let autoZoomDuration;void 0!==selectedJobId&&void 0!==selectedJob&&(autoZoomDuration=function(jobs,selectedJob){const bucketSpanSeconds=Object(external_kbnSharedDeps_Lodash_.find)(jobs,{id:selectedJob.job_id}).bucketSpanSeconds;let autoZoomDuration=1e3*bucketSpanSeconds*499;const maxBars=Math.floor(550),buckets=Object(time_buckets.c)();buckets.setInterval("auto"),buckets.setBarTarget(Math.floor(500)),buckets.setMaxBars(maxBars);const nowMs=(new Date).getTime(),max=external_kbnSharedDeps_MomentTimezone_default()(nowMs),min=external_kbnSharedDeps_MomentTimezone_default()(nowMs-autoZoomDuration);buckets.setBounds({min:min,max:max});const calculatedIntervalSecs=buckets.getIntervalToNearestMultiple(bucketSpanSeconds).asSeconds();return calculatedIntervalSecs!==bucketSpanSeconds&&(autoZoomDuration*=bucketSpanSeconds/calculatedIntervalSecs),autoZoomDuration}(timeSeriesJobs,selectedJob));const appStateHandler=Object(external_kbnSharedDeps_React_.useCallback)((action,payload)=>{var _timeSeriesExplorerUr7;const isInitUpdate=void 0===(null==timeSeriesExplorerUrlState||null===(_timeSeriesExplorerUr7=timeSeriesExplorerUrlState.mlTimeSeriesExplorer)||void 0===_timeSeriesExplorerUr7?void 0:_timeSeriesExplorerUr7.zoom),mlTimeSeriesExplorer=void 0!==(null==timeSeriesExplorerUrlState?void 0:timeSeriesExplorerUrlState.mlTimeSeriesExplorer)?{...timeSeriesExplorerUrlState.mlTimeSeriesExplorer}:{};switch(action){case APP_STATE_ACTION_CLEAR:delete mlTimeSeriesExplorer.detectorIndex,delete mlTimeSeriesExplorer.entities,delete mlTimeSeriesExplorer.forecastId,delete mlTimeSeriesExplorer.zoom,delete mlTimeSeriesExplorer.functionDescription;break;case APP_STATE_ACTION_SET_DETECTOR_INDEX:mlTimeSeriesExplorer.detectorIndex=payload,delete mlTimeSeriesExplorer.functionDescription;break;case APP_STATE_ACTION_SET_ENTITIES:mlTimeSeriesExplorer.entities=payload,delete mlTimeSeriesExplorer.functionDescription;break;case APP_STATE_ACTION_SET_FORECAST_ID:mlTimeSeriesExplorer.forecastId=payload,delete mlTimeSeriesExplorer.zoom;break;case APP_STATE_ACTION_SET_ZOOM:mlTimeSeriesExplorer.zoom=payload;break;case APP_STATE_ACTION_UNSET_ZOOM:delete mlTimeSeriesExplorer.zoom;break;case APP_STATE_ACTION_SET_FUNCTION_DESCRIPTION:mlTimeSeriesExplorer.functionDescription=payload}setTimeSeriesExplorerUrlState({mlTimeSeriesExplorer:mlTimeSeriesExplorer},isInitUpdate)},[JSON.stringify(null==timeSeriesExplorerUrlState?void 0:timeSeriesExplorerUrlState.mlTimeSeriesExplorer),setTimeSeriesExplorerUrlState]);Object(external_kbnSharedDeps_React_.useEffect)(()=>{void 0!==selectedJobIds&&void 0!==previousSelectedJobIds&&(setLastRefresh(Date.now()),appStateHandler(APP_STATE_ACTION_CLEAR));const validatedJobId=function(jobsWithTimeRange,selectedJobIds,setGlobalState,toastNotifications){const jobs=createTimeSeriesJobData(job_service.a.jobs),timeSeriesJobIds=jobs.map(j=>j.id),invalidIds=Object(external_kbnSharedDeps_Lodash_.difference)(selectedJobIds,timeSeriesJobIds),validSelectedJobIds=Object(external_kbnSharedDeps_Lodash_.without)(selectedJobIds,...invalidIds);if(1===invalidIds.length){const selectedJobId=invalidIds[0],selectedJob=jobsWithTimeRange.find(j=>j.id===selectedJobId);if(void 0!==selectedJob&&void 0!==selectedJob.isNotSingleMetricViewerJobMessage){const warningText=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.canNotViewRequestedJobsWarningWithReasonMessage",{defaultMessage:"You can't view {selectedJobId} in this dashboard because {reason}.",values:{selectedJobId:selectedJobId,reason:selectedJob.isNotSingleMetricViewerJobMessage}});toastNotifications.addWarning({title:warningText,"data-test-subj":"mlTimeSeriesExplorerDisabledJobReasonWarningToast"})}}if(invalidIds.length>1){let warningText=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.canNotViewRequestedJobsWarningMessage",{defaultMessage:"You can't view requested {invalidIdsCount, plural, one {job} other {jobs}} {invalidIds} in this dashboard",values:{invalidIdsCount:invalidIds.length,invalidIds:invalidIds.join(", ")}});0===validSelectedJobIds.length&&timeSeriesJobIds.length>0&&(warningText+=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.autoSelectingFirstJobText",{defaultMessage:", auto selecting first job"})),toastNotifications.addWarning(warningText)}if(validSelectedJobIds.length>1)return toastNotifications.addWarning(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.youCanViewOneJobAtTimeWarningMessage",{defaultMessage:"You can only view one job at a time in this dashboard"})),setGlobalState("ml",{jobIds:[validSelectedJobIds[0]]}),!0;if(invalidIds.length>0&&validSelectedJobIds.length>0)return setGlobalState("ml",{jobIds:[validSelectedJobIds[0]]}),!0;if(1===validSelectedJobIds.length)return validSelectedJobIds[0];if(0===validSelectedJobIds.length&&jobs.length>0){const jobIds=[jobs[0].id],time=Object(job_select_service_utils.b)(jobsWithTimeRange,jobIds);return setGlobalState({ml:{jobIds:jobIds},...void 0!==time?{time:time}:{}}),!0}return!1}(jobsWithTimeRange,selectedJobIds,setGlobalState,toasts);"string"==typeof validatedJobId&&setSelectedJobId(validatedJobId)},[JSON.stringify(selectedJobIds)]);const boundsMinMs=null==bounds||null===(_bounds$min=bounds.min)||void 0===_bounds$min?void 0:_bounds$min.valueOf(),boundsMaxMs=null==bounds||null===(_bounds$max=bounds.max)||void 0===_bounds$max?void 0:_bounds$max.valueOf(),[selectedForecastIdProp,setSelectedForecastIdProp]=Object(external_kbnSharedDeps_React_.useState)(null==timeSeriesExplorerUrlState||null===(_timeSeriesExplorerUr8=timeSeriesExplorerUrlState.mlTimeSeriesExplorer)||void 0===_timeSeriesExplorerUr8?void 0:_timeSeriesExplorerUr8.forecastId);Object(external_kbnSharedDeps_React_.useEffect)(()=>{void 0!==autoZoomDuration&&void 0!==boundsMinMs&&void 0!==boundsMaxMs&&void 0!==selectedJob&&void 0!==selectedForecastId&&(selectedForecastIdProp!==selectedForecastId&&setSelectedForecastIdProp(void 0),forecast_service.a.getForecastDateRange(selectedJob,selectedForecastId).then(resp=>{if(void 0===autoZoomDuration)return;const earliest=external_kbnSharedDeps_Moment_default()(resp.earliest||boundsMinMs),latest=external_kbnSharedDeps_Moment_default()(resp.latest||boundsMaxMs);if(earliest.isBefore(external_kbnSharedDeps_Moment_default()(boundsMinMs))||latest.isAfter(external_kbnSharedDeps_Moment_default()(boundsMaxMs))){const earliestMs=Math.min(earliest.valueOf(),boundsMinMs),latestMs=Math.max(latest.valueOf(),boundsMaxMs);setGlobalState("time",{from:external_kbnSharedDeps_Moment_default()(earliestMs).toISOString(),to:external_kbnSharedDeps_Moment_default()(latestMs).toISOString()})}setSelectedForecastIdProp(selectedForecastId)}).catch(resp=>{console.error("Time series explorer - error loading time range of forecast from elasticsearch:",resp)}))},[selectedForecastId]);const[tableInterval]=useTableInterval(),[tableSeverity]=Object(select_severity.e)(),tzConfig=config.get("dateFormat:tz"),dateFormatTz="Browser"!==tzConfig?tzConfig:external_kbnSharedDeps_Moment_default.a.tz.guess();if(0===timeSeriesJobs.length)return external_kbnSharedDeps_React_default.a.createElement(TimeSeriesExplorerPage,{dateFormatTz:dateFormatTz},external_kbnSharedDeps_React_default.a.createElement(TimeseriesexplorerNoJobsFound,null));if(void 0===selectedJobId||void 0===autoZoomDuration||void 0===bounds)return null;const zoomProp="string"==typeof selectedForecastId&&void 0===selectedForecastIdProp?void 0:zoom;return external_kbnSharedDeps_React_default.a.createElement(timeseriesexplorer_TimeSeriesExplorer,{toastNotificationService:toastNotificationService,appStateHandler:appStateHandler,autoZoomDuration:autoZoomDuration,bounds:bounds,dateFormatTz:dateFormatTz,lastRefresh:lastRefresh,previousRefresh:previousRefresh,selectedJobId:selectedJobId,selectedDetectorIndex:selectedDetectorIndex,selectedEntities:selectedEntities,selectedForecastId:selectedForecastIdProp,tableInterval:tableInterval.val,tableSeverity:tableSeverity.val,timefilter:timefilter,zoom:zoomProp,invalidTimeRangeError:invalidTimeRangeError,functionDescription:selectedFunctionDescription})},ExplorerNoInfluencersFound=({viewBySwimlaneFieldName:viewBySwimlaneFieldName,showFilterMessage:showFilterMessage=!1})=>!1===showFilterMessage?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.explorer.noInfluencersFoundTitle",defaultMessage:"No {viewBySwimlaneFieldName} influencers found",values:{viewBySwimlaneFieldName:viewBySwimlaneFieldName}}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.explorer.noInfluencersFoundTitleFilterMessage",defaultMessage:"No {viewBySwimlaneFieldName} influencers found for specified filter",values:{viewBySwimlaneFieldName:viewBySwimlaneFieldName}}),ExplorerNoJobsFound=()=>{const ADJobsManagementUrl=Object(use_create_url.b)({page:ml_url_generator.b.ANOMALY_DETECTION_JOBS_MANAGE,excludeBasePath:!0});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiEmptyPrompt,{iconType:"alert",title:external_kbnSharedDeps_React_default.a.createElement("h2",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.explorer.noJobsFoundLabel",defaultMessage:"No jobs found"})),actions:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Link,{to:ADJobsManagementUrl},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{color:"primary",fill:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.explorer.createNewJobLinkText",defaultMessage:"Create job"}))),"data-test-subj":"mlNoJobsFound"})},ExplorerNoResultsFound=({hasResults:hasResults,selectedJobsRunning:selectedJobsRunning})=>{const resultsHaveNoAnomalies=!0===hasResults,noResults=!1===hasResults;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiEmptyPrompt,{iconType:"iInCircle",title:external_kbnSharedDeps_React_default.a.createElement("h2",null,resultsHaveNoAnomalies&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.explorer.noAnomaliesFoundLabel",defaultMessage:"No anomalies found"}),noResults&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.explorer.noResultsFoundLabel",defaultMessage:"No results found"})),body:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,selectedJobsRunning&&noResults&&external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.explorer.selectedJobsRunningLabel",defaultMessage:"One or more selected jobs are still running and results may not be available yet."})),!selectedJobsRunning&&external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.explorer.tryWideningTimeSelectionLabel",defaultMessage:"Try widening the time selection or moving further back in time"})))})};const Influencer=({influencerFieldName:influencerFieldName,influencerFilter:influencerFilter,valueData:valueData})=>{const maxScore=Math.floor(valueData.maxAnomalyScore),maxScoreLabel=Object(anomaly_utils.g)(valueData.maxAnomalyScore),severity=Object(anomaly_utils.i)(maxScore),totalScore=Math.floor(valueData.sumAnomalyScore),totalScoreLabel=Object(anomaly_utils.g)(valueData.sumAnomalyScore),barStyle={width:(0!==maxScore?maxScore:1)+"%"},tooltipContent=function(maxScoreLabel,totalScoreLabel){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.influencersList.maxAnomalyScoreTooltipDescription",defaultMessage:"Maximum anomaly score: {maxScoreLabel}",values:{maxScoreLabel:maxScoreLabel}})),external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.influencersList.totalAnomalyScoreTooltipDescription",defaultMessage:"Total anomaly score: {totalScoreLabel}",values:{totalScoreLabel:totalScoreLabel}})))}(maxScoreLabel,totalScoreLabel);return external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":"mlInfluencerEntry field-"+influencerFieldName},external_kbnSharedDeps_React_default.a.createElement("div",{className:"field-label","data-test-subj":"mlInfluencerEntryFieldLabel"},external_kbnSharedDeps_React_default.a.createElement(EntityCell,{entityName:influencerFieldName,entityValue:valueData.influencerFieldValue,filter:influencerFilter})),external_kbnSharedDeps_React_default.a.createElement("div",{className:"progress "+severity.id},external_kbnSharedDeps_React_default.a.createElement("div",{className:"progress-bar-holder"},external_kbnSharedDeps_React_default.a.createElement("div",{className:"progress-bar",style:barStyle})),external_kbnSharedDeps_React_default.a.createElement("div",{className:"score-label"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{position:"right",className:"ml-influencers-list-tooltip",title:`${influencerFieldName}: ${valueData.influencerFieldValue}`,content:tooltipContent},external_kbnSharedDeps_React_default.a.createElement("span",null,maxScoreLabel)))),external_kbnSharedDeps_React_default.a.createElement("div",{className:"total-score-label"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{position:"right",className:"ml-influencers-list-tooltip",title:`${influencerFieldName}: ${valueData.influencerFieldValue}`,content:tooltipContent},external_kbnSharedDeps_React_default.a.createElement("span",null,totalScore>0?function(value,maxDigits=3){return Math.abs(value)<Math.pow(10,maxDigits)?value:external_kbnSharedDeps_ElasticNumeral_default()(value).format("0a")}(totalScore,4):totalScoreLabel))))},InfluencersByName=({influencerFieldName:influencerFieldName,influencerFilter:influencerFilter,fieldValues:fieldValues})=>{const influencerValues=fieldValues.map(valueData=>external_kbnSharedDeps_React_default.a.createElement(Influencer,{key:valueData.influencerFieldValue,influencerFieldName:influencerFieldName,influencerFilter:influencerFilter,valueData:valueData}));return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,{key:influencerFieldName},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"xs","data-test-subj":"mlInfluencerFieldName "+influencerFieldName},external_kbnSharedDeps_React_default.a.createElement("h3",null,influencerFieldName)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"xs"}),influencerValues)},InfluencersList=({influencers:influencers,influencerFilter:influencerFilter})=>{if(void 0===influencers||0===Object.keys(influencers).length)return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceAround",className:"ml-influencers-list"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"xxl"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"xs",className:"influencer-title"},external_kbnSharedDeps_React_default.a.createElement("h3",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.influencersList.noInfluencersFoundTitle",defaultMessage:"No influencers found"})))));const influencersByName=Object.keys(influencers).map(influencerFieldName=>external_kbnSharedDeps_React_default.a.createElement(InfluencersByName,{key:influencerFieldName,influencerFieldName:influencerFieldName,influencerFilter:influencerFilter,fieldValues:influencers[influencerFieldName]}));return external_kbnSharedDeps_React_default.a.createElement("div",{className:"ml-influencers-list"},influencersByName)};var explorer_constants=__webpack_require__(75);var anomaly_timeline_service=__webpack_require__(397),swimlane_container=__webpack_require__(161),anomaly_explorer_charts_service=__webpack_require__(222);const memoizeIsEqual=(newArgs,lastArgs)=>Object(external_kbnSharedDeps_Lodash_.isEqual)(newArgs,lastArgs),memoize=(func,context)=>memoize_one_cjs_default()(((func,context=null)=>function(lastRefresh,...args){return func.apply(context,args)})(func,context),memoizeIsEqual),memoizedLoadOverallAnnotations=memoize(explorer_utils.q),memoizedLoadAnnotationsTableData=memoize(explorer_utils.n),memoizedLoadFilteredTopInfluencers=memoize(explorer_utils.p),memoizedLoadTopInfluencers=memoize(explorer_utils.r),memoizedLoadAnomaliesTableData=memoize(explorer_utils.o),useExplorerData=()=>{const timefilter=Object(contexts_kibana.g)(),{services:{mlServices:{mlApiServices:mlApiServices},uiSettings:uiSettings}}=Object(contexts_kibana.b)(),loadExplorerData=Object(external_kbnSharedDeps_React_.useMemo)(()=>{const mlResultsService=Object(results_service.mlResultsServiceProvider)(mlApiServices);return((mlResultsService,anomalyTimelineService,anomalyExplorerChartsService,timefilter)=>{const memoizedLoadOverallData=memoize(anomalyTimelineService.loadOverallData,anomalyTimelineService),memoizedLoadViewBySwimlane=memoize(anomalyTimelineService.loadViewBySwimlane,anomalyTimelineService),memoizedAnomalyDataChange=memoize(anomalyExplorerChartsService.getAnomalyData,anomalyExplorerChartsService);return config=>{if(void 0===(arg=config)||void 0===arg.selectedJobs||null===arg.selectedJobs||void 0===arg.viewBySwimlaneFieldName)return Object(external_kbnSharedDeps_Rxjs_.of)({});var arg;const{lastRefresh:lastRefresh,influencersFilterQuery:influencersFilterQuery,noInfluencersConfigured:noInfluencersConfigured,selectedCells:selectedCells,selectedJobs:selectedJobs,swimlaneBucketInterval:swimlaneBucketInterval,swimlaneLimit:swimlaneLimit,tableInterval:tableInterval,tableSeverity:tableSeverity,viewBySwimlaneFieldName:viewBySwimlaneFieldName,swimlaneContainerWidth:swimlaneContainerWidth,viewByFromPage:viewByFromPage,viewByPerPage:viewByPerPage}=config,combinedJobRecords=selectedJobs.reduce((acc,job)=>({...acc,[job.id]:job_service.a.getJob(job.id)}),{}),selectionInfluencers=Object(explorer_utils.i)(selectedCells,viewBySwimlaneFieldName),jobIds=Object(explorer_utils.j)(selectedCells,selectedJobs),bounds=timefilter.getBounds(),timerange=Object(explorer_utils.k)(selectedCells,swimlaneBucketInterval.asSeconds(),bounds),dateFormatTz=Object(explorer_utils.e)(),interval=swimlaneBucketInterval.asSeconds();return Object(external_kbnSharedDeps_Rxjs_.forkJoin)({overallAnnotations:memoizedLoadOverallAnnotations(lastRefresh,selectedJobs,interval,bounds),annotationsData:memoizedLoadAnnotationsTableData(lastRefresh,selectedCells,selectedJobs,swimlaneBucketInterval.asSeconds(),bounds),anomalyChartRecords:anomalyExplorerChartsService.loadDataForCharts$(jobIds,timerange.earliestMs,timerange.latestMs,selectionInfluencers,selectedCells,influencersFilterQuery),influencers:0===selectionInfluencers.length?memoizedLoadTopInfluencers(lastRefresh,mlResultsService,jobIds,timerange.earliestMs,timerange.latestMs,[],noInfluencersConfigured,influencersFilterQuery):Promise.resolve({}),overallState:memoizedLoadOverallData(lastRefresh,selectedJobs,swimlaneContainerWidth),tableData:memoizedLoadAnomaliesTableData(lastRefresh,selectedCells,selectedJobs,dateFormatTz,swimlaneBucketInterval.asSeconds(),bounds,viewBySwimlaneFieldName,tableInterval,tableSeverity,influencersFilterQuery),topFieldValues:void 0!==selectedCells&&!0===selectedCells.showTopFieldValues?anomalyTimelineService.loadViewByTopFieldValuesForSelectedTime(timerange.earliestMs,timerange.latestMs,selectedJobs,viewBySwimlaneFieldName,swimlaneLimit,viewByPerPage,viewByFromPage,swimlaneContainerWidth):Promise.resolve([])}).pipe(Object(external_kbnSharedDeps_RxjsOperators_.tap)(explorerService.setViewBySwimlaneLoading),Object(external_kbnSharedDeps_RxjsOperators_.tap)(({anomalyChartRecords:anomalyChartRecords,topFieldValues:topFieldValues})=>{memoizedAnomalyDataChange(lastRefresh,explorerService,combinedJobRecords,swimlaneContainerWidth,void 0!==selectedCells&&Array.isArray(anomalyChartRecords)?anomalyChartRecords:[],timerange.earliestMs,timerange.latestMs,timefilter,tableSeverity)}),Object(external_kbnSharedDeps_RxjsOperators_.mergeMap)(({overallAnnotations:overallAnnotations,anomalyChartRecords:anomalyChartRecords,influencers:influencers,overallState:overallState,topFieldValues:topFieldValues,annotationsData:annotationsData,tableData:tableData})=>Object(external_kbnSharedDeps_Rxjs_.forkJoin)({filteredTopInfluencers:(selectionInfluencers.length>0||void 0!==influencersFilterQuery)&&void 0!==anomalyChartRecords&&anomalyChartRecords.length>0?memoizedLoadFilteredTopInfluencers(lastRefresh,mlResultsService,jobIds,timerange.earliestMs,timerange.latestMs,anomalyChartRecords,selectionInfluencers,noInfluencersConfigured,influencersFilterQuery):Promise.resolve(influencers),viewBySwimlaneState:memoizedLoadViewBySwimlane(lastRefresh,topFieldValues,{earliest:overallState.earliest,latest:overallState.latest},selectedJobs,viewBySwimlaneFieldName,explorer_constants.a,viewByPerPage,viewByFromPage,swimlaneContainerWidth,influencersFilterQuery)}).pipe(Object(external_kbnSharedDeps_RxjsOperators_.map)(({viewBySwimlaneState:viewBySwimlaneState,filteredTopInfluencers:filteredTopInfluencers})=>({overallAnnotations:overallAnnotations,annotations:annotationsData,influencers:filteredTopInfluencers,loading:!1,viewBySwimlaneDataLoading:!1,anomalyChartsDataLoading:!1,overallSwimlaneData:overallState,viewBySwimlaneData:viewBySwimlaneState,tableData:tableData,swimlaneLimit:Object(swimlane_container.c)(viewBySwimlaneState)?viewBySwimlaneState.cardinality:void 0})))))}})(mlResultsService,new anomaly_timeline_service.AnomalyTimelineService(timefilter,uiSettings,mlResultsService),new anomaly_explorer_charts_service.a(timefilter,mlApiServices,mlResultsService),timefilter)},[]),loadExplorerData$=Object(external_kbnSharedDeps_React_.useMemo)(()=>new external_kbnSharedDeps_Rxjs_.Subject,[]),explorerData$=Object(external_kbnSharedDeps_React_.useMemo)(()=>loadExplorerData$.pipe(Object(external_kbnSharedDeps_RxjsOperators_.switchMap)(loadExplorerData)),[]);return[useObservable_default()(explorerData$),Object(external_kbnSharedDeps_React_.useCallback)(c=>{loadExplorerData$.next(c)},[])]};var explorer_charts_container_service=__webpack_require__(276);const checkSelectedCells=state=>{const{filterActive:filterActive,loading:loading,selectedCells:selectedCells,viewBySwimlaneData:viewBySwimlaneData,viewBySwimlaneDataLoading:viewBySwimlaneDataLoading}=state;if(loading||viewBySwimlaneDataLoading)return{};let clearSelection=!1;return null!=selectedCells&&selectedCells.type===explorer_constants.h.VIEW_BY&&void 0!==viewBySwimlaneData&&void 0!==viewBySwimlaneData.points&&viewBySwimlaneData.points.length>0&&(clearSelection=!1===filterActive&&!selectedCells.lanes.some(lane=>viewBySwimlaneData.points.some(point=>point.laneLabel===lane&&point.time>=selectedCells.times[0]&&point.time<=selectedCells.times[1]))),!0===clearSelection?{...Object(explorer_utils.d)()}:{}};const jobSelectionChange=(state,payload)=>{const{selectedJobs:selectedJobs}=payload,stateUpdate={...state,noInfluencersConfigured:0===Object(explorer_utils.g)(selectedJobs).length,overallSwimlaneData:Object(explorer_utils.f)(),selectedJobs:selectedJobs,viewByFromPage:!state.selectedJobs||Object(external_kbnSharedDeps_Lodash_.isEqual)(state.selectedJobs,selectedJobs)?state.viewByFromPage:1};if(!0===stateUpdate.noInfluencersConfigured){const noFilterState={filterActive:!1,filteredFields:[],influencersFilterQuery:void 0,maskAll:!1,queryString:"",tableQueryString:""};Object.assign(stateUpdate,noFilterState)}else stateUpdate.indexPattern=function(selectedJobs){return{title:".ml-anomalies-*",fields:Object(explorer_utils.g)(selectedJobs).map(influencer=>({name:influencer,type:"string",aggregatable:!0,searchable:!0}))}}(selectedJobs);return stateUpdate.loading=!0,stateUpdate};function getExplorerDefaultState(){return{overallAnnotations:{error:void 0,annotationsData:[],aggregations:{}},annotations:{error:void 0,annotationsData:[],aggregations:{}},anomalyChartsDataLoading:!0,chartsData:Object(explorer_charts_container_service.a)(),fieldFormatsLoading:!1,filterActive:!1,filteredFields:[],filterPlaceHolder:void 0,indexPattern:{title:".ml-anomalies-*",fields:[]},influencersFilterQuery:void 0,influencers:{},isAndOperator:!1,loading:!0,maskAll:!1,noInfluencersConfigured:!0,overallSwimlaneData:Object(explorer_utils.f)(),queryString:"",selectedCells:void 0,selectedJobs:null,swimlaneBucketInterval:void 0,swimlaneContainerWidth:0,tableData:{anomalies:[],examplesByJobId:[""],interval:0,jobIds:[],showViewSeriesLink:!1},tableQueryString:"",viewByLoadedForTimeFormatted:null,viewBySwimlaneData:Object(explorer_utils.f)(),viewBySwimlaneDataLoading:!1,viewBySwimlaneFieldName:void 0,viewBySwimlaneOptions:[],viewByPerPage:explorer_constants.i,viewByFromPage:1,swimlaneLimit:void 0}}const setKqlQueryBarPlaceholder=state=>{const{influencers:influencers,noInfluencersConfigured:noInfluencersConfigured}=state;if(void 0!==influencers&&!noInfluencersConfigured)for(const influencerName in influencers)if(influencers[influencerName][0]&&influencers[influencerName][0].influencerFieldValue)return{filterPlaceHolder:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.explorer.kueryBar.filterPlaceholder",{defaultMessage:"Filter by influencer fields… ({queryExample})",values:{queryExample:`${influencerName} : ${influencers[influencerName][0].influencerFieldValue}`}})};return{}};const explorerAction$=new external_kbnSharedDeps_Rxjs_.Subject,explorerState$=explorerAction$.pipe(Object(external_kbnSharedDeps_RxjsOperators_.flatMap)(action=>Object(external_kbnSharedDeps_Rxjs_.isObservable)(action)?action:Object(external_kbnSharedDeps_Rxjs_.from)([action])),Object(external_kbnSharedDeps_RxjsOperators_.distinctUntilChanged)(external_kbnSharedDeps_Lodash_.isEqual)).pipe(Object(external_kbnSharedDeps_RxjsOperators_.scan)((state,nextAction)=>{const{type:type,payload:payload}=nextAction;let nextState;switch(type){case explorer_constants.c.CLEAR_EXPLORER_DATA:nextState=getExplorerDefaultState();break;case explorer_constants.c.CLEAR_INFLUENCER_FILTER_SETTINGS:nextState=function(state){return{...state,filterActive:!1,filteredFields:[],influencersFilterQuery:void 0,isAndOperator:!1,maskAll:!1,queryString:"",tableQueryString:"",...Object(explorer_utils.d)(),viewByFromPage:1}}(state);break;case explorer_constants.c.CLEAR_JOBS:nextState={...state,...Object(explorer_utils.d)(),loading:!1,viewByFromPage:1,selectedJobs:[]};break;case explorer_constants.c.JOB_SELECTION_CHANGE:nextState=jobSelectionChange(state,payload);break;case explorer_constants.c.SET_CHARTS_DATA_LOADING:nextState={...state,anomalyChartsDataLoading:!0,chartsData:Object(explorer_charts_container_service.a)()};break;case explorer_constants.c.SET_CHARTS:nextState={...state,chartsData:{...Object(explorer_charts_container_service.a)(),chartsPerRow:payload.chartsPerRow,seriesToPlot:payload.seriesToPlot,tooManyBuckets:!!payload.tooManyBuckets,errorMessages:payload.errorMessages}};break;case explorer_constants.c.SET_INFLUENCER_FILTER_SETTINGS:nextState=function(state,payload){const{filterQuery:influencersFilterQuery,isAndOperator:isAndOperator,filteredFields:filteredFields,queryString:queryString,tableQueryString:tableQueryString}=payload,{selectedCells:selectedCells,viewBySwimlaneOptions:viewBySwimlaneOptions}=state;let selectedViewByFieldName=state.viewBySwimlaneFieldName;const filteredViewBySwimlaneOptions=viewBySwimlaneOptions.filter(d=>filteredFields.includes(d));if(isAndOperator&&void 0===selectedCells)selectedViewByFieldName=explorer_constants.j;else for(let i=0;i<filteredFields.length;i++)if(filteredViewBySwimlaneOptions.includes(filteredFields[i])&&(void 0===selectedCells||selectedCells&&"overall"===selectedCells.type)){selectedViewByFieldName=filteredFields[i];break}return{...state,filterActive:!0,filteredFields:filteredFields,influencersFilterQuery:influencersFilterQuery,isAndOperator:isAndOperator,queryString:queryString,tableQueryString:tableQueryString,maskAll:selectedViewByFieldName===explorer_constants.j||!1===filteredFields.includes(selectedViewByFieldName),viewBySwimlaneFieldName:selectedViewByFieldName,viewBySwimlaneOptions:filteredViewBySwimlaneOptions,viewByFromPage:1}}(state,payload);break;case explorer_constants.c.SET_SELECTED_CELLS:const selectedCells=payload;nextState={...state,selectedCells:selectedCells};break;case explorer_constants.c.SET_EXPLORER_DATA:case explorer_constants.c.SET_FILTER_DATA:nextState={...state,...payload};break;case explorer_constants.c.SET_SWIMLANE_CONTAINER_WIDTH:nextState={...state,swimlaneContainerWidth:payload};break;case explorer_constants.c.SET_VIEW_BY_SWIMLANE_FIELD_NAME:const{filteredFields:filteredFields,influencersFilterQuery:influencersFilterQuery}=state,viewBySwimlaneFieldName=payload;let maskAll=!1;void 0!==influencersFilterQuery&&(maskAll=viewBySwimlaneFieldName===explorer_constants.j||!1===filteredFields.includes(viewBySwimlaneFieldName)),nextState={...state,...Object(explorer_utils.d)(),maskAll:maskAll,viewBySwimlaneFieldName:viewBySwimlaneFieldName,viewBySwimlaneData:Object(explorer_utils.f)(),viewByFromPage:1,viewBySwimlaneDataLoading:!0};break;case explorer_constants.c.SET_VIEW_BY_SWIMLANE_LOADING:const{annotationsData:annotationsData,overallState:overallState,tableData:tableData}=payload;nextState={...state,annotations:annotationsData,overallSwimlaneData:overallState,tableData:tableData,viewBySwimlaneData:{...Object(explorer_utils.f)()},viewBySwimlaneDataLoading:!0};break;case explorer_constants.c.SET_VIEW_BY_FROM_PAGE:nextState={...state,viewByFromPage:payload};break;case explorer_constants.c.SET_VIEW_BY_PER_PAGE:nextState={...state,viewByFromPage:1,viewByPerPage:payload};break;default:nextState=state}if(null===nextState.selectedJobs)return nextState;const swimlaneBucketInterval=Object(explorer_utils.l)(nextState.selectedJobs,nextState.swimlaneContainerWidth),{viewBySwimlaneFieldName:viewBySwimlaneFieldName,viewBySwimlaneOptions:viewBySwimlaneOptions}=Object(explorer_utils.m)({currentViewBySwimlaneFieldName:nextState.viewBySwimlaneFieldName,filterActive:nextState.filterActive,filteredFields:nextState.filteredFields,isAndOperator:nextState.isAndOperator,selectedJobs:nextState.selectedJobs,selectedCells:nextState.selectedCells}),{selectedCells:selectedCells}=nextState,timeRange=function(selectedCells){if(void 0!==(null==selectedCells?void 0:selectedCells.times))return{earliestMs:1e3*selectedCells.times[0],latestMs:1e3*selectedCells.times[1]-1}}(selectedCells);return{...nextState,swimlaneBucketInterval:swimlaneBucketInterval,viewByLoadedForTimeFormatted:timeRange?Object(date_utils.b)(timeRange.earliestMs):null,viewBySwimlaneFieldName:viewBySwimlaneFieldName,viewBySwimlaneOptions:viewBySwimlaneOptions,...checkSelectedCells(nextState),...setKqlQueryBarPlaceholder(nextState)}},getExplorerDefaultState()),Object(external_kbnSharedDeps_RxjsOperators_.shareReplay)(1)),explorerAppState$=explorerState$.pipe(Object(external_kbnSharedDeps_RxjsOperators_.map)(state=>{const appState={mlExplorerFilter:{},mlExplorerSwimlane:{}};if(void 0!==state.selectedCells){const swimlaneSelectedCells=state.selectedCells;appState.mlExplorerSwimlane.selectedType=swimlaneSelectedCells.type,appState.mlExplorerSwimlane.selectedLanes=swimlaneSelectedCells.lanes,appState.mlExplorerSwimlane.selectedTimes=swimlaneSelectedCells.times,appState.mlExplorerSwimlane.showTopFieldValues=swimlaneSelectedCells.showTopFieldValues}return void 0!==state.viewBySwimlaneFieldName&&(appState.mlExplorerSwimlane.viewByFieldName=state.viewBySwimlaneFieldName),void 0!==state.viewByFromPage&&(appState.mlExplorerSwimlane.viewByFromPage=state.viewByFromPage),void 0!==state.viewByPerPage&&(appState.mlExplorerSwimlane.viewByPerPage=state.viewByPerPage),state.filterActive&&(appState.mlExplorerFilter.influencersFilterQuery=state.influencersFilterQuery,appState.mlExplorerFilter.filterActive=state.filterActive,appState.mlExplorerFilter.filteredFields=state.filteredFields,appState.mlExplorerFilter.queryString=state.queryString),appState}),Object(external_kbnSharedDeps_RxjsOperators_.distinctUntilChanged)(external_kbnSharedDeps_Lodash_.isEqual)),explorerService={appState$:explorerAppState$,state$:explorerState$,clearExplorerData:()=>{explorerAction$.next({type:explorer_constants.c.CLEAR_EXPLORER_DATA})},clearInfluencerFilterSettings:()=>{explorerAction$.next({type:explorer_constants.c.CLEAR_INFLUENCER_FILTER_SETTINGS})},clearJobs:()=>{explorerAction$.next({type:explorer_constants.c.CLEAR_JOBS})},updateJobSelection:selectedJobIds=>{explorerAction$.next(function(selectedJobIds){return Object(external_kbnSharedDeps_Rxjs_.from)(field_format_service.a.populateFormats(selectedJobIds)).pipe(Object(external_kbnSharedDeps_RxjsOperators_.map)(resp=>{if(resp.err)return console.log("Error populating field formats:",resp.err),null;const selectedJobs=Object(explorer_utils.a)(job_service.a.jobs).map(job=>(job.selected=selectedJobIds.some(id=>job.id===id),job)).filter(job=>job.selected);return{type:explorer_constants.c.JOB_SELECTION_CHANGE,payload:{loading:!1,selectedJobs:selectedJobs}}}))}(selectedJobIds))},setCharts:payload=>{explorerAction$.next({type:explorer_constants.c.SET_CHARTS,payload:payload})},setInfluencerFilterSettings:payload=>{explorerAction$.next({type:explorer_constants.c.SET_INFLUENCER_FILTER_SETTINGS,payload:payload})},setSelectedCells:payload=>{explorerAction$.next({type:explorer_constants.c.SET_SELECTED_CELLS,payload:payload})},setExplorerData:payload=>{explorerAction$.next((payload=>({type:explorer_constants.c.SET_EXPLORER_DATA,payload:payload}))(payload))},setFilterData:payload=>{explorerAction$.next((payload=>({type:explorer_constants.c.SET_FILTER_DATA,payload:payload}))(payload))},setChartsDataLoading:()=>{explorerAction$.next({type:explorer_constants.c.SET_CHARTS_DATA_LOADING})},setSwimlaneContainerWidth:payload=>{explorerAction$.next({type:explorer_constants.c.SET_SWIMLANE_CONTAINER_WIDTH,payload:payload})},setViewBySwimlaneFieldName:payload=>{explorerAction$.next({type:explorer_constants.c.SET_VIEW_BY_SWIMLANE_FIELD_NAME,payload:payload})},setViewBySwimlaneLoading:payload=>{explorerAction$.next({type:explorer_constants.c.SET_VIEW_BY_SWIMLANE_LOADING,payload:payload})},setViewByFromPage:payload=>{explorerAction$.next({type:explorer_constants.c.SET_VIEW_BY_FROM_PAGE,payload:payload})},setViewByPerPage:payload=>{explorerAction$.next({type:explorer_constants.c.SET_VIEW_BY_PER_PAGE,payload:payload})}};function useExplorerUrlState(){const[legacyExplorerState]=Object(url_state.b)("mlExplorerSwimlane");return Object(url_state.b)(ml_url_generator.b.ANOMALY_EXPLORER,{mlExplorerSwimlane:legacyExplorerState,mlExplorerFilter:{}})}const useShowCharts=()=>{var _explorerUrlState$mlS;const[explorerUrlState,setExplorerUrlState]=useExplorerUrlState();return[null===(_explorerUrlState$mlS=null==explorerUrlState?void 0:explorerUrlState.mlShowCharts)||void 0===_explorerUrlState$mlS||_explorerUrlState$mlS,Object(external_kbnSharedDeps_React_.useCallback)(v=>{setExplorerUrlState({mlShowCharts:v})},[setExplorerUrlState])]},CheckboxShowCharts=()=>{const[showCharts,setShowCharts]=useShowCharts(),id=Object(external_kbnSharedDeps_React_.useMemo)(()=>Object(external_kbnSharedDeps_ElasticEui_.htmlIdGenerator)()(),[]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCheckbox,{id:id,label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.controls.checkboxShowCharts.showChartsCheckboxLabel",defaultMessage:"Show charts"}),checked:showCharts,onChange:e=>{setShowCharts(e.target.checked)}})},DEFAULT_QUERY_LANG=constants_search.c.KUERY;function getKqlQueryValues({inputString:inputString,queryLanguage:queryLanguage,indexPattern:indexPattern}){var _influencersFilterQue;let influencersFilterQuery={};const filteredFields=[],ast=data_public_.esKuery.fromKueryExpression(inputString),isAndOperator=ast&&"and"===ast.function;ast&&Array.isArray(ast.arguments)&&ast.arguments.forEach(arg=>{void 0!==arg.arguments?arg.arguments.forEach(nestedArg=>{"string"==typeof nestedArg.value&&filteredFields.push(nestedArg.value)}):"string"==typeof arg.value&&filteredFields.push(arg.value)}),queryLanguage===constants_search.c.KUERY?influencersFilterQuery=data_public_.esKuery.toElasticsearchQuery(data_public_.esKuery.fromKueryExpression(inputString),indexPattern):queryLanguage===constants_search.c.LUCENE&&(influencersFilterQuery=data_public_.esQuery.luceneStringToDsl(inputString));return{clearSettings:(null===(_influencersFilterQue=influencersFilterQuery)||void 0===_influencersFilterQue?void 0:_influencersFilterQue.match_all)&&0===Object.keys(influencersFilterQuery.match_all).length,settings:{filterQuery:influencersFilterQuery,queryString:inputString,tableQueryString:inputString,isAndOperator:isAndOperator,filteredFields:filteredFields}}}const ExplorerQueryBar=({filterActive:filterActive,filterIconTriggeredQuery:filterIconTriggeredQuery,filterPlaceHolder:filterPlaceHolder,indexPattern:indexPattern,queryString:queryString,updateLanguage:updateLanguage})=>{const[searchInput,setSearchInput]=Object(external_kbnSharedDeps_React_.useState)(function({filterActive:filterActive,queryString:queryString}){return void 0!==queryString&&!0===filterActive?{language:constants_search.c.KUERY,query:queryString}:{query:"",language:DEFAULT_QUERY_LANG}}({filterActive:filterActive,queryString:queryString})),[errorMessage,setErrorMessage]=Object(external_kbnSharedDeps_React_.useState)(void 0);Object(external_kbnSharedDeps_React_.useEffect)(()=>{void 0!==filterIconTriggeredQuery&&setSearchInput({language:searchInput.language,query:filterIconTriggeredQuery})},[filterIconTriggeredQuery]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiInputPopover,{style:{maxWidth:"100%"},closePopover:()=>setErrorMessage(void 0),input:external_kbnSharedDeps_React_default.a.createElement(data_public_.QueryStringInput,{bubbleSubmitEvent:!1,query:searchInput,indexPatterns:[indexPattern],onChange:query=>{searchInput.language!==query.language&&updateLanguage(query.language),setSearchInput(query)},onSubmit:query=>{try{const{clearSettings:clearSettings,settings:settings}=getKqlQueryValues({inputString:query.query,queryLanguage:query.language,indexPattern:indexPattern});!0===clearSettings?explorerService.clearInfluencerFilterSettings():explorerService.setInfluencerFilterSettings(settings)}catch(e){console.log("Invalid query syntax in search bar",e),setErrorMessage({query:query.query,message:e.message})}},placeholder:filterPlaceHolder,disableAutoFocus:!0,dataTestSubj:"explorerQueryInput",languageSwitcherPopoverAnchorPosition:"rightDown"}),isOpen:(null==errorMessage?void 0:errorMessage.query)===searchInput.query&&""!==(null==errorMessage?void 0:errorMessage.message)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCode,null,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.explorer.invalidKuerySyntaxErrorMessageQueryBar",{defaultMessage:"Invalid query"}),": ",null==errorMessage?void 0:errorMessage.message.split("\n")[0]))};var anomaly_swimlane_embeddable=__webpack_require__(288),embeddables=__webpack_require__(103),dashboard_public_=__webpack_require__(53),embeddable_public_=__webpack_require__(45);function useDashboardService(){const{services:{savedObjects:{client:savedObjectClient},kibanaVersion:kibanaVersion,share:{urlGenerators:urlGenerators}}}=Object(contexts_kibana.b)();return Object(external_kbnSharedDeps_React_.useMemo)(()=>function(savedObjectClient,kibanaVersion,dashboardUrlGenerator){const generateId=Object(external_kbnSharedDeps_ElasticEui_.htmlIdGenerator)();return{fetchDashboards:async query=>await savedObjectClient.find({type:"dashboard",perPage:1e3,search:query?query+"*":"",searchFields:["title^3","description"]}),getLastPanel:panels=>panels.length>0?panels.reduce((prev,current)=>prev.gridData.y>=current.gridData.y?prev.gridData.y===current.gridData.y?prev.gridData.x>current.gridData.x?prev:current:prev:current):null,async attachPanels(dashboardId,dashboardAttributes,panelsData){const panels=JSON.parse(dashboardAttributes.panelsJSON),version=kibanaVersion;for(const panelData of panelsData){const panelIndex=generateId(),lastPanel=this.getLastPanel(panels),xOffset=lastPanel?lastPanel.gridData.w+lastPanel.gridData.x:0,xPosition=48-xOffset-24>=0?xOffset:0;panels.push({panelIndex:panelIndex,embeddableConfig:panelData.embeddableConfig,title:panelData.title,type:panelData.type,version:version,gridData:{h:15,i:panelIndex,w:24,x:xPosition,y:lastPanel?xPosition>0?lastPanel.gridData.y:lastPanel.gridData.y+lastPanel.gridData.h:0}})}await savedObjectClient.update("dashboard",dashboardId,{...dashboardAttributes,panelsJSON:JSON.stringify(panels)})},getDashboardEditUrl:async dashboardId=>await dashboardUrlGenerator.createUrl({dashboardId:dashboardId,useHash:!1,viewMode:embeddable_public_.ViewMode.EDIT})}}(savedObjectClient,kibanaVersion,urlGenerators.getUrlGenerator(dashboard_public_.DASHBOARD_APP_URL_GENERATOR)),[savedObjectClient,kibanaVersion])}const useDashboardTable=()=>{const{notifications:{toasts:toasts}}=Object(contexts_kibana.b)(),dashboardService=useDashboardService(),[isLoading,setIsLoading]=Object(external_kbnSharedDeps_React_.useState)(!1);Object(external_kbnSharedDeps_React_.useEffect)(()=>(fetchDashboards(),()=>{fetchDashboards.cancel()}),[]);const search=Object(external_kbnSharedDeps_React_.useMemo)(()=>({onChange:({queryText:queryText})=>{setIsLoading(!0),fetchDashboards(queryText)},box:{incremental:!0,"data-test-subj":"mlDashboardsSearchBox"}}),[]),[dashboardItems,setDashboardItems]=Object(external_kbnSharedDeps_React_.useState)([]),[selectedItems,setSelectedItems]=Object(external_kbnSharedDeps_React_.useState)([]),fetchDashboards=Object(external_kbnSharedDeps_React_.useCallback)(Object(external_kbnSharedDeps_Lodash_.debounce)(async query=>{try{const items=(await dashboardService.fetchDashboards(query)).savedObjects.map(savedObject=>({id:savedObject.id,title:savedObject.attributes.title,description:savedObject.attributes.description,attributes:savedObject.attributes}));setDashboardItems(items)}catch(e){toasts.danger({body:e})}setIsLoading(!1)},500),[]);return{dashboardItems:dashboardItems,selectedItems:selectedItems,selection:{onSelectionChange:setSelectedItems},search:search,isLoading:isLoading}},add_to_dashboard_controls_columns=[{field:"title",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.explorer.dashboardsTable.titleColumnHeader",{defaultMessage:"Title"}),sortable:!0,truncateText:!0},{field:"description",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.explorer.dashboardsTable.descriptionColumnHeader",{defaultMessage:"Description"}),truncateText:!0}],AddToDashboardControl=({onClose:onClose,selection:selection,dashboardItems:dashboardItems,isLoading:isLoading,search:search,addToDashboardAndEditCallback:addToDashboardAndEditCallback,addToDashboardCallback:addToDashboardCallback,title:title,disabled:disabled,children:children})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModal,{onClose:onClose.bind(null,void 0),"data-test-subj":"mlAddToDashboardModal"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalHeader,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalHeaderTitle,null,title)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalBody,null,children,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{fullWidth:!0,label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.explorer.addToDashboard.selectDashboardsLabel",defaultMessage:"Select dashboards:"}),"data-test-subj":"mlDashboardSelectionContainer"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiInMemoryTable,{itemId:"id",isSelectable:!0,selection:selection,items:dashboardItems,loading:isLoading,columns:add_to_dashboard_controls_columns,search:search,pagination:!0,sorting:!0,"data-test-subj":"mlDashboardSelectionTable"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalFooter,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{onClick:onClose.bind(null,void 0)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.explorer.addToDashboard.cancelButtonLabel",defaultMessage:"Cancel"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{disabled:disabled,onClick:onClose.bind(null,addToDashboardAndEditCallback),"data-test-subj":"mlAddAndEditDashboardButton"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.explorer.dashboardsTable.addAndEditDashboardLabel",defaultMessage:"Add and edit dashboard"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{fill:!0,onClick:onClose.bind(null,addToDashboardCallback),disabled:disabled,"data-test-subj":"mlAddToDashboardsButton"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.explorer.dashboardsTable.addToDashboardLabel",defaultMessage:"Add to dashboards"})))),useAddToDashboardActions=({onClose:onClose,getPanelsData:getPanelsData,selectedDashboards:selectedDashboards})=>{const{notifications:{toasts:toasts},services:{application:{navigateToUrl:navigateToUrl}}}=Object(contexts_kibana.b)(),dashboardService=useDashboardService(),addToDashboardCallback=Object(external_kbnSharedDeps_React_.useCallback)(async()=>{const panelsData=await getPanelsData(selectedDashboards);for(const selectedDashboard of selectedDashboards)try{await dashboardService.attachPanels(selectedDashboard.id,selectedDashboard.attributes,panelsData),toasts.success({title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.explorer.dashboardsTable.savedSuccessfullyTitle",defaultMessage:'Dashboard "{dashboardTitle}" updated successfully',values:{dashboardTitle:selectedDashboard.title}}),toastLifeTimeMs:3e3})}catch(e){toasts.danger({body:e})}},[selectedDashboards,getPanelsData]),addToDashboardAndEditCallback=Object(external_kbnSharedDeps_React_.useCallback)(async()=>{onClose(async()=>{await addToDashboardCallback();const selectedDashboardId=selectedDashboards[0].id;await navigateToUrl(await dashboardService.getDashboardEditUrl(selectedDashboardId))})},[addToDashboardCallback,selectedDashboards,navigateToUrl]);return{addToDashboardCallback:addToDashboardCallback,addToDashboardAndEditCallback:addToDashboardAndEditCallback}};const AddSwimlaneToDashboardControl=({onClose:onClose,jobIds:jobIds,viewBy:viewBy})=>{const{selectedItems:selectedItems,selection:selection,dashboardItems:dashboardItems,isLoading:isLoading,search:search}=useDashboardTable(),[selectedSwimlanes,setSelectedSwimlanes]=Object(external_kbnSharedDeps_React_.useState)({[explorer_constants.h.OVERALL]:!0,[explorer_constants.h.VIEW_BY]:!1}),getPanelsData=Object(external_kbnSharedDeps_React_.useCallback)(async()=>Object.entries(selectedSwimlanes).filter(([,isSelected])=>isSelected).map(([swimlaneType])=>swimlaneType).map(swimlaneType=>{const config=function(jobIds){return{type:embeddables.b,title:Object(anomaly_swimlane_embeddable.getDefaultSwimlanePanelTitle)(jobIds)}}(jobIds);return swimlaneType===explorer_constants.h.VIEW_BY?{...config,embeddableConfig:{jobIds:jobIds,swimlaneType:swimlaneType,viewBy:viewBy}}:{...config,embeddableConfig:{jobIds:jobIds,swimlaneType:swimlaneType}}}),[selectedSwimlanes,selectedItems]),{addToDashboardAndEditCallback:addToDashboardAndEditCallback,addToDashboardCallback:addToDashboardCallback}=useAddToDashboardActions({onClose:onClose,getPanelsData:getPanelsData,selectedDashboards:selectedItems}),swimlaneTypeOptions=[{id:explorer_constants.h.OVERALL,label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.explorer.overallLabel",{defaultMessage:"Overall"})},{id:explorer_constants.h.VIEW_BY,label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.explorer.viewByFieldLabel",{defaultMessage:"View by {viewByField}",values:{viewByField:viewBy}})}],noSwimlaneSelected=Object.values(selectedSwimlanes).every(isSelected=>!isSelected),extraControls=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.explorer.addToDashboard.swimlanes.selectSwimlanesLabel",defaultMessage:"Select swim lane view:"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCheckboxGroup,{options:swimlaneTypeOptions,idToSelectedMap:selectedSwimlanes,onChange:optionId=>{const newSelection={...selectedSwimlanes,[optionId]:!selectedSwimlanes[optionId]};setSelectedSwimlanes(newSelection)},"data-test-subj":"mlAddToDashboardSwimlaneTypeSelector"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"})),title=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.explorer.addToDashboard.swimlanes.dashboardsTitle",defaultMessage:"Add swim lanes to dashboards"}),disabled=noSwimlaneSelected||0===selectedItems.length;return external_kbnSharedDeps_React_default.a.createElement(AddToDashboardControl,{onClose:onClose,selectedItems:selectedItems,selection:selection,dashboardItems:dashboardItems,isLoading:isLoading,search:search,addToDashboardAndEditCallback:addToDashboardAndEditCallback,addToDashboardCallback:addToDashboardCallback,disabled:disabled,title:title},extraControls)};var common_=__webpack_require__(28);const hasMatchingPoints=({filteredFields:filteredFields=[],swimlaneData:swimlaneData})=>{const wildCardField=filteredFields.find(field=>/\@kuery-wildcard\@$/.test(field)),substring=void 0!==wildCardField?wildCardField.replace(/\@kuery-wildcard\@$/,""):null;return null!==substring&&swimlaneData.points.some(point=>point.laneLabel.includes(substring))},NoOverallData=()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.anomalySwimLane.noOverallDataMessage",defaultMessage:"No anomalies found in the overall bucket results for this time range"});const AnomalyTimeline=external_kbnSharedDeps_React_default.a.memo(({explorerState:explorerState,setSelectedCells:setSelectedCells})=>{var _capabilities$dashboa,_capabilities$dashboa2,_selectedJobs$length;const{services:{uiSettings:uiSettings,application:{capabilities:capabilities}}}=Object(contexts_kibana.b)(),[isMenuOpen,setIsMenuOpen]=Object(external_kbnSharedDeps_React_.useState)(!1),[isAddDashboardsActive,setIsAddDashboardActive]=Object(external_kbnSharedDeps_React_.useState)(!1),canEditDashboards=null!==(_capabilities$dashboa=null===(_capabilities$dashboa2=capabilities.dashboard)||void 0===_capabilities$dashboa2?void 0:_capabilities$dashboa2.createNew)&&void 0!==_capabilities$dashboa&&_capabilities$dashboa,timeBuckets=Object(external_kbnSharedDeps_React_.useMemo)(()=>new time_buckets.a({"histogram:maxBars":uiSettings.get(common_.UI_SETTINGS.HISTOGRAM_MAX_BARS),"histogram:barTarget":uiSettings.get(common_.UI_SETTINGS.HISTOGRAM_BAR_TARGET),dateFormat:uiSettings.get("dateFormat"),"dateFormat:scaled":uiSettings.get("dateFormat:scaled")}),[uiSettings]),{filterActive:filterActive,filteredFields:filteredFields,maskAll:maskAll,overallSwimlaneData:overallSwimlaneData,selectedCells:selectedCells,viewByLoadedForTimeFormatted:viewByLoadedForTimeFormatted,viewBySwimlaneData:viewBySwimlaneData,viewBySwimlaneDataLoading:viewBySwimlaneDataLoading,viewBySwimlaneFieldName:viewBySwimlaneFieldName,viewBySwimlaneOptions:viewBySwimlaneOptions,selectedJobs:selectedJobs,viewByFromPage:viewByFromPage,viewByPerPage:viewByPerPage,swimlaneLimit:swimlaneLimit,loading:loading,overallAnnotations:overallAnnotations}=explorerState,annotations=Object(external_kbnSharedDeps_React_.useMemo)(()=>overallAnnotations.annotationsData,[overallAnnotations]),menuItems=Object(external_kbnSharedDeps_React_.useMemo)(()=>{const items=[];return canEditDashboards&&items.push(external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenuItem,{key:"addToDashboard",onClick:setIsAddDashboardActive.bind(null,!0),"data-test-subj":"mlAnomalyTimelinePanelAddToDashboardButton"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.explorer.addToDashboardLabel",defaultMessage:"Add to dashboard"}))),items},[canEditDashboards]),overallCellSelection=Object(external_kbnSharedDeps_React_.useMemo)(()=>{if(selectedCells)return selectedCells.type===explorer_constants.h.OVERALL?selectedCells:{type:explorer_constants.h.OVERALL,lanes:[explorer_constants.g],times:selectedCells.times}},[selectedCells]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPanel,{paddingSize:"m"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"row",gutterSize:"m",responsive:!1,alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{className:"panel-title"},external_kbnSharedDeps_React_default.a.createElement("h2",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.explorer.anomalyTimelineTitle",defaultMessage:"Anomaly timeline"})))),viewBySwimlaneOptions.length>0&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_React_default.a.createElement("span",{className:"eui-textNoWrap"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.explorer.viewByLabel",defaultMessage:"View by"})),display:"columnCompressed"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSelect,{compressed:!0,id:"selectViewBy",options:(options=viewBySwimlaneOptions,options.map(option=>({value:option,text:option}))),value:viewBySwimlaneFieldName,onChange:e=>explorerService.setViewBySwimlaneFieldName(e.target.value)}))),selectedCells?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{size:"xs",onClick:setSelectedCells.bind(null,void 0),"data-test-subj":"mlAnomalyTimelineClearSelection"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.explorer.clearSelectionLabel",defaultMessage:"Clear selection"}))):null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,style:{alignSelf:"center"}},external_kbnSharedDeps_React_default.a.createElement("div",{className:"panel-sub-title"},viewByLoadedForTimeFormatted&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.explorer.sortedByMaxAnomalyScoreForTimeFormattedLabel",defaultMessage:"(Sorted by max anomaly score for {viewByLoadedForTimeFormatted})",values:{viewByLoadedForTimeFormatted:viewByLoadedForTimeFormatted}}),void 0===viewByLoadedForTimeFormatted&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.explorer.sortedByMaxAnomalyScoreLabel",defaultMessage:"(Sorted by max anomaly score)"}),!0===filterActive&&viewBySwimlaneFieldName===explorer_constants.j&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.explorer.jobScoreAcrossAllInfluencersLabel",defaultMessage:"(Job score across all influencers)"})))),menuItems.length>0&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,style:{marginLeft:"auto",alignSelf:"baseline"}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopover,{button:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{size:"s","aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.explorer.swimlaneActions",{defaultMessage:"Actions"}),color:"subdued",iconType:"boxesHorizontal",onClick:setIsMenuOpen.bind(null,!isMenuOpen),"data-test-subj":"mlAnomalyTimelinePanelMenu"}),isOpen:isMenuOpen,closePopover:setIsMenuOpen.bind(null,!1),panelPaddingSize:"none",anchorPosition:"downLeft"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenuPanel,{items:menuItems})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(swimlane_container.b,{id:"overall","data-test-subj":"mlAnomalyExplorerSwimlaneOverall",filterActive:filterActive,maskAll:maskAll,timeBuckets:timeBuckets,swimlaneData:overallSwimlaneData,swimlaneType:explorer_constants.h.OVERALL,selection:overallCellSelection,onCellsSelection:setSelectedCells,onResize:explorerService.setSwimlaneContainerWidth,isLoading:loading,noDataWarning:external_kbnSharedDeps_React_default.a.createElement(NoOverallData,null),showTimeline:!1,annotationsData:annotations}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),viewBySwimlaneOptions.length>0&&external_kbnSharedDeps_React_default.a.createElement(swimlane_container.b,{id:"view_by","data-test-subj":"mlAnomalyExplorerSwimlaneViewBy",filterActive:filterActive,maskAll:maskAll&&!hasMatchingPoints({filteredFields:filteredFields,swimlaneData:viewBySwimlaneData}),timeBuckets:timeBuckets,showLegend:!0,swimlaneData:viewBySwimlaneData,swimlaneType:explorer_constants.h.VIEW_BY,selection:selectedCells,onCellsSelection:setSelectedCells,onResize:explorerService.setSwimlaneContainerWidth,fromPage:viewByFromPage,perPage:viewByPerPage,swimlaneLimit:swimlaneLimit,onPaginationChange:({perPage:perPageUpdate,fromPage:fromPageUpdate})=>{perPageUpdate&&explorerService.setViewByPerPage(perPageUpdate),fromPageUpdate&&explorerService.setViewByFromPage(fromPageUpdate)},isLoading:loading||viewBySwimlaneDataLoading,noDataWarning:"string"==typeof viewBySwimlaneFieldName?viewBySwimlaneFieldName===explorer_constants.j?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.explorer.noResultForSelectedJobsMessage",defaultMessage:"No results found for selected {jobsCount, plural, one {job} other {jobs}}",values:{jobsCount:null!==(_selectedJobs$length=null==selectedJobs?void 0:selectedJobs.length)&&void 0!==_selectedJobs$length?_selectedJobs$length:1}}):external_kbnSharedDeps_React_default.a.createElement(ExplorerNoInfluencersFound,{viewBySwimlaneFieldName:viewBySwimlaneFieldName,showFilterMessage:!0===filterActive}):null})),isAddDashboardsActive&&selectedJobs&&external_kbnSharedDeps_React_default.a.createElement(AddSwimlaneToDashboardControl,{onClose:async callback=>{setIsAddDashboardActive(!1),callback&&await callback()},jobIds:selectedJobs.map(({id:id})=>id),viewBy:viewBySwimlaneFieldName}));var options},(prevProps,nextProps)=>Object(external_kbnSharedDeps_Lodash_.isEqual)(prevProps.explorerState,nextProps.explorerState));var explorer_charts_container=__webpack_require__(411),anomaly_charts_embeddable=__webpack_require__(289),anomaly_charts_initializer=__webpack_require__(401);const AddAnomalyChartsToDashboardControl=({onClose:onClose,jobIds:jobIds,selectedCells:selectedCells,bounds:bounds,interval:interval})=>{const[severity]=Object(select_severity.e)(),[maxSeriesToPlot,setMaxSeriesToPlot]=Object(external_kbnSharedDeps_React_.useState)(anomaly_explorer_charts_service.b),getPanelsData=Object(external_kbnSharedDeps_React_.useCallback)(async()=>{var _timeRange;let timeRange;if(void 0!==selectedCells&&void 0!==interval&&void 0!==bounds){const{earliestMs:earliestMs,latestMs:latestMs}=Object(explorer_utils.k)(selectedCells,interval,bounds);timeRange={from:Object(external_kbnSharedDeps_ElasticEui_.formatDate)(earliestMs,"MMM D, YYYY @ HH:mm:ss.SSS"),to:Object(external_kbnSharedDeps_ElasticEui_.formatDate)(latestMs,"MMM D, YYYY @ HH:mm:ss.SSS"),mode:"absolute"}}return[{...function(jobIds){return{type:embeddables.a,title:Object(anomaly_charts_embeddable.getDefaultExplorerChartsPanelTitle)(jobIds)}}(jobIds),embeddableConfig:{jobIds:jobIds,maxSeriesToPlot:null!=maxSeriesToPlot?maxSeriesToPlot:anomaly_explorer_charts_service.b,severityThreshold:severity.val,...null!==(_timeRange=timeRange)&&void 0!==_timeRange?_timeRange:{}}}]},[selectedCells,interval,bounds,jobIds,maxSeriesToPlot,severity]),{selectedItems:selectedItems,selection:selection,dashboardItems:dashboardItems,isLoading:isLoading,search:search}=useDashboardTable(),{addToDashboardAndEditCallback:addToDashboardAndEditCallback,addToDashboardCallback:addToDashboardCallback}=useAddToDashboardActions({onClose:onClose,getPanelsData:getPanelsData,selectedDashboards:selectedItems}),title=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.explorer.addToDashboard.anomalyCharts.dashboardsTitle",defaultMessage:"Add anomaly charts to dashboards"}),disabled=selectedItems.length<1&&!Array.isArray(void 0===jobIds),extraControls=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.explorer.addToDashboard.anomalyCharts.maxSeriesToPlotLabel",defaultMessage:"Maximum number of series to plot"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldNumber,{"data-test-subj":"mlAnomalyChartsInitializerMaxSeries",id:"selectMaxSeriesToPlot",name:"selectMaxSeriesToPlot",value:maxSeriesToPlot,onChange:e=>setMaxSeriesToPlot(parseInt(e.target.value,10)),min:0,max:anomaly_charts_initializer.b}));return external_kbnSharedDeps_React_default.a.createElement(AddToDashboardControl,{onClose:onClose,selectedItems:selectedItems,selection:selection,dashboardItems:dashboardItems,isLoading:isLoading,search:search,addToDashboardAndEditCallback:addToDashboardAndEditCallback,addToDashboardCallback:addToDashboardCallback,disabled:disabled,title:title},extraControls)},AnomalyContextMenu=({selectedJobs:selectedJobs,selectedCells:selectedCells,bounds:bounds,interval:interval,chartsCount:chartsCount})=>{var _capabilities$dashboa,_capabilities$dashboa2;const{services:{application:{capabilities:capabilities}}}=Object(contexts_kibana.b)(),[isMenuOpen,setIsMenuOpen]=Object(external_kbnSharedDeps_React_.useState)(!1),[isAddDashboardsActive,setIsAddDashboardActive]=Object(external_kbnSharedDeps_React_.useState)(!1),canEditDashboards=null!==(_capabilities$dashboa=null===(_capabilities$dashboa2=capabilities.dashboard)||void 0===_capabilities$dashboa2?void 0:_capabilities$dashboa2.createNew)&&void 0!==_capabilities$dashboa&&_capabilities$dashboa,menuItems=Object(external_kbnSharedDeps_React_.useMemo)(()=>{const items=[];return canEditDashboards&&items.push(external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenuItem,{key:"addToDashboard",onClick:setIsAddDashboardActive.bind(null,!0),"data-test-subj":"mlAnomalyAddChartsToDashboardButton"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.explorer.anomalies.addToDashboardLabel",defaultMessage:"Add anomaly charts to dashboard"}))),items},[canEditDashboards]),jobIds=selectedJobs.map(({id:id})=>id);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,menuItems.length>0&&chartsCount>0&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,style:{marginLeft:"auto",alignSelf:"baseline"}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopover,{button:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{size:"s","aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.explorer.anomalies.actionsAriaLabel",{defaultMessage:"Actions"}),color:"subdued",iconType:"boxesHorizontal",onClick:setIsMenuOpen.bind(null,!isMenuOpen),"data-test-subj":"mlExplorerAnomalyPanelMenu",disabled:chartsCount<1}),isOpen:isMenuOpen,closePopover:setIsMenuOpen.bind(null,!1),panelPaddingSize:"none",anchorPosition:"downLeft"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenuPanel,{items:menuItems}))),isAddDashboardsActive&&selectedJobs&&external_kbnSharedDeps_React_default.a.createElement(AddAnomalyChartsToDashboardControl,{onClose:async callback=>{setIsAddDashboardActive(!1),callback&&await callback()},selectedCells:selectedCells,bounds:bounds,interval:interval,jobIds:jobIds}))};function explorer_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}const ExplorerPage=({children:children,jobSelectorProps:jobSelectorProps,noInfluencersConfigured:noInfluencersConfigured,influencers:influencers,filterActive:filterActive,filterPlaceHolder:filterPlaceHolder,indexPattern:indexPattern,queryString:queryString,filterIconTriggeredQuery:filterIconTriggeredQuery,updateLanguage:updateLanguage})=>external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":"mlPageAnomalyExplorer"},external_kbnSharedDeps_React_default.a.createElement(navigation_menu.a,{tabId:"anomaly_detection"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPage,{style:{background:"none"}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageBody,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageHeader,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageHeaderSection,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(AnomalyResultsViewSelector,{viewId:"explorer"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{className:"eui-textNoWrap"},external_kbnSharedDeps_React_default.a.createElement("h1",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.explorer.pageTitle",defaultMessage:"Anomaly Explorer"})))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageHeaderSection,{style:{width:"100%"}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",justifyContent:"flexEnd",gutterSize:"s"},!1===noInfluencersConfigured&&void 0!==influencers&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement("div",{className:"mlAnomalyExplorer__filterBar"},external_kbnSharedDeps_React_default.a.createElement(ExplorerQueryBar,{filterActive:filterActive,filterPlaceHolder:filterPlaceHolder,indexPattern:indexPattern,queryString:queryString,filterIconTriggeredQuery:filterIconTriggeredQuery,updateLanguage:updateLanguage}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(date_picker_wrapper.a,null))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHorizontalRule,{margin:"none"}),external_kbnSharedDeps_React_default.a.createElement(job_selector.a,jobSelectorProps),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHorizontalRule,{margin:"none"}),children)));class explorer_ExplorerUI extends external_kbnSharedDeps_React_default.a.Component{constructor(...args){super(...args),explorer_defineProperty(this,"state",{filterIconTriggeredQuery:void 0,language:DEFAULT_QUERY_LANG}),explorer_defineProperty(this,"htmlIdGen",Object(external_kbnSharedDeps_ElasticEui_.htmlIdGenerator)()),explorer_defineProperty(this,"applyFilter",(fieldName,fieldValue,action)=>{const{filterActive:filterActive,indexPattern:indexPattern,queryString:queryString}=this.props.explorerState;let newQueryString="";const sanitizedFieldName=Object(explorer_utils.c)(fieldName),sanitizedFieldValue=Object(explorer_utils.b)(fieldValue);if(action===explorer_constants.d.ADD){const queryPattern=Object(explorer_utils.h)(fieldName,fieldValue);if(null!==queryString.match(queryPattern))return;newQueryString=`${queryString?queryString+" and ":""}${sanitizedFieldName}:"${sanitizedFieldValue}"`}else if(action===explorer_constants.d.REMOVE){if(!1===filterActive)return;newQueryString=Object(explorer_utils.s)(queryString,sanitizedFieldName,sanitizedFieldValue)}this.setState({filterIconTriggeredQuery:""+newQueryString});try{const{clearSettings:clearSettings,settings:settings}=getKqlQueryValues({inputString:""+newQueryString,queryLanguage:this.state.language,indexPattern:indexPattern});!0===clearSettings?explorerService.clearInfluencerFilterSettings():explorerService.setInfluencerFilterSettings(settings)}catch(e){console.log("Invalid query syntax from table",e);Object(dependency_cache.j)().addDanger(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.explorer.invalidKuerySyntaxErrorMessageFromTable",{defaultMessage:"Invalid syntax in query bar. The input must be valid Kibana Query Language (KQL)"}))}}),explorer_defineProperty(this,"updateLanguage",language=>this.setState({language:language}))}componentDidMount(){const{invalidTimeRangeError:invalidTimeRangeError}=this.props;if(invalidTimeRangeError){Object(dependency_cache.j)().addWarning(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.explorer.invalidTimeRangeInUrlCallout",{defaultMessage:"The time filter was changed to the full range due to an invalid default time filter. Check the advanced settings for {field}.",values:{field:constants_settings.a}}))}}render(){var _tableData$anomalies;const{share:{urlGenerators:{getUrlGenerator:getUrlGenerator}}}=this.props.kibana.services,mlUrlGenerator=getUrlGenerator(ml_url_generator.a),{showCharts:showCharts,severity:severity,stoppedPartitions:stoppedPartitions,selectedJobsRunning:selectedJobsRunning,timefilter:timefilter,timeBuckets:timeBuckets}=this.props,{annotations:annotations,chartsData:chartsData,filterActive:filterActive,filterPlaceHolder:filterPlaceHolder,indexPattern:indexPattern,influencers:influencers,loading:loading,noInfluencersConfigured:noInfluencersConfigured,overallSwimlaneData:overallSwimlaneData,queryString:queryString,selectedCells:selectedCells,selectedJobs:selectedJobs,tableData:tableData}=this.props.explorerState,{annotationsData:annotationsData,aggregations:aggregations,error:annotationsError}=annotations,jobSelectorProps={dateFormatTz:Object(explorer_utils.e)()},noJobsFound=null===selectedJobs||0===selectedJobs.length,hasResults=overallSwimlaneData.points&&overallSwimlaneData.points.length>0,hasResultsWithAnomalies=hasResults&&overallSwimlaneData.points.some(v=>v.value>0)||(null===(_tableData$anomalies=tableData.anomalies)||void 0===_tableData$anomalies?void 0:_tableData$anomalies.length)>0;if(noJobsFound&&!loading)return external_kbnSharedDeps_React_default.a.createElement(ExplorerPage,{jobSelectorProps:jobSelectorProps},external_kbnSharedDeps_React_default.a.createElement(ExplorerNoJobsFound,null));if(!1===hasResultsWithAnomalies&&!loading)return external_kbnSharedDeps_React_default.a.createElement(ExplorerPage,{jobSelectorProps:jobSelectorProps},external_kbnSharedDeps_React_default.a.createElement(ExplorerNoResultsFound,{hasResults:hasResults,selectedJobsRunning:selectedJobsRunning}));const mainColumnClasses="column "+(!0===noInfluencersConfigured?"col-xs-12":"col-xs-10"),bounds=timefilter.getActiveBounds(),selectedJobIds=Array.isArray(selectedJobs)?selectedJobs.map(job=>job.id):[];return external_kbnSharedDeps_React_default.a.createElement(ExplorerPage,{jobSelectorProps:jobSelectorProps,noInfluencersConfigured:noInfluencersConfigured,influencers:influencers,filterActive:filterActive,filterPlaceHolder:filterPlaceHolder,filterIconTriggeredQuery:this.state.filterIconTriggeredQuery,indexPattern:indexPattern,queryString:queryString,updateLanguage:this.updateLanguage},external_kbnSharedDeps_React_default.a.createElement("div",{className:"results-container"},noInfluencersConfigured&&external_kbnSharedDeps_React_default.a.createElement("div",{className:"no-influencers-warning"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIconTip,{content:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.explorer.noConfiguredInfluencersTooltip",{defaultMessage:"The Top Influencers list is hidden because no influencers have been configured for the selected jobs."}),position:"right",type:"iInCircle"})),!1===noInfluencersConfigured&&external_kbnSharedDeps_React_default.a.createElement("div",{className:"column col-xs-2","data-test-subj":"mlAnomalyExplorerInfluencerList"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{className:"panel-title"},external_kbnSharedDeps_React_default.a.createElement("h2",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.explorer.topInfuencersTitle",defaultMessage:"Top influencers"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIconTip,{content:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.explorer.topInfluencersTooltip",defaultMessage:"View the relative impact of the top influencers in the selected time period and add them as filters on the results. Each influencer has a maximum anomaly score between 0-100 and a total anomaly score for that period."}),position:"right"}))),loading?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingContent,{lines:10}):external_kbnSharedDeps_React_default.a.createElement(InfluencersList,{influencers:influencers,influencerFilter:this.applyFilter})),external_kbnSharedDeps_React_default.a.createElement("div",{className:mainColumnClasses},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),stoppedPartitions&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{size:"s",title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.explorer.stoppedPartitionsExistCallout",defaultMessage:"There may be fewer results than there could have been because stop_on_warn is turned on. Both categorization and subsequent anomaly detection have stopped for some partitions in {jobsWithStoppedPartitions, plural, one {job} other {jobs}} [{stoppedPartitions}] where the categorization status has changed to warn.",values:{jobsWithStoppedPartitions:stoppedPartitions.length,stoppedPartitions:stoppedPartitions.join(", ")}})}),external_kbnSharedDeps_React_default.a.createElement(AnomalyTimeline,{explorerState:this.props.explorerState,setSelectedCells:this.props.setSelectedCells}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),void 0!==annotationsError&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{className:"panel-title","data-test-subj":"mlAnomalyExplorerAnnotationsPanel error"},external_kbnSharedDeps_React_default.a.createElement("h2",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.explorer.annotationsErrorTitle",defaultMessage:"Annotations"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPanel,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.explorer.annotationsErrorCallOutTitle",{defaultMessage:"An error occurred loading annotations:"}),color:"danger",iconType:"alert"},external_kbnSharedDeps_React_default.a.createElement("p",null,annotationsError))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"})),annotationsData.length>0&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPanel,{"data-test-subj":"mlAnomalyExplorerAnnotationsPanel loaded"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiAccordion,{id:this.htmlIdGen(),buttonContent:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{className:"panel-title"},external_kbnSharedDeps_React_default.a.createElement("h2",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.explorer.annotationsTitle",defaultMessage:"Annotations {badge}",values:{badge:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBadge,{color:"hollow"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.explorer.annotationsTitleTotalCount",defaultMessage:"Total: {count}",values:{count:annotationsData.length}}))}})))},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(annotations_table.a,{jobIds:selectedJobIds,annotations:annotationsData,aggregations:aggregations,drillDown:!0,numberBadge:!1})))),external_kbnSharedDeps_React_default.a.createElement(annotation_flyout.a,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"})),!1===loading&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPanel,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"row",gutterSize:"m",responsive:!1,alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{className:"panel-title"},external_kbnSharedDeps_React_default.a.createElement("h2",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.explorer.anomaliesTitle",defaultMessage:"Anomalies"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,style:{marginLeft:"auto",alignSelf:"baseline"}},external_kbnSharedDeps_React_default.a.createElement(AnomalyContextMenu,{selectedJobs:selectedJobs,selectedCells:selectedCells,bounds:bounds,interval:this.props.explorerState.swimlaneBucketInterval?this.props.explorerState.swimlaneBucketInterval.asSeconds():void 0,chartsCount:chartsData.seriesToPlot.length}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"row",gutterSize:"l",responsive:!0,className:"ml-anomalies-controls"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,style:{width:"170px"}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.explorer.severityThresholdLabel",{defaultMessage:"Severity threshold"})},external_kbnSharedDeps_React_default.a.createElement(select_severity.b,null))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,style:{width:"170px"}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{content:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.explorer.intervalTooltip",{defaultMessage:"Show only the highest severity anomaly for each interval (such as hour or day) or show all anomalies in the selected time period."})},external_kbnSharedDeps_React_default.a.createElement("span",null,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.explorer.intervalLabel",{defaultMessage:"Interval"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{type:"questionInCircle",color:"subdued"})))},external_kbnSharedDeps_React_default.a.createElement(SelectInterval,null))),chartsData.seriesToPlot.length>0&&void 0!==selectedCells&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,style:{alignSelf:"center"}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:"​"},external_kbnSharedDeps_React_default.a.createElement(CheckboxShowCharts,null)))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement("div",{className:"euiText explorer-charts"},showCharts&&external_kbnSharedDeps_React_default.a.createElement(explorer_charts_container.a,{...chartsData,severity:severity,timefilter:timefilter,mlUrlGenerator:mlUrlGenerator,timeBuckets:timeBuckets,onSelectEntity:this.applyFilter})),external_kbnSharedDeps_React_default.a.createElement(AnomaliesTable,{bounds:bounds,tableData:tableData,influencerFilter:this.applyFilter})))))}}const Explorer=Object(kibanaReact_public_.withKibana)(explorer_ExplorerUI);var constants_anomalies=__webpack_require__(1);function explorer_extends(){return(explorer_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const explorerRouteFactory=(navigateToPath,basePath)=>({path:"/explorer",render:(props,deps)=>external_kbnSharedDeps_React_default.a.createElement(explorer_PageWrapper,explorer_extends({},props,{deps:deps})),breadcrumbs:[getBreadcrumbWithUrlForApp("ML_BREADCRUMB",navigateToPath,basePath),getBreadcrumbWithUrlForApp("ANOMALY_DETECTION_BREADCRUMB",navigateToPath,basePath),{text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.anomalyDetection.anomalyExplorerLabel",{defaultMessage:"Anomaly Explorer"}),href:""}]}),explorer_PageWrapper=({deps:deps})=>{const{context:context,results:results}=useResolver(void 0,void 0,deps.config,{...basicResolvers(deps),jobs:job_service.a.loadJobsWrapper,jobsWithTimeRange:()=>ml_api_service.ml.jobs.jobsWithTimerange(Object(explorer_utils.e)())}),annotationUpdatesService=Object(external_kbnSharedDeps_React_.useMemo)(()=>new annotations_service.a,[]);return external_kbnSharedDeps_React_default.a.createElement(PageLoader,{context:context},external_kbnSharedDeps_React_default.a.createElement(ml_annotation_updates_context.a.Provider,{value:annotationUpdatesService},external_kbnSharedDeps_React_default.a.createElement(ExplorerUrlStateManager,{jobsWithTimeRange:results.jobsWithTimeRange.jobs})))},ExplorerUrlStateManager=({jobsWithTimeRange:jobsWithTimeRange})=>{var _globalState$time,_globalState$time2,_explorerState$swimla;const[explorerUrlState,setExplorerUrlState]=useExplorerUrlState(),[globalState,setGlobalState]=Object(url_state.c)("_g"),[lastRefresh,setLastRefresh]=Object(external_kbnSharedDeps_React_.useState)(0),[stoppedPartitions,setStoppedPartitions]=Object(external_kbnSharedDeps_React_.useState)(),[invalidTimeRangeError,setInValidTimeRangeError]=Object(external_kbnSharedDeps_React_.useState)(!1),timeBuckets=(()=>{const uiSettings=Object(contexts_kibana.h)();return Object(external_kbnSharedDeps_React_.useMemo)(()=>new time_buckets.a({"histogram:maxBars":uiSettings.get(common_.UI_SETTINGS.HISTOGRAM_MAX_BARS),"histogram:barTarget":uiSettings.get(common_.UI_SETTINGS.HISTOGRAM_BAR_TARGET),dateFormat:uiSettings.get("dateFormat"),"dateFormat:scaled":uiSettings.get("dateFormat:scaled")}),[uiSettings])})(),timefilter=Object(contexts_kibana.g)({timeRangeSelector:!0,autoRefreshSelector:!0}),{jobIds:jobIds}=(jobs=>{var _globalState$ml2,_globalState$ml4;const[globalState,setGlobalState]=Object(url_state.c)("_g"),{toasts:toastNotifications}=Object(contexts_kibana.f)(),tmpIds=Object(external_kbnSharedDeps_React_.useMemo)(()=>{var _globalState$ml;const ids=(null==globalState||null===(_globalState$ml=globalState.ml)||void 0===_globalState$ml?void 0:_globalState$ml.jobIds)||[];return("string"==typeof ids?[ids]:ids).map(id=>String(id))},[null==globalState||null===(_globalState$ml2=globalState.ml)||void 0===_globalState$ml2?void 0:_globalState$ml2.jobIds]),invalidIds=Object(external_kbnSharedDeps_React_.useMemo)(()=>function(jobs,ids){return ids.filter(id=>!1===jobs.some(job=>job.job_id===id)&&"*"!==id)}(jobs,tmpIds),[tmpIds]),validIds=Object(external_kbnSharedDeps_React_.useMemo)(()=>{const res=Object(external_kbnSharedDeps_Lodash_.difference)(tmpIds,invalidIds);return res.sort(),res},[tmpIds,invalidIds]),jobSelection=Object(external_kbnSharedDeps_React_.useMemo)(()=>{var _globalState$ml$group,_globalState$ml3;const selectedGroups=null!==(_globalState$ml$group=null==globalState||null===(_globalState$ml3=globalState.ml)||void 0===_globalState$ml3?void 0:_globalState$ml3.groups)&&void 0!==_globalState$ml$group?_globalState$ml$group:[];return{jobIds:validIds,selectedGroups:selectedGroups}},[validIds,null==globalState||null===(_globalState$ml4=globalState.ml)||void 0===_globalState$ml4?void 0:_globalState$ml4.groups]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{invalidIds.length>0&&toastNotifications.addWarning(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobSelect.requestedJobsDoesNotExistWarningMessage",{defaultMessage:"Requested\n{invalidIdsLength, plural, one {job {invalidIds} does not exist} other {jobs {invalidIds} do not exist}}",values:{invalidIdsLength:invalidIds.length,invalidIds:invalidIds.join()}}))},[invalidIds]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{if(0===validIds.length&&jobs.length>0){toastNotifications.addWarning(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobSelect.noJobsSelectedWarningMessage",{defaultMessage:"No jobs selected, auto selecting first job"}));const mlGlobalState=(null==globalState?void 0:globalState.ml)||{};mlGlobalState.jobIds=[jobs[0].job_id];const time=Object(job_select_service_utils.b)(jobs,mlGlobalState.jobIds);setGlobalState({ml:mlGlobalState,...void 0!==time?{time:time}:{}})}},[jobs,validIds,setGlobalState,null==globalState?void 0:globalState.ml]),jobSelection})(jobsWithTimeRange),selectedJobsRunning=jobsWithTimeRange.some(job=>jobIds.includes(job.id)&&!0===job.isRunning),explorerAppState=useObservable_default()(explorerService.appState$),explorerState=useObservable_default()(explorerService.state$),refresh=useRefresh();Object(external_kbnSharedDeps_React_.useEffect)(()=>{if(void 0!==refresh&&lastRefresh!==refresh.lastRefresh&&(setLastRefresh(null==refresh?void 0:refresh.lastRefresh),void 0!==refresh.timeRange)){const{start:start,end:end}=refresh.timeRange;setGlobalState("time",{from:start,to:end})}},[null==refresh?void 0:refresh.lastRefresh,lastRefresh,setLastRefresh,setGlobalState]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{void 0!==(null==globalState?void 0:globalState.time)&&("invalid"===globalState.time.mode&&setInValidTimeRangeError(!0),timefilter.setTime({from:globalState.time.from,to:globalState.time.to}))},[null==globalState||null===(_globalState$time=globalState.time)||void 0===_globalState$time?void 0:_globalState$time.from,null==globalState||null===(_globalState$time2=globalState.time)||void 0===_globalState$time2?void 0:_globalState$time2.to]);const getJobsWithStoppedPartitions=Object(external_kbnSharedDeps_React_.useCallback)(async selectedJobIds=>{try{const fetchedStoppedPartitions=await ml_api_service.ml.results.getCategoryStoppedPartitions(selectedJobIds,constants_anomalies.d);fetchedStoppedPartitions&&Array.isArray(fetchedStoppedPartitions.jobs)&&fetchedStoppedPartitions.jobs.length>0?setStoppedPartitions(fetchedStoppedPartitions.jobs):setStoppedPartitions(void 0)}catch(error){console.error(error)}},[]);Object(external_kbnSharedDeps_React_.useEffect)(()=>{jobIds.length>0?(explorerService.updateJobSelection(jobIds),getJobsWithStoppedPartitions(jobIds)):explorerService.clearJobs()},[JSON.stringify(jobIds)]),Object(external_kbnSharedDeps_React_.useEffect)(()=>()=>{explorerService.clearExplorerData()},[]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{var _explorerUrlState$mlE;const filterData=null==explorerUrlState?void 0:explorerUrlState.mlExplorerFilter;void 0!==filterData&&explorerService.setFilterData(filterData);const{viewByFieldName:viewByFieldName,viewByFromPage:viewByFromPage,viewByPerPage:viewByPerPage}=null!==(_explorerUrlState$mlE=null==explorerUrlState?void 0:explorerUrlState.mlExplorerSwimlane)&&void 0!==_explorerUrlState$mlE?_explorerUrlState$mlE:{};void 0!==viewByFieldName&&explorerService.setViewBySwimlaneFieldName(viewByFieldName),void 0!==viewByPerPage&&explorerService.setViewByPerPage(viewByPerPage),void 0!==viewByFromPage&&explorerService.setViewByFromPage(viewByFromPage)},[]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{var _explorerUrlState$mlE2,_explorerAppState$mlE;const replaceState=void 0===(null==explorerUrlState||null===(_explorerUrlState$mlE2=explorerUrlState.mlExplorerSwimlane)||void 0===_explorerUrlState$mlE2?void 0:_explorerUrlState$mlE2.viewByFieldName);void 0!==(null==explorerAppState||null===(_explorerAppState$mlE=explorerAppState.mlExplorerSwimlane)||void 0===_explorerAppState$mlE?void 0:_explorerAppState$mlE.viewByFieldName)&&setExplorerUrlState(explorerAppState,replaceState)},[explorerAppState]);const[explorerData,loadExplorerData]=useExplorerData();Object(external_kbnSharedDeps_React_.useEffect)(()=>{void 0!==explorerData&&Object.keys(explorerData).length>0&&explorerService.setExplorerData(explorerData)},[explorerData]);const[showCharts]=useShowCharts(),[tableInterval]=useTableInterval(),[tableSeverity]=Object(select_severity.e)(),[selectedCells,setSelectedCells]=((appState,setAppState,bucketIntervalInSeconds)=>{var _timeBounds$min,_timeBounds$max;const timeBounds=Object(contexts_kibana.g)().getBounds(),selectedCells=Object(external_kbnSharedDeps_React_.useMemo)(()=>{var _appState$mlExplorerS,_appState$mlExplorerS2,_appState$mlExplorerS3;if(null==appState||null===(_appState$mlExplorerS=appState.mlExplorerSwimlane)||void 0===_appState$mlExplorerS||!_appState$mlExplorerS.selectedType)return;let times=null!==(_appState$mlExplorerS2=appState.mlExplorerSwimlane.selectedTimes)&&void 0!==_appState$mlExplorerS2?_appState$mlExplorerS2:appState.mlExplorerSwimlane.selectedTime;"number"==typeof times&&(times=[times,times+bucketIntervalInSeconds]);let lanes=null!==(_appState$mlExplorerS3=appState.mlExplorerSwimlane.selectedLanes)&&void 0!==_appState$mlExplorerS3?_appState$mlExplorerS3:appState.mlExplorerSwimlane.selectedLane;return"string"==typeof lanes&&(lanes=[lanes]),{type:appState.mlExplorerSwimlane.selectedType,lanes:lanes,times:times,showTopFieldValues:appState.mlExplorerSwimlane.showTopFieldValues,viewByFieldName:appState.mlExplorerSwimlane.viewByFieldName}},[JSON.stringify(null==appState?void 0:appState.mlExplorerSwimlane),bucketIntervalInSeconds]),setSelectedCells=Object(external_kbnSharedDeps_React_.useCallback)(swimlaneSelectedCells=>{const mlExplorerSwimlane={...appState.mlExplorerSwimlane};if(void 0!==swimlaneSelectedCells){swimlaneSelectedCells.showTopFieldValues=!1;const currentSwimlaneType=null==selectedCells?void 0:selectedCells.type,currentShowTopFieldValues=null==selectedCells?void 0:selectedCells.showTopFieldValues,newSwimlaneType=null==swimlaneSelectedCells?void 0:swimlaneSelectedCells.type;(currentSwimlaneType===explorer_constants.h.OVERALL&&newSwimlaneType===explorer_constants.h.VIEW_BY||newSwimlaneType===explorer_constants.h.OVERALL||!0===currentShowTopFieldValues)&&(swimlaneSelectedCells.showTopFieldValues=!0),mlExplorerSwimlane.selectedType=swimlaneSelectedCells.type,mlExplorerSwimlane.selectedLanes=swimlaneSelectedCells.lanes,mlExplorerSwimlane.selectedTimes=swimlaneSelectedCells.times,mlExplorerSwimlane.showTopFieldValues=swimlaneSelectedCells.showTopFieldValues,setAppState({mlExplorerSwimlane:mlExplorerSwimlane})}else delete mlExplorerSwimlane.selectedType,delete mlExplorerSwimlane.selectedLanes,delete mlExplorerSwimlane.selectedTimes,delete mlExplorerSwimlane.showTopFieldValues,setAppState({mlExplorerSwimlane:mlExplorerSwimlane})},[null==appState?void 0:appState.mlExplorerSwimlane,selectedCells,setAppState]);return Object(external_kbnSharedDeps_React_.useEffect)((function(){if(void 0===(null==selectedCells?void 0:selectedCells.times)||void 0===bucketIntervalInSeconds)return;const[selectedFrom,selectedTo]=selectedCells.times,rangeFrom=timeBounds.min.unix()-bucketIntervalInSeconds,rangeTo=timeBounds.max.unix()+bucketIntervalInSeconds,resultFrom=Math.max(selectedFrom,rangeFrom),resultTo=Math.min(selectedTo,rangeTo);rangeFrom>resultTo||rangeTo<resultFrom?setSelectedCells():selectedFrom===resultFrom&&selectedTo===resultTo||resultFrom===rangeFrom&&resultTo===rangeTo||setSelectedCells({...selectedCells,times:[resultFrom,resultTo]})}),[null===(_timeBounds$min=timeBounds.min)||void 0===_timeBounds$min?void 0:_timeBounds$min.unix(),null===(_timeBounds$max=timeBounds.max)||void 0===_timeBounds$max?void 0:_timeBounds$max.unix(),selectedCells,bucketIntervalInSeconds]),[selectedCells,setSelectedCells]})(explorerUrlState,setExplorerUrlState,null==explorerState||null===(_explorerState$swimla=explorerState.swimlaneBucketInterval)||void 0===_explorerState$swimla?void 0:_explorerState$swimla.asSeconds());Object(external_kbnSharedDeps_React_.useEffect)(()=>{explorerService.setSelectedCells(selectedCells)},[JSON.stringify(selectedCells)]);const loadExplorerDataConfig=void 0!==explorerState?{lastRefresh:lastRefresh,influencersFilterQuery:explorerState.influencersFilterQuery,noInfluencersConfigured:explorerState.noInfluencersConfigured,selectedCells:selectedCells,selectedJobs:explorerState.selectedJobs,swimlaneBucketInterval:explorerState.swimlaneBucketInterval,tableInterval:tableInterval.val,tableSeverity:tableSeverity.val,viewBySwimlaneFieldName:explorerState.viewBySwimlaneFieldName,swimlaneContainerWidth:explorerState.swimlaneContainerWidth,viewByPerPage:explorerState.viewByPerPage,viewByFromPage:explorerState.viewByFromPage}:void 0;return Object(external_kbnSharedDeps_React_.useEffect)(()=>{const swimlaneLimit=!Object(swimlane_container.c)(null==explorerState?void 0:explorerState.viewBySwimlaneData)||null!=selectedCells&&selectedCells.showTopFieldValues||null==explorerState?void 0:explorerState.viewBySwimlaneData.cardinality;explorerState&&explorerState.swimlaneContainerWidth>0&&loadExplorerData({...loadExplorerDataConfig,swimlaneLimit:swimlaneLimit})},[JSON.stringify(loadExplorerDataConfig),null==selectedCells?void 0:selectedCells.showTopFieldValues]),void 0===explorerState||void 0===refresh||void 0===showCharts?null:external_kbnSharedDeps_React_default.a.createElement("div",{className:"ml-explorer"},external_kbnSharedDeps_React_default.a.createElement(Explorer,{explorerState:explorerState,setSelectedCells:setSelectedCells,showCharts:showCharts,severity:tableSeverity.val,stoppedPartitions:stoppedPartitions,invalidTimeRangeError:invalidTimeRangeError,selectedJobsRunning:selectedJobsRunning,timeBuckets:timeBuckets,timefilter:timefilter}))},access_denied_page_Page=()=>{const{services:{docLinks:docLinks}}=Object(contexts_kibana.b)(),helpLink=docLinks.links.ml.guide;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(navigation_menu.a,{tabId:"access-denied"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPage,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageBody,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageContentHeader,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageContentHeaderSection,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,null,external_kbnSharedDeps_React_default.a.createElement("h1",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.management.jobsList.accessDeniedTitle",defaultMessage:"Access denied"}))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageContentBody,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.accessDenied.label",{defaultMessage:"Insufficient permissions"}),color:"danger",iconType:"cross"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"s"},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.accessDenied.description",defaultMessage:"You don’t have permission to access the ML plugin"}))))))),external_kbnSharedDeps_React_default.a.createElement(help_menu.a,{docLink:helpLink}))};function access_denied_extends(){return(access_denied_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const access_denied_breadcrumbs=[{text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.accessDeniedLabel",{defaultMessage:"Access denied"}),href:""}],accessDeniedRouteFactory=()=>({path:"/access-denied",render:(props,deps)=>external_kbnSharedDeps_React_default.a.createElement(access_denied_PageWrapper,access_denied_extends({},props,{deps:deps})),breadcrumbs:access_denied_breadcrumbs}),access_denied_PageWrapper=({deps:deps})=>{const{context:context}=useResolver(void 0,void 0,deps.config,{});return external_kbnSharedDeps_React_default.a.createElement(PageLoader,{context:context},external_kbnSharedDeps_React_default.a.createElement(access_denied_page_Page,null))},PageLoader=({context:context,children:children})=>null===context?null:external_kbnSharedDeps_React_default.a.createElement(ml.a.Provider,{value:context},children),LegacyHashUrlRedirect=({children:children})=>{const history=Object(external_kbnSharedDeps_ReactRouterDom_.useHistory)(),location=Object(external_kbnSharedDeps_ReactRouterDom_.useLocation)();return Object(external_kbnSharedDeps_React_.useEffect)(()=>{location.hash.startsWith("#/")&&history.push(location.hash.replace("#",""))},[location.hash]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,children)},MlRoutes=({pageDeps:pageDeps})=>{const navigateToPath=Object(contexts_kibana.e)(),{services:{http:{basePath:basePath}}}=Object(contexts_kibana.b)();return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,Object.entries(routes_namespaceObject).map(([name,routeFactory])=>{const route=routeFactory(navigateToPath,basePath.get());return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Route,{key:name,path:route.path,exact:!0,render:props=>(window.setTimeout(()=>{pageDeps.setBreadcrumbs(route.breadcrumbs)}),route.render(props,pageDeps))})}))},MlRouter=({pageDeps:pageDeps})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ReactRouterDom_.Router,{history:pageDeps.history},external_kbnSharedDeps_React_default.a.createElement(LegacyHashUrlRedirect,null,external_kbnSharedDeps_React_default.a.createElement(url_state.a,null,external_kbnSharedDeps_React_default.a.createElement("div",{className:"ml-app","data-test-subj":"mlApp"},external_kbnSharedDeps_React_default.a.createElement(MlRoutes,{pageDeps:pageDeps})))));var http_service=__webpack_require__(111);const localStorage=new public_.Storage(window.localStorage);function getMlGlobalServices(httpStart){const httpService=new http_service.a(httpStart);return{httpService:httpService,mlApiServices:Object(ml_api_service.mlApiServicesProvider)(httpService)}}const App=({coreStart:coreStart,deps:deps,appMountParams:appMountParams})=>{const pageDeps={history:appMountParams.history,indexPatterns:deps.data.indexPatterns,config:coreStart.uiSettings,setBreadcrumbs:coreStart.chrome.setBreadcrumbs,redirectToMlAccessDeniedPage:async()=>{const accessDeniedPageUrl=await deps.share.urlGenerators.getUrlGenerator(ml_url_generator.a).createUrl({page:ml_url_generator.b.ACCESS_DENIED});await coreStart.application.navigateToUrl(accessDeniedPageUrl)}},services={appName:"ML",kibanaVersion:deps.kibanaVersion,share:deps.share,data:deps.data,security:deps.security,licenseManagement:deps.licenseManagement,lens:deps.lens,storage:localStorage,embeddable:deps.embeddable,maps:deps.maps,triggersActionsUi:deps.triggersActionsUi,fileDataVisualizer:deps.fileDataVisualizer,...coreStart},I18nContext=coreStart.i18n.Context;return external_kbnSharedDeps_React_default.a.createElement(kibanaReact_public_.RedirectAppLinks,{application:coreStart.application},external_kbnSharedDeps_React_default.a.createElement(I18nContext,null,external_kbnSharedDeps_React_default.a.createElement(kibanaReact_public_.KibanaContextProvider,{services:{...services,mlServices:getMlGlobalServices(coreStart.http)}},external_kbnSharedDeps_React_default.a.createElement(MlRouter,{pageDeps:pageDeps}))))},renderApp=(coreStart,deps,appMountParams)=>{Object(dependency_cache.l)({indexPatterns:deps.data.indexPatterns,timefilter:deps.data.query.timefilter,fieldFormats:deps.data.fieldFormats,autocomplete:deps.data.autocomplete,config:coreStart.uiSettings,chrome:coreStart.chrome,docLinks:coreStart.docLinks,toastNotifications:coreStart.notifications.toasts,overlays:coreStart.overlays,recentlyAccessed:coreStart.chrome.recentlyAccessed,basePath:coreStart.http.basePath,savedObjectsClient:coreStart.savedObjects.client,application:coreStart.application,http:coreStart.http,security:deps.security,urlGenerators:deps.share.urlGenerators,maps:deps.maps,fileDataVisualizer:deps.fileDataVisualizer}),appMountParams.onAppLeave(actions=>actions.default());const mlLicense=Object(license.e)(deps.licensing,[()=>external_kbnSharedDeps_ReactDom_default.a.render(external_kbnSharedDeps_React_default.a.createElement(App,{coreStart:coreStart,deps:deps,appMountParams:appMountParams}),appMountParams.element)]);return()=>{mlLicense.unsubscribe(),Object(dependency_cache.a)(),external_kbnSharedDeps_ReactDom_default.a.unmountComponentAtNode(appMountParams.element)}}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return getTaskStateBadge})),__webpack_require__.d(__webpack_exports__,"a",(function(){return getJobTypeBadge})),__webpack_require__.d(__webpack_exports__,"c",(function(){return progressColumn})),__webpack_require__.d(__webpack_exports__,"d",(function(){return useColumns}));var external_kbnSharedDeps_React_=__webpack_require__(14),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),external_kbnSharedDeps_KbnI18n_=__webpack_require__(2),external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(40),external_kbnSharedDeps_ElasticEui_=__webpack_require__(39),common=__webpack_require__(71),analytics_list_common=__webpack_require__(93),check_capabilities=__webpack_require__(68),delete_job_check_modal=__webpack_require__(295),action_clone=__webpack_require__(423),action_delete=__webpack_require__(415),kibana=__webpack_require__(63),ml_api_service=__webpack_require__(64),toast_notification_service=__webpack_require__(73),validators=__webpack_require__(17),analytics=__webpack_require__(67);let mmLValidator;const EditActionFlyout=({closeFlyout:closeFlyout,item:item})=>{const{id:jobId,config:config}=item,{state:state}=item.stats,initialAllowLazyStart=void 0!==config.allow_lazy_start?String(config.allow_lazy_start):"",[allowLazyStart,setAllowLazyStart]=Object(external_kbnSharedDeps_React_.useState)(initialAllowLazyStart),[description,setDescription]=Object(external_kbnSharedDeps_React_.useState)(config.description||""),[modelMemoryLimit,setModelMemoryLimit]=Object(external_kbnSharedDeps_React_.useState)(config.model_memory_limit),[mmlValidationError,setMmlValidationError]=Object(external_kbnSharedDeps_React_.useState)(),[maxNumThreads,setMaxNumThreads]=Object(external_kbnSharedDeps_React_.useState)(config.max_num_threads),{services:{notifications:notifications}}=Object(kibana.b)(),{refresh:refresh}=Object(analytics.J)(),toastNotificationService=Object(toast_notification_service.c)(),updateButtonDisabled=void 0!==mmlValidationError||0===maxNumThreads;Object(external_kbnSharedDeps_React_.useEffect)(()=>{if(void 0===mmLValidator&&(mmLValidator=Object(validators.c)()),""!==modelMemoryLimit){const validationResult=mmLValidator(modelMemoryLimit);null!==validationResult&&validationResult.invalidUnits?setMmlValidationError(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.modelMemoryUnitsInvalidError",{defaultMessage:"Model memory limit data unit unrecognized. It must be {str}",values:{str:validationResult.invalidUnits.allowedUnits}})):setMmlValidationError(void 0)}else setMmlValidationError(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.modelMemoryEmptyError",{defaultMessage:"Model memory limit must not be empty"}))},[modelMemoryLimit]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiOverlayMask,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyout,{onClose:closeFlyout,hideCloseButton:!0,"aria-labelledby":"analyticsEditFlyoutTitle","data-test-subj":"mlAnalyticsEditFlyout"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyoutHeader,{hasBorder:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"m"},external_kbnSharedDeps_React_default.a.createElement("h2",{id:"analyticsEditFlyoutTitle"},external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.editFlyoutTitle",{defaultMessage:"Edit {jobId}",values:{jobId:jobId}})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyoutBody,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiForm,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.editFlyout.allowLazyStartLabel",{defaultMessage:"Allow lazy start"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSelect,{"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.editFlyout.allowLazyStartAriaLabel",{defaultMessage:"Update allow lazy start."}),"data-test-subj":"mlAnalyticsEditFlyoutAllowLazyStartInput",options:[{value:"true",text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.editFlyout.allowLazyStartTrueValue",{defaultMessage:"True"})},{value:"false",text:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.editFlyout.allowLazyStartFalseValue",{defaultMessage:"False"})}],value:allowLazyStart,onChange:e=>setAllowLazyStart(e.target.value)})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.editFlyout.descriptionLabel",{defaultMessage:"Description"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldText,{"data-test-subj":"mlAnalyticsEditFlyoutDescriptionInput",value:description,onChange:e=>setDescription(e.target.value),"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.editFlyout.descriptionAriaLabel",{defaultMessage:"Update the job description."})})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{helpText:state!==analytics_list_common.b.STOPPED&&external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.editFlyout.modelMemoryHelpText",{defaultMessage:"Model memory limit cannot be edited until the job has stopped."}),label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.editFlyout.modelMemoryLimitLabel",{defaultMessage:"Model memory limit"}),isInvalid:void 0!==mmlValidationError,error:mmlValidationError},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldText,{"data-test-subj":"mlAnalyticsEditFlyoutmodelMemoryLimitInput",isInvalid:void 0!==mmlValidationError,readOnly:state!==analytics_list_common.b.STOPPED,value:modelMemoryLimit,onChange:e=>setModelMemoryLimit(e.target.value),"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.editFlyout.modelMemoryLimitAriaLabel",{defaultMessage:"Update the model memory limit."})})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{helpText:state!==analytics_list_common.b.STOPPED&&external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.editFlyout.maxNumThreadsHelpText",{defaultMessage:"Maximum number of threads cannot be edited until the job has stopped."}),label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.editFlyout.maxNumThreadsLabel",{defaultMessage:"Maximum number of threads"}),isInvalid:0===maxNumThreads,error:0===maxNumThreads&&external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.editFlyout.maxNumThreadsError",{defaultMessage:"The minimum value is 1."})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldNumber,{"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.editFlyout.maxNumThreadsAriaLabel",{defaultMessage:"Update the maximum number of threads to be used by the analysis."}),"data-test-subj":"mlAnalyticsEditFlyoutMaxNumThreadsLimitInput",onChange:e=>setMaxNumThreads(""===e.target.value?void 0:+e.target.value),step:1,min:1,readOnly:state!==analytics_list_common.b.STOPPED,value:maxNumThreads})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyoutFooter,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{iconType:"cross",onClick:closeFlyout,flush:"left"},external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.editFlyoutCancelButtonText",{defaultMessage:"Cancel"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{"data-test-subj":"mlAnalyticsEditFlyoutUpdateButton",onClick:async()=>{const updateConfig=Object.assign({allow_lazy_start:allowLazyStart,description:description},modelMemoryLimit&&{model_memory_limit:modelMemoryLimit},maxNumThreads&&{max_num_threads:maxNumThreads});try{await ml_api_service.ml.dataFrameAnalytics.updateDataFrameAnalytics(jobId,updateConfig),notifications.toasts.addSuccess(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.editFlyoutSuccessMessage",{defaultMessage:"Analytics job {jobId} has been updated.",values:{jobId:jobId}})),refresh(),closeFlyout()}catch(e){console.error(e),toastNotificationService.displayErrorToast(e,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.editFlyoutErrorMessage",{defaultMessage:"Could not save changes to analytics job {jobId}",values:{jobId:jobId}}))}},fill:!0,isDisabled:updateButtonDisabled},external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.editFlyoutUpdateButtonText",{defaultMessage:"Update"})))))))},editActionNameText=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.editActionNameText",{defaultMessage:"Edit"}),EditActionName=({isDisabled:isDisabled})=>isDisabled?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{position:"top",content:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.editActionPermissionTooltip",{defaultMessage:"You do not have permission to edit analytics jobs."})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,editActionNameText)):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,editActionNameText);var analytics_service=__webpack_require__(182);const startActionNameText=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.startActionNameText",{defaultMessage:"Start"}),StartActionName=({canStartStopDataFrameAnalytics:canStartStopDataFrameAnalytics,isDisabled:isDisabled,item:item})=>isDisabled?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{position:"top",content:canStartStopDataFrameAnalytics?external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.completeBatchAnalyticsToolTip",{defaultMessage:"{analyticsId} is a completed analytics job and cannot be restarted.",values:{analyticsId:item.config.id}}):Object(check_capabilities.f)("canStartStopDataFrameAnalytics")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,startActionNameText)):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,startActionNameText),StartActionModal=({closeModal:closeModal,item:item,startAndCloseModal:startAndCloseModal})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,void 0!==item&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiConfirmModal,{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.startModalTitle",{defaultMessage:"Start {analyticsId}?",values:{analyticsId:item.config.id}}),onCancel:closeModal,onConfirm:startAndCloseModal,cancelButtonText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.startModalCancelButton",{defaultMessage:"Cancel"}),confirmButtonText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.startModalStartButton",{defaultMessage:"Start"}),defaultFocusedButton:external_kbnSharedDeps_ElasticEui_.EUI_MODAL_CONFIRM_BUTTON,buttonColor:"primary"},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.startModalBody",{defaultMessage:"A data frame analytics job increases search and indexing load in your cluster. If excessive load occurs, stop the job."})))),stopActionNameText=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.stopActionNameText",{defaultMessage:"Stop"}),StopActionName=({isDisabled:isDisabled})=>isDisabled?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{position:"top",content:Object(check_capabilities.f)("canStartStopDataFrameAnalytics")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,stopActionNameText)):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,stopActionNameText),StopActionModal=({closeModal:closeModal,item:item,forceStopAndCloseModal:forceStopAndCloseModal})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,void 0!==item&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiConfirmModal,{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.forceStopModalTitle",{defaultMessage:"Force this job to stop?"}),onCancel:closeModal,onConfirm:forceStopAndCloseModal,cancelButtonText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.forceStopModalCancelButton",{defaultMessage:"Cancel"}),confirmButtonText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.forceStopModalStartButton",{defaultMessage:"Force stop"}),defaultFocusedButton:external_kbnSharedDeps_ElasticEui_.EUI_MODAL_CONFIRM_BUTTON,buttonColor:"primary"},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataframe.analyticsList.forceStopModalBody",defaultMessage:"{analyticsId} is in a failed state. You must stop the job and fix the failure.",values:{analyticsId:item.config.id}}))));var get_view_link_status=__webpack_require__(199);const viewActionButtonText=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.viewActionName",{defaultMessage:"View"}),ViewButton=({item:item})=>{const{disabled:disabled,tooltipContent:tooltipContent}=Object(get_view_link_status.a)(item);return disabled?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{position:"top",content:tooltipContent},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,viewActionButtonText)):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,viewActionButtonText)};var ml_url_generator=__webpack_require__(0);const useViewAction=()=>{const mlUrlGenerator=Object(kibana.d)(),navigateToPath=Object(kibana.e)(),clickHandler=Object(external_kbnSharedDeps_React_.useCallback)(item=>{const analysisType=Object(analytics.r)(item.config.analysis);(async(jobId,analysisType)=>{const path=await mlUrlGenerator.createUrl({page:ml_url_generator.b.DATA_FRAME_ANALYTICS_EXPLORATION,pageState:{jobId:jobId,analysisType:analysisType}});await navigateToPath(path,!1)})(item.id,analysisType)},[]);return{action:Object(external_kbnSharedDeps_React_.useMemo)(()=>({isPrimary:!0,name:item=>external_kbnSharedDeps_React_default.a.createElement(ViewButton,{item:item}),enabled:item=>!Object(get_view_link_status.a)(item).disabled,description:viewActionButtonText,icon:"visTable",type:"icon",onClick:clickHandler,"data-test-subj":"mlAnalyticsJobViewButton"}),[clickHandler])}},mapActionButtonText=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.mapActionName",{defaultMessage:"Map"}),MapButton=({item:item})=>{if(!Object(analytics.D)(item.config.analysis)&&!Object(analytics.C)(item.config.analysis)&&!Object(analytics.A)(item.config.analysis)){const toolTipContent=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.mapActionDisabledTooltipContent",{defaultMessage:"Unknown analysis type."});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{position:"top",content:toolTipContent},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,mapActionButtonText))}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,mapActionButtonText)},useActions=isManagementTable=>{const canCreateDataFrameAnalytics=Object(check_capabilities.e)("canCreateDataFrameAnalytics"),canDeleteDataFrameAnalytics=Object(check_capabilities.e)("canDeleteDataFrameAnalytics"),canStartStopDataFrameAnalytics=Object(check_capabilities.e)("canStartStopDataFrameAnalytics"),viewAction=useViewAction(),mapAction=(()=>{const mlUrlGenerator=Object(kibana.d)(),navigateToPath=Object(kibana.e)(),clickHandler=Object(external_kbnSharedDeps_React_.useCallback)(async item=>{const path=await mlUrlGenerator.createUrl({page:ml_url_generator.b.DATA_FRAME_ANALYTICS_MAP,pageState:{jobId:item.id}});await navigateToPath(path,!1)},[]);return{action:Object(external_kbnSharedDeps_React_.useMemo)(()=>({isPrimary:!0,name:item=>external_kbnSharedDeps_React_default.a.createElement(MapButton,{item:item}),enabled:item=>!Object(get_view_link_status.a)(item).disabled,description:mapActionButtonText,icon:"graphApp",type:"icon",onClick:clickHandler,"data-test-subj":"mlAnalyticsJobMapButton"}),[clickHandler])}})(),cloneAction=Object(action_clone.c)(canCreateDataFrameAnalytics),deleteAction=Object(action_delete.b)(canDeleteDataFrameAnalytics),editAction=(canStartStopDataFrameAnalytics=>{const[item,setItem]=Object(external_kbnSharedDeps_React_.useState)(),[isFlyoutVisible,setIsFlyoutVisible]=Object(external_kbnSharedDeps_React_.useState)(!1),openFlyout=newItem=>{setItem(newItem),setIsFlyoutVisible(!0)};return{action:Object(external_kbnSharedDeps_React_.useMemo)(()=>({name:()=>external_kbnSharedDeps_React_default.a.createElement(EditActionName,{isDisabled:!canStartStopDataFrameAnalytics}),enabled:()=>canStartStopDataFrameAnalytics,description:editActionNameText,icon:"pencil",type:"icon",onClick:i=>openFlyout(i),"data-test-subj":"mlAnalyticsJobEditButton"}),[canStartStopDataFrameAnalytics]),isFlyoutVisible:isFlyoutVisible,item:item,closeFlyout:()=>setIsFlyoutVisible(!1),openFlyout:openFlyout}})(canStartStopDataFrameAnalytics),startAction=(canStartStopDataFrameAnalytics=>{const[isModalVisible,setModalVisible]=Object(external_kbnSharedDeps_React_.useState)(!1),[item,setItem]=Object(external_kbnSharedDeps_React_.useState)(),toastNotificationService=Object(toast_notification_service.c)(),openModal=newItem=>{setItem(newItem),setModalVisible(!0)},startButtonEnabled=i=>{if(!Object(analytics_list_common.g)(i.stats.state)){const completeAnalytics=Object(analytics_list_common.e)(i.stats);return canStartStopDataFrameAnalytics&&!completeAnalytics}return canStartStopDataFrameAnalytics};return{action:Object(external_kbnSharedDeps_React_.useMemo)(()=>({name:i=>external_kbnSharedDeps_React_default.a.createElement(StartActionName,{isDisabled:!startButtonEnabled(i),item:i,canStartStopDataFrameAnalytics:canStartStopDataFrameAnalytics}),available:i=>!Object(analytics_list_common.g)(i.stats.state)&&!Object(analytics_list_common.f)(i.stats.state),enabled:startButtonEnabled,description:startActionNameText,icon:"play",type:"icon",onClick:openModal,"data-test-subj":"mlAnalyticsJobStartButton"}),[]),closeModal:()=>setModalVisible(!1),isModalVisible:isModalVisible,item:item,openModal:openModal,startAndCloseModal:()=>{void 0!==item&&(setModalVisible(!1),Object(analytics_service.e)(item,toastNotificationService))}}})(canStartStopDataFrameAnalytics),stopAction=(canStartStopDataFrameAnalytics=>{const[isModalVisible,setModalVisible]=Object(external_kbnSharedDeps_React_.useState)(!1),[item,setItem]=Object(external_kbnSharedDeps_React_.useState)(),openModal=newItem=>{setItem(newItem),setModalVisible(!0)},clickHandler=Object(external_kbnSharedDeps_React_.useCallback)(i=>{canStartStopDataFrameAnalytics&&(Object(analytics_list_common.f)(i.stats.state)?openModal(i):Object(analytics_service.f)(i))},[analytics_service.f]);return{action:Object(external_kbnSharedDeps_React_.useMemo)(()=>({name:()=>external_kbnSharedDeps_React_default.a.createElement(StopActionName,{isDisabled:!canStartStopDataFrameAnalytics}),available:i=>Object(analytics_list_common.g)(i.stats.state)||Object(analytics_list_common.f)(i.stats.state),enabled:()=>canStartStopDataFrameAnalytics,description:stopActionNameText,icon:"stop",type:"icon",onClick:clickHandler,"data-test-subj":"mlAnalyticsJobStopButton"}),[clickHandler]),closeModal:()=>setModalVisible(!1),isModalVisible:isModalVisible,item:item,openModal:openModal,forceStopAndCloseModal:()=>{void 0!==item&&(setModalVisible(!1),Object(analytics_service.f)(item))}}})(canStartStopDataFrameAnalytics),{refresh:refresh}=Object(analytics.J)();let modals=null;const actions=[viewAction.action,mapAction.action];var _deleteAction$item;!1===isManagementTable&&(modals=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,startAction.isModalVisible&&external_kbnSharedDeps_React_default.a.createElement(StartActionModal,startAction),stopAction.isModalVisible&&external_kbnSharedDeps_React_default.a.createElement(StopActionModal,stopAction),deleteAction.isDeleteJobCheckModalVisible&&(null==deleteAction||null===(_deleteAction$item=deleteAction.item)||void 0===_deleteAction$item?void 0:_deleteAction$item.config)&&external_kbnSharedDeps_React_default.a.createElement(delete_job_check_modal.a,{onCloseCallback:deleteAction.closeDeleteJobCheckModal,canDeleteCallback:()=>{deleteAction.openModal(deleteAction.item),deleteAction.closeDeleteJobCheckModal()},refreshJobsCallback:refresh,jobType:deleteAction.jobType,jobIds:[deleteAction.item.config.id]}),deleteAction.isModalVisible&&external_kbnSharedDeps_React_default.a.createElement(action_delete.a,deleteAction),(editAction=>!0===editAction.isFlyoutVisible&&void 0!==editAction.item)(editAction)&&external_kbnSharedDeps_React_default.a.createElement(EditActionFlyout,editAction)),actions.push(startAction.action,stopAction.action,editAction.action,cloneAction.action,deleteAction.action));return{actions:actions,modals:modals}};var TASK_STATE_COLOR,job_spaces_list=__webpack_require__(418);!function(TASK_STATE_COLOR){TASK_STATE_COLOR.analyzing="primary",TASK_STATE_COLOR.failed="danger",TASK_STATE_COLOR.reindexing="primary",TASK_STATE_COLOR.started="primary",TASK_STATE_COLOR.starting="primary",TASK_STATE_COLOR.stopped="hollow"}(TASK_STATE_COLOR||(TASK_STATE_COLOR={}));const getTaskStateBadge=(state,failureReason)=>{const color=TASK_STATE_COLOR[state];return Object(analytics_list_common.f)(state)&&void 0!==failureReason?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{content:failureReason},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBadge,{className:"mlTaskStateBadge",color:color},state)):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBadge,{className:"mlTaskStateBadge",color:color},state)},getJobTypeBadge=jobType=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBadge,{className:"mlTaskStateBadge",color:"hollow"},jobType),progressColumn={name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.progress",{defaultMessage:"Progress"}),truncateText:!0,render(item){const{currentPhase:currentPhase,progress:progress,totalPhases:totalPhases}=Object(analytics_list_common.d)(item.stats);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",gutterSize:"xs"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{style:{width:"60px"},grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs"},"Phase ",currentPhase,"/",totalPhases)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{style:{width:"40px"},grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{content:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.progressOfPhase",{defaultMessage:"Progress of phase {currentPhase}: {progress}%",values:{currentPhase:currentPhase,progress:progress}})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiProgress,{value:progress,max:100,color:"primary",size:"m","data-test-subj":"mlAnalyticsTableProgress"})))),!1)},width:"130px","data-test-subj":"mlAnalyticsTableColumnProgress"},DFAnalyticsJobIdLink=({jobId:jobId})=>{const href=Object(kibana.c)({page:ml_url_generator.b.DATA_FRAME_ANALYTICS_JOBS_MANAGE,pageState:{jobId:jobId}});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{href:href},jobId)},useColumns=(expandedRowItemIds,setExpandedRowItemIds,isManagementTable=!1,isMlEnabledInSpace=!0,spacesApi,refresh=(()=>{}))=>{const{actions:actions,modals:modals}=useActions(isManagementTable);const columns=[{name:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiScreenReaderOnly,null,external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataframe.analyticsList.showDetailsColumn.screenReaderDescription",defaultMessage:"This column contains clickable controls for showing more details on each job"}))),align:external_kbnSharedDeps_ElasticEui_.RIGHT_ALIGNMENT,width:"40px",isExpander:!0,render:item=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{onClick:()=>function(item){const index=expandedRowItemIds.indexOf(item.config.id);-1!==index?(expandedRowItemIds.splice(index,1),setExpandedRowItemIds([...expandedRowItemIds])):expandedRowItemIds.push(item.config.id),setExpandedRowItemIds([...expandedRowItemIds])}(item),"aria-label":expandedRowItemIds.includes(item.config.id)?external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.rowCollapse",{defaultMessage:"Hide details for {analyticsId}",values:{analyticsId:item.config.id}}):external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.rowExpand",{defaultMessage:"Show details for {analyticsId}",values:{analyticsId:item.config.id}}),iconType:expandedRowItemIds.includes(item.config.id)?"arrowUp":"arrowDown"}),"data-test-subj":"mlAnalyticsTableRowDetailsToggle"},{field:analytics_list_common.c.id,name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.id",{defaultMessage:"ID"}),sortable:item=>item.id,truncateText:!0,"data-test-subj":"mlAnalyticsTableColumnId",scope:"row",render:jobId=>isManagementTable?external_kbnSharedDeps_React_default.a.createElement(DFAnalyticsJobIdLink,{jobId:jobId}):jobId},{field:analytics_list_common.c.description,name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.description",{defaultMessage:"Description"}),sortable:!0,truncateText:!0,"data-test-subj":"mlAnalyticsTableColumnJobDescription"},{field:analytics_list_common.c.memoryStatus,name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.memoryStatus",{defaultMessage:"Memory status"}),truncateText:!0,"data-test-subj":"mlAnalyticsTableColumnJobMemoryStatus"},{field:analytics_list_common.c.configSourceIndex,name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.sourceIndex",{defaultMessage:"Source index"}),sortable:!0,truncateText:!0,"data-test-subj":"mlAnalyticsTableColumnSourceIndex"},{field:analytics_list_common.c.configDestIndex,name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.destinationIndex",{defaultMessage:"Destination index"}),sortable:!0,truncateText:!0,"data-test-subj":"mlAnalyticsTableColumnDestIndex"},{name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.type",{defaultMessage:"Type"}),sortable:item=>Object(common.t)(item.config.analysis),truncateText:!0,render:item=>getJobTypeBadge(Object(common.t)(item.config.analysis)),width:"150px","data-test-subj":"mlAnalyticsTableColumnType"},{name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.status",{defaultMessage:"Status"}),sortable:item=>item.stats.state,truncateText:!0,render:item=>getTaskStateBadge(item.stats.state,item.stats.failure_reason),width:"100px","data-test-subj":"mlAnalyticsTableColumnStatus"},progressColumn,{name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.tableActionLabel",{defaultMessage:"Actions"}),actions:actions,width:!0===isManagementTable?"100px":"150px","data-test-subj":"mlAnalyticsTableColumnActions"}];return!0===isManagementTable&&(spacesApi&&columns.splice(columns.length-1,0,{name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.analyticsSpacesLabel",{defaultMessage:"Spaces"}),render:item=>{var _item$spaceIds;return Array.isArray(item.spaceIds)?external_kbnSharedDeps_React_default.a.createElement(job_spaces_list.a,{spacesApi:spacesApi,spaceIds:null!==(_item$spaceIds=item.spaceIds)&&void 0!==_item$spaceIds?_item$spaceIds:[],jobId:item.id,jobType:"data-frame-analytics",refresh:refresh}):null},width:"90px"}),!1===isMlEnabledInSpace&&columns.pop()),{columns:columns,modals:modals}}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return getDefaultDFAListState})),__webpack_require__.d(__webpack_exports__,"a",(function(){return Page}));var external_kbnSharedDeps_React_=__webpack_require__(14),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(40),external_kbnSharedDeps_ElasticEui_=__webpack_require__(39),external_kbnSharedDeps_ReactRouterDom_=__webpack_require__(44),url_state=__webpack_require__(77),navigation_menu=__webpack_require__(100),date_picker_wrapper=__webpack_require__(184),analytics_list=__webpack_require__(412),kibana=__webpack_require__(63),jobs_list=__webpack_require__(191),common=__webpack_require__(71);const useRefreshInterval=setBlockRefresh=>{const{services:services}=Object(kibana.b)(),{timefilter:timefilter}=services.data.query.timefilter,{refresh:refresh}=Object(common.I)();Object(external_kbnSharedDeps_React_.useEffect)(()=>{let analyticsRefreshInterval=null;const refreshIntervalSubscription=timefilter.getRefreshIntervalUpdate$().subscribe(setAutoRefresh);function setAutoRefresh(){const{value:value,pause:pause}=timefilter.getRefreshInterval();pause?clearRefreshInterval():function(interval){if(clearRefreshInterval(),interval>=jobs_list.c){setBlockRefresh(!1);const intervalId=window.setInterval(()=>{refresh()},interval);analyticsRefreshInterval=intervalId}}(value),refresh()}function clearRefreshInterval(){setBlockRefresh(!0),null!==analyticsRefreshInterval&&window.clearInterval(analyticsRefreshInterval)}return timefilter.disableTimeRangeSelector(),timefilter.enableAutoRefreshSelector(),function(){const{value:value}=timefilter.getRefreshInterval();0===value&&timefilter.setRefreshInterval({pause:!1,value:jobs_list.a});setAutoRefresh()}(),()=>{refreshIntervalSubscription.unsubscribe(),clearRefreshInterval()}},[])};var refresh_analytics_list_button=__webpack_require__(416),node_available_warning=__webpack_require__(291),saved_objects_warning=__webpack_require__(292),upgrade=__webpack_require__(293),external_kbnSharedDeps_KbnI18n_=__webpack_require__(2);const AnalyticsNavigationBar=({jobId:jobId,modelId:modelId,selectedTabId:selectedTabId})=>{const navigateToPath=Object(kibana.e)(),tabs=Object(external_kbnSharedDeps_React_.useMemo)(()=>{const navTabs=[{id:"data_frame_analytics",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.jobsTabLabel",{defaultMessage:"Jobs"}),path:"/data_frame_analytics"},{id:"models",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.modelsTabLabel",{defaultMessage:"Models"}),path:"/data_frame_analytics/models"}];return void 0===jobId&&void 0===modelId||navTabs.push({id:"map",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.mapTabLabel",{defaultMessage:"Map"}),path:"/data_frame_analytics/map"}),navTabs},[void 0!==jobId]),onTabClick=Object(external_kbnSharedDeps_React_.useCallback)(async tab=>{await navigateToPath(tab.path,!0)},[navigateToPath]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTabs,null,tabs.map(tab=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTab,{key:"tab-"+tab.id,isSelected:tab.id===selectedTabId,onClick:onTabClick.bind(null,tab)},tab.name)))};var stats_bar=__webpack_require__(183),trained_models=__webpack_require__(238);const DeleteModelsModal=({models:models,onClose:onClose})=>{const modelsWithPipelines=models.filter(model=>!!model.pipelines).map(model=>model.model_id);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModal,{onClose:onClose.bind(null,!1),initialFocus:"[name=cancelModelDeletion]"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalHeader,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalHeaderTitle,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.deleteModal.header",defaultMessage:"Delete {modelsCount, plural, one {{modelId}} other {# models}}?",values:{modelId:models[0].model_id,modelsCount:models.length}}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalBody,null,modelsWithPipelines.length>0&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{"data-test-subj":"modelsWithPipelinesWarning",color:"danger",iconType:"alert",size:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.deleteModal.modelsWithPipelinesWarningMessage",defaultMessage:"{modelsWithPipelinesCount, plural, one{Model} other {Models}} {modelsWithPipelines} {modelsWithPipelinesCount, plural, one{has} other {have}} associated pipelines!",values:{modelsWithPipelinesCount:modelsWithPipelines.length,modelsWithPipelines:modelsWithPipelines.join(", ")}}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalFooter,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{onClick:onClose.bind(null,!1),name:"cancelModelDeletion"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.deleteModal.cancelButtonLabel",defaultMessage:"Cancel"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{onClick:onClose.bind(null,!0),fill:!0,color:"danger"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.deleteModal.deleteButtonLabel",defaultMessage:"Delete"}))))};var date_utils=__webpack_require__(72),guards=__webpack_require__(163);const formatterDictionary={tags:tags=>{if(0!==tags.length)return external_kbnSharedDeps_React_default.a.createElement("div",null,tags.map(tag=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBadge,{key:tag,color:"hollow"},tag)))},create_time:date_utils.d,timestamp:date_utils.d},ExpandedRow=({item:item})=>{var _stats$ingest,_stats$ingest2;const{inference_config:inferenceConfig,stats:stats,metadata:metadata,tags:tags,version:version,estimated_operations:estimated_operations,estimated_heap_memory_usage_bytes:estimated_heap_memory_usage_bytes,default_field_map:default_field_map,license_level:license_level,pipelines:pipelines,description:description}=item,details={description:description,tags:tags,version:version,estimated_operations:estimated_operations,estimated_heap_memory_usage_bytes:estimated_heap_memory_usage_bytes,default_field_map:default_field_map,license_level:license_level};function formatToListItems(items){return Object.entries(items).filter(([,value])=>Object(guards.a)(value)).map(([title,value])=>title in formatterDictionary?{title:title,description:formatterDictionary[title](value)}:{title:title,description:"object"==typeof value?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCodeBlock,{language:"json",fontSize:"s",paddingSize:"s",overflowHeight:300,isCopyable:!1},JSON.stringify(value,null,2)):value.toString()})}const{services:{share:share,application:{navigateToUrl:navigateToUrl}}}=Object(kibana.b)(),tabs=[{id:"details",name:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.expandedRow.detailsTabLabel",defaultMessage:"Details"}),content:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGrid,{columns:2,gutterSize:"m"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPanel,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("h5",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.expandedRow.detailsTitle",defaultMessage:"Details"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionList,{compressed:!0,type:"column",listItems:formatToListItems(details)})))))},...inferenceConfig?[{id:"config",name:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.expandedRow.configTabLabel",defaultMessage:"Config"}),content:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGrid,{columns:2,gutterSize:"m"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPanel,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("h5",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.expandedRow.inferenceConfigTitle",defaultMessage:"Inference configuration"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionList,{compressed:!0,type:"column",listItems:formatToListItems(inferenceConfig[Object.keys(inferenceConfig)[0]])}))),(null==metadata?void 0:metadata.analytics_config)&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPanel,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("h5",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.expandedRow.analyticsConfigTitle",defaultMessage:"Analytics configuration"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionList,{compressed:!0,type:"column",listItems:formatToListItems(metadata.analytics_config)})))))}]:[],{id:"stats",name:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.expandedRow.statsTabLabel",defaultMessage:"Stats"}),content:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGrid,{columns:2},stats.inference_stats&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPanel,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("h5",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.expandedRow.inferenceStatsTitle",defaultMessage:"Inference stats"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionList,{compressed:!0,type:"column",listItems:formatToListItems(stats.inference_stats)}))),(null===(_stats$ingest=stats.ingest)||void 0===_stats$ingest?void 0:_stats$ingest.total)&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPanel,{style:{maxHeight:"400px",overflow:"auto"}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("h5",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.expandedRow.ingestStatsTitle",defaultMessage:"Ingest stats"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionList,{compressed:!0,type:"column",listItems:formatToListItems(stats.ingest.total)}),(null===(_stats$ingest2=stats.ingest)||void 0===_stats$ingest2?void 0:_stats$ingest2.pipelines)&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("h5",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.expandedRow.byPipelineTitle",defaultMessage:"By pipeline"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),Object.entries(stats.ingest.pipelines).map(([pipelineName,{processors:processors,...pipelineStats}],i)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,{key:pipelineName},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"xs"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTextColor,{color:"subdued"},external_kbnSharedDeps_React_default.a.createElement("h5",null,i+1,". ",pipelineName)))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHorizontalRule,{size:"full",margin:"s"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionList,{compressed:!0,type:"column",listItems:formatToListItems(pipelineStats)}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"xxs"},external_kbnSharedDeps_React_default.a.createElement("h6",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.expandedRow.byProcessorTitle",defaultMessage:"By processor"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,processors.map(processor=>{const name=Object.keys(processor)[0],{stats:processorStats}=processor[name];return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,{key:name},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"xxs"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTextColor,{color:"subdued"},external_kbnSharedDeps_React_default.a.createElement("h6",null,name)))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHorizontalRule,{size:"full",margin:"s"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionList,{compressed:!0,type:"column",listItems:formatToListItems(processorStats)}))})))))))))},...pipelines&&Object.keys(pipelines).length>0?[{id:"pipelines",name:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.expandedRow.pipelinesTabLabel",defaultMessage:"Pipelines"})," ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiNotificationBadge,null,stats.pipeline_count)),content:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGrid,{columns:2,gutterSize:"m"},Object.entries(pipelines).map(([pipelineName,{processors:processors,description:pipelineDescription}])=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{key:pipelineName},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPanel,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("h5",null,pipelineName))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{onClick:async()=>{const ingestPipelinesAppUrlGenerator=share.urlGenerators.getUrlGenerator("INGEST_PIPELINES_APP_URL_GENERATOR");await navigateToUrl(await ingestPipelinesAppUrlGenerator.createUrl({page:"pipeline_edit",pipelineId:pipelineName,absolute:!0}))}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.expandedRow.editPipelineLabel",defaultMessage:"Edit"})))),pipelineDescription&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,pipelineDescription),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"xxs"},external_kbnSharedDeps_React_default.a.createElement("h6",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.expandedRow.processorsTitle",defaultMessage:"Processors"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCodeBlock,{language:"painless",fontSize:"m",paddingSize:"m",overflowHeight:300,isCopyable:!0},JSON.stringify(processors,null,2)))))))}]:[]];return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTabbedContent,{size:"s",style:{width:"100%"},tabs:tabs,initialSelectedTab:tabs[0],autoFocus:"selected",onTabClick:tab=>{}})};var ml_url_generator=__webpack_require__(0),data_frame_analytics=__webpack_require__(79),use_table_settings=__webpack_require__(248);const BUILT_IN_MODEL_TYPE=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.trainedModels.modelsList.builtInModelLabel",{defaultMessage:"built-in"}),ModelsList=()=>{var _pageState$queryText;const{services:{application:{navigateToUrl:navigateToUrl,capabilities:capabilities}}}=Object(kibana.b)(),urlGenerator=Object(kibana.d)(),[pageState,updatePageState]=Object(url_state.b)(ml_url_generator.b.DATA_FRAME_ANALYTICS_MODELS_MANAGE,{pageIndex:0,pageSize:10,sortField:ModelsTableToConfigMapping.id,sortDirection:"asc"}),searchQueryText=null!==(_pageState$queryText=pageState.queryText)&&void 0!==_pageState$queryText?_pageState$queryText:"",canDeleteDataFrameAnalytics=capabilities.ml.canDeleteDataFrameAnalytics,trainedModelsApiService=Object(trained_models.a)(),{toasts:toasts}=Object(kibana.f)(),[isLoading,setIsLoading]=Object(external_kbnSharedDeps_React_.useState)(!1),[items,setItems]=Object(external_kbnSharedDeps_React_.useState)([]),[selectedModels,setSelectedModels]=Object(external_kbnSharedDeps_React_.useState)([]),[modelsToDelete,setModelsToDelete]=Object(external_kbnSharedDeps_React_.useState)([]),[itemIdToExpandedRowMap,setItemIdToExpandedRowMap]=Object(external_kbnSharedDeps_React_.useState)({}),mlUrlGenerator=Object(kibana.d)(),navigateToPath=Object(kibana.e)(),isBuiltInModel=Object(external_kbnSharedDeps_React_.useCallback)(item=>item.tags.includes(data_frame_analytics.b),[]),fetchModelsData=Object(external_kbnSharedDeps_React_.useCallback)(async()=>{try{const response=await trainedModelsApiService.getTrainedModels(void 0,{with_pipelines:!0,size:1e3}),newItems=[],expandedItemsToRefresh=[];for(const model of response){const tableItem={...model,..."object"==typeof model.inference_config?{type:[...Object.keys(model.inference_config),...isBuiltInModel(model)?[BUILT_IN_MODEL_TYPE]:[]]}:{}};newItems.push(tableItem),itemIdToExpandedRowMap[model.model_id]&&expandedItemsToRefresh.push(tableItem)}setItems(newItems),expandedItemsToRefresh.length>0&&(await fetchModelsStats(expandedItemsToRefresh),setItemIdToExpandedRowMap(expandedItemsToRefresh.reduce((acc,item)=>(acc[item.model_id]=external_kbnSharedDeps_React_default.a.createElement(ExpandedRow,{item:item}),acc),{})))}catch(error){var _error$body;toasts.addError(new Error(null===(_error$body=error.body)||void 0===_error$body?void 0:_error$body.message),{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.trainedModels.modelsList.fetchFailedErrorMessage",{defaultMessage:"Models fetch failed"})})}setIsLoading(!1),common.G.next(common.n.IDLE)},[itemIdToExpandedRowMap]);Object(common.I)({isLoading:setIsLoading,onRefresh:fetchModelsData});const modelsStats=Object(external_kbnSharedDeps_React_.useMemo)(()=>({total:{show:!0,value:items.length,label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.trainedModels.modelsList.totalAmountLabel",{defaultMessage:"Total trained models"})}}),[items]),fetchModelsStats=Object(external_kbnSharedDeps_React_.useCallback)(async models=>{const modelIdsToFetch=models.map(model=>model.model_id);try{const{trained_model_stats:modelsStatsResponse}=await trainedModelsApiService.getTrainedModelStats(modelIdsToFetch);for(const{model_id:id,...stats}of modelsStatsResponse){models.find(m=>m.model_id===id).stats=stats}return!0}catch(error){toasts.addError(new Error(error.body.message),{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.trainedModels.modelsList.fetchModelStatsErrorMessage",{defaultMessage:"Fetch model stats failed"})})}},[]),inferenceTypesOptions=Object(external_kbnSharedDeps_React_.useMemo)(()=>[...items.reduce((acc,item)=>{const type=item.inference_config&&Object.keys(item.inference_config)[0];return type&&acc.add(type),acc},new Set)].map(v=>({value:v,name:v})),[items]);async function prepareModelsForDeletion(models){await fetchModelsStats(models)?setModelsToDelete(models):toasts.addDanger(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.trainedModels.modelsList.unableToDeleteModelsErrorMessage",{defaultMessage:"Unable to delete models"}))}const actions=[{name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.trainedModels.modelsList.viewTrainingDataActionLabel",{defaultMessage:"View training data"}),description:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.trainedModels.modelsList.viewTrainingDataActionLabel",{defaultMessage:"View training data"}),icon:"visTable",type:"icon",available:item=>{var _item$metadata,_item$metadata$analyt;return null===(_item$metadata=item.metadata)||void 0===_item$metadata||null===(_item$metadata$analyt=_item$metadata.analytics_config)||void 0===_item$metadata$analyt?void 0:_item$metadata$analyt.id},onClick:async item=>{var _item$metadata2,_item$metadata3,_item$metadata4,_item$metadata5;if(void 0===(null===(_item$metadata2=item.metadata)||void 0===_item$metadata2?void 0:_item$metadata2.analytics_config))return;const analysisType=Object(common.t)(null===(_item$metadata3=item.metadata)||void 0===_item$metadata3?void 0:_item$metadata3.analytics_config.analysis),url=await urlGenerator.createUrl({page:ml_url_generator.b.DATA_FRAME_ANALYTICS_EXPLORATION,pageState:{jobId:null===(_item$metadata4=item.metadata)||void 0===_item$metadata4?void 0:_item$metadata4.analytics_config.id,analysisType:analysisType,..."classification"===analysisType||"regression"===analysisType?{queryText:(null===(_item$metadata5=item.metadata)||void 0===_item$metadata5?void 0:_item$metadata5.analytics_config.dest.results_field)+".is_training : true"}:{}}});await navigateToUrl(url)},isPrimary:!0},{name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.inference.modelsList.analyticsMapActionLabel",{defaultMessage:"Analytics map"}),description:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.inference.modelsList.analyticsMapActionLabel",{defaultMessage:"Analytics map"}),icon:"graphApp",type:"icon",isPrimary:!0,available:item=>{var _item$metadata6,_item$metadata6$analy;return null===(_item$metadata6=item.metadata)||void 0===_item$metadata6||null===(_item$metadata6$analy=_item$metadata6.analytics_config)||void 0===_item$metadata6$analy?void 0:_item$metadata6$analy.id},onClick:async item=>{const path=await mlUrlGenerator.createUrl({page:ml_url_generator.b.DATA_FRAME_ANALYTICS_MAP,pageState:{modelId:item.model_id}});await navigateToPath(path,!1)}},{name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.trainedModels.modelsList.deleteModelActionLabel",{defaultMessage:"Delete model"}),description:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.trainedModels.modelsList.deleteModelActionLabel",{defaultMessage:"Delete model"}),icon:"trash",type:"icon",color:"danger",isPrimary:!1,onClick:async model=>{await prepareModelsForDeletion([model])},available:item=>canDeleteDataFrameAnalytics&&!isBuiltInModel(item),enabled:item=>!item.pipelines}],toggleDetails=async item=>{const itemIdToExpandedRowMapValues={...itemIdToExpandedRowMap};itemIdToExpandedRowMapValues[item.model_id]?delete itemIdToExpandedRowMapValues[item.model_id]:(await fetchModelsStats([item]),itemIdToExpandedRowMapValues[item.model_id]=external_kbnSharedDeps_React_default.a.createElement(ExpandedRow,{item:item})),setItemIdToExpandedRowMap(itemIdToExpandedRowMapValues)},columns=[{align:"left",width:"40px",isExpander:!0,render:item=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{onClick:toggleDetails.bind(null,item),"aria-label":itemIdToExpandedRowMap[item.model_id]?external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.trainedModels.modelsList.collapseRow",{defaultMessage:"Collapse"}):external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.trainedModels.modelsList.expandRow",{defaultMessage:"Expand"}),iconType:itemIdToExpandedRowMap[item.model_id]?"arrowUp":"arrowDown"})},{field:ModelsTableToConfigMapping.id,name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.trainedModels.modelsList.modelIdHeader",{defaultMessage:"ID"}),sortable:!0,truncateText:!0},{field:ModelsTableToConfigMapping.description,width:"350px",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.trainedModels.modelsList.modelDescriptionHeader",{defaultMessage:"Description"}),sortable:!1,truncateText:!0},{field:ModelsTableToConfigMapping.type,name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.trainedModels.modelsList.typeHeader",{defaultMessage:"Type"}),sortable:!0,align:"left",render:types=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"xs",wrap:!0},types.map(type=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{key:type,grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBadge,{color:"hollow"},type))))},{field:ModelsTableToConfigMapping.createdAt,name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.trainedModels.modelsList.createdAtHeader",{defaultMessage:"Created at"}),dataType:"date",render:date_utils.d,sortable:!0},{name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.trainedModels.modelsList.actionsHeader",{defaultMessage:"Actions"}),actions:actions}],filters=inferenceTypesOptions&&inferenceTypesOptions.length>0?[{type:"field_value_selection",field:"type",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.typeFilter",{defaultMessage:"Type"}),multiSelect:"or",options:inferenceTypesOptions}]:[],toolsLeft=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"s"},external_kbnSharedDeps_React_default.a.createElement("h5",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.selectedModelsMessage",defaultMessage:"{modelsCount, plural, one{# model} other {# models}} selected",values:{modelsCount:selectedModels.length}})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{color:"danger",onClick:prepareModelsForDeletion.bind(null,selectedModels)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.deleteModelsButtonLabel",defaultMessage:"Delete"}))))),selection=canDeleteDataFrameAnalytics?{selectableMessage:(selectable,item)=>selectable?external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.trainedModels.modelsList.selectableMessage",{defaultMessage:"Select a model"}):Array.isArray(item.pipelines)&&item.pipelines.length>0?external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.trainedModels.modelsList.disableSelectableMessage",{defaultMessage:"Model has associated pipelines"}):isBuiltInModel(item)?external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.trainedModels.modelsList.builtInModelMessage",{defaultMessage:"Built-in model"}):"",selectable:item=>!item.pipelines&&!isBuiltInModel(item),onSelectionChange:selectedItems=>{setSelectedModels(selectedItems)}}:void 0,{onTableChange:onTableChange,pagination:pagination,sorting:sorting}=Object(use_table_settings.a)(items,pageState,updatePageState),search={query:searchQueryText,onChange:searchChange=>null===searchChange.error&&(updatePageState({queryText:searchChange.queryText,pageIndex:0}),!0),box:{incremental:!0},...inferenceTypesOptions&&inferenceTypesOptions.length>0?{filters:filters}:{},...selectedModels.length>0?{toolsLeft:toolsLeft}:{}};return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceBetween"},modelsStats&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(stats_bar.a,{stats:modelsStats,dataTestSub:"mlInferenceModelsStatsBar"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":"mlModelsTableContainer"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiInMemoryTable,{allowNeutralSort:!1,columns:columns,hasActions:!0,isExpandable:!0,itemIdToExpandedRowMap:itemIdToExpandedRowMap,isSelectable:!1,items:items,itemId:ModelsTableToConfigMapping.id,loading:isLoading,search:search,selection:selection,rowProps:item=>({"data-test-subj":"mlModelsTableRow row-"+item.model_id}),pagination:pagination,onTableChange:onTableChange,sorting:sorting})),modelsToDelete.length>0&&external_kbnSharedDeps_React_default.a.createElement(DeleteModelsModal,{onClose:async deletionApproved=>{deletionApproved&&await async function(){const modelsToDeleteIds=modelsToDelete.map(model=>model.model_id);try{await Promise.all(modelsToDeleteIds.map(modelId=>trainedModelsApiService.deleteTrainedModel(modelId))),setItems(items.filter(model=>!modelsToDelete.some(toDelete=>toDelete.model_id===model.model_id))),toasts.addSuccess(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.trainedModels.modelsList.successfullyDeletedMessage",{defaultMessage:"{modelsCount, plural, one {Model {modelsToDeleteIds}} other {# models}} {modelsCount, plural, one {has} other {have}} been successfully deleted",values:{modelsCount:modelsToDeleteIds.length,modelsToDeleteIds:modelsToDeleteIds.join(", ")}}))}catch(error){var _error$body2;toasts.addError(new Error(null==error||null===(_error$body2=error.body)||void 0===_error$body2?void 0:_error$body2.message),{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.trainedModels.modelsList.fetchDeletionErrorMessage",{defaultMessage:"{modelsCount, plural, one {Model} other {Models}} deletion failed",values:{modelsCount:modelsToDeleteIds.length}})})}}(),setModelsToDelete([])},models:modelsToDelete}))},ModelsTableToConfigMapping={id:"model_id",description:"description",createdAt:"create_time",type:"type"};var cytoscape_cjs=__webpack_require__(513),cytoscape_cjs_default=__webpack_require__.n(cytoscape_cjs),cytoscape_dagre=__webpack_require__(519),cytoscape_dagre_default=__webpack_require__.n(cytoscape_dagre),ml_classification_job=__webpack_require__(697),ml_classification_job_default=__webpack_require__.n(ml_classification_job),ml_outlier_detection_job=__webpack_require__(698),ml_outlier_detection_job_default=__webpack_require__.n(ml_outlier_detection_job),ml_regression_job=__webpack_require__(699),ml_regression_job_default=__webpack_require__.n(ml_regression_job);const MAP_SHAPES_ELLIPSE="ellipse",MAP_SHAPES_RECTANGLE="rectangle",MAP_SHAPES_DIAMOND="diamond",MAP_SHAPES_TRIANGLE="triangle";const getCytoscapeOptions=theme=>({autoungrabify:!0,boxSelectionEnabled:!1,maxZoom:3,minZoom:.2,style:[{selector:"node",style:{"background-color":el=>el.data("isRoot")?theme.euiColorWarning:theme.euiColorGhost,"background-height":"60%","background-width":"60%","border-color":el=>function(el,theme){if(el.selected())return theme.euiColorPrimary;switch(el.data("type")){case data_frame_analytics.e.ANALYTICS:return theme.euiColorSecondary;case data_frame_analytics.e.TRANSFORM:return theme.euiColorVis1;case data_frame_analytics.e.INDEX:return theme.euiColorVis2;case data_frame_analytics.e.TRAINED_MODEL:return theme.euiColorVis3;default:return theme.euiColorMediumShade}}(el,theme),"border-style":"solid","background-image":el=>function(el){switch(el.data("analysisType")){case data_frame_analytics.a.OUTLIER_DETECTION:return ml_outlier_detection_job_default.a;case data_frame_analytics.a.CLASSIFICATION:return ml_classification_job_default.a;case data_frame_analytics.a.REGRESSION:return ml_regression_job_default.a;default:return}}(el),"border-width":el=>el.selected()?4:3,color:theme.euiTextColors.default,"font-family":"Inter UI, Segoe UI, Helvetica, Arial, sans-serif","font-size":theme.euiFontSizeXS,"min-zoomed-font-size":parseInt(theme.euiSizeL,10),label:"data(label)",shape:el=>function(el,theme){switch(el.data("type")){case data_frame_analytics.e.ANALYTICS:return MAP_SHAPES_ELLIPSE;case data_frame_analytics.e.TRANSFORM:return MAP_SHAPES_RECTANGLE;case data_frame_analytics.e.INDEX:return MAP_SHAPES_DIAMOND;case data_frame_analytics.e.TRAINED_MODEL:return MAP_SHAPES_TRIANGLE;default:return MAP_SHAPES_ELLIPSE}}(el),"text-background-color":theme.euiColorLightestShade,"text-background-opacity":0,"text-background-padding":theme.paddingSizes.xs,"text-background-shape":"roundrectangle","text-margin-y":parseInt(theme.paddingSizes.s,10),"text-max-width":"200px","text-valign":"bottom","text-wrap":"wrap"}},{selector:"edge",style:{"curve-style":"taxi","taxi-direction":"rightward","line-color":"#C5CCD7","overlay-opacity":0,"target-arrow-color":"#C5CCD7","target-arrow-shape":"triangle","target-distance-from-node":theme.paddingSizes.xs,width:1,"source-arrow-shape":"none"}}]});cytoscape_cjs_default.a.use(cytoscape_dagre_default.a);const CytoscapeContext=Object(external_kbnSharedDeps_React_.createContext)(void 0);function Cytoscape({children:children,elements:elements,theme:theme,height:height,itemsDeleted:itemsDeleted,resetCy:resetCy,style:style,width:width}){const[ref,cy]=function(options){const[cy,setCy]=Object(external_kbnSharedDeps_React_.useState)(),ref=Object(external_kbnSharedDeps_React_.useRef)(null);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{cy||setCy(cytoscape_cjs_default()({...options,container:ref.current}))},[options,cy]),Object(external_kbnSharedDeps_React_.useEffect)(()=>()=>{cy&&cy.destroy()},[cy]),[ref,cy]}({...getCytoscapeOptions(theme),elements:elements}),divStyle={...style,height:height},dataHandler=Object(external_kbnSharedDeps_React_.useCallback)(event=>{cy&&height>0&&setTimeout(()=>cy.layout(function(width,height){return{name:"dagre",rankDir:"LR",fit:!0,padding:20,spacingFactor:.95,boundingBox:{x1:0,y1:0,w:width,h:height}}}(width,height)).run(),150)},[cy,height,width]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>(cy&&cy.on("data",dataHandler),()=>{cy&&cy.removeListener("data",void 0,dataHandler)}),[cy,elements,height,width]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{cy&&(!1===itemsDeleted||cy.elements().remove(),cy.add(elements),cy.trigger("data"))},[cy,elements]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{cy&&cy.reset()},[cy,resetCy]),external_kbnSharedDeps_React_default.a.createElement(CytoscapeContext.Provider,{value:cy},external_kbnSharedDeps_React_default.a.createElement("div",{ref:ref,style:divStyle,"data-test-subj":"mlPageDataFrameAnalyticsMapCytoscape"},children))}var external_kbnSharedDeps_MomentTimezone_=__webpack_require__(48),external_kbnSharedDeps_MomentTimezone_default=__webpack_require__.n(external_kbnSharedDeps_MomentTimezone_),check_capabilities=__webpack_require__(68),index_utils=__webpack_require__(82),clone_action_name=__webpack_require__(140),action_delete=__webpack_require__(415),delete_job_check_modal=__webpack_require__(295);function getListItems(details){return Object.entries(details).map(([key,value])=>{let description;return description="create_time"===key?Object(date_utils.c)(1e3*external_kbnSharedDeps_MomentTimezone_default()(value).unix()):"object"==typeof value?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCodeBlock,{language:"json",fontSize:"s",paddingSize:"s"},JSON.stringify(value,null,2)):value,{title:key,description:description}})}const Controls=external_kbnSharedDeps_React_default.a.memo(({details:details,getNodeData:getNodeData,modelId:modelId,refreshJobsCallback:refreshJobsCallback,updateElements:updateElements})=>{const[showFlyout,setShowFlyout]=Object(external_kbnSharedDeps_React_.useState)(!1),[selectedNode,setSelectedNode]=Object(external_kbnSharedDeps_React_.useState)(),[isPopoverOpen,setPopover]=Object(external_kbnSharedDeps_React_.useState)(!1),[didUntag,setDidUntag]=Object(external_kbnSharedDeps_React_.useState)(!1),canCreateDataFrameAnalytics=Object(check_capabilities.e)("canCreateDataFrameAnalytics"),canDeleteDataFrameAnalytics=Object(check_capabilities.e)("canDeleteDataFrameAnalytics"),deleteAction=Object(action_delete.b)(canDeleteDataFrameAnalytics),{closeDeleteJobCheckModal:closeDeleteJobCheckModal,deleteItem:deleteItem,deleteTargetIndex:deleteTargetIndex,isModalVisible:isModalVisible,isDeleteJobCheckModalVisible:isDeleteJobCheckModalVisible,item:item,jobType:jobType,openModal:openModal,openDeleteJobCheckModal:openDeleteJobCheckModal}=deleteAction,{toasts:toasts}=Object(kibana.f)(),mlUrlGenerator=Object(kibana.d)(),navigateToPath=Object(kibana.e)(),navigateToWizardWithClonedJob=Object(clone_action_name.e)(),cy=Object(external_kbnSharedDeps_React_.useContext)(CytoscapeContext),deselect=Object(external_kbnSharedDeps_React_.useCallback)(()=>{cy&&cy.elements().unselect(),setShowFlyout(!1),setSelectedNode(void 0)},[cy,setSelectedNode]),nodeId=null==selectedNode?void 0:selectedNode.data("id"),nodeLabel=null==selectedNode?void 0:selectedNode.data("label"),nodeType=null==selectedNode?void 0:selectedNode.data("type"),onCreateJobClick=Object(external_kbnSharedDeps_React_.useCallback)(async()=>{const indexId=Object(index_utils.c)(nodeLabel);if(indexId){const path=await mlUrlGenerator.createUrl({page:ml_url_generator.b.DATA_FRAME_ANALYTICS_CREATE_JOB,pageState:{index:indexId}});await navigateToPath(path)}else toasts.addDanger(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsMap.flyout.indexPatternMissingMessage",{defaultMessage:"To create a job from this index please create an index pattern for {indexTitle}.",values:{indexTitle:nodeLabel}}))},[nodeLabel]),onCloneJobClick=Object(external_kbnSharedDeps_React_.useCallback)(async()=>{var _details$nodeId;navigateToWizardWithClonedJob({config:details[nodeId],stats:null===(_details$nodeId=details[nodeId])||void 0===_details$nodeId?void 0:_details$nodeId.stats})},[nodeId]);if(Object(external_kbnSharedDeps_React_.useEffect)(()=>{const selectHandler=event=>{setSelectedNode(event.target),setShowFlyout(!0)};return cy&&(cy.on("select","node",selectHandler),cy.on("unselect","node",deselect)),()=>{cy&&(cy.removeListener("select","node",selectHandler),cy.removeListener("unselect","node",deselect))}},[cy,deselect]),Object(external_kbnSharedDeps_React_.useEffect)((function(){if(!1===isModalVisible&&!0===deleteItem||!0===didUntag){let destIndexNode;if(!0===deleteTargetIndex||!0===didUntag){destIndexNode=`${details[nodeId].dest.index}-${data_frame_analytics.e.INDEX}`}updateElements(nodeId,nodeLabel,destIndexNode),setShowFlyout(!1)}}),[isModalVisible,deleteItem,didUntag]),!1===showFlyout)return null;const button=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{size:"s",iconType:"arrowDown",iconSide:"right",onClick:()=>{setPopover(!isPopoverOpen)}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataframe.analyticsMap.flyout.nodeActionsButton",defaultMessage:"Node actions"})),items=[...nodeType===data_frame_analytics.e.ANALYTICS?[external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenuItem,{key:nodeId+"-delete",icon:"trash",disabled:!canDeleteDataFrameAnalytics,onClick:()=>{var _details$nodeId2;openDeleteJobCheckModal({config:details[nodeId],stats:null===(_details$nodeId2=details[nodeId])||void 0===_details$nodeId2?void 0:_details$nodeId2.stats})}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataframe.analyticsMap.flyout.deleteJobButton",defaultMessage:"Delete job"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenuItem,{key:nodeId+"-clone",icon:"copy",disabled:!canCreateDataFrameAnalytics,onClick:onCloneJobClick},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataframe.analyticsMap.flyout.cloneJobButton",defaultMessage:"Clone job"}))]:[],...nodeType===data_frame_analytics.e.INDEX?[external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenuItem,{disabled:!canCreateDataFrameAnalytics,key:nodeId+"-create",icon:"plusInCircle",onClick:onCreateJobClick},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataframe.analyticsMap.flyout.createJobButton",defaultMessage:"Create job from this index"}))]:[],...modelId===nodeLabel||nodeType!==data_frame_analytics.e.ANALYTICS&&nodeType!==data_frame_analytics.e.INDEX?[]:[external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenuItem,{key:nodeId+"-fetch-related",icon:"branch",onClick:()=>{getNodeData({id:nodeLabel,type:nodeType}),cy&&cy.elements().unselect(),setShowFlyout(!1),setPopover(!1)}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataframe.analyticsMap.flyout.fetchRelatedNodesButton",defaultMessage:"Fetch related nodes"}))]];return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPortal,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyout,{ownFocus:!0,size:"m",onClose:deselect,"data-test-subj":"mlAnalyticsJobMapFlyout"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyoutHeader,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"column",gutterSize:"xs"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"s"},external_kbnSharedDeps_React_default.a.createElement("h3",{"data-test-subj":"mlDataFrameAnalyticsNodeDetailsTitle"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataframe.analyticsMap.flyoutHeaderTitle",defaultMessage:"Details for {type} {id}",values:{id:nodeLabel,type:nodeType}})))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyoutBody,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"column",gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionList,{compressed:!0,type:"column",listItems:getListItems("index-pattern"===nodeType?details[nodeId][nodeLabel]:details[nodeId])})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyoutFooter,null,nodeType!==data_frame_analytics.e.TRAINED_MODEL&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopover,{button:button,isOpen:isPopoverOpen,closePopover:()=>{setPopover(!1)},panelPaddingSize:"s",anchorPosition:"downLeft"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenuPanel,{items:items})))),isDeleteJobCheckModalVisible&&item&&external_kbnSharedDeps_React_default.a.createElement(delete_job_check_modal.a,{jobType:jobType,jobIds:[item.config.id],onCloseCallback:closeDeleteJobCheckModal,canDeleteCallback:()=>{openModal(deleteAction.item),closeDeleteJobCheckModal()},refreshJobsCallback:refreshJobsCallback,setDidUntag:setDidUntag}),isModalVisible&&external_kbnSharedDeps_React_default.a.createElement(action_delete.a,deleteAction))}),JobMapLegend=({theme:theme})=>{const[showJobTypes,setShowJobTypes]=Object(external_kbnSharedDeps_React_.useState)(!1);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{className:"mlJobMapLegend__container",alignItems:"center","data-test-subj":"mlPageDataFrameAnalyticsMapLegend"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"xs",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement("span",{className:"mlJobMapLegend__sourceNode"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs",color:"subdued"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataframe.analyticsMap.legend.rootNodeLabel",defaultMessage:"source node"}))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"xs",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement("span",{className:"mlJobMapLegend__indexPattern"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs",color:"subdued"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataframe.analyticsMap.legend.indexLabel",defaultMessage:"index"}))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"xs",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement("span",{className:"mlJobMapLegend__transform"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs",color:"subdued"},data_frame_analytics.e.TRANSFORM)))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"xs",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement("span",{style:{display:"inline-block",width:"0px",height:"0px",borderLeft:`${theme.euiSizeS} solid ${theme.euiPageBackgroundColor}`,borderRight:`${theme.euiSizeS} solid ${theme.euiPageBackgroundColor}`,borderBottom:`${theme.euiSizeM} solid ${theme.euiColorVis3}`}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs",color:"subdued"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataframe.analyticsMap.legend.trainedModelLabel",defaultMessage:"trained model"}))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"xs",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement("span",{className:"mlJobMapLegend__analytics"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"xs",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs",color:"subdued"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataframe.analyticsMap.legend.analyticsJobLabel",defaultMessage:"analytics jobs"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopover,{ownFocus:!0,button:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{iconSize:"s",onClick:()=>setShowJobTypes(!showJobTypes),iconType:showJobTypes?"arrowUp":"arrowDown","aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsMap.legend.showJobTypesAriaLabel",{defaultMessage:"Show job types"})}),isOpen:showJobTypes,closePopover:()=>setShowJobTypes(!1)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiListGroup,{flush:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiListGroupItem,{iconType:"outlierDetectionJob",label:"Outlier detection",size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiListGroupItem,{iconType:"regressionJob",label:"Regression",size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiListGroupItem,{iconType:"classificationJob",label:"Classification",size:"xs"}))))))))))};var color_range_legend=__webpack_require__(145),useWindowSize=__webpack_require__(700),useWindowSize_default=__webpack_require__.n(useWindowSize);var external_kbnSharedDeps_Lodash_=__webpack_require__(7),ml_api_service=__webpack_require__(64);const useFetchAnalyticsMapData=()=>{const[isLoading,setIsLoading]=Object(external_kbnSharedDeps_React_.useState)(!1),[elements,setElements]=Object(external_kbnSharedDeps_React_.useState)([]),[nodeDetails,setNodeDetails]=Object(external_kbnSharedDeps_React_.useState)({}),[error,setError]=Object(external_kbnSharedDeps_React_.useState)(),[message,setMessage]=Object(external_kbnSharedDeps_React_.useState)();return{elements:elements,error:error,fetchAndSetElementsWrapper:async params=>{const{analyticsId:analyticsId,id:id,modelId:modelId,type:type}=null!=params?params:{},treatAsRoot=void 0!==id;let idToUse;idToUse=void 0!==id?id:void 0!==modelId?modelId:analyticsId,await(async(idToUse,treatAsRoot,type)=>{setIsLoading(!0);const analyticsMap=await ml_api_service.ml.dataFrameAnalytics.getDataFrameAnalyticsMap(idToUse,treatAsRoot,type),{elements:nodeElements,details:details,error:fetchError}=analyticsMap;if(null!==fetchError&&(setIsLoading(!1),setError(fetchError)),0===(null==nodeElements?void 0:nodeElements.length)&&setMessage(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsMap.emptyResponseMessage",{defaultMessage:"No related analytics jobs found for {id}.",values:{id:idToUse}})),(null==nodeElements?void 0:nodeElements.length)>0)if(!1===treatAsRoot)setElements(nodeElements),setNodeDetails(details);else{const uniqueElements=Object(external_kbnSharedDeps_Lodash_.uniqWith)([...nodeElements,...elements],external_kbnSharedDeps_Lodash_.isEqual);setElements(uniqueElements),setNodeDetails({...details,...nodeDetails})}setIsLoading(!1)})(idToUse,treatAsRoot,void 0!==modelId&&!1===treatAsRoot?data_frame_analytics.e.TRAINED_MODEL:type)},isLoading:isLoading,message:message,nodeDetails:nodeDetails,setElements:setElements,setError:setError}},JobMapTitle=({analyticsId:analyticsId,modelId:modelId})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("span",{"data-test-subj":"mlPageDataFrameAnalyticsMapTitle"},analyticsId?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataframe.analyticsMap.analyticsIdTitle",defaultMessage:"Map for analytics ID {analyticsId}",values:{analyticsId:analyticsId}}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataframe.analyticsMap.modelIdTitle",defaultMessage:"Map for trained model ID {modelId}",values:{modelId:modelId}}))),JobMap=({analyticsId:analyticsId,modelId:modelId})=>{const[itemsDeleted,setItemsDeleted]=Object(external_kbnSharedDeps_React_.useState)(!1),[resetCyToggle,setResetCyToggle]=Object(external_kbnSharedDeps_React_.useState)(!1),{elements:elements,error:error,fetchAndSetElementsWrapper:fetchAndSetElementsWrapper,isLoading:isLoading,message:message,nodeDetails:nodeDetails,setElements:setElements,setError:setError}=useFetchAnalyticsMapData(),{services:{notifications:notifications,application:{navigateToUrl:navigateToUrl}}}=Object(kibana.b)(),urlGenerator=Object(kibana.d)(),{euiTheme:euiTheme}=Object(color_range_legend.e)();Object(external_kbnSharedDeps_React_.useEffect)(()=>{fetchAndSetElementsWrapper({analyticsId:analyticsId,modelId:modelId})},[analyticsId,modelId]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{void 0!==message&&notifications.toasts.add(message)},[message]),void 0!==error&&(notifications.toasts.addDanger(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsMap.fetchDataErrorMessage",{defaultMessage:"Unable to fetch some data. An error occurred: {error}",values:{error:JSON.stringify(error)}})),setError(void 0));const{ref:ref,width:width,height:height}=function(){const ref=Object(external_kbnSharedDeps_React_.useRef)(null),windowHeight=useWindowSize_default()().height;if(!ref.current)return{ref:ref,width:0,height:0};const{top:top,width:width}=ref.current.getBoundingClientRect();return{ref:ref,width:width,height:windowHeight-top}}(),refreshCallback=()=>fetchAndSetElementsWrapper({analyticsId:analyticsId,modelId:modelId});return external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":"mlPageDataFrameAnalyticsMap"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"column",gutterSize:"none",justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(JobMapTitle,{analyticsId:analyticsId,modelId:modelId})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(JobMapLegend,{theme:euiTheme})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"xs",component:"span"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{size:"xs","data-test-subj":"mlAnalyticsRefreshMapButton"+(isLoading?" loading":" loaded"),onClick:refreshCallback,isLoading:isLoading},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataframe.analyticsList.refreshMapButtonLabel",defaultMessage:"Refresh"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{size:"xs","data-test-subj":"mlAnalyticsResetGraphButton",onClick:()=>setResetCyToggle(!resetCyToggle)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataframe.analyticsList.resetMapButtonLabel",defaultMessage:"Reset"})))))),external_kbnSharedDeps_React_default.a.createElement("div",{style:{height:height-parseInt(euiTheme.gutterTypes.gutterLarge,10)-20},ref:ref},external_kbnSharedDeps_React_default.a.createElement(Cytoscape,{theme:euiTheme,height:height-20,elements:elements,width:width,style:(theme=euiTheme,{background:`linear-gradient(\n  90deg,\n  ${theme.euiPageBackgroundColor}\n    calc(${theme.euiSizeL} - calc(${theme.euiSizeXS} / 2)),\n  transparent 1%\n)\ncenter,\nlinear-gradient(\n  ${theme.euiPageBackgroundColor}\n    calc(${theme.euiSizeL} - calc(${theme.euiSizeXS} / 2)),\n  transparent 1%\n)\ncenter,\n${theme.euiColorLightShade}`,backgroundSize:`${theme.euiSizeL} ${theme.euiSizeL}`,margin:"-"+theme.gutterTypes.gutterLarge,marginTop:0}),itemsDeleted:itemsDeleted,resetCy:resetCyToggle},external_kbnSharedDeps_React_default.a.createElement(Controls,{details:nodeDetails,getNodeData:fetchAndSetElementsWrapper,modelId:modelId,updateElements:(nodeId,nodeLabel,destIndexNode)=>{if(nodeLabel===analyticsId)(async()=>{const url=await urlGenerator.createUrl({page:ml_url_generator.b.DATA_FRAME_ANALYTICS_JOBS_MANAGE});await navigateToUrl(url)})();else{const filteredElements=elements.filter(e=>{let isNotDeletedNodeOrRelated=e.data.id!==nodeId&&e.data.target!==nodeId&&e.data.source!==nodeId;var _nodeDetails$e$data$i,_nodeDetails$e$data$i2,_nodeDetails$e$data$i3;void 0!==e.data.id&&e.data.type===data_frame_analytics.e.TRAINED_MODEL&&(isNotDeletedNodeOrRelated=isNotDeletedNodeOrRelated&&(null===(_nodeDetails$e$data$i=nodeDetails[e.data.id])||void 0===_nodeDetails$e$data$i||null===(_nodeDetails$e$data$i2=_nodeDetails$e$data$i.metadata)||void 0===_nodeDetails$e$data$i2||null===(_nodeDetails$e$data$i3=_nodeDetails$e$data$i2.analytics_config)||void 0===_nodeDetails$e$data$i3?void 0:_nodeDetails$e$data$i3.id)!==nodeLabel);return void 0!==destIndexNode?isNotDeletedNodeOrRelated&&e.data.id!==destIndexNode&&e.data.target!==destIndexNode&&e.data.source!==destIndexNode:isNotDeletedNodeOrRelated});setItemsDeleted(!0),setElements(filteredElements)}},refreshJobsCallback:refreshCallback}))));var theme};var analytics_list_common=__webpack_require__(93),help_menu=__webpack_require__(104);const getDefaultDFAListState=()=>({pageIndex:0,pageSize:10,sortField:analytics_list_common.c.id,sortDirection:"asc"}),Page=()=>{var _globalState$ml,_globalState$ml2;const[blockRefresh,setBlockRefresh]=Object(external_kbnSharedDeps_React_.useState)(!1),[globalState]=Object(url_state.c)("_g"),[dfaPageState,setDfaPageState]=Object(url_state.b)(ml_url_generator.b.DATA_FRAME_ANALYTICS_JOBS_MANAGE,getDefaultDFAListState());useRefreshInterval(setBlockRefresh);const location=Object(external_kbnSharedDeps_ReactRouterDom_.useLocation)(),selectedTabId=Object(external_kbnSharedDeps_React_.useMemo)(()=>location.pathname.split("/").pop(),[location]),mapJobId=null==globalState||null===(_globalState$ml=globalState.ml)||void 0===_globalState$ml?void 0:_globalState$ml.jobId,mapModelId=null==globalState||null===(_globalState$ml2=globalState.ml)||void 0===_globalState$ml2?void 0:_globalState$ml2.modelId,{services:{docLinks:docLinks}}=Object(kibana.b)(),helpLink=docLinks.links.ml.dataFrameAnalytics;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(navigation_menu.a,{tabId:"data_frame_analytics"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPage,{"data-test-subj":"mlPageDataFrameAnalytics"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageBody,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageHeader,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageHeaderSection,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,null,external_kbnSharedDeps_React_default.a.createElement("h1",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataframe.analyticsList.title",defaultMessage:"Data frame analytics"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageHeaderSection,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},"map"!==selectedTabId&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(refresh_analytics_list_button.a,null)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(date_picker_wrapper.a,null)))))),external_kbnSharedDeps_React_default.a.createElement(node_available_warning.a,null),external_kbnSharedDeps_React_default.a.createElement(saved_objects_warning.a,{jobType:"data-frame-analytics"}),external_kbnSharedDeps_React_default.a.createElement(upgrade.a,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageContent,null,external_kbnSharedDeps_React_default.a.createElement(AnalyticsNavigationBar,{selectedTabId:selectedTabId,jobId:mapJobId,modelId:mapModelId}),"map"===selectedTabId&&(mapJobId||mapModelId)&&external_kbnSharedDeps_React_default.a.createElement(JobMap,{analyticsId:mapJobId,modelId:mapModelId}),"data_frame_analytics"===selectedTabId&&external_kbnSharedDeps_React_default.a.createElement(analytics_list.a,{blockRefresh:blockRefresh,pageState:dfaPageState,updatePageState:setDfaPageState}),"models"===selectedTabId&&external_kbnSharedDeps_React_default.a.createElement(ModelsList,null)))),external_kbnSharedDeps_React_default.a.createElement(help_menu.a,{docLink:helpLink}))}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return BADGE_LIMIT})),__webpack_require__.d(__webpack_exports__,"b",(function(){return JobSelectorFlyoutContent}));var external_kbnSharedDeps_React_=__webpack_require__(14),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),external_kbnSharedDeps_KbnI18n_=__webpack_require__(2),external_kbnSharedDeps_ElasticEui_=__webpack_require__(39),job_selector_badge=__webpack_require__(227);const NewSelectionIdBadges=({limit:limit,maps:maps,newSelection:newSelection,onDeleteClick:onDeleteClick,onLinkClick:onLinkClick,showAllBadges:showAllBadges})=>{const badges=[];for(let i=0;i<newSelection.length&&!(i>=limit&&!1===showAllBadges);i++)badges.push(external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,key:newSelection[i]},external_kbnSharedDeps_React_default.a.createElement(job_selector_badge.a,{id:newSelection[i],icon:!0,isGroup:void 0!==maps.groupsMap[newSelection[i]],removeId:onDeleteClick})));return!1===showAllBadges&&newSelection.length>limit?badges.push(external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{key:"more-badges-link",onClick:onLinkClick},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{grow:!1,size:"xs"},external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobSelector.showFlyoutBadges",{defaultMessage:"And {overFlow} more",values:{overFlow:newSelection.length-limit}})))):!0===showAllBadges&&newSelection.length>limit&&badges.push(external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{key:"hide-badges-link",onClick:onLinkClick},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{grow:!1,size:"xs"},external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobSelector.hideFlyoutBadges",{defaultMessage:"Hide"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,badges)};var custom_selection_table=__webpack_require__(424);function TimeRangeBar({isRunning:isRunning,timerange:timerange,ganttBarWidth:ganttBarWidth}){const style={width:timerange.widthPx,marginLeft:timerange.fromPx},className="mlJobSelector__ganttBar"+(isRunning?" mlJobSelector__ganttBarRunning":"");return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{position:"top",content:timerange.label},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement("div",{className:"mlJobSelector__ganttBarBackEdge"},external_kbnSharedDeps_React_default.a.createElement("div",{className:"mlJobSelector__ganttBarDashed",style:{width:ganttBarWidth+"px"}})),external_kbnSharedDeps_React_default.a.createElement("div",{style:style,className:className})))}var external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(40),external_kbnSharedDeps_ElasticEuiLibServices_=__webpack_require__(52),kibana=__webpack_require__(63),ml_url_generator=__webpack_require__(0),app=__webpack_require__(5);const JOB_FILTER_FIELDS=["job_id","groups"],GROUP_FILTER_FIELDS=["id"];function JobSelectorTable({ganttBarWidth:ganttBarWidth,groupsList:groupsList,jobs:jobs,onSelection:onSelection,selectedIds:selectedIds,singleSelection:singleSelection,timeseriesOnly:timeseriesOnly,withTimeRangeSelector:withTimeRangeSelector}){const[sortableProperties,setSortableProperties]=Object(external_kbnSharedDeps_React_.useState)(),[currentTab,setCurrentTab]=Object(external_kbnSharedDeps_React_.useState)("Jobs"),{services:{application:{navigateToApp:navigateToApp}}}=Object(kibana.b)();Object(external_kbnSharedDeps_React_.useEffect)(()=>{let sortablePropertyItems=[],defaultSortProperty="job_id";"Jobs"===currentTab||singleSelection?sortablePropertyItems=[{name:"job_id",getValue:item=>item.job_id.toLowerCase(),isAscending:!0},{name:"groups",getValue:item=>item.groups&&item.groups[0]?item.groups[0].toLowerCase():"",isAscending:!0}]:"Groups"===currentTab&&(defaultSortProperty="id",sortablePropertyItems=[{name:"id",getValue:item=>item.id.toLowerCase(),isAscending:!0}]);const sortableProps=new external_kbnSharedDeps_ElasticEuiLibServices_.SortableProperties(sortablePropertyItems,defaultSortProperty);setSortableProperties(sortableProps)},[jobs,currentTab]);const tabs=[{id:"Jobs",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobSelector.jobsTab",{defaultMessage:"Jobs"}),content:renderJobsTable()},{id:"Groups",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobSelector.groupsTab",{defaultMessage:"Groups"}),content:function(){const groupColumns=[{id:"checkbox",isCheckbox:!0,textOnly:!1,width:"32px"},{label:"group ID",id:"id",isSortable:!0,alignment:external_kbnSharedDeps_ElasticEuiLibServices_.LEFT_ALIGNMENT,render:({id:id})=>external_kbnSharedDeps_React_default.a.createElement(job_selector_badge.a,{id:id,isGroup:!0})},{id:"jobs in group",label:"jobs in group",isSortable:!1,alignment:external_kbnSharedDeps_ElasticEuiLibServices_.CENTER_ALIGNMENT,render:({jobIds:jobIds=[]})=>jobIds.length}];withTimeRangeSelector&&groupColumns.push({label:"time range",id:"timerange",alignment:external_kbnSharedDeps_ElasticEuiLibServices_.LEFT_ALIGNMENT,render:({timeRange:timeRange={}})=>external_kbnSharedDeps_React_default.a.createElement(TimeRangeBar,{timerange:timeRange,ganttBarWidth:ganttBarWidth})});return external_kbnSharedDeps_React_default.a.createElement(custom_selection_table.a,{columns:groupColumns,filterDefaultFields:singleSelection?void 0:GROUP_FILTER_FIELDS,items:groupsList,onTableChange:selectionFromTable=>onSelection({selectionFromTable:selectionFromTable}),selectedIds:selectedIds,sortableProperties:sortableProperties})}()}];function renderJobsTable(){const columns=[{id:"checkbox",isCheckbox:!0,textOnly:!1,width:"32px"},{label:"job ID",id:"job_id",isSortable:!0,alignment:external_kbnSharedDeps_ElasticEuiLibServices_.LEFT_ALIGNMENT},{id:"groups",label:"groups",isSortable:!0,alignment:external_kbnSharedDeps_ElasticEuiLibServices_.LEFT_ALIGNMENT,render:({groups:groups=[]})=>groups.map(group=>external_kbnSharedDeps_React_default.a.createElement(job_selector_badge.a,{key:group+"-key",id:group,isGroup:!0}))}];withTimeRangeSelector&&columns.push({label:"time range",id:"timerange",alignment:external_kbnSharedDeps_ElasticEuiLibServices_.LEFT_ALIGNMENT,render:({timeRange:timeRange={},isRunning:isRunning})=>external_kbnSharedDeps_React_default.a.createElement(TimeRangeBar,{timerange:timeRange,isRunning:isRunning,ganttBarWidth:ganttBarWidth})});const filters=[{type:"field_value_selection",field:"groups",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobSelector.filterBar.groupLabel",{defaultMessage:"Group"}),loadingMessage:"Loading...",noOptionsMessage:"No groups found.",multiSelect:"or",cache:1e4,options:groupsList.map(g=>({value:g.id,view:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{key:g.id,grow:!1},external_kbnSharedDeps_React_default.a.createElement(job_selector_badge.a,{id:g.id,isGroup:!0})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobSelector.filterBar.jobGroupTitle",{defaultMessage:"({jobsCount, plural, one {# job} other {# jobs}})",values:{jobsCount:g.jobIds.length}}))))}))}];return external_kbnSharedDeps_React_default.a.createElement(custom_selection_table.a,{columns:columns,filters:filters,filterDefaultFields:singleSelection?void 0:JOB_FILTER_FIELDS,items:jobs,onTableChange:selectionFromTable=>onSelection({selectionFromTable:selectionFromTable}),radioDisabledCheck:item=>timeseriesOnly&&!1===item.isSingleMetricViewerJob,selectedIds:selectedIds,singleSelection:singleSelection,sortableProperties:sortableProperties,timeseriesOnly:timeseriesOnly})}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,0===jobs.length&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobSelector.noJobsFoundTitle",defaultMessage:"No anomaly detection jobs found"}),iconType:"iInCircle"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{textAlign:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{color:"primary",onClick:async()=>{await navigateToApp(app.e,{path:ml_url_generator.b.ANOMALY_DETECTION_CREATE_JOB})}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobSelector.createJobButtonLabel",defaultMessage:"Create job"})))),0!==jobs.length&&!0===singleSelection&&renderJobsTable(),0!==jobs.length&&!singleSelection&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTabbedContent,{size:"s",tabs:tabs,initialSelectedTab:tabs[0],onTabClick:tab=>{setCurrentTab(tab.id)}}))}var job_select_service_utils=__webpack_require__(269);const BADGE_LIMIT=10,JobSelectorFlyoutContent=({dateFormatTz:dateFormatTz,selectedIds:selectedIds=[],singleSelection:singleSelection,timeseriesOnly:timeseriesOnly,onJobsFetched:onJobsFetched,onSelectionConfirmed:onSelectionConfirmed,onFlyoutClose:onFlyoutClose,maps:maps,applyTimeRangeConfig:applyTimeRangeConfig,onTimeRangeConfigChange:onTimeRangeConfigChange,withTimeRangeSelector:withTimeRangeSelector=!0})=>{const{services:{notifications:notifications,mlServices:{mlApiServices:mlApiServices}}}=Object(kibana.b)(),[newSelection,setNewSelection]=Object(external_kbnSharedDeps_React_.useState)(selectedIds),[isLoading,setIsLoading]=Object(external_kbnSharedDeps_React_.useState)(!0),[showAllBadges,setShowAllBadges]=Object(external_kbnSharedDeps_React_.useState)(!1),[jobs,setJobs]=Object(external_kbnSharedDeps_React_.useState)([]),[groups,setGroups]=Object(external_kbnSharedDeps_React_.useState)([]),[ganttBarWidth,setGanttBarWidth]=Object(external_kbnSharedDeps_React_.useState)(299),[jobGroupsMaps,setJobGroupsMaps]=Object(external_kbnSharedDeps_React_.useState)(maps),flyoutEl=Object(external_kbnSharedDeps_React_.useRef)(null),applySelection=Object(external_kbnSharedDeps_React_.useCallback)(()=>{const allNewSelection=[],groupSelection=[];newSelection.forEach(id=>{void 0!==jobGroupsMaps.groupsMap[id]?(allNewSelection.push(...jobGroupsMaps.groupsMap[id]),groupSelection.push({groupId:id,jobIds:jobGroupsMaps.groupsMap[id]})):allNewSelection.push(id)});const allNewSelectionUnique=Array.from(new Set(allNewSelection)),time=applyTimeRangeConfig?Object(job_select_service_utils.b)(jobs,allNewSelectionUnique):void 0;onSelectionConfirmed({newSelection:allNewSelectionUnique,jobIds:allNewSelectionUnique,groups:groupSelection,time:time})},[onSelectionConfirmed,newSelection,jobGroupsMaps,applyTimeRangeConfig]);function removeId(id){setNewSelection(newSelection.filter(item=>item!==id))}function toggleTimerangeSwitch(){onTimeRangeConfigChange&&onTimeRangeConfigChange(!applyTimeRangeConfig)}function clearSelection(){setNewSelection([])}function handleNewSelection({selectionFromTable:selectionFromTable}){setNewSelection(selectionFromTable)}const handleResize=Object(external_kbnSharedDeps_React_.useCallback)(()=>{if(0===jobs.length||!flyoutEl.current)return;const tableHeaderCols=flyoutEl.current.querySelectorAll("table thead th"),derivedWidth=tableHeaderCols[tableHeaderCols.length-1].offsetWidth-16,normalizedJobs=Object(job_select_service_utils.c)(jobs,dateFormatTz,derivedWidth);setJobs(normalizedJobs);const{groups:updatedGroups}=Object(job_select_service_utils.a)(normalizedJobs);setGroups(updatedGroups),setGanttBarWidth(derivedWidth)},[dateFormatTz,jobs]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{!async function(){try{const resp=await mlApiServices.jobs.jobsWithTimerange(dateFormatTz),normalizedJobs=Object(job_select_service_utils.c)(resp.jobs,dateFormatTz,299),{groups:groupsWithTimerange,groupsMap:groupsMap}=Object(job_select_service_utils.a)(normalizedJobs);setJobs(normalizedJobs),setGroups(groupsWithTimerange),setJobGroupsMaps({groupsMap:groupsMap,jobsMap:resp.jobsMap}),onJobsFetched&&onJobsFetched({groupsMap:groupsMap,jobsMap:resp.jobsMap})}catch(e){console.error("Error fetching jobs with time range",e);const{toasts:toasts}=notifications;toasts.addDanger({title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobSelector.jobFetchErrorMessage",{defaultMessage:"An error occurred fetching jobs. Refresh and try again."})})}setIsLoading(!1)}()},[]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyoutHeader,{hasBorder:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"m"},external_kbnSharedDeps_React_default.a.createElement("h2",{id:"flyoutTitle"},external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobSelector.flyoutTitle",{defaultMessage:"Job selection"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyoutBody,{className:"mlJobSelectorFlyoutBody"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiResizeObserver,{onResize:handleResize},resizeRef=>external_kbnSharedDeps_React_default.a.createElement("div",{ref:e=>{flyoutEl.current=e,resizeRef(e)}},isLoading?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiProgress,{size:"xs",color:"accent"}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"column",responsive:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{wrap:!0,responsive:!1,gutterSize:"xs",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(NewSelectionIdBadges,{limit:BADGE_LIMIT,maps:jobGroupsMaps,newSelection:newSelection,onDeleteClick:removeId,onLinkClick:()=>setShowAllBadges(!showAllBadges),showAllBadges:showAllBadges}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"row",justifyContent:"spaceBetween",responsive:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},!singleSelection&&newSelection.length>0&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{onClick:clearSelection,size:"xs","data-test-subj":"mlFlyoutJobSelectorButtonClearSelection"},external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobSelector.clearAllFlyoutButton",{defaultMessage:"Clear all"}))),withTimeRangeSelector&&void 0!==applyTimeRangeConfig&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSwitch,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobSelector.applyTimerangeSwitchLabel",{defaultMessage:"Apply time range"}),checked:applyTimeRangeConfig,onChange:toggleTimerangeSwitch,"data-test-subj":"mlFlyoutJobSelectorSwitchApplyTimeRange"}))))),external_kbnSharedDeps_React_default.a.createElement(JobSelectorTable,{jobs:jobs,ganttBarWidth:ganttBarWidth,groupsList:groups,onSelection:handleNewSelection,selectedIds:newSelection,singleSelection:singleSelection,timeseriesOnly:timeseriesOnly,withTimeRangeSelector:withTimeRangeSelector}))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyoutFooter,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{onClick:applySelection,fill:!0,isDisabled:0===newSelection.length,"data-test-subj":"mlFlyoutJobSelectorButtonApply"},external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobSelector.applyFlyoutButton",{defaultMessage:"Apply"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{iconType:"cross",onClick:onFlyoutClose,"data-test-subj":"mlFlyoutJobSelectorButtonClose"},external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobSelector.closeFlyoutButton",{defaultMessage:"Close"}))))))}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return CustomUrls}));var external_kbnSharedDeps_React_=__webpack_require__(14),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),external_kbnSharedDeps_ElasticEui_=__webpack_require__(39),external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(40),external_kbnSharedDeps_KbnI18n_=__webpack_require__(2),kibana=__webpack_require__(63),custom_url_utils=__webpack_require__(151);const URL_TYPE_KIBANA_DASHBOARD="KIBANA_DASHBOARD",URL_TYPE_KIBANA_DISCOVER="KIBANA_DISCOVER",URL_TYPE_OTHER="OTHER",TIME_RANGE_TYPE={AUTO:"auto",INTERVAL:"interval"};var external_kbnSharedDeps_RisonNode_=__webpack_require__(51),external_kbnSharedDeps_RisonNode_default=__webpack_require__.n(external_kbnSharedDeps_RisonNode_),url=__webpack_require__(471),url_default=__webpack_require__.n(url),public_=__webpack_require__(53),job_utils=__webpack_require__(69),parse_interval=__webpack_require__(26),ml_api_service=__webpack_require__(64),job_service=__webpack_require__(70),string_utils=__webpack_require__(89),dependency_cache=__webpack_require__(22),data_grid=__webpack_require__(110);function getNewCustomUrlDefaults(job,dashboards,indexPatterns){const kibanaSettings={queryFieldNames:[]};let urlType=URL_TYPE_OTHER;void 0!==dashboards&&dashboards.length>0?(urlType=URL_TYPE_KIBANA_DASHBOARD,kibanaSettings.dashboardId=dashboards[0].id):void 0!==indexPatterns&&indexPatterns.length>0&&(urlType=URL_TYPE_KIBANA_DISCOVER);const datafeedConfig=job.datafeed_config;if(void 0!==indexPatterns&&indexPatterns.length>0&&void 0!==datafeedConfig&&void 0!==datafeedConfig.indices&&datafeedConfig.indices.length>0){const datafeedIndex=datafeedConfig.indices[0];let defaultIndexPattern=indexPatterns.find(indexPattern=>indexPattern.title===datafeedIndex);void 0===defaultIndexPattern&&(defaultIndexPattern=indexPatterns[0]),kibanaSettings.discoverIndexPatternId=defaultIndexPattern.id}return{label:"",type:urlType,timeRange:{type:TIME_RANGE_TYPE.AUTO,interval:""},kibanaSettings:kibanaSettings,otherUrlSettings:{urlValue:""}}}function getQueryEntityFieldNames(job){const influencers=job.analysis_config.influencers,detectors=job.analysis_config.detectors,entityFieldNames=[];return void 0!==influencers&&entityFieldNames.push(...influencers),detectors.forEach((detector,detectorIndex)=>{Object(job_utils.h)(job,detectorIndex).forEach(fieldName=>{-1===entityFieldNames.indexOf(fieldName)&&entityFieldNames.push(fieldName)})}),entityFieldNames}function isValidCustomUrlSettingsTimeRange(timeRangeSettings){if(timeRangeSettings.type===TIME_RANGE_TYPE.INTERVAL){return null!==Object(parse_interval.a)(timeRangeSettings.interval)}return!0}function buildCustomUrlFromSettings(settings){if(settings.type===URL_TYPE_KIBANA_DASHBOARD)return function(settings){return new Promise((resolve,reject)=>{const{dashboardId:dashboardId,queryFieldNames:queryFieldNames}=settings.kibanaSettings;Object(dependency_cache.h)().get("dashboard",dashboardId).then(response=>{let filters=[],query=void 0;const searchSourceJSON=response.get("kibanaSavedObjectMeta.searchSourceJSON");if(void 0!==searchSourceJSON){const searchSourceData=JSON.parse(searchSourceJSON);void 0!==searchSourceData.filter&&(filters=searchSourceData.filter),query=searchSourceData.query}const queryFromEntityFieldNames=buildAppStateQueryParam(queryFieldNames);void 0!==queryFromEntityFieldNames&&(query=queryFromEntityFieldNames);return Object(dependency_cache.d)()(public_.DASHBOARD_APP_URL_GENERATOR).createUrl({dashboardId:dashboardId,timeRange:{from:"$earliest$",to:"$latest$",mode:"absolute"},filters:filters,query:query,useHash:!1}).then(urlValue=>{const urlToAdd={url_name:settings.label,url_value:decodeURIComponent("dashboards"+url_default.a.parse(urlValue).hash),time_range:TIME_RANGE_TYPE.AUTO};settings.timeRange.type===TIME_RANGE_TYPE.INTERVAL&&(urlToAdd.time_range=settings.timeRange.interval),resolve(urlToAdd)})}).catch(resp=>{reject(resp)})})}(settings);if(settings.type===URL_TYPE_KIBANA_DISCOVER)return Promise.resolve(function(settings){const{discoverIndexPatternId:discoverIndexPatternId,queryFieldNames:queryFieldNames}=settings.kibanaSettings,_g=external_kbnSharedDeps_RisonNode_default.a.encode({time:{from:"$earliest$",to:"$latest$",mode:"absolute"}}),appState={index:discoverIndexPatternId},queryFromEntityFieldNames=buildAppStateQueryParam(queryFieldNames);void 0!==queryFromEntityFieldNames&&(appState.query=queryFromEntityFieldNames);const _a=external_kbnSharedDeps_RisonNode_default.a.encode(appState),urlValue=`discover#/?_g=${_g}&_a=${_a}`,urlToAdd={url_name:settings.label,url_value:urlValue,time_range:TIME_RANGE_TYPE.AUTO};settings.timeRange.type===TIME_RANGE_TYPE.INTERVAL&&(urlToAdd.time_range=settings.timeRange.interval);return urlToAdd}(settings));{const urlToAdd={url_name:settings.label,url_value:settings.otherUrlSettings.urlValue};return Promise.resolve(urlToAdd)}}function buildAppStateQueryParam(queryFieldNames){let queryParam;if(void 0!==queryFieldNames&&queryFieldNames.length>0){let queryString="";queryFieldNames.forEach((fieldName,i)=>{i>0&&(queryString+=" and "),queryString+=`${Object(string_utils.c)(fieldName)}:"$${fieldName}$"`}),queryParam={language:"kuery",query:queryString}}return queryParam}function getTestUrl(job,customUrl){const urlValue=customUrl.url_value,bucketSpanSecs=Object(parse_interval.a)(job.analysis_config.bucket_span).asSeconds();let testUrl=customUrl.url_value;const body={query:{bool:{must:[{term:{job_id:job.job_id}},{term:{result_type:"record"}}]}},size:1,_source:{excludes:[]},sort:[{record_score:{order:"desc"}}]};return new Promise((resolve,reject)=>{ml_api_service.ml.results.anomalySearch({body:body},[job.job_id]).then(resp=>{if(resp.hits.total.value>0){const record=resp.hits.hits[0]._source;testUrl=Object(custom_url_utils.e)(customUrl,bucketSpanSecs,record,"timestamp"),resolve(testUrl)}else job_service.a.searchPreview(job).then(response=>{let testDoc;const docTimeFieldName=job.data_description.time_field;if(response.aggregations){const firstBucket=response.aggregations.buckets.buckets[0];testDoc={[docTimeFieldName]:firstBucket.key},urlValue.replace(/\$([^?&$\'"]{1,40})\$/g,(match,name)=>{if("earliest"!==name&&"latest"!==name&&void 0!==firstBucket[name]){const tokenBuckets=firstBucket[name];tokenBuckets.buckets&&(testDoc[name]=tokenBuckets.buckets[0].key)}})}else response.hits.total.value>0&&(testDoc=Object(data_grid.n)(response.hits.hits[0].fields));void 0!==testDoc&&(testUrl=Object(custom_url_utils.e)(customUrl,bucketSpanSecs,testDoc,docTimeFieldName)),resolve(testUrl)})}).catch(resp=>{reject(resp)})})}const CustomUrlList=({job:job,customUrls:customUrls,setCustomUrls:setCustomUrls})=>{const{services:{http:http,notifications:notifications}}=Object(kibana.b)(),[expandedUrlIndex,setExpandedUrlIndex]=Object(external_kbnSharedDeps_React_.useState)(null),customUrlRows=customUrls.map((customUrl,index)=>{const label=customUrl.url_name,otherUrls=[...customUrls];otherUrls.splice(index,1);const isInvalidLabel=!Object(custom_url_utils.b)(label,otherUrls),invalidLabelError=isInvalidLabel?[external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.customUrlEditorList.labelIsNotUniqueErrorMessage",{defaultMessage:"A unique label must be supplied"})]:[],isInvalidTimeRange=!function(timeRange){return void 0===timeRange||0===timeRange.length||timeRange===TIME_RANGE_TYPE.AUTO||null!==Object(parse_interval.a)(timeRange)}(customUrl.time_range),invalidIntervalError=isInvalidTimeRange?[external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.customUrlEditorList.invalidTimeRangeFormatErrorMessage",{defaultMessage:"Invalid format"})]:[];return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{key:"url_"+index,"data-test-subj":"mlJobEditCustomUrlItem_"+index},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.customUrlEditorList.labelLabel",defaultMessage:"Label"}),isInvalid:isInvalidLabel,error:invalidLabelError},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldText,{value:label,isInvalid:isInvalidLabel,onChange:e=>((e,index)=>{index<customUrls.length&&(customUrls[index]={...customUrls[index],url_name:e.target.value},setCustomUrls(customUrls))})(e,index),"data-test-subj":"mlJobEditCustomUrlLabelInput_"+index}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{fullWidth:!0,label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.customUrlEditorList.urlLabel",defaultMessage:"URL"})},index===expandedUrlIndex?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTextArea,{inputRef:input=>{input&&input.focus()},fullWidth:!0,value:customUrl.url_value,onChange:e=>((e,index)=>{index<customUrls.length&&(customUrls[index]={...customUrls[index],url_value:e.target.value},setCustomUrls(customUrls))})(e,index),onBlur:()=>{setExpandedUrlIndex(null)},"data-test-subj":"mlJobEditCustomUrlTextarea_"+index}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldText,{fullWidth:!0,value:customUrl.url_value,readOnly:!0,onFocus:()=>setExpandedUrlIndex(index),"data-test-subj":"mlJobEditCustomUrlInput_"+index}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.customUrlEditorList.timeRangeLabel",defaultMessage:"Time range"}),error:invalidIntervalError,isInvalid:isInvalidTimeRange},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldText,{value:customUrl.time_range||"",isInvalid:isInvalidTimeRange,placeholder:TIME_RANGE_TYPE.AUTO,onChange:e=>((e,index)=>{if(index<customUrls.length){customUrls[index]={...customUrls[index]};const timeRange=e.target.value;void 0!==timeRange&&timeRange.length>0?customUrls[index].time_range=timeRange:delete customUrls[index].time_range,setCustomUrls(customUrls)}})(e,index)}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{hasEmptyLabelSpace:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{content:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.customUrlEditorList.testCustomUrlTooltip",defaultMessage:"Test custom URL"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{size:"s",color:"primary",onClick:()=>(index=>{index<customUrls.length&&getTestUrl(job,customUrls[index]).then(testUrl=>{Object(custom_url_utils.d)(testUrl,customUrls[index],http.basePath.get())}).catch(resp=>{console.error("Error obtaining URL for test:",resp);const{toasts:toasts}=notifications;toasts.addDanger(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.customUrlEditorList.obtainingUrlToTestConfigurationErrorMessage",{defaultMessage:"An error occurred obtaining the URL to test the configuration"}))})})(index),iconType:"popout","aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.customUrlEditorList.testCustomUrlAriaLabel",{defaultMessage:"Test custom URL"})})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{hasEmptyLabelSpace:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{content:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.customUrlEditorList.deleteCustomUrlTooltip",defaultMessage:"Delete custom URL"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{size:"s",color:"danger",onClick:()=>(index=>{index<customUrls.length&&(customUrls.splice(index,1),setCustomUrls(customUrls))})(index),iconType:"trash","aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.customUrlEditorList.deleteCustomUrlAriaLabel",{defaultMessage:"Delete custom URL"})})))))});return external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":"mlJobEditCustomUrlsList"},customUrlRows)};const CustomUrlEditor=({customUrl:customUrl,setEditCustomUrl:setEditCustomUrl,savedCustomUrls:savedCustomUrls,dashboards:dashboards,indexPatterns:indexPatterns,queryEntityFieldNames:queryEntityFieldNames})=>{if(void 0===customUrl)return null;const{label:label,type:type,timeRange:timeRange,kibanaSettings:kibanaSettings,otherUrlSettings:otherUrlSettings}=customUrl,dashboardOptions=dashboards.map(dashboard=>({value:dashboard.id,text:dashboard.title})),indexPatternOptions=indexPatterns.map(indexPattern=>({value:indexPattern.id,text:indexPattern.title})),entityOptions=queryEntityFieldNames.map(fieldName=>({label:fieldName}));let selectedEntityOptions=[];if(void 0!==kibanaSettings&&void 0!==kibanaSettings.queryFieldNames){selectedEntityOptions=kibanaSettings.queryFieldNames.map(fieldName=>({label:fieldName}))}const timeRangeOptions=Object.values(TIME_RANGE_TYPE).map(timeRangeType=>({value:timeRangeType,text:timeRangeType})),isInvalidLabel=!Object(custom_url_utils.b)(label,savedCustomUrls),invalidLabelError=isInvalidLabel?[external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.customUrlsEditor.invalidLabelErrorMessage",{defaultMessage:"A unique label must be supplied"})]:[],isInvalidTimeRange=!isValidCustomUrlSettingsTimeRange(timeRange),invalidIntervalError=isInvalidTimeRange?[external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.customUrlsList.invalidIntervalFormatErrorMessage",{defaultMessage:"Invalid interval format"})]:[];return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("h4",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.customUrlsEditor.createNewCustomUrlTitle",defaultMessage:"Create new custom URL"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiForm,{className:"ml-edit-url-form"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.customUrlsEditor.labelLabel",defaultMessage:"Label"}),className:"url-label",error:invalidLabelError,isInvalid:isInvalidLabel,display:"rowCompressed"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldText,{name:"label",value:label,onChange:e=>{setEditCustomUrl({...customUrl,label:e.target.value})},isInvalid:isInvalidLabel,compressed:!0,"data-test-subj":"mlJobCustomUrlLabelInput"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.customUrlsEditor.linkToLabel",defaultMessage:"Link to"}),display:"rowCompressed"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiRadioGroup,{options:[{id:URL_TYPE_KIBANA_DASHBOARD,label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.customUrlEditor.kibanaDashboardLabel",{defaultMessage:"Kibana dashboard"})},{id:URL_TYPE_KIBANA_DISCOVER,label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.customUrlEditor.discoverLabel",{defaultMessage:"Discover"})},{id:URL_TYPE_OTHER,label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.customUrlEditor.otherLabel",{defaultMessage:"Other"})}],idSelected:type,onChange:linkType=>{setEditCustomUrl({...customUrl,type:linkType})},className:"url-link-to-radio"})),type===URL_TYPE_KIBANA_DASHBOARD&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.customUrlsEditor.dashboardNameLabel",defaultMessage:"Dashboard name"}),display:"rowCompressed"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSelect,{options:dashboardOptions,value:kibanaSettings.dashboardId,onChange:e=>{const kibanaSettings=customUrl.kibanaSettings;setEditCustomUrl({...customUrl,kibanaSettings:{...kibanaSettings,dashboardId:e.target.value}})},compressed:!0})),type===URL_TYPE_KIBANA_DISCOVER&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.customUrlsEditor.indexPatternLabel",defaultMessage:"Index pattern"}),display:"rowCompressed"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSelect,{options:indexPatternOptions,value:kibanaSettings.discoverIndexPatternId,onChange:e=>{const kibanaSettings=customUrl.kibanaSettings;setEditCustomUrl({...customUrl,kibanaSettings:{...kibanaSettings,discoverIndexPatternId:e.target.value}})},compressed:!0})),(type===URL_TYPE_KIBANA_DASHBOARD||type===URL_TYPE_KIBANA_DISCOVER)&&entityOptions.length>0&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.customUrlsEditor.queryEntitiesLabel",defaultMessage:"Query entities"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiComboBox,{placeholder:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.customUrlsEditor.selectEntitiesPlaceholder",{defaultMessage:"Select entities"}),options:entityOptions,selectedOptions:selectedEntityOptions,onChange:selectedOptions=>{const selectedFieldNames=selectedOptions.map(option=>option.label),kibanaSettings=customUrl.kibanaSettings;setEditCustomUrl({...customUrl,kibanaSettings:{...kibanaSettings,queryFieldNames:selectedFieldNames}})},isClearable:!0})),(type===URL_TYPE_KIBANA_DASHBOARD||type===URL_TYPE_KIBANA_DISCOVER)&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.customUrlsEditor.timeRangeLabel",defaultMessage:"Time range"}),className:"url-time-range",display:"rowCompressed"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSelect,{options:timeRangeOptions,value:timeRange.type,onChange:e=>{const timeRange=customUrl.timeRange;setEditCustomUrl({...customUrl,timeRange:{...timeRange,type:e.target.value}})},compressed:!0}))),timeRange.type===TIME_RANGE_TYPE.INTERVAL&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.customUrlsEditor.intervalLabel",defaultMessage:"Interval"}),className:"url-time-range",error:invalidIntervalError,isInvalid:isInvalidTimeRange,display:"rowCompressed"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldText,{value:timeRange.interval,onChange:e=>{const timeRange=customUrl.timeRange;setEditCustomUrl({...customUrl,timeRange:{...timeRange,interval:e.target.value}})},isInvalid:isInvalidTimeRange,compressed:!0}))))),type===URL_TYPE_OTHER&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.customUrlsEditor.urlLabel",defaultMessage:"URL"}),display:"rowCompressed",fullWidth:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTextArea,{fullWidth:!0,rows:2,value:otherUrlSettings.urlValue,onChange:e=>{setEditCustomUrl({...customUrl,otherUrlSettings:{urlValue:e.target.value}})},compressed:!0}))))};var kibanaReact_public_=__webpack_require__(42),edit_utils=__webpack_require__(322);function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class custom_urls_CustomUrlsUI extends external_kbnSharedDeps_React_.Component{constructor(props){super(props),_defineProperty(this,"editNewCustomUrl",()=>{this.setState(prevState=>{const{dashboards:dashboards,indexPatterns:indexPatterns}=prevState;return{editorOpen:!0,editorSettings:getNewCustomUrlDefaults(this.props.job,dashboards,indexPatterns)}})}),_defineProperty(this,"setEditCustomUrl",customUrl=>{this.setState({editorSettings:customUrl})}),_defineProperty(this,"addNewCustomUrl",()=>{buildCustomUrlFromSettings(this.state.editorSettings).then(customUrl=>{const customUrls=[...this.state.customUrls,customUrl];this.props.setCustomUrls(customUrls),this.setState({editorOpen:!1})}).catch(error=>{console.error("Error building custom URL from settings:",error);const{toasts:toasts}=this.props.kibana.services.notifications;toasts.addDanger(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.editJobFlyout.customUrls.addNewUrlErrorNotificationMessage",{defaultMessage:"An error occurred building the new custom URL from the supplied settings"}))})}),_defineProperty(this,"onTestButtonClick",()=>{const{http:{basePath:basePath},notifications:{toasts:toasts}}=this.props.kibana.services,job=this.props.job;buildCustomUrlFromSettings(this.state.editorSettings).then(customUrl=>{getTestUrl(job,customUrl).then(testUrl=>{Object(custom_url_utils.d)(testUrl,customUrl,basePath.get())}).catch(resp=>{console.error("Error obtaining URL for test:",resp),toasts.addWarning(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.editJobFlyout.customUrls.getTestUrlErrorNotificationMessage",{defaultMessage:"An error occurred obtaining the URL to test the configuration"}))})}).catch(resp=>{console.error("Error building custom URL from settings:",resp),toasts.addWarning(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.editJobFlyout.customUrls.buildUrlErrorNotificationMessage",{defaultMessage:"An error occurred building the custom URL for testing from the supplied settings"}))})}),_defineProperty(this,"closeEditor",()=>{this.setState({editorOpen:!1})}),this.state={customUrls:[],dashboards:[],indexPatterns:[],queryEntityFieldNames:[],editorOpen:!1}}static getDerivedStateFromProps(props){return{job:props.job,customUrls:props.jobCustomUrls,queryEntityFieldNames:getQueryEntityFieldNames(props.job)}}componentDidMount(){const{toasts:toasts}=this.props.kibana.services.notifications;Object(edit_utils.b)(1e3).then(dashboards=>{this.setState({dashboards:dashboards})}).catch(resp=>{console.error("Error loading list of dashboards:",resp),toasts.addDanger(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.editJobFlyout.customUrls.loadSavedDashboardsErrorNotificationMessage",{defaultMessage:"An error occurred loading the list of saved Kibana dashboards"}))}),Object(edit_utils.a)(1e3).then(indexPatterns=>{this.setState({indexPatterns:indexPatterns})}).catch(resp=>{console.error("Error loading list of dashboards:",resp),toasts.addDanger(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.editJobFlyout.customUrls.loadIndexPatternsErrorNotificationMessage",{defaultMessage:"An error occurred loading the list of saved index patterns"}))})}renderEditor(){var _this$props$editMode;const{customUrls:customUrls,editorOpen:editorOpen,editorSettings:editorSettings,dashboards:dashboards,indexPatterns:indexPatterns,queryEntityFieldNames:queryEntityFieldNames}=this.state,editMode=null!==(_this$props$editMode=this.props.editMode)&&void 0!==_this$props$editMode?_this$props$editMode:"inline",editor=external_kbnSharedDeps_React_default.a.createElement(CustomUrlEditor,{customUrl:editorSettings,setEditCustomUrl:this.setEditCustomUrl,savedCustomUrls:customUrls,dashboards:dashboards,indexPatterns:indexPatterns,queryEntityFieldNames:queryEntityFieldNames}),isValidEditorSettings=!editorOpen||void 0===editorSettings||function(settings,savedCustomUrls){let isValid=Object(custom_url_utils.b)(settings.label,savedCustomUrls);return!0===isValid&&(isValid=isValidCustomUrlSettingsTimeRange(settings.timeRange)),isValid}(editorSettings,customUrls),addButton=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{onClick:this.addNewCustomUrl,isDisabled:!isValidEditorSettings,"data-test-subj":"mlJobAddCustomUrl"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.customUrls.addButtonLabel",defaultMessage:"Add"})),testButton=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{iconType:"popout",iconSide:"right",onClick:this.onTestButtonClick,isDisabled:!isValidEditorSettings},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.customUrls.testButtonLabel",defaultMessage:"Test"}));return"inline"===editMode?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPanel,{className:"edit-custom-url-panel"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{color:"text",onClick:this.closeEditor,iconType:"cross","aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.editJobFlyout.customUrls.closeEditorAriaLabel",{defaultMessage:"Close custom URL editor"}),className:"close-editor-button"}),editor,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},addButton),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},testButton))):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModal,{onClose:this.closeEditor,initialFocus:"[name=label]",style:{width:500},"data-test-subj":"mlJobNewCustomUrlFormModal"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalHeader,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalHeaderTitle,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.customUrls.addCustomUrlButtonLabel",defaultMessage:"Add custom URL"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalBody,null,editor),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalFooter,null,testButton,addButton))}render(){const{customUrls:customUrls,editorOpen:editorOpen}=this.state,{editMode:editMode="inline"}=this.props;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),(!editorOpen||"modal"===editMode)&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{size:"s",onClick:this.editNewCustomUrl,"data-test-subj":"mlJobOpenCustomUrlFormButton"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.customUrls.addCustomUrlButtonLabel",defaultMessage:"Add custom URL"})),editorOpen&&this.renderEditor(),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(CustomUrlList,{job:this.props.job,customUrls:customUrls,setCustomUrls:this.props.setCustomUrls}))}}const CustomUrls=Object(kibanaReact_public_.withKibana)(custom_urls_CustomUrlsUI)},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return AnnotationFlyout}));var external_kbnSharedDeps_React_=__webpack_require__(14),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),useObservable=__webpack_require__(134),useObservable_default=__webpack_require__.n(useObservable),external_kbnSharedDeps_Lodash_=__webpack_require__(7),external_kbnSharedDeps_ElasticEui_=__webpack_require__(39),external_kbnSharedDeps_KbnI18n_=__webpack_require__(2),external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(40),annotations=__webpack_require__(137),annotations_service=__webpack_require__(136),date_utils=__webpack_require__(72);const AnnotationDescriptionList=({annotation:annotation,detectorDescription:detectorDescription})=>{const listItems=[{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.annotationDescriptionList.jobIdTitle",{defaultMessage:"Job ID"}),description:annotation.job_id},{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.annotationDescriptionList.startTitle",{defaultMessage:"Start"}),description:Object(date_utils.c)(annotation.timestamp)}];var _annotation$create_us,_annotation$modified_,_annotation$partition,_annotation$over_fiel,_annotation$by_field_;(void 0!==annotation.end_timestamp&&listItems.push({title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.annotationDescriptionList.endTitle",{defaultMessage:"End"}),description:Object(date_utils.c)(annotation.end_timestamp)}),void 0!==annotation.create_time&&void 0!==annotation.modified_time)&&(listItems.push({title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.annotationDescriptionList.createdTitle",{defaultMessage:"Created"}),description:Object(date_utils.c)(annotation.create_time)}),listItems.push({title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.annotationDescriptionList.createdByTitle",{defaultMessage:"Created by"}),description:null!==(_annotation$create_us=annotation.create_username)&&void 0!==_annotation$create_us?_annotation$create_us:""}),listItems.push({title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.annotationDescriptionList.lastModifiedTitle",{defaultMessage:"Last modified"}),description:Object(date_utils.c)(annotation.modified_time)}),listItems.push({title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.annotationDescriptionList.modifiedByTitle",{defaultMessage:"Modified by"}),description:null!==(_annotation$modified_=annotation.modified_username)&&void 0!==_annotation$modified_?_annotation$modified_:""}));(void 0!==detectorDescription&&listItems.push({title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.annotationDescriptionList.detectorTitle",{defaultMessage:"Detector"}),description:detectorDescription}),void 0!==annotation.partition_field_name)&&listItems.push({title:annotation.partition_field_name,description:null!==(_annotation$partition=annotation.partition_field_value)&&void 0!==_annotation$partition?_annotation$partition:""});void 0!==annotation.over_field_name&&listItems.push({title:annotation.over_field_name,description:null!==(_annotation$over_fiel=annotation.over_field_value)&&void 0!==_annotation$over_fiel?_annotation$over_fiel:""});void 0!==annotation.by_field_name&&listItems.push({title:annotation.by_field_name,description:null!==(_annotation$by_field_=annotation.by_field_value)&&void 0!==_annotation$by_field_?_annotation$by_field_:""});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDescriptionList,{className:"ml-annotation-description-list",type:"column",listItems:listItems})},DeleteAnnotationModal=({cancelAction:cancelAction,deleteAction:deleteAction,isVisible:isVisible})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,!0===isVisible&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiConfirmModal,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.deleteAnnotationModal.deleteAnnotationTitle",defaultMessage:"Delete this annotation?"}),onCancel:cancelAction,onConfirm:deleteAction,cancelButtonText:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.deleteAnnotationModal.cancelButtonLabel",defaultMessage:"Cancel"}),confirmButtonText:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.deleteAnnotationModal.deleteButtonLabel",defaultMessage:"Delete"}),buttonColor:"danger",defaultFocusedButton:external_kbnSharedDeps_ElasticEui_.EUI_MODAL_CONFIRM_BUTTON,className:"eui-textBreakWord"}));var ml_api_service=__webpack_require__(64),dependency_cache=__webpack_require__(22);function getAnnotationFieldName(fieldType){return fieldType+"_name"}function getAnnotationFieldValue(fieldType){return fieldType+"_value"}var anomalies=__webpack_require__(1),ml_annotation_updates_context=__webpack_require__(138);function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class annotation_flyout_AnnotationFlyoutUI extends external_kbnSharedDeps_React_.Component{constructor(...args){super(...args),_defineProperty(this,"state",{isDeleteModalVisible:!1,applyAnnotationToSeries:!0,annotationState:null}),_defineProperty(this,"annotationSub",null),_defineProperty(this,"annotationTextChangeHandler",e=>{if(null===this.state.annotationState)return;const{annotationUpdatesService:annotationUpdatesService}=this.props;annotationUpdatesService.setValue({...this.state.annotationState,annotation:e.target.value})}),_defineProperty(this,"cancelEditingHandler",()=>{const{annotationUpdatesService:annotationUpdatesService}=this.props;annotationUpdatesService.setValue(null)}),_defineProperty(this,"deleteConfirmHandler",()=>{this.setState({isDeleteModalVisible:!0})}),_defineProperty(this,"deleteHandler",async()=>{const{annotationState:annotationState}=this.state,toastNotifications=Object(dependency_cache.j)();if(null===annotationState||void 0===annotationState._id)return;try{await ml_api_service.ml.annotations.deleteAnnotation(annotationState._id),toastNotifications.addSuccess(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.deletedAnnotationNotificationMessage",{defaultMessage:"Deleted annotation for job with ID {jobId}.",values:{jobId:annotationState.job_id}}))}catch(err){toastNotifications.addDanger(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.errorWithDeletingAnnotationNotificationErrorMessage",{defaultMessage:"An error occurred deleting the annotation for job with ID {jobId}: {error}",values:{jobId:annotationState.job_id,error:JSON.stringify(err)}}))}this.closeDeleteModal();const{annotationUpdatesService:annotationUpdatesService}=this.props;annotationUpdatesService.setValue(null),Object(annotations_service.c)()}),_defineProperty(this,"closeDeleteModal",()=>{this.setState({isDeleteModalVisible:!1})}),_defineProperty(this,"validateAnnotationText",()=>{const{annotationState:annotationState}=this.state,errors=[];if(null===annotationState)return errors;0===annotationState.annotation.trim().length&&errors.push(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.annotationFlyout.noAnnotationTextError",{defaultMessage:"Enter annotation text"}));const textLength=annotationState.annotation.length;if(textLength>annotations.c){const charsOver=textLength-annotations.c;errors.push(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.annotationFlyout.maxLengthError",{defaultMessage:"{charsOver, number} {charsOver, plural, one {character} other {characters}} above maximum length of {maxChars}",values:{maxChars:annotations.c,charsOver:charsOver}}))}return errors}),_defineProperty(this,"saveOrUpdateAnnotation",()=>{var _chartDetails$entityD,_annotation$event;const{annotationState:originalAnnotation}=this.state,{chartDetails:chartDetails,detectorIndex:detectorIndex,annotationUpdatesService:annotationUpdatesService}=this.props;if(null===originalAnnotation)return;const annotation=Object(external_kbnSharedDeps_Lodash_.cloneDeep)(originalAnnotation);this.state.applyAnnotationToSeries&&null!=chartDetails&&null!==(_chartDetails$entityD=chartDetails.entityData)&&void 0!==_chartDetails$entityD&&_chartDetails$entityD.entities&&(chartDetails.entityData.entities.forEach(entity=>{const{fieldName:fieldName,fieldValue:fieldValue}=entity,fieldType=entity.fieldType;annotation[getAnnotationFieldName(fieldType)]=fieldName,annotation[getAnnotationFieldValue(fieldType)]=fieldValue}),annotation.detector_index=detectorIndex),this.state.applyAnnotationToSeries||(delete annotation.detector_index,anomalies.e.forEach(fieldType=>{delete annotation[getAnnotationFieldName(fieldType)],delete annotation[getAnnotationFieldValue(fieldType)]})),annotation.event=null!==(_annotation$event=annotation.event)&&void 0!==_annotation$event?_annotation$event:annotations.b,annotationUpdatesService.setValue(null),ml_api_service.ml.annotations.indexAnnotation(annotation).then(()=>{Object(annotations_service.c)();const toastNotifications=Object(dependency_cache.j)();void 0===annotation._id?toastNotifications.addSuccess(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.addedAnnotationNotificationMessage",{defaultMessage:"Added an annotation for job with ID {jobId}.",values:{jobId:annotation.job_id}})):toastNotifications.addSuccess(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.updatedAnnotationNotificationMessage",{defaultMessage:"Updated annotation for job with ID {jobId}.",values:{jobId:annotation.job_id}}))}).catch(resp=>{const toastNotifications=Object(dependency_cache.j)();void 0===annotation._id?toastNotifications.addDanger(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.errorWithCreatingAnnotationNotificationErrorMessage",{defaultMessage:"An error occurred creating the annotation for job with ID {jobId}: {error}",values:{jobId:annotation.job_id,error:JSON.stringify(resp)}})):toastNotifications.addDanger(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.errorWithUpdatingAnnotationNotificationErrorMessage",{defaultMessage:"An error occurred updating the annotation for job with ID {jobId}: {error}",values:{jobId:annotation.job_id,error:JSON.stringify(resp)}}))})})}componentDidMount(){const{annotationUpdatesService:annotationUpdatesService}=this.props;this.annotationSub=annotationUpdatesService.update$().subscribe(v=>{this.setState({annotationState:v})})}componentWillUnmount(){this.annotationSub.unsubscribe()}render(){const{detectors:detectors,detectorIndex:detectorIndex}=this.props,{annotationState:annotationState,isDeleteModalVisible:isDeleteModalVisible}=this.state;if(!annotationState)return null;const isExistingAnnotation=void 0!==annotationState._id,validationErrors=this.validateAnnotationText(),isInvalid=validationErrors.length>0;let helpText=null;!1===isInvalid&&annotationState.annotation.length>.95*annotations.c&&(helpText=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.annotationFlyout.approachingMaxLengthWarning",{defaultMessage:"{charsRemaining, number} {charsRemaining, plural, one {character} other {characters}} remaining",values:{charsRemaining:annotations.c-annotationState.annotation.length}}));const detector=detectors?detectors.find(d=>d.index===detectorIndex):void 0,detectorDescription=detector&&"detector_description"in detector?detector.detector_description:"";return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyoutBody,null,external_kbnSharedDeps_React_default.a.createElement(AnnotationDescriptionList,{annotation:annotationState,detectorDescription:detectorDescription}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.annotationFlyout.annotationTextLabel",defaultMessage:"Annotation text"}),fullWidth:!0,helpText:helpText,isInvalid:isInvalid,error:validationErrors},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTextArea,{fullWidth:!0,isInvalid:isInvalid,onChange:this.annotationTextChangeHandler,placeholder:"...",value:annotationState.annotation})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCheckbox,{id:"xpack.ml.annotationFlyout.applyToPartition",label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.annotationFlyout.applyToPartitionTextLabel",defaultMessage:"Apply annotation to this series"}),checked:this.state.applyAnnotationToSeries,onChange:()=>this.setState({applyAnnotationToSeries:!this.state.applyAnnotationToSeries})}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyoutFooter,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{onClick:this.cancelEditingHandler,flush:"left"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.annotationFlyout.cancelButtonLabel",defaultMessage:"Cancel"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,style:{marginLeft:"auto"}},isExistingAnnotation&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{color:"danger",onClick:this.deleteConfirmHandler},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.annotationFlyout.deleteButtonLabel",defaultMessage:"Delete"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{fill:!0,isDisabled:!0===isInvalid,onClick:this.saveOrUpdateAnnotation,"data-test-subj":"annotationFlyoutUpdateButton"},isExistingAnnotation?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.annotationFlyout.updateButtonLabel",defaultMessage:"Update"}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.annotationFlyout.createButtonLabel",defaultMessage:"Create"}))))),external_kbnSharedDeps_React_default.a.createElement(DeleteAnnotationModal,{cancelAction:this.closeDeleteModal,deleteAction:this.deleteHandler,isVisible:isDeleteModalVisible}))}}const AnnotationFlyout=props=>{const annotationUpdatesService=Object(external_kbnSharedDeps_React_.useContext)(ml_annotation_updates_context.a),annotationProp=useObservable_default()(annotationUpdatesService.isAnnotationInitialized$()),cancelEditingHandler=Object(external_kbnSharedDeps_React_.useCallback)(()=>{annotationUpdatesService.setValue(null)},[]);if(null==annotationProp)return null;const isExistingAnnotation=void 0!==annotationProp._id;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyout,{onClose:cancelEditingHandler,size:"m","aria-labelledby":"Add annotation","data-test-subj":"mlAnnotationFlyout",className:"mlAnnotationFlyout"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyoutHeader,{hasBorder:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"s"},external_kbnSharedDeps_React_default.a.createElement("h2",{id:"mlAnnotationFlyoutTitle"},isExistingAnnotation?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.annotationFlyout.editAnnotationTitle",defaultMessage:"Edit annotation"}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.annotationFlyout.addAnnotationTitle",defaultMessage:"Add annotation"})))),external_kbnSharedDeps_React_default.a.createElement(annotation_flyout_AnnotationFlyoutUI,_extends({},props,{annotationUpdatesService:annotationUpdatesService})))}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"getDefaultSwimlanePanelTitle",(function(){return getDefaultSwimlanePanelTitle})),__webpack_require__.d(__webpack_exports__,"AnomalySwimlaneEmbeddable",(function(){return anomaly_swimlane_embeddable_AnomalySwimlaneEmbeddable}));var external_kbnSharedDeps_React_=__webpack_require__(14),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),external_kbnSharedDeps_ReactDom_=__webpack_require__(46),external_kbnSharedDeps_ReactDom_default=__webpack_require__.n(external_kbnSharedDeps_ReactDom_),external_kbnSharedDeps_KbnI18n_=__webpack_require__(2),external_kbnSharedDeps_Rxjs_=__webpack_require__(23),public_=__webpack_require__(42),embeddable_public_=__webpack_require__(45);const EmbeddableSwimLaneContainer=external_kbnSharedDeps_React_default.a.lazy(()=>__webpack_require__.e(16).then(__webpack_require__.bind(null,886)));var ui_actions=__webpack_require__(181),embeddables=__webpack_require__(103),embeddable_loading_fallback=__webpack_require__(158);function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}const getDefaultSwimlanePanelTitle=jobIds=>external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.swimlaneEmbeddable.title",{defaultMessage:"ML anomaly swim lane for {jobIds}",values:{jobIds:jobIds.join(", ")}});class anomaly_swimlane_embeddable_AnomalySwimlaneEmbeddable extends embeddable_public_.Embeddable{constructor(initialInput,services,parent){super(initialInput,{defaultTitle:initialInput.title},parent),this.services=services,_defineProperty(this,"node",void 0),_defineProperty(this,"reload$",new external_kbnSharedDeps_Rxjs_.Subject),_defineProperty(this,"type",embeddables.b)}render(node){super.render(node),this.node=node;const I18nContext=this.services[0].i18n.Context;external_kbnSharedDeps_ReactDom_default.a.render(external_kbnSharedDeps_React_default.a.createElement(I18nContext,null,external_kbnSharedDeps_React_default.a.createElement(public_.KibanaContextProvider,{services:{...this.services[0]}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Suspense,{fallback:external_kbnSharedDeps_React_default.a.createElement(embeddable_loading_fallback.a,null)},external_kbnSharedDeps_React_default.a.createElement(EmbeddableSwimLaneContainer,{id:this.input.id,embeddableContext:this,embeddableInput:this.getInput$(),services:this.services,refresh:this.reload$.asObservable(),onInputChange:this.updateInput.bind(this),onOutputChange:this.updateOutput.bind(this)})))),node)}destroy(){super.destroy(),this.node&&external_kbnSharedDeps_ReactDom_default.a.unmountComponentAtNode(this.node)}reload(){this.reload$.next()}supportedTriggers(){return[ui_actions.a]}}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"getDefaultExplorerChartsPanelTitle",(function(){return getDefaultExplorerChartsPanelTitle})),__webpack_require__.d(__webpack_exports__,"AnomalyChartsEmbeddable",(function(){return anomaly_charts_embeddable_AnomalyChartsEmbeddable}));var external_kbnSharedDeps_React_=__webpack_require__(14),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),external_kbnSharedDeps_ReactDom_=__webpack_require__(46),external_kbnSharedDeps_ReactDom_default=__webpack_require__.n(external_kbnSharedDeps_ReactDom_),external_kbnSharedDeps_KbnI18n_=__webpack_require__(2),external_kbnSharedDeps_Rxjs_=__webpack_require__(23),public_=__webpack_require__(42),embeddable_public_=__webpack_require__(45);const EmbeddableAnomalyChartsContainer=external_kbnSharedDeps_React_default.a.lazy(()=>Promise.all([__webpack_require__.e(0),__webpack_require__.e(1),__webpack_require__.e(3),__webpack_require__.e(17)]).then(__webpack_require__.bind(null,884)));var embeddables=__webpack_require__(103),embeddable_loading_fallback=__webpack_require__(158);function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}const getDefaultExplorerChartsPanelTitle=jobIds=>external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.anomalyChartsEmbeddable.title",{defaultMessage:"ML anomaly charts for {jobIds}",values:{jobIds:jobIds.join(", ")}});class anomaly_charts_embeddable_AnomalyChartsEmbeddable extends embeddable_public_.Embeddable{constructor(initialInput,services,parent){super(initialInput,{defaultTitle:initialInput.title},parent),this.services=services,_defineProperty(this,"node",void 0),_defineProperty(this,"reload$",new external_kbnSharedDeps_Rxjs_.Subject),_defineProperty(this,"type",embeddables.a),this.initializeOutput(initialInput)}async initializeOutput(initialInput){const{anomalyExplorerService:anomalyExplorerService}=this.services[2],{jobIds:jobIds}=initialInput;try{const jobs=await anomalyExplorerService.getCombinedJobs(jobIds),indexPatternsService=this.services[1].data.indexPatterns,indices=new Set(jobs.map(j=>j.datafeed_config.indices).flat()),indexPatterns={};for(const indexName of indices){const indexPattern=(await indexPatternsService.find(`"${indexName}"`)).find(obj=>obj.title.toLowerCase()===indexName.toLowerCase());void 0!==indexPattern&&(indexPatterns[indexPattern.id]=indexPattern)}this.updateOutput({...this.getOutput(),indexPatterns:Object.values(indexPatterns)})}catch(e){console.error("Unable to load index patterns for "+jobIds,e)}}render(node){super.render(node),this.node=node;const I18nContext=this.services[0].i18n.Context;external_kbnSharedDeps_ReactDom_default.a.render(external_kbnSharedDeps_React_default.a.createElement(I18nContext,null,external_kbnSharedDeps_React_default.a.createElement(public_.KibanaContextProvider,{services:{...this.services[0]}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Suspense,{fallback:external_kbnSharedDeps_React_default.a.createElement(embeddable_loading_fallback.a,null)},external_kbnSharedDeps_React_default.a.createElement(EmbeddableAnomalyChartsContainer,{id:this.input.id,embeddableContext:this,embeddableInput:this.getInput$(),services:this.services,refresh:this.reload$.asObservable(),onInputChange:this.updateInput.bind(this),onOutputChange:this.updateOutput.bind(this)})))),node)}destroy(){super.destroy(),this.node&&external_kbnSharedDeps_ReactDom_default.a.unmountComponentAtNode(this.node)}reload(){this.reload$.next()}supportedTriggers(){return[]}}},,function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return NodeAvailableWarning}));var external_kbnSharedDeps_React_=__webpack_require__(14),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),external_kbnSharedDeps_ElasticEui_=__webpack_require__(39),external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(40),ml_nodes_check=__webpack_require__(125),ml_server_info=__webpack_require__(88);const NodeAvailableWarning=()=>{if(!0===Object(ml_nodes_check.d)()||!1===Object(ml_nodes_check.e)())return null;const id=Object(ml_server_info.a)();return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.nodeAvailableWarning.noMLNodesAvailableTitle",defaultMessage:"No ML nodes available"}),color:"warning",iconType:"alert"},external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.nodeAvailableWarning.noMLNodesAvailableDescription",defaultMessage:"There are no ML nodes available."})),external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.nodeAvailableWarning.unavailableCreateOrRunJobsDescription",defaultMessage:"You will not be able to create or run jobs."})),Object(ml_server_info.d)()&&null!==id&&external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.nodeAvailableWarning.linkToCloudDescription",defaultMessage:"Please edit your {link}. You may enable a free 1GB machine learning node or expand your existing ML configuration.",values:{link:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{href:"https://cloud.elastic.co/deployments?q="+id},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.nodeAvailableWarning.linkToCloud.hereLinkText",defaultMessage:"Elastic Cloud deployment"}))}}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}))}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return SavedObjectsWarning}));var external_kbnSharedDeps_React_=__webpack_require__(14),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),external_kbnSharedDeps_ElasticEui_=__webpack_require__(39),external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(40),kibana=__webpack_require__(63);const SavedObjectsWarning=({jobType:jobType})=>{const{savedObjects:{initSavedObjects:initSavedObjects}}=Object(kibana.a)(),{services:{http:{basePath:basePath}}}=Object(kibana.b)(),[showWarning,setShowWarning]=Object(external_kbnSharedDeps_React_.useState)(!1);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{let unmounted=!1;return initSavedObjects(!0).then(({jobs:jobs})=>{if(!0===unmounted)return;const missingJobs=jobs.length>0&&(void 0===jobType||jobs.some(({type:type})=>type===jobType));setShowWarning(missingJobs)}).catch(()=>{console.log("Saved object synchronization check could not be performed.")}),()=>{unmounted=!0}},[]),!1===showWarning?null:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.missingSavedObjectWarning.title",defaultMessage:"ML job synchronization required"}),color:"warning",iconType:"alert"},external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.missingSavedObjectWarning.description",defaultMessage:"Some jobs are missing their saved object and require synchronization in {link}.",values:{link:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{href:basePath.get()+"/app/management/insightsAndAlerting/jobsListLink"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.missingSavedObjectWarning.linkToManagement.link",defaultMessage:"Stack Management"}))}}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}))}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return UpgradeWarning}));var external_kbnSharedDeps_React_=__webpack_require__(14),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),external_kbnSharedDeps_ElasticEui_=__webpack_require__(39),external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(40),upgrade_service=__webpack_require__(312);const UpgradeWarning=()=>!0===Object(upgrade_service.a)()?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.upgrade.upgradeWarning.upgradeInProgressWarningTitle",defaultMessage:"Index migration in progress"}),color:"warning",iconType:"alert"},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.upgrade.upgradeWarning.upgradeInProgressWarningDescription",defaultMessage:"Indices related to Machine Learning are currently being upgraded."}),external_kbnSharedDeps_React_default.a.createElement("br",null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.upgrade.upgradeWarning.upgradeInProgressWarningDescriptionExtra",defaultMessage:"Some actions will not be available during this time."}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"})):null},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return AnnotationsTable}));var external_kbnSharedDeps_Lodash_=__webpack_require__(7),external_kbnSharedDeps_React_=__webpack_require__(14),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),memoize_one_cjs=__webpack_require__(247),memoize_one_cjs_default=__webpack_require__.n(memoize_one_cjs),external_kbnSharedDeps_ElasticEui_=__webpack_require__(39),external_kbnSharedDeps_KbnI18n_=__webpack_require__(2),external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(40),external_kbnSharedDeps_ElasticEuiLibServices_=__webpack_require__(52),recently_accessed=__webpack_require__(194),ml_api_service=__webpack_require__(64),job_service=__webpack_require__(70),table_service=__webpack_require__(246),constants_search=__webpack_require__(101),job_utils=__webpack_require__(69),annotations_service=__webpack_require__(136),constants_annotations=__webpack_require__(137),public_=__webpack_require__(42),ml_url_generator=__webpack_require__(0),app=__webpack_require__(5),date_utils=__webpack_require__(72),ml_annotation_updates_context=__webpack_require__(138);function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class annotations_table_AnnotationsTableUI extends external_kbnSharedDeps_React_.Component{constructor(props){super(props),_defineProperty(this,"getAnnotationsWithExtraInfo",memoize_one_cjs_default()(annotations=>{var _this$props$chartDeta,_this$props$chartDeta2;return Array.isArray(null===(_this$props$chartDeta=this.props.chartDetails)||void 0===_this$props$chartDeta||null===(_this$props$chartDeta2=_this$props$chartDeta.entityData)||void 0===_this$props$chartDeta2?void 0:_this$props$chartDeta2.entities)?annotations.map(annotation=>{var _this$props$chartDeta3,_this$props$chartDeta4;const allMatched=null===(_this$props$chartDeta3=this.props.chartDetails)||void 0===_this$props$chartDeta3||null===(_this$props$chartDeta4=_this$props$chartDeta3.entityData)||void 0===_this$props$chartDeta4?void 0:_this$props$chartDeta4.entities.every(({fieldType:fieldType,fieldValue:fieldValue})=>{const field=fieldType+"_value";return!(!annotation[field]||annotation[field]!==fieldValue)});return{...annotation,current_series:allMatched}}):annotations})),_defineProperty(this,"annotationsRefreshSubscription",null),_defineProperty(this,"previousJobId",void 0),_defineProperty(this,"openSingleMetricView",async(annotation={})=>{const{services:{application:{navigateToApp:navigateToApp},share:{urlGenerators:{getUrlGenerator:getUrlGenerator}}}}=this.props.kibana,job=this.getJob(annotation.job_id),dataCounts=job.data_counts,resultLatest=Object(job_utils.g)(dataCounts.latest_record_timestamp,dataCounts.latest_bucket_timestamp),timeRange={from:new Date(dataCounts.earliest_record_timestamp).toISOString(),to:new Date(resultLatest).toISOString(),mode:"absolute"};let mlTimeSeriesExplorer={};const entityCondition={};void 0!==annotation.timestamp&&void 0!==annotation.end_timestamp&&(mlTimeSeriesExplorer={zoom:{from:new Date(annotation.timestamp).toISOString(),to:new Date(annotation.end_timestamp).toISOString()}},annotation.timestamp<dataCounts.earliest_record_timestamp&&(timeRange.from=new Date(annotation.timestamp).toISOString()),annotation.end_timestamp>dataCounts.latest_record_timestamp&&(timeRange.to=new Date(annotation.end_timestamp).toISOString())),void 0!==annotation.detector_index&&(mlTimeSeriesExplorer.detectorIndex=annotation.detector_index),void 0!==annotation.partition_field_value&&(entityCondition[annotation.partition_field_name]=annotation.partition_field_value),void 0!==annotation.over_field_value&&(entityCondition[annotation.over_field_name]=annotation.over_field_value),void 0!==annotation.by_field_value&&(entityCondition[annotation.by_field_name]=annotation.by_field_value),mlTimeSeriesExplorer.entities=entityCondition;const mlUrlGenerator=getUrlGenerator(ml_url_generator.a),singleMetricViewerLink=await mlUrlGenerator.createUrl({page:ml_url_generator.b.SINGLE_METRIC_VIEWER,pageState:{timeRange:timeRange,refreshInterval:{display:"Off",pause:!0,value:0},jobIds:[job.job_id],query:{query_string:{analyze_wildcard:!0,query:"*"}},...mlTimeSeriesExplorer},excludeBasePath:!0});Object(recently_accessed.a)("timeseriesexplorer",job.job_id,singleMetricViewerLink),await navigateToApp(app.e,{path:singleMetricViewerLink})}),_defineProperty(this,"onMouseOverRow",record=>{void 0!==this.mouseOverRecord?this.mouseOverRecord.rowId!==record.rowId&&(table_service.a.rowMouseleave$.next({record:this.mouseOverRecord,type:"annotation"}),table_service.a.rowMouseenter$.next({record:record,type:"annotation"})):table_service.a.rowMouseenter$.next({record:record,type:"annotation"}),this.mouseOverRecord=record}),_defineProperty(this,"onMouseLeaveRow",()=>{void 0!==this.mouseOverRecord&&(table_service.a.rowMouseleave$.next({record:this.mouseOverRecord,type:"annotation"}),this.mouseOverRecord=void 0)}),this.state={annotations:[],aggregations:null,isLoading:!1,queryText:`event:(${constants_annotations.b} or ${constants_annotations.a})`,searchError:void 0,jobId:Array.isArray(this.props.jobs)&&this.props.jobs.length>0&&void 0!==this.props.jobs[0]?this.props.jobs[0].job_id:void 0},this.sorting={sort:{field:"timestamp",direction:"asc"}}}getAnnotations(){const job=this.props.jobs[0],dataCounts=job.data_counts;this.setState({isLoading:!0}),dataCounts.processed_record_count>0&&ml_api_service.ml.annotations.getAnnotations$({jobIds:[job.job_id],earliestMs:null,latestMs:null,maxAnnotations:constants_search.a,fields:[{field:"event",missing:constants_annotations.b}]}).toPromise().then(resp=>{this.setState((prevState,props)=>({annotations:resp.annotations[props.jobs[0].job_id]||[],aggregations:resp.aggregations,errorMessage:void 0,isLoading:!1,jobId:props.jobs[0].job_id}))}).catch(resp=>{console.log("Error loading list of annotations for jobs list:",resp),this.setState({annotations:[],errorMessage:"Error loading the list of annotations for this job",isLoading:!1,jobId:void 0})})}getJob(jobId){if(Array.isArray(this.props.jobs)&&this.props.jobs.length>0){const job=this.props.jobs[0];if(void 0===jobId||job.job_id===jobId)return job}return job_service.a.getJob(jobId)}componentDidMount(){void 0===this.props.annotations&&Array.isArray(this.props.jobs)&&this.props.jobs.length>0&&(this.annotationsRefreshSubscription=annotations_service.b.subscribe(()=>{this.getAnnotations()}),Object(annotations_service.c)())}componentDidUpdate(){Array.isArray(this.props.jobs)&&this.props.jobs.length>0&&this.previousJobId!==this.props.jobs[0].job_id&&void 0===this.props.annotations&&!1===this.state.isLoading&&this.state.jobId!==this.props.jobs[0].job_id&&(Object(annotations_service.c)(),this.previousJobId=this.props.jobs[0].job_id)}componentWillUnmount(){null!==this.annotationsRefreshSubscription&&this.annotationsRefreshSubscription.unsubscribe()}render(){var _this$props$aggregati,_this$props$chartDeta5,_this$props$chartDeta6;const{isSingleMetricViewerLinkVisible:isSingleMetricViewerLinkVisible=!0,isNumberBadgeVisible:isNumberBadgeVisible=!1,annotationUpdatesService:annotationUpdatesService}=this.props,{queryText:queryText,searchError:searchError}=this.state;if(void 0===this.props.annotations){if(!0===this.state.isLoading)return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceAround"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingSpinner,{size:"l"})));if(void 0!==this.state.errorMessage)return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:this.state.errorMessage,color:"danger",iconType:"cross"})}const annotations=this.props.annotations||this.state.annotations;if(0===annotations.length)return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.annotationsTable.annotationsNotCreatedTitle",defaultMessage:"No annotations created for this job"}),iconType:"iInCircle",role:"alert"},this.state.jobId&&Object(job_utils.p)(this.getJob(this.state.jobId))&&external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.annotationsTable.howToCreateAnnotationDescription",defaultMessage:"To create an annotation, open the {linkToSingleMetricView}",values:{linkToSingleMetricView:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{onClick:()=>this.openSingleMetricView()},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.annotationsTable.howToCreateAnnotationDescription.singleMetricViewerLinkText",defaultMessage:"Single Metric Viewer"}))}})));const columns=[{field:"annotation",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.annotationsTable.annotationColumnName",{defaultMessage:"Annotation"}),sortable:!0,width:"40%",scope:"row"},{field:"timestamp",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.annotationsTable.fromColumnName",{defaultMessage:"From"}),dataType:"date",render:date_utils.d,sortable:!0},{field:"end_timestamp",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.annotationsTable.toColumnName",{defaultMessage:"To"}),dataType:"date",render:date_utils.d,sortable:!0},{field:"modified_time",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.annotationsTable.lastModifiedDateColumnName",{defaultMessage:"Last modified date"}),dataType:"date",render:date_utils.d,sortable:!0},{field:"modified_username",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.annotationsTable.lastModifiedByColumnName",{defaultMessage:"Last modified by"}),sortable:!0},{field:"event",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.annotationsTable.eventColumnName",{defaultMessage:"Event"}),sortable:!0,width:"10%"}];Object(external_kbnSharedDeps_Lodash_.uniq)(annotations.map(a=>a.job_id)).length>1&&columns.unshift({field:"job_id",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.annotationsTable.jobIdColumnName",{defaultMessage:"job ID"}),sortable:!0}),isNumberBadgeVisible&&columns.unshift({field:"key",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.annotationsTable.labelColumnName",{defaultMessage:"Label"}),sortable:key=>+key,width:"60px",render:key=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBadge,{color:"default"},key)});const actions=[];actions.push({render:annotation=>{const annotationId=annotation._id,originalAnnotation=annotations.find(d=>d._id===annotationId),editAnnotationsTooltipText=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.annotationsTable.editAnnotationsTooltip",defaultMessage:"Edit annotation"}),editAnnotationsTooltipAriaLabelText=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.annotationsTable.editAnnotationsTooltipAriaLabel",{defaultMessage:"Edit annotation"});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{position:"bottom",content:editAnnotationsTooltipText},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{onClick:()=>annotationUpdatesService.setValue(null!=originalAnnotation?originalAnnotation:annotation),iconType:"pencil","aria-label":editAnnotationsTooltipAriaLabelText}))}}),isSingleMetricViewerLinkVisible&&actions.push({render:annotation=>{const isDrillDownAvailable=Object(job_utils.p)(this.getJob(annotation.job_id)),openInSingleMetricViewerTooltipText=isDrillDownAvailable?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.annotationsTable.openInSingleMetricViewerTooltip",defaultMessage:"Open in Single Metric Viewer"}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.annotationsTable.jobConfigurationNotSupportedInSingleMetricViewerTooltip",defaultMessage:"Job configuration not supported in Single Metric Viewer"}),openInSingleMetricViewerAriaLabelText=isDrillDownAvailable?external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.annotationsTable.openInSingleMetricViewerAriaLabel",{defaultMessage:"Open in Single Metric Viewer"}):external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.annotationsTable.jobConfigurationNotSupportedInSingleMetricViewerAriaLabel",{defaultMessage:"Job configuration not supported in Single Metric Viewer"});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{position:"bottom",content:openInSingleMetricViewerTooltipText},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{onClick:()=>this.openSingleMetricView(annotation),disabled:!isDrillDownAvailable,iconType:"visLine","aria-label":openInSingleMetricViewerAriaLabelText}))}});let filterOptions=[];const aggregations=null!==(_this$props$aggregati=this.props.aggregations)&&void 0!==_this$props$aggregati?_this$props$aggregati:this.state.aggregations;if(aggregations){const buckets=aggregations.event.buckets;let foundUser=!1,foundDelayedData=!1;buckets.forEach(bucket=>{bucket.key===constants_annotations.b&&(foundUser=!0),bucket.key===constants_annotations.a&&(foundDelayedData=!0)});const adjustedBuckets=[];foundUser||adjustedBuckets.push({key:constants_annotations.b,doc_count:0}),foundDelayedData||adjustedBuckets.push({key:constants_annotations.a,doc_count:0}),filterOptions=[...adjustedBuckets,...buckets]}const filters=[{type:"field_value_selection",field:"event",name:"Event",multiSelect:"or",options:filterOptions.map(field=>({value:field.key,name:field.key,view:`${field.key} (${field.doc_count})`}))}];var _this$props$chartDeta7,_this$props$chartDeta8;(this.props.detectors&&columns.push({name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.annotationsTable.detectorColumnName",{defaultMessage:"Detector"}),width:"10%",render:item=>"detector_index"in item?this.props.detectors[item.detector_index].detector_description:""}),Array.isArray(null===(_this$props$chartDeta5=this.props.chartDetails)||void 0===_this$props$chartDeta5||null===(_this$props$chartDeta6=_this$props$chartDeta5.entityData)||void 0===_this$props$chartDeta6?void 0:_this$props$chartDeta6.entities))?(null===(_this$props$chartDeta7=this.props.chartDetails)||void 0===_this$props$chartDeta7||null===(_this$props$chartDeta8=_this$props$chartDeta7.entityData)||void 0===_this$props$chartDeta8||_this$props$chartDeta8.entities.forEach(entity=>{"partition_field"===entity.fieldType&&columns.push({field:"partition_field_value",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.annotationsTable.partitionSMVColumnName",{defaultMessage:"Partition"}),sortable:!0}),"over_field"===entity.fieldType&&columns.push({field:"over_field_value",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.annotationsTable.overColumnSMVName",{defaultMessage:"Over"}),sortable:!0}),"by_field"===entity.fieldType&&columns.push({field:"by_field_value",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.annotationsTable.byColumnSMVName",{defaultMessage:"By"}),sortable:!0})}),filters.push({type:"is",field:"current_series",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.annotationsTable.seriesOnlyFilterName",{defaultMessage:"Filter to series"})})):(columns.push({field:"partition_field_value",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.annotationsTable.partitionAEColumnName",{defaultMessage:"Partition"}),sortable:!0}),columns.push({field:"over_field_value",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.annotationsTable.overAEColumnName",{defaultMessage:"Over"}),sortable:!0}),columns.push({field:"by_field_value",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.annotationsTable.byAEColumnName",{defaultMessage:"By"}),sortable:!0}));const search={defaultQuery:queryText,box:{incremental:!0,schema:!0},filters:filters};columns.push({align:external_kbnSharedDeps_ElasticEuiLibServices_.RIGHT_ALIGNMENT,width:"60px",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.annotationsTable.actionsColumnName",{defaultMessage:"Actions"}),actions:actions},{field:"current_series",name:"current_series",dataType:"boolean",width:"0px",render:()=>""});const items=this.getAnnotationsWithExtraInfo(annotations);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiInMemoryTable,{error:searchError,className:"eui-textOverflowWrap",compressed:!0,items:items,columns:columns,pagination:{pageSizeOptions:[5,10,25]},sorting:this.sorting,search:search,rowProps:item=>({onMouseOver:()=>this.onMouseOverRow(item),onMouseLeave:()=>this.onMouseLeaveRow()})}))}}const AnnotationsTable=Object(public_.withKibana)(props=>{const annotationUpdatesService=Object(external_kbnSharedDeps_React_.useContext)(ml_annotation_updates_context.a);return external_kbnSharedDeps_React_default.a.createElement(annotations_table_AnnotationsTableUI,_extends({annotationUpdatesService:annotationUpdatesService},props))})},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return DeleteJobCheckModal}));var external_kbnSharedDeps_React_=__webpack_require__(14),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(40),external_kbnSharedDeps_KbnI18n_=__webpack_require__(2),external_kbnSharedDeps_ElasticEui_=__webpack_require__(39),kibana=__webpack_require__(63),toast_notification_service=__webpack_require__(73);const shouldUnTagLabel=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.deleteJobCheckModal.shouldUnTagLabel",{defaultMessage:"Remove job from current space"});const DeleteJobCheckModal=({canDeleteCallback:canDeleteCallback,onCloseCallback:onCloseCallback,refreshJobsCallback:refreshJobsCallback,jobType:jobType,jobIds:jobIds,setDidUntag:setDidUntag})=>{const[buttonContent,setButtonContent]=Object(external_kbnSharedDeps_React_.useState)(),[modalContent,setModalContent]=Object(external_kbnSharedDeps_React_.useState)(),[hasUntagged,setHasUntagged]=Object(external_kbnSharedDeps_React_.useState)(!1),[isUntagging,setIsUntagging]=Object(external_kbnSharedDeps_React_.useState)(!1),[isLoading,setIsLoading]=Object(external_kbnSharedDeps_React_.useState)(!1),[jobCheckRespSummary,setJobCheckRespSummary]=Object(external_kbnSharedDeps_React_.useState)(),{savedObjects:{canDeleteJob:canDeleteJob,removeJobFromCurrentSpace:removeJobFromCurrentSpace}}=Object(kibana.a)(),{displayErrorToast:displayErrorToast,displaySuccessToast:displaySuccessToast}=Object(toast_notification_service.c)();Object(external_kbnSharedDeps_React_.useEffect)(()=>{setIsLoading(!0),canDeleteJob(jobType,jobIds).then(resp=>{const respSummary=function(resp){const jobsChecked=Object.keys(resp),{canDelete:canDelete,canRemoveFromSpace:canRemoveFromSpace}=resp[jobsChecked[0]];let canTakeAnyAction=!0;return jobsChecked.length>1&&(canTakeAnyAction=jobsChecked.every(id=>resp[id].canDelete===canDelete&&resp[id].canRemoveFromSpace===canRemoveFromSpace)),{canDelete:canDelete,canRemoveFromSpace:canRemoveFromSpace,canTakeAnyAction:canTakeAnyAction}}(resp),{canDelete:canDelete,canRemoveFromSpace:canRemoveFromSpace,canTakeAnyAction:canTakeAnyAction}=respSummary;if(canTakeAnyAction&&canDelete&&!canRemoveFromSpace)return void canDeleteCallback();setJobCheckRespSummary(respSummary);const{buttonText:buttonText,modalText:modalText}=function(jobIds,respSummary){const{canDelete:canDelete,canRemoveFromSpace:canRemoveFromSpace,canTakeAnyAction:canTakeAnyAction}=respSummary;if(!1===canTakeAnyAction)return{buttonText:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.deleteJobCheckModal.buttonTextNoAction",defaultMessage:"Close"}),modalText:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.deleteJobCheckModal.modalTextNoAction",defaultMessage:"{ids} have different space permissions. When you delete multiple jobs, they must have the same permissions. Deselect the jobs and try deleting each job individually.",values:{ids:jobIds.join(", ")}}))};const noActionContent={buttonText:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.deleteJobCheckModal.buttonTextClose",defaultMessage:"Close"}),modalText:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.deleteJobCheckModal.modalTextClose",defaultMessage:"{ids} cannot be deleted and cannot be removed from the current space. This job is assigned to the * space and you do not have access to all spaces.",values:{ids:jobIds.join(", ")}}))};return canDelete?{buttonText:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.deleteJobCheckModal.buttonTextCanDelete",defaultMessage:"Continue to delete {length, plural, one {# job} other {# jobs}}",values:{length:jobIds.length}}),modalText:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.deleteJobCheckModal.modalTextCanDelete",defaultMessage:"{ids} can be deleted.",values:{ids:jobIds.join(", ")}}))}:canRemoveFromSpace?{buttonText:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.deleteJobCheckModal.buttonTextCanUnTagConfirm",defaultMessage:"Remove from current space"}),modalText:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.deleteJobCheckModal.modalTextCanUnTag",defaultMessage:"{ids} cannot be deleted but can be removed from the current space.",values:{ids:jobIds.join(", ")}}))}:noActionContent}(jobIds,respSummary);setButtonContent(buttonText),setModalContent(modalText)}),"function"==typeof setDidUntag&&setDidUntag(!1),setIsLoading(!1)},[]);const onUntagClick=async()=>{setIsUntagging(!0);const resp=await removeJobFromCurrentSpace(jobType,jobIds);setIsUntagging(!1),"function"==typeof setDidUntag&&setDidUntag(!0),Object.entries(resp).forEach(([id,{success:success,error:error}])=>{if(!1===success){const title=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.deleteJobCheckModal.unTagErrorTitle",{defaultMessage:"Error updating {id}",values:{id:id}});displayErrorToast(error,title)}else{setHasUntagged(!0);const message=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.deleteJobCheckModal.unTagSuccessTitle",{defaultMessage:"Successfully updated {id}",values:{id:id}});displaySuccessToast(message)}}),onCloseCallback(),"function"==typeof refreshJobsCallback&&refreshJobsCallback()};return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModal,{onClose:onCloseCallback,"data-test-subj":"mlAnalyticsJobDeleteCheckOverlay"},!0===isLoading&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalBody,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceAround"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingSpinner,{size:"xl"}))))),!1===isLoading&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalHeader,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalHeaderTitle,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.deleteJobCheckModal.modalTitle",defaultMessage:"Checking space permissions"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalBody,null,modalContent),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalFooter,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},!hasUntagged&&(null==jobCheckRespSummary?void 0:jobCheckRespSummary.canTakeAnyAction)&&(null==jobCheckRespSummary?void 0:jobCheckRespSummary.canRemoveFromSpace)&&(null==jobCheckRespSummary?void 0:jobCheckRespSummary.canDelete)&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{isLoading:isUntagging,color:"primary",size:"s",onClick:onUntagClick},shouldUnTagLabel)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{size:"s",onClick:null==jobCheckRespSummary||!jobCheckRespSummary.canTakeAnyAction||null==jobCheckRespSummary||!jobCheckRespSummary.canRemoveFromSpace||null!=jobCheckRespSummary&&jobCheckRespSummary.canDelete?async()=>{null!=jobCheckRespSummary&&jobCheckRespSummary.canTakeAnyAction&&null!=jobCheckRespSummary&&jobCheckRespSummary.canDelete?canDeleteCallback():onCloseCallback()}:onUntagClick,fill:!0},buttonContent))))))}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return LoadingWrapper}));var external_kbnSharedDeps_React_=__webpack_require__(14),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),external_kbnSharedDeps_ElasticEui_=__webpack_require__(39);const LoadingWrapper=({hasData:hasData,loading:loading=!1,height:height,children:children})=>{const opacity=!0===loading?!0===hasData?.3:0:1;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement("div",{style:{height:"100%",opacity:opacity,transition:"opacity 0.2s"}},children),!0===loading&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceAround",alignItems:"center",style:void 0!==height?{height:height,marginTop:"-"+height}:{}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingSpinner,{size:"xl"}))))}},,,,,,,,,,,,,,,,function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return setUpgradeInProgress})),__webpack_require__.d(__webpack_exports__,"a",(function(){return isUpgradeInProgress}));let upgradeInProgress=!1;function setUpgradeInProgress(show){upgradeInProgress=show}function isUpgradeInProgress(){return upgradeInProgress}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return mlCalendarService}));var _kbn_i18n__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2),_ml_api_service__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(64);const mlCalendarService=new class{async assignNewJobId(calendar,jobId){const{calendar_id:calendarId}=calendar;try{await _ml_api_service__WEBPACK_IMPORTED_MODULE_1__.ml.updateCalendar({...calendar,calendarId:calendarId,job_ids:[...calendar.job_ids,jobId]})}catch(e){throw new Error(_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.ml.calendarService.assignNewJobIdErrorMessage",{defaultMessage:"Unable to assign {jobId} to {calendarId}",values:{calendarId:calendarId,jobId:jobId}}))}}async fetchCalendarsByIds(calendarIds){try{const calendars=await _ml_api_service__WEBPACK_IMPORTED_MODULE_1__.ml.calendars({calendarIds:calendarIds});return Array.isArray(calendars)?calendars:[calendars]}catch(e){throw new Error(_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.ml.calendarService.fetchCalendarsByIdsErrorMessage",{defaultMessage:"Unable to fetch calendars: {calendarIds}",values:{calendarIds:calendarIds.join(", ")}}))}}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.XJsonMode=exports.installXJsonMode=exports.addXJsonToRules=exports.XJsonHighlightRules=exports.ScriptHighlightRules=exports.ElasticsearchSqlHighlightRules=void 0;var lexer_rules_1=__webpack_require__(463);Object.defineProperty(exports,"ElasticsearchSqlHighlightRules",{enumerable:!0,get:function(){return lexer_rules_1.ElasticsearchSqlHighlightRules}}),Object.defineProperty(exports,"ScriptHighlightRules",{enumerable:!0,get:function(){return lexer_rules_1.ScriptHighlightRules}}),Object.defineProperty(exports,"XJsonHighlightRules",{enumerable:!0,get:function(){return lexer_rules_1.XJsonHighlightRules}}),Object.defineProperty(exports,"addXJsonToRules",{enumerable:!0,get:function(){return lexer_rules_1.addXJsonToRules}});var x_json_1=__webpack_require__(467);Object.defineProperty(exports,"installXJsonMode",{enumerable:!0,get:function(){return x_json_1.installXJsonMode}}),Object.defineProperty(exports,"XJsonMode",{enumerable:!0,get:function(){return x_json_1.XJsonMode}})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ElasticsearchSqlHighlightRules=void 0;const brace_1=__webpack_require__(35).__importDefault(__webpack_require__(193)),{TextHighlightRules:TextHighlightRules}=brace_1.default.acequire("ace/mode/text_highlight_rules"),oop=brace_1.default.acequire("ace/lib/oop");exports.ElasticsearchSqlHighlightRules=function(){const keywordMapper=this.createKeywordMapper({keyword:["describe|between|in|like|not|and|or|desc|select|from|where|having|group|by|orderasc|desc|pivot|for|in|as|show|columns|include|frozen|tables|escape|limit|rlike|all|distinct|is","avg|count|first|first_value|last|last_value|max|min|sum|kurtosis|mad|percentile|percentile_rank|skewness|stddev_pop|sum_of_squares|var_pop|histogram|case|coalesce|greatest|ifnull|iif|isnull|least|nullif|nvl|curdate|current_date|current_time|current_timestamp|curtime|dateadd|datediff|datepart|datetrunc|date_add|date_diff|date_part|date_trunc|day|dayname|dayofmonth|dayofweek|dayofyear|day_name|day_of_month|day_of_week|day_of_year|dom|dow|doy|hour|hour_of_day|idow|isodayofweek|isodow|isoweek|isoweekofyear|iso_day_of_week|iso_week_of_year|iw|iwoy|minute|minute_of_day|minute_of_hour|month|monthname|month_name|month_of_year|now|quarter|second|second_of_minute|timestampadd|timestampdiff|timestamp_add|timestamp_diff|today|week|week_of_year|year|abs|acos|asin|atan|atan2|cbrt|ceil|ceiling|cos|cosh|cot|degrees|e|exp|expm1|floor|log|log10|mod|pi|power|radians|rand|random|round|sign|signum|sin|sinh|sqrt|tan|truncate|ascii|bit_length|char|character_length|char_length|concat|insert|lcase|left|length|locate|ltrim|octet_length|position|repeat|replace|right|rtrim|space|substring|ucase|cast|convert|database|user|st_astext|st_aswkt|st_distance|st_geometrytype|st_geomfromtext|st_wkttosql|st_x|st_y|st_z|score","true|false","null|boolean|byte|short|integer|long|double|float|half_float|scaled_float|keyword|text|binary|date|ip|object|nested|time|interval_year|interval_month|interval_day|interval_hour|interval_minute|interval_second|interval_year_to_monthinteval_day_to_hour|interval_day_to_minute|interval_day_to_second|interval_hour_to_minute|interval_hour_to_secondinterval_minute_to_second|geo_point|geo_shape|shape"].join("|")},"identifier",!0);this.$rules={start:[{token:"comment",regex:"--.*$"},{token:"comment",start:"/\\*",end:"\\*/"},{token:"string",regex:'".*?"'},{token:"constant",regex:"'.*?'"},{token:"string",regex:"`.*?`"},{token:"entity.name.function",regex:"[+-]?\\d+(?:(?:\\.\\d*)?(?:[eE][+-]?\\d+)?)?\\b"},{token:keywordMapper,regex:"[a-zA-Z_$][a-zA-Z0-9_$]*\\b"},{token:"keyword.operator",regex:"⇐|<⇒|\\*|\\.|\\:\\:|\\+|\\-|\\/|\\/\\/|%|&|\\^|~|<|>|<=|=>|==|!=|<>|="},{token:"paren.lparen",regex:"[\\(]"},{token:"paren.rparen",regex:"[\\)]"},{token:"text",regex:"\\s+"}]},this.normalizeRules()},oop.inherits(exports.ElasticsearchSqlHighlightRules,TextHighlightRules)},function(module,exports){module.exports=function(){throw new Error("define cannot be used indirect")}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ScriptHighlightRules=void 0;const brace_1=__webpack_require__(35).__importDefault(__webpack_require__(193)),oop=brace_1.default.acequire("ace/lib/oop"),{TextHighlightRules:TextHighlightRules}=brace_1.default.acequire("ace/mode/text_highlight_rules");function ScriptHighlightRules(){this.name="ScriptHighlightRules",this.$rules={start:[{token:"script.comment",regex:"\\/\\/.*$"},{token:"script.string.regexp",regex:"[/](?:(?:\\[(?:\\\\]|[^\\]])+\\])|(?:\\\\/|[^\\]/]))*[/]\\w*\\s*(?=[).,;]|$)"},{token:"script.string",regex:"['](?:(?:\\\\.)|(?:[^'\\\\]))*?[']"},{token:"script.constant.numeric",regex:"0[xX][0-9a-fA-F]+\\b"},{token:"script.constant.numeric",regex:"[+-]?\\d+(?:(?:\\.\\d*)?(?:[eE][+-]?\\d+)?)?\\b"},{token:"script.constant.language.boolean",regex:"(?:true|false)\\b"},{token:"script.keyword",regex:"def|int|long|byte|String|float|double|char|null|if|else|while|do|for|continue|break|new|try|catch|throw|this|instanceof|return|ctx"},{token:"script.text",regex:"[a-zA-Z_$][a-zA-Z0-9_$]*\\b"},{token:"script.keyword.operator",regex:"\\?\\.|\\*\\.|=~|==~|!|%|&|\\*|\\-\\-|\\-|\\+\\+|\\+|~|===|==|=|!=|!==|<=|>=|<<=|>>=|>>>=|<>|<|>|->|!|&&|\\|\\||\\?\\:|\\*=|%=|\\+=|\\-=|&=|\\^=|\\b(?:in|instanceof|new|typeof|void)"},{token:"script.lparen",regex:"[[({]"},{token:"script.rparen",regex:"[\\])}]"},{token:"script.text",regex:"\\s+"}]}}exports.ScriptHighlightRules=ScriptHighlightRules,oop.inherits(ScriptHighlightRules,TextHighlightRules)},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return Axes}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(14),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),_elastic_charts__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(43),_utils__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(319);const dateFormatter=Object(_elastic_charts__WEBPACK_IMPORTED_MODULE_1__.timeFormatter)(Object(_elastic_charts__WEBPACK_IMPORTED_MODULE_1__.niceTimeFormatByDay)(3));function tickFormatter(d){return(Math.round(100*d)/100).toString()}const Axes=({chartData:chartData})=>{const yDomain=void 0!==chartData?Object(_utils__WEBPACK_IMPORTED_MODULE_2__.b)(chartData):void 0;return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0__.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_charts__WEBPACK_IMPORTED_MODULE_1__.Axis,{id:"bottom",position:_elastic_charts__WEBPACK_IMPORTED_MODULE_1__.Position.Bottom,showOverlappingTicks:!0,tickFormat:dateFormatter}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_charts__WEBPACK_IMPORTED_MODULE_1__.Axis,{id:"left",position:_elastic_charts__WEBPACK_IMPORTED_MODULE_1__.Position.Left,tickFormat:tickFormatter,domain:yDomain}))}},function(module,__webpack_exports__,__webpack_require__){"use strict";function getYRange(chartData){if(0===chartData.length)return{min:0,max:0};let max=Number.MIN_VALUE,min=Number.MAX_VALUE;chartData.forEach(r=>{max=Math.max(r.value,max),min=Math.min(r.value,min)});const padding=.1*(max-min);return max+=padding,min-=padding,{min:min,max:max}}function getXRange(lineChartData){return 0===lineChartData.length?{min:0,max:0}:{min:lineChartData[0].time,max:lineChartData[lineChartData.length-1].time}}__webpack_require__.d(__webpack_exports__,"b",(function(){return getYRange})),__webpack_require__.d(__webpack_exports__,"a",(function(){return getXRange}))},function(module,__webpack_exports__,__webpack_require__){"use strict";let VALIDATION_RESULT;__webpack_require__.d(__webpack_exports__,"a",(function(){return VALIDATION_RESULT})),function(VALIDATION_RESULT){VALIDATION_RESULT[VALIDATION_RESULT.NO_EXAMPLES=0]="NO_EXAMPLES",VALIDATION_RESULT[VALIDATION_RESULT.FAILED_TO_TOKENIZE=1]="FAILED_TO_TOKENIZE",VALIDATION_RESULT[VALIDATION_RESULT.TOO_MANY_TOKENS=2]="TOO_MANY_TOKENS",VALIDATION_RESULT[VALIDATION_RESULT.TOKEN_COUNT=3]="TOKEN_COUNT",VALIDATION_RESULT[VALIDATION_RESULT.MEDIAN_LINE_LENGTH=4]="MEDIAN_LINE_LENGTH",VALIDATION_RESULT[VALIDATION_RESULT.NULL_VALUES=5]="NULL_VALUES",VALIDATION_RESULT[VALIDATION_RESULT.INSUFFICIENT_PRIVILEGES=6]="INSUFFICIENT_PRIVILEGES"}(VALIDATION_RESULT||(VALIDATION_RESULT={}))},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return Anomalies}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(14),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),_elastic_charts__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(43),_common_util_anomaly_utils__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(6),_common_constants_anomalies__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(1);function getAnomalyStyle(threshold){return{line:{stroke:Object(_common_util_anomaly_utils__WEBPACK_IMPORTED_MODULE_2__.j)(threshold),strokeWidth:3,opacity:1}}}const Anomalies=({anomalyData:anomalyData})=>{const severities=function(anomalies){const severities={critical:[],major:[],minor:[],warning:[],unknown:[],low:[]};return anomalies.forEach(a=>{0!==a.value&&severities[a.severity].push({dataValue:a.time})}),severities}(void 0===anomalyData?[]:anomalyData);return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0__.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_charts__WEBPACK_IMPORTED_MODULE_1__.LineAnnotation,{id:"low",domainType:_elastic_charts__WEBPACK_IMPORTED_MODULE_1__.AnnotationDomainType.XDomain,dataValues:severities.low,style:getAnomalyStyle(_common_constants_anomalies__WEBPACK_IMPORTED_MODULE_3__.c.LOW),hideTooltips:!0}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_charts__WEBPACK_IMPORTED_MODULE_1__.LineAnnotation,{id:"warning",domainType:_elastic_charts__WEBPACK_IMPORTED_MODULE_1__.AnnotationDomainType.XDomain,dataValues:severities.warning,style:getAnomalyStyle(_common_constants_anomalies__WEBPACK_IMPORTED_MODULE_3__.c.WARNING),hideTooltips:!0}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_charts__WEBPACK_IMPORTED_MODULE_1__.LineAnnotation,{id:"minor",domainType:_elastic_charts__WEBPACK_IMPORTED_MODULE_1__.AnnotationDomainType.XDomain,dataValues:severities.minor,style:getAnomalyStyle(_common_constants_anomalies__WEBPACK_IMPORTED_MODULE_3__.c.MINOR),hideTooltips:!0}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_charts__WEBPACK_IMPORTED_MODULE_1__.LineAnnotation,{id:"major",domainType:_elastic_charts__WEBPACK_IMPORTED_MODULE_1__.AnnotationDomainType.XDomain,dataValues:severities.major,style:getAnomalyStyle(_common_constants_anomalies__WEBPACK_IMPORTED_MODULE_3__.c.MAJOR),hideTooltips:!0}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_charts__WEBPACK_IMPORTED_MODULE_1__.LineAnnotation,{id:"critical",domainType:_elastic_charts__WEBPACK_IMPORTED_MODULE_1__.AnnotationDomainType.XDomain,dataValues:severities.critical,style:getAnomalyStyle(_common_constants_anomalies__WEBPACK_IMPORTED_MODULE_3__.c.CRITICAL),hideTooltips:!0}))}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"c",(function(){return saveJob})),__webpack_require__.d(__webpack_exports__,"b",(function(){return loadSavedDashboards})),__webpack_require__.d(__webpack_exports__,"a",(function(){return loadIndexPatterns}));var lodash__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(7),_services_ml_server_info__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(88),_common_util_job_utils__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(69),_util_dependency_cache__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(22),_services_ml_api_service__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(64);function saveJob(job,newJobData,finish){return new Promise((resolve,reject)=>{const jobData={...extractDescription(job,newJobData),...extractGroups(job,newJobData),...extractMML(job,newJobData),...extractModelSnapshotRetentionDays(job,newJobData),...extractDailyModelSnapshotRetentionAfterDays(job,newJobData),...extractDetectorDescriptions(job,newJobData),...extractCustomSettings(job,newJobData)},datafeedData={...extractDatafeed(job,newJobData)};void 0!==jobData.custom_settings&&(jobData.custom_settings=function(jobData,datafeedData){let customSettings={};void 0!==jobData.custom_settings&&(customSettings={...jobData.custom_settings},void 0===jobData.custom_settings.created_by||void 0===jobData.detectors&&!Object.keys(datafeedData).length||Object(_common_util_job_utils__WEBPACK_IMPORTED_MODULE_2__.r)(customSettings));return customSettings}(jobData,datafeedData));const saveDatafeedWrapper=()=>{(function(datafeedConfig,job){return new Promise((resolve,reject)=>{if(Object.keys(datafeedConfig).length){const datafeedId=job.datafeed_config.datafeed_id;_services_ml_api_service__WEBPACK_IMPORTED_MODULE_4__.ml.updateDatafeed({datafeedId:datafeedId,datafeedConfig:datafeedConfig}).then(()=>{resolve()}).catch(error=>{reject(error)})}else resolve()})})(datafeedData,job).then(()=>{resolve()}).catch(error=>{reject(error)})};Object.keys(jobData).length?_services_ml_api_service__WEBPACK_IMPORTED_MODULE_4__.ml.updateJob({jobId:job.job_id,job:jobData}).then(()=>{saveDatafeedWrapper()}).catch(error=>{reject(error)}):saveDatafeedWrapper()})}function loadSavedDashboards(maxNumber){return new Promise((resolve,reject)=>{Object(_util_dependency_cache__WEBPACK_IMPORTED_MODULE_3__.h)().find({type:"dashboard",fields:["title"],perPage:maxNumber}).then(resp=>{const savedObjects=resp.savedObjects;if(void 0!==savedObjects){const dashboards=savedObjects.map(savedObj=>({id:savedObj.id,title:savedObj.attributes.title}));dashboards.sort((dash1,dash2)=>dash1.title.localeCompare(dash2.title)),resolve(dashboards)}}).catch(resp=>{reject(resp)})})}function loadIndexPatterns(maxNumber){return new Promise((resolve,reject)=>{Object(_util_dependency_cache__WEBPACK_IMPORTED_MODULE_3__.h)().find({type:"index-pattern",fields:["title"],perPage:maxNumber}).then(resp=>{const savedObjects=resp.savedObjects;if(void 0!==savedObjects){const indexPatterns=savedObjects.map(savedObj=>({id:savedObj.id,title:savedObj.attributes.title}));indexPatterns.sort((dash1,dash2)=>dash1.title.localeCompare(dash2.title)),resolve(indexPatterns)}}).catch(resp=>{reject(resp)})})}function extractDescription(job,newJobData){const description=newJobData.description;return newJobData.description!==job.description?{description:description}:{}}function extractGroups(job,newJobData){const groups=newJobData.groups;if(void 0!==newJobData.groups){return 0===Object(lodash__WEBPACK_IMPORTED_MODULE_0__.difference)(job.groups,groups).length+Object(lodash__WEBPACK_IMPORTED_MODULE_0__.difference)(groups,job.groups).length?{}:{groups:groups}}return{}}function extractMML(job,newJobData){const jobLimits=Object(_services_ml_server_info__WEBPACK_IMPORTED_MODULE_1__.c)(),mmlData={};if(void 0!==job.analysis_limits.model_memory_limit){let{mml:mml}=newJobData;""===mml&&(mml=jobLimits.max_model_memory_limit),mml!==job.analysis_limits.model_memory_limit&&(mmlData.analysis_limits={model_memory_limit:mml})}return mmlData}function extractModelSnapshotRetentionDays(job,newJobData){const modelSnapshotRetentionDays=newJobData.modelSnapshotRetentionDays;return modelSnapshotRetentionDays!==job.model_snapshot_retention_days?{model_snapshot_retention_days:modelSnapshotRetentionDays}:{}}function extractDailyModelSnapshotRetentionAfterDays(job,newJobData){const dailyModelSnapshotRetentionAfterDays=newJobData.dailyModelSnapshotRetentionAfterDays;return dailyModelSnapshotRetentionAfterDays!==job.daily_model_snapshot_retention_after_days?{daily_model_snapshot_retention_after_days:dailyModelSnapshotRetentionAfterDays}:{}}function extractDetectorDescriptions(job,newJobData){const detectors=[],descriptions=newJobData.detectorDescriptions.map((d,i)=>({detector_index:i,description:d}));return job.analysis_config.detectors.forEach(d=>{descriptions[d.detector_index].description!==d.detector_description&&detectors.push(descriptions[d.detector_index])}),detectors.length?{detectors:detectors}:{}}function extractCustomSettings(job,newJobData){const settingsData={};return newJobData&&newJobData.customUrls&&(settingsData.custom_settings=job.custom_settings||{},settingsData.custom_settings.custom_urls=newJobData.customUrls),settingsData}function extractDatafeed(job,newDatafeedData){const datafeedData={};if(void 0!==job.datafeed_config){const origQueryString=JSON.stringify(job.datafeed_config.query),newQuery=JSON.parse(newDatafeedData.datafeedQuery);origQueryString!==JSON.stringify(newQuery)&&(datafeedData.query=newQuery),job.datafeed_config.query_delay!==newDatafeedData.datafeedQueryDelay&&(datafeedData.query_delay=newDatafeedData.datafeedQueryDelay),job.datafeed_config.frequency!==newDatafeedData.datafeedFrequency&&""!==newDatafeedData.datafeedFrequency&&(datafeedData.frequency=newDatafeedData.datafeedFrequency),job.datafeed_config.scroll_size!==newDatafeedData.datafeedScrollSize&&(datafeedData.scroll_size=newDatafeedData.datafeedScrollSize)}return datafeedData}},function(module,exports,__webpack_require__){exports.format_value=__webpack_require__(170).format_value,exports.parse_value=__webpack_require__(170).parse_value,exports.RRule=__webpack_require__(197).RRule,exports.parse_calendar=__webpack_require__(324).parse_calendar,exports.ParseError=__webpack_require__(324).ParseError,exports.CalendarObject=__webpack_require__(107).CalendarObject,exports.CalendarProperty=__webpack_require__(107).CalendarProperty,exports.iCalendar=__webpack_require__(198).iCalendar,exports.VEvent=__webpack_require__(493).VEvent,exports.VTimezone=__webpack_require__(494).VTimezone,exports.PRODID="-//Tri Tech Computers//node-icalendar//EN"},function(module,exports,__webpack_require__){__webpack_require__(249);var util=__webpack_require__(171),types=__webpack_require__(170),CalendarObject=__webpack_require__(107).CalendarObject,schema=__webpack_require__(107).schema,properties=__webpack_require__(107).properties,iCalendar=__webpack_require__(198).iCalendar,parse_value=types.parse_value,ParseError=(types.format_value,exports.ParseError=function(){Error.apply(this,arguments)});function parse_record(rec){var propname,current_param,params={},state=PROP_NAME,lastpos=0;function newstate(s){state=s,lastpos=i+1}function str(){return rec.substr(lastpos,i-lastpos)}for(var i=0,j=rec.length;i<j;++i){var ch=rec[i];switch(state){case PROP_NAME:":"!=ch&&";"!=ch||(propname=str(),state=PARAM_OR_VALUE,--i);break;case PARAM_OR_VALUE:if(":"==ch)newstate(PROP_VALUE);else{if(";"!=ch)throw new Error("Parse error");newstate(PARAM_NAME)}break;case PARAM_NAME:"="==ch&&(current_param=str(),newstate(MAYBE_QUOTED_PARAM));break;case MAYBE_QUOTED_PARAM:'"'==ch?newstate(QUOTED_PARAM_VALUE):state=PARAM_VALUE;break;case PARAM_VALUE:":"!=ch&&";"!=ch||(params[current_param]=str(),state=PARAM_OR_VALUE,--i);break;case QUOTED_PARAM_VALUE:'"'==ch&&(params[current_param]=str(),state=PARAM_OR_VALUE);break;case PROP_VALUE:i=j;break;default:throw new Error("Invalid parser state")}}return[propname,str(),params]}util.inherits(ParseError,Error),PROP_NAME=0,PARAM_NAME=1,PARAM_VALUE=2,MAYBE_QUOTED_PARAM=3,QUOTED_PARAM_VALUE=4,PARAM_OR_VALUE=5,PROP_VALUE=6,exports.parse_calendar=function(data,timezone){data=data.split(/\r?\n/);var calendar=new iCalendar(!0);if(timezone)if("string"==typeof timezone&&(timezone=exports.parse_calendar(timezone)),timezone instanceof iCalendar)for(var tzs=timezone.getComponents("VTIMEZONE"),i=0;i<tzs.length;++i)calendar.addComponent(tzs[i]);else calendar.addComponent(tzs[i]);var state=function(expect_element,expect_value,next_state){return function(element,value,parameters){if(element!=expect_element)throw new ParseError("Expected "+expect_element+" got "+element);if(expect_value&&expect_value!=value)throw new ParseError("Expected "+expect_value+" got "+value);return next_state}}("BEGIN","VCALENDAR",function parse_component(component,next_state){var cal=component.calendar;return function this_state(element,value,parameters){if("BEGIN"==element){var factory=(schema[value]||{}).factory,child=void 0!==factory?new factory(cal):new CalendarObject(cal,value);return parse_component(child,(function(){return component.addComponent(child),this_state.apply(this,arguments)}))}if("END"==element)return next_state;var prop=properties[element]||{};return value=parse_value(prop.type,value,parameters,cal,prop.list),component.addProperty(element,value,parameters),this_state}}(calendar));for(i=0;i<data.length-1;++i)if(data[i].length){if(void 0===state)throw new ParseError("Mismatched BEGIN/END tags");for(var j=i;j+1<data.length&&(" "===data[j+1][0]||"\t"===data[j+1][0]);)++j;var record=data[i];if(j!=i){for(var d=data.slice(i,j+1),k=1;k<d.length;++k)d[k]=d[k].substr(1);record=d.join(""),i=j}state=state.apply(null,parse_record(record))}if(void 0!==state)throw new ParseError("Unable to parse calendar data; END:VCALENDAR not found!");return calendar}},function(module,__webpack_exports__,__webpack_require__){"use strict";let ACTION;__webpack_require__.d(__webpack_exports__,"a",(function(){return ACTION})),function(ACTION){ACTION[ACTION.ADD_REQUEST_MESSAGE=0]="ADD_REQUEST_MESSAGE",ACTION[ACTION.RESET_REQUEST_MESSAGES=1]="RESET_REQUEST_MESSAGES",ACTION[ACTION.CLOSE_MODAL=2]="CLOSE_MODAL",ACTION[ACTION.OPEN_MODAL=3]="OPEN_MODAL",ACTION[ACTION.RESET_ADVANCED_EDITOR_MESSAGES=4]="RESET_ADVANCED_EDITOR_MESSAGES",ACTION[ACTION.RESET_FORM=5]="RESET_FORM",ACTION[ACTION.SET_ADVANCED_EDITOR_RAW_STRING=6]="SET_ADVANCED_EDITOR_RAW_STRING",ACTION[ACTION.SET_FORM_STATE=7]="SET_FORM_STATE",ACTION[ACTION.SET_INDEX_PATTERN_TITLES=8]="SET_INDEX_PATTERN_TITLES",ACTION[ACTION.SET_IS_JOB_CREATED=9]="SET_IS_JOB_CREATED",ACTION[ACTION.SET_IS_JOB_STARTED=10]="SET_IS_JOB_STARTED",ACTION[ACTION.SET_IS_MODAL_BUTTON_DISABLED=11]="SET_IS_MODAL_BUTTON_DISABLED",ACTION[ACTION.SET_IS_MODAL_VISIBLE=12]="SET_IS_MODAL_VISIBLE",ACTION[ACTION.SET_JOB_CONFIG=13]="SET_JOB_CONFIG",ACTION[ACTION.SET_JOB_IDS=14]="SET_JOB_IDS",ACTION[ACTION.SWITCH_TO_ADVANCED_EDITOR=15]="SWITCH_TO_ADVANCED_EDITOR",ACTION[ACTION.SWITCH_TO_FORM=16]="SWITCH_TO_FORM",ACTION[ACTION.SET_ESTIMATED_MODEL_MEMORY_LIMIT=17]="SET_ESTIMATED_MODEL_MEMORY_LIMIT",ACTION[ACTION.SET_JOB_CLONE=18]="SET_JOB_CLONE"}(ACTION||(ACTION={}))},function(module,exports,__webpack_require__){var Stack=__webpack_require__(200),arrayEach=__webpack_require__(253),assignValue=__webpack_require__(205),baseAssign=__webpack_require__(552),baseAssignIn=__webpack_require__(558),cloneBuffer=__webpack_require__(332),copyArray=__webpack_require__(333),copySymbols=__webpack_require__(561),copySymbolsIn=__webpack_require__(562),getAllKeys=__webpack_require__(337),getAllKeysIn=__webpack_require__(563),getTag=__webpack_require__(155),initCloneArray=__webpack_require__(567),initCloneByTag=__webpack_require__(568),initCloneObject=__webpack_require__(342),isArray=__webpack_require__(80),isBuffer=__webpack_require__(154),isMap=__webpack_require__(572),isObject=__webpack_require__(109),isSet=__webpack_require__(574),keys=__webpack_require__(127),keysIn=__webpack_require__(143),cloneableTags={};cloneableTags["[object Arguments]"]=cloneableTags["[object Array]"]=cloneableTags["[object ArrayBuffer]"]=cloneableTags["[object DataView]"]=cloneableTags["[object Boolean]"]=cloneableTags["[object Date]"]=cloneableTags["[object Float32Array]"]=cloneableTags["[object Float64Array]"]=cloneableTags["[object Int8Array]"]=cloneableTags["[object Int16Array]"]=cloneableTags["[object Int32Array]"]=cloneableTags["[object Map]"]=cloneableTags["[object Number]"]=cloneableTags["[object Object]"]=cloneableTags["[object RegExp]"]=cloneableTags["[object Set]"]=cloneableTags["[object String]"]=cloneableTags["[object Symbol]"]=cloneableTags["[object Uint8Array]"]=cloneableTags["[object Uint8ClampedArray]"]=cloneableTags["[object Uint16Array]"]=cloneableTags["[object Uint32Array]"]=!0,cloneableTags["[object Error]"]=cloneableTags["[object Function]"]=cloneableTags["[object WeakMap]"]=!1,module.exports=function baseClone(value,bitmask,customizer,key,object,stack){var result,isDeep=1&bitmask,isFlat=2&bitmask,isFull=4&bitmask;if(customizer&&(result=object?customizer(value,key,object,stack):customizer(value)),void 0!==result)return result;if(!isObject(value))return value;var isArr=isArray(value);if(isArr){if(result=initCloneArray(value),!isDeep)return copyArray(value,result)}else{var tag=getTag(value),isFunc="[object Function]"==tag||"[object GeneratorFunction]"==tag;if(isBuffer(value))return cloneBuffer(value,isDeep);if("[object Object]"==tag||"[object Arguments]"==tag||isFunc&&!object){if(result=isFlat||isFunc?{}:initCloneObject(value),!isDeep)return isFlat?copySymbolsIn(value,baseAssignIn(result,value)):copySymbols(value,baseAssign(result,value))}else{if(!cloneableTags[tag])return object?value:{};result=initCloneByTag(value,tag,isDeep)}}stack||(stack=new Stack);var stacked=stack.get(value);if(stacked)return stacked;stack.set(value,result),isSet(value)?value.forEach((function(subValue){result.add(baseClone(subValue,bitmask,customizer,subValue,value,stack))})):isMap(value)&&value.forEach((function(subValue,key){result.set(key,baseClone(subValue,bitmask,customizer,key,value,stack))}));var props=isArr?void 0:(isFull?isFlat?getAllKeysIn:getAllKeys:isFlat?keysIn:keys)(value);return arrayEach(props||value,(function(subValue,key){props&&(subValue=value[key=subValue]),assignValue(result,key,baseClone(subValue,bitmask,customizer,key,value,stack))})),result}},function(module,exports,__webpack_require__){(function(global){var freeGlobal="object"==typeof global&&global&&global.Object===Object&&global;module.exports=freeGlobal}).call(this,__webpack_require__(117))},function(module,exports){var funcToString=Function.prototype.toString;module.exports=function(func){if(null!=func){try{return funcToString.call(func)}catch(e){}try{return func+""}catch(e){}}return""}},function(module,exports,__webpack_require__){var getNative=__webpack_require__(141),defineProperty=function(){try{var func=getNative(Object,"defineProperty");return func({},"",{}),func}catch(e){}}();module.exports=defineProperty},function(module,exports,__webpack_require__){var baseTimes=__webpack_require__(553),isArguments=__webpack_require__(174),isArray=__webpack_require__(80),isBuffer=__webpack_require__(154),isIndex=__webpack_require__(207),isTypedArray=__webpack_require__(175),hasOwnProperty=Object.prototype.hasOwnProperty;module.exports=function(value,inherited){var isArr=isArray(value),isArg=!isArr&&isArguments(value),isBuff=!isArr&&!isArg&&isBuffer(value),isType=!isArr&&!isArg&&!isBuff&&isTypedArray(value),skipIndexes=isArr||isArg||isBuff||isType,result=skipIndexes?baseTimes(value.length,String):[],length=result.length;for(var key in value)!inherited&&!hasOwnProperty.call(value,key)||skipIndexes&&("length"==key||isBuff&&("offset"==key||"parent"==key)||isType&&("buffer"==key||"byteLength"==key||"byteOffset"==key)||isIndex(key,length))||result.push(key);return result}},function(module,exports){module.exports=function(func,transform){return function(arg){return func(transform(arg))}}},function(module,exports,__webpack_require__){(function(module){var root=__webpack_require__(114),freeExports=exports&&!exports.nodeType&&exports,freeModule=freeExports&&"object"==typeof module&&module&&!module.nodeType&&module,Buffer=freeModule&&freeModule.exports===freeExports?root.Buffer:void 0,allocUnsafe=Buffer?Buffer.allocUnsafe:void 0;module.exports=function(buffer,isDeep){if(isDeep)return buffer.slice();var length=buffer.length,result=allocUnsafe?allocUnsafe(length):new buffer.constructor(length);return buffer.copy(result),result}}).call(this,__webpack_require__(165)(module))},function(module,exports){module.exports=function(source,array){var index=-1,length=source.length;for(array||(array=Array(length));++index<length;)array[index]=source[index];return array}},function(module,exports){module.exports=function(array,predicate){for(var index=-1,length=null==array?0:array.length,resIndex=0,result=[];++index<length;){var value=array[index];predicate(value,index,array)&&(result[resIndex++]=value)}return result}},function(module,exports){module.exports=function(){return[]}},function(module,exports,__webpack_require__){var arrayPush=__webpack_require__(258),getPrototype=__webpack_require__(210),getSymbols=__webpack_require__(257),stubArray=__webpack_require__(335),getSymbolsIn=Object.getOwnPropertySymbols?function(object){for(var result=[];object;)arrayPush(result,getSymbols(object)),object=getPrototype(object);return result}:stubArray;module.exports=getSymbolsIn},function(module,exports,__webpack_require__){var baseGetAllKeys=__webpack_require__(338),getSymbols=__webpack_require__(257),keys=__webpack_require__(127);module.exports=function(object){return baseGetAllKeys(object,keys,getSymbols)}},function(module,exports,__webpack_require__){var arrayPush=__webpack_require__(258),isArray=__webpack_require__(80);module.exports=function(object,keysFunc,symbolsFunc){var result=keysFunc(object);return isArray(object)?result:arrayPush(result,symbolsFunc(object))}},function(module,exports,__webpack_require__){var Set=__webpack_require__(141)(__webpack_require__(114),"Set");module.exports=Set},function(module,exports,__webpack_require__){var Uint8Array=__webpack_require__(114).Uint8Array;module.exports=Uint8Array},function(module,exports,__webpack_require__){var cloneArrayBuffer=__webpack_require__(259);module.exports=function(typedArray,isDeep){var buffer=isDeep?cloneArrayBuffer(typedArray.buffer):typedArray.buffer;return new typedArray.constructor(buffer,typedArray.byteOffset,typedArray.length)}},function(module,exports,__webpack_require__){var baseCreate=__webpack_require__(343),getPrototype=__webpack_require__(210),isPrototype=__webpack_require__(209);module.exports=function(object){return"function"!=typeof object.constructor||isPrototype(object)?{}:baseCreate(getPrototype(object))}},function(module,exports,__webpack_require__){var isObject=__webpack_require__(109),objectCreate=Object.create,baseCreate=function(){function object(){}return function(proto){if(!isObject(proto))return{};if(objectCreate)return objectCreate(proto);object.prototype=proto;var result=new object;return object.prototype=void 0,result}}();module.exports=baseCreate},function(module,exports,__webpack_require__){module.exports=__webpack_require__(345)},function(module,exports,__webpack_require__){var arrayEach=__webpack_require__(253),baseEach=__webpack_require__(211),castFunction=__webpack_require__(346),isArray=__webpack_require__(80);module.exports=function(collection,iteratee){return(isArray(collection)?arrayEach:baseEach)(collection,castFunction(iteratee))}},function(module,exports,__webpack_require__){var identity=__webpack_require__(144);module.exports=function(value){return"function"==typeof value?value:identity}},function(module,exports,__webpack_require__){var arrayFilter=__webpack_require__(334),baseFilter=__webpack_require__(578),baseIteratee=__webpack_require__(124),isArray=__webpack_require__(80);module.exports=function(collection,predicate){return(isArray(collection)?arrayFilter:baseFilter)(collection,baseIteratee(predicate,3))}},function(module,exports,__webpack_require__){var baseIsEqualDeep=__webpack_require__(581),isObjectLike=__webpack_require__(120);module.exports=function baseIsEqual(value,other,bitmask,customizer,stack){return value===other||(null==value||null==other||!isObjectLike(value)&&!isObjectLike(other)?value!=value&&other!=other:baseIsEqualDeep(value,other,bitmask,customizer,baseIsEqual,stack))}},function(module,exports,__webpack_require__){var SetCache=__webpack_require__(350),arraySome=__webpack_require__(584),cacheHas=__webpack_require__(351);module.exports=function(array,other,bitmask,customizer,equalFunc,stack){var isPartial=1&bitmask,arrLength=array.length,othLength=other.length;if(arrLength!=othLength&&!(isPartial&&othLength>arrLength))return!1;var arrStacked=stack.get(array),othStacked=stack.get(other);if(arrStacked&&othStacked)return arrStacked==other&&othStacked==array;var index=-1,result=!0,seen=2&bitmask?new SetCache:void 0;for(stack.set(array,other),stack.set(other,array);++index<arrLength;){var arrValue=array[index],othValue=other[index];if(customizer)var compared=isPartial?customizer(othValue,arrValue,index,other,array,stack):customizer(arrValue,othValue,index,array,other,stack);if(void 0!==compared){if(compared)continue;result=!1;break}if(seen){if(!arraySome(other,(function(othValue,othIndex){if(!cacheHas(seen,othIndex)&&(arrValue===othValue||equalFunc(arrValue,othValue,bitmask,customizer,stack)))return seen.push(othIndex)}))){result=!1;break}}else if(arrValue!==othValue&&!equalFunc(arrValue,othValue,bitmask,customizer,stack)){result=!1;break}}return stack.delete(array),stack.delete(other),result}},function(module,exports,__webpack_require__){var MapCache=__webpack_require__(252),setCacheAdd=__webpack_require__(582),setCacheHas=__webpack_require__(583);function SetCache(values){var index=-1,length=null==values?0:values.length;for(this.__data__=new MapCache;++index<length;)this.add(values[index])}SetCache.prototype.add=SetCache.prototype.push=setCacheAdd,SetCache.prototype.has=setCacheHas,module.exports=SetCache},function(module,exports){module.exports=function(cache,key){return cache.has(key)}},function(module,exports,__webpack_require__){var isObject=__webpack_require__(109);module.exports=function(value){return value==value&&!isObject(value)}},function(module,exports){module.exports=function(key,srcValue){return function(object){return null!=object&&(object[key]===srcValue&&(void 0!==srcValue||key in Object(object)))}}},function(module,exports,__webpack_require__){var baseToString=__webpack_require__(594);module.exports=function(value){return null==value?"":baseToString(value)}},function(module,exports,__webpack_require__){var baseHasIn=__webpack_require__(595),hasPath=__webpack_require__(356);module.exports=function(object,path){return null!=object&&hasPath(object,path,baseHasIn)}},function(module,exports,__webpack_require__){var castPath=__webpack_require__(213),isArguments=__webpack_require__(174),isArray=__webpack_require__(80),isIndex=__webpack_require__(207),isLength=__webpack_require__(254),toKey=__webpack_require__(176);module.exports=function(object,path,hasFunc){for(var index=-1,length=(path=castPath(path,object)).length,result=!1;++index<length;){var key=toKey(path[index]);if(!(result=null!=object&&hasFunc(object,key)))break;object=object[key]}return result||++index!=length?result:!!(length=null==object?0:object.length)&&isLength(length)&&isIndex(key,length)&&(isArray(object)||isArguments(object))}},function(module,exports){module.exports=function(key){return function(object){return null==object?void 0:object[key]}}},function(module,exports,__webpack_require__){var baseHas=__webpack_require__(598),hasPath=__webpack_require__(356);module.exports=function(object,path){return null!=object&&hasPath(object,path,baseHas)}},function(module,exports){module.exports=function(value){return void 0===value}},function(module,exports,__webpack_require__){var arrayMap=__webpack_require__(214),baseIteratee=__webpack_require__(124),baseMap=__webpack_require__(361),isArray=__webpack_require__(80);module.exports=function(collection,iteratee){return(isArray(collection)?arrayMap:baseMap)(collection,baseIteratee(iteratee,3))}},function(module,exports,__webpack_require__){var baseEach=__webpack_require__(211),isArrayLike=__webpack_require__(123);module.exports=function(collection,iteratee){var index=-1,result=isArrayLike(collection)?Array(collection.length):[];return baseEach(collection,(function(value,key,collection){result[++index]=iteratee(value,key,collection)})),result}},function(module,exports,__webpack_require__){var arrayReduce=__webpack_require__(600),baseEach=__webpack_require__(211),baseIteratee=__webpack_require__(124),baseReduce=__webpack_require__(601),isArray=__webpack_require__(80);module.exports=function(collection,iteratee,accumulator){var func=isArray(collection)?arrayReduce:baseReduce,initAccum=arguments.length<3;return func(collection,baseIteratee(iteratee,4),accumulator,initAccum,baseEach)}},function(module,exports,__webpack_require__){var apply=__webpack_require__(611),nativeMax=Math.max;module.exports=function(func,start,transform){return start=nativeMax(void 0===start?func.length-1:start,0),function(){for(var args=arguments,index=-1,length=nativeMax(args.length-start,0),array=Array(length);++index<length;)array[index]=args[start+index];index=-1;for(var otherArgs=Array(start+1);++index<start;)otherArgs[index]=args[index];return otherArgs[start]=transform(array),apply(func,this,otherArgs)}}},function(module,exports,__webpack_require__){var baseSetToString=__webpack_require__(612),setToString=__webpack_require__(613)(baseSetToString);module.exports=setToString},function(module,exports){module.exports=function(array,predicate,fromIndex,fromRight){for(var length=array.length,index=fromIndex+(fromRight?1:-1);fromRight?index--:++index<length;)if(predicate(array[index],index,array))return index;return-1}},function(module,exports,__webpack_require__){var isArrayLike=__webpack_require__(123),isObjectLike=__webpack_require__(120);module.exports=function(value){return isObjectLike(value)&&isArrayLike(value)}},function(module,exports,__webpack_require__){var baseValues=__webpack_require__(622),keys=__webpack_require__(127);module.exports=function(object){return null==object?[]:baseValues(object,keys(object))}},function(module,exports,__webpack_require__){var _=__webpack_require__(108),PriorityQueue=__webpack_require__(369);module.exports=function(g,source,weightFn,edgeFn){return function(g,source,weightFn,edgeFn){var v,vEntry,results={},pq=new PriorityQueue,updateNeighbors=function(edge){var w=edge.v!==v?edge.v:edge.w,wEntry=results[w],weight=weightFn(edge),distance=vEntry.distance+weight;if(weight<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+edge+" Weight: "+weight);distance<wEntry.distance&&(wEntry.distance=distance,wEntry.predecessor=v,pq.decrease(w,distance))};g.nodes().forEach((function(v){var distance=v===source?0:Number.POSITIVE_INFINITY;results[v]={distance:distance},pq.add(v,distance)}));for(;pq.size()>0&&(v=pq.removeMin(),(vEntry=results[v]).distance!==Number.POSITIVE_INFINITY);)edgeFn(v).forEach(updateNeighbors);return results}(g,String(source),weightFn||DEFAULT_WEIGHT_FUNC,edgeFn||function(v){return g.outEdges(v)})};var DEFAULT_WEIGHT_FUNC=_.constant(1)},function(module,exports,__webpack_require__){var _=__webpack_require__(108);function PriorityQueue(){this._arr=[],this._keyIndices={}}module.exports=PriorityQueue,PriorityQueue.prototype.size=function(){return this._arr.length},PriorityQueue.prototype.keys=function(){return this._arr.map((function(x){return x.key}))},PriorityQueue.prototype.has=function(key){return _.has(this._keyIndices,key)},PriorityQueue.prototype.priority=function(key){var index=this._keyIndices[key];if(void 0!==index)return this._arr[index].priority},PriorityQueue.prototype.min=function(){if(0===this.size())throw new Error("Queue underflow");return this._arr[0].key},PriorityQueue.prototype.add=function(key,priority){var keyIndices=this._keyIndices;if(key=String(key),!_.has(keyIndices,key)){var arr=this._arr,index=arr.length;return keyIndices[key]=index,arr.push({key:key,priority:priority}),this._decrease(index),!0}return!1},PriorityQueue.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var min=this._arr.pop();return delete this._keyIndices[min.key],this._heapify(0),min.key},PriorityQueue.prototype.decrease=function(key,priority){var index=this._keyIndices[key];if(priority>this._arr[index].priority)throw new Error("New priority is greater than current priority. Key: "+key+" Old: "+this._arr[index].priority+" New: "+priority);this._arr[index].priority=priority,this._decrease(index)},PriorityQueue.prototype._heapify=function(i){var arr=this._arr,l=2*i,r=l+1,largest=i;l<arr.length&&(largest=arr[l].priority<arr[largest].priority?l:largest,r<arr.length&&(largest=arr[r].priority<arr[largest].priority?r:largest),largest!==i&&(this._swap(i,largest),this._heapify(largest)))},PriorityQueue.prototype._decrease=function(index){for(var parent,arr=this._arr,priority=arr[index].priority;0!==index&&!(arr[parent=index>>1].priority<priority);)this._swap(index,parent),index=parent},PriorityQueue.prototype._swap=function(i,j){var arr=this._arr,keyIndices=this._keyIndices,origArrI=arr[i],origArrJ=arr[j];arr[i]=origArrJ,arr[j]=origArrI,keyIndices[origArrJ.key]=i,keyIndices[origArrI.key]=j}},function(module,exports,__webpack_require__){var _=__webpack_require__(108);module.exports=function(g){var index=0,stack=[],visited={},results=[];return g.nodes().forEach((function(v){_.has(visited,v)||function dfs(v){var entry=visited[v]={onStack:!0,lowlink:index,index:index++};if(stack.push(v),g.successors(v).forEach((function(w){_.has(visited,w)?visited[w].onStack&&(entry.lowlink=Math.min(entry.lowlink,visited[w].index)):(dfs(w),entry.lowlink=Math.min(entry.lowlink,visited[w].lowlink))})),entry.lowlink===entry.index){var w,cmpt=[];do{w=stack.pop(),visited[w].onStack=!1,cmpt.push(w)}while(v!==w);results.push(cmpt)}}(v)})),results}},function(module,exports,__webpack_require__){var _=__webpack_require__(108);function topsort(g){var visited={},stack={},results=[];if(_.each(g.sinks(),(function visit(node){if(_.has(stack,node))throw new CycleException;_.has(visited,node)||(stack[node]=!0,visited[node]=!0,_.each(g.predecessors(node),visit),delete stack[node],results.push(node))})),_.size(visited)!==g.nodeCount())throw new CycleException;return results}function CycleException(){}module.exports=topsort,topsort.CycleException=CycleException,CycleException.prototype=new Error},function(module,exports,__webpack_require__){var _=__webpack_require__(108);module.exports=function(g,vs,order){_.isArray(vs)||(vs=[vs]);var navigation=(g.isDirected()?g.successors:g.neighbors).bind(g),acc=[],visited={};return _.each(vs,(function(v){if(!g.hasNode(v))throw new Error("Graph does not have node: "+v);!function doDfs(g,v,postorder,visited,navigation,acc){_.has(visited,v)||(visited[v]=!0,postorder||acc.push(v),_.each(navigation(v),(function(w){doDfs(g,w,postorder,visited,navigation,acc)})),postorder&&acc.push(v))}(g,v,"post"===order,visited,navigation,acc)})),acc}},function(module,exports,__webpack_require__){var toNumber=__webpack_require__(641);module.exports=function(value){return value?(value=toNumber(value))===1/0||value===-1/0?17976931348623157e292*(value<0?-1:1):value==value?value:0:0===value?value:0}},function(module,exports,__webpack_require__){var baseFlatten=__webpack_require__(265);module.exports=function(array){return(null==array?0:array.length)?baseFlatten(array,1):[]}},function(module,exports,__webpack_require__){var baseAssignValue=__webpack_require__(206),eq=__webpack_require__(152);module.exports=function(object,key,value){(void 0!==value&&!eq(object[key],value)||void 0===value&&!(key in object))&&baseAssignValue(object,key,value)}},function(module,exports){module.exports=function(object,key){if(("constructor"!==key||"function"!=typeof object[key])&&"__proto__"!=key)return object[key]}},function(module,exports){module.exports=function(value,other){return value<other}},function(module,exports,__webpack_require__){"use strict";var _=__webpack_require__(78),Graph=__webpack_require__(113).Graph,slack=__webpack_require__(217).slack;function tightTree(t,g){return _.forEach(t.nodes(),(function dfs(v){_.forEach(g.nodeEdges(v),(function(e){var edgeV=e.v,w=v===edgeV?e.w:edgeV;t.hasNode(w)||slack(g,e)||(t.setNode(w,{}),t.setEdge(v,w,{}),dfs(w))}))})),t.nodeCount()}function findMinSlackEdge(t,g){return _.minBy(g.edges(),(function(e){if(t.hasNode(e.v)!==t.hasNode(e.w))return slack(g,e)}))}function shiftRanks(t,g,delta){_.forEach(t.nodes(),(function(v){g.node(v).rank+=delta}))}module.exports=function(g){var edge,delta,t=new Graph({directed:!1}),start=g.nodes()[0],size=g.nodeCount();t.setNode(start,{});for(;tightTree(t,g)<size;)edge=findMinSlackEdge(t,g),delta=t.hasNode(edge.v)?slack(g,edge):-slack(g,edge),shiftRanks(t,g,delta);return t}},function(module,exports,__webpack_require__){switch(window.__kbnThemeTag__){case"v7dark":return __webpack_require__(714);case"v7light":return __webpack_require__(716);case"v8dark":return __webpack_require__(718);case"v8light":return __webpack_require__(720)}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return useStorage}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(14),_kibana__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(63);function useStorage(key,initValue){var _storage$get;const{services:{storage:storage}}=Object(_kibana__WEBPACK_IMPORTED_MODULE_1__.b)(),[val,setVal]=Object(react__WEBPACK_IMPORTED_MODULE_0__.useState)(null!==(_storage$get=storage.get(key))&&void 0!==_storage$get?_storage$get:initValue);return[val,Object(react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(value=>{try{storage.set(key,value),setVal(value)}catch(e){throw new Error("Unable to update storage with provided value")}},[])]}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return ML_ENTITY_FIELDS_CONFIG})),__webpack_require__.d(__webpack_exports__,"a",(function(){return ML_APPLY_TIME_RANGE_CONFIG}));const ML_ENTITY_FIELDS_CONFIG="ml.singleMetricViewer.partitionFields",ML_APPLY_TIME_RANGE_CONFIG="ml.jobSelectorFlyout.applyTimeRange"},,,,,,,,,,,,,,,,function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"AnomalyTimelineService",(function(){return AnomalyTimelineService}));var _src_plugins_data_public__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(41),_util_time_buckets__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(90),_explorer_explorer_constants__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(75);function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class AnomalyTimelineService{constructor(timeFilter,uiSettings,mlResultsService){this.timeFilter=timeFilter,this.mlResultsService=mlResultsService,_defineProperty(this,"timeBuckets",void 0),_defineProperty(this,"_customTimeRange",void 0),this.timeBuckets=new _util_time_buckets__WEBPACK_IMPORTED_MODULE_1__.a({"histogram:maxBars":uiSettings.get(_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_0__.UI_SETTINGS.HISTOGRAM_MAX_BARS),"histogram:barTarget":uiSettings.get(_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_0__.UI_SETTINGS.HISTOGRAM_BAR_TARGET),dateFormat:uiSettings.get("dateFormat"),"dateFormat:scaled":uiSettings.get("dateFormat:scaled")}),this.timeFilter.enableTimeRangeSelector()}setTimeRange(timeRange){this._customTimeRange=timeRange}getSwimlaneBucketInterval(selectedJobs,swimlaneContainerWidth){const bounds=this.getTimeBounds();if(void 0===bounds)throw new Error("timeRangeSelectorEnabled has to be enabled");this.timeBuckets.setInterval("auto"),this.timeBuckets.setBounds(bounds);const intervalSeconds=this.timeBuckets.getInterval().asSeconds(),numBuckets=(bounds.max.valueOf()-bounds.min.valueOf())/1e3/intervalSeconds;Math.floor(swimlaneContainerWidth/numBuckets*100)/100<8&&this.timeBuckets.setInterval(2*intervalSeconds+"s");const maxBucketSpanSeconds=selectedJobs.reduce((memo,job)=>Math.max(memo,job.bucketSpanSeconds),0);return maxBucketSpanSeconds>intervalSeconds&&(this.timeBuckets.setInterval(maxBucketSpanSeconds+"s"),this.timeBuckets.setBounds(bounds)),this.timeBuckets.getInterval()}async loadOverallData(selectedJobs,chartWidth,bucketInterval){const interval=null!=bucketInterval?bucketInterval:this.getSwimlaneBucketInterval(selectedJobs,chartWidth);if(!selectedJobs||!selectedJobs.length)throw new Error("Explorer jobs collection is required");const bounds=this.getTimeBounds(),searchBounds=Object(_util_time_buckets__WEBPACK_IMPORTED_MODULE_1__.b)(bounds,interval,!1),selectedJobIds=selectedJobs.map(d=>d.id),overallBucketsBounds=Object(_util_time_buckets__WEBPACK_IMPORTED_MODULE_1__.b)(bounds,interval,!0),resp=await this.mlResultsService.getOverallBucketScores(selectedJobIds,1,overallBucketsBounds.min.valueOf(),overallBucketsBounds.max.valueOf(),interval.asSeconds()+"s");return this.processOverallResults(resp.results,searchBounds,interval.asSeconds())}async loadViewBySwimlane(fieldValues,bounds,selectedJobs,viewBySwimlaneFieldName,swimlaneLimit,perPage,fromPage,swimlaneContainerWidth,influencersFilterQuery,bucketInterval){const timefilterBounds=this.getTimeBounds();if(void 0===timefilterBounds)throw new Error("timeRangeSelectorEnabled has to be enabled");const swimlaneBucketInterval=null!=bucketInterval?bucketInterval:this.getSwimlaneBucketInterval(selectedJobs,swimlaneContainerWidth),searchBounds=Object(_util_time_buckets__WEBPACK_IMPORTED_MODULE_1__.b)(timefilterBounds,swimlaneBucketInterval,!1),selectedJobIds=selectedJobs.map(d=>d.id),intervalMs=swimlaneBucketInterval.asMilliseconds();let response;if(viewBySwimlaneFieldName===_explorer_explorer_constants__WEBPACK_IMPORTED_MODULE_2__.j){const jobIds=void 0!==fieldValues&&fieldValues.length>0?fieldValues:selectedJobIds;response=await this.mlResultsService.getScoresByBucket(jobIds,searchBounds.min.valueOf(),searchBounds.max.valueOf(),intervalMs,perPage,fromPage)}else response=await this.mlResultsService.getInfluencerValueMaxScoreByTime(selectedJobIds,viewBySwimlaneFieldName,fieldValues,searchBounds.min.valueOf(),searchBounds.max.valueOf(),intervalMs,swimlaneLimit,perPage,fromPage,influencersFilterQuery);if(void 0===response)return;return this.processViewByResults(response.results,response.cardinality,fieldValues,bounds,viewBySwimlaneFieldName,swimlaneBucketInterval.asSeconds())}async loadViewByTopFieldValuesForSelectedTime(earliestMs,latestMs,selectedJobs,viewBySwimlaneFieldName,swimlaneLimit,perPage,fromPage,swimlaneContainerWidth){const selectedJobIds=selectedJobs.map(d=>d.id);if(viewBySwimlaneFieldName!==_explorer_explorer_constants__WEBPACK_IMPORTED_MODULE_2__.j){const resp=await this.mlResultsService.getTopInfluencers(selectedJobIds,earliestMs,latestMs,swimlaneLimit,perPage,fromPage);if(void 0===resp.influencers[viewBySwimlaneFieldName])return[];const topFieldValues=[],topInfluencers=resp.influencers[viewBySwimlaneFieldName];return Array.isArray(topInfluencers)&&topInfluencers.forEach(influencerData=>{influencerData.maxAnomalyScore>0&&topFieldValues.push(influencerData.influencerFieldValue)}),topFieldValues}{const resp=await this.mlResultsService.getScoresByBucket(selectedJobIds,earliestMs,latestMs,this.getSwimlaneBucketInterval(selectedJobs,swimlaneContainerWidth).asMilliseconds(),swimlaneLimit);return Object.keys(resp.results)}}getTimeBounds(){return void 0!==this._customTimeRange?this.timeFilter.calculateBounds(this._customTimeRange):this.timeFilter.getBounds()}processOverallResults(scoresByTime,searchBounds,interval){const overallLabel=_explorer_explorer_constants__WEBPACK_IMPORTED_MODULE_2__.g,dataset={laneLabels:[overallLabel],points:[],interval:interval,earliest:searchBounds.min.valueOf()/1e3,latest:searchBounds.max.valueOf()/1e3};return Object.entries(scoresByTime).forEach(([timeMs,score])=>{const time=+timeMs/1e3;dataset.points.push({laneLabel:overallLabel,time:time,value:score}),dataset.earliest=Math.min(time,dataset.earliest),dataset.latest=Math.max(time+dataset.interval,dataset.latest)}),dataset}processViewByResults(scoresByInfluencerAndTime,cardinality,sortedLaneValues,bounds,viewBySwimlaneFieldName,interval){const dataset={fieldName:viewBySwimlaneFieldName,points:[],laneLabels:[],interval:interval,earliest:bounds.earliest,latest:bounds.latest,cardinality:cardinality},maxScoreByLaneLabel={};Object.entries(scoresByInfluencerAndTime).forEach(([influencerFieldValue,influencerData])=>{dataset.laneLabels.push(influencerFieldValue),maxScoreByLaneLabel[influencerFieldValue]=0,Object.entries(influencerData).forEach(([timeMs,anomalyScore])=>{const time=+timeMs/1e3;dataset.points.push({laneLabel:influencerFieldValue,time:time,value:anomalyScore}),maxScoreByLaneLabel[influencerFieldValue]=Math.max(maxScoreByLaneLabel[influencerFieldValue],anomalyScore)})});const sortValuesLength=sortedLaneValues.length;return dataset.laneLabels=0===sortValuesLength?dataset.laneLabels.sort((a,b)=>maxScoreByLaneLabel[b]-maxScoreByLaneLabel[a]):dataset.laneLabels.sort((a,b)=>{let aIndex=sortedLaneValues.indexOf(a),bIndex=sortedLaneValues.indexOf(b);return aIndex=aIndex>-1?aIndex:sortValuesLength,bIndex=bIndex>-1?bIndex:sortValuesLength,aIndex-bIndex}),dataset}}},,,,function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return MAX_ANOMALY_CHARTS_ALLOWED})),__webpack_require__.d(__webpack_exports__,"a",(function(){return AnomalyChartsInitializer}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(14),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),_elastic_eui__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(39),_kbn_i18n_react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(40),_application_services_anomaly_explorer_charts_service__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(222);const MAX_ANOMALY_CHARTS_ALLOWED=48,AnomalyChartsInitializer=({defaultTitle:defaultTitle,initialInput:initialInput,onCreate:onCreate,onCancel:onCancel})=>{var _initialInput$maxSeri;const[panelTitle,setPanelTitle]=Object(react__WEBPACK_IMPORTED_MODULE_0__.useState)(defaultTitle),[maxSeriesToPlot,setMaxSeriesToPlot]=Object(react__WEBPACK_IMPORTED_MODULE_0__.useState)(null!==(_initialInput$maxSeri=null==initialInput?void 0:initialInput.maxSeriesToPlot)&&void 0!==_initialInput$maxSeri?_initialInput$maxSeri:_application_services_anomaly_explorer_charts_service__WEBPACK_IMPORTED_MODULE_3__.b),isPanelTitleValid=panelTitle.length>0,isFormValid=isPanelTitleValid&&maxSeriesToPlot>0;return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__.EuiModal,{initialFocus:"[name=panelTitle]",onClose:onCancel,"data-test-subj":"mlAnomalyChartsEmbeddableInitializer"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__.EuiModalHeader,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__.EuiModalHeaderTitle,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("h2",null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_kbn_i18n_react__WEBPACK_IMPORTED_MODULE_2__.FormattedMessage,{id:"xpack.ml.anomalyChartsEmbeddable.setupModal.title",defaultMessage:"Anomaly explorer charts configuration"})))),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__.EuiModalBody,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__.EuiForm,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__.EuiFormRow,{label:react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_kbn_i18n_react__WEBPACK_IMPORTED_MODULE_2__.FormattedMessage,{id:"xpack.ml.anomalyChartsEmbeddable.panelTitleLabel",defaultMessage:"Panel title"}),isInvalid:!isPanelTitleValid},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__.EuiFieldText,{"data-test-subj":"panelTitleInput",id:"panelTitle",name:"panelTitle",value:panelTitle,onChange:e=>setPanelTitle(e.target.value),isInvalid:!isPanelTitleValid})),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__.EuiFormRow,{label:react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_kbn_i18n_react__WEBPACK_IMPORTED_MODULE_2__.FormattedMessage,{id:"xpack.ml.anomalyChartsEmbeddable.maxSeriesToPlotLabel",defaultMessage:"Maximum number of series to plot"})},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__.EuiFieldNumber,{"data-test-subj":"mlAnomalyChartsInitializerMaxSeries",id:"selectMaxSeriesToPlot",name:"selectMaxSeriesToPlot",value:maxSeriesToPlot,onChange:e=>setMaxSeriesToPlot(parseInt(e.target.value,10)),min:0,max:MAX_ANOMALY_CHARTS_ALLOWED})))),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__.EuiModalFooter,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__.EuiButtonEmpty,{onClick:onCancel,"data-test-subj":"mlAnomalyChartsInitializerCancelButton"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_kbn_i18n_react__WEBPACK_IMPORTED_MODULE_2__.FormattedMessage,{id:"xpack.ml.anomalyChartsEmbeddable.setupModal.cancelButtonLabel",defaultMessage:"Cancel"})),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__.EuiButton,{"data-test-subj":"mlAnomalyChartsInitializerConfirmButton",isDisabled:!isFormValid,onClick:onCreate.bind(null,{panelTitle:panelTitle,maxSeriesToPlot:maxSeriesToPlot}),fill:!0},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_kbn_i18n_react__WEBPACK_IMPORTED_MODULE_2__.FormattedMessage,{id:"xpack.ml.anomalyChartsEmbeddable.setupModal.confirmButtonLabel",defaultMessage:"Confirm configurations"}))))}},,,,,,,,,function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return jobs_list_view_JobsListView}));var external_kbnSharedDeps_React_=__webpack_require__(14),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(40),external_kbnSharedDeps_ElasticEui_=__webpack_require__(39),external_kbnSharedDeps_Lodash_=__webpack_require__(7),ml_api_service=__webpack_require__(64),external_kbnSharedDeps_KbnI18n_=__webpack_require__(2),job_service=__webpack_require__(70),toast_notification_service=__webpack_require__(73),dependency_cache=__webpack_require__(22),string_utils=__webpack_require__(89),states=__webpack_require__(106),parse_interval=__webpack_require__(26),calendar_service=__webpack_require__(313),object_utils=__webpack_require__(4);function loadFullJob(jobId){return new Promise((resolve,reject)=>{ml_api_service.ml.jobs.jobs([jobId]).then(jobs=>{if(!jobs.length)throw new Error("Could not find job "+jobId);resolve(jobs[0])}).catch(error=>{reject(error)})})}function loadJobForCloning(jobId){return new Promise((resolve,reject)=>{ml_api_service.ml.jobs.jobForCloning(jobId).then(resp=>{if(!resp)throw new Error("Could not find job "+jobId);resolve(resp)}).catch(error=>{reject(error)})})}function isStartable(jobs){return jobs.some(j=>j.datafeedState===states.a.STOPPED&&j.jobState!==states.c.CLOSING)}function isStoppable(jobs){return jobs.some(j=>j.datafeedState===states.a.STARTED||j.datafeedState===states.a.STARTING)}function isClosable(jobs){return jobs.some(j=>j.datafeedState===states.a.STOPPED&&j.jobState!==states.c.CLOSED&&j.jobState!==states.c.CLOSING)}function stopDatafeeds(jobs,finish=(()=>{})){const datafeedIds=jobs.filter(j=>j.hasDatafeed).map(j=>j.datafeedId);job_service.a.stopDatafeeds(datafeedIds).then(resp=>{showResults(resp,states.a.STOPPED),finish()}).catch(error=>{Object(dependency_cache.j)().addDanger(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.stopJobErrorMessage",{defaultMessage:"Jobs failed to stop"}),error),finish()})}function showResults(resp,action){const successes=[],failures=[];for(const d in resp)!0===resp[d][action]||!1===resp[d][action]&&409===resp[d].error.statusCode&&action===states.a.STARTED?successes.push(d):failures.push({id:d,result:resp[d]});let actionText="",actionTextPT="";action===states.a.STARTED?(actionText=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.startActionStatusText",{defaultMessage:"start"}),actionTextPT=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.startedActionStatusText",{defaultMessage:"started"})):action===states.a.STOPPED?(actionText=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.stopActionStatusText",{defaultMessage:"stop"}),actionTextPT=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.stoppedActionStatusText",{defaultMessage:"stopped"})):action===states.a.DELETED?(actionText=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.deleteActionStatusText",{defaultMessage:"delete"}),actionTextPT=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.deletedActionStatusText",{defaultMessage:"deleted"})):action===states.c.CLOSED&&(actionText=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.closeActionStatusText",{defaultMessage:"close"}),actionTextPT=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.closedActionStatusText",{defaultMessage:"closed"}));const toastNotifications=Object(dependency_cache.j)();toastNotifications.addSuccess(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.actionExecuteSuccessfullyNotificationMessage",{defaultMessage:"{successesJobsCount, plural, one{{successJob}} other{# jobs}} {actionTextPT} successfully",values:{successesJobsCount:successes.length,successJob:successes[0],actionTextPT:actionTextPT}})),failures.length>0&&failures.forEach(f=>{Object(toast_notification_service.b)(toastNotifications).displayErrorToast(f.result.error,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.actionFailedNotificationMessage",{defaultMessage:"{failureId} failed to {actionText}",values:{failureId:f.id,actionText:actionText}}))})}function closeJobs(jobs,finish=(()=>{})){const jobIds=jobs.map(j=>j.id);job_service.a.closeJobs(jobIds).then(resp=>{showResults(resp,states.c.CLOSED),finish()}).catch(error=>{Object(toast_notification_service.a)().displayErrorToast(error,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.closeJobErrorMessage",{defaultMessage:"Jobs failed to close"})),finish()})}function filterJobs(jobs,clauses){if(0===clauses.length)return jobs;const matches=jobs.reduce((p,c)=>(p[c.id]={job:c,count:0},p),{});clauses.forEach(c=>{const bool="must"===c.match;let js=[];js="term"===c.type?!0===bool?jobs.filter(job=>Object(string_utils.f)(job.id,c.value)===bool||Object(string_utils.f)(job.description,c.value)===bool||Object(string_utils.f)(job.memory_status,c.value)===bool):jobs.filter(job=>Object(string_utils.f)(job.id,c.value)===bool&&Object(string_utils.f)(job.description,c.value)===bool&&Object(string_utils.f)(job.memory_status,c.value)===bool):Array.isArray(c.value)?"id"===c.field?jobs.filter(job=>c.value.indexOf(jobProperty(job,c.field))>=0):jobs.filter(job=>jobProperty(job,c.field).some(g=>c.value.indexOf(g)>=0)):jobs.filter(job=>jobProperty(job,c.field)===c.value),js.forEach(j=>matches[j.id].count++)});const filteredJobs=[];return Object(external_kbnSharedDeps_Lodash_.each)(matches,m=>{m.count>=clauses.length&&filteredJobs.push(m.job)}),filteredJobs}function jobProperty(job,prop){return job[{job_state:"jobState",datafeed_state:"datafeedState",groups:"groups",id:"id"}[prop]]}var external_kbnSharedDeps_Moment_=__webpack_require__(15),external_kbnSharedDeps_Moment_default=__webpack_require__.n(external_kbnSharedDeps_Moment_),check_capabilities=__webpack_require__(68),check_ml_nodes=__webpack_require__(83),index_utils=__webpack_require__(82);function actionsMenuContent(showEditJobFlyout,showDeleteJobModal,showStartDatafeedModal,refreshJobs,showCreateAlertFlyout){const canCreateJob=Object(check_capabilities.e)("canCreateJob")&&Object(check_ml_nodes.e)(),canUpdateJob=Object(check_capabilities.e)("canUpdateJob"),canDeleteJob=Object(check_capabilities.e)("canDeleteJob"),canUpdateDatafeed=Object(check_capabilities.e)("canUpdateDatafeed"),canStartStopDatafeed=Object(check_capabilities.e)("canStartStopDatafeed")&&Object(check_ml_nodes.e)(),canCloseJob=Object(check_capabilities.e)("canCloseJob")&&Object(check_ml_nodes.e)(),canCreateMlAlerts=Object(check_capabilities.e)("canCreateMlAlerts");return[{name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.managementActions.startDatafeedLabel",{defaultMessage:"Start datafeed"}),description:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.managementActions.startDatafeedDescription",{defaultMessage:"Start datafeed"}),icon:"play",enabled:item=>!0!==item.deleting&&canStartStopDatafeed,available:item=>isStartable([item]),onClick:item=>{showStartDatafeedModal([item]),closeMenu()},"data-test-subj":"mlActionButtonStartDatafeed"},{name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.managementActions.stopDatafeedLabel",{defaultMessage:"Stop datafeed"}),description:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.managementActions.stopDatafeedDescription",{defaultMessage:"Stop datafeed"}),icon:"stop",enabled:item=>!0!==item.deleting&&canStartStopDatafeed,available:item=>isStoppable([item]),onClick:item=>{stopDatafeeds([item],refreshJobs),closeMenu(!0)},"data-test-subj":"mlActionButtonStopDatafeed"},{name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.managementActions.createAlertLabel",{defaultMessage:"Create alert rule"}),description:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.managementActions.createAlertLabel",{defaultMessage:"Create alert rule"}),icon:"bell",enabled:item=>!0!==item.deleting,available:()=>canCreateMlAlerts,onClick:item=>{showCreateAlertFlyout([item.id]),closeMenu(!0)},"data-test-subj":"mlActionButtonCreateAlert"},{name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.managementActions.closeJobLabel",{defaultMessage:"Close job"}),description:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.managementActions.closeJobDescription",{defaultMessage:"Close job"}),icon:"cross",enabled:item=>!0!==item.deleting&&canCloseJob,available:item=>isClosable([item]),onClick:item=>{closeJobs([item],refreshJobs),closeMenu(!0)},"data-test-subj":"mlActionButtonCloseJob"},{name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.managementActions.cloneJobLabel",{defaultMessage:"Clone job"}),description:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.managementActions.cloneJobDescription",{defaultMessage:"Clone job"}),icon:"copy",enabled:item=>!0!==item.deleting&&canCreateJob,onClick:item=>{const indexPatternNames=Object(index_utils.d)(),indexPatternTitle=item.datafeedIndices.join(",");indexPatternNames.includes(indexPatternTitle)?async function(jobId){try{var _originalJob$custom_s;const[{job:cloneableJob,datafeed:datafeed},originalJob]=await Promise.all([loadJobForCloning(jobId),loadFullJob(jobId)]);var _originalJob$custom_s2;if(void 0!==cloneableJob&&void 0!==(null==originalJob||null===(_originalJob$custom_s=originalJob.custom_settings)||void 0===_originalJob$custom_s?void 0:_originalJob$custom_s.created_by)){if(job_service.a.tempJobCloningObjects.createdBy=null==originalJob||null===(_originalJob$custom_s2=originalJob.custom_settings)||void 0===_originalJob$custom_s2?void 0:_originalJob$custom_s2.created_by,job_service.a.tempJobCloningObjects.job=cloneableJob,void 0!==originalJob.data_counts.earliest_record_timestamp&&void 0!==originalJob.data_counts.latest_record_timestamp&&void 0!==originalJob.data_counts.latest_bucket_timestamp){let start=originalJob.data_counts.earliest_record_timestamp,end=originalJob.data_counts.latest_record_timestamp;if(void 0!==originalJob.datafeed_config.aggregations){const bucketSpanMs=Object(parse_interval.a)(originalJob.analysis_config.bucket_span).asMilliseconds();start=Math.floor(originalJob.data_counts.earliest_record_timestamp/bucketSpanMs)*bucketSpanMs,end=originalJob.data_counts.latest_bucket_timestamp+2*bucketSpanMs-1}job_service.a.tempJobCloningObjects.start=start,job_service.a.tempJobCloningObjects.end=end}}else job_service.a.tempJobCloningObjects.job=cloneableJob,job_service.a.tempJobCloningObjects.createdBy=void 0;void 0!==datafeed&&(job_service.a.tempJobCloningObjects.datafeed=datafeed),originalJob.calendars&&(job_service.a.tempJobCloningObjects.calendars=await calendar_service.a.fetchCalendarsByIds(originalJob.calendars)),window.location.href="#/jobs/new_job"}catch(error){Object(toast_notification_service.a)().displayErrorToast(error,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.cloneJobErrorMessage",{defaultMessage:"Could not clone {jobId}. Job could not be found",values:{jobId:jobId}}))}}(item.id):Object(dependency_cache.j)().addDanger(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.managementActions.noSourceIndexPatternForClone",{defaultMessage:"Unable to clone the anomaly detection job {jobId}. No index pattern exists for index {indexPatternTitle}.",values:{jobId:item.id,indexPatternTitle:indexPatternTitle}})),closeMenu(!0)},"data-test-subj":"mlActionButtonCloneJob"},{name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.managementActions.editJobLabel",{defaultMessage:"Edit job"}),description:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.managementActions.editJobDescription",{defaultMessage:"Edit job"}),icon:"pencil",enabled:item=>!0!==item.deleting&&canUpdateJob&&canUpdateDatafeed,onClick:item=>{showEditJobFlyout(item),closeMenu()},"data-test-subj":"mlActionButtonEditJob"},{name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.managementActions.deleteJobLabel",{defaultMessage:"Delete job"}),description:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.managementActions.deleteJobDescription",{defaultMessage:"Delete job"}),icon:"trash",color:"danger",enabled:()=>canDeleteJob,onClick:item=>{showDeleteJobModal([item]),closeMenu()},"data-test-subj":"mlActionButtonDeleteJob"}]}function closeMenu(now=!1){now?document.querySelector(".euiTable").click():window.setTimeout(()=>{const modalBody=document.querySelector(".euiModalBody");modalBody?modalBody.click():document.querySelector(".euiTable").click()},500)}var use_create_ad_links=__webpack_require__(242);function ResultLinks({jobs:jobs}){const openJobsInSingleMetricViewerText=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.resultActions.openJobsInSingleMetricViewerText",{defaultMessage:"Open {jobsCount, plural, one {{jobId}} other {# jobs}} in Single Metric Viewer",values:{jobsCount:jobs.length,jobId:jobs[0].id}}),openJobsInAnomalyExplorerText=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.resultActions.openJobsInAnomalyExplorerText",{defaultMessage:"Open {jobsCount, plural, one {{jobId}} other {# jobs}} in Anomaly Explorer",values:{jobsCount:jobs.length,jobId:jobs[0].id}}),singleMetricVisible=jobs.length<2,singleMetricEnabled=1===jobs.length&&jobs[0].isSingleMetricViewerJob,singleMetricDisabledMessage=1===jobs.length&&jobs[0].isNotSingleMetricViewerJobMessage,singleMetricDisabledMessageText=void 0!==singleMetricDisabledMessage?external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.resultActions.singleMetricDisabledMessageText",{defaultMessage:"Disabled because {reason}.",values:{reason:singleMetricDisabledMessage}}):void 0,jobActionsDisabled=1===jobs.length&&!0===jobs[0].deleting,{createLinkWithUserDefaults:createLinkWithUserDefaults}=Object(use_create_ad_links.a)(),timeSeriesExplorerLink=Object(external_kbnSharedDeps_React_.useMemo)(()=>createLinkWithUserDefaults("timeseriesexplorer",jobs),[jobs]),anomalyExplorerLink=Object(external_kbnSharedDeps_React_.useMemo)(()=>createLinkWithUserDefaults("explorer",jobs),[jobs]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"xs",justifyContent:"flexEnd",alignItems:"center",wrap:!1,direction:"row",responsive:!1},singleMetricVisible&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{position:"bottom",content:null!=singleMetricDisabledMessageText?singleMetricDisabledMessageText:openJobsInSingleMetricViewerText},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{href:timeSeriesExplorerLink,iconType:"visLine","aria-label":openJobsInSingleMetricViewerText,className:"results-button",isDisabled:!1===singleMetricEnabled||!0===jobActionsDisabled,"data-test-subj":"mlOpenJobsInSingleMetricViewerButton"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{position:"bottom",content:openJobsInAnomalyExplorerText},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{href:anomalyExplorerLink,iconType:"visTable","aria-label":openJobsInAnomalyExplorerText,className:"results-button",isDisabled:!0===jobActionsDisabled,"data-test-subj":"mlOpenJobsInAnomalyExplorerButton"}))))}var group_color_utils=__webpack_require__(149);const JobGroup=({name:name})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBadge,{key:name+"-id","data-test-subj":"mlJobGroup",color:Object(group_color_utils.a)(name)},name);var kibana=__webpack_require__(63),ml_url_generator=__webpack_require__(0);function isGroupIdLink(props){return void 0!==props.groupId}const AnomalyDetectionJobIdLink=props=>{const mlUrlGenerator=Object(kibana.d)(),[href,setHref]=Object(external_kbnSharedDeps_React_.useState)("");return Object(external_kbnSharedDeps_React_.useEffect)(()=>{let isCancelled=!1;return(async()=>{const pageState={};isGroupIdLink(props)?pageState.groupIds=[props.groupId]:pageState.jobId=props.id;const url=await mlUrlGenerator.createUrl({page:ml_url_generator.b.ANOMALY_DETECTION_JOBS_MANAGE,pageState:pageState});isCancelled||setHref(url)})(),()=>{isCancelled=!0}},[props,mlUrlGenerator]),isGroupIdLink(props)?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{style:{marginLeft:"4px"},key:props.groupId,href:href},external_kbnSharedDeps_React_default.a.createElement(JobGroup,{name:props.groupId})):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{key:props.id,href:href},props.id)};function JobDescription({job:job,isManagementTable:isManagementTable}){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement("div",{className:"job-description"},job.description,"  ",job.groups.map(group=>!0===isManagementTable?external_kbnSharedDeps_React_default.a.createElement(AnomalyDetectionJobIdLink,{key:group,groupId:group}):external_kbnSharedDeps_React_default.a.createElement(JobGroup,{key:group,name:group}))))}var job_message_icon=__webpack_require__(420),job_spaces_list=__webpack_require__(418),time_format=__webpack_require__(130);function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}const PAGE_SIZE_OPTIONS=[10,25,50];class jobs_list_JobsList extends external_kbnSharedDeps_React_.Component{constructor(props){super(props),_defineProperty(this,"onTableChange",({page:page={},sort:sort={}})=>{const{index:pageIndex,size:pageSize}=page,{field:sortField,direction:sortDirection}=sort;this.props.onJobsViewStateUpdate({pageIndex:pageIndex,pageSize:pageSize,sortField:sortField,sortDirection:sortDirection})}),_defineProperty(this,"toggleRow",item=>{this.props.toggleRow(item.id)}),this.state={jobsSummaryList:props.jobsSummaryList,itemIdToExpandedRowMap:{}}}static getDerivedStateFromProps(props){return{itemIdToExpandedRowMap:props.itemIdToExpandedRowMap,jobsSummaryList:props.jobsSummaryList}}getJobIdLink(id){return!1===this.props.isMlEnabledInSpace?id:external_kbnSharedDeps_React_default.a.createElement(AnomalyDetectionJobIdLink,{key:id,id:id})}getPageOfJobs(index,size,sortField,sortDirection){let list=this.state.jobsSummaryList;list=Object(external_kbnSharedDeps_Lodash_.sortBy)(this.state.jobsSummaryList,item=>item[sortField]),list="asc"===sortDirection?list:list.reverse();const listLength=list.length;let pageStart=index*size;return pageStart>=listLength&&0!==listLength&&(pageStart=Math.floor((listLength-1)/size)*size,setTimeout(()=>{this.props.onJobsViewStateUpdate({pageIndex:pageStart/size})},0)),{pageOfItems:list.slice(pageStart,pageStart+size),totalItemCount:listLength}}render(){const{loading:loading,isManagementTable:isManagementTable,spacesApi:spacesApi}=this.props,selectionControls={selectable:job=>!0!==job.deleting,selectableMessage:(selectable,rowItem)=>!1===selectable?external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.cannotSelectRowForJobMessage",{defaultMessage:"Cannot select job ID {jobId}",values:{jobId:rowItem.id}}):external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.selectRowForJobMessage",{defaultMessage:"Select the row for job ID {jobId}",values:{jobId:rowItem.id}}),onSelectionChange:this.props.selectJobChange},columns=[{name:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiScreenReaderOnly,null,external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.showDetailsColumn.screenReaderDescription",defaultMessage:"This column contains clickable controls for showing more details on each job"}))),render:item=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{onClick:()=>this.toggleRow(item),isDisabled:!0===item.deleting,iconType:this.state.itemIdToExpandedRowMap[item.id]?"arrowDown":"arrowRight","aria-label":this.state.itemIdToExpandedRowMap[item.id]?external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.collapseJobDetailsAriaLabel",{defaultMessage:"Hide details for {itemId}",values:{itemId:item.id}}):external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.expandJobDetailsAriaLabel",{defaultMessage:"Show details for {itemId}",values:{itemId:item.id}}),"data-row-id":item.id,"data-test-subj":"mlJobListRowDetailsToggle"}),width:"3%"},{field:"id","data-test-subj":"mlJobListColumnId",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.idLabel",{defaultMessage:"ID"}),sortable:!0,truncateText:!1,width:"15%",scope:"row",render:isManagementTable?id=>this.getJobIdLink(id):void 0},{field:"auditMessage",name:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiScreenReaderOnly,null,external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.auditMessageColumn.screenReaderDescription",defaultMessage:"This column displays icons when there are errors or warnings for the job in the past 24 hours"}))),render:item=>external_kbnSharedDeps_React_default.a.createElement(job_message_icon.a,{message:item,showTooltip:!0})},{field:"alertingRules",name:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiScreenReaderOnly,null,external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.alertingRules.screenReaderDescription",defaultMessage:"This column displays icons when there are alert rules associated with a job"}))),width:"30px",render:item=>Array.isArray(item)?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{position:"bottom",content:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.alertingRules.tooltipContent",defaultMessage:"Job has {rulesCount} associated alert {rulesCount, plural, one { rule} other { rules}}",values:{rulesCount:item.length}})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{type:"bell"})):external_kbnSharedDeps_React_default.a.createElement("span",null)},{name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.descriptionLabel",{defaultMessage:"Description"}),sortable:!0,field:"description","data-test-subj":"mlJobListColumnDescription",render:(description,item)=>external_kbnSharedDeps_React_default.a.createElement(JobDescription,{job:item,isManagementTable:isManagementTable}),textOnly:!0,width:"20%"},{field:"processed_record_count","data-test-subj":"mlJobListColumnRecordCount",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.processedRecordsLabel",{defaultMessage:"Processed records"}),sortable:!0,truncateText:!1,dataType:"number",render:count=>Object(string_utils.g)(count),width:"10%"},{field:"memory_status","data-test-subj":"mlJobListColumnMemoryStatus",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.memoryStatusLabel",{defaultMessage:"Memory status"}),sortable:!0,truncateText:!1,width:"5%"},{field:"jobState","data-test-subj":"mlJobListColumnJobState",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.jobStateLabel",{defaultMessage:"Job state"}),sortable:!0,truncateText:!1,width:"8%"},{field:"datafeedState","data-test-subj":"mlJobListColumnDatafeedState",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.datafeedStateLabel",{defaultMessage:"Datafeed state"}),sortable:!0,truncateText:!1,width:"8%"},{name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.actionsLabel",{defaultMessage:"Actions"}),render:item=>external_kbnSharedDeps_React_default.a.createElement(ResultLinks,{jobs:[item]}),width:"8%"}];!0===isManagementTable?(spacesApi&&columns.splice(columns.length-1,0,{name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.spacesLabel",{defaultMessage:"Spaces"}),render:item=>external_kbnSharedDeps_React_default.a.createElement(job_spaces_list.a,{spacesApi:spacesApi,spaceIds:item.spaceIds,jobId:item.id,jobType:"anomaly-detector",refresh:this.props.refreshJobs})}),!1===this.props.isMlEnabledInSpace&&columns.pop()):(columns.splice(columns.length-1,0,{name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.latestTimestampLabel",{defaultMessage:"Latest timestamp"}),truncateText:!1,field:"latestTimestampSortValue","data-test-subj":"mlJobListColumnLatestTimestamp",sortable:!0,render:(time,item)=>external_kbnSharedDeps_React_default.a.createElement("span",{className:"euiTableCellContent__text"},void 0===item.latestTimestampMs?"":external_kbnSharedDeps_Moment_default()(item.latestTimestampMs).format(time_format.a)),textOnly:!0,width:"15%"}),columns.push({name:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiScreenReaderOnly,null,external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.jobActionsColumn.screenReaderDescription",defaultMessage:"This column contains extra actions in a menu that can be performed on each job"}))),actions:actionsMenuContent(this.props.showEditJobFlyout,this.props.showDeleteJobModal,this.props.showStartDatafeedModal,this.props.refreshJobs,this.props.showCreateAlertFlyout),width:"40px"}));const{pageIndex:pageIndex,pageSize:pageSize,sortField:sortField,sortDirection:sortDirection}=this.props.jobsViewState,{pageOfItems:pageOfItems,totalItemCount:totalItemCount}=this.getPageOfJobs(pageIndex,pageSize,sortField,sortDirection),pagination={pageIndex:pageIndex,pageSize:pageSize,totalItemCount:totalItemCount,pageSizeOptions:PAGE_SIZE_OPTIONS},sorting={sort:{field:sortField,direction:sortDirection}},selectedJobsClass=this.props.selectedJobsCount?"jobs-selected":"";return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBasicTable,{"data-test-subj":loading?"mlJobListTable loading":"mlJobListTable loaded",loading:!0===loading,noItemsMessage:loading?external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.loadingJobsLabel",{defaultMessage:"Loading jobs…"}):external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.noJobsFoundLabel",{defaultMessage:"No jobs found"}),itemId:"id",className:"jobs-list-table "+selectedJobsClass,items:pageOfItems,columns:columns,pagination:pagination,onChange:this.onTableChange,selection:isManagementTable?void 0:selectionControls,itemIdToExpandedRowMap:this.state.itemIdToExpandedRowMap,isExpandable:!0,sorting:sorting,hasActions:!0,rowProps:item=>({"data-test-subj":"mlJobListRow row-"+item.id})})}}jobs_list_JobsList.defaultProps={isManagementTable:!1,isMlEnabledInSpace:!0,loading:!1};var external_kbnSharedDeps_ElasticNumeral_=__webpack_require__(49),external_kbnSharedDeps_ElasticNumeral_default=__webpack_require__.n(external_kbnSharedDeps_ElasticNumeral_),round_to_decimal_place=__webpack_require__(166),date_utils=__webpack_require__(72);function formatValues(obj){if(!obj)return["",""];const[key,value]=obj;switch(key){case"finished_time":case"create_time":case"log_time":case"timestamp":case"earliest_record_timestamp":case"latest_record_timestamp":case"last_data_time":case"latest_empty_bucket_timestamp":case"latest_sparse_bucket_timestamp":case"latest_bucket_timestamp":return[key,Object(date_utils.d)(value)];case"established_model_memory":case"input_bytes":case"model_bytes":case"model_bytes_exceeded":case"model_bytes_memory_limit":case"peak_model_bytes":return[key,(txt=value,external_kbnSharedDeps_ElasticNumeral_default()(txt).format("0.0 b"))];case"processed_record_count":case"processed_field_count":case"input_field_count":case"invalid_date_count":case"missing_field_count":case"out_of_order_timestamp_count":case"empty_bucket_count":case"sparse_bucket_count":case"bucket_count":case"input_record_count":case"total_by_field_count":case"total_over_field_count":case"total_partition_field_count":case"bucket_allocation_failures_count":case"search_count":return[key,Object(string_utils.g)(value)];case"average_search_time_per_bucket_ms":case"exponential_average_search_time_per_hour_ms":case"total_bucket_processing_time_ms":case"minimum_bucket_processing_time_ms":case"maximum_bucket_processing_time_ms":case"average_bucket_processing_time_ms":case"exponential_average_bucket_processing_time_ms":case"exponential_average_bucket_processing_time_per_hour_ms":return[key,"number"==typeof value?Object(round_to_decimal_place.a)(value,3).toLocaleString():value];default:return[key,value]}var txt}function filterObjects(obj,allowArrays,allowObjects){return Object.keys(obj).filter(k=>allowObjects||"object"!=typeof obj[k]||allowArrays&&Array.isArray(obj[k])).map(k=>{let item=obj[k];return Array.isArray(item)?item=item.join(", "):"object"==typeof obj[k]&&(item=JSON.stringify(item)),[k,item]})}var ml_alerting_flyout=__webpack_require__(244);var ml_job_editor=__webpack_require__(129);function JsonPane({job:job}){const json=JSON.stringify(job,null,2);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(ml_job_editor.a,{value:json,readOnly:!0,mode:ml_job_editor.b.XJSON}))}var job_utils=__webpack_require__(69);class datafeed_preview_tab_DatafeedPreviewPane extends external_kbnSharedDeps_React_.Component{constructor(props){super(props),this.state={previewJson:"",loading:!0,canPreviewDatafeed:!0}}renderContent(){const{previewJson:previewJson,loading:loading,canPreviewDatafeed:canPreviewDatafeed}=this.state;return!1===canPreviewDatafeed?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.jobDetails.noPermissionToViewDatafeedPreviewTitle",defaultMessage:"You do not have permission to view the datafeed preview"}),color:"warning",iconType:"alert"},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.jobDetails.pleaseContactYourAdministratorLabel",defaultMessage:"Please contact your administrator"}))):!0===loading?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingSpinner,{size:"xl"}):external_kbnSharedDeps_React_default.a.createElement(ml_job_editor.a,{value:previewJson,readOnly:!0})}componentDidMount(){const canPreviewDatafeed=Object(check_capabilities.e)("canPreviewDatafeed")&&void 0!==this.props.job.datafeed_config;this.setState({canPreviewDatafeed:canPreviewDatafeed}),function(job,canPreviewDatafeed){return new Promise((resolve,reject)=>{canPreviewDatafeed&&job_service.a.getDatafeedPreview(job.datafeed_config.datafeed_id).then(resp=>{Array.isArray(resp)?resolve(JSON.stringify(resp.slice(0,job_utils.a),null,2)):(resolve(""),console.log("Datafeed preview could not be loaded",resp))}).catch(error=>{reject(error)})})}(this.props.job,canPreviewDatafeed).then(previewJson=>{this.setState({previewJson:previewJson,loading:!1})}).catch(error=>{console.log("Datafeed preview could not be loaded",error),this.setState({loading:!1})})}render(){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),this.renderContent())}}var annotations_table=__webpack_require__(294),annotation_flyout=__webpack_require__(287);const EditModelSnapshotFlyout=({snapshot:snapshot,job:job,closeFlyout:closeFlyout})=>{const{toasts:toasts}=Object(kibana.f)(),[description,setDescription]=Object(external_kbnSharedDeps_React_.useState)(snapshot.description),[retain,setRetain]=Object(external_kbnSharedDeps_React_.useState)(snapshot.retain),[deleteModalVisible,setDeleteModalVisible]=Object(external_kbnSharedDeps_React_.useState)(!1),[isCurrentSnapshot,setIsCurrentSnapshot]=Object(external_kbnSharedDeps_React_.useState)(snapshot.snapshot_id===job.model_snapshot_id);Object(external_kbnSharedDeps_React_.useEffect)(()=>{setIsCurrentSnapshot(snapshot.snapshot_id===job.model_snapshot_id)},[snapshot]);const updateSnapshot=Object(external_kbnSharedDeps_React_.useCallback)(async()=>{try{await ml_api_service.ml.updateModelSnapshot(snapshot.job_id,snapshot.snapshot_id,{description:description,retain:retain}),closeWithReload()}catch(error){toasts.addError(new Error(error.body.message),{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.editModelSnapshotFlyout.saveErrorTitle",{defaultMessage:"Model snapshot update failed"})})}},[retain,description,snapshot]),deleteSnapshot=Object(external_kbnSharedDeps_React_.useCallback)(async()=>{try{await ml_api_service.ml.deleteModelSnapshot(snapshot.job_id,snapshot.snapshot_id),hideDeleteModal(),closeWithReload()}catch(error){toasts.addError(new Error(error.body.message),{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.editModelSnapshotFlyout.deleteErrorTitle",{defaultMessage:"Model snapshot deletion failed"})})}},[snapshot]);function closeWithReload(){closeFlyout(!0)}function closeWithoutReload(){closeFlyout(!1)}function hideDeleteModal(){setDeleteModalVisible(!1)}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyout,{onClose:closeWithoutReload,hideCloseButton:!0,size:"m"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyoutBody,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"s"},external_kbnSharedDeps_React_default.a.createElement("h5",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.editModelSnapshotFlyout.title",defaultMessage:"Edit snapshot {ssId}",values:{ssId:snapshot.snapshot_id}}))),isCurrentSnapshot&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{size:"s",title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.editModelSnapshotFlyout.calloutTitle",{defaultMessage:"Current snapshot"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.editModelSnapshotFlyout.calloutText",defaultMessage:"This is the current snapshot being used by job {jobId} and so cannot be deleted.",values:{jobId:job.job_id}}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.editModelSnapshotFlyout.descriptionTitle",{defaultMessage:"Description"}),fullWidth:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTextArea,{fullWidth:!0,value:description,onChange:e=>setDescription(e.target.value)})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{fullWidth:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSwitch,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.editModelSnapshotFlyout.retainSwitchLabel",{defaultMessage:"Retain snapshot during automatic snapshot cleanup process"}),checked:retain,onChange:e=>setRetain(e.target.checked)})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyoutFooter,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{iconType:"cross",onClick:closeWithoutReload,flush:"left"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.editModelSnapshotFlyout.closeButton",defaultMessage:"Close"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!0}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{onClick:function(){setDeleteModalVisible(!0)},color:"danger",disabled:!0===isCurrentSnapshot},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.editModelSnapshotFlyout.useDefaultButton",defaultMessage:"Delete"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{onClick:updateSnapshot,fill:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.editModelSnapshotFlyout.saveButton",defaultMessage:"Save"})))))),deleteModalVisible&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiConfirmModal,{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.editModelSnapshotFlyout.deleteTitle",{defaultMessage:"Delete snapshot?"}),onCancel:hideDeleteModal,onConfirm:deleteSnapshot,cancelButtonText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.editModelSnapshotFlyout.cancelButton",{defaultMessage:"Cancel"}),confirmButtonText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.editModelSnapshotFlyout.deleteButton",{defaultMessage:"Delete"}),buttonColor:"danger",defaultFocusedButton:"confirm"}))};var anomaly_utils=__webpack_require__(6);var results_service=__webpack_require__(128),event_rate_chart=__webpack_require__(228),color_range_legend=__webpack_require__(145);const CreateCalendar=({calendarEvents:calendarEvents,setCalendarEvents:setCalendarEvents,minSelectableTimeStamp:minSelectableTimeStamp,maxSelectableTimeStamp:maxSelectableTimeStamp,eventRateData:eventRateData,anomalies:anomalies,chartReady:chartReady})=>{const maxSelectableTimeMoment=external_kbnSharedDeps_Moment_default()(maxSelectableTimeStamp),minSelectableTimeMoment=external_kbnSharedDeps_Moment_default()(minSelectableTimeStamp),{euiTheme:euiTheme}=Object(color_range_legend.e)(),onBrushEnd=Object(external_kbnSharedDeps_React_.useCallback)(({x:x})=>{if(x&&2===x.length){const end=x[1]<minSelectableTimeStamp?null:x[1];if(null!==end){const start=x[0]<minSelectableTimeStamp?minSelectableTimeStamp:x[0];setCalendarEvents([...calendarEvents,{start:external_kbnSharedDeps_Moment_default()(start),end:external_kbnSharedDeps_Moment_default()(end),description:createDefaultEventDescription(calendarEvents.length+1)}])}}},[calendarEvents]),setStartDate=Object(external_kbnSharedDeps_React_.useCallback)((start,index)=>{const event=calendarEvents[index];void 0===event?setCalendarEvents([...calendarEvents,{start:start,end:null,description:createDefaultEventDescription(index)}]):(event.start=start,setCalendarEvents([...calendarEvents]))},[calendarEvents]),setEndDate=Object(external_kbnSharedDeps_React_.useCallback)((end,index)=>{const event=calendarEvents[index];void 0===event?setCalendarEvents([...calendarEvents,{start:null,end:end,description:createDefaultEventDescription(index)}]):(event.end=end,setCalendarEvents([...calendarEvents]))},[calendarEvents]),setDescription=Object(external_kbnSharedDeps_React_.useCallback)((description,index)=>{const event=calendarEvents[index];void 0!==event&&(event.description=description,setCalendarEvents([...calendarEvents]))},[calendarEvents]),removeCalendarEvent=Object(external_kbnSharedDeps_React_.useCallback)(index=>{if(void 0!==calendarEvents[index]){const ce=[...calendarEvents];ce.splice(index,1),setCalendarEvents(ce)}},[calendarEvents]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"}),external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.revertModelSnapshotFlyout.createCalendar.title",defaultMessage:"Select time range for calendar event."})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(Chart,{eventRateData:eventRateData,anomalies:anomalies,loading:!1===chartReady,overlayRanges:calendarEvents.filter(filterIncompleteEvents).map(c=>({start:c.start.valueOf(),end:c.end.valueOf()})),onBrushEnd:onBrushEnd,overlayColor:euiTheme.euiColorPrimary}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),calendarEvents.map((c,i)=>{var _c$end,_c$start;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,{key:i},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPanel,{paddingSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.revertModelSnapshotFlyout.createCalendar.fromLabel",{defaultMessage:"From"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDatePicker,{showTimeSelect:!0,selected:c.start,minDate:minSelectableTimeMoment,maxDate:null!==(_c$end=c.end)&&void 0!==_c$end?_c$end:maxSelectableTimeMoment,onChange:d=>setStartDate(d,i)}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.revertModelSnapshotFlyout.createCalendar.toLabel",{defaultMessage:"To"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDatePicker,{showTimeSelect:!0,selected:c.end,minDate:null!==(_c$start=c.start)&&void 0!==_c$start?_c$start:minSelectableTimeMoment,maxDate:maxSelectableTimeMoment,onChange:d=>setEndDate(d,i)})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{fullWidth:!0,label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.revertModelSnapshotFlyout.createCalendar.descriptionLabel",{defaultMessage:"Description"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldText,{fullWidth:!0,value:c.description,onChange:e=>setDescription(e.target.value,i)}))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,style:{borderLeft:"1px solid "+euiTheme.euiColorLightShade,marginRight:"0px"}}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{style:{margin:"auto"},color:"danger",onClick:()=>removeCalendarEvent(i),iconType:"trash","aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.revertModelSnapshotFlyout.createCalendar.deleteLabel",{defaultMessage:"Delete event"})})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}))}))},Chart=Object(external_kbnSharedDeps_React_.memo)(({eventRateData:eventRateData,anomalies:anomalies,loading:loading,onBrushEnd:onBrushEnd,overlayRanges:overlayRanges,overlayColor:overlayColor})=>external_kbnSharedDeps_React_default.a.createElement(event_rate_chart.a,{eventRateChartData:eventRateData,anomalyData:anomalies,loading:loading,height:"100px",width:"100%",fadeChart:!0,overlayRanges:overlayRanges.map(c=>({start:c.start,end:c.end,color:overlayColor,showMarker:!1})),onBrushEnd:onBrushEnd}),(prev,next)=>prev.overlayRanges.length===next.overlayRanges.length&&JSON.stringify(prev.overlayRanges)===JSON.stringify(next.overlayRanges));function filterIncompleteEvents(event){return null!==event.start&&null!==event.end}function createDefaultEventDescription(index){return external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.revertModelSnapshotFlyout.createCalendar.defaultEventDescription",{defaultMessage:"Auto created event {index}",values:{index:index}})}const RevertModelSnapshotFlyout=({snapshot:snapshot,snapshots:snapshots,job:job,closeFlyout:closeFlyout,refresh:refresh})=>{const{toasts:toasts}=Object(kibana.f)(),{loadAnomalyDataForJob:loadAnomalyDataForJob,loadEventRateForJob:loadEventRateForJob}=Object(external_kbnSharedDeps_React_.useMemo)(()=>{return mlResultsService=results_service.mlResultsService,{loadEventRateForJob:async function(job,bucketSpanMs,bars){const intervalMs=Math.max(Math.floor((job.data_counts.latest_record_timestamp-job.data_counts.earliest_record_timestamp)/bars),bucketSpanMs),resp=await mlResultsService.getEventRateData(job.datafeed_config.indices.join(),job.datafeed_config.query,job.data_description.time_field,job.data_counts.earliest_record_timestamp,job.data_counts.latest_record_timestamp,intervalMs,job.datafeed_config.runtime_mappings,job.datafeed_config.indices_options);if(void 0!==resp.error)throw resp.error;const events=Object.entries(resp.results).map(([time,value])=>({time:+time,value:value}));return events.length&&events.push({time:events[events.length-1].time+intervalMs,value:0}),events},loadAnomalyDataForJob:async function(job,bucketSpanMs,bars){const intervalMs=Math.max(Math.floor((job.data_counts.latest_record_timestamp-job.data_counts.earliest_record_timestamp)/bars),bucketSpanMs),results=(await mlResultsService.getScoresByBucket([job.job_id],job.data_counts.earliest_record_timestamp,job.data_counts.latest_record_timestamp,intervalMs,1)).results[job.job_id];if(void 0===results)return[];const anomalies={};return anomalies[0]=Object.entries(results).map(([time,value])=>({time:+time,value:value,severity:Object(anomaly_utils.k)(value)})),anomalies}};var mlResultsService},[]),[currentSnapshot,setCurrentSnapshot]=Object(external_kbnSharedDeps_React_.useState)(snapshot),[revertModalVisible,setRevertModalVisible]=Object(external_kbnSharedDeps_React_.useState)(!1),[replay,setReplay]=Object(external_kbnSharedDeps_React_.useState)(!1),[runInRealTime,setRunInRealTime]=Object(external_kbnSharedDeps_React_.useState)(!1),[createCalendar,setCreateCalendar]=Object(external_kbnSharedDeps_React_.useState)(!1),[calendarEvents,setCalendarEvents]=Object(external_kbnSharedDeps_React_.useState)([]),[calendarEventsValid,setCalendarEventsValid]=Object(external_kbnSharedDeps_React_.useState)(!0),[eventRateData,setEventRateData]=Object(external_kbnSharedDeps_React_.useState)([]),[anomalies,setAnomalies]=Object(external_kbnSharedDeps_React_.useState)([]),[chartReady,setChartReady]=Object(external_kbnSharedDeps_React_.useState)(!1);Object(external_kbnSharedDeps_React_.useEffect)(()=>{createChartData()},[currentSnapshot]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{const invalid=calendarEvents.some(c=>""===c.description||null===c.end||null===c.start);setCalendarEventsValid(!1===invalid);const dedupedCalendarEvents=[...new Map(calendarEvents.map(c=>{var _c$start,_c$end;return[`${null===(_c$start=c.start)||void 0===_c$start?void 0:_c$start.valueOf()}${null===(_c$end=c.end)||void 0===_c$end?void 0:_c$end.valueOf()}`,c]})).values()];dedupedCalendarEvents.length<calendarEvents.length&&setCalendarEvents(dedupedCalendarEvents)},[calendarEvents]);const createChartData=Object(external_kbnSharedDeps_React_.useCallback)(async()=>{const bucketSpanMs=Object(parse_interval.a)(job.analysis_config.bucket_span).asMilliseconds(),eventRate=await loadEventRateForJob(job,bucketSpanMs,100),anomalyData=await loadAnomalyDataForJob(job,bucketSpanMs,100);setEventRateData(eventRate),void 0!==anomalyData[0]&&setAnomalies(anomalyData[0]),setChartReady(!0)},[job]);function hideRevertModal(){setRevertModalVisible(!1)}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyout,{onClose:closeFlyout,hideCloseButton:!0,size:"m"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyoutHeader,{hasBorder:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"s"},external_kbnSharedDeps_React_default.a.createElement("h5",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.revertModelSnapshotFlyout.title",defaultMessage:"Revert to model snapshot {ssId}",values:{ssId:currentSnapshot.snapshot_id}}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"s"},external_kbnSharedDeps_React_default.a.createElement("p",null,currentSnapshot.description))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyoutBody,null,!1,external_kbnSharedDeps_React_default.a.createElement(event_rate_chart.a,{eventRateChartData:eventRateData,anomalyData:anomalies,loading:!1===chartReady,height:"100px",width:"100%",fadeChart:!0,overlayRanges:[{start:currentSnapshot.latest_record_time_stamp,end:job.data_counts.latest_record_timestamp,color:"#ff0000"}]}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.revertModelSnapshotFlyout.warningCallout.title",{defaultMessage:"Anomaly data will be deleted"}),color:"warning",iconType:"alert"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.revertModelSnapshotFlyout.warningCallout.contents",defaultMessage:"All anomaly detection results after {date} will be deleted.",values:{date:Object(date_utils.d)(currentSnapshot.latest_record_time_stamp)}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHorizontalRule,{margin:"xl"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{fullWidth:!0,helpText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.revertModelSnapshotFlyout.replaySwitchHelp",{defaultMessage:"Reopen job and replay analysis after the revert has been applied."})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSwitch,{id:"replaySwitch",label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.revertModelSnapshotFlyout.replaySwitchLabel",{defaultMessage:"Replay analysis"}),checked:replay,onChange:e=>setReplay(e.target.checked)})),replay&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{fullWidth:!0,helpText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.revertModelSnapshotFlyout.realTimeSwitchHelp",{defaultMessage:"Job will continue to run until manually stopped. All new data added to the index will be analyzed."})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSwitch,{id:"realTimeSwitch",label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.revertModelSnapshotFlyout.realTimeSwitchLabel",{defaultMessage:"Run job in real time"}),checked:runInRealTime,onChange:e=>setRunInRealTime(e.target.checked)})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{fullWidth:!0,helpText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.revertModelSnapshotFlyout.createCalendarSwitchHelp",{defaultMessage:"Create a new calendar and event to skip over a period of time when analyzing the data."})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSwitch,{id:"createCalendarSwitch",label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.revertModelSnapshotFlyout.createCalendarSwitchLabel",{defaultMessage:"Create calendar to skip a range of time"}),checked:createCalendar,onChange:e=>setCreateCalendar(e.target.checked)})),createCalendar&&external_kbnSharedDeps_React_default.a.createElement(CreateCalendar,{calendarEvents:calendarEvents,setCalendarEvents:setCalendarEvents,minSelectableTimeStamp:snapshot.latest_record_time_stamp,maxSelectableTimeStamp:job.data_counts.latest_record_timestamp,eventRateData:eventRateData,anomalies:anomalies,chartReady:chartReady}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyoutFooter,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{iconType:"cross",onClick:closeFlyout,flush:"left"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.revertModelSnapshotFlyout.closeButton",defaultMessage:"Close"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!0}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{onClick:function(){setRevertModalVisible(!0)},disabled:!0===createCalendar&&!1===calendarEventsValid,fill:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.revertModelSnapshotFlyout.saveButton",defaultMessage:"Apply"})))))),revertModalVisible&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiConfirmModal,{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.revertModelSnapshotFlyout.deleteTitle",{defaultMessage:"Apply snapshot revert"}),onCancel:hideRevertModal,onConfirm:async function(){const end=replay&&!1===runInRealTime?job.data_counts.latest_record_timestamp:void 0;try{const events=replay&&createCalendar?calendarEvents.filter(revert_model_snapshot_flyout_filterIncompleteEvents).map(c=>({start:c.start.valueOf(),end:c.end.valueOf(),description:c.description})):void 0;ml_api_service.ml.jobs.revertModelSnapshot(job.job_id,currentSnapshot.snapshot_id,replay,end,events).then(()=>{toasts.addSuccess(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.revertModelSnapshotFlyout.revertSuccessTitle",{defaultMessage:"Model snapshot revert successful"})),refresh()}),hideRevertModal(),closeFlyout()}catch(error){toasts.addError(new Error(error.body.message),{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.revertModelSnapshotFlyout.revertErrorTitle",{defaultMessage:"Model snapshot revert failed"})})}},cancelButtonText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.revertModelSnapshotFlyout.cancelButton",{defaultMessage:"Cancel"}),confirmButtonText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.newJob.wizard.revertModelSnapshotFlyout.deleteButton",{defaultMessage:"Apply"}),buttonColor:"danger",defaultFocusedButton:"confirm"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.newJob.wizard.revertModelSnapshotFlyout.modalBody",defaultMessage:"The snapshot revert will be carried out in the background and may take some time."})))};function revert_model_snapshot_flyout_filterIncompleteEvents(event){return null!==event.start&&null!==event.end}const CloseJobConfirm=({combinedJobState:combinedJobState,hideCloseJobModalVisible:hideCloseJobModalVisible,forceCloseJob:forceCloseJob})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiConfirmModal,{title:combinedJobState===COMBINED_JOB_STATE.OPEN_AND_RUNNING?external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.modelSnapshotTable.closeJobConfirm.stopAndClose.title",{defaultMessage:"Stop datafeed and close job?"}):external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.modelSnapshotTable.closeJobConfirm.close.title",{defaultMessage:"Close job?"}),onCancel:hideCloseJobModalVisible,onConfirm:forceCloseJob,cancelButtonText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.modelSnapshotTable.closeJobConfirm.cancelButton",{defaultMessage:"Cancel"}),confirmButtonText:combinedJobState===COMBINED_JOB_STATE.OPEN_AND_RUNNING?external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.modelSnapshotTable.closeJobConfirm.stopAndClose.button",{defaultMessage:"Force stop and close"}):external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.modelSnapshotTable.closeJobConfirm.close.button",{defaultMessage:"Force close"}),defaultFocusedButton:"confirm"},external_kbnSharedDeps_React_default.a.createElement("p",null,combinedJobState===COMBINED_JOB_STATE.OPEN_AND_RUNNING&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.modelSnapshotTable.closeJobConfirm.contentOpenAndRunning",defaultMessage:"Job is currently open and running."}),combinedJobState===COMBINED_JOB_STATE.OPEN_AND_STOPPED&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.modelSnapshotTable.closeJobConfirm.contentOpen",defaultMessage:"Job is currently open."}),external_kbnSharedDeps_React_default.a.createElement("br",null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.modelSnapshotTable.closeJobConfirm.content",defaultMessage:"Snapshot revert can only happen on jobs which are closed."})));let COMBINED_JOB_STATE;!function(COMBINED_JOB_STATE){COMBINED_JOB_STATE[COMBINED_JOB_STATE.OPEN_AND_RUNNING=0]="OPEN_AND_RUNNING",COMBINED_JOB_STATE[COMBINED_JOB_STATE.OPEN_AND_STOPPED=1]="OPEN_AND_STOPPED",COMBINED_JOB_STATE[COMBINED_JOB_STATE.CLOSED=2]="CLOSED",COMBINED_JOB_STATE[COMBINED_JOB_STATE.UNKNOWN=3]="UNKNOWN"}(COMBINED_JOB_STATE||(COMBINED_JOB_STATE={}));const ModelSnapshotTable=({job:job,refreshJobList:refreshJobList})=>{const canCreateJob=Object(check_capabilities.e)("canCreateJob"),canStartStopDatafeed=Object(check_capabilities.e)("canStartStopDatafeed"),[snapshots,setSnapshots]=Object(external_kbnSharedDeps_React_.useState)([]),[snapshotsLoaded,setSnapshotsLoaded]=Object(external_kbnSharedDeps_React_.useState)(!1),[editSnapshot,setEditSnapshot]=Object(external_kbnSharedDeps_React_.useState)(null),[revertSnapshot,setRevertSnapshot]=Object(external_kbnSharedDeps_React_.useState)(null),[closeJobModalVisible,setCloseJobModalVisible]=Object(external_kbnSharedDeps_React_.useState)(null),[combinedJobState,setCombinedJobState]=Object(external_kbnSharedDeps_React_.useState)(null),isMounted=Object(external_kbnSharedDeps_React_.useRef)(!0);async function loadModelSnapshots(){if(!1===isMounted.current)return;const{model_snapshots:ms}=await ml_api_service.ml.getModelSnapshots(job.job_id);setSnapshots(ms),setSnapshotsLoaded(!0)}Object(external_kbnSharedDeps_React_.useEffect)(()=>(loadModelSnapshots(),()=>{isMounted.current=!1}),[]);const checkJobIsClosed=Object(external_kbnSharedDeps_React_.useCallback)(async snapshot=>{const state=await getCombinedJobState(job.job_id);state!==COMBINED_JOB_STATE.UNKNOWN?(setCombinedJobState(state),state===COMBINED_JOB_STATE.CLOSED?setRevertSnapshot(snapshot):setCloseJobModalVisible(snapshot)):console.error("Error retrieving state for job "+job.job_id)},[job]);function hideCloseJobModalVisible(){setCombinedJobState(null),setCloseJobModalVisible(null)}const forceCloseJob=Object(external_kbnSharedDeps_React_.useCallback)(async()=>{if(await ml_api_service.ml.jobs.forceStopAndCloseJob(job.job_id),null!==closeJobModalVisible){await getCombinedJobState(job.job_id)===COMBINED_JOB_STATE.CLOSED&&setRevertSnapshot(closeJobModalVisible)}hideCloseJobModalVisible()},[job,closeJobModalVisible]),closeEditFlyout=Object(external_kbnSharedDeps_React_.useCallback)(reload=>{setEditSnapshot(null),reload&&loadModelSnapshots()},[]),closeRevertFlyout=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setRevertSnapshot(null)},[]),refresh=Object(external_kbnSharedDeps_React_.useCallback)(()=>{loadModelSnapshots(),setTimeout(refreshJobList,500)},[]),columns=[{field:"snapshot_id",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.modelSnapshotTable.id",{defaultMessage:"ID"}),sortable:!0},{field:"description",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.modelSnapshotTable.description",{defaultMessage:"Description"}),sortable:!0},{field:"timestamp",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.modelSnapshotTable.time",{defaultMessage:"Date created"}),dataType:"date",render:date_utils.d,sortable:!0},{field:"latest_record_time_stamp",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.modelSnapshotTable.latestTimestamp",{defaultMessage:"Latest timestamp"}),dataType:"date",render:date_utils.d,sortable:!0},{field:"retain",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.modelSnapshotTable.retain",{defaultMessage:"Retain"}),width:"100px",sortable:!0},{field:"",width:"100px",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.modelSnapshotTable.actions",{defaultMessage:"Actions"}),actions:[{name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.modelSnapshotTable.actions.revert.name",{defaultMessage:"Revert"}),description:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.modelSnapshotTable.actions.revert.description",{defaultMessage:"Revert to this snapshot"}),enabled:()=>canCreateJob&&canStartStopDatafeed,type:"icon",icon:"crosshairs",onClick:checkJobIsClosed},{name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.modelSnapshotTable.actions.edit.name",{defaultMessage:"Edit"}),description:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.modelSnapshotTable.actions.edit.description",{defaultMessage:"Edit this snapshot"}),enabled:()=>canCreateJob,type:"icon",icon:"pencil",onClick:setEditSnapshot}]}];return!1===snapshotsLoaded?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceAround"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingSpinner,{size:"l"})))):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiInMemoryTable,{className:"eui-textOverflowWrap",compressed:!0,items:snapshots,columns:columns,pagination:{pageSizeOptions:[5,10,25]},sorting:{sort:{field:"timestamp",direction:"asc"}}}),null!==editSnapshot&&external_kbnSharedDeps_React_default.a.createElement(EditModelSnapshotFlyout,{snapshot:editSnapshot,job:job,closeFlyout:closeEditFlyout}),null!==revertSnapshot&&external_kbnSharedDeps_React_default.a.createElement(RevertModelSnapshotFlyout,{snapshot:revertSnapshot,snapshots:snapshots,job:job,closeFlyout:closeRevertFlyout,refresh:refresh}),null!==closeJobModalVisible&&null!==combinedJobState&&external_kbnSharedDeps_React_default.a.createElement(CloseJobConfirm,{combinedJobState:combinedJobState,hideCloseJobModalVisible:hideCloseJobModalVisible,forceCloseJob:forceCloseJob}))};async function getCombinedJobState(jobId){const jobs=await ml_api_service.ml.jobs.jobs([jobId]);return 1!==jobs.length?COMBINED_JOB_STATE.UNKNOWN:jobs[0].state!==states.c.CLOSED?jobs[0].datafeed_config.state!==states.a.STOPPED?COMBINED_JOB_STATE.OPEN_AND_RUNNING:COMBINED_JOB_STATE.OPEN_AND_STOPPED:COMBINED_JOB_STATE.CLOSED}var external_kbnSharedDeps_ElasticEuiLibServicesFormat_=__webpack_require__(56),recently_accessed=__webpack_require__(194),forecast_service=__webpack_require__(168),public_=__webpack_require__(42),app=__webpack_require__(5);class forecasts_table_ForecastsTableUI extends external_kbnSharedDeps_React_.Component{constructor(props){super(props),this.state={isLoading:0!==props.job.data_counts.processed_record_count,forecasts:[]}}componentDidMount(){const dataCounts=this.props.job.data_counts;dataCounts.processed_record_count>0&&forecast_service.a.getForecastsSummary(this.props.job,null,dataCounts.earliest_record_timestamp,500).then(resp=>{this.setState({isLoading:!1,forecasts:resp.forecasts})}).catch(resp=>{console.log("Error loading list of forecasts for jobs list:",resp),this.setState({isLoading:!1,errorMessage:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.jobDetails.forecastsTable.loadingErrorMessage",{defaultMessage:"Error loading the list of forecasts run on this job"}),forecasts:[]})})}async openSingleMetricView(forecast){const{services:{application:{navigateToApp:navigateToApp},share:{urlGenerators:{getUrlGenerator:getUrlGenerator}}}}=this.props.kibana,dataCounts=this.props.job.data_counts,jobEarliest=dataCounts.earliest_record_timestamp,resultLatest=Object(job_utils.g)(dataCounts.latest_record_timestamp,dataCounts.latest_bucket_timestamp),from=new Date(dataCounts.earliest_record_timestamp).toISOString(),to=void 0!==forecast?new Date(forecast.forecast_end_timestamp).toISOString():new Date(resultLatest).toISOString();let mlTimeSeriesExplorer={};if(void 0!==forecast){const forecastDurationMs=forecast.forecast_end_timestamp-forecast.forecast_start_timestamp,zoomFrom=Math.max(forecast.forecast_start_timestamp-forecastDurationMs,jobEarliest);mlTimeSeriesExplorer={forecastId:forecast.forecast_id,zoom:{from:new Date(zoomFrom).toISOString(),to:new Date(forecast.forecast_end_timestamp).toISOString()}}}const mlUrlGenerator=getUrlGenerator(ml_url_generator.a),singleMetricViewerForecastLink=await mlUrlGenerator.createUrl({page:ml_url_generator.b.SINGLE_METRIC_VIEWER,pageState:{timeRange:{from:from,to:to,mode:"absolute"},refreshInterval:{display:"Off",pause:!0,value:0},jobIds:[this.props.job.job_id],query:{query_string:{analyze_wildcard:!0,query:"*"}},...mlTimeSeriesExplorer},excludeBasePath:!0});Object(recently_accessed.a)("timeseriesexplorer",this.props.job.job_id,singleMetricViewerForecastLink),await navigateToApp(app.e,{path:singleMetricViewerForecastLink})}render(){if(!0===this.state.isLoading)return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceAround"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingSpinner,{size:"l"})));if(void 0!==this.state.errorMessage)return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:this.state.errorMessage,color:"danger",iconType:"cross"});const forecasts=this.state.forecasts;if(0===forecasts.length)return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.jobDetails.forecastsTable.noForecastsTitle",defaultMessage:"No forecasts have been run for this job"}),iconType:"iInCircle",role:"alert"},Object(job_utils.p)(this.props.job)&&external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.jobDetails.forecastsTable.noForecastsDescription",defaultMessage:"To run a forecast, open the {singleMetricViewerLink}",values:{singleMetricViewerLink:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{onClick:()=>this.openSingleMetricView()},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.jobDetails.forecastsTable.noForecastsDescription.linkText",defaultMessage:"Single Metric Viewer"}))}})));const columns=[{field:"forecast_create_timestamp",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.jobDetails.forecastsTable.createdLabel",{defaultMessage:"Created"}),dataType:"date",render:date_utils.d,textOnly:!0,sortable:!0,scope:"row"},{field:"forecast_start_timestamp",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.jobDetails.forecastsTable.fromLabel",{defaultMessage:"From"}),dataType:"date",render:date_utils.d,textOnly:!0,sortable:!0},{field:"forecast_end_timestamp",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.jobDetails.forecastsTable.toLabel",{defaultMessage:"To"}),dataType:"date",render:date_utils.d,textOnly:!0,sortable:!0},{field:"forecast_status",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.jobDetails.forecastsTable.statusLabel",{defaultMessage:"Status"}),sortable:!0},{field:"forecast_memory_bytes",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.jobDetails.forecastsTable.memorySizeLabel",{defaultMessage:"Memory size"}),render:bytes=>Object(external_kbnSharedDeps_ElasticEuiLibServicesFormat_.formatNumber)(bytes,"0b"),sortable:!0},{field:"processing_time_ms",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.jobDetails.forecastsTable.processingTimeLabel",{defaultMessage:"Processing time"}),render:ms=>external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.jobDetails.forecastsTable.msTimeUnitLabel",{defaultMessage:"{ms} ms",values:{ms:ms}}),sortable:!0},{field:"forecast_expiry_timestamp",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.jobDetails.forecastsTable.expiresLabel",{defaultMessage:"Expires"}),render:date_utils.d,textOnly:!0,sortable:!0},{field:"forecast_messages",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.jobDetails.forecastsTable.messagesLabel",{defaultMessage:"Messages"}),sortable:!1,render:messages=>external_kbnSharedDeps_React_default.a.createElement("div",null,messages.map((message,index)=>external_kbnSharedDeps_React_default.a.createElement("p",{key:index},message))),textOnly:!0},{name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.jobDetails.forecastsTable.viewLabel",{defaultMessage:"View"}),width:"60px",render:forecast=>{const viewForecastAriaLabel=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.jobDetails.forecastsTable.viewAriaLabel",{defaultMessage:"View forecast created at {createdDate}",values:{createdDate:Object(date_utils.d)(forecast.forecast_create_timestamp)}});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{onClick:()=>this.openSingleMetricView(forecast),isDisabled:forecast.forecast_status!==states.b.FINISHED,iconType:"visLine","aria-label":viewForecastAriaLabel})}}];return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiInMemoryTable,{compressed:!0,items:forecasts,columns:columns,pagination:{pageSizeOptions:[5,10,25]},sorting:!0})}}const ForecastsTable=Object(public_.withKibana)(forecasts_table_ForecastsTableUI);function SectionItem({item:item}){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTableRow,null,""!==item[0]&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTableRowCell,null,external_kbnSharedDeps_React_default.a.createElement("span",{className:"job-item header"},item[0])),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTableRowCell,null,external_kbnSharedDeps_React_default.a.createElement("span",{className:"job-item"},item[1])))}function Section({section:section}){return 0===section.items.length?external_kbnSharedDeps_React_default.a.createElement("div",null):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("h4",null,section.title)),external_kbnSharedDeps_React_default.a.createElement("div",{className:"job-section","data-test-subj":"mlJobRowDetailsSection-"+section.id},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTable,{compressed:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTableBody,null,section.items.map((item,i)=>external_kbnSharedDeps_React_default.a.createElement(SectionItem,{item:item,key:i}))))))}class job_details_pane_JobDetailsPane extends external_kbnSharedDeps_React_.Component{constructor(props){super(props),this.state={}}static getDerivedStateFromProps(props){const{sections:sections,time:time}=props;return{sections:sections,time:time}}render(){const{sections:sections,time:time}=this.state;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement("div",{className:"row",time:time,"data-test-subj":this.props["data-test-subj"]},external_kbnSharedDeps_React_default.a.createElement("div",{className:"col-md-6"},sections.filter(s=>"left"===s.position).map((s,i)=>external_kbnSharedDeps_React_default.a.createElement(Section,{section:s,key:i}))),external_kbnSharedDeps_React_default.a.createElement("div",{className:"col-md-6"},sections.filter(s=>"right"===s.position).map((s,i)=>external_kbnSharedDeps_React_default.a.createElement(Section,{section:s,key:i})))))}}var job_messages=__webpack_require__(421),errors=__webpack_require__(24);const JobMessagesPane=({jobId:jobId})=>{const[messages,setMessages]=Object(external_kbnSharedDeps_React_.useState)([]),[isLoading,setIsLoading]=Object(external_kbnSharedDeps_React_.useState)(!1),[errorMessage,setErrorMessage]=Object(external_kbnSharedDeps_React_.useState)(""),toastNotificationService=Object(toast_notification_service.c)(),fetchMessages=async()=>{setIsLoading(!0);try{setMessages(await ml_api_service.ml.jobs.jobAuditMessages(jobId)),setIsLoading(!1)}catch(error){setIsLoading(!1),toastNotificationService.displayErrorToast(error,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobService.jobAuditMessagesErrorTitle",{defaultMessage:"Error loading job messages"})),setErrorMessage(Object(errors.i)(error))}},refreshMessage=Object(external_kbnSharedDeps_React_.useCallback)(fetchMessages,[jobId]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{fetchMessages()},[]),external_kbnSharedDeps_React_default.a.createElement(job_messages.a,{refreshMessage:refreshMessage,messages:messages,loading:isLoading,error:errorMessage})};class job_details_JobDetailsUI extends external_kbnSharedDeps_React_.Component{constructor(props){super(props),this.state={},this.props.addYourself&&this.props.addYourself(props.jobId,j=>this.updateJob(j))}componentWillUnmount(){this.props.removeYourself(this.props.jobId)}updateJob(job){this.setState({job:job})}render(){const{job:job}=this.state,{services:{http:{basePath:basePath}}}=this.props.kibana;if(void 0===job)return external_kbnSharedDeps_React_default.a.createElement("div",{className:"job-loading-spinner","data-test-subj":"mlJobDetails loading"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingSpinner,{size:"l"}));{const{showFullDetails:showFullDetails,refreshJobList:refreshJobList}=this.props,{general:general,customUrl:customUrl,node:node,calendars:calendars,detectors:detectors,influencers:influencers,analysisConfig:analysisConfig,analysisLimits:analysisLimits,dataDescription:dataDescription,datafeed:datafeed,counts:counts,modelSizeStats:modelSizeStats,jobTimingStats:jobTimingStats,datafeedTimingStats:datafeedTimingStats,alertRules:alertRules}=function(job,basePath,refreshJobList){var _job$alerting_rules;if(0===Object.keys(job).length)return{};const general={id:"general",title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.jobDetails.generalTitle",{defaultMessage:"General"}),position:"left",items:filterObjects(job,!0).map(formatValues)},customUrl={id:"customUrl",title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.jobDetails.customUrlsTitle",{defaultMessage:"Custom URLs"}),position:"right",items:[]};job.custom_settings&&job.custom_settings.custom_urls&&customUrl.items.push(...job.custom_settings.custom_urls.map(cu=>[cu.url_name,cu.url_value,cu.time_range]));const node={id:"node",title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.jobDetails.nodeTitle",{defaultMessage:"Node"}),position:"right",items:[]};job.node&&node.items.push(["name",job.node.name]);const calendars={id:"calendars",title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.jobDetails.calendarsTitle",{defaultMessage:"Calendars"}),position:"right",items:[]};if(job.calendars){calendars.items=job.calendars.map(c=>["",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{href:basePath.prepend(`/app/ml/settings/calendars_list/edit_calendar/${c}?_g=()`)},c)]);const i=general.items.findIndex(item=>"calendars"===item[0]);i>=0&&general.items.splice(i,1)}const alertRules={id:"alertRules",title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.jobDetails.alertRulesTitle",{defaultMessage:"Alert rules"}),position:"right",items:(null!==(_job$alerting_rules=job.alerting_rules)&&void 0!==_job$alerting_rules?_job$alerting_rules:[]).map(v=>["",external_kbnSharedDeps_React_default.a.createElement(ml_alerting_flyout.a,{initialAlert:v,onSave:refreshJobList})])},detectors={id:"detectors",title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.jobDetails.detectorsTitle",{defaultMessage:"Detectors"}),position:"left",items:[]};job.analysis_config&&job.analysis_config.detectors&&detectors.items.push(...job.analysis_config.detectors.map(d=>{const stringifiedDtr=Object(string_utils.b)(d);return[stringifiedDtr,stringifiedDtr!==d.detector_description?d.detector_description:""]}));const influencers={id:"influencers",title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.jobDetails.influencersTitle",{defaultMessage:"Influencers"}),position:"left",items:job.analysis_config.influencers.map(i=>["",i])},analysisConfig={id:"analysisConfig",title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.jobDetails.analysisConfigTitle",{defaultMessage:"Analysis config"}),position:"left",items:filterObjects(job.analysis_config)},analysisLimits={id:"analysisLimits",title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.jobDetails.analysisLimitsTitle",{defaultMessage:"Analysis limits"}),position:"left",items:filterObjects(job.analysis_limits)},dataDescription={id:"dataDescription",title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.jobDetails.dataDescriptionTitle",{defaultMessage:"Data description"}),position:"right",items:filterObjects(job.data_description)},datafeed={id:"datafeed",title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.jobDetails.datafeedTitle",{defaultMessage:"Datafeed"}),position:"left",items:filterObjects(job.datafeed_config||{},!0,!0)};if(job.node&&datafeed.items.push(["node",JSON.stringify(job.node)]),job.datafeed_config&&job.datafeed_config.timing_stats){const i=datafeed.items.findIndex(item=>"timing_stats"===item[0]);i>=0&&datafeed.items.splice(i,1)}return{general:general,customUrl:customUrl,node:node,calendars:calendars,detectors:detectors,influencers:influencers,analysisConfig:analysisConfig,analysisLimits:analysisLimits,dataDescription:dataDescription,datafeed:datafeed,counts:{id:"counts",title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.jobDetails.countsTitle",{defaultMessage:"Counts"}),position:"left",items:filterObjects(job.data_counts).map(formatValues)},modelSizeStats:{id:"modelSizeStats",title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.jobDetails.modelSizeStatsTitle",{defaultMessage:"Model size stats"}),position:"right",items:filterObjects(job.model_size_stats).map(formatValues)},jobTimingStats:{id:"jobTimingStats",title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.jobDetails.jobTimingStatsTitle",{defaultMessage:"Job timing stats"}),position:"left",items:filterObjects(job.timing_stats).map(formatValues)},datafeedTimingStats:{id:"datafeedTimingStats",title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.jobDetails.datafeedTimingStatsTitle",{defaultMessage:"Timing stats"}),position:"right",items:job.datafeed_config&&job.datafeed_config.timing_stats?filterObjects(job.datafeed_config.timing_stats).filter(o=>"total_search_time_ms"!==o[0]).map(formatValues):[]},alertRules:alertRules}}(job,basePath,refreshJobList),tabs=[{id:"job-settings","data-test-subj":"mlJobListTab-job-settings",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.jobDetails.tabs.jobSettingsLabel",{defaultMessage:"Job settings"}),content:external_kbnSharedDeps_React_default.a.createElement(job_details_pane_JobDetailsPane,{"data-test-subj":"mlJobDetails-job-settings",sections:[general,customUrl,node,calendars,alertRules]}),time:job.open_time},{id:"job-config","data-test-subj":"mlJobListTab-job-config",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.jobDetails.tabs.jobConfigLabel",{defaultMessage:"Job config"}),content:external_kbnSharedDeps_React_default.a.createElement(job_details_pane_JobDetailsPane,{"data-test-subj":"mlJobDetails-job-config",sections:[detectors,influencers,analysisConfig,analysisLimits,dataDescription]})},{id:"counts","data-test-subj":"mlJobListTab-counts",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.jobDetails.tabs.countsLabel",{defaultMessage:"Counts"}),content:external_kbnSharedDeps_React_default.a.createElement(job_details_pane_JobDetailsPane,{"data-test-subj":"mlJobDetails-counts",sections:[counts,modelSizeStats,jobTimingStats]})},{id:"json","data-test-subj":"mlJobListTab-json",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.jobDetails.tabs.jsonLabel",{defaultMessage:"JSON"}),content:external_kbnSharedDeps_React_default.a.createElement(JsonPane,{job:job})},{id:"job-messages","data-test-subj":"mlJobListTab-job-messages",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.jobDetails.tabs.jobMessagesLabel",{defaultMessage:"Job messages"}),content:external_kbnSharedDeps_React_default.a.createElement(JobMessagesPane,{jobId:job.job_id})}];return showFullDetails&&datafeed.items.length&&(tabs.splice(2,0,{id:"datafeed","data-test-subj":"mlJobListTab-datafeed",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.jobDetails.tabs.datafeedLabel",{defaultMessage:"Datafeed"}),content:external_kbnSharedDeps_React_default.a.createElement(job_details_pane_JobDetailsPane,{"data-test-subj":"mlJobDetails-datafeed",sections:[datafeed,datafeedTimingStats]})}),tabs.push({id:"datafeed-preview","data-test-subj":"mlJobListTab-datafeed-preview",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.jobDetails.tabs.datafeedPreviewLabel",{defaultMessage:"Datafeed preview"}),content:external_kbnSharedDeps_React_default.a.createElement(datafeed_preview_tab_DatafeedPreviewPane,{job:job})},{id:"forecasts","data-test-subj":"mlJobListTab-forecasts",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.jobDetails.tabs.forecastsLabel",{defaultMessage:"Forecasts"}),content:external_kbnSharedDeps_React_default.a.createElement(ForecastsTable,{job:job})})),showFullDetails&&(tabs.push({id:"annotations","data-test-subj":"mlJobListTab-annotations",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.jobDetails.tabs.annotationsLabel",{defaultMessage:"Annotations"}),content:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(annotations_table.a,{jobs:[job],drillDown:!0}),external_kbnSharedDeps_React_default.a.createElement(annotation_flyout.a,null))}),tabs.push({id:"modelSnapshots","data-test-subj":"mlJobListTab-modelSnapshots",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.jobDetails.tabs.modelSnapshotsLabel",{defaultMessage:"Model snapshots"}),content:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(ModelSnapshotTable,{job:job,refreshJobList:refreshJobList}))})),external_kbnSharedDeps_React_default.a.createElement("div",{className:"tab-contents","data-test-subj":"mlJobListRowDetails details-"+job.job_id},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTabbedContent,{tabs:tabs,initialSelectedTab:tabs[0],onTabClick:()=>{}}))}}}const job_details_JobDetails=Object(public_.withKibana)(job_details_JobDetailsUI),JobFilterBar=({queryText:queryText,setFilters:setFilters})=>{const[error,setError]=Object(external_kbnSharedDeps_React_.useState)(null),{services:{mlServices:{mlApiServices:mlApiServices}}}=Object(kibana.b)(),loadGroups=Object(external_kbnSharedDeps_React_.useCallback)(async()=>{try{return(await mlApiServices.jobs.groups()).map(g=>({value:g.id,view:external_kbnSharedDeps_React_default.a.createElement("div",{className:"group-item"},external_kbnSharedDeps_React_default.a.createElement(JobGroup,{name:g.id})," ",external_kbnSharedDeps_React_default.a.createElement("span",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.jobFilterBar.jobGroupTitle",defaultMessage:"({jobsCount, plural, one {# job} other {# jobs}})",values:{jobsCount:g.jobIds.length}})))}))}catch(e){return[]}},[]),queryInstance=Object(external_kbnSharedDeps_React_.useMemo)(()=>external_kbnSharedDeps_ElasticEui_.EuiSearchBar.Query.parse(null!=queryText?queryText:""),[queryText]);Object(external_kbnSharedDeps_React_.useEffect)(()=>{setFilters(queryInstance)},[queryText]);const filters=Object(external_kbnSharedDeps_React_.useMemo)(()=>[{type:"field_value_toggle_group",field:"job_state",items:[{value:"opened",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.jobFilterBar.openedLabel",{defaultMessage:"Opened"})},{value:"closed",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.jobFilterBar.closedLabel",{defaultMessage:"Closed"})},{value:"failed",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.jobFilterBar.failedLabel",{defaultMessage:"Failed"})}]},{type:"field_value_toggle_group",field:"datafeed_state",items:[{value:"started",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.jobFilterBar.startedLabel",{defaultMessage:"Started"})},{value:"stopped",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.jobFilterBar.stoppedLabel",{defaultMessage:"Stopped"})}]},{type:"field_value_selection",field:"groups",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.jobFilterBar.groupLabel",{defaultMessage:"Group"}),multiSelect:"or",cache:1e4,options:()=>loadGroups()}],[]),errorText=Object(external_kbnSharedDeps_React_.useMemo)(()=>null===error?"":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.jobFilterBar.invalidSearchErrorMessage",{defaultMessage:"Invalid search: {errorMessage}",values:{errorMessage:error.message}}),[error]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"column"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{"data-test-subj":"mlJobListSearchBar",grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSearchBar,{box:{incremental:!0},query:queryInstance,filters:filters,onChange:({query:query,error:queryError})=>{error?setError(queryError):(setFilters(query),setError(null))},className:"mlJobFilterBar"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{fullWidth:!0,isInvalid:null!==error,error:errorText,style:{maxHeight:0}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null))))};function job_details_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class tabs_job_details_JobDetails extends external_kbnSharedDeps_React_.Component{constructor(props){super(props),job_details_defineProperty(this,"onDescriptionChange",e=>{this.setJobDetails({jobDescription:e.target.value})}),job_details_defineProperty(this,"onMmlChange",e=>{this.setJobDetails({jobModelMemoryLimit:e.target.value})}),job_details_defineProperty(this,"onModelSnapshotRetentionDaysChange",e=>{const jobModelSnapshotRetentionDays=Math.floor(+e.target.value);this.setJobDetails({jobModelSnapshotRetentionDays:jobModelSnapshotRetentionDays,...this.state.dailyModelSnapshotRetentionAfterDays>jobModelSnapshotRetentionDays?{jobDailyModelSnapshotRetentionAfterDays:jobModelSnapshotRetentionDays}:{}})}),job_details_defineProperty(this,"onDailyModelSnapshotRetentionAfterDaysChange",e=>{const jobDailyModelSnapshotRetentionAfterDays=Math.floor(+e.target.value);jobDailyModelSnapshotRetentionAfterDays<=this.state.modelSnapshotRetentionDays&&this.setJobDetails({jobDailyModelSnapshotRetentionAfterDays:jobDailyModelSnapshotRetentionAfterDays})}),job_details_defineProperty(this,"onGroupsChange",selectedGroups=>{this.setJobDetails({jobGroups:selectedGroups.map(g=>g.label)})}),job_details_defineProperty(this,"onCreateGroup",(input,flattenedOptions)=>{const normalizedSearchValue=input.trim().toLowerCase();if(!normalizedSearchValue)return;const newGroup={label:input},groups=this.state.groups;-1===flattenedOptions.findIndex(option=>option.label.trim().toLowerCase()===normalizedSearchValue)&&groups.push(newGroup);const selectedGroups=this.state.selectedGroups.concat(newGroup);this.setState({groups:groups},()=>this.onGroupsChange(selectedGroups))}),this.state={description:"",groups:[],selectedGroups:[],mml:"",mmlValidationError:"",groupsValidationError:"",modelSnapshotRetentionDays:1,dailyModelSnapshotRetentionAfterDays:1},this.setJobDetails=props.setJobDetails}componentDidMount(){ml_api_service.ml.jobs.groups().then(resp=>{const groups=resp.map(g=>({label:g.id,color:Object(group_color_utils.a)(g.id)}));this.setState({groups:groups})}).catch(error=>{console.error("Could not load groups",error)})}static getDerivedStateFromProps(props){const selectedGroups=void 0!==props.jobGroups?props.jobGroups.map(g=>({label:g,color:Object(group_color_utils.a)(g)})):[],{datafeedRunning:datafeedRunning,jobClosed:jobClosed}=props;let mmlHelpText=null;return jobClosed||(mmlHelpText=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.jobDetails.modelMemoryLimitJobOpenLabelHelp",defaultMessage:"Model memory limit cannot be edited while the job is open."})),datafeedRunning&&(mmlHelpText=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.jobDetails.modelMemoryLimitLabelHelp",defaultMessage:"Model memory limit cannot be edited while the datafeed is running."})),{description:props.jobDescription,selectedGroups:selectedGroups,mml:props.jobModelMemoryLimit,mmlHelpText:mmlHelpText,mmlValidationError:props.jobModelMemoryLimitValidationError,groupsValidationError:props.jobGroupsValidationError,modelSnapshotRetentionDays:props.jobModelSnapshotRetentionDays,dailyModelSnapshotRetentionAfterDays:props.jobDailyModelSnapshotRetentionAfterDays}}render(){const{description:description,selectedGroups:selectedGroups,mml:mml,groups:groups,mmlValidationError:mmlValidationError,groupsValidationError:groupsValidationError,modelSnapshotRetentionDays:modelSnapshotRetentionDays,dailyModelSnapshotRetentionAfterDays:dailyModelSnapshotRetentionAfterDays,mmlHelpText:mmlHelpText}=this.state,{datafeedRunning:datafeedRunning,jobClosed:jobClosed}=this.props;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiForm,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.jobDetails.jobDescriptionLabel",defaultMessage:"Job description"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldText,{value:description,onChange:this.onDescriptionChange})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.jobDetails.jobGroupsLabel",defaultMessage:"Job groups"}),isInvalid:""!==groupsValidationError,error:groupsValidationError},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiComboBox,{placeholder:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.editJobFlyout.jobDetails.jobGroupsPlaceholder",{defaultMessage:"Select or create groups"}),options:groups,selectedOptions:selectedGroups,onChange:this.onGroupsChange,onCreateOption:this.onCreateGroup,isClearable:!0,isInvalid:""!==groupsValidationError,error:groupsValidationError})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.jobDetails.modelMemoryLimitLabel",defaultMessage:"Model memory limit"}),helpText:mmlHelpText,isInvalid:""!==mmlValidationError,error:mmlValidationError},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldText,{value:mml,onChange:this.onMmlChange,isInvalid:""!==mmlValidationError,error:mmlValidationError,disabled:datafeedRunning||!jobClosed})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.jobDetails.modelSnapshotRetentionDaysLabel",defaultMessage:"Model snapshot retention days"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldNumber,{min:0,value:modelSnapshotRetentionDays,onChange:this.onModelSnapshotRetentionDaysChange})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.jobDetails.dailyModelSnapshotRetentionAfterDaysLabel",defaultMessage:"Daily model snapshot retention after days"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldNumber,{min:0,max:modelSnapshotRetentionDays,value:dailyModelSnapshotRetentionAfterDays,onChange:this.onDailyModelSnapshotRetentionAfterDaysChange}))))}}class detectors_Detectors extends external_kbnSharedDeps_React_.Component{constructor(props){var obj,key,value;super(props),value=(e,i)=>{const jobDetectorDescriptions=this.state.detectorDescriptions;jobDetectorDescriptions[i]=e.target.value,this.setDetectorDescriptions({jobDetectorDescriptions:jobDetectorDescriptions})},(key="onDescriptionChange")in(obj=this)?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,this.detectors=job_service.a.getJobGroups().map(g=>({label:g.id})),this.state={detectors:[],detectorDescriptions:[]},this.setDetectorDescriptions=props.setDetectorDescriptions}static getDerivedStateFromProps(props){return{detectors:props.jobDetectors,detectorDescriptions:props.jobDetectorDescriptions}}render(){const{detectors:detectors,detectorDescriptions:detectorDescriptions}=this.state;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiForm,null,detectorDescriptions.map((d,i)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:Object(string_utils.b)(detectors[i]),key:i},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldText,{value:d,onChange:e=>this.onDescriptionChange(e,i)})))))}}var ml_server_info=__webpack_require__(88);function datafeed_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function getDefaults(bucketSpan,jobDefaults){const bucketSpanSeconds=void 0!==bucketSpan?Object(parse_interval.a)(bucketSpan).asSeconds():"";return{queryDelay:"60s",frequency:Object(job_utils.f)(bucketSpanSeconds)+"s",scrollSize:jobDefaults.datafeeds.scroll_size}}class datafeed_Datafeed extends external_kbnSharedDeps_React_.Component{constructor(props){super(props),datafeed_defineProperty(this,"onQueryChange",query=>{this.setDatafeed({datafeedQuery:query})}),datafeed_defineProperty(this,"onQueryDelayChange",e=>{this.setDatafeed({datafeedQueryDelay:e.target.value})}),datafeed_defineProperty(this,"onFrequencyChange",e=>{this.setDatafeed({datafeedFrequency:e.target.value})}),datafeed_defineProperty(this,"onScrollSizeChange",e=>{this.setDatafeed({datafeedScrollSize:+e.target.value})}),this.state={query:"",queryDelay:"",frequency:"",scrollSize:"",defaults:{queryDelay:"",frequency:"",scrollSize:0},jobDefaults:Object(ml_server_info.b)()},this.setDatafeed=props.setDatafeed}static getDerivedStateFromProps(props,state){return{query:props.datafeedQuery,queryDelay:props.datafeedQueryDelay,frequency:props.datafeedFrequency,scrollSize:props.datafeedScrollSize,defaults:getDefaults(props.jobBucketSpan,state.jobDefaults)}}render(){const{query:query,queryDelay:queryDelay,frequency:frequency,scrollSize:scrollSize,defaults:defaults}=this.state,{datafeedRunning:datafeedRunning}=this.props;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),datafeedRunning&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{color:"warning"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.datafeed.readOnlyCalloutText",defaultMessage:"Datafeed settings cannot be edited while the datafeed is running. Please stop the job if you wish to edit these settings."})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiForm,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.datafeed.queryLabel",defaultMessage:"Query"}),style:{maxWidth:"inherit"}},external_kbnSharedDeps_React_default.a.createElement(ml_job_editor.a,{mode:ml_job_editor.b.XJSON,value:query,onChange:this.onQueryChange,height:"200px",readOnly:datafeedRunning})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.datafeed.queryDelayLabel",defaultMessage:"Query delay"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldText,{value:queryDelay,placeholder:defaults.queryDelay,onChange:this.onQueryDelayChange,disabled:datafeedRunning})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.datafeed.frequencyLabel",defaultMessage:"Frequency"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldText,{value:frequency,placeholder:defaults.frequency,onChange:this.onFrequencyChange,disabled:datafeedRunning})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.datafeed.scrollSizeLabel",defaultMessage:"Scroll size"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldNumber,{value:scrollSize,placeholder:defaults.scrollSize,onChange:this.onScrollSizeChange,disabled:datafeedRunning}))))}}var custom_urls=__webpack_require__(286),edit_utils=__webpack_require__(322),util=__webpack_require__(169),custom_url_utils=__webpack_require__(151);function validateGroupNames(groups){const tempJob={groups:groups},validationResults=Object(job_utils.u)(tempJob),{valid:valid}=validationResults,groupIds={valid:valid,message:""};return Object(util.b)(validationResults,{groupIds:groupIds}),groupIds}var shared_imports=__webpack_require__(167);function edit_job_flyout_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class edit_job_flyout_EditJobFlyoutUI extends external_kbnSharedDeps_React_.Component{constructor(props){super(props),edit_job_flyout_defineProperty(this,"_initialJobFormState",null),edit_job_flyout_defineProperty(this,"closeFlyout",(isConfirmed=!1)=>{!this.containsUnsavedChanges()||isConfirmed?(this.setState({isConfirmationModalVisible:!1}),this.setState({isFlyoutVisible:!1})):this.setState({isConfirmationModalVisible:!0})}),edit_job_flyout_defineProperty(this,"showFlyout",jobLite=>{const hasDatafeed=jobLite.hasDatafeed;loadFullJob(jobLite.id).then(job=>{this.extractJob(job,hasDatafeed),this.setState({job:job,isFlyoutVisible:!0})}).catch(error=>{console.error(error)})}),edit_job_flyout_defineProperty(this,"setJobDetails",jobDetails=>{let{jobModelMemoryLimitValidationError:jobModelMemoryLimitValidationError,jobGroupsValidationError:jobGroupsValidationError}=this.state;void 0!==jobDetails.jobModelMemoryLimit&&(jobModelMemoryLimitValidationError=function(mml){const limits=Object(ml_server_info.c)(),tempJob={analysis_limits:{model_memory_limit:mml}};let validationResults=Object(job_utils.w)(mml),{valid:valid}=validationResults;valid&&(validationResults=Object(job_utils.v)(tempJob,limits),valid=validationResults.valid);const modelMemoryLimit={valid:valid,message:""};return Object(util.b)(validationResults,{modelMemoryLimit:modelMemoryLimit}),modelMemoryLimit}(jobDetails.jobModelMemoryLimit).message),void 0!==jobDetails.jobGroups&&(jobGroupsValidationError=validateGroupNames(jobDetails.jobGroups).message,""===jobGroupsValidationError&&ml_api_service.ml.jobs.jobsExist(jobDetails.jobGroups,!0).then(resp=>{!1===(!1===Object.values(resp).some(g=>!0===g.exists&&!1===g.isGroup))&&this.setState({jobGroupsValidationError:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.editJobFlyout.groupsAndJobsHasSameIdErrorMessage",{defaultMessage:"A job with this ID already exists. Groups and jobs cannot use the same ID."}),isValidJobDetails:!1})}));const isValidJobDetails=""===jobModelMemoryLimitValidationError&&""===jobGroupsValidationError;this.setState({...jobDetails,jobModelMemoryLimitValidationError:jobModelMemoryLimitValidationError,jobGroupsValidationError:jobGroupsValidationError,isValidJobDetails:isValidJobDetails})}),edit_job_flyout_defineProperty(this,"setDetectorDescriptions",jobDetectorDescriptions=>{this.setState({...jobDetectorDescriptions})}),edit_job_flyout_defineProperty(this,"setDatafeed",datafeed=>{this.setState({...datafeed})}),edit_job_flyout_defineProperty(this,"setCustomUrls",jobCustomUrls=>{const isValidJobCustomUrls=void 0===(customUrls=jobCustomUrls)||0===customUrls.length||!customUrls.some((customUrl,index)=>{const label=customUrl.url_name,otherUrls=[...customUrls];otherUrls.splice(index,1);let itemValid=Object(custom_url_utils.b)(label,otherUrls);if(!0===itemValid){const timeRange=customUrl.time_range;itemValid=Object(custom_url_utils.c)(timeRange)}return!itemValid});var customUrls;this.setState({jobCustomUrls:jobCustomUrls,isValidJobCustomUrls:isValidJobCustomUrls})}),edit_job_flyout_defineProperty(this,"save",()=>{const newJobData={description:this.state.jobDescription,groups:this.state.jobGroups,mml:this.state.jobModelMemoryLimit,modelSnapshotRetentionDays:this.state.jobModelSnapshotRetentionDays,dailyModelSnapshotRetentionAfterDays:this.state.jobDailyModelSnapshotRetentionAfterDays,detectorDescriptions:this.state.jobDetectorDescriptions,datafeedQuery:Object(shared_imports.b)(this.state.datafeedQuery),datafeedQueryDelay:this.state.datafeedQueryDelay,datafeedFrequency:this.state.datafeedFrequency,datafeedScrollSize:this.state.datafeedScrollSize,customUrls:this.state.jobCustomUrls},{toasts:toasts}=this.props.kibana.services.notifications,toastNotificationService=Object(toast_notification_service.b)(toasts);Object(edit_utils.c)(this.state.job,newJobData).then(()=>{toasts.addSuccess(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.editJobFlyout.changesSavedNotificationMessage",{defaultMessage:"Changes to {jobId} saved",values:{jobId:this.state.job.job_id}})),this.refreshJobs(),this.closeFlyout(!0)}).catch(error=>{console.error(error),toastNotificationService.displayErrorToast(error,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.editJobFlyout.changesNotSavedNotificationMessage",{defaultMessage:"Could not save changes to {jobId}",values:{jobId:this.state.job.job_id}}))})}),this.state={job:{},hasDatafeed:!1,datafeedRunning:!1,isFlyoutVisible:!1,isConfirmationModalVisible:!1,jobDescription:"",jobGroups:[],jobModelMemoryLimit:"",jobModelSnapshotRetentionDays:10,jobDailyModelSnapshotRetentionAfterDays:10,jobDetectors:[],jobDetectorDescriptions:[],jobCustomUrls:[],datafeedQuery:"",datafeedQueryDelay:"",datafeedFrequency:"",datafeedScrollSize:"",jobModelMemoryLimitValidationError:"",jobGroupsValidationError:"",isValidJobDetails:!0,isValidJobCustomUrls:!0},this.refreshJobs=this.props.refreshJobs}componentDidMount(){"function"==typeof this.props.setShowFunction&&this.props.setShowFunction(this.showFlyout)}componentWillUnmount(){"function"==typeof this.props.unsetShowFunction&&this.props.unsetShowFunction()}containsUnsavedChanges(){return!Object(external_kbnSharedDeps_Lodash_.isEqual)(this._initialJobFormState,Object(external_kbnSharedDeps_Lodash_.pick)(this.state,["jobDescription","jobGroups","jobModelMemoryLimit","jobModelSnapshotRetentionDays","jobDailyModelSnapshotRetentionAfterDays","jobCustomUrls","jobDetectors","jobDetectorDescriptions","jobBucketSpan","datafeedQuery","datafeedQueryDelay","datafeedFrequency","datafeedScrollSize"]))}extractInitialJobFormState(job,hasDatafeed){const mml=job.analysis_limits&&job.analysis_limits.model_memory_limit?job.analysis_limits.model_memory_limit:"",modelSnapshotRetentionDays=void 0!==job.model_snapshot_retention_days?job.model_snapshot_retention_days:10,dailyModelSnapshotRetentionAfterDays=void 0!==job.daily_model_snapshot_retention_after_days?job.daily_model_snapshot_retention_after_days:modelSnapshotRetentionDays,detectors=job.analysis_config&&job.analysis_config.detectors?[...job.analysis_config.detectors]:[],bucketSpan=job.analysis_config?job.analysis_config.bucket_span:"",datafeedConfig={...job.datafeed_config},frequency=void 0!==datafeedConfig.frequency?datafeedConfig.frequency:"",customUrls=job.custom_settings&&job.custom_settings.custom_urls?[...job.custom_settings.custom_urls]:[];this._initialJobFormState=Object.freeze({jobDescription:job.description,jobGroups:void 0!==job.groups?job.groups:[],jobModelMemoryLimit:mml,jobModelSnapshotRetentionDays:modelSnapshotRetentionDays,jobDailyModelSnapshotRetentionAfterDays:dailyModelSnapshotRetentionAfterDays,jobDetectors:detectors,jobDetectorDescriptions:detectors.map(d=>d.detector_description),jobBucketSpan:bucketSpan,jobCustomUrls:customUrls,datafeedQuery:hasDatafeed?JSON.stringify(datafeedConfig.query,null,2):"",datafeedQueryDelay:hasDatafeed?datafeedConfig.query_delay:"",datafeedFrequency:hasDatafeed?frequency:"",datafeedScrollSize:hasDatafeed?+datafeedConfig.scroll_size:null})}extractJob(job,hasDatafeed){this.extractInitialJobFormState(job,hasDatafeed);const datafeedRunning=hasDatafeed&&job.datafeed_config.state!==states.a.STOPPED,jobClosed=job.state===states.c.CLOSED;this.setState({job:job,hasDatafeed:hasDatafeed,datafeedRunning:datafeedRunning,jobClosed:jobClosed,jobModelMemoryLimitValidationError:"",jobGroupsValidationError:"",...Object(external_kbnSharedDeps_Lodash_.cloneDeep)(this._initialJobFormState)})}render(){let flyout,confirmationModal;if(this.state.isFlyoutVisible){const{job:job,jobDescription:jobDescription,jobGroups:jobGroups,jobModelMemoryLimit:jobModelMemoryLimit,jobModelSnapshotRetentionDays:jobModelSnapshotRetentionDays,jobDailyModelSnapshotRetentionAfterDays:jobDailyModelSnapshotRetentionAfterDays,jobDetectors:jobDetectors,jobDetectorDescriptions:jobDetectorDescriptions,jobBucketSpan:jobBucketSpan,jobCustomUrls:jobCustomUrls,datafeedQuery:datafeedQuery,datafeedQueryDelay:datafeedQueryDelay,datafeedFrequency:datafeedFrequency,datafeedScrollSize:datafeedScrollSize,jobGroupsValidationError:jobGroupsValidationError,jobModelMemoryLimitValidationError:jobModelMemoryLimitValidationError,isValidJobDetails:isValidJobDetails,isValidJobCustomUrls:isValidJobCustomUrls,datafeedRunning:datafeedRunning,jobClosed:jobClosed}=this.state,tabs=[{id:"job-details",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.editJobFlyout.jobDetailsTitle",{defaultMessage:"Job details"}),content:external_kbnSharedDeps_React_default.a.createElement(tabs_job_details_JobDetails,{jobClosed:jobClosed,datafeedRunning:datafeedRunning,jobDescription:jobDescription,jobGroups:jobGroups,jobModelMemoryLimit:jobModelMemoryLimit,jobModelSnapshotRetentionDays:jobModelSnapshotRetentionDays,jobDailyModelSnapshotRetentionAfterDays:jobDailyModelSnapshotRetentionAfterDays,setJobDetails:this.setJobDetails,jobGroupsValidationError:jobGroupsValidationError,jobModelMemoryLimitValidationError:jobModelMemoryLimitValidationError})},{id:"detectors",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.editJobFlyout.detectorsTitle",{defaultMessage:"Detectors"}),content:external_kbnSharedDeps_React_default.a.createElement(detectors_Detectors,{jobDetectors:jobDetectors,jobDetectorDescriptions:jobDetectorDescriptions,setDetectorDescriptions:this.setDetectorDescriptions})},{id:"datafeed",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.editJobFlyout.datafeedTitle",{defaultMessage:"Datafeed"}),content:external_kbnSharedDeps_React_default.a.createElement(datafeed_Datafeed,{datafeedQuery:datafeedQuery,datafeedQueryDelay:datafeedQueryDelay,datafeedFrequency:datafeedFrequency,datafeedScrollSize:datafeedScrollSize,jobBucketSpan:jobBucketSpan,setDatafeed:this.setDatafeed,datafeedRunning:datafeedRunning})},{id:"custom-urls",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.editJobFlyout.customUrlsTitle",{defaultMessage:"Custom URLs"}),content:external_kbnSharedDeps_React_default.a.createElement(custom_urls.a,{job:job,jobCustomUrls:jobCustomUrls,setCustomUrls:this.setCustomUrls})}];flyout=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyout,{onClose:()=>{this.closeFlyout()},size:"m"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyoutHeader,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,null,external_kbnSharedDeps_React_default.a.createElement("h2",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.pageTitle",defaultMessage:"Edit {jobId}",values:{jobId:job.job_id}})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyoutBody,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTabbedContent,{tabs:tabs,initialSelectedTab:tabs[0],onTabClick:()=>{}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyoutFooter,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{iconType:"cross",onClick:()=>{this.closeFlyout()},flush:"left"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.closeButtonLabel",defaultMessage:"Close"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{onClick:this.save,fill:!0,isDisabled:!1===isValidJobDetails||!1===isValidJobCustomUrls},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.saveButtonLabel",defaultMessage:"Save"}))))))}return this.state.isConfirmationModalVisible&&(confirmationModal=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiConfirmModal,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.unsavedChangesDialogTitle",defaultMessage:"Save changes before leaving?"}),onCancel:()=>this.closeFlyout(!0),onConfirm:()=>this.save(),cancelButtonText:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.leaveAnywayButtonLabel",defaultMessage:"Leave anyway"}),confirmButtonText:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.saveChangesButtonLabel",defaultMessage:"Save changes"}),defaultFocusedButton:"confirm"},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.unsavedChangesDialogMessage",defaultMessage:"If you don't save, your changes will be lost."})))),external_kbnSharedDeps_React_default.a.createElement("div",null,flyout,confirmationModal)}}const EditJobFlyout=Object(public_.withKibana)(edit_job_flyout_EditJobFlyoutUI);var jobs_list=__webpack_require__(191),delete_job_check_modal=__webpack_require__(295);const DeleteJobModal=({setShowFunction:setShowFunction,unsetShowFunction:unsetShowFunction,refreshJobs:refreshJobs})=>{const[deleting,setDeleting]=Object(external_kbnSharedDeps_React_.useState)(!1),[modalVisible,setModalVisible]=Object(external_kbnSharedDeps_React_.useState)(!1),[jobIds,setJobIds]=Object(external_kbnSharedDeps_React_.useState)([]),[canDelete,setCanDelete]=Object(external_kbnSharedDeps_React_.useState)(!1);function showModal(jobs){setJobIds(jobs.map(({id:id})=>id)),setModalVisible(!0),setDeleting(!1)}function closeModal(){setModalVisible(!1),setCanDelete(!1)}return Object(external_kbnSharedDeps_React_.useEffect)(()=>("function"==typeof setShowFunction&&setShowFunction(showModal),()=>{"function"==typeof unsetShowFunction&&unsetShowFunction()}),[]),!1===modalVisible||0===jobIds.length?null:canDelete?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModal,{"data-test-subj":"mlDeleteJobConfirmModal",onClose:closeModal},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalHeader,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalHeaderTitle,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.deleteJobModal.deleteJobsTitle",defaultMessage:"Delete {jobsCount, plural, one {{jobId}} other {# jobs}}?",values:{jobsCount:jobIds.length,jobId:jobIds[0]}}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalBody,null,external_kbnSharedDeps_React_default.a.createElement("p",null,!0===deleting?external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.deleteJobModal.deletingJobsStatusLabel",defaultMessage:"Deleting jobs"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),external_kbnSharedDeps_React_default.a.createElement("div",{style:{textAlign:"center"}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingSpinner,{size:"l"}))):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.deleteJobModal.deleteMultipleJobsDescription",defaultMessage:"Deleting {jobsCount, plural, one {a job} other {multiple jobs}} can be time consuming. {jobsCount, plural, one {It} other {They}} will be deleted in the background and may not disappear from the jobs list instantly.",values:{jobsCount:jobIds.length}})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalFooter,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{onClick:closeModal,disabled:deleting},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.deleteJobModal.cancelButtonLabel",defaultMessage:"Cancel"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{onClick:function(){setDeleting(!0),function(jobs,finish=(()=>{})){const jobIds=jobs.map(j=>j.id);job_service.a.deleteJobs(jobIds).then(resp=>{showResults(resp,states.c.DELETED),finish()}).catch(error=>{Object(toast_notification_service.a)().displayErrorToast(error,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.deleteJobErrorMessage",{defaultMessage:"Jobs failed to delete"})),finish()})}(jobIds.map(id=>({id:id}))),setTimeout(()=>{closeModal(),refreshJobs()},jobs_list.b)},fill:!0,disabled:deleting,color:"danger","data-test-subj":"mlDeleteJobConfirmModalButton"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.deleteJobModal.deleteButtonLabel",defaultMessage:"Delete"}))))):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(delete_job_check_modal.a,{jobIds:jobIds,jobType:"anomaly-detector",canDeleteCallback:()=>{setCanDelete(!0)},onCloseCallback:closeModal,refreshJobsCallback:refreshJobs}))};__webpack_require__(477);function time_range_selector_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class time_range_selector_TimeRangeSelector extends external_kbnSharedDeps_React_.Component{constructor(props){super(props),time_range_selector_defineProperty(this,"setStartTab",tab=>{switch(this.setState({startTab:tab}),tab){case 0:this.setStartTime(void 0);break;case 1:this.setStartTime(this.now)}}),time_range_selector_defineProperty(this,"setEndTab",tab=>{switch(this.setState({endTab:tab}),tab){case 0:this.setEndTime(void 0);break;case 1:this.setEndTime(this.now)}}),time_range_selector_defineProperty(this,"setStartTime",time=>{this.props.setStartTime(time)}),time_range_selector_defineProperty(this,"setEndTime",time=>{this.props.setEndTime(time)}),this.state={startTab:0,endTab:1},this.latestTimestamp=this.props.startTime,this.now=this.props.now}getTabItems(){const datePickerTimes={start:external_kbnSharedDeps_Moment_default.a.isMoment(this.props.startTime)?this.props.startTime:this.latestTimestamp,end:external_kbnSharedDeps_Moment_default.a.isMoment(this.props.endTime)?this.props.endTime:this.now},formattedLatestStartTime=this.latestTimestamp.format(time_format.a),startLabels=!0===this.latestTimestamp.valueOf()>0?[external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.startDatafeedModal.continueFromStartTimeLabel",defaultMessage:"Continue from {formattedLatestStartTime}",values:{formattedLatestStartTime:formattedLatestStartTime}}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.startDatafeedModal.continueFromNowLabel",defaultMessage:"Continue from now"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.startDatafeedModal.continueFromSpecifiedTimeLabel",defaultMessage:"Continue from specified time"})]:[external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.startDatafeedModal.startAtBeginningOfDataLabel",defaultMessage:"Start at beginning of data"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.startDatafeedModal.startFromNowLabel",defaultMessage:"Start from now"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.startDatafeedModal.specifyStartTimeLabel",defaultMessage:"Specify start time"})];return{startItems:[{index:0,label:startLabels[0]},{index:1,label:startLabels[1]},{index:2,label:startLabels[2],body:external_kbnSharedDeps_React_default.a.createElement(DatePickerWithInput,{date:datePickerTimes.start,onChange:this.setStartTime,maxDate:datePickerTimes.end,setIsValid:this.props.setTimeRangeValid,tab:this.state.startTab})}],endItems:[{index:0,label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.startDatafeedModal.noEndTimeLabel",defaultMessage:"No end time (Real-time search)"})},{index:1,label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.startDatafeedModal.specifyEndTimeLabel",defaultMessage:"Specify end time"}),body:external_kbnSharedDeps_React_default.a.createElement(DatePickerWithInput,{date:datePickerTimes.end,onChange:this.setEndTime,minDate:datePickerTimes.start,setIsValid:this.props.setTimeRangeValid,tab:this.state.endTab})}]}}render(){const{startItems:startItems,endItems:endItems}=this.getTabItems();return external_kbnSharedDeps_React_default.a.createElement("div",{className:"time-range-selector"},external_kbnSharedDeps_React_default.a.createElement("div",{className:"time-range-section-container"},external_kbnSharedDeps_React_default.a.createElement(TabStack,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.startDatafeedModal.searchStartTimeTitle",defaultMessage:"Search start time"}),items:startItems,switchState:this.state.startTab,switchFunc:this.setStartTab}),external_kbnSharedDeps_React_default.a.createElement(TabStack,{title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.startDatafeedModal.searchEndTimeTitle",defaultMessage:"Search end time"}),items:endItems,switchState:this.state.endTab,switchFunc:this.setEndTab})))}}function TabStack({title:title,items:items,switchState:switchState,switchFunc:switchFunc}){return external_kbnSharedDeps_React_default.a.createElement("div",{className:"time-range-section"},external_kbnSharedDeps_React_default.a.createElement("div",{className:"time-range-section-title"},title),external_kbnSharedDeps_React_default.a.createElement("ul",{className:"tab-stack"},items.map((item,i)=>{let className="";return switchState===item.index&&(className+="active "),void 0!==item.body&&(className+="has-body "),external_kbnSharedDeps_React_default.a.createElement("li",{key:i,className:className},external_kbnSharedDeps_React_default.a.createElement("a",{onClick:()=>switchFunc(item.index),onKeyUp:()=>{}},item.label),void 0!==item.body&&external_kbnSharedDeps_React_default.a.createElement("div",{className:"body"},item.body))})))}const DatePickerWithInput=({date:date,onChange:onChange,minDate:minDate,setIsValid:setIsValid,tab:tab})=>{const[dateString,setDateString]=Object(external_kbnSharedDeps_React_.useState)(date.format(time_format.a)),[currentTab,setCurrentTab]=Object(external_kbnSharedDeps_React_.useState)(tab);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{currentTab!==tab&&(setDateString(date.format(time_format.a)),setCurrentTab(tab))},[tab]),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldText,{value:dateString,onChange:function(e){const val=e.target.value;setDateString(val);const newDate=external_kbnSharedDeps_Moment_default()(val);newDate.isValid()?(setIsValid(!0),onChange(newDate)):setIsValid(!1)},placeholder:time_format.a,"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate('xpack.ml.jobsList.startDatafeedModal.enterDateText"',{defaultMessage:"Enter date"})}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDatePicker,{selected:date,onChange:function(newDate){setDateString(newDate.format(time_format.a)),setIsValid(!0),onChange(newDate)},minDate:minDate,inline:!0,showTimeSelect:!0}))};function start_datafeed_modal_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class start_datafeed_modal_StartDatafeedModal extends external_kbnSharedDeps_React_.Component{constructor(props){super(props),start_datafeed_modal_defineProperty(this,"setStartTime",time=>{this.setState({startTime:time})}),start_datafeed_modal_defineProperty(this,"setEndTime",time=>{this.setState({endTime:time})}),start_datafeed_modal_defineProperty(this,"setCreateAlert",e=>{this.setState({createAlert:e.target.checked})}),start_datafeed_modal_defineProperty(this,"closeModal",()=>{this.setState({isModalVisible:!1})}),start_datafeed_modal_defineProperty(this,"setTimeRangeValid",timeRangeValid=>{this.setState({timeRangeValid:timeRangeValid})}),start_datafeed_modal_defineProperty(this,"showModal",(jobs,showCreateAlertFlyout)=>{const now=external_kbnSharedDeps_Moment_default()(),endTime=now,initialSpecifiedStartTime=function(jobs){const times=jobs.map(j=>j.earliestStartTimestampMs||0);return external_kbnSharedDeps_Moment_default()(Math.min(...times))}(jobs),allowCreateAlert=jobs.length>0;this.setState({jobs:jobs,isModalVisible:!0,startTime:void 0,endTime:endTime,initialSpecifiedStartTime:initialSpecifiedStartTime,showCreateAlertFlyout:showCreateAlertFlyout,allowCreateAlert:allowCreateAlert,createAlert:!1,now:now})}),start_datafeed_modal_defineProperty(this,"save",()=>{const{jobs:jobs}=this.state,start=external_kbnSharedDeps_Moment_default.a.isMoment(this.state.startTime)?this.state.startTime.valueOf():this.state.startTime,end=external_kbnSharedDeps_Moment_default.a.isMoment(this.state.endTime)?this.state.endTime.valueOf():this.state.endTime;!function(jobs,start,end,finish=(()=>{})){const datafeedIds=jobs.filter(j=>j.hasDatafeed).map(j=>j.datafeedId);job_service.a.forceStartDatafeeds(datafeedIds,start,end).then(resp=>{showResults(resp,states.a.STARTED),finish()}).catch(error=>{Object(dependency_cache.j)().addDanger(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.startJobErrorMessage",{defaultMessage:"Jobs failed to start"}),error),finish()})}(jobs,start,end,()=>{this.state.createAlert&&jobs.length>0&&this.getShowCreateAlertFlyoutFunction()(jobs.map(job=>job.id)),this.refreshJobs()}),this.closeModal()});const _now=external_kbnSharedDeps_Moment_default()();this.state={jobs:this.props.jobs,isModalVisible:!1,startTime:_now,endTime:_now,createAlert:!1,allowCreateAlert:!1,initialSpecifiedStartTime:_now,now:_now,timeRangeValid:!0},this.initialSpecifiedStartTime=_now,this.refreshJobs=this.props.refreshJobs,this.getShowCreateAlertFlyoutFunction=this.props.getShowCreateAlertFlyoutFunction}componentDidMount(){"function"==typeof this.props.setShowFunction&&this.props.setShowFunction(this.showModal)}componentWillUnmount(){"function"==typeof this.props.unsetShowFunction&&this.props.unsetShowFunction()}render(){const{jobs:jobs,initialSpecifiedStartTime:initialSpecifiedStartTime,startTime:startTime,endTime:endTime,createAlert:createAlert,now:now,timeRangeValid:timeRangeValid}=this.state,startableJobs=void 0!==jobs?jobs.filter(j=>j.hasDatafeed):[],startDisabled=!1===timeRangeValid||void 0!==startTime&&startTime===endTime;let modal;return this.state.isModalVisible&&(modal=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModal,{onClose:this.closeModal,style:{width:"850px"},maxWidth:!1,"data-test-subj":"mlStartDatafeedModal"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalHeader,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalHeaderTitle,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.startDatafeedModal.startJobsTitle",defaultMessage:"Start {jobsCount, plural, one {{jobId}} other {# jobs}}",values:{jobsCount:startableJobs.length,jobId:startableJobs[0].id}}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalBody,null,external_kbnSharedDeps_React_default.a.createElement(time_range_selector_TimeRangeSelector,{startTime:void 0===startTime?initialSpecifiedStartTime:startTime,endTime:endTime,setStartTime:this.setStartTime,setEndTime:this.setEndTime,now:now,setTimeRangeValid:this.setTimeRangeValid}),void 0===this.state.endTime&&external_kbnSharedDeps_React_default.a.createElement("div",{className:"create-watch"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHorizontalRule,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCheckbox,{id:"createAlert",label:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.startDatafeedModal.createAlertDescription",defaultMessage:"Create alert rule after datafeed has started"}),checked:createAlert,onChange:this.setCreateAlert}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalFooter,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{onClick:this.closeModal,"data-test-subj":"mlStartDatafeedModalCancelButton"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.startDatafeedModal.cancelButtonLabel",defaultMessage:"Cancel"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{onClick:this.save,isDisabled:startDisabled,fill:!0,"data-test-subj":"mlStartDatafeedModalStartButton"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.startDatafeedModal.startButtonLabel",defaultMessage:"Start"}))))),external_kbnSharedDeps_React_default.a.createElement("div",null,modal)}}function actions_menu_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class actions_menu_MultiJobActionsMenuUI extends external_kbnSharedDeps_React_.Component{constructor(props){super(props),actions_menu_defineProperty(this,"onButtonClick",()=>{this.setState(prevState=>({isOpen:!prevState.isOpen}))}),actions_menu_defineProperty(this,"closePopover",()=>{this.setState({isOpen:!1})}),this.state={isOpen:!1},this.canDeleteJob=Object(check_capabilities.e)("canDeleteJob"),this.canStartStopDatafeed=Object(check_capabilities.e)("canStartStopDatafeed")&&Object(check_ml_nodes.e)(),this.canCloseJob=Object(check_capabilities.e)("canCloseJob")&&Object(check_ml_nodes.e)(),this.canCreateMlAlerts=Object(check_capabilities.e)("canCreateMlAlerts")}render(){const anyJobsDeleting=this.props.jobs.some(j=>j.deleting),button=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{size:"s",onClick:this.onButtonClick,iconType:"gear","aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.multiJobActionsMenu.managementActionsAriaLabel",{defaultMessage:"Management actions"}),color:"text",disabled:anyJobsDeleting||!1===this.canDeleteJob&&!1===this.canStartStopDatafeed,"data-test-subj":"mlADJobListMultiSelectManagementActionsButton"}),items=[external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenuItem,{key:"delete",icon:"trash",disabled:!1===this.canDeleteJob,onClick:()=>{this.props.showDeleteJobModal(this.props.jobs),this.closePopover()},"data-test-subj":"mlADJobListMultiSelectDeleteJobActionButton"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.multiJobsActions.deleteJobsLabel",defaultMessage:"Delete {jobsCount, plural, one {job} other {jobs}}",values:{jobsCount:this.props.jobs.length}}))];return isClosable(this.props.jobs)&&items.push(external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenuItem,{key:"close job",icon:"cross",disabled:!1===this.canCloseJob,onClick:()=>{closeJobs(this.props.jobs),this.closePopover()},"data-test-subj":"mlADJobListMultiSelectCloseJobActionButton"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.multiJobsActions.closeJobsLabel",defaultMessage:"Close {jobsCount, plural, one {job} other {jobs}}",values:{jobsCount:this.props.jobs.length}}))),isStoppable(this.props.jobs)&&items.push(external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenuItem,{key:"stop datafeed",icon:"stop",disabled:!1===this.canStartStopDatafeed,onClick:()=>{stopDatafeeds(this.props.jobs,this.props.refreshJobs),this.closePopover()},"data-test-subj":"mlADJobListMultiSelectStopDatafeedActionButton"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.multiJobsActions.stopDatafeedsLabel",defaultMessage:"Stop {jobsCount, plural, one {datafeed} other {datafeeds}}",values:{jobsCount:this.props.jobs.length}}))),isStartable(this.props.jobs)&&items.push(external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenuItem,{key:"start datafeed",icon:"play",disabled:!1===this.canStartStopDatafeed,onClick:()=>{this.props.showStartDatafeedModal(this.props.jobs),this.closePopover()},"data-test-subj":"mlADJobListMultiSelectStartDatafeedActionButton"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.multiJobsActions.startDatafeedsLabel",defaultMessage:"Start {jobsCount, plural, one {datafeed} other {datafeeds}}",values:{jobsCount:this.props.jobs.length}}))),this.canCreateMlAlerts&&1===this.props.jobs.length&&items.push(external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenuItem,{key:"create alert",icon:"bell",disabled:!1,onClick:()=>{this.props.showCreateAlertFlyout(this.props.jobs.map(({id:id})=>id)),this.closePopover()},"data-test-subj":"mlADJobListMultiSelectCreateAlertActionButton"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.multiJobsActions.createAlertsLabel",defaultMessage:"Create alert rule"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopover,{button:button,isOpen:this.state.isOpen,closePopover:this.closePopover,panelPaddingSize:"none",anchorPosition:"downCenter"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenuPanel,{items:items.reverse()}))}}const MultiJobActionsMenu=actions_menu_MultiJobActionsMenuUI;function group_list_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function Check({group:group,selectedGroups:selectedGroups}){return void 0!==selectedGroups[group.id]?selectedGroups[group.id].partial?external_kbnSharedDeps_React_default.a.createElement("div",{className:"check selected"},external_kbnSharedDeps_React_default.a.createElement("span",null,"—")):external_kbnSharedDeps_React_default.a.createElement("div",{className:"check selected"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{type:"check"})):external_kbnSharedDeps_React_default.a.createElement("div",{className:"check"})}class group_list_GroupList extends external_kbnSharedDeps_React_.Component{constructor(props){super(props),group_list_defineProperty(this,"selectGroup",group=>{this.props.selectGroup(group)}),group_list_defineProperty(this,"moveUp",(event,index)=>{event.preventDefault(),index<0||index>0&&this.selectItems[index-1].focus()}),group_list_defineProperty(this,"moveDown",(event,index)=>{event.preventDefault(),index<this.selectItems.length-1&&this.selectItems[index+1].focus()}),group_list_defineProperty(this,"handleKeyDown",(event,group,index)=>{switch(event.key){case external_kbnSharedDeps_ElasticEui_.keys.ENTER:case external_kbnSharedDeps_ElasticEui_.keys.SPACE:this.selectGroup(group);break;case external_kbnSharedDeps_ElasticEui_.keys.ARROW_DOWN:this.moveDown(event,index);break;case external_kbnSharedDeps_ElasticEui_.keys.ARROW_UP:this.moveUp(event,index)}}),group_list_defineProperty(this,"setRef",(ref,index)=>{this.selectItems[index]=ref}),this.state={groups:[]},this.selectItems=[]}render(){const{selectedGroups:selectedGroups,groups:groups}=this.props;return external_kbnSharedDeps_React_default.a.createElement("div",{className:"group-list"},groups.map((g,index)=>external_kbnSharedDeps_React_default.a.createElement("div",{tabIndex:"0",onKeyDown:event=>this.handleKeyDown(event,g,index),key:g.id,className:"group-item",onClick:()=>this.selectGroup(g),ref:ref=>this.setRef(ref,index)},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(JobGroup,{name:g.id})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(Check,{group:g,selectedGroups:selectedGroups}))))))}}function new_group_input_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class new_group_input_NewGroupInput extends external_kbnSharedDeps_React_.Component{constructor(props){super(props),new_group_input_defineProperty(this,"changeTempNewGroup",e=>{const tempNewGroupName=e.target.value;let groupsValidationError="";groupsValidationError=""===tempNewGroupName?"":this.props.allJobIds.includes(tempNewGroupName)?external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.multiJobActions.groupSelector.groupsAndJobsCanNotUseSameIdErrorMessage",{defaultMessage:"A job with this ID already exists. Groups and jobs cannot use the same ID."}):validateGroupNames([tempNewGroupName]).message,this.setState({tempNewGroupName:tempNewGroupName,groupsValidationError:groupsValidationError})}),new_group_input_defineProperty(this,"newGroupKeyPress",e=>{e.key===external_kbnSharedDeps_ElasticEui_.keys.ENTER&&""===this.state.groupsValidationError&&""!==this.state.tempNewGroupName&&this.addNewGroup()}),new_group_input_defineProperty(this,"addNewGroup",()=>{this.props.addNewGroup(this.state.tempNewGroupName),this.setState({tempNewGroupName:""})}),this.state={tempNewGroupName:"",groupsValidationError:""}}render(){const{tempNewGroupName:tempNewGroupName,groupsValidationError:groupsValidationError}=this.state;return external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{display:"rowCompressed",isInvalid:""!==groupsValidationError,error:groupsValidationError,className:"new-group-input"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldText,{compressed:!0,placeholder:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.multiJobActions.groupSelector.addNewGroupPlaceholder",{defaultMessage:"Add new group"}),value:tempNewGroupName,onChange:this.changeTempNewGroup,onKeyDown:this.newGroupKeyPress,isInvalid:""!==groupsValidationError,error:groupsValidationError}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{className:"new-group-input"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{onClick:this.addNewGroup,iconType:"plusInCircle","aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.multiJobActions.groupSelector.addButtonAriaLabel",{defaultMessage:"Add"}),disabled:""===tempNewGroupName||""!==groupsValidationError})))))}}function group_selector_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function createSelectedGroups(jobs,groups){const jobIds=jobs.map(j=>j.id),groupCounts={};jobs.forEach(j=>{j.groups.forEach(g=>{void 0===groupCounts[g]&&(groupCounts[g]=0),groupCounts[g]++})});return groups.reduce((p,c)=>(c.jobIds.some(j=>jobIds.includes(j))&&(p[c.id]={partial:groupCounts[c.id]!==jobIds.length}),p),{})}class group_selector_GroupSelector extends external_kbnSharedDeps_React_.Component{constructor(props){super(props),group_selector_defineProperty(this,"togglePopover",()=>{this.state.isPopoverOpen?this.closePopover():ml_api_service.ml.jobs.groups().then(groups=>{const selectedGroups=createSelectedGroups(this.props.jobs,groups);this.setState({isPopoverOpen:!0,edited:!1,selectedGroups:selectedGroups,groups:groups})}).catch(error=>{console.error(error)})}),group_selector_defineProperty(this,"closePopover",()=>{this.setState({edited:!1,isPopoverOpen:!1})}),group_selector_defineProperty(this,"selectGroup",group=>{const newSelectedGroups=Object(external_kbnSharedDeps_Lodash_.cloneDeep)(this.state.selectedGroups);void 0===newSelectedGroups[group.id]?newSelectedGroups[group.id]={partial:!1}:!0===newSelectedGroups[group.id].partial?newSelectedGroups[group.id].partial=!1:delete newSelectedGroups[group.id],this.setState({selectedGroups:newSelectedGroups,edited:!0})}),group_selector_defineProperty(this,"applyChanges",()=>{const{selectedGroups:selectedGroups}=this.state,{jobs:jobs}=this.props,newJobs=jobs.map(j=>({id:j.id,oldGroups:j.groups,newGroups:[]}));for(const gId in selectedGroups)if(selectedGroups.hasOwnProperty(gId)){const group=selectedGroups[gId];newJobs.forEach(j=>{(!1===group.partial||!0===group.partial&&j.oldGroups.includes(gId))&&j.newGroups.push(gId)})}const tempJobs=newJobs.map(j=>({job_id:j.id,groups:j.newGroups}));ml_api_service.ml.jobs.updateGroups(tempJobs).then(resp=>{let success=!0;for(const jobId in resp)resp.hasOwnProperty(jobId)&&!1===resp[jobId].success&&(Object(toast_notification_service.a)().displayErrorToast(resp[jobId].error),success=!1);success?(this.refreshJobs(),this.closePopover()):console.error(resp)}).catch(error=>{Object(toast_notification_service.a)().displayErrorToast(error),console.error(error)})}),group_selector_defineProperty(this,"addNewGroup",id=>{const newGroup={id:id,calendarIds:[],jobIds:[]},groups=this.state.groups;!1===groups.some(g=>g.id===newGroup.id)&&groups.push(newGroup),this.setState({groups:groups})}),this.state={isPopoverOpen:!1,groups:[],selectedGroups:{},edited:!1},this.refreshJobs=this.props.refreshJobs,this.canUpdateJob=Object(check_capabilities.e)("canUpdateJob")}static getDerivedStateFromProps(props,state){if(!1===state.edited){return{selectedGroups:createSelectedGroups(props.jobs,state.groups)}}return{}}render(){const{groups:groups,selectedGroups:selectedGroups,edited:edited}=this.state,button=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{position:"bottom",content:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.multiJobActions.groupSelector.editJobGroupsButtonTooltip",defaultMessage:"Edit job groups"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{iconType:"indexEdit","aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.multiJobActions.groupSelector.editJobGroupsButtonAriaLabel",{defaultMessage:"Edit job groups"}),onClick:()=>this.togglePopover(),disabled:!1===this.canUpdateJob,"data-test-subj":"mlADJobListMultiSelectEditJobGroupsButton"}));return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopover,{id:"trapFocus",ownFocus:!0,button:button,isOpen:this.state.isPopoverOpen,closePopover:()=>this.closePopover()},external_kbnSharedDeps_React_default.a.createElement("div",{className:"group-selector"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopoverTitle,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.multiJobActions.groupSelector.applyGroupsToJobTitle",defaultMessage:"Apply groups to {jobsCount, plural, one {job} other {jobs}}",values:{jobsCount:this.props.jobs.length}})),external_kbnSharedDeps_React_default.a.createElement(group_list_GroupList,{groups:groups,selectedGroups:selectedGroups,selectGroup:this.selectGroup}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHorizontalRule,{margin:"xs"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(new_group_input_NewGroupInput,{addNewGroup:this.addNewGroup,allJobIds:this.props.allJobIds}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHorizontalRule,{margin:"m"}),external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{size:"s",onClick:this.applyChanges,isDisabled:!1===edited},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.multiJobActions.groupSelector.applyButtonLabel",defaultMessage:"Apply"})))))))}}class multi_job_actions_MultiJobActions extends external_kbnSharedDeps_React_.Component{constructor(props){super(props),this.state={}}render(){const jobsSelected=this.props.selectedJobs.length>0;return external_kbnSharedDeps_React_default.a.createElement("div",{className:"multi-select-actions"+(jobsSelected?"":"-no-display"),"data-test-subj":"mlADJobListMultiSelectActionsArea "+(jobsSelected?"active":"inactive")},jobsSelected&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"xs",alignItems:"center",wrap:!1,direction:"row",responsive:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"s"},external_kbnSharedDeps_React_default.a.createElement("h3",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.multiJobsActions.jobsSelectedLabel",defaultMessage:"{selectedJobsCount, plural, one {# job} other {# jobs}}   selected",values:{selectedJobsCount:this.props.selectedJobs.length}})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement("div",{className:"actions-border-large"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(ResultLinks,{jobs:this.props.selectedJobs})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(group_selector_GroupSelector,{jobs:this.props.selectedJobs,allJobIds:this.props.allJobIds,refreshJobs:this.props.refreshJobs})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(MultiJobActionsMenu,{jobs:this.props.selectedJobs,showStartDatafeedModal:this.props.showStartDatafeedModal,showDeleteJobModal:this.props.showDeleteJobModal,refreshJobs:this.props.refreshJobs,showCreateAlertFlyout:this.props.showCreateAlertFlyout}))))}}var use_create_url=__webpack_require__(92);function NewJobButton(){const buttonEnabled=Object(check_capabilities.e)("canCreateJob")&&Object(check_ml_nodes.e)(),newJob=Object(use_create_url.a)(ml_url_generator.b.ANOMALY_DETECTION_CREATE_JOB_SELECT_INDEX);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{"data-test-subj":"mlCreateNewJobButton",onClick:newJob,size:"s",disabled:!1===buttonEnabled,fill:!0,iconType:"plusInCircle"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.createNewJobButtonLabel",defaultMessage:"Create job"}))}var stats_bar=__webpack_require__(183);const JobStatsBar=({jobsSummaryList:jobsSummaryList})=>{const jobStats=function(jobsSummaryList){const jobStats={activeNodes:{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.statsBar.activeMLNodesLabel",{defaultMessage:"Active ML nodes"}),value:0,show:!0},total:{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.statsBar.totalJobsLabel",{defaultMessage:"Total jobs"}),value:0,show:!0},open:{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.statsBar.openJobsLabel",{defaultMessage:"Open jobs"}),value:0,show:!0},closed:{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.statsBar.closedJobsLabel",{defaultMessage:"Closed jobs"}),value:0,show:!0},failed:{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.statsBar.failedJobsLabel",{defaultMessage:"Failed jobs"}),value:0,show:!1},activeDatafeeds:{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.statsBar.activeDatafeedsLabel",{defaultMessage:"Active datafeeds"}),value:0,show:!0}};if(void 0===jobsSummaryList)return jobStats;const mlNodes={};let failedJobs=0;return jobsSummaryList.forEach(job=>{job.jobState===states.c.OPENED?jobStats.open.value++:job.jobState===states.c.CLOSED?jobStats.closed.value++:job.jobState===states.c.FAILED&&failedJobs++,job.hasDatafeed&&job.datafeedState===states.a.STARTED&&jobStats.activeDatafeeds.value++,void 0!==job.nodeName&&(mlNodes[job.nodeName]={})}),jobStats.total.value=jobsSummaryList.length,failedJobs?(jobStats.failed.value=failedJobs,jobStats.failed.show=!0):jobStats.failed.show=!1,jobStats.activeNodes.value=Object.keys(mlNodes).length,jobStats}(jobsSummaryList);return external_kbnSharedDeps_React_default.a.createElement(stats_bar.a,{stats:jobStats,dataTestSub:"mlJobStatsBar"})};var node_available_warning=__webpack_require__(291),jobs_awaiting_node_warning=__webpack_require__(162),saved_objects_warning=__webpack_require__(292),date_picker_wrapper=__webpack_require__(184),upgrade=__webpack_require__(293);const RefreshJobsListButton=({onRefreshClick:onRefreshClick,isRefreshing:isRefreshing})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{"data-test-subj":"mlRefreshJobListButton"+(isRefreshing?" loading":" loaded"),onClick:onRefreshClick,isLoading:isRefreshing},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.refreshButtonLabel",defaultMessage:"Refresh"}));function jobs_list_view_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}let deletingJobsRefreshTimeout=null;class jobs_list_view_JobsListView extends external_kbnSharedDeps_React_.Component{constructor(props){super(props),jobs_list_view_defineProperty(this,"toggleRow",jobId=>{if(this.state.itemIdToExpandedRowMap[jobId]){const itemIdToExpandedRowMap={...this.state.itemIdToExpandedRowMap};delete itemIdToExpandedRowMap[jobId],this.setState({itemIdToExpandedRowMap:itemIdToExpandedRowMap})}else{let itemIdToExpandedRowMap={...this.state.itemIdToExpandedRowMap};void 0!==this.state.fullJobsList[jobId]?itemIdToExpandedRowMap[jobId]=external_kbnSharedDeps_React_default.a.createElement(job_details_JobDetails,{jobId:jobId,job:this.state.fullJobsList[jobId],addYourself:this.addUpdateFunction,removeYourself:this.removeUpdateFunction,showFullDetails:!0!==this.props.isManagementTable,refreshJobList:this.onRefreshClick}):itemIdToExpandedRowMap[jobId]=external_kbnSharedDeps_React_default.a.createElement(job_details_JobDetails,{jobId:jobId,addYourself:this.addUpdateFunction,removeYourself:this.removeUpdateFunction,showFullDetails:!0!==this.props.isManagementTable,refreshJobList:this.onRefreshClick}),this.setState({itemIdToExpandedRowMap:itemIdToExpandedRowMap},()=>{loadFullJob(jobId).then(job=>{const fullJobsList={...this.state.fullJobsList};fullJobsList[jobId]=job,this.setState({fullJobsList:fullJobsList},()=>{itemIdToExpandedRowMap={...this.state.itemIdToExpandedRowMap},void 0!==itemIdToExpandedRowMap[jobId]&&(itemIdToExpandedRowMap[jobId]=external_kbnSharedDeps_React_default.a.createElement(job_details_JobDetails,{jobId:jobId,job:job,addYourself:this.addUpdateFunction,removeYourself:this.removeUpdateFunction,showFullDetails:!0!==this.props.isManagementTable,refreshJobList:this.onRefreshClick})),this.setState({itemIdToExpandedRowMap:itemIdToExpandedRowMap},()=>{this.updateFunctions[jobId](job)})})}).catch(error=>{console.error(error)})})}}),jobs_list_view_defineProperty(this,"addUpdateFunction",(id,f)=>{this.updateFunctions[id]=f}),jobs_list_view_defineProperty(this,"removeUpdateFunction",id=>{delete this.updateFunctions[id]}),jobs_list_view_defineProperty(this,"setShowEditJobFlyoutFunction",func=>{this.showEditJobFlyout=func}),jobs_list_view_defineProperty(this,"unsetShowEditJobFlyoutFunction",()=>{this.showEditJobFlyout=()=>{}}),jobs_list_view_defineProperty(this,"setShowDeleteJobModalFunction",func=>{this.showDeleteJobModal=func}),jobs_list_view_defineProperty(this,"unsetShowDeleteJobModalFunction",()=>{this.showDeleteJobModal=()=>{}}),jobs_list_view_defineProperty(this,"setShowStartDatafeedModalFunction",func=>{this.showStartDatafeedModal=func}),jobs_list_view_defineProperty(this,"unsetShowStartDatafeedModalFunction",()=>{this.showStartDatafeedModal=()=>{}}),jobs_list_view_defineProperty(this,"setShowCreateAlertFlyoutFunction",func=>{this.showCreateAlertFlyout=func}),jobs_list_view_defineProperty(this,"unsetShowCreateAlertFlyoutFunction",()=>{this.showCreateAlertFlyout=()=>{}}),jobs_list_view_defineProperty(this,"getShowCreateAlertFlyoutFunction",()=>this.showCreateAlertFlyout),jobs_list_view_defineProperty(this,"selectJobChange",selectedJobs=>{this.setState({selectedJobs:selectedJobs})}),jobs_list_view_defineProperty(this,"setFilters",query=>{const filterClauses=query&&query.ast&&query.ast.clauses||[],filteredJobsSummaryList=filterJobs(this.state.jobsSummaryList,filterClauses);this.props.onJobsViewStateUpdate({queryText:null==query?void 0:query.text},!1===this._isFiltersSet),this._isFiltersSet=!0,this.setState({filteredJobsSummaryList:filteredJobsSummaryList,filterClauses:filterClauses},()=>{this.refreshSelectedJobs()})}),jobs_list_view_defineProperty(this,"onRefreshClick",()=>{this.setState({isRefreshing:!0}),this.refreshJobSummaryList(!0)}),jobs_list_view_defineProperty(this,"isDoneRefreshing",()=>{this.setState({isRefreshing:!1})}),this.state={isRefreshing:!1,loading:null,jobsSummaryList:[],filteredJobsSummaryList:[],fullJobsList:{},selectedJobs:[],itemIdToExpandedRowMap:{},filterClauses:[],deletingJobIds:[],jobsAwaitingNodeCount:0},this.updateFunctions={},this.showEditJobFlyout=()=>{},this.showDeleteJobModal=()=>{},this.showStartDatafeedModal=()=>{},this.showCreateAlertFlyout=()=>{},this._isMounted=!1,this._isFiltersSet=!1}componentDidMount(){this._isMounted=!0,this.refreshJobSummaryList(!0),!0!==this.props.isManagementTable&&this.openAutoStartDatafeedModal()}componentDidUpdate(prevProps){prevProps.lastRefresh!==this.props.lastRefresh&&this.refreshJobSummaryList()}componentWillUnmount(){void 0===this.props.isManagementTable&&(deletingJobsRefreshTimeout=null),this._isMounted=!1}openAutoStartDatafeedModal(){const job=function(){const job=job_service.a.tempJobCloningObjects.job,datafeed=job_service.a.tempJobCloningObjects.datafeed;if(void 0!==job){job_service.a.tempJobCloningObjects.job=void 0,job_service.a.tempJobCloningObjects.datafeed=void 0,job_service.a.tempJobCloningObjects.createdBy=void 0;const hasDatafeed=Object(object_utils.b)(datafeed),datafeedId=hasDatafeed?datafeed.datafeed_id:"";return{id:job.job_id,hasDatafeed:hasDatafeed,latestTimestampSortValue:0,datafeedId:datafeedId}}}();void 0!==job&&this.showStartDatafeedModal([job])}refreshSelectedJobs(){const selectedJobsIds=this.state.selectedJobs.map(j=>j.id),filteredJobIds=this.state.filteredJobsSummaryList.map(j=>j.id),selectedJobs=this.state.jobsSummaryList.filter(j=>selectedJobsIds.find(id=>id===j.id)).filter(j=>filteredJobIds.find(id=>id===j.id));this.setState({selectedJobs:selectedJobs})}async refreshJobSummaryList(forceRefresh=!1){if(this._isMounted&&(!0===forceRefresh||!0!==this.props.blockRefresh)){null===this.state.loading&&this.setState({loading:!0});const expandedJobsIds=Object.keys(this.state.itemIdToExpandedRowMap);try{let jobsSpaces={};if(this.props.spacesApi&&this.props.isManagementTable){const allSpaces=await ml_api_service.ml.savedObjects.jobsSpaces();jobsSpaces=allSpaces["anomaly-detector"]}let jobsAwaitingNodeCount=0;const jobs=await ml_api_service.ml.jobs.jobsSummary(expandedJobsIds),fullJobsList={},jobsSummaryList=jobs.map(job=>(void 0!==job.fullJob&&(fullJobsList[job.id]=job.fullJob,delete job.fullJob),job.latestTimestampSortValue=job.latestTimestampMs||0,job.spaceIds=this.props.spacesApi&&this.props.isManagementTable&&jobsSpaces&&void 0!==jobsSpaces[job.id]?jobsSpaces[job.id]:[],!0===job.awaitingNodeAssignment&&jobsAwaitingNodeCount++,job)),filteredJobsSummaryList=filterJobs(jobsSummaryList,this.state.filterClauses);this.setState({jobsSummaryList:jobsSummaryList,filteredJobsSummaryList:filteredJobsSummaryList,fullJobsList:fullJobsList,loading:!1,jobsAwaitingNodeCount:jobsAwaitingNodeCount},()=>{this.refreshSelectedJobs()}),Object.keys(this.updateFunctions).forEach(j=>{this.updateFunctions[j](fullJobsList[j])}),jobs.forEach(job=>{job.deleting&&this.state.itemIdToExpandedRowMap[job.id]&&this.toggleRow(job.id)}),this.isDoneRefreshing(),jobsSummaryList.some(j=>!0===j.deleting)&&this.checkDeletingJobTasks(forceRefresh)}catch(error){console.error(error),this.setState({loading:!1})}}}async checkDeletingJobTasks(forceRefresh=!1){if(!1===this._isMounted)return;const{jobIds:taskJobIds}=await ml_api_service.ml.jobs.deletingJobTasks(),taskListHasChanged=!1===Object(external_kbnSharedDeps_Lodash_.isEqual)(taskJobIds.sort(),this.state.deletingJobIds.sort());this.setState({deletingJobIds:taskJobIds}),(taskListHasChanged||forceRefresh)&&this.refreshJobSummaryList(),taskJobIds.length>0&&null===deletingJobsRefreshTimeout&&(deletingJobsRefreshTimeout=setTimeout(()=>{deletingJobsRefreshTimeout=null,this.checkDeletingJobTasks()},jobs_list.b))}renderManagementJobsListComponents(){const{isRefreshing:isRefreshing,loading:loading,itemIdToExpandedRowMap:itemIdToExpandedRowMap,jobsSummaryList:jobsSummaryList,filteredJobsSummaryList:filteredJobsSummaryList,fullJobsList:fullJobsList,selectedJobs:selectedJobs}=this.state;return external_kbnSharedDeps_React_default.a.createElement("div",{className:"job-management","data-test-subj":"ml-jobs-list"},external_kbnSharedDeps_React_default.a.createElement(node_available_warning.a,null),external_kbnSharedDeps_React_default.a.createElement(upgrade.a,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(JobStatsBar,{jobsSummaryList:jobsSummaryList})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(RefreshJobsListButton,{onRefreshClick:this.onRefreshClick,isRefreshing:isRefreshing}))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement("div",{className:"managementJobsList"},external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(JobFilterBar,{setFilters:this.setFilters,queryText:this.props.jobsViewState.queryText})),external_kbnSharedDeps_React_default.a.createElement(jobs_list_JobsList,{jobsSummaryList:filteredJobsSummaryList,fullJobsList:fullJobsList,itemIdToExpandedRowMap:itemIdToExpandedRowMap,toggleRow:this.toggleRow,selectJobChange:this.selectJobChange,selectedJobsCount:selectedJobs.length,loading:loading,isManagementTable:!0,isMlEnabledInSpace:this.props.isMlEnabledInSpace,spacesApi:this.props.spacesApi,jobsViewState:this.props.jobsViewState,onJobsViewStateUpdate:this.props.onJobsViewStateUpdate,refreshJobs:()=>this.refreshJobSummaryList(!0)})))}renderJobsListComponents(){const{isRefreshing:isRefreshing,loading:loading,jobsSummaryList:jobsSummaryList,jobsAwaitingNodeCount:jobsAwaitingNodeCount}=this.state,jobIds=jobsSummaryList.map(j=>j.id);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPage,{"data-test-subj":"ml-jobs-list"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageBody,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageHeader,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageHeaderSection,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,null,external_kbnSharedDeps_React_default.a.createElement("h1",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.jobsList.title",defaultMessage:"Anomaly detection jobs"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageHeaderSection,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(RefreshJobsListButton,{onRefreshClick:this.onRefreshClick,isRefreshing:isRefreshing})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(date_picker_wrapper.a,null))))),external_kbnSharedDeps_React_default.a.createElement(node_available_warning.a,null),external_kbnSharedDeps_React_default.a.createElement(jobs_awaiting_node_warning.a,{jobCount:jobsAwaitingNodeCount}),external_kbnSharedDeps_React_default.a.createElement(saved_objects_warning.a,{jobType:"anomaly-detector"}),external_kbnSharedDeps_React_default.a.createElement(upgrade.a,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageContent,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(JobStatsBar,{jobsSummaryList:jobsSummaryList})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(NewJobButton,null))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement("div",{className:"actions-bar"},external_kbnSharedDeps_React_default.a.createElement(multi_job_actions_MultiJobActions,{selectedJobs:this.state.selectedJobs,allJobIds:jobIds,showStartDatafeedModal:this.showStartDatafeedModal,showDeleteJobModal:this.showDeleteJobModal,showCreateAlertFlyout:this.showCreateAlertFlyout,refreshJobs:()=>this.refreshJobSummaryList(!0)}),external_kbnSharedDeps_React_default.a.createElement(JobFilterBar,{setFilters:this.setFilters,queryText:this.props.jobsViewState.queryText})),external_kbnSharedDeps_React_default.a.createElement(jobs_list_JobsList,{jobsSummaryList:this.state.filteredJobsSummaryList,fullJobsList:this.state.fullJobsList,itemIdToExpandedRowMap:this.state.itemIdToExpandedRowMap,toggleRow:this.toggleRow,selectJobChange:this.selectJobChange,showEditJobFlyout:this.showEditJobFlyout,showDeleteJobModal:this.showDeleteJobModal,showStartDatafeedModal:this.showStartDatafeedModal,refreshJobs:()=>this.refreshJobSummaryList(!0),jobsViewState:this.props.jobsViewState,onJobsViewStateUpdate:this.props.onJobsViewStateUpdate,selectedJobsCount:this.state.selectedJobs.length,showCreateAlertFlyout:this.showCreateAlertFlyout,loading:loading}),external_kbnSharedDeps_React_default.a.createElement(EditJobFlyout,{setShowFunction:this.setShowEditJobFlyoutFunction,unsetShowFunction:this.unsetShowEditJobFlyoutFunction,refreshJobs:()=>this.refreshJobSummaryList(!0),allJobIds:jobIds}),external_kbnSharedDeps_React_default.a.createElement(DeleteJobModal,{setShowFunction:this.setShowDeleteJobModalFunction,unsetShowFunction:this.unsetShowDeleteJobModalFunction,refreshJobs:()=>this.refreshJobSummaryList(!0)}),external_kbnSharedDeps_React_default.a.createElement(start_datafeed_modal_StartDatafeedModal,{setShowFunction:this.setShowStartDatafeedModalFunction,unsetShowFunction:this.unsetShowDeleteJobModalFunction,getShowCreateAlertFlyoutFunction:this.getShowCreateAlertFlyoutFunction,refreshJobs:()=>this.refreshJobSummaryList(!0)}),external_kbnSharedDeps_React_default.a.createElement(ml_alerting_flyout.b,{setShowFunction:this.setShowCreateAlertFlyoutFunction,unsetShowFunction:this.unsetShowCreateAlertFlyoutFunction,onSave:this.onRefreshClick})))))}render(){const{isManagementTable:isManagementTable}=this.props;return external_kbnSharedDeps_React_default.a.createElement("div",null,isManagementTable?this.renderManagementJobsListComponents():this.renderJobsListComponents())}}},,function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return DataFrameAnalyticsList}));var external_kbnSharedDeps_React_=__webpack_require__(14),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),external_kbnSharedDeps_KbnI18n_=__webpack_require__(2),external_kbnSharedDeps_ElasticEui_=__webpack_require__(39),data_frame_analytics=__webpack_require__(79),common=__webpack_require__(71),check_capabilities=__webpack_require__(68),analytics_list_common=__webpack_require__(93),analytics_service=__webpack_require__(182),use_columns=__webpack_require__(283),expanded_row=__webpack_require__(413),stats_bar=__webpack_require__(183);const CreateAnalyticsButton=({isDisabled:isDisabled,setIsSourceIndexModalVisible:setIsSourceIndexModalVisible})=>{const button=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{disabled:isDisabled,fill:!0,onClick:()=>{setIsSourceIndexModalVisible(!0)},iconType:"plusInCircle",size:"s","data-test-subj":"mlAnalyticsButtonCreate"},external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.createDataFrameAnalyticsButton",{defaultMessage:"Create job"}));return isDisabled?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{position:"top",content:Object(check_capabilities.f)("canCreateDataFrameAnalytics")},button):button};var source_selection=__webpack_require__(417),string_utils=__webpack_require__(89);const AnalyticsEmptyPrompt=({disabled:disabled,isManagementTable:isManagementTable,onCreateFirstJobClick:onCreateFirstJobClick})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiEmptyPrompt,{iconType:"createAdvancedJob",title:external_kbnSharedDeps_React_default.a.createElement("h2",null,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataFrame.analyticsList.emptyPromptTitle",{defaultMessage:"Create your first data frame analytics job"})),actions:isManagementTable?[]:[external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{onClick:onCreateFirstJobClick,isDisabled:disabled,color:"primary",iconType:"plusInCircle",fill:!0,"data-test-subj":"mlAnalyticsCreateFirstButton"},external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataFrame.analyticsList.emptyPromptButtonText",{defaultMessage:"Create job"}))],"data-test-subj":"mlNoDataFrameAnalyticsFound"});var use_table_settings=__webpack_require__(248),refresh_analytics_list_button=__webpack_require__(416),jobs_awaiting_node_warning=__webpack_require__(162);const filters=[{type:"field_value_selection",field:"job_type",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.typeFilter",{defaultMessage:"Type"}),multiSelect:"or",options:Object.values(data_frame_analytics.a).map(val=>({value:val,name:val,view:Object(use_columns.a)(val)}))},{type:"field_value_selection",field:"state",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.statusFilter",{defaultMessage:"Status"}),multiSelect:"or",options:Object.values(analytics_list_common.b).map(val=>({value:val,name:val,view:Object(use_columns.b)(val)}))}];const DataFrameAnalyticsList=({isManagementTable:isManagementTable=!1,isMlEnabledInSpace:isMlEnabledInSpace=!0,spacesApi:spacesApi,blockRefresh:blockRefresh=!1,pageState:pageState,updatePageState:updatePageState})=>{var _pageState$queryText;const searchQueryText=null!==(_pageState$queryText=pageState.queryText)&&void 0!==_pageState$queryText?_pageState$queryText:"",setSearchQueryText=Object(external_kbnSharedDeps_React_.useCallback)(value=>{updatePageState({queryText:value})},[updatePageState]),[isInitialized,setIsInitialized]=Object(external_kbnSharedDeps_React_.useState)(!1),[isSourceIndexModalVisible,setIsSourceIndexModalVisible]=Object(external_kbnSharedDeps_React_.useState)(!1),[isLoading,setIsLoading]=Object(external_kbnSharedDeps_React_.useState)(!1),[filteredAnalytics,setFilteredAnalytics]=Object(external_kbnSharedDeps_React_.useState)([]),[searchError,setSearchError]=Object(external_kbnSharedDeps_React_.useState)(),[analytics,setAnalytics]=Object(external_kbnSharedDeps_React_.useState)([]),[analyticsStats,setAnalyticsStats]=Object(external_kbnSharedDeps_React_.useState)(void 0),[expandedRowItemIds,setExpandedRowItemIds]=Object(external_kbnSharedDeps_React_.useState)([]),[errorMessage,setErrorMessage]=Object(external_kbnSharedDeps_React_.useState)(void 0),[jobsAwaitingNodeCount,setJobsAwaitingNodeCount]=Object(external_kbnSharedDeps_React_.useState)(0),disabled=!Object(check_capabilities.e)("canCreateDataFrameAnalytics")||!Object(check_capabilities.e)("canStartStopDataFrameAnalytics"),getAnalytics=Object(analytics_service.d)(setAnalytics,setAnalyticsStats,setErrorMessage,setIsInitialized,setJobsAwaitingNodeCount,blockRefresh,isManagementTable),updateFilteredItems=Object(external_kbnSharedDeps_React_.useCallback)(queryClauses=>{if(queryClauses.length){const filtered=function(items,clauses){if(0===clauses.length)return items;const matches=items.reduce((p,c)=>(p[c.id]={job:c,count:0},p),{});return clauses.forEach(c=>{const bool="must"===c.match;let js=[];js="term"===c.type?!0===bool?items.filter(item=>{var _item$stats,_item$stats$memory_us;return Object(string_utils.f)(item.id,c.value)===bool||Object(string_utils.f)(item.config.description,c.value)===bool||Object(string_utils.f)(null===(_item$stats=item.stats)||void 0===_item$stats||null===(_item$stats$memory_us=_item$stats.memory_usage)||void 0===_item$stats$memory_us?void 0:_item$stats$memory_us.status,c.value)===bool}):items.filter(item=>{var _item$stats2,_item$stats2$memory_u;return Object(string_utils.f)(item.id,c.value)===bool&&Object(string_utils.f)(item.config.description,c.value)===bool&&Object(string_utils.f)(null===(_item$stats2=item.stats)||void 0===_item$stats2||null===(_item$stats2$memory_u=_item$stats2.memory_usage)||void 0===_item$stats2$memory_u?void 0:_item$stats2$memory_u.status,c.value)===bool}):Array.isArray(c.value)?items.filter(item=>c.value.includes(item[c.field])):items.filter(item=>item[c.field]===c.value),js.forEach(j=>matches[j.id].count++)}),Object.values(matches).filter(m=>(m&&m.count)>=clauses.length).map(m=>m.job)}(analytics,queryClauses);setFilteredAnalytics(filtered)}else setFilteredAnalytics(analytics)},[analytics]);Object(external_kbnSharedDeps_React_.useEffect)(()=>{(()=>{if(""!==searchQueryText){const query=external_kbnSharedDeps_ElasticEui_.EuiSearchBar.Query.parse(searchQueryText);let clauses=[];query&&void 0!==query.ast&&void 0!==query.ast.clauses&&(clauses=query.ast.clauses),updateFilteredItems(clauses)}else updateFilteredItems([])})()},[searchQueryText]);const getAnalyticsCallback=Object(external_kbnSharedDeps_React_.useCallback)(()=>getAnalytics(!0),[]),{refresh:refresh}=Object(common.I)({isLoading:setIsLoading,onRefresh:getAnalyticsCallback},isManagementTable),{columns:columns,modals:modals}=Object(use_columns.d)(expandedRowItemIds,setExpandedRowItemIds,isManagementTable,isMlEnabledInSpace,spacesApi,refresh),{onTableChange:onTableChange,pagination:pagination,sorting:sorting}=Object(use_table_settings.a)(filteredAnalytics,pageState,updatePageState);if(!isInitialized)return null;if(void 0!==errorMessage)return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataFrame.analyticsList.errorPromptTitle",{defaultMessage:"An error occurred getting the data frame analytics list."}),color:"danger",iconType:"alert"},external_kbnSharedDeps_React_default.a.createElement("pre",null,JSON.stringify(errorMessage)));if(0===analytics.length)return external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":"mlAnalyticsJobList"},external_kbnSharedDeps_React_default.a.createElement(AnalyticsEmptyPrompt,{isManagementTable:isManagementTable,disabled:disabled,onCreateFirstJobClick:()=>setIsSourceIndexModalVisible(!0)}),!0===isSourceIndexModalVisible&&external_kbnSharedDeps_React_default.a.createElement(source_selection.a,{onClose:()=>setIsSourceIndexModalVisible(!1)}));const itemIdToExpandedRowMap=(dataFrameAnalytics=analytics,expandedRowItemIds.reduce((m,analyticsId)=>{const item=dataFrameAnalytics.find(analytics=>analytics.config.id===analyticsId);return void 0!==item&&(m[analyticsId]=external_kbnSharedDeps_React_default.a.createElement(expanded_row.a,{item:item})),m},{}));var dataFrameAnalytics;const stats=analyticsStats&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(stats_bar.a,{stats:analyticsStats,dataTestSub:"mlAnalyticsStatsBar"})),managementStats=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceBetween"},stats,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(refresh_analytics_list_button.a,null)))),search={query:searchQueryText,onChange:search=>{null===search.error?(setSearchError(void 0),setSearchQueryText(search.queryText)):setSearchError(search.error.message)},box:{incremental:!0},filters:filters};return external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":"mlAnalyticsJobList"},modals,!isManagementTable&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(jobs_awaiting_node_warning.a,{jobCount:jobsAwaitingNodeCount}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceBetween"},!isManagementTable&&stats,isManagementTable&&managementStats,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},!isManagementTable&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(CreateAnalyticsButton,{isDisabled:disabled,setIsSourceIndexModalVisible:setIsSourceIndexModalVisible}))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":"mlAnalyticsTableContainer"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiInMemoryTable,{allowNeutralSort:!1,columns:columns,hasActions:!1,isExpandable:!0,itemIdToExpandedRowMap:itemIdToExpandedRowMap,isSelectable:!1,items:analytics,itemId:analytics_list_common.c.id,loading:isLoading,onTableChange:onTableChange,pagination:pagination,sorting:sorting,search:search,"data-test-subj":isLoading?"mlAnalyticsTable loading":"mlAnalyticsTable loaded",rowProps:item=>({"data-test-subj":"mlAnalyticsTableRow row-"+item.id}),error:searchError})),!0===isSourceIndexModalVisible&&external_kbnSharedDeps_React_default.a.createElement(source_selection.a,{onClose:()=>setIsSourceIndexModalVisible(!1)}))}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return ExpandedRow}));var external_kbnSharedDeps_React_=__webpack_require__(14),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),external_kbnSharedDeps_MomentTimezone_=__webpack_require__(48),external_kbnSharedDeps_MomentTimezone_default=__webpack_require__.n(external_kbnSharedDeps_MomentTimezone_),external_kbnSharedDeps_ElasticEui_=__webpack_require__(39),external_kbnSharedDeps_KbnI18n_=__webpack_require__(2),date_utils=__webpack_require__(72);__webpack_require__(495);const Section=({section:section})=>{if(0===section.items.length)return null;const columns=[{field:"title",name:"",render:v=>external_kbnSharedDeps_React_default.a.createElement("strong",null,v)},{field:"description",name:"",render:v=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,v)}];return external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":section.dataTestSubj},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("span",null,section.title)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBasicTable,{compressed:!0,items:section.items,columns:columns,tableCaption:section.title,tableLayout:"auto",className:"mlExpandedRowDetailsSection","data-test-subj":section.dataTestSubj+"-table"}))},ExpandedRowDetailsPane=({sections:sections,dataTestSubj:dataTestSubj})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{className:"mlExpandedRowDetails","data-test-subj":dataTestSubj},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{style:{width:"50%"}},sections.filter(s=>"left"===s.position).map(s=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,{key:s.title},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(Section,{section:s})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{style:{width:"50%"}},sections.filter(s=>"right"===s.position).map(s=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,{key:s.title},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(Section,{section:s}))))),ExpandedRowJsonPane=({json:json,dataTestSubj:dataTestSubj})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{"data-test-subj":dataTestSubj},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCodeEditor,{value:JSON.stringify(json,null,2),readOnly:!0,mode:"json",style:{width:"100%"},theme:"textmate","data-test-subj":"mlAnalyticsDetailsJsonPreview"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1}," ")),ProgressBar=({progress:progress})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",gutterSize:"xs"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{style:{width:"100px"},grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiProgress,{value:progress,max:100,color:"primary",size:"m"},progress,"%")),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{style:{width:"35px"},grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs"},progress+"%")));var common=__webpack_require__(71),use_columns=__webpack_require__(283),analytics_list_common=__webpack_require__(93),analytics=__webpack_require__(67),ml_api_service=(__webpack_require__(504),__webpack_require__(64)),job_messages=__webpack_require__(421),toast_notification_service=__webpack_require__(73);const ExpandedRowMessagesPane=({analyticsId:analyticsId,dataTestSubj:dataTestSubj})=>{const[messages,setMessages]=Object(external_kbnSharedDeps_React_.useState)([]),[isLoading,setIsLoading]=Object(external_kbnSharedDeps_React_.useState)(!1),[errorMessage,setErrorMessage]=Object(external_kbnSharedDeps_React_.useState)(""),toastNotificationService=Object(toast_notification_service.c)(),getMessages=Object(external_kbnSharedDeps_React_.useCallback)(async()=>{try{setIsLoading(!0);const messagesResp=await ml_api_service.ml.dataFrameAnalytics.getAnalyticsAuditMessages(analyticsId);setIsLoading(!1),setMessages(messagesResp)}catch(error){setIsLoading(!1),toastNotificationService.displayErrorToast(error,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dfAnalyticsList.analyticsDetails.messagesPane.errorToastMessageTitle",{defaultMessage:"Error loading job messages"})),setErrorMessage(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dfAnalyticsList.analyticsDetails.messagesPane.errorMessage",{defaultMessage:"Messages could not be loaded"}))}},[]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{getMessages()},[]),Object(common.I)({onRefresh:getMessages}),external_kbnSharedDeps_React_default.a.createElement("div",{className:"mlExpandedRowJobMessages","data-test-subj":dataTestSubj},external_kbnSharedDeps_React_default.a.createElement(job_messages.a,{messages:messages,loading:isLoading,error:errorMessage,refreshMessage:getMessages}))};function getItemDescription(value){return"object"==typeof value?JSON.stringify(value):value.toString()}const LoadedStat=({isLoading:isLoading,evalData:evalData,resultProperty:resultProperty})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,!1===isLoading&&null!==evalData.error&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{type:"alert",size:"s"}),!0===isLoading&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingSpinner,{size:"s"}),!1===isLoading&&null===evalData.error&&evalData[resultProperty]),defaultEval={mse:"",msle:"",huber:"",rSquared:"",error:null},ExpandedRow=({item:item})=>{var _item$config,_item$config$dest,_item$config2;const[trainingEval,setTrainingEval]=Object(external_kbnSharedDeps_React_.useState)(defaultEval),[generalizationEval,setGeneralizationEval]=Object(external_kbnSharedDeps_React_.useState)(defaultEval),[isLoadingTraining,setIsLoadingTraining]=Object(external_kbnSharedDeps_React_.useState)(!1),[isLoadingGeneralization,setIsLoadingGeneralization]=Object(external_kbnSharedDeps_React_.useState)(!1),index=null==item||null===(_item$config=item.config)||void 0===_item$config||null===(_item$config$dest=_item$config.dest)||void 0===_item$config$dest?void 0:_item$config$dest.index,dependentVariable=Object(common.w)(item.config.analysis),predictionFieldName=Object(common.A)(item.config.analysis),resultsField=item.config.dest.results_field,jobIsCompleted=Object(analytics_list_common.e)(item.stats),isRegressionJob=Object(analytics.D)(item.config.analysis),analysisType=Object(analytics.r)(item.config.analysis);Object(external_kbnSharedDeps_React_.useEffect)(()=>{jobIsCompleted&&isRegressionJob&&(async()=>{setIsLoadingGeneralization(!0),setIsLoadingTraining(!0);const genErrorEval=await Object(common.F)({isTraining:!1,index:index,dependentVariable:dependentVariable,resultsField:resultsField,predictionFieldName:predictionFieldName,jobType:analytics.b.REGRESSION});if(!0===genErrorEval.success&&genErrorEval.eval&&Object(analytics.E)(genErrorEval.eval)){const{mse:mse,msle:msle,huber:huber,r_squared:r_squared}=Object(common.C)(genErrorEval.eval);setGeneralizationEval({mse:mse,msle:msle,huber:huber,rSquared:r_squared,error:null}),setIsLoadingGeneralization(!1)}else setIsLoadingGeneralization(!1),setGeneralizationEval({mse:"",msle:"",huber:"",rSquared:"",error:genErrorEval.error});const trainingErrorEval=await Object(common.F)({isTraining:!0,index:index,dependentVariable:dependentVariable,resultsField:resultsField,predictionFieldName:predictionFieldName,jobType:analytics.b.REGRESSION});if(!0===trainingErrorEval.success&&trainingErrorEval.eval&&Object(analytics.E)(trainingErrorEval.eval)){const{mse:mse,msle:msle,huber:huber,r_squared:r_squared}=Object(common.C)(trainingErrorEval.eval);setTrainingEval({mse:mse,msle:msle,huber:huber,rSquared:r_squared,error:null}),setIsLoadingTraining(!1)}else setIsLoadingTraining(!1),setTrainingEval({mse:"",msle:"",huber:"",rSquared:"",error:genErrorEval.error})})()},[jobIsCompleted]);const stateValues={...item.stats},analysisStatsValues=stateValues.analysis_stats?stateValues.analysis_stats[analysisType+"_stats"]:void 0;null!==(_item$config2=item.config)&&void 0!==_item$config2&&_item$config2.description&&(stateValues.description=item.config.description),delete stateValues.progress;const stateItems=Object.entries(stateValues).map(([stateKey,stateValue])=>{const title=stateKey.toString();return"state"===title?{title:title,description:Object(use_columns.b)(getItemDescription(stateValue))}:"analysis_stats"!==title?{title:title,description:getItemDescription(stateValue)}:void 0}).filter(stateItem=>void 0!==stateItem),state={title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.expandedRow.tabs.jobSettings.state",{defaultMessage:"State"}),items:stateItems,position:"left",dataTestSubj:"mlAnalyticsTableRowDetailsSection state"},{currentPhase:currentPhase,totalPhases:totalPhases}=Object(analytics_list_common.d)(item.stats),progress={title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.expandedRow.tabs.jobSettings.progress",{defaultMessage:"Progress"}),items:[{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.expandedRow.tabs.jobSettings.phase",{defaultMessage:"Phase"}),description:`${currentPhase}/${totalPhases}`},...item.stats.progress.map(s=>({title:s.phase,description:external_kbnSharedDeps_React_default.a.createElement(ProgressBar,{progress:s.progress_percent})}))],position:"right",dataTestSubj:"mlAnalyticsTableRowDetailsSection progress"},stats={title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.expandedRow.tabs.jobSettings.stats",{defaultMessage:"Stats"}),items:[{title:"create_time",description:Object(date_utils.c)(1e3*external_kbnSharedDeps_MomentTimezone_default()(item.config.create_time).unix())},{title:"model_memory_limit",description:item.config.model_memory_limit},{title:"version",description:item.config.version}],position:"left",dataTestSubj:"mlAnalyticsTableRowDetailsSection stats"},analysisStats=analysisStatsValues?{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.expandedRow.tabs.jobSettings.analysisStats",{defaultMessage:"Analysis stats"}),items:[{title:"timestamp",description:Object(date_utils.c)(1e3*external_kbnSharedDeps_MomentTimezone_default()(analysisStatsValues.timestamp).unix())},{title:"timing_stats",description:getItemDescription(analysisStatsValues.timing_stats)},...Object.entries(analysisStatsValues.parameters||analysisStatsValues.hyperparameters||{}).map(([stateKey,stateValue])=>({title:stateKey.toString(),description:getItemDescription(stateValue)}))],position:"right",dataTestSubj:"mlAnalyticsTableRowDetailsSection analysisStats"}:void 0;jobIsCompleted&&isRegressionJob&&stats.items.push({title:"generalization mean squared error",description:external_kbnSharedDeps_React_default.a.createElement(LoadedStat,{isLoading:isLoadingGeneralization,evalData:generalizationEval,resultProperty:analytics.j.MSE})},{title:"generalization mean squared logarithmic error",description:external_kbnSharedDeps_React_default.a.createElement(LoadedStat,{isLoading:isLoadingGeneralization,evalData:generalizationEval,resultProperty:analytics.j.MSLE})},{title:"generalization r squared",description:external_kbnSharedDeps_React_default.a.createElement(LoadedStat,{isLoading:isLoadingGeneralization,evalData:generalizationEval,resultProperty:analytics.j.R_SQUARED})},{title:"generalization pseudo huber loss function",description:external_kbnSharedDeps_React_default.a.createElement(LoadedStat,{isLoading:isLoadingTraining,evalData:generalizationEval,resultProperty:analytics.j.HUBER})},{title:"training mean squared error",description:external_kbnSharedDeps_React_default.a.createElement(LoadedStat,{isLoading:isLoadingTraining,evalData:trainingEval,resultProperty:analytics.j.MSE})},{title:"training mean squared logarithmic error",description:external_kbnSharedDeps_React_default.a.createElement(LoadedStat,{isLoading:isLoadingTraining,evalData:trainingEval,resultProperty:analytics.j.MSLE})},{title:"training r squared",description:external_kbnSharedDeps_React_default.a.createElement(LoadedStat,{isLoading:isLoadingTraining,evalData:trainingEval,resultProperty:analytics.j.R_SQUARED})},{title:"training pseudo huber loss function",description:external_kbnSharedDeps_React_default.a.createElement(LoadedStat,{isLoading:isLoadingTraining,evalData:trainingEval,resultProperty:analytics.j.HUBER})});const detailsSections=[state,progress],statsSections=[stats];void 0!==analysisStats&&statsSections.push(analysisStats);const tabs=[{id:"ml-analytics-job-details",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.expandedRow.tabs.jobSettingsLabel",{defaultMessage:"Job details"}),content:external_kbnSharedDeps_React_default.a.createElement(ExpandedRowDetailsPane,{sections:detailsSections,dataTestSubj:"mlAnalyticsTableRowDetailsTabContent job-details "+item.config.id}),"data-test-subj":"mlAnalyticsTableRowDetailsTab job-details "+item.config.id},{id:"ml-analytics-job-stats",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.analyticsDetails.tabs.analyticsStatsLabel",{defaultMessage:"Job stats"}),content:external_kbnSharedDeps_React_default.a.createElement(ExpandedRowDetailsPane,{sections:statsSections,dataTestSubj:"mlAnalyticsTableRowDetailsTabContent job-stats "+item.config.id}),"data-test-subj":"mlAnalyticsTableRowDetailsTab job-stats "+item.config.id},{id:"ml-analytics-job-json",name:"JSON",content:external_kbnSharedDeps_React_default.a.createElement(ExpandedRowJsonPane,{json:item.config,dataTestSubj:"mlAnalyticsTableRowDetailsTabContent json "+item.config.id}),"data-test-subj":"mlAnalyticsTableRowDetailsTab json "+item.config.id},{id:"ml-analytics-job-messages",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.analyticsDetails.tabs.analyticsMessagesLabel",{defaultMessage:"Job messages"}),content:external_kbnSharedDeps_React_default.a.createElement(ExpandedRowMessagesPane,{analyticsId:item.id,dataTestSubj:"mlAnalyticsTableRowDetailsTabContent job-messages "+item.config.id}),"data-test-subj":"mlAnalyticsTableRowDetailsTab job-messages "+item.config.id}];return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTabbedContent,{size:"s",tabs:tabs,initialSelectedTab:tabs[0],onTabClick:()=>{},expand:!1,style:{width:"100%"},"data-test-subj":"mlAnalyticsTableRowDetails-"+item.config.id})}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return results_loader_ResultsLoader})),__webpack_require__.d(__webpack_exports__,"a",(function(){return categorization_examples_loader_CategorizationExamplesLoader}));var external_kbnSharedDeps_Rxjs_=__webpack_require__(23),job_creator=__webpack_require__(95),results_service=__webpack_require__(128),anomaly_utils=__webpack_require__(6),parse_interval=__webpack_require__(26),external_kbnSharedDeps_Lodash_=__webpack_require__(7),string_utils=__webpack_require__(89),ml_api_service=__webpack_require__(64);var new_job=__webpack_require__(74),aggregation_types=__webpack_require__(81);function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}const emptyModelItem={time:0,actual:0,modelUpper:0,modelLower:0};class results_loader_ResultsLoader{constructor(jobCreator,chartInterval,chartLoader){_defineProperty(this,"_results$",void 0),_defineProperty(this,"_resultsSearchRunning",!1),_defineProperty(this,"_jobCreator",void 0),_defineProperty(this,"_chartInterval",void 0),_defineProperty(this,"_lastModelTimeStamp",0),_defineProperty(this,"_lastResultsTimeout",null),_defineProperty(this,"_chartLoader",void 0),_defineProperty(this,"_results",{progress:0,model:[],anomalies:[]}),_defineProperty(this,"_detectorSplitFieldFilters",null),_defineProperty(this,"_splitFieldFiltersLoaded",!1),_defineProperty(this,"progressSubscriber",async progress=>{!1===this._resultsSearchRunning&&(progress-this._results.progress>5||100===progress)&&(!1===this._splitFieldFiltersLoaded&&(this._splitFieldFiltersLoaded=!0,await this._populateDetectorSplitFieldFilters()),this._updateData(progress,!1),100===progress&&(clearTimeout(this._lastResultsTimeout),this._lastResultsTimeout=setTimeout(()=>{this._updateData(progress,!0)},500)))}),this._jobCreator=jobCreator,this._chartInterval=chartInterval,this._results$=new external_kbnSharedDeps_Rxjs_.BehaviorSubject(this._results),this._chartLoader=chartLoader,jobCreator.subscribeToProgress(this.progressSubscriber)}async _updateData(progress,fullRefresh){this._resultsSearchRunning=!0,!0===fullRefresh&&this._clearResults(),this._results.progress=progress;const getAnomalyData=this._jobCreator.type===new_job.f.SINGLE_METRIC?()=>this._loadJobAnomalyData(0):()=>this._loadDetectorsAnomalyData(),[model,anomalies]=await Promise.all([this._loadModelData(0),getAnomalyData()]);this._results.model=model,this._results.anomalies=anomalies,this._resultsSearchRunning=!1,this._results$.next(this._results)}get results$(){return this._results$}subscribeToResults(func){return this._results$.subscribe(func)}get progress(){return this._results.progress}_clearResults(){this._results.model={},this._results.anomalies={},this._results.progress=0,this._lastModelTimeStamp=0}async _loadModelData(dtrIndex){if(!1===this._jobCreator.modelPlot)return[];const agg=this._jobCreator.getAggregation(dtrIndex);if(null===agg)return{[dtrIndex]:[emptyModelItem]};const resp=await results_service.mlResultsService.getModelPlotOutput(this._jobCreator.jobId,dtrIndex,[],this._lastModelTimeStamp,this._jobCreator.end,this._chartInterval.getInterval().asMilliseconds(),agg.mlModelPlotAgg).toPromise();return this._createModel(resp,dtrIndex)}_createModel({results:results},dtrIndex){void 0===this._results.model[dtrIndex]&&(this._results.model[dtrIndex]=[]);const dslName=this._jobCreator.aggregations[dtrIndex].dslName,modelScale=dslName===aggregation_types.a.COUNT||dslName===aggregation_types.a.CARDINALITY?this._calculateModelScale():1,model=Object.entries(results).map(([time,{actual:actual,modelLower:modelLower,modelUpper:modelUpper}])=>({time:+time,actual:actual,modelUpper:(null===modelUpper?0:modelUpper)*modelScale,modelLower:(null===modelLower?0:modelLower)*modelScale}));if(model.length>10){this._lastModelTimeStamp=model[model.length-5].time;for(let i=0;i<5;i++)this._results.model[dtrIndex].pop()}return{[dtrIndex]:this._results.model[dtrIndex].concat(model)}}async _loadJobAnomalyData(dtrIndex){const results=(await results_service.mlResultsService.getScoresByBucket([this._jobCreator.jobId],this._jobCreator.start,this._jobCreator.end,this._chartInterval.getInterval().asMilliseconds(),1)).results[this._jobCreator.jobId];if(void 0===results)return[];const anomalies={};return anomalies[0]=Object.entries(results).map(([time,value])=>({time:+time,value:value,severity:Object(anomaly_utils.k)(value)})),anomalies}async _loadDetectorsAnomalyData(){const resp=await(jobId=this._jobCreator.jobId,earliestMs=this._jobCreator.start,latestMs=this._jobCreator.end,intervalMs=this._chartInterval.getInterval().asMilliseconds(),firstSplitField=this._detectorSplitFieldFilters,new Promise((resolve,reject)=>{const obj={success:!0,results:{},totalResults:0};let jobIdFilterStr="job_id: "+jobId;firstSplitField&&void 0!==firstSplitField.value&&(jobIdFilterStr+=` AND ${Object(string_utils.c)(firstSplitField.name)}:`,jobIdFilterStr+=`"${String(firstSplitField.value).replace(/\\/g,"\\\\")}"`),ml_api_service.ml.results.anomalySearch({size:0,body:{query:{bool:{filter:[{query_string:{query:"result_type:record"}},{bool:{must:[{range:{timestamp:{gte:earliestMs,lte:latestMs,format:"epoch_millis"}}},{query_string:{query:jobIdFilterStr}}]}}]}},aggs:{detector_index:{terms:{field:"detector_index",order:{recordScore:"desc"}},aggs:{recordScore:{max:{field:"record_score"}},byTime:{date_histogram:{field:"timestamp",fixed_interval:intervalMs+"ms",min_doc_count:1,extended_bounds:{min:earliestMs,max:latestMs}},aggs:{recordScore:{max:{field:"record_score"}}}}}}}}},[jobId]).then(resp=>{Object(external_kbnSharedDeps_Lodash_.get)(resp,["aggregations","detector_index","buckets"],[]).forEach(dtr=>{const dtrResults=[],dtrIndex=+dtr.key,buckets=Object(external_kbnSharedDeps_Lodash_.get)(dtr,["byTime","buckets"],[]);for(let j=0;j<buckets.length;j++){const bkt=buckets[j],time=bkt.key;dtrResults.push({time:time,value:Object(external_kbnSharedDeps_Lodash_.get)(bkt,["recordScore","value"])})}obj.results[dtrIndex]=dtrResults}),resolve(obj)}).catch(resp=>{reject(resp)})}));var jobId,earliestMs,latestMs,intervalMs,firstSplitField;const anomalies={};return Object.entries(resp.results).forEach(([dtrIdx,results])=>{anomalies[+dtrIdx]=results.map(r=>({...r,severity:Object(anomaly_utils.k)(r.value)}))}),anomalies}async _populateDetectorSplitFieldFilters(){if(Object(job_creator.c)(this._jobCreator)&&null!==this._jobCreator.splitField){const fieldValues=await this._chartLoader.loadFieldExampleValues(this._jobCreator.splitField,this._jobCreator.runtimeMappings,this._jobCreator.datafeedConfig.indices_options);fieldValues.length>0&&(this._detectorSplitFieldFilters={name:this._jobCreator.splitField.name,value:fieldValues[0]})}else this._detectorSplitFieldFilters=null}_calculateModelScale(){const duration=Object(parse_interval.a)(this._jobCreator.bucketSpan),bucketSpanMs=null!==duration?duration.asMilliseconds():0;return this._chartInterval.getInterval().asMilliseconds()/bucketSpanMs}}var categorization_job=__webpack_require__(150);function categorization_examples_loader_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class categorization_examples_loader_CategorizationExamplesLoader{constructor(jobCreator,indexPattern,query){categorization_examples_loader_defineProperty(this,"_jobCreator",void 0),categorization_examples_loader_defineProperty(this,"_indexPatternTitle",""),categorization_examples_loader_defineProperty(this,"_timeFieldName",""),categorization_examples_loader_defineProperty(this,"_query",{}),this._jobCreator=jobCreator,this._indexPatternTitle=indexPattern.title,this._query=query,"string"==typeof indexPattern.timeFieldName&&(this._timeFieldName=indexPattern.timeFieldName)}async loadExamples(){var _this$_jobCreator$run;const analyzer=this._jobCreator.categorizationAnalyzer,categorizationFieldName=this._jobCreator.categorizationFieldName;if(null===categorizationFieldName)return{examples:[],sampleSize:0,overallValidStatus:categorization_job.a.INVALID,validationChecks:[]};return await ml_api_service.ml.jobs.categorizationFieldExamples(this._indexPatternTitle,this._query,categorization_job.b,categorizationFieldName,this._timeFieldName,this._jobCreator.start,this._jobCreator.end,analyzer,null!==(_this$_jobCreator$run=this._jobCreator.runtimeMappings)&&void 0!==_this$_jobCreator$run?_this$_jobCreator$run:void 0,this._jobCreator.datafeedConfig.indices_options)}}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return DeleteActionModal})),__webpack_require__.d(__webpack_exports__,"b",(function(){return useDeleteAction}));var external_kbnSharedDeps_React_=__webpack_require__(14),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),external_kbnSharedDeps_KbnI18n_=__webpack_require__(2),external_kbnSharedDeps_ElasticEui_=__webpack_require__(39),check_capabilities=__webpack_require__(68),common=__webpack_require__(93);const deleteActionNameText=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.deleteActionNameText",{defaultMessage:"Delete"}),DeleteActionName=({isDisabled:isDisabled,item:item})=>isDisabled?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{position:"top",content:Object(common.g)(item.stats.state)?external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.deleteActionDisabledToolTipContent",{defaultMessage:"Stop the data frame analytics job in order to delete it."}):Object(check_capabilities.f)("canStartStopDataFrameAnalytics")},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,deleteActionNameText)):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,deleteActionNameText),DeleteActionModal=({closeModal:closeModal,deleteAndCloseModal:deleteAndCloseModal,deleteTargetIndex:deleteTargetIndex,deleteIndexPattern:deleteIndexPattern,indexPatternExists:indexPatternExists,isLoading:isLoading,item:item,toggleDeleteIndex:toggleDeleteIndex,toggleDeleteIndexPattern:toggleDeleteIndexPattern,userCanDeleteIndex:userCanDeleteIndex})=>{if(void 0===item)return null;const indexName=item.config.dest.index;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiConfirmModal,{"data-test-subj":"mlAnalyticsJobDeleteModal",title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.deleteModalTitle",{defaultMessage:"Delete {analyticsId}?",values:{analyticsId:item.config.id}}),onCancel:closeModal,onConfirm:deleteAndCloseModal,cancelButtonText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.deleteModalCancelButton",{defaultMessage:"Cancel"}),confirmButtonText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.deleteModalDeleteButton",{defaultMessage:"Delete"}),defaultFocusedButton:external_kbnSharedDeps_ElasticEui_.EUI_MODAL_CONFIRM_BUTTON,buttonColor:"danger",confirmButtonDisabled:isLoading},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"column",gutterSize:"none"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,userCanDeleteIndex&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSwitch,{"data-test-subj":"mlAnalyticsJobDeleteIndexSwitch",style:{paddingBottom:10},label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.deleteDestinationIndexTitle",{defaultMessage:"Delete destination index {indexName}",values:{indexName:indexName}}),checked:deleteTargetIndex,onChange:toggleDeleteIndex})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,userCanDeleteIndex&&indexPatternExists&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSwitch,{"data-test-subj":"mlAnalyticsJobDeleteIndexPatternSwitch",label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.deleteTargetIndexPatternTitle",{defaultMessage:"Delete index pattern {indexPattern}",values:{indexPattern:indexName}}),checked:deleteIndexPattern,onChange:toggleDeleteIndexPattern}))))};var errors=__webpack_require__(24),kibana=__webpack_require__(63),toast_notification_service=__webpack_require__(73),analytics_service=__webpack_require__(182);const useDeleteAction=canDeleteDataFrameAnalytics=>{var _item$config$dest$ind;const[item,setItem]=Object(external_kbnSharedDeps_React_.useState)(),[isModalVisible,setModalVisible]=Object(external_kbnSharedDeps_React_.useState)(!1),[isDeleteJobCheckModalVisible,setDeleteJobCheckModalVisible]=Object(external_kbnSharedDeps_React_.useState)(!1),[deleteItem,setDeleteItem]=Object(external_kbnSharedDeps_React_.useState)(!1),[deleteTargetIndex,setDeleteTargetIndex]=Object(external_kbnSharedDeps_React_.useState)(!0),[deleteIndexPattern,setDeleteIndexPattern]=Object(external_kbnSharedDeps_React_.useState)(!0),[userCanDeleteIndex,setUserCanDeleteIndex]=Object(external_kbnSharedDeps_React_.useState)(!1),[indexPatternExists,setIndexPatternExists]=Object(external_kbnSharedDeps_React_.useState)(!1),[isLoading,setIsLoading]=Object(external_kbnSharedDeps_React_.useState)(!1),{savedObjects:savedObjects}=Object(kibana.b)().services,savedObjectsClient=savedObjects.client,indexName=null!==(_item$config$dest$ind=null==item?void 0:item.config.dest.index)&&void 0!==_item$config$dest$ind?_item$config$dest$ind:"",toastNotificationService=Object(toast_notification_service.c)();Object(external_kbnSharedDeps_React_.useEffect)(()=>{setIsLoading(!0),(async()=>{try{const ip=(await savedObjectsClient.find({type:"index-pattern",perPage:10,search:`"${indexName}"`,searchFields:["title"],fields:["title"]})).savedObjects.find(obj=>obj.attributes.title.toLowerCase()===indexName.toLowerCase());setIndexPatternExists(void 0!==ip),setIsLoading(!1)}catch(e){const error=Object(errors.i)(e);setIsLoading(!1),toastNotificationService.displayDangerToast(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.errorWithCheckingIfIndexPatternExistsNotificationErrorMessage",{defaultMessage:"An error occurred checking if index pattern {indexPattern} exists: {error}",values:{indexPattern:indexName,error:error}}))}})(),(()=>{try{Object(analytics_service.a)(indexName,toastNotificationService)&&setUserCanDeleteIndex(!0)}catch(e){const error=Object(errors.i)(e);setIsLoading(!1),toastNotificationService.displayDangerToast(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analyticsList.errorWithCheckingIfUserCanDeleteIndexNotificationErrorMessage",{defaultMessage:"An error occurred checking if user can delete {destinationIndex}: {error}",values:{destinationIndex:indexName,error:error}}))}})()},[isModalVisible]);const openDeleteJobCheckModal=newItem=>{setItem(newItem),setDeleteJobCheckModalVisible(!0)};return{action:Object(external_kbnSharedDeps_React_.useMemo)(()=>({name:i=>external_kbnSharedDeps_React_default.a.createElement(DeleteActionName,{isDisabled:Object(common.g)(i.stats.state)||!canDeleteDataFrameAnalytics,item:i}),enabled:i=>!Object(common.g)(i.stats.state)&&canDeleteDataFrameAnalytics,description:deleteActionNameText,icon:"trash",type:"icon",onClick:i=>openDeleteJobCheckModal(i),"data-test-subj":"mlAnalyticsJobDeleteButton"}),[]),closeDeleteJobCheckModal:()=>setDeleteJobCheckModalVisible(!1),closeModal:()=>setModalVisible(!1),deleteAndCloseModal:()=>{setDeleteItem(!0),setModalVisible(!1),void 0!==item&&(userCanDeleteIndex&&deleteTargetIndex||userCanDeleteIndex&&deleteIndexPattern?Object(analytics_service.c)(item.config,item.stats,deleteTargetIndex,indexPatternExists&&deleteIndexPattern,toastNotificationService):Object(analytics_service.b)(item.config,item.stats,toastNotificationService))},deleteTargetIndex:deleteTargetIndex,deleteIndexPattern:deleteIndexPattern,deleteItem:deleteItem,indexPatternExists:indexPatternExists,isDeleteJobCheckModalVisible:isDeleteJobCheckModalVisible,isModalVisible:isModalVisible,isLoading:isLoading,item:item,jobType:"data-frame-analytics",openModal:newItem=>{setItem(newItem),setModalVisible(!0)},openDeleteJobCheckModal:openDeleteJobCheckModal,toggleDeleteIndex:()=>setDeleteTargetIndex(!deleteTargetIndex),toggleDeleteIndexPattern:()=>setDeleteIndexPattern(!deleteIndexPattern),userCanDeleteIndex:userCanDeleteIndex}}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return RefreshAnalyticsListButton}));var external_kbnSharedDeps_React_=__webpack_require__(14),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),external_kbnSharedDeps_ElasticEui_=__webpack_require__(39),external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(40),common=__webpack_require__(71);const RefreshAnalyticsListButton=()=>{const[isLoading,setIsLoading]=Object(external_kbnSharedDeps_React_.useState)(!1),{refresh:refresh}=Object(common.I)({isLoading:setIsLoading});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{"data-test-subj":"mlAnalyticsRefreshListButton"+(isLoading?" loading":" loaded"),onClick:refresh,isLoading:isLoading},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataframe.analyticsList.refreshButtonLabel",defaultMessage:"Refresh"}))}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return SourceSelection}));var external_kbnSharedDeps_React_=__webpack_require__(14),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),external_kbnSharedDeps_KbnI18n_=__webpack_require__(2),external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(40),external_kbnSharedDeps_ElasticEui_=__webpack_require__(39),public_=__webpack_require__(57),kibana=__webpack_require__(63),object_utils=__webpack_require__(232),index_utils=__webpack_require__(82);const SourceSelection=({onClose:onClose})=>{const{services:{savedObjects:savedObjects,uiSettings:uiSettings}}=Object(kibana.b)(),navigateToPath=Object(kibana.e)(),[isCcsCallOut,setIsCcsCallOut]=Object(external_kbnSharedDeps_React_.useState)(!1),[ccsCallOutBodyText,setCcsCallOutBodyText]=Object(external_kbnSharedDeps_React_.useState)();return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModal,{className:"dataFrameAnalyticsCreateSearchDialog",onClose:onClose,"data-test-subj":"analyticsCreateSourceIndexModal"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalHeader,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalHeaderTitle,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataframe.analytics.create.newAnalyticsTitle",defaultMessage:"New analytics job"})," ","/"," ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataframe.analytics.create.chooseSourceTitle",defaultMessage:"Choose a source index pattern"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiModalBody,null,isCcsCallOut&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{"data-test-subj":"analyticsCreateSourceIndexModalCcsErrorCallOut",title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataFrame.analytics.create.searchSelection.CcsErrorCallOutTitle",{defaultMessage:"Index patterns using cross-cluster search are not supported."}),color:"danger"},"string"==typeof ccsCallOutBodyText&&external_kbnSharedDeps_React_default.a.createElement("p",null,ccsCallOutBodyText)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"})),external_kbnSharedDeps_React_default.a.createElement(public_.SavedObjectFinderUi,{key:"searchSavedObjectFinder",onChoose:async(id,type,fullName,savedObject)=>{let indexPatternTitle="";if("index-pattern"===type)indexPatternTitle=Object(object_utils.a)(savedObject,"attributes.title");else if("search"===type){var _indexPatternAndSaved,_indexPatternAndSaved2;indexPatternTitle=null!==(_indexPatternAndSaved=null===(_indexPatternAndSaved2=(await Object(index_utils.a)(id)).indexPattern)||void 0===_indexPatternAndSaved2?void 0:_indexPatternAndSaved2.title)&&void 0!==_indexPatternAndSaved?_indexPatternAndSaved:""}if(Object(index_utils.g)(indexPatternTitle))return setIsCcsCallOut(!0),void setCcsCallOutBodyText("search"===type?external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataFrame.analytics.create.searchSelection.CcsErrorCallOutBody",{defaultMessage:"The saved search '{savedSearchTitle}' uses the index pattern '{indexPatternTitle}'.",values:{savedSearchTitle:Object(object_utils.a)(savedObject,"attributes.title"),indexPatternTitle:indexPatternTitle}}):void 0);await navigateToPath(`/data_frame_analytics/new_job?${"index-pattern"===type?"index":"savedSearchId"}=${encodeURIComponent(id)}`)},showFilter:!0,noItemsMessage:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataFrame.analytics.create.searchSelection.notFoundLabel",{defaultMessage:"No matching indices or saved searches found."}),savedObjectMetaData:[{type:"search",getIconForSavedObject:()=>"search",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataFrame.analytics.create.searchSelection.savedObjectType.search",{defaultMessage:"Saved search"})},{type:"index-pattern",getIconForSavedObject:()=>"indexPatternApp",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataFrame.analytics.create.searchSelection.savedObjectType.indexPattern",{defaultMessage:"Index pattern"})}],fixedPageSize:8,uiSettings:uiSettings,savedObjects:savedObjects})))}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return JobSpacesList}));var external_kbnSharedDeps_React_=__webpack_require__(14),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),external_kbnSharedDeps_ElasticEui_=__webpack_require__(39),external_kbnSharedDeps_KbnI18n_=__webpack_require__(2),saved_objects=__webpack_require__(298),ml_api_service=__webpack_require__(64),toast_notification_service=__webpack_require__(73);const objectNoun=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.management.jobsSpacesList.objectNoun",{defaultMessage:"job"}),JobSpacesList=({spacesApi:spacesApi,spaceIds:spaceIds,jobId:jobId,jobType:jobType,refresh:refresh})=>{const{displayErrorToast:displayErrorToast}=Object(toast_notification_service.c)(),[showFlyout,setShowFlyout]=Object(external_kbnSharedDeps_React_.useState)(!1);function onClose(){setShowFlyout(!1),refresh()}function handleApplySpaces(resp){Object.entries(resp).forEach(([id,{success:success,error:error}])=>{if(!1===success){const title=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.management.jobsSpacesList.updateSpaces.error",{defaultMessage:"Error updating {id}",values:{id:id}});displayErrorToast(error,title)}})}const LazySpaceList=Object(external_kbnSharedDeps_React_.useCallback)(spacesApi.ui.components.getSpaceList,[spacesApi]),LazyShareToSpaceFlyout=Object(external_kbnSharedDeps_React_.useCallback)(spacesApi.ui.components.getShareToSpaceFlyout,[spacesApi]),shareToSpaceFlyoutProps={savedObjectTarget:{type:saved_objects.a,id:jobId,namespaces:spaceIds,title:jobId,noun:objectNoun},behaviorContext:"outside-space",changeSpacesHandler:async function(spacesToAdd,spacesToRemove){if(spacesToAdd.length){handleApplySpaces(await ml_api_service.ml.savedObjects.assignJobToSpace(jobType,[jobId],spacesToAdd))}if(spacesToRemove.length&&!spacesToAdd.includes("*")){handleApplySpaces(await ml_api_service.ml.savedObjects.removeJobFromSpace(jobType,[jobId],spacesToRemove))}onClose()},onClose:onClose};return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{onClick:()=>setShowFlyout(!0),style:{height:"auto"}},external_kbnSharedDeps_React_default.a.createElement(LazySpaceList,{namespaces:spaceIds,displayLimit:0,behaviorContext:"outside-space"})),showFlyout&&external_kbnSharedDeps_React_default.a.createElement(LazyShareToSpaceFlyout,shareToSpaceFlyoutProps))}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return use_create_analytics_form_state.b})),__webpack_require__.d(__webpack_exports__,"b",(function(){return useCreateAnalyticsForm}));var use_create_analytics_form_state=__webpack_require__(119),external_kbnSharedDeps_React_=__webpack_require__(14),external_kbnSharedDeps_KbnI18n_=__webpack_require__(2),errors=__webpack_require__(24),ml_api_service=__webpack_require__(64),ml=__webpack_require__(85),public_=__webpack_require__(41),common=__webpack_require__(71),action_clone=__webpack_require__(423),use_create_analytics_form_actions=__webpack_require__(325),reducer=__webpack_require__(425);const useCreateAnalyticsForm=()=>{const mlContext=Object(ml.b)(),[state,dispatch]=Object(external_kbnSharedDeps_React_.useReducer)(reducer.b,Object(use_create_analytics_form_state.e)()),{refresh:refresh}=Object(common.I)(),{form:form,jobConfig:jobConfig,isAdvancedEditorEnabled:isAdvancedEditorEnabled}=state,{createIndexPattern:createIndexPattern,jobId:jobId}=form;let{destinationIndex:destinationIndex}=form;const addRequestMessage=requestMessage=>dispatch({type:use_create_analytics_form_actions.a.ADD_REQUEST_MESSAGE,requestMessage:requestMessage}),createKibanaIndexPattern=async()=>{const indexPatternName=destinationIndex;try{await mlContext.indexPatterns.createAndSave({title:indexPatternName},!1,!0),addRequestMessage({message:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.createIndexPatternSuccessMessage",{defaultMessage:"Kibana index pattern {indexPatternName} created.",values:{indexPatternName:indexPatternName}})})}catch(e){e instanceof public_.DuplicateIndexPatternError?addRequestMessage({error:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.duplicateIndexPatternErrorMessageError",{defaultMessage:"The index pattern {indexPatternName} already exists.",values:{indexPatternName:indexPatternName}}),message:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.duplicateIndexPatternErrorMessage",{defaultMessage:"An error occurred creating the Kibana index pattern:"})}):addRequestMessage({error:Object(errors.i)(e),message:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.createIndexPatternErrorMessage",{defaultMessage:"An error occurred creating the Kibana index pattern:"})})}},prepareFormValidation=async()=>{try{const indexPatternsMap={};(await mlContext.indexPatterns.getCache()||[]).forEach(obj=>{var _obj$attributes;const title=null==obj||null===(_obj$attributes=obj.attributes)||void 0===_obj$attributes?void 0:_obj$attributes.title;if(void 0!==title){const id=(null==obj?void 0:obj.id)||"";indexPatternsMap[title]={label:title,value:id}}}),payload={indexPatternsMap:indexPatternsMap},dispatch({type:use_create_analytics_form_actions.a.SET_INDEX_PATTERN_TITLES,payload:payload})}catch(e){addRequestMessage({error:Object(errors.i)(e),message:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.errorGettingIndexPatternTitles",{defaultMessage:"An error occurred getting the existing index pattern titles:"})})}var payload},setFormState=payload=>{dispatch({type:use_create_analytics_form_actions.a.SET_FORM_STATE,payload:payload})},switchToAdvancedEditor=()=>{dispatch({type:use_create_analytics_form_actions.a.SWITCH_TO_ADVANCED_EDITOR})},setEstimatedModelMemoryLimit=value=>{dispatch({type:use_create_analytics_form_actions.a.SET_ESTIMATED_MODEL_MEMORY_LIMIT,value:value})};return{state:state,actions:{closeModal:()=>dispatch({type:use_create_analytics_form_actions.a.CLOSE_MODAL}),createAnalyticsJob:async()=>{dispatch({type:use_create_analytics_form_actions.a.RESET_REQUEST_MESSAGES});const analyticsJobConfig=isAdvancedEditorEnabled?jobConfig:Object(use_create_analytics_form_state.f)(form);isAdvancedEditorEnabled&&(destinationIndex=analyticsJobConfig.dest.index);try{return await ml_api_service.ml.dataFrameAnalytics.createDataFrameAnalytics(jobId,analyticsJobConfig),addRequestMessage({message:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.stepCreateForm.createDataFrameAnalyticsSuccessMessage",{defaultMessage:"Request to create data frame analytics {jobId} acknowledged.",values:{jobId:jobId}})}),isJobCreated=!0,dispatch({type:use_create_analytics_form_actions.a.SET_IS_JOB_CREATED,isJobCreated:isJobCreated}),createIndexPattern&&createKibanaIndexPattern(),refresh(),!0}catch(e){return addRequestMessage({error:Object(errors.i)(e),message:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.errorCreatingDataFrameAnalyticsJob",{defaultMessage:"An error occurred creating the data frame analytics job:"})}),!1}var isJobCreated},initiateWizard:async()=>{await mlContext.indexPatterns.clearCache(),await prepareFormValidation()},resetAdvancedEditorMessages:()=>dispatch({type:use_create_analytics_form_actions.a.RESET_ADVANCED_EDITOR_MESSAGES}),setAdvancedEditorRawString:advancedEditorRawString=>dispatch({type:use_create_analytics_form_actions.a.SET_ADVANCED_EDITOR_RAW_STRING,advancedEditorRawString:advancedEditorRawString}),setFormState:setFormState,setJobConfig:payload=>{dispatch({type:use_create_analytics_form_actions.a.SET_JOB_CONFIG,payload:payload})},startAnalyticsJob:async()=>{try{const response=await ml_api_service.ml.dataFrameAnalytics.startDataFrameAnalytics(jobId);if(!0!==response.acknowledged)throw new Error(response);addRequestMessage({message:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.startDataFrameAnalyticsSuccessMessage",{defaultMessage:"Request to start data frame analytics {jobId} acknowledged.",values:{jobId:jobId}})}),isJobStarted=!0,dispatch({type:use_create_analytics_form_actions.a.SET_IS_JOB_STARTED,isJobStarted:isJobStarted}),refresh()}catch(e){addRequestMessage({error:Object(errors.i)(e),message:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.errorStartingDataFrameAnalyticsJob",{defaultMessage:"An error occurred starting the data frame analytics job:"})})}var isJobStarted},switchToAdvancedEditor:switchToAdvancedEditor,switchToForm:()=>{dispatch({type:use_create_analytics_form_actions.a.SWITCH_TO_FORM})},setEstimatedModelMemoryLimit:setEstimatedModelMemoryLimit,setJobClone:async cloneJob=>{dispatch({type:use_create_analytics_form_actions.a.RESET_FORM});const config=Object(action_clone.a)(cloneJob);Object(action_clone.b)(config)?(setFormState(Object(use_create_analytics_form_state.d)(config)),switchToAdvancedEditor()):(setFormState(Object(use_create_analytics_form_state.d)(config)),setEstimatedModelMemoryLimit(config.model_memory_limit)),dispatch({type:use_create_analytics_form_actions.a.SET_JOB_CLONE,cloneJob:cloneJob})}}}}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return JobIcon}));var external_kbnSharedDeps_React_=__webpack_require__(14),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),external_kbnSharedDeps_ElasticEui_=__webpack_require__(39);const[INFO,WARNING,ERROR]=["info","warning","error"],JobIcon=({message:message,showTooltip:showTooltip=!1})=>{if(void 0===message)return external_kbnSharedDeps_React_default.a.createElement("span",null);let color="primary",icon="alert";return message.level===INFO?icon="iInCircle":message.level===WARNING?color="warning":message.level===ERROR&&(color="danger"),showTooltip?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{position:"bottom",content:message.text},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{type:icon,color:color})):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{type:icon,color:color})}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return JobMessages}));var external_kbnSharedDeps_React_=__webpack_require__(14),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),external_kbnSharedDeps_ElasticEui_=__webpack_require__(39),external_kbnSharedDeps_KbnI18n_=__webpack_require__(2),external_kbnSharedDeps_Theme_euiLightVars_=__webpack_require__(50),external_kbnSharedDeps_Theme_euiLightVars_default=__webpack_require__.n(external_kbnSharedDeps_Theme_euiLightVars_),job_message_icon=__webpack_require__(420),date_utils=__webpack_require__(72);const JobMessages=({messages:messages,loading:loading,error:error,refreshMessage:refreshMessage})=>{const columns=[{name:refreshMessage?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{content:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobMessages.refreshLabel",{defaultMessage:"Refresh"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{onClick:refreshMessage,iconType:"refresh","aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobMessages.refreshAriaLabel",{defaultMessage:"Refresh"})})):"",render:message=>external_kbnSharedDeps_React_default.a.createElement(job_message_icon.a,{message:message}),width:""+external_kbnSharedDeps_Theme_euiLightVars_default.a.euiSizeL},{field:"timestamp",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobMessages.timeLabel",{defaultMessage:"Time"}),render:date_utils.d,width:"120px",sortable:!0},{field:"node_name",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobMessages.nodeLabel",{defaultMessage:"Node"}),width:"150px"},{field:"message",name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobMessages.messageLabel",{defaultMessage:"Message"}),width:"50%"}];return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiInMemoryTable,{className:"job-messages-table",items:messages,columns:columns,sorting:{sort:{field:"timestamp",direction:"asc"}},compressed:!0,loading:loading,error:error,"data-test-subj":"mlAnalyticsDetailsJobMessagesTable"}))}},,function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return clone_action_name.c})),__webpack_require__.d(__webpack_exports__,"b",(function(){return clone_action_name.d})),__webpack_require__.d(__webpack_exports__,"c",(function(){return useCloneAction}));var clone_action_name=__webpack_require__(140),external_kbnSharedDeps_React_=__webpack_require__(14),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_);const useCloneAction=canCreateDataFrameAnalytics=>{const navigateToWizardWithClonedJob=Object(clone_action_name.e)(),clickHandler=Object(external_kbnSharedDeps_React_.useCallback)(item=>{navigateToWizardWithClonedJob(item)},[]);return{action:Object(external_kbnSharedDeps_React_.useMemo)(()=>({name:()=>external_kbnSharedDeps_React_default.a.createElement(clone_action_name.a,{isDisabled:!canCreateDataFrameAnalytics}),enabled:()=>canCreateDataFrameAnalytics,description:clone_action_name.b,icon:"copy",type:"icon",onClick:clickHandler,"data-test-subj":"mlAnalyticsJobCloneButton"}),[])}}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return CustomSelectionTable}));var external_kbnSharedDeps_React_=__webpack_require__(14),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),external_kbnSharedDeps_ElasticEui_=__webpack_require__(39),external_kbnSharedDeps_ElasticEuiLibServices_=__webpack_require__(52),external_kbnSharedDeps_KbnI18n_=__webpack_require__(2);function getError(error){return null!==error?external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobSelector.filterBar.invalidSearchErrorMessage",{defaultMessage:"Invalid search: {errorMessage}",values:{errorMessage:error.message}}):""}function CustomSelectionTable({checkboxDisabledCheck:checkboxDisabledCheck,columns:columns,currentPage:currentPage=0,filterDefaultFields:filterDefaultFields,filters:filters,items:items,itemsPerPage:itemsPerPage=20,onTableChange:onTableChange,radioDisabledCheck:radioDisabledCheck,selectedIds:selectedIds,setCurrentPaginationData:setCurrentPaginationData,singleSelection:singleSelection,sortableProperties:sortableProperties,tableItemId:tableItemId="id"}){const[itemIdToSelectedMap,setItemIdToSelectedMap]=Object(external_kbnSharedDeps_React_.useState)(getCurrentlySelectedItemIdsMap()),[currentItems,setCurrentItems]=Object(external_kbnSharedDeps_React_.useState)(items),[lastSelected,setLastSelected]=Object(external_kbnSharedDeps_React_.useState)(selectedIds),[sortedColumn,setSortedColumn]=Object(external_kbnSharedDeps_React_.useState)(""),[pager,setPager]=Object(external_kbnSharedDeps_React_.useState)(),[pagerSettings,setPagerSettings]=Object(external_kbnSharedDeps_React_.useState)({itemsPerPage:itemsPerPage,firstItemIndex:0,lastItemIndex:1}),[query,setQuery]=Object(external_kbnSharedDeps_React_.useState)(external_kbnSharedDeps_ElasticEui_.EuiSearchBar.Query.MATCH_ALL),[error,setError]=Object(external_kbnSharedDeps_React_.useState)(null);function getCurrentlySelectedItemIdsMap(){const selectedIdsMap={all:!1};return selectedIds.forEach(id=>{selectedIdsMap[id]=!0}),selectedIdsMap}function handleTableChange({isSelected:isSelected,itemId:itemId}){const selectedMapIds=Object.getOwnPropertyNames(itemIdToSelectedMap),currentItemIds=currentItems.map(item=>item[tableItemId]);let currentSelected=selectedMapIds.filter(id=>!0===itemIdToSelectedMap[id]&&id!==itemId);"all"!==itemId?!0===isSelected&&currentSelected.push(itemId):!1===isSelected?currentSelected=currentSelected.filter(id=>!1===currentItemIds.includes(id)):(currentSelected=[...currentSelected,...currentItemIds],currentSelected=[...new Set(currentSelected)]),setCurrentPaginationData&&setCurrentPaginationData({pageIndex:pager.getCurrentPageIndex(),itemsPerPage:pagerSettings.itemsPerPage}),onTableChange(currentSelected)}function handleQueryChange({query:incomingQuery,error:newError}){if(newError)setError(newError);else{const queriedItems=external_kbnSharedDeps_ElasticEui_.EuiSearchBar.Query.execute(incomingQuery,items,{defaultFields:filterDefaultFields});setError(null),setCurrentItems(queriedItems),setQuery(incomingQuery)}}function isItemSelected(itemId){return!0===itemIdToSelectedMap[itemId]}function areAllItemsSelected(){return-1===currentItems.findIndex(item=>!isItemSelected(item[tableItemId]))}Object(external_kbnSharedDeps_React_.useEffect)(()=>{setCurrentItems(items),handleQueryChange({query:query})},[items]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{setItemIdToSelectedMap(getCurrentlySelectedItemIdsMap())},[selectedIds]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{const tablePager=new external_kbnSharedDeps_ElasticEuiLibServices_.Pager(currentItems.length,itemsPerPage,currentPage);setPagerSettings({itemsPerPage:itemsPerPage,firstItemIndex:tablePager.getFirstItemIndex(),lastItemIndex:tablePager.getLastItemIndex()}),setPager(tablePager)},[currentItems]);const selectAllCheckboxId=Object(external_kbnSharedDeps_React_.useMemo)(()=>Object(external_kbnSharedDeps_ElasticEui_.htmlIdGenerator)()(),[]);function renderSelectAll(mobile){const selectAll=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobSelector.customTable.selectAllCheckboxLabel",{defaultMessage:"Select all"});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCheckbox,{id:`${mobile?"mobile-":""}${selectAllCheckboxId}`,label:mobile?selectAll:null,checked:areAllItemsSelected(),onChange:toggleAll,type:mobile?null:"inList"})}function toggleItem(itemId){if(singleSelection){const lastId=lastSelected[0];setItemIdToSelectedMap({...itemIdToSelectedMap,[lastId]:!1,[itemId]:!0}),function(itemId){onTableChange([itemId])}(itemId),setLastSelected([itemId])}else{const isSelected=!isItemSelected(itemId);setItemIdToSelectedMap({...itemIdToSelectedMap,[itemId]:isSelected}),handleTableChange({isSelected:isSelected,itemId:itemId})}}function toggleAll(){const allSelected=areAllItemsSelected()||!0===itemIdToSelectedMap.all,newItemIdToSelectedMap={};currentItems.forEach(item=>newItemIdToSelectedMap[item[tableItemId]]=!allSelected),setItemIdToSelectedMap(newItemIdToSelectedMap),handleTableChange({isSelected:!allSelected,itemId:"all"})}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"column"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,"data-test-subj":"mlCustomSelectionTableSearchBar"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSearchBar,{defaultQuery:query,box:{incremental:!0,placeholder:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobSelector.customTable.searchBarPlaceholder",{defaultMessage:"Search..."})},filters:filters,onChange:handleQueryChange}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{fullWidth:!0,isInvalid:null!==error,error:getError(error),style:{maxHeight:"0px"}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null)))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTableHeaderMobile,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{responsive:!1,justifyContent:"spaceBetween",alignItems:"baseline"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},renderSelectAll(!0)))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTable,{"data-test-subj":"mlCustomSelectionTable"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTableHeader,null,function(){const headers=[];return columns.forEach((column,columnIndex)=>{column.isCheckbox&&!singleSelection?headers.push(external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTableHeaderCellCheckbox,{key:column.id,width:column.width},renderSelectAll())):headers.push(external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTableHeaderCell,{key:column.id,align:columns[columnIndex].alignment,width:column.width,onSort:column.isSortable?()=>function(prop){sortableProperties.sortOn(prop);const sortedItems=sortableProperties.sortItems(currentItems);setCurrentItems(sortedItems),setSortedColumn(prop)}(column.id):void 0,isSorted:sortedColumn===column.id,isSortAscending:!sortableProperties||sortableProperties.isAscendingByName(column.id),mobileOptions:column.mobileOptions},column.label))}),headers.length?headers:null}()),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTableBody,null,function(){const renderRow=item=>{const cells=columns.map(column=>{const cell=item[column.id];let child;return column.isCheckbox?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTableRowCellCheckbox,{key:column.id},!singleSelection&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCheckbox,{disabled:void 0!==checkboxDisabledCheck?checkboxDisabledCheck(item):void 0,id:item[tableItemId]+"-checkbox","data-test-subj":item[tableItemId]+"-checkbox",checked:isItemSelected(item[tableItemId]),onChange:()=>toggleItem(item[tableItemId]),type:"inList"}),singleSelection&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiRadio,{id:item[tableItemId],"data-test-subj":item[tableItemId]+"-radio-button",checked:isItemSelected(item[tableItemId]),onChange:()=>toggleItem(item[tableItemId]),disabled:void 0!==radioDisabledCheck?radioDisabledCheck(item):void 0})):(child=column.render?column.render(item):cell,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTableRowCell,{key:column.id,align:column.alignment,truncateText:cell&&cell.truncateText,textOnly:!cell||cell.textOnly,mobileOptions:{header:column.label,...column.mobileOptions}},child))});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTableRow,{key:item[tableItemId],isSelected:isItemSelected(item[tableItemId]),isSelectable:!0,hasActions:!0,"data-test-subj":"mlCustomSelectionTableRow row-"+item[tableItemId]},cells)},rows=[];for(let itemIndex=pagerSettings.firstItemIndex;itemIndex<=pagerSettings.lastItemIndex;itemIndex++){const item=currentItems[itemIndex];if(void 0===item)break;rows.push(renderRow(item))}return rows}())),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),void 0!==pager&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTablePagination,{activePage:pager.getCurrentPageIndex(),itemsPerPage:pagerSettings.itemsPerPage,itemsPerPageOptions:[5,10,20,50],pageCount:pager.getTotalPages(),onChangeItemsPerPage:function(numItemsPerPage){pager.setItemsPerPage(numItemsPerPage),setPagerSettings({...pagerSettings,itemsPerPage:numItemsPerPage,firstItemIndex:pager.getFirstItemIndex(),lastItemIndex:pager.getLastItemIndex()})},onChangePage:pageIndex=>function(pageIndex){pager.goToPageIndex(pageIndex),setPagerSettings({...pagerSettings,firstItemIndex:pager.getFirstItemIndex(),lastItemIndex:pager.getLastItemIndex()})}(pageIndex)}))}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return getModelMemoryLimitErrors})),__webpack_require__.d(__webpack_exports__,"b",(function(){return reducer}));var external_kbnSharedDeps_KbnI18n_=__webpack_require__(2),external_kbnSharedDeps_Lodash_=__webpack_require__(7),external_kbnSharedDeps_ElasticNumeral_=__webpack_require__(49),external_kbnSharedDeps_ElasticNumeral_default=__webpack_require__.n(external_kbnSharedDeps_ElasticNumeral_);const windowWithTextEncoder=window;function isValidIndexName(indexName){return"string"==typeof indexName&&indexName===indexName.toLowerCase()&&/^[^\*\\/\?"<>|\s,#:]+$/.test(indexName)&&/^[^-_\+]+$/.test(indexName.charAt(0))&&"."!==indexName&&".."!==indexName&&function(indexName){return!(windowWithTextEncoder.TextEncoder&&new windowWithTextEncoder.TextEncoder("utf-8").encode(indexName).length>255)&&indexName.length<=255}(indexName)}var shared_imports=__webpack_require__(167),actions=__webpack_require__(325),use_create_analytics_form_state=__webpack_require__(119),job_utils=__webpack_require__(69),validators=__webpack_require__(17),validation=__webpack_require__(27),data_frame_analytics=__webpack_require__(79),analytics=__webpack_require__(67),public_=__webpack_require__(41),clone_action_name=__webpack_require__(140);const mmlAllowedUnitsStr=`${validation.a.slice(0,validation.a.length-1).join(", ")} or ${[...validation.a].pop()}`,mmlUnitInvalidErrorMessage=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.modelMemoryUnitsInvalidError",{defaultMessage:"Model memory limit data unit unrecognized. It must be {str}",values:{str:mmlAllowedUnitsStr}});function getModelMemoryLimitErrors(mmlValidationResult){return null===mmlValidationResult?null:Object.keys(mmlValidationResult).reduce((acc,errorKey)=>("min"===errorKey&&acc.push(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.modelMemoryUnitsMinError",{defaultMessage:"Model memory limit is lower than estimated value {mml}",values:{mml:mmlValidationResult.min.minValue}})),"invalidUnits"===errorKey&&acc.push(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.modelMemoryUnitsInvalidError",{defaultMessage:"Model memory limit data unit unrecognized. It must be {str}",values:{str:mmlAllowedUnitsStr}})),acc),[])}const validateNumTopFeatureImportanceValues=numTopFeatureImportanceValues=>"number"==typeof numTopFeatureImportanceValues&&numTopFeatureImportanceValues>=analytics.g&&Number.isInteger(numTopFeatureImportanceValues),validateAdvancedEditor=state=>{var _jobConfig$source2,_jobConfig$dest$index,_jobConfig$dest,_jobConfig$dest2,_jobConfig$dest3;const{jobIdEmpty:jobIdEmpty,jobIdValid:jobIdValid,jobIdExists:jobIdExists,jobType:jobType,createIndexPattern:createIndexPattern,includes:includes}=state.form,{jobConfig:jobConfig}=state;state.advancedEditorMessages=[];const sourceIndexName=(state=>{var _jobConfig$source;const{jobConfig:jobConfig}=state,sourceIndex=null==jobConfig||null===(_jobConfig$source=jobConfig.source)||void 0===_jobConfig$source?void 0:_jobConfig$source.index;return"string"==typeof sourceIndex?sourceIndex:Array.isArray(sourceIndex)?sourceIndex.join(","):""})(state),sourceIndexNameEmpty=""===sourceIndexName;let sourceIndexNameValid=0===Object.keys(public_.indexPatterns.validate(sourceIndexName)).length;const sourceIndex=null==jobConfig||null===(_jobConfig$source2=jobConfig.source)||void 0===_jobConfig$source2?void 0:_jobConfig$source2.index;sourceIndexNameValid&&("string"==typeof sourceIndex&&(sourceIndexNameValid=!sourceIndex.includes(",")),Array.isArray(sourceIndex)&&(sourceIndexNameValid=!sourceIndex.some(d=>null==d?void 0:d.includes(","))));const destinationIndexName=null!==(_jobConfig$dest$index=null==jobConfig||null===(_jobConfig$dest=jobConfig.dest)||void 0===_jobConfig$dest?void 0:_jobConfig$dest.index)&&void 0!==_jobConfig$dest$index?_jobConfig$dest$index:"",destinationIndexNameEmpty=""===destinationIndexName,destinationIndexNameValid=isValidIndexName(destinationIndexName),destinationIndexPatternTitleExists=void 0!==state.indexPatternsMap[destinationIndexName],resultsFieldEmptyString="string"==typeof(null==jobConfig||null===(_jobConfig$dest2=jobConfig.dest)||void 0===_jobConfig$dest2?void 0:_jobConfig$dest2.results_field)&&""===(null==jobConfig||null===(_jobConfig$dest3=jobConfig.dest)||void 0===_jobConfig$dest3?void 0:_jobConfig$dest3.results_field.trim()),mml=jobConfig.model_memory_limit,modelMemoryLimitEmpty=""===mml||void 0===mml;if(!modelMemoryLimitEmpty&&void 0!==mml){const{valid:valid}=Object(job_utils.w)(mml);state.form.modelMemoryLimitUnitValid=valid}let dependentVariableEmpty=!1,includesValid=!0,trainingPercentValid=!0,numTopFeatureImportanceValuesValid=!0;if(void 0!==jobConfig.analysis||jobType!==data_frame_analytics.a.CLASSIFICATION&&jobType!==data_frame_analytics.a.REGRESSION||(dependentVariableEmpty=!0),void 0!==jobConfig.analysis&&(Object(analytics.D)(jobConfig.analysis)||Object(analytics.A)(jobConfig.analysis))){const dependentVariableName=Object(analytics.t)(jobConfig.analysis)||"";dependentVariableEmpty=""===dependentVariableName,!dependentVariableEmpty&&void 0!==includes&&includes.length>0&&!includes.includes(dependentVariableName)&&(includesValid=!1,state.advancedEditorMessages.push({error:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditorMessage.includesInvalid",{defaultMessage:"The dependent variable must be included."}),message:""}));const trainingPercent=Object(analytics.y)(jobConfig.analysis);void 0!==trainingPercent&&(isNaN(trainingPercent)||"number"!=typeof trainingPercent||trainingPercent<analytics.o||trainingPercent>analytics.n)&&(trainingPercentValid=!1,state.advancedEditorMessages.push({error:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditorMessage.trainingPercentInvalid",{defaultMessage:"The training percent must be a number between {min} and {max}.",values:{min:analytics.o,max:analytics.n}}),message:""}));const numTopFeatureImportanceValues=Object(analytics.v)(jobConfig.analysis);void 0!==numTopFeatureImportanceValues&&(numTopFeatureImportanceValuesValid=validateNumTopFeatureImportanceValues(numTopFeatureImportanceValues),!1===numTopFeatureImportanceValuesValid&&state.advancedEditorMessages.push({error:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditorMessage.numTopFeatureImportanceValuesInvalid",{defaultMessage:"The value for num_top_feature_importance_values must be an integer of {min} or higher.",values:{min:0}}),message:""}))}return sourceIndexNameEmpty?state.advancedEditorMessages.push({error:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditorMessage.sourceIndexNameEmpty",{defaultMessage:"The source index name must not be empty."}),message:""}):sourceIndexNameValid||state.advancedEditorMessages.push({error:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditorMessage.sourceIndexNameValid",{defaultMessage:"Invalid source index name."}),message:""}),destinationIndexNameEmpty?state.advancedEditorMessages.push({error:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditorMessage.destinationIndexNameEmpty",{defaultMessage:"The destination index name must not be empty."}),message:""}):destinationIndexPatternTitleExists&&!createIndexPattern?state.advancedEditorMessages.push({error:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditorMessage.destinationIndexNameExistsWarn",{defaultMessage:"An index with this destination index name already exists. Be aware that running this analytics job will modify this destination index."}),message:""}):destinationIndexNameValid||state.advancedEditorMessages.push({error:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditorMessage.destinationIndexNameValid",{defaultMessage:"Invalid destination index name."}),message:""}),resultsFieldEmptyString&&state.advancedEditorMessages.push({error:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditorMessage.resultsFieldEmptyString",{defaultMessage:"The results field must not be an empty string."}),message:""}),dependentVariableEmpty&&state.advancedEditorMessages.push({error:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditorMessage.dependentVariableEmpty",{defaultMessage:"The dependent variable field must not be empty."}),message:""}),modelMemoryLimitEmpty&&state.advancedEditorMessages.push({error:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditorMessage.modelMemoryLimitEmpty",{defaultMessage:"The model memory limit field must not be empty."}),message:""}),state.form.modelMemoryLimitUnitValid||state.advancedEditorMessages.push({error:mmlUnitInvalidErrorMessage,message:""}),state.form.destinationIndexPatternTitleExists=destinationIndexPatternTitleExists,state.isValid=includesValid&&trainingPercentValid&&state.form.modelMemoryLimitUnitValid&&!jobIdEmpty&&jobIdValid&&!jobIdExists&&!sourceIndexNameEmpty&&sourceIndexNameValid&&!destinationIndexNameEmpty&&destinationIndexNameValid&&!resultsFieldEmptyString&&!dependentVariableEmpty&&!modelMemoryLimitEmpty&&numTopFeatureImportanceValuesValid&&(!destinationIndexPatternTitleExists||!createIndexPattern),state};const mmlValidator=Object(external_kbnSharedDeps_Lodash_.memoize)(estimatedMml=>Object(validators.a)(Object(validators.f)(),function(estimatedMml){return mml=>{if(!mml||!estimatedMml)return null;const mmlInBytes=external_kbnSharedDeps_ElasticNumeral_default()(mml.toUpperCase()).value();return external_kbnSharedDeps_ElasticNumeral_default()(estimatedMml.toUpperCase()).value()>mmlInBytes?{min:{minValue:estimatedMml,actualValue:mml}}:null}}(estimatedMml),Object(validators.c)())),validateMml=Object(external_kbnSharedDeps_Lodash_.memoize)((estimatedMml,mml)=>mmlValidator(estimatedMml)(mml),(...args)=>args.join("_")),validateForm=state=>{const{jobIdEmpty:jobIdEmpty,jobIdValid:jobIdValid,jobIdExists:jobIdExists,jobType:jobType,sourceIndexNameEmpty:sourceIndexNameEmpty,sourceIndexNameValid:sourceIndexNameValid,destinationIndexNameEmpty:destinationIndexNameEmpty,destinationIndexNameValid:destinationIndexNameValid,destinationIndexPatternTitleExists:destinationIndexPatternTitleExists,createIndexPattern:createIndexPattern,dependentVariable:dependentVariable,modelMemoryLimit:modelMemoryLimit,numTopFeatureImportanceValuesValid:numTopFeatureImportanceValuesValid}=state.form,{estimatedModelMemoryLimit:estimatedModelMemoryLimit}=state,jobTypeEmpty=void 0===jobType,dependentVariableEmpty=(jobType===data_frame_analytics.a.REGRESSION||jobType===data_frame_analytics.a.CLASSIFICATION)&&""===dependentVariable,mmlValidationResult=validateMml(estimatedModelMemoryLimit,modelMemoryLimit),mmlInvalid=null!==mmlValidationResult&&(void 0!==mmlValidationResult.invalidUnits||!0===mmlValidationResult.required);return state.form.modelMemoryLimitValidationResult=mmlValidationResult,state.isValid=!jobTypeEmpty&&!mmlInvalid&&!jobIdEmpty&&jobIdValid&&!jobIdExists&&!sourceIndexNameEmpty&&sourceIndexNameValid&&!destinationIndexNameEmpty&&destinationIndexNameValid&&!dependentVariableEmpty&&numTopFeatureImportanceValuesValid&&(!destinationIndexPatternTitleExists||!createIndexPattern),state};function reducer(state,action){switch(action.type){case actions.a.ADD_REQUEST_MESSAGE:const requestMessages=state.requestMessages;return requestMessages.push(action.requestMessage),{...state,requestMessages:requestMessages};case actions.a.RESET_REQUEST_MESSAGES:return{...state,requestMessages:[]};case actions.a.RESET_ADVANCED_EDITOR_MESSAGES:return{...state,advancedEditorMessages:[]};case actions.a.RESET_FORM:return Object(use_create_analytics_form_state.e)();case actions.a.SET_ADVANCED_EDITOR_RAW_STRING:let resultJobConfig,disableSwitchToForm=!1;try{resultJobConfig=JSON.parse(Object(shared_imports.b)(action.advancedEditorRawString));const runtimeMappingsChanged=state.form.runtimeMappings&&resultJobConfig.source.runtime_mappings&&!Object(external_kbnSharedDeps_Lodash_.isEqual)(state.form.runtimeMappings,resultJobConfig.source.runtime_mappings);disableSwitchToForm=Object(clone_action_name.d)(resultJobConfig)||runtimeMappingsChanged}catch(e){return{...state,advancedEditorRawString:action.advancedEditorRawString,isAdvancedEditorValidJson:!1,disableSwitchToForm:!0,advancedEditorMessages:[]}}return{...validateAdvancedEditor({...state,jobConfig:resultJobConfig}),advancedEditorRawString:action.advancedEditorRawString,isAdvancedEditorValidJson:!0,disableSwitchToForm:disableSwitchToForm};case actions.a.SET_FORM_STATE:const newFormState={...state.form,...action.payload};if(void 0!==action.payload.destinationIndex&&(newFormState.destinationIndexNameEmpty=""===newFormState.destinationIndex,newFormState.destinationIndexNameValid=isValidIndexName(newFormState.destinationIndex),newFormState.destinationIndexPatternTitleExists=void 0!==state.indexPatternsMap[newFormState.destinationIndex]),void 0!==action.payload.jobId&&(newFormState.jobIdEmpty=""===newFormState.jobId,newFormState.jobIdValid=Object(job_utils.i)(newFormState.jobId),newFormState.jobIdInvalidMaxLength=!!Object(validators.b)(validation.b)(newFormState.jobId)),void 0!==action.payload.sourceIndex){newFormState.sourceIndexNameEmpty=""===newFormState.sourceIndex;const validationMessages=public_.indexPatterns.validate(newFormState.sourceIndex);newFormState.sourceIndexNameValid=0===Object.keys(validationMessages).length}return void 0!==action.payload.numTopFeatureImportanceValues&&(newFormState.numTopFeatureImportanceValuesValid=validateNumTopFeatureImportanceValues(null==newFormState?void 0:newFormState.numTopFeatureImportanceValues)),state.isAdvancedEditorEnabled?validateAdvancedEditor({...state,form:newFormState}):validateForm({...state,form:newFormState});case actions.a.SET_INDEX_PATTERN_TITLES:{const newState={...state,...action.payload};return newState.form.destinationIndexPatternTitleExists=void 0!==newState.indexPatternsMap[newState.form.destinationIndex],newState}case actions.a.SET_IS_JOB_CREATED:return{...state,isJobCreated:action.isJobCreated};case actions.a.SET_IS_JOB_STARTED:return{...state,isJobStarted:action.isJobStarted};case actions.a.SET_JOB_CONFIG:return validateAdvancedEditor({...state,jobConfig:action.payload});case actions.a.SWITCH_TO_ADVANCED_EDITOR:const jobConfig=Object(use_create_analytics_form_state.f)(state.form),shouldDisableSwitchToForm=Object(clone_action_name.d)(jobConfig);return validateAdvancedEditor({...state,advancedEditorRawString:JSON.stringify(jobConfig,null,2),isAdvancedEditorEnabled:!0,disableSwitchToForm:shouldDisableSwitchToForm,hasSwitchedToEditor:!0,jobConfig:jobConfig});case actions.a.SWITCH_TO_FORM:const{jobConfig:config}=state,{jobId:jobId}=state.form,formState={...state.form,...Object(use_create_analytics_form_state.d)(config,!1)};return"string"==typeof jobId&&""!==jobId.trim()&&(formState.jobId=jobId),formState.jobIdEmpty=""===jobId,formState.jobIdValid=Object(job_utils.i)(jobId),formState.jobIdInvalidMaxLength=!!Object(validators.b)(validation.b)(jobId),formState.destinationIndexNameEmpty=""===formState.destinationIndex,formState.destinationIndexNameValid=isValidIndexName(formState.destinationIndex||""),formState.destinationIndexPatternTitleExists=void 0!==state.indexPatternsMap[formState.destinationIndex||""],void 0!==formState.numTopFeatureImportanceValues&&(formState.numTopFeatureImportanceValuesValid=validateNumTopFeatureImportanceValues(formState.numTopFeatureImportanceValues)),validateForm({...state,form:formState,isAdvancedEditorEnabled:!1,advancedEditorRawString:JSON.stringify(config,null,2),jobConfig:config});case actions.a.SET_ESTIMATED_MODEL_MEMORY_LIMIT:return{...state,estimatedModelMemoryLimit:action.value};case actions.a.SET_JOB_CLONE:return{...state,cloneJob:action.cloneJob}}return state}},,,,,,,,,,,,,,,,,,,,,,,,,,,,function(module,exports,__webpack_require__){switch(window.__kbnThemeTag__){case"v7dark":return __webpack_require__(454);case"v7light":return __webpack_require__(456);case"v8dark":return __webpack_require__(458);case"v8light":return __webpack_require__(460)}},function(module,exports,__webpack_require__){var api=__webpack_require__(65),content=__webpack_require__(455);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){(exports=__webpack_require__(66)(!1)).push([module.i,'.ml-app .ml-icon-severity-critical,.ml-app .ml-icon-severity-major,.ml-app .ml-icon-severity-minor,.ml-app .ml-icon-severity-warning,.ml-app .ml-icon-severity-unknown{text-shadow:1px 1px 1px #343741}.ml-app .ml-icon-severity-critical{color:#FE5050}.ml-app .ml-icon-severity-major{color:#FBA740}.ml-app .ml-icon-severity-minor{color:#FDEC25}.ml-app .ml-icon-severity-warning{color:#8BC8FB}.ml-app .ml-icon-severity-unknown{color:#98A2B3}.ml-app .mlDataFrameAnalyticsRegression__evaluateStat{padding-top:24px}.ml-app .mlJobMapLegend__container{background-color:\'#FFFFFF\'}.ml-app .mlJobMapLegend__indexPattern{height:12px;width:12px;background-color:#fff;border:2px solid #D36086;transform:rotate(45deg);display:\'inline-block\'}.ml-app .mlJobMapLegend__transform{height:12px;width:12px;background-color:#fff;border:2px solid #6092C0;display:\'inline-block\'}.ml-app .mlJobMapLegend__analytics{height:12px;width:12px;background-color:#fff;border:2px solid #54B399;border-radius:50%;display:\'inline-block\'}.ml-app .mlJobMapLegend__sourceNode{height:12px;width:12px;background-color:#FFCE7A;border:1px solid #343741;border-radius:4px;display:\'inline-block\'}.ml-app .mlAnalyticsTable .euiTableRow-isExpandedRow .euiTableCellContent{animation:none !important}.ml-app .mlAnalyticsTable .euiTableRow-isExpandedRow .euiTableCellContent .euiTableCellContent__text{width:100%}.ml-app .mlAnalyticsTable .euiIcon-isLoaded{animation:none !important}.ml-app .mlTaskStateBadge,.ml-app .mlTaskModeBadge{max-width:100px}.ml-app .dataFrameAnalyticsCreateSearchDialog{width:720px;min-height:600px}.ml-app .dfAnalyticsCreationWizard__card{width:300px}.ml-app .mlFieldDataTopValuesContainer{padding-top:4px}.ml-app .mlTopValuesValueLabelContainer{margin-right:12px}.ml-app .mlTopValuesValueLabelContainer.mlTopValuesValueLabelContainer--small{width:70px}.ml-app .mlTopValuesValueLabelContainer.mlTopValuesValueLabelContainer--large{width:200px}.ml-app .mlTopValuesPercentLabelContainer{margin-left:12px;width:70px}.ml-app .mlMetricDistributionChartContainer{padding-top:4px;width:100%}@media only screen and (max-width: 574px){.ml-app .mlDataVisualizerExpandedRow{flex-direction:column}}@media only screen and (min-width: 575px) and (max-width: 767px){.ml-app .mlDataVisualizerExpandedRow{flex-direction:column}}@media only screen and (min-width: 768px) and (max-width: 991px){.ml-app .mlDataVisualizerExpandedRow{flex-direction:column}}.ml-app .mlDataVisualizerFieldCountContainer{max-width:300px}.ml-app .mlDataVisualizerColumnHeaderIcon{max-width:12px}.ml-app .mlDataVisualizerFieldExpandedRow{padding-left:64px;width:100%}.ml-app .mlDataVisualizerFieldExpandedRow .mlFieldDataCard__valuesTitle{text-transform:uppercase;text-align:left;color:#98A2B3;font-weight:bold;padding-bottom:8px}.ml-app .mlDataVisualizerFieldExpandedRow .mlFieldDataCard__codeContent{font-family:"Roboto Mono",Consolas,Menlo,Courier,monospace;letter-spacing:normal}.ml-app .mlDataVisualizer .euiTableRow>.euiTableRowCell{border-bottom:0;border-top:1px solid #343741}.ml-app .mlDataVisualizer .euiTableRow-isExpandedRow .euiTableRowCell{background-color:#1D1E24 !important;border-top:0;border-bottom:1px solid #343741}.ml-app .mlDataVisualizer .euiTableRow-isExpandedRow .euiTableRowCell:hover{background-color:#1D1E24 !important}.ml-app .mlDataVisualizer .mlDataVisualizerSummaryTable{max-width:350px;min-width:250px}.ml-app .mlDataVisualizer .mlDataVisualizerSummaryTable .euiTableRow>.euiTableRowCell{border-bottom:0}.ml-app .mlDataVisualizer .mlDataVisualizerSummaryTable .euiTableHeaderCell{display:none}.ml-app .mlDataVisualizer .mlDataVisualizerSummaryTableWrapper{max-width:300px}.ml-app .mlDataVisualizer .mlDataVisualizerMapWrapper{min-height:300px;min-width:600px}.ml-app .ml-explorer{width:100%;display:inline-block;color:#98A2B3}.ml-app .ml-explorer .mlAnomalyExplorer__filterBar{padding-right:16px;padding-left:16px}.ml-app .ml-explorer .results-container{padding:0 0 16px 0}.ml-app .ml-explorer .results-container .col-xs-12{width:calc(100% - 32px);padding-left:16px}.ml-app .ml-explorer .results-container .no-influencers-warning{float:left;padding-top:4px;padding-left:16px;color:#98A2B3;font-size:14px}.ml-app .ml-explorer .results-container .panel-title{font-size:18px;font-weight:400;color:#98A2B3;display:inline-block;padding-bottom:4px}.ml-app .ml-explorer .results-container .panel-sub-title{color:#98A2B3;font-size:12px}.ml-app .ml-explorer .ml-anomalies-controls{padding-top:4px}.ml-app .ml-explorer .ml-anomalies-controls #show_charts_checkbox_control{padding-top:24px}.ml-app .mlSwimLaneContainer .echLegendListContainer{height:34px !important}.ml-app .mlSwimLaneContainer .echLegendList{display:flex !important;justify-content:space-between !important;flex-wrap:nowrap;position:absolute;right:0}.ml-app .ml-explorer-chart-eui-icon-tip{max-width:none}.ml-app .ml-explorer-chart-label-badges{margin-top:4px;display:flex;align-items:center}.ml-app .ml-reset-font-weight{font-weight:normal}.ml-app .ml-explorer-chart-container{overflow:hidden}.ml-app .ml-explorer-chart-container .ml-explorer-chart-svg{font-size:12px;font-family:"Inter UI",-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol"}.ml-app .ml-explorer-chart-container .ml-explorer-chart-svg .line-chart rect{fill:#1D1E24;opacity:1}.ml-app .ml-explorer-chart-container .ml-explorer-chart-svg .line-chart rect.selected-interval{fill:rgba(200,200,200,0.1);stroke:#98A2B3;stroke-width:2px;stroke-opacity:.8}.ml-app .ml-explorer-chart-container .ml-explorer-chart-svg .line-chart rect.scheduled-event-marker{stroke-width:1px;stroke:#98A2B3;fill:#343741;pointer-events:none}.ml-app .ml-explorer-chart-container .axis path,.ml-app .ml-explorer-chart-container .axis line{fill:none;stroke:#343741;shape-rendering:crispEdges}.ml-app .ml-explorer-chart-container .axis .tick line.ml-tick-emphasis{stroke:rgba(0,0,0,0.2)}.ml-app .ml-explorer-chart-container .axis text{fill:#98A2B3}.ml-app .ml-explorer-chart-container .axis .tick line{stroke:#343741;stroke-width:1px}.ml-app .ml-explorer-chart-container .values-line{fill:none;stroke:#1BA9F5;stroke-width:2}.ml-app .ml-explorer-chart-container .values-dots circle,.ml-app .ml-explorer-chart-container .values-dots-circle{fill:#1BA9F5;stroke-width:0}.ml-app .ml-explorer-chart-container .values-dots circle.values-dots-circle-blur{fill:#535966}.ml-app .ml-explorer-chart-container .metric-value{opacity:1;fill:transparent;stroke:#1BA9F5;stroke-width:0}.ml-app .ml-explorer-chart-container .anomaly-marker{stroke-width:1px;stroke:#535966}.ml-app .ml-explorer-chart-container .anomaly-marker:hover{stroke-width:6px;stroke:#1BA9F5}.ml-app .ml-explorer-chart-container .anomaly-marker.critical{fill:#FE5050}.ml-app .ml-explorer-chart-container .anomaly-marker.major{fill:#FBA740}.ml-app .ml-explorer-chart-container .anomaly-marker.minor{fill:#FDEC25}.ml-app .ml-explorer-chart-container .anomaly-marker.warning{fill:#8BC8FB}.ml-app .ml-explorer-chart-container .anomaly-marker.low{fill:#D2E9F7}.ml-app .ml-explorer-chart-container .metric-value:hover,.ml-app .ml-explorer-chart-container .anomaly-marker:hover{stroke-width:6px;stroke-opacity:.65}.ml-app .ml-explorer-chart{overflow:hidden}.ml-app .ml-explorer-chart-content-wrapper{height:215px}.ml-app .ml-explorer-chart-axis-emphasis{font-weight:bold}.ml-app .explorer-charts ml-explorer-charts-container .row{padding:10px}.ml-app .explorer-charts ml-explorer-charts-container label{font-size:12px}.ml-app .explorer-charts ml-explorer-charts-container select{font-size:14px;font-style:400}.ml-app .explorer-charts ml-explorer-charts-container .chart-controls label{padding:0 0 10px 0}.ml-app .explorer-charts ml-explorer-charts-container .no-results-item{text-align:center;padding-top:10px}.ml-app .explorer-charts ml-explorer-charts-container .ml-anomaly-interim-result{font-style:italic;padding-bottom:3px}.ml-app .explorer-charts ml-explorer-charts-container .ml-tablerow-expanded{width:100%;padding:5px 20px;overflow:hidden;font-size:12px}.ml-app .explorer-charts ml-explorer-charts-container .ml-tablerow-expanded td{padding:0 0 2px 0}.ml-app .explorer-charts ml-explorer-charts-container .ml-tablerow-expanded table tr>td:first-child{padding-left:2px;vertical-align:top}.ml-app .explorer-charts ml-explorer-charts-container .ml-tablerow-expanded td:first-child{width:140px}.ml-app .explorer-charts ml-explorer-charts-container .ml-tablerow-expanded td:nth-child(2){padding-left:5px}.ml-app .ml-explorer-chart-icons{float:right;padding-left:5px;margin:2px -8px 0 0}.ml-app .ml-edit-url-form .url-label{width:250px}.ml-app .ml-edit-url-form .url-link-to-radio .euiRadio{display:inline-block;padding-right:24px}.ml-app .ml-edit-url-form .url-time-range{width:150px}.ml-app .new-job-button-container{float:right}.ml-app .edit-custom-url-panel .close-editor-button{position:relative;float:right;top:-4px;right:0}.ml-app .tab-contents{margin:-8px;padding:8px;background-color:#1D1E24}.ml-app .tab-contents .col-md-6:nth-child(1){padding-right:7px}.ml-app .tab-contents .col-md-6:nth-child(2){padding-left:7px}.ml-app .tab-contents .job-section{overflow:auto;padding:5px 15px;background-color:#25262E;border:1px solid #343741;border-radius:4px;margin:4px 0}.ml-app .tab-contents .job-section .euiTable{background-color:transparent}.ml-app .tab-contents .job-section .euiTable .euiTableRow:first-child .euiTableRowCell{border-top:0}.ml-app .tab-contents .job-section .euiTable .euiTableRow:last-child .euiTableRowCell{border-bottom:0}.ml-app .tab-contents .job-section .euiTable .euiTableRow .euiTableRowCell{vertical-align:top;border-bottom:1px solid #343741}.ml-app .tab-contents .job-section .euiTable .euiTableRow .euiTableRowCell .euiTableCellContent__text{word-wrap:break-word}.ml-app .tab-contents .job-section .euiTable .euiTableRow:hover{background-color:inherit}.ml-app .tab-contents .job-section .job-item{font-size:12px}.ml-app .tab-contents .job-section .job-item.header{font-weight:bold}.ml-app .tab-contents .json-textarea{height:500px}.ml-app .job-messages-table{max-height:500px;overflow:auto;text-align:left}.ml-app .job-messages-table tr:last-child td{border-bottom:none}.ml-app .job-messages-table .euiTableRowCell{background-color:#1D1E24}.ml-app .mlJobFilterBar .euiFilterGroup .euiPopover .euiPanel .group-item{padding:8px 16px}.ml-app .mlJobFilterBar .euiFilterGroup .euiPopover .euiPanel .inline-group{border:1px solid #1D1E24;border-radius:4px}.ml-app .mlJobFilterBar .euiFilterGroup .euiPopover .euiPanel .euiFilterSelectItem:hover,.ml-app .mlJobFilterBar .euiFilterGroup .euiPopover .euiPanel .euiFilterSelectItem:focus{text-decoration:none}.ml-app .mlJobFilterBar .euiFilterGroup .euiPopover .euiPanel .euiFilterSelectItem:hover .inline-group,.ml-app .mlJobFilterBar .euiFilterGroup .euiPopover .euiPanel .euiFilterSelectItem:focus .inline-group{border:1px solid #98A2B3;box-shadow:0 1px 2px #535966}.ml-app .inline-group{font-size:12px;background-color:#343741;padding:2px 5px;border-radius:2px;display:inline-block;margin:0 3px;color:#1D1E24;vertical-align:text-top}.ml-app .jobs-list-table>div>.euiTable>thead th{text-align:left;white-space:normal}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(2){width:34px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(3){width:auto}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(4){width:20px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(5){width:auto}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(6){width:100px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(7){width:85px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(8){width:80px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(9){width:80px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(10){width:150px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(11){width:80px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(12){width:30px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(12) .euiTableCellContent__text{display:none}.ml-app .jobs-list-table>div>.euiTable>tbody td:nth-child(4) .euiTableCellContent{padding:0}.ml-app .jobs-list-table>div>.euiTable>tbody td:nth-child(10){white-space:nowrap}.ml-app .jobs-list-table>div>.euiTable>tbody .euiTableCellContent{animation:unset}.ml-app .jobs-list-table>div>.euiTable>tbody .euiTableRow.euiTableRow-isExpandedRow>td>div>.euiTableCellContent__text{width:100%}.ml-app .jobs-list-table>div>.euiTable>tbody .euiTableRow.euiTableRow-isExpandedRow>td>div>.euiTableCellContent__text .euiTableRowCell{background-color:inherit}.ml-app .jobs-list-table>div>.euiTable>tbody .euiTableRow>.euiTableRowCell>.euiTableCellContent>.euiTableCellContent__hoverItem{opacity:1}.ml-app .jobs-list-table>div>.euiTable>tbody .euiContextMenuPanel .euiContextMenuItem{white-space:nowrap}.ml-app .jobs-list-table>div>.euiTable>tbody .euiContextMenuPanel .euiContextMenuItem:last-child:not(.euiContextMenuItem-isDisabled){color:#F66}.ml-app .jobs-list-table>div>.euiTable>tbody .results-button{margin-right:4px;width:18px}.ml-app .jobs-list-table>div>.euiTable>tbody .euiContextMenuItem .euiIcon{margin-right:4px}.ml-app .jobs-list-table>div>.euiTable .job-description{display:inline-block}.ml-app .jobs-list-table>div>.euiTable .job-loading-spinner{text-align:center}.ml-app .jobs-list-table.jobs-selected .results-button{color:#343741;pointer-events:none}.ml-app .actions-bar{min-height:60px;display:flex;align-items:center}.ml-app .job-management{padding:20px}.ml-app .multi-select-actions .actions-border,.ml-app .multi-select-actions .actions-border-large{height:20px;border-right:1px solid #343741;width:1px;display:inline-block;vertical-align:middle;margin:0 5px}.ml-app .multi-select-actions .actions-border-large{height:35px;margin:0 15px}.ml-app .multi-select-actions .results-button{margin-right:5px}.ml-app .multi-select-actions .euiContextMenuPanel .euiContextMenuItem__text{white-space:nowrap}.ml-app .multi-select-actions .euiContextMenuPanel .euiContextMenuItem:last-child:not(.euiContextMenuItem-isDisabled){color:#F66}.ml-app .multi-select-actions-no-display{display:none}.ml-app .group-selector{max-width:300px}.ml-app .group-selector .euiPopoverTitle{margin-bottom:8px !important}.ml-app .group-list{max-height:350px;overflow:auto}.ml-app .group-list .group-item{line-height:18px;padding:6px 0;border-bottom:1px solid #343741;cursor:pointer}.ml-app .group-list .group-item:focus{background-color:#EEF6F9;box-shadow:none}.ml-app .group-list .group-item .check{width:20px;display:inline-block}.ml-app .group-list .group-item .inline-group{border:1px solid #1D1E24;border-radius:4px}.ml-app .group-list .group-item:hover .inline-group{border:1px solid #98A2B3;box-shadow:0 1px 2px #535966}.ml-app .group-list .group-item:last-child{margin-bottom:0;border-bottom:none}.ml-app .new-group-input{padding-bottom:0}.ml-app .ml-custom-urls-selection>.euiFlexGroup>.euiFlexItem:first-child{max-width:388px}.ml-app .ml-custom-urls-selection>.euiFlexGroup>.euiFlexItem:last-child{flex-basis:50%}.ml-app .mlOverviewPanel{padding-top:0}.ml-app .mlOverviewPanel__isLoading{text-align:center;padding:10%}.ml-app .mlOverviewPanel__buttons{float:right}.ml-app .mlOverviewPanel__spinner{display:inline-block}.ml-app .mlOverviewPanel__refreshButton{padding-right:12px}.ml-app .mlOverviewPanel__statsBar{margin-top:0;margin-right:0}.ml-app .mlSettingsPage .mlSettingsPage__header{width:1200px;margin-left:auto;margin-right:auto}.ml-app .mlSettingsPage .mlSettingsPage__content{width:1200px;margin-top:16px;margin-bottom:16px}.ml-app .ml-list-filter-lists .ml-list-filter-lists-content{max-width:1100px;margin-top:16px;margin-bottom:16px}.ml-app .ml-list-filter-lists .ml-filter-lists-table th:last-child,.ml-app .ml-list-filter-lists .ml-filter-lists-table td:last-child{width:70px}.ml-app .ml-edit-filter-lists .ml-edit-filter-lists-content{max-width:1100px;width:100%;margin-top:16px;margin-bottom:16px}.ml-app .ml-edit-filter-lists .ml-filter-list-usage>div{display:inline}.ml-app .ml-edit-filter-lists .ml-filter-list-usage .euiButtonEmpty.euiButtonEmpty--small{padding-bottom:4px}.ml-app .ml-edit-filter-lists .ml-filter-list-usage .euiButtonEmpty .euiButtonEmpty__content{padding:0 4px}.ml-app .ml-add-filter-item-popover .euiFormRow{width:300px;padding-bottom:4px}.ml-app .ml-filter-list-usage-popover li{line-height:24px}.ml-app .mlCalendarEditForm .mlCalendarEditForm__content{max-width:1200px;width:100%;margin-top:16px;margin-bottom:16px}.ml-app .mlCalendarList .mlCalendarList__content{max-width:1200px;margin-top:16px;margin-bottom:16px}.ml-app .ml-time-series-explorer{color:#98A2B3}.ml-app .ml-time-series-explorer .results-container .panel-title{font-size:18px;font-weight:400;color:#98A2B3}.ml-app .ml-time-series-explorer .results-container .entity-count-text{color:#7DE2D1;font-size:14px}.ml-app .ml-time-series-explorer .forecast-controls{float:right}.ml-app .ml-time-series-explorer .ml-anomalies-controls{padding-top:4px}.ml-app .ml-time-series-explorer .ml-timeseries-chart svg{font-size:12px;font-family:"Inter UI",-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol"}.ml-app .ml-time-series-explorer .ml-timeseries-chart .axis path,.ml-app .ml-time-series-explorer .ml-timeseries-chart .axis line{fill:none;stroke:#343741;shape-rendering:crispEdges;pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .axis text{fill:#DFE5EF}.ml-app .ml-time-series-explorer .ml-timeseries-chart .axis .tick line{stroke:#343741}.ml-app .ml-time-series-explorer .ml-timeseries-chart .chart-border{stroke:#343741;fill:none;stroke-width:1;shape-rendering:crispEdges}.ml-app .ml-time-series-explorer .ml-timeseries-chart .chart-border-highlight{stroke:#98A2B3;stroke-width:2}.ml-app .ml-time-series-explorer .ml-timeseries-chart .chart-border-highlight:hover{opacity:1}.ml-app .ml-time-series-explorer .ml-timeseries-chart .area{stroke-width:1}.ml-app .ml-time-series-explorer .ml-timeseries-chart .area.bounds{fill:rgba(27,169,245,0.2);pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .values-line{fill:none;stroke:#1BA9F5;stroke-width:2;pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .values-line.forecast{stroke:#D6BF57;pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .hidden{visibility:hidden}.ml-app .ml-time-series-explorer .ml-timeseries-chart .area.forecast{fill:rgba(214,191,87,0.3);pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .metric-value{opacity:1;fill:transparent;stroke:#1BA9F5;stroke-width:0}.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker{stroke-width:1px;stroke:#535966}.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.critical{fill:#FE5050}.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.major{fill:#FBA740}.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.minor{fill:#FDEC25}.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.warning{fill:#8BC8FB}.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.low{fill:#D2E9F7}.ml-app .ml-time-series-explorer .ml-timeseries-chart .metric-value:hover,.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker:hover,.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.highlighted{stroke-width:6px;stroke-opacity:.65;stroke:#1BA9F5}.ml-app .ml-time-series-explorer .ml-timeseries-chart rect.scheduled-event-marker{stroke-width:1px;stroke:#98A2B3;fill:#343741;pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .forecast .metric-value,.ml-app .ml-time-series-explorer .ml-timeseries-chart .forecast .metric-value:hover{stroke:#D6BF57}.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .x-axis-background line{fill:none;shape-rendering:crispEdges;stroke:#25262E}.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .x-axis-background rect{fill:#25262E}.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .focus-zoom{fill:#98A2B3}.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .focus-zoom a text{fill:#1BA9F5;cursor:pointer}.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .focus-zoom a:hover,.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .focus-zoom a:active,.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .focus-zoom a:focus{text-decoration:underline}.ml-app .ml-time-series-explorer .ml-timeseries-chart .context-chart .x.axis path{display:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .context-chart .axis text{font-size:10px;fill:#DFE5EF}.ml-app .ml-time-series-explorer .ml-timeseries-chart .context-chart .values-line{stroke-width:1}.ml-app .ml-time-series-explorer .ml-timeseries-chart .context-chart .mask polygon{fill-opacity:.1}.ml-app .ml-time-series-explorer .ml-timeseries-chart .context-chart .mask .area.bounds{fill:#343741}.ml-app .ml-time-series-explorer .ml-timeseries-chart .context-chart .mask .values-line{stroke-width:1;stroke:#535966}.ml-app .ml-time-series-explorer .ml-timeseries-chart .swimlane .axis text{display:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .swimlane rect.swimlane-cell-hidden{display:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .brush .extent{fill-opacity:0;shape-rendering:crispEdges;stroke:#98A2B3;stroke-width:2;cursor:move}.ml-app .ml-time-series-explorer .ml-timeseries-chart .brush .extent:hover{opacity:1}.ml-app .ml-time-series-explorer .ml-timeseries-chart .top-border{fill:#1D1E24}.ml-app .ml-time-series-explorer .ml-timeseries-chart foreignObject.brush-handle{pointer-events:none;padding-top:1px}.ml-app .ml-time-series-explorer .ml-timeseries-chart div.brush-handle-inner{border:1px solid #98A2B3;background-color:#343741;height:70px;width:10px;text-align:center;cursor:ew-resize;margin-top:9px;font-size:14px;fill:#98A2B3}.ml-app .ml-time-series-explorer .ml-timeseries-chart div.brush-handle-inner-left{border-radius:4px 0 0 4px}.ml-app .ml-time-series-explorer .ml-timeseries-chart div.brush-handle-inner-right{border-radius:0 4px 4px 0}.ml-app .ml-time-series-explorer .ml-timeseries-chart rect.brush-handle{stroke-width:1;stroke:#98A2B3;fill:#343741;pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart rect.brush-handle:hover{opacity:1}.ml-app .mlTimeSeriesExplorerProgress{background-color:#1D1E24}.ml-app .mlTimeSeriesExplorerProgress::-moz-progress-bar,.ml-app .mlTimeSeriesExplorerProgress::-webkit-progress-bar{background-color:#1D1E24}.ml-app .mlAnnotationBrush .extent{stroke:#343741;stroke-width:2px;stroke-dasharray:2 2;fill:#25262E;shape-rendering:geometricPrecision}.ml-app .mlAnnotationRect{stroke:#fff;stroke-width:2px;stroke-opacity:.2;transition:stroke-opacity 150ms;fill:#fff;fill-opacity:.05;transition:fill-opacity 150ms;shape-rendering:geometricPrecision}.ml-app .mlAnnotationRect-isHighlight{stroke-opacity:.4;transition:stroke-opacity 150ms;fill-opacity:.1;transition:fill-opacity 150ms}.ml-app .mlAnnotationRect-isBlur{stroke-opacity:.1;transition:stroke-opacity 150ms;fill-opacity:.025;transition:fill-opacity 150ms}.ml-app .mlAnnotationText{text-anchor:middle;font-size:12px;font-family:"Inter UI",-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";font-weight:500;fill:#fff;transition:fill 150ms;-webkit-user-select:none;user-select:none}.ml-app .mlAnnotationText-isBlur{fill:#535966;transition:fill 150ms}.ml-app .mlAnnotationTextRect{fill:#343741;transition:fill 150ms}.ml-app .mlAnnotationTextRect-isBlur{fill:#25262E;transition:fill 150ms}.ml-app .mlAnnotationHidden{display:none}.ml-app .mlContextAnnotationRect{stroke:#fff;stroke-width:2px;stroke-opacity:.2;transition:stroke-opacity 150ms;fill:#fff;fill-opacity:.05;transition:fill-opacity 150ms;shape-rendering:geometricPrecision}.ml-app .mlContextAnnotationRect-isBlur{stroke-opacity:.1;transition:stroke-opacity 150ms;fill-opacity:.025;transition:fill-opacity 150ms}.ml-app .euiDescriptionList.euiDescriptionList--column.ml-annotation-description-list .euiDescriptionList__title{flex-basis:30%}.ml-app .euiDescriptionList.euiDescriptionList--column.ml-annotation-description-list .euiDescriptionList__description{flex-basis:70%}.ml-app .euiDescriptionList.euiDescriptionList--column.ml-annotation-description-list>*{margin-top:4px}.ml-app .ml-anomalies-table .ml-icon-severity-critical,.ml-app .ml-anomalies-table .ml-icon-severity-major,.ml-app .ml-anomalies-table .ml-icon-severity-minor,.ml-app .ml-anomalies-table .ml-icon-severity-warning,.ml-app .ml-anomalies-table .ml-icon-severity-unknown{color:inherit;text-shadow:none}.ml-app .ml-anomalies-table .ml-icon-severity-critical .euiIcon{fill:#FE5050}.ml-app .ml-anomalies-table .ml-icon-severity-major .euiIcon{fill:#FBA740}.ml-app .ml-anomalies-table .ml-icon-severity-minor .euiIcon{fill:#FDEC25}.ml-app .ml-anomalies-table .ml-icon-severity-warning .euiIcon{fill:#8BC8FB}.ml-app .ml-anomalies-table .ml-icon-severity-unknown .euiIcon{fill:#98A2B3}.ml-app .ml-anomalies-table tr th:first-child,.ml-app .ml-anomalies-table tr td:first-child{width:32px}.ml-app .ml-anomalies-table .euiTableCellContent .euiHealth{font-size:inherit}.ml-app .ml-anomalies-table .euiTableCellContent .detector-rules-icon{margin-left:4px;opacity:.5}.ml-app .ml-anomalies-table .euiContextMenuItem{min-width:150px}.ml-app .ml-anomalies-table .mlAnomalyCategoryExamples__header{display:inline}.ml-app .ml-anomalies-table .mlAnomalyCategoryExamples__link{width:100%}.ml-app .ml-anomalies-table .category-example{display:block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.ml-app .ml-anomalies-table .mlAnomalyCategoryExamples{padding:24px}.ml-app .ml-anomalies-table .mlAnomalyCategoryExamples__item{display:block;white-space:wrap;font-family:"Roboto Mono",Consolas,Menlo,Courier,monospace}.ml-app .ml-anomalies-table .interim-result{font-style:italic}.ml-app .ml-anomalies-table .ml-anomalies-table-details{padding:4px 32px;max-height:1000px;overflow-y:auto}.ml-app .ml-anomalies-table .ml-anomalies-table-details .anomaly-description-list .euiDescriptionList__title{margin-top:0;flex-basis:15%;font-size:inherit;line-height:1.5rem;max-width:100%;overflow:hidden !important;text-overflow:ellipsis !important;white-space:nowrap !important;word-wrap:normal !important}.ml-app .ml-anomalies-table .ml-anomalies-table-details .anomaly-description-list .euiDescriptionList__description{margin-top:0;flex-basis:85%;font-size:inherit;line-height:1.5rem}.ml-app .mlColorRangeLegend text{font-size:10px;font-size:.625rem;fill:#98A2B3}.ml-app .mlColorRangeLegend .axis path{fill:none;stroke:none}.ml-app .mlColorRangeLegend .axis line{fill:none;stroke:#535966;shape-rendering:crispEdges}.ml-app .ml-table-controls label{font-size:12px;padding:0 0 4px 4px}.ml-app .ml-table-controls .ml-table-controls-element{display:inline-block;padding-left:16px}.ml-app .ml-table-controls select{font-size:12px;font-style:normal}.ml-app .ml-select-severity .euiFormControlLayoutClearButton{display:none}.ml-app .field-value-short{max-width:100%;overflow:hidden !important;text-overflow:ellipsis !important;white-space:nowrap !important;word-wrap:normal !important;display:inline-block;vertical-align:bottom}.ml-app .field-value-long{overflow-wrap:break-word}.ml-app .filter-button{opacity:.5;width:16px;height:16px;transform:translateY(-1px)}.ml-app .filter-button .euiIcon{width:12px;height:12px}.ml-app .filter-button:hover{opacity:1}.ml-app .ml-field-title-bar{font-size:18px;font-size:1.125rem;line-height:1.5;font-family:Roboto Mono, serif;font-style:normal;font-weight:bold;font-size:14px;border-radius:4px 4px 0 0;padding:4px;margin:-16px -16px 0 -16px;border-top:3px solid;text-align:center}.ml-app .ml-field-title-bar .field-type-icon{vertical-align:middle;margin-bottom:-4px;display:inline-block}.ml-app .ml-field-title-bar .field-name{max-width:100%;overflow:hidden !important;text-overflow:ellipsis !important;white-space:nowrap !important;word-wrap:normal !important;vertical-align:middle;padding-right:8px;max-width:290px;display:inline-block;margin-left:8px}.ml-app .ml-influencers-list{line-height:1.45}.ml-app .ml-influencers-list .field-label{font-size:12px;text-align:left;max-height:14px;max-width:calc(100% - 102px)}.ml-app .ml-influencers-list .field-label .field-value{max-width:100%;overflow:hidden !important;text-overflow:ellipsis !important;white-space:nowrap !important;word-wrap:normal !important;display:inline-block;vertical-align:bottom}.ml-app .ml-influencers-list .progress{display:inline-block;width:calc(100% - 34px);height:22px;min-width:70px;margin-bottom:0;color:#98A2B3;background-color:transparent}.ml-app .ml-influencers-list .progress .progress-bar-holder{width:calc(100% - 28px)}.ml-app .ml-influencers-list .progress .progress-bar{height:2px;margin-top:12px;text-align:right;line-height:18px;display:inline-block;transition:none}.ml-app .ml-influencers-list .progress.critical .progress-bar{background-color:#FE5050}.ml-app .ml-influencers-list .progress.critical .score-label{border-color:#FE5050}.ml-app .ml-influencers-list .progress.major .progress-bar{background-color:#FBA740}.ml-app .ml-influencers-list .progress.major .score-label{border-color:#FBA740}.ml-app .ml-influencers-list .progress.minor .progress-bar{background-color:#FDEC25}.ml-app .ml-influencers-list .progress.minor .score-label{border-color:#FDEC25}.ml-app .ml-influencers-list .progress.warning .progress-bar{background-color:#8BC8FB}.ml-app .ml-influencers-list .progress.warning .score-label{border-color:#8BC8FB}.ml-app .ml-influencers-list .score-label{text-align:center;line-height:14px;white-space:nowrap;font-size:12px;display:inline;margin-left:4px}.ml-app .ml-influencers-list .total-score-label{width:32px;vertical-align:top;text-align:center;color:#98A2B3;font-size:11px;line-height:14px;border-radius:4px;padding:2px;margin-top:4px;display:inline-block;border:1px solid #343741}.ml-app .ml-influencers-list-tooltip{word-break:break-all}.ml-app .ml-items-grid-page-size-menu{width:140px}.ml-app .mlJobSelectorBar{padding:8px}.ml-app .mlJobSelectorFlyoutBody>.euiFlyoutBody__overflow{padding-top:8px}.ml-app .mlJobSelector__ganttBar{background-color:#79ADDA;height:12px;border-radius:2px}.ml-app .mlJobSelector__ganttBarBackEdge{height:16px;border-left:1px solid #D6D6D6;border-right:1px solid #D6D6D6;margin-bottom:-14px;padding-top:8px}.ml-app .mlJobSelector__ganttBarDashed{height:1px;border-top:1px dashed #D6D6D6}.ml-app .mlJobSelector__ganttBarRunning{background-image:linear-gradient(45deg, rgba(255,255,255,0.15) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.15) 50%, rgba(255,255,255,0.15) 75%, transparent 75%, transparent);background-size:40px 40px;animation:progress-bar-stripes 2s linear infinite}.ml-app .ml-loading-indicator{text-align:center;font-size:17px;display:flex;flex-direction:column;align-items:center;justify-content:center}.ml-app .mlNavigationMenu{padding:0 12px;border-bottom:1px solid #343741;background-color:#1D1E24}.ml-app .ml-rule-editor-flyout{font-size:14px}.ml-app .ml-rule-editor-flyout .select-rule-action .rule-detector-description-list{padding-left:16px}.ml-app .ml-rule-editor-flyout .select-rule-action-panel{padding:8px 0}.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList .euiDescriptionList__title{flex-basis:15%;padding:0 16px}.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList .euiDescriptionList__description{flex-basis:85%}.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList .euiDescriptionList__title:nth-child(1),.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList .euiDescriptionList__description:nth-child(2){color:#DFE5EF;font-weight:700;border-bottom:1px solid #343741;padding-bottom:12px}.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList .euiDescriptionList__title:nth-child(3),.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList .euiDescriptionList__description:nth-child(4){padding-top:8px}.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList.euiDescriptionList--column>*{margin-top:4px}.ml-app .ml-rule-editor-flyout .scope-enable-checkbox .euiCheckbox__input[disabled] ~ .euiCheckbox__label{color:inherit}.ml-app .ml-rule-editor-flyout .scope-field-checkbox{margin-right:2px}.ml-app .ml-rule-editor-flyout .scope-field-checkbox .euiCheckbox{margin-top:4px}.ml-app .ml-rule-editor-flyout .scope-field-button{pointer-events:none;border-bottom:none}.ml-app .ml-rule-editor-flyout .scope-edit-filter-link{line-height:32px;font-size:12px}.ml-app .ml-rule-editor-flyout .condition-edit-value-field{width:170px;height:28px;margin:0 2px}.ml-app .ml-rule-editor-flyout .condition-edit-value-field input{height:28px}.ml-app .ml-rule-editor-flyout .euiExpressionButton.disabled{pointer-events:none}.ml-app .ml-rule-editor-flyout .euiExpressionButton.disabled .euiExpressionButton__value,.ml-app .ml-rule-editor-flyout .euiExpressionButton.disabled .euiExpressionButton__description{color:#343741}.ml-app .ml-rule-editor-flyout .text-highlight{font-weight:700}.ml-app .euiDescriptionList.euiDescriptionList--column.rule-detector-description-list .euiDescriptionList__title{flex-basis:15%}.ml-app .euiDescriptionList.euiDescriptionList--column.rule-detector-description-list .euiDescriptionList__description{flex-basis:85%}.ml-app .euiDescriptionList.euiDescriptionList--column.rule-detector-description-list>*{margin-top:4px}.ml-app .stat{margin-right:8px}.ml-app .mlStatsBar{height:42px;padding:14px;background-color:#25262E}.ml-app .mlEmbeddedMapContent{width:100%;height:100%;display:flex;flex:1 1 100%;z-index:1;min-height:0}.ml-app .tab-datavisualizer_index_select,.ml-app .tab-timeseriesexplorer,.ml-app .tab-explorer{background-color:#1D1E24}.ml-app .button-wrapper{display:inline}.ml-app .button-wrapper.disabled .kuiButton[disabled]{pointer-events:none}.ml-app .button-wrapper.disabled{cursor:not-allowed}.ml-app .clear,.ml-app .clearfix{clear:both}.ml-app .mlDisableAntiAliasing{-webkit-font-smoothing:none}.ml-app .mlDisableAntiAliasing * canvas{image-rendering:pixelated}\n',""]),module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(65),content=__webpack_require__(457);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){(exports=__webpack_require__(66)(!1)).push([module.i,'.ml-app .ml-icon-severity-critical,.ml-app .ml-icon-severity-major,.ml-app .ml-icon-severity-minor,.ml-app .ml-icon-severity-warning,.ml-app .ml-icon-severity-unknown{text-shadow:1px 1px 1px #D3DAE6}.ml-app .ml-icon-severity-critical{color:#cf4141}.ml-app .ml-icon-severity-major{color:#9e6929}.ml-app .ml-icon-severity-minor{color:#7c7313}.ml-app .ml-icon-severity-warning{color:#537896}.ml-app .ml-icon-severity-unknown{color:#69707D}.ml-app .mlDataFrameAnalyticsRegression__evaluateStat{padding-top:24px}.ml-app .mlJobMapLegend__container{background-color:\'#FFFFFF\'}.ml-app .mlJobMapLegend__indexPattern{height:12px;width:12px;background-color:#fff;border:2px solid #D36086;transform:rotate(45deg);display:\'inline-block\'}.ml-app .mlJobMapLegend__transform{height:12px;width:12px;background-color:#fff;border:2px solid #6092C0;display:\'inline-block\'}.ml-app .mlJobMapLegend__analytics{height:12px;width:12px;background-color:#fff;border:2px solid #54B399;border-radius:50%;display:\'inline-block\'}.ml-app .mlJobMapLegend__sourceNode{height:12px;width:12px;background-color:#F5A700;border:1px solid #D3DAE6;border-radius:4px;display:\'inline-block\'}.ml-app .mlAnalyticsTable .euiTableRow-isExpandedRow .euiTableCellContent{animation:none !important}.ml-app .mlAnalyticsTable .euiTableRow-isExpandedRow .euiTableCellContent .euiTableCellContent__text{width:100%}.ml-app .mlAnalyticsTable .euiIcon-isLoaded{animation:none !important}.ml-app .mlTaskStateBadge,.ml-app .mlTaskModeBadge{max-width:100px}.ml-app .dataFrameAnalyticsCreateSearchDialog{width:720px;min-height:600px}.ml-app .dfAnalyticsCreationWizard__card{width:300px}.ml-app .mlFieldDataTopValuesContainer{padding-top:4px}.ml-app .mlTopValuesValueLabelContainer{margin-right:12px}.ml-app .mlTopValuesValueLabelContainer.mlTopValuesValueLabelContainer--small{width:70px}.ml-app .mlTopValuesValueLabelContainer.mlTopValuesValueLabelContainer--large{width:200px}.ml-app .mlTopValuesPercentLabelContainer{margin-left:12px;width:70px}.ml-app .mlMetricDistributionChartContainer{padding-top:4px;width:100%}@media only screen and (max-width: 574px){.ml-app .mlDataVisualizerExpandedRow{flex-direction:column}}@media only screen and (min-width: 575px) and (max-width: 767px){.ml-app .mlDataVisualizerExpandedRow{flex-direction:column}}@media only screen and (min-width: 768px) and (max-width: 991px){.ml-app .mlDataVisualizerExpandedRow{flex-direction:column}}.ml-app .mlDataVisualizerFieldCountContainer{max-width:300px}.ml-app .mlDataVisualizerColumnHeaderIcon{max-width:12px}.ml-app .mlDataVisualizerFieldExpandedRow{padding-left:64px;width:100%}.ml-app .mlDataVisualizerFieldExpandedRow .mlFieldDataCard__valuesTitle{text-transform:uppercase;text-align:left;color:#69707D;font-weight:bold;padding-bottom:8px}.ml-app .mlDataVisualizerFieldExpandedRow .mlFieldDataCard__codeContent{font-family:"Roboto Mono",Consolas,Menlo,Courier,monospace;letter-spacing:normal}.ml-app .mlDataVisualizer .euiTableRow>.euiTableRowCell{border-bottom:0;border-top:1px solid #D3DAE6}.ml-app .mlDataVisualizer .euiTableRow-isExpandedRow .euiTableRowCell{background-color:#fff !important;border-top:0;border-bottom:1px solid #D3DAE6}.ml-app .mlDataVisualizer .euiTableRow-isExpandedRow .euiTableRowCell:hover{background-color:#fff !important}.ml-app .mlDataVisualizer .mlDataVisualizerSummaryTable{max-width:350px;min-width:250px}.ml-app .mlDataVisualizer .mlDataVisualizerSummaryTable .euiTableRow>.euiTableRowCell{border-bottom:0}.ml-app .mlDataVisualizer .mlDataVisualizerSummaryTable .euiTableHeaderCell{display:none}.ml-app .mlDataVisualizer .mlDataVisualizerSummaryTableWrapper{max-width:300px}.ml-app .mlDataVisualizer .mlDataVisualizerMapWrapper{min-height:300px;min-width:600px}.ml-app .ml-explorer{width:100%;display:inline-block;color:#69707D}.ml-app .ml-explorer .mlAnomalyExplorer__filterBar{padding-right:16px;padding-left:16px}.ml-app .ml-explorer .results-container{padding:0 0 16px 0}.ml-app .ml-explorer .results-container .col-xs-12{width:calc(100% - 32px);padding-left:16px}.ml-app .ml-explorer .results-container .no-influencers-warning{float:left;padding-top:4px;padding-left:16px;color:#69707D;font-size:14px}.ml-app .ml-explorer .results-container .panel-title{font-size:18px;font-weight:400;color:#69707D;display:inline-block;padding-bottom:4px}.ml-app .ml-explorer .results-container .panel-sub-title{color:#69707D;font-size:12px}.ml-app .ml-explorer .ml-anomalies-controls{padding-top:4px}.ml-app .ml-explorer .ml-anomalies-controls #show_charts_checkbox_control{padding-top:24px}.ml-app .mlSwimLaneContainer .echLegendListContainer{height:34px !important}.ml-app .mlSwimLaneContainer .echLegendList{display:flex !important;justify-content:space-between !important;flex-wrap:nowrap;position:absolute;right:0}.ml-app .ml-explorer-chart-eui-icon-tip{max-width:none}.ml-app .ml-explorer-chart-label-badges{margin-top:4px;display:flex;align-items:center}.ml-app .ml-reset-font-weight{font-weight:normal}.ml-app .ml-explorer-chart-container{overflow:hidden}.ml-app .ml-explorer-chart-container .ml-explorer-chart-svg{font-size:12px;font-family:"Inter UI",-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol"}.ml-app .ml-explorer-chart-container .ml-explorer-chart-svg .line-chart rect{fill:#fff;opacity:1}.ml-app .ml-explorer-chart-container .ml-explorer-chart-svg .line-chart rect.selected-interval{fill:rgba(200,200,200,0.1);stroke:#69707D;stroke-width:2px;stroke-opacity:.8}.ml-app .ml-explorer-chart-container .ml-explorer-chart-svg .line-chart rect.scheduled-event-marker{stroke-width:1px;stroke:#69707D;fill:#D3DAE6;pointer-events:none}.ml-app .ml-explorer-chart-container .axis path,.ml-app .ml-explorer-chart-container .axis line{fill:none;stroke:#D3DAE6;shape-rendering:crispEdges}.ml-app .ml-explorer-chart-container .axis .tick line.ml-tick-emphasis{stroke:rgba(0,0,0,0.2)}.ml-app .ml-explorer-chart-container .axis text{fill:#69707D}.ml-app .ml-explorer-chart-container .axis .tick line{stroke:#D3DAE6;stroke-width:1px}.ml-app .ml-explorer-chart-container .values-line{fill:none;stroke:#006BB4;stroke-width:2}.ml-app .ml-explorer-chart-container .values-dots circle,.ml-app .ml-explorer-chart-container .values-dots-circle{fill:#006BB4;stroke-width:0}.ml-app .ml-explorer-chart-container .values-dots circle.values-dots-circle-blur{fill:#98A2B3}.ml-app .ml-explorer-chart-container .metric-value{opacity:1;fill:transparent;stroke:#006BB4;stroke-width:0}.ml-app .ml-explorer-chart-container .anomaly-marker{stroke-width:1px;stroke:#98A2B3}.ml-app .ml-explorer-chart-container .anomaly-marker:hover{stroke-width:6px;stroke:#006BB4}.ml-app .ml-explorer-chart-container .anomaly-marker.critical{fill:#FE5050}.ml-app .ml-explorer-chart-container .anomaly-marker.major{fill:#FBA740}.ml-app .ml-explorer-chart-container .anomaly-marker.minor{fill:#FDEC25}.ml-app .ml-explorer-chart-container .anomaly-marker.warning{fill:#8BC8FB}.ml-app .ml-explorer-chart-container .anomaly-marker.low{fill:#D2E9F7}.ml-app .ml-explorer-chart-container .metric-value:hover,.ml-app .ml-explorer-chart-container .anomaly-marker:hover{stroke-width:6px;stroke-opacity:.65}.ml-app .ml-explorer-chart{overflow:hidden}.ml-app .ml-explorer-chart-content-wrapper{height:215px}.ml-app .ml-explorer-chart-axis-emphasis{font-weight:bold}.ml-app .explorer-charts ml-explorer-charts-container .row{padding:10px}.ml-app .explorer-charts ml-explorer-charts-container label{font-size:12px}.ml-app .explorer-charts ml-explorer-charts-container select{font-size:14px;font-style:400}.ml-app .explorer-charts ml-explorer-charts-container .chart-controls label{padding:0 0 10px 0}.ml-app .explorer-charts ml-explorer-charts-container .no-results-item{text-align:center;padding-top:10px}.ml-app .explorer-charts ml-explorer-charts-container .ml-anomaly-interim-result{font-style:italic;padding-bottom:3px}.ml-app .explorer-charts ml-explorer-charts-container .ml-tablerow-expanded{width:100%;padding:5px 20px;overflow:hidden;font-size:12px}.ml-app .explorer-charts ml-explorer-charts-container .ml-tablerow-expanded td{padding:0 0 2px 0}.ml-app .explorer-charts ml-explorer-charts-container .ml-tablerow-expanded table tr>td:first-child{padding-left:2px;vertical-align:top}.ml-app .explorer-charts ml-explorer-charts-container .ml-tablerow-expanded td:first-child{width:140px}.ml-app .explorer-charts ml-explorer-charts-container .ml-tablerow-expanded td:nth-child(2){padding-left:5px}.ml-app .ml-explorer-chart-icons{float:right;padding-left:5px;margin:2px -8px 0 0}.ml-app .ml-edit-url-form .url-label{width:250px}.ml-app .ml-edit-url-form .url-link-to-radio .euiRadio{display:inline-block;padding-right:24px}.ml-app .ml-edit-url-form .url-time-range{width:150px}.ml-app .new-job-button-container{float:right}.ml-app .edit-custom-url-panel .close-editor-button{position:relative;float:right;top:-4px;right:0}.ml-app .tab-contents{margin:-8px;padding:8px;background-color:#fff}.ml-app .tab-contents .col-md-6:nth-child(1){padding-right:7px}.ml-app .tab-contents .col-md-6:nth-child(2){padding-left:7px}.ml-app .tab-contents .job-section{overflow:auto;padding:5px 15px;background-color:#F5F7FA;border:1px solid #D3DAE6;border-radius:4px;margin:4px 0}.ml-app .tab-contents .job-section .euiTable{background-color:transparent}.ml-app .tab-contents .job-section .euiTable .euiTableRow:first-child .euiTableRowCell{border-top:0}.ml-app .tab-contents .job-section .euiTable .euiTableRow:last-child .euiTableRowCell{border-bottom:0}.ml-app .tab-contents .job-section .euiTable .euiTableRow .euiTableRowCell{vertical-align:top;border-bottom:1px solid #D3DAE6}.ml-app .tab-contents .job-section .euiTable .euiTableRow .euiTableRowCell .euiTableCellContent__text{word-wrap:break-word}.ml-app .tab-contents .job-section .euiTable .euiTableRow:hover{background-color:inherit}.ml-app .tab-contents .job-section .job-item{font-size:12px}.ml-app .tab-contents .job-section .job-item.header{font-weight:bold}.ml-app .tab-contents .json-textarea{height:500px}.ml-app .job-messages-table{max-height:500px;overflow:auto;text-align:left}.ml-app .job-messages-table tr:last-child td{border-bottom:none}.ml-app .job-messages-table .euiTableRowCell{background-color:#fff}.ml-app .mlJobFilterBar .euiFilterGroup .euiPopover .euiPanel .group-item{padding:8px 16px}.ml-app .mlJobFilterBar .euiFilterGroup .euiPopover .euiPanel .inline-group{border:1px solid #fff;border-radius:4px}.ml-app .mlJobFilterBar .euiFilterGroup .euiPopover .euiPanel .euiFilterSelectItem:hover,.ml-app .mlJobFilterBar .euiFilterGroup .euiPopover .euiPanel .euiFilterSelectItem:focus{text-decoration:none}.ml-app .mlJobFilterBar .euiFilterGroup .euiPopover .euiPanel .euiFilterSelectItem:hover .inline-group,.ml-app .mlJobFilterBar .euiFilterGroup .euiPopover .euiPanel .euiFilterSelectItem:focus .inline-group{border:1px solid #69707D;box-shadow:0 1px 2px #98A2B3}.ml-app .inline-group{font-size:12px;background-color:#D3DAE6;padding:2px 5px;border-radius:2px;display:inline-block;margin:0 3px;color:#fff;vertical-align:text-top}.ml-app .jobs-list-table>div>.euiTable>thead th{text-align:left;white-space:normal}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(2){width:34px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(3){width:auto}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(4){width:20px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(5){width:auto}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(6){width:100px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(7){width:85px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(8){width:80px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(9){width:80px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(10){width:150px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(11){width:80px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(12){width:30px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(12) .euiTableCellContent__text{display:none}.ml-app .jobs-list-table>div>.euiTable>tbody td:nth-child(4) .euiTableCellContent{padding:0}.ml-app .jobs-list-table>div>.euiTable>tbody td:nth-child(10){white-space:nowrap}.ml-app .jobs-list-table>div>.euiTable>tbody .euiTableCellContent{animation:unset}.ml-app .jobs-list-table>div>.euiTable>tbody .euiTableRow.euiTableRow-isExpandedRow>td>div>.euiTableCellContent__text{width:100%}.ml-app .jobs-list-table>div>.euiTable>tbody .euiTableRow.euiTableRow-isExpandedRow>td>div>.euiTableCellContent__text .euiTableRowCell{background-color:inherit}.ml-app .jobs-list-table>div>.euiTable>tbody .euiTableRow>.euiTableRowCell>.euiTableCellContent>.euiTableCellContent__hoverItem{opacity:1}.ml-app .jobs-list-table>div>.euiTable>tbody .euiContextMenuPanel .euiContextMenuItem{white-space:nowrap}.ml-app .jobs-list-table>div>.euiTable>tbody .euiContextMenuPanel .euiContextMenuItem:last-child:not(.euiContextMenuItem-isDisabled){color:#BD271E}.ml-app .jobs-list-table>div>.euiTable>tbody .results-button{margin-right:4px;width:18px}.ml-app .jobs-list-table>div>.euiTable>tbody .euiContextMenuItem .euiIcon{margin-right:4px}.ml-app .jobs-list-table>div>.euiTable .job-description{display:inline-block}.ml-app .jobs-list-table>div>.euiTable .job-loading-spinner{text-align:center}.ml-app .jobs-list-table.jobs-selected .results-button{color:#D3DAE6;pointer-events:none}.ml-app .actions-bar{min-height:60px;display:flex;align-items:center}.ml-app .job-management{padding:20px}.ml-app .multi-select-actions .actions-border,.ml-app .multi-select-actions .actions-border-large{height:20px;border-right:1px solid #D3DAE6;width:1px;display:inline-block;vertical-align:middle;margin:0 5px}.ml-app .multi-select-actions .actions-border-large{height:35px;margin:0 15px}.ml-app .multi-select-actions .results-button{margin-right:5px}.ml-app .multi-select-actions .euiContextMenuPanel .euiContextMenuItem__text{white-space:nowrap}.ml-app .multi-select-actions .euiContextMenuPanel .euiContextMenuItem:last-child:not(.euiContextMenuItem-isDisabled){color:#BD271E}.ml-app .multi-select-actions-no-display{display:none}.ml-app .group-selector{max-width:300px}.ml-app .group-selector .euiPopoverTitle{margin-bottom:8px !important}.ml-app .group-list{max-height:350px;overflow:auto}.ml-app .group-list .group-item{line-height:18px;padding:6px 0;border-bottom:1px solid #D3DAE6;cursor:pointer}.ml-app .group-list .group-item:focus{background-color:#EEF6F9;box-shadow:none}.ml-app .group-list .group-item .check{width:20px;display:inline-block}.ml-app .group-list .group-item .inline-group{border:1px solid #fff;border-radius:4px}.ml-app .group-list .group-item:hover .inline-group{border:1px solid #69707D;box-shadow:0 1px 2px #98A2B3}.ml-app .group-list .group-item:last-child{margin-bottom:0;border-bottom:none}.ml-app .new-group-input{padding-bottom:0}.ml-app .ml-custom-urls-selection>.euiFlexGroup>.euiFlexItem:first-child{max-width:388px}.ml-app .ml-custom-urls-selection>.euiFlexGroup>.euiFlexItem:last-child{flex-basis:50%}.ml-app .mlOverviewPanel{padding-top:0}.ml-app .mlOverviewPanel__isLoading{text-align:center;padding:10%}.ml-app .mlOverviewPanel__buttons{float:right}.ml-app .mlOverviewPanel__spinner{display:inline-block}.ml-app .mlOverviewPanel__refreshButton{padding-right:12px}.ml-app .mlOverviewPanel__statsBar{margin-top:0;margin-right:0}.ml-app .mlSettingsPage .mlSettingsPage__header{width:1200px;margin-left:auto;margin-right:auto}.ml-app .mlSettingsPage .mlSettingsPage__content{width:1200px;margin-top:16px;margin-bottom:16px}.ml-app .ml-list-filter-lists .ml-list-filter-lists-content{max-width:1100px;margin-top:16px;margin-bottom:16px}.ml-app .ml-list-filter-lists .ml-filter-lists-table th:last-child,.ml-app .ml-list-filter-lists .ml-filter-lists-table td:last-child{width:70px}.ml-app .ml-edit-filter-lists .ml-edit-filter-lists-content{max-width:1100px;width:100%;margin-top:16px;margin-bottom:16px}.ml-app .ml-edit-filter-lists .ml-filter-list-usage>div{display:inline}.ml-app .ml-edit-filter-lists .ml-filter-list-usage .euiButtonEmpty.euiButtonEmpty--small{padding-bottom:4px}.ml-app .ml-edit-filter-lists .ml-filter-list-usage .euiButtonEmpty .euiButtonEmpty__content{padding:0 4px}.ml-app .ml-add-filter-item-popover .euiFormRow{width:300px;padding-bottom:4px}.ml-app .ml-filter-list-usage-popover li{line-height:24px}.ml-app .mlCalendarEditForm .mlCalendarEditForm__content{max-width:1200px;width:100%;margin-top:16px;margin-bottom:16px}.ml-app .mlCalendarList .mlCalendarList__content{max-width:1200px;margin-top:16px;margin-bottom:16px}.ml-app .ml-time-series-explorer{color:#69707D}.ml-app .ml-time-series-explorer .results-container .panel-title{font-size:18px;font-weight:400;color:#69707D}.ml-app .ml-time-series-explorer .results-container .entity-count-text{color:#017D73;font-size:14px}.ml-app .ml-time-series-explorer .forecast-controls{float:right}.ml-app .ml-time-series-explorer .ml-anomalies-controls{padding-top:4px}.ml-app .ml-time-series-explorer .ml-timeseries-chart svg{font-size:12px;font-family:"Inter UI",-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol"}.ml-app .ml-time-series-explorer .ml-timeseries-chart .axis path,.ml-app .ml-time-series-explorer .ml-timeseries-chart .axis line{fill:none;stroke:#D3DAE6;shape-rendering:crispEdges;pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .axis text{fill:#343741}.ml-app .ml-time-series-explorer .ml-timeseries-chart .axis .tick line{stroke:#D3DAE6}.ml-app .ml-time-series-explorer .ml-timeseries-chart .chart-border{stroke:#D3DAE6;fill:none;stroke-width:1;shape-rendering:crispEdges}.ml-app .ml-time-series-explorer .ml-timeseries-chart .chart-border-highlight{stroke:#69707D;stroke-width:2}.ml-app .ml-time-series-explorer .ml-timeseries-chart .chart-border-highlight:hover{opacity:1}.ml-app .ml-time-series-explorer .ml-timeseries-chart .area{stroke-width:1}.ml-app .ml-time-series-explorer .ml-timeseries-chart .area.bounds{fill:rgba(0,107,180,0.2);pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .values-line{fill:none;stroke:#006BB4;stroke-width:2;pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .values-line.forecast{stroke:#D6BF57;pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .hidden{visibility:hidden}.ml-app .ml-time-series-explorer .ml-timeseries-chart .area.forecast{fill:rgba(214,191,87,0.3);pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .metric-value{opacity:1;fill:transparent;stroke:#006BB4;stroke-width:0}.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker{stroke-width:1px;stroke:#98A2B3}.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.critical{fill:#FE5050}.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.major{fill:#FBA740}.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.minor{fill:#FDEC25}.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.warning{fill:#8BC8FB}.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.low{fill:#D2E9F7}.ml-app .ml-time-series-explorer .ml-timeseries-chart .metric-value:hover,.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker:hover,.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.highlighted{stroke-width:6px;stroke-opacity:.65;stroke:#006BB4}.ml-app .ml-time-series-explorer .ml-timeseries-chart rect.scheduled-event-marker{stroke-width:1px;stroke:#69707D;fill:#D3DAE6;pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .forecast .metric-value,.ml-app .ml-time-series-explorer .ml-timeseries-chart .forecast .metric-value:hover{stroke:#D6BF57}.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .x-axis-background line{fill:none;shape-rendering:crispEdges;stroke:#F5F7FA}.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .x-axis-background rect{fill:#F5F7FA}.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .focus-zoom{fill:#69707D}.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .focus-zoom a text{fill:#006BB4;cursor:pointer}.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .focus-zoom a:hover,.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .focus-zoom a:active,.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .focus-zoom a:focus{text-decoration:underline}.ml-app .ml-time-series-explorer .ml-timeseries-chart .context-chart .x.axis path{display:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .context-chart .axis text{font-size:10px;fill:#343741}.ml-app .ml-time-series-explorer .ml-timeseries-chart .context-chart .values-line{stroke-width:1}.ml-app .ml-time-series-explorer .ml-timeseries-chart .context-chart .mask polygon{fill-opacity:.1}.ml-app .ml-time-series-explorer .ml-timeseries-chart .context-chart .mask .area.bounds{fill:#D3DAE6}.ml-app .ml-time-series-explorer .ml-timeseries-chart .context-chart .mask .values-line{stroke-width:1;stroke:#98A2B3}.ml-app .ml-time-series-explorer .ml-timeseries-chart .swimlane .axis text{display:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .swimlane rect.swimlane-cell-hidden{display:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .brush .extent{fill-opacity:0;shape-rendering:crispEdges;stroke:#69707D;stroke-width:2;cursor:move}.ml-app .ml-time-series-explorer .ml-timeseries-chart .brush .extent:hover{opacity:1}.ml-app .ml-time-series-explorer .ml-timeseries-chart .top-border{fill:#fff}.ml-app .ml-time-series-explorer .ml-timeseries-chart foreignObject.brush-handle{pointer-events:none;padding-top:1px}.ml-app .ml-time-series-explorer .ml-timeseries-chart div.brush-handle-inner{border:1px solid #69707D;background-color:#D3DAE6;height:70px;width:10px;text-align:center;cursor:ew-resize;margin-top:9px;font-size:14px;fill:#69707D}.ml-app .ml-time-series-explorer .ml-timeseries-chart div.brush-handle-inner-left{border-radius:4px 0 0 4px}.ml-app .ml-time-series-explorer .ml-timeseries-chart div.brush-handle-inner-right{border-radius:0 4px 4px 0}.ml-app .ml-time-series-explorer .ml-timeseries-chart rect.brush-handle{stroke-width:1;stroke:#69707D;fill:#D3DAE6;pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart rect.brush-handle:hover{opacity:1}.ml-app .mlTimeSeriesExplorerProgress{background-color:#fff}.ml-app .mlTimeSeriesExplorerProgress::-moz-progress-bar,.ml-app .mlTimeSeriesExplorerProgress::-webkit-progress-bar{background-color:#fff}.ml-app .mlAnnotationBrush .extent{stroke:#D3DAE6;stroke-width:2px;stroke-dasharray:2 2;fill:#F5F7FA;shape-rendering:geometricPrecision}.ml-app .mlAnnotationRect{stroke:#000;stroke-width:2px;stroke-opacity:.2;transition:stroke-opacity 150ms;fill:#000;fill-opacity:.05;transition:fill-opacity 150ms;shape-rendering:geometricPrecision}.ml-app .mlAnnotationRect-isHighlight{stroke-opacity:.4;transition:stroke-opacity 150ms;fill-opacity:.1;transition:fill-opacity 150ms}.ml-app .mlAnnotationRect-isBlur{stroke-opacity:.1;transition:stroke-opacity 150ms;fill-opacity:.025;transition:fill-opacity 150ms}.ml-app .mlAnnotationText{text-anchor:middle;font-size:12px;font-family:"Inter UI",-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";font-weight:500;fill:#000;transition:fill 150ms;-webkit-user-select:none;user-select:none}.ml-app .mlAnnotationText-isBlur{fill:#98A2B3;transition:fill 150ms}.ml-app .mlAnnotationTextRect{fill:#D3DAE6;transition:fill 150ms}.ml-app .mlAnnotationTextRect-isBlur{fill:#F5F7FA;transition:fill 150ms}.ml-app .mlAnnotationHidden{display:none}.ml-app .mlContextAnnotationRect{stroke:#000;stroke-width:2px;stroke-opacity:.2;transition:stroke-opacity 150ms;fill:#000;fill-opacity:.05;transition:fill-opacity 150ms;shape-rendering:geometricPrecision}.ml-app .mlContextAnnotationRect-isBlur{stroke-opacity:.1;transition:stroke-opacity 150ms;fill-opacity:.025;transition:fill-opacity 150ms}.ml-app .euiDescriptionList.euiDescriptionList--column.ml-annotation-description-list .euiDescriptionList__title{flex-basis:30%}.ml-app .euiDescriptionList.euiDescriptionList--column.ml-annotation-description-list .euiDescriptionList__description{flex-basis:70%}.ml-app .euiDescriptionList.euiDescriptionList--column.ml-annotation-description-list>*{margin-top:4px}.ml-app .ml-anomalies-table .ml-icon-severity-critical,.ml-app .ml-anomalies-table .ml-icon-severity-major,.ml-app .ml-anomalies-table .ml-icon-severity-minor,.ml-app .ml-anomalies-table .ml-icon-severity-warning,.ml-app .ml-anomalies-table .ml-icon-severity-unknown{color:inherit;text-shadow:none}.ml-app .ml-anomalies-table .ml-icon-severity-critical .euiIcon{fill:#cf4141}.ml-app .ml-anomalies-table .ml-icon-severity-major .euiIcon{fill:#9e6929}.ml-app .ml-anomalies-table .ml-icon-severity-minor .euiIcon{fill:#7c7313}.ml-app .ml-anomalies-table .ml-icon-severity-warning .euiIcon{fill:#537896}.ml-app .ml-anomalies-table .ml-icon-severity-unknown .euiIcon{fill:#69707D}.ml-app .ml-anomalies-table tr th:first-child,.ml-app .ml-anomalies-table tr td:first-child{width:32px}.ml-app .ml-anomalies-table .euiTableCellContent .euiHealth{font-size:inherit}.ml-app .ml-anomalies-table .euiTableCellContent .detector-rules-icon{margin-left:4px;opacity:.5}.ml-app .ml-anomalies-table .euiContextMenuItem{min-width:150px}.ml-app .ml-anomalies-table .mlAnomalyCategoryExamples__header{display:inline}.ml-app .ml-anomalies-table .mlAnomalyCategoryExamples__link{width:100%}.ml-app .ml-anomalies-table .category-example{display:block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.ml-app .ml-anomalies-table .mlAnomalyCategoryExamples{padding:24px}.ml-app .ml-anomalies-table .mlAnomalyCategoryExamples__item{display:block;white-space:wrap;font-family:"Roboto Mono",Consolas,Menlo,Courier,monospace}.ml-app .ml-anomalies-table .interim-result{font-style:italic}.ml-app .ml-anomalies-table .ml-anomalies-table-details{padding:4px 32px;max-height:1000px;overflow-y:auto}.ml-app .ml-anomalies-table .ml-anomalies-table-details .anomaly-description-list .euiDescriptionList__title{margin-top:0;flex-basis:15%;font-size:inherit;line-height:1.5rem;max-width:100%;overflow:hidden !important;text-overflow:ellipsis !important;white-space:nowrap !important;word-wrap:normal !important}.ml-app .ml-anomalies-table .ml-anomalies-table-details .anomaly-description-list .euiDescriptionList__description{margin-top:0;flex-basis:85%;font-size:inherit;line-height:1.5rem}.ml-app .mlColorRangeLegend text{font-size:10px;font-size:.625rem;fill:#69707D}.ml-app .mlColorRangeLegend .axis path{fill:none;stroke:none}.ml-app .mlColorRangeLegend .axis line{fill:none;stroke:#98A2B3;shape-rendering:crispEdges}.ml-app .ml-table-controls label{font-size:12px;padding:0 0 4px 4px}.ml-app .ml-table-controls .ml-table-controls-element{display:inline-block;padding-left:16px}.ml-app .ml-table-controls select{font-size:12px;font-style:normal}.ml-app .ml-select-severity .euiFormControlLayoutClearButton{display:none}.ml-app .field-value-short{max-width:100%;overflow:hidden !important;text-overflow:ellipsis !important;white-space:nowrap !important;word-wrap:normal !important;display:inline-block;vertical-align:bottom}.ml-app .field-value-long{overflow-wrap:break-word}.ml-app .filter-button{opacity:.5;width:16px;height:16px;transform:translateY(-1px)}.ml-app .filter-button .euiIcon{width:12px;height:12px}.ml-app .filter-button:hover{opacity:1}.ml-app .ml-field-title-bar{font-size:18px;font-size:1.125rem;line-height:1.5;font-family:Roboto Mono, serif;font-style:normal;font-weight:bold;font-size:14px;border-radius:4px 4px 0 0;padding:4px;margin:-16px -16px 0 -16px;border-top:3px solid;text-align:center}.ml-app .ml-field-title-bar .field-type-icon{vertical-align:middle;margin-bottom:-4px;display:inline-block}.ml-app .ml-field-title-bar .field-name{max-width:100%;overflow:hidden !important;text-overflow:ellipsis !important;white-space:nowrap !important;word-wrap:normal !important;vertical-align:middle;padding-right:8px;max-width:290px;display:inline-block;margin-left:8px}.ml-app .ml-influencers-list{line-height:1.45}.ml-app .ml-influencers-list .field-label{font-size:12px;text-align:left;max-height:14px;max-width:calc(100% - 102px)}.ml-app .ml-influencers-list .field-label .field-value{max-width:100%;overflow:hidden !important;text-overflow:ellipsis !important;white-space:nowrap !important;word-wrap:normal !important;display:inline-block;vertical-align:bottom}.ml-app .ml-influencers-list .progress{display:inline-block;width:calc(100% - 34px);height:22px;min-width:70px;margin-bottom:0;color:#69707D;background-color:transparent}.ml-app .ml-influencers-list .progress .progress-bar-holder{width:calc(100% - 28px)}.ml-app .ml-influencers-list .progress .progress-bar{height:2px;margin-top:12px;text-align:right;line-height:18px;display:inline-block;transition:none}.ml-app .ml-influencers-list .progress.critical .progress-bar{background-color:#FE5050}.ml-app .ml-influencers-list .progress.critical .score-label{border-color:#FE5050}.ml-app .ml-influencers-list .progress.major .progress-bar{background-color:#FBA740}.ml-app .ml-influencers-list .progress.major .score-label{border-color:#FBA740}.ml-app .ml-influencers-list .progress.minor .progress-bar{background-color:#FDEC25}.ml-app .ml-influencers-list .progress.minor .score-label{border-color:#FDEC25}.ml-app .ml-influencers-list .progress.warning .progress-bar{background-color:#8BC8FB}.ml-app .ml-influencers-list .progress.warning .score-label{border-color:#8BC8FB}.ml-app .ml-influencers-list .score-label{text-align:center;line-height:14px;white-space:nowrap;font-size:12px;display:inline;margin-left:4px}.ml-app .ml-influencers-list .total-score-label{width:32px;vertical-align:top;text-align:center;color:#69707D;font-size:11px;line-height:14px;border-radius:4px;padding:2px;margin-top:4px;display:inline-block;border:1px solid #D3DAE6}.ml-app .ml-influencers-list-tooltip{word-break:break-all}.ml-app .ml-items-grid-page-size-menu{width:140px}.ml-app .mlJobSelectorBar{padding:8px}.ml-app .mlJobSelectorFlyoutBody>.euiFlyoutBody__overflow{padding-top:8px}.ml-app .mlJobSelector__ganttBar{background-color:#79ADDA;height:12px;border-radius:2px}.ml-app .mlJobSelector__ganttBarBackEdge{height:16px;border-left:1px solid #D6D6D6;border-right:1px solid #D6D6D6;margin-bottom:-14px;padding-top:8px}.ml-app .mlJobSelector__ganttBarDashed{height:1px;border-top:1px dashed #D6D6D6}.ml-app .mlJobSelector__ganttBarRunning{background-image:linear-gradient(45deg, rgba(255,255,255,0.15) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.15) 50%, rgba(255,255,255,0.15) 75%, transparent 75%, transparent);background-size:40px 40px;animation:progress-bar-stripes 2s linear infinite}.ml-app .ml-loading-indicator{text-align:center;font-size:17px;display:flex;flex-direction:column;align-items:center;justify-content:center}.ml-app .mlNavigationMenu{padding:0 12px;border-bottom:1px solid #D3DAE6;background-color:#fff}.ml-app .ml-rule-editor-flyout{font-size:14px}.ml-app .ml-rule-editor-flyout .select-rule-action .rule-detector-description-list{padding-left:16px}.ml-app .ml-rule-editor-flyout .select-rule-action-panel{padding:8px 0}.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList .euiDescriptionList__title{flex-basis:15%;padding:0 16px}.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList .euiDescriptionList__description{flex-basis:85%}.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList .euiDescriptionList__title:nth-child(1),.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList .euiDescriptionList__description:nth-child(2){color:#1a1c21;font-weight:700;border-bottom:1px solid #D3DAE6;padding-bottom:12px}.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList .euiDescriptionList__title:nth-child(3),.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList .euiDescriptionList__description:nth-child(4){padding-top:8px}.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList.euiDescriptionList--column>*{margin-top:4px}.ml-app .ml-rule-editor-flyout .scope-enable-checkbox .euiCheckbox__input[disabled] ~ .euiCheckbox__label{color:inherit}.ml-app .ml-rule-editor-flyout .scope-field-checkbox{margin-right:2px}.ml-app .ml-rule-editor-flyout .scope-field-checkbox .euiCheckbox{margin-top:4px}.ml-app .ml-rule-editor-flyout .scope-field-button{pointer-events:none;border-bottom:none}.ml-app .ml-rule-editor-flyout .scope-edit-filter-link{line-height:32px;font-size:12px}.ml-app .ml-rule-editor-flyout .condition-edit-value-field{width:170px;height:28px;margin:0 2px}.ml-app .ml-rule-editor-flyout .condition-edit-value-field input{height:28px}.ml-app .ml-rule-editor-flyout .euiExpressionButton.disabled{pointer-events:none}.ml-app .ml-rule-editor-flyout .euiExpressionButton.disabled .euiExpressionButton__value,.ml-app .ml-rule-editor-flyout .euiExpressionButton.disabled .euiExpressionButton__description{color:#D3DAE6}.ml-app .ml-rule-editor-flyout .text-highlight{font-weight:700}.ml-app .euiDescriptionList.euiDescriptionList--column.rule-detector-description-list .euiDescriptionList__title{flex-basis:15%}.ml-app .euiDescriptionList.euiDescriptionList--column.rule-detector-description-list .euiDescriptionList__description{flex-basis:85%}.ml-app .euiDescriptionList.euiDescriptionList--column.rule-detector-description-list>*{margin-top:4px}.ml-app .stat{margin-right:8px}.ml-app .mlStatsBar{height:42px;padding:14px;background-color:#F5F7FA}.ml-app .mlEmbeddedMapContent{width:100%;height:100%;display:flex;flex:1 1 100%;z-index:1;min-height:0}.ml-app .tab-datavisualizer_index_select,.ml-app .tab-timeseriesexplorer,.ml-app .tab-explorer{background-color:#fff}.ml-app .button-wrapper{display:inline}.ml-app .button-wrapper.disabled .kuiButton[disabled]{pointer-events:none}.ml-app .button-wrapper.disabled{cursor:not-allowed}.ml-app .clear,.ml-app .clearfix{clear:both}.ml-app .mlDisableAntiAliasing{-webkit-font-smoothing:none}.ml-app .mlDisableAntiAliasing * canvas{image-rendering:pixelated}\n',""]),module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(65),content=__webpack_require__(459);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){(exports=__webpack_require__(66)(!1)).push([module.i,'.ml-app .ml-icon-severity-critical,.ml-app .ml-icon-severity-major,.ml-app .ml-icon-severity-minor,.ml-app .ml-icon-severity-warning,.ml-app .ml-icon-severity-unknown{text-shadow:1px 1px 1px #343741}.ml-app .ml-icon-severity-critical{color:#FE5050}.ml-app .ml-icon-severity-major{color:#FBA740}.ml-app .ml-icon-severity-minor{color:#FDEC25}.ml-app .ml-icon-severity-warning{color:#8BC8FB}.ml-app .ml-icon-severity-unknown{color:#98A2B3}.ml-app .mlDataFrameAnalyticsRegression__evaluateStat{padding-top:24px}.ml-app .mlJobMapLegend__container{background-color:\'#FFFFFF\'}.ml-app .mlJobMapLegend__indexPattern{height:12px;width:12px;background-color:#fff;border:2px solid #D36086;transform:rotate(45deg);display:\'inline-block\'}.ml-app .mlJobMapLegend__transform{height:12px;width:12px;background-color:#fff;border:2px solid #6092C0;display:\'inline-block\'}.ml-app .mlJobMapLegend__analytics{height:12px;width:12px;background-color:#fff;border:2px solid #54B399;border-radius:50%;display:\'inline-block\'}.ml-app .mlJobMapLegend__sourceNode{height:12px;width:12px;background-color:#F3D371;border:1px solid #343741;border-radius:6px;display:\'inline-block\'}.ml-app .mlAnalyticsTable .euiTableRow-isExpandedRow .euiTableCellContent{animation:none !important}.ml-app .mlAnalyticsTable .euiTableRow-isExpandedRow .euiTableCellContent .euiTableCellContent__text{width:100%}.ml-app .mlAnalyticsTable .euiIcon-isLoaded{animation:none !important}.ml-app .mlTaskStateBadge,.ml-app .mlTaskModeBadge{max-width:100px}.ml-app .dataFrameAnalyticsCreateSearchDialog{width:720px;min-height:600px}.ml-app .dfAnalyticsCreationWizard__card{width:300px}.ml-app .mlFieldDataTopValuesContainer{padding-top:4px}.ml-app .mlTopValuesValueLabelContainer{margin-right:12px}.ml-app .mlTopValuesValueLabelContainer.mlTopValuesValueLabelContainer--small{width:70px}.ml-app .mlTopValuesValueLabelContainer.mlTopValuesValueLabelContainer--large{width:200px}.ml-app .mlTopValuesPercentLabelContainer{margin-left:12px;width:70px}.ml-app .mlMetricDistributionChartContainer{padding-top:4px;width:100%}@media only screen and (max-width: 574px){.ml-app .mlDataVisualizerExpandedRow{flex-direction:column}}@media only screen and (min-width: 575px) and (max-width: 767px){.ml-app .mlDataVisualizerExpandedRow{flex-direction:column}}@media only screen and (min-width: 768px) and (max-width: 991px){.ml-app .mlDataVisualizerExpandedRow{flex-direction:column}}.ml-app .mlDataVisualizerFieldCountContainer{max-width:300px}.ml-app .mlDataVisualizerColumnHeaderIcon{max-width:12px}.ml-app .mlDataVisualizerFieldExpandedRow{padding-left:64px;width:100%}.ml-app .mlDataVisualizerFieldExpandedRow .mlFieldDataCard__valuesTitle{text-transform:uppercase;text-align:left;color:#98A2B3;font-weight:bold;padding-bottom:8px}.ml-app .mlDataVisualizerFieldExpandedRow .mlFieldDataCard__codeContent{font-family:"Roboto Mono",Consolas,Menlo,Courier,monospace;letter-spacing:normal}.ml-app .mlDataVisualizer .euiTableRow>.euiTableRowCell{border-bottom:0;border-top:1px solid #343741}.ml-app .mlDataVisualizer .euiTableRow-isExpandedRow .euiTableRowCell{background-color:#1D1E24 !important;border-top:0;border-bottom:1px solid #343741}.ml-app .mlDataVisualizer .euiTableRow-isExpandedRow .euiTableRowCell:hover{background-color:#1D1E24 !important}.ml-app .mlDataVisualizer .mlDataVisualizerSummaryTable{max-width:350px;min-width:250px}.ml-app .mlDataVisualizer .mlDataVisualizerSummaryTable .euiTableRow>.euiTableRowCell{border-bottom:0}.ml-app .mlDataVisualizer .mlDataVisualizerSummaryTable .euiTableHeaderCell{display:none}.ml-app .mlDataVisualizer .mlDataVisualizerSummaryTableWrapper{max-width:300px}.ml-app .mlDataVisualizer .mlDataVisualizerMapWrapper{min-height:300px;min-width:600px}.ml-app .ml-explorer{width:100%;display:inline-block;color:#98A2B3}.ml-app .ml-explorer .mlAnomalyExplorer__filterBar{padding-right:16px;padding-left:16px}.ml-app .ml-explorer .results-container{padding:0 0 16px 0}.ml-app .ml-explorer .results-container .col-xs-12{width:calc(100% - 32px);padding-left:16px}.ml-app .ml-explorer .results-container .no-influencers-warning{float:left;padding-top:4px;padding-left:16px;color:#98A2B3;font-size:14px}.ml-app .ml-explorer .results-container .panel-title{font-size:16px;font-weight:400;color:#98A2B3;display:inline-block;padding-bottom:4px}.ml-app .ml-explorer .results-container .panel-sub-title{color:#98A2B3;font-size:12px}.ml-app .ml-explorer .ml-anomalies-controls{padding-top:4px}.ml-app .ml-explorer .ml-anomalies-controls #show_charts_checkbox_control{padding-top:24px}.ml-app .mlSwimLaneContainer .echLegendListContainer{height:34px !important}.ml-app .mlSwimLaneContainer .echLegendList{display:flex !important;justify-content:space-between !important;flex-wrap:nowrap;position:absolute;right:0}.ml-app .ml-explorer-chart-eui-icon-tip{max-width:none}.ml-app .ml-explorer-chart-label-badges{margin-top:4px;display:flex;align-items:center}.ml-app .ml-reset-font-weight{font-weight:normal}.ml-app .ml-explorer-chart-container{overflow:hidden}.ml-app .ml-explorer-chart-container .ml-explorer-chart-svg{font-size:12px;font-family:"Inter",-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol"}.ml-app .ml-explorer-chart-container .ml-explorer-chart-svg .line-chart rect{fill:#1D1E24;opacity:1}.ml-app .ml-explorer-chart-container .ml-explorer-chart-svg .line-chart rect.selected-interval{fill:rgba(200,200,200,0.1);stroke:#98A2B3;stroke-width:2px;stroke-opacity:.8}.ml-app .ml-explorer-chart-container .ml-explorer-chart-svg .line-chart rect.scheduled-event-marker{stroke-width:1px;stroke:#98A2B3;fill:#343741;pointer-events:none}.ml-app .ml-explorer-chart-container .axis path,.ml-app .ml-explorer-chart-container .axis line{fill:none;stroke:#343741;shape-rendering:crispEdges}.ml-app .ml-explorer-chart-container .axis .tick line.ml-tick-emphasis{stroke:rgba(0,0,0,0.2)}.ml-app .ml-explorer-chart-container .axis text{fill:#98A2B3}.ml-app .ml-explorer-chart-container .axis .tick line{stroke:#343741;stroke-width:1px}.ml-app .ml-explorer-chart-container .values-line{fill:none;stroke:#36A2EF;stroke-width:2}.ml-app .ml-explorer-chart-container .values-dots circle,.ml-app .ml-explorer-chart-container .values-dots-circle{fill:#36A2EF;stroke-width:0}.ml-app .ml-explorer-chart-container .values-dots circle.values-dots-circle-blur{fill:#535966}.ml-app .ml-explorer-chart-container .metric-value{opacity:1;fill:transparent;stroke:#36A2EF;stroke-width:0}.ml-app .ml-explorer-chart-container .anomaly-marker{stroke-width:1px;stroke:#535966}.ml-app .ml-explorer-chart-container .anomaly-marker:hover{stroke-width:6px;stroke:#36A2EF}.ml-app .ml-explorer-chart-container .anomaly-marker.critical{fill:#FE5050}.ml-app .ml-explorer-chart-container .anomaly-marker.major{fill:#FBA740}.ml-app .ml-explorer-chart-container .anomaly-marker.minor{fill:#FDEC25}.ml-app .ml-explorer-chart-container .anomaly-marker.warning{fill:#8BC8FB}.ml-app .ml-explorer-chart-container .anomaly-marker.low{fill:#D2E9F7}.ml-app .ml-explorer-chart-container .metric-value:hover,.ml-app .ml-explorer-chart-container .anomaly-marker:hover{stroke-width:6px;stroke-opacity:.65}.ml-app .ml-explorer-chart{overflow:hidden}.ml-app .ml-explorer-chart-content-wrapper{height:215px}.ml-app .ml-explorer-chart-axis-emphasis{font-weight:bold}.ml-app .explorer-charts ml-explorer-charts-container .row{padding:10px}.ml-app .explorer-charts ml-explorer-charts-container label{font-size:12px}.ml-app .explorer-charts ml-explorer-charts-container select{font-size:14px;font-style:400}.ml-app .explorer-charts ml-explorer-charts-container .chart-controls label{padding:0 0 10px 0}.ml-app .explorer-charts ml-explorer-charts-container .no-results-item{text-align:center;padding-top:10px}.ml-app .explorer-charts ml-explorer-charts-container .ml-anomaly-interim-result{font-style:italic;padding-bottom:3px}.ml-app .explorer-charts ml-explorer-charts-container .ml-tablerow-expanded{width:100%;padding:5px 20px;overflow:hidden;font-size:12px}.ml-app .explorer-charts ml-explorer-charts-container .ml-tablerow-expanded td{padding:0 0 2px 0}.ml-app .explorer-charts ml-explorer-charts-container .ml-tablerow-expanded table tr>td:first-child{padding-left:2px;vertical-align:top}.ml-app .explorer-charts ml-explorer-charts-container .ml-tablerow-expanded td:first-child{width:140px}.ml-app .explorer-charts ml-explorer-charts-container .ml-tablerow-expanded td:nth-child(2){padding-left:5px}.ml-app .ml-explorer-chart-icons{float:right;padding-left:5px;margin:2px -8px 0 0}.ml-app .ml-edit-url-form .url-label{width:250px}.ml-app .ml-edit-url-form .url-link-to-radio .euiRadio{display:inline-block;padding-right:24px}.ml-app .ml-edit-url-form .url-time-range{width:150px}.ml-app .new-job-button-container{float:right}.ml-app .edit-custom-url-panel .close-editor-button{position:relative;float:right;top:-4px;right:0}.ml-app .tab-contents{margin:-8px;padding:8px;background-color:#1D1E24}.ml-app .tab-contents .col-md-6:nth-child(1){padding-right:7px}.ml-app .tab-contents .col-md-6:nth-child(2){padding-left:7px}.ml-app .tab-contents .job-section{overflow:auto;padding:5px 15px;background-color:#25262E;border:1px solid #343741;border-radius:6px;margin:4px 0}.ml-app .tab-contents .job-section .euiTable{background-color:transparent}.ml-app .tab-contents .job-section .euiTable .euiTableRow:first-child .euiTableRowCell{border-top:0}.ml-app .tab-contents .job-section .euiTable .euiTableRow:last-child .euiTableRowCell{border-bottom:0}.ml-app .tab-contents .job-section .euiTable .euiTableRow .euiTableRowCell{vertical-align:top;border-bottom:1px solid #343741}.ml-app .tab-contents .job-section .euiTable .euiTableRow .euiTableRowCell .euiTableCellContent__text{word-wrap:break-word}.ml-app .tab-contents .job-section .euiTable .euiTableRow:hover{background-color:inherit}.ml-app .tab-contents .job-section .job-item{font-size:12px}.ml-app .tab-contents .job-section .job-item.header{font-weight:bold}.ml-app .tab-contents .json-textarea{height:500px}.ml-app .job-messages-table{max-height:500px;overflow:auto;text-align:left}.ml-app .job-messages-table tr:last-child td{border-bottom:none}.ml-app .job-messages-table .euiTableRowCell{background-color:#1D1E24}.ml-app .mlJobFilterBar .euiFilterGroup .euiPopover .euiPanel .group-item{padding:8px 16px}.ml-app .mlJobFilterBar .euiFilterGroup .euiPopover .euiPanel .inline-group{border:1px solid #1D1E24;border-radius:6px}.ml-app .mlJobFilterBar .euiFilterGroup .euiPopover .euiPanel .euiFilterSelectItem:hover,.ml-app .mlJobFilterBar .euiFilterGroup .euiPopover .euiPanel .euiFilterSelectItem:focus{text-decoration:none}.ml-app .mlJobFilterBar .euiFilterGroup .euiPopover .euiPanel .euiFilterSelectItem:hover .inline-group,.ml-app .mlJobFilterBar .euiFilterGroup .euiPopover .euiPanel .euiFilterSelectItem:focus .inline-group{border:1px solid #98A2B3;box-shadow:0 1px 2px #535966}.ml-app .inline-group{font-size:12px;background-color:#343741;padding:2px 5px;border-radius:2px;display:inline-block;margin:0 3px;color:#1D1E24;vertical-align:text-top}.ml-app .jobs-list-table>div>.euiTable>thead th{text-align:left;white-space:normal}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(2){width:34px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(3){width:auto}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(4){width:20px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(5){width:auto}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(6){width:100px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(7){width:85px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(8){width:80px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(9){width:80px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(10){width:150px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(11){width:80px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(12){width:30px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(12) .euiTableCellContent__text{display:none}.ml-app .jobs-list-table>div>.euiTable>tbody td:nth-child(4) .euiTableCellContent{padding:0}.ml-app .jobs-list-table>div>.euiTable>tbody td:nth-child(10){white-space:nowrap}.ml-app .jobs-list-table>div>.euiTable>tbody .euiTableCellContent{animation:unset}.ml-app .jobs-list-table>div>.euiTable>tbody .euiTableRow.euiTableRow-isExpandedRow>td>div>.euiTableCellContent__text{width:100%}.ml-app .jobs-list-table>div>.euiTable>tbody .euiTableRow.euiTableRow-isExpandedRow>td>div>.euiTableCellContent__text .euiTableRowCell{background-color:inherit}.ml-app .jobs-list-table>div>.euiTable>tbody .euiTableRow>.euiTableRowCell>.euiTableCellContent>.euiTableCellContent__hoverItem{opacity:1}.ml-app .jobs-list-table>div>.euiTable>tbody .euiContextMenuPanel .euiContextMenuItem{white-space:nowrap}.ml-app .jobs-list-table>div>.euiTable>tbody .euiContextMenuPanel .euiContextMenuItem:last-child:not(.euiContextMenuItem-isDisabled){color:#F86B63}.ml-app .jobs-list-table>div>.euiTable>tbody .results-button{margin-right:4px;width:18px}.ml-app .jobs-list-table>div>.euiTable>tbody .euiContextMenuItem .euiIcon{margin-right:4px}.ml-app .jobs-list-table>div>.euiTable .job-description{display:inline-block}.ml-app .jobs-list-table>div>.euiTable .job-loading-spinner{text-align:center}.ml-app .jobs-list-table.jobs-selected .results-button{color:#343741;pointer-events:none}.ml-app .actions-bar{min-height:60px;display:flex;align-items:center}.ml-app .job-management{padding:20px}.ml-app .multi-select-actions .actions-border,.ml-app .multi-select-actions .actions-border-large{height:20px;border-right:1px solid #343741;width:1px;display:inline-block;vertical-align:middle;margin:0 5px}.ml-app .multi-select-actions .actions-border-large{height:35px;margin:0 15px}.ml-app .multi-select-actions .results-button{margin-right:5px}.ml-app .multi-select-actions .euiContextMenuPanel .euiContextMenuItem__text{white-space:nowrap}.ml-app .multi-select-actions .euiContextMenuPanel .euiContextMenuItem:last-child:not(.euiContextMenuItem-isDisabled){color:#F86B63}.ml-app .multi-select-actions-no-display{display:none}.ml-app .group-selector{max-width:300px}.ml-app .group-selector .euiPopoverTitle{margin-bottom:8px !important}.ml-app .group-list{max-height:350px;overflow:auto}.ml-app .group-list .group-item{line-height:18px;padding:6px 0;border-bottom:1px solid #343741;cursor:pointer}.ml-app .group-list .group-item:focus{background-color:#EEF6F9;box-shadow:none}.ml-app .group-list .group-item .check{width:20px;display:inline-block}.ml-app .group-list .group-item .inline-group{border:1px solid #1D1E24;border-radius:6px}.ml-app .group-list .group-item:hover .inline-group{border:1px solid #98A2B3;box-shadow:0 1px 2px #535966}.ml-app .group-list .group-item:last-child{margin-bottom:0;border-bottom:none}.ml-app .new-group-input{padding-bottom:0}.ml-app .ml-custom-urls-selection>.euiFlexGroup>.euiFlexItem:first-child{max-width:388px}.ml-app .ml-custom-urls-selection>.euiFlexGroup>.euiFlexItem:last-child{flex-basis:50%}.ml-app .mlOverviewPanel{padding-top:0}.ml-app .mlOverviewPanel__isLoading{text-align:center;padding:10%}.ml-app .mlOverviewPanel__buttons{float:right}.ml-app .mlOverviewPanel__spinner{display:inline-block}.ml-app .mlOverviewPanel__refreshButton{padding-right:12px}.ml-app .mlOverviewPanel__statsBar{margin-top:0;margin-right:0}.ml-app .mlSettingsPage .mlSettingsPage__header{width:1200px;margin-left:auto;margin-right:auto}.ml-app .mlSettingsPage .mlSettingsPage__content{width:1200px;margin-top:16px;margin-bottom:16px}.ml-app .ml-list-filter-lists .ml-list-filter-lists-content{max-width:1100px;margin-top:16px;margin-bottom:16px}.ml-app .ml-list-filter-lists .ml-filter-lists-table th:last-child,.ml-app .ml-list-filter-lists .ml-filter-lists-table td:last-child{width:70px}.ml-app .ml-edit-filter-lists .ml-edit-filter-lists-content{max-width:1100px;width:100%;margin-top:16px;margin-bottom:16px}.ml-app .ml-edit-filter-lists .ml-filter-list-usage>div{display:inline}.ml-app .ml-edit-filter-lists .ml-filter-list-usage .euiButtonEmpty.euiButtonEmpty--small{padding-bottom:4px}.ml-app .ml-edit-filter-lists .ml-filter-list-usage .euiButtonEmpty .euiButtonEmpty__content{padding:0 4px}.ml-app .ml-add-filter-item-popover .euiFormRow{width:300px;padding-bottom:4px}.ml-app .ml-filter-list-usage-popover li{line-height:24px}.ml-app .mlCalendarEditForm .mlCalendarEditForm__content{max-width:1200px;width:100%;margin-top:16px;margin-bottom:16px}.ml-app .mlCalendarList .mlCalendarList__content{max-width:1200px;margin-top:16px;margin-bottom:16px}.ml-app .ml-time-series-explorer{color:#98A2B3}.ml-app .ml-time-series-explorer .results-container .panel-title{font-size:16px;font-weight:400;color:#98A2B3}.ml-app .ml-time-series-explorer .results-container .entity-count-text{color:#7DDED8;font-size:14px}.ml-app .ml-time-series-explorer .forecast-controls{float:right}.ml-app .ml-time-series-explorer .ml-anomalies-controls{padding-top:4px}.ml-app .ml-time-series-explorer .ml-timeseries-chart svg{font-size:12px;font-family:"Inter",-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol"}.ml-app .ml-time-series-explorer .ml-timeseries-chart .axis path,.ml-app .ml-time-series-explorer .ml-timeseries-chart .axis line{fill:none;stroke:#343741;shape-rendering:crispEdges;pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .axis text{fill:#DFE5EF}.ml-app .ml-time-series-explorer .ml-timeseries-chart .axis .tick line{stroke:#343741}.ml-app .ml-time-series-explorer .ml-timeseries-chart .chart-border{stroke:#343741;fill:none;stroke-width:1;shape-rendering:crispEdges}.ml-app .ml-time-series-explorer .ml-timeseries-chart .chart-border-highlight{stroke:#98A2B3;stroke-width:2}.ml-app .ml-time-series-explorer .ml-timeseries-chart .chart-border-highlight:hover{opacity:1}.ml-app .ml-time-series-explorer .ml-timeseries-chart .area{stroke-width:1}.ml-app .ml-time-series-explorer .ml-timeseries-chart .area.bounds{fill:rgba(54,162,239,0.2);pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .values-line{fill:none;stroke:#36A2EF;stroke-width:2;pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .values-line.forecast{stroke:#D6BF57;pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .hidden{visibility:hidden}.ml-app .ml-time-series-explorer .ml-timeseries-chart .area.forecast{fill:rgba(214,191,87,0.3);pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .metric-value{opacity:1;fill:transparent;stroke:#36A2EF;stroke-width:0}.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker{stroke-width:1px;stroke:#535966}.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.critical{fill:#FE5050}.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.major{fill:#FBA740}.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.minor{fill:#FDEC25}.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.warning{fill:#8BC8FB}.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.low{fill:#D2E9F7}.ml-app .ml-time-series-explorer .ml-timeseries-chart .metric-value:hover,.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker:hover,.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.highlighted{stroke-width:6px;stroke-opacity:.65;stroke:#36A2EF}.ml-app .ml-time-series-explorer .ml-timeseries-chart rect.scheduled-event-marker{stroke-width:1px;stroke:#98A2B3;fill:#343741;pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .forecast .metric-value,.ml-app .ml-time-series-explorer .ml-timeseries-chart .forecast .metric-value:hover{stroke:#D6BF57}.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .x-axis-background line{fill:none;shape-rendering:crispEdges;stroke:#25262E}.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .x-axis-background rect{fill:#25262E}.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .focus-zoom{fill:#98A2B3}.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .focus-zoom a text{fill:#36A2EF;cursor:pointer}.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .focus-zoom a:hover,.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .focus-zoom a:active,.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .focus-zoom a:focus{text-decoration:underline}.ml-app .ml-time-series-explorer .ml-timeseries-chart .context-chart .x.axis path{display:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .context-chart .axis text{font-size:10px;fill:#DFE5EF}.ml-app .ml-time-series-explorer .ml-timeseries-chart .context-chart .values-line{stroke-width:1}.ml-app .ml-time-series-explorer .ml-timeseries-chart .context-chart .mask polygon{fill-opacity:.1}.ml-app .ml-time-series-explorer .ml-timeseries-chart .context-chart .mask .area.bounds{fill:#343741}.ml-app .ml-time-series-explorer .ml-timeseries-chart .context-chart .mask .values-line{stroke-width:1;stroke:#535966}.ml-app .ml-time-series-explorer .ml-timeseries-chart .swimlane .axis text{display:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .swimlane rect.swimlane-cell-hidden{display:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .brush .extent{fill-opacity:0;shape-rendering:crispEdges;stroke:#98A2B3;stroke-width:2;cursor:move}.ml-app .ml-time-series-explorer .ml-timeseries-chart .brush .extent:hover{opacity:1}.ml-app .ml-time-series-explorer .ml-timeseries-chart .top-border{fill:#1D1E24}.ml-app .ml-time-series-explorer .ml-timeseries-chart foreignObject.brush-handle{pointer-events:none;padding-top:1px}.ml-app .ml-time-series-explorer .ml-timeseries-chart div.brush-handle-inner{border:1px solid #98A2B3;background-color:#343741;height:70px;width:10px;text-align:center;cursor:ew-resize;margin-top:9px;font-size:14px;fill:#98A2B3}.ml-app .ml-time-series-explorer .ml-timeseries-chart div.brush-handle-inner-left{border-radius:6px 0 0 6px}.ml-app .ml-time-series-explorer .ml-timeseries-chart div.brush-handle-inner-right{border-radius:0 6px 6px 0}.ml-app .ml-time-series-explorer .ml-timeseries-chart rect.brush-handle{stroke-width:1;stroke:#98A2B3;fill:#343741;pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart rect.brush-handle:hover{opacity:1}.ml-app .mlTimeSeriesExplorerProgress{background-color:#1D1E24}.ml-app .mlTimeSeriesExplorerProgress::-moz-progress-bar,.ml-app .mlTimeSeriesExplorerProgress::-webkit-progress-bar{background-color:#1D1E24}.ml-app .mlAnnotationBrush .extent{stroke:#343741;stroke-width:2px;stroke-dasharray:2 2;fill:#25262E;shape-rendering:geometricPrecision}.ml-app .mlAnnotationRect{stroke:#fff;stroke-width:2px;stroke-opacity:.2;transition:stroke-opacity 150ms;fill:#fff;fill-opacity:.05;transition:fill-opacity 150ms;shape-rendering:geometricPrecision}.ml-app .mlAnnotationRect-isHighlight{stroke-opacity:.4;transition:stroke-opacity 150ms;fill-opacity:.1;transition:fill-opacity 150ms}.ml-app .mlAnnotationRect-isBlur{stroke-opacity:.1;transition:stroke-opacity 150ms;fill-opacity:.025;transition:fill-opacity 150ms}.ml-app .mlAnnotationText{text-anchor:middle;font-size:12px;font-family:"Inter",-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";font-weight:500;fill:#fff;transition:fill 150ms;-webkit-user-select:none;user-select:none}.ml-app .mlAnnotationText-isBlur{fill:#535966;transition:fill 150ms}.ml-app .mlAnnotationTextRect{fill:#343741;transition:fill 150ms}.ml-app .mlAnnotationTextRect-isBlur{fill:#25262E;transition:fill 150ms}.ml-app .mlAnnotationHidden{display:none}.ml-app .mlContextAnnotationRect{stroke:#fff;stroke-width:2px;stroke-opacity:.2;transition:stroke-opacity 150ms;fill:#fff;fill-opacity:.05;transition:fill-opacity 150ms;shape-rendering:geometricPrecision}.ml-app .mlContextAnnotationRect-isBlur{stroke-opacity:.1;transition:stroke-opacity 150ms;fill-opacity:.025;transition:fill-opacity 150ms}.ml-app .euiDescriptionList.euiDescriptionList--column.ml-annotation-description-list .euiDescriptionList__title{flex-basis:30%}.ml-app .euiDescriptionList.euiDescriptionList--column.ml-annotation-description-list .euiDescriptionList__description{flex-basis:70%}.ml-app .euiDescriptionList.euiDescriptionList--column.ml-annotation-description-list>*{margin-top:4px}.ml-app .ml-anomalies-table .ml-icon-severity-critical,.ml-app .ml-anomalies-table .ml-icon-severity-major,.ml-app .ml-anomalies-table .ml-icon-severity-minor,.ml-app .ml-anomalies-table .ml-icon-severity-warning,.ml-app .ml-anomalies-table .ml-icon-severity-unknown{color:inherit;text-shadow:none}.ml-app .ml-anomalies-table .ml-icon-severity-critical .euiIcon{fill:#FE5050}.ml-app .ml-anomalies-table .ml-icon-severity-major .euiIcon{fill:#FBA740}.ml-app .ml-anomalies-table .ml-icon-severity-minor .euiIcon{fill:#FDEC25}.ml-app .ml-anomalies-table .ml-icon-severity-warning .euiIcon{fill:#8BC8FB}.ml-app .ml-anomalies-table .ml-icon-severity-unknown .euiIcon{fill:#98A2B3}.ml-app .ml-anomalies-table tr th:first-child,.ml-app .ml-anomalies-table tr td:first-child{width:32px}.ml-app .ml-anomalies-table .euiTableCellContent .euiHealth{font-size:inherit}.ml-app .ml-anomalies-table .euiTableCellContent .detector-rules-icon{margin-left:4px;opacity:.5}.ml-app .ml-anomalies-table .euiContextMenuItem{min-width:150px}.ml-app .ml-anomalies-table .mlAnomalyCategoryExamples__header{display:inline}.ml-app .ml-anomalies-table .mlAnomalyCategoryExamples__link{width:100%}.ml-app .ml-anomalies-table .category-example{display:block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.ml-app .ml-anomalies-table .mlAnomalyCategoryExamples{padding:24px}.ml-app .ml-anomalies-table .mlAnomalyCategoryExamples__item{display:block;white-space:wrap;font-family:"Roboto Mono",Consolas,Menlo,Courier,monospace}.ml-app .ml-anomalies-table .interim-result{font-style:italic}.ml-app .ml-anomalies-table .ml-anomalies-table-details{padding:4px 32px;max-height:1000px;overflow-y:auto}.ml-app .ml-anomalies-table .ml-anomalies-table-details .anomaly-description-list .euiDescriptionList__title{margin-top:0;flex-basis:15%;font-size:inherit;line-height:1.5rem;max-width:100%;overflow:hidden !important;text-overflow:ellipsis !important;white-space:nowrap !important;word-wrap:normal !important}.ml-app .ml-anomalies-table .ml-anomalies-table-details .anomaly-description-list .euiDescriptionList__description{margin-top:0;flex-basis:85%;font-size:inherit;line-height:1.5rem}.ml-app .mlColorRangeLegend text{font-size:10px;font-size:.71429rem;fill:#98A2B3}.ml-app .mlColorRangeLegend .axis path{fill:none;stroke:none}.ml-app .mlColorRangeLegend .axis line{fill:none;stroke:#535966;shape-rendering:crispEdges}.ml-app .ml-table-controls label{font-size:12px;padding:0 0 4px 4px}.ml-app .ml-table-controls .ml-table-controls-element{display:inline-block;padding-left:16px}.ml-app .ml-table-controls select{font-size:12px;font-style:normal}.ml-app .ml-select-severity .euiFormControlLayoutClearButton{display:none}.ml-app .field-value-short{max-width:100%;overflow:hidden !important;text-overflow:ellipsis !important;white-space:nowrap !important;word-wrap:normal !important;display:inline-block;vertical-align:bottom}.ml-app .field-value-long{overflow-wrap:break-word}.ml-app .filter-button{opacity:.5;width:16px;height:16px;transform:translateY(-1px)}.ml-app .filter-button .euiIcon{width:12px;height:12px}.ml-app .filter-button:hover{opacity:1}.ml-app .ml-field-title-bar{font-size:16px;font-size:1.14286rem;line-height:1.71429rem;font-family:Roboto Mono, serif;font-style:normal;font-weight:bold;font-size:14px;border-radius:6px 6px 0 0;padding:4px;margin:-16px -16px 0 -16px;border-top:3px solid;text-align:center}.ml-app .ml-field-title-bar .field-type-icon{vertical-align:middle;margin-bottom:-4px;display:inline-block}.ml-app .ml-field-title-bar .field-name{max-width:100%;overflow:hidden !important;text-overflow:ellipsis !important;white-space:nowrap !important;word-wrap:normal !important;vertical-align:middle;padding-right:8px;max-width:290px;display:inline-block;margin-left:8px}.ml-app .ml-influencers-list{line-height:1.45}.ml-app .ml-influencers-list .field-label{font-size:12px;text-align:left;max-height:14px;max-width:calc(100% - 102px)}.ml-app .ml-influencers-list .field-label .field-value{max-width:100%;overflow:hidden !important;text-overflow:ellipsis !important;white-space:nowrap !important;word-wrap:normal !important;display:inline-block;vertical-align:bottom}.ml-app .ml-influencers-list .progress{display:inline-block;width:calc(100% - 34px);height:22px;min-width:70px;margin-bottom:0;color:#98A2B3;background-color:transparent}.ml-app .ml-influencers-list .progress .progress-bar-holder{width:calc(100% - 28px)}.ml-app .ml-influencers-list .progress .progress-bar{height:2px;margin-top:12px;text-align:right;line-height:18px;display:inline-block;transition:none}.ml-app .ml-influencers-list .progress.critical .progress-bar{background-color:#FE5050}.ml-app .ml-influencers-list .progress.critical .score-label{border-color:#FE5050}.ml-app .ml-influencers-list .progress.major .progress-bar{background-color:#FBA740}.ml-app .ml-influencers-list .progress.major .score-label{border-color:#FBA740}.ml-app .ml-influencers-list .progress.minor .progress-bar{background-color:#FDEC25}.ml-app .ml-influencers-list .progress.minor .score-label{border-color:#FDEC25}.ml-app .ml-influencers-list .progress.warning .progress-bar{background-color:#8BC8FB}.ml-app .ml-influencers-list .progress.warning .score-label{border-color:#8BC8FB}.ml-app .ml-influencers-list .score-label{text-align:center;line-height:14px;white-space:nowrap;font-size:12px;display:inline;margin-left:4px}.ml-app .ml-influencers-list .total-score-label{width:32px;vertical-align:top;text-align:center;color:#98A2B3;font-size:11px;line-height:14px;border-radius:6px;padding:2px;margin-top:4px;display:inline-block;border:1px solid #343741}.ml-app .ml-influencers-list-tooltip{word-break:break-all}.ml-app .ml-items-grid-page-size-menu{width:140px}.ml-app .mlJobSelectorBar{padding:8px}.ml-app .mlJobSelectorFlyoutBody>.euiFlyoutBody__overflow{padding-top:8px}.ml-app .mlJobSelector__ganttBar{background-color:#79ADDA;height:12px;border-radius:2px}.ml-app .mlJobSelector__ganttBarBackEdge{height:16px;border-left:1px solid #D6D6D6;border-right:1px solid #D6D6D6;margin-bottom:-14px;padding-top:8px}.ml-app .mlJobSelector__ganttBarDashed{height:1px;border-top:1px dashed #D6D6D6}.ml-app .mlJobSelector__ganttBarRunning{background-image:linear-gradient(45deg, rgba(255,255,255,0.15) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.15) 50%, rgba(255,255,255,0.15) 75%, transparent 75%, transparent);background-size:40px 40px;animation:progress-bar-stripes 2s linear infinite}.ml-app .ml-loading-indicator{text-align:center;font-size:17px;display:flex;flex-direction:column;align-items:center;justify-content:center}.ml-app .mlNavigationMenu{padding:0 12px;border-bottom:1px solid #343741;background-color:#1D1E24}.ml-app .ml-rule-editor-flyout{font-size:14px}.ml-app .ml-rule-editor-flyout .select-rule-action .rule-detector-description-list{padding-left:16px}.ml-app .ml-rule-editor-flyout .select-rule-action-panel{padding:8px 0}.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList .euiDescriptionList__title{flex-basis:15%;padding:0 16px}.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList .euiDescriptionList__description{flex-basis:85%}.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList .euiDescriptionList__title:nth-child(1),.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList .euiDescriptionList__description:nth-child(2){color:#DFE5EF;font-weight:700;border-bottom:1px solid #343741;padding-bottom:12px}.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList .euiDescriptionList__title:nth-child(3),.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList .euiDescriptionList__description:nth-child(4){padding-top:8px}.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList.euiDescriptionList--column>*{margin-top:4px}.ml-app .ml-rule-editor-flyout .scope-enable-checkbox .euiCheckbox__input[disabled] ~ .euiCheckbox__label{color:inherit}.ml-app .ml-rule-editor-flyout .scope-field-checkbox{margin-right:2px}.ml-app .ml-rule-editor-flyout .scope-field-checkbox .euiCheckbox{margin-top:4px}.ml-app .ml-rule-editor-flyout .scope-field-button{pointer-events:none;border-bottom:none}.ml-app .ml-rule-editor-flyout .scope-edit-filter-link{line-height:32px;font-size:12px}.ml-app .ml-rule-editor-flyout .condition-edit-value-field{width:170px;height:28px;margin:0 2px}.ml-app .ml-rule-editor-flyout .condition-edit-value-field input{height:28px}.ml-app .ml-rule-editor-flyout .euiExpressionButton.disabled{pointer-events:none}.ml-app .ml-rule-editor-flyout .euiExpressionButton.disabled .euiExpressionButton__value,.ml-app .ml-rule-editor-flyout .euiExpressionButton.disabled .euiExpressionButton__description{color:#343741}.ml-app .ml-rule-editor-flyout .text-highlight{font-weight:700}.ml-app .euiDescriptionList.euiDescriptionList--column.rule-detector-description-list .euiDescriptionList__title{flex-basis:15%}.ml-app .euiDescriptionList.euiDescriptionList--column.rule-detector-description-list .euiDescriptionList__description{flex-basis:85%}.ml-app .euiDescriptionList.euiDescriptionList--column.rule-detector-description-list>*{margin-top:4px}.ml-app .stat{margin-right:8px}.ml-app .mlStatsBar{height:42px;padding:14px;background-color:#25262E}.ml-app .mlEmbeddedMapContent{width:100%;height:100%;display:flex;flex:1 1 100%;z-index:1;min-height:0}.ml-app .tab-datavisualizer_index_select,.ml-app .tab-timeseriesexplorer,.ml-app .tab-explorer{background-color:#1D1E24}.ml-app .button-wrapper{display:inline}.ml-app .button-wrapper.disabled .kuiButton[disabled]{pointer-events:none}.ml-app .button-wrapper.disabled{cursor:not-allowed}.ml-app .clear,.ml-app .clearfix{clear:both}.ml-app .mlDisableAntiAliasing{-webkit-font-smoothing:none}.ml-app .mlDisableAntiAliasing * canvas{image-rendering:pixelated}\n',""]),module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(65),content=__webpack_require__(461);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){(exports=__webpack_require__(66)(!1)).push([module.i,'.ml-app .ml-icon-severity-critical,.ml-app .ml-icon-severity-major,.ml-app .ml-icon-severity-minor,.ml-app .ml-icon-severity-warning,.ml-app .ml-icon-severity-unknown{text-shadow:1px 1px 1px #D3DAE6}.ml-app .ml-icon-severity-critical{color:#cf4141}.ml-app .ml-icon-severity-major{color:#9e6929}.ml-app .ml-icon-severity-minor{color:#7c7313}.ml-app .ml-icon-severity-warning{color:#537896}.ml-app .ml-icon-severity-unknown{color:#69707D}.ml-app .mlDataFrameAnalyticsRegression__evaluateStat{padding-top:24px}.ml-app .mlJobMapLegend__container{background-color:\'#FFFFFF\'}.ml-app .mlJobMapLegend__indexPattern{height:12px;width:12px;background-color:#fff;border:2px solid #D36086;transform:rotate(45deg);display:\'inline-block\'}.ml-app .mlJobMapLegend__transform{height:12px;width:12px;background-color:#fff;border:2px solid #6092C0;display:\'inline-block\'}.ml-app .mlJobMapLegend__analytics{height:12px;width:12px;background-color:#fff;border:2px solid #54B399;border-radius:50%;display:\'inline-block\'}.ml-app .mlJobMapLegend__sourceNode{height:12px;width:12px;background-color:#FEC514;border:1px solid #D3DAE6;border-radius:6px;display:\'inline-block\'}.ml-app .mlAnalyticsTable .euiTableRow-isExpandedRow .euiTableCellContent{animation:none !important}.ml-app .mlAnalyticsTable .euiTableRow-isExpandedRow .euiTableCellContent .euiTableCellContent__text{width:100%}.ml-app .mlAnalyticsTable .euiIcon-isLoaded{animation:none !important}.ml-app .mlTaskStateBadge,.ml-app .mlTaskModeBadge{max-width:100px}.ml-app .dataFrameAnalyticsCreateSearchDialog{width:720px;min-height:600px}.ml-app .dfAnalyticsCreationWizard__card{width:300px}.ml-app .mlFieldDataTopValuesContainer{padding-top:4px}.ml-app .mlTopValuesValueLabelContainer{margin-right:12px}.ml-app .mlTopValuesValueLabelContainer.mlTopValuesValueLabelContainer--small{width:70px}.ml-app .mlTopValuesValueLabelContainer.mlTopValuesValueLabelContainer--large{width:200px}.ml-app .mlTopValuesPercentLabelContainer{margin-left:12px;width:70px}.ml-app .mlMetricDistributionChartContainer{padding-top:4px;width:100%}@media only screen and (max-width: 574px){.ml-app .mlDataVisualizerExpandedRow{flex-direction:column}}@media only screen and (min-width: 575px) and (max-width: 767px){.ml-app .mlDataVisualizerExpandedRow{flex-direction:column}}@media only screen and (min-width: 768px) and (max-width: 991px){.ml-app .mlDataVisualizerExpandedRow{flex-direction:column}}.ml-app .mlDataVisualizerFieldCountContainer{max-width:300px}.ml-app .mlDataVisualizerColumnHeaderIcon{max-width:12px}.ml-app .mlDataVisualizerFieldExpandedRow{padding-left:64px;width:100%}.ml-app .mlDataVisualizerFieldExpandedRow .mlFieldDataCard__valuesTitle{text-transform:uppercase;text-align:left;color:#69707D;font-weight:bold;padding-bottom:8px}.ml-app .mlDataVisualizerFieldExpandedRow .mlFieldDataCard__codeContent{font-family:"Roboto Mono",Consolas,Menlo,Courier,monospace;letter-spacing:normal}.ml-app .mlDataVisualizer .euiTableRow>.euiTableRowCell{border-bottom:0;border-top:1px solid #D3DAE6}.ml-app .mlDataVisualizer .euiTableRow-isExpandedRow .euiTableRowCell{background-color:#fff !important;border-top:0;border-bottom:1px solid #D3DAE6}.ml-app .mlDataVisualizer .euiTableRow-isExpandedRow .euiTableRowCell:hover{background-color:#fff !important}.ml-app .mlDataVisualizer .mlDataVisualizerSummaryTable{max-width:350px;min-width:250px}.ml-app .mlDataVisualizer .mlDataVisualizerSummaryTable .euiTableRow>.euiTableRowCell{border-bottom:0}.ml-app .mlDataVisualizer .mlDataVisualizerSummaryTable .euiTableHeaderCell{display:none}.ml-app .mlDataVisualizer .mlDataVisualizerSummaryTableWrapper{max-width:300px}.ml-app .mlDataVisualizer .mlDataVisualizerMapWrapper{min-height:300px;min-width:600px}.ml-app .ml-explorer{width:100%;display:inline-block;color:#69707D}.ml-app .ml-explorer .mlAnomalyExplorer__filterBar{padding-right:16px;padding-left:16px}.ml-app .ml-explorer .results-container{padding:0 0 16px 0}.ml-app .ml-explorer .results-container .col-xs-12{width:calc(100% - 32px);padding-left:16px}.ml-app .ml-explorer .results-container .no-influencers-warning{float:left;padding-top:4px;padding-left:16px;color:#69707D;font-size:14px}.ml-app .ml-explorer .results-container .panel-title{font-size:16px;font-weight:400;color:#69707D;display:inline-block;padding-bottom:4px}.ml-app .ml-explorer .results-container .panel-sub-title{color:#69707D;font-size:12px}.ml-app .ml-explorer .ml-anomalies-controls{padding-top:4px}.ml-app .ml-explorer .ml-anomalies-controls #show_charts_checkbox_control{padding-top:24px}.ml-app .mlSwimLaneContainer .echLegendListContainer{height:34px !important}.ml-app .mlSwimLaneContainer .echLegendList{display:flex !important;justify-content:space-between !important;flex-wrap:nowrap;position:absolute;right:0}.ml-app .ml-explorer-chart-eui-icon-tip{max-width:none}.ml-app .ml-explorer-chart-label-badges{margin-top:4px;display:flex;align-items:center}.ml-app .ml-reset-font-weight{font-weight:normal}.ml-app .ml-explorer-chart-container{overflow:hidden}.ml-app .ml-explorer-chart-container .ml-explorer-chart-svg{font-size:12px;font-family:"Inter",-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol"}.ml-app .ml-explorer-chart-container .ml-explorer-chart-svg .line-chart rect{fill:#fff;opacity:1}.ml-app .ml-explorer-chart-container .ml-explorer-chart-svg .line-chart rect.selected-interval{fill:rgba(200,200,200,0.1);stroke:#69707D;stroke-width:2px;stroke-opacity:.8}.ml-app .ml-explorer-chart-container .ml-explorer-chart-svg .line-chart rect.scheduled-event-marker{stroke-width:1px;stroke:#69707D;fill:#D3DAE6;pointer-events:none}.ml-app .ml-explorer-chart-container .axis path,.ml-app .ml-explorer-chart-container .axis line{fill:none;stroke:#D3DAE6;shape-rendering:crispEdges}.ml-app .ml-explorer-chart-container .axis .tick line.ml-tick-emphasis{stroke:rgba(0,0,0,0.2)}.ml-app .ml-explorer-chart-container .axis text{fill:#69707D}.ml-app .ml-explorer-chart-container .axis .tick line{stroke:#D3DAE6;stroke-width:1px}.ml-app .ml-explorer-chart-container .values-line{fill:none;stroke:#07C;stroke-width:2}.ml-app .ml-explorer-chart-container .values-dots circle,.ml-app .ml-explorer-chart-container .values-dots-circle{fill:#07C;stroke-width:0}.ml-app .ml-explorer-chart-container .values-dots circle.values-dots-circle-blur{fill:#98A2B3}.ml-app .ml-explorer-chart-container .metric-value{opacity:1;fill:transparent;stroke:#07C;stroke-width:0}.ml-app .ml-explorer-chart-container .anomaly-marker{stroke-width:1px;stroke:#98A2B3}.ml-app .ml-explorer-chart-container .anomaly-marker:hover{stroke-width:6px;stroke:#07C}.ml-app .ml-explorer-chart-container .anomaly-marker.critical{fill:#FE5050}.ml-app .ml-explorer-chart-container .anomaly-marker.major{fill:#FBA740}.ml-app .ml-explorer-chart-container .anomaly-marker.minor{fill:#FDEC25}.ml-app .ml-explorer-chart-container .anomaly-marker.warning{fill:#8BC8FB}.ml-app .ml-explorer-chart-container .anomaly-marker.low{fill:#D2E9F7}.ml-app .ml-explorer-chart-container .metric-value:hover,.ml-app .ml-explorer-chart-container .anomaly-marker:hover{stroke-width:6px;stroke-opacity:.65}.ml-app .ml-explorer-chart{overflow:hidden}.ml-app .ml-explorer-chart-content-wrapper{height:215px}.ml-app .ml-explorer-chart-axis-emphasis{font-weight:bold}.ml-app .explorer-charts ml-explorer-charts-container .row{padding:10px}.ml-app .explorer-charts ml-explorer-charts-container label{font-size:12px}.ml-app .explorer-charts ml-explorer-charts-container select{font-size:14px;font-style:400}.ml-app .explorer-charts ml-explorer-charts-container .chart-controls label{padding:0 0 10px 0}.ml-app .explorer-charts ml-explorer-charts-container .no-results-item{text-align:center;padding-top:10px}.ml-app .explorer-charts ml-explorer-charts-container .ml-anomaly-interim-result{font-style:italic;padding-bottom:3px}.ml-app .explorer-charts ml-explorer-charts-container .ml-tablerow-expanded{width:100%;padding:5px 20px;overflow:hidden;font-size:12px}.ml-app .explorer-charts ml-explorer-charts-container .ml-tablerow-expanded td{padding:0 0 2px 0}.ml-app .explorer-charts ml-explorer-charts-container .ml-tablerow-expanded table tr>td:first-child{padding-left:2px;vertical-align:top}.ml-app .explorer-charts ml-explorer-charts-container .ml-tablerow-expanded td:first-child{width:140px}.ml-app .explorer-charts ml-explorer-charts-container .ml-tablerow-expanded td:nth-child(2){padding-left:5px}.ml-app .ml-explorer-chart-icons{float:right;padding-left:5px;margin:2px -8px 0 0}.ml-app .ml-edit-url-form .url-label{width:250px}.ml-app .ml-edit-url-form .url-link-to-radio .euiRadio{display:inline-block;padding-right:24px}.ml-app .ml-edit-url-form .url-time-range{width:150px}.ml-app .new-job-button-container{float:right}.ml-app .edit-custom-url-panel .close-editor-button{position:relative;float:right;top:-4px;right:0}.ml-app .tab-contents{margin:-8px;padding:8px;background-color:#fff}.ml-app .tab-contents .col-md-6:nth-child(1){padding-right:7px}.ml-app .tab-contents .col-md-6:nth-child(2){padding-left:7px}.ml-app .tab-contents .job-section{overflow:auto;padding:5px 15px;background-color:#F5F7FA;border:1px solid #D3DAE6;border-radius:6px;margin:4px 0}.ml-app .tab-contents .job-section .euiTable{background-color:transparent}.ml-app .tab-contents .job-section .euiTable .euiTableRow:first-child .euiTableRowCell{border-top:0}.ml-app .tab-contents .job-section .euiTable .euiTableRow:last-child .euiTableRowCell{border-bottom:0}.ml-app .tab-contents .job-section .euiTable .euiTableRow .euiTableRowCell{vertical-align:top;border-bottom:1px solid #D3DAE6}.ml-app .tab-contents .job-section .euiTable .euiTableRow .euiTableRowCell .euiTableCellContent__text{word-wrap:break-word}.ml-app .tab-contents .job-section .euiTable .euiTableRow:hover{background-color:inherit}.ml-app .tab-contents .job-section .job-item{font-size:12px}.ml-app .tab-contents .job-section .job-item.header{font-weight:bold}.ml-app .tab-contents .json-textarea{height:500px}.ml-app .job-messages-table{max-height:500px;overflow:auto;text-align:left}.ml-app .job-messages-table tr:last-child td{border-bottom:none}.ml-app .job-messages-table .euiTableRowCell{background-color:#fff}.ml-app .mlJobFilterBar .euiFilterGroup .euiPopover .euiPanel .group-item{padding:8px 16px}.ml-app .mlJobFilterBar .euiFilterGroup .euiPopover .euiPanel .inline-group{border:1px solid #fff;border-radius:6px}.ml-app .mlJobFilterBar .euiFilterGroup .euiPopover .euiPanel .euiFilterSelectItem:hover,.ml-app .mlJobFilterBar .euiFilterGroup .euiPopover .euiPanel .euiFilterSelectItem:focus{text-decoration:none}.ml-app .mlJobFilterBar .euiFilterGroup .euiPopover .euiPanel .euiFilterSelectItem:hover .inline-group,.ml-app .mlJobFilterBar .euiFilterGroup .euiPopover .euiPanel .euiFilterSelectItem:focus .inline-group{border:1px solid #69707D;box-shadow:0 1px 2px #98A2B3}.ml-app .inline-group{font-size:12px;background-color:#D3DAE6;padding:2px 5px;border-radius:2px;display:inline-block;margin:0 3px;color:#fff;vertical-align:text-top}.ml-app .jobs-list-table>div>.euiTable>thead th{text-align:left;white-space:normal}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(2){width:34px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(3){width:auto}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(4){width:20px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(5){width:auto}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(6){width:100px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(7){width:85px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(8){width:80px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(9){width:80px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(10){width:150px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(11){width:80px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(12){width:30px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(12) .euiTableCellContent__text{display:none}.ml-app .jobs-list-table>div>.euiTable>tbody td:nth-child(4) .euiTableCellContent{padding:0}.ml-app .jobs-list-table>div>.euiTable>tbody td:nth-child(10){white-space:nowrap}.ml-app .jobs-list-table>div>.euiTable>tbody .euiTableCellContent{animation:unset}.ml-app .jobs-list-table>div>.euiTable>tbody .euiTableRow.euiTableRow-isExpandedRow>td>div>.euiTableCellContent__text{width:100%}.ml-app .jobs-list-table>div>.euiTable>tbody .euiTableRow.euiTableRow-isExpandedRow>td>div>.euiTableCellContent__text .euiTableRowCell{background-color:inherit}.ml-app .jobs-list-table>div>.euiTable>tbody .euiTableRow>.euiTableRowCell>.euiTableCellContent>.euiTableCellContent__hoverItem{opacity:1}.ml-app .jobs-list-table>div>.euiTable>tbody .euiContextMenuPanel .euiContextMenuItem{white-space:nowrap}.ml-app .jobs-list-table>div>.euiTable>tbody .euiContextMenuPanel .euiContextMenuItem:last-child:not(.euiContextMenuItem-isDisabled){color:#BD271E}.ml-app .jobs-list-table>div>.euiTable>tbody .results-button{margin-right:4px;width:18px}.ml-app .jobs-list-table>div>.euiTable>tbody .euiContextMenuItem .euiIcon{margin-right:4px}.ml-app .jobs-list-table>div>.euiTable .job-description{display:inline-block}.ml-app .jobs-list-table>div>.euiTable .job-loading-spinner{text-align:center}.ml-app .jobs-list-table.jobs-selected .results-button{color:#D3DAE6;pointer-events:none}.ml-app .actions-bar{min-height:60px;display:flex;align-items:center}.ml-app .job-management{padding:20px}.ml-app .multi-select-actions .actions-border,.ml-app .multi-select-actions .actions-border-large{height:20px;border-right:1px solid #D3DAE6;width:1px;display:inline-block;vertical-align:middle;margin:0 5px}.ml-app .multi-select-actions .actions-border-large{height:35px;margin:0 15px}.ml-app .multi-select-actions .results-button{margin-right:5px}.ml-app .multi-select-actions .euiContextMenuPanel .euiContextMenuItem__text{white-space:nowrap}.ml-app .multi-select-actions .euiContextMenuPanel .euiContextMenuItem:last-child:not(.euiContextMenuItem-isDisabled){color:#BD271E}.ml-app .multi-select-actions-no-display{display:none}.ml-app .group-selector{max-width:300px}.ml-app .group-selector .euiPopoverTitle{margin-bottom:8px !important}.ml-app .group-list{max-height:350px;overflow:auto}.ml-app .group-list .group-item{line-height:18px;padding:6px 0;border-bottom:1px solid #D3DAE6;cursor:pointer}.ml-app .group-list .group-item:focus{background-color:#EEF6F9;box-shadow:none}.ml-app .group-list .group-item .check{width:20px;display:inline-block}.ml-app .group-list .group-item .inline-group{border:1px solid #fff;border-radius:6px}.ml-app .group-list .group-item:hover .inline-group{border:1px solid #69707D;box-shadow:0 1px 2px #98A2B3}.ml-app .group-list .group-item:last-child{margin-bottom:0;border-bottom:none}.ml-app .new-group-input{padding-bottom:0}.ml-app .ml-custom-urls-selection>.euiFlexGroup>.euiFlexItem:first-child{max-width:388px}.ml-app .ml-custom-urls-selection>.euiFlexGroup>.euiFlexItem:last-child{flex-basis:50%}.ml-app .mlOverviewPanel{padding-top:0}.ml-app .mlOverviewPanel__isLoading{text-align:center;padding:10%}.ml-app .mlOverviewPanel__buttons{float:right}.ml-app .mlOverviewPanel__spinner{display:inline-block}.ml-app .mlOverviewPanel__refreshButton{padding-right:12px}.ml-app .mlOverviewPanel__statsBar{margin-top:0;margin-right:0}.ml-app .mlSettingsPage .mlSettingsPage__header{width:1200px;margin-left:auto;margin-right:auto}.ml-app .mlSettingsPage .mlSettingsPage__content{width:1200px;margin-top:16px;margin-bottom:16px}.ml-app .ml-list-filter-lists .ml-list-filter-lists-content{max-width:1100px;margin-top:16px;margin-bottom:16px}.ml-app .ml-list-filter-lists .ml-filter-lists-table th:last-child,.ml-app .ml-list-filter-lists .ml-filter-lists-table td:last-child{width:70px}.ml-app .ml-edit-filter-lists .ml-edit-filter-lists-content{max-width:1100px;width:100%;margin-top:16px;margin-bottom:16px}.ml-app .ml-edit-filter-lists .ml-filter-list-usage>div{display:inline}.ml-app .ml-edit-filter-lists .ml-filter-list-usage .euiButtonEmpty.euiButtonEmpty--small{padding-bottom:4px}.ml-app .ml-edit-filter-lists .ml-filter-list-usage .euiButtonEmpty .euiButtonEmpty__content{padding:0 4px}.ml-app .ml-add-filter-item-popover .euiFormRow{width:300px;padding-bottom:4px}.ml-app .ml-filter-list-usage-popover li{line-height:24px}.ml-app .mlCalendarEditForm .mlCalendarEditForm__content{max-width:1200px;width:100%;margin-top:16px;margin-bottom:16px}.ml-app .mlCalendarList .mlCalendarList__content{max-width:1200px;margin-top:16px;margin-bottom:16px}.ml-app .ml-time-series-explorer{color:#69707D}.ml-app .ml-time-series-explorer .results-container .panel-title{font-size:16px;font-weight:400;color:#69707D}.ml-app .ml-time-series-explorer .results-container .entity-count-text{color:#00BFB3;font-size:14px}.ml-app .ml-time-series-explorer .forecast-controls{float:right}.ml-app .ml-time-series-explorer .ml-anomalies-controls{padding-top:4px}.ml-app .ml-time-series-explorer .ml-timeseries-chart svg{font-size:12px;font-family:"Inter",-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol"}.ml-app .ml-time-series-explorer .ml-timeseries-chart .axis path,.ml-app .ml-time-series-explorer .ml-timeseries-chart .axis line{fill:none;stroke:#D3DAE6;shape-rendering:crispEdges;pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .axis text{fill:#343741}.ml-app .ml-time-series-explorer .ml-timeseries-chart .axis .tick line{stroke:#D3DAE6}.ml-app .ml-time-series-explorer .ml-timeseries-chart .chart-border{stroke:#D3DAE6;fill:none;stroke-width:1;shape-rendering:crispEdges}.ml-app .ml-time-series-explorer .ml-timeseries-chart .chart-border-highlight{stroke:#69707D;stroke-width:2}.ml-app .ml-time-series-explorer .ml-timeseries-chart .chart-border-highlight:hover{opacity:1}.ml-app .ml-time-series-explorer .ml-timeseries-chart .area{stroke-width:1}.ml-app .ml-time-series-explorer .ml-timeseries-chart .area.bounds{fill:rgba(0,119,204,0.2);pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .values-line{fill:none;stroke:#07C;stroke-width:2;pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .values-line.forecast{stroke:#D6BF57;pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .hidden{visibility:hidden}.ml-app .ml-time-series-explorer .ml-timeseries-chart .area.forecast{fill:rgba(214,191,87,0.3);pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .metric-value{opacity:1;fill:transparent;stroke:#07C;stroke-width:0}.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker{stroke-width:1px;stroke:#98A2B3}.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.critical{fill:#FE5050}.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.major{fill:#FBA740}.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.minor{fill:#FDEC25}.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.warning{fill:#8BC8FB}.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.low{fill:#D2E9F7}.ml-app .ml-time-series-explorer .ml-timeseries-chart .metric-value:hover,.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker:hover,.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.highlighted{stroke-width:6px;stroke-opacity:.65;stroke:#07C}.ml-app .ml-time-series-explorer .ml-timeseries-chart rect.scheduled-event-marker{stroke-width:1px;stroke:#69707D;fill:#D3DAE6;pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .forecast .metric-value,.ml-app .ml-time-series-explorer .ml-timeseries-chart .forecast .metric-value:hover{stroke:#D6BF57}.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .x-axis-background line{fill:none;shape-rendering:crispEdges;stroke:#F5F7FA}.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .x-axis-background rect{fill:#F5F7FA}.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .focus-zoom{fill:#69707D}.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .focus-zoom a text{fill:#07C;cursor:pointer}.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .focus-zoom a:hover,.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .focus-zoom a:active,.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .focus-zoom a:focus{text-decoration:underline}.ml-app .ml-time-series-explorer .ml-timeseries-chart .context-chart .x.axis path{display:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .context-chart .axis text{font-size:10px;fill:#343741}.ml-app .ml-time-series-explorer .ml-timeseries-chart .context-chart .values-line{stroke-width:1}.ml-app .ml-time-series-explorer .ml-timeseries-chart .context-chart .mask polygon{fill-opacity:.1}.ml-app .ml-time-series-explorer .ml-timeseries-chart .context-chart .mask .area.bounds{fill:#D3DAE6}.ml-app .ml-time-series-explorer .ml-timeseries-chart .context-chart .mask .values-line{stroke-width:1;stroke:#98A2B3}.ml-app .ml-time-series-explorer .ml-timeseries-chart .swimlane .axis text{display:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .swimlane rect.swimlane-cell-hidden{display:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .brush .extent{fill-opacity:0;shape-rendering:crispEdges;stroke:#69707D;stroke-width:2;cursor:move}.ml-app .ml-time-series-explorer .ml-timeseries-chart .brush .extent:hover{opacity:1}.ml-app .ml-time-series-explorer .ml-timeseries-chart .top-border{fill:#fff}.ml-app .ml-time-series-explorer .ml-timeseries-chart foreignObject.brush-handle{pointer-events:none;padding-top:1px}.ml-app .ml-time-series-explorer .ml-timeseries-chart div.brush-handle-inner{border:1px solid #69707D;background-color:#D3DAE6;height:70px;width:10px;text-align:center;cursor:ew-resize;margin-top:9px;font-size:14px;fill:#69707D}.ml-app .ml-time-series-explorer .ml-timeseries-chart div.brush-handle-inner-left{border-radius:6px 0 0 6px}.ml-app .ml-time-series-explorer .ml-timeseries-chart div.brush-handle-inner-right{border-radius:0 6px 6px 0}.ml-app .ml-time-series-explorer .ml-timeseries-chart rect.brush-handle{stroke-width:1;stroke:#69707D;fill:#D3DAE6;pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart rect.brush-handle:hover{opacity:1}.ml-app .mlTimeSeriesExplorerProgress{background-color:#fff}.ml-app .mlTimeSeriesExplorerProgress::-moz-progress-bar,.ml-app .mlTimeSeriesExplorerProgress::-webkit-progress-bar{background-color:#fff}.ml-app .mlAnnotationBrush .extent{stroke:#D3DAE6;stroke-width:2px;stroke-dasharray:2 2;fill:#F5F7FA;shape-rendering:geometricPrecision}.ml-app .mlAnnotationRect{stroke:#000;stroke-width:2px;stroke-opacity:.2;transition:stroke-opacity 150ms;fill:#000;fill-opacity:.05;transition:fill-opacity 150ms;shape-rendering:geometricPrecision}.ml-app .mlAnnotationRect-isHighlight{stroke-opacity:.4;transition:stroke-opacity 150ms;fill-opacity:.1;transition:fill-opacity 150ms}.ml-app .mlAnnotationRect-isBlur{stroke-opacity:.1;transition:stroke-opacity 150ms;fill-opacity:.025;transition:fill-opacity 150ms}.ml-app .mlAnnotationText{text-anchor:middle;font-size:12px;font-family:"Inter",-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";font-weight:500;fill:#000;transition:fill 150ms;-webkit-user-select:none;user-select:none}.ml-app .mlAnnotationText-isBlur{fill:#98A2B3;transition:fill 150ms}.ml-app .mlAnnotationTextRect{fill:#D3DAE6;transition:fill 150ms}.ml-app .mlAnnotationTextRect-isBlur{fill:#F5F7FA;transition:fill 150ms}.ml-app .mlAnnotationHidden{display:none}.ml-app .mlContextAnnotationRect{stroke:#000;stroke-width:2px;stroke-opacity:.2;transition:stroke-opacity 150ms;fill:#000;fill-opacity:.05;transition:fill-opacity 150ms;shape-rendering:geometricPrecision}.ml-app .mlContextAnnotationRect-isBlur{stroke-opacity:.1;transition:stroke-opacity 150ms;fill-opacity:.025;transition:fill-opacity 150ms}.ml-app .euiDescriptionList.euiDescriptionList--column.ml-annotation-description-list .euiDescriptionList__title{flex-basis:30%}.ml-app .euiDescriptionList.euiDescriptionList--column.ml-annotation-description-list .euiDescriptionList__description{flex-basis:70%}.ml-app .euiDescriptionList.euiDescriptionList--column.ml-annotation-description-list>*{margin-top:4px}.ml-app .ml-anomalies-table .ml-icon-severity-critical,.ml-app .ml-anomalies-table .ml-icon-severity-major,.ml-app .ml-anomalies-table .ml-icon-severity-minor,.ml-app .ml-anomalies-table .ml-icon-severity-warning,.ml-app .ml-anomalies-table .ml-icon-severity-unknown{color:inherit;text-shadow:none}.ml-app .ml-anomalies-table .ml-icon-severity-critical .euiIcon{fill:#cf4141}.ml-app .ml-anomalies-table .ml-icon-severity-major .euiIcon{fill:#9e6929}.ml-app .ml-anomalies-table .ml-icon-severity-minor .euiIcon{fill:#7c7313}.ml-app .ml-anomalies-table .ml-icon-severity-warning .euiIcon{fill:#537896}.ml-app .ml-anomalies-table .ml-icon-severity-unknown .euiIcon{fill:#69707D}.ml-app .ml-anomalies-table tr th:first-child,.ml-app .ml-anomalies-table tr td:first-child{width:32px}.ml-app .ml-anomalies-table .euiTableCellContent .euiHealth{font-size:inherit}.ml-app .ml-anomalies-table .euiTableCellContent .detector-rules-icon{margin-left:4px;opacity:.5}.ml-app .ml-anomalies-table .euiContextMenuItem{min-width:150px}.ml-app .ml-anomalies-table .mlAnomalyCategoryExamples__header{display:inline}.ml-app .ml-anomalies-table .mlAnomalyCategoryExamples__link{width:100%}.ml-app .ml-anomalies-table .category-example{display:block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.ml-app .ml-anomalies-table .mlAnomalyCategoryExamples{padding:24px}.ml-app .ml-anomalies-table .mlAnomalyCategoryExamples__item{display:block;white-space:wrap;font-family:"Roboto Mono",Consolas,Menlo,Courier,monospace}.ml-app .ml-anomalies-table .interim-result{font-style:italic}.ml-app .ml-anomalies-table .ml-anomalies-table-details{padding:4px 32px;max-height:1000px;overflow-y:auto}.ml-app .ml-anomalies-table .ml-anomalies-table-details .anomaly-description-list .euiDescriptionList__title{margin-top:0;flex-basis:15%;font-size:inherit;line-height:1.5rem;max-width:100%;overflow:hidden !important;text-overflow:ellipsis !important;white-space:nowrap !important;word-wrap:normal !important}.ml-app .ml-anomalies-table .ml-anomalies-table-details .anomaly-description-list .euiDescriptionList__description{margin-top:0;flex-basis:85%;font-size:inherit;line-height:1.5rem}.ml-app .mlColorRangeLegend text{font-size:10px;font-size:.71429rem;fill:#69707D}.ml-app .mlColorRangeLegend .axis path{fill:none;stroke:none}.ml-app .mlColorRangeLegend .axis line{fill:none;stroke:#98A2B3;shape-rendering:crispEdges}.ml-app .ml-table-controls label{font-size:12px;padding:0 0 4px 4px}.ml-app .ml-table-controls .ml-table-controls-element{display:inline-block;padding-left:16px}.ml-app .ml-table-controls select{font-size:12px;font-style:normal}.ml-app .ml-select-severity .euiFormControlLayoutClearButton{display:none}.ml-app .field-value-short{max-width:100%;overflow:hidden !important;text-overflow:ellipsis !important;white-space:nowrap !important;word-wrap:normal !important;display:inline-block;vertical-align:bottom}.ml-app .field-value-long{overflow-wrap:break-word}.ml-app .filter-button{opacity:.5;width:16px;height:16px;transform:translateY(-1px)}.ml-app .filter-button .euiIcon{width:12px;height:12px}.ml-app .filter-button:hover{opacity:1}.ml-app .ml-field-title-bar{font-size:16px;font-size:1.14286rem;line-height:1.71429rem;font-family:Roboto Mono, serif;font-style:normal;font-weight:bold;font-size:14px;border-radius:6px 6px 0 0;padding:4px;margin:-16px -16px 0 -16px;border-top:3px solid;text-align:center}.ml-app .ml-field-title-bar .field-type-icon{vertical-align:middle;margin-bottom:-4px;display:inline-block}.ml-app .ml-field-title-bar .field-name{max-width:100%;overflow:hidden !important;text-overflow:ellipsis !important;white-space:nowrap !important;word-wrap:normal !important;vertical-align:middle;padding-right:8px;max-width:290px;display:inline-block;margin-left:8px}.ml-app .ml-influencers-list{line-height:1.45}.ml-app .ml-influencers-list .field-label{font-size:12px;text-align:left;max-height:14px;max-width:calc(100% - 102px)}.ml-app .ml-influencers-list .field-label .field-value{max-width:100%;overflow:hidden !important;text-overflow:ellipsis !important;white-space:nowrap !important;word-wrap:normal !important;display:inline-block;vertical-align:bottom}.ml-app .ml-influencers-list .progress{display:inline-block;width:calc(100% - 34px);height:22px;min-width:70px;margin-bottom:0;color:#69707D;background-color:transparent}.ml-app .ml-influencers-list .progress .progress-bar-holder{width:calc(100% - 28px)}.ml-app .ml-influencers-list .progress .progress-bar{height:2px;margin-top:12px;text-align:right;line-height:18px;display:inline-block;transition:none}.ml-app .ml-influencers-list .progress.critical .progress-bar{background-color:#FE5050}.ml-app .ml-influencers-list .progress.critical .score-label{border-color:#FE5050}.ml-app .ml-influencers-list .progress.major .progress-bar{background-color:#FBA740}.ml-app .ml-influencers-list .progress.major .score-label{border-color:#FBA740}.ml-app .ml-influencers-list .progress.minor .progress-bar{background-color:#FDEC25}.ml-app .ml-influencers-list .progress.minor .score-label{border-color:#FDEC25}.ml-app .ml-influencers-list .progress.warning .progress-bar{background-color:#8BC8FB}.ml-app .ml-influencers-list .progress.warning .score-label{border-color:#8BC8FB}.ml-app .ml-influencers-list .score-label{text-align:center;line-height:14px;white-space:nowrap;font-size:12px;display:inline;margin-left:4px}.ml-app .ml-influencers-list .total-score-label{width:32px;vertical-align:top;text-align:center;color:#69707D;font-size:11px;line-height:14px;border-radius:6px;padding:2px;margin-top:4px;display:inline-block;border:1px solid #D3DAE6}.ml-app .ml-influencers-list-tooltip{word-break:break-all}.ml-app .ml-items-grid-page-size-menu{width:140px}.ml-app .mlJobSelectorBar{padding:8px}.ml-app .mlJobSelectorFlyoutBody>.euiFlyoutBody__overflow{padding-top:8px}.ml-app .mlJobSelector__ganttBar{background-color:#79ADDA;height:12px;border-radius:2px}.ml-app .mlJobSelector__ganttBarBackEdge{height:16px;border-left:1px solid #D6D6D6;border-right:1px solid #D6D6D6;margin-bottom:-14px;padding-top:8px}.ml-app .mlJobSelector__ganttBarDashed{height:1px;border-top:1px dashed #D6D6D6}.ml-app .mlJobSelector__ganttBarRunning{background-image:linear-gradient(45deg, rgba(255,255,255,0.15) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.15) 50%, rgba(255,255,255,0.15) 75%, transparent 75%, transparent);background-size:40px 40px;animation:progress-bar-stripes 2s linear infinite}.ml-app .ml-loading-indicator{text-align:center;font-size:17px;display:flex;flex-direction:column;align-items:center;justify-content:center}.ml-app .mlNavigationMenu{padding:0 12px;border-bottom:1px solid #D3DAE6;background-color:#fff}.ml-app .ml-rule-editor-flyout{font-size:14px}.ml-app .ml-rule-editor-flyout .select-rule-action .rule-detector-description-list{padding-left:16px}.ml-app .ml-rule-editor-flyout .select-rule-action-panel{padding:8px 0}.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList .euiDescriptionList__title{flex-basis:15%;padding:0 16px}.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList .euiDescriptionList__description{flex-basis:85%}.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList .euiDescriptionList__title:nth-child(1),.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList .euiDescriptionList__description:nth-child(2){color:#1a1c21;font-weight:700;border-bottom:1px solid #D3DAE6;padding-bottom:12px}.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList .euiDescriptionList__title:nth-child(3),.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList .euiDescriptionList__description:nth-child(4){padding-top:8px}.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList.euiDescriptionList--column>*{margin-top:4px}.ml-app .ml-rule-editor-flyout .scope-enable-checkbox .euiCheckbox__input[disabled] ~ .euiCheckbox__label{color:inherit}.ml-app .ml-rule-editor-flyout .scope-field-checkbox{margin-right:2px}.ml-app .ml-rule-editor-flyout .scope-field-checkbox .euiCheckbox{margin-top:4px}.ml-app .ml-rule-editor-flyout .scope-field-button{pointer-events:none;border-bottom:none}.ml-app .ml-rule-editor-flyout .scope-edit-filter-link{line-height:32px;font-size:12px}.ml-app .ml-rule-editor-flyout .condition-edit-value-field{width:170px;height:28px;margin:0 2px}.ml-app .ml-rule-editor-flyout .condition-edit-value-field input{height:28px}.ml-app .ml-rule-editor-flyout .euiExpressionButton.disabled{pointer-events:none}.ml-app .ml-rule-editor-flyout .euiExpressionButton.disabled .euiExpressionButton__value,.ml-app .ml-rule-editor-flyout .euiExpressionButton.disabled .euiExpressionButton__description{color:#D3DAE6}.ml-app .ml-rule-editor-flyout .text-highlight{font-weight:700}.ml-app .euiDescriptionList.euiDescriptionList--column.rule-detector-description-list .euiDescriptionList__title{flex-basis:15%}.ml-app .euiDescriptionList.euiDescriptionList--column.rule-detector-description-list .euiDescriptionList__description{flex-basis:85%}.ml-app .euiDescriptionList.euiDescriptionList--column.rule-detector-description-list>*{margin-top:4px}.ml-app .stat{margin-right:8px}.ml-app .mlStatsBar{height:42px;padding:14px;background-color:#F5F7FA}.ml-app .mlEmbeddedMapContent{width:100%;height:100%;display:flex;flex:1 1 100%;z-index:1;min-height:0}.ml-app .tab-datavisualizer_index_select,.ml-app .tab-timeseriesexplorer,.ml-app .tab-explorer{background-color:#fff}.ml-app .button-wrapper{display:inline}.ml-app .button-wrapper.disabled .kuiButton[disabled]{pointer-events:none}.ml-app .button-wrapper.disabled{cursor:not-allowed}.ml-app .clear,.ml-app .clearfix{clear:both}.ml-app .mlDisableAntiAliasing{-webkit-font-smoothing:none}.ml-app .mlDisableAntiAliasing * canvas{image-rendering:pixelated}\n',""]),module.exports=exports},,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.addXJsonToRules=exports.XJsonHighlightRules=exports.ScriptHighlightRules=exports.ElasticsearchSqlHighlightRules=void 0;var elasticsearch_sql_highlight_rules_1=__webpack_require__(315);Object.defineProperty(exports,"ElasticsearchSqlHighlightRules",{enumerable:!0,get:function(){return elasticsearch_sql_highlight_rules_1.ElasticsearchSqlHighlightRules}});var script_highlight_rules_1=__webpack_require__(317);Object.defineProperty(exports,"ScriptHighlightRules",{enumerable:!0,get:function(){return script_highlight_rules_1.ScriptHighlightRules}});var x_json_highlight_rules_1=__webpack_require__(464);Object.defineProperty(exports,"XJsonHighlightRules",{enumerable:!0,get:function(){return x_json_highlight_rules_1.XJsonHighlightRules}}),Object.defineProperty(exports,"addXJsonToRules",{enumerable:!0,get:function(){return x_json_highlight_rules_1.addToRules}})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.addToRules=exports.XJsonHighlightRules=void 0;const tslib_1=__webpack_require__(35),lodash_1=__webpack_require__(7),brace_1=tslib_1.__importDefault(__webpack_require__(193));__webpack_require__(465);const elasticsearch_sql_highlight_rules_1=__webpack_require__(315),script_highlight_rules_1=__webpack_require__(317),{JsonHighlightRules:JsonHighlightRules}=brace_1.default.acequire("ace/mode/json_highlight_rules"),oop=brace_1.default.acequire("ace/lib/oop"),jsonRules=function(root){const rules={},xJsonRules=[{token:["variable","whitespace","ace.punctuation.colon","whitespace","punctuation.start_triple_quote"],regex:'("(?:[^"]*_)?script"|"inline"|"source")(\\s*?)(:)(\\s*?)(""")',next:"script-start",merge:!1,push:!0},{token:"variable",regex:'["](?:(?:\\\\.)|(?:[^"\\\\]))*?["]\\s*(?=:)'},{token:"punctuation.start_triple_quote",regex:'"""',next:"string_literal",merge:!1,push:!0},{token:"string",regex:'["](?:(?:\\\\.)|(?:[^"\\\\]))*?["]'},{token:"constant.numeric",regex:"0[xX][0-9a-fA-F]+\\b"},{token:"constant.numeric",regex:"[+-]?\\d+(?:(?:\\.\\d*)?(?:[eE][+-]?\\d+)?)?\\b"},{token:"constant.language.boolean",regex:"(?:true|false)\\b"},{token:"invalid.illegal",regex:"['](?:(?:\\\\.)|(?:[^'\\\\]))*?[']"},{token:"invalid.illegal",regex:"\\/\\/.*$"},{token:"paren.lparen",merge:!1,regex:"{",next:root=root||"json",push:!0},{token:"paren.lparen",merge:!1,regex:"[[(]"},{token:"paren.rparen",merge:!1,regex:"[\\])]"},{token:"paren.rparen",regex:"}",merge:!1,next:"pop"},{token:"punctuation.comma",regex:","},{token:"punctuation.colon",regex:":"},{token:"whitespace",regex:"\\s+"},{token:"text",regex:".+?"}];return rules[root]=xJsonRules,rules[root+"-sql"]=[{token:["variable","whitespace","ace.punctuation.colon","whitespace","punctuation.start_triple_quote"],regex:'("query")(\\s*?)(:)(\\s*?)(""")',next:"sql-start",merge:!1,push:!0}].concat(xJsonRules),rules.string_literal=[{token:"punctuation.end_triple_quote",regex:'"""',next:"pop"},{token:"multi_string",regex:"."}],rules};function XJsonHighlightRules(){this.$rules={...jsonRules("start")},this.embedRules(script_highlight_rules_1.ScriptHighlightRules,"script-",[{token:"punctuation.end_triple_quote",regex:'"""',next:"pop"}]),this.embedRules(elasticsearch_sql_highlight_rules_1.ElasticsearchSqlHighlightRules,"sql-",[{token:"punctuation.end_triple_quote",regex:'"""',next:"pop"}])}exports.XJsonHighlightRules=XJsonHighlightRules,oop.inherits(XJsonHighlightRules,JsonHighlightRules),exports.addToRules=function(otherRules,embedUnder){otherRules.$rules=lodash_1.defaultsDeep(otherRules.$rules,jsonRules(embedUnder)),otherRules.embedRules(script_highlight_rules_1.ScriptHighlightRules,"script-",[{token:"punctuation.end_triple_quote",regex:'"""',next:"pop"}]),otherRules.embedRules(elasticsearch_sql_highlight_rules_1.ElasticsearchSqlHighlightRules,"sql-",[{token:"punctuation.end_triple_quote",regex:'"""',next:"pop"}])}},function(module,exports,__webpack_require__){ace.define("ace/mode/json_highlight_rules",["require","exports","module","ace/lib/oop","ace/mode/text_highlight_rules"],(function(acequire,exports,module){"use strict";var oop=acequire("../lib/oop"),TextHighlightRules=acequire("./text_highlight_rules").TextHighlightRules,JsonHighlightRules=function(){this.$rules={start:[{token:"variable",regex:'["](?:(?:\\\\.)|(?:[^"\\\\]))*?["]\\s*(?=:)'},{token:"string",regex:'"',next:"string"},{token:"constant.numeric",regex:"0[xX][0-9a-fA-F]+\\b"},{token:"constant.numeric",regex:"[+-]?\\d+(?:(?:\\.\\d*)?(?:[eE][+-]?\\d+)?)?\\b"},{token:"constant.language.boolean",regex:"(?:true|false)\\b"},{token:"text",regex:"['](?:(?:\\\\.)|(?:[^'\\\\]))*?[']"},{token:"comment",regex:"\\/\\/.*$"},{token:"comment.start",regex:"\\/\\*",next:"comment"},{token:"paren.lparen",regex:"[[({]"},{token:"paren.rparen",regex:"[\\])}]"},{token:"text",regex:"\\s+"}],string:[{token:"constant.language.escape",regex:/\\(?:x[0-9a-fA-F]{2}|u[0-9a-fA-F]{4}|["\\\/bfnrt])/},{token:"string",regex:'"|$',next:"start"},{defaultToken:"string"}],comment:[{token:"comment.end",regex:"\\*\\/",next:"start"},{defaultToken:"comment"}]}};oop.inherits(JsonHighlightRules,TextHighlightRules),exports.JsonHighlightRules=JsonHighlightRules})),ace.define("ace/mode/matching_brace_outdent",["require","exports","module","ace/range"],(function(acequire,exports,module){"use strict";var Range=acequire("../range").Range,MatchingBraceOutdent=function(){};(function(){this.checkOutdent=function(line,input){return!!/^\s+$/.test(line)&&/^\s*\}/.test(input)},this.autoOutdent=function(doc,row){var match=doc.getLine(row).match(/^(\s*\})/);if(!match)return 0;var column=match[1].length,openBracePos=doc.findMatchingBracket({row:row,column:column});if(!openBracePos||openBracePos.row==row)return 0;var indent=this.$getIndent(doc.getLine(openBracePos.row));doc.replace(new Range(row,0,row,column-1),indent)},this.$getIndent=function(line){return line.match(/^\s*/)[0]}}).call(MatchingBraceOutdent.prototype),exports.MatchingBraceOutdent=MatchingBraceOutdent})),ace.define("ace/mode/folding/cstyle",["require","exports","module","ace/lib/oop","ace/range","ace/mode/folding/fold_mode"],(function(acequire,exports,module){"use strict";var oop=acequire("../../lib/oop"),Range=acequire("../../range").Range,BaseFoldMode=acequire("./fold_mode").FoldMode,FoldMode=exports.FoldMode=function(commentRegex){commentRegex&&(this.foldingStartMarker=new RegExp(this.foldingStartMarker.source.replace(/\|[^|]*?$/,"|"+commentRegex.start)),this.foldingStopMarker=new RegExp(this.foldingStopMarker.source.replace(/\|[^|]*?$/,"|"+commentRegex.end)))};oop.inherits(FoldMode,BaseFoldMode),function(){this.foldingStartMarker=/([\{\[\(])[^\}\]\)]*$|^\s*(\/\*)/,this.foldingStopMarker=/^[^\[\{\(]*([\}\]\)])|^[\s\*]*(\*\/)/,this.singleLineBlockCommentRe=/^\s*(\/\*).*\*\/\s*$/,this.tripleStarBlockCommentRe=/^\s*(\/\*\*\*).*\*\/\s*$/,this.startRegionRe=/^\s*(\/\*|\/\/)#?region\b/,this._getFoldWidgetBase=this.getFoldWidget,this.getFoldWidget=function(session,foldStyle,row){var line=session.getLine(row);if(this.singleLineBlockCommentRe.test(line)&&!this.startRegionRe.test(line)&&!this.tripleStarBlockCommentRe.test(line))return"";var fw=this._getFoldWidgetBase(session,foldStyle,row);return!fw&&this.startRegionRe.test(line)?"start":fw},this.getFoldWidgetRange=function(session,foldStyle,row,forceMultiline){var match,line=session.getLine(row);if(this.startRegionRe.test(line))return this.getCommentRegionBlock(session,line,row);if(match=line.match(this.foldingStartMarker)){var i=match.index;if(match[1])return this.openingBracketBlock(session,match[1],row,i);var range=session.getCommentFoldRange(row,i+match[0].length,1);return range&&!range.isMultiLine()&&(forceMultiline?range=this.getSectionRange(session,row):"all"!=foldStyle&&(range=null)),range}if("markbegin"!==foldStyle&&(match=line.match(this.foldingStopMarker))){i=match.index+match[0].length;return match[1]?this.closingBracketBlock(session,match[1],row,i):session.getCommentFoldRange(row,i,-1)}},this.getSectionRange=function(session,row){for(var line=session.getLine(row),startIndent=line.search(/\S/),startRow=row,startColumn=line.length,endRow=row+=1,maxRow=session.getLength();++row<maxRow;){var indent=(line=session.getLine(row)).search(/\S/);if(-1!==indent){if(startIndent>indent)break;var subRange=this.getFoldWidgetRange(session,"all",row);if(subRange){if(subRange.start.row<=startRow)break;if(subRange.isMultiLine())row=subRange.end.row;else if(startIndent==indent)break}endRow=row}}return new Range(startRow,startColumn,endRow,session.getLine(endRow).length)},this.getCommentRegionBlock=function(session,line,row){for(var startColumn=line.search(/\s*$/),maxRow=session.getLength(),startRow=row,re=/^\s*(?:\/\*|\/\/|--)#?(end)?region\b/,depth=1;++row<maxRow;){line=session.getLine(row);var m=re.exec(line);if(m&&(m[1]?depth--:depth++,!depth))break}if(row>startRow)return new Range(startRow,startColumn,row,line.length)}}.call(FoldMode.prototype)})),ace.define("ace/mode/json",["require","exports","module","ace/lib/oop","ace/mode/text","ace/mode/json_highlight_rules","ace/mode/matching_brace_outdent","ace/mode/behaviour/cstyle","ace/mode/folding/cstyle","ace/worker/worker_client"],(function(acequire,exports,module){"use strict";var oop=acequire("../lib/oop"),TextMode=acequire("./text").Mode,HighlightRules=acequire("./json_highlight_rules").JsonHighlightRules,MatchingBraceOutdent=acequire("./matching_brace_outdent").MatchingBraceOutdent,CstyleBehaviour=acequire("./behaviour/cstyle").CstyleBehaviour,CStyleFoldMode=acequire("./folding/cstyle").FoldMode,WorkerClient=acequire("../worker/worker_client").WorkerClient,Mode=function(){this.HighlightRules=HighlightRules,this.$outdent=new MatchingBraceOutdent,this.$behaviour=new CstyleBehaviour,this.foldingRules=new CStyleFoldMode};oop.inherits(Mode,TextMode),function(){this.getNextLineIndent=function(state,line,tab){var indent=this.$getIndent(line);"start"==state&&(line.match(/^.*[\{\(\[]\s*$/)&&(indent+=tab));return indent},this.checkOutdent=function(state,line,input){return this.$outdent.checkOutdent(line,input)},this.autoOutdent=function(state,doc,row){this.$outdent.autoOutdent(doc,row)},this.createWorker=function(session){var worker=new WorkerClient(["ace"],__webpack_require__(466),"JsonWorker");return worker.attachToDocument(session.getDocument()),worker.on("annotate",(function(e){session.setAnnotations(e.data)})),worker.on("terminate",(function(){session.clearAnnotations()})),worker},this.$id="ace/mode/json"}.call(Mode.prototype),exports.Mode=Mode}))},function(module,exports){module.exports.id="ace/mode/json_worker",module.exports.src='"no use strict";!function(window){function resolveModuleId(id,paths){for(var testPath=id,tail="";testPath;){var alias=paths[testPath];if("string"==typeof alias)return alias+tail;if(alias)return alias.location.replace(/\\/*$/,"/")+(tail||alias.main||alias.name);if(alias===!1)return"";var i=testPath.lastIndexOf("/");if(-1===i)break;tail=testPath.substr(i)+tail,testPath=testPath.slice(0,i)}return id}if(!(void 0!==window.window&&window.document||window.acequire&&window.define)){window.console||(window.console=function(){var msgs=Array.prototype.slice.call(arguments,0);postMessage({type:"log",data:msgs})},window.console.error=window.console.warn=window.console.log=window.console.trace=window.console),window.window=window,window.ace=window,window.onerror=function(message,file,line,col,err){postMessage({type:"error",data:{message:message,data:err.data,file:file,line:line,col:col,stack:err.stack}})},window.normalizeModule=function(parentId,moduleName){if(-1!==moduleName.indexOf("!")){var chunks=moduleName.split("!");return window.normalizeModule(parentId,chunks[0])+"!"+window.normalizeModule(parentId,chunks[1])}if("."==moduleName.charAt(0)){var base=parentId.split("/").slice(0,-1).join("/");for(moduleName=(base?base+"/":"")+moduleName;-1!==moduleName.indexOf(".")&&previous!=moduleName;){var previous=moduleName;moduleName=moduleName.replace(/^\\.\\//,"").replace(/\\/\\.\\//,"/").replace(/[^\\/]+\\/\\.\\.\\//,"")}}return moduleName},window.acequire=function acequire(parentId,id){if(id||(id=parentId,parentId=null),!id.charAt)throw Error("worker.js acequire() accepts only (parentId, id) as arguments");id=window.normalizeModule(parentId,id);var module=window.acequire.modules[id];if(module)return module.initialized||(module.initialized=!0,module.exports=module.factory().exports),module.exports;if(!window.acequire.tlns)return console.log("unable to load "+id);var path=resolveModuleId(id,window.acequire.tlns);return".js"!=path.slice(-3)&&(path+=".js"),window.acequire.id=id,window.acequire.modules[id]={},importScripts(path),window.acequire(parentId,id)},window.acequire.modules={},window.acequire.tlns={},window.define=function(id,deps,factory){if(2==arguments.length?(factory=deps,"string"!=typeof id&&(deps=id,id=window.acequire.id)):1==arguments.length&&(factory=id,deps=[],id=window.acequire.id),"function"!=typeof factory)return window.acequire.modules[id]={exports:factory,initialized:!0},void 0;deps.length||(deps=["require","exports","module"]);var req=function(childId){return window.acequire(id,childId)};window.acequire.modules[id]={exports:{},factory:function(){var module=this,returnExports=factory.apply(this,deps.map(function(dep){switch(dep){case"require":return req;case"exports":return module.exports;case"module":return module;default:return req(dep)}}));return returnExports&&(module.exports=returnExports),module}}},window.define.amd={},acequire.tlns={},window.initBaseUrls=function(topLevelNamespaces){for(var i in topLevelNamespaces)acequire.tlns[i]=topLevelNamespaces[i]},window.initSender=function(){var EventEmitter=window.acequire("ace/lib/event_emitter").EventEmitter,oop=window.acequire("ace/lib/oop"),Sender=function(){};return function(){oop.implement(this,EventEmitter),this.callback=function(data,callbackId){postMessage({type:"call",id:callbackId,data:data})},this.emit=function(name,data){postMessage({type:"event",name:name,data:data})}}.call(Sender.prototype),new Sender};var main=window.main=null,sender=window.sender=null;window.onmessage=function(e){var msg=e.data;if(msg.event&&sender)sender._signal(msg.event,msg.data);else if(msg.command)if(main[msg.command])main[msg.command].apply(main,msg.args);else{if(!window[msg.command])throw Error("Unknown command:"+msg.command);window[msg.command].apply(window,msg.args)}else if(msg.init){window.initBaseUrls(msg.tlns),acequire("ace/lib/es5-shim"),sender=window.sender=window.initSender();var clazz=acequire(msg.module)[msg.classname];main=window.main=new clazz(sender)}}}}(this),ace.define("ace/lib/oop",["require","exports","module"],function(acequire,exports){"use strict";exports.inherits=function(ctor,superCtor){ctor.super_=superCtor,ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:!1,writable:!0,configurable:!0}})},exports.mixin=function(obj,mixin){for(var key in mixin)obj[key]=mixin[key];return obj},exports.implement=function(proto,mixin){exports.mixin(proto,mixin)}}),ace.define("ace/range",["require","exports","module"],function(acequire,exports){"use strict";var comparePoints=function(p1,p2){return p1.row-p2.row||p1.column-p2.column},Range=function(startRow,startColumn,endRow,endColumn){this.start={row:startRow,column:startColumn},this.end={row:endRow,column:endColumn}};(function(){this.isEqual=function(range){return this.start.row===range.start.row&&this.end.row===range.end.row&&this.start.column===range.start.column&&this.end.column===range.end.column},this.toString=function(){return"Range: ["+this.start.row+"/"+this.start.column+"] -> ["+this.end.row+"/"+this.end.column+"]"},this.contains=function(row,column){return 0==this.compare(row,column)},this.compareRange=function(range){var cmp,end=range.end,start=range.start;return cmp=this.compare(end.row,end.column),1==cmp?(cmp=this.compare(start.row,start.column),1==cmp?2:0==cmp?1:0):-1==cmp?-2:(cmp=this.compare(start.row,start.column),-1==cmp?-1:1==cmp?42:0)},this.comparePoint=function(p){return this.compare(p.row,p.column)},this.containsRange=function(range){return 0==this.comparePoint(range.start)&&0==this.comparePoint(range.end)},this.intersects=function(range){var cmp=this.compareRange(range);return-1==cmp||0==cmp||1==cmp},this.isEnd=function(row,column){return this.end.row==row&&this.end.column==column},this.isStart=function(row,column){return this.start.row==row&&this.start.column==column},this.setStart=function(row,column){"object"==typeof row?(this.start.column=row.column,this.start.row=row.row):(this.start.row=row,this.start.column=column)},this.setEnd=function(row,column){"object"==typeof row?(this.end.column=row.column,this.end.row=row.row):(this.end.row=row,this.end.column=column)},this.inside=function(row,column){return 0==this.compare(row,column)?this.isEnd(row,column)||this.isStart(row,column)?!1:!0:!1},this.insideStart=function(row,column){return 0==this.compare(row,column)?this.isEnd(row,column)?!1:!0:!1},this.insideEnd=function(row,column){return 0==this.compare(row,column)?this.isStart(row,column)?!1:!0:!1},this.compare=function(row,column){return this.isMultiLine()||row!==this.start.row?this.start.row>row?-1:row>this.end.row?1:this.start.row===row?column>=this.start.column?0:-1:this.end.row===row?this.end.column>=column?0:1:0:this.start.column>column?-1:column>this.end.column?1:0},this.compareStart=function(row,column){return this.start.row==row&&this.start.column==column?-1:this.compare(row,column)},this.compareEnd=function(row,column){return this.end.row==row&&this.end.column==column?1:this.compare(row,column)},this.compareInside=function(row,column){return this.end.row==row&&this.end.column==column?1:this.start.row==row&&this.start.column==column?-1:this.compare(row,column)},this.clipRows=function(firstRow,lastRow){if(this.end.row>lastRow)var end={row:lastRow+1,column:0};else if(firstRow>this.end.row)var end={row:firstRow,column:0};if(this.start.row>lastRow)var start={row:lastRow+1,column:0};else if(firstRow>this.start.row)var start={row:firstRow,column:0};return Range.fromPoints(start||this.start,end||this.end)},this.extend=function(row,column){var cmp=this.compare(row,column);if(0==cmp)return this;if(-1==cmp)var start={row:row,column:column};else var end={row:row,column:column};return Range.fromPoints(start||this.start,end||this.end)},this.isEmpty=function(){return this.start.row===this.end.row&&this.start.column===this.end.column},this.isMultiLine=function(){return this.start.row!==this.end.row},this.clone=function(){return Range.fromPoints(this.start,this.end)},this.collapseRows=function(){return 0==this.end.column?new Range(this.start.row,0,Math.max(this.start.row,this.end.row-1),0):new Range(this.start.row,0,this.end.row,0)},this.toScreenRange=function(session){var screenPosStart=session.documentToScreenPosition(this.start),screenPosEnd=session.documentToScreenPosition(this.end);return new Range(screenPosStart.row,screenPosStart.column,screenPosEnd.row,screenPosEnd.column)},this.moveBy=function(row,column){this.start.row+=row,this.start.column+=column,this.end.row+=row,this.end.column+=column}}).call(Range.prototype),Range.fromPoints=function(start,end){return new Range(start.row,start.column,end.row,end.column)},Range.comparePoints=comparePoints,Range.comparePoints=function(p1,p2){return p1.row-p2.row||p1.column-p2.column},exports.Range=Range}),ace.define("ace/apply_delta",["require","exports","module"],function(acequire,exports){"use strict";exports.applyDelta=function(docLines,delta){var row=delta.start.row,startColumn=delta.start.column,line=docLines[row]||"";switch(delta.action){case"insert":var lines=delta.lines;if(1===lines.length)docLines[row]=line.substring(0,startColumn)+delta.lines[0]+line.substring(startColumn);else{var args=[row,1].concat(delta.lines);docLines.splice.apply(docLines,args),docLines[row]=line.substring(0,startColumn)+docLines[row],docLines[row+delta.lines.length-1]+=line.substring(startColumn)}break;case"remove":var endColumn=delta.end.column,endRow=delta.end.row;row===endRow?docLines[row]=line.substring(0,startColumn)+line.substring(endColumn):docLines.splice(row,endRow-row+1,line.substring(0,startColumn)+docLines[endRow].substring(endColumn))}}}),ace.define("ace/lib/event_emitter",["require","exports","module"],function(acequire,exports){"use strict";var EventEmitter={},stopPropagation=function(){this.propagationStopped=!0},preventDefault=function(){this.defaultPrevented=!0};EventEmitter._emit=EventEmitter._dispatchEvent=function(eventName,e){this._eventRegistry||(this._eventRegistry={}),this._defaultHandlers||(this._defaultHandlers={});var listeners=this._eventRegistry[eventName]||[],defaultHandler=this._defaultHandlers[eventName];if(listeners.length||defaultHandler){"object"==typeof e&&e||(e={}),e.type||(e.type=eventName),e.stopPropagation||(e.stopPropagation=stopPropagation),e.preventDefault||(e.preventDefault=preventDefault),listeners=listeners.slice();for(var i=0;listeners.length>i&&(listeners[i](e,this),!e.propagationStopped);i++);return defaultHandler&&!e.defaultPrevented?defaultHandler(e,this):void 0}},EventEmitter._signal=function(eventName,e){var listeners=(this._eventRegistry||{})[eventName];if(listeners){listeners=listeners.slice();for(var i=0;listeners.length>i;i++)listeners[i](e,this)}},EventEmitter.once=function(eventName,callback){var _self=this;callback&&this.addEventListener(eventName,function newCallback(){_self.removeEventListener(eventName,newCallback),callback.apply(null,arguments)})},EventEmitter.setDefaultHandler=function(eventName,callback){var handlers=this._defaultHandlers;if(handlers||(handlers=this._defaultHandlers={_disabled_:{}}),handlers[eventName]){var old=handlers[eventName],disabled=handlers._disabled_[eventName];disabled||(handlers._disabled_[eventName]=disabled=[]),disabled.push(old);var i=disabled.indexOf(callback);-1!=i&&disabled.splice(i,1)}handlers[eventName]=callback},EventEmitter.removeDefaultHandler=function(eventName,callback){var handlers=this._defaultHandlers;if(handlers){var disabled=handlers._disabled_[eventName];if(handlers[eventName]==callback)handlers[eventName],disabled&&this.setDefaultHandler(eventName,disabled.pop());else if(disabled){var i=disabled.indexOf(callback);-1!=i&&disabled.splice(i,1)}}},EventEmitter.on=EventEmitter.addEventListener=function(eventName,callback,capturing){this._eventRegistry=this._eventRegistry||{};var listeners=this._eventRegistry[eventName];return listeners||(listeners=this._eventRegistry[eventName]=[]),-1==listeners.indexOf(callback)&&listeners[capturing?"unshift":"push"](callback),callback},EventEmitter.off=EventEmitter.removeListener=EventEmitter.removeEventListener=function(eventName,callback){this._eventRegistry=this._eventRegistry||{};var listeners=this._eventRegistry[eventName];if(listeners){var index=listeners.indexOf(callback);-1!==index&&listeners.splice(index,1)}},EventEmitter.removeAllListeners=function(eventName){this._eventRegistry&&(this._eventRegistry[eventName]=[])},exports.EventEmitter=EventEmitter}),ace.define("ace/anchor",["require","exports","module","ace/lib/oop","ace/lib/event_emitter"],function(acequire,exports){"use strict";var oop=acequire("./lib/oop"),EventEmitter=acequire("./lib/event_emitter").EventEmitter,Anchor=exports.Anchor=function(doc,row,column){this.$onChange=this.onChange.bind(this),this.attach(doc),column===void 0?this.setPosition(row.row,row.column):this.setPosition(row,column)};(function(){function $pointsInOrder(point1,point2,equalPointsInOrder){var bColIsAfter=equalPointsInOrder?point1.column<=point2.column:point1.column<point2.column;return point1.row<point2.row||point1.row==point2.row&&bColIsAfter}function $getTransformedPoint(delta,point,moveIfEqual){var deltaIsInsert="insert"==delta.action,deltaRowShift=(deltaIsInsert?1:-1)*(delta.end.row-delta.start.row),deltaColShift=(deltaIsInsert?1:-1)*(delta.end.column-delta.start.column),deltaStart=delta.start,deltaEnd=deltaIsInsert?deltaStart:delta.end;return $pointsInOrder(point,deltaStart,moveIfEqual)?{row:point.row,column:point.column}:$pointsInOrder(deltaEnd,point,!moveIfEqual)?{row:point.row+deltaRowShift,column:point.column+(point.row==deltaEnd.row?deltaColShift:0)}:{row:deltaStart.row,column:deltaStart.column}}oop.implement(this,EventEmitter),this.getPosition=function(){return this.$clipPositionToDocument(this.row,this.column)},this.getDocument=function(){return this.document},this.$insertRight=!1,this.onChange=function(delta){if(!(delta.start.row==delta.end.row&&delta.start.row!=this.row||delta.start.row>this.row)){var point=$getTransformedPoint(delta,{row:this.row,column:this.column},this.$insertRight);this.setPosition(point.row,point.column,!0)}},this.setPosition=function(row,column,noClip){var pos;if(pos=noClip?{row:row,column:column}:this.$clipPositionToDocument(row,column),this.row!=pos.row||this.column!=pos.column){var old={row:this.row,column:this.column};this.row=pos.row,this.column=pos.column,this._signal("change",{old:old,value:pos})}},this.detach=function(){this.document.removeEventListener("change",this.$onChange)},this.attach=function(doc){this.document=doc||this.document,this.document.on("change",this.$onChange)},this.$clipPositionToDocument=function(row,column){var pos={};return row>=this.document.getLength()?(pos.row=Math.max(0,this.document.getLength()-1),pos.column=this.document.getLine(pos.row).length):0>row?(pos.row=0,pos.column=0):(pos.row=row,pos.column=Math.min(this.document.getLine(pos.row).length,Math.max(0,column))),0>column&&(pos.column=0),pos}}).call(Anchor.prototype)}),ace.define("ace/document",["require","exports","module","ace/lib/oop","ace/apply_delta","ace/lib/event_emitter","ace/range","ace/anchor"],function(acequire,exports){"use strict";var oop=acequire("./lib/oop"),applyDelta=acequire("./apply_delta").applyDelta,EventEmitter=acequire("./lib/event_emitter").EventEmitter,Range=acequire("./range").Range,Anchor=acequire("./anchor").Anchor,Document=function(textOrLines){this.$lines=[""],0===textOrLines.length?this.$lines=[""]:Array.isArray(textOrLines)?this.insertMergedLines({row:0,column:0},textOrLines):this.insert({row:0,column:0},textOrLines)};(function(){oop.implement(this,EventEmitter),this.setValue=function(text){var len=this.getLength()-1;this.remove(new Range(0,0,len,this.getLine(len).length)),this.insert({row:0,column:0},text)},this.getValue=function(){return this.getAllLines().join(this.getNewLineCharacter())},this.createAnchor=function(row,column){return new Anchor(this,row,column)},this.$split=0==="aaa".split(/a/).length?function(text){return text.replace(/\\r\\n|\\r/g,"\\n").split("\\n")}:function(text){return text.split(/\\r\\n|\\r|\\n/)},this.$detectNewLine=function(text){var match=text.match(/^.*?(\\r\\n|\\r|\\n)/m);this.$autoNewLine=match?match[1]:"\\n",this._signal("changeNewLineMode")},this.getNewLineCharacter=function(){switch(this.$newLineMode){case"windows":return"\\r\\n";case"unix":return"\\n";default:return this.$autoNewLine||"\\n"}},this.$autoNewLine="",this.$newLineMode="auto",this.setNewLineMode=function(newLineMode){this.$newLineMode!==newLineMode&&(this.$newLineMode=newLineMode,this._signal("changeNewLineMode"))},this.getNewLineMode=function(){return this.$newLineMode},this.isNewLine=function(text){return"\\r\\n"==text||"\\r"==text||"\\n"==text},this.getLine=function(row){return this.$lines[row]||""},this.getLines=function(firstRow,lastRow){return this.$lines.slice(firstRow,lastRow+1)},this.getAllLines=function(){return this.getLines(0,this.getLength())},this.getLength=function(){return this.$lines.length},this.getTextRange=function(range){return this.getLinesForRange(range).join(this.getNewLineCharacter())},this.getLinesForRange=function(range){var lines;if(range.start.row===range.end.row)lines=[this.getLine(range.start.row).substring(range.start.column,range.end.column)];else{lines=this.getLines(range.start.row,range.end.row),lines[0]=(lines[0]||"").substring(range.start.column);var l=lines.length-1;range.end.row-range.start.row==l&&(lines[l]=lines[l].substring(0,range.end.column))}return lines},this.insertLines=function(row,lines){return console.warn("Use of document.insertLines is deprecated. Use the insertFullLines method instead."),this.insertFullLines(row,lines)},this.removeLines=function(firstRow,lastRow){return console.warn("Use of document.removeLines is deprecated. Use the removeFullLines method instead."),this.removeFullLines(firstRow,lastRow)},this.insertNewLine=function(position){return console.warn("Use of document.insertNewLine is deprecated. Use insertMergedLines(position, [\'\', \'\']) instead."),this.insertMergedLines(position,["",""])},this.insert=function(position,text){return 1>=this.getLength()&&this.$detectNewLine(text),this.insertMergedLines(position,this.$split(text))},this.insertInLine=function(position,text){var start=this.clippedPos(position.row,position.column),end=this.pos(position.row,position.column+text.length);return this.applyDelta({start:start,end:end,action:"insert",lines:[text]},!0),this.clonePos(end)},this.clippedPos=function(row,column){var length=this.getLength();void 0===row?row=length:0>row?row=0:row>=length&&(row=length-1,column=void 0);var line=this.getLine(row);return void 0==column&&(column=line.length),column=Math.min(Math.max(column,0),line.length),{row:row,column:column}},this.clonePos=function(pos){return{row:pos.row,column:pos.column}},this.pos=function(row,column){return{row:row,column:column}},this.$clipPosition=function(position){var length=this.getLength();return position.row>=length?(position.row=Math.max(0,length-1),position.column=this.getLine(length-1).length):(position.row=Math.max(0,position.row),position.column=Math.min(Math.max(position.column,0),this.getLine(position.row).length)),position},this.insertFullLines=function(row,lines){row=Math.min(Math.max(row,0),this.getLength());var column=0;this.getLength()>row?(lines=lines.concat([""]),column=0):(lines=[""].concat(lines),row--,column=this.$lines[row].length),this.insertMergedLines({row:row,column:column},lines)},this.insertMergedLines=function(position,lines){var start=this.clippedPos(position.row,position.column),end={row:start.row+lines.length-1,column:(1==lines.length?start.column:0)+lines[lines.length-1].length};return this.applyDelta({start:start,end:end,action:"insert",lines:lines}),this.clonePos(end)},this.remove=function(range){var start=this.clippedPos(range.start.row,range.start.column),end=this.clippedPos(range.end.row,range.end.column);return this.applyDelta({start:start,end:end,action:"remove",lines:this.getLinesForRange({start:start,end:end})}),this.clonePos(start)},this.removeInLine=function(row,startColumn,endColumn){var start=this.clippedPos(row,startColumn),end=this.clippedPos(row,endColumn);return this.applyDelta({start:start,end:end,action:"remove",lines:this.getLinesForRange({start:start,end:end})},!0),this.clonePos(start)},this.removeFullLines=function(firstRow,lastRow){firstRow=Math.min(Math.max(0,firstRow),this.getLength()-1),lastRow=Math.min(Math.max(0,lastRow),this.getLength()-1);var deleteFirstNewLine=lastRow==this.getLength()-1&&firstRow>0,deleteLastNewLine=this.getLength()-1>lastRow,startRow=deleteFirstNewLine?firstRow-1:firstRow,startCol=deleteFirstNewLine?this.getLine(startRow).length:0,endRow=deleteLastNewLine?lastRow+1:lastRow,endCol=deleteLastNewLine?0:this.getLine(endRow).length,range=new Range(startRow,startCol,endRow,endCol),deletedLines=this.$lines.slice(firstRow,lastRow+1);return this.applyDelta({start:range.start,end:range.end,action:"remove",lines:this.getLinesForRange(range)}),deletedLines},this.removeNewLine=function(row){this.getLength()-1>row&&row>=0&&this.applyDelta({start:this.pos(row,this.getLine(row).length),end:this.pos(row+1,0),action:"remove",lines:["",""]})},this.replace=function(range,text){if(range instanceof Range||(range=Range.fromPoints(range.start,range.end)),0===text.length&&range.isEmpty())return range.start;if(text==this.getTextRange(range))return range.end;this.remove(range);var end;return end=text?this.insert(range.start,text):range.start},this.applyDeltas=function(deltas){for(var i=0;deltas.length>i;i++)this.applyDelta(deltas[i])},this.revertDeltas=function(deltas){for(var i=deltas.length-1;i>=0;i--)this.revertDelta(deltas[i])},this.applyDelta=function(delta,doNotValidate){var isInsert="insert"==delta.action;(isInsert?1>=delta.lines.length&&!delta.lines[0]:!Range.comparePoints(delta.start,delta.end))||(isInsert&&delta.lines.length>2e4&&this.$splitAndapplyLargeDelta(delta,2e4),applyDelta(this.$lines,delta,doNotValidate),this._signal("change",delta))},this.$splitAndapplyLargeDelta=function(delta,MAX){for(var lines=delta.lines,l=lines.length,row=delta.start.row,column=delta.start.column,from=0,to=0;;){from=to,to+=MAX-1;var chunk=lines.slice(from,to);if(to>l){delta.lines=chunk,delta.start.row=row+from,delta.start.column=column;break}chunk.push(""),this.applyDelta({start:this.pos(row+from,column),end:this.pos(row+to,column=0),action:delta.action,lines:chunk},!0)}},this.revertDelta=function(delta){this.applyDelta({start:this.clonePos(delta.start),end:this.clonePos(delta.end),action:"insert"==delta.action?"remove":"insert",lines:delta.lines.slice()})},this.indexToPosition=function(index,startRow){for(var lines=this.$lines||this.getAllLines(),newlineLength=this.getNewLineCharacter().length,i=startRow||0,l=lines.length;l>i;i++)if(index-=lines[i].length+newlineLength,0>index)return{row:i,column:index+lines[i].length+newlineLength};return{row:l-1,column:lines[l-1].length}},this.positionToIndex=function(pos,startRow){for(var lines=this.$lines||this.getAllLines(),newlineLength=this.getNewLineCharacter().length,index=0,row=Math.min(pos.row,lines.length),i=startRow||0;row>i;++i)index+=lines[i].length+newlineLength;return index+pos.column}}).call(Document.prototype),exports.Document=Document}),ace.define("ace/lib/lang",["require","exports","module"],function(acequire,exports){"use strict";exports.last=function(a){return a[a.length-1]},exports.stringReverse=function(string){return string.split("").reverse().join("")},exports.stringRepeat=function(string,count){for(var result="";count>0;)1&count&&(result+=string),(count>>=1)&&(string+=string);return result};var trimBeginRegexp=/^\\s\\s*/,trimEndRegexp=/\\s\\s*$/;exports.stringTrimLeft=function(string){return string.replace(trimBeginRegexp,"")},exports.stringTrimRight=function(string){return string.replace(trimEndRegexp,"")},exports.copyObject=function(obj){var copy={};for(var key in obj)copy[key]=obj[key];return copy},exports.copyArray=function(array){for(var copy=[],i=0,l=array.length;l>i;i++)copy[i]=array[i]&&"object"==typeof array[i]?this.copyObject(array[i]):array[i];return copy},exports.deepCopy=function deepCopy(obj){if("object"!=typeof obj||!obj)return obj;var copy;if(Array.isArray(obj)){copy=[];for(var key=0;obj.length>key;key++)copy[key]=deepCopy(obj[key]);return copy}if("[object Object]"!==Object.prototype.toString.call(obj))return obj;copy={};for(var key in obj)copy[key]=deepCopy(obj[key]);return copy},exports.arrayToMap=function(arr){for(var map={},i=0;arr.length>i;i++)map[arr[i]]=1;return map},exports.createMap=function(props){var map=Object.create(null);for(var i in props)map[i]=props[i];return map},exports.arrayRemove=function(array,value){for(var i=0;array.length>=i;i++)value===array[i]&&array.splice(i,1)},exports.escapeRegExp=function(str){return str.replace(/([.*+?^${}()|[\\]\\/\\\\])/g,"\\\\$1")},exports.escapeHTML=function(str){return str.replace(/&/g,"&#38;").replace(/"/g,"&#34;").replace(/\'/g,"&#39;").replace(/</g,"&#60;")},exports.getMatchOffsets=function(string,regExp){var matches=[];return string.replace(regExp,function(str){matches.push({offset:arguments[arguments.length-2],length:str.length})}),matches},exports.deferredCall=function(fcn){var timer=null,callback=function(){timer=null,fcn()},deferred=function(timeout){return deferred.cancel(),timer=setTimeout(callback,timeout||0),deferred};return deferred.schedule=deferred,deferred.call=function(){return this.cancel(),fcn(),deferred},deferred.cancel=function(){return clearTimeout(timer),timer=null,deferred},deferred.isPending=function(){return timer},deferred},exports.delayedCall=function(fcn,defaultTimeout){var timer=null,callback=function(){timer=null,fcn()},_self=function(timeout){null==timer&&(timer=setTimeout(callback,timeout||defaultTimeout))};return _self.delay=function(timeout){timer&&clearTimeout(timer),timer=setTimeout(callback,timeout||defaultTimeout)},_self.schedule=_self,_self.call=function(){this.cancel(),fcn()},_self.cancel=function(){timer&&clearTimeout(timer),timer=null},_self.isPending=function(){return timer},_self}}),ace.define("ace/worker/mirror",["require","exports","module","ace/range","ace/document","ace/lib/lang"],function(acequire,exports){"use strict";acequire("../range").Range;var Document=acequire("../document").Document,lang=acequire("../lib/lang"),Mirror=exports.Mirror=function(sender){this.sender=sender;var doc=this.doc=new Document(""),deferredUpdate=this.deferredUpdate=lang.delayedCall(this.onUpdate.bind(this)),_self=this;sender.on("change",function(e){var data=e.data;if(data[0].start)doc.applyDeltas(data);else for(var i=0;data.length>i;i+=2){if(Array.isArray(data[i+1]))var d={action:"insert",start:data[i],lines:data[i+1]};else var d={action:"remove",start:data[i],end:data[i+1]};doc.applyDelta(d,!0)}return _self.$timeout?deferredUpdate.schedule(_self.$timeout):(_self.onUpdate(),void 0)})};(function(){this.$timeout=500,this.setTimeout=function(timeout){this.$timeout=timeout},this.setValue=function(value){this.doc.setValue(value),this.deferredUpdate.schedule(this.$timeout)},this.getValue=function(callbackId){this.sender.callback(this.doc.getValue(),callbackId)},this.onUpdate=function(){},this.isPending=function(){return this.deferredUpdate.isPending()}}).call(Mirror.prototype)}),ace.define("ace/mode/json/json_parse",["require","exports","module"],function(){"use strict";var at,ch,text,value,escapee={\'"\':\'"\',"\\\\":"\\\\","/":"/",b:"\\b",f:"\\f",n:"\\n",r:"\\r",t:"\t"},error=function(m){throw{name:"SyntaxError",message:m,at:at,text:text}},next=function(c){return c&&c!==ch&&error("Expected \'"+c+"\' instead of \'"+ch+"\'"),ch=text.charAt(at),at+=1,ch},number=function(){var number,string="";for("-"===ch&&(string="-",next("-"));ch>="0"&&"9">=ch;)string+=ch,next();if("."===ch)for(string+=".";next()&&ch>="0"&&"9">=ch;)string+=ch;if("e"===ch||"E"===ch)for(string+=ch,next(),("-"===ch||"+"===ch)&&(string+=ch,next());ch>="0"&&"9">=ch;)string+=ch,next();return number=+string,isNaN(number)?(error("Bad number"),void 0):number},string=function(){var hex,i,uffff,string="";if(\'"\'===ch)for(;next();){if(\'"\'===ch)return next(),string;if("\\\\"===ch)if(next(),"u"===ch){for(uffff=0,i=0;4>i&&(hex=parseInt(next(),16),isFinite(hex));i+=1)uffff=16*uffff+hex;string+=String.fromCharCode(uffff)}else{if("string"!=typeof escapee[ch])break;string+=escapee[ch]}else string+=ch}error("Bad string")},white=function(){for(;ch&&" ">=ch;)next()},word=function(){switch(ch){case"t":return next("t"),next("r"),next("u"),next("e"),!0;case"f":return next("f"),next("a"),next("l"),next("s"),next("e"),!1;case"n":return next("n"),next("u"),next("l"),next("l"),null}error("Unexpected \'"+ch+"\'")},array=function(){var array=[];if("["===ch){if(next("["),white(),"]"===ch)return next("]"),array;for(;ch;){if(array.push(value()),white(),"]"===ch)return next("]"),array;next(","),white()}}error("Bad array")},object=function(){var key,object={};if("{"===ch){if(next("{"),white(),"}"===ch)return next("}"),object;for(;ch;){if(key=string(),white(),next(":"),Object.hasOwnProperty.call(object,key)&&error(\'Duplicate key "\'+key+\'"\'),object[key]=value(),white(),"}"===ch)return next("}"),object;next(","),white()}}error("Bad object")};return value=function(){switch(white(),ch){case"{":return object();case"[":return array();case\'"\':return string();case"-":return number();default:return ch>="0"&&"9">=ch?number():word()}},function(source,reviver){var result;return text=source,at=0,ch=" ",result=value(),white(),ch&&error("Syntax error"),"function"==typeof reviver?function walk(holder,key){var k,v,value=holder[key];if(value&&"object"==typeof value)for(k in value)Object.hasOwnProperty.call(value,k)&&(v=walk(value,k),void 0!==v?value[k]=v:delete value[k]);return reviver.call(holder,key,value)}({"":result},""):result}}),ace.define("ace/mode/json_worker",["require","exports","module","ace/lib/oop","ace/worker/mirror","ace/mode/json/json_parse"],function(acequire,exports){"use strict";var oop=acequire("../lib/oop"),Mirror=acequire("../worker/mirror").Mirror,parse=acequire("./json/json_parse"),JsonWorker=exports.JsonWorker=function(sender){Mirror.call(this,sender),this.setTimeout(200)};oop.inherits(JsonWorker,Mirror),function(){this.onUpdate=function(){var value=this.doc.getValue(),errors=[];try{value&&parse(value)}catch(e){var pos=this.doc.indexToPosition(e.at-1);errors.push({row:pos.row,column:pos.column,text:e.message,type:"error"})}this.sender.emit("annotate",errors)}}.call(JsonWorker.prototype)}),ace.define("ace/lib/es5-shim",["require","exports","module"],function(){function Empty(){}function doesDefinePropertyWork(object){try{return Object.defineProperty(object,"sentinel",{}),"sentinel"in object}catch(exception){}}function toInteger(n){return n=+n,n!==n?n=0:0!==n&&n!==1/0&&n!==-(1/0)&&(n=(n>0||-1)*Math.floor(Math.abs(n))),n}Function.prototype.bind||(Function.prototype.bind=function(that){var target=this;if("function"!=typeof target)throw new TypeError("Function.prototype.bind called on incompatible "+target);var args=slice.call(arguments,1),bound=function(){if(this instanceof bound){var result=target.apply(this,args.concat(slice.call(arguments)));return Object(result)===result?result:this}return target.apply(that,args.concat(slice.call(arguments)))};return target.prototype&&(Empty.prototype=target.prototype,bound.prototype=new Empty,Empty.prototype=null),bound});var defineGetter,defineSetter,lookupGetter,lookupSetter,supportsAccessors,call=Function.prototype.call,prototypeOfArray=Array.prototype,prototypeOfObject=Object.prototype,slice=prototypeOfArray.slice,_toString=call.bind(prototypeOfObject.toString),owns=call.bind(prototypeOfObject.hasOwnProperty);if((supportsAccessors=owns(prototypeOfObject,"__defineGetter__"))&&(defineGetter=call.bind(prototypeOfObject.__defineGetter__),defineSetter=call.bind(prototypeOfObject.__defineSetter__),lookupGetter=call.bind(prototypeOfObject.__lookupGetter__),lookupSetter=call.bind(prototypeOfObject.__lookupSetter__)),2!=[1,2].splice(0).length)if(function(){function makeArray(l){var a=Array(l+2);return a[0]=a[1]=0,a}var lengthBefore,array=[];return array.splice.apply(array,makeArray(20)),array.splice.apply(array,makeArray(26)),lengthBefore=array.length,array.splice(5,0,"XXX"),lengthBefore+1==array.length,lengthBefore+1==array.length?!0:void 0\n}()){var array_splice=Array.prototype.splice;Array.prototype.splice=function(start,deleteCount){return arguments.length?array_splice.apply(this,[void 0===start?0:start,void 0===deleteCount?this.length-start:deleteCount].concat(slice.call(arguments,2))):[]}}else Array.prototype.splice=function(pos,removeCount){var length=this.length;pos>0?pos>length&&(pos=length):void 0==pos?pos=0:0>pos&&(pos=Math.max(length+pos,0)),length>pos+removeCount||(removeCount=length-pos);var removed=this.slice(pos,pos+removeCount),insert=slice.call(arguments,2),add=insert.length;if(pos===length)add&&this.push.apply(this,insert);else{var remove=Math.min(removeCount,length-pos),tailOldPos=pos+remove,tailNewPos=tailOldPos+add-remove,tailCount=length-tailOldPos,lengthAfterRemove=length-remove;if(tailOldPos>tailNewPos)for(var i=0;tailCount>i;++i)this[tailNewPos+i]=this[tailOldPos+i];else if(tailNewPos>tailOldPos)for(i=tailCount;i--;)this[tailNewPos+i]=this[tailOldPos+i];if(add&&pos===lengthAfterRemove)this.length=lengthAfterRemove,this.push.apply(this,insert);else for(this.length=lengthAfterRemove+add,i=0;add>i;++i)this[pos+i]=insert[i]}return removed};Array.isArray||(Array.isArray=function(obj){return"[object Array]"==_toString(obj)});var boxedString=Object("a"),splitString="a"!=boxedString[0]||!(0 in boxedString);if(Array.prototype.forEach||(Array.prototype.forEach=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,thisp=arguments[1],i=-1,length=self.length>>>0;if("[object Function]"!=_toString(fun))throw new TypeError;for(;length>++i;)i in self&&fun.call(thisp,self[i],i,object)}),Array.prototype.map||(Array.prototype.map=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0,result=Array(length),thisp=arguments[1];if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");for(var i=0;length>i;i++)i in self&&(result[i]=fun.call(thisp,self[i],i,object));return result}),Array.prototype.filter||(Array.prototype.filter=function(fun){var value,object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0,result=[],thisp=arguments[1];if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");for(var i=0;length>i;i++)i in self&&(value=self[i],fun.call(thisp,value,i,object)&&result.push(value));return result}),Array.prototype.every||(Array.prototype.every=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0,thisp=arguments[1];if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");for(var i=0;length>i;i++)if(i in self&&!fun.call(thisp,self[i],i,object))return!1;return!0}),Array.prototype.some||(Array.prototype.some=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0,thisp=arguments[1];if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");for(var i=0;length>i;i++)if(i in self&&fun.call(thisp,self[i],i,object))return!0;return!1}),Array.prototype.reduce||(Array.prototype.reduce=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0;if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");if(!length&&1==arguments.length)throw new TypeError("reduce of empty array with no initial value");var result,i=0;if(arguments.length>=2)result=arguments[1];else for(;;){if(i in self){result=self[i++];break}if(++i>=length)throw new TypeError("reduce of empty array with no initial value")}for(;length>i;i++)i in self&&(result=fun.call(void 0,result,self[i],i,object));return result}),Array.prototype.reduceRight||(Array.prototype.reduceRight=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0;if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");if(!length&&1==arguments.length)throw new TypeError("reduceRight of empty array with no initial value");var result,i=length-1;if(arguments.length>=2)result=arguments[1];else for(;;){if(i in self){result=self[i--];break}if(0>--i)throw new TypeError("reduceRight of empty array with no initial value")}do i in this&&(result=fun.call(void 0,result,self[i],i,object));while(i--);return result}),Array.prototype.indexOf&&-1==[0,1].indexOf(1,2)||(Array.prototype.indexOf=function(sought){var self=splitString&&"[object String]"==_toString(this)?this.split(""):toObject(this),length=self.length>>>0;if(!length)return-1;var i=0;for(arguments.length>1&&(i=toInteger(arguments[1])),i=i>=0?i:Math.max(0,length+i);length>i;i++)if(i in self&&self[i]===sought)return i;return-1}),Array.prototype.lastIndexOf&&-1==[0,1].lastIndexOf(0,-3)||(Array.prototype.lastIndexOf=function(sought){var self=splitString&&"[object String]"==_toString(this)?this.split(""):toObject(this),length=self.length>>>0;if(!length)return-1;var i=length-1;for(arguments.length>1&&(i=Math.min(i,toInteger(arguments[1]))),i=i>=0?i:length-Math.abs(i);i>=0;i--)if(i in self&&sought===self[i])return i;return-1}),Object.getPrototypeOf||(Object.getPrototypeOf=function(object){return object.__proto__||(object.constructor?object.constructor.prototype:prototypeOfObject)}),!Object.getOwnPropertyDescriptor){var ERR_NON_OBJECT="Object.getOwnPropertyDescriptor called on a non-object: ";Object.getOwnPropertyDescriptor=function(object,property){if("object"!=typeof object&&"function"!=typeof object||null===object)throw new TypeError(ERR_NON_OBJECT+object);if(owns(object,property)){var descriptor,getter,setter;if(descriptor={enumerable:!0,configurable:!0},supportsAccessors){var prototype=object.__proto__;object.__proto__=prototypeOfObject;var getter=lookupGetter(object,property),setter=lookupSetter(object,property);if(object.__proto__=prototype,getter||setter)return getter&&(descriptor.get=getter),setter&&(descriptor.set=setter),descriptor}return descriptor.value=object[property],descriptor}}}if(Object.getOwnPropertyNames||(Object.getOwnPropertyNames=function(object){return Object.keys(object)}),!Object.create){var createEmpty;createEmpty=null===Object.prototype.__proto__?function(){return{__proto__:null}}:function(){var empty={};for(var i in empty)empty[i]=null;return empty.constructor=empty.hasOwnProperty=empty.propertyIsEnumerable=empty.isPrototypeOf=empty.toLocaleString=empty.toString=empty.valueOf=empty.__proto__=null,empty},Object.create=function(prototype,properties){var object;if(null===prototype)object=createEmpty();else{if("object"!=typeof prototype)throw new TypeError("typeof prototype["+typeof prototype+"] != \'object\'");var Type=function(){};Type.prototype=prototype,object=new Type,object.__proto__=prototype}return void 0!==properties&&Object.defineProperties(object,properties),object}}if(Object.defineProperty){var definePropertyWorksOnObject=doesDefinePropertyWork({}),definePropertyWorksOnDom="undefined"==typeof document||doesDefinePropertyWork(document.createElement("div"));if(!definePropertyWorksOnObject||!definePropertyWorksOnDom)var definePropertyFallback=Object.defineProperty}if(!Object.defineProperty||definePropertyFallback){var ERR_NON_OBJECT_DESCRIPTOR="Property description must be an object: ",ERR_NON_OBJECT_TARGET="Object.defineProperty called on non-object: ",ERR_ACCESSORS_NOT_SUPPORTED="getters & setters can not be defined on this javascript engine";Object.defineProperty=function(object,property,descriptor){if("object"!=typeof object&&"function"!=typeof object||null===object)throw new TypeError(ERR_NON_OBJECT_TARGET+object);if("object"!=typeof descriptor&&"function"!=typeof descriptor||null===descriptor)throw new TypeError(ERR_NON_OBJECT_DESCRIPTOR+descriptor);if(definePropertyFallback)try{return definePropertyFallback.call(Object,object,property,descriptor)}catch(exception){}if(owns(descriptor,"value"))if(supportsAccessors&&(lookupGetter(object,property)||lookupSetter(object,property))){var prototype=object.__proto__;object.__proto__=prototypeOfObject,delete object[property],object[property]=descriptor.value,object.__proto__=prototype}else object[property]=descriptor.value;else{if(!supportsAccessors)throw new TypeError(ERR_ACCESSORS_NOT_SUPPORTED);owns(descriptor,"get")&&defineGetter(object,property,descriptor.get),owns(descriptor,"set")&&defineSetter(object,property,descriptor.set)}return object}}Object.defineProperties||(Object.defineProperties=function(object,properties){for(var property in properties)owns(properties,property)&&Object.defineProperty(object,property,properties[property]);return object}),Object.seal||(Object.seal=function(object){return object}),Object.freeze||(Object.freeze=function(object){return object});try{Object.freeze(function(){})}catch(exception){Object.freeze=function(freezeObject){return function(object){return"function"==typeof object?object:freezeObject(object)}}(Object.freeze)}if(Object.preventExtensions||(Object.preventExtensions=function(object){return object}),Object.isSealed||(Object.isSealed=function(){return!1}),Object.isFrozen||(Object.isFrozen=function(){return!1}),Object.isExtensible||(Object.isExtensible=function(object){if(Object(object)===object)throw new TypeError;for(var name="";owns(object,name);)name+="?";object[name]=!0;var returnValue=owns(object,name);return delete object[name],returnValue}),!Object.keys){var hasDontEnumBug=!0,dontEnums=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],dontEnumsLength=dontEnums.length;for(var key in{toString:null})hasDontEnumBug=!1;Object.keys=function(object){if("object"!=typeof object&&"function"!=typeof object||null===object)throw new TypeError("Object.keys called on a non-object");var keys=[];for(var name in object)owns(object,name)&&keys.push(name);if(hasDontEnumBug)for(var i=0,ii=dontEnumsLength;ii>i;i++){var dontEnum=dontEnums[i];owns(object,dontEnum)&&keys.push(dontEnum)}return keys}}Date.now||(Date.now=function(){return(new Date).getTime()});var ws="\t\\n\v\\f\\r   ᠎             　\\u2028\\u2029\ufeff";if(!String.prototype.trim||ws.trim()){ws="["+ws+"]";var trimBeginRegexp=RegExp("^"+ws+ws+"*"),trimEndRegexp=RegExp(ws+ws+"*$");String.prototype.trim=function(){return(this+"").replace(trimBeginRegexp,"").replace(trimEndRegexp,"")}}var toObject=function(o){if(null==o)throw new TypeError("can\'t convert "+o+" to object");return Object(o)}});'},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.XJsonMode=exports.installXJsonMode=void 0;var x_json_1=__webpack_require__(468);Object.defineProperty(exports,"installXJsonMode",{enumerable:!0,get:function(){return x_json_1.installXJsonMode}}),Object.defineProperty(exports,"XJsonMode",{enumerable:!0,get:function(){return x_json_1.XJsonMode}})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.installXJsonMode=exports.XJsonMode=void 0;const brace_1=__webpack_require__(35).__importDefault(__webpack_require__(193)),index_1=__webpack_require__(314),worker_1=__webpack_require__(469),{WorkerClient:WorkerClient}=brace_1.default.acequire("ace/worker/worker_client"),oop=brace_1.default.acequire("ace/lib/oop"),{Mode:JSONMode}=brace_1.default.acequire("ace/mode/json"),{Tokenizer:AceTokenizer}=brace_1.default.acequire("ace/tokenizer"),{MatchingBraceOutdent:MatchingBraceOutdent}=brace_1.default.acequire("ace/mode/matching_brace_outdent"),{CstyleBehaviour:CstyleBehaviour}=brace_1.default.acequire("ace/mode/behaviour/cstyle"),{FoldMode:CStyleFoldMode}=brace_1.default.acequire("ace/mode/folding/cstyle"),XJsonMode=function(){const ruleset=new index_1.XJsonHighlightRules;ruleset.normalizeRules(),this.$tokenizer=new AceTokenizer(ruleset.getRules()),this.$outdent=new MatchingBraceOutdent,this.$behaviour=new CstyleBehaviour,this.foldingRules=new CStyleFoldMode};exports.XJsonMode=XJsonMode,oop.inherits(XJsonMode,JSONMode),XJsonMode.prototype.createWorker=function(session){const xJsonWorker=new WorkerClient(["ace"],worker_1.workerModule,"JsonWorker");return xJsonWorker.attachToDocument(session.getDocument()),xJsonWorker.on("annotate",(function(e){session.setAnnotations(e.data)})),xJsonWorker.on("terminate",(function(){session.clearAnnotations()})),xJsonWorker},exports.installXJsonMode=function(editor){editor.getSession().setMode(new XJsonMode)}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.workerModule=void 0;const x_json_ace_worker_js_1=__webpack_require__(35).__importDefault(__webpack_require__(470));exports.workerModule={id:"ace/mode/json_worker",src:x_json_ace_worker_js_1.default}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default='/*\n * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one\n * or more contributor license agreements. Licensed under the Elastic License\n * 2.0 and the Server Side Public License, v 1; you may not use this file except\n * in compliance with, at your election, the Elastic License 2.0 or the Server\n * Side Public License, v 1.\n */\n\n/* @notice\n *\n * This product includes code that is based on Ace editor, which was available\n * under a "BSD" license.\n *\n * Distributed under the BSD license:\n *\n * Copyright (c) 2010, Ajax.org B.V.\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *     * Redistributions of source code must retain the above copyright\n *       notice, this list of conditions and the following disclaimer.\n *     * Redistributions in binary form must reproduce the above copyright\n *       notice, this list of conditions and the following disclaimer in the\n *       documentation and/or other materials provided with the distribution.\n *     * Neither the name of Ajax.org B.V. nor the\n *       names of its contributors may be used to endorse or promote products\n *       derived from this software without specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND\n * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n * DISCLAIMED. IN NO EVENT SHALL AJAX.ORG B.V. BE LIABLE FOR ANY\n * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\n * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n/* eslint-disable */\n/*\n  This file is loaded up as a blob by Brace to hand to Ace to load as Jsonp\n  (hence the redefining of everything).  It is based on the json\n  mode from the brace distro.\n\n  It is very likely that this file will be removed in future but for now it enables\n  extended JSON parsing, like e.g. """{}""" (triple quotes)\n*/\n"no use strict";\n! function(window) {\n  function resolveModuleId(id, paths) {\n    for (var testPath = id, tail = ""; testPath;) {\n      var alias = paths[testPath];\n      if ("string" == typeof alias) return alias + tail;\n      if (alias) return alias.location.replace(/\\/*$/, "/") + (tail || alias.main || alias.name);\n      if (alias === !1) return "";\n      var i = testPath.lastIndexOf("/");\n      if (-1 === i) break;\n      tail = testPath.substr(i) + tail, testPath = testPath.slice(0, i)\n    }\n    return id\n  }\n  if (!(void 0 !== window.window && window.document || window.acequire && window.define)) {\n    window.console || (window.console = function() {\n      var msgs = Array.prototype.slice.call(arguments, 0);\n      postMessage({\n        type: "log",\n        data: msgs\n      })\n    }, window.console.error = window.console.warn = window.console.log = window.console.trace = window.console), window.window = window, window.ace = window, window.onerror = function(message, file, line, col, err) {\n      postMessage({\n        type: "error",\n        data: {\n          message: message,\n          data: err.data,\n          file: file,\n          line: line,\n          col: col,\n          stack: err.stack\n        }\n      })\n    }, window.normalizeModule = function(parentId, moduleName) {\n      if (-1 !== moduleName.indexOf("!")) {\n        var chunks = moduleName.split("!");\n        return window.normalizeModule(parentId, chunks[0]) + "!" + window.normalizeModule(parentId, chunks[1])\n      }\n      if ("." == moduleName.charAt(0)) {\n        var base = parentId.split("/").slice(0, -1).join("/");\n        for (moduleName = (base ? base + "/" : "") + moduleName; - 1 !== moduleName.indexOf(".") && previous != moduleName;) {\n          var previous = moduleName;\n          moduleName = moduleName.replace(/^\\.\\//, "").replace(/\\/\\.\\//, "/").replace(/[^\\/]+\\/\\.\\.\\//, "")\n        }\n      }\n      return moduleName\n    }, window.acequire = function acequire(parentId, id) {\n      if (id || (id = parentId, parentId = null), !id.charAt) throw Error("worker.js acequire() accepts only (parentId, id) as arguments");\n      id = window.normalizeModule(parentId, id);\n      var module = window.acequire.modules[id];\n      if (module) return module.initialized || (module.initialized = !0, module.exports = module.factory().exports), module.exports;\n      if (!window.acequire.tlns) return console.log("unable to load " + id);\n      var path = resolveModuleId(id, window.acequire.tlns);\n      return ".js" != path.slice(-3) && (path += ".js"), window.acequire.id = id, window.acequire.modules[id] = {}, importScripts(path), window.acequire(parentId, id)\n    }, window.acequire.modules = {}, window.acequire.tlns = {}, window.define = function(id, deps, factory) {\n      if (2 == arguments.length ? (factory = deps, "string" != typeof id && (deps = id, id = window.acequire.id)) : 1 == arguments.length && (factory = id, deps = [], id = window.acequire.id), "function" != typeof factory) return window.acequire.modules[id] = {\n        exports: factory,\n        initialized: !0\n      }, void 0;\n      deps.length || (deps = ["require", "exports", "module"]);\n      var req = function(childId) {\n        return window.acequire(id, childId)\n      };\n      window.acequire.modules[id] = {\n        exports: {},\n        factory: function() {\n          var module = this,\n            returnExports = factory.apply(this, deps.map(function(dep) {\n              switch (dep) {\n                case "require":\n                  return req;\n                case "exports":\n                  return module.exports;\n                case "module":\n                  return module;\n                default:\n                  return req(dep)\n              }\n            }));\n          return returnExports && (module.exports = returnExports), module\n        }\n      }\n    }, window.define.amd = {}, acequire.tlns = {}, window.initBaseUrls = function(topLevelNamespaces) {\n      for (var i in topLevelNamespaces) acequire.tlns[i] = topLevelNamespaces[i]\n    }, window.initSender = function() {\n      var EventEmitter = window.acequire("ace/lib/event_emitter").EventEmitter,\n        oop = window.acequire("ace/lib/oop"),\n        Sender = function() {};\n      return function() {\n        oop.implement(this, EventEmitter), this.callback = function(data, callbackId) {\n          postMessage({\n            type: "call",\n            id: callbackId,\n            data: data\n          })\n        }, this.emit = function(name, data) {\n          postMessage({\n            type: "event",\n            name: name,\n            data: data\n          })\n        }\n      }.call(Sender.prototype), new Sender\n    };\n    var main = window.main = null,\n      sender = window.sender = null;\n    window.onmessage = function(e) {\n      var msg = e.data;\n      if (msg.event && sender) sender._signal(msg.event, msg.data);\n      else if (msg.command)\n        if (main[msg.command]) main[msg.command].apply(main, msg.args);\n        else {\n          if (!window[msg.command]) throw Error("Unknown command:" + msg.command);\n          window[msg.command].apply(window, msg.args)\n        }\n      else if (msg.init) {\n        window.initBaseUrls(msg.tlns), acequire("ace/lib/es5-shim"), sender = window.sender = window.initSender();\n        var clazz = acequire(msg.module)[msg.classname];\n        main = window.main = new clazz(sender)\n      }\n    }\n  }\n}(this), ace.define("ace/lib/oop", ["require", "exports", "module"], function(acequire, exports) {\n  "use strict";\n  exports.inherits = function(ctor, superCtor) {\n    ctor.super_ = superCtor, ctor.prototype = Object.create(superCtor.prototype, {\n      constructor: {\n        value: ctor,\n        enumerable: !1,\n        writable: !0,\n        configurable: !0\n      }\n    })\n  }, exports.mixin = function(obj, mixin) {\n    for (var key in mixin) obj[key] = mixin[key];\n    return obj\n  }, exports.implement = function(proto, mixin) {\n    exports.mixin(proto, mixin)\n  }\n}), ace.define("ace/range", ["require", "exports", "module"], function(acequire, exports) {\n  "use strict";\n  var comparePoints = function(p1, p2) {\n      return p1.row - p2.row || p1.column - p2.column\n    },\n    Range = function(startRow, startColumn, endRow, endColumn) {\n      this.start = {\n        row: startRow,\n        column: startColumn\n      }, this.end = {\n        row: endRow,\n        column: endColumn\n      }\n    };\n  (function() {\n    this.isEqual = function(range) {\n      return this.start.row === range.start.row && this.end.row === range.end.row && this.start.column === range.start.column && this.end.column === range.end.column\n    }, this.toString = function() {\n      return "Range: [" + this.start.row + "/" + this.start.column + "] -> [" + this.end.row + "/" + this.end.column + "]"\n    }, this.contains = function(row, column) {\n      return 0 == this.compare(row, column)\n    }, this.compareRange = function(range) {\n      var cmp, end = range.end,\n        start = range.start;\n      return cmp = this.compare(end.row, end.column), 1 == cmp ? (cmp = this.compare(start.row, start.column), 1 == cmp ? 2 : 0 == cmp ? 1 : 0) : -1 == cmp ? -2 : (cmp = this.compare(start.row, start.column), -1 == cmp ? -1 : 1 == cmp ? 42 : 0)\n    }, this.comparePoint = function(p) {\n      return this.compare(p.row, p.column)\n    }, this.containsRange = function(range) {\n      return 0 == this.comparePoint(range.start) && 0 == this.comparePoint(range.end)\n    }, this.intersects = function(range) {\n      var cmp = this.compareRange(range);\n      return -1 == cmp || 0 == cmp || 1 == cmp\n    }, this.isEnd = function(row, column) {\n      return this.end.row == row && this.end.column == column\n    }, this.isStart = function(row, column) {\n      return this.start.row == row && this.start.column == column\n    }, this.setStart = function(row, column) {\n      "object" == typeof row ? (this.start.column = row.column, this.start.row = row.row) : (this.start.row = row, this.start.column = column)\n    }, this.setEnd = function(row, column) {\n      "object" == typeof row ? (this.end.column = row.column, this.end.row = row.row) : (this.end.row = row, this.end.column = column)\n    }, this.inside = function(row, column) {\n      return 0 == this.compare(row, column) ? this.isEnd(row, column) || this.isStart(row, column) ? !1 : !0 : !1\n    }, this.insideStart = function(row, column) {\n      return 0 == this.compare(row, column) ? this.isEnd(row, column) ? !1 : !0 : !1\n    }, this.insideEnd = function(row, column) {\n      return 0 == this.compare(row, column) ? this.isStart(row, column) ? !1 : !0 : !1\n    }, this.compare = function(row, column) {\n      return this.isMultiLine() || row !== this.start.row ? this.start.row > row ? -1 : row > this.end.row ? 1 : this.start.row === row ? column >= this.start.column ? 0 : -1 : this.end.row === row ? this.end.column >= column ? 0 : 1 : 0 : this.start.column > column ? -1 : column > this.end.column ? 1 : 0\n    }, this.compareStart = function(row, column) {\n      return this.start.row == row && this.start.column == column ? -1 : this.compare(row, column)\n    }, this.compareEnd = function(row, column) {\n      return this.end.row == row && this.end.column == column ? 1 : this.compare(row, column)\n    }, this.compareInside = function(row, column) {\n      return this.end.row == row && this.end.column == column ? 1 : this.start.row == row && this.start.column == column ? -1 : this.compare(row, column)\n    }, this.clipRows = function(firstRow, lastRow) {\n      if (this.end.row > lastRow) var end = {\n        row: lastRow + 1,\n        column: 0\n      };\n      else if (firstRow > this.end.row) var end = {\n        row: firstRow,\n        column: 0\n      };\n      if (this.start.row > lastRow) var start = {\n        row: lastRow + 1,\n        column: 0\n      };\n      else if (firstRow > this.start.row) var start = {\n        row: firstRow,\n        column: 0\n      };\n      return Range.fromPoints(start || this.start, end || this.end)\n    }, this.extend = function(row, column) {\n      var cmp = this.compare(row, column);\n      if (0 == cmp) return this;\n      if (-1 == cmp) var start = {\n        row: row,\n        column: column\n      };\n      else var end = {\n        row: row,\n        column: column\n      };\n      return Range.fromPoints(start || this.start, end || this.end)\n    }, this.isEmpty = function() {\n      return this.start.row === this.end.row && this.start.column === this.end.column\n    }, this.isMultiLine = function() {\n      return this.start.row !== this.end.row\n    }, this.clone = function() {\n      return Range.fromPoints(this.start, this.end)\n    }, this.collapseRows = function() {\n      return 0 == this.end.column ? new Range(this.start.row, 0, Math.max(this.start.row, this.end.row - 1), 0) : new Range(this.start.row, 0, this.end.row, 0)\n    }, this.toScreenRange = function(session) {\n      var screenPosStart = session.documentToScreenPosition(this.start),\n        screenPosEnd = session.documentToScreenPosition(this.end);\n      return new Range(screenPosStart.row, screenPosStart.column, screenPosEnd.row, screenPosEnd.column)\n    }, this.moveBy = function(row, column) {\n      this.start.row += row, this.start.column += column, this.end.row += row, this.end.column += column\n    }\n  }).call(Range.prototype), Range.fromPoints = function(start, end) {\n    return new Range(start.row, start.column, end.row, end.column)\n  }, Range.comparePoints = comparePoints, Range.comparePoints = function(p1, p2) {\n    return p1.row - p2.row || p1.column - p2.column\n  }, exports.Range = Range\n}), ace.define("ace/apply_delta", ["require", "exports", "module"], function(acequire, exports) {\n  "use strict";\n  exports.applyDelta = function(docLines, delta) {\n    var row = delta.start.row,\n      startColumn = delta.start.column,\n      line = docLines[row] || "";\n    switch (delta.action) {\n      case "insert":\n        var lines = delta.lines;\n        if (1 === lines.length) docLines[row] = line.substring(0, startColumn) + delta.lines[0] + line.substring(startColumn);\n        else {\n          var args = [row, 1].concat(delta.lines);\n          docLines.splice.apply(docLines, args), docLines[row] = line.substring(0, startColumn) + docLines[row], docLines[row + delta.lines.length - 1] += line.substring(startColumn)\n        }\n        break;\n      case "remove":\n        var endColumn = delta.end.column,\n          endRow = delta.end.row;\n        row === endRow ? docLines[row] = line.substring(0, startColumn) + line.substring(endColumn) : docLines.splice(row, endRow - row + 1, line.substring(0, startColumn) + docLines[endRow].substring(endColumn))\n    }\n  }\n}), ace.define("ace/lib/event_emitter", ["require", "exports", "module"], function(acequire, exports) {\n  "use strict";\n  var EventEmitter = {},\n    stopPropagation = function() {\n      this.propagationStopped = !0\n    },\n    preventDefault = function() {\n      this.defaultPrevented = !0\n    };\n  EventEmitter._emit = EventEmitter._dispatchEvent = function(eventName, e) {\n    this._eventRegistry || (this._eventRegistry = {}), this._defaultHandlers || (this._defaultHandlers = {});\n    var listeners = this._eventRegistry[eventName] || [],\n      defaultHandler = this._defaultHandlers[eventName];\n    if (listeners.length || defaultHandler) {\n      "object" == typeof e && e || (e = {}), e.type || (e.type = eventName), e.stopPropagation || (e.stopPropagation = stopPropagation), e.preventDefault || (e.preventDefault = preventDefault), listeners = listeners.slice();\n      for (var i = 0; listeners.length > i && (listeners[i](e, this), !e.propagationStopped); i++);\n      return defaultHandler && !e.defaultPrevented ? defaultHandler(e, this) : void 0\n    }\n  }, EventEmitter._signal = function(eventName, e) {\n    var listeners = (this._eventRegistry || {})[eventName];\n    if (listeners) {\n      listeners = listeners.slice();\n      for (var i = 0; listeners.length > i; i++) listeners[i](e, this)\n    }\n  }, EventEmitter.once = function(eventName, callback) {\n    var _self = this;\n    callback && this.addEventListener(eventName, function newCallback() {\n      _self.removeEventListener(eventName, newCallback), callback.apply(null, arguments)\n    })\n  }, EventEmitter.setDefaultHandler = function(eventName, callback) {\n    var handlers = this._defaultHandlers;\n    if (handlers || (handlers = this._defaultHandlers = {\n        _disabled_: {}\n      }), handlers[eventName]) {\n      var old = handlers[eventName],\n        disabled = handlers._disabled_[eventName];\n      disabled || (handlers._disabled_[eventName] = disabled = []), disabled.push(old);\n      var i = disabled.indexOf(callback); - 1 != i && disabled.splice(i, 1)\n    }\n    handlers[eventName] = callback\n  }, EventEmitter.removeDefaultHandler = function(eventName, callback) {\n    var handlers = this._defaultHandlers;\n    if (handlers) {\n      var disabled = handlers._disabled_[eventName];\n      if (handlers[eventName] == callback) handlers[eventName], disabled && this.setDefaultHandler(eventName, disabled.pop());\n      else if (disabled) {\n        var i = disabled.indexOf(callback); - 1 != i && disabled.splice(i, 1)\n      }\n    }\n  }, EventEmitter.on = EventEmitter.addEventListener = function(eventName, callback, capturing) {\n    this._eventRegistry = this._eventRegistry || {};\n    var listeners = this._eventRegistry[eventName];\n    return listeners || (listeners = this._eventRegistry[eventName] = []), -1 == listeners.indexOf(callback) && listeners[capturing ? "unshift" : "push"](callback), callback\n  }, EventEmitter.off = EventEmitter.removeListener = EventEmitter.removeEventListener = function(eventName, callback) {\n    this._eventRegistry = this._eventRegistry || {};\n    var listeners = this._eventRegistry[eventName];\n    if (listeners) {\n      var index = listeners.indexOf(callback); - 1 !== index && listeners.splice(index, 1)\n    }\n  }, EventEmitter.removeAllListeners = function(eventName) {\n    this._eventRegistry && (this._eventRegistry[eventName] = [])\n  }, exports.EventEmitter = EventEmitter\n}), ace.define("ace/anchor", ["require", "exports", "module", "ace/lib/oop", "ace/lib/event_emitter"], function(acequire, exports) {\n  "use strict";\n  var oop = acequire("./lib/oop"),\n    EventEmitter = acequire("./lib/event_emitter").EventEmitter,\n    Anchor = exports.Anchor = function(doc, row, column) {\n      this.$onChange = this.onChange.bind(this), this.attach(doc), column === void 0 ? this.setPosition(row.row, row.column) : this.setPosition(row, column)\n    };\n  (function() {\n    function $pointsInOrder(point1, point2, equalPointsInOrder) {\n      var bColIsAfter = equalPointsInOrder ? point1.column <= point2.column : point1.column < point2.column;\n      return point1.row < point2.row || point1.row == point2.row && bColIsAfter\n    }\n\n    function $getTransformedPoint(delta, point, moveIfEqual) {\n      var deltaIsInsert = "insert" == delta.action,\n        deltaRowShift = (deltaIsInsert ? 1 : -1) * (delta.end.row - delta.start.row),\n        deltaColShift = (deltaIsInsert ? 1 : -1) * (delta.end.column - delta.start.column),\n        deltaStart = delta.start,\n        deltaEnd = deltaIsInsert ? deltaStart : delta.end;\n      return $pointsInOrder(point, deltaStart, moveIfEqual) ? {\n        row: point.row,\n        column: point.column\n      } : $pointsInOrder(deltaEnd, point, !moveIfEqual) ? {\n        row: point.row + deltaRowShift,\n        column: point.column + (point.row == deltaEnd.row ? deltaColShift : 0)\n      } : {\n        row: deltaStart.row,\n        column: deltaStart.column\n      }\n    }\n    oop.implement(this, EventEmitter), this.getPosition = function() {\n      return this.$clipPositionToDocument(this.row, this.column)\n    }, this.getDocument = function() {\n      return this.document\n    }, this.$insertRight = !1, this.onChange = function(delta) {\n      if (!(delta.start.row == delta.end.row && delta.start.row != this.row || delta.start.row > this.row)) {\n        var point = $getTransformedPoint(delta, {\n          row: this.row,\n          column: this.column\n        }, this.$insertRight);\n        this.setPosition(point.row, point.column, !0)\n      }\n    }, this.setPosition = function(row, column, noClip) {\n      var pos;\n      if (pos = noClip ? {\n          row: row,\n          column: column\n        } : this.$clipPositionToDocument(row, column), this.row != pos.row || this.column != pos.column) {\n        var old = {\n          row: this.row,\n          column: this.column\n        };\n        this.row = pos.row, this.column = pos.column, this._signal("change", {\n          old: old,\n          value: pos\n        })\n      }\n    }, this.detach = function() {\n      this.document.removeEventListener("change", this.$onChange)\n    }, this.attach = function(doc) {\n      this.document = doc || this.document, this.document.on("change", this.$onChange)\n    }, this.$clipPositionToDocument = function(row, column) {\n      var pos = {};\n      return row >= this.document.getLength() ? (pos.row = Math.max(0, this.document.getLength() - 1), pos.column = this.document.getLine(pos.row).length) : 0 > row ? (pos.row = 0, pos.column = 0) : (pos.row = row, pos.column = Math.min(this.document.getLine(pos.row).length, Math.max(0, column))), 0 > column && (pos.column = 0), pos\n    }\n  }).call(Anchor.prototype)\n}), ace.define("ace/document", ["require", "exports", "module", "ace/lib/oop", "ace/apply_delta", "ace/lib/event_emitter", "ace/range", "ace/anchor"], function(acequire, exports) {\n  "use strict";\n  var oop = acequire("./lib/oop"),\n    applyDelta = acequire("./apply_delta").applyDelta,\n    EventEmitter = acequire("./lib/event_emitter").EventEmitter,\n    Range = acequire("./range").Range,\n    Anchor = acequire("./anchor").Anchor,\n    Document = function(textOrLines) {\n      this.$lines = [""], 0 === textOrLines.length ? this.$lines = [""] : Array.isArray(textOrLines) ? this.insertMergedLines({\n        row: 0,\n        column: 0\n      }, textOrLines) : this.insert({\n        row: 0,\n        column: 0\n      }, textOrLines)\n    };\n  (function() {\n    oop.implement(this, EventEmitter), this.setValue = function(text) {\n      var len = this.getLength() - 1;\n      this.remove(new Range(0, 0, len, this.getLine(len).length)), this.insert({\n        row: 0,\n        column: 0\n      }, text)\n    }, this.getValue = function() {\n      return this.getAllLines().join(this.getNewLineCharacter())\n    }, this.createAnchor = function(row, column) {\n      return new Anchor(this, row, column)\n    }, this.$split = 0 === "aaa".split(/a/).length ? function(text) {\n      return text.replace(/\\r\\n|\\r/g, "\\n").split("\\n")\n    } : function(text) {\n      return text.split(/\\r\\n|\\r|\\n/)\n    }, this.$detectNewLine = function(text) {\n      var match = text.match(/^.*?(\\r\\n|\\r|\\n)/m);\n      this.$autoNewLine = match ? match[1] : "\\n", this._signal("changeNewLineMode")\n    }, this.getNewLineCharacter = function() {\n      switch (this.$newLineMode) {\n        case "windows":\n          return "\\r\\n";\n        case "unix":\n          return "\\n";\n        default:\n          return this.$autoNewLine || "\\n"\n      }\n    }, this.$autoNewLine = "", this.$newLineMode = "auto", this.setNewLineMode = function(newLineMode) {\n      this.$newLineMode !== newLineMode && (this.$newLineMode = newLineMode, this._signal("changeNewLineMode"))\n    }, this.getNewLineMode = function() {\n      return this.$newLineMode\n    }, this.isNewLine = function(text) {\n      return "\\r\\n" == text || "\\r" == text || "\\n" == text\n    }, this.getLine = function(row) {\n      return this.$lines[row] || ""\n    }, this.getLines = function(firstRow, lastRow) {\n      return this.$lines.slice(firstRow, lastRow + 1)\n    }, this.getAllLines = function() {\n      return this.getLines(0, this.getLength())\n    }, this.getLength = function() {\n      return this.$lines.length\n    }, this.getTextRange = function(range) {\n      return this.getLinesForRange(range).join(this.getNewLineCharacter())\n    }, this.getLinesForRange = function(range) {\n      var lines;\n      if (range.start.row === range.end.row) lines = [this.getLine(range.start.row).substring(range.start.column, range.end.column)];\n      else {\n        lines = this.getLines(range.start.row, range.end.row), lines[0] = (lines[0] || "").substring(range.start.column);\n        var l = lines.length - 1;\n        range.end.row - range.start.row == l && (lines[l] = lines[l].substring(0, range.end.column))\n      }\n      return lines\n    }, this.insertLines = function(row, lines) {\n      return console.warn("Use of document.insertLines is deprecated. Use the insertFullLines method instead."), this.insertFullLines(row, lines)\n    }, this.removeLines = function(firstRow, lastRow) {\n      return console.warn("Use of document.removeLines is deprecated. Use the removeFullLines method instead."), this.removeFullLines(firstRow, lastRow)\n    }, this.insertNewLine = function(position) {\n      return console.warn("Use of document.insertNewLine is deprecated. Use insertMergedLines(position, [\'\', \'\']) instead."), this.insertMergedLines(position, ["", ""])\n    }, this.insert = function(position, text) {\n      return 1 >= this.getLength() && this.$detectNewLine(text), this.insertMergedLines(position, this.$split(text))\n    }, this.insertInLine = function(position, text) {\n      var start = this.clippedPos(position.row, position.column),\n        end = this.pos(position.row, position.column + text.length);\n      return this.applyDelta({\n        start: start,\n        end: end,\n        action: "insert",\n        lines: [text]\n      }, !0), this.clonePos(end)\n    }, this.clippedPos = function(row, column) {\n      var length = this.getLength();\n      void 0 === row ? row = length : 0 > row ? row = 0 : row >= length && (row = length - 1, column = void 0);\n      var line = this.getLine(row);\n      return void 0 == column && (column = line.length), column = Math.min(Math.max(column, 0), line.length), {\n        row: row,\n        column: column\n      }\n    }, this.clonePos = function(pos) {\n      return {\n        row: pos.row,\n        column: pos.column\n      }\n    }, this.pos = function(row, column) {\n      return {\n        row: row,\n        column: column\n      }\n    }, this.$clipPosition = function(position) {\n      var length = this.getLength();\n      return position.row >= length ? (position.row = Math.max(0, length - 1), position.column = this.getLine(length - 1).length) : (position.row = Math.max(0, position.row), position.column = Math.min(Math.max(position.column, 0), this.getLine(position.row).length)), position\n    }, this.insertFullLines = function(row, lines) {\n      row = Math.min(Math.max(row, 0), this.getLength());\n      var column = 0;\n      this.getLength() > row ? (lines = lines.concat([""]), column = 0) : (lines = [""].concat(lines), row--, column = this.$lines[row].length), this.insertMergedLines({\n        row: row,\n        column: column\n      }, lines)\n    }, this.insertMergedLines = function(position, lines) {\n      var start = this.clippedPos(position.row, position.column),\n        end = {\n          row: start.row + lines.length - 1,\n          column: (1 == lines.length ? start.column : 0) + lines[lines.length - 1].length\n        };\n      return this.applyDelta({\n        start: start,\n        end: end,\n        action: "insert",\n        lines: lines\n      }), this.clonePos(end)\n    }, this.remove = function(range) {\n      var start = this.clippedPos(range.start.row, range.start.column),\n        end = this.clippedPos(range.end.row, range.end.column);\n      return this.applyDelta({\n        start: start,\n        end: end,\n        action: "remove",\n        lines: this.getLinesForRange({\n          start: start,\n          end: end\n        })\n      }), this.clonePos(start)\n    }, this.removeInLine = function(row, startColumn, endColumn) {\n      var start = this.clippedPos(row, startColumn),\n        end = this.clippedPos(row, endColumn);\n      return this.applyDelta({\n        start: start,\n        end: end,\n        action: "remove",\n        lines: this.getLinesForRange({\n          start: start,\n          end: end\n        })\n      }, !0), this.clonePos(start)\n    }, this.removeFullLines = function(firstRow, lastRow) {\n      firstRow = Math.min(Math.max(0, firstRow), this.getLength() - 1), lastRow = Math.min(Math.max(0, lastRow), this.getLength() - 1);\n      var deleteFirstNewLine = lastRow == this.getLength() - 1 && firstRow > 0,\n        deleteLastNewLine = this.getLength() - 1 > lastRow,\n        startRow = deleteFirstNewLine ? firstRow - 1 : firstRow,\n        startCol = deleteFirstNewLine ? this.getLine(startRow).length : 0,\n        endRow = deleteLastNewLine ? lastRow + 1 : lastRow,\n        endCol = deleteLastNewLine ? 0 : this.getLine(endRow).length,\n        range = new Range(startRow, startCol, endRow, endCol),\n        deletedLines = this.$lines.slice(firstRow, lastRow + 1);\n      return this.applyDelta({\n        start: range.start,\n        end: range.end,\n        action: "remove",\n        lines: this.getLinesForRange(range)\n      }), deletedLines\n    }, this.removeNewLine = function(row) {\n      this.getLength() - 1 > row && row >= 0 && this.applyDelta({\n        start: this.pos(row, this.getLine(row).length),\n        end: this.pos(row + 1, 0),\n        action: "remove",\n        lines: ["", ""]\n      })\n    }, this.replace = function(range, text) {\n      if (range instanceof Range || (range = Range.fromPoints(range.start, range.end)), 0 === text.length && range.isEmpty()) return range.start;\n      if (text == this.getTextRange(range)) return range.end;\n      this.remove(range);\n      var end;\n      return end = text ? this.insert(range.start, text) : range.start\n    }, this.applyDeltas = function(deltas) {\n      for (var i = 0; deltas.length > i; i++) this.applyDelta(deltas[i])\n    }, this.revertDeltas = function(deltas) {\n      for (var i = deltas.length - 1; i >= 0; i--) this.revertDelta(deltas[i])\n    }, this.applyDelta = function(delta, doNotValidate) {\n      var isInsert = "insert" == delta.action;\n      (isInsert ? 1 >= delta.lines.length && !delta.lines[0] : !Range.comparePoints(delta.start, delta.end)) || (isInsert && delta.lines.length > 2e4 && this.$splitAndapplyLargeDelta(delta, 2e4), applyDelta(this.$lines, delta, doNotValidate), this._signal("change", delta))\n    }, this.$splitAndapplyLargeDelta = function(delta, MAX) {\n      for (var lines = delta.lines, l = lines.length, row = delta.start.row, column = delta.start.column, from = 0, to = 0;;) {\n        from = to, to += MAX - 1;\n        var chunk = lines.slice(from, to);\n        if (to > l) {\n          delta.lines = chunk, delta.start.row = row + from, delta.start.column = column;\n          break\n        }\n        chunk.push(""), this.applyDelta({\n          start: this.pos(row + from, column),\n          end: this.pos(row + to, column = 0),\n          action: delta.action,\n          lines: chunk\n        }, !0)\n      }\n    }, this.revertDelta = function(delta) {\n      this.applyDelta({\n        start: this.clonePos(delta.start),\n        end: this.clonePos(delta.end),\n        action: "insert" == delta.action ? "remove" : "insert",\n        lines: delta.lines.slice()\n      })\n    }, this.indexToPosition = function(index, startRow) {\n      for (var lines = this.$lines || this.getAllLines(), newlineLength = this.getNewLineCharacter().length, i = startRow || 0, l = lines.length; l > i; i++)\n        if (index -= lines[i].length + newlineLength, 0 > index) return {\n          row: i,\n          column: index + lines[i].length + newlineLength\n        };\n      return {\n        row: l - 1,\n        column: lines[l - 1].length\n      }\n    }, this.positionToIndex = function(pos, startRow) {\n      for (var lines = this.$lines || this.getAllLines(), newlineLength = this.getNewLineCharacter().length, index = 0, row = Math.min(pos.row, lines.length), i = startRow || 0; row > i; ++i) index += lines[i].length + newlineLength;\n      return index + pos.column\n    }\n  }).call(Document.prototype), exports.Document = Document\n}), ace.define("ace/lib/lang", ["require", "exports", "module"], function(acequire, exports) {\n  "use strict";\n  exports.last = function(a) {\n    return a[a.length - 1]\n  }, exports.stringReverse = function(string) {\n    return string.split("").reverse().join("")\n  }, exports.stringRepeat = function(string, count) {\n    for (var result = ""; count > 0;) 1 & count && (result += string), (count >>= 1) && (string += string);\n    return result\n  };\n  var trimBeginRegexp = /^\\s\\s*/,\n    trimEndRegexp = /\\s\\s*$/;\n  exports.stringTrimLeft = function(string) {\n    return string.replace(trimBeginRegexp, "")\n  }, exports.stringTrimRight = function(string) {\n    return string.replace(trimEndRegexp, "")\n  }, exports.copyObject = function(obj) {\n    var copy = {};\n    for (var key in obj) copy[key] = obj[key];\n    return copy\n  }, exports.copyArray = function(array) {\n    for (var copy = [], i = 0, l = array.length; l > i; i++) copy[i] = array[i] && "object" == typeof array[i] ? this.copyObject(array[i]) : array[i];\n    return copy\n  }, exports.deepCopy = function deepCopy(obj) {\n    if ("object" != typeof obj || !obj) return obj;\n    var copy;\n    if (Array.isArray(obj)) {\n      copy = [];\n      for (var key = 0; obj.length > key; key++) copy[key] = deepCopy(obj[key]);\n      return copy\n    }\n    if ("[object Object]" !== Object.prototype.toString.call(obj)) return obj;\n    copy = {};\n    for (var key in obj) copy[key] = deepCopy(obj[key]);\n    return copy\n  }, exports.arrayToMap = function(arr) {\n    for (var map = {}, i = 0; arr.length > i; i++) map[arr[i]] = 1;\n    return map\n  }, exports.createMap = function(props) {\n    var map = Object.create(null);\n    for (var i in props) map[i] = props[i];\n    return map\n  }, exports.arrayRemove = function(array, value) {\n    for (var i = 0; array.length >= i; i++) value === array[i] && array.splice(i, 1)\n  }, exports.escapeRegExp = function(str) {\n    return str.replace(/([.*+?^${}()|[\\]\\/\\\\])/g, "\\\\$1")\n  }, exports.escapeHTML = function(str) {\n    return str.replace(/&/g, "&#38;").replace(/"/g, "&#34;").replace(/\'/g, "&#39;").replace(/</g, "&#60;")\n  }, exports.getMatchOffsets = function(string, regExp) {\n    var matches = [];\n    return string.replace(regExp, function(str) {\n      matches.push({\n        offset: arguments[arguments.length - 2],\n        length: str.length\n      })\n    }), matches\n  }, exports.deferredCall = function(fcn) {\n    var timer = null,\n      callback = function() {\n        timer = null, fcn()\n      },\n      deferred = function(timeout) {\n        return deferred.cancel(), timer = setTimeout(callback, timeout || 0), deferred\n      };\n    return deferred.schedule = deferred, deferred.call = function() {\n      return this.cancel(), fcn(), deferred\n    }, deferred.cancel = function() {\n      return clearTimeout(timer), timer = null, deferred\n    }, deferred.isPending = function() {\n      return timer\n    }, deferred\n  }, exports.delayedCall = function(fcn, defaultTimeout) {\n    var timer = null,\n      callback = function() {\n        timer = null, fcn()\n      },\n      _self = function(timeout) {\n        null == timer && (timer = setTimeout(callback, timeout || defaultTimeout))\n      };\n    return _self.delay = function(timeout) {\n      timer && clearTimeout(timer), timer = setTimeout(callback, timeout || defaultTimeout)\n    }, _self.schedule = _self, _self.call = function() {\n      this.cancel(), fcn()\n    }, _self.cancel = function() {\n      timer && clearTimeout(timer), timer = null\n    }, _self.isPending = function() {\n      return timer\n    }, _self\n  }\n}), ace.define("ace/worker/mirror", ["require", "exports", "module", "ace/range", "ace/document", "ace/lib/lang"], function(acequire, exports) {\n  "use strict";\n  acequire("../range").Range;\n  var Document = acequire("../document").Document,\n    lang = acequire("../lib/lang"),\n    Mirror = exports.Mirror = function(sender) {\n      this.sender = sender;\n      var doc = this.doc = new Document(""),\n        deferredUpdate = this.deferredUpdate = lang.delayedCall(this.onUpdate.bind(this)),\n        _self = this;\n      sender.on("change", function(e) {\n        var data = e.data;\n        if (data[0].start) doc.applyDeltas(data);\n        else\n          for (var i = 0; data.length > i; i += 2) {\n            if (Array.isArray(data[i + 1])) var d = {\n              action: "insert",\n              start: data[i],\n              lines: data[i + 1]\n            };\n            else var d = {\n              action: "remove",\n              start: data[i],\n              end: data[i + 1]\n            };\n            doc.applyDelta(d, !0)\n          }\n        return _self.$timeout ? deferredUpdate.schedule(_self.$timeout) : (_self.onUpdate(), void 0)\n      })\n    };\n  (function() {\n    this.$timeout = 500, this.setTimeout = function(timeout) {\n      this.$timeout = timeout\n    }, this.setValue = function(value) {\n      this.doc.setValue(value), this.deferredUpdate.schedule(this.$timeout)\n    }, this.getValue = function(callbackId) {\n      this.sender.callback(this.doc.getValue(), callbackId)\n    }, this.onUpdate = function() {}, this.isPending = function() {\n      return this.deferredUpdate.isPending()\n    }\n  }).call(Mirror.prototype)\n}), ace.define("ace/mode/json/json_parse", ["require", "exports", "module"], function() {\n  "use strict";\n  var at, ch, text, value, escapee = {\n      \'"\': \'"\',\n      "\\\\": "\\\\",\n      "/": "/",\n      b: "\\b",\n      f: "\\f",\n      n: "\\n",\n      r: "\\r",\n      t: "\t"\n    },\n    error = function(m) {\n      throw {\n        name: "SyntaxError",\n        message: m,\n        at: at,\n        text: text\n      }\n    },\n    reset = function (newAt) {\n      ch = text.charAt(newAt);\n      at = newAt + 1;\n    },\n    next = function(c) {\n      return c && c !== ch && error("Expected \'" + c + "\' instead of \'" + ch + "\'"), ch = text.charAt(at), at += 1, ch\n    },\n    nextUpTo = function (upTo, errorMessage) {\n      let currentAt = at,\n        i = text.indexOf(upTo, currentAt);\n      if (i < 0) {\n        error(errorMessage || \'Expected \\\'\' + upTo + \'\\\'\');\n      }\n      reset(i + upTo.length);\n      return text.substring(currentAt, i);\n    },\n    peek = function (c) {\n      return text.substr(at, c.length) === c; // nocommit - double check\n    },\n    number = function() {\n      var number, string = "";\n      for ("-" === ch && (string = "-", next("-")); ch >= "0" && "9" >= ch;) string += ch, next();\n      if ("." === ch)\n        for (string += "."; next() && ch >= "0" && "9" >= ch;) string += ch;\n      if ("e" === ch || "E" === ch)\n        for (string += ch, next(), ("-" === ch || "+" === ch) && (string += ch, next()); ch >= "0" && "9" >= ch;) string += ch, next();\n      return number = +string, isNaN(number) ? (error("Bad number"), void 0) : number\n    },\n    string = function() {\n      var hex, i, uffff, string = "";\n      if (\'"\' === ch) {\n        if (peek(\'""\')) {\n          // literal\n          next(\'"\');\n          next(\'"\');\n          return nextUpTo(\'"""\', \'failed to find closing \\\'"""\\\'\');\n        } else {\n          for (; next();) {\n            if (\'"\' === ch) return next(), string;\n            if ("\\\\" === ch)\n              if (next(), "u" === ch) {\n                for (uffff = 0, i = 0; 4 > i && (hex = parseInt(next(), 16), isFinite(hex)); i += 1) uffff = 16 * uffff + hex;\n                string += String.fromCharCode(uffff)\n              } else {\n                if ("string" != typeof escapee[ch]) break;\n                string += escapee[ch]\n              }\n            else string += ch\n          }\n        }\n      }\n      error("Bad string")\n    },\n    white = function() {\n      for (; ch && " " >= ch;) next()\n    },\n    word = function() {\n      switch (ch) {\n        case "t":\n          return next("t"), next("r"), next("u"), next("e"), !0;\n        case "f":\n          return next("f"), next("a"), next("l"), next("s"), next("e"), !1;\n        case "n":\n          return next("n"), next("u"), next("l"), next("l"), null\n      }\n      error("Unexpected \'" + ch + "\'")\n    },\n    array = function() {\n      var array = [];\n      if ("[" === ch) {\n        if (next("["), white(), "]" === ch) return next("]"), array;\n        for (; ch;) {\n          if (array.push(value()), white(), "]" === ch) return next("]"), array;\n          next(","), white()\n        }\n      }\n      error("Bad array")\n    },\n    object = function() {\n      var key, object = {};\n      if ("{" === ch) {\n        if (next("{"), white(), "}" === ch) return next("}"), object;\n        for (; ch;) {\n          if (key = string(), white(), next(":"), Object.hasOwnProperty.call(object, key) && error(\'Duplicate key "\' + key + \'"\'), object[key] = value(), white(), "}" === ch) return next("}"), object;\n          next(","), white()\n        }\n      }\n      error("Bad object")\n    };\n  return value = function() {\n      switch (white(), ch) {\n        case "{":\n          return object();\n        case "[":\n          return array();\n        case \'"\':\n          return string();\n        case "-":\n          return number();\n        default:\n          return ch >= "0" && "9" >= ch ? number() : word()\n      }\n    },\n    function(source, reviver) {\n      var result;\n      return text = source, at = 0, ch = " ", result = value(), white(), ch && error("Syntax error"), "function" == typeof reviver ? function walk(holder, key) {\n        var k, v, value = holder[key];\n        if (value && "object" == typeof value)\n          for (k in value) Object.hasOwnProperty.call(value, k) && (v = walk(value, k), void 0 !== v ? value[k] = v : delete value[k]);\n        return reviver.call(holder, key, value)\n      }({\n        "": result\n      }, "") : result\n    }\n}), ace.define("ace/mode/json_worker", ["require", "exports", "module", "ace/lib/oop", "ace/worker/mirror", "ace/mode/json/json_parse"], function(acequire, exports) {\n  "use strict";\n  var oop = acequire("../lib/oop"),\n    Mirror = acequire("../worker/mirror").Mirror,\n    parse = acequire("./json/json_parse"),\n    JsonWorker = exports.JsonWorker = function(sender) {\n      Mirror.call(this, sender), this.setTimeout(200)\n    };\n  oop.inherits(JsonWorker, Mirror),\n    function() {\n      this.onUpdate = function() {\n        var value = this.doc.getValue(),\n          errors = [];\n        try {\n          value && parse(value)\n        } catch (e) {\n          var pos = this.doc.indexToPosition(e.at - 1);\n          errors.push({\n            row: pos.row,\n            column: pos.column,\n            text: e.message,\n            type: "error"\n          })\n        }\n        this.sender.emit("annotate", errors)\n      }\n    }.call(JsonWorker.prototype)\n}), ace.define("ace/lib/es5-shim", ["require", "exports", "module"], function() {\n  function Empty() {}\n\n  function doesDefinePropertyWork(object) {\n    try {\n      return Object.defineProperty(object, "sentinel", {}), "sentinel" in object\n    } catch (exception) {}\n  }\n\n  function toInteger(n) {\n    return n = +n, n !== n ? n = 0 : 0 !== n && n !== 1 / 0 && n !== -(1 / 0) && (n = (n > 0 || -1) * Math.floor(Math.abs(n))), n\n  }\n  Function.prototype.bind || (Function.prototype.bind = function(that) {\n    var target = this;\n    if ("function" != typeof target) throw new TypeError("Function.prototype.bind called on incompatible " + target);\n    var args = slice.call(arguments, 1),\n      bound = function() {\n        if (this instanceof bound) {\n          var result = target.apply(this, args.concat(slice.call(arguments)));\n          return Object(result) === result ? result : this\n        }\n        return target.apply(that, args.concat(slice.call(arguments)))\n      };\n    return target.prototype && (Empty.prototype = target.prototype, bound.prototype = new Empty, Empty.prototype = null), bound\n  });\n  var defineGetter, defineSetter, lookupGetter, lookupSetter, supportsAccessors, call = Function.prototype.call,\n    prototypeOfArray = Array.prototype,\n    prototypeOfObject = Object.prototype,\n    slice = prototypeOfArray.slice,\n    _toString = call.bind(prototypeOfObject.toString),\n    owns = call.bind(prototypeOfObject.hasOwnProperty);\n  if ((supportsAccessors = owns(prototypeOfObject, "__defineGetter__")) && (defineGetter = call.bind(prototypeOfObject.__defineGetter__), defineSetter = call.bind(prototypeOfObject.__defineSetter__), lookupGetter = call.bind(prototypeOfObject.__lookupGetter__), lookupSetter = call.bind(prototypeOfObject.__lookupSetter__)), 2 != [1, 2].splice(0).length)\n    if (function() {\n        function makeArray(l) {\n          var a = Array(l + 2);\n          return a[0] = a[1] = 0, a\n        }\n        var lengthBefore, array = [];\n        return array.splice.apply(array, makeArray(20)), array.splice.apply(array, makeArray(26)), lengthBefore = array.length, array.splice(5, 0, "XXX"), lengthBefore + 1 == array.length, lengthBefore + 1 == array.length ? !0 : void 0\n      }()) {\n      var array_splice = Array.prototype.splice;\n      Array.prototype.splice = function(start, deleteCount) {\n        return arguments.length ? array_splice.apply(this, [void 0 === start ? 0 : start, void 0 === deleteCount ? this.length - start : deleteCount].concat(slice.call(arguments, 2))) : []\n      }\n    } else Array.prototype.splice = function(pos, removeCount) {\n      var length = this.length;\n      pos > 0 ? pos > length && (pos = length) : void 0 == pos ? pos = 0 : 0 > pos && (pos = Math.max(length + pos, 0)), length > pos + removeCount || (removeCount = length - pos);\n      var removed = this.slice(pos, pos + removeCount),\n        insert = slice.call(arguments, 2),\n        add = insert.length;\n      if (pos === length) add && this.push.apply(this, insert);\n      else {\n        var remove = Math.min(removeCount, length - pos),\n          tailOldPos = pos + remove,\n          tailNewPos = tailOldPos + add - remove,\n          tailCount = length - tailOldPos,\n          lengthAfterRemove = length - remove;\n        if (tailOldPos > tailNewPos)\n          for (var i = 0; tailCount > i; ++i) this[tailNewPos + i] = this[tailOldPos + i];\n        else if (tailNewPos > tailOldPos)\n          for (i = tailCount; i--;) this[tailNewPos + i] = this[tailOldPos + i];\n        if (add && pos === lengthAfterRemove) this.length = lengthAfterRemove, this.push.apply(this, insert);\n        else\n          for (this.length = lengthAfterRemove + add, i = 0; add > i; ++i) this[pos + i] = insert[i]\n      }\n      return removed\n    };\n  Array.isArray || (Array.isArray = function(obj) {\n    return "[object Array]" == _toString(obj)\n  });\n  var boxedString = Object("a"),\n    splitString = "a" != boxedString[0] || !(0 in boxedString);\n  if (Array.prototype.forEach || (Array.prototype.forEach = function(fun) {\n      var object = toObject(this),\n        self = splitString && "[object String]" == _toString(this) ? this.split("") : object,\n        thisp = arguments[1],\n        i = -1,\n        length = self.length >>> 0;\n      if ("[object Function]" != _toString(fun)) throw new TypeError;\n      for (; length > ++i;) i in self && fun.call(thisp, self[i], i, object)\n    }), Array.prototype.map || (Array.prototype.map = function(fun) {\n      var object = toObject(this),\n        self = splitString && "[object String]" == _toString(this) ? this.split("") : object,\n        length = self.length >>> 0,\n        result = Array(length),\n        thisp = arguments[1];\n      if ("[object Function]" != _toString(fun)) throw new TypeError(fun + " is not a function");\n      for (var i = 0; length > i; i++) i in self && (result[i] = fun.call(thisp, self[i], i, object));\n      return result\n    }), Array.prototype.filter || (Array.prototype.filter = function(fun) {\n      var value, object = toObject(this),\n        self = splitString && "[object String]" == _toString(this) ? this.split("") : object,\n        length = self.length >>> 0,\n        result = [],\n        thisp = arguments[1];\n      if ("[object Function]" != _toString(fun)) throw new TypeError(fun + " is not a function");\n      for (var i = 0; length > i; i++) i in self && (value = self[i], fun.call(thisp, value, i, object) && result.push(value));\n      return result\n    }), Array.prototype.every || (Array.prototype.every = function(fun) {\n      var object = toObject(this),\n        self = splitString && "[object String]" == _toString(this) ? this.split("") : object,\n        length = self.length >>> 0,\n        thisp = arguments[1];\n      if ("[object Function]" != _toString(fun)) throw new TypeError(fun + " is not a function");\n      for (var i = 0; length > i; i++)\n        if (i in self && !fun.call(thisp, self[i], i, object)) return !1;\n      return !0\n    }), Array.prototype.some || (Array.prototype.some = function(fun) {\n      var object = toObject(this),\n        self = splitString && "[object String]" == _toString(this) ? this.split("") : object,\n        length = self.length >>> 0,\n        thisp = arguments[1];\n      if ("[object Function]" != _toString(fun)) throw new TypeError(fun + " is not a function");\n      for (var i = 0; length > i; i++)\n        if (i in self && fun.call(thisp, self[i], i, object)) return !0;\n      return !1\n    }), Array.prototype.reduce || (Array.prototype.reduce = function(fun) {\n      var object = toObject(this),\n        self = splitString && "[object String]" == _toString(this) ? this.split("") : object,\n        length = self.length >>> 0;\n      if ("[object Function]" != _toString(fun)) throw new TypeError(fun + " is not a function");\n      if (!length && 1 == arguments.length) throw new TypeError("reduce of empty array with no initial value");\n      var result, i = 0;\n      if (arguments.length >= 2) result = arguments[1];\n      else\n        for (;;) {\n          if (i in self) {\n            result = self[i++];\n            break\n          }\n          if (++i >= length) throw new TypeError("reduce of empty array with no initial value")\n        }\n      for (; length > i; i++) i in self && (result = fun.call(void 0, result, self[i], i, object));\n      return result\n    }), Array.prototype.reduceRight || (Array.prototype.reduceRight = function(fun) {\n      var object = toObject(this),\n        self = splitString && "[object String]" == _toString(this) ? this.split("") : object,\n        length = self.length >>> 0;\n      if ("[object Function]" != _toString(fun)) throw new TypeError(fun + " is not a function");\n      if (!length && 1 == arguments.length) throw new TypeError("reduceRight of empty array with no initial value");\n      var result, i = length - 1;\n      if (arguments.length >= 2) result = arguments[1];\n      else\n        for (;;) {\n          if (i in self) {\n            result = self[i--];\n            break\n          }\n          if (0 > --i) throw new TypeError("reduceRight of empty array with no initial value")\n        }\n      do i in this && (result = fun.call(void 0, result, self[i], i, object)); while (i--);\n      return result\n    }), Array.prototype.indexOf && -1 == [0, 1].indexOf(1, 2) || (Array.prototype.indexOf = function(sought) {\n      var self = splitString && "[object String]" == _toString(this) ? this.split("") : toObject(this),\n        length = self.length >>> 0;\n      if (!length) return -1;\n      var i = 0;\n      for (arguments.length > 1 && (i = toInteger(arguments[1])), i = i >= 0 ? i : Math.max(0, length + i); length > i; i++)\n        if (i in self && self[i] === sought) return i;\n      return -1\n    }), Array.prototype.lastIndexOf && -1 == [0, 1].lastIndexOf(0, -3) || (Array.prototype.lastIndexOf = function(sought) {\n      var self = splitString && "[object String]" == _toString(this) ? this.split("") : toObject(this),\n        length = self.length >>> 0;\n      if (!length) return -1;\n      var i = length - 1;\n      for (arguments.length > 1 && (i = Math.min(i, toInteger(arguments[1]))), i = i >= 0 ? i : length - Math.abs(i); i >= 0; i--)\n        if (i in self && sought === self[i]) return i;\n      return -1\n    }), Object.getPrototypeOf || (Object.getPrototypeOf = function(object) {\n      return object.__proto__ || (object.constructor ? object.constructor.prototype : prototypeOfObject)\n    }), !Object.getOwnPropertyDescriptor) {\n    var ERR_NON_OBJECT = "Object.getOwnPropertyDescriptor called on a non-object: ";\n    Object.getOwnPropertyDescriptor = function(object, property) {\n      if ("object" != typeof object && "function" != typeof object || null === object) throw new TypeError(ERR_NON_OBJECT + object);\n      if (owns(object, property)) {\n        var descriptor, getter, setter;\n        if (descriptor = {\n            enumerable: !0,\n            configurable: !0\n          }, supportsAccessors) {\n          var prototype = object.__proto__;\n          object.__proto__ = prototypeOfObject;\n          var getter = lookupGetter(object, property),\n            setter = lookupSetter(object, property);\n          if (object.__proto__ = prototype, getter || setter) return getter && (descriptor.get = getter), setter && (descriptor.set = setter), descriptor\n        }\n        return descriptor.value = object[property], descriptor\n      }\n    }\n  }\n  if (Object.getOwnPropertyNames || (Object.getOwnPropertyNames = function(object) {\n      return Object.keys(object)\n    }), !Object.create) {\n    var createEmpty;\n    createEmpty = null === Object.prototype.__proto__ ? function() {\n      return {\n        __proto__: null\n      }\n    } : function() {\n      var empty = {};\n      for (var i in empty) empty[i] = null;\n      return empty.constructor = empty.hasOwnProperty = empty.propertyIsEnumerable = empty.isPrototypeOf = empty.toLocaleString = empty.toString = empty.valueOf = empty.__proto__ = null, empty\n    }, Object.create = function(prototype, properties) {\n      var object;\n      if (null === prototype) object = createEmpty();\n      else {\n        if ("object" != typeof prototype) throw new TypeError("typeof prototype[" + typeof prototype + "] != \'object\'");\n        var Type = function() {};\n        Type.prototype = prototype, object = new Type, object.__proto__ = prototype\n      }\n      return void 0 !== properties && Object.defineProperties(object, properties), object\n    }\n  }\n  if (Object.defineProperty) {\n    var definePropertyWorksOnObject = doesDefinePropertyWork({}),\n      definePropertyWorksOnDom = "undefined" == typeof document || doesDefinePropertyWork(document.createElement("div"));\n    if (!definePropertyWorksOnObject || !definePropertyWorksOnDom) var definePropertyFallback = Object.defineProperty\n  }\n  if (!Object.defineProperty || definePropertyFallback) {\n    var ERR_NON_OBJECT_DESCRIPTOR = "Property description must be an object: ",\n      ERR_NON_OBJECT_TARGET = "Object.defineProperty called on non-object: ",\n      ERR_ACCESSORS_NOT_SUPPORTED = "getters & setters can not be defined on this javascript engine";\n    Object.defineProperty = function(object, property, descriptor) {\n      if ("object" != typeof object && "function" != typeof object || null === object) throw new TypeError(ERR_NON_OBJECT_TARGET + object);\n      if ("object" != typeof descriptor && "function" != typeof descriptor || null === descriptor) throw new TypeError(ERR_NON_OBJECT_DESCRIPTOR + descriptor);\n      if (definePropertyFallback) try {\n        return definePropertyFallback.call(Object, object, property, descriptor)\n      } catch (exception) {}\n      if (owns(descriptor, "value"))\n        if (supportsAccessors && (lookupGetter(object, property) || lookupSetter(object, property))) {\n          var prototype = object.__proto__;\n          object.__proto__ = prototypeOfObject, delete object[property], object[property] = descriptor.value, object.__proto__ = prototype\n        } else object[property] = descriptor.value;\n      else {\n        if (!supportsAccessors) throw new TypeError(ERR_ACCESSORS_NOT_SUPPORTED);\n        owns(descriptor, "get") && defineGetter(object, property, descriptor.get), owns(descriptor, "set") && defineSetter(object, property, descriptor.set)\n      }\n      return object\n    }\n  }\n  Object.defineProperties || (Object.defineProperties = function(object, properties) {\n    for (var property in properties) owns(properties, property) && Object.defineProperty(object, property, properties[property]);\n    return object\n  }), Object.seal || (Object.seal = function(object) {\n    return object\n  }), Object.freeze || (Object.freeze = function(object) {\n    return object\n  });\n  try {\n    Object.freeze(function() {})\n  } catch (exception) {\n    Object.freeze = function(freezeObject) {\n      return function(object) {\n        return "function" == typeof object ? object : freezeObject(object)\n      }\n    }(Object.freeze)\n  }\n  if (Object.preventExtensions || (Object.preventExtensions = function(object) {\n      return object\n    }), Object.isSealed || (Object.isSealed = function() {\n      return !1\n    }), Object.isFrozen || (Object.isFrozen = function() {\n      return !1\n    }), Object.isExtensible || (Object.isExtensible = function(object) {\n      if (Object(object) === object) throw new TypeError;\n      for (var name = ""; owns(object, name);) name += "?";\n      object[name] = !0;\n      var returnValue = owns(object, name);\n      return delete object[name], returnValue\n    }), !Object.keys) {\n    var hasDontEnumBug = !0,\n      dontEnums = ["toString", "toLocaleString", "valueOf", "hasOwnProperty", "isPrototypeOf", "propertyIsEnumerable", "constructor"],\n      dontEnumsLength = dontEnums.length;\n    for (var key in {\n        toString: null\n      }) hasDontEnumBug = !1;\n    Object.keys = function(object) {\n      if ("object" != typeof object && "function" != typeof object || null === object) throw new TypeError("Object.keys called on a non-object");\n      var keys = [];\n      for (var name in object) owns(object, name) && keys.push(name);\n      if (hasDontEnumBug)\n        for (var i = 0, ii = dontEnumsLength; ii > i; i++) {\n          var dontEnum = dontEnums[i];\n          owns(object, dontEnum) && keys.push(dontEnum)\n        }\n      return keys\n    }\n  }\n  Date.now || (Date.now = function() {\n    return (new Date).getTime()\n  });\n  var ws = "\t\\n\v\\f\\r   ᠎             　\\u2028\\u2029\ufeff";\n  if (!String.prototype.trim || ws.trim()) {\n    ws = "[" + ws + "]";\n    var trimBeginRegexp = RegExp("^" + ws + ws + "*"),\n      trimEndRegexp = RegExp(ws + ws + "*$");\n    String.prototype.trim = function() {\n      return (this + "").replace(trimBeginRegexp, "").replace(trimEndRegexp, "")\n    }\n  }\n  var toObject = function(o) {\n    if (null == o) throw new TypeError("can\'t convert " + o + " to object");\n    return Object(o)\n  }\n});\n'},function(module,exports,__webpack_require__){"use strict";var punycode=__webpack_require__(472),util=__webpack_require__(473);function Url(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}exports.parse=urlParse,exports.resolve=function(source,relative){return urlParse(source,!1,!0).resolve(relative)},exports.resolveObject=function(source,relative){return source?urlParse(source,!1,!0).resolveObject(relative):relative},exports.format=function(obj){util.isString(obj)&&(obj=urlParse(obj));return obj instanceof Url?obj.format():Url.prototype.format.call(obj)},exports.Url=Url;var protocolPattern=/^([a-z0-9.+-]+:)/i,portPattern=/:[0-9]*$/,simplePathPattern=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,unwise=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),autoEscape=["'"].concat(unwise),nonHostChars=["%","/","?",";","#"].concat(autoEscape),hostEndingChars=["/","?","#"],hostnamePartPattern=/^[+a-z0-9A-Z_-]{0,63}$/,hostnamePartStart=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,unsafeProtocol={javascript:!0,"javascript:":!0},hostlessProtocol={javascript:!0,"javascript:":!0},slashedProtocol={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},querystring=__webpack_require__(474);function urlParse(url,parseQueryString,slashesDenoteHost){if(url&&util.isObject(url)&&url instanceof Url)return url;var u=new Url;return u.parse(url,parseQueryString,slashesDenoteHost),u}Url.prototype.parse=function(url,parseQueryString,slashesDenoteHost){if(!util.isString(url))throw new TypeError("Parameter 'url' must be a string, not "+typeof url);var queryIndex=url.indexOf("?"),splitter=-1!==queryIndex&&queryIndex<url.indexOf("#")?"?":"#",uSplit=url.split(splitter);uSplit[0]=uSplit[0].replace(/\\/g,"/");var rest=url=uSplit.join(splitter);if(rest=rest.trim(),!slashesDenoteHost&&1===url.split("#").length){var simplePath=simplePathPattern.exec(rest);if(simplePath)return this.path=rest,this.href=rest,this.pathname=simplePath[1],simplePath[2]?(this.search=simplePath[2],this.query=parseQueryString?querystring.parse(this.search.substr(1)):this.search.substr(1)):parseQueryString&&(this.search="",this.query={}),this}var proto=protocolPattern.exec(rest);if(proto){var lowerProto=(proto=proto[0]).toLowerCase();this.protocol=lowerProto,rest=rest.substr(proto.length)}if(slashesDenoteHost||proto||rest.match(/^\/\/[^@\/]+@[^@\/]+/)){var slashes="//"===rest.substr(0,2);!slashes||proto&&hostlessProtocol[proto]||(rest=rest.substr(2),this.slashes=!0)}if(!hostlessProtocol[proto]&&(slashes||proto&&!slashedProtocol[proto])){for(var auth,atSign,hostEnd=-1,i=0;i<hostEndingChars.length;i++){-1!==(hec=rest.indexOf(hostEndingChars[i]))&&(-1===hostEnd||hec<hostEnd)&&(hostEnd=hec)}-1!==(atSign=-1===hostEnd?rest.lastIndexOf("@"):rest.lastIndexOf("@",hostEnd))&&(auth=rest.slice(0,atSign),rest=rest.slice(atSign+1),this.auth=decodeURIComponent(auth)),hostEnd=-1;for(i=0;i<nonHostChars.length;i++){var hec;-1!==(hec=rest.indexOf(nonHostChars[i]))&&(-1===hostEnd||hec<hostEnd)&&(hostEnd=hec)}-1===hostEnd&&(hostEnd=rest.length),this.host=rest.slice(0,hostEnd),rest=rest.slice(hostEnd),this.parseHost(),this.hostname=this.hostname||"";var ipv6Hostname="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!ipv6Hostname)for(var hostparts=this.hostname.split(/\./),l=(i=0,hostparts.length);i<l;i++){var part=hostparts[i];if(part&&!part.match(hostnamePartPattern)){for(var newpart="",j=0,k=part.length;j<k;j++)part.charCodeAt(j)>127?newpart+="x":newpart+=part[j];if(!newpart.match(hostnamePartPattern)){var validParts=hostparts.slice(0,i),notHost=hostparts.slice(i+1),bit=part.match(hostnamePartStart);bit&&(validParts.push(bit[1]),notHost.unshift(bit[2])),notHost.length&&(rest="/"+notHost.join(".")+rest),this.hostname=validParts.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),ipv6Hostname||(this.hostname=punycode.toASCII(this.hostname));var p=this.port?":"+this.port:"",h=this.hostname||"";this.host=h+p,this.href+=this.host,ipv6Hostname&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==rest[0]&&(rest="/"+rest))}if(!unsafeProtocol[lowerProto])for(i=0,l=autoEscape.length;i<l;i++){var ae=autoEscape[i];if(-1!==rest.indexOf(ae)){var esc=encodeURIComponent(ae);esc===ae&&(esc=escape(ae)),rest=rest.split(ae).join(esc)}}var hash=rest.indexOf("#");-1!==hash&&(this.hash=rest.substr(hash),rest=rest.slice(0,hash));var qm=rest.indexOf("?");if(-1!==qm?(this.search=rest.substr(qm),this.query=rest.substr(qm+1),parseQueryString&&(this.query=querystring.parse(this.query)),rest=rest.slice(0,qm)):parseQueryString&&(this.search="",this.query={}),rest&&(this.pathname=rest),slashedProtocol[lowerProto]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){p=this.pathname||"";var s=this.search||"";this.path=p+s}return this.href=this.format(),this},Url.prototype.format=function(){var auth=this.auth||"";auth&&(auth=(auth=encodeURIComponent(auth)).replace(/%3A/i,":"),auth+="@");var protocol=this.protocol||"",pathname=this.pathname||"",hash=this.hash||"",host=!1,query="";this.host?host=auth+this.host:this.hostname&&(host=auth+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(host+=":"+this.port)),this.query&&util.isObject(this.query)&&Object.keys(this.query).length&&(query=querystring.stringify(this.query));var search=this.search||query&&"?"+query||"";return protocol&&":"!==protocol.substr(-1)&&(protocol+=":"),this.slashes||(!protocol||slashedProtocol[protocol])&&!1!==host?(host="//"+(host||""),pathname&&"/"!==pathname.charAt(0)&&(pathname="/"+pathname)):host||(host=""),hash&&"#"!==hash.charAt(0)&&(hash="#"+hash),search&&"?"!==search.charAt(0)&&(search="?"+search),protocol+host+(pathname=pathname.replace(/[?#]/g,(function(match){return encodeURIComponent(match)})))+(search=search.replace("#","%23"))+hash},Url.prototype.resolve=function(relative){return this.resolveObject(urlParse(relative,!1,!0)).format()},Url.prototype.resolveObject=function(relative){if(util.isString(relative)){var rel=new Url;rel.parse(relative,!1,!0),relative=rel}for(var result=new Url,tkeys=Object.keys(this),tk=0;tk<tkeys.length;tk++){var tkey=tkeys[tk];result[tkey]=this[tkey]}if(result.hash=relative.hash,""===relative.href)return result.href=result.format(),result;if(relative.slashes&&!relative.protocol){for(var rkeys=Object.keys(relative),rk=0;rk<rkeys.length;rk++){var rkey=rkeys[rk];"protocol"!==rkey&&(result[rkey]=relative[rkey])}return slashedProtocol[result.protocol]&&result.hostname&&!result.pathname&&(result.path=result.pathname="/"),result.href=result.format(),result}if(relative.protocol&&relative.protocol!==result.protocol){if(!slashedProtocol[relative.protocol]){for(var keys=Object.keys(relative),v=0;v<keys.length;v++){var k=keys[v];result[k]=relative[k]}return result.href=result.format(),result}if(result.protocol=relative.protocol,relative.host||hostlessProtocol[relative.protocol])result.pathname=relative.pathname;else{for(var relPath=(relative.pathname||"").split("/");relPath.length&&!(relative.host=relPath.shift()););relative.host||(relative.host=""),relative.hostname||(relative.hostname=""),""!==relPath[0]&&relPath.unshift(""),relPath.length<2&&relPath.unshift(""),result.pathname=relPath.join("/")}if(result.search=relative.search,result.query=relative.query,result.host=relative.host||"",result.auth=relative.auth,result.hostname=relative.hostname||relative.host,result.port=relative.port,result.pathname||result.search){var p=result.pathname||"",s=result.search||"";result.path=p+s}return result.slashes=result.slashes||relative.slashes,result.href=result.format(),result}var isSourceAbs=result.pathname&&"/"===result.pathname.charAt(0),isRelAbs=relative.host||relative.pathname&&"/"===relative.pathname.charAt(0),mustEndAbs=isRelAbs||isSourceAbs||result.host&&relative.pathname,removeAllDots=mustEndAbs,srcPath=result.pathname&&result.pathname.split("/")||[],psychotic=(relPath=relative.pathname&&relative.pathname.split("/")||[],result.protocol&&!slashedProtocol[result.protocol]);if(psychotic&&(result.hostname="",result.port=null,result.host&&(""===srcPath[0]?srcPath[0]=result.host:srcPath.unshift(result.host)),result.host="",relative.protocol&&(relative.hostname=null,relative.port=null,relative.host&&(""===relPath[0]?relPath[0]=relative.host:relPath.unshift(relative.host)),relative.host=null),mustEndAbs=mustEndAbs&&(""===relPath[0]||""===srcPath[0])),isRelAbs)result.host=relative.host||""===relative.host?relative.host:result.host,result.hostname=relative.hostname||""===relative.hostname?relative.hostname:result.hostname,result.search=relative.search,result.query=relative.query,srcPath=relPath;else if(relPath.length)srcPath||(srcPath=[]),srcPath.pop(),srcPath=srcPath.concat(relPath),result.search=relative.search,result.query=relative.query;else if(!util.isNullOrUndefined(relative.search)){if(psychotic)result.hostname=result.host=srcPath.shift(),(authInHost=!!(result.host&&result.host.indexOf("@")>0)&&result.host.split("@"))&&(result.auth=authInHost.shift(),result.host=result.hostname=authInHost.shift());return result.search=relative.search,result.query=relative.query,util.isNull(result.pathname)&&util.isNull(result.search)||(result.path=(result.pathname?result.pathname:"")+(result.search?result.search:"")),result.href=result.format(),result}if(!srcPath.length)return result.pathname=null,result.search?result.path="/"+result.search:result.path=null,result.href=result.format(),result;for(var last=srcPath.slice(-1)[0],hasTrailingSlash=(result.host||relative.host||srcPath.length>1)&&("."===last||".."===last)||""===last,up=0,i=srcPath.length;i>=0;i--)"."===(last=srcPath[i])?srcPath.splice(i,1):".."===last?(srcPath.splice(i,1),up++):up&&(srcPath.splice(i,1),up--);if(!mustEndAbs&&!removeAllDots)for(;up--;up)srcPath.unshift("..");!mustEndAbs||""===srcPath[0]||srcPath[0]&&"/"===srcPath[0].charAt(0)||srcPath.unshift(""),hasTrailingSlash&&"/"!==srcPath.join("/").substr(-1)&&srcPath.push("");var authInHost,isAbsolute=""===srcPath[0]||srcPath[0]&&"/"===srcPath[0].charAt(0);psychotic&&(result.hostname=result.host=isAbsolute?"":srcPath.length?srcPath.shift():"",(authInHost=!!(result.host&&result.host.indexOf("@")>0)&&result.host.split("@"))&&(result.auth=authInHost.shift(),result.host=result.hostname=authInHost.shift()));return(mustEndAbs=mustEndAbs||result.host&&srcPath.length)&&!isAbsolute&&srcPath.unshift(""),srcPath.length?result.pathname=srcPath.join("/"):(result.pathname=null,result.path=null),util.isNull(result.pathname)&&util.isNull(result.search)||(result.path=(result.pathname?result.pathname:"")+(result.search?result.search:"")),result.auth=relative.auth||result.auth,result.slashes=result.slashes||relative.slashes,result.href=result.format(),result},Url.prototype.parseHost=function(){var host=this.host,port=portPattern.exec(host);port&&(":"!==(port=port[0])&&(this.port=port.substr(1)),host=host.substr(0,host.length-port.length)),host&&(this.hostname=host)}},function(module,exports,__webpack_require__){(function(module,global){var __WEBPACK_AMD_DEFINE_RESULT__;/*! https://mths.be/punycode v1.4.1 by @mathias */!function(root){exports&&exports.nodeType,module&&module.nodeType;var freeGlobal="object"==typeof global&&global;freeGlobal.global!==freeGlobal&&freeGlobal.window!==freeGlobal&&freeGlobal.self;var punycode,maxInt=2147483647,regexPunycode=/^xn--/,regexNonASCII=/[^\x20-\x7E]/,regexSeparators=/[\x2E\u3002\uFF0E\uFF61]/g,errors={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},floor=Math.floor,stringFromCharCode=String.fromCharCode;function error(type){throw new RangeError(errors[type])}function map(array,fn){for(var length=array.length,result=[];length--;)result[length]=fn(array[length]);return result}function mapDomain(string,fn){var parts=string.split("@"),result="";return parts.length>1&&(result=parts[0]+"@",string=parts[1]),result+map((string=string.replace(regexSeparators,".")).split("."),fn).join(".")}function ucs2decode(string){for(var value,extra,output=[],counter=0,length=string.length;counter<length;)(value=string.charCodeAt(counter++))>=55296&&value<=56319&&counter<length?56320==(64512&(extra=string.charCodeAt(counter++)))?output.push(((1023&value)<<10)+(1023&extra)+65536):(output.push(value),counter--):output.push(value);return output}function ucs2encode(array){return map(array,(function(value){var output="";return value>65535&&(output+=stringFromCharCode((value-=65536)>>>10&1023|55296),value=56320|1023&value),output+=stringFromCharCode(value)})).join("")}function digitToBasic(digit,flag){return digit+22+75*(digit<26)-((0!=flag)<<5)}function adapt(delta,numPoints,firstTime){var k=0;for(delta=firstTime?floor(delta/700):delta>>1,delta+=floor(delta/numPoints);delta>455;k+=36)delta=floor(delta/35);return floor(k+36*delta/(delta+38))}function decode(input){var out,basic,j,index,oldi,w,k,digit,t,baseMinusT,codePoint,output=[],inputLength=input.length,i=0,n=128,bias=72;for((basic=input.lastIndexOf("-"))<0&&(basic=0),j=0;j<basic;++j)input.charCodeAt(j)>=128&&error("not-basic"),output.push(input.charCodeAt(j));for(index=basic>0?basic+1:0;index<inputLength;){for(oldi=i,w=1,k=36;index>=inputLength&&error("invalid-input"),((digit=(codePoint=input.charCodeAt(index++))-48<10?codePoint-22:codePoint-65<26?codePoint-65:codePoint-97<26?codePoint-97:36)>=36||digit>floor((maxInt-i)/w))&&error("overflow"),i+=digit*w,!(digit<(t=k<=bias?1:k>=bias+26?26:k-bias));k+=36)w>floor(maxInt/(baseMinusT=36-t))&&error("overflow"),w*=baseMinusT;bias=adapt(i-oldi,out=output.length+1,0==oldi),floor(i/out)>maxInt-n&&error("overflow"),n+=floor(i/out),i%=out,output.splice(i++,0,n)}return ucs2encode(output)}function encode(input){var n,delta,handledCPCount,basicLength,bias,j,m,q,k,t,currentValue,inputLength,handledCPCountPlusOne,baseMinusT,qMinusT,output=[];for(inputLength=(input=ucs2decode(input)).length,n=128,delta=0,bias=72,j=0;j<inputLength;++j)(currentValue=input[j])<128&&output.push(stringFromCharCode(currentValue));for(handledCPCount=basicLength=output.length,basicLength&&output.push("-");handledCPCount<inputLength;){for(m=maxInt,j=0;j<inputLength;++j)(currentValue=input[j])>=n&&currentValue<m&&(m=currentValue);for(m-n>floor((maxInt-delta)/(handledCPCountPlusOne=handledCPCount+1))&&error("overflow"),delta+=(m-n)*handledCPCountPlusOne,n=m,j=0;j<inputLength;++j)if((currentValue=input[j])<n&&++delta>maxInt&&error("overflow"),currentValue==n){for(q=delta,k=36;!(q<(t=k<=bias?1:k>=bias+26?26:k-bias));k+=36)qMinusT=q-t,baseMinusT=36-t,output.push(stringFromCharCode(digitToBasic(t+qMinusT%baseMinusT,0))),q=floor(qMinusT/baseMinusT);output.push(stringFromCharCode(digitToBasic(q,0))),bias=adapt(delta,handledCPCountPlusOne,handledCPCount==basicLength),delta=0,++handledCPCount}++delta,++n}return output.join("")}punycode={version:"1.4.1",ucs2:{decode:ucs2decode,encode:ucs2encode},decode:decode,encode:encode,toASCII:function(input){return mapDomain(input,(function(string){return regexNonASCII.test(string)?"xn--"+encode(string):string}))},toUnicode:function(input){return mapDomain(input,(function(string){return regexPunycode.test(string)?decode(string.slice(4).toLowerCase()):string}))}},void 0===(__WEBPACK_AMD_DEFINE_RESULT__=function(){return punycode}.call(exports,__webpack_require__,exports,module))||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)}()}).call(this,__webpack_require__(165)(module),__webpack_require__(117))},function(module,exports,__webpack_require__){"use strict";module.exports={isString:function(arg){return"string"==typeof arg},isObject:function(arg){return"object"==typeof arg&&null!==arg},isNull:function(arg){return null===arg},isNullOrUndefined:function(arg){return null==arg}}},function(module,exports,__webpack_require__){"use strict";exports.decode=exports.parse=__webpack_require__(475),exports.encode=exports.stringify=__webpack_require__(476)},function(module,exports,__webpack_require__){"use strict";function hasOwnProperty(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}module.exports=function(qs,sep,eq,options){sep=sep||"&",eq=eq||"=";var obj={};if("string"!=typeof qs||0===qs.length)return obj;var regexp=/\+/g;qs=qs.split(sep);var maxKeys=1e3;options&&"number"==typeof options.maxKeys&&(maxKeys=options.maxKeys);var len=qs.length;maxKeys>0&&len>maxKeys&&(len=maxKeys);for(var i=0;i<len;++i){var kstr,vstr,k,v,x=qs[i].replace(regexp,"%20"),idx=x.indexOf(eq);idx>=0?(kstr=x.substr(0,idx),vstr=x.substr(idx+1)):(kstr=x,vstr=""),k=decodeURIComponent(kstr),v=decodeURIComponent(vstr),hasOwnProperty(obj,k)?isArray(obj[k])?obj[k].push(v):obj[k]=[obj[k],v]:obj[k]=v}return obj};var isArray=Array.isArray||function(xs){return"[object Array]"===Object.prototype.toString.call(xs)}},function(module,exports,__webpack_require__){"use strict";var stringifyPrimitive=function(v){switch(typeof v){case"string":return v;case"boolean":return v?"true":"false";case"number":return isFinite(v)?v:"";default:return""}};module.exports=function(obj,sep,eq,name){return sep=sep||"&",eq=eq||"=",null===obj&&(obj=void 0),"object"==typeof obj?map(objectKeys(obj),(function(k){var ks=encodeURIComponent(stringifyPrimitive(k))+eq;return isArray(obj[k])?map(obj[k],(function(v){return ks+encodeURIComponent(stringifyPrimitive(v))})).join(sep):ks+encodeURIComponent(stringifyPrimitive(obj[k]))})).join(sep):name?encodeURIComponent(stringifyPrimitive(name))+eq+encodeURIComponent(stringifyPrimitive(obj)):""};var isArray=Array.isArray||function(xs){return"[object Array]"===Object.prototype.toString.call(xs)};function map(xs,f){if(xs.map)return xs.map(f);for(var res=[],i=0;i<xs.length;i++)res.push(f(xs[i],i));return res}var objectKeys=Object.keys||function(obj){var res=[];for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&res.push(key);return res}},function(module,exports,__webpack_require__){switch(window.__kbnThemeTag__){case"v7dark":return __webpack_require__(478);case"v7light":return __webpack_require__(480);case"v8dark":return __webpack_require__(482);case"v8light":return __webpack_require__(484)}},function(module,exports,__webpack_require__){var api=__webpack_require__(65),content=__webpack_require__(479);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){(exports=__webpack_require__(66)(!1)).push([module.i,".time-range-selector .time-range-section-container{display:flex}.time-range-selector .time-range-section-title{font-weight:bold;margin-bottom:8px}.time-range-selector .time-range-section{flex:50%;padding:0 8px;border-right:1px solid #343741}.time-range-selector .tab-stack{margin-bottom:0;padding-left:0;list-style:none}.time-range-selector .tab-stack>li{float:none;position:relative;display:block;margin-bottom:4px}.time-range-selector .tab-stack>li>a{position:relative;display:block;padding:8px 16px;border-radius:4px}.time-range-selector .tab-stack>li>a:hover{background-color:#25262E}.time-range-selector .tab-stack>li .body{display:none}.time-range-selector .tab-stack>li.active>a{color:#1D1E24;background-color:#1BA9F5}.time-range-selector .tab-stack>li.active .body{display:block;height:315px}.time-range-selector .tab-stack>li.has-body.active>a{border-radius:4px 4px 0 0}.time-range-selector .tab-stack>li.has-body.active .react-datepicker{border-radius:0 0 4px 4px;border-top:none}.time-range-selector .time-range-section:last-child{border-right:none}\n",""]),module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(65),content=__webpack_require__(481);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){(exports=__webpack_require__(66)(!1)).push([module.i,".time-range-selector .time-range-section-container{display:flex}.time-range-selector .time-range-section-title{font-weight:bold;margin-bottom:8px}.time-range-selector .time-range-section{flex:50%;padding:0 8px;border-right:1px solid #D3DAE6}.time-range-selector .tab-stack{margin-bottom:0;padding-left:0;list-style:none}.time-range-selector .tab-stack>li{float:none;position:relative;display:block;margin-bottom:4px}.time-range-selector .tab-stack>li>a{position:relative;display:block;padding:8px 16px;border-radius:4px}.time-range-selector .tab-stack>li>a:hover{background-color:#F5F7FA}.time-range-selector .tab-stack>li .body{display:none}.time-range-selector .tab-stack>li.active>a{color:#fff;background-color:#006BB4}.time-range-selector .tab-stack>li.active .body{display:block;height:315px}.time-range-selector .tab-stack>li.has-body.active>a{border-radius:4px 4px 0 0}.time-range-selector .tab-stack>li.has-body.active .react-datepicker{border-radius:0 0 4px 4px;border-top:none}.time-range-selector .time-range-section:last-child{border-right:none}\n",""]),module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(65),content=__webpack_require__(483);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){(exports=__webpack_require__(66)(!1)).push([module.i,".time-range-selector .time-range-section-container{display:flex}.time-range-selector .time-range-section-title{font-weight:bold;margin-bottom:8px}.time-range-selector .time-range-section{flex:50%;padding:0 8px;border-right:1px solid #343741}.time-range-selector .tab-stack{margin-bottom:0;padding-left:0;list-style:none}.time-range-selector .tab-stack>li{float:none;position:relative;display:block;margin-bottom:4px}.time-range-selector .tab-stack>li>a{position:relative;display:block;padding:8px 16px;border-radius:4px}.time-range-selector .tab-stack>li>a:hover{background-color:#25262E}.time-range-selector .tab-stack>li .body{display:none}.time-range-selector .tab-stack>li.active>a{color:#1D1E24;background-color:#36A2EF}.time-range-selector .tab-stack>li.active .body{display:block;height:315px}.time-range-selector .tab-stack>li.has-body.active>a{border-radius:6px 6px 0 0}.time-range-selector .tab-stack>li.has-body.active .react-datepicker{border-radius:0 0 6px 6px;border-top:none}.time-range-selector .time-range-section:last-child{border-right:none}\n",""]),module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(65),content=__webpack_require__(485);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){(exports=__webpack_require__(66)(!1)).push([module.i,".time-range-selector .time-range-section-container{display:flex}.time-range-selector .time-range-section-title{font-weight:bold;margin-bottom:8px}.time-range-selector .time-range-section{flex:50%;padding:0 8px;border-right:1px solid #D3DAE6}.time-range-selector .tab-stack{margin-bottom:0;padding-left:0;list-style:none}.time-range-selector .tab-stack>li{float:none;position:relative;display:block;margin-bottom:4px}.time-range-selector .tab-stack>li>a{position:relative;display:block;padding:8px 16px;border-radius:4px}.time-range-selector .tab-stack>li>a:hover{background-color:#F5F7FA}.time-range-selector .tab-stack>li .body{display:none}.time-range-selector .tab-stack>li.active>a{color:#fff;background-color:#07C}.time-range-selector .tab-stack>li.active .body{display:block;height:315px}.time-range-selector .tab-stack>li.has-body.active>a{border-radius:6px 6px 0 0}.time-range-selector .tab-stack>li.has-body.active .react-datepicker{border-radius:0 0 6px 6px;border-top:none}.time-range-selector .time-range-section:last-child{border-right:none}\n",""]),module.exports=exports},,,function(module,exports,__webpack_require__){"use strict";exports.byteLength=function(b64){var lens=getLens(b64),validLen=lens[0],placeHoldersLen=lens[1];return 3*(validLen+placeHoldersLen)/4-placeHoldersLen},exports.toByteArray=function(b64){var tmp,i,lens=getLens(b64),validLen=lens[0],placeHoldersLen=lens[1],arr=new Arr(function(b64,validLen,placeHoldersLen){return 3*(validLen+placeHoldersLen)/4-placeHoldersLen}(0,validLen,placeHoldersLen)),curByte=0,len=placeHoldersLen>0?validLen-4:validLen;for(i=0;i<len;i+=4)tmp=revLookup[b64.charCodeAt(i)]<<18|revLookup[b64.charCodeAt(i+1)]<<12|revLookup[b64.charCodeAt(i+2)]<<6|revLookup[b64.charCodeAt(i+3)],arr[curByte++]=tmp>>16&255,arr[curByte++]=tmp>>8&255,arr[curByte++]=255&tmp;2===placeHoldersLen&&(tmp=revLookup[b64.charCodeAt(i)]<<2|revLookup[b64.charCodeAt(i+1)]>>4,arr[curByte++]=255&tmp);1===placeHoldersLen&&(tmp=revLookup[b64.charCodeAt(i)]<<10|revLookup[b64.charCodeAt(i+1)]<<4|revLookup[b64.charCodeAt(i+2)]>>2,arr[curByte++]=tmp>>8&255,arr[curByte++]=255&tmp);return arr},exports.fromByteArray=function(uint8){for(var tmp,len=uint8.length,extraBytes=len%3,parts=[],i=0,len2=len-extraBytes;i<len2;i+=16383)parts.push(encodeChunk(uint8,i,i+16383>len2?len2:i+16383));1===extraBytes?(tmp=uint8[len-1],parts.push(lookup[tmp>>2]+lookup[tmp<<4&63]+"==")):2===extraBytes&&(tmp=(uint8[len-2]<<8)+uint8[len-1],parts.push(lookup[tmp>>10]+lookup[tmp>>4&63]+lookup[tmp<<2&63]+"="));return parts.join("")};for(var lookup=[],revLookup=[],Arr="undefined"!=typeof Uint8Array?Uint8Array:Array,code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,len=code.length;i<len;++i)lookup[i]=code[i],revLookup[code.charCodeAt(i)]=i;function getLens(b64){var len=b64.length;if(len%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var validLen=b64.indexOf("=");return-1===validLen&&(validLen=len),[validLen,validLen===len?0:4-validLen%4]}function encodeChunk(uint8,start,end){for(var tmp,num,output=[],i=start;i<end;i+=3)tmp=(uint8[i]<<16&16711680)+(uint8[i+1]<<8&65280)+(255&uint8[i+2]),output.push(lookup[(num=tmp)>>18&63]+lookup[num>>12&63]+lookup[num>>6&63]+lookup[63&num]);return output.join("")}revLookup["-".charCodeAt(0)]=62,revLookup["_".charCodeAt(0)]=63},function(module,exports){exports.read=function(buffer,offset,isLE,mLen,nBytes){var e,m,eLen=8*nBytes-mLen-1,eMax=(1<<eLen)-1,eBias=eMax>>1,nBits=-7,i=isLE?nBytes-1:0,d=isLE?-1:1,s=buffer[offset+i];for(i+=d,e=s&(1<<-nBits)-1,s>>=-nBits,nBits+=eLen;nBits>0;e=256*e+buffer[offset+i],i+=d,nBits-=8);for(m=e&(1<<-nBits)-1,e>>=-nBits,nBits+=mLen;nBits>0;m=256*m+buffer[offset+i],i+=d,nBits-=8);if(0===e)e=1-eBias;else{if(e===eMax)return m?NaN:1/0*(s?-1:1);m+=Math.pow(2,mLen),e-=eBias}return(s?-1:1)*m*Math.pow(2,e-mLen)},exports.write=function(buffer,value,offset,isLE,mLen,nBytes){var e,m,c,eLen=8*nBytes-mLen-1,eMax=(1<<eLen)-1,eBias=eMax>>1,rt=23===mLen?Math.pow(2,-24)-Math.pow(2,-77):0,i=isLE?0:nBytes-1,d=isLE?1:-1,s=value<0||0===value&&1/value<0?1:0;for(value=Math.abs(value),isNaN(value)||value===1/0?(m=isNaN(value)?1:0,e=eMax):(e=Math.floor(Math.log(value)/Math.LN2),value*(c=Math.pow(2,-e))<1&&(e--,c*=2),(value+=e+eBias>=1?rt/c:rt*Math.pow(2,1-eBias))*c>=2&&(e++,c/=2),e+eBias>=eMax?(m=0,e=eMax):e+eBias>=1?(m=(value*c-1)*Math.pow(2,mLen),e+=eBias):(m=value*Math.pow(2,eBias-1)*Math.pow(2,mLen),e=0));mLen>=8;buffer[offset+i]=255&m,i+=d,m/=256,mLen-=8);for(e=e<<mLen|m,eLen+=mLen;eLen>0;buffer[offset+i]=255&e,i+=d,e/=256,eLen-=8);buffer[offset+i-d]|=128*s}},function(module,exports){var toString={}.toString;module.exports=Array.isArray||function(arr){return"[object Array]"==toString.call(arr)}},function(module,exports){module.exports=function(arg){return arg&&"object"==typeof arg&&"function"==typeof arg.copy&&"function"==typeof arg.fill&&"function"==typeof arg.readUInt8}},function(module,exports){"function"==typeof Object.create?module.exports=function(ctor,superCtor){ctor.super_=superCtor,ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:!1,writable:!0,configurable:!0}})}:module.exports=function(ctor,superCtor){ctor.super_=superCtor;var TempCtor=function(){};TempCtor.prototype=superCtor.prototype,ctor.prototype=new TempCtor,ctor.prototype.constructor=ctor}},function(module,exports,__webpack_require__){"use strict";var util=__webpack_require__(171),CalendarObject=__webpack_require__(107).CalendarObject,schema=__webpack_require__(107).schema,iCalendar=__webpack_require__(198).iCalendar,RRule=__webpack_require__(197).RRule,VEvent=exports.VEvent=function(calendar,uid){calendar instanceof iCalendar||null==calendar||(uid=calendar,calendar=null),CalendarObject.call(this,calendar,"VEVENT"),void 0!==uid&&(this.addProperty("DTSTAMP",new Date),this.addProperty("UID",uid))};util.inherits(VEvent,CalendarObject),VEvent.prototype.setSummary=function(summ){this.addProperty("SUMMARY",summ)},VEvent.prototype.setLocation=function(loc){this.addProperty("LOCATION",loc)},VEvent.prototype.setDescription=function(desc){this.addProperty("DESCRIPTION",desc)},VEvent.prototype.setDate=function(start,end){this.addProperty("DTSTART",start),end instanceof Date?this.addProperty("DTEND",end):this.addProperty("DURATION",end)},VEvent.prototype.rrule=function(){var rr=this.getPropertyValue("RRULE");if(!rr)return null;for(var ex,exceptions=[],i=0;ex=this.getPropertyValue("EXDATE",i++);)exceptions.push.apply(exceptions,ex);return new RRule(rr,{DTSTART:this.getPropertyValue("DTSTART"),DTEND:this.getPropertyValue("DTEND"),EXDATE:exceptions})},VEvent.prototype.inTimeRange=function(start,end){var rr=this.rrule();if(rr){var next=rr.next(start);return null!==next&&(!end||next<=end)}var dtstart=this.getPropertyValue("DTSTART"),dtend=this.getPropertyValue("DTEND");if(!dtend){var duration=this.getPropertyValue("DURATION");if(0===duration)return(!start||start<=dtstart)&&(!end||end>dtstart);dtend=duration?new Date(dtstart.valueOf()+1e3*this.getPropertyValue("DURATION")):new Date(dtstart.valueOf()+864e5)}return(!start||start<dtend)&&(!end||end>dtstart)},VEvent.prototype.reply=function(fromuser,status,options){var resp=this.clone(!0);options=options||{},!0===status||void 0===status?status="ACCEPTED":!1===status&&(status="DECLINED"),resp.setProperty("ATTENDEE",fromuser,{PARTSTAT:status,CN:options.CN||fromuser}),resp.setProperty("DTSTAMP",new Date),resp.setProperty("LAST-MODIFIED",new Date);var ics=new iCalendar;return ics.addProperty("METHOD","REPLY"),this.calendar&&ics.addComponents(this.calendar.getComponents("VTIMEZONE")),ics.addComponent(resp),ics},schema.VEVENT={factory:VEvent,valid_properties:[],required_properties:["DTSTAMP","UID"],valid_children:[],required_children:[]}},function(module,exports,__webpack_require__){var assert=__webpack_require__(249),util=__webpack_require__(171),CalendarObject=__webpack_require__(107).CalendarObject,schema=__webpack_require__(107).schema,RRule=__webpack_require__(197).RRule,VTimezone=exports.VTimezone=function(calendar,tzid){CalendarObject.call(this,calendar,"VTIMEZONE"),this.addProperty("TZID",tzid)};util.inherits(VTimezone,CalendarObject),VTimezone.prototype.getRRule=function(section){var comp=this.getComponents(section)[0];return comp&&comp.getPropertyValue("RRULE")?new RRule(comp.getPropertyValue("RRULE"),comp.getPropertyValue("DTSTART"),comp.getPropertyValue("DTEND")):null},VTimezone.prototype.getOffsetForDate=function(dt){if(!this.getComponents("DAYLIGHT").length)return this.getComponents("STANDARD")[0].getPropertyValue("TZOFFSETTO");assert.equal(1,this.components.STANDARD.length),assert.equal(1,this.components.DAYLIGHT.length);var next_std=this.getRRule("STANDARD"),next_dst=this.getRRule("DAYLIGHT");return null===next_std||null===next_dst?this.getComponents("STANDARD")[0].getPropertyValue("TZOFFSETTO"):(next_std=next_std.next(dt),next_dst=next_dst.next(dt),this.getComponents(next_dst<next_std?"STANDARD":"DAYLIGHT")[0].getPropertyValue("TZOFFSETTO"))},VTimezone.prototype.fromLocalTime=function(dtarray){var hrs=this.getOffsetForDate(dtarray),min=hrs%100;return hrs=(hrs-min)/100,new Date(Date.UTC(dtarray[0],dtarray[1]-1,dtarray[2],dtarray[3]-hrs,dtarray[4]-min,dtarray[5]))},schema.VTIMEZONE={factory:VTimezone}},function(module,exports,__webpack_require__){switch(window.__kbnThemeTag__){case"v7dark":return __webpack_require__(496);case"v7light":return __webpack_require__(498);case"v8dark":return __webpack_require__(500);case"v8light":return __webpack_require__(502)}},function(module,exports,__webpack_require__){var api=__webpack_require__(65),content=__webpack_require__(497);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){(exports=__webpack_require__(66)(!1)).push([module.i,".mlExpandedRowDetails{padding:0 8px 8px 8px}.mlExpandedRowDetailsSection thead{display:none}\n",""]),module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(65),content=__webpack_require__(499);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){(exports=__webpack_require__(66)(!1)).push([module.i,".mlExpandedRowDetails{padding:0 8px 8px 8px}.mlExpandedRowDetailsSection thead{display:none}\n",""]),module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(65),content=__webpack_require__(501);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){(exports=__webpack_require__(66)(!1)).push([module.i,".mlExpandedRowDetails{padding:0 8px 8px 8px}.mlExpandedRowDetailsSection thead{display:none}\n",""]),module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(65),content=__webpack_require__(503);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){(exports=__webpack_require__(66)(!1)).push([module.i,".mlExpandedRowDetails{padding:0 8px 8px 8px}.mlExpandedRowDetailsSection thead{display:none}\n",""]),module.exports=exports},function(module,exports,__webpack_require__){switch(window.__kbnThemeTag__){case"v7dark":return __webpack_require__(505);case"v7light":return __webpack_require__(507);case"v8dark":return __webpack_require__(509);case"v8light":return __webpack_require__(511)}},function(module,exports,__webpack_require__){var api=__webpack_require__(65),content=__webpack_require__(506);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){(exports=__webpack_require__(66)(!1)).push([module.i,".mlExpandedRowJobMessages{padding:0 8px 8px 8px}.mlExpandedRowJobMessages .euiTable,.mlExpandedRowJobMessages .euiTableRowCell{background-color:transparent !important}\n",""]),module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(65),content=__webpack_require__(508);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){(exports=__webpack_require__(66)(!1)).push([module.i,".mlExpandedRowJobMessages{padding:0 8px 8px 8px}.mlExpandedRowJobMessages .euiTable,.mlExpandedRowJobMessages .euiTableRowCell{background-color:transparent !important}\n",""]),module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(65),content=__webpack_require__(510);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){(exports=__webpack_require__(66)(!1)).push([module.i,".mlExpandedRowJobMessages{padding:0 8px 8px 8px}.mlExpandedRowJobMessages .euiTable,.mlExpandedRowJobMessages .euiTableRowCell{background-color:transparent !important}\n",""]),module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(65),content=__webpack_require__(512);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){(exports=__webpack_require__(66)(!1)).push([module.i,".mlExpandedRowJobMessages{padding:0 8px 8px 8px}.mlExpandedRowJobMessages .euiTable,.mlExpandedRowJobMessages .euiTableRowCell{background-color:transparent !important}\n",""]),module.exports=exports},function(module,exports,__webpack_require__){"use strict";(function(setImmediate){function _interopDefault(ex){return ex&&"object"==typeof ex&&"default"in ex?ex.default:ex}var util=_interopDefault(__webpack_require__(516)),Heap=_interopDefault(__webpack_require__(517));function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}function _slicedToArray(arr,i){return function(arr){if(Array.isArray(arr))return arr}(arr)||function(arr,i){var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var window$1="undefined"==typeof window?null:window,navigator=window$1?window$1.navigator:null,typeofstr=(window$1&&window$1.document,_typeof("")),typeofobj=_typeof({}),typeoffn=_typeof((function(){})),typeofhtmlele="undefined"==typeof HTMLElement?"undefined":_typeof(HTMLElement),instanceStr=function(obj){return obj&&obj.instanceString&&fn(obj.instanceString)?obj.instanceString():null},string=function(obj){return null!=obj&&_typeof(obj)==typeofstr},fn=function(obj){return null!=obj&&_typeof(obj)===typeoffn},array=function(obj){return Array.isArray?Array.isArray(obj):null!=obj&&obj instanceof Array},plainObject=function(obj){return null!=obj&&_typeof(obj)===typeofobj&&!array(obj)&&obj.constructor===Object},number=function(obj){return null!=obj&&_typeof(obj)===_typeof(1)&&!isNaN(obj)},htmlElement=function(obj){return"undefined"===typeofhtmlele?void 0:null!=obj&&obj instanceof HTMLElement},elementOrCollection=function(obj){return element(obj)||collection(obj)},element=function(obj){return"collection"===instanceStr(obj)&&obj._private.single},collection=function(obj){return"collection"===instanceStr(obj)&&!obj._private.single},core=function(obj){return"core"===instanceStr(obj)},stylesheet=function(obj){return"stylesheet"===instanceStr(obj)},emptyString=function(obj){return null==obj||!(""!==obj&&!obj.match(/^\s+$/))},promise=function(obj){return function(obj){return null!=obj&&_typeof(obj)===typeofobj}(obj)&&fn(obj.then)},memoize=function(fn,keyFn){keyFn||(keyFn=function(){if(1===arguments.length)return arguments[0];if(0===arguments.length)return"undefined";for(var args=[],i=0;i<arguments.length;i++)args.push(arguments[i]);return args.join("$")});var memoizedFn=function memoizedFn(){var ret,self=this,args=arguments,k=keyFn.apply(self,args),cache=memoizedFn.cache;return(ret=cache[k])||(ret=cache[k]=fn.apply(self,args)),ret};return memoizedFn.cache={},memoizedFn},camel2dash=memoize((function(str){return str.replace(/([A-Z])/g,(function(v){return"-"+v.toLowerCase()}))})),dash2camel=memoize((function(str){return str.replace(/(-\w)/g,(function(v){return v[1].toUpperCase()}))})),prependCamel=memoize((function(prefix,str){return prefix+str[0].toUpperCase()+str.substring(1)}),(function(prefix,str){return prefix+"$"+str})),capitalize=function(str){return emptyString(str)?str:str.charAt(0).toUpperCase()+str.substring(1)},number$1="(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))",ascending=function(a,b){return a<b?-1:a>b?1:0},extend=null!=Object.assign?Object.assign.bind(Object):function(tgt){for(var args=arguments,i=1;i<args.length;i++){var obj=args[i];if(null!=obj)for(var keys=Object.keys(obj),j=0;j<keys.length;j++){var k=keys[j];tgt[k]=obj[k]}}return tgt},color2tuple=function(color){return(array(color)?color:null)||function(color){return colors[color.toLowerCase()]}(color)||function(hex){if((4===hex.length||7===hex.length)&&"#"===hex[0]){var r,g,b;return 4===hex.length?(r=parseInt(hex[1]+hex[1],16),g=parseInt(hex[2]+hex[2],16),b=parseInt(hex[3]+hex[3],16)):(r=parseInt(hex[1]+hex[2],16),g=parseInt(hex[3]+hex[4],16),b=parseInt(hex[5]+hex[6],16)),[r,g,b]}}(color)||function(rgb){var ret,m=new RegExp("^rgb[a]?\\(((?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%]?)\\s*,\\s*((?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%]?)\\s*,\\s*((?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%]?)(?:\\s*,\\s*((?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))))?\\)$").exec(rgb);if(m){ret=[];for(var isPct=[],i=1;i<=3;i++){var channel=m[i];if("%"===channel[channel.length-1]&&(isPct[i]=!0),channel=parseFloat(channel),isPct[i]&&(channel=channel/100*255),channel<0||channel>255)return;ret.push(Math.floor(channel))}var atLeastOneIsPct=isPct[1]||isPct[2]||isPct[3],allArePct=isPct[1]&&isPct[2]&&isPct[3];if(atLeastOneIsPct&&!allArePct)return;var alpha=m[4];if(void 0!==alpha){if((alpha=parseFloat(alpha))<0||alpha>1)return;ret.push(alpha)}}return ret}(color)||function(hsl){var ret,h,s,l,a,r,g,b;function hue2rgb(p,q,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?p+6*(q-p)*t:t<.5?q:t<2/3?p+(q-p)*(2/3-t)*6:p}var m=new RegExp("^hsl[a]?\\(((?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?)))\\s*,\\s*((?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%])\\s*,\\s*((?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%])(?:\\s*,\\s*((?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))))?\\)$").exec(hsl);if(m){if((h=parseInt(m[1]))<0?h=(360- -1*h%360)%360:h>360&&(h%=360),h/=360,(s=parseFloat(m[2]))<0||s>100)return;if(s/=100,(l=parseFloat(m[3]))<0||l>100)return;if(l/=100,void 0!==(a=m[4])&&((a=parseFloat(a))<0||a>1))return;if(0===s)r=g=b=Math.round(255*l);else{var q=l<.5?l*(1+s):l+s-l*s,p=2*l-q;r=Math.round(255*hue2rgb(p,q,h+1/3)),g=Math.round(255*hue2rgb(p,q,h)),b=Math.round(255*hue2rgb(p,q,h-1/3))}ret=[r,g,b,a]}return ret}(color)},colors={transparent:[0,0,0,0],aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],grey:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},setMap=function(options){for(var obj=options.map,keys=options.keys,l=keys.length,i=0;i<l;i++){var key=keys[i];if(plainObject(key))throw Error("Tried to set map with object key");i<keys.length-1?(null==obj[key]&&(obj[key]={}),obj=obj[key]):obj[key]=options.value}},getMap=function(options){for(var obj=options.map,keys=options.keys,l=keys.length,i=0;i<l;i++){var key=keys[i];if(plainObject(key))throw Error("Tried to get map with object key");if(null==(obj=obj[key]))return obj}return obj},performance=window$1?window$1.performance:null,pnow=performance&&performance.now?function(){return performance.now()}:function(){return Date.now()},raf=function(){if(window$1){if(window$1.requestAnimationFrame)return function(fn){window$1.requestAnimationFrame(fn)};if(window$1.mozRequestAnimationFrame)return function(fn){window$1.mozRequestAnimationFrame(fn)};if(window$1.webkitRequestAnimationFrame)return function(fn){window$1.webkitRequestAnimationFrame(fn)};if(window$1.msRequestAnimationFrame)return function(fn){window$1.msRequestAnimationFrame(fn)}}return function(fn){fn&&setTimeout((function(){fn(pnow())}),1e3/60)}}(),requestAnimationFrame=function(fn){return raf(fn)},performanceNow=pnow,hashIterableInts=function(iterator){for(var entry,seed=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5381,hash=seed;!(entry=iterator.next()).done;)hash=(hash<<5)+hash+entry.value|0;return hash},hashInt=function(num){var seed=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5381;return(seed<<5)+seed+num|0},hashIntsArray=function(ints,seed){var entry={value:0,done:!1},i=0,length=ints.length;return hashIterableInts({next:function(){return i<length?entry.value=ints[i++]:entry.done=!0,entry}},seed)},hashString=function(str,seed){var entry={value:0,done:!1},i=0,length=str.length;return hashIterableInts({next:function(){return i<length?entry.value=str.charCodeAt(i++):entry.done=!0,entry}},seed)},hashStrings=function(){return hashStringsArray(arguments)},hashStringsArray=function(strs){for(var hash,i=0;i<strs.length;i++){var str=strs[i];hash=0===i?hashString(str):hashString(str,hash)}return hash},warningsEnabled=!0,warnSupported=null!=console.warn,traceSupported=null!=console.trace,MAX_INT=Number.MAX_SAFE_INTEGER||9007199254740991,trueify=function(){return!0},falsify=function(){return!1},zeroify=function(){return 0},noop=function(){},error=function(msg){throw new Error(msg)},warnings=function(enabled){if(void 0===enabled)return warningsEnabled;warningsEnabled=!!enabled},warn=function(msg){warnings()&&(warnSupported?console.warn(msg):(console.log(msg),traceSupported&&console.trace()))},copy=function(obj){return null==obj?obj:array(obj)?obj.slice():plainObject(obj)?function(obj){return extend({},obj)}(obj):obj},uuid=function(a,b){for(b=a="";a++<36;b+=51*a&52?(15^a?8^Math.random()*(20^a?16:4):4).toString(16):"-");return b},_staticEmptyObject={},staticEmptyObject=function(){return _staticEmptyObject},defaults=function(_defaults){var keys=Object.keys(_defaults);return function(opts){for(var filledOpts={},i=0;i<keys.length;i++){var key=keys[i],optVal=null==opts?void 0:opts[key];filledOpts[key]=void 0===optVal?_defaults[key]:optVal}return filledOpts}},removeFromArray=function(arr,ele,manyCopies){for(var i=arr.length;i>=0&&(arr[i]!==ele||(arr.splice(i,1),manyCopies));i--);},clearArray=function(arr){arr.splice(0,arr.length)},getPrefixedProperty=function(obj,propName,prefix){return prefix&&(propName=prependCamel(prefix,propName)),obj[propName]},setPrefixedProperty=function(obj,propName,prefix,value){prefix&&(propName=prependCamel(prefix,propName)),obj[propName]=value},Map$1="undefined"!=typeof Map?Map:function(){function ObjectMap(){_classCallCheck(this,ObjectMap),this._obj={}}return _createClass(ObjectMap,[{key:"set",value:function(key,val){return this._obj[key]=val,this}},{key:"delete",value:function(key){return this._obj[key]=void 0,this}},{key:"clear",value:function(){this._obj={}}},{key:"has",value:function(key){return void 0!==this._obj[key]}},{key:"get",value:function(key){return this._obj[key]}}]),ObjectMap}(),ObjectSet=function(){function ObjectSet(arrayOrObjectSet){if(_classCallCheck(this,ObjectSet),this._obj=Object.create(null),this.size=0,null!=arrayOrObjectSet){var arr;arr=null!=arrayOrObjectSet.instanceString&&arrayOrObjectSet.instanceString()===this.instanceString()?arrayOrObjectSet.toArray():arrayOrObjectSet;for(var i=0;i<arr.length;i++)this.add(arr[i])}}return _createClass(ObjectSet,[{key:"instanceString",value:function(){return"set"}},{key:"add",value:function(val){var o=this._obj;1!==o[val]&&(o[val]=1,this.size++)}},{key:"delete",value:function(val){var o=this._obj;1===o[val]&&(o[val]=0,this.size--)}},{key:"clear",value:function(){this._obj=Object.create(null)}},{key:"has",value:function(val){return 1===this._obj[val]}},{key:"toArray",value:function(){var _this=this;return Object.keys(this._obj).filter((function(key){return _this.has(key)}))}},{key:"forEach",value:function(callback,thisArg){return this.toArray().forEach(callback,thisArg)}}]),ObjectSet}(),Set$1="undefined"!==("undefined"==typeof Set?"undefined":_typeof(Set))?Set:ObjectSet,Element=function(cy,params,restore){if(restore=!(void 0!==restore&&!restore),void 0!==cy&&void 0!==params&&core(cy)){var group=params.group;if(null==group&&(group=params.data&&null!=params.data.source&&null!=params.data.target?"edges":"nodes"),"nodes"===group||"edges"===group){this.length=1,this[0]=this;var _p=this._private={cy:cy,single:!0,data:params.data||{},position:params.position||{x:0,y:0},autoWidth:void 0,autoHeight:void 0,autoPadding:void 0,compoundBoundsClean:!1,listeners:[],group:group,style:{},rstyle:{},styleCxts:[],styleKeys:{},removed:!0,selected:!!params.selected,selectable:void 0===params.selectable||!!params.selectable,locked:!!params.locked,grabbed:!1,grabbable:void 0===params.grabbable||!!params.grabbable,pannable:void 0===params.pannable?"edges"===group:!!params.pannable,active:!1,classes:new Set$1,animation:{current:[],queue:[]},rscratch:{},scratch:params.scratch||{},edges:[],children:[],parent:null,traversalCache:{},backgrounding:!1,bbCache:null,bbCacheShift:{x:0,y:0},bodyBounds:null,overlayBounds:null,labelBounds:{all:null,source:null,target:null,main:null},arrowBounds:{source:null,target:null,"mid-source":null,"mid-target":null}};if(null==_p.position.x&&(_p.position.x=0),null==_p.position.y&&(_p.position.y=0),params.renderedPosition){var rpos=params.renderedPosition,pan=cy.pan(),zoom=cy.zoom();_p.position={x:(rpos.x-pan.x)/zoom,y:(rpos.y-pan.y)/zoom}}var classes=[];array(params.classes)?classes=params.classes:string(params.classes)&&(classes=params.classes.split(/\s+/));for(var i=0,l=classes.length;i<l;i++){var cls=classes[i];cls&&""!==cls&&_p.classes.add(cls)}this.createEmitter();var bypass=params.style||params.css;bypass&&(warn("Setting a `style` bypass at element creation is deprecated"),this.style(bypass)),(void 0===restore||restore)&&this.restore()}else error("An element must be of type `nodes` or `edges`; you specified `"+group+"`")}else error("An element must have a core reference and parameters set")},defineSearch=function(params){return params={bfs:params.bfs||!params.dfs,dfs:params.dfs||!params.bfs},function(roots,fn$1,directed){var options;plainObject(roots)&&!elementOrCollection(roots)&&(roots=(options=roots).roots||options.root,fn$1=options.visit,directed=options.directed),directed=2!==arguments.length||fn(fn$1)?directed:fn$1,fn$1=fn(fn$1)?fn$1:function(){};for(var found,cy=this._private.cy,v=roots=string(roots)?this.filter(roots):roots,Q=[],connectedNodes=[],connectedBy={},id2depth={},V={},j=0,_this$byGroup=this.byGroup(),nodes=_this$byGroup.nodes,edges=_this$byGroup.edges,i=0;i<v.length;i++){var vi=v[i],viId=vi.id();vi.isNode()&&(Q.unshift(vi),params.bfs&&(V[viId]=!0,connectedNodes.push(vi)),id2depth[viId]=0)}var _loop2=function(){var v=params.bfs?Q.shift():Q.pop(),vId=v.id();if(params.dfs){if(V[vId])return"continue";V[vId]=!0,connectedNodes.push(v)}var ret,depth=id2depth[vId],prevEdge=connectedBy[vId],src=null!=prevEdge?prevEdge.source():null,tgt=null!=prevEdge?prevEdge.target():null,prevNode=null==prevEdge?void 0:v.same(src)?tgt[0]:src[0];if(!0===(ret=fn$1(v,prevEdge,prevNode,j++,depth)))return found=v,"break";if(!1===ret)return"break";for(var vwEdges=v.connectedEdges().filter((function(e){return(!directed||e.source().same(v))&&edges.has(e)})),_i2=0;_i2<vwEdges.length;_i2++){var e=vwEdges[_i2],w=e.connectedNodes().filter((function(n){return!n.same(v)&&nodes.has(n)})),wId=w.id();0===w.length||V[wId]||(w=w[0],Q.push(w),params.bfs&&(V[wId]=!0,connectedNodes.push(w)),connectedBy[wId]=e,id2depth[wId]=id2depth[vId]+1)}};_loop:for(;0!==Q.length;){var _ret=_loop2();switch(_ret){case"continue":continue;case"break":break _loop}}for(var connectedEles=cy.collection(),_i=0;_i<connectedNodes.length;_i++){var node=connectedNodes[_i],edge=connectedBy[node.id()];null!=edge&&connectedEles.merge(edge),connectedEles.merge(node)}return{path:cy.collection(connectedEles),found:cy.collection(found)}}},elesfn={breadthFirstSearch:defineSearch({bfs:!0}),depthFirstSearch:defineSearch({dfs:!0})};elesfn.bfs=elesfn.breadthFirstSearch,elesfn.dfs=elesfn.depthFirstSearch;var dijkstraDefaults=defaults({root:null,weight:function(edge){return 1},directed:!1}),elesfn$1={dijkstra:function(options){if(!plainObject(options)){var args=arguments;options={root:args[0],weight:args[1],directed:args[2]}}var _dijkstraDefaults=dijkstraDefaults(options),root=_dijkstraDefaults.root,weight=_dijkstraDefaults.weight,directed=_dijkstraDefaults.directed,eles=this,weightFn=weight,source=string(root)?this.filter(root)[0]:root[0],dist={},prev={},knownDist={},_this$byGroup=this.byGroup(),nodes=_this$byGroup.nodes,edges=_this$byGroup.edges;edges.unmergeBy((function(ele){return ele.isLoop()}));for(var getDist=function(node){return dist[node.id()]},setDist=function(node,d){dist[node.id()]=d,Q.updateItem(node)},Q=new Heap((function(a,b){return getDist(a)-getDist(b)})),i=0;i<nodes.length;i++){var node=nodes[i];dist[node.id()]=node.same(source)?0:1/0,Q.push(node)}for(var distBetween=function(u,v){for(var smallestEdge,uvs=(directed?u.edgesTo(v):u.edgesWith(v)).intersect(edges),smallestDistance=1/0,_i=0;_i<uvs.length;_i++){var edge=uvs[_i],_weight=weightFn(edge);(_weight<smallestDistance||!smallestEdge)&&(smallestDistance=_weight,smallestEdge=edge)}return{edge:smallestEdge,dist:smallestDistance}};Q.size()>0;){var u=Q.pop(),smalletsDist=getDist(u),uid=u.id();if(knownDist[uid]=smalletsDist,smalletsDist!==1/0)for(var neighbors=u.neighborhood().intersect(nodes),_i2=0;_i2<neighbors.length;_i2++){var v=neighbors[_i2],vid=v.id(),vDist=distBetween(u,v),alt=smalletsDist+vDist.dist;alt<getDist(v)&&(setDist(v,alt),prev[vid]={node:u,edge:vDist.edge})}}return{distanceTo:function(node){var target=string(node)?nodes.filter(node)[0]:node[0];return knownDist[target.id()]},pathTo:function(node){var target=string(node)?nodes.filter(node)[0]:node[0],S=[],u=target,uid=u.id();if(target.length>0)for(S.unshift(target);prev[uid];){var p=prev[uid];S.unshift(p.edge),S.unshift(p.node),uid=(u=p.node).id()}return eles.spawn(S)}}}},elesfn$2={kruskal:function(weightFn){weightFn=weightFn||function(edge){return 1};for(var _this$byGroup=this.byGroup(),nodes=_this$byGroup.nodes,edges=_this$byGroup.edges,numNodes=nodes.length,forest=new Array(numNodes),A=nodes,findSetIndex=function(ele){for(var i=0;i<forest.length;i++){if(forest[i].has(ele))return i}},i=0;i<numNodes;i++)forest[i]=this.spawn(nodes[i]);for(var S=edges.sort((function(a,b){return weightFn(a)-weightFn(b)})),_i=0;_i<S.length;_i++){var edge=S[_i],u=edge.source()[0],v=edge.target()[0],setUIndex=findSetIndex(u),setVIndex=findSetIndex(v),setU=forest[setUIndex],setV=forest[setVIndex];setUIndex!==setVIndex&&(A.merge(edge),setU.merge(setV),forest.splice(setVIndex,1))}return A}},aStarDefaults=defaults({root:null,goal:null,weight:function(edge){return 1},heuristic:function(edge){return 0},directed:!1}),elesfn$3={aStar:function(options){var cy=this.cy(),_aStarDefaults=aStarDefaults(options),root=_aStarDefaults.root,goal=_aStarDefaults.goal,heuristic=_aStarDefaults.heuristic,directed=_aStarDefaults.directed,weight=_aStarDefaults.weight;root=cy.collection(root)[0],goal=cy.collection(goal)[0];var cMin,cMinId,sid=root.id(),tid=goal.id(),gScore={},fScore={},closedSetIds={},openSet=new Heap((function(a,b){return fScore[a.id()]-fScore[b.id()]})),openSetIds=new Set$1,cameFrom={},cameFromEdge={},addToOpenSet=function(ele,id){openSet.push(ele),openSetIds.add(id)};addToOpenSet(root,sid),gScore[sid]=0,fScore[sid]=heuristic(root);for(var id,steps=0;openSet.size()>0;){if(cMin=openSet.pop(),cMinId=cMin.id(),openSetIds.delete(cMinId),steps++,cMinId===tid){for(var path=[],pathNode=goal,pathNodeId=tid,pathEdge=cameFromEdge[pathNodeId];path.unshift(pathNode),null!=pathEdge&&path.unshift(pathEdge),null!=(pathNode=cameFrom[pathNodeId]);)pathEdge=cameFromEdge[pathNodeId=pathNode.id()];return{found:!0,distance:gScore[cMinId],path:this.spawn(path),steps:steps}}closedSetIds[cMinId]=!0;for(var vwEdges=cMin._private.edges,i=0;i<vwEdges.length;i++){var e=vwEdges[i];if(this.hasElementWithId(e.id())&&(!directed||e.data("source")===cMinId)){var wSrc=e.source(),wTgt=e.target(),w=wSrc.id()!==cMinId?wSrc:wTgt,wid=w.id();if(this.hasElementWithId(wid)&&!closedSetIds[wid]){var tempScore=gScore[cMinId]+weight(e);id=wid,openSetIds.has(id)?tempScore<gScore[wid]&&(gScore[wid]=tempScore,fScore[wid]=tempScore+heuristic(w),cameFrom[wid]=cMin):(gScore[wid]=tempScore,fScore[wid]=tempScore+heuristic(w),addToOpenSet(w,wid),cameFrom[wid]=cMin,cameFromEdge[wid]=e)}}}}return{found:!1,distance:void 0,path:void 0,steps:steps}}},floydWarshallDefaults=defaults({weight:function(edge){return 1},directed:!1}),elesfn$4={floydWarshall:function(options){for(var cy=this.cy(),_floydWarshallDefault=floydWarshallDefaults(options),weight=_floydWarshallDefault.weight,directed=_floydWarshallDefault.directed,weightFn=weight,_this$byGroup=this.byGroup(),nodes=_this$byGroup.nodes,edges=_this$byGroup.edges,N=nodes.length,Nsq=N*N,indexOf=function(node){return nodes.indexOf(node)},atIndex=function(i){return nodes[i]},dist=new Array(Nsq),n=0;n<Nsq;n++){var j=n%N,i=(n-j)/N;dist[n]=i===j?0:1/0}for(var next=new Array(Nsq),edgeNext=new Array(Nsq),_i=0;_i<edges.length;_i++){var edge=edges[_i],src=edge.source()[0],tgt=edge.target()[0];if(src!==tgt){var s=indexOf(src),t=indexOf(tgt),st=s*N+t,_weight=weightFn(edge);if(dist[st]>_weight&&(dist[st]=_weight,next[st]=t,edgeNext[st]=edge),!directed){var ts=t*N+s;!directed&&dist[ts]>_weight&&(dist[ts]=_weight,next[ts]=s,edgeNext[ts]=edge)}}}for(var k=0;k<N;k++)for(var _i2=0;_i2<N;_i2++)for(var ik=_i2*N+k,_j=0;_j<N;_j++){var ij=_i2*N+_j,kj=k*N+_j;dist[ik]+dist[kj]<dist[ij]&&(dist[ij]=dist[ik]+dist[kj],next[ij]=next[ik])}var indexOfArgEle=function(ele){return indexOf(function(ele){return(string(ele)?cy.filter(ele):ele)[0]}(ele))};return{distance:function(from,to){var i=indexOfArgEle(from),j=indexOfArgEle(to);return dist[i*N+j]},path:function(from,to){var i=indexOfArgEle(from),j=indexOfArgEle(to),fromNode=atIndex(i);if(i===j)return fromNode.collection();if(null==next[i*N+j])return cy.collection();var edge,path=cy.collection(),prev=i;for(path.merge(fromNode);i!==j;)prev=i,i=next[i*N+j],edge=edgeNext[prev*N+i],path.merge(edge),path.merge(atIndex(i));return path}}}},bellmanFordDefaults=defaults({weight:function(edge){return 1},directed:!1,root:null}),elesfn$5={bellmanFord:function(options){var _this=this,_bellmanFordDefaults=bellmanFordDefaults(options),weight=_bellmanFordDefaults.weight,directed=_bellmanFordDefaults.directed,root=_bellmanFordDefaults.root,weightFn=weight,eles=this,cy=this.cy(),_this$byGroup=this.byGroup(),edges=_this$byGroup.edges,nodes=_this$byGroup.nodes,numNodes=nodes.length,infoMap=new Map$1,hasNegativeWeightCycle=!1;root=cy.collection(root)[0],edges.unmergeBy((function(edge){return edge.isLoop()}));for(var numEdges=edges.length,getInfo=function(node){var obj=infoMap.get(node.id());return obj||(obj={},infoMap.set(node.id(),obj)),obj},getNodeFromTo=function(to){return(string(to)?cy.$(to):to)[0]},i=0;i<numNodes;i++){var node=nodes[i],info=getInfo(node);node.same(root)?info.dist=0:info.dist=1/0,info.pred=null,info.edge=null}for(var replacedEdge=!1,checkForEdgeReplacement=function(node1,node2,edge,info1,info2,weight){var dist=info1.dist+weight;dist<info2.dist&&!edge.same(info1.edge)&&(info2.dist=dist,info2.pred=node1,info2.edge=edge,replacedEdge=!0)},_i=1;_i<numNodes;_i++){replacedEdge=!1;for(var e=0;e<numEdges;e++){var edge=edges[e],src=edge.source(),tgt=edge.target(),_weight=weightFn(edge),srcInfo=getInfo(src),tgtInfo=getInfo(tgt);checkForEdgeReplacement(src,0,edge,srcInfo,tgtInfo,_weight),directed||checkForEdgeReplacement(tgt,0,edge,tgtInfo,srcInfo,_weight)}if(!replacedEdge)break}if(replacedEdge)for(var _e=0;_e<numEdges;_e++){var _edge=edges[_e],_src=_edge.source(),_tgt=_edge.target(),_weight2=weightFn(_edge),srcDist=getInfo(_src).dist,tgtDist=getInfo(_tgt).dist;if(srcDist+_weight2<tgtDist||!directed&&tgtDist+_weight2<srcDist){warn("Graph contains a negative weight cycle for Bellman-Ford"),hasNegativeWeightCycle=!0;break}}return{distanceTo:function(to){return getInfo(getNodeFromTo(to)).dist},pathTo:function(to){for(var thisStart=arguments.length>1&&void 0!==arguments[1]?arguments[1]:root,end=getNodeFromTo(to),path=[],node=end;;){if(null==node)return _this.spawn();var _getInfo=getInfo(node),edge=_getInfo.edge,pred=_getInfo.pred;if(path.unshift(node[0]),node.same(thisStart)&&path.length>0)break;null!=edge&&path.unshift(edge),node=pred}return eles.spawn(path)},hasNegativeWeightCycle:hasNegativeWeightCycle,negativeWeightCycles:[]}}},sqrt2=Math.sqrt(2),collapse=function(edgeIndex,nodeMap,remainingEdges){0===remainingEdges.length&&error("Karger-Stein must be run on a connected (sub)graph");for(var edgeInfo=remainingEdges[edgeIndex],sourceIn=edgeInfo[1],targetIn=edgeInfo[2],partition1=nodeMap[sourceIn],partition2=nodeMap[targetIn],newEdges=remainingEdges,i=newEdges.length-1;i>=0;i--){var edge=newEdges[i],src=edge[1],tgt=edge[2];(nodeMap[src]===partition1&&nodeMap[tgt]===partition2||nodeMap[src]===partition2&&nodeMap[tgt]===partition1)&&newEdges.splice(i,1)}for(var _i=0;_i<newEdges.length;_i++){var _edge=newEdges[_i];_edge[1]===partition2?(newEdges[_i]=_edge.slice(),newEdges[_i][1]=partition1):_edge[2]===partition2&&(newEdges[_i]=_edge.slice(),newEdges[_i][2]=partition1)}for(var _i2=0;_i2<nodeMap.length;_i2++)nodeMap[_i2]===partition2&&(nodeMap[_i2]=partition1);return newEdges},contractUntil=function(metaNodeMap,remainingEdges,size,sizeLimit){for(;size>sizeLimit;){var edgeIndex=Math.floor(Math.random()*remainingEdges.length);remainingEdges=collapse(edgeIndex,metaNodeMap,remainingEdges),size--}return remainingEdges},elesfn$6={kargerStein:function(){var _this$byGroup=this.byGroup(),nodes=_this$byGroup.nodes,edges=_this$byGroup.edges;edges.unmergeBy((function(edge){return edge.isLoop()}));var numNodes=nodes.length,numEdges=edges.length,numIter=Math.ceil(Math.pow(Math.log(numNodes)/Math.LN2,2)),stopSize=Math.floor(numNodes/sqrt2);if(!(numNodes<2)){for(var edgeIndexes=[],i=0;i<numEdges;i++){var e=edges[i];edgeIndexes.push([i,nodes.indexOf(e.source()),nodes.indexOf(e.target())])}for(var minCutSize=1/0,minCutEdgeIndexes=[],minCutNodeMap=new Array(numNodes),metaNodeMap=new Array(numNodes),metaNodeMap2=new Array(numNodes),copyNodesMap=function(from,to){for(var _i3=0;_i3<numNodes;_i3++)to[_i3]=from[_i3]},iter=0;iter<=numIter;iter++){for(var _i4=0;_i4<numNodes;_i4++)metaNodeMap[_i4]=_i4;var edgesState=contractUntil(metaNodeMap,edgeIndexes.slice(),numNodes,stopSize),edgesState2=edgesState.slice();copyNodesMap(metaNodeMap,metaNodeMap2);var res1=contractUntil(metaNodeMap,edgesState,stopSize,2),res2=contractUntil(metaNodeMap2,edgesState2,stopSize,2);res1.length<=res2.length&&res1.length<minCutSize?(minCutSize=res1.length,minCutEdgeIndexes=res1,copyNodesMap(metaNodeMap,minCutNodeMap)):res2.length<=res1.length&&res2.length<minCutSize&&(minCutSize=res2.length,minCutEdgeIndexes=res2,copyNodesMap(metaNodeMap2,minCutNodeMap))}for(var cut=this.spawn(minCutEdgeIndexes.map((function(e){return edges[e[0]]}))),partition1=this.spawn(),partition2=this.spawn(),witnessNodePartition=minCutNodeMap[0],_i5=0;_i5<minCutNodeMap.length;_i5++){var partitionId=minCutNodeMap[_i5],node=nodes[_i5];partitionId===witnessNodePartition?partition1.merge(node):partition2.merge(node)}return{cut:cut,partition1:partition1,partition2:partition2}}error("At least 2 nodes are required for Karger-Stein algorithm")}},modelToRenderedPosition=function(p,zoom,pan){return{x:p.x*zoom+pan.x,y:p.y*zoom+pan.y}},renderedToModelPosition=function(p,zoom,pan){return{x:(p.x-pan.x)/zoom,y:(p.y-pan.y)/zoom}},array2point=function(arr){return{x:arr[0],y:arr[1]}},getAngleFromDisp=function(dispX,dispY){return Math.atan2(dispY,dispX)-Math.PI/2},log2=Math.log2||function(n){return Math.log(n)/Math.log(2)},signum=function(x){return x>0?1:x<0?-1:0},dist=function(p1,p2){return Math.sqrt(sqdist(p1,p2))},sqdist=function(p1,p2){var dx=p2.x-p1.x,dy=p2.y-p1.y;return dx*dx+dy*dy},inPlaceSumNormalize=function(v){for(var length=v.length,total=0,i=0;i<length;i++)total+=v[i];for(var _i=0;_i<length;_i++)v[_i]=v[_i]/total;return v},qbezierAt=function(p0,p1,p2,t){return(1-t)*(1-t)*p0+2*(1-t)*t*p1+t*t*p2},qbezierPtAt=function(p0,p1,p2,t){return{x:qbezierAt(p0.x,p1.x,p2.x,t),y:qbezierAt(p0.y,p1.y,p2.y,t)}},bound=function(min,val,max){return Math.max(min,Math.min(max,val))},makeBoundingBox=function(bb){if(null==bb)return{x1:1/0,y1:1/0,x2:-1/0,y2:-1/0,w:0,h:0};if(null!=bb.x1&&null!=bb.y1){if(null!=bb.x2&&null!=bb.y2&&bb.x2>=bb.x1&&bb.y2>=bb.y1)return{x1:bb.x1,y1:bb.y1,x2:bb.x2,y2:bb.y2,w:bb.x2-bb.x1,h:bb.y2-bb.y1};if(null!=bb.w&&null!=bb.h&&bb.w>=0&&bb.h>=0)return{x1:bb.x1,y1:bb.y1,x2:bb.x1+bb.w,y2:bb.y1+bb.h,w:bb.w,h:bb.h}}},expandBoundingBoxByPoint=function(bb,x,y){bb.x1=Math.min(bb.x1,x),bb.x2=Math.max(bb.x2,x),bb.w=bb.x2-bb.x1,bb.y1=Math.min(bb.y1,y),bb.y2=Math.max(bb.y2,y),bb.h=bb.y2-bb.y1},expandBoundingBox=function(bb){var padding=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return bb.x1-=padding,bb.x2+=padding,bb.y1-=padding,bb.y2+=padding,bb.w=bb.x2-bb.x1,bb.h=bb.y2-bb.y1,bb},expandBoundingBoxSides=function(bb){var top,right,bottom,left,padding=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0];if(1===padding.length)top=right=bottom=left=padding[0];else if(2===padding.length)top=bottom=padding[0],left=right=padding[1];else if(4===padding.length){var _padding=_slicedToArray(padding,4);top=_padding[0],right=_padding[1],bottom=_padding[2],left=_padding[3]}return bb.x1-=left,bb.x2+=right,bb.y1-=top,bb.y2+=bottom,bb.w=bb.x2-bb.x1,bb.h=bb.y2-bb.y1,bb},assignBoundingBox=function(bb1,bb2){bb1.x1=bb2.x1,bb1.y1=bb2.y1,bb1.x2=bb2.x2,bb1.y2=bb2.y2,bb1.w=bb1.x2-bb1.x1,bb1.h=bb1.y2-bb1.y1},assignShiftToBoundingBox=function(bb,delta){bb.x1+=delta.x,bb.x2+=delta.x,bb.y1+=delta.y,bb.y2+=delta.y},boundingBoxesIntersect=function(bb1,bb2){return!(bb1.x1>bb2.x2)&&(!(bb2.x1>bb1.x2)&&(!(bb1.x2<bb2.x1)&&(!(bb2.x2<bb1.x1)&&(!(bb1.y2<bb2.y1)&&(!(bb2.y2<bb1.y1)&&(!(bb1.y1>bb2.y2)&&!(bb2.y1>bb1.y2)))))))},inBoundingBox=function(bb,x,y){return bb.x1<=x&&x<=bb.x2&&bb.y1<=y&&y<=bb.y2},boundingBoxInBoundingBox=function(bb1,bb2){return inBoundingBox(bb1,bb2.x1,bb2.y1)&&inBoundingBox(bb1,bb2.x2,bb2.y2)},roundRectangleIntersectLine=function(x,y,nodeX,nodeY,width,height,padding){var straightLineIntersections,cornerRadius=getRoundRectangleRadius(width,height),halfWidth=width/2,halfHeight=height/2,topStartY=nodeY-halfHeight-padding;if((straightLineIntersections=finiteLinesIntersect(x,y,nodeX,nodeY,nodeX-halfWidth+cornerRadius-padding,topStartY,nodeX+halfWidth-cornerRadius+padding,topStartY,!1)).length>0)return straightLineIntersections;var rightStartX=nodeX+halfWidth+padding;if((straightLineIntersections=finiteLinesIntersect(x,y,nodeX,nodeY,rightStartX,nodeY-halfHeight+cornerRadius-padding,rightStartX,nodeY+halfHeight-cornerRadius+padding,!1)).length>0)return straightLineIntersections;var bottomStartY=nodeY+halfHeight+padding;if((straightLineIntersections=finiteLinesIntersect(x,y,nodeX,nodeY,nodeX-halfWidth+cornerRadius-padding,bottomStartY,nodeX+halfWidth-cornerRadius+padding,bottomStartY,!1)).length>0)return straightLineIntersections;var arcIntersections,leftStartX=nodeX-halfWidth-padding;if((straightLineIntersections=finiteLinesIntersect(x,y,nodeX,nodeY,leftStartX,nodeY-halfHeight+cornerRadius-padding,leftStartX,nodeY+halfHeight-cornerRadius+padding,!1)).length>0)return straightLineIntersections;var topLeftCenterX=nodeX-halfWidth+cornerRadius,topLeftCenterY=nodeY-halfHeight+cornerRadius;if((arcIntersections=intersectLineCircle(x,y,nodeX,nodeY,topLeftCenterX,topLeftCenterY,cornerRadius+padding)).length>0&&arcIntersections[0]<=topLeftCenterX&&arcIntersections[1]<=topLeftCenterY)return[arcIntersections[0],arcIntersections[1]];var topRightCenterX=nodeX+halfWidth-cornerRadius,topRightCenterY=nodeY-halfHeight+cornerRadius;if((arcIntersections=intersectLineCircle(x,y,nodeX,nodeY,topRightCenterX,topRightCenterY,cornerRadius+padding)).length>0&&arcIntersections[0]>=topRightCenterX&&arcIntersections[1]<=topRightCenterY)return[arcIntersections[0],arcIntersections[1]];var bottomRightCenterX=nodeX+halfWidth-cornerRadius,bottomRightCenterY=nodeY+halfHeight-cornerRadius;if((arcIntersections=intersectLineCircle(x,y,nodeX,nodeY,bottomRightCenterX,bottomRightCenterY,cornerRadius+padding)).length>0&&arcIntersections[0]>=bottomRightCenterX&&arcIntersections[1]>=bottomRightCenterY)return[arcIntersections[0],arcIntersections[1]];var bottomLeftCenterX=nodeX-halfWidth+cornerRadius,bottomLeftCenterY=nodeY+halfHeight-cornerRadius;return(arcIntersections=intersectLineCircle(x,y,nodeX,nodeY,bottomLeftCenterX,bottomLeftCenterY,cornerRadius+padding)).length>0&&arcIntersections[0]<=bottomLeftCenterX&&arcIntersections[1]>=bottomLeftCenterY?[arcIntersections[0],arcIntersections[1]]:[]},inLineVicinity=function(x,y,lx1,ly1,lx2,ly2,tolerance){var t=tolerance,x1=Math.min(lx1,lx2),x2=Math.max(lx1,lx2),y1=Math.min(ly1,ly2),y2=Math.max(ly1,ly2);return x1-t<=x&&x<=x2+t&&y1-t<=y&&y<=y2+t},inBezierVicinity=function(x,y,x1,y1,x2,y2,x3,y3,tolerance){var bb_x1=Math.min(x1,x3,x2)-tolerance,bb_x2=Math.max(x1,x3,x2)+tolerance,bb_y1=Math.min(y1,y3,y2)-tolerance,bb_y2=Math.max(y1,y3,y2)+tolerance;return!(x<bb_x1||x>bb_x2||y<bb_y1||y>bb_y2)},sqdistToQuadraticBezier=function(x,y,x1,y1,x2,y2,x3,y3){var roots=[];!function(a,b,c,d,result){var discriminant,q,r,dum1,s,t,term1,r13;0===a&&(a=1e-5),r=-27*(d/=a)+(b/=a)*(9*(c/=a)-b*b*2),discriminant=(q=(3*c-b*b)/9)*q*q+(r/=54)*r,result[1]=0,term1=b/3,discriminant>0?(s=(s=r+Math.sqrt(discriminant))<0?-Math.pow(-s,1/3):Math.pow(s,1/3),t=(t=r-Math.sqrt(discriminant))<0?-Math.pow(-t,1/3):Math.pow(t,1/3),result[0]=-term1+s+t,term1+=(s+t)/2,result[4]=result[2]=-term1,term1=Math.sqrt(3)*(-t+s)/2,result[3]=term1,result[5]=-term1):(result[5]=result[3]=0,0===discriminant?(r13=r<0?-Math.pow(-r,1/3):Math.pow(r,1/3),result[0]=2*r13-term1,result[4]=result[2]=-(r13+term1)):(dum1=(q=-q)*q*q,dum1=Math.acos(r/Math.sqrt(dum1)),r13=2*Math.sqrt(q),result[0]=-term1+r13*Math.cos(dum1/3),result[2]=-term1+r13*Math.cos((dum1+2*Math.PI)/3),result[4]=-term1+r13*Math.cos((dum1+4*Math.PI)/3)))}(1*x1*x1-4*x1*x2+2*x1*x3+4*x2*x2-4*x2*x3+x3*x3+y1*y1-4*y1*y2+2*y1*y3+4*y2*y2-4*y2*y3+y3*y3,9*x1*x2-3*x1*x1-3*x1*x3-6*x2*x2+3*x2*x3+9*y1*y2-3*y1*y1-3*y1*y3-6*y2*y2+3*y2*y3,3*x1*x1-6*x1*x2+x1*x3-x1*x+2*x2*x2+2*x2*x-x3*x+3*y1*y1-6*y1*y2+y1*y3-y1*y+2*y2*y2+2*y2*y-y3*y,1*x1*x2-x1*x1+x1*x-x2*x+y1*y2-y1*y1+y1*y-y2*y,roots);for(var params=[],index=0;index<6;index+=2)Math.abs(roots[index+1])<1e-7&&roots[index]>=0&&roots[index]<=1&&params.push(roots[index]);params.push(1),params.push(0);for(var curX,curY,distSquared,minDistanceSquared=-1,i=0;i<params.length;i++)curX=Math.pow(1-params[i],2)*x1+2*(1-params[i])*params[i]*x2+params[i]*params[i]*x3,curY=Math.pow(1-params[i],2)*y1+2*(1-params[i])*params[i]*y2+params[i]*params[i]*y3,distSquared=Math.pow(curX-x,2)+Math.pow(curY-y,2),minDistanceSquared>=0?distSquared<minDistanceSquared&&(minDistanceSquared=distSquared):minDistanceSquared=distSquared;return minDistanceSquared},sqdistToFiniteLine=function(x,y,x1,y1,x2,y2){var offset=[x-x1,y-y1],line=[x2-x1,y2-y1],lineSq=line[0]*line[0]+line[1]*line[1],hypSq=offset[0]*offset[0]+offset[1]*offset[1],dotProduct=offset[0]*line[0]+offset[1]*line[1],adjSq=dotProduct*dotProduct/lineSq;return dotProduct<0?hypSq:adjSq>lineSq?(x-x2)*(x-x2)+(y-y2)*(y-y2):hypSq-adjSq},pointInsidePolygonPoints=function(x,y,points){for(var x1,y1,x2,y2,up=0,i=0;i<points.length/2;i++)if(x1=points[2*i],y1=points[2*i+1],i+1<points.length/2?(x2=points[2*(i+1)],y2=points[2*(i+1)+1]):(x2=points[2*(i+1-points.length/2)],y2=points[2*(i+1-points.length/2)+1]),x1==x&&x2==x);else{if(!(x1>=x&&x>=x2||x1<=x&&x<=x2))continue;(x-x1)/(x2-x1)*(y2-y1)+y1>y&&up++}return up%2!=0},pointInsidePolygon=function(x,y,basePoints,centerX,centerY,width,height,direction,padding){var angle,transformedPoints=new Array(basePoints.length);null!=direction[0]?(angle=Math.atan(direction[1]/direction[0]),direction[0]<0?angle+=Math.PI/2:angle=-angle-Math.PI/2):angle=direction;for(var points,cos=Math.cos(-angle),sin=Math.sin(-angle),i=0;i<transformedPoints.length/2;i++)transformedPoints[2*i]=width/2*(basePoints[2*i]*cos-basePoints[2*i+1]*sin),transformedPoints[2*i+1]=height/2*(basePoints[2*i+1]*cos+basePoints[2*i]*sin),transformedPoints[2*i]+=centerX,transformedPoints[2*i+1]+=centerY;if(padding>0){var expandedLineSet=expandPolygon(transformedPoints,-padding);points=joinLines(expandedLineSet)}else points=transformedPoints;return pointInsidePolygonPoints(x,y,points)},joinLines=function(lineSet){for(var currentLineStartX,currentLineStartY,currentLineEndX,currentLineEndY,nextLineStartX,nextLineStartY,nextLineEndX,nextLineEndY,vertices=new Array(lineSet.length/2),i=0;i<lineSet.length/4;i++){currentLineStartX=lineSet[4*i],currentLineStartY=lineSet[4*i+1],currentLineEndX=lineSet[4*i+2],currentLineEndY=lineSet[4*i+3],i<lineSet.length/4-1?(nextLineStartX=lineSet[4*(i+1)],nextLineStartY=lineSet[4*(i+1)+1],nextLineEndX=lineSet[4*(i+1)+2],nextLineEndY=lineSet[4*(i+1)+3]):(nextLineStartX=lineSet[0],nextLineStartY=lineSet[1],nextLineEndX=lineSet[2],nextLineEndY=lineSet[3]);var intersection=finiteLinesIntersect(currentLineStartX,currentLineStartY,currentLineEndX,currentLineEndY,nextLineStartX,nextLineStartY,nextLineEndX,nextLineEndY,!0);vertices[2*i]=intersection[0],vertices[2*i+1]=intersection[1]}return vertices},expandPolygon=function(points,pad){for(var currentPointX,currentPointY,nextPointX,nextPointY,expandedLineSet=new Array(2*points.length),i=0;i<points.length/2;i++){currentPointX=points[2*i],currentPointY=points[2*i+1],i<points.length/2-1?(nextPointX=points[2*(i+1)],nextPointY=points[2*(i+1)+1]):(nextPointX=points[0],nextPointY=points[1]);var offsetX=nextPointY-currentPointY,offsetY=-(nextPointX-currentPointX),offsetLength=Math.sqrt(offsetX*offsetX+offsetY*offsetY),normalizedOffsetX=offsetX/offsetLength,normalizedOffsetY=offsetY/offsetLength;expandedLineSet[4*i]=currentPointX+normalizedOffsetX*pad,expandedLineSet[4*i+1]=currentPointY+normalizedOffsetY*pad,expandedLineSet[4*i+2]=nextPointX+normalizedOffsetX*pad,expandedLineSet[4*i+3]=nextPointY+normalizedOffsetY*pad}return expandedLineSet},checkInEllipse=function(x,y,width,height,centerX,centerY,padding){return x-=centerX,y-=centerY,(x/=width/2+padding)*x+(y/=height/2+padding)*y<=1},intersectLineCircle=function(x1,y1,x2,y2,centerX,centerY,radius){var d=[x2-x1,y2-y1],f=[x1-centerX,y1-centerY],a=d[0]*d[0]+d[1]*d[1],b=2*(f[0]*d[0]+f[1]*d[1]),discriminant=b*b-4*a*(f[0]*f[0]+f[1]*f[1]-radius*radius);if(discriminant<0)return[];var t1=(-b+Math.sqrt(discriminant))/(2*a),t2=(-b-Math.sqrt(discriminant))/(2*a),tMin=Math.min(t1,t2),tMax=Math.max(t1,t2),inRangeParams=[];if(tMin>=0&&tMin<=1&&inRangeParams.push(tMin),tMax>=0&&tMax<=1&&inRangeParams.push(tMax),0===inRangeParams.length)return[];var nearIntersectionX=inRangeParams[0]*d[0]+x1,nearIntersectionY=inRangeParams[0]*d[1]+y1;return inRangeParams.length>1?inRangeParams[0]==inRangeParams[1]?[nearIntersectionX,nearIntersectionY]:[nearIntersectionX,nearIntersectionY,inRangeParams[1]*d[0]+x1,inRangeParams[1]*d[1]+y1]:[nearIntersectionX,nearIntersectionY]},midOfThree=function(a,b,c){return b<=a&&a<=c||c<=a&&a<=b?a:a<=b&&b<=c||c<=b&&b<=a?b:c},finiteLinesIntersect=function(x1,y1,x2,y2,x3,y3,x4,y4,infiniteLines){var dx13=x1-x3,dx21=x2-x1,dx43=x4-x3,dy13=y1-y3,dy21=y2-y1,dy43=y4-y3,ua_t=dx43*dy13-dy43*dx13,ub_t=dx21*dy13-dy21*dx13,u_b=dy43*dx21-dx43*dy21;if(0!==u_b){var ua=ua_t/u_b,ub=ub_t/u_b;return-.001<=ua&&ua<=1.001&&-.001<=ub&&ub<=1.001||infiniteLines?[x1+ua*dx21,y1+ua*dy21]:[]}return 0===ua_t||0===ub_t?midOfThree(x1,x2,x4)===x4?[x4,y4]:midOfThree(x1,x2,x3)===x3?[x3,y3]:midOfThree(x3,x4,x2)===x2?[x2,y2]:[]:[]},polygonIntersectLine=function(x,y,basePoints,centerX,centerY,width,height,padding){var intersection,points,currentX,currentY,nextX,nextY,intersections=[],transformedPoints=new Array(basePoints.length),doTransform=!0;if(null==width&&(doTransform=!1),doTransform){for(var i=0;i<transformedPoints.length/2;i++)transformedPoints[2*i]=basePoints[2*i]*width+centerX,transformedPoints[2*i+1]=basePoints[2*i+1]*height+centerY;if(padding>0){var expandedLineSet=expandPolygon(transformedPoints,-padding);points=joinLines(expandedLineSet)}else points=transformedPoints}else points=basePoints;for(var _i2=0;_i2<points.length/2;_i2++)currentX=points[2*_i2],currentY=points[2*_i2+1],_i2<points.length/2-1?(nextX=points[2*(_i2+1)],nextY=points[2*(_i2+1)+1]):(nextX=points[0],nextY=points[1]),0!==(intersection=finiteLinesIntersect(x,y,centerX,centerY,currentX,currentY,nextX,nextY)).length&&intersections.push(intersection[0],intersection[1]);return intersections},shortenIntersection=function(intersection,offset,amount){var disp=[intersection[0]-offset[0],intersection[1]-offset[1]],length=Math.sqrt(disp[0]*disp[0]+disp[1]*disp[1]),lenRatio=(length-amount)/length;return lenRatio<0&&(lenRatio=1e-5),[offset[0]+lenRatio*disp[0],offset[1]+lenRatio*disp[1]]},generateUnitNgonPointsFitToSquare=function(sides,rotationRadians){var points=generateUnitNgonPoints(sides,rotationRadians);return points=fitPolygonToSquare(points)},fitPolygonToSquare=function(points){for(var x,y,sides=points.length/2,minX=1/0,minY=1/0,maxX=-1/0,maxY=-1/0,i=0;i<sides;i++)x=points[2*i],y=points[2*i+1],minX=Math.min(minX,x),maxX=Math.max(maxX,x),minY=Math.min(minY,y),maxY=Math.max(maxY,y);for(var sx=2/(maxX-minX),sy=2/(maxY-minY),_i3=0;_i3<sides;_i3++)x=points[2*_i3]=points[2*_i3]*sx,y=points[2*_i3+1]=points[2*_i3+1]*sy,minX=Math.min(minX,x),maxX=Math.max(maxX,x),minY=Math.min(minY,y),maxY=Math.max(maxY,y);if(minY<-1)for(var _i4=0;_i4<sides;_i4++)y=points[2*_i4+1]=points[2*_i4+1]+(-1-minY);return points},generateUnitNgonPoints=function(sides,rotationRadians){var increment=1/sides*2*Math.PI,startAngle=sides%2==0?Math.PI/2+increment/2:Math.PI/2;startAngle+=rotationRadians;for(var currentAngle,points=new Array(2*sides),i=0;i<sides;i++)currentAngle=i*increment+startAngle,points[2*i]=Math.cos(currentAngle),points[2*i+1]=Math.sin(-currentAngle);return points},getRoundRectangleRadius=function(width,height){return Math.min(width/4,height/4,8)},getBarrelCurveConstants=function(width,height){return{heightOffset:Math.min(15,.05*height),widthOffset:Math.min(100,.25*width),ctrlPtOffsetPct:.05}},pageRankDefaults=defaults({dampingFactor:.8,precision:1e-6,iterations:200,weight:function(edge){return 1}}),elesfn$7={pageRank:function(options){for(var _pageRankDefaults=pageRankDefaults(options),dampingFactor=_pageRankDefaults.dampingFactor,precision=_pageRankDefaults.precision,iterations=_pageRankDefaults.iterations,weight=_pageRankDefaults.weight,cy=this._private.cy,_this$byGroup=this.byGroup(),nodes=_this$byGroup.nodes,edges=_this$byGroup.edges,numNodes=nodes.length,numNodesSqd=numNodes*numNodes,numEdges=edges.length,matrix=new Array(numNodesSqd),columnSum=new Array(numNodes),additionalProb=(1-dampingFactor)/numNodes,i=0;i<numNodes;i++){for(var j=0;j<numNodes;j++){matrix[i*numNodes+j]=0}columnSum[i]=0}for(var _i=0;_i<numEdges;_i++){var edge=edges[_i],srcId=edge.data("source"),tgtId=edge.data("target");if(srcId!==tgtId){var s=nodes.indexOfId(srcId),t=nodes.indexOfId(tgtId),w=weight(edge);matrix[t*numNodes+s]+=w,columnSum[s]+=w}}for(var p=1/numNodes+additionalProb,_j=0;_j<numNodes;_j++)if(0===columnSum[_j])for(var _i2=0;_i2<numNodes;_i2++){matrix[_i2*numNodes+_j]=p}else for(var _i3=0;_i3<numNodes;_i3++){var _n3=_i3*numNodes+_j;matrix[_n3]=matrix[_n3]/columnSum[_j]+additionalProb}for(var previous,eigenvector=new Array(numNodes),temp=new Array(numNodes),_i4=0;_i4<numNodes;_i4++)eigenvector[_i4]=1;for(var iter=0;iter<iterations;iter++){for(var _i5=0;_i5<numNodes;_i5++)temp[_i5]=0;for(var _i6=0;_i6<numNodes;_i6++)for(var _j2=0;_j2<numNodes;_j2++){var _n4=_i6*numNodes+_j2;temp[_i6]+=matrix[_n4]*eigenvector[_j2]}inPlaceSumNormalize(temp),previous=eigenvector,eigenvector=temp,temp=previous;for(var diff=0,_i7=0;_i7<numNodes;_i7++){var delta=previous[_i7]-eigenvector[_i7];diff+=delta*delta}if(diff<precision)break}return{rank:function(node){return node=cy.collection(node)[0],eigenvector[nodes.indexOf(node)]}}}},defaults$1=defaults({root:null,weight:function(edge){return 1},directed:!1,alpha:0}),elesfn$8={degreeCentralityNormalized:function(options){options=defaults$1(options);var cy=this.cy(),nodes=this.nodes(),numNodes=nodes.length;if(options.directed){for(var indegrees={},outdegrees={},maxIndegree=0,maxOutdegree=0,_i=0;_i<numNodes;_i++){var _node=nodes[_i],id=_node.id();options.root=_node;var _currDegree=this.degreeCentrality(options);maxIndegree<_currDegree.indegree&&(maxIndegree=_currDegree.indegree),maxOutdegree<_currDegree.outdegree&&(maxOutdegree=_currDegree.outdegree),indegrees[id]=_currDegree.indegree,outdegrees[id]=_currDegree.outdegree}return{indegree:function(node){return 0==maxIndegree?0:(string(node)&&(node=cy.filter(node)),indegrees[node.id()]/maxIndegree)},outdegree:function(node){return 0===maxOutdegree?0:(string(node)&&(node=cy.filter(node)),outdegrees[node.id()]/maxOutdegree)}}}for(var degrees={},maxDegree=0,i=0;i<numNodes;i++){var node=nodes[i];options.root=node;var currDegree=this.degreeCentrality(options);maxDegree<currDegree.degree&&(maxDegree=currDegree.degree),degrees[node.id()]=currDegree.degree}return{degree:function(node){return 0===maxDegree?0:(string(node)&&(node=cy.filter(node)),degrees[node.id()]/maxDegree)}}},degreeCentrality:function(options){options=defaults$1(options);var cy=this.cy(),callingEles=this,_options=options,root=_options.root,weight=_options.weight,directed=_options.directed,alpha=_options.alpha;if(root=cy.collection(root)[0],directed){for(var edges=root.connectedEdges(),incoming=edges.filter((function(edge){return edge.target().same(root)&&callingEles.has(edge)})),outgoing=edges.filter((function(edge){return edge.source().same(root)&&callingEles.has(edge)})),k_in=incoming.length,k_out=outgoing.length,s_in=0,s_out=0,_i2=0;_i2<incoming.length;_i2++)s_in+=weight(incoming[_i2]);for(var _i3=0;_i3<outgoing.length;_i3++)s_out+=weight(outgoing[_i3]);return{indegree:Math.pow(k_in,1-alpha)*Math.pow(s_in,alpha),outdegree:Math.pow(k_out,1-alpha)*Math.pow(s_out,alpha)}}for(var connEdges=root.connectedEdges().intersection(callingEles),k=connEdges.length,s=0,i=0;i<connEdges.length;i++)s+=weight(connEdges[i]);return{degree:Math.pow(k,1-alpha)*Math.pow(s,alpha)}}};elesfn$8.dc=elesfn$8.degreeCentrality,elesfn$8.dcn=elesfn$8.degreeCentralityNormalised=elesfn$8.degreeCentralityNormalized;var defaults$2=defaults({harmonic:!0,weight:function(){return 1},directed:!1,root:null}),elesfn$9={closenessCentralityNormalized:function(options){for(var _defaults=defaults$2(options),harmonic=_defaults.harmonic,weight=_defaults.weight,directed=_defaults.directed,cy=this.cy(),closenesses={},maxCloseness=0,nodes=this.nodes(),fw=this.floydWarshall({weight:weight,directed:directed}),i=0;i<nodes.length;i++){for(var currCloseness=0,node_i=nodes[i],j=0;j<nodes.length;j++)if(i!==j){var d=fw.distance(node_i,nodes[j]);currCloseness+=harmonic?1/d:d}harmonic||(currCloseness=1/currCloseness),maxCloseness<currCloseness&&(maxCloseness=currCloseness),closenesses[node_i.id()]=currCloseness}return{closeness:function(node){return 0==maxCloseness?0:(node=string(node)?cy.filter(node)[0].id():node.id(),closenesses[node]/maxCloseness)}}},closenessCentrality:function(options){var _defaults2=defaults$2(options),root=_defaults2.root,weight=_defaults2.weight,directed=_defaults2.directed,harmonic=_defaults2.harmonic;root=this.filter(root)[0];for(var dijkstra=this.dijkstra({root:root,weight:weight,directed:directed}),totalDistance=0,nodes=this.nodes(),i=0;i<nodes.length;i++){var n=nodes[i];if(!n.same(root)){var d=dijkstra.distanceTo(n);totalDistance+=harmonic?1/d:d}}return harmonic?totalDistance:1/totalDistance}};elesfn$9.cc=elesfn$9.closenessCentrality,elesfn$9.ccn=elesfn$9.closenessCentralityNormalised=elesfn$9.closenessCentralityNormalized;var defaults$3=defaults({weight:null,directed:!1}),elesfn$a={betweennessCentrality:function(options){for(var _defaults=defaults$3(options),directed=_defaults.directed,weight=_defaults.weight,weighted=null!=weight,cy=this.cy(),V=this.nodes(),A={},_C={},max=0,C_set=function(key,val){_C[key]=val,val>max&&(max=val)},C_get=function(key){return _C[key]},i=0;i<V.length;i++){var v=V[i],vid=v.id();A[vid]=directed?v.outgoers().nodes():v.openNeighborhood().nodes(),C_set(vid,0)}for(var _loop=function(s){for(var sid=V[s].id(),S=[],P={},g={},d={},Q=new Heap((function(a,b){return d[a]-d[b]})),_i=0;_i<V.length;_i++){var _vid=V[_i].id();P[_vid]=[],g[_vid]=0,d[_vid]=1/0}for(g[sid]=1,d[sid]=0,Q.push(sid);!Q.empty();){var _v=Q.pop();if(S.push(_v),weighted)for(var j=0;j<A[_v].length;j++){var w=A[_v][j],vEle=cy.getElementById(_v),edge=void 0;edge=vEle.edgesTo(w).length>0?vEle.edgesTo(w)[0]:w.edgesTo(vEle)[0];var edgeWeight=weight(edge);w=w.id(),d[w]>d[_v]+edgeWeight&&(d[w]=d[_v]+edgeWeight,Q.nodes.indexOf(w)<0?Q.push(w):Q.updateItem(w),g[w]=0,P[w]=[]),d[w]==d[_v]+edgeWeight&&(g[w]=g[w]+g[_v],P[w].push(_v))}else for(var _j=0;_j<A[_v].length;_j++){var _w=A[_v][_j].id();d[_w]==1/0&&(Q.push(_w),d[_w]=d[_v]+1),d[_w]==d[_v]+1&&(g[_w]=g[_w]+g[_v],P[_w].push(_v))}}for(var e={},_i2=0;_i2<V.length;_i2++)e[V[_i2].id()]=0;for(;S.length>0;)for(var _w2=S.pop(),_j2=0;_j2<P[_w2].length;_j2++){var _v2=P[_w2][_j2];e[_v2]=e[_v2]+g[_v2]/g[_w2]*(1+e[_w2]),_w2!=V[s].id()&&C_set(_w2,C_get(_w2)+e[_w2])}},s=0;s<V.length;s++)_loop(s);var ret={betweenness:function(node){var id=cy.collection(node).id();return C_get(id)},betweennessNormalized:function(node){if(0==max)return 0;var id=cy.collection(node).id();return C_get(id)/max}};return ret.betweennessNormalised=ret.betweennessNormalized,ret}};elesfn$a.bc=elesfn$a.betweennessCentrality;var defaults$4=defaults({expandFactor:2,inflateFactor:2,multFactor:1,maxIterations:20,attributes:[function(edge){return 1}]}),getSimilarity=function(edge,attributes){for(var total=0,i=0;i<attributes.length;i++)total+=attributes[i](edge);return total},normalize=function(M,n){for(var sum,col=0;col<n;col++){sum=0;for(var row=0;row<n;row++)sum+=M[row*n+col];for(var _row=0;_row<n;_row++)M[_row*n+col]=M[_row*n+col]/sum}},mmult=function(A,B,n){for(var C=new Array(n*n),i=0;i<n;i++){for(var j=0;j<n;j++)C[i*n+j]=0;for(var k=0;k<n;k++)for(var _j=0;_j<n;_j++)C[i*n+_j]+=A[i*n+k]*B[k*n+_j]}return C},expand=function(M,n,expandFactor){for(var _M=M.slice(0),p=1;p<expandFactor;p++)M=mmult(M,_M,n);return M},inflate=function(M,n,inflateFactor){for(var _M=new Array(n*n),i=0;i<n*n;i++)_M[i]=Math.pow(M[i],inflateFactor);return normalize(_M,n),_M},hasConverged=function(M,_M,n2,roundFactor){for(var i=0;i<n2;i++){if(Math.round(M[i]*Math.pow(10,roundFactor))/Math.pow(10,roundFactor)!==Math.round(_M[i]*Math.pow(10,roundFactor))/Math.pow(10,roundFactor))return!1}return!0},isDuplicate=function(c1,c2){for(var i=0;i<c1.length;i++)if(!c2[i]||c1[i].id()!==c2[i].id())return!1;return!0},markovClustering=function(options){for(var nodes=this.nodes(),edges=this.edges(),cy=this.cy(),opts=function(options){return defaults$4(options)}(options),id2position={},i=0;i<nodes.length;i++)id2position[nodes[i].id()]=i;for(var _M,n=nodes.length,n2=n*n,M=new Array(n2),_i=0;_i<n2;_i++)M[_i]=0;for(var e=0;e<edges.length;e++){var edge=edges[e],_i2=id2position[edge.source().id()],j=id2position[edge.target().id()],sim=getSimilarity(edge,opts.attributes);M[_i2*n+j]+=sim,M[j*n+_i2]+=sim}!function(M,n,val){for(var i=0;i<n;i++)M[i*n+i]=val}(M,n,opts.multFactor),normalize(M,n);for(var isStillMoving=!0,iterations=0;isStillMoving&&iterations<opts.maxIterations;)isStillMoving=!1,_M=expand(M,n,opts.expandFactor),M=inflate(_M,n,opts.inflateFactor),hasConverged(M,_M,n2,4)||(isStillMoving=!0),iterations++;var clusters=function(M,n,nodes,cy){for(var clusters=[],i=0;i<n;i++){for(var cluster=[],j=0;j<n;j++)Math.round(1e3*M[i*n+j])/1e3>0&&cluster.push(nodes[j]);0!==cluster.length&&clusters.push(cy.collection(cluster))}return clusters}(M,n,nodes,cy);return clusters=function(clusters){for(var i=0;i<clusters.length;i++)for(var j=0;j<clusters.length;j++)i!=j&&isDuplicate(clusters[i],clusters[j])&&clusters.splice(j,1);return clusters}(clusters)},markovClustering$1={markovClustering:markovClustering,mcl:markovClustering},identity=function(x){return x},absDiff=function(p,q){return Math.abs(q-p)},addAbsDiff=function(total,p,q){return total+absDiff(p,q)},addSquaredDiff=function(total,p,q){return total+Math.pow(q-p,2)},sqrt=function(x){return Math.sqrt(x)},maxAbsDiff=function(currentMax,p,q){return Math.max(currentMax,absDiff(p,q))},getDistance=function(length,getP,getQ,init,visit){for(var post=arguments.length>5&&void 0!==arguments[5]?arguments[5]:identity,ret=init,dim=0;dim<length;dim++)ret=visit(ret,getP(dim),getQ(dim));return post(ret)},distances={euclidean:function(length,getP,getQ){return length>=2?getDistance(length,getP,getQ,0,addSquaredDiff,sqrt):getDistance(length,getP,getQ,0,addAbsDiff)},squaredEuclidean:function(length,getP,getQ){return getDistance(length,getP,getQ,0,addSquaredDiff)},manhattan:function(length,getP,getQ){return getDistance(length,getP,getQ,0,addAbsDiff)},max:function(length,getP,getQ){return getDistance(length,getP,getQ,-1/0,maxAbsDiff)}};function clusteringDistance(method,length,getP,getQ,nodeP,nodeQ){var impl;return impl=fn(method)?method:distances[method]||distances.euclidean,0===length&&fn(method)?impl(nodeP,nodeQ):impl(length,getP,getQ,nodeP,nodeQ)}distances["squared-euclidean"]=distances.squaredEuclidean,distances.squaredeuclidean=distances.squaredEuclidean;var defaults$5=defaults({k:2,m:2,sensitivityThreshold:1e-4,distance:"euclidean",maxIterations:10,attributes:[],testMode:!1,testCentroids:null}),setOptions$1=function(options){return defaults$5(options)},getDist=function(type,node,centroid,attributes,mode){var getP="kMedoids"!==mode?function(i){return centroid[i]}:function(i){return attributes[i](centroid)},nodeP=centroid,nodeQ=node;return clusteringDistance(type,attributes.length,getP,(function(i){return attributes[i](node)}),nodeP,nodeQ)},randomCentroids=function(nodes,k,attributes){for(var ndim=attributes.length,min=new Array(ndim),max=new Array(ndim),centroids=new Array(k),centroid=null,i=0;i<ndim;i++)min[i]=nodes.min(attributes[i]).value,max[i]=nodes.max(attributes[i]).value;for(var c=0;c<k;c++){centroid=[];for(var _i=0;_i<ndim;_i++)centroid[_i]=Math.random()*(max[_i]-min[_i])+min[_i];centroids[c]=centroid}return centroids},classify=function(node,centroids,distance,attributes,type){for(var min=1/0,index=0,i=0;i<centroids.length;i++){var dist=getDist(distance,node,centroids[i],attributes,type);dist<min&&(min=dist,index=i)}return index},buildCluster=function(centroid,nodes,assignment){for(var cluster=[],node=null,n=0;n<nodes.length;n++)assignment[(node=nodes[n]).id()]===centroid&&cluster.push(node);return cluster},haveMatricesConverged=function(v1,v2,sensitivityThreshold){for(var i=0;i<v1.length;i++)for(var j=0;j<v1[i].length;j++){if(Math.abs(v1[i][j]-v2[i][j])>sensitivityThreshold)return!1}return!0},seenBefore=function(node,medoids,n){for(var i=0;i<n;i++)if(node===medoids[i])return!0;return!1},randomMedoids=function(nodes,k){var medoids=new Array(k);if(nodes.length<50)for(var i=0;i<k;i++){for(var node=nodes[Math.floor(Math.random()*nodes.length)];seenBefore(node,medoids,i);)node=nodes[Math.floor(Math.random()*nodes.length)];medoids[i]=node}else for(var _i2=0;_i2<k;_i2++)medoids[_i2]=nodes[Math.floor(Math.random()*nodes.length)];return medoids},findCost=function(potentialNewMedoid,cluster,attributes){for(var cost=0,n=0;n<cluster.length;n++)cost+=getDist("manhattan",cluster[n],potentialNewMedoid,attributes,"kMedoids");return cost},updateCentroids=function(centroids,nodes,U,weight,opts){for(var numerator,denominator,n=0;n<nodes.length;n++)for(var c=0;c<centroids.length;c++)weight[n][c]=Math.pow(U[n][c],opts.m);for(var _c=0;_c<centroids.length;_c++)for(var dim=0;dim<opts.attributes.length;dim++){numerator=0,denominator=0;for(var _n2=0;_n2<nodes.length;_n2++)numerator+=weight[_n2][_c]*opts.attributes[dim](nodes[_n2]),denominator+=weight[_n2][_c];centroids[_c][dim]=numerator/denominator}},updateMembership=function(U,_U,centroids,nodes,opts){for(var i=0;i<U.length;i++)_U[i]=U[i].slice();for(var sum,numerator,denominator,pow=2/(opts.m-1),c=0;c<centroids.length;c++)for(var n=0;n<nodes.length;n++){sum=0;for(var k=0;k<centroids.length;k++)numerator=getDist(opts.distance,nodes[n],centroids[c],opts.attributes,"cmeans"),denominator=getDist(opts.distance,nodes[n],centroids[k],opts.attributes,"cmeans"),sum+=Math.pow(numerator/denominator,pow);U[n][c]=1/sum}},fuzzyCMeans=function(options){var centroids,U,_U,weight,cy=this.cy(),nodes=this.nodes(),opts=setOptions$1(options);_U=new Array(nodes.length);for(var i=0;i<nodes.length;i++)_U[i]=new Array(opts.k);U=new Array(nodes.length);for(var _i3=0;_i3<nodes.length;_i3++)U[_i3]=new Array(opts.k);for(var _i4=0;_i4<nodes.length;_i4++){for(var total=0,j=0;j<opts.k;j++)U[_i4][j]=Math.random(),total+=U[_i4][j];for(var _j=0;_j<opts.k;_j++)U[_i4][_j]=U[_i4][_j]/total}centroids=new Array(opts.k);for(var _i5=0;_i5<opts.k;_i5++)centroids[_i5]=new Array(opts.attributes.length);weight=new Array(nodes.length);for(var _i6=0;_i6<nodes.length;_i6++)weight[_i6]=new Array(opts.k);for(var isStillMoving=!0,iterations=0;isStillMoving&&iterations<opts.maxIterations;)isStillMoving=!1,updateCentroids(centroids,nodes,U,weight,opts),updateMembership(U,_U,centroids,nodes,opts),haveMatricesConverged(U,_U,opts.sensitivityThreshold)||(isStillMoving=!0),iterations++;return{clusters:function(nodes,U,opts,cy){for(var max,index,clusters=new Array(opts.k),c=0;c<clusters.length;c++)clusters[c]=[];for(var n=0;n<U.length;n++){max=-1/0,index=-1;for(var _c2=0;_c2<U[0].length;_c2++)U[n][_c2]>max&&(max=U[n][_c2],index=_c2);clusters[index].push(nodes[n])}for(var _c3=0;_c3<clusters.length;_c3++)clusters[_c3]=cy.collection(clusters[_c3]);return clusters}(nodes,U,opts,cy),degreeOfMembership:U}},kClustering={kMeans:function(options){var centroids,cy=this.cy(),nodes=this.nodes(),node=null,opts=setOptions$1(options),clusters=new Array(opts.k),assignment={};centroids=opts.testMode?"number"==typeof opts.testCentroids?randomCentroids(nodes,opts.k,opts.attributes):"object"===_typeof(opts.testCentroids)?opts.testCentroids:randomCentroids(nodes,opts.k,opts.attributes):randomCentroids(nodes,opts.k,opts.attributes);for(var v1,v2,sensitivityThreshold,isStillMoving=!0,iterations=0;isStillMoving&&iterations<opts.maxIterations;){for(var n=0;n<nodes.length;n++)assignment[(node=nodes[n]).id()]=classify(node,centroids,opts.distance,opts.attributes,"kMeans");isStillMoving=!1;for(var c=0;c<opts.k;c++){var cluster=buildCluster(c,nodes,assignment);if(0!==cluster.length){for(var ndim=opts.attributes.length,centroid=centroids[c],newCentroid=new Array(ndim),sum=new Array(ndim),d=0;d<ndim;d++){sum[d]=0;for(var i=0;i<cluster.length;i++)node=cluster[i],sum[d]+=opts.attributes[d](node);newCentroid[d]=sum[d]/cluster.length,v1=newCentroid[d],v2=centroid[d],sensitivityThreshold=opts.sensitivityThreshold,Math.abs(v2-v1)<=sensitivityThreshold||(isStillMoving=!0)}centroids[c]=newCentroid,clusters[c]=cy.collection(cluster)}}iterations++}return clusters},kMedoids:function(options){var medoids,curCost,cy=this.cy(),nodes=this.nodes(),node=null,opts=setOptions$1(options),clusters=new Array(opts.k),assignment={},minCosts=new Array(opts.k);opts.testMode?"number"==typeof opts.testCentroids||(medoids="object"===_typeof(opts.testCentroids)?opts.testCentroids:randomMedoids(nodes,opts.k)):medoids=randomMedoids(nodes,opts.k);for(var isStillMoving=!0,iterations=0;isStillMoving&&iterations<opts.maxIterations;){for(var n=0;n<nodes.length;n++)assignment[(node=nodes[n]).id()]=classify(node,medoids,opts.distance,opts.attributes,"kMedoids");isStillMoving=!1;for(var m=0;m<medoids.length;m++){var cluster=buildCluster(m,nodes,assignment);if(0!==cluster.length){minCosts[m]=findCost(medoids[m],cluster,opts.attributes);for(var _n=0;_n<cluster.length;_n++)(curCost=findCost(cluster[_n],cluster,opts.attributes))<minCosts[m]&&(minCosts[m]=curCost,medoids[m]=cluster[_n],isStillMoving=!0);clusters[m]=cy.collection(cluster)}}iterations++}return clusters},fuzzyCMeans:fuzzyCMeans,fcm:fuzzyCMeans},defaults$6=defaults({distance:"euclidean",linkage:"min",mode:"threshold",threshold:1/0,addDendrogram:!1,dendrogramDepth:0,attributes:[]}),linkageAliases={single:"min",complete:"max"},mergeClosest=function(clusters,index,dists,mins,opts){for(var dist,minKey=0,min=1/0,attrs=opts.attributes,getDist=function(n1,n2){return clusteringDistance(opts.distance,attrs.length,(function(i){return attrs[i](n1)}),(function(i){return attrs[i](n2)}),n1,n2)},i=0;i<clusters.length;i++){var key=clusters[i].key,_dist=dists[key][mins[key]];_dist<min&&(minKey=key,min=_dist)}if("threshold"===opts.mode&&min>=opts.threshold||"dendrogram"===opts.mode&&1===clusters.length)return!1;var merged,c1=index[minKey],c2=index[mins[minKey]];merged="dendrogram"===opts.mode?{left:c1,right:c2,key:c1.key}:{value:c1.value.concat(c2.value),key:c1.key},clusters[c1.index]=merged,clusters.splice(c2.index,1),index[c1.key]=merged;for(var _i=0;_i<clusters.length;_i++){var cur=clusters[_i];c1.key===cur.key?dist=1/0:"min"===opts.linkage?(dist=dists[c1.key][cur.key],dists[c1.key][cur.key]>dists[c2.key][cur.key]&&(dist=dists[c2.key][cur.key])):"max"===opts.linkage?(dist=dists[c1.key][cur.key],dists[c1.key][cur.key]<dists[c2.key][cur.key]&&(dist=dists[c2.key][cur.key])):dist="mean"===opts.linkage?(dists[c1.key][cur.key]*c1.size+dists[c2.key][cur.key]*c2.size)/(c1.size+c2.size):"dendrogram"===opts.mode?getDist(cur.value,c1.value):getDist(cur.value[0],c1.value[0]),dists[c1.key][cur.key]=dists[cur.key][c1.key]=dist}for(var _i2=0;_i2<clusters.length;_i2++){var key1=clusters[_i2].key;if(mins[key1]===c1.key||mins[key1]===c2.key){for(var _min=key1,j=0;j<clusters.length;j++){var key2=clusters[j].key;dists[key1][key2]<dists[key1][_min]&&(_min=key2)}mins[key1]=_min}clusters[_i2].index=_i2}return c1.key=c2.key=c1.index=c2.index=null,!0},getAllChildren=function getAllChildren(root,arr,cy){root&&(root.value?arr.push(root.value):(root.left&&getAllChildren(root.left,arr),root.right&&getAllChildren(root.right,arr)))},hierarchicalClustering=function(options){for(var cy=this.cy(),nodes=this.nodes(),opts=function(options){var opts=defaults$6(options),preferredAlias=linkageAliases[opts.linkage];return null!=preferredAlias&&(opts.linkage=preferredAlias),opts}(options),attrs=opts.attributes,getDist=function(n1,n2){return clusteringDistance(opts.distance,attrs.length,(function(i){return attrs[i](n1)}),(function(i){return attrs[i](n2)}),n1,n2)},clusters=[],dists=[],mins=[],index=[],n=0;n<nodes.length;n++){var cluster={value:"dendrogram"===opts.mode?nodes[n]:[nodes[n]],key:n,index:n};clusters[n]=cluster,index[n]=cluster,dists[n]=[],mins[n]=0}for(var i=0;i<clusters.length;i++)for(var j=0;j<=i;j++){var dist=void 0;dist="dendrogram"===opts.mode?i===j?1/0:getDist(clusters[i].value,clusters[j].value):i===j?1/0:getDist(clusters[i].value[0],clusters[j].value[0]),dists[i][j]=dist,dists[j][i]=dist,dist<dists[i][mins[i]]&&(mins[i]=j)}for(var retClusters,merged=mergeClosest(clusters,index,dists,mins,opts);merged;)merged=mergeClosest(clusters,index,dists,mins,opts);return"dendrogram"===opts.mode?(retClusters=function buildClustersFromTree(root,k,cy){if(!root)return[];var left=[],right=[],leaves=[];return 0===k?(root.left&&getAllChildren(root.left,left),root.right&&getAllChildren(root.right,right),leaves=left.concat(right),[cy.collection(leaves)]):1===k?root.value?[cy.collection(root.value)]:(root.left&&getAllChildren(root.left,left),root.right&&getAllChildren(root.right,right),[cy.collection(left),cy.collection(right)]):root.value?[cy.collection(root.value)]:(root.left&&(left=buildClustersFromTree(root.left,k-1,cy)),root.right&&(right=buildClustersFromTree(root.right,k-1,cy)),left.concat(right))}(clusters[0],opts.dendrogramDepth,cy),opts.addDendrogram&&function buildDendrogram(root,cy){if(!root)return"";if(root.left&&root.right){var leftStr=buildDendrogram(root.left,cy),rightStr=buildDendrogram(root.right,cy),node=cy.add({group:"nodes",data:{id:leftStr+","+rightStr}});return cy.add({group:"edges",data:{source:leftStr,target:node.id()}}),cy.add({group:"edges",data:{source:rightStr,target:node.id()}}),node.id()}return root.value?root.value.id():void 0}(clusters[0],cy)):(retClusters=new Array(clusters.length),clusters.forEach((function(cluster,i){cluster.key=cluster.index=null,retClusters[i]=cy.collection(cluster.value)}))),retClusters},hierarchicalClustering$1={hierarchicalClustering:hierarchicalClustering,hca:hierarchicalClustering},defaults$7=defaults({distance:"euclidean",preference:"median",damping:.8,maxIterations:1e3,minIterations:100,attributes:[]}),getSimilarity$1=function(type,n1,n2,attributes){var attr=function(n,i){return attributes[i](n)};return-clusteringDistance(type,attributes.length,(function(i){return attr(n1,i)}),(function(i){return attr(n2,i)}),n1,n2)},getPreference=function(S,preference){return"median"===preference?function(arr){var begin=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,end=arguments.length>2&&void 0!==arguments[2]?arguments[2]:arr.length,copy=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],sort=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],includeHoles=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];copy?arr=arr.slice(begin,end):(end<arr.length&&arr.splice(end,arr.length-end),begin>0&&arr.splice(0,begin));for(var off=0,i=arr.length-1;i>=0;i--){var v=arr[i];includeHoles?isFinite(v)||(arr[i]=-1/0,off++):arr.splice(i,1)}sort&&arr.sort((function(a,b){return a-b}));var len=arr.length,mid=Math.floor(len/2);return len%2!=0?arr[mid+1+off]:(arr[mid-1+off]+arr[mid+off])/2}(S):"mean"===preference?function(arr){for(var begin=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,end=arguments.length>2&&void 0!==arguments[2]?arguments[2]:arr.length,total=0,n=0,i=begin;i<end;i++){var val=arr[i];isFinite(val)&&(total+=val,n++)}return total/n}(S):"min"===preference?function(arr){for(var begin=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,end=arguments.length>2&&void 0!==arguments[2]?arguments[2]:arr.length,min=1/0,i=begin;i<end;i++){var val=arr[i];isFinite(val)&&(min=Math.min(val,min))}return min}(S):"max"===preference?function(arr){for(var begin=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,end=arguments.length>2&&void 0!==arguments[2]?arguments[2]:arr.length,max=-1/0,i=begin;i<end;i++){var val=arr[i];isFinite(val)&&(max=Math.max(val,max))}return max}(S):preference},assignClusters=function(n,S,exemplars){for(var clusters=[],i=0;i<n;i++){for(var index=-1,max=-1/0,ei=0;ei<exemplars.length;ei++){var e=exemplars[ei];S[i*n+e]>max&&(index=e,max=S[i*n+e])}index>0&&clusters.push(index)}for(var _ei=0;_ei<exemplars.length;_ei++)clusters[exemplars[_ei]]=exemplars[_ei];return clusters},affinityPropagation=function(options){for(var n,n2,S,p,R,A,cy=this.cy(),nodes=this.nodes(),opts=function(options){var dmp=options.damping,pref=options.preference;.5<=dmp&&dmp<1||error("Damping must range on [0.5, 1).  Got: ".concat(dmp));var validPrefs=["median","mean","min","max"];return validPrefs.some((function(v){return v===pref}))||number(pref)||error("Preference must be one of [".concat(validPrefs.map((function(p){return"'".concat(p,"'")})).join(", "),"] or a number.  Got: ").concat(pref)),defaults$7(options)}(options),id2position={},i=0;i<nodes.length;i++)id2position[nodes[i].id()]=i;n2=(n=nodes.length)*n,S=new Array(n2);for(var _i=0;_i<n2;_i++)S[_i]=-1/0;for(var _i2=0;_i2<n;_i2++)for(var j=0;j<n;j++)_i2!==j&&(S[_i2*n+j]=getSimilarity$1(opts.distance,nodes[_i2],nodes[j],opts.attributes));p=getPreference(S,opts.preference);for(var _i3=0;_i3<n;_i3++)S[_i3*n+_i3]=p;R=new Array(n2);for(var _i4=0;_i4<n2;_i4++)R[_i4]=0;A=new Array(n2);for(var _i5=0;_i5<n2;_i5++)A[_i5]=0;for(var old=new Array(n),Rp=new Array(n),se=new Array(n),_i6=0;_i6<n;_i6++)old[_i6]=0,Rp[_i6]=0,se[_i6]=0;for(var iter,e=new Array(n*opts.minIterations),_i7=0;_i7<e.length;_i7++)e[_i7]=0;for(iter=0;iter<opts.maxIterations;iter++){for(var _i8=0;_i8<n;_i8++){for(var max=-1/0,max2=-1/0,maxI=-1,AS=0,_j=0;_j<n;_j++)old[_j]=R[_i8*n+_j],(AS=A[_i8*n+_j]+S[_i8*n+_j])>=max?(max2=max,max=AS,maxI=_j):AS>max2&&(max2=AS);for(var _j2=0;_j2<n;_j2++)R[_i8*n+_j2]=(1-opts.damping)*(S[_i8*n+_j2]-max)+opts.damping*old[_j2];R[_i8*n+maxI]=(1-opts.damping)*(S[_i8*n+maxI]-max2)+opts.damping*old[maxI]}for(var _i9=0;_i9<n;_i9++){for(var sum=0,_j3=0;_j3<n;_j3++)old[_j3]=A[_j3*n+_i9],Rp[_j3]=Math.max(0,R[_j3*n+_i9]),sum+=Rp[_j3];sum-=Rp[_i9],Rp[_i9]=R[_i9*n+_i9],sum+=Rp[_i9];for(var _j4=0;_j4<n;_j4++)A[_j4*n+_i9]=(1-opts.damping)*Math.min(0,sum-Rp[_j4])+opts.damping*old[_j4];A[_i9*n+_i9]=(1-opts.damping)*(sum-Rp[_i9])+opts.damping*old[_i9]}for(var K=0,_i10=0;_i10<n;_i10++){var E=A[_i10*n+_i10]+R[_i10*n+_i10]>0?1:0;e[iter%opts.minIterations*n+_i10]=E,K+=E}if(K>0&&(iter>=opts.minIterations-1||iter==opts.maxIterations-1)){for(var _sum=0,_i11=0;_i11<n;_i11++){se[_i11]=0;for(var _j5=0;_j5<opts.minIterations;_j5++)se[_i11]+=e[_j5*n+_i11];0!==se[_i11]&&se[_i11]!==opts.minIterations||_sum++}if(_sum===n)break}}for(var exemplarsIndices=function(n,R,A){for(var indices=[],i=0;i<n;i++)R[i*n+i]+A[i*n+i]>0&&indices.push(i);return indices}(n,R,A),clusterIndices=function(n,S,exemplars){for(var clusters=assignClusters(n,S,exemplars),ei=0;ei<exemplars.length;ei++){for(var ii=[],c=0;c<clusters.length;c++)clusters[c]===exemplars[ei]&&ii.push(c);for(var maxI=-1,maxSum=-1/0,i=0;i<ii.length;i++){for(var sum=0,j=0;j<ii.length;j++)sum+=S[ii[j]*n+ii[i]];sum>maxSum&&(maxI=i,maxSum=sum)}exemplars[ei]=ii[maxI]}return clusters=assignClusters(n,S,exemplars)}(n,S,exemplarsIndices),clusters={},c=0;c<exemplarsIndices.length;c++)clusters[exemplarsIndices[c]]=[];for(var _i12=0;_i12<nodes.length;_i12++){var clusterIndex=clusterIndices[id2position[nodes[_i12].id()]];null!=clusterIndex&&clusters[clusterIndex].push(nodes[_i12])}for(var retClusters=new Array(exemplarsIndices.length),_c=0;_c<exemplarsIndices.length;_c++)retClusters[_c]=cy.collection(clusters[exemplarsIndices[_c]]);return retClusters},elesfn$b={};[elesfn,elesfn$1,elesfn$2,elesfn$3,elesfn$4,elesfn$5,elesfn$6,elesfn$7,elesfn$8,elesfn$9,elesfn$a,markovClustering$1,kClustering,hierarchicalClustering$1,{affinityPropagation:affinityPropagation,ap:affinityPropagation}].forEach((function(props){extend(elesfn$b,props)}));
/*!
Embeddable Minimum Strictly-Compliant Promises/A+ 1.1.1 Thenable
Copyright (c) 2013-2014 Ralf S. Engelschall (http://engelschall.com)
Licensed under The MIT License (http://opensource.org/licenses/MIT)
*/
var api=function api(executor){if(!(this instanceof api))return new api(executor);this.id="Thenable/1.0.7",this.state=0,this.fulfillValue=void 0,this.rejectReason=void 0,this.onFulfilled=[],this.onRejected=[],this.proxy={then:this.then.bind(this)},"function"==typeof executor&&executor.call(this,this.fulfill.bind(this),this.reject.bind(this))};api.prototype={fulfill:function(value){return deliver(this,1,"fulfillValue",value)},reject:function(value){return deliver(this,2,"rejectReason",value)},then:function(onFulfilled,onRejected){var next=new api;return this.onFulfilled.push(resolver(onFulfilled,next,"fulfill")),this.onRejected.push(resolver(onRejected,next,"reject")),execute(this),next.proxy}};var deliver=function(curr,state,name,value){return 0===curr.state&&(curr.state=state,curr[name]=value,execute(curr)),curr},execute=function(curr){1===curr.state?execute_handlers(curr,"onFulfilled",curr.fulfillValue):2===curr.state&&execute_handlers(curr,"onRejected",curr.rejectReason)},execute_handlers=function(curr,name,value){if(0!==curr[name].length){var handlers=curr[name];curr[name]=[];var func=function(){for(var i=0;i<handlers.length;i++)handlers[i](value)};"function"==typeof setImmediate?setImmediate(func):setTimeout(func,0)}},resolver=function(cb,next,method){return function(value){if("function"!=typeof cb)next[method].call(next,value);else{var result;try{result=cb(value)}catch(e){return void next.reject(e)}resolve(next,result)}}},resolve=function resolve(promise,x){if(promise!==x&&promise.proxy!==x){var then;if("object"===_typeof(x)&&null!==x||"function"==typeof x)try{then=x.then}catch(e){return void promise.reject(e)}if("function"!=typeof then)promise.fulfill(x);else{var resolved=!1;try{then.call(x,(function(y){resolved||(resolved=!0,y===x?promise.reject(new TypeError("circular thenable chain")):resolve(promise,y))}),(function(r){resolved||(resolved=!0,promise.reject(r))}))}catch(e){resolved||promise.reject(e)}}}else promise.reject(new TypeError("cannot resolve promise with itself"))};api.all=function(ps){return new api((function(resolveAll,rejectAll){for(var vals=new Array(ps.length),doneCount=0,fulfill=function(i,val){vals[i]=val,++doneCount===ps.length&&resolveAll(vals)},i=0;i<ps.length;i++)!function(i){var p=ps[i];null!=p&&null!=p.then?p.then((function(val){fulfill(i,val)}),(function(err){rejectAll(err)})):fulfill(i,p)}(i)}))},api.resolve=function(val){return new api((function(resolve,reject){resolve(val)}))},api.reject=function(val){return new api((function(resolve,reject){reject(val)}))};var Promise$1="undefined"!=typeof Promise?Promise:api,Animation=function(target,opts,opts2){var isCore=core(target),isEle=!isCore,_p=this._private=extend({duration:1e3},opts,opts2);if(_p.target=target,_p.style=_p.style||_p.css,_p.started=!1,_p.playing=!1,_p.hooked=!1,_p.applying=!1,_p.progress=0,_p.completes=[],_p.frames=[],_p.complete&&fn(_p.complete)&&_p.completes.push(_p.complete),isEle){var pos=target.position();_p.startPosition=_p.startPosition||{x:pos.x,y:pos.y},_p.startStyle=_p.startStyle||target.cy().style().getAnimationStartStyle(target,_p.style)}if(isCore){var pan=target.pan();_p.startPan={x:pan.x,y:pan.y},_p.startZoom=target.zoom()}this.length=1,this[0]=this},anifn=Animation.prototype;extend(anifn,{instanceString:function(){return"animation"},hook:function(){var _p=this._private;if(!_p.hooked){var tAni=_p.target._private.animation;(_p.queue?tAni.queue:tAni.current).push(this),elementOrCollection(_p.target)&&_p.target.cy().addToAnimationPool(_p.target),_p.hooked=!0}return this},play:function(){var _p=this._private;return 1===_p.progress&&(_p.progress=0),_p.playing=!0,_p.started=!1,_p.stopped=!1,this.hook(),this},playing:function(){return this._private.playing},apply:function(){var _p=this._private;return _p.applying=!0,_p.started=!1,_p.stopped=!1,this.hook(),this},applying:function(){return this._private.applying},pause:function(){var _p=this._private;return _p.playing=!1,_p.started=!1,this},stop:function(){var _p=this._private;return _p.playing=!1,_p.started=!1,_p.stopped=!0,this},rewind:function(){return this.progress(0)},fastforward:function(){return this.progress(1)},time:function(t){var _p=this._private;return void 0===t?_p.progress*_p.duration:this.progress(t/_p.duration)},progress:function(p){var _p=this._private,wasPlaying=_p.playing;return void 0===p?_p.progress:(wasPlaying&&this.pause(),_p.progress=p,_p.started=!1,wasPlaying&&this.play(),this)},completed:function(){return 1===this._private.progress},reverse:function(){var _p=this._private,wasPlaying=_p.playing;wasPlaying&&this.pause(),_p.progress=1-_p.progress,_p.started=!1;var swap=function(a,b){var _pa=_p[a];null!=_pa&&(_p[a]=_p[b],_p[b]=_pa)};if(swap("zoom","startZoom"),swap("pan","startPan"),swap("position","startPosition"),_p.style)for(var i=0;i<_p.style.length;i++){var prop=_p.style[i],name=prop.name,startStyleProp=_p.startStyle[name];_p.startStyle[name]=prop,_p.style[i]=startStyleProp}return wasPlaying&&this.play(),this},promise:function(type){var arr,_p=this._private;switch(type){case"frame":arr=_p.frames;break;default:case"complete":case"completed":arr=_p.completes}return new Promise$1((function(resolve,reject){arr.push((function(){resolve()}))}))}}),anifn.complete=anifn.completed,anifn.run=anifn.play,anifn.running=anifn.playing;var define$3={};[{animated:function(){return function(){var all=void 0!==this.length?this:[this];if(!(this._private.cy||this).styleEnabled())return!1;var ele=all[0];return ele?ele._private.animation.current.length>0:void 0}},clearQueue:function(){return function(){var all=void 0!==this.length?this:[this];if(!(this._private.cy||this).styleEnabled())return this;for(var i=0;i<all.length;i++){all[i]._private.animation.queue=[]}return this}},delay:function(){return function(time,complete){return(this._private.cy||this).styleEnabled()?this.animate({delay:time,duration:time,complete:complete}):this}},delayAnimation:function(){return function(time,complete){return(this._private.cy||this).styleEnabled()?this.animation({delay:time,duration:time,complete:complete}):this}},animation:function(){return function(properties,params){var selfIsArrayLike=void 0!==this.length,all=selfIsArrayLike?this:[this],cy=this._private.cy||this,isCore=!selfIsArrayLike,isEles=!isCore;if(!cy.styleEnabled())return this;var style=cy.style();if(properties=extend({},properties,params),0===Object.keys(properties).length)return new Animation(all[0],properties);switch(void 0===properties.duration&&(properties.duration=400),properties.duration){case"slow":properties.duration=600;break;case"fast":properties.duration=200}if(isEles&&(properties.style=style.getPropsList(properties.style||properties.css),properties.css=void 0),isEles&&null!=properties.renderedPosition){var rpos=properties.renderedPosition,pan=cy.pan(),zoom=cy.zoom();properties.position=renderedToModelPosition(rpos,zoom,pan)}if(isCore&&null!=properties.panBy){var panBy=properties.panBy,cyPan=cy.pan();properties.pan={x:cyPan.x+panBy.x,y:cyPan.y+panBy.y}}var center=properties.center||properties.centre;if(isCore&&null!=center){var centerPan=cy.getCenterPan(center.eles,properties.zoom);null!=centerPan&&(properties.pan=centerPan)}if(isCore&&null!=properties.fit){var fit=properties.fit,fitVp=cy.getFitViewport(fit.eles||fit.boundingBox,fit.padding);null!=fitVp&&(properties.pan=fitVp.pan,properties.zoom=fitVp.zoom)}if(isCore&&plainObject(properties.zoom)){var vp=cy.getZoomedViewport(properties.zoom);null!=vp&&(vp.zoomed&&(properties.zoom=vp.zoom),vp.panned&&(properties.pan=vp.pan))}return new Animation(all[0],properties)}},animate:function(){return function(properties,params){var all=void 0!==this.length?this:[this];if(!(this._private.cy||this).styleEnabled())return this;params&&(properties=extend({},properties,params));for(var i=0;i<all.length;i++){var ele=all[i],queue=ele.animated()&&(void 0===properties.queue||properties.queue);ele.animation(properties,queue?{queue:!0}:void 0).play()}return this}},stop:function(){return function(clearQueue,jumpToEnd){var all=void 0!==this.length?this:[this],cy=this._private.cy||this;if(!cy.styleEnabled())return this;for(var i=0;i<all.length;i++){for(var _p=all[i]._private,anis=_p.animation.current,j=0;j<anis.length;j++){var ani_p=anis[j]._private;jumpToEnd&&(ani_p.duration=0)}clearQueue&&(_p.animation.queue=[]),jumpToEnd||(_p.animation.current=[])}return cy.notify("draw"),this}}},{data:function(params){return params=extend({},{field:"data",bindingEvent:"data",allowBinding:!1,allowSetting:!1,allowGetting:!1,settingEvent:"data",settingTriggersEvent:!1,triggerFnName:"trigger",immutableKeys:{},updateStyle:!1,beforeGet:function(self){},beforeSet:function(self,obj){},onSet:function(self){},canSet:function(self){return!0}},params),function(name,value){var p=params,selfIsArrayLike=void 0!==this.length,all=selfIsArrayLike?this:[this],single=selfIsArrayLike?this[0]:this;if(string(name)){var ret;if(p.allowGetting&&void 0===value)return single&&(p.beforeGet(single),ret=single._private[p.field][name]),ret;if(p.allowSetting&&void 0!==value&&!p.immutableKeys[name]){var change=function(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}({},name,value);p.beforeSet(this,change);for(var i=0,l=all.length;i<l;i++){var ele=all[i];p.canSet(ele)&&(ele._private[p.field][name]=value)}p.updateStyle&&this.updateStyle(),p.onSet(this),p.settingTriggersEvent&&this[p.triggerFnName](p.settingEvent)}}else if(p.allowSetting&&plainObject(name)){var k,v,obj=name,keys=Object.keys(obj);p.beforeSet(this,obj);for(var _i=0;_i<keys.length;_i++){if(v=obj[k=keys[_i]],!p.immutableKeys[k])for(var j=0;j<all.length;j++){var _ele=all[j];p.canSet(_ele)&&(_ele._private[p.field][k]=v)}}p.updateStyle&&this.updateStyle(),p.onSet(this),p.settingTriggersEvent&&this[p.triggerFnName](p.settingEvent)}else if(p.allowBinding&&fn(name)){var fn$1=name;this.on(p.bindingEvent,fn$1)}else if(p.allowGetting&&void 0===name){var _ret;return single&&(p.beforeGet(single),_ret=single._private[p.field]),_ret}return this}},removeData:function(params){return params=extend({},{field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!1,immutableKeys:{}},params),function(names){var p=params,all=void 0!==this.length?this:[this];if(string(names)){for(var keys=names.split(/\s+/),l=keys.length,i=0;i<l;i++){var key=keys[i];if(!emptyString(key))if(!p.immutableKeys[key])for(var i_a=0,l_a=all.length;i_a<l_a;i_a++)all[i_a]._private[p.field][key]=void 0}p.triggerEvent&&this[p.triggerFnName](p.event)}else if(void 0===names){for(var _i_a=0,_l_a=all.length;_i_a<_l_a;_i_a++)for(var _privateFields=all[_i_a]._private[p.field],_keys=Object.keys(_privateFields),_i2=0;_i2<_keys.length;_i2++){var _key=_keys[_i2];!p.immutableKeys[_key]&&(_privateFields[_key]=void 0)}p.triggerEvent&&this[p.triggerFnName](p.event)}return this}}},{eventAliasesOn:function(proto){var p=proto;p.addListener=p.listen=p.bind=p.on,p.unlisten=p.unbind=p.off=p.removeListener,p.trigger=p.emit,p.pon=p.promiseOn=function(events,selector){var self=this,args=Array.prototype.slice.call(arguments,0);return new Promise$1((function(resolve,reject){var onArgs=args.concat([function(e){self.off.apply(self,offArgs),resolve(e)}]),offArgs=onArgs.concat([]);self.on.apply(self,onArgs)}))}}}].forEach((function(m){extend(define$3,m)}));var elesfn$c={animate:define$3.animate(),animation:define$3.animation(),animated:define$3.animated(),clearQueue:define$3.clearQueue(),delay:define$3.delay(),delayAnimation:define$3.delayAnimation(),stop:define$3.stop()},elesfn$d={classes:function(_classes){if(void 0===_classes){var ret=[];return this[0]._private.classes.forEach((function(cls){return ret.push(cls)})),ret}array(_classes)||(_classes=(_classes||"").match(/\S+/g)||[]);for(var changed=[],classesSet=new Set$1(_classes),j=0;j<this.length;j++){for(var ele=this[j],_p=ele._private,eleClasses=_p.classes,changedEle=!1,i=0;i<_classes.length;i++){var cls=_classes[i];if(!eleClasses.has(cls)){changedEle=!0;break}}changedEle||(changedEle=eleClasses.size!==_classes.length),changedEle&&(_p.classes=classesSet,changed.push(ele))}return changed.length>0&&this.spawn(changed).updateStyle().emit("class"),this},addClass:function(classes){return this.toggleClass(classes,!0)},hasClass:function(className){var ele=this[0];return null!=ele&&ele._private.classes.has(className)},toggleClass:function(classes,toggle){array(classes)||(classes=classes.match(/\S+/g)||[]);for(var toggleUndefd=void 0===toggle,changed=[],i=0,il=this.length;i<il;i++)for(var ele=this[i],eleClasses=ele._private.classes,changedEle=!1,j=0;j<classes.length;j++){var cls=classes[j],hasClass=eleClasses.has(cls),changedNow=!1;toggle||toggleUndefd&&!hasClass?(eleClasses.add(cls),changedNow=!0):(!toggle||toggleUndefd&&hasClass)&&(eleClasses.delete(cls),changedNow=!0),!changedEle&&changedNow&&(changed.push(ele),changedEle=!0)}return changed.length>0&&this.spawn(changed).updateStyle().emit("class"),this},removeClass:function(classes){return this.toggleClass(classes,!1)},flashClass:function(classes,duration){var self=this;if(null==duration)duration=250;else if(0===duration)return self;return self.addClass(classes),setTimeout((function(){self.removeClass(classes)}),duration),self}};elesfn$d.className=elesfn$d.classNames=elesfn$d.classes;var tokens={metaChar:"[\\!\\\"\\#\\$\\%\\&\\'\\(\\)\\*\\+\\,\\.\\/\\:\\;\\<\\=\\>\\?\\@\\[\\]\\^\\`\\{\\|\\}\\~]",comparatorOp:"=|\\!=|>|>=|<|<=|\\$=|\\^=|\\*=",boolOp:"\\?|\\!|\\^",string:"\"(?:\\\\\"|[^\"])*\"|'(?:\\\\'|[^'])*'",number:number$1,meta:"degree|indegree|outdegree",separator:"\\s*,\\s*",descendant:"\\s+",child:"\\s+>\\s+",subject:"\\$",group:"node|edge|\\*",directedEdge:"\\s+->\\s+",undirectedEdge:"\\s+<->\\s+"};tokens.variable="(?:[\\w-]|(?:\\\\"+tokens.metaChar+"))+",tokens.value=tokens.string+"|"+tokens.number,tokens.className=tokens.variable,tokens.id=tokens.variable,function(){var ops,op,i;for(ops=tokens.comparatorOp.split("|"),i=0;i<ops.length;i++)op=ops[i],tokens.comparatorOp+="|@"+op;for(ops=tokens.comparatorOp.split("|"),i=0;i<ops.length;i++)(op=ops[i]).indexOf("!")>=0||"="!==op&&(tokens.comparatorOp+="|\\!"+op)}();var Type_GROUP=0,Type_COLLECTION=1,Type_FILTER=2,Type_DATA_COMPARE=3,Type_DATA_EXIST=4,Type_DATA_BOOL=5,Type_META_COMPARE=6,Type_STATE=7,Type_ID=8,Type_CLASS=9,Type_UNDIRECTED_EDGE=10,Type_DIRECTED_EDGE=11,Type_NODE_SOURCE=12,Type_NODE_TARGET=13,Type_NODE_NEIGHBOR=14,Type_CHILD=15,Type_DESCENDANT=16,Type_PARENT=17,Type_ANCESTOR=18,Type_COMPOUND_SPLIT=19,Type_TRUE=20,stateSelectors=[{selector:":selected",matches:function(ele){return ele.selected()}},{selector:":unselected",matches:function(ele){return!ele.selected()}},{selector:":selectable",matches:function(ele){return ele.selectable()}},{selector:":unselectable",matches:function(ele){return!ele.selectable()}},{selector:":locked",matches:function(ele){return ele.locked()}},{selector:":unlocked",matches:function(ele){return!ele.locked()}},{selector:":visible",matches:function(ele){return ele.visible()}},{selector:":hidden",matches:function(ele){return!ele.visible()}},{selector:":transparent",matches:function(ele){return ele.transparent()}},{selector:":grabbed",matches:function(ele){return ele.grabbed()}},{selector:":free",matches:function(ele){return!ele.grabbed()}},{selector:":removed",matches:function(ele){return ele.removed()}},{selector:":inside",matches:function(ele){return!ele.removed()}},{selector:":grabbable",matches:function(ele){return ele.grabbable()}},{selector:":ungrabbable",matches:function(ele){return!ele.grabbable()}},{selector:":animated",matches:function(ele){return ele.animated()}},{selector:":unanimated",matches:function(ele){return!ele.animated()}},{selector:":parent",matches:function(ele){return ele.isParent()}},{selector:":childless",matches:function(ele){return ele.isChildless()}},{selector:":child",matches:function(ele){return ele.isChild()}},{selector:":orphan",matches:function(ele){return ele.isOrphan()}},{selector:":nonorphan",matches:function(ele){return ele.isChild()}},{selector:":compound",matches:function(ele){return ele.isNode()?ele.isParent():ele.source().isParent()||ele.target().isParent()}},{selector:":loop",matches:function(ele){return ele.isLoop()}},{selector:":simple",matches:function(ele){return ele.isSimple()}},{selector:":active",matches:function(ele){return ele.active()}},{selector:":inactive",matches:function(ele){return!ele.active()}},{selector:":backgrounding",matches:function(ele){return ele.backgrounding()}},{selector:":nonbackgrounding",matches:function(ele){return!ele.backgrounding()}}].sort((function(a,b){return function(a,b){return-1*ascending(a,b)}(a.selector,b.selector)})),lookup=function(){for(var s,selToFn={},i=0;i<stateSelectors.length;i++)selToFn[(s=stateSelectors[i]).selector]=s.matches;return selToFn}(),stateSelectorRegex="("+stateSelectors.map((function(s){return s.selector})).join("|")+")",cleanMetaChars=function(str){return str.replace(new RegExp("\\\\("+tokens.metaChar+")","g"),(function(match,$1){return $1}))},replaceLastQuery=function(selector,examiningQuery,replacementQuery){selector[selector.length-1]=replacementQuery},exprs=[{name:"group",query:!0,regex:"("+tokens.group+")",populate:function(selector,query,_ref){var group=_slicedToArray(_ref,1)[0];query.checks.push({type:Type_GROUP,value:"*"===group?group:group+"s"})}},{name:"state",query:!0,regex:stateSelectorRegex,populate:function(selector,query,_ref3){var state=_slicedToArray(_ref3,1)[0];query.checks.push({type:Type_STATE,value:state})}},{name:"id",query:!0,regex:"\\#("+tokens.id+")",populate:function(selector,query,_ref5){var id=_slicedToArray(_ref5,1)[0];query.checks.push({type:Type_ID,value:cleanMetaChars(id)})}},{name:"className",query:!0,regex:"\\.("+tokens.className+")",populate:function(selector,query,_ref7){var className=_slicedToArray(_ref7,1)[0];query.checks.push({type:Type_CLASS,value:cleanMetaChars(className)})}},{name:"dataExists",query:!0,regex:"\\[\\s*("+tokens.variable+")\\s*\\]",populate:function(selector,query,_ref9){var variable=_slicedToArray(_ref9,1)[0];query.checks.push({type:Type_DATA_EXIST,field:cleanMetaChars(variable)})}},{name:"dataCompare",query:!0,regex:"\\[\\s*("+tokens.variable+")\\s*("+tokens.comparatorOp+")\\s*("+tokens.value+")\\s*\\]",populate:function(selector,query,_ref11){var _ref12=_slicedToArray(_ref11,3),variable=_ref12[0],comparatorOp=_ref12[1],value=_ref12[2];value=null!=new RegExp("^"+tokens.string+"$").exec(value)?value.substring(1,value.length-1):parseFloat(value),query.checks.push({type:Type_DATA_COMPARE,field:cleanMetaChars(variable),operator:comparatorOp,value:value})}},{name:"dataBool",query:!0,regex:"\\[\\s*("+tokens.boolOp+")\\s*("+tokens.variable+")\\s*\\]",populate:function(selector,query,_ref13){var _ref14=_slicedToArray(_ref13,2),boolOp=_ref14[0],variable=_ref14[1];query.checks.push({type:Type_DATA_BOOL,field:cleanMetaChars(variable),operator:boolOp})}},{name:"metaCompare",query:!0,regex:"\\[\\[\\s*("+tokens.meta+")\\s*("+tokens.comparatorOp+")\\s*("+tokens.number+")\\s*\\]\\]",populate:function(selector,query,_ref15){var _ref16=_slicedToArray(_ref15,3),meta=_ref16[0],comparatorOp=_ref16[1],number=_ref16[2];query.checks.push({type:Type_META_COMPARE,field:cleanMetaChars(meta),operator:comparatorOp,value:parseFloat(number)})}},{name:"nextQuery",separator:!0,regex:tokens.separator,populate:function(selector,query){var currentSubject=selector.currentSubject,edgeCount=selector.edgeCount,compoundCount=selector.compoundCount,lastQ=selector[selector.length-1];return null!=currentSubject&&(lastQ.subject=currentSubject,selector.currentSubject=null),lastQ.edgeCount=edgeCount,lastQ.compoundCount=compoundCount,selector.edgeCount=0,selector.compoundCount=0,selector[selector.length++]={checks:[]}}},{name:"directedEdge",separator:!0,regex:tokens.directedEdge,populate:function(selector,query){if(null==selector.currentSubject){var edgeQuery={checks:[]},source=query,target={checks:[]};return edgeQuery.checks.push({type:Type_DIRECTED_EDGE,source:source,target:target}),replaceLastQuery(selector,0,edgeQuery),selector.edgeCount++,target}var srcTgtQ={checks:[]},_source=query,_target={checks:[]};return srcTgtQ.checks.push({type:Type_NODE_SOURCE,source:_source,target:_target}),replaceLastQuery(selector,0,srcTgtQ),selector.edgeCount++,_target}},{name:"undirectedEdge",separator:!0,regex:tokens.undirectedEdge,populate:function(selector,query){if(null==selector.currentSubject){var edgeQuery={checks:[]},source=query,target={checks:[]};return edgeQuery.checks.push({type:Type_UNDIRECTED_EDGE,nodes:[source,target]}),replaceLastQuery(selector,0,edgeQuery),selector.edgeCount++,target}var nhoodQ={checks:[]},node=query,neighbor={checks:[]};return nhoodQ.checks.push({type:Type_NODE_NEIGHBOR,node:node,neighbor:neighbor}),replaceLastQuery(selector,0,nhoodQ),neighbor}},{name:"child",separator:!0,regex:tokens.child,populate:function(selector,query){if(null==selector.currentSubject){var parentChildQuery={checks:[]},child={checks:[]},parent=selector[selector.length-1];return parentChildQuery.checks.push({type:Type_CHILD,parent:parent,child:child}),replaceLastQuery(selector,0,parentChildQuery),selector.compoundCount++,child}if(selector.currentSubject===query){var compound={checks:[]},left=selector[selector.length-1],right={checks:[]},subject={checks:[]},_child={checks:[]},_parent={checks:[]};return compound.checks.push({type:Type_COMPOUND_SPLIT,left:left,right:right,subject:subject}),subject.checks=query.checks,query.checks=[{type:Type_TRUE}],_parent.checks.push({type:Type_TRUE}),right.checks.push({type:Type_PARENT,parent:_parent,child:_child}),replaceLastQuery(selector,0,compound),selector.currentSubject=subject,selector.compoundCount++,_child}var _parent2={checks:[]},_child2={checks:[]},pcQChecks=[{type:Type_PARENT,parent:_parent2,child:_child2}];return _parent2.checks=query.checks,query.checks=pcQChecks,selector.compoundCount++,_child2}},{name:"descendant",separator:!0,regex:tokens.descendant,populate:function(selector,query){if(null==selector.currentSubject){var ancChQuery={checks:[]},descendant={checks:[]},ancestor=selector[selector.length-1];return ancChQuery.checks.push({type:Type_DESCENDANT,ancestor:ancestor,descendant:descendant}),replaceLastQuery(selector,0,ancChQuery),selector.compoundCount++,descendant}if(selector.currentSubject===query){var compound={checks:[]},left=selector[selector.length-1],right={checks:[]},subject={checks:[]},_descendant={checks:[]},_ancestor={checks:[]};return compound.checks.push({type:Type_COMPOUND_SPLIT,left:left,right:right,subject:subject}),subject.checks=query.checks,query.checks=[{type:Type_TRUE}],_ancestor.checks.push({type:Type_TRUE}),right.checks.push({type:Type_ANCESTOR,ancestor:_ancestor,descendant:_descendant}),replaceLastQuery(selector,0,compound),selector.currentSubject=subject,selector.compoundCount++,_descendant}var _ancestor2={checks:[]},_descendant2={checks:[]},adQChecks=[{type:Type_ANCESTOR,ancestor:_ancestor2,descendant:_descendant2}];return _ancestor2.checks=query.checks,query.checks=adQChecks,selector.compoundCount++,_descendant2}},{name:"subject",modifier:!0,regex:tokens.subject,populate:function(selector,query){if(null!=selector.currentSubject&&selector.currentSubject!==query)return warn("Redefinition of subject in selector `"+selector.toString()+"`"),!1;selector.currentSubject=query;var topChk=selector[selector.length-1].checks[0],topType=null==topChk?null:topChk.type;topType===Type_DIRECTED_EDGE?topChk.type=Type_NODE_TARGET:topType===Type_UNDIRECTED_EDGE&&(topChk.type=Type_NODE_NEIGHBOR,topChk.node=topChk.nodes[1],topChk.neighbor=topChk.nodes[0],topChk.nodes=null)}}];exprs.forEach((function(e){return e.regexObj=new RegExp("^"+e.regex)}));var consumeExpr=function(remaining){for(var expr,match,name,j=0;j<exprs.length;j++){var e=exprs[j],n=e.name,m=remaining.match(e.regexObj);if(null!=m){match=m,expr=e,name=n;var consumed=m[0];remaining=remaining.substring(consumed.length);break}}return{expr:expr,match:match,name:name,remaining:remaining}},parse$1={parse:function(selector){var remaining=this.inputText=selector,currentQuery=this[0]={checks:[]};for(this.length=1,remaining=function(remaining){var match=remaining.match(/^\s+/);if(match){var consumed=match[0];remaining=remaining.substring(consumed.length)}return remaining}(remaining);;){var exprInfo=consumeExpr(remaining);if(null==exprInfo.expr)return warn("The selector `"+selector+"`is invalid"),!1;var args=exprInfo.match.slice(1),ret=exprInfo.expr.populate(this,currentQuery,args);if(!1===ret)return!1;if(null!=ret&&(currentQuery=ret),(remaining=exprInfo.remaining).match(/^\s*$/))break}var lastQ=this[this.length-1];null!=this.currentSubject&&(lastQ.subject=this.currentSubject),lastQ.edgeCount=this.edgeCount,lastQ.compoundCount=this.compoundCount;for(var i=0;i<this.length;i++){var q=this[i];if(q.compoundCount>0&&q.edgeCount>0)return warn("The selector `"+selector+"` is invalid because it uses both a compound selector and an edge selector"),!1;if(q.edgeCount>1)return warn("The selector `"+selector+"` is invalid because it uses multiple edge selectors"),!1;1===q.edgeCount&&warn("The selector `"+selector+"` is deprecated.  Edge selectors do not take effect on changes to source and target nodes after an edge is added, for performance reasons.  Use a class or data selector on edges instead, updating the class or data of an edge when your app detects a change in source or target nodes.")}return!0},toString:function(){if(null!=this.toStringCache)return this.toStringCache;for(var clean=function(obj){return null==obj?"":obj},cleanVal=function(val){return string(val)?'"'+val+'"':clean(val)},space=function(val){return" "+val+" "},checkToString=function(check,subject){var type=check.type,value=check.value;switch(type){case Type_GROUP:var group=clean(value);return group.substring(0,group.length-1);case Type_DATA_COMPARE:var field=check.field,operator=check.operator;return"["+field+space(clean(operator))+cleanVal(value)+"]";case Type_DATA_BOOL:var _operator=check.operator,_field=check.field;return"["+clean(_operator)+_field+"]";case Type_DATA_EXIST:return"["+check.field+"]";case Type_META_COMPARE:var _operator2=check.operator;return"[["+check.field+space(clean(_operator2))+cleanVal(value)+"]]";case Type_STATE:return value;case Type_ID:return"#"+value;case Type_CLASS:return"."+value;case Type_PARENT:case Type_CHILD:return queryToString(check.parent,subject)+space(">")+queryToString(check.child,subject);case Type_ANCESTOR:case Type_DESCENDANT:return queryToString(check.ancestor,subject)+" "+queryToString(check.descendant,subject);case Type_COMPOUND_SPLIT:var lhs=queryToString(check.left,subject),sub=queryToString(check.subject,subject),rhs=queryToString(check.right,subject);return lhs+(lhs.length>0?" ":"")+sub+rhs;case Type_TRUE:return""}},queryToString=function(query,subject){return query.checks.reduce((function(str,chk,i){return str+(subject===query&&0===i?"$":"")+checkToString(chk,subject)}),"")},str="",i=0;i<this.length;i++){var query=this[i];str+=queryToString(query,query.subject),this.length>1&&i<this.length-1&&(str+=", ")}return this.toStringCache=str,str}},valCmp=function(fieldVal,operator,value){var matches,fieldStr,valStr,isFieldStr=string(fieldVal),isFieldNum=number(fieldVal),isValStr=string(value),caseInsensitive=!1,notExpr=!1,isIneqCmp=!1;switch(operator.indexOf("!")>=0&&(operator=operator.replace("!",""),notExpr=!0),operator.indexOf("@")>=0&&(operator=operator.replace("@",""),caseInsensitive=!0),(isFieldStr||isValStr||caseInsensitive)&&(fieldStr=isFieldStr||isFieldNum?""+fieldVal:"",valStr=""+value),caseInsensitive&&(fieldVal=fieldStr=fieldStr.toLowerCase(),value=valStr=valStr.toLowerCase()),operator){case"*=":matches=fieldStr.indexOf(valStr)>=0;break;case"$=":matches=fieldStr.indexOf(valStr,fieldStr.length-valStr.length)>=0;break;case"^=":matches=0===fieldStr.indexOf(valStr);break;case"=":matches=fieldVal===value;break;case">":isIneqCmp=!0,matches=fieldVal>value;break;case">=":isIneqCmp=!0,matches=fieldVal>=value;break;case"<":isIneqCmp=!0,matches=fieldVal<value;break;case"<=":isIneqCmp=!0,matches=fieldVal<=value;break;default:matches=!1}return!notExpr||null==fieldVal&&isIneqCmp||(matches=!matches),matches},data=function(ele,field){return ele.data(field)},match=[],matches=function(query,ele){return query.checks.every((function(chk){return match[chk.type](chk,ele)}))};match[Type_GROUP]=function(check,ele){var group=check.value;return"*"===group||group===ele.group()},match[Type_STATE]=function(check,ele){return function(sel,ele){return lookup[sel](ele)}(check.value,ele)},match[Type_ID]=function(check,ele){var id=check.value;return ele.id()===id},match[Type_CLASS]=function(check,ele){var cls=check.value;return ele.hasClass(cls)},match[Type_META_COMPARE]=function(check,ele){var field=check.field,operator=check.operator,value=check.value;return valCmp(function(ele,field){return ele[field]()}(ele,field),operator,value)},match[Type_DATA_COMPARE]=function(check,ele){var field=check.field,operator=check.operator,value=check.value;return valCmp(data(ele,field),operator,value)},match[Type_DATA_BOOL]=function(check,ele){var field=check.field,operator=check.operator;return function(fieldVal,operator){switch(operator){case"?":return!!fieldVal;case"!":return!fieldVal;case"^":return void 0===fieldVal}}(data(ele,field),operator)},match[Type_DATA_EXIST]=function(check,ele){var field=check.field;check.operator;return void 0!==data(ele,field)},match[Type_UNDIRECTED_EDGE]=function(check,ele){var qA=check.nodes[0],qB=check.nodes[1],src=ele.source(),tgt=ele.target();return matches(qA,src)&&matches(qB,tgt)||matches(qB,src)&&matches(qA,tgt)},match[Type_NODE_NEIGHBOR]=function(check,ele){return matches(check.node,ele)&&ele.neighborhood().some((function(n){return n.isNode()&&matches(check.neighbor,n)}))},match[Type_DIRECTED_EDGE]=function(check,ele){return matches(check.source,ele.source())&&matches(check.target,ele.target())},match[Type_NODE_SOURCE]=function(check,ele){return matches(check.source,ele)&&ele.outgoers().some((function(n){return n.isNode()&&matches(check.target,n)}))},match[Type_NODE_TARGET]=function(check,ele){return matches(check.target,ele)&&ele.incomers().some((function(n){return n.isNode()&&matches(check.source,n)}))},match[Type_CHILD]=function(check,ele){return matches(check.child,ele)&&matches(check.parent,ele.parent())},match[Type_PARENT]=function(check,ele){return matches(check.parent,ele)&&ele.children().some((function(c){return matches(check.child,c)}))},match[Type_DESCENDANT]=function(check,ele){return matches(check.descendant,ele)&&ele.ancestors().some((function(a){return matches(check.ancestor,a)}))},match[Type_ANCESTOR]=function(check,ele){return matches(check.ancestor,ele)&&ele.descendants().some((function(d){return matches(check.descendant,d)}))},match[Type_COMPOUND_SPLIT]=function(check,ele){return matches(check.subject,ele)&&matches(check.left,ele)&&matches(check.right,ele)},match[Type_TRUE]=function(){return!0},match[Type_COLLECTION]=function(check,ele){return check.value.has(ele)},match[Type_FILTER]=function(check,ele){return(0,check.value)(ele)};var Selector=function(selector){this.inputText=selector,this.currentSubject=null,this.compoundCount=0,this.edgeCount=0,this.length=0,null==selector||string(selector)&&selector.match(/^\s*$/)||(elementOrCollection(selector)?this.addQuery({checks:[{type:Type_COLLECTION,value:selector.collection()}]}):fn(selector)?this.addQuery({checks:[{type:Type_FILTER,value:selector}]}):string(selector)?this.parse(selector)||(this.invalid=!0):error("A selector must be created from a string; found "))},selfn=Selector.prototype;[parse$1,{matches:function(ele){for(var j=0;j<this.length;j++){var query=this[j];if(matches(query,ele))return!0}return!1},filter:function(collection){var self=this;if(1===self.length&&1===self[0].checks.length&&self[0].checks[0].type===Type_ID)return collection.getElementById(self[0].checks[0].value).collection();var selectorFunction=function(element){for(var j=0;j<self.length;j++){var query=self[j];if(matches(query,element))return!0}return!1};return null==self.text()&&(selectorFunction=function(){return!0}),collection.filter(selectorFunction)}}].forEach((function(p){return extend(selfn,p)})),selfn.text=function(){return this.inputText},selfn.size=function(){return this.length},selfn.eq=function(i){return this[i]},selfn.sameText=function(otherSel){return!this.invalid&&!otherSel.invalid&&this.text()===otherSel.text()},selfn.addQuery=function(q){this[this.length++]=q},selfn.selector=selfn.toString;var elesfn$e={allAre:function(selector){var selObj=new Selector(selector);return this.every((function(ele){return selObj.matches(ele)}))},is:function(selector){var selObj=new Selector(selector);return this.some((function(ele){return selObj.matches(ele)}))},some:function(fn,thisArg){for(var i=0;i<this.length;i++){if(thisArg?fn.apply(thisArg,[this[i],i,this]):fn(this[i],i,this))return!0}return!1},every:function(fn,thisArg){for(var i=0;i<this.length;i++){if(!(thisArg?fn.apply(thisArg,[this[i],i,this]):fn(this[i],i,this)))return!1}return!0},same:function(collection){if(this===collection)return!0;collection=this.cy().collection(collection);var thisLength=this.length;return thisLength===collection.length&&(1===thisLength?this[0]===collection[0]:this.every((function(ele){return collection.hasElementWithId(ele.id())})))},anySame:function(collection){return collection=this.cy().collection(collection),this.some((function(ele){return collection.hasElementWithId(ele.id())}))},allAreNeighbors:function(collection){collection=this.cy().collection(collection);var nhood=this.neighborhood();return collection.every((function(ele){return nhood.hasElementWithId(ele.id())}))},contains:function(collection){collection=this.cy().collection(collection);var self=this;return collection.every((function(ele){return self.hasElementWithId(ele.id())}))}};elesfn$e.allAreNeighbours=elesfn$e.allAreNeighbors,elesfn$e.has=elesfn$e.contains,elesfn$e.equal=elesfn$e.equals=elesfn$e.same;var fn$1,elesfn$g,cache=function(fn,name){return function(arg1,arg2,arg3,arg4){var key,selectorOrEles=arg1;if(null==selectorOrEles?key="":elementOrCollection(selectorOrEles)&&1===selectorOrEles.length&&(key=selectorOrEles.id()),1===this.length&&key){var _p=this[0]._private,tch=_p.traversalCache=_p.traversalCache||{},ch=tch[name]=tch[name]||[],hash=hashString(key),cacheHit=ch[hash];return cacheHit||(ch[hash]=fn.call(this,arg1,arg2,arg3,arg4))}return fn.call(this,arg1,arg2,arg3,arg4)}},elesfn$f={parent:function(selector){var parents=[];if(1===this.length){var parent=this[0]._private.parent;if(parent)return parent}for(var i=0;i<this.length;i++){var _parent=this[i]._private.parent;_parent&&parents.push(_parent)}return this.spawn(parents,{unique:!0}).filter(selector)},parents:function(selector){for(var parents=[],eles=this.parent();eles.nonempty();){for(var i=0;i<eles.length;i++){var ele=eles[i];parents.push(ele)}eles=eles.parent()}return this.spawn(parents,{unique:!0}).filter(selector)},commonAncestors:function(selector){for(var ancestors,i=0;i<this.length;i++){var parents=this[i].parents();ancestors=(ancestors=ancestors||parents).intersect(parents)}return ancestors.filter(selector)},orphans:function(selector){return this.stdFilter((function(ele){return ele.isOrphan()})).filter(selector)},nonorphans:function(selector){return this.stdFilter((function(ele){return ele.isChild()})).filter(selector)},children:cache((function(selector){for(var children=[],i=0;i<this.length;i++)for(var eleChildren=this[i]._private.children,j=0;j<eleChildren.length;j++)children.push(eleChildren[j]);return this.spawn(children,{unique:!0}).filter(selector)}),"children"),siblings:function(selector){return this.parent().children().not(this).filter(selector)},isParent:function(){var ele=this[0];if(ele)return ele.isNode()&&0!==ele._private.children.length},isChildless:function(){var ele=this[0];if(ele)return ele.isNode()&&0===ele._private.children.length},isChild:function(){var ele=this[0];if(ele)return ele.isNode()&&null!=ele._private.parent},isOrphan:function(){var ele=this[0];if(ele)return ele.isNode()&&null==ele._private.parent},descendants:function(selector){var elements=[];return function add(eles){for(var i=0;i<eles.length;i++){var ele=eles[i];elements.push(ele),ele.children().nonempty()&&add(ele.children())}}(this.children()),this.spawn(elements,{unique:!0}).filter(selector)}};function forEachCompound(eles,fn,includeSelf,recursiveStep){for(var q=[],did=new Set$1,hasCompounds=eles.cy().hasCompoundNodes(),i=0;i<eles.length;i++){var ele=eles[i];includeSelf?q.push(ele):hasCompounds&&recursiveStep(q,did,ele)}for(;q.length>0;){var _ele=q.shift();fn(_ele),did.add(_ele.id()),hasCompounds&&recursiveStep(q,did,_ele)}return eles}function addChildren(q,did,ele){if(ele.isParent())for(var children=ele._private.children,i=0;i<children.length;i++){var child=children[i];did.has(child.id())||q.push(child)}}function addParent(q,did,ele){if(ele.isChild()){var parent=ele._private.parent;did.has(parent.id())||q.push(parent)}}function addParentAndChildren(q,did,ele){addParent(q,did,ele),addChildren(q,did,ele)}elesfn$f.forEachDown=function(fn){var includeSelf=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return forEachCompound(this,fn,includeSelf,addChildren)},elesfn$f.forEachUp=function(fn){var includeSelf=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return forEachCompound(this,fn,includeSelf,addParent)},elesfn$f.forEachUpAndDown=function(fn){var includeSelf=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return forEachCompound(this,fn,includeSelf,addParentAndChildren)},elesfn$f.ancestors=elesfn$f.parents,(fn$1=elesfn$g={data:define$3.data({field:"data",bindingEvent:"data",allowBinding:!0,allowSetting:!0,settingEvent:"data",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,immutableKeys:{id:!0,source:!0,target:!0,parent:!0},updateStyle:!0}),removeData:define$3.removeData({field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!0,immutableKeys:{id:!0,source:!0,target:!0,parent:!0},updateStyle:!0}),scratch:define$3.data({field:"scratch",bindingEvent:"scratch",allowBinding:!0,allowSetting:!0,settingEvent:"scratch",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeScratch:define$3.removeData({field:"scratch",event:"scratch",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0}),rscratch:define$3.data({field:"rscratch",allowBinding:!1,allowSetting:!0,settingTriggersEvent:!1,allowGetting:!0}),removeRscratch:define$3.removeData({field:"rscratch",triggerEvent:!1}),id:function(){var ele=this[0];if(ele)return ele._private.data.id}}).attr=fn$1.data,fn$1.removeAttr=fn$1.removeData;var fn$2,elesfn$i,data$1=elesfn$g,elesfn$h={};function defineDegreeFunction(callback){return function(includeLoops){if(void 0===includeLoops&&(includeLoops=!0),0!==this.length&&this.isNode()&&!this.removed()){for(var degree=0,node=this[0],connectedEdges=node._private.edges,i=0;i<connectedEdges.length;i++){var edge=connectedEdges[i];!includeLoops&&edge.isLoop()||(degree+=callback(node,edge))}return degree}}}function defineDegreeBoundsFunction(degreeFn,callback){return function(includeLoops){for(var ret,nodes=this.nodes(),i=0;i<nodes.length;i++){var degree=nodes[i][degreeFn](includeLoops);void 0===degree||void 0!==ret&&!callback(degree,ret)||(ret=degree)}return ret}}extend(elesfn$h,{degree:defineDegreeFunction((function(node,edge){return edge.source().same(edge.target())?2:1})),indegree:defineDegreeFunction((function(node,edge){return edge.target().same(node)?1:0})),outdegree:defineDegreeFunction((function(node,edge){return edge.source().same(node)?1:0}))}),extend(elesfn$h,{minDegree:defineDegreeBoundsFunction("degree",(function(degree,min){return degree<min})),maxDegree:defineDegreeBoundsFunction("degree",(function(degree,max){return degree>max})),minIndegree:defineDegreeBoundsFunction("indegree",(function(degree,min){return degree<min})),maxIndegree:defineDegreeBoundsFunction("indegree",(function(degree,max){return degree>max})),minOutdegree:defineDegreeBoundsFunction("outdegree",(function(degree,min){return degree<min})),maxOutdegree:defineDegreeBoundsFunction("outdegree",(function(degree,max){return degree>max}))}),extend(elesfn$h,{totalDegree:function(includeLoops){for(var total=0,nodes=this.nodes(),i=0;i<nodes.length;i++)total+=nodes[i].degree(includeLoops);return total}});var beforePositionSet=function(eles,newPos,silent){for(var i=0;i<eles.length;i++){var ele=eles[i];if(!ele.locked()){var oldPos=ele._private.position,delta={x:null!=newPos.x?newPos.x-oldPos.x:0,y:null!=newPos.y?newPos.y-oldPos.y:0};!ele.isParent()||0===delta.x&&0===delta.y||ele.children().shift(delta,silent),ele.shiftCachedBoundingBox(delta)}}},positionDef={field:"position",bindingEvent:"position",allowBinding:!0,allowSetting:!0,settingEvent:"position",settingTriggersEvent:!0,triggerFnName:"emitAndNotify",allowGetting:!0,validKeys:["x","y"],beforeGet:function(ele){ele.updateCompoundBounds()},beforeSet:function(eles,newPos){beforePositionSet(eles,newPos,!1)},onSet:function(eles){eles.dirtyCompoundBoundsCache()},canSet:function(ele){return!ele.locked()}};(fn$2=elesfn$i={position:define$3.data(positionDef),silentPosition:define$3.data(extend({},positionDef,{allowBinding:!1,allowSetting:!0,settingTriggersEvent:!1,allowGetting:!1,beforeSet:function(eles,newPos){beforePositionSet(eles,newPos,!0)}})),positions:function(pos,silent){if(plainObject(pos))silent?this.silentPosition(pos):this.position(pos);else if(fn(pos)){var _fn=pos,cy=this.cy();cy.startBatch();for(var i=0;i<this.length;i++){var _pos,ele=this[i];(_pos=_fn(ele,i))&&(silent?ele.silentPosition(_pos):ele.position(_pos))}cy.endBatch()}return this},silentPositions:function(pos){return this.positions(pos,!0)},shift:function(dim,val,silent){var delta;if(plainObject(dim)?(delta={x:number(dim.x)?dim.x:0,y:number(dim.y)?dim.y:0},silent=val):string(dim)&&number(val)&&((delta={x:0,y:0})[dim]=val),null!=delta){var cy=this.cy();cy.startBatch();for(var i=0;i<this.length;i++){var ele=this[i],pos=ele.position(),newPos={x:pos.x+delta.x,y:pos.y+delta.y};silent?ele.silentPosition(newPos):ele.position(newPos)}cy.endBatch()}return this},silentShift:function(dim,val){return plainObject(dim)?this.shift(dim,!0):string(dim)&&number(val)&&this.shift(dim,val,!0),this},renderedPosition:function(dim,val){var ele=this[0],cy=this.cy(),zoom=cy.zoom(),pan=cy.pan(),rpos=plainObject(dim)?dim:void 0,setting=void 0!==rpos||void 0!==val&&string(dim);if(ele&&ele.isNode()){if(!setting){var pos=ele.position();return rpos=modelToRenderedPosition(pos,zoom,pan),void 0===dim?rpos:rpos[dim]}for(var i=0;i<this.length;i++){var _ele=this[i];void 0!==val?_ele.position(dim,(val-pan[dim])/zoom):void 0!==rpos&&_ele.position(renderedToModelPosition(rpos,zoom,pan))}}else if(!setting)return;return this},relativePosition:function(dim,val){var ele=this[0],cy=this.cy(),ppos=plainObject(dim)?dim:void 0,setting=void 0!==ppos||void 0!==val&&string(dim),hasCompoundNodes=cy.hasCompoundNodes();if(ele&&ele.isNode()){if(!setting){var pos=ele.position(),_parent=hasCompoundNodes?ele.parent():null,_hasParent=_parent&&_parent.length>0,_relativeToParent=_hasParent;_hasParent&&(_parent=_parent[0]);var _origin=_relativeToParent?_parent.position():{x:0,y:0};return ppos={x:pos.x-_origin.x,y:pos.y-_origin.y},void 0===dim?ppos:ppos[dim]}for(var i=0;i<this.length;i++){var _ele2=this[i],parent=hasCompoundNodes?_ele2.parent():null,hasParent=parent&&parent.length>0,relativeToParent=hasParent;hasParent&&(parent=parent[0]);var origin=relativeToParent?parent.position():{x:0,y:0};void 0!==val?_ele2.position(dim,val+origin[dim]):void 0!==ppos&&_ele2.position({x:ppos.x+origin.x,y:ppos.y+origin.y})}}else if(!setting)return;return this}}).modelPosition=fn$2.point=fn$2.position,fn$2.modelPositions=fn$2.points=fn$2.positions,fn$2.renderedPoint=fn$2.renderedPosition,fn$2.relativePoint=fn$2.relativePosition;var fn$3,elesfn$j,position=elesfn$i;fn$3=elesfn$j={},elesfn$j.renderedBoundingBox=function(options){var bb=this.boundingBox(options),cy=this.cy(),zoom=cy.zoom(),pan=cy.pan(),x1=bb.x1*zoom+pan.x,x2=bb.x2*zoom+pan.x,y1=bb.y1*zoom+pan.y,y2=bb.y2*zoom+pan.y;return{x1:x1,x2:x2,y1:y1,y2:y2,w:x2-x1,h:y2-y1}},elesfn$j.dirtyCompoundBoundsCache=function(){var cy=this.cy();return cy.styleEnabled()&&cy.hasCompoundNodes()?(this.forEachUp((function(ele){if(ele.isParent()){var _p=ele._private;_p.compoundBoundsClean=!1,_p.bbCache=null,ele.emitAndNotify("bounds")}})),this):this},elesfn$j.updateCompoundBounds=function(){var force=arguments.length>0&&void 0!==arguments[0]&&arguments[0],cy=this.cy();if(!cy.styleEnabled()||!cy.hasCompoundNodes())return this;if(!force&&cy.batching())return this;function update(parent){if(parent.isParent()){var _p=parent._private,children=parent.children(),includeLabels="include"===parent.pstyle("compound-sizing-wrt-labels").value,min={width:{val:parent.pstyle("min-width").pfValue,left:parent.pstyle("min-width-bias-left"),right:parent.pstyle("min-width-bias-right")},height:{val:parent.pstyle("min-height").pfValue,top:parent.pstyle("min-height-bias-top"),bottom:parent.pstyle("min-height-bias-bottom")}},bb=children.boundingBox({includeLabels:includeLabels,includeOverlays:!1,useCache:!1}),pos=_p.position;0!==bb.w&&0!==bb.h||((bb={w:parent.pstyle("width").pfValue,h:parent.pstyle("height").pfValue}).x1=pos.x-bb.w/2,bb.x2=pos.x+bb.w/2,bb.y1=pos.y-bb.h/2,bb.y2=pos.y+bb.h/2);var leftVal=min.width.left.value;"px"===min.width.left.units&&min.width.val>0&&(leftVal=100*leftVal/min.width.val);var rightVal=min.width.right.value;"px"===min.width.right.units&&min.width.val>0&&(rightVal=100*rightVal/min.width.val);var topVal=min.height.top.value;"px"===min.height.top.units&&min.height.val>0&&(topVal=100*topVal/min.height.val);var bottomVal=min.height.bottom.value;"px"===min.height.bottom.units&&min.height.val>0&&(bottomVal=100*bottomVal/min.height.val);var widthBiasDiffs=computeBiasValues(min.width.val-bb.w,leftVal,rightVal),diffLeft=widthBiasDiffs.biasDiff,diffRight=widthBiasDiffs.biasComplementDiff,heightBiasDiffs=computeBiasValues(min.height.val-bb.h,topVal,bottomVal),diffTop=heightBiasDiffs.biasDiff,diffBottom=heightBiasDiffs.biasComplementDiff;_p.autoPadding=function(width,height,paddingObject,relativeTo){if("%"!==paddingObject.units)return"px"===paddingObject.units?paddingObject.pfValue:0;switch(relativeTo){case"width":return width>0?paddingObject.pfValue*width:0;case"height":return height>0?paddingObject.pfValue*height:0;case"average":return width>0&&height>0?paddingObject.pfValue*(width+height)/2:0;case"min":return width>0&&height>0?width>height?paddingObject.pfValue*height:paddingObject.pfValue*width:0;case"max":return width>0&&height>0?width>height?paddingObject.pfValue*width:paddingObject.pfValue*height:0;default:return 0}}(bb.w,bb.h,parent.pstyle("padding"),parent.pstyle("padding-relative-to").value),_p.autoWidth=Math.max(bb.w,min.width.val),pos.x=(-diffLeft+bb.x1+bb.x2+diffRight)/2,_p.autoHeight=Math.max(bb.h,min.height.val),pos.y=(-diffTop+bb.y1+bb.y2+diffBottom)/2}function computeBiasValues(propDiff,propBias,propBiasComplement){var biasDiff=0,biasComplementDiff=0,biasTotal=propBias+propBiasComplement;return propDiff>0&&biasTotal>0&&(biasDiff=propBias/biasTotal*propDiff,biasComplementDiff=propBiasComplement/biasTotal*propDiff),{biasDiff:biasDiff,biasComplementDiff:biasComplementDiff}}}for(var i=0;i<this.length;i++){var ele=this[i],_p=ele._private;_p.compoundBoundsClean||(update(ele),cy.batching()||(_p.compoundBoundsClean=!0))}return this};var noninf=function(x){return x===1/0||x===-1/0?0:x},updateBounds=function(b,x1,y1,x2,y2){x2-x1!=0&&y2-y1!=0&&null!=x1&&null!=y1&&null!=x2&&null!=y2&&(b.x1=x1<b.x1?x1:b.x1,b.x2=x2>b.x2?x2:b.x2,b.y1=y1<b.y1?y1:b.y1,b.y2=y2>b.y2?y2:b.y2,b.w=b.x2-b.x1,b.h=b.y2-b.y1)},updateBoundsFromBox=function(b,b2){return null==b2?b:updateBounds(b,b2.x1,b2.y1,b2.x2,b2.y2)},prefixedProperty=function(obj,field,prefix){return getPrefixedProperty(obj,field,prefix)},updateBoundsFromArrow=function(bounds,ele,prefix){if(!ele.cy().headless()){var x,y,_p=ele._private,rstyle=_p.rstyle,halfArW=rstyle.arrowWidth/2;if("none"!==ele.pstyle(prefix+"-arrow-shape").value){"source"===prefix?(x=rstyle.srcX,y=rstyle.srcY):"target"===prefix?(x=rstyle.tgtX,y=rstyle.tgtY):(x=rstyle.midX,y=rstyle.midY);var bbs=_p.arrowBounds=_p.arrowBounds||{},bb=bbs[prefix]=bbs[prefix]||{};bb.x1=x-halfArW,bb.y1=y-halfArW,bb.x2=x+halfArW,bb.y2=y+halfArW,bb.w=bb.x2-bb.x1,bb.h=bb.y2-bb.y1,expandBoundingBox(bb,1),updateBounds(bounds,bb.x1,bb.y1,bb.x2,bb.y2)}}},updateBoundsFromLabel=function(bounds,ele,prefix){if(!ele.cy().headless()){var prefixDash;prefixDash=prefix?prefix+"-":"";var _p=ele._private,rstyle=_p.rstyle;if(ele.pstyle(prefixDash+"label").strValue){var lx1,lx2,ly1,ly2,halign=ele.pstyle("text-halign"),valign=ele.pstyle("text-valign"),labelWidth=prefixedProperty(rstyle,"labelWidth",prefix),labelHeight=prefixedProperty(rstyle,"labelHeight",prefix),labelX=prefixedProperty(rstyle,"labelX",prefix),labelY=prefixedProperty(rstyle,"labelY",prefix),marginX=ele.pstyle(prefixDash+"text-margin-x").pfValue,marginY=ele.pstyle(prefixDash+"text-margin-y").pfValue,isEdge=ele.isEdge(),rotation=ele.pstyle(prefixDash+"text-rotation"),outlineWidth=ele.pstyle("text-outline-width").pfValue,halfBorderWidth=ele.pstyle("text-border-width").pfValue/2,padding=ele.pstyle("text-background-padding").pfValue,lh=labelHeight,lw=labelWidth,lw_2=lw/2,lh_2=lh/2;if(isEdge)lx1=labelX-lw_2,lx2=labelX+lw_2,ly1=labelY-lh_2,ly2=labelY+lh_2;else{switch(halign.value){case"left":lx1=labelX-lw,lx2=labelX;break;case"center":lx1=labelX-lw_2,lx2=labelX+lw_2;break;case"right":lx1=labelX,lx2=labelX+lw}switch(valign.value){case"top":ly1=labelY-lh,ly2=labelY;break;case"center":ly1=labelY-lh_2,ly2=labelY+lh_2;break;case"bottom":ly1=labelY,ly2=labelY+lh}}lx1+=marginX-Math.max(outlineWidth,halfBorderWidth)-padding,lx2+=marginX+Math.max(outlineWidth,halfBorderWidth)+padding,ly1+=marginY-Math.max(outlineWidth,halfBorderWidth)-padding,ly2+=marginY+Math.max(outlineWidth,halfBorderWidth)+padding;var bbPrefix=prefix||"main",bbs=_p.labelBounds,bb=bbs[bbPrefix]=bbs[bbPrefix]||{};bb.x1=lx1,bb.y1=ly1,bb.x2=lx2,bb.y2=ly2,bb.w=lx2-lx1,bb.h=ly2-ly1,expandBoundingBox(bb,1);var isAutorotate=isEdge&&"autorotate"===rotation.strValue,isPfValue=null!=rotation.pfValue&&0!==rotation.pfValue;if(isAutorotate||isPfValue){var theta=isAutorotate?prefixedProperty(_p.rstyle,"labelAngle",prefix):rotation.pfValue,cos=Math.cos(theta),sin=Math.sin(theta),xo=(lx1+lx2)/2,yo=(ly1+ly2)/2;if(!isEdge){switch(halign.value){case"left":xo=lx2;break;case"right":xo=lx1}switch(valign.value){case"top":yo=ly2;break;case"bottom":yo=ly1}}var rotate=function(x,y){return{x:(x-=xo)*cos-(y-=yo)*sin+xo,y:x*sin+y*cos+yo}},px1y1=rotate(lx1,ly1),px1y2=rotate(lx1,ly2),px2y1=rotate(lx2,ly1),px2y2=rotate(lx2,ly2);lx1=Math.min(px1y1.x,px1y2.x,px2y1.x,px2y2.x),lx2=Math.max(px1y1.x,px1y2.x,px2y1.x,px2y2.x),ly1=Math.min(px1y1.y,px1y2.y,px2y1.y,px2y2.y),ly2=Math.max(px1y1.y,px1y2.y,px2y1.y,px2y2.y)}updateBounds(bounds,lx1,ly1,lx2,ly2),updateBounds(_p.labelBounds.all,lx1,ly1,lx2,ly2)}return bounds}},getKey=function(opts){var i=0,tf=function(val){return(val?1:0)<<i++},key=0;return key+=tf(opts.incudeNodes),key+=tf(opts.includeEdges),key+=tf(opts.includeLabels),key+=tf(opts.includeMainLabels),key+=tf(opts.includeSourceLabels),key+=tf(opts.includeTargetLabels),key+=tf(opts.includeOverlays)},getBoundingBoxPosKey=function(ele){if(ele.isEdge()){var p1=ele.source().position(),p2=ele.target().position(),r=function(x){return Math.round(x)};return hashIntsArray([r(p1.x),r(p1.y),r(p2.x),r(p2.y)])}return 0},cachedBoundingBoxImpl=function(ele,opts){var bb,_p=ele._private,isEdge=ele.isEdge(),usingDefOpts=(null==opts?defBbOptsKey:getKey(opts))===defBbOptsKey,currPosKey=getBoundingBoxPosKey(ele),isPosKeySame=_p.bbCachePosKey===currPosKey,needRecalc=!(opts.useCache&&isPosKeySame)||null==_p.bbCache;if(needRecalc?(isPosKeySame||ele.recalculateRenderedStyle(),bb=function(ele,options){var ex1,ex2,ey1,ey2,x,y,bb,cy=ele._private.cy,styleEnabled=cy.styleEnabled(),headless=cy.headless(),bounds=makeBoundingBox(),_p=ele._private,isNode=ele.isNode(),isEdge=ele.isEdge(),rstyle=_p.rstyle,manualExpansion=isNode&&styleEnabled?ele.pstyle("bounds-expansion").pfValue:[0],isDisplayed=function(ele){return"none"!==ele.pstyle("display").value},displayed=!styleEnabled||isDisplayed(ele)&&(!isEdge||isDisplayed(ele.source())&&isDisplayed(ele.target()));if(displayed){var overlayPadding=0;styleEnabled&&options.includeOverlays&&0!==ele.pstyle("overlay-opacity").value&&(overlayPadding=ele.pstyle("overlay-padding").value);var wHalf=0;if(styleEnabled&&(wHalf=ele.pstyle("width").pfValue/2),isNode&&options.includeNodes){var pos=ele.position();x=pos.x,y=pos.y;var halfW=ele.outerWidth()/2,halfH=ele.outerHeight()/2;updateBounds(bounds,ex1=x-halfW,ey1=y-halfH,ex2=x+halfW,ey2=y+halfH)}else if(isEdge&&options.includeEdges)if(styleEnabled&&!headless&&(ex1=Math.min(rstyle.srcX,rstyle.midX,rstyle.tgtX),ex2=Math.max(rstyle.srcX,rstyle.midX,rstyle.tgtX),ey1=Math.min(rstyle.srcY,rstyle.midY,rstyle.tgtY),ey2=Math.max(rstyle.srcY,rstyle.midY,rstyle.tgtY),updateBounds(bounds,ex1-=wHalf,ey1-=wHalf,ex2+=wHalf,ey2+=wHalf)),styleEnabled&&!headless&&"haystack"===ele.pstyle("curve-style").strValue){var hpts=rstyle.haystackPts||[];if(ex1=hpts[0].x,ey1=hpts[0].y,ex1>(ex2=hpts[1].x)){var temp=ex1;ex1=ex2,ex2=temp}if(ey1>(ey2=hpts[1].y)){var _temp=ey1;ey1=ey2,ey2=_temp}updateBounds(bounds,ex1-wHalf,ey1-wHalf,ex2+wHalf,ey2+wHalf)}else{for(var pts=rstyle.bezierPts||rstyle.linePts||[],j=0;j<pts.length;j++){var pt=pts[j];ex1=pt.x-wHalf,ex2=pt.x+wHalf,ey1=pt.y-wHalf,ey2=pt.y+wHalf,updateBounds(bounds,ex1,ey1,ex2,ey2)}if(0===pts.length){var n1pos=ele.source().position(),n2pos=ele.target().position();if((ex1=n1pos.x)>(ex2=n2pos.x)){var _temp2=ex1;ex1=ex2,ex2=_temp2}if((ey1=n1pos.y)>(ey2=n2pos.y)){var _temp3=ey1;ey1=ey2,ey2=_temp3}updateBounds(bounds,ex1-=wHalf,ey1-=wHalf,ex2+=wHalf,ey2+=wHalf)}}if(styleEnabled&&options.includeEdges&&isEdge&&(updateBoundsFromArrow(bounds,ele,"mid-source"),updateBoundsFromArrow(bounds,ele,"mid-target"),updateBoundsFromArrow(bounds,ele,"source"),updateBoundsFromArrow(bounds,ele,"target")),styleEnabled)if("yes"===ele.pstyle("ghost").value){var gx=ele.pstyle("ghost-offset-x").pfValue,gy=ele.pstyle("ghost-offset-y").pfValue;updateBounds(bounds,bounds.x1+gx,bounds.y1+gy,bounds.x2+gx,bounds.y2+gy)}var bbBody=_p.bodyBounds=_p.bodyBounds||{};assignBoundingBox(bbBody,bounds),expandBoundingBoxSides(bbBody,manualExpansion),expandBoundingBox(bbBody,1),styleEnabled&&(ex1=bounds.x1,ex2=bounds.x2,ey1=bounds.y1,ey2=bounds.y2,updateBounds(bounds,ex1-overlayPadding,ey1-overlayPadding,ex2+overlayPadding,ey2+overlayPadding));var bbOverlay=_p.overlayBounds=_p.overlayBounds||{};assignBoundingBox(bbOverlay,bounds),expandBoundingBoxSides(bbOverlay,manualExpansion),expandBoundingBox(bbOverlay,1);var bbLabels=_p.labelBounds=_p.labelBounds||{};null!=bbLabels.all?((bb=bbLabels.all).x1=1/0,bb.y1=1/0,bb.x2=-1/0,bb.y2=-1/0,bb.w=0,bb.h=0):bbLabels.all=makeBoundingBox(),styleEnabled&&options.includeLabels&&(options.includeMainLabels&&updateBoundsFromLabel(bounds,ele,null),isEdge&&(options.includeSourceLabels&&updateBoundsFromLabel(bounds,ele,"source"),options.includeTargetLabels&&updateBoundsFromLabel(bounds,ele,"target")))}return bounds.x1=noninf(bounds.x1),bounds.y1=noninf(bounds.y1),bounds.x2=noninf(bounds.x2),bounds.y2=noninf(bounds.y2),bounds.w=noninf(bounds.x2-bounds.x1),bounds.h=noninf(bounds.y2-bounds.y1),bounds.w>0&&bounds.h>0&&displayed&&(expandBoundingBoxSides(bounds,manualExpansion),expandBoundingBox(bounds,1)),bounds}(ele,defBbOpts),_p.bbCache=bb,_p.bbCacheShift.x=_p.bbCacheShift.y=0,_p.bbCachePosKey=currPosKey):bb=_p.bbCache,!needRecalc&&(0!==_p.bbCacheShift.x||0!==_p.bbCacheShift.y)){var shift=assignShiftToBoundingBox,delta=_p.bbCacheShift,safeShift=function(bb,delta){null!=bb&&shift(bb,delta)};shift(bb,delta);var bodyBounds=_p.bodyBounds,overlayBounds=_p.overlayBounds,labelBounds=_p.labelBounds,arrowBounds=_p.arrowBounds;safeShift(bodyBounds,delta),safeShift(overlayBounds,delta),null!=arrowBounds&&(safeShift(arrowBounds.source,delta),safeShift(arrowBounds.target,delta),safeShift(arrowBounds["mid-source"],delta),safeShift(arrowBounds["mid-target"],delta)),null!=labelBounds&&(safeShift(labelBounds.main,delta),safeShift(labelBounds.all,delta),safeShift(labelBounds.source,delta),safeShift(labelBounds.target,delta))}if(_p.bbCacheShift.x=_p.bbCacheShift.y=0,!usingDefOpts){var isNode=ele.isNode();bb=makeBoundingBox(),(opts.includeNodes&&isNode||opts.includeEdges&&!isNode)&&(opts.includeOverlays?updateBoundsFromBox(bb,_p.overlayBounds):updateBoundsFromBox(bb,_p.bodyBounds)),opts.includeLabels&&(opts.includeMainLabels&&(!isEdge||opts.includeSourceLabels&&opts.includeTargetLabels)?updateBoundsFromBox(bb,_p.labelBounds.all):(opts.includeMainLabels&&updateBoundsFromBox(bb,_p.labelBounds.main),opts.includeSourceLabels&&updateBoundsFromBox(bb,_p.labelBounds.source),opts.includeTargetLabels&&updateBoundsFromBox(bb,_p.labelBounds.target))),bb.w=bb.x2-bb.x1,bb.h=bb.y2-bb.y1}return bb},defBbOpts={includeNodes:!0,includeEdges:!0,includeLabels:!0,includeMainLabels:!0,includeSourceLabels:!0,includeTargetLabels:!0,includeOverlays:!0,useCache:!0},defBbOptsKey=getKey(defBbOpts),filledBbOpts=defaults(defBbOpts);elesfn$j.boundingBox=function(options){var bounds;if(1!==this.length||null==this[0]._private.bbCache||void 0!==options&&void 0!==options.useCache&&!0!==options.useCache){bounds=makeBoundingBox();var opts=filledBbOpts(options=options||defBbOpts);if(this.cy().styleEnabled())for(var i=0;i<this.length;i++){var ele=this[i],_p=ele._private,currPosKey=getBoundingBoxPosKey(ele),isPosKeySame=_p.bbCachePosKey===currPosKey,useCache=opts.useCache&&isPosKeySame;ele.recalculateRenderedStyle(useCache)}this.updateCompoundBounds();for(var _i=0;_i<this.length;_i++){var _ele=this[_i];updateBoundsFromBox(bounds,cachedBoundingBoxImpl(_ele,opts))}}else options=void 0===options?defBbOpts:filledBbOpts(options),bounds=cachedBoundingBoxImpl(this[0],options);return bounds.x1=noninf(bounds.x1),bounds.y1=noninf(bounds.y1),bounds.x2=noninf(bounds.x2),bounds.y2=noninf(bounds.y2),bounds.w=noninf(bounds.x2-bounds.x1),bounds.h=noninf(bounds.y2-bounds.y1),bounds},elesfn$j.dirtyBoundingBoxCache=function(){for(var i=0;i<this.length;i++){var _p=this[i]._private;_p.bbCache=null,_p.bbCacheShift.x=_p.bbCacheShift.y=0,_p.bbCachePosKey=null,_p.bodyBounds=null,_p.overlayBounds=null,_p.labelBounds.all=null,_p.labelBounds.source=null,_p.labelBounds.target=null,_p.labelBounds.main=null,_p.arrowBounds.source=null,_p.arrowBounds.target=null,_p.arrowBounds["mid-source"]=null,_p.arrowBounds["mid-target"]=null}return this.emitAndNotify("bounds"),this},elesfn$j.shiftCachedBoundingBox=function(delta){for(var i=0;i<this.length;i++){var _p=this[i]._private;null!=_p.bbCache&&(_p.bbCacheShift.x+=delta.x,_p.bbCacheShift.y+=delta.y)}return this.emitAndNotify("bounds"),this},elesfn$j.boundingBoxAt=function(fn){var nodes=this.nodes(),cy=this.cy(),hasCompoundNodes=cy.hasCompoundNodes();if(hasCompoundNodes&&(nodes=nodes.filter((function(node){return!node.isParent()}))),plainObject(fn)){var obj=fn;fn=function(){return obj}}cy.startBatch(),nodes.forEach((function(node,i){return node._private.bbAtOldPos=fn(node,i)})).silentPositions(fn),hasCompoundNodes&&this.updateCompoundBounds(!0);var bb=function(bb){return{x1:bb.x1,x2:bb.x2,w:bb.w,y1:bb.y1,y2:bb.y2,h:bb.h}}(this.boundingBox({useCache:!1}));return nodes.silentPositions((function(node){return node._private.bbAtOldPos})),cy.endBatch(),bb},fn$3.boundingbox=fn$3.bb=fn$3.boundingBox,fn$3.renderedBoundingbox=fn$3.renderedBoundingBox;var fn$4,elesfn$k,bounds=elesfn$j;fn$4=elesfn$k={};var defineDimFns=function(opts){opts.uppercaseName=capitalize(opts.name),opts.autoName="auto"+opts.uppercaseName,opts.labelName="label"+opts.uppercaseName,opts.outerName="outer"+opts.uppercaseName,opts.uppercaseOuterName=capitalize(opts.outerName),fn$4[opts.name]=function(){var ele=this[0],_p=ele._private,styleEnabled=_p.cy._private.styleEnabled;if(ele){if(!styleEnabled)return 1;if(ele.isParent())return ele.updateCompoundBounds(),_p[opts.autoName]||0;var d=ele.pstyle(opts.name);switch(d.strValue){case"label":return ele.recalculateRenderedStyle(),_p.rstyle[opts.labelName]||0;default:return d.pfValue}}},fn$4["outer"+opts.uppercaseName]=function(){var ele=this[0],styleEnabled=ele._private.cy._private.styleEnabled;if(ele)return styleEnabled?ele[opts.name]()+ele.pstyle("border-width").pfValue+2*ele.padding():1},fn$4["rendered"+opts.uppercaseName]=function(){var ele=this[0];if(ele)return ele[opts.name]()*this.cy().zoom()},fn$4["rendered"+opts.uppercaseOuterName]=function(){var ele=this[0];if(ele)return ele[opts.outerName]()*this.cy().zoom()}};defineDimFns({name:"width"}),defineDimFns({name:"height"}),elesfn$k.padding=function(){var ele=this[0],_p=ele._private;return ele.isParent()?(ele.updateCompoundBounds(),void 0!==_p.autoPadding?_p.autoPadding:ele.pstyle("padding").pfValue):ele.pstyle("padding").pfValue},elesfn$k.paddedHeight=function(){var ele=this[0];return ele.height()+2*ele.padding()},elesfn$k.paddedWidth=function(){var ele=this[0];return ele.width()+2*ele.padding()};var widthHeight=elesfn$k,pts={controlPoints:{get:function(ele){return ele.renderer().getControlPoints(ele)},mult:!0},segmentPoints:{get:function(ele){return ele.renderer().getSegmentPoints(ele)},mult:!0},sourceEndpoint:{get:function(ele){return ele.renderer().getSourceEndpoint(ele)}},targetEndpoint:{get:function(ele){return ele.renderer().getTargetEndpoint(ele)}},midpoint:{get:function(ele){return ele.renderer().getEdgeMidpoint(ele)}}},edgePoints=Object.keys(pts).reduce((function(obj,name){var spec=pts[name],rName=function(name){return"rendered"+name[0].toUpperCase()+name.substr(1)}(name);return obj[name]=function(){return function(ele,getValue){if(ele.isEdge())return getValue(ele)}(this,spec.get)},spec.mult?obj[rName]=function(){return function(ele,getPoints){if(ele.isEdge()){var cy=ele.cy(),pan=cy.pan(),zoom=cy.zoom();return getPoints(ele).map((function(p){return modelToRenderedPosition(p,zoom,pan)}))}}(this,spec.get)}:obj[rName]=function(){return function(ele,getPoint){if(ele.isEdge()){var cy=ele.cy();return modelToRenderedPosition(getPoint(ele),cy.zoom(),cy.pan())}}(this,spec.get)},obj}),{}),dimensions=extend({},position,bounds,widthHeight,edgePoints),Event=function(src,props){this.recycle(src,props)};function returnFalse(){return!1}function returnTrue(){return!0}Event.prototype={instanceString:function(){return"event"},recycle:function(src,props){if(this.isImmediatePropagationStopped=this.isPropagationStopped=this.isDefaultPrevented=returnFalse,null!=src&&src.preventDefault?(this.type=src.type,this.isDefaultPrevented=src.defaultPrevented?returnTrue:returnFalse):null!=src&&src.type?props=src:this.type=src,null!=props&&(this.originalEvent=props.originalEvent,this.type=null!=props.type?props.type:this.type,this.cy=props.cy,this.target=props.target,this.position=props.position,this.renderedPosition=props.renderedPosition,this.namespace=props.namespace,this.layout=props.layout),null!=this.cy&&null!=this.position&&null==this.renderedPosition){var pos=this.position,zoom=this.cy.zoom(),pan=this.cy.pan();this.renderedPosition={x:pos.x*zoom+pan.x,y:pos.y*zoom+pan.y}}this.timeStamp=src&&src.timeStamp||Date.now()},preventDefault:function(){this.isDefaultPrevented=returnTrue;var e=this.originalEvent;e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){this.isPropagationStopped=returnTrue;var e=this.originalEvent;e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=returnTrue,this.stopPropagation()},isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,isImmediatePropagationStopped:returnFalse};var eventRegex=/^([^.]+)(\.(?:[^.]+))?$/,defaults$8={qualifierCompare:function(q1,q2){return q1===q2},eventMatches:function(){return!0},addEventFields:function(){},callbackContext:function(context){return context},beforeEmit:function(){},afterEmit:function(){},bubble:function(){return!1},parent:function(){return null},context:null},defaultsKeys=Object.keys(defaults$8),emptyOpts={};function Emitter(){for(var opts=arguments.length>0&&void 0!==arguments[0]?arguments[0]:emptyOpts,context=arguments.length>1?arguments[1]:void 0,i=0;i<defaultsKeys.length;i++){var key=defaultsKeys[i];this[key]=opts[key]||defaults$8[key]}this.context=context||this.context,this.listeners=[],this.emitting=0}var p=Emitter.prototype,forEachEvent=function(self,handler,events,qualifier,callback,conf,confOverrides){fn(qualifier)&&(callback=qualifier,qualifier=null),confOverrides&&(conf=null==conf?confOverrides:extend({},conf,confOverrides));for(var eventList=array(events)?events:events.split(/\s+/),i=0;i<eventList.length;i++){var evt=eventList[i];if(!emptyString(evt)){var match=evt.match(eventRegex);if(match)if(!1===handler(self,evt,match[1],match[2]?match[2]:null,qualifier,callback,conf))break}}},makeEventObj=function(self,obj){return self.addEventFields(self.context,obj),new Event(obj.type,obj)},forEachEventObj=function(self,handler,events){if("event"!==instanceStr(events))if(plainObject(events))handler(self,makeEventObj(self,events));else for(var eventList=array(events)?events:events.split(/\s+/),i=0;i<eventList.length;i++){var evt=eventList[i];if(!emptyString(evt)){var match=evt.match(eventRegex);if(match){var type=match[1],namespace=match[2]?match[2]:null;handler(self,makeEventObj(self,{type:type,namespace:namespace,target:self.context}))}}}else handler(self,events)};p.on=p.addListener=function(events,qualifier,callback,conf,confOverrides){return forEachEvent(this,(function(self,event,type,namespace,qualifier,callback,conf){fn(callback)&&self.listeners.push({event:event,callback:callback,type:type,namespace:namespace,qualifier:qualifier,conf:conf})}),events,qualifier,callback,conf,confOverrides),this},p.one=function(events,qualifier,callback,conf){return this.on(events,qualifier,callback,conf,{one:!0})},p.removeListener=p.off=function(events,qualifier,callback,conf){var _this=this;0!==this.emitting&&(this.listeners=this.listeners.slice());for(var listeners=this.listeners,_loop=function(i){var listener=listeners[i];forEachEvent(_this,(function(self,event,type,namespace,qualifier,callback){if((listener.type===type||"*"===events)&&(!namespace&&".*"!==listener.namespace||listener.namespace===namespace)&&(!qualifier||self.qualifierCompare(listener.qualifier,qualifier))&&(!callback||listener.callback===callback))return listeners.splice(i,1),!1}),events,qualifier,callback,conf)},i=listeners.length-1;i>=0;i--)_loop(i);return this},p.removeAllListeners=function(){return this.removeListener("*")},p.emit=p.trigger=function(events,extraParams,manualCallback){var listeners=this.listeners,numListenersBeforeEmit=listeners.length;return this.emitting++,array(extraParams)||(extraParams=[extraParams]),forEachEventObj(this,(function(self,eventObj){null!=manualCallback&&(listeners=[{event:eventObj.event,type:eventObj.type,namespace:eventObj.namespace,callback:manualCallback}],numListenersBeforeEmit=listeners.length);for(var _loop2=function(i){var listener=listeners[i];if(listener.type===eventObj.type&&(!listener.namespace||listener.namespace===eventObj.namespace||".*"===listener.namespace)&&self.eventMatches(self.context,listener,eventObj)){var args=[eventObj];null!=extraParams&&function(arr,otherArr){for(var i=0;i<otherArr.length;i++){var el=otherArr[i];arr.push(el)}}(args,extraParams),self.beforeEmit(self.context,listener,eventObj),listener.conf&&listener.conf.one&&(self.listeners=self.listeners.filter((function(l){return l!==listener})));var context=self.callbackContext(self.context,listener,eventObj),ret=listener.callback.apply(context,args);self.afterEmit(self.context,listener,eventObj),!1===ret&&(eventObj.stopPropagation(),eventObj.preventDefault())}},i=0;i<numListenersBeforeEmit;i++)_loop2(i);self.bubble(self.context)&&!eventObj.isPropagationStopped()&&self.parent(self.context).emit(eventObj,extraParams)}),events),this.emitting--,this};var emitterOptions={qualifierCompare:function(selector1,selector2){return null==selector1||null==selector2?null==selector1&&null==selector2:selector1.sameText(selector2)},eventMatches:function(ele,listener,eventObj){var selector=listener.qualifier;return null==selector||ele!==eventObj.target&&element(eventObj.target)&&selector.matches(eventObj.target)},addEventFields:function(ele,evt){evt.cy=ele.cy(),evt.target=ele},callbackContext:function(ele,listener,eventObj){return null!=listener.qualifier?eventObj.target:ele},beforeEmit:function(context,listener){listener.conf&&listener.conf.once&&listener.conf.onceCollection.removeListener(listener.event,listener.qualifier,listener.callback)},bubble:function(){return!0},parent:function(ele){return ele.isChild()?ele.parent():ele.cy()}},argSelector=function(arg){return string(arg)?new Selector(arg):arg},elesfn$l={createEmitter:function(){for(var i=0;i<this.length;i++){var ele=this[i],_p=ele._private;_p.emitter||(_p.emitter=new Emitter(emitterOptions,ele))}return this},emitter:function(){return this._private.emitter},on:function(events,selector,callback){for(var argSel=argSelector(selector),i=0;i<this.length;i++){this[i].emitter().on(events,argSel,callback)}return this},removeListener:function(events,selector,callback){for(var argSel=argSelector(selector),i=0;i<this.length;i++){this[i].emitter().removeListener(events,argSel,callback)}return this},removeAllListeners:function(){for(var i=0;i<this.length;i++){this[i].emitter().removeAllListeners()}return this},one:function(events,selector,callback){for(var argSel=argSelector(selector),i=0;i<this.length;i++){this[i].emitter().one(events,argSel,callback)}return this},once:function(events,selector,callback){for(var argSel=argSelector(selector),i=0;i<this.length;i++){this[i].emitter().on(events,argSel,callback,{once:!0,onceCollection:this})}},emit:function(events,extraParams){for(var i=0;i<this.length;i++){this[i].emitter().emit(events,extraParams)}return this},emitAndNotify:function(event,extraParams){if(0!==this.length)return this.cy().notify(event,this),this.emit(event,extraParams),this}};define$3.eventAliasesOn(elesfn$l);var elesfn$m={nodes:function(selector){return this.filter((function(ele){return ele.isNode()})).filter(selector)},edges:function(selector){return this.filter((function(ele){return ele.isEdge()})).filter(selector)},byGroup:function(){for(var nodes=this.spawn(),edges=this.spawn(),i=0;i<this.length;i++){var ele=this[i];ele.isNode()?nodes.merge(ele):edges.merge(ele)}return{nodes:nodes,edges:edges}},filter:function(_filter,thisArg){if(void 0===_filter)return this;if(string(_filter)||elementOrCollection(_filter))return new Selector(_filter).filter(this);if(fn(_filter)){for(var filterEles=this.spawn(),i=0;i<this.length;i++){var ele=this[i];(thisArg?_filter.apply(thisArg,[ele,i,this]):_filter(ele,i,this))&&filterEles.merge(ele)}return filterEles}return this.spawn()},not:function(toRemove){if(toRemove){string(toRemove)&&(toRemove=this.filter(toRemove));for(var elements=[],rMap=toRemove._private.map,i=0;i<this.length;i++){var element=this[i];rMap.has(element.id())||elements.push(element)}return this.spawn(elements)}return this},absoluteComplement:function(){return this.cy().mutableElements().not(this)},intersect:function(other){if(string(other)){var selector=other;return this.filter(selector)}for(var elements=[],col2=other,col1Smaller=this.length<other.length,map2=col1Smaller?col2._private.map:this._private.map,col=col1Smaller?this:col2,i=0;i<col.length;i++){var id=col[i]._private.data.id,entry=map2.get(id);entry&&elements.push(entry.ele)}return this.spawn(elements)},xor:function(other){var cy=this._private.cy;string(other)&&(other=cy.$(other));var elements=[],col2=other,add=function(col,other){for(var i=0;i<col.length;i++){var ele=col[i],id=ele._private.data.id;other.hasElementWithId(id)||elements.push(ele)}};return add(this,col2),add(col2,this),this.spawn(elements)},diff:function(other){var cy=this._private.cy;string(other)&&(other=cy.$(other));var left=[],right=[],both=[],col2=other,add=function(col,other,retEles){for(var i=0;i<col.length;i++){var ele=col[i],id=ele._private.data.id;other.hasElementWithId(id)?both.push(ele):retEles.push(ele)}};return add(this,col2,left),add(col2,this,right),{left:this.spawn(left,{unique:!0}),right:this.spawn(right,{unique:!0}),both:this.spawn(both,{unique:!0})}},add:function(toAdd){var cy=this._private.cy;if(!toAdd)return this;if(string(toAdd)){var selector=toAdd;toAdd=cy.mutableElements().filter(selector)}for(var elements=[],i=0;i<this.length;i++)elements.push(this[i]);for(var map=this._private.map,_i=0;_i<toAdd.length;_i++){var add=!map.has(toAdd[_i].id());add&&elements.push(toAdd[_i])}return this.spawn(elements)},merge:function(toAdd){var _p=this._private,cy=_p.cy;if(!toAdd)return this;if(toAdd&&string(toAdd)){var selector=toAdd;toAdd=cy.mutableElements().filter(selector)}for(var map=_p.map,i=0;i<toAdd.length;i++){var toAddEle=toAdd[i],id=toAddEle._private.data.id;if(!map.has(id)){var index=this.length++;this[index]=toAddEle,map.set(id,{ele:toAddEle,index:index})}else{var _index=map.get(id).index;this[_index]=toAddEle,map.set(id,{ele:toAddEle,index:_index})}}return this},unmergeAt:function(i){var id=this[i].id(),map=this._private.map;this[i]=void 0,map.delete(id);var unmergedLastEle=i===this.length-1;if(this.length>1&&!unmergedLastEle){var lastEleI=this.length-1,lastEle=this[lastEleI],lastEleId=lastEle._private.data.id;this[lastEleI]=void 0,this[i]=lastEle,map.set(lastEleId,{ele:lastEle,index:i})}return this.length--,this},unmergeOne:function(ele){ele=ele[0];var _p=this._private,id=ele._private.data.id,entry=_p.map.get(id);if(!entry)return this;var i=entry.index;return this.unmergeAt(i),this},unmerge:function(toRemove){var cy=this._private.cy;if(!toRemove)return this;if(toRemove&&string(toRemove)){var selector=toRemove;toRemove=cy.mutableElements().filter(selector)}for(var i=0;i<toRemove.length;i++)this.unmergeOne(toRemove[i]);return this},unmergeBy:function(toRmFn){for(var i=this.length-1;i>=0;i--){toRmFn(this[i])&&this.unmergeAt(i)}return this},map:function(mapFn,thisArg){for(var arr=[],i=0;i<this.length;i++){var ele=this[i],ret=thisArg?mapFn.apply(thisArg,[ele,i,this]):mapFn(ele,i,this);arr.push(ret)}return arr},reduce:function(fn,initialValue){for(var val=initialValue,i=0;i<this.length;i++)val=fn(val,this[i],i,this);return val},max:function(valFn,thisArg){for(var maxEle,max=-1/0,i=0;i<this.length;i++){var ele=this[i],val=thisArg?valFn.apply(thisArg,[ele,i,this]):valFn(ele,i,this);val>max&&(max=val,maxEle=ele)}return{value:max,ele:maxEle}},min:function(valFn,thisArg){for(var minEle,min=1/0,i=0;i<this.length;i++){var ele=this[i],val=thisArg?valFn.apply(thisArg,[ele,i,this]):valFn(ele,i,this);val<min&&(min=val,minEle=ele)}return{value:min,ele:minEle}}},fn$5=elesfn$m;fn$5.u=fn$5["|"]=fn$5["+"]=fn$5.union=fn$5.or=fn$5.add,fn$5["\\"]=fn$5["!"]=fn$5["-"]=fn$5.difference=fn$5.relativeComplement=fn$5.subtract=fn$5.not,fn$5.n=fn$5["&"]=fn$5["."]=fn$5.and=fn$5.intersection=fn$5.intersect,fn$5["^"]=fn$5["(+)"]=fn$5["(-)"]=fn$5.symmetricDifference=fn$5.symdiff=fn$5.xor,fn$5.fnFilter=fn$5.filterFn=fn$5.stdFilter=fn$5.filter,fn$5.complement=fn$5.abscomp=fn$5.absoluteComplement;var zIndexSort=function(a,b){var hasCompoundNodes=a.cy().hasCompoundNodes();function getDepth(ele){var style=ele.pstyle("z-compound-depth");return"auto"===style.value?hasCompoundNodes?ele.zDepth():0:"bottom"===style.value?-1:"top"===style.value?MAX_INT:0}var depthDiff=getDepth(a)-getDepth(b);if(0!==depthDiff)return depthDiff;function getEleDepth(ele){return"auto"===ele.pstyle("z-index-compare").value&&ele.isNode()?1:0}var eleDiff=getEleDepth(a)-getEleDepth(b);if(0!==eleDiff)return eleDiff;var zDiff=a.pstyle("z-index").value-b.pstyle("z-index").value;return 0!==zDiff?zDiff:a.poolIndex()-b.poolIndex()},elesfn$o={forEach:function(fn$1,thisArg){if(fn(fn$1))for(var N=this.length,i=0;i<N;i++){var ele=this[i];if(!1===(thisArg?fn$1.apply(thisArg,[ele,i,this]):fn$1(ele,i,this)))break}return this},toArray:function(){for(var array=[],i=0;i<this.length;i++)array.push(this[i]);return array},slice:function(start,end){var array=[],thisSize=this.length;null==end&&(end=thisSize),null==start&&(start=0),start<0&&(start=thisSize+start),end<0&&(end=thisSize+end);for(var i=start;i>=0&&i<end&&i<thisSize;i++)array.push(this[i]);return this.spawn(array)},size:function(){return this.length},eq:function(i){return this[i]||this.spawn()},first:function(){return this[0]||this.spawn()},last:function(){return this[this.length-1]||this.spawn()},empty:function(){return 0===this.length},nonempty:function(){return!this.empty()},sort:function(sortFn){if(!fn(sortFn))return this;var sorted=this.toArray().sort(sortFn);return this.spawn(sorted)},sortByZIndex:function(){return this.sort(zIndexSort)},zDepth:function(){var ele=this[0];if(ele){var _p=ele._private;if("nodes"===_p.group){var depth=_p.data.parent?ele.parents().size():0;return ele.isParent()?depth:MAX_INT-1}var src=_p.source,tgt=_p.target,srcDepth=src.zDepth(),tgtDepth=tgt.zDepth();return Math.max(srcDepth,tgtDepth,0)}}};elesfn$o.each=elesfn$o.forEach;var getLayoutDimensionOptions=defaults({nodeDimensionsIncludeLabels:!1}),elesfn$p={layoutDimensions:function(options){var dims;if(options=getLayoutDimensionOptions(options),this.takesUpSpace())if(options.nodeDimensionsIncludeLabels){var bbDim=this.boundingBox();dims={w:bbDim.w,h:bbDim.h}}else dims={w:this.outerWidth(),h:this.outerHeight()};else dims={w:0,h:0};return 0!==dims.w&&0!==dims.h||(dims.w=dims.h=1),dims},layoutPositions:function(layout,options,fn){var nodes=this.nodes(),cy=this.cy(),layoutEles=options.eles,getMemoizeKey=function(node){return node.id()},fnMem=memoize(fn,getMemoizeKey);layout.emit({type:"layoutstart",layout:layout}),layout.animations=[];var useSpacingFactor=options.spacingFactor&&1!==options.spacingFactor,bb=function(){if(!useSpacingFactor)return null;for(var bb=makeBoundingBox(),i=0;i<nodes.length;i++){var node=nodes[i],pos=fnMem(node,i);expandBoundingBoxByPoint(bb,pos.x,pos.y)}return bb}(),getFinalPos=memoize((function(node,i){var newPos=fnMem(node,i);useSpacingFactor&&(newPos=function(spacing,nodesBb,pos){var center_x=nodesBb.x1+nodesBb.w/2,center_y=nodesBb.y1+nodesBb.h/2;return{x:center_x+(pos.x-center_x)*spacing,y:center_y+(pos.y-center_y)*spacing}}(Math.abs(options.spacingFactor),bb,newPos));return null!=options.transform&&(newPos=options.transform(node,newPos)),newPos}),getMemoizeKey);if(options.animate){for(var i=0;i<nodes.length;i++){var node=nodes[i],newPos=getFinalPos(node,i);if(null==options.animateFilter||options.animateFilter(node,i)){var ani=node.animation({position:newPos,duration:options.animationDuration,easing:options.animationEasing});layout.animations.push(ani)}else node.position(newPos)}if(options.fit){var fitAni=cy.animation({fit:{boundingBox:layoutEles.boundingBoxAt(getFinalPos),padding:options.padding},duration:options.animationDuration,easing:options.animationEasing});layout.animations.push(fitAni)}else if(void 0!==options.zoom&&void 0!==options.pan){var zoomPanAni=cy.animation({zoom:options.zoom,pan:options.pan,duration:options.animationDuration,easing:options.animationEasing});layout.animations.push(zoomPanAni)}layout.animations.forEach((function(ani){return ani.play()})),layout.one("layoutready",options.ready),layout.emit({type:"layoutready",layout:layout}),Promise$1.all(layout.animations.map((function(ani){return ani.promise()}))).then((function(){layout.one("layoutstop",options.stop),layout.emit({type:"layoutstop",layout:layout})}))}else nodes.positions(getFinalPos),options.fit&&cy.fit(options.eles,options.padding),null!=options.zoom&&cy.zoom(options.zoom),options.pan&&cy.pan(options.pan),layout.one("layoutready",options.ready),layout.emit({type:"layoutready",layout:layout}),layout.one("layoutstop",options.stop),layout.emit({type:"layoutstop",layout:layout});return this},layout:function(options){return this.cy().makeLayout(extend({},options,{eles:this}))}};function styleCache(key,fn,ele){var val,_p=ele._private,cache=_p.styleCache=_p.styleCache||[];return null!=(val=cache[key])?val:val=cache[key]=fn(ele)}function cacheStyleFunction(key,fn){return key=hashString(key),function(ele){return styleCache(key,fn,ele)}}function cachePrototypeStyleFunction(key,fn){key=hashString(key);var selfFn=function(ele){return fn.call(ele)};return function(){var ele=this[0];if(ele)return styleCache(key,selfFn,ele)}}elesfn$p.createLayout=elesfn$p.makeLayout=elesfn$p.layout;var elesfn$q={recalculateRenderedStyle:function(useCache){var cy=this.cy(),renderer=cy.renderer(),styleEnabled=cy.styleEnabled();return renderer&&styleEnabled&&renderer.recalculateRenderedStyle(this,useCache),this},dirtyStyleCache:function(){var eles,cy=this.cy(),dirty=function(ele){return ele._private.styleCache=null};cy.hasCompoundNodes()?((eles=this.spawnSelf().merge(this.descendants()).merge(this.parents())).merge(eles.connectedEdges()),eles.forEach(dirty)):this.forEach((function(ele){dirty(ele),ele.connectedEdges().forEach(dirty)}));return this},updateStyle:function(notifyRenderer){var cy=this._private.cy;if(!cy.styleEnabled())return this;if(cy.batching())return cy._private.batchStyleEles.merge(this),this;var hasCompounds=cy.hasCompoundNodes(),style=cy.style(),updatedEles=this;notifyRenderer=!(!notifyRenderer&&void 0!==notifyRenderer),hasCompounds&&(updatedEles=this.spawnSelf().merge(this.descendants()).merge(this.parents()));var changedEles=style.apply(updatedEles);return notifyRenderer?changedEles.emitAndNotify("style"):changedEles.emit("style"),this},parsedStyle:function(property){var includeNonDefault=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],ele=this[0],cy=ele.cy();if(cy.styleEnabled()&&ele){var overriddenStyle=ele._private.style[property];return null!=overriddenStyle?overriddenStyle:includeNonDefault?cy.style().getDefaultProperty(property):null}},numericStyle:function(property){var ele=this[0];if(ele.cy().styleEnabled()&&ele){var pstyle=ele.pstyle(property);return void 0!==pstyle.pfValue?pstyle.pfValue:pstyle.value}},numericStyleUnits:function(property){var ele=this[0];if(ele.cy().styleEnabled())return ele?ele.pstyle(property).units:void 0},renderedStyle:function(property){var cy=this.cy();if(!cy.styleEnabled())return this;var ele=this[0];return ele?cy.style().getRenderedStyle(ele,property):void 0},style:function(name,value){var cy=this.cy();if(!cy.styleEnabled())return this;var style=cy.style();if(plainObject(name)){var props=name;style.applyBypass(this,props,!1),this.emitAndNotify("style")}else if(string(name)){if(void 0===value){var ele=this[0];return ele?style.getStylePropertyValue(ele,name):void 0}style.applyBypass(this,name,value,!1),this.emitAndNotify("style")}else if(void 0===name){var _ele=this[0];return _ele?style.getRawStyle(_ele):void 0}return this},removeStyle:function(names){var cy=this.cy();if(!cy.styleEnabled())return this;var style=cy.style();if(void 0===names)for(var i=0;i<this.length;i++){var ele=this[i];style.removeAllBypasses(ele,!1)}else{names=names.split(/\s+/);for(var _i=0;_i<this.length;_i++){var _ele2=this[_i];style.removeBypasses(_ele2,names,!1)}}return this.emitAndNotify("style"),this},show:function(){return this.css("display","element"),this},hide:function(){return this.css("display","none"),this},effectiveOpacity:function(){var cy=this.cy();if(!cy.styleEnabled())return 1;var hasCompoundNodes=cy.hasCompoundNodes(),ele=this[0];if(ele){var _p=ele._private,parentOpacity=ele.pstyle("opacity").value;if(!hasCompoundNodes)return parentOpacity;var parents=_p.data.parent?ele.parents():null;if(parents)for(var i=0;i<parents.length;i++){parentOpacity*=parents[i].pstyle("opacity").value}return parentOpacity}},transparent:function(){if(!this.cy().styleEnabled())return!1;var ele=this[0],hasCompoundNodes=ele.cy().hasCompoundNodes();return ele?hasCompoundNodes?0===ele.effectiveOpacity():0===ele.pstyle("opacity").value:void 0},backgrounding:function(){return!!this.cy().styleEnabled()&&!!this[0]._private.backgrounding}};function checkCompound(ele,parentOk){var parents=ele._private.data.parent?ele.parents():null;if(parents)for(var i=0;i<parents.length;i++){if(!parentOk(parents[i]))return!1}return!0}function defineDerivedStateFunction(specs){var ok=specs.ok,edgeOkViaNode=specs.edgeOkViaNode||specs.ok,parentOk=specs.parentOk||specs.ok;return function(){var cy=this.cy();if(!cy.styleEnabled())return!0;var ele=this[0],hasCompoundNodes=cy.hasCompoundNodes();if(ele){var _p=ele._private;if(!ok(ele))return!1;if(ele.isNode())return!hasCompoundNodes||checkCompound(ele,parentOk);var src=_p.source,tgt=_p.target;return edgeOkViaNode(src)&&(!hasCompoundNodes||checkCompound(src,edgeOkViaNode))&&(src===tgt||edgeOkViaNode(tgt)&&(!hasCompoundNodes||checkCompound(tgt,edgeOkViaNode)))}}}var eleTakesUpSpace=cacheStyleFunction("eleTakesUpSpace",(function(ele){return"element"===ele.pstyle("display").value&&0!==ele.width()&&(!ele.isNode()||0!==ele.height())}));elesfn$q.takesUpSpace=cachePrototypeStyleFunction("takesUpSpace",defineDerivedStateFunction({ok:eleTakesUpSpace}));var eleInteractive=cacheStyleFunction("eleInteractive",(function(ele){return"yes"===ele.pstyle("events").value&&"visible"===ele.pstyle("visibility").value&&eleTakesUpSpace(ele)})),parentInteractive=cacheStyleFunction("parentInteractive",(function(parent){return"visible"===parent.pstyle("visibility").value&&eleTakesUpSpace(parent)}));elesfn$q.interactive=cachePrototypeStyleFunction("interactive",defineDerivedStateFunction({ok:eleInteractive,parentOk:parentInteractive,edgeOkViaNode:eleTakesUpSpace})),elesfn$q.noninteractive=function(){var ele=this[0];if(ele)return!ele.interactive()};var eleVisible=cacheStyleFunction("eleVisible",(function(ele){return"visible"===ele.pstyle("visibility").value&&0!==ele.pstyle("opacity").pfValue&&eleTakesUpSpace(ele)})),edgeVisibleViaNode=eleTakesUpSpace;elesfn$q.visible=cachePrototypeStyleFunction("visible",defineDerivedStateFunction({ok:eleVisible,edgeOkViaNode:edgeVisibleViaNode})),elesfn$q.hidden=function(){var ele=this[0];if(ele)return!ele.visible()},elesfn$q.isBundledBezier=cachePrototypeStyleFunction("isBundledBezier",(function(){return!!this.cy().styleEnabled()&&(!this.removed()&&"bezier"===this.pstyle("curve-style").value&&this.takesUpSpace())})),elesfn$q.bypass=elesfn$q.css=elesfn$q.style,elesfn$q.renderedCss=elesfn$q.renderedStyle,elesfn$q.removeBypass=elesfn$q.removeCss=elesfn$q.removeStyle,elesfn$q.pstyle=elesfn$q.parsedStyle;var elesfn$r={};function defineSwitchFunction(params){return function(){var args=arguments,changedEles=[];if(2===args.length){var data=args[0],handler=args[1];this.on(params.event,data,handler)}else if(1===args.length&&fn(args[0])){var _handler=args[0];this.on(params.event,_handler)}else if(0===args.length||1===args.length&&array(args[0])){for(var addlEvents=1===args.length?args[0]:null,i=0;i<this.length;i++){var ele=this[i],able=!params.ableField||ele._private[params.ableField],changed=ele._private[params.field]!=params.value;if(params.overrideAble){var overrideAble=params.overrideAble(ele);if(void 0!==overrideAble&&(able=overrideAble,!overrideAble))return this}able&&(ele._private[params.field]=params.value,changed&&changedEles.push(ele))}var changedColl=this.spawn(changedEles);changedColl.updateStyle(),changedColl.emit(params.event),addlEvents&&changedColl.emit(addlEvents)}return this}}function defineSwitchSet(params){elesfn$r[params.field]=function(){var ele=this[0];if(ele){if(params.overrideField){var val=params.overrideField(ele);if(void 0!==val)return val}return ele._private[params.field]}},elesfn$r[params.on]=defineSwitchFunction({event:params.on,field:params.field,ableField:params.ableField,overrideAble:params.overrideAble,value:!0}),elesfn$r[params.off]=defineSwitchFunction({event:params.off,field:params.field,ableField:params.ableField,overrideAble:params.overrideAble,value:!1})}defineSwitchSet({field:"locked",overrideField:function(ele){return!!ele.cy().autolock()||void 0},on:"lock",off:"unlock"}),defineSwitchSet({field:"grabbable",overrideField:function(ele){return!ele.cy().autoungrabify()&&!ele.pannable()&&void 0},on:"grabify",off:"ungrabify"}),defineSwitchSet({field:"selected",ableField:"selectable",overrideAble:function(ele){return!ele.cy().autounselectify()&&void 0},on:"select",off:"unselect"}),defineSwitchSet({field:"selectable",overrideField:function(ele){return!ele.cy().autounselectify()&&void 0},on:"selectify",off:"unselectify"}),elesfn$r.deselect=elesfn$r.unselect,elesfn$r.grabbed=function(){var ele=this[0];if(ele)return ele._private.grabbed},defineSwitchSet({field:"active",on:"activate",off:"unactivate"}),defineSwitchSet({field:"pannable",on:"panify",off:"unpanify"}),elesfn$r.inactive=function(){var ele=this[0];if(ele)return!ele._private.active};var elesfn$s={},defineDagExtremity=function(params){return function(selector){for(var ret=[],i=0;i<this.length;i++){var ele=this[i];if(ele.isNode()){for(var disqualified=!1,edges=ele.connectedEdges(),j=0;j<edges.length;j++){var edge=edges[j],src=edge.source(),tgt=edge.target();if(params.noIncomingEdges&&tgt===ele&&src!==ele||params.noOutgoingEdges&&src===ele&&tgt!==ele){disqualified=!0;break}}disqualified||ret.push(ele)}}return this.spawn(ret,{unique:!0}).filter(selector)}},defineDagOneHop=function(params){return function(selector){for(var oEles=[],i=0;i<this.length;i++){var ele=this[i];if(ele.isNode())for(var edges=ele.connectedEdges(),j=0;j<edges.length;j++){var edge=edges[j],src=edge.source(),tgt=edge.target();params.outgoing&&src===ele?(oEles.push(edge),oEles.push(tgt)):params.incoming&&tgt===ele&&(oEles.push(edge),oEles.push(src))}}return this.spawn(oEles,{unique:!0}).filter(selector)}},defineDagAllHops=function(params){return function(selector){for(var eles=this,sEles=[],sElesIds={};;){var next=params.outgoing?eles.outgoers():eles.incomers();if(0===next.length)break;for(var newNext=!1,i=0;i<next.length;i++){var n=next[i],nid=n.id();sElesIds[nid]||(sElesIds[nid]=!0,sEles.push(n),newNext=!0)}if(!newNext)break;eles=next}return this.spawn(sEles,{unique:!0}).filter(selector)}};function defineSourceFunction(params){return function(selector){for(var sources=[],i=0;i<this.length;i++){var src=this[i]._private[params.attr];src&&sources.push(src)}return this.spawn(sources,{unique:!0}).filter(selector)}}function defineEdgesWithFunction(params){return function(otherNodes){var elements=[],cy=this._private.cy,p=params||{};string(otherNodes)&&(otherNodes=cy.$(otherNodes));for(var h=0;h<otherNodes.length;h++)for(var edges=otherNodes[h]._private.edges,i=0;i<edges.length;i++){var edge=edges[i],edgeData=edge._private.data,thisToOther=this.hasElementWithId(edgeData.source)&&otherNodes.hasElementWithId(edgeData.target),otherToThis=otherNodes.hasElementWithId(edgeData.source)&&this.hasElementWithId(edgeData.target);if(thisToOther||otherToThis){if(p.thisIsSrc||p.thisIsTgt){if(p.thisIsSrc&&!thisToOther)continue;if(p.thisIsTgt&&!otherToThis)continue}elements.push(edge)}}return this.spawn(elements,{unique:!0})}}function defineParallelEdgesFunction(params){return params=extend({},{codirected:!1},params),function(selector){for(var elements=[],edges=this.edges(),p=params,i=0;i<edges.length;i++)for(var edge1_p=edges[i]._private,src1=edge1_p.source,srcid1=src1._private.data.id,tgtid1=edge1_p.data.target,srcEdges1=src1._private.edges,j=0;j<srcEdges1.length;j++){var edge2=srcEdges1[j],edge2data=edge2._private.data,tgtid2=edge2data.target,srcid2=edge2data.source,codirected=tgtid2===tgtid1&&srcid2===srcid1,oppdirected=srcid1===tgtid2&&tgtid1===srcid2;(p.codirected&&codirected||!p.codirected&&(codirected||oppdirected))&&elements.push(edge2)}return this.spawn(elements,{unique:!0}).filter(selector)}}elesfn$s.clearTraversalCache=function(){for(var i=0;i<this.length;i++)this[i]._private.traversalCache=null},extend(elesfn$s,{roots:defineDagExtremity({noIncomingEdges:!0}),leaves:defineDagExtremity({noOutgoingEdges:!0}),outgoers:cache(defineDagOneHop({outgoing:!0}),"outgoers"),successors:defineDagAllHops({outgoing:!0}),incomers:cache(defineDagOneHop({incoming:!0}),"incomers"),predecessors:defineDagAllHops({incoming:!0})}),extend(elesfn$s,{neighborhood:cache((function(selector){for(var elements=[],nodes=this.nodes(),i=0;i<nodes.length;i++)for(var node=nodes[i],connectedEdges=node.connectedEdges(),j=0;j<connectedEdges.length;j++){var edge=connectedEdges[j],src=edge.source(),tgt=edge.target(),otherNode=node===src?tgt:src;otherNode.length>0&&elements.push(otherNode[0]),elements.push(edge[0])}return this.spawn(elements,{unique:!0}).filter(selector)}),"neighborhood"),closedNeighborhood:function(selector){return this.neighborhood().add(this).filter(selector)},openNeighborhood:function(selector){return this.neighborhood(selector)}}),elesfn$s.neighbourhood=elesfn$s.neighborhood,elesfn$s.closedNeighbourhood=elesfn$s.closedNeighborhood,elesfn$s.openNeighbourhood=elesfn$s.openNeighborhood,extend(elesfn$s,{source:cache((function(selector){var src,ele=this[0];return ele&&(src=ele._private.source||ele.cy().collection()),src&&selector?src.filter(selector):src}),"source"),target:cache((function(selector){var tgt,ele=this[0];return ele&&(tgt=ele._private.target||ele.cy().collection()),tgt&&selector?tgt.filter(selector):tgt}),"target"),sources:defineSourceFunction({attr:"source"}),targets:defineSourceFunction({attr:"target"})}),extend(elesfn$s,{edgesWith:cache(defineEdgesWithFunction(),"edgesWith"),edgesTo:cache(defineEdgesWithFunction({thisIsSrc:!0}),"edgesTo")}),extend(elesfn$s,{connectedEdges:cache((function(selector){for(var retEles=[],i=0;i<this.length;i++){var node=this[i];if(node.isNode())for(var edges=node._private.edges,j=0;j<edges.length;j++){var edge=edges[j];retEles.push(edge)}}return this.spawn(retEles,{unique:!0}).filter(selector)}),"connectedEdges"),connectedNodes:cache((function(selector){for(var retEles=[],i=0;i<this.length;i++){var edge=this[i];edge.isEdge()&&(retEles.push(edge.source()[0]),retEles.push(edge.target()[0]))}return this.spawn(retEles,{unique:!0}).filter(selector)}),"connectedNodes"),parallelEdges:cache(defineParallelEdgesFunction(),"parallelEdges"),codirectedEdges:cache(defineParallelEdgesFunction({codirected:!0}),"codirectedEdges")}),extend(elesfn$s,{components:function(root){var self=this,cy=self.cy(),visited=cy.collection(),unvisited=null==root?self.nodes():root.nodes(),components=[];null!=root&&unvisited.empty()&&(unvisited=root.sources());var visitInComponent=function(node,component){visited.merge(node),unvisited.unmerge(node),component.merge(node)};if(unvisited.empty())return self.spawn();var _loop=function(){var cmpt=cy.collection();components.push(cmpt);var root=unvisited[0];visitInComponent(root,cmpt),self.bfs({directed:!1,roots:root,visit:function(v){return visitInComponent(v,cmpt)}}),cmpt.forEach((function(node){node.connectedEdges().forEach((function(e){cmpt.has(e.source())&&cmpt.has(e.target())&&cmpt.merge(e)}))}))};do{_loop()}while(unvisited.length>0);return components},component:function(){var ele=this[0];return ele.cy().mutableElements().components(ele)[0]}}),elesfn$s.componentsOf=elesfn$s.components;var idFactory_generate=function(cy,element,tryThisId){for(var id=null!=tryThisId?tryThisId:uuid();cy.hasElementWithId(id);)id=uuid();return id},Collection=function(cy,elements,options){if(void 0!==cy&&core(cy)){var map=new Map$1,createdElements=!1;if(elements){if(elements.length>0&&plainObject(elements[0])&&!element(elements[0])){createdElements=!0;for(var eles=[],elesIds=new Set$1,i=0,l=elements.length;i<l;i++){var json=elements[i];null==json.data&&(json.data={});var _data=json.data;if(null==_data.id)_data.id=idFactory_generate(cy,json);else if(cy.hasElementWithId(_data.id)||elesIds.has(_data.id))continue;var ele=new Element(cy,json,!1);eles.push(ele),elesIds.add(_data.id)}elements=eles}}else elements=[];this.length=0;for(var _i=0,_l=elements.length;_i<_l;_i++){var element$1=elements[_i][0];if(null!=element$1){var id=element$1._private.data.id;(null==options||options.unique&&!map.has(id))&&(map.set(id,{index:this.length,ele:element$1}),this[this.length]=element$1,this.length++)}}this._private={cy:cy,map:map},createdElements&&this.restore()}else error("A collection must have a reference to the core")},elesfn$t=Element.prototype=Collection.prototype;elesfn$t.instanceString=function(){return"collection"},elesfn$t.spawn=function(cy,eles,opts){return core(cy)||(opts=eles,eles=cy,cy=this.cy()),new Collection(cy,eles,opts)},elesfn$t.spawnSelf=function(){return this.spawn(this)},elesfn$t.cy=function(){return this._private.cy},elesfn$t.renderer=function(){return this._private.cy.renderer()},elesfn$t.element=function(){return this[0]},elesfn$t.collection=function(){return collection(this)?this:new Collection(this._private.cy,[this])},elesfn$t.unique=function(){return new Collection(this._private.cy,this,{unique:!0})},elesfn$t.hasElementWithId=function(id){return id=""+id,this._private.map.has(id)},elesfn$t.getElementById=function(id){id=""+id;var cy=this._private.cy,entry=this._private.map.get(id);return entry?entry.ele:new Collection(cy)},elesfn$t.$id=elesfn$t.getElementById,elesfn$t.poolIndex=function(){var eles=this._private.cy._private.elements,id=this[0]._private.data.id;return eles._private.map.get(id).index},elesfn$t.indexOf=function(ele){var id=ele[0]._private.data.id;return this._private.map.get(id).index},elesfn$t.indexOfId=function(id){return id=""+id,this._private.map.get(id).index},elesfn$t.json=function(obj){var ele=this.element(),cy=this.cy();if(null==ele&&obj)return this;if(null!=ele){var p=ele._private;if(plainObject(obj)){if(cy.startBatch(),obj.data){ele.data(obj.data);var _data2=p.data;if(ele.isEdge()){var move=!1,spec={},src=obj.data.source,tgt=obj.data.target;null!=src&&src!=_data2.source&&(spec.source=""+src,move=!0),null!=tgt&&tgt!=_data2.target&&(spec.target=""+tgt,move=!0),move&&(ele=ele.move(spec))}else{var parent=obj.data.parent;null==parent&&null==_data2.parent||parent==_data2.parent||(void 0===parent&&(parent=null),null!=parent&&(parent=""+parent),ele=ele.move({parent:parent}))}}obj.position&&ele.position(obj.position);var checkSwitch=function(k,trueFnName,falseFnName){var obj_k=obj[k];null!=obj_k&&obj_k!==p[k]&&(obj_k?ele[trueFnName]():ele[falseFnName]())};return checkSwitch("removed","remove","restore"),checkSwitch("selected","select","unselect"),checkSwitch("selectable","selectify","unselectify"),checkSwitch("locked","lock","unlock"),checkSwitch("grabbable","grabify","ungrabify"),checkSwitch("pannable","panify","unpanify"),null!=obj.classes&&ele.classes(obj.classes),cy.endBatch(),this}if(void 0===obj){var json={data:copy(p.data),position:copy(p.position),group:p.group,removed:p.removed,selected:p.selected,selectable:p.selectable,locked:p.locked,grabbable:p.grabbable,pannable:p.pannable,classes:null};json.classes="";var i=0;return p.classes.forEach((function(cls){return json.classes+=0==i++?cls:" "+cls})),json}}},elesfn$t.jsons=function(){for(var jsons=[],i=0;i<this.length;i++){var json=this[i].json();jsons.push(json)}return jsons},elesfn$t.clone=function(){for(var cy=this.cy(),elesArr=[],i=0;i<this.length;i++){var json=this[i].json(),clone=new Element(cy,json,!1);elesArr.push(clone)}return new Collection(cy,elesArr)},elesfn$t.copy=elesfn$t.clone,elesfn$t.restore=function(){for(var elements,i,notifyRenderer=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],addToPool=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],self=this,cy=self.cy(),cy_p=cy._private,nodes=[],edges=[],_i2=0,l=self.length;_i2<l;_i2++){var ele=self[_i2];addToPool&&!ele.removed()||(ele.isNode()?nodes.push(ele):edges.push(ele))}elements=nodes.concat(edges);var removeFromElements=function(){elements.splice(i,1),i--};for(i=0;i<elements.length;i++){var _ele=elements[i],_private=_ele._private,_data3=_private.data;if(_ele.clearTraversalCache(),addToPool||_private.removed)if(void 0===_data3.id)_data3.id=idFactory_generate(cy,_ele);else if(number(_data3.id))_data3.id=""+_data3.id;else{if(emptyString(_data3.id)||!string(_data3.id)){error("Can not create element with invalid string ID `"+_data3.id+"`"),removeFromElements();continue}if(cy.hasElementWithId(_data3.id)){error("Can not create second element with ID `"+_data3.id+"`"),removeFromElements();continue}}else;var id=_data3.id;if(_ele.isNode()){var pos=_private.position;null==pos.x&&(pos.x=0),null==pos.y&&(pos.y=0)}if(_ele.isEdge()){for(var edge=_ele,fields=["source","target"],fieldsLength=fields.length,badSourceOrTarget=!1,j=0;j<fieldsLength;j++){var field=fields[j],val=_data3[field];number(val)&&(val=_data3[field]=""+_data3[field]),null==val||""===val?(error("Can not create edge `"+id+"` with unspecified "+field),badSourceOrTarget=!0):cy.hasElementWithId(val)||(error("Can not create edge `"+id+"` with nonexistant "+field+" `"+val+"`"),badSourceOrTarget=!0)}if(badSourceOrTarget){removeFromElements();continue}var src=cy.getElementById(_data3.source),tgt=cy.getElementById(_data3.target);src.same(tgt)?src._private.edges.push(edge):(src._private.edges.push(edge),tgt._private.edges.push(edge)),edge._private.source=src,edge._private.target=tgt}_private.map=new Map$1,_private.map.set(id,{ele:_ele,index:0}),_private.removed=!1,addToPool&&cy.addToPool(_ele)}for(var _i3=0;_i3<nodes.length;_i3++){var node=nodes[_i3],_data4=node._private.data;number(_data4.parent)&&(_data4.parent=""+_data4.parent);var parentId=_data4.parent,specifiedParent=null!=parentId;if(specifiedParent){var parent=cy.getElementById(parentId);if(parent.empty())_data4.parent=void 0;else{for(var selfAsParent=!1,ancestor=parent;!ancestor.empty();){if(node.same(ancestor)){selfAsParent=!0,_data4.parent=void 0;break}ancestor=ancestor.parent()}selfAsParent||(parent[0]._private.children.push(node),node._private.parent=parent[0],cy_p.hasCompoundNodes=!0)}}}if(elements.length>0){for(var restored=new Collection(cy,elements),_i4=0;_i4<restored.length;_i4++){var _ele2=restored[_i4];_ele2.isNode()||(_ele2.parallelEdges().clearTraversalCache(),_ele2.source().clearTraversalCache(),_ele2.target().clearTraversalCache())}(cy_p.hasCompoundNodes?cy.collection().merge(restored).merge(restored.connectedNodes()).merge(restored.parent()):restored).dirtyCompoundBoundsCache().dirtyBoundingBoxCache().updateStyle(notifyRenderer),notifyRenderer?restored.emitAndNotify("add"):addToPool&&restored.emit("add")}return self},elesfn$t.removed=function(){var ele=this[0];return ele&&ele._private.removed},elesfn$t.inside=function(){var ele=this[0];return ele&&!ele._private.removed},elesfn$t.remove=function(){var notifyRenderer=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],removeFromPool=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],self=this,elesToRemove=[],elesToRemoveIds={},cy=self._private.cy;function addConnectedEdges(node){for(var edges=node._private.edges,i=0;i<edges.length;i++)add(edges[i])}function addChildren(node){for(var children=node._private.children,i=0;i<children.length;i++)add(children[i])}function add(ele){var alreadyAdded=elesToRemoveIds[ele.id()];removeFromPool&&ele.removed()||alreadyAdded||(elesToRemoveIds[ele.id()]=!0,ele.isNode()?(elesToRemove.push(ele),addConnectedEdges(ele),addChildren(ele)):elesToRemove.unshift(ele))}for(var i=0,l=self.length;i<l;i++){var ele=self[i];add(ele)}function removeEdgeRef(node,edge){var connectedEdges=node._private.edges;removeFromArray(connectedEdges,edge),node.clearTraversalCache()}function removeParallelRef(pllEdge){pllEdge.clearTraversalCache()}var alteredParents=[];function removeChildRef(parent,ele){ele=ele[0];var children=(parent=parent[0])._private.children,pid=parent.id();removeFromArray(children,ele),ele._private.parent=null,alteredParents.ids[pid]||(alteredParents.ids[pid]=!0,alteredParents.push(parent))}alteredParents.ids={},self.dirtyCompoundBoundsCache(),removeFromPool&&cy.removeFromPool(elesToRemove);for(var _i5=0;_i5<elesToRemove.length;_i5++){var _ele3=elesToRemove[_i5];if(_ele3.isEdge()){var src=_ele3.source()[0],tgt=_ele3.target()[0];removeEdgeRef(src,_ele3),removeEdgeRef(tgt,_ele3);for(var pllEdges=_ele3.parallelEdges(),j=0;j<pllEdges.length;j++){var pllEdge=pllEdges[j];removeParallelRef(pllEdge),pllEdge.isBundledBezier()&&pllEdge.dirtyBoundingBoxCache()}}else{var parent=_ele3.parent();0!==parent.length&&removeChildRef(parent,_ele3)}removeFromPool&&(_ele3._private.removed=!0)}var elesStillInside=cy._private.elements;cy._private.hasCompoundNodes=!1;for(var _i6=0;_i6<elesStillInside.length;_i6++){var _ele4=elesStillInside[_i6];if(_ele4.isParent()){cy._private.hasCompoundNodes=!0;break}}var removedElements=new Collection(this.cy(),elesToRemove);removedElements.size()>0&&(notifyRenderer?removedElements.emitAndNotify("remove"):removeFromPool&&removedElements.emit("remove"));for(var _i7=0;_i7<alteredParents.length;_i7++){var _ele5=alteredParents[_i7];removeFromPool&&_ele5.removed()||_ele5.updateStyle()}return removedElements},elesfn$t.move=function(struct){var cy=this._private.cy,eles=this,toString=function(id){return null==id?id:""+id};if(void 0!==struct.source||void 0!==struct.target){var srcId=toString(struct.source),tgtId=toString(struct.target),srcExists=null!=srcId&&cy.hasElementWithId(srcId),tgtExists=null!=tgtId&&cy.hasElementWithId(tgtId);(srcExists||tgtExists)&&(cy.batch((function(){eles.remove(!1,!1),eles.emitAndNotify("moveout");for(var i=0;i<eles.length;i++){var ele=eles[i],_data5=ele._private.data;ele.isEdge()&&(srcExists&&(_data5.source=srcId),tgtExists&&(_data5.target=tgtId))}eles.restore(!1,!1)})),eles.emitAndNotify("move"))}else if(void 0!==struct.parent){var parentId=toString(struct.parent);if(null===parentId||cy.hasElementWithId(parentId)){var pidToAssign=null===parentId?void 0:parentId;cy.batch((function(){var updated=eles.remove(!1,!1);updated.emitAndNotify("moveout");for(var i=0;i<eles.length;i++){var ele=eles[i],_data6=ele._private.data;ele.isNode()&&(_data6.parent=pidToAssign)}updated.restore(!1,!1)})),eles.emitAndNotify("move")}}return this},[elesfn$b,elesfn$c,elesfn$d,elesfn$e,elesfn$f,data$1,elesfn$h,dimensions,elesfn$l,elesfn$m,{isNode:function(){return"nodes"===this.group()},isEdge:function(){return"edges"===this.group()},isLoop:function(){return this.isEdge()&&this.source()[0]===this.target()[0]},isSimple:function(){return this.isEdge()&&this.source()[0]!==this.target()[0]},group:function(){var ele=this[0];if(ele)return ele._private.group}},elesfn$o,elesfn$p,elesfn$q,elesfn$r,elesfn$s].forEach((function(props){extend(elesfn$t,props)}));var corefn={add:function(opts){var elements,cy=this;if(elementOrCollection(opts)){var eles=opts;if(eles._private.cy===cy)elements=eles.restore();else{for(var jsons=[],i=0;i<eles.length;i++){var ele=eles[i];jsons.push(ele.json())}elements=new Collection(cy,jsons)}}else if(array(opts)){elements=new Collection(cy,opts)}else if(plainObject(opts)&&(array(opts.nodes)||array(opts.edges))){for(var elesByGroup=opts,_jsons2=[],grs=["nodes","edges"],_i=0,il=grs.length;_i<il;_i++){var group=grs[_i],elesArray=elesByGroup[group];if(array(elesArray))for(var j=0,jl=elesArray.length;j<jl;j++){var json=extend({group:group},elesArray[j]);_jsons2.push(json)}}elements=new Collection(cy,_jsons2)}else{elements=new Element(cy,opts).collection()}return elements},remove:function(collection){if(elementOrCollection(collection));else if(string(collection)){var selector=collection;collection=this.$(selector)}return collection.remove()}};
/*! Bezier curve function generator. Copyright Gaetan Renaudeau. MIT License: http://en.wikipedia.org/wiki/MIT_License */
/*! Runge-Kutta spring physics function generator. Adapted from Framer.js, copyright Koen Bok. MIT License: http://en.wikipedia.org/wiki/MIT_License */
var generateSpringRK4=function(){function springAccelerationForState(state){return-state.tension*state.x-state.friction*state.v}function springEvaluateStateWithDerivative(initialState,dt,derivative){var state={x:initialState.x+derivative.dx*dt,v:initialState.v+derivative.dv*dt,tension:initialState.tension,friction:initialState.friction};return{dx:state.v,dv:springAccelerationForState(state)}}function springIntegrateState(state,dt){var a={dx:state.v,dv:springAccelerationForState(state)},b=springEvaluateStateWithDerivative(state,.5*dt,a),c=springEvaluateStateWithDerivative(state,.5*dt,b),d=springEvaluateStateWithDerivative(state,dt,c),dxdt=1/6*(a.dx+2*(b.dx+c.dx)+d.dx),dvdt=1/6*(a.dv+2*(b.dv+c.dv)+d.dv);return state.x=state.x+dxdt*dt,state.v=state.v+dvdt*dt,state}return function springRK4Factory(tension,friction,duration){var have_duration,dt,last_state,initState={x:-1,v:0,tension:null,friction:null},path=[0],time_lapsed=0;for(tension=parseFloat(tension)||500,friction=parseFloat(friction)||20,duration=duration||null,initState.tension=tension,initState.friction=friction,dt=(have_duration=null!==duration)?(time_lapsed=springRK4Factory(tension,friction))/duration*.016:.016;last_state=springIntegrateState(last_state||initState,dt),path.push(1+last_state.x),time_lapsed+=16,Math.abs(last_state.x)>1e-4&&Math.abs(last_state.v)>1e-4;);return have_duration?function(percentComplete){return path[percentComplete*(path.length-1)|0]}:time_lapsed}}(),cubicBezier=function(t1,p1,t2,p2){var bezier=function(mX1,mY1,mX2,mY2){var NEWTON_ITERATIONS=4,NEWTON_MIN_SLOPE=.001,SUBDIVISION_PRECISION=1e-7,SUBDIVISION_MAX_ITERATIONS=10,kSplineTableSize=11,kSampleStepSize=1/(kSplineTableSize-1),float32ArraySupported="undefined"!=typeof Float32Array;if(4!==arguments.length)return!1;for(var i=0;i<4;++i)if("number"!=typeof arguments[i]||isNaN(arguments[i])||!isFinite(arguments[i]))return!1;mX1=Math.min(mX1,1),mX2=Math.min(mX2,1),mX1=Math.max(mX1,0),mX2=Math.max(mX2,0);var mSampleValues=float32ArraySupported?new Float32Array(kSplineTableSize):new Array(kSplineTableSize);function A(aA1,aA2){return 1-3*aA2+3*aA1}function B(aA1,aA2){return 3*aA2-6*aA1}function C(aA1){return 3*aA1}function calcBezier(aT,aA1,aA2){return((A(aA1,aA2)*aT+B(aA1,aA2))*aT+C(aA1))*aT}function getSlope(aT,aA1,aA2){return 3*A(aA1,aA2)*aT*aT+2*B(aA1,aA2)*aT+C(aA1)}function newtonRaphsonIterate(aX,aGuessT){for(var _i=0;_i<NEWTON_ITERATIONS;++_i){var currentSlope=getSlope(aGuessT,mX1,mX2);if(0===currentSlope)return aGuessT;aGuessT-=(calcBezier(aGuessT,mX1,mX2)-aX)/currentSlope}return aGuessT}function calcSampleValues(){for(var _i2=0;_i2<kSplineTableSize;++_i2)mSampleValues[_i2]=calcBezier(_i2*kSampleStepSize,mX1,mX2)}function binarySubdivide(aX,aA,aB){var currentX,currentT,i=0;do{(currentX=calcBezier(currentT=aA+(aB-aA)/2,mX1,mX2)-aX)>0?aB=currentT:aA=currentT}while(Math.abs(currentX)>SUBDIVISION_PRECISION&&++i<SUBDIVISION_MAX_ITERATIONS);return currentT}function getTForX(aX){for(var intervalStart=0,currentSample=1,lastSample=kSplineTableSize-1;currentSample!==lastSample&&mSampleValues[currentSample]<=aX;++currentSample)intervalStart+=kSampleStepSize;--currentSample;var guessForT=intervalStart+(aX-mSampleValues[currentSample])/(mSampleValues[currentSample+1]-mSampleValues[currentSample])*kSampleStepSize,initialSlope=getSlope(guessForT,mX1,mX2);return initialSlope>=NEWTON_MIN_SLOPE?newtonRaphsonIterate(aX,guessForT):0===initialSlope?guessForT:binarySubdivide(aX,intervalStart,intervalStart+kSampleStepSize)}var _precomputed=!1;function precompute(){_precomputed=!0,mX1===mY1&&mX2===mY2||calcSampleValues()}var f=function(aX){return _precomputed||precompute(),mX1===mY1&&mX2===mY2?aX:0===aX?0:1===aX?1:calcBezier(getTForX(aX),mY1,mY2)};f.getControlPoints=function(){return[{x:mX1,y:mY1},{x:mX2,y:mY2}]};var str="generateBezier("+[mX1,mY1,mX2,mY2]+")";return f.toString=function(){return str},f}(t1,p1,t2,p2);return function(start,end,percent){return start+(end-start)*bezier(percent)}},easings={linear:function(start,end,percent){return start+(end-start)*percent},ease:cubicBezier(.25,.1,.25,1),"ease-in":cubicBezier(.42,0,1,1),"ease-out":cubicBezier(0,0,.58,1),"ease-in-out":cubicBezier(.42,0,.58,1),"ease-in-sine":cubicBezier(.47,0,.745,.715),"ease-out-sine":cubicBezier(.39,.575,.565,1),"ease-in-out-sine":cubicBezier(.445,.05,.55,.95),"ease-in-quad":cubicBezier(.55,.085,.68,.53),"ease-out-quad":cubicBezier(.25,.46,.45,.94),"ease-in-out-quad":cubicBezier(.455,.03,.515,.955),"ease-in-cubic":cubicBezier(.55,.055,.675,.19),"ease-out-cubic":cubicBezier(.215,.61,.355,1),"ease-in-out-cubic":cubicBezier(.645,.045,.355,1),"ease-in-quart":cubicBezier(.895,.03,.685,.22),"ease-out-quart":cubicBezier(.165,.84,.44,1),"ease-in-out-quart":cubicBezier(.77,0,.175,1),"ease-in-quint":cubicBezier(.755,.05,.855,.06),"ease-out-quint":cubicBezier(.23,1,.32,1),"ease-in-out-quint":cubicBezier(.86,0,.07,1),"ease-in-expo":cubicBezier(.95,.05,.795,.035),"ease-out-expo":cubicBezier(.19,1,.22,1),"ease-in-out-expo":cubicBezier(1,0,0,1),"ease-in-circ":cubicBezier(.6,.04,.98,.335),"ease-out-circ":cubicBezier(.075,.82,.165,1),"ease-in-out-circ":cubicBezier(.785,.135,.15,.86),spring:function(tension,friction,duration){if(0===duration)return easings.linear;var spring=generateSpringRK4(tension,friction,duration);return function(start,end,percent){return start+(end-start)*spring(percent)}},"cubic-bezier":cubicBezier};function getEasedValue(type,start,end,percent,easingFn){if(1===percent)return end;var val=easingFn(start,end,percent);return null==type||((type.roundValue||type.color)&&(val=Math.round(val)),void 0!==type.min&&(val=Math.max(val,type.min)),void 0!==type.max&&(val=Math.min(val,type.max))),val}function getValue(prop,spec){return null!=prop.pfValue||null!=prop.value?null==prop.pfValue||null!=spec&&"%"===spec.type.units?prop.value:prop.pfValue:prop}function ease(startProp,endProp,percent,easingFn,propSpec){var type=null!=propSpec?propSpec.type:null;percent<0?percent=0:percent>1&&(percent=1);var start=getValue(startProp,propSpec),end=getValue(endProp,propSpec);if(number(start)&&number(end))return getEasedValue(type,start,end,percent,easingFn);if(array(start)&&array(end)){for(var easedArr=[],i=0;i<end.length;i++){var si=start[i],ei=end[i];if(null!=si&&null!=ei){var val=getEasedValue(type,si,ei,percent,easingFn);easedArr.push(val)}else easedArr.push(ei)}return easedArr}}function step(self,ani,now,isCore){var isEles=!isCore,_p=self._private,ani_p=ani._private,pEasing=ani_p.easing,startTime=ani_p.startTime,style=(isCore?self:self.cy()).style();if(!ani_p.easingImpl)if(null==pEasing)ani_p.easingImpl=easings.linear;else{var easingVals,name,args;if(string(pEasing))easingVals=style.parse("transition-timing-function",pEasing).value;else easingVals=pEasing;string(easingVals)?(name=easingVals,args=[]):(name=easingVals[1],args=easingVals.slice(2).map((function(n){return+n}))),args.length>0?("spring"===name&&args.push(ani_p.duration),ani_p.easingImpl=easings[name].apply(null,args)):ani_p.easingImpl=easings[name]}var percent,easing=ani_p.easingImpl;if(percent=0===ani_p.duration?1:(now-startTime)/ani_p.duration,ani_p.applying&&(percent=ani_p.progress),percent<0?percent=0:percent>1&&(percent=1),null==ani_p.delay){var startPos=ani_p.startPosition,endPos=ani_p.position;if(endPos&&isEles&&!self.locked()){var newPos={};valid(startPos.x,endPos.x)&&(newPos.x=ease(startPos.x,endPos.x,percent,easing)),valid(startPos.y,endPos.y)&&(newPos.y=ease(startPos.y,endPos.y,percent,easing)),self.position(newPos)}var startPan=ani_p.startPan,endPan=ani_p.pan,pan=_p.pan,animatingPan=null!=endPan&&isCore;animatingPan&&(valid(startPan.x,endPan.x)&&(pan.x=ease(startPan.x,endPan.x,percent,easing)),valid(startPan.y,endPan.y)&&(pan.y=ease(startPan.y,endPan.y,percent,easing)),self.emit("pan"));var startZoom=ani_p.startZoom,endZoom=ani_p.zoom,animatingZoom=null!=endZoom&&isCore;animatingZoom&&(valid(startZoom,endZoom)&&(_p.zoom=bound(_p.minZoom,ease(startZoom,endZoom,percent,easing),_p.maxZoom)),self.emit("zoom")),(animatingPan||animatingZoom)&&self.emit("viewport");var props=ani_p.style;if(props&&props.length>0&&isEles){for(var i=0;i<props.length;i++){var prop=props[i],_name=prop.name,end=prop,start=ani_p.startStyle[_name],easedVal=ease(start,end,percent,easing,style.properties[start.name]);style.overrideBypass(self,_name,easedVal)}self.emit("style")}}return ani_p.progress=percent,percent}function valid(start,end){return null!=start&&null!=end&&(!(!number(start)||!number(end))||!(!start||!end))}function startAnimation(self,ani,now,isCore){var ani_p=ani._private;ani_p.started=!0,ani_p.startTime=now-ani_p.progress*ani_p.duration}function stepAll(now,cy){var eles=cy._private.aniEles,doneEles=[];function stepOne(ele,isCore){var _p=ele._private,current=_p.animation.current,queue=_p.animation.queue,ranAnis=!1;if(!isCore&&"none"===ele.pstyle("display").value){current=current.splice(0,current.length).concat(queue.splice(0,queue.length));for(var i=0;i<current.length;i++)current[i].stop()}if(0===current.length){var next=queue.shift();next&&current.push(next)}for(var callbacks=function(_callbacks){for(var j=_callbacks.length-1;j>=0;j--){(0,_callbacks[j])()}_callbacks.splice(0,_callbacks.length)},_i=current.length-1;_i>=0;_i--){var ani=current[_i],ani_p=ani._private;ani_p.stopped?(current.splice(_i,1),ani_p.hooked=!1,ani_p.playing=!1,ani_p.started=!1,callbacks(ani_p.frames)):(ani_p.playing||ani_p.applying)&&(ani_p.playing&&ani_p.applying&&(ani_p.applying=!1),ani_p.started||startAnimation(0,ani,now),step(ele,ani,now,isCore),ani_p.applying&&(ani_p.applying=!1),callbacks(ani_p.frames),null!=ani_p.step&&ani_p.step(now),ani.completed()&&(current.splice(_i,1),ani_p.hooked=!1,ani_p.playing=!1,ani_p.started=!1,callbacks(ani_p.completes)),ranAnis=!0)}return isCore||0!==current.length||0!==queue.length||doneEles.push(ele),ranAnis}for(var ranEleAni=!1,e=0;e<eles.length;e++){var handledThisEle=stepOne(eles[e]);ranEleAni=ranEleAni||handledThisEle}var ranCoreAni=stepOne(cy,!0);(ranEleAni||ranCoreAni)&&(eles.length>0?cy.notify("draw",eles):cy.notify("draw")),eles.unmerge(doneEles),cy.emit("step")}var corefn$1={animate:define$3.animate(),animation:define$3.animation(),animated:define$3.animated(),clearQueue:define$3.clearQueue(),delay:define$3.delay(),delayAnimation:define$3.delayAnimation(),stop:define$3.stop(),addToAnimationPool:function(eles){this.styleEnabled()&&this._private.aniEles.merge(eles)},stopAnimationLoop:function(){this._private.animationsRunning=!1},startAnimationLoop:function(){var cy=this;if(cy._private.animationsRunning=!0,cy.styleEnabled()){var renderer=cy.renderer();renderer&&renderer.beforeRender?renderer.beforeRender((function(willDraw,now){stepAll(now,cy)}),renderer.beforeRenderPriorities.animations):function headlessStep(){cy._private.animationsRunning&&requestAnimationFrame((function(now){stepAll(now,cy),headlessStep()}))}()}}},emitterOptions$1={qualifierCompare:function(selector1,selector2){return null==selector1||null==selector2?null==selector1&&null==selector2:selector1.sameText(selector2)},eventMatches:function(cy,listener,eventObj){var selector=listener.qualifier;return null==selector||cy!==eventObj.target&&element(eventObj.target)&&selector.matches(eventObj.target)},addEventFields:function(cy,evt){evt.cy=cy,evt.target=cy},callbackContext:function(cy,listener,eventObj){return null!=listener.qualifier?eventObj.target:cy}},argSelector$1=function(arg){return string(arg)?new Selector(arg):arg},elesfn$u={createEmitter:function(){var _p=this._private;return _p.emitter||(_p.emitter=new Emitter(emitterOptions$1,this)),this},emitter:function(){return this._private.emitter},on:function(events,selector,callback){return this.emitter().on(events,argSelector$1(selector),callback),this},removeListener:function(events,selector,callback){return this.emitter().removeListener(events,argSelector$1(selector),callback),this},removeAllListeners:function(){return this.emitter().removeAllListeners(),this},one:function(events,selector,callback){return this.emitter().one(events,argSelector$1(selector),callback),this},once:function(events,selector,callback){return this.emitter().one(events,argSelector$1(selector),callback),this},emit:function(events,extraParams){return this.emitter().emit(events,extraParams),this},emitAndNotify:function(event,eles){return this.emit(event),this.notify(event,eles),this}};define$3.eventAliasesOn(elesfn$u);var corefn$2={png:function(options){return options=options||{},this._private.renderer.png(options)},jpg:function(options){var renderer=this._private.renderer;return(options=options||{}).bg=options.bg||"#fff",renderer.jpg(options)}};corefn$2.jpeg=corefn$2.jpg;var corefn$3={layout:function(options){if(null!=options)if(null!=options.name){var name=options.name,Layout=this.extension("layout",name);if(null!=Layout){var eles;eles=string(options.eles)?this.$(options.eles):null!=options.eles?options.eles:this.$();var layout=new Layout(extend({},options,{cy:this,eles:eles}));return layout}error("No such layout `"+name+"` found.  Did you forget to import it and `cytoscape.use()` it?")}else error("A `name` must be specified to make a layout");else error("Layout options must be specified to make a layout")}};corefn$3.createLayout=corefn$3.makeLayout=corefn$3.layout;var corefn$4={notify:function(eventName,eventEles){var _p=this._private;if(this.batching()){_p.batchNotifications=_p.batchNotifications||{};var eles=_p.batchNotifications[eventName]=_p.batchNotifications[eventName]||this.collection();null!=eventEles&&eles.merge(eventEles)}else if(_p.notificationsEnabled){var renderer=this.renderer();!this.destroyed()&&renderer&&renderer.notify(eventName,eventEles)}},notifications:function(bool){var p=this._private;return void 0===bool?p.notificationsEnabled:(p.notificationsEnabled=!!bool,this)},noNotifications:function(callback){this.notifications(!1),callback(),this.notifications(!0)},batching:function(){return this._private.batchCount>0},startBatch:function(){var _p=this._private;return null==_p.batchCount&&(_p.batchCount=0),0===_p.batchCount&&(_p.batchStyleEles=this.collection(),_p.batchNotifications={}),_p.batchCount++,this},endBatch:function(){var _p=this._private;if(0===_p.batchCount)return this;if(_p.batchCount--,0===_p.batchCount){_p.batchStyleEles.updateStyle();var renderer=this.renderer();Object.keys(_p.batchNotifications).forEach((function(eventName){var eles=_p.batchNotifications[eventName];eles.empty()?renderer.notify(eventName):renderer.notify(eventName,eles)}))}return this},batch:function(callback){return this.startBatch(),callback(),this.endBatch(),this},batchData:function(map){var cy=this;return this.batch((function(){for(var ids=Object.keys(map),i=0;i<ids.length;i++){var id=ids[i],data=map[id];cy.getElementById(id).data(data)}}))}},rendererDefaults=defaults({hideEdgesOnViewport:!1,textureOnViewport:!1,motionBlur:!1,motionBlurOpacity:.05,pixelRatio:void 0,desktopTapThreshold:4,touchTapThreshold:8,wheelSensitivity:1,debug:!1,showFps:!1}),corefn$5={renderTo:function(context,zoom,pan,pxRatio){return this._private.renderer.renderTo(context,zoom,pan,pxRatio),this},renderer:function(){return this._private.renderer},forceRender:function(){return this.notify("draw"),this},resize:function(){return this.invalidateSize(),this.emitAndNotify("resize"),this},initRenderer:function(options){var RendererProto=this.extension("renderer",options.name);if(null!=RendererProto){void 0!==options.wheelSensitivity&&warn("You have set a custom wheel sensitivity.  This will make your app zoom unnaturally when using mainstream mice.  You should change this value from the default only if you can guarantee that all your users will use the same hardware and OS configuration as your current machine.");var rOpts=rendererDefaults(options);rOpts.cy=this,this._private.renderer=new RendererProto(rOpts),this.notify("init")}else error("Can not initialise: No such renderer `".concat(options.name,"` found. Did you forget to import it and `cytoscape.use()` it?"))},destroyRenderer:function(){this.notify("destroy");var domEle=this.container();if(domEle)for(domEle._cyreg=null;domEle.childNodes.length>0;)domEle.removeChild(domEle.childNodes[0]);this._private.renderer=null,this.mutableElements().forEach((function(ele){var _p=ele._private;_p.rscratch={},_p.rstyle={},_p.animation.current=[],_p.animation.queue=[]}))},onRender:function(fn){return this.on("render",fn)},offRender:function(fn){return this.off("render",fn)}};corefn$5.invalidateDimensions=corefn$5.resize;var corefn$6={collection:function(eles,opts){return string(eles)?this.$(eles):elementOrCollection(eles)?eles.collection():array(eles)?new Collection(this,eles,opts):new Collection(this)},nodes:function(selector){var nodes=this.$((function(ele){return ele.isNode()}));return selector?nodes.filter(selector):nodes},edges:function(selector){var edges=this.$((function(ele){return ele.isEdge()}));return selector?edges.filter(selector):edges},$:function(selector){var eles=this._private.elements;return selector?eles.filter(selector):eles.spawnSelf()},mutableElements:function(){return this._private.elements}};corefn$6.elements=corefn$6.filter=corefn$6.$;var styfn={};styfn.apply=function(eles){var _p=this._private,updatedEles=_p.cy.collection();_p.newStyle&&(_p.contextStyles={},_p.propDiffs={},this.cleanElements(eles,!0));for(var ie=0;ie<eles.length;ie++){var ele=eles[ie],cxtMeta=this.getContextMeta(ele);if(!cxtMeta.empty){var cxtStyle=this.getContextStyle(cxtMeta),app=this.applyContextStyle(cxtMeta,cxtStyle,ele);_p.newStyle||this.updateTransitions(ele,app.diffProps),this.updateStyleHints(ele)&&updatedEles.merge(ele)}}return _p.newStyle=!1,updatedEles},styfn.getPropertiesDiff=function(oldCxtKey,newCxtKey){var cache=this._private.propDiffs=this._private.propDiffs||{},dualCxtKey=oldCxtKey+"-"+newCxtKey,cachedVal=cache[dualCxtKey];if(cachedVal)return cachedVal;for(var diffProps=[],addedProp={},i=0;i<this.length;i++){var cxt=this[i],oldHasCxt="t"===oldCxtKey[i],newHasCxt="t"===newCxtKey[i],cxtHasDiffed=oldHasCxt!==newHasCxt,cxtHasMappedProps=cxt.mappedProperties.length>0;if(cxtHasDiffed||newHasCxt&&cxtHasMappedProps){var props=void 0;cxtHasDiffed&&cxtHasMappedProps||cxtHasDiffed?props=cxt.properties:cxtHasMappedProps&&(props=cxt.mappedProperties);for(var j=0;j<props.length;j++){for(var prop=props[j],name=prop.name,laterCxtOverrides=!1,k=i+1;k<this.length;k++){var laterCxt=this[k];if("t"===newCxtKey[k]&&(laterCxtOverrides=null!=laterCxt.properties[prop.name]))break}addedProp[name]||laterCxtOverrides||(addedProp[name]=!0,diffProps.push(name))}}}return cache[dualCxtKey]=diffProps,diffProps},styfn.getContextMeta=function(ele){var diffProps,cxtKey="",prevKey=ele._private.styleCxtKey||"";this._private.newStyle&&(prevKey="");for(var i=0;i<this.length;i++){var context=this[i];cxtKey+=context.selector&&context.selector.matches(ele)?"t":"f"}return diffProps=this.getPropertiesDiff(prevKey,cxtKey),ele._private.styleCxtKey=cxtKey,{key:cxtKey,diffPropNames:diffProps,empty:0===diffProps.length}},styfn.getContextStyle=function(cxtMeta){var cxtKey=cxtMeta.key,cxtStyles=this._private.contextStyles=this._private.contextStyles||{};if(cxtStyles[cxtKey])return cxtStyles[cxtKey];for(var style={_private:{key:cxtKey}},i=0;i<this.length;i++){var cxt=this[i];if("t"===cxtKey[i])for(var j=0;j<cxt.properties.length;j++){var prop=cxt.properties[j];style[prop.name]=prop}}return cxtStyles[cxtKey]=style,style},styfn.applyContextStyle=function(cxtMeta,cxtStyle,ele){for(var diffProps=cxtMeta.diffPropNames,retDiffProps={},types=this.types,i=0;i<diffProps.length;i++){var diffPropName=diffProps[i],cxtProp=cxtStyle[diffPropName],eleProp=ele.pstyle(diffPropName);if(!cxtProp){if(!eleProp)continue;cxtProp=eleProp.bypass?{name:diffPropName,deleteBypassed:!0}:{name:diffPropName,delete:!0}}if(eleProp!==cxtProp){if(cxtProp.mapped===types.fn&&null!=eleProp&&null!=eleProp.mapping&&eleProp.mapping.value===cxtProp.value){var mapping=eleProp.mapping;if((mapping.fnValue=cxtProp.value(ele))===mapping.prevFnValue)continue}var retDiffProp=retDiffProps[diffPropName]={prev:eleProp};this.applyParsedProperty(ele,cxtProp),retDiffProp.next=ele.pstyle(diffPropName),retDiffProp.next&&retDiffProp.next.bypass&&(retDiffProp.next=retDiffProp.next.bypassed)}}return{diffProps:retDiffProps}},styfn.updateStyleHints=function(ele){var _p=ele._private,self=this,propNames=self.propertyGroupNames,propGrKeys=self.propertyGroupKeys,propHash=function(ele,propNames,seedKey){return self.getPropertiesHash(ele,propNames,seedKey)},oldStyleKey=_p.styleKey;if(ele.removed())return!1;var isNode="nodes"===_p.group,overriddenStyles=ele._private.style;propNames=Object.keys(overriddenStyles);for(var i=0;i<propGrKeys.length;i++){var grKey=propGrKeys[i];_p.styleKeys[grKey]=0}for(var updateGrKey=function(val,grKey){return _p.styleKeys[grKey]=hashInt(val,_p.styleKeys[grKey])},updateGrKeyWStr=function(strVal,grKey){for(var j=0;j<strVal.length;j++)updateGrKey(strVal.charCodeAt(j),grKey)},cleanNum=function(val){return-128<val&&val<128&&Math.floor(val)!==val?2e9-(1024*val|0):val},_i=0;_i<propNames.length;_i++){var name=propNames[_i],parsedProp=overriddenStyles[name];if(null!=parsedProp){var propInfo=this.properties[name],type=propInfo.type,_grKey=propInfo.groupKey,normalizedNumberVal=void 0;null!=propInfo.hashOverride?normalizedNumberVal=propInfo.hashOverride(ele,parsedProp):null!=parsedProp.pfValue&&(normalizedNumberVal=parsedProp.pfValue);var numberVal=null==propInfo.enums?parsedProp.value:null,haveNormNum=null!=normalizedNumberVal,haveNum=haveNormNum||null!=numberVal,units=parsedProp.units;if(type.number&&haveNum){var v=haveNormNum?normalizedNumberVal:numberVal;if(type.multiple)for(var _i2=0;_i2<v.length;_i2++)updateGrKey(cleanNum(v[_i2]),_grKey);else updateGrKey(cleanNum(v),_grKey);haveNormNum||null==units||updateGrKeyWStr(units,_grKey)}else updateGrKeyWStr(parsedProp.strValue,_grKey)}}for(var hash=0,_i3=0;_i3<propGrKeys.length;_i3++){var _grKey2=propGrKeys[_i3],grHash=_p.styleKeys[_grKey2];hash=hashInt(grHash,hash)}_p.styleKey=hash;var labelDimsKey=_p.labelDimsKey=_p.styleKeys.labelDimensions;if(_p.labelKey=propHash(ele,["label"],labelDimsKey),_p.labelStyleKey=hashInt(_p.styleKeys.commonLabel,_p.labelKey),isNode||(_p.sourceLabelKey=propHash(ele,["source-label"],labelDimsKey),_p.sourceLabelStyleKey=hashInt(_p.styleKeys.commonLabel,_p.sourceLabelKey),_p.targetLabelKey=propHash(ele,["target-label"],labelDimsKey),_p.targetLabelStyleKey=hashInt(_p.styleKeys.commonLabel,_p.targetLabelKey)),isNode){var _p$styleKeys=_p.styleKeys,nodeBody=_p$styleKeys.nodeBody,nodeBorder=_p$styleKeys.nodeBorder,backgroundImage=_p$styleKeys.backgroundImage,compound=_p$styleKeys.compound,pie=_p$styleKeys.pie;_p.nodeKey=hashIntsArray([nodeBorder,backgroundImage,compound,pie],nodeBody),_p.hasPie=0!=pie}return oldStyleKey!==_p.styleKey},styfn.clearStyleHints=function(ele){var _p=ele._private;_p.styleKeys={},_p.styleKey=null,_p.labelKey=null,_p.labelStyleKey=null,_p.sourceLabelKey=null,_p.sourceLabelStyleKey=null,_p.targetLabelKey=null,_p.targetLabelStyleKey=null,_p.nodeKey=null,_p.hasPie=null},styfn.applyParsedProperty=function(ele,parsedProp){var flatProp,self=this,prop=parsedProp,style=ele._private.style,types=self.types,type=self.properties[prop.name].type,propIsBypass=prop.bypass,origProp=style[prop.name],origPropIsBypass=origProp&&origProp.bypass,_p=ele._private,getVal=function(p){return null==p?null:null!=p.pfValue?p.pfValue:p.value},checkTriggers=function(){var fromVal=getVal(origProp),toVal=getVal(prop);self.checkTriggers(ele,prop.name,fromVal,toVal)};if("curve-style"===parsedProp.name&&ele.isEdge()&&("bezier"!==parsedProp.value&&ele.isLoop()||"haystack"===parsedProp.value&&(ele.source().isParent()||ele.target().isParent()))&&(prop=parsedProp=this.parse(parsedProp.name,"bezier",propIsBypass)),prop.delete)return style[prop.name]=void 0,checkTriggers(),!0;if(prop.deleteBypassed)return origProp?!!origProp.bypass&&(origProp.bypassed=void 0,checkTriggers(),!0):(checkTriggers(),!0);if(prop.deleteBypass)return origProp?!!origProp.bypass&&(style[prop.name]=origProp.bypassed,checkTriggers(),!0):(checkTriggers(),!0);var printMappingErr=function(){warn("Do not assign mappings to elements without corresponding data (i.e. ele `"+ele.id()+"` has no mapping for property `"+prop.name+"` with data field `"+prop.field+"`); try a `["+prop.field+"]` selector to limit scope to elements with `"+prop.field+"` defined")};switch(prop.mapped){case types.mapData:for(var percent,fields=prop.field.split("."),fieldVal=_p.data,i=0;i<fields.length&&fieldVal;i++){fieldVal=fieldVal[fields[i]]}if(null==fieldVal)return printMappingErr(),!1;if(!number(fieldVal))return warn("Do not use continuous mappers without specifying numeric data (i.e. `"+prop.field+": "+fieldVal+"` for `"+ele.id()+"` is non-numeric)"),!1;var fieldWidth=prop.fieldMax-prop.fieldMin;if((percent=0===fieldWidth?0:(fieldVal-prop.fieldMin)/fieldWidth)<0?percent=0:percent>1&&(percent=1),type.color){var r1=prop.valueMin[0],r2=prop.valueMax[0],g1=prop.valueMin[1],g2=prop.valueMax[1],b1=prop.valueMin[2],b2=prop.valueMax[2],a1=null==prop.valueMin[3]?1:prop.valueMin[3],a2=null==prop.valueMax[3]?1:prop.valueMax[3],clr=[Math.round(r1+(r2-r1)*percent),Math.round(g1+(g2-g1)*percent),Math.round(b1+(b2-b1)*percent),Math.round(a1+(a2-a1)*percent)];flatProp={bypass:prop.bypass,name:prop.name,value:clr,strValue:"rgb("+clr[0]+", "+clr[1]+", "+clr[2]+")"}}else{if(!type.number)return!1;var calcValue=prop.valueMin+(prop.valueMax-prop.valueMin)*percent;flatProp=this.parse(prop.name,calcValue,prop.bypass,"mapping")}if(!flatProp)return printMappingErr(),!1;flatProp.mapping=prop,prop=flatProp;break;case types.data:for(var _fields=prop.field.split("."),_fieldVal=_p.data,_i4=0;_i4<_fields.length&&_fieldVal;_i4++){_fieldVal=_fieldVal[_fields[_i4]]}if(null!=_fieldVal&&(flatProp=this.parse(prop.name,_fieldVal,prop.bypass,"mapping")),!flatProp)return printMappingErr(),!1;flatProp.mapping=prop,prop=flatProp;break;case types.fn:var fn=prop.value,fnRetVal=null!=prop.fnValue?prop.fnValue:fn(ele);if(prop.prevFnValue=fnRetVal,null==fnRetVal)return warn("Custom function mappers may not return null (i.e. `"+prop.name+"` for ele `"+ele.id()+"` is null)"),!1;if(!(flatProp=this.parse(prop.name,fnRetVal,prop.bypass,"mapping")))return warn("Custom function mappers may not return invalid values for the property type (i.e. `"+prop.name+"` for ele `"+ele.id()+"` is invalid)"),!1;flatProp.mapping=copy(prop),prop=flatProp;break;case void 0:break;default:return!1}return propIsBypass?(prop.bypassed=origPropIsBypass?origProp.bypassed:origProp,style[prop.name]=prop):origPropIsBypass?origProp.bypassed=prop:style[prop.name]=prop,checkTriggers(),!0},styfn.cleanElements=function(eles,keepBypasses){for(var i=0;i<eles.length;i++){var ele=eles[i];if(this.clearStyleHints(ele),ele.dirtyCompoundBoundsCache(),ele.dirtyBoundingBoxCache(),keepBypasses)for(var style=ele._private.style,propNames=Object.keys(style),j=0;j<propNames.length;j++){var propName=propNames[j],eleProp=style[propName];null!=eleProp&&(eleProp.bypass?eleProp.bypassed=null:style[propName]=null)}else ele._private.style={}}},styfn.update=function(){this._private.cy.mutableElements().updateStyle()},styfn.updateTransitions=function(ele,diffProps){var self=this,_p=ele._private,props=ele.pstyle("transition-property").value,duration=ele.pstyle("transition-duration").pfValue,delay=ele.pstyle("transition-delay").pfValue;if(props.length>0&&duration>0){for(var style={},anyPrev=!1,i=0;i<props.length;i++){var prop=props[i],styProp=ele.pstyle(prop),diffProp=diffProps[prop];if(diffProp){var fromProp=diffProp.prev,toProp=null!=diffProp.next?diffProp.next:styProp,diff=!1,initVal=void 0;fromProp&&(number(fromProp.pfValue)&&number(toProp.pfValue)?(diff=toProp.pfValue-fromProp.pfValue,initVal=fromProp.pfValue+1e-6*diff):number(fromProp.value)&&number(toProp.value)?(diff=toProp.value-fromProp.value,initVal=fromProp.value+1e-6*diff):array(fromProp.value)&&array(toProp.value)&&(diff=fromProp.value[0]!==toProp.value[0]||fromProp.value[1]!==toProp.value[1]||fromProp.value[2]!==toProp.value[2],initVal=fromProp.strValue),diff&&(style[prop]=toProp.strValue,this.applyBypass(ele,prop,initVal),anyPrev=!0))}}if(!anyPrev)return;_p.transitioning=!0,new Promise$1((function(resolve){delay>0?ele.delayAnimation(delay).play().promise().then(resolve):resolve()})).then((function(){return ele.animation({style:style,duration:duration,easing:ele.pstyle("transition-timing-function").value,queue:!1}).play().promise()})).then((function(){self.removeBypasses(ele,props),ele.emitAndNotify("style"),_p.transitioning=!1}))}else _p.transitioning&&(this.removeBypasses(ele,props),ele.emitAndNotify("style"),_p.transitioning=!1)},styfn.checkTrigger=function(ele,name,fromValue,toValue,getTrigger,onTrigger){var prop=this.properties[name],triggerCheck=getTrigger(prop);null!=triggerCheck&&triggerCheck(fromValue,toValue)&&onTrigger(prop)},styfn.checkZOrderTrigger=function(ele,name,fromValue,toValue){var _this=this;this.checkTrigger(ele,name,fromValue,toValue,(function(prop){return prop.triggersZOrder}),(function(){_this._private.cy.notify("zorder",ele)}))},styfn.checkBoundsTrigger=function(ele,name,fromValue,toValue){this.checkTrigger(ele,name,fromValue,toValue,(function(prop){return prop.triggersBounds}),(function(prop){ele.dirtyCompoundBoundsCache(),ele.dirtyBoundingBoxCache(),"bezier"!==ele.pstyle("curve-style").value&&("curve-style"!==name||"bezier"!==fromValue&&"bezier"!==toValue)||!prop.triggersBoundsOfParallelBeziers||ele.parallelEdges().forEach((function(pllEdge){pllEdge.isBundledBezier()&&pllEdge.dirtyBoundingBoxCache()}))}))},styfn.checkTriggers=function(ele,name,fromValue,toValue){ele.dirtyStyleCache(),this.checkZOrderTrigger(ele,name,fromValue,toValue),this.checkBoundsTrigger(ele,name,fromValue,toValue)};var styfn$1={applyBypass:function(eles,name,value,updateTransitions){var props=[];if("*"===name||"**"===name){if(void 0!==value)for(var i=0;i<this.properties.length;i++){var _name=this.properties[i].name,parsedProp=this.parse(_name,value,!0);parsedProp&&props.push(parsedProp)}}else if(string(name)){var _parsedProp=this.parse(name,value,!0);_parsedProp&&props.push(_parsedProp)}else{if(!plainObject(name))return!1;var specifiedProps=name;updateTransitions=value;for(var names=Object.keys(specifiedProps),_i=0;_i<names.length;_i++){var _name2=names[_i],_value=specifiedProps[_name2];if(void 0===_value&&(_value=specifiedProps[dash2camel(_name2)]),void 0!==_value){var _parsedProp2=this.parse(_name2,_value,!0);_parsedProp2&&props.push(_parsedProp2)}}}if(0===props.length)return!1;for(var ret=!1,_i2=0;_i2<eles.length;_i2++){for(var ele=eles[_i2],diffProps={},diffProp=void 0,j=0;j<props.length;j++){var _prop=props[j];if(updateTransitions){var prevProp=ele.pstyle(_prop.name);diffProp=diffProps[_prop.name]={prev:prevProp}}ret=this.applyParsedProperty(ele,_prop)||ret,updateTransitions&&(diffProp.next=ele.pstyle(_prop.name))}ret&&this.updateStyleHints(ele),updateTransitions&&this.updateTransitions(ele,diffProps,!0)}return ret},overrideBypass:function(eles,name,value){name=camel2dash(name);for(var i=0;i<eles.length;i++){var ele=eles[i],prop=ele._private.style[name],type=this.properties[name].type,isColor=type.color,isMulti=type.mutiple,oldValue=prop?null!=prop.pfValue?prop.pfValue:prop.value:null;prop&&prop.bypass?(prop.value=value,null!=prop.pfValue&&(prop.pfValue=value),prop.strValue=isColor?"rgb("+value.join(",")+")":isMulti?value.join(" "):""+value,this.updateStyleHints(ele)):this.applyBypass(ele,name,value),this.checkTriggers(ele,name,oldValue,value)}},removeAllBypasses:function(eles,updateTransitions){return this.removeBypasses(eles,this.propertyNames,updateTransitions)},removeBypasses:function(eles,props,updateTransitions){for(var j=0;j<eles.length;j++){for(var ele=eles[j],diffProps={},i=0;i<props.length;i++){var name=props[i],prop=this.properties[name],prevProp=ele.pstyle(prop.name);if(prevProp&&prevProp.bypass){var parsedProp=this.parse(name,"",!0),diffProp=diffProps[prop.name]={prev:prevProp};this.applyParsedProperty(ele,parsedProp),diffProp.next=ele.pstyle(prop.name)}}this.updateStyleHints(ele),updateTransitions&&this.updateTransitions(ele,diffProps,!0)}}},styfn$2={getEmSizeInPixels:function(){var px=this.containerCss("font-size");return null!=px?parseFloat(px):1},containerCss:function(propName){var domElement=this._private.cy.container();if(window$1&&domElement&&window$1.getComputedStyle)return window$1.getComputedStyle(domElement).getPropertyValue(propName)}},styfn$3={getRenderedStyle:function(ele,prop){return prop?this.getStylePropertyValue(ele,prop,!0):this.getRawStyle(ele,!0)},getRawStyle:function(ele,isRenderedVal){if(ele=ele[0]){for(var rstyle={},i=0;i<this.properties.length;i++){var prop=this.properties[i],val=this.getStylePropertyValue(ele,prop.name,isRenderedVal);null!=val&&(rstyle[prop.name]=val,rstyle[dash2camel(prop.name)]=val)}return rstyle}},getIndexedStyle:function(ele,property,subproperty,index){var pstyle=ele.pstyle(property)[subproperty][index];return null!=pstyle?pstyle:ele.cy().style().getDefaultProperty(property)[subproperty][0]},getStylePropertyValue:function(ele,propName,isRenderedVal){if(ele=ele[0]){var prop=this.properties[propName];prop.alias&&(prop=prop.pointsTo);var type=prop.type,styleProp=ele.pstyle(prop.name);if(styleProp){var value=styleProp.value,units=styleProp.units,strValue=styleProp.strValue;if(isRenderedVal&&type.number&&null!=value&&number(value)){var zoom=ele.cy().zoom(),getRenderedValue=function(val){return val*zoom},getValueStringWithUnits=function(val,units){return getRenderedValue(val)+units},isArrayValue=array(value);return(isArrayValue?units.every((function(u){return null!=u})):null!=units)?isArrayValue?value.map((function(v,i){return getValueStringWithUnits(v,units[i])})).join(" "):getValueStringWithUnits(value,units):isArrayValue?value.map((function(v){return string(v)?v:""+getRenderedValue(v)})).join(" "):""+getRenderedValue(value)}if(null!=strValue)return strValue}return null}},getAnimationStartStyle:function(ele,aniProps){for(var rstyle={},i=0;i<aniProps.length;i++){var name=aniProps[i].name,styleProp=ele.pstyle(name);void 0!==styleProp&&(styleProp=plainObject(styleProp)?this.parse(name,styleProp.strValue):this.parse(name,styleProp)),styleProp&&(rstyle[name]=styleProp)}return rstyle},getPropsList:function(propsObj){var rstyle=[],style=propsObj,props=this.properties;if(style)for(var names=Object.keys(style),i=0;i<names.length;i++){var name=names[i],val=style[name],prop=props[name]||props[camel2dash(name)],styleProp=this.parse(prop.name,val);styleProp&&rstyle.push(styleProp)}return rstyle},getNonDefaultPropertiesHash:function(ele,propNames,seed){var name,val,strVal,chVal,i,j,hash=seed;for(i=0;i<propNames.length;i++)if(name=propNames[i],null!=(val=ele.pstyle(name,!1)))if(null!=val.pfValue)hash=hashInt(chVal,hash);else for(strVal=val.strValue,j=0;j<strVal.length;j++)chVal=strVal.charCodeAt(j),hash=hashInt(chVal,hash);return hash}};styfn$3.getPropertiesHash=styfn$3.getNonDefaultPropertiesHash;var styfn$4={appendFromJson:function(json){for(var i=0;i<json.length;i++){var context=json[i],selector=context.selector,props=context.style||context.css,names=Object.keys(props);this.selector(selector);for(var j=0;j<names.length;j++){var name=names[j],value=props[name];this.css(name,value)}}return this},fromJson:function(json){return this.resetToDefault(),this.appendFromJson(json),this},json:function(){for(var json=[],i=this.defaultLength;i<this.length;i++){for(var cxt=this[i],selector=cxt.selector,props=cxt.properties,css={},j=0;j<props.length;j++){var prop=props[j];css[prop.name]=prop.strValue}json.push({selector:selector?selector.toString():"core",style:css})}return json}},styfn$5={appendFromString:function(string){var selAndBlockStr,blockRem,propAndValStr,remaining=""+string;function removeSelAndBlockFromRemaining(){remaining=remaining.length>selAndBlockStr.length?remaining.substr(selAndBlockStr.length):""}function removePropAndValFromRem(){blockRem=blockRem.length>propAndValStr.length?blockRem.substr(propAndValStr.length):""}for(remaining=remaining.replace(/[/][*](\s|.)+?[*][/]/g,"");;){if(remaining.match(/^\s*$/))break;var selAndBlock=remaining.match(/^\s*((?:.|\s)+?)\s*\{((?:.|\s)+?)\}/);if(!selAndBlock){warn("Halting stylesheet parsing: String stylesheet contains more to parse but no selector and block found in: "+remaining);break}selAndBlockStr=selAndBlock[0];var selectorStr=selAndBlock[1];if("core"!==selectorStr)if(new Selector(selectorStr).invalid){warn("Skipping parsing of block: Invalid selector found in string stylesheet: "+selectorStr),removeSelAndBlockFromRemaining();continue}var blockStr=selAndBlock[2],invalidBlock=!1;blockRem=blockStr;for(var props=[];;){if(blockRem.match(/^\s*$/))break;var propAndVal=blockRem.match(/^\s*(.+?)\s*:\s*(.+?)\s*;/);if(!propAndVal){warn("Skipping parsing of block: Invalid formatting of style property and value definitions found in:"+blockStr),invalidBlock=!0;break}propAndValStr=propAndVal[0];var propStr=propAndVal[1],valStr=propAndVal[2];if(this.properties[propStr])this.parse(propStr,valStr)?(props.push({name:propStr,val:valStr}),removePropAndValFromRem()):(warn("Skipping property: Invalid property definition in: "+propAndValStr),removePropAndValFromRem());else warn("Skipping property: Invalid property name in: "+propAndValStr),removePropAndValFromRem()}if(invalidBlock){removeSelAndBlockFromRemaining();break}this.selector(selectorStr);for(var i=0;i<props.length;i++){var _prop=props[i];this.css(_prop.name,_prop.val)}removeSelAndBlockFromRemaining()}return this},fromString:function(string){return this.resetToDefault(),this.appendFromString(string),this}},styfn$6={};!function(){var number=number$1,data=function(prefix){return"^"+prefix+"\\s*\\(\\s*([\\w\\.]+)\\s*\\)$"},mapData=function(prefix){var mapArg=number+"|\\w+|rgb[a]?\\((?:(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%]?)\\s*,\\s*(?:(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%]?)\\s*,\\s*(?:(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%]?)(?:\\s*,\\s*(?:(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))))?\\)|hsl[a]?\\((?:(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?)))\\s*,\\s*(?:(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%])\\s*,\\s*(?:(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%])(?:\\s*,\\s*(?:(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))))?\\)|\\#[0-9a-fA-F]{3}|\\#[0-9a-fA-F]{6}";return"^"+prefix+"\\s*\\(([\\w\\.]+)\\s*\\,\\s*("+number+")\\s*\\,\\s*("+number+")\\s*,\\s*("+mapArg+")\\s*\\,\\s*("+mapArg+")\\)$"},urlRegexes=["^url\\s*\\(\\s*['\"]?(.+?)['\"]?\\s*\\)$","^(none)$","^(.+)$"];styfn$6.types={time:{number:!0,min:0,units:"s|ms",implicitUnits:"ms"},percent:{number:!0,min:0,max:100,units:"%",implicitUnits:"%"},percentages:{number:!0,min:0,max:100,units:"%",implicitUnits:"%",multiple:!0},zeroOneNumber:{number:!0,min:0,max:1,unitless:!0},zeroOneNumbers:{number:!0,min:0,max:1,unitless:!0,multiple:!0},nOneOneNumber:{number:!0,min:-1,max:1,unitless:!0},nonNegativeInt:{number:!0,min:0,integer:!0,unitless:!0},position:{enums:["parent","origin"]},nodeSize:{number:!0,min:0,enums:["label"]},number:{number:!0,unitless:!0},numbers:{number:!0,unitless:!0,multiple:!0},positiveNumber:{number:!0,unitless:!0,min:0,strictMin:!0},size:{number:!0,min:0},bidirectionalSize:{number:!0},bidirectionalSizes:{number:!0,multiple:!0},sizeMaybePercent:{number:!0,min:0,allowPercent:!0},axisDirection:{enums:["horizontal","leftward","rightward","vertical","upward","downward","auto"]},paddingRelativeTo:{enums:["width","height","average","min","max"]},bgWH:{number:!0,min:0,allowPercent:!0,enums:["auto"],multiple:!0},bgPos:{number:!0,allowPercent:!0,multiple:!0},bgRelativeTo:{enums:["inner","include-padding"],multiple:!0},bgRepeat:{enums:["repeat","repeat-x","repeat-y","no-repeat"],multiple:!0},bgFit:{enums:["none","contain","cover"],multiple:!0},bgCrossOrigin:{enums:["anonymous","use-credentials"],multiple:!0},bgClip:{enums:["none","node"],multiple:!0},color:{color:!0},colors:{color:!0,multiple:!0},fill:{enums:["solid","linear-gradient","radial-gradient"]},bool:{enums:["yes","no"]},lineStyle:{enums:["solid","dotted","dashed"]},lineCap:{enums:["butt","round","square"]},borderStyle:{enums:["solid","dotted","dashed","double"]},curveStyle:{enums:["bezier","unbundled-bezier","haystack","segments","straight","taxi"]},fontFamily:{regex:'^([\\w- \\"]+(?:\\s*,\\s*[\\w- \\"]+)*)$'},fontStyle:{enums:["italic","normal","oblique"]},fontWeight:{enums:["normal","bold","bolder","lighter","100","200","300","400","500","600","800","900",100,200,300,400,500,600,700,800,900]},textDecoration:{enums:["none","underline","overline","line-through"]},textTransform:{enums:["none","uppercase","lowercase"]},textWrap:{enums:["none","wrap","ellipsis"]},textOverflowWrap:{enums:["whitespace","anywhere"]},textBackgroundShape:{enums:["rectangle","roundrectangle","round-rectangle"]},nodeShape:{enums:["rectangle","roundrectangle","round-rectangle","cutrectangle","cut-rectangle","bottomroundrectangle","bottom-round-rectangle","barrel","ellipse","triangle","square","pentagon","hexagon","concavehexagon","concave-hexagon","heptagon","octagon","tag","star","diamond","vee","rhomboid","polygon"]},compoundIncludeLabels:{enums:["include","exclude"]},arrowShape:{enums:["tee","triangle","triangle-tee","triangle-cross","triangle-backcurve","vee","square","circle","diamond","chevron","none"]},arrowFill:{enums:["filled","hollow"]},display:{enums:["element","none"]},visibility:{enums:["hidden","visible"]},zCompoundDepth:{enums:["bottom","orphan","auto","top"]},zIndexCompare:{enums:["auto","manual"]},valign:{enums:["top","center","bottom"]},halign:{enums:["left","center","right"]},justification:{enums:["left","center","right","auto"]},text:{string:!0},data:{mapping:!0,regex:data("data")},layoutData:{mapping:!0,regex:data("layoutData")},scratch:{mapping:!0,regex:data("scratch")},mapData:{mapping:!0,regex:mapData("mapData")},mapLayoutData:{mapping:!0,regex:mapData("mapLayoutData")},mapScratch:{mapping:!0,regex:mapData("mapScratch")},fn:{mapping:!0,fn:!0},url:{regexes:urlRegexes,singleRegexMatchValue:!0},urls:{regexes:urlRegexes,singleRegexMatchValue:!0,multiple:!0},propList:{propList:!0},angle:{number:!0,units:"deg|rad",implicitUnits:"rad"},textRotation:{number:!0,units:"deg|rad",implicitUnits:"rad",enums:["none","autorotate"]},polygonPointList:{number:!0,multiple:!0,evenMultiple:!0,min:-1,max:1,unitless:!0},edgeDistances:{enums:["intersection","node-position"]},edgeEndpoint:{number:!0,multiple:!0,units:"%|px|em|deg|rad",implicitUnits:"px",enums:["inside-to-node","outside-to-node","outside-to-node-or-label","outside-to-line","outside-to-line-or-label"],singleEnum:!0,validate:function(valArr,unitsArr){switch(valArr.length){case 2:return"deg"!==unitsArr[0]&&"rad"!==unitsArr[0]&&"deg"!==unitsArr[1]&&"rad"!==unitsArr[1];case 1:return string(valArr[0])||"deg"===unitsArr[0]||"rad"===unitsArr[0];default:return!1}}},easing:{regexes:["^(spring)\\s*\\(\\s*("+number+")\\s*,\\s*("+number+")\\s*\\)$","^(cubic-bezier)\\s*\\(\\s*("+number+")\\s*,\\s*("+number+")\\s*,\\s*("+number+")\\s*,\\s*("+number+")\\s*\\)$"],enums:["linear","ease","ease-in","ease-out","ease-in-out","ease-in-sine","ease-out-sine","ease-in-out-sine","ease-in-quad","ease-out-quad","ease-in-out-quad","ease-in-cubic","ease-out-cubic","ease-in-out-cubic","ease-in-quart","ease-out-quart","ease-in-out-quart","ease-in-quint","ease-out-quint","ease-in-out-quint","ease-in-expo","ease-out-expo","ease-in-out-expo","ease-in-circ","ease-out-circ","ease-in-out-circ"]},gradientDirection:{enums:["to-bottom","to-top","to-left","to-right","to-bottom-right","to-bottom-left","to-top-right","to-top-left","to-right-bottom","to-left-bottom","to-right-top","to-left-top"]},boundsExpansion:{number:!0,multiple:!0,min:0,validate:function(valArr){var length=valArr.length;return 1===length||2===length||4===length}}};var diff={zeroNonZero:function(val1,val2){return(null==val1||null==val2)&&val1!==val2||(0==val1&&0!=val2||0!=val1&&0==val2)},any:function(val1,val2){return val1!=val2}},t=styfn$6.types,mainLabel=[{name:"label",type:t.text,triggersBounds:diff.any},{name:"text-rotation",type:t.textRotation,triggersBounds:diff.any},{name:"text-margin-x",type:t.bidirectionalSize,triggersBounds:diff.any},{name:"text-margin-y",type:t.bidirectionalSize,triggersBounds:diff.any}],sourceLabel=[{name:"source-label",type:t.text,triggersBounds:diff.any},{name:"source-text-rotation",type:t.textRotation,triggersBounds:diff.any},{name:"source-text-margin-x",type:t.bidirectionalSize,triggersBounds:diff.any},{name:"source-text-margin-y",type:t.bidirectionalSize,triggersBounds:diff.any},{name:"source-text-offset",type:t.size,triggersBounds:diff.any}],targetLabel=[{name:"target-label",type:t.text,triggersBounds:diff.any},{name:"target-text-rotation",type:t.textRotation,triggersBounds:diff.any},{name:"target-text-margin-x",type:t.bidirectionalSize,triggersBounds:diff.any},{name:"target-text-margin-y",type:t.bidirectionalSize,triggersBounds:diff.any},{name:"target-text-offset",type:t.size,triggersBounds:diff.any}],labelDimensions=[{name:"font-family",type:t.fontFamily,triggersBounds:diff.any},{name:"font-style",type:t.fontStyle,triggersBounds:diff.any},{name:"font-weight",type:t.fontWeight,triggersBounds:diff.any},{name:"font-size",type:t.size,triggersBounds:diff.any},{name:"text-transform",type:t.textTransform,triggersBounds:diff.any},{name:"text-wrap",type:t.textWrap,triggersBounds:diff.any},{name:"text-overflow-wrap",type:t.textOverflowWrap,triggersBounds:diff.any},{name:"text-max-width",type:t.size,triggersBounds:diff.any},{name:"text-outline-width",type:t.size,triggersBounds:diff.any},{name:"line-height",type:t.positiveNumber,triggersBounds:diff.any}],commonLabel=[{name:"text-valign",type:t.valign,triggersBounds:diff.any},{name:"text-halign",type:t.halign,triggersBounds:diff.any},{name:"color",type:t.color},{name:"text-outline-color",type:t.color},{name:"text-outline-opacity",type:t.zeroOneNumber},{name:"text-background-color",type:t.color},{name:"text-background-opacity",type:t.zeroOneNumber},{name:"text-background-padding",type:t.size,triggersBounds:diff.any},{name:"text-border-opacity",type:t.zeroOneNumber},{name:"text-border-color",type:t.color},{name:"text-border-width",type:t.size,triggersBounds:diff.any},{name:"text-border-style",type:t.borderStyle,triggersBounds:diff.any},{name:"text-background-shape",type:t.textBackgroundShape,triggersBounds:diff.any},{name:"text-justification",type:t.justification}],behavior=[{name:"events",type:t.bool},{name:"text-events",type:t.bool}],visibility=[{name:"display",type:t.display,triggersZOrder:diff.any,triggersBounds:diff.any,triggersBoundsOfParallelBeziers:!0},{name:"visibility",type:t.visibility,triggersZOrder:diff.any},{name:"opacity",type:t.zeroOneNumber,triggersZOrder:diff.zeroNonZero},{name:"text-opacity",type:t.zeroOneNumber},{name:"min-zoomed-font-size",type:t.size},{name:"z-compound-depth",type:t.zCompoundDepth,triggersZOrder:diff.any},{name:"z-index-compare",type:t.zIndexCompare,triggersZOrder:diff.any},{name:"z-index",type:t.nonNegativeInt,triggersZOrder:diff.any}],overlay=[{name:"overlay-padding",type:t.size,triggersBounds:diff.any},{name:"overlay-color",type:t.color},{name:"overlay-opacity",type:t.zeroOneNumber,triggersBounds:diff.zeroNonZero}],transition=[{name:"transition-property",type:t.propList},{name:"transition-duration",type:t.time},{name:"transition-delay",type:t.time},{name:"transition-timing-function",type:t.easing}],nodeSizeHashOverride=function(ele,parsedProp){return"label"===parsedProp.value?-ele.poolIndex():parsedProp.pfValue},nodeBody=[{name:"height",type:t.nodeSize,triggersBounds:diff.any,hashOverride:nodeSizeHashOverride},{name:"width",type:t.nodeSize,triggersBounds:diff.any,hashOverride:nodeSizeHashOverride},{name:"shape",type:t.nodeShape,triggersBounds:diff.any},{name:"shape-polygon-points",type:t.polygonPointList,triggersBounds:diff.any},{name:"background-color",type:t.color},{name:"background-fill",type:t.fill},{name:"background-opacity",type:t.zeroOneNumber},{name:"background-blacken",type:t.nOneOneNumber},{name:"background-gradient-stop-colors",type:t.colors},{name:"background-gradient-stop-positions",type:t.percentages},{name:"background-gradient-direction",type:t.gradientDirection},{name:"padding",type:t.sizeMaybePercent,triggersBounds:diff.any},{name:"padding-relative-to",type:t.paddingRelativeTo,triggersBounds:diff.any},{name:"bounds-expansion",type:t.boundsExpansion,triggersBounds:diff.any}],nodeBorder=[{name:"border-color",type:t.color},{name:"border-opacity",type:t.zeroOneNumber},{name:"border-width",type:t.size,triggersBounds:diff.any},{name:"border-style",type:t.borderStyle}],backgroundImage=[{name:"background-image",type:t.urls},{name:"background-image-crossorigin",type:t.bgCrossOrigin},{name:"background-image-opacity",type:t.zeroOneNumbers},{name:"background-position-x",type:t.bgPos},{name:"background-position-y",type:t.bgPos},{name:"background-width-relative-to",type:t.bgRelativeTo},{name:"background-height-relative-to",type:t.bgRelativeTo},{name:"background-repeat",type:t.bgRepeat},{name:"background-fit",type:t.bgFit},{name:"background-clip",type:t.bgClip},{name:"background-width",type:t.bgWH},{name:"background-height",type:t.bgWH},{name:"background-offset-x",type:t.bgPos},{name:"background-offset-y",type:t.bgPos}],compound=[{name:"position",type:t.position,triggersBounds:diff.any},{name:"compound-sizing-wrt-labels",type:t.compoundIncludeLabels,triggersBounds:diff.any},{name:"min-width",type:t.size,triggersBounds:diff.any},{name:"min-width-bias-left",type:t.sizeMaybePercent,triggersBounds:diff.any},{name:"min-width-bias-right",type:t.sizeMaybePercent,triggersBounds:diff.any},{name:"min-height",type:t.size,triggersBounds:diff.any},{name:"min-height-bias-top",type:t.sizeMaybePercent,triggersBounds:diff.any},{name:"min-height-bias-bottom",type:t.sizeMaybePercent,triggersBounds:diff.any}],edgeLine=[{name:"line-style",type:t.lineStyle},{name:"line-color",type:t.color},{name:"line-fill",type:t.fill},{name:"line-cap",type:t.lineCap},{name:"line-dash-pattern",type:t.numbers},{name:"line-dash-offset",type:t.number},{name:"line-gradient-stop-colors",type:t.colors},{name:"line-gradient-stop-positions",type:t.percentages},{name:"curve-style",type:t.curveStyle,triggersBounds:diff.any,triggersBoundsOfParallelBeziers:!0},{name:"haystack-radius",type:t.zeroOneNumber,triggersBounds:diff.any},{name:"source-endpoint",type:t.edgeEndpoint,triggersBounds:diff.any},{name:"target-endpoint",type:t.edgeEndpoint,triggersBounds:diff.any},{name:"control-point-step-size",type:t.size,triggersBounds:diff.any},{name:"control-point-distances",type:t.bidirectionalSizes,triggersBounds:diff.any},{name:"control-point-weights",type:t.numbers,triggersBounds:diff.any},{name:"segment-distances",type:t.bidirectionalSizes,triggersBounds:diff.any},{name:"segment-weights",type:t.numbers,triggersBounds:diff.any},{name:"taxi-turn",type:t.sizeMaybePercent,triggersBounds:diff.any},{name:"taxi-turn-min-distance",type:t.size,triggersBounds:diff.any},{name:"taxi-direction",type:t.axisDirection,triggersBounds:diff.any},{name:"edge-distances",type:t.edgeDistances,triggersBounds:diff.any},{name:"arrow-scale",type:t.positiveNumber,triggersBounds:diff.any},{name:"loop-direction",type:t.angle,triggersBounds:diff.any},{name:"loop-sweep",type:t.angle,triggersBounds:diff.any},{name:"source-distance-from-node",type:t.size,triggersBounds:diff.any},{name:"target-distance-from-node",type:t.size,triggersBounds:diff.any}],ghost=[{name:"ghost",type:t.bool,triggersBounds:diff.any},{name:"ghost-offset-x",type:t.bidirectionalSize,triggersBounds:diff.any},{name:"ghost-offset-y",type:t.bidirectionalSize,triggersBounds:diff.any},{name:"ghost-opacity",type:t.zeroOneNumber}],core=[{name:"selection-box-color",type:t.color},{name:"selection-box-opacity",type:t.zeroOneNumber},{name:"selection-box-border-color",type:t.color},{name:"selection-box-border-width",type:t.size},{name:"active-bg-color",type:t.color},{name:"active-bg-opacity",type:t.zeroOneNumber},{name:"active-bg-size",type:t.size},{name:"outside-texture-bg-color",type:t.color},{name:"outside-texture-bg-opacity",type:t.zeroOneNumber}],pie=[];styfn$6.pieBackgroundN=16,pie.push({name:"pie-size",type:t.sizeMaybePercent});for(var i=1;i<=styfn$6.pieBackgroundN;i++)pie.push({name:"pie-"+i+"-background-color",type:t.color}),pie.push({name:"pie-"+i+"-background-size",type:t.percent}),pie.push({name:"pie-"+i+"-background-opacity",type:t.zeroOneNumber});var edgeArrow=[],arrowPrefixes=styfn$6.arrowPrefixes=["source","mid-source","target","mid-target"];[{name:"arrow-shape",type:t.arrowShape,triggersBounds:diff.any},{name:"arrow-color",type:t.color},{name:"arrow-fill",type:t.arrowFill}].forEach((function(prop){arrowPrefixes.forEach((function(prefix){var name=prefix+"-"+prop.name,type=prop.type,triggersBounds=prop.triggersBounds;edgeArrow.push({name:name,type:type,triggersBounds:triggersBounds})}))}),{});var props=styfn$6.properties=[].concat(behavior,transition,visibility,overlay,ghost,commonLabel,labelDimensions,mainLabel,sourceLabel,targetLabel,nodeBody,nodeBorder,backgroundImage,pie,compound,edgeLine,edgeArrow,core),propGroups=styfn$6.propertyGroups={behavior:behavior,transition:transition,visibility:visibility,overlay:overlay,ghost:ghost,commonLabel:commonLabel,labelDimensions:labelDimensions,mainLabel:mainLabel,sourceLabel:sourceLabel,targetLabel:targetLabel,nodeBody:nodeBody,nodeBorder:nodeBorder,backgroundImage:backgroundImage,pie:pie,compound:compound,edgeLine:edgeLine,edgeArrow:edgeArrow,core:core},propGroupNames=styfn$6.propertyGroupNames={};(styfn$6.propertyGroupKeys=Object.keys(propGroups)).forEach((function(key){propGroupNames[key]=propGroups[key].map((function(prop){return prop.name})),propGroups[key].forEach((function(prop){return prop.groupKey=key}))}));var aliases=styfn$6.aliases=[{name:"content",pointsTo:"label"},{name:"control-point-distance",pointsTo:"control-point-distances"},{name:"control-point-weight",pointsTo:"control-point-weights"},{name:"edge-text-rotation",pointsTo:"text-rotation"},{name:"padding-left",pointsTo:"padding"},{name:"padding-right",pointsTo:"padding"},{name:"padding-top",pointsTo:"padding"},{name:"padding-bottom",pointsTo:"padding"}];styfn$6.propertyNames=props.map((function(p){return p.name}));for(var _i=0;_i<props.length;_i++){var prop=props[_i];props[prop.name]=prop}for(var _i2=0;_i2<aliases.length;_i2++){var alias=aliases[_i2],pointsToProp=props[alias.pointsTo],aliasProp={name:alias.name,alias:!0,pointsTo:pointsToProp};props.push(aliasProp),props[alias.name]=aliasProp}}(),styfn$6.getDefaultProperty=function(name){return this.getDefaultProperties()[name]},styfn$6.getDefaultProperties=function(){var _p=this._private;if(null!=_p.defaultProperties)return _p.defaultProperties;for(var rawProps=extend({"selection-box-color":"#ddd","selection-box-opacity":.65,"selection-box-border-color":"#aaa","selection-box-border-width":1,"active-bg-color":"black","active-bg-opacity":.15,"active-bg-size":30,"outside-texture-bg-color":"#000","outside-texture-bg-opacity":.125,events:"yes","text-events":"no","text-valign":"top","text-halign":"center","text-justification":"auto","line-height":1,color:"#000","text-outline-color":"#000","text-outline-width":0,"text-outline-opacity":1,"text-opacity":1,"text-decoration":"none","text-transform":"none","text-wrap":"none","text-overflow-wrap":"whitespace","text-max-width":9999,"text-background-color":"#000","text-background-opacity":0,"text-background-shape":"rectangle","text-background-padding":0,"text-border-opacity":0,"text-border-width":0,"text-border-style":"solid","text-border-color":"#000","font-family":"Helvetica Neue, Helvetica, sans-serif","font-style":"normal","font-weight":"normal","font-size":16,"min-zoomed-font-size":0,"text-rotation":"none","source-text-rotation":"none","target-text-rotation":"none",visibility:"visible",display:"element",opacity:1,"z-compound-depth":"auto","z-index-compare":"auto","z-index":0,label:"","text-margin-x":0,"text-margin-y":0,"source-label":"","source-text-offset":0,"source-text-margin-x":0,"source-text-margin-y":0,"target-label":"","target-text-offset":0,"target-text-margin-x":0,"target-text-margin-y":0,"overlay-opacity":0,"overlay-color":"#000","overlay-padding":10,"transition-property":"none","transition-duration":0,"transition-delay":0,"transition-timing-function":"linear","background-blacken":0,"background-color":"#999","background-fill":"solid","background-opacity":1,"background-image":"none","background-image-crossorigin":"anonymous","background-image-opacity":1,"background-position-x":"50%","background-position-y":"50%","background-offset-x":0,"background-offset-y":0,"background-width-relative-to":"include-padding","background-height-relative-to":"include-padding","background-repeat":"no-repeat","background-fit":"none","background-clip":"node","background-width":"auto","background-height":"auto","border-color":"#000","border-opacity":1,"border-width":0,"border-style":"solid",height:30,width:30,shape:"ellipse","shape-polygon-points":"-1, -1,   1, -1,   1, 1,   -1, 1","bounds-expansion":0,"background-gradient-direction":"to-bottom","background-gradient-stop-colors":"#999","background-gradient-stop-positions":"0%",ghost:"no","ghost-offset-y":0,"ghost-offset-x":0,"ghost-opacity":0,padding:0,"padding-relative-to":"width",position:"origin","compound-sizing-wrt-labels":"include","min-width":0,"min-width-bias-left":0,"min-width-bias-right":0,"min-height":0,"min-height-bias-top":0,"min-height-bias-bottom":0},{"pie-size":"100%"},[{name:"pie-{{i}}-background-color",value:"black"},{name:"pie-{{i}}-background-size",value:"0%"},{name:"pie-{{i}}-background-opacity",value:1}].reduce((function(css,prop){for(var i=1;i<=styfn$6.pieBackgroundN;i++){var name=prop.name.replace("{{i}}",i),val=prop.value;css[name]=val}return css}),{}),{"line-style":"solid","line-color":"#999","line-fill":"solid","line-cap":"butt","line-gradient-stop-colors":"#999","line-gradient-stop-positions":"0%","control-point-step-size":40,"control-point-weights":.5,"segment-weights":.5,"segment-distances":20,"taxi-turn":"50%","taxi-turn-min-distance":10,"taxi-direction":"auto","edge-distances":"intersection","curve-style":"haystack","haystack-radius":0,"arrow-scale":1,"loop-direction":"-45deg","loop-sweep":"-90deg","source-distance-from-node":0,"target-distance-from-node":0,"source-endpoint":"outside-to-node","target-endpoint":"outside-to-node","line-dash-pattern":[6,3],"line-dash-offset":0},[{name:"arrow-shape",value:"none"},{name:"arrow-color",value:"#999"},{name:"arrow-fill",value:"filled"}].reduce((function(css,prop){return styfn$6.arrowPrefixes.forEach((function(prefix){var name=prefix+"-"+prop.name,val=prop.value;css[name]=val})),css}),{})),parsedProps={},i=0;i<this.properties.length;i++){var prop=this.properties[i];if(!prop.pointsTo){var name=prop.name,val=rawProps[name],parsedProp=this.parse(name,val);parsedProps[name]=parsedProp}}return _p.defaultProperties=parsedProps,_p.defaultProperties},styfn$6.addDefaultStylesheet=function(){this.selector(":parent").css({shape:"rectangle",padding:10,"background-color":"#eee","border-color":"#ccc","border-width":1}).selector("edge").css({width:3}).selector(":loop").css({"curve-style":"bezier"}).selector("edge:compound").css({"curve-style":"bezier","source-endpoint":"outside-to-line","target-endpoint":"outside-to-line"}).selector(":selected").css({"background-color":"#0169D9","line-color":"#0169D9","source-arrow-color":"#0169D9","target-arrow-color":"#0169D9","mid-source-arrow-color":"#0169D9","mid-target-arrow-color":"#0169D9"}).selector(":parent:selected").css({"background-color":"#CCE1F9","border-color":"#aec8e5"}).selector(":active").css({"overlay-color":"black","overlay-padding":10,"overlay-opacity":.25}),this.defaultLength=this.length};var styfn$7={parse:function(name,value,propIsBypass,propIsFlat){if(fn(value))return this.parseImplWarn(name,value,propIsBypass,propIsFlat);var ret,argHash=hashStrings(name,""+value,propIsBypass?"t":"f","mapping"===propIsFlat||!0===propIsFlat||!1===propIsFlat||null==propIsFlat?"dontcare":propIsFlat),propCache=this.propCache=this.propCache||[];return(ret=propCache[argHash])||(ret=propCache[argHash]=this.parseImplWarn(name,value,propIsBypass,propIsFlat)),(propIsBypass||"mapping"===propIsFlat)&&(ret=copy(ret))&&(ret.value=copy(ret.value)),ret},parseImplWarn:function(name,value,propIsBypass,propIsFlat){var prop=this.parseImpl(name,value,propIsBypass,propIsFlat);return prop||null==value||warn("The style property `".concat(name,": ").concat(value,"` is invalid")),prop}};styfn$7.parseImpl=function(name,value,propIsBypass,propIsFlat){name=camel2dash(name);var property=this.properties[name],passedValue=value,types=this.types;if(!property)return null;if(void 0===value)return null;property.alias&&(property=property.pointsTo,name=property.name);var valueIsString=string(value);valueIsString&&(value=value.trim());var data,mapData,type=property.type;if(!type)return null;if(propIsBypass&&(""===value||null===value))return{name:name,value:value,bypass:!0,deleteBypass:!0};if(fn(value))return{name:name,value:value,strValue:"fn",mapped:types.fn,bypass:propIsBypass};if(!valueIsString||propIsFlat||value.length<7||"a"!==value[1]);else{if(value.length>=7&&"d"===value[0]&&(data=new RegExp(types.data.regex).exec(value))){if(propIsBypass)return!1;var mapped=types.data;return{name:name,value:data,strValue:""+value,mapped:mapped,field:data[1],bypass:propIsBypass}}if(value.length>=10&&"m"===value[0]&&(mapData=new RegExp(types.mapData.regex).exec(value))){if(propIsBypass)return!1;if(type.multiple)return!1;var _mapped=types.mapData;if(!type.color&&!type.number)return!1;var valueMin=this.parse(name,mapData[4]);if(!valueMin||valueMin.mapped)return!1;var valueMax=this.parse(name,mapData[5]);if(!valueMax||valueMax.mapped)return!1;if(valueMin.pfValue===valueMax.pfValue||valueMin.strValue===valueMax.strValue)return warn("`"+name+": "+value+"` is not a valid mapper because the output range is zero; converting to `"+name+": "+valueMin.strValue+"`"),this.parse(name,valueMin.strValue);if(type.color){var c1=valueMin.value,c2=valueMax.value;if(!(c1[0]!==c2[0]||c1[1]!==c2[1]||c1[2]!==c2[2]||c1[3]!==c2[3]&&(null!=c1[3]&&1!==c1[3]||null!=c2[3]&&1!==c2[3])))return!1}return{name:name,value:mapData,strValue:""+value,mapped:_mapped,field:mapData[1],fieldMin:parseFloat(mapData[2]),fieldMax:parseFloat(mapData[3]),valueMin:valueMin.value,valueMax:valueMax.value,bypass:propIsBypass}}}if(type.multiple&&"multiple"!==propIsFlat){var vals;if(vals=valueIsString?value.split(/\s+/):array(value)?value:[value],type.evenMultiple&&vals.length%2!=0)return null;for(var valArr=[],unitsArr=[],pfValArr=[],strVal="",hasEnum=!1,i=0;i<vals.length;i++){var p=this.parse(name,vals[i],propIsBypass,"multiple");hasEnum=hasEnum||string(p.value),valArr.push(p.value),pfValArr.push(null!=p.pfValue?p.pfValue:p.value),unitsArr.push(p.units),strVal+=(i>0?" ":"")+p.strValue}return type.validate&&!type.validate(valArr,unitsArr)?null:type.singleEnum&&hasEnum?1===valArr.length&&string(valArr[0])?{name:name,value:valArr[0],strValue:valArr[0],bypass:propIsBypass}:null:{name:name,value:valArr,pfValue:pfValArr,strValue:strVal,bypass:propIsBypass,units:unitsArr}}var deg,obj,checkEnums=function(){for(var _i=0;_i<type.enums.length;_i++){if(type.enums[_i]===value)return{name:name,value:value,strValue:""+value,bypass:propIsBypass}}return null};if(type.number){var units,implicitUnits="px";if(type.units&&(units=type.units),type.implicitUnits&&(implicitUnits=type.implicitUnits),!type.unitless)if(valueIsString){var unitsRegex="px|em"+(type.allowPercent?"|\\%":"");units&&(unitsRegex=units);var match=value.match("^("+number$1+")("+unitsRegex+")?$");match&&(value=match[1],units=match[2]||implicitUnits)}else units&&!type.implicitUnits||(units=implicitUnits);if(value=parseFloat(value),isNaN(value)&&void 0===type.enums)return null;if(isNaN(value)&&void 0!==type.enums)return value=passedValue,checkEnums();if(type.integer&&(!number(obj=value)||Math.floor(obj)!==obj))return null;if(void 0!==type.min&&(value<type.min||type.strictMin&&value===type.min)||void 0!==type.max&&(value>type.max||type.strictMax&&value===type.max))return null;var ret={name:name,value:value,strValue:""+value+(units||""),units:units,bypass:propIsBypass};return type.unitless||"px"!==units&&"em"!==units?ret.pfValue=value:ret.pfValue="px"!==units&&units?this.getEmSizeInPixels()*value:value,"ms"!==units&&"s"!==units||(ret.pfValue="ms"===units?value:1e3*value),"deg"!==units&&"rad"!==units||(ret.pfValue="rad"===units?value:(deg=value,Math.PI*deg/180)),"%"===units&&(ret.pfValue=value/100),ret}if(type.propList){var props=[],propsStr=""+value;if("none"===propsStr);else{for(var propsSplit=propsStr.split(/\s*,\s*|\s+/),_i2=0;_i2<propsSplit.length;_i2++){var propName=propsSplit[_i2].trim();this.properties[propName]?props.push(propName):warn("`"+propName+"` is not a valid property name")}if(0===props.length)return null}return{name:name,value:props,strValue:0===props.length?"none":props.join(" "),bypass:propIsBypass}}if(type.color){var tuple=color2tuple(value);return tuple?{name:name,value:tuple,pfValue:tuple,strValue:"rgb("+tuple[0]+","+tuple[1]+","+tuple[2]+")",bypass:propIsBypass}:null}if(type.regex||type.regexes){if(type.enums){var enumProp=checkEnums();if(enumProp)return enumProp}for(var regexes=type.regexes?type.regexes:[type.regex],_i3=0;_i3<regexes.length;_i3++){var m=new RegExp(regexes[_i3]).exec(value);if(m)return{name:name,value:type.singleRegexMatchValue?m[1]:m,strValue:""+value,bypass:propIsBypass}}return null}return type.string?{name:name,value:""+value,strValue:""+value,bypass:propIsBypass}:type.enums?checkEnums():null};var Style=function Style(cy){if(!(this instanceof Style))return new Style(cy);core(cy)?(this._private={cy:cy,coreStyle:{}},this.length=0,this.resetToDefault()):error("A style must have a core reference")},styfn$8=Style.prototype;styfn$8.instanceString=function(){return"style"},styfn$8.clear=function(){for(var i=0;i<this.length;i++)this[i]=void 0;return this.length=0,this._private.newStyle=!0,this},styfn$8.resetToDefault=function(){return this.clear(),this.addDefaultStylesheet(),this},styfn$8.core=function(propName){return this._private.coreStyle[propName]||this.getDefaultProperty(propName)},styfn$8.selector=function(selectorStr){var selector="core"===selectorStr?null:new Selector(selectorStr),i=this.length++;return this[i]={selector:selector,properties:[],mappedProperties:[],index:i},this},styfn$8.css=function(){var self=this,args=arguments;if(1===args.length)for(var map=args[0],i=0;i<self.properties.length;i++){var prop=self.properties[i],mapVal=map[prop.name];void 0===mapVal&&(mapVal=map[dash2camel(prop.name)]),void 0!==mapVal&&this.cssRule(prop.name,mapVal)}else 2===args.length&&this.cssRule(args[0],args[1]);return this},styfn$8.style=styfn$8.css,styfn$8.cssRule=function(name,value){var property=this.parse(name,value);if(property){var i=this.length-1;this[i].properties.push(property),this[i].properties[property.name]=property,property.name.match(/pie-(\d+)-background-size/)&&property.value&&(this._private.hasPie=!0),property.mapped&&this[i].mappedProperties.push(property),!this[i].selector&&(this._private.coreStyle[property.name]=property)}return this},styfn$8.append=function(style){return stylesheet(style)?style.appendToStyle(this):array(style)?this.appendFromJson(style):string(style)&&this.appendFromString(style),this},Style.fromJson=function(cy,json){var style=new Style(cy);return style.fromJson(json),style},Style.fromString=function(cy,string){return new Style(cy).fromString(string)},[styfn,styfn$1,styfn$2,styfn$3,styfn$4,styfn$5,styfn$6,styfn$7].forEach((function(props){extend(styfn$8,props)})),Style.types=styfn$8.types,Style.properties=styfn$8.properties,Style.propertyGroups=styfn$8.propertyGroups,Style.propertyGroupNames=styfn$8.propertyGroupNames,Style.propertyGroupKeys=styfn$8.propertyGroupKeys;var corefn$7={style:function(newStyle){newStyle&&this.setStyle(newStyle).update();return this._private.style},setStyle:function(style){var _p=this._private;return stylesheet(style)?_p.style=style.generateStyle(this):array(style)?_p.style=Style.fromJson(this,style):string(style)?_p.style=Style.fromString(this,style):_p.style=Style(this),_p.style}},corefn$8={autolock:function(bool){return void 0===bool?this._private.autolock:(this._private.autolock=!!bool,this)},autoungrabify:function(bool){return void 0===bool?this._private.autoungrabify:(this._private.autoungrabify=!!bool,this)},autounselectify:function(bool){return void 0===bool?this._private.autounselectify:(this._private.autounselectify=!!bool,this)},selectionType:function(selType){var _p=this._private;return null==_p.selectionType&&(_p.selectionType="single"),void 0===selType?_p.selectionType:("additive"!==selType&&"single"!==selType||(_p.selectionType=selType),this)},panningEnabled:function(bool){return void 0===bool?this._private.panningEnabled:(this._private.panningEnabled=!!bool,this)},userPanningEnabled:function(bool){return void 0===bool?this._private.userPanningEnabled:(this._private.userPanningEnabled=!!bool,this)},zoomingEnabled:function(bool){return void 0===bool?this._private.zoomingEnabled:(this._private.zoomingEnabled=!!bool,this)},userZoomingEnabled:function(bool){return void 0===bool?this._private.userZoomingEnabled:(this._private.userZoomingEnabled=!!bool,this)},boxSelectionEnabled:function(bool){return void 0===bool?this._private.boxSelectionEnabled:(this._private.boxSelectionEnabled=!!bool,this)},pan:function(){var dim,val,dims,x,y,args=arguments,pan=this._private.pan;switch(args.length){case 0:return pan;case 1:if(string(args[0]))return pan[dim=args[0]];if(plainObject(args[0])){if(!this._private.panningEnabled)return this;x=(dims=args[0]).x,y=dims.y,number(x)&&(pan.x=x),number(y)&&(pan.y=y),this.emit("pan viewport")}break;case 2:if(!this._private.panningEnabled)return this;dim=args[0],val=args[1],"x"!==dim&&"y"!==dim||!number(val)||(pan[dim]=val),this.emit("pan viewport")}return this.notify("viewport"),this},panBy:function(arg0,arg1){var dim,val,dims,x,y,args=arguments,pan=this._private.pan;if(!this._private.panningEnabled)return this;switch(args.length){case 1:plainObject(arg0)&&(x=(dims=args[0]).x,y=dims.y,number(x)&&(pan.x+=x),number(y)&&(pan.y+=y),this.emit("pan viewport"));break;case 2:val=arg1,"x"!==(dim=arg0)&&"y"!==dim||!number(val)||(pan[dim]+=val),this.emit("pan viewport")}return this.notify("viewport"),this},fit:function(elements,padding){var viewportState=this.getFitViewport(elements,padding);if(viewportState){var _p=this._private;_p.zoom=viewportState.zoom,_p.pan=viewportState.pan,this.emit("pan zoom viewport"),this.notify("viewport")}return this},getFitViewport:function(elements,padding){if(number(elements)&&void 0===padding&&(padding=elements,elements=void 0),this._private.panningEnabled&&this._private.zoomingEnabled){var bb,obj;if(string(elements)){var sel=elements;elements=this.$(sel)}else if(plainObject(obj=elements)&&number(obj.x1)&&number(obj.x2)&&number(obj.y1)&&number(obj.y2)){var bbe=elements;(bb={x1:bbe.x1,y1:bbe.y1,x2:bbe.x2,y2:bbe.y2}).w=bb.x2-bb.x1,bb.h=bb.y2-bb.y1}else elementOrCollection(elements)||(elements=this.mutableElements());if(!elementOrCollection(elements)||!elements.empty()){bb=bb||elements.boundingBox();var zoom,w=this.width(),h=this.height();if(padding=number(padding)?padding:0,!isNaN(w)&&!isNaN(h)&&w>0&&h>0&&!isNaN(bb.w)&&!isNaN(bb.h)&&bb.w>0&&bb.h>0)return{zoom:zoom=(zoom=(zoom=Math.min((w-2*padding)/bb.w,(h-2*padding)/bb.h))>this._private.maxZoom?this._private.maxZoom:zoom)<this._private.minZoom?this._private.minZoom:zoom,pan:{x:(w-zoom*(bb.x1+bb.x2))/2,y:(h-zoom*(bb.y1+bb.y2))/2}}}}},zoomRange:function(min,max){var _p=this._private;if(null==max){var opts=min;min=opts.min,max=opts.max}return number(min)&&number(max)&&min<=max?(_p.minZoom=min,_p.maxZoom=max):number(min)&&void 0===max&&min<=_p.maxZoom?_p.minZoom=min:number(max)&&void 0===min&&max>=_p.minZoom&&(_p.maxZoom=max),this},minZoom:function(zoom){return void 0===zoom?this._private.minZoom:this.zoomRange({min:zoom})},maxZoom:function(zoom){return void 0===zoom?this._private.maxZoom:this.zoomRange({max:zoom})},getZoomedViewport:function(params){var pos,zoom,_p=this._private,currentPan=_p.pan,currentZoom=_p.zoom,bail=!1;if(_p.zoomingEnabled||(bail=!0),number(params)?zoom=params:plainObject(params)&&(zoom=params.level,null!=params.position?pos=modelToRenderedPosition(params.position,currentZoom,currentPan):null!=params.renderedPosition&&(pos=params.renderedPosition),null==pos||_p.panningEnabled||(bail=!0)),zoom=(zoom=zoom>_p.maxZoom?_p.maxZoom:zoom)<_p.minZoom?_p.minZoom:zoom,bail||!number(zoom)||zoom===currentZoom||null!=pos&&(!number(pos.x)||!number(pos.y)))return null;if(null!=pos){var pan1=currentPan,zoom1=currentZoom,zoom2=zoom;return{zoomed:!0,panned:!0,zoom:zoom2,pan:{x:-zoom2/zoom1*(pos.x-pan1.x)+pos.x,y:-zoom2/zoom1*(pos.y-pan1.y)+pos.y}}}return{zoomed:!0,panned:!1,zoom:zoom,pan:currentPan}},zoom:function(params){if(void 0===params)return this._private.zoom;var vp=this.getZoomedViewport(params),_p=this._private;return null!=vp&&vp.zoomed?(_p.zoom=vp.zoom,vp.panned&&(_p.pan.x=vp.pan.x,_p.pan.y=vp.pan.y),this.emit("zoom"+(vp.panned?" pan":"")+" viewport"),this.notify("viewport"),this):this},viewport:function(opts){var _p=this._private,zoomDefd=!0,panDefd=!0,events=[],zoomFailed=!1,panFailed=!1;if(!opts)return this;if(number(opts.zoom)||(zoomDefd=!1),plainObject(opts.pan)||(panDefd=!1),!zoomDefd&&!panDefd)return this;if(zoomDefd){var z=opts.zoom;z<_p.minZoom||z>_p.maxZoom||!_p.zoomingEnabled?zoomFailed=!0:(_p.zoom=z,events.push("zoom"))}if(panDefd&&(!zoomFailed||!opts.cancelOnFailedZoom)&&_p.panningEnabled){var p=opts.pan;number(p.x)&&(_p.pan.x=p.x,panFailed=!1),number(p.y)&&(_p.pan.y=p.y,panFailed=!1),panFailed||events.push("pan")}return events.length>0&&(events.push("viewport"),this.emit(events.join(" ")),this.notify("viewport")),this},center:function(elements){var pan=this.getCenterPan(elements);return pan&&(this._private.pan=pan,this.emit("pan viewport"),this.notify("viewport")),this},getCenterPan:function(elements,zoom){if(this._private.panningEnabled){if(string(elements)){var selector=elements;elements=this.mutableElements().filter(selector)}else elementOrCollection(elements)||(elements=this.mutableElements());if(0!==elements.length){var bb=elements.boundingBox(),w=this.width(),h=this.height();return{x:(w-(zoom=void 0===zoom?this._private.zoom:zoom)*(bb.x1+bb.x2))/2,y:(h-zoom*(bb.y1+bb.y2))/2}}}},reset:function(){return this._private.panningEnabled&&this._private.zoomingEnabled?(this.viewport({pan:{x:0,y:0},zoom:1}),this):this},invalidateSize:function(){this._private.sizeCache=null},size:function(){var style,val,_p=this._private,container=_p.container;return _p.sizeCache=_p.sizeCache||(container?(style=window$1.getComputedStyle(container),val=function(name){return parseFloat(style.getPropertyValue(name))},{width:container.clientWidth-val("padding-left")-val("padding-right"),height:container.clientHeight-val("padding-top")-val("padding-bottom")}):{width:1,height:1})},width:function(){return this.size().width},height:function(){return this.size().height},extent:function(){var pan=this._private.pan,zoom=this._private.zoom,rb=this.renderedExtent(),b={x1:(rb.x1-pan.x)/zoom,x2:(rb.x2-pan.x)/zoom,y1:(rb.y1-pan.y)/zoom,y2:(rb.y2-pan.y)/zoom};return b.w=b.x2-b.x1,b.h=b.y2-b.y1,b},renderedExtent:function(){var width=this.width(),height=this.height();return{x1:0,y1:0,x2:width,y2:height,w:width,h:height}}};corefn$8.centre=corefn$8.center,corefn$8.autolockNodes=corefn$8.autolock,corefn$8.autoungrabifyNodes=corefn$8.autoungrabify;var fn$6={data:define$3.data({field:"data",bindingEvent:"data",allowBinding:!0,allowSetting:!0,settingEvent:"data",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0}),removeData:define$3.removeData({field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!0}),scratch:define$3.data({field:"scratch",bindingEvent:"scratch",allowBinding:!0,allowSetting:!0,settingEvent:"scratch",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0}),removeScratch:define$3.removeData({field:"scratch",event:"scratch",triggerFnName:"trigger",triggerEvent:!0})};fn$6.attr=fn$6.data,fn$6.removeAttr=fn$6.removeData;var Core=function(opts){var cy=this,container=(opts=extend({},opts)).container;container&&!htmlElement(container)&&htmlElement(container[0])&&(container=container[0]);var reg=container?container._cyreg:null;(reg=reg||{})&&reg.cy&&(reg.cy.destroy(),reg={});var readies=reg.readies=reg.readies||[];container&&(container._cyreg=reg),reg.cy=cy;var head=void 0!==window$1&&void 0!==container&&!opts.headless,options=opts;options.layout=extend({name:head?"grid":"null"},options.layout),options.renderer=extend({name:head?"canvas":"null"},options.renderer);var defVal=function(def,val,altVal){return void 0!==val?val:void 0!==altVal?altVal:def},_p=this._private={container:container,ready:!1,options:options,elements:new Collection(this),listeners:[],aniEles:new Collection(this),data:{},scratch:{},layout:null,renderer:null,destroyed:!1,notificationsEnabled:!0,minZoom:1e-50,maxZoom:1e50,zoomingEnabled:defVal(!0,options.zoomingEnabled),userZoomingEnabled:defVal(!0,options.userZoomingEnabled),panningEnabled:defVal(!0,options.panningEnabled),userPanningEnabled:defVal(!0,options.userPanningEnabled),boxSelectionEnabled:defVal(!0,options.boxSelectionEnabled),autolock:defVal(!1,options.autolock,options.autolockNodes),autoungrabify:defVal(!1,options.autoungrabify,options.autoungrabifyNodes),autounselectify:defVal(!1,options.autounselectify),styleEnabled:void 0===options.styleEnabled?head:options.styleEnabled,zoom:number(options.zoom)?options.zoom:1,pan:{x:plainObject(options.pan)&&number(options.pan.x)?options.pan.x:0,y:plainObject(options.pan)&&number(options.pan.y)?options.pan.y:0},animation:{current:[],queue:[]},hasCompoundNodes:!1};this.createEmitter(),this.selectionType(options.selectionType),this.zoomRange({min:options.minZoom,max:options.maxZoom});_p.styleEnabled&&cy.setStyle([]);var rendererOptions=extend({},options,options.renderer);cy.initRenderer(rendererOptions);!function(extData,next){if(extData.some(promise))return Promise$1.all(extData).then(next);next(extData)}([options.style,options.elements],(function(thens){var initStyle=thens[0],initEles=thens[1];_p.styleEnabled&&cy.style().append(initStyle),function(elements,onload,ondone){cy.notifications(!1);var oldEles=cy.mutableElements();oldEles.length>0&&oldEles.remove(),null!=elements&&(plainObject(elements)||array(elements))&&cy.add(elements),cy.one("layoutready",(function(e){cy.notifications(!0),cy.emit(e),cy.one("load",onload),cy.emitAndNotify("load")})).one("layoutstop",(function(){cy.one("done",ondone),cy.emit("done")}));var layoutOpts=extend({},cy._private.options.layout);layoutOpts.eles=cy.elements(),cy.layout(layoutOpts).run()}(initEles,(function(){cy.startAnimationLoop(),_p.ready=!0,fn(options.ready)&&cy.on("ready",options.ready);for(var i=0;i<readies.length;i++){var fn$1=readies[i];cy.on("ready",fn$1)}reg&&(reg.readies=[]),cy.emit("ready")}),options.done)}))},corefn$9=Core.prototype;extend(corefn$9,{instanceString:function(){return"core"},isReady:function(){return this._private.ready},destroyed:function(){return this._private.destroyed},ready:function(fn){return this.isReady()?this.emitter().emit("ready",[],fn):this.on("ready",fn),this},destroy:function(){var cy=this;if(!cy.destroyed())return cy.stopAnimationLoop(),cy.destroyRenderer(),this.emit("destroy"),cy._private.destroyed=!0,cy},hasElementWithId:function(id){return this._private.elements.hasElementWithId(id)},getElementById:function(id){return this._private.elements.getElementById(id)},hasCompoundNodes:function(){return this._private.hasCompoundNodes},headless:function(){return this._private.renderer.isHeadless()},styleEnabled:function(){return this._private.styleEnabled},addToPool:function(eles){return this._private.elements.merge(eles),this},removeFromPool:function(eles){return this._private.elements.unmerge(eles),this},container:function(){return this._private.container||null},mount:function(container){if(null!=container){var cy=this,_p=cy._private,options=_p.options;return!htmlElement(container)&&htmlElement(container[0])&&(container=container[0]),cy.stopAnimationLoop(),cy.destroyRenderer(),_p.container=container,_p.styleEnabled=!0,cy.invalidateSize(),cy.initRenderer(extend({},options,options.renderer,{name:"null"===options.renderer.name?"canvas":options.renderer.name})),cy.startAnimationLoop(),cy.style(options.style),cy.emit("mount"),cy}},unmount:function(){var cy=this;return cy.stopAnimationLoop(),cy.destroyRenderer(),cy.initRenderer({name:"null"}),cy.emit("unmount"),cy},options:function(){return copy(this._private.options)},json:function(obj){var cy=this,_p=cy._private,eles=cy.mutableElements();if(plainObject(obj)){if(cy.startBatch(),obj.elements){var idInJson={},updateEles=function(jsons,gr){for(var toAdd=[],toMod=[],i=0;i<jsons.length;i++){var json=jsons[i],id=""+json.data.id,ele=cy.getElementById(id);idInJson[id]=!0,0!==ele.length?toMod.push({ele:ele,json:json}):gr?(json.group=gr,toAdd.push(json)):toAdd.push(json)}cy.add(toAdd);for(var _i=0;_i<toMod.length;_i++){var _toMod$_i=toMod[_i],_ele=_toMod$_i.ele,_json=_toMod$_i.json;_ele.json(_json)}};if(array(obj.elements))updateEles(obj.elements);else for(var grs=["nodes","edges"],i=0;i<grs.length;i++){var gr=grs[i],elements=obj.elements[gr];array(elements)&&updateEles(elements,gr)}var parentsToRemove=cy.collection();eles.filter((function(ele){return!idInJson[ele.id()]})).forEach((function(ele){ele.isParent()?parentsToRemove.merge(ele):ele.remove()})),parentsToRemove.forEach((function(ele){return ele.children().move({parent:null})})),parentsToRemove.forEach((function(ele){return function(ele){return cy.getElementById(ele.id())}(ele).remove()}))}obj.style&&cy.style(obj.style),null!=obj.zoom&&obj.zoom!==_p.zoom&&cy.zoom(obj.zoom),obj.pan&&(obj.pan.x===_p.pan.x&&obj.pan.y===_p.pan.y||cy.pan(obj.pan)),obj.data&&cy.data(obj.data);for(var fields=["minZoom","maxZoom","zoomingEnabled","userZoomingEnabled","panningEnabled","userPanningEnabled","boxSelectionEnabled","autolock","autoungrabify","autounselectify"],_i2=0;_i2<fields.length;_i2++){var f=fields[_i2];null!=obj[f]&&cy[f](obj[f])}return cy.endBatch(),this}var json={};!!obj?json.elements=this.elements().map((function(ele){return ele.json()})):(json.elements={},eles.forEach((function(ele){var group=ele.group();json.elements[group]||(json.elements[group]=[]),json.elements[group].push(ele.json())}))),this._private.styleEnabled&&(json.style=cy.style().json()),json.data=copy(cy.data());var options=_p.options;return json.zoomingEnabled=_p.zoomingEnabled,json.userZoomingEnabled=_p.userZoomingEnabled,json.zoom=_p.zoom,json.minZoom=_p.minZoom,json.maxZoom=_p.maxZoom,json.panningEnabled=_p.panningEnabled,json.userPanningEnabled=_p.userPanningEnabled,json.pan=copy(_p.pan),json.boxSelectionEnabled=_p.boxSelectionEnabled,json.renderer=copy(options.renderer),json.hideEdgesOnViewport=options.hideEdgesOnViewport,json.textureOnViewport=options.textureOnViewport,json.wheelSensitivity=options.wheelSensitivity,json.motionBlur=options.motionBlur,json}}),corefn$9.$id=corefn$9.getElementById,[corefn,corefn$1,elesfn$u,corefn$2,corefn$3,corefn$4,corefn$5,corefn$6,corefn$7,corefn$8,fn$6].forEach((function(props){extend(corefn$9,props)}));var defaults$9={fit:!0,directed:!1,padding:30,circle:!1,grid:!1,spacingFactor:1.75,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,roots:void 0,maximal:!1,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(node,i){return!0},ready:void 0,stop:void 0,transform:function(node,position){return position}},getInfo=function(ele){return ele.scratch("breadthfirst")},setInfo=function(ele,obj){return ele.scratch("breadthfirst",obj)};function BreadthFirstLayout(options){this.options=extend({},defaults$9,options)}BreadthFirstLayout.prototype.run=function(){var roots,params=this.options,options=params,cy=params.cy,eles=options.eles,nodes=eles.nodes().filter((function(n){return!n.isParent()})),graph=eles,directed=options.directed,maximal=options.maximal||options.maximalAdjustments>0,bb=makeBoundingBox(options.boundingBox?options.boundingBox:{x1:0,y1:0,w:cy.width(),h:cy.height()});if(elementOrCollection(options.roots))roots=options.roots;else if(array(options.roots)){for(var rootsArray=[],i=0;i<options.roots.length;i++){var id=options.roots[i],ele=cy.getElementById(id);rootsArray.push(ele)}roots=cy.collection(rootsArray)}else if(string(options.roots))roots=cy.$(options.roots);else if(directed)roots=nodes.roots();else{var components=eles.components();roots=cy.collection();for(var _loop=function(_i){var comp=components[_i],maxDegree=comp.maxDegree(!1),compRoots=comp.filter((function(ele){return ele.degree(!1)===maxDegree}));roots=roots.add(compRoots)},_i=0;_i<components.length;_i++)_loop(_i)}var depths=[],foundByBfs={},addToDepth=function(ele,d){null==depths[d]&&(depths[d]=[]);var i=depths[d].length;depths[d].push(ele),setInfo(ele,{index:i,depth:d})};graph.bfs({roots:roots,directed:options.directed,visit:function(node,edge,pNode,i,depth){var ele=node[0],id=ele.id();addToDepth(ele,depth),foundByBfs[id]=!0}});for(var orphanNodes=[],_i2=0;_i2<nodes.length;_i2++){var _ele=nodes[_i2];foundByBfs[_ele.id()]||orphanNodes.push(_ele)}var assignDepthsAt=function(i){for(var eles=depths[i],j=0;j<eles.length;j++){var _ele2=eles[j];null!=_ele2?setInfo(_ele2,{depth:i,index:j}):(eles.splice(j,1),j--)}},assignDepths=function(){for(var _i3=0;_i3<depths.length;_i3++)assignDepthsAt(_i3)},adjustMaximally=function(ele,shifted){for(var eInfo=getInfo(ele),incomers=ele.incomers().filter((function(el){return el.isNode()&&eles.has(el)})),maxDepth=-1,id=ele.id(),k=0;k<incomers.length;k++){var incmr=incomers[k],iInfo=getInfo(incmr);maxDepth=Math.max(maxDepth,iInfo.depth)}return eInfo.depth<=maxDepth&&(shifted[id]?null:(function(ele,newDepth){var _getInfo=getInfo(ele),depth=_getInfo.depth,index=_getInfo.index;depths[depth][index]=null,addToDepth(ele,newDepth)}(ele,maxDepth+1),shifted[id]=!0,!0))};if(directed&&maximal){var Q=[],shifted={},enqueue=function(n){return Q.push(n)};for(nodes.forEach((function(n){return Q.push(n)}));Q.length>0;){var _ele3=Q.shift(),didShift=adjustMaximally(_ele3,shifted);if(didShift)_ele3.outgoers().filter((function(el){return el.isNode()&&eles.has(el)})).forEach(enqueue);else if(null===didShift){warn("Detected double maximal shift for node `"+_ele3.id()+"`.  Bailing maximal adjustment due to cycle.  Use `options.maximal: true` only on DAGs.");break}}}assignDepths();var minDistance=0;if(options.avoidOverlap)for(var _i4=0;_i4<nodes.length;_i4++){var nbb=nodes[_i4].layoutDimensions(options),w=nbb.w,h=nbb.h;minDistance=Math.max(minDistance,w,h)}for(var cachedWeightedPercent={},getWeightedPercent=function(ele){if(cachedWeightedPercent[ele.id()])return cachedWeightedPercent[ele.id()];for(var eleDepth=getInfo(ele).depth,neighbors=ele.neighborhood(),percent=0,samples=0,_i5=0;_i5<neighbors.length;_i5++){var neighbor=neighbors[_i5];if(!neighbor.isEdge()&&!neighbor.isParent()&&nodes.has(neighbor)){var bf=getInfo(neighbor),index=bf.index,depth=bf.depth;if(null!=index&&null!=depth){var nDepth=depths[depth].length;depth<eleDepth&&(percent+=index/nDepth,samples++)}}}return percent/=samples=Math.max(1,samples),0===samples&&(percent=0),cachedWeightedPercent[ele.id()]=percent,percent},sortFn=function(a,b){var diff=getWeightedPercent(a)-getWeightedPercent(b);return 0===diff?ascending(a.id(),b.id()):diff},_i6=0;_i6<depths.length;_i6++)depths[_i6].sort(sortFn),assignDepthsAt(_i6);for(var orphanDepth=[],_i7=0;_i7<orphanNodes.length;_i7++)orphanDepth.push(orphanNodes[_i7]);depths.unshift(orphanDepth),assignDepths();for(var biggestDepthSize=0,_i8=0;_i8<depths.length;_i8++)biggestDepthSize=Math.max(depths[_i8].length,biggestDepthSize);var center_x=bb.x1+bb.w/2,center_y=bb.x1+bb.h/2,maxDepthSize=depths.reduce((function(max,eles){return Math.max(max,eles.length)}),0);return nodes.layoutPositions(this,options,(function(ele){var _getInfo2=getInfo(ele),depth=_getInfo2.depth,index=_getInfo2.index,depthSize=depths[depth].length,distanceX=Math.max(bb.w/((options.grid?maxDepthSize:depthSize)+1),minDistance),distanceY=Math.max(bb.h/(depths.length+1),minDistance),radiusStepSize=Math.min(bb.w/2/depths.length,bb.h/2/depths.length);if(radiusStepSize=Math.max(radiusStepSize,minDistance),options.circle){var radius=radiusStepSize*depth+radiusStepSize-(depths.length>0&&depths[0].length<=3?radiusStepSize/2:0),theta=2*Math.PI/depths[depth].length*index;return 0===depth&&1===depths[0].length&&(radius=1),{x:center_x+radius*Math.cos(theta),y:center_y+radius*Math.sin(theta)}}return{x:center_x+(index+1-(depthSize+1)/2)*distanceX,y:(depth+1)*distanceY}})),this};var defaults$a={fit:!0,padding:30,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,spacingFactor:void 0,radius:void 0,startAngle:1.5*Math.PI,sweep:void 0,clockwise:!0,sort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(node,i){return!0},ready:void 0,stop:void 0,transform:function(node,position){return position}};function CircleLayout(options){this.options=extend({},defaults$a,options)}CircleLayout.prototype.run=function(){var params=this.options,options=params,cy=params.cy,eles=options.eles,clockwise=void 0!==options.counterclockwise?!options.counterclockwise:options.clockwise,nodes=eles.nodes().not(":parent");options.sort&&(nodes=nodes.sort(options.sort));for(var r,bb=makeBoundingBox(options.boundingBox?options.boundingBox:{x1:0,y1:0,w:cy.width(),h:cy.height()}),center_x=bb.x1+bb.w/2,center_y=bb.y1+bb.h/2,dTheta=(void 0===options.sweep?2*Math.PI-2*Math.PI/nodes.length:options.sweep)/Math.max(1,nodes.length-1),minDistance=0,i=0;i<nodes.length;i++){var nbb=nodes[i].layoutDimensions(options),w=nbb.w,h=nbb.h;minDistance=Math.max(minDistance,w,h)}if(r=number(options.radius)?options.radius:nodes.length<=1?0:Math.min(bb.h,bb.w)/2-minDistance,nodes.length>1&&options.avoidOverlap){minDistance*=1.75;var dcos=Math.cos(dTheta)-Math.cos(0),dsin=Math.sin(dTheta)-Math.sin(0),rMin=Math.sqrt(minDistance*minDistance/(dcos*dcos+dsin*dsin));r=Math.max(rMin,r)}return nodes.layoutPositions(this,options,(function(ele,i){var theta=options.startAngle+i*dTheta*(clockwise?1:-1),rx=r*Math.cos(theta),ry=r*Math.sin(theta);return{x:center_x+rx,y:center_y+ry}})),this};var DEBUG,defaults$b={fit:!0,padding:30,startAngle:1.5*Math.PI,sweep:void 0,clockwise:!0,equidistant:!1,minNodeSpacing:10,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,height:void 0,width:void 0,spacingFactor:void 0,concentric:function(node){return node.degree()},levelWidth:function(nodes){return nodes.maxDegree()/4},animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(node,i){return!0},ready:void 0,stop:void 0,transform:function(node,position){return position}};function ConcentricLayout(options){this.options=extend({},defaults$b,options)}ConcentricLayout.prototype.run=function(){for(var params=this.options,options=params,clockwise=void 0!==options.counterclockwise?!options.counterclockwise:options.clockwise,cy=params.cy,nodes=options.eles.nodes().not(":parent"),bb=makeBoundingBox(options.boundingBox?options.boundingBox:{x1:0,y1:0,w:cy.width(),h:cy.height()}),center_x=bb.x1+bb.w/2,center_y=bb.y1+bb.h/2,nodeValues=[],maxNodeSize=0,i=0;i<nodes.length;i++){var value,node=nodes[i];value=options.concentric(node),nodeValues.push({value:value,node:node}),node._private.scratch.concentric=value}nodes.updateStyle();for(var _i=0;_i<nodes.length;_i++){var nbb=nodes[_i].layoutDimensions(options);maxNodeSize=Math.max(maxNodeSize,nbb.w,nbb.h)}nodeValues.sort((function(a,b){return b.value-a.value}));for(var levelWidth=options.levelWidth(nodes),levels=[[]],currentLevel=levels[0],_i2=0;_i2<nodeValues.length;_i2++){var val=nodeValues[_i2];if(currentLevel.length>0)Math.abs(currentLevel[0].value-val.value)>=levelWidth&&(currentLevel=[],levels.push(currentLevel));currentLevel.push(val)}var minDist=maxNodeSize+options.minNodeSpacing;if(!options.avoidOverlap){var firstLvlHasMulti=levels.length>0&&levels[0].length>1,rStep=(Math.min(bb.w,bb.h)/2-minDist)/(levels.length+firstLvlHasMulti?1:0);minDist=Math.min(minDist,rStep)}for(var r=0,_i3=0;_i3<levels.length;_i3++){var level=levels[_i3],sweep=void 0===options.sweep?2*Math.PI-2*Math.PI/level.length:options.sweep,dTheta=level.dTheta=sweep/Math.max(1,level.length-1);if(level.length>1&&options.avoidOverlap){var dcos=Math.cos(dTheta)-Math.cos(0),dsin=Math.sin(dTheta)-Math.sin(0),rMin=Math.sqrt(minDist*minDist/(dcos*dcos+dsin*dsin));r=Math.max(rMin,r)}level.r=r,r+=minDist}if(options.equidistant){for(var rDeltaMax=0,_r=0,_i4=0;_i4<levels.length;_i4++){var rDelta=levels[_i4].r-_r;rDeltaMax=Math.max(rDeltaMax,rDelta)}_r=0;for(var _i5=0;_i5<levels.length;_i5++){var _level2=levels[_i5];0===_i5&&(_r=_level2.r),_level2.r=_r,_r+=rDeltaMax}}for(var pos={},_i6=0;_i6<levels.length;_i6++)for(var _level3=levels[_i6],_dTheta=_level3.dTheta,_r2=_level3.r,j=0;j<_level3.length;j++){var _val=_level3[j],theta=options.startAngle+(clockwise?1:-1)*_dTheta*j,p={x:center_x+_r2*Math.cos(theta),y:center_y+_r2*Math.sin(theta)};pos[_val.node.id()]=p}return nodes.layoutPositions(this,options,(function(ele){var id=ele.id();return pos[id]})),this};var defaults$c={ready:function(){},stop:function(){},animate:!0,animationEasing:void 0,animationDuration:void 0,animateFilter:function(node,i){return!0},animationThreshold:250,refresh:20,fit:!0,padding:30,boundingBox:void 0,nodeDimensionsIncludeLabels:!1,randomize:!1,componentSpacing:40,nodeRepulsion:function(node){return 2048},nodeOverlap:4,idealEdgeLength:function(edge){return 32},edgeElasticity:function(edge){return 32},nestingFactor:1.2,gravity:1,numIter:1e3,initialTemp:1e3,coolingFactor:.99,minTemp:1};function CoseLayout(options){this.options=extend({},defaults$c,options),this.options.layout=this}CoseLayout.prototype.run=function(){var options=this.options,cy=options.cy,layout=this;layout.stopped=!1,!0!==options.animate&&!1!==options.animate||layout.emit({type:"layoutstart",layout:layout}),DEBUG=!0===options.debug;var layoutInfo=createLayoutInfo(cy,layout,options);DEBUG&&(void 0)(layoutInfo),options.randomize&&randomizePositions(layoutInfo);var startTime=performanceNow(),refresh=function(){refreshPositions(layoutInfo,cy,options),!0===options.fit&&cy.fit(options.padding)},mainLoop=function(i){return!(layout.stopped||i>=options.numIter)&&(step$1(layoutInfo,options),layoutInfo.temperature=layoutInfo.temperature*options.coolingFactor,!(layoutInfo.temperature<options.minTemp))},done=function(){if(!0===options.animate||!1===options.animate)refresh(),layout.one("layoutstop",options.stop),layout.emit({type:"layoutstop",layout:layout});else{var nodes=options.eles.nodes(),getScaledPos=getScaleInBoundsFn(layoutInfo,options,nodes);nodes.layoutPositions(layout,options,getScaledPos)}},i=0,loopRet=!0;if(!0===options.animate){!function frame(){for(var f=0;loopRet&&f<options.refresh;)loopRet=mainLoop(i),i++,f++;loopRet?(performanceNow()-startTime>=options.animationThreshold&&refresh(),requestAnimationFrame(frame)):(separateComponents(layoutInfo,options),done())}()}else{for(;loopRet;)loopRet=mainLoop(i),i++;separateComponents(layoutInfo,options),done()}return this},CoseLayout.prototype.stop=function(){return this.stopped=!0,this.thread&&this.thread.stop(),this.emit("layoutstop"),this},CoseLayout.prototype.destroy=function(){return this.thread&&this.thread.stop(),this};var createLayoutInfo=function(cy,layout,options){for(var edges=options.eles.edges(),nodes=options.eles.nodes(),layoutInfo={isCompound:cy.hasCompoundNodes(),layoutNodes:[],idToIndex:{},nodeSize:nodes.size(),graphSet:[],indexToGraph:[],layoutEdges:[],edgeSize:edges.size(),temperature:options.initialTemp,clientWidth:cy.width(),clientHeight:cy.width(),boundingBox:makeBoundingBox(options.boundingBox?options.boundingBox:{x1:0,y1:0,w:cy.width(),h:cy.height()})},components=options.eles.components(),id2cmptId={},i=0;i<components.length;i++)for(var component=components[i],j=0;j<component.length;j++){id2cmptId[component[j].id()]=i}for(i=0;i<layoutInfo.nodeSize;i++){var nbb=(n=nodes[i]).layoutDimensions(options);(tempNode={}).isLocked=n.locked(),tempNode.id=n.data("id"),tempNode.parentId=n.data("parent"),tempNode.cmptId=id2cmptId[n.id()],tempNode.children=[],tempNode.positionX=n.position("x"),tempNode.positionY=n.position("y"),tempNode.offsetX=0,tempNode.offsetY=0,tempNode.height=nbb.w,tempNode.width=nbb.h,tempNode.maxX=tempNode.positionX+tempNode.width/2,tempNode.minX=tempNode.positionX-tempNode.width/2,tempNode.maxY=tempNode.positionY+tempNode.height/2,tempNode.minY=tempNode.positionY-tempNode.height/2,tempNode.padLeft=parseFloat(n.style("padding")),tempNode.padRight=parseFloat(n.style("padding")),tempNode.padTop=parseFloat(n.style("padding")),tempNode.padBottom=parseFloat(n.style("padding")),tempNode.nodeRepulsion=fn(options.nodeRepulsion)?options.nodeRepulsion(n):options.nodeRepulsion,layoutInfo.layoutNodes.push(tempNode),layoutInfo.idToIndex[tempNode.id]=i}var queue=[],start=0,end=-1,tempGraph=[];for(i=0;i<layoutInfo.nodeSize;i++){var n,p_id=(n=layoutInfo.layoutNodes[i]).parentId;null!=p_id?layoutInfo.layoutNodes[layoutInfo.idToIndex[p_id]].children.push(n.id):(queue[++end]=n.id,tempGraph.push(n.id))}for(layoutInfo.graphSet.push(tempGraph);start<=end;){var node_id=queue[start++],node_ix=layoutInfo.idToIndex[node_id],children=layoutInfo.layoutNodes[node_ix].children;if(children.length>0){layoutInfo.graphSet.push(children);for(i=0;i<children.length;i++)queue[++end]=children[i]}}for(i=0;i<layoutInfo.graphSet.length;i++){var graph=layoutInfo.graphSet[i];for(j=0;j<graph.length;j++){var index=layoutInfo.idToIndex[graph[j]];layoutInfo.indexToGraph[index]=i}}for(i=0;i<layoutInfo.edgeSize;i++){var e=edges[i],tempEdge={};tempEdge.id=e.data("id"),tempEdge.sourceId=e.data("source"),tempEdge.targetId=e.data("target");var idealLength=fn(options.idealEdgeLength)?options.idealEdgeLength(e):options.idealEdgeLength,elasticity=fn(options.edgeElasticity)?options.edgeElasticity(e):options.edgeElasticity,sourceIx=layoutInfo.idToIndex[tempEdge.sourceId],targetIx=layoutInfo.idToIndex[tempEdge.targetId];if(layoutInfo.indexToGraph[sourceIx]!=layoutInfo.indexToGraph[targetIx]){for(var lca=findLCA(tempEdge.sourceId,tempEdge.targetId,layoutInfo),lcaGraph=layoutInfo.graphSet[lca],depth=0,tempNode=layoutInfo.layoutNodes[sourceIx];-1===lcaGraph.indexOf(tempNode.id);)tempNode=layoutInfo.layoutNodes[layoutInfo.idToIndex[tempNode.parentId]],depth++;for(tempNode=layoutInfo.layoutNodes[targetIx];-1===lcaGraph.indexOf(tempNode.id);)tempNode=layoutInfo.layoutNodes[layoutInfo.idToIndex[tempNode.parentId]],depth++;idealLength*=depth*options.nestingFactor}tempEdge.idealLength=idealLength,tempEdge.elasticity=elasticity,layoutInfo.layoutEdges.push(tempEdge)}return layoutInfo},findLCA=function(node1,node2,layoutInfo){var res=findLCA_aux(node1,node2,0,layoutInfo);return 2>res.count?0:res.graph},findLCA_aux=function findLCA_aux(node1,node2,graphIx,layoutInfo){var graph=layoutInfo.graphSet[graphIx];if(-1<graph.indexOf(node1)&&-1<graph.indexOf(node2))return{count:2,graph:graphIx};for(var c=0,i=0;i<graph.length;i++){var nodeId=graph[i],nodeIx=layoutInfo.idToIndex[nodeId],children=layoutInfo.layoutNodes[nodeIx].children;if(0!==children.length){var result=findLCA_aux(node1,node2,layoutInfo.indexToGraph[layoutInfo.idToIndex[children[0]]],layoutInfo);if(0!==result.count){if(1!==result.count)return result;if(2===++c)break}}}return{count:c,graph:graphIx}},randomizePositions=function(layoutInfo,cy){for(var width=layoutInfo.clientWidth,height=layoutInfo.clientHeight,i=0;i<layoutInfo.nodeSize;i++){var n=layoutInfo.layoutNodes[i];0!==n.children.length||n.isLocked||(n.positionX=Math.random()*width,n.positionY=Math.random()*height)}},getScaleInBoundsFn=function(layoutInfo,options,nodes){var bb=layoutInfo.boundingBox,coseBB={x1:1/0,x2:-1/0,y1:1/0,y2:-1/0};return options.boundingBox&&(nodes.forEach((function(node){var lnode=layoutInfo.layoutNodes[layoutInfo.idToIndex[node.data("id")]];coseBB.x1=Math.min(coseBB.x1,lnode.positionX),coseBB.x2=Math.max(coseBB.x2,lnode.positionX),coseBB.y1=Math.min(coseBB.y1,lnode.positionY),coseBB.y2=Math.max(coseBB.y2,lnode.positionY)})),coseBB.w=coseBB.x2-coseBB.x1,coseBB.h=coseBB.y2-coseBB.y1),function(ele,i){var lnode=layoutInfo.layoutNodes[layoutInfo.idToIndex[ele.data("id")]];if(options.boundingBox){var pctX=(lnode.positionX-coseBB.x1)/coseBB.w,pctY=(lnode.positionY-coseBB.y1)/coseBB.h;return{x:bb.x1+pctX*bb.w,y:bb.y1+pctY*bb.h}}return{x:lnode.positionX,y:lnode.positionY}}},refreshPositions=function(layoutInfo,cy,options){var layout=options.layout,nodes=options.eles.nodes(),getScaledPos=getScaleInBoundsFn(layoutInfo,options,nodes);nodes.positions(getScaledPos),!0!==layoutInfo.ready&&(layoutInfo.ready=!0,layout.one("layoutready",options.ready),layout.emit({type:"layoutready",layout:this}))},step$1=function(layoutInfo,options,_step){calculateNodeForces(layoutInfo,options),calculateEdgeForces(layoutInfo),calculateGravityForces(layoutInfo,options),propagateForces(layoutInfo),updatePositions(layoutInfo)},calculateNodeForces=function(layoutInfo,options){for(var i=0;i<layoutInfo.graphSet.length;i++)for(var graph=layoutInfo.graphSet[i],numNodes=graph.length,j=0;j<numNodes;j++)for(var node1=layoutInfo.layoutNodes[layoutInfo.idToIndex[graph[j]]],k=j+1;k<numNodes;k++){var node2=layoutInfo.layoutNodes[layoutInfo.idToIndex[graph[k]]];nodeRepulsion(node1,node2,layoutInfo,options)}},randomDistance=function(max){return-max+2*max*Math.random()},nodeRepulsion=function(node1,node2,layoutInfo,options){if(node1.cmptId===node2.cmptId||layoutInfo.isCompound){var directionX=node2.positionX-node1.positionX,directionY=node2.positionY-node1.positionY;0===directionX&&0===directionY&&(directionX=randomDistance(1),directionY=randomDistance(1));var overlap=nodesOverlap(node1,node2,directionX,directionY);if(overlap>0)var forceX=(force=options.nodeOverlap*overlap)*directionX/(distance=Math.sqrt(directionX*directionX+directionY*directionY)),forceY=force*directionY/distance;else{var force,point1=findClippingPoint(node1,directionX,directionY),point2=findClippingPoint(node2,-1*directionX,-1*directionY),distanceX=point2.x-point1.x,distanceY=point2.y-point1.y,distanceSqr=distanceX*distanceX+distanceY*distanceY,distance=Math.sqrt(distanceSqr);forceX=(force=(node1.nodeRepulsion+node2.nodeRepulsion)/distanceSqr)*distanceX/distance,forceY=force*distanceY/distance}node1.isLocked||(node1.offsetX-=forceX,node1.offsetY-=forceY),node2.isLocked||(node2.offsetX+=forceX,node2.offsetY+=forceY)}},nodesOverlap=function(node1,node2,dX,dY){if(dX>0)var overlapX=node1.maxX-node2.minX;else overlapX=node2.maxX-node1.minX;if(dY>0)var overlapY=node1.maxY-node2.minY;else overlapY=node2.maxY-node1.minY;return overlapX>=0&&overlapY>=0?Math.sqrt(overlapX*overlapX+overlapY*overlapY):0},findClippingPoint=function(node,dX,dY){var X=node.positionX,Y=node.positionY,H=node.height||1,W=node.width||1,dirSlope=dY/dX,nodeSlope=H/W,res={};return 0===dX&&0<dY||0===dX&&0>dY?(res.x=X,res.y=Y+H/2,res):0<dX&&-1*nodeSlope<=dirSlope&&dirSlope<=nodeSlope?(res.x=X+W/2,res.y=Y+W*dY/2/dX,res):0>dX&&-1*nodeSlope<=dirSlope&&dirSlope<=nodeSlope?(res.x=X-W/2,res.y=Y-W*dY/2/dX,res):0<dY&&(dirSlope<=-1*nodeSlope||dirSlope>=nodeSlope)?(res.x=X+H*dX/2/dY,res.y=Y+H/2,res):0>dY&&(dirSlope<=-1*nodeSlope||dirSlope>=nodeSlope)?(res.x=X-H*dX/2/dY,res.y=Y-H/2,res):res},calculateEdgeForces=function(layoutInfo,options){for(var i=0;i<layoutInfo.edgeSize;i++){var edge=layoutInfo.layoutEdges[i],sourceIx=layoutInfo.idToIndex[edge.sourceId],source=layoutInfo.layoutNodes[sourceIx],targetIx=layoutInfo.idToIndex[edge.targetId],target=layoutInfo.layoutNodes[targetIx],directionX=target.positionX-source.positionX,directionY=target.positionY-source.positionY;if(0!==directionX||0!==directionY){var point1=findClippingPoint(source,directionX,directionY),point2=findClippingPoint(target,-1*directionX,-1*directionY),lx=point2.x-point1.x,ly=point2.y-point1.y,l=Math.sqrt(lx*lx+ly*ly),force=Math.pow(edge.idealLength-l,2)/edge.elasticity;if(0!==l)var forceX=force*lx/l,forceY=force*ly/l;else forceX=0,forceY=0;source.isLocked||(source.offsetX+=forceX,source.offsetY+=forceY),target.isLocked||(target.offsetX-=forceX,target.offsetY-=forceY)}}},calculateGravityForces=function(layoutInfo,options){for(var i=0;i<layoutInfo.graphSet.length;i++){var graph=layoutInfo.graphSet[i],numNodes=graph.length;if(0===i)var centerX=layoutInfo.clientHeight/2,centerY=layoutInfo.clientWidth/2;else{var temp=layoutInfo.layoutNodes[layoutInfo.idToIndex[graph[0]]],parent=layoutInfo.layoutNodes[layoutInfo.idToIndex[temp.parentId]];centerX=parent.positionX,centerY=parent.positionY}for(var j=0;j<numNodes;j++){var node=layoutInfo.layoutNodes[layoutInfo.idToIndex[graph[j]]];if(!node.isLocked){var dx=centerX-node.positionX,dy=centerY-node.positionY,d=Math.sqrt(dx*dx+dy*dy);if(d>1){var fx=options.gravity*dx/d,fy=options.gravity*dy/d;node.offsetX+=fx,node.offsetY+=fy}}}}},propagateForces=function(layoutInfo,options){var queue=[],start=0,end=-1;for(queue.push.apply(queue,layoutInfo.graphSet[0]),end+=layoutInfo.graphSet[0].length;start<=end;){var nodeId=queue[start++],nodeIndex=layoutInfo.idToIndex[nodeId],node=layoutInfo.layoutNodes[nodeIndex],children=node.children;if(0<children.length&&!node.isLocked){for(var offX=node.offsetX,offY=node.offsetY,i=0;i<children.length;i++){var childNode=layoutInfo.layoutNodes[layoutInfo.idToIndex[children[i]]];childNode.offsetX+=offX,childNode.offsetY+=offY,queue[++end]=children[i]}node.offsetX=0,node.offsetY=0}}},updatePositions=function(layoutInfo,options){for(var i=0;i<layoutInfo.nodeSize;i++){0<(n=layoutInfo.layoutNodes[i]).children.length&&(n.maxX=void 0,n.minX=void 0,n.maxY=void 0,n.minY=void 0)}for(i=0;i<layoutInfo.nodeSize;i++){if(!(0<(n=layoutInfo.layoutNodes[i]).children.length||n.isLocked)){var tempForce=limitForce(n.offsetX,n.offsetY,layoutInfo.temperature);n.positionX+=tempForce.x,n.positionY+=tempForce.y,n.offsetX=0,n.offsetY=0,n.minX=n.positionX-n.width,n.maxX=n.positionX+n.width,n.minY=n.positionY-n.height,n.maxY=n.positionY+n.height,updateAncestryBoundaries(n,layoutInfo)}}for(i=0;i<layoutInfo.nodeSize;i++){var n;0<(n=layoutInfo.layoutNodes[i]).children.length&&!n.isLocked&&(n.positionX=(n.maxX+n.minX)/2,n.positionY=(n.maxY+n.minY)/2,n.width=n.maxX-n.minX,n.height=n.maxY-n.minY)}},limitForce=function(forceX,forceY,max){var force=Math.sqrt(forceX*forceX+forceY*forceY);if(force>max)var res={x:max*forceX/force,y:max*forceY/force};else res={x:forceX,y:forceY};return res},updateAncestryBoundaries=function updateAncestryBoundaries(node,layoutInfo){var parentId=node.parentId;if(null!=parentId){var p=layoutInfo.layoutNodes[layoutInfo.idToIndex[parentId]],flag=!1;return(null==p.maxX||node.maxX+p.padRight>p.maxX)&&(p.maxX=node.maxX+p.padRight,flag=!0),(null==p.minX||node.minX-p.padLeft<p.minX)&&(p.minX=node.minX-p.padLeft,flag=!0),(null==p.maxY||node.maxY+p.padBottom>p.maxY)&&(p.maxY=node.maxY+p.padBottom,flag=!0),(null==p.minY||node.minY-p.padTop<p.minY)&&(p.minY=node.minY-p.padTop,flag=!0),flag?updateAncestryBoundaries(p,layoutInfo):void 0}},separateComponents=function(layoutInfo,options){for(var nodes=layoutInfo.layoutNodes,components=[],i=0;i<nodes.length;i++){var node=nodes[i],cid=node.cmptId;(components[cid]=components[cid]||[]).push(node)}var totalA=0;for(i=0;i<components.length;i++){if(c=components[i]){c.x1=1/0,c.x2=-1/0,c.y1=1/0,c.y2=-1/0;for(var j=0;j<c.length;j++){var n=c[j];c.x1=Math.min(c.x1,n.positionX-n.width/2),c.x2=Math.max(c.x2,n.positionX+n.width/2),c.y1=Math.min(c.y1,n.positionY-n.height/2),c.y2=Math.max(c.y2,n.positionY+n.height/2)}c.w=c.x2-c.x1,c.h=c.y2-c.y1,totalA+=c.w*c.h}}components.sort((function(c1,c2){return c2.w*c2.h-c1.w*c1.h}));var x=0,y=0,usedW=0,rowH=0,maxRowW=Math.sqrt(totalA)*layoutInfo.clientWidth/layoutInfo.clientHeight;for(i=0;i<components.length;i++){var c;if(c=components[i]){for(j=0;j<c.length;j++){(n=c[j]).isLocked||(n.positionX+=x-c.x1,n.positionY+=y-c.y1)}x+=c.w+options.componentSpacing,usedW+=c.w+options.componentSpacing,rowH=Math.max(rowH,c.h),usedW>maxRowW&&(y+=rowH+options.componentSpacing,x=0,usedW=0,rowH=0)}}},defaults$d={fit:!0,padding:30,boundingBox:void 0,avoidOverlap:!0,avoidOverlapPadding:10,nodeDimensionsIncludeLabels:!1,spacingFactor:void 0,condense:!1,rows:void 0,cols:void 0,position:function(node){},sort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(node,i){return!0},ready:void 0,stop:void 0,transform:function(node,position){return position}};function GridLayout(options){this.options=extend({},defaults$d,options)}GridLayout.prototype.run=function(){var params=this.options,options=params,cy=params.cy,nodes=options.eles.nodes().not(":parent");options.sort&&(nodes=nodes.sort(options.sort));var bb=makeBoundingBox(options.boundingBox?options.boundingBox:{x1:0,y1:0,w:cy.width(),h:cy.height()});if(0===bb.h||0===bb.w)nodes.layoutPositions(this,options,(function(ele){return{x:bb.x1,y:bb.y1}}));else{var cells=nodes.size(),splits=Math.sqrt(cells*bb.h/bb.w),rows=Math.round(splits),cols=Math.round(bb.w/bb.h*splits),small=function(val){if(null==val)return Math.min(rows,cols);Math.min(rows,cols)==rows?rows=val:cols=val},large=function(val){if(null==val)return Math.max(rows,cols);Math.max(rows,cols)==rows?rows=val:cols=val},oRows=options.rows,oCols=null!=options.cols?options.cols:options.columns;if(null!=oRows&&null!=oCols)rows=oRows,cols=oCols;else if(null!=oRows&&null==oCols)rows=oRows,cols=Math.ceil(cells/rows);else if(null==oRows&&null!=oCols)cols=oCols,rows=Math.ceil(cells/cols);else if(cols*rows>cells){var sm=small(),lg=large();(sm-1)*lg>=cells?small(sm-1):(lg-1)*sm>=cells&&large(lg-1)}else for(;cols*rows<cells;){var _sm=small(),_lg=large();(_lg+1)*_sm>=cells?large(_lg+1):small(_sm+1)}var cellWidth=bb.w/cols,cellHeight=bb.h/rows;if(options.condense&&(cellWidth=0,cellHeight=0),options.avoidOverlap)for(var i=0;i<nodes.length;i++){var node=nodes[i],pos=node._private.position;null!=pos.x&&null!=pos.y||(pos.x=0,pos.y=0);var nbb=node.layoutDimensions(options),p=options.avoidOverlapPadding,w=nbb.w+p,h=nbb.h+p;cellWidth=Math.max(cellWidth,w),cellHeight=Math.max(cellHeight,h)}for(var cellUsed={},used=function(row,col){return!!cellUsed["c-"+row+"-"+col]},use=function(row,col){cellUsed["c-"+row+"-"+col]=!0},row=0,col=0,moveToNextCell=function(){++col>=cols&&(col=0,row++)},id2manPos={},_i=0;_i<nodes.length;_i++){var _node=nodes[_i],rcPos=options.position(_node);if(rcPos&&(void 0!==rcPos.row||void 0!==rcPos.col)){var _pos={row:rcPos.row,col:rcPos.col};if(void 0===_pos.col)for(_pos.col=0;used(_pos.row,_pos.col);)_pos.col++;else if(void 0===_pos.row)for(_pos.row=0;used(_pos.row,_pos.col);)_pos.row++;id2manPos[_node.id()]=_pos,use(_pos.row,_pos.col)}}nodes.layoutPositions(this,options,(function(element,i){var x,y;if(element.locked()||element.isParent())return!1;var rcPos=id2manPos[element.id()];if(rcPos)x=rcPos.col*cellWidth+cellWidth/2+bb.x1,y=rcPos.row*cellHeight+cellHeight/2+bb.y1;else{for(;used(row,col);)moveToNextCell();x=col*cellWidth+cellWidth/2+bb.x1,y=row*cellHeight+cellHeight/2+bb.y1,use(row,col),moveToNextCell()}return{x:x,y:y}}))}return this};var defaults$e={ready:function(){},stop:function(){}};function NullLayout(options){this.options=extend({},defaults$e,options)}NullLayout.prototype.run=function(){var options=this.options,eles=options.eles;options.cy;return this.emit("layoutstart"),eles.nodes().positions((function(){return{x:0,y:0}})),this.one("layoutready",options.ready),this.emit("layoutready"),this.one("layoutstop",options.stop),this.emit("layoutstop"),this},NullLayout.prototype.stop=function(){return this};var defaults$f={positions:void 0,zoom:void 0,pan:void 0,fit:!0,padding:30,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(node,i){return!0},ready:void 0,stop:void 0,transform:function(node,position){return position}};function PresetLayout(options){this.options=extend({},defaults$f,options)}PresetLayout.prototype.run=function(){var options=this.options,nodes=options.eles.nodes(),posIsFn=fn(options.positions);return nodes.layoutPositions(this,options,(function(node,i){var position=function(node){if(null==options.positions)return function(p){return{x:p.x,y:p.y}}(node.position());if(posIsFn)return options.positions(node);var pos=options.positions[node._private.data.id];return null==pos?null:pos}(node);return!node.locked()&&null!=position&&position})),this};var defaults$g={fit:!0,padding:30,boundingBox:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(node,i){return!0},ready:void 0,stop:void 0,transform:function(node,position){return position}};function RandomLayout(options){this.options=extend({},defaults$g,options)}RandomLayout.prototype.run=function(){var options=this.options,cy=options.cy,nodes=options.eles.nodes().not(":parent"),bb=makeBoundingBox(options.boundingBox?options.boundingBox:{x1:0,y1:0,w:cy.width(),h:cy.height()});return nodes.layoutPositions(this,options,(function(node,i){return{x:bb.x1+Math.round(Math.random()*bb.w),y:bb.y1+Math.round(Math.random()*bb.h)}})),this};var layout=[{name:"breadthfirst",impl:BreadthFirstLayout},{name:"circle",impl:CircleLayout},{name:"concentric",impl:ConcentricLayout},{name:"cose",impl:CoseLayout},{name:"grid",impl:GridLayout},{name:"null",impl:NullLayout},{name:"preset",impl:PresetLayout},{name:"random",impl:RandomLayout}];function NullRenderer(options){this.options=options,this.notifications=0}var noop$1=function(){};NullRenderer.prototype={recalculateRenderedStyle:noop$1,notify:function(){this.notifications++},init:noop$1,isHeadless:function(){return!0}};var BRp={arrowShapeWidth:.3,registerArrowShapes:function(){var arrowShapes=this.arrowShapes={},renderer=this,bbCollide=function(x,y,size,angle,translation,edgeWidth,padding){var x1=translation.x-size/2-padding,x2=translation.x+size/2+padding,y1=translation.y-size/2-padding,y2=translation.y+size/2+padding;return x1<=x&&x<=x2&&y1<=y&&y<=y2},transform=function(x,y,size,angle,translation){var xRotated=x*Math.cos(angle)-y*Math.sin(angle),yScaled=(x*Math.sin(angle)+y*Math.cos(angle))*size;return{x:xRotated*size+translation.x,y:yScaled+translation.y}},transformPoints=function(pts,size,angle,translation){for(var retPts=[],i=0;i<pts.length;i+=2){var x=pts[i],y=pts[i+1];retPts.push(transform(x,y,size,angle,translation))}return retPts},pointsToArr=function(pts){for(var ret=[],i=0;i<pts.length;i++){var p=pts[i];ret.push(p.x,p.y)}return ret},standardGap=function(edge){return edge.pstyle("width").pfValue*edge.pstyle("arrow-scale").pfValue*2},defineArrowShape=function(name,defn){string(defn)&&(defn=arrowShapes[defn]),arrowShapes[name]=extend({name:name,points:[-.15,-.3,.15,-.3,.15,.3,-.15,.3],collide:function(x,y,size,angle,translation,padding){var points=pointsToArr(transformPoints(this.points,size+2*padding,angle,translation));return pointInsidePolygonPoints(x,y,points)},roughCollide:bbCollide,draw:function(context,size,angle,translation){var points=transformPoints(this.points,size,angle,translation);renderer.arrowShapeImpl("polygon")(context,points)},spacing:function(edge){return 0},gap:standardGap},defn)};defineArrowShape("none",{collide:falsify,roughCollide:falsify,draw:noop,spacing:zeroify,gap:zeroify}),defineArrowShape("triangle",{points:[-.15,-.3,0,0,.15,-.3]}),defineArrowShape("arrow","triangle"),defineArrowShape("triangle-backcurve",{points:arrowShapes.triangle.points,controlPoint:[0,-.15],roughCollide:bbCollide,draw:function(context,size,angle,translation,edgeWidth){var ptsTrans=transformPoints(this.points,size,angle,translation),ctrlPt=this.controlPoint,ctrlPtTrans=transform(ctrlPt[0],ctrlPt[1],size,angle,translation);renderer.arrowShapeImpl(this.name)(context,ptsTrans,ctrlPtTrans)},gap:function(edge){return.8*standardGap(edge)}}),defineArrowShape("triangle-tee",{points:[0,0,.15,-.3,-.15,-.3,0,0],pointsTee:[-.15,-.4,-.15,-.5,.15,-.5,.15,-.4],collide:function(x,y,size,angle,translation,edgeWidth,padding){var triPts=pointsToArr(transformPoints(this.points,size+2*padding,angle,translation)),teePts=pointsToArr(transformPoints(this.pointsTee,size+2*padding,angle,translation));return pointInsidePolygonPoints(x,y,triPts)||pointInsidePolygonPoints(x,y,teePts)},draw:function(context,size,angle,translation,edgeWidth){var triPts=transformPoints(this.points,size,angle,translation),teePts=transformPoints(this.pointsTee,size,angle,translation);renderer.arrowShapeImpl(this.name)(context,triPts,teePts)}}),defineArrowShape("triangle-cross",{points:[0,0,.15,-.3,-.15,-.3,0,0],baseCrossLinePts:[-.15,-.4,-.15,-.4,.15,-.4,.15,-.4],crossLinePts:function(size,edgeWidth){var p=this.baseCrossLinePts.slice(),shiftFactor=edgeWidth/size;return p[3]=p[3]-shiftFactor,p[5]=p[5]-shiftFactor,p},collide:function(x,y,size,angle,translation,edgeWidth,padding){var triPts=pointsToArr(transformPoints(this.points,size+2*padding,angle,translation)),teePts=pointsToArr(transformPoints(this.crossLinePts(size,edgeWidth),size+2*padding,angle,translation));return pointInsidePolygonPoints(x,y,triPts)||pointInsidePolygonPoints(x,y,teePts)},draw:function(context,size,angle,translation,edgeWidth){var triPts=transformPoints(this.points,size,angle,translation),crossLinePts=transformPoints(this.crossLinePts(size,edgeWidth),size,angle,translation);renderer.arrowShapeImpl(this.name)(context,triPts,crossLinePts)}}),defineArrowShape("vee",{points:[-.15,-.3,0,0,.15,-.3,0,-.15],gap:function(edge){return.525*standardGap(edge)}}),defineArrowShape("circle",{radius:.15,collide:function(x,y,size,angle,translation,edgeWidth,padding){var t=translation;return Math.pow(t.x-x,2)+Math.pow(t.y-y,2)<=Math.pow((size+2*padding)*this.radius,2)},draw:function(context,size,angle,translation,edgeWidth){renderer.arrowShapeImpl(this.name)(context,translation.x,translation.y,this.radius*size)},spacing:function(edge){return renderer.getArrowWidth(edge.pstyle("width").pfValue,edge.pstyle("arrow-scale").value)*this.radius}}),defineArrowShape("tee",{points:[-.15,0,-.15,-.1,.15,-.1,.15,0],spacing:function(edge){return 1},gap:function(edge){return 1}}),defineArrowShape("square",{points:[-.15,0,.15,0,.15,-.3,-.15,-.3]}),defineArrowShape("diamond",{points:[-.15,-.15,0,-.3,.15,-.15,0,0],gap:function(edge){return edge.pstyle("width").pfValue*edge.pstyle("arrow-scale").value}}),defineArrowShape("chevron",{points:[0,0,-.15,-.15,-.1,-.2,0,-.1,.1,-.2,.15,-.15],gap:function(edge){return.95*edge.pstyle("width").pfValue*edge.pstyle("arrow-scale").value}})}},BRp$1={projectIntoViewport:function(clientX,clientY){var cy=this.cy,offsets=this.findContainerClientCoords(),offsetLeft=offsets[0],offsetTop=offsets[1],scale=offsets[4],pan=cy.pan(),zoom=cy.zoom();return[((clientX-offsetLeft)/scale-pan.x)/zoom,((clientY-offsetTop)/scale-pan.y)/zoom]},findContainerClientCoords:function(){if(this.containerBB)return this.containerBB;var container=this.container,rect=container.getBoundingClientRect(),style=window$1.getComputedStyle(container),styleValue=function(name){return parseFloat(style.getPropertyValue(name))},padding_left=styleValue("padding-left"),padding_right=styleValue("padding-right"),padding_top=styleValue("padding-top"),padding_bottom=styleValue("padding-bottom"),border_left=styleValue("border-left-width"),border_right=styleValue("border-right-width"),border_top=styleValue("border-top-width"),clientWidth=(styleValue("border-bottom-width"),container.clientWidth),clientHeight=container.clientHeight,paddingHor=padding_left+padding_right,paddingVer=padding_top+padding_bottom,borderHor=border_left+border_right,scale=rect.width/(clientWidth+borderHor),unscaledW=clientWidth-paddingHor,unscaledH=clientHeight-paddingVer,left=rect.left+padding_left+border_left,top=rect.top+padding_top+border_top;return this.containerBB=[left,top,unscaledW,unscaledH,scale]},invalidateContainerClientCoordsCache:function(){this.containerBB=null},findNearestElement:function(x,y,interactiveElementsOnly,isTouch){return this.findNearestElements(x,y,interactiveElementsOnly,isTouch)[0]},findNearestElements:function(x,y,interactiveElementsOnly,isTouch){var nearEdge,nearNode,self=this,r=this,eles=r.getCachedZSortedEles(),near=[],zoom=r.cy.zoom(),hasCompounds=r.cy.hasCompoundNodes(),edgeThreshold=(isTouch?24:8)/zoom,nodeThreshold=(isTouch?8:2)/zoom,labelThreshold=(isTouch?8:2)/zoom,minSqDist=1/0;function addEle(ele,sqDist){if(ele.isNode()){if(nearNode)return;nearNode=ele,near.push(ele)}if(ele.isEdge()&&(null==sqDist||sqDist<minSqDist))if(nearEdge){if(nearEdge.pstyle("z-compound-depth").value===ele.pstyle("z-compound-depth").value&&nearEdge.pstyle("z-compound-depth").value===ele.pstyle("z-compound-depth").value)for(var i=0;i<near.length;i++)if(near[i].isEdge()){near[i]=ele,nearEdge=ele,minSqDist=null!=sqDist?sqDist:minSqDist;break}}else near.push(ele),nearEdge=ele,minSqDist=null!=sqDist?sqDist:minSqDist}function checkNode(node){var width=node.outerWidth()+2*nodeThreshold,height=node.outerHeight()+2*nodeThreshold,hw=width/2,hh=height/2,pos=node.position();if(pos.x-hw<=x&&x<=pos.x+hw&&pos.y-hh<=y&&y<=pos.y+hh&&r.nodeShapes[self.getNodeShape(node)].checkPoint(x,y,0,width,height,pos.x,pos.y))return addEle(node,0),!0}function checkEdge(edge){var sqDist,_p=edge._private,rs=_p.rscratch,styleWidth=edge.pstyle("width").pfValue,scale=edge.pstyle("arrow-scale").value,width=styleWidth/2+edgeThreshold,widthSq=width*width,width2=2*width,src=_p.source,tgt=_p.target;if("segments"===rs.edgeType||"straight"===rs.edgeType||"haystack"===rs.edgeType){for(var pts=rs.allpts,i=0;i+3<pts.length;i+=2)if(inLineVicinity(x,y,pts[i],pts[i+1],pts[i+2],pts[i+3],width2)&&widthSq>(sqDist=sqdistToFiniteLine(x,y,pts[i],pts[i+1],pts[i+2],pts[i+3])))return addEle(edge,sqDist),!0}else if("bezier"===rs.edgeType||"multibezier"===rs.edgeType||"self"===rs.edgeType||"compound"===rs.edgeType)for(pts=rs.allpts,i=0;i+5<rs.allpts.length;i+=4)if(inBezierVicinity(x,y,pts[i],pts[i+1],pts[i+2],pts[i+3],pts[i+4],pts[i+5],width2)&&widthSq>(sqDist=sqdistToQuadraticBezier(x,y,pts[i],pts[i+1],pts[i+2],pts[i+3],pts[i+4],pts[i+5])))return addEle(edge,sqDist),!0;src=src||_p.source,tgt=tgt||_p.target;var arSize=self.getArrowWidth(styleWidth,scale),arrows=[{name:"source",x:rs.arrowStartX,y:rs.arrowStartY,angle:rs.srcArrowAngle},{name:"target",x:rs.arrowEndX,y:rs.arrowEndY,angle:rs.tgtArrowAngle},{name:"mid-source",x:rs.midX,y:rs.midY,angle:rs.midsrcArrowAngle},{name:"mid-target",x:rs.midX,y:rs.midY,angle:rs.midtgtArrowAngle}];for(i=0;i<arrows.length;i++){var ar=arrows[i],shape=r.arrowShapes[edge.pstyle(ar.name+"-arrow-shape").value],edgeWidth=edge.pstyle("width").pfValue;if(shape.roughCollide(x,y,arSize,ar.angle,{x:ar.x,y:ar.y},edgeWidth,edgeThreshold)&&shape.collide(x,y,arSize,ar.angle,{x:ar.x,y:ar.y},edgeWidth,edgeThreshold))return addEle(edge),!0}hasCompounds&&near.length>0&&(checkNode(src),checkNode(tgt))}function preprop(obj,name,pre){return getPrefixedProperty(obj,name,pre)}function checkLabel(ele,prefix){var prefixDash,_p=ele._private,th=labelThreshold;prefixDash=prefix?prefix+"-":"";var bb=_p.labelBounds[prefix||"main"],text=ele.pstyle(prefixDash+"label").value;if("yes"===ele.pstyle("text-events").strValue&&text){var rstyle=_p.rstyle,lx=preprop(rstyle,"labelX",prefix),ly=preprop(rstyle,"labelY",prefix),theta=preprop(_p.rscratch,"labelAngle",prefix),lx1=bb.x1-th,lx2=bb.x2+th,ly1=bb.y1-th,ly2=bb.y2+th;if(theta){var cos=Math.cos(theta),sin=Math.sin(theta),rotate=function(x,y){return{x:(x-=lx)*cos-(y-=ly)*sin+lx,y:x*sin+y*cos+ly}},px1y1=rotate(lx1,ly1),px1y2=rotate(lx1,ly2),px2y1=rotate(lx2,ly1),px2y2=rotate(lx2,ly2),points=[px1y1.x,px1y1.y,px2y1.x,px2y1.y,px2y2.x,px2y2.y,px1y2.x,px1y2.y];if(pointInsidePolygonPoints(x,y,points))return addEle(ele),!0}else if(inBoundingBox(bb,x,y))return addEle(ele),!0}}interactiveElementsOnly&&(eles=eles.interactive);for(var i=eles.length-1;i>=0;i--){var ele=eles[i];ele.isNode()?checkNode(ele)||checkLabel(ele):checkEdge(ele)||checkLabel(ele)||checkLabel(ele,"source")||checkLabel(ele,"target")}return near},getAllInBox:function(x1,y1,x2,y2){for(var bb,pt,eles=this.getCachedZSortedEles().interactive,box=[],x1c=Math.min(x1,x2),x2c=Math.max(x1,x2),y1c=Math.min(y1,y2),y2c=Math.max(y1,y2),boxBb=makeBoundingBox({x1:x1=x1c,y1:y1=y1c,x2:x2=x2c,y2:y2=y2c}),e=0;e<eles.length;e++){var ele=eles[e];if(ele.isNode()){var node=ele,nodeBb=node.boundingBox({includeNodes:!0,includeEdges:!1,includeLabels:!1});boundingBoxesIntersect(boxBb,nodeBb)&&!boundingBoxInBoundingBox(nodeBb,boxBb)&&box.push(node)}else{var edge=ele,_p=edge._private,rs=_p.rscratch;if(null!=rs.startX&&null!=rs.startY&&!inBoundingBox(boxBb,rs.startX,rs.startY))continue;if(null!=rs.endX&&null!=rs.endY&&!inBoundingBox(boxBb,rs.endX,rs.endY))continue;if("bezier"===rs.edgeType||"multibezier"===rs.edgeType||"self"===rs.edgeType||"compound"===rs.edgeType||"segments"===rs.edgeType||"haystack"===rs.edgeType){for(var pts=_p.rstyle.bezierPts||_p.rstyle.linePts||_p.rstyle.haystackPts,allInside=!0,i=0;i<pts.length;i++)if(bb=boxBb,pt=pts[i],!inBoundingBox(bb,pt.x,pt.y)){allInside=!1;break}allInside&&box.push(edge)}else"haystack"!==rs.edgeType&&"straight"!==rs.edgeType||box.push(edge)}}return box}},BRp$2={calculateArrowAngles:function(edge){var dispX,dispY,startX,startY,endX,endY,rs=edge._private.rscratch,isHaystack="haystack"===rs.edgeType,isBezier="bezier"===rs.edgeType,isMultibezier="multibezier"===rs.edgeType,isSegments="segments"===rs.edgeType,isCompound="compound"===rs.edgeType,isSelf="self"===rs.edgeType;if(isHaystack?(startX=rs.haystackPts[0],startY=rs.haystackPts[1],endX=rs.haystackPts[2],endY=rs.haystackPts[3]):(startX=rs.arrowStartX,startY=rs.arrowStartY,endX=rs.arrowEndX,endY=rs.arrowEndY),midX=rs.midX,midY=rs.midY,isSegments)dispX=startX-rs.segpts[0],dispY=startY-rs.segpts[1];else if(isMultibezier||isCompound||isSelf||isBezier){var pts=rs.allpts;dispX=startX-qbezierAt(pts[0],pts[2],pts[4],.1),dispY=startY-qbezierAt(pts[1],pts[3],pts[5],.1)}else dispX=startX-midX,dispY=startY-midY;rs.srcArrowAngle=getAngleFromDisp(dispX,dispY);var midX=rs.midX,midY=rs.midY;if(isHaystack&&(midX=(startX+endX)/2,midY=(startY+endY)/2),dispX=endX-startX,dispY=endY-startY,isSegments)if((pts=rs.allpts).length/2%2==0){var i1=(i2=pts.length/2)-2;dispX=pts[i2]-pts[i1],dispY=pts[i2+1]-pts[i1+1]}else{i1=(i2=pts.length/2-1)-2;var i2,i3=i2+2;dispX=pts[i2]-pts[i1],dispY=pts[i2+1]-pts[i1+1]}else if(isMultibezier||isCompound||isSelf){var bp0x,bp0y,bp1x,bp1y,pts=rs.allpts;if(rs.ctrlpts.length/2%2==0){var p1=(ic=(p0=pts.length/2-1)+2)+2;bp0x=qbezierAt(pts[p0],pts[ic],pts[p1],0),bp0y=qbezierAt(pts[p0+1],pts[ic+1],pts[p1+1],0),bp1x=qbezierAt(pts[p0],pts[ic],pts[p1],1e-4),bp1y=qbezierAt(pts[p0+1],pts[ic+1],pts[p1+1],1e-4)}else{var ic,p0;p1=(ic=pts.length/2-1)+2;bp0x=qbezierAt(pts[p0=ic-2],pts[ic],pts[p1],.4999),bp0y=qbezierAt(pts[p0+1],pts[ic+1],pts[p1+1],.4999),bp1x=qbezierAt(pts[p0],pts[ic],pts[p1],.5),bp1y=qbezierAt(pts[p0+1],pts[ic+1],pts[p1+1],.5)}dispX=bp1x-bp0x,dispY=bp1y-bp0y}(rs.midtgtArrowAngle=getAngleFromDisp(dispX,dispY),rs.midDispX=dispX,rs.midDispY=dispY,dispX*=-1,dispY*=-1,isSegments)&&((pts=rs.allpts).length/2%2==0||(dispX=-(pts[i3=(i2=pts.length/2-1)+2]-pts[i2]),dispY=-(pts[i3+1]-pts[i2+1])));if(rs.midsrcArrowAngle=getAngleFromDisp(dispX,dispY),isSegments)dispX=endX-rs.segpts[rs.segpts.length-2],dispY=endY-rs.segpts[rs.segpts.length-1];else if(isMultibezier||isCompound||isSelf||isBezier){var l=(pts=rs.allpts).length;dispX=endX-qbezierAt(pts[l-6],pts[l-4],pts[l-2],.9),dispY=endY-qbezierAt(pts[l-5],pts[l-3],pts[l-1],.9)}else dispX=endX-midX,dispY=endY-midY;rs.tgtArrowAngle=getAngleFromDisp(dispX,dispY)}};BRp$2.getArrowWidth=BRp$2.getArrowHeight=function(edgeWidth,scale){var cache=this.arrowWidthCache=this.arrowWidthCache||{},cachedVal=cache[edgeWidth+", "+scale];return cachedVal||(cachedVal=Math.max(Math.pow(13.37*edgeWidth,.9),29)*scale,cache[edgeWidth+", "+scale]=cachedVal,cachedVal)};var BRp$3={};function getPts(pts){var retPts=[];if(null!=pts){for(var i=0;i<pts.length;i+=2){var x=pts[i],y=pts[i+1];retPts.push({x:x,y:y})}return retPts}}BRp$3.findHaystackPoints=function(edges){for(var i=0;i<edges.length;i++){var edge=edges[i],_p=edge._private,rs=_p.rscratch;if(!rs.haystack){var angle=2*Math.random()*Math.PI;rs.source={x:Math.cos(angle),y:Math.sin(angle)},angle=2*Math.random()*Math.PI,rs.target={x:Math.cos(angle),y:Math.sin(angle)}}var src=_p.source,tgt=_p.target,srcPos=src.position(),tgtPos=tgt.position(),srcW=src.width(),tgtW=tgt.width(),srcH=src.height(),tgtH=tgt.height(),halfRadius=edge.pstyle("haystack-radius").value/2;rs.haystackPts=rs.allpts=[rs.source.x*srcW*halfRadius+srcPos.x,rs.source.y*srcH*halfRadius+srcPos.y,rs.target.x*tgtW*halfRadius+tgtPos.x,rs.target.y*tgtH*halfRadius+tgtPos.y],rs.midX=(rs.allpts[0]+rs.allpts[2])/2,rs.midY=(rs.allpts[1]+rs.allpts[3])/2,rs.edgeType="haystack",rs.haystack=!0,this.storeEdgeProjections(edge),this.calculateArrowAngles(edge),this.recalculateEdgeLabelProjections(edge),this.calculateLabelAngles(edge)}},BRp$3.findSegmentsPoints=function(edge,pairInfo){var rs=edge._private.rscratch,posPts=pairInfo.posPts,intersectionPts=pairInfo.intersectionPts,vectorNormInverse=pairInfo.vectorNormInverse,edgeDistances=edge.pstyle("edge-distances").value,segmentWs=edge.pstyle("segment-weights"),segmentDs=edge.pstyle("segment-distances"),segmentsN=Math.min(segmentWs.pfValue.length,segmentDs.pfValue.length);rs.edgeType="segments",rs.segpts=[];for(var s=0;s<segmentsN;s++){var w=segmentWs.pfValue[s],d=segmentDs.pfValue[s],w1=1-w,w2=w,midptPts="node-position"===edgeDistances?posPts:intersectionPts,adjustedMidpt={x:midptPts.x1*w1+midptPts.x2*w2,y:midptPts.y1*w1+midptPts.y2*w2};rs.segpts.push(adjustedMidpt.x+vectorNormInverse.x*d,adjustedMidpt.y+vectorNormInverse.y*d)}},BRp$3.findLoopPoints=function(edge,pairInfo,i,edgeIsUnbundled){var rs=edge._private.rscratch,dirCounts=pairInfo.dirCounts,srcPos=pairInfo.srcPos,ctrlptDists=edge.pstyle("control-point-distances"),ctrlptDist=ctrlptDists?ctrlptDists.pfValue[0]:void 0,loopDir=edge.pstyle("loop-direction").pfValue,loopSwp=edge.pstyle("loop-sweep").pfValue,stepSize=edge.pstyle("control-point-step-size").pfValue;rs.edgeType="self";var j=i,loopDist=stepSize;edgeIsUnbundled&&(j=0,loopDist=ctrlptDist);var loopAngle=loopDir-Math.PI/2,outAngle=loopAngle-loopSwp/2,inAngle=loopAngle+loopSwp/2,dc=String(loopDir+"_"+loopSwp);j=void 0===dirCounts[dc]?dirCounts[dc]=0:++dirCounts[dc],rs.ctrlpts=[srcPos.x+1.4*Math.cos(outAngle)*loopDist*(j/3+1),srcPos.y+1.4*Math.sin(outAngle)*loopDist*(j/3+1),srcPos.x+1.4*Math.cos(inAngle)*loopDist*(j/3+1),srcPos.y+1.4*Math.sin(inAngle)*loopDist*(j/3+1)]},BRp$3.findCompoundLoopPoints=function(edge,pairInfo,i,edgeIsUnbundled){var rs=edge._private.rscratch;rs.edgeType="compound";var srcPos=pairInfo.srcPos,tgtPos=pairInfo.tgtPos,srcW=pairInfo.srcW,srcH=pairInfo.srcH,tgtW=pairInfo.tgtW,tgtH=pairInfo.tgtH,stepSize=edge.pstyle("control-point-step-size").pfValue,ctrlptDists=edge.pstyle("control-point-distances"),ctrlptDist=ctrlptDists?ctrlptDists.pfValue[0]:void 0,j=i,loopDist=stepSize;edgeIsUnbundled&&(j=0,loopDist=ctrlptDist);var loopaPos={x:srcPos.x-srcW/2,y:srcPos.y-srcH/2},loopbPos={x:tgtPos.x-tgtW/2,y:tgtPos.y-tgtH/2},loopPos={x:Math.min(loopaPos.x,loopbPos.x),y:Math.min(loopaPos.y,loopbPos.y)},compoundStretchA=Math.max(.5,Math.log(.01*srcW)),compoundStretchB=Math.max(.5,Math.log(.01*tgtW));rs.ctrlpts=[loopPos.x,loopPos.y-(1+Math.pow(50,1.12)/100)*loopDist*(j/3+1)*compoundStretchA,loopPos.x-(1+Math.pow(50,1.12)/100)*loopDist*(j/3+1)*compoundStretchB,loopPos.y]},BRp$3.findStraightEdgePoints=function(edge){edge._private.rscratch.edgeType="straight"},BRp$3.findBezierPoints=function(edge,pairInfo,i,edgeIsUnbundled,edgeIsSwapped){var rs=edge._private.rscratch,vectorNormInverse=pairInfo.vectorNormInverse,posPts=pairInfo.posPts,intersectionPts=pairInfo.intersectionPts,edgeDistances=edge.pstyle("edge-distances").value,stepSize=edge.pstyle("control-point-step-size").pfValue,ctrlptDists=edge.pstyle("control-point-distances"),ctrlptWs=edge.pstyle("control-point-weights"),bezierN=ctrlptDists&&ctrlptWs?Math.min(ctrlptDists.value.length,ctrlptWs.value.length):1,ctrlptDist=ctrlptDists?ctrlptDists.pfValue[0]:void 0,ctrlptWeight=ctrlptWs.value[0],multi=edgeIsUnbundled;rs.edgeType=multi?"multibezier":"bezier",rs.ctrlpts=[];for(var b=0;b<bezierN;b++){var normctrlptDist=(.5-pairInfo.eles.length/2+i)*stepSize*(edgeIsSwapped?-1:1),manctrlptDist=void 0,sign=signum(normctrlptDist);multi&&(ctrlptDist=ctrlptDists?ctrlptDists.pfValue[b]:stepSize,ctrlptWeight=ctrlptWs.value[b]);var distanceFromMidpoint=void 0!==(manctrlptDist=edgeIsUnbundled?ctrlptDist:void 0!==ctrlptDist?sign*ctrlptDist:void 0)?manctrlptDist:normctrlptDist,w1=1-ctrlptWeight,w2=ctrlptWeight,midptPts="node-position"===edgeDistances?posPts:intersectionPts,adjustedMidpt={x:midptPts.x1*w1+midptPts.x2*w2,y:midptPts.y1*w1+midptPts.y2*w2};rs.ctrlpts.push(adjustedMidpt.x+vectorNormInverse.x*distanceFromMidpoint,adjustedMidpt.y+vectorNormInverse.y*distanceFromMidpoint)}},BRp$3.findTaxiPoints=function(edge,pairInfo){var rs=edge._private.rscratch;rs.edgeType="segments";var posPts=pairInfo.posPts,srcW=pairInfo.srcW,srcH=pairInfo.srcH,tgtW=pairInfo.tgtW,tgtH=pairInfo.tgtH,dIncludesNodeBody="node-position"!==edge.pstyle("edge-distances").value,taxiDir=edge.pstyle("taxi-direction").value,rawTaxiDir=taxiDir,taxiTurn=edge.pstyle("taxi-turn"),taxiTurnPfVal=taxiTurn.pfValue,minD=edge.pstyle("taxi-turn-min-distance").pfValue,turnIsPercent="%"===taxiTurn.units,dw=dIncludesNodeBody?(srcW+tgtW)/2:0,dh=dIncludesNodeBody?(srcH+tgtH)/2:0,pdx=posPts.x2-posPts.x1,pdy=posPts.y2-posPts.y1,subDWH=function(dxy,dwh){return dxy>0?Math.max(dxy-dwh,0):Math.min(dxy+dwh,0)},dx=subDWH(pdx,dw),dy=subDWH(pdy,dh),isExplicitDir=!1;"auto"===taxiDir?taxiDir=Math.abs(dx)>Math.abs(dy)?"horizontal":"vertical":"upward"===taxiDir||"downward"===taxiDir?(taxiDir="vertical",isExplicitDir=!0):"leftward"!==taxiDir&&"rightward"!==taxiDir||(taxiDir="horizontal",isExplicitDir=!0);var isVert="vertical"===taxiDir,l=isVert?dy:dx,pl=isVert?pdy:pdx,sgnL=signum(pl),forcedDir=!1;isExplicitDir&&turnIsPercent||!("downward"===rawTaxiDir&&pl<0||"upward"===rawTaxiDir&&pl>0||"leftward"===rawTaxiDir&&pl>0||"rightward"===rawTaxiDir&&pl<0)||(l=(sgnL*=-1)*Math.abs(l),forcedDir=!0);var d=turnIsPercent?taxiTurnPfVal*l:taxiTurnPfVal*sgnL,getIsTooClose=function(d){return Math.abs(d)<minD||Math.abs(d)>=Math.abs(l)},isTooCloseSrc=getIsTooClose(d),isTooCloseTgt=getIsTooClose(l-d);if((isTooCloseSrc||isTooCloseTgt)&&!forcedDir)if(isVert){var lShapeInsideSrc=Math.abs(pl)<=srcH/2,lShapeInsideTgt=Math.abs(pdx)<=tgtW/2;if(lShapeInsideSrc){var x=(posPts.x1+posPts.x2)/2,y1=posPts.y1,y2=posPts.y2;rs.segpts=[x,y1,x,y2]}else if(lShapeInsideTgt){var y=(posPts.y1+posPts.y2)/2,x1=posPts.x1,x2=posPts.x2;rs.segpts=[x1,y,x2,y]}else rs.segpts=[posPts.x1,posPts.y2]}else{var _lShapeInsideSrc=Math.abs(pl)<=srcW/2,_lShapeInsideTgt=Math.abs(pdy)<=tgtH/2;if(_lShapeInsideSrc){var _y=(posPts.y1+posPts.y2)/2,_x=posPts.x1,_x2=posPts.x2;rs.segpts=[_x,_y,_x2,_y]}else if(_lShapeInsideTgt){var _x3=(posPts.x1+posPts.x2)/2,_y2=posPts.y1,_y3=posPts.y2;rs.segpts=[_x3,_y2,_x3,_y3]}else rs.segpts=[posPts.x2,posPts.y1]}else if(isVert){var _y4=posPts.y1+d+(dIncludesNodeBody?srcH/2*sgnL:0),_x4=posPts.x1,_x5=posPts.x2;rs.segpts=[_x4,_y4,_x5,_y4]}else{var _x6=posPts.x1+d+(dIncludesNodeBody?srcW/2*sgnL:0),_y5=posPts.y1,_y6=posPts.y2;rs.segpts=[_x6,_y5,_x6,_y6]}},BRp$3.tryToCorrectInvalidPoints=function(edge,pairInfo){var rs=edge._private.rscratch;if("bezier"===rs.edgeType){var srcPos=pairInfo.srcPos,tgtPos=pairInfo.tgtPos,srcW=pairInfo.srcW,srcH=pairInfo.srcH,tgtW=pairInfo.tgtW,tgtH=pairInfo.tgtH,srcShape=pairInfo.srcShape,tgtShape=pairInfo.tgtShape,badStart=!number(rs.startX)||!number(rs.startY),badAStart=!number(rs.arrowStartX)||!number(rs.arrowStartY),badEnd=!number(rs.endX)||!number(rs.endY),badAEnd=!number(rs.arrowEndX)||!number(rs.arrowEndY),minCpADist=3*(this.getArrowWidth(edge.pstyle("width").pfValue,edge.pstyle("arrow-scale").value)*this.arrowShapeWidth),startACpDist=dist({x:rs.ctrlpts[0],y:rs.ctrlpts[1]},{x:rs.startX,y:rs.startY}),closeStartACp=startACpDist<minCpADist,endACpDist=dist({x:rs.ctrlpts[0],y:rs.ctrlpts[1]},{x:rs.endX,y:rs.endY}),closeEndACp=endACpDist<minCpADist,overlapping=!1;if(badStart||badAStart||closeStartACp){overlapping=!0;var cpD={x:rs.ctrlpts[0]-srcPos.x,y:rs.ctrlpts[1]-srcPos.y},cpL=Math.sqrt(cpD.x*cpD.x+cpD.y*cpD.y),cpM={x:cpD.x/cpL,y:cpD.y/cpL},radius=Math.max(srcW,srcH),cpProj={x:rs.ctrlpts[0]+2*cpM.x*radius,y:rs.ctrlpts[1]+2*cpM.y*radius},srcCtrlPtIntn=srcShape.intersectLine(srcPos.x,srcPos.y,srcW,srcH,cpProj.x,cpProj.y,0);closeStartACp?(rs.ctrlpts[0]=rs.ctrlpts[0]+cpM.x*(minCpADist-startACpDist),rs.ctrlpts[1]=rs.ctrlpts[1]+cpM.y*(minCpADist-startACpDist)):(rs.ctrlpts[0]=srcCtrlPtIntn[0]+cpM.x*minCpADist,rs.ctrlpts[1]=srcCtrlPtIntn[1]+cpM.y*minCpADist)}if(badEnd||badAEnd||closeEndACp){overlapping=!0;var _cpD={x:rs.ctrlpts[0]-tgtPos.x,y:rs.ctrlpts[1]-tgtPos.y},_cpL=Math.sqrt(_cpD.x*_cpD.x+_cpD.y*_cpD.y),_cpM={x:_cpD.x/_cpL,y:_cpD.y/_cpL},_radius=Math.max(srcW,srcH),_cpProj={x:rs.ctrlpts[0]+2*_cpM.x*_radius,y:rs.ctrlpts[1]+2*_cpM.y*_radius},tgtCtrlPtIntn=tgtShape.intersectLine(tgtPos.x,tgtPos.y,tgtW,tgtH,_cpProj.x,_cpProj.y,0);closeEndACp?(rs.ctrlpts[0]=rs.ctrlpts[0]+_cpM.x*(minCpADist-endACpDist),rs.ctrlpts[1]=rs.ctrlpts[1]+_cpM.y*(minCpADist-endACpDist)):(rs.ctrlpts[0]=tgtCtrlPtIntn[0]+_cpM.x*minCpADist,rs.ctrlpts[1]=tgtCtrlPtIntn[1]+_cpM.y*minCpADist)}overlapping&&this.findEndpoints(edge)}},BRp$3.storeAllpts=function(edge){var rs=edge._private.rscratch;if("multibezier"===rs.edgeType||"bezier"===rs.edgeType||"self"===rs.edgeType||"compound"===rs.edgeType){rs.allpts=[],rs.allpts.push(rs.startX,rs.startY);for(var b=0;b+1<rs.ctrlpts.length;b+=2)rs.allpts.push(rs.ctrlpts[b],rs.ctrlpts[b+1]),b+3<rs.ctrlpts.length&&rs.allpts.push((rs.ctrlpts[b]+rs.ctrlpts[b+2])/2,(rs.ctrlpts[b+1]+rs.ctrlpts[b+3])/2);var m;rs.allpts.push(rs.endX,rs.endY),rs.ctrlpts.length/2%2==0?(m=rs.allpts.length/2-1,rs.midX=rs.allpts[m],rs.midY=rs.allpts[m+1]):(m=rs.allpts.length/2-3,.5,rs.midX=qbezierAt(rs.allpts[m],rs.allpts[m+2],rs.allpts[m+4],.5),rs.midY=qbezierAt(rs.allpts[m+1],rs.allpts[m+3],rs.allpts[m+5],.5))}else if("straight"===rs.edgeType)rs.allpts=[rs.startX,rs.startY,rs.endX,rs.endY],rs.midX=(rs.startX+rs.endX+rs.arrowStartX+rs.arrowEndX)/4,rs.midY=(rs.startY+rs.endY+rs.arrowStartY+rs.arrowEndY)/4;else if("segments"===rs.edgeType)if(rs.allpts=[],rs.allpts.push(rs.startX,rs.startY),rs.allpts.push.apply(rs.allpts,rs.segpts),rs.allpts.push(rs.endX,rs.endY),rs.segpts.length%4==0){var i2=rs.segpts.length/2,i1=i2-2;rs.midX=(rs.segpts[i1]+rs.segpts[i2])/2,rs.midY=(rs.segpts[i1+1]+rs.segpts[i2+1])/2}else{var _i=rs.segpts.length/2-1;rs.midX=rs.segpts[_i],rs.midY=rs.segpts[_i+1]}},BRp$3.checkForInvalidEdgeWarning=function(edge){var rs=edge[0]._private.rscratch;rs.nodesOverlap||number(rs.startX)&&number(rs.startY)&&number(rs.endX)&&number(rs.endY)?rs.loggedErr=!1:rs.loggedErr||(rs.loggedErr=!0,warn("Edge `"+edge.id()+"` has invalid endpoints and so it is impossible to draw.  Adjust your edge style (e.g. control points) accordingly or use an alternative edge type.  This is expected behaviour when the source node and the target node overlap."))},BRp$3.findEdgeControlPoints=function(edges){var _this=this;if(edges&&0!==edges.length){for(var r=this,hasCompounds=r.cy.hasCompoundNodes(),hashTable={map:new Map$1,get:function(pairId){var map2=this.map.get(pairId[0]);return null!=map2?map2.get(pairId[1]):null},set:function(pairId,val){var map2=this.map.get(pairId[0]);null==map2&&(map2=new Map$1,this.map.set(pairId[0],map2)),map2.set(pairId[1],val)}},pairIds=[],haystackEdges=[],i=0;i<edges.length;i++){var edge=edges[i],_p=edge._private,curveStyle=edge.pstyle("curve-style").value;if(!edge.removed()&&edge.takesUpSpace())if("haystack"!==curveStyle){var edgeIsUnbundled="unbundled-bezier"===curveStyle||"segments"===curveStyle||"straight"===curveStyle||"taxi"===curveStyle,edgeIsBezier="unbundled-bezier"===curveStyle||"bezier"===curveStyle,src=_p.source,tgt=_p.target,pairId=[src.poolIndex(),tgt.poolIndex()].sort(),tableEntry=hashTable.get(pairId);null==tableEntry&&(tableEntry={eles:[]},hashTable.set(pairId,tableEntry),pairIds.push(pairId)),tableEntry.eles.push(edge),edgeIsUnbundled&&(tableEntry.hasUnbundled=!0),edgeIsBezier&&(tableEntry.hasBezier=!0)}else haystackEdges.push(edge)}for(var _loop=function(p){var pairId=pairIds[p],pairInfo=hashTable.get(pairId),swappedpairInfo=void 0;if(!pairInfo.hasUnbundled){var pllEdges=pairInfo.eles[0].parallelEdges().filter((function(e){return e.isBundledBezier()}));clearArray(pairInfo.eles),pllEdges.forEach((function(edge){return pairInfo.eles.push(edge)})),pairInfo.eles.sort((function(edge1,edge2){return edge1.poolIndex()-edge2.poolIndex()}))}var firstEdge=pairInfo.eles[0],src=firstEdge.source(),tgt=firstEdge.target();if(src.poolIndex()>tgt.poolIndex()){var temp=src;src=tgt,tgt=temp}var srcPos=pairInfo.srcPos=src.position(),tgtPos=pairInfo.tgtPos=tgt.position(),srcW=pairInfo.srcW=src.outerWidth(),srcH=pairInfo.srcH=src.outerHeight(),tgtW=pairInfo.tgtW=tgt.outerWidth(),tgtH=pairInfo.tgtH=tgt.outerHeight(),srcShape=pairInfo.srcShape=r.nodeShapes[_this.getNodeShape(src)],tgtShape=pairInfo.tgtShape=r.nodeShapes[_this.getNodeShape(tgt)];pairInfo.dirCounts={north:0,west:0,south:0,east:0,northwest:0,southwest:0,northeast:0,southeast:0};for(var _i2=0;_i2<pairInfo.eles.length;_i2++){var _edge=pairInfo.eles[_i2],rs=_edge[0]._private.rscratch,_curveStyle=_edge.pstyle("curve-style").value,_edgeIsUnbundled="unbundled-bezier"===_curveStyle||"segments"===_curveStyle||"taxi"===_curveStyle,edgeIsSwapped=!src.same(_edge.source());if(!pairInfo.calculatedIntersection&&src!==tgt&&(pairInfo.hasBezier||pairInfo.hasUnbundled)){pairInfo.calculatedIntersection=!0;var srcOutside=srcShape.intersectLine(srcPos.x,srcPos.y,srcW,srcH,tgtPos.x,tgtPos.y,0),srcIntn=pairInfo.srcIntn=srcOutside,tgtOutside=tgtShape.intersectLine(tgtPos.x,tgtPos.y,tgtW,tgtH,srcPos.x,srcPos.y,0),tgtIntn=pairInfo.tgtIntn=tgtOutside,intersectionPts=pairInfo.intersectionPts={x1:srcOutside[0],x2:tgtOutside[0],y1:srcOutside[1],y2:tgtOutside[1]},posPts=pairInfo.posPts={x1:srcPos.x,x2:tgtPos.x,y1:srcPos.y,y2:tgtPos.y},dy=tgtOutside[1]-srcOutside[1],dx=tgtOutside[0]-srcOutside[0],l=Math.sqrt(dx*dx+dy*dy),vector=pairInfo.vector={x:dx,y:dy},vectorNorm=pairInfo.vectorNorm={x:vector.x/l,y:vector.y/l},vectorNormInverse={x:-vectorNorm.y,y:vectorNorm.x};pairInfo.nodesOverlap=!number(l)||tgtShape.checkPoint(srcOutside[0],srcOutside[1],0,tgtW,tgtH,tgtPos.x,tgtPos.y)||srcShape.checkPoint(tgtOutside[0],tgtOutside[1],0,srcW,srcH,srcPos.x,srcPos.y),pairInfo.vectorNormInverse=vectorNormInverse,swappedpairInfo={nodesOverlap:pairInfo.nodesOverlap,dirCounts:pairInfo.dirCounts,calculatedIntersection:!0,hasBezier:pairInfo.hasBezier,hasUnbundled:pairInfo.hasUnbundled,eles:pairInfo.eles,srcPos:tgtPos,tgtPos:srcPos,srcW:tgtW,srcH:tgtH,tgtW:srcW,tgtH:srcH,srcIntn:tgtIntn,tgtIntn:srcIntn,srcShape:tgtShape,tgtShape:srcShape,posPts:{x1:posPts.x2,y1:posPts.y2,x2:posPts.x1,y2:posPts.y1},intersectionPts:{x1:intersectionPts.x2,y1:intersectionPts.y2,x2:intersectionPts.x1,y2:intersectionPts.y1},vector:{x:-vector.x,y:-vector.y},vectorNorm:{x:-vectorNorm.x,y:-vectorNorm.y},vectorNormInverse:{x:-vectorNormInverse.x,y:-vectorNormInverse.y}}}var passedPairInfo=edgeIsSwapped?swappedpairInfo:pairInfo;rs.nodesOverlap=passedPairInfo.nodesOverlap,rs.srcIntn=passedPairInfo.srcIntn,rs.tgtIntn=passedPairInfo.tgtIntn,hasCompounds&&(src.isParent()||src.isChild()||tgt.isParent()||tgt.isChild())&&(src.parents().anySame(tgt)||tgt.parents().anySame(src)||src.same(tgt)&&src.isParent())?_this.findCompoundLoopPoints(_edge,passedPairInfo,_i2,_edgeIsUnbundled):src===tgt?_this.findLoopPoints(_edge,passedPairInfo,_i2,_edgeIsUnbundled):"segments"===_curveStyle?_this.findSegmentsPoints(_edge,passedPairInfo):"taxi"===_curveStyle?_this.findTaxiPoints(_edge,passedPairInfo):"straight"===_curveStyle||!_edgeIsUnbundled&&pairInfo.eles.length%2==1&&_i2===Math.floor(pairInfo.eles.length/2)?_this.findStraightEdgePoints(_edge):_this.findBezierPoints(_edge,passedPairInfo,_i2,_edgeIsUnbundled,edgeIsSwapped),_this.findEndpoints(_edge),_this.tryToCorrectInvalidPoints(_edge,passedPairInfo),_this.checkForInvalidEdgeWarning(_edge),_this.storeAllpts(_edge),_this.storeEdgeProjections(_edge),_this.calculateArrowAngles(_edge),_this.recalculateEdgeLabelProjections(_edge),_this.calculateLabelAngles(_edge)}},p=0;p<pairIds.length;p++)_loop(p);this.findHaystackPoints(haystackEdges)}},BRp$3.getSegmentPoints=function(edge){var rs=edge[0]._private.rscratch;if("segments"===rs.edgeType)return this.recalculateRenderedStyle(edge),getPts(rs.segpts)},BRp$3.getControlPoints=function(edge){var rs=edge[0]._private.rscratch,type=rs.edgeType;if("bezier"===type||"multibezier"===type||"self"===type||"compound"===type)return this.recalculateRenderedStyle(edge),getPts(rs.ctrlpts)},BRp$3.getEdgeMidpoint=function(edge){var rs=edge[0]._private.rscratch;return this.recalculateRenderedStyle(edge),{x:rs.midX,y:rs.midY}};var BRp$4={manualEndptToPx:function(node,prop){var npos=node.position(),w=node.outerWidth(),h=node.outerHeight();if(2===prop.value.length){var p=[prop.pfValue[0],prop.pfValue[1]];return"%"===prop.units[0]&&(p[0]=p[0]*w),"%"===prop.units[1]&&(p[1]=p[1]*h),p[0]+=npos.x,p[1]+=npos.y,p}var angle=prop.pfValue[0];angle=-Math.PI/2+angle;var l=2*Math.max(w,h),_p=[npos.x+Math.cos(angle)*l,npos.y+Math.sin(angle)*l];return this.nodeShapes[this.getNodeShape(node)].intersectLine(npos.x,npos.y,w,h,_p[0],_p[1],0)},findEndpoints:function(edge){var intersect,p1,p2,p1_i,p2_i,r=this,source=edge.source()[0],target=edge.target()[0],srcPos=source.position(),tgtPos=target.position(),tgtArShape=edge.pstyle("target-arrow-shape").value,srcArShape=edge.pstyle("source-arrow-shape").value,tgtDist=edge.pstyle("target-distance-from-node").pfValue,srcDist=edge.pstyle("source-distance-from-node").pfValue,curveStyle=edge.pstyle("curve-style").value,rs=edge._private.rscratch,et=rs.edgeType,self="self"===et||"compound"===et,bezier="bezier"===et||"multibezier"===et||self,multi="bezier"!==et,lines="straight"===et||"segments"===et,segments="segments"===et,hasEndpts=bezier||multi||lines,overrideEndpts=self||"taxi"===curveStyle,srcManEndpt=edge.pstyle("source-endpoint"),srcManEndptVal=overrideEndpts?"outside-to-node":srcManEndpt.value,tgtManEndpt=edge.pstyle("target-endpoint"),tgtManEndptVal=overrideEndpts?"outside-to-node":tgtManEndpt.value;if(rs.srcManEndpt=srcManEndpt,rs.tgtManEndpt=tgtManEndpt,bezier){var cpStart=[rs.ctrlpts[0],rs.ctrlpts[1]];p1=multi?[rs.ctrlpts[rs.ctrlpts.length-2],rs.ctrlpts[rs.ctrlpts.length-1]]:cpStart,p2=cpStart}else if(lines){var srcArrowFromPt=segments?rs.segpts.slice(0,2):[tgtPos.x,tgtPos.y];p1=segments?rs.segpts.slice(rs.segpts.length-2):[srcPos.x,srcPos.y],p2=srcArrowFromPt}if("inside-to-node"===tgtManEndptVal)intersect=[tgtPos.x,tgtPos.y];else if(tgtManEndpt.units)intersect=this.manualEndptToPx(target,tgtManEndpt);else if("outside-to-line"===tgtManEndptVal)intersect=rs.tgtIntn;else if("outside-to-node"===tgtManEndptVal||"outside-to-node-or-label"===tgtManEndptVal?p1_i=p1:"outside-to-line"!==tgtManEndptVal&&"outside-to-line-or-label"!==tgtManEndptVal||(p1_i=[srcPos.x,srcPos.y]),intersect=r.nodeShapes[this.getNodeShape(target)].intersectLine(tgtPos.x,tgtPos.y,target.outerWidth(),target.outerHeight(),p1_i[0],p1_i[1],0),"outside-to-node-or-label"===tgtManEndptVal||"outside-to-line-or-label"===tgtManEndptVal){var trs=target._private.rscratch,lw=trs.labelWidth,lh=trs.labelHeight,lx=trs.labelX,ly=trs.labelY,va=target.pstyle("text-valign").value;"top"===va?ly-=lh/2:"bottom"===va&&(ly+=lh/2);var ha=target.pstyle("text-halign").value;"left"===ha?lx-=lw/2:"right"===ha&&(lx+=lw/2);var labelIntersect=r.nodeShapes.rectangle.intersectLine(lx,ly,lw,lh,p1_i[0],p1_i[1],0),refPt=srcPos,intSqdist=sqdist(refPt,array2point(intersect));sqdist(refPt,array2point(labelIntersect))<intSqdist&&(intersect=labelIntersect)}var arrowEnd=shortenIntersection(intersect,p1,r.arrowShapes[tgtArShape].spacing(edge)+tgtDist),edgeEnd=shortenIntersection(intersect,p1,r.arrowShapes[tgtArShape].gap(edge)+tgtDist);if(rs.endX=edgeEnd[0],rs.endY=edgeEnd[1],rs.arrowEndX=arrowEnd[0],rs.arrowEndY=arrowEnd[1],"inside-to-node"===srcManEndptVal)intersect=[srcPos.x,srcPos.y];else if(srcManEndpt.units)intersect=this.manualEndptToPx(source,srcManEndpt);else if("outside-to-line"===srcManEndptVal)intersect=rs.srcIntn;else if("outside-to-node"===srcManEndptVal||"outside-to-node-or-label"===srcManEndptVal?p2_i=p2:"outside-to-line"!==srcManEndptVal&&"outside-to-line-or-label"!==srcManEndptVal||(p2_i=[tgtPos.x,tgtPos.y]),intersect=r.nodeShapes[this.getNodeShape(source)].intersectLine(srcPos.x,srcPos.y,source.outerWidth(),source.outerHeight(),p2_i[0],p2_i[1],0),"outside-to-node-or-label"===srcManEndptVal||"outside-to-line-or-label"===srcManEndptVal){var srs=source._private.rscratch,_lw=srs.labelWidth,_lh=srs.labelHeight,_lx=srs.labelX,_ly=srs.labelY,_va=source.pstyle("text-valign").value;"top"===_va?_ly-=_lh/2:"bottom"===_va&&(_ly+=_lh/2);var _ha=source.pstyle("text-halign").value;"left"===_ha?_lx-=_lw/2:"right"===_ha&&(_lx+=_lw/2);var _labelIntersect=r.nodeShapes.rectangle.intersectLine(_lx,_ly,_lw,_lh,p2_i[0],p2_i[1],0),_refPt=tgtPos,_intSqdist=sqdist(_refPt,array2point(intersect));sqdist(_refPt,array2point(_labelIntersect))<_intSqdist&&(intersect=_labelIntersect)}var arrowStart=shortenIntersection(intersect,p2,r.arrowShapes[srcArShape].spacing(edge)+srcDist),edgeStart=shortenIntersection(intersect,p2,r.arrowShapes[srcArShape].gap(edge)+srcDist);rs.startX=edgeStart[0],rs.startY=edgeStart[1],rs.arrowStartX=arrowStart[0],rs.arrowStartY=arrowStart[1],hasEndpts&&(number(rs.startX)&&number(rs.startY)&&number(rs.endX)&&number(rs.endY)?rs.badLine=!1:rs.badLine=!0)},getSourceEndpoint:function(edge){var rs=edge[0]._private.rscratch;switch(this.recalculateRenderedStyle(edge),rs.edgeType){case"haystack":return{x:rs.haystackPts[0],y:rs.haystackPts[1]};default:return{x:rs.arrowStartX,y:rs.arrowStartY}}},getTargetEndpoint:function(edge){var rs=edge[0]._private.rscratch;switch(this.recalculateRenderedStyle(edge),rs.edgeType){case"haystack":return{x:rs.haystackPts[2],y:rs.haystackPts[3]};default:return{x:rs.arrowEndX,y:rs.arrowEndY}}}},BRp$5={};function pushBezierPts(r,edge,pts){for(var qbezierAt$1=function(p1,p2,p3,t){return qbezierAt(p1,p2,p3,t)},bpts=edge._private.rstyle.bezierPts,i=0;i<r.bezierProjPcts.length;i++){var p=r.bezierProjPcts[i];bpts.push({x:qbezierAt$1(pts[0],pts[2],pts[4],p),y:qbezierAt$1(pts[1],pts[3],pts[5],p)})}}BRp$5.storeEdgeProjections=function(edge){var _p=edge._private,rs=_p.rscratch,et=rs.edgeType;if(_p.rstyle.bezierPts=null,_p.rstyle.linePts=null,_p.rstyle.haystackPts=null,"multibezier"===et||"bezier"===et||"self"===et||"compound"===et){_p.rstyle.bezierPts=[];for(var i=0;i+5<rs.allpts.length;i+=4)pushBezierPts(this,edge,rs.allpts.slice(i,i+6))}else if("segments"===et){var lpts=_p.rstyle.linePts=[];for(i=0;i+1<rs.allpts.length;i+=2)lpts.push({x:rs.allpts[i],y:rs.allpts[i+1]})}else if("haystack"===et){var hpts=rs.haystackPts;_p.rstyle.haystackPts=[{x:hpts[0],y:hpts[1]},{x:hpts[2],y:hpts[3]}]}_p.rstyle.arrowWidth=this.getArrowWidth(edge.pstyle("width").pfValue,edge.pstyle("arrow-scale").value)*this.arrowShapeWidth},BRp$5.recalculateEdgeProjections=function(edges){this.findEdgeControlPoints(edges)};var BRp$6={recalculateNodeLabelProjection:function(node){var content=node.pstyle("label").strValue;if(!emptyString(content)){var textX,textY,_p=node._private,nodeWidth=node.width(),nodeHeight=node.height(),padding=node.padding(),nodePos=node.position(),textHalign=node.pstyle("text-halign").strValue,textValign=node.pstyle("text-valign").strValue,rs=_p.rscratch,rstyle=_p.rstyle;switch(textHalign){case"left":textX=nodePos.x-nodeWidth/2-padding;break;case"right":textX=nodePos.x+nodeWidth/2+padding;break;default:textX=nodePos.x}switch(textValign){case"top":textY=nodePos.y-nodeHeight/2-padding;break;case"bottom":textY=nodePos.y+nodeHeight/2+padding;break;default:textY=nodePos.y}rs.labelX=textX,rs.labelY=textY,rstyle.labelX=textX,rstyle.labelY=textY,this.applyLabelDimensions(node)}}},lineAngleFromDelta=function(dx,dy){var angle=Math.atan(dy/dx);return 0===dx&&angle<0&&(angle*=-1),angle},lineAngle=function(p0,p1){var dx=p1.x-p0.x,dy=p1.y-p0.y;return lineAngleFromDelta(dx,dy)};BRp$6.recalculateEdgeLabelProjections=function(edge){var p,_p=edge._private,rs=_p.rscratch,r=this,content={mid:edge.pstyle("label").strValue,source:edge.pstyle("source-label").strValue,target:edge.pstyle("target-label").strValue};if(content.mid||content.source||content.target){p={x:rs.midX,y:rs.midY};var setRs=function(propName,prefix,value){setPrefixedProperty(_p.rscratch,propName,prefix,value),setPrefixedProperty(_p.rstyle,propName,prefix,value)};setRs("labelX",null,p.x),setRs("labelY",null,p.y);var midAngle=lineAngleFromDelta(rs.midDispX,rs.midDispY);setRs("labelAutoAngle",null,midAngle);var calculateEndProjection=function(prefix){var angle,isSrc="source"===prefix;if(content[prefix]){var offset=edge.pstyle(prefix+"-text-offset").pfValue;switch(rs.edgeType){case"self":case"compound":case"bezier":case"multibezier":for(var selected,cps=function createControlPointInfo(){if(createControlPointInfo.cache)return createControlPointInfo.cache;for(var ctrlpts=[],i=0;i+5<rs.allpts.length;i+=4){var p0={x:rs.allpts[i],y:rs.allpts[i+1]},p1={x:rs.allpts[i+2],y:rs.allpts[i+3]},p2={x:rs.allpts[i+4],y:rs.allpts[i+5]};ctrlpts.push({p0:p0,p1:p1,p2:p2,startDist:0,length:0,segments:[]})}var bpts=_p.rstyle.bezierPts,nProjs=r.bezierProjPcts.length;function addSegment(cp,p0,p1,t0,t1){var length=dist(p0,p1),prevSegment=cp.segments[cp.segments.length-1],segment={p0:p0,p1:p1,t0:t0,t1:t1,startDist:prevSegment?prevSegment.startDist+prevSegment.length:0,length:length};cp.segments.push(segment),cp.length+=length}for(var _i=0;_i<ctrlpts.length;_i++){var cp=ctrlpts[_i],prevCp=ctrlpts[_i-1];prevCp&&(cp.startDist=prevCp.startDist+prevCp.length),addSegment(cp,cp.p0,bpts[_i*nProjs],0,r.bezierProjPcts[0]);for(var j=0;j<nProjs-1;j++)addSegment(cp,bpts[_i*nProjs+j],bpts[_i*nProjs+j+1],r.bezierProjPcts[j],r.bezierProjPcts[j+1]);addSegment(cp,bpts[_i*nProjs+nProjs-1],cp.p2,r.bezierProjPcts[nProjs-1],1)}return createControlPointInfo.cache=ctrlpts}(),startDist=0,totalDist=0,i=0;i<cps.length;i++){for(var _cp=cps[isSrc?i:cps.length-1-i],j=0;j<_cp.segments.length;j++){var _seg=_cp.segments[isSrc?j:_cp.segments.length-1-j],lastSeg=i===cps.length-1&&j===_cp.segments.length-1;if(startDist=totalDist,(totalDist+=_seg.length)>=offset||lastSeg){selected={cp:_cp,segment:_seg};break}}if(selected)break}var cp=selected.cp,seg=selected.segment,tSegment=(offset-startDist)/seg.length,segDt=seg.t1-seg.t0,t=isSrc?seg.t0+segDt*tSegment:seg.t1-segDt*tSegment;t=bound(0,t,1),p=qbezierPtAt(cp.p0,cp.p1,cp.p2,t),angle=function(p0,p1,p2,t){var t0=bound(0,t-.001,1),t1=bound(0,t+.001,1),lp0=qbezierPtAt(p0,p1,p2,t0),lp1=qbezierPtAt(p0,p1,p2,t1);return lineAngle(lp0,lp1)}(cp.p0,cp.p1,cp.p2,t);break;case"straight":case"segments":case"haystack":for(var di,d0,p0,p1,d=0,l=rs.allpts.length,_i2=0;_i2+3<l&&(isSrc?(p0={x:rs.allpts[_i2],y:rs.allpts[_i2+1]},p1={x:rs.allpts[_i2+2],y:rs.allpts[_i2+3]}):(p0={x:rs.allpts[l-2-_i2],y:rs.allpts[l-1-_i2]},p1={x:rs.allpts[l-4-_i2],y:rs.allpts[l-3-_i2]}),d0=d,!((d+=di=dist(p0,p1))>=offset));_i2+=2);var _t=(offset-d0)/di;_t=bound(0,_t,1),p=function(p0,p1,t,d){var vec_x=p1.x-p0.x,vec_y=p1.y-p0.y,vecDist=dist(p0,p1),normVec_x=vec_x/vecDist,normVec_y=vec_y/vecDist;return t=null==t?0:t,d=null!=d?d:t*vecDist,{x:p0.x+normVec_x*d,y:p0.y+normVec_y*d}}(p0,p1,_t),angle=lineAngle(p0,p1)}setRs("labelX",prefix,p.x),setRs("labelY",prefix,p.y),setRs("labelAutoAngle",prefix,angle)}};calculateEndProjection("source"),calculateEndProjection("target"),this.applyLabelDimensions(edge)}},BRp$6.applyLabelDimensions=function(ele){this.applyPrefixedLabelDimensions(ele),ele.isEdge()&&(this.applyPrefixedLabelDimensions(ele,"source"),this.applyPrefixedLabelDimensions(ele,"target"))},BRp$6.applyPrefixedLabelDimensions=function(ele,prefix){var _p=ele._private,text=this.getLabelText(ele,prefix),labelDims=this.calculateLabelDimensions(ele,text),lineHeight=ele.pstyle("line-height").pfValue,textWrap=ele.pstyle("text-wrap").strValue,lines=getPrefixedProperty(_p.rscratch,"labelWrapCachedLines",prefix)||[],numLines="wrap"!==textWrap?1:Math.max(lines.length,1),normPerLineHeight=labelDims.height/numLines,labelLineHeight=normPerLineHeight*lineHeight,width=labelDims.width,height=labelDims.height+(numLines-1)*(lineHeight-1)*normPerLineHeight;setPrefixedProperty(_p.rstyle,"labelWidth",prefix,width),setPrefixedProperty(_p.rscratch,"labelWidth",prefix,width),setPrefixedProperty(_p.rstyle,"labelHeight",prefix,height),setPrefixedProperty(_p.rscratch,"labelHeight",prefix,height),setPrefixedProperty(_p.rscratch,"labelLineHeight",prefix,labelLineHeight)},BRp$6.getLabelText=function(ele,prefix){var _p=ele._private,pfd=prefix?prefix+"-":"",text=ele.pstyle(pfd+"label").strValue,textTransform=ele.pstyle("text-transform").value,rscratch=function(propName,value){return value?(setPrefixedProperty(_p.rscratch,propName,prefix,value),value):getPrefixedProperty(_p.rscratch,propName,prefix)};if(!text)return"";"none"==textTransform||("uppercase"==textTransform?text=text.toUpperCase():"lowercase"==textTransform&&(text=text.toLowerCase()));var wrapStyle=ele.pstyle("text-wrap").value;if("wrap"===wrapStyle){var labelKey=rscratch("labelKey");if(null!=labelKey&&rscratch("labelWrapKey")===labelKey)return rscratch("labelWrapCachedText");for(var lines=text.split("\n"),maxW=ele.pstyle("text-max-width").pfValue,overflowAny="anywhere"===ele.pstyle("text-overflow-wrap").value,wrappedLines=[],wordsRegex=/[\s\u200b]+/,wordSeparator=overflowAny?"":" ",l=0;l<lines.length;l++){var line=lines[l],lineW=this.calculateLabelDimensions(ele,line).width;if(overflowAny){var processedLine=line.split("").join("​");line=processedLine}if(lineW>maxW){for(var words=line.split(wordsRegex),subline="",w=0;w<words.length;w++){var word=words[w],testLine=0===subline.length?word:subline+wordSeparator+word;this.calculateLabelDimensions(ele,testLine).width<=maxW?subline+=word+wordSeparator:(wrappedLines.push(subline),subline=word+wordSeparator)}subline.match(/^[\s\u200b]+$/)||wrappedLines.push(subline)}else wrappedLines.push(line)}rscratch("labelWrapCachedLines",wrappedLines),text=rscratch("labelWrapCachedText",wrappedLines.join("\n")),rscratch("labelWrapKey",labelKey)}else if("ellipsis"===wrapStyle){for(var _maxW=ele.pstyle("text-max-width").pfValue,ellipsized="",incLastCh=!1,i=0;i<text.length;i++){if(this.calculateLabelDimensions(ele,ellipsized+text[i]+"…").width>_maxW)break;ellipsized+=text[i],i===text.length-1&&(incLastCh=!0)}return incLastCh||(ellipsized+="…"),ellipsized}return text},BRp$6.getLabelJustification=function(ele){var justification=ele.pstyle("text-justification").strValue,textHalign=ele.pstyle("text-halign").strValue;if("auto"!==justification)return justification;if(!ele.isNode())return"center";switch(textHalign){case"left":return"right";case"right":return"left";default:return"center"}},BRp$6.calculateLabelDimensions=function(ele,text){var cacheKey=hashString(text,ele._private.labelDimsKey),cache=this.labelDimCache||(this.labelDimCache=[]),existingVal=cache[cacheKey];if(null!=existingVal)return existingVal;var fStyle=ele.pstyle("font-style").strValue,size=1*ele.pstyle("font-size").pfValue+"px",family=ele.pstyle("font-family").strValue,weight=ele.pstyle("font-weight").strValue,div=this.labelCalcDiv;div||(div=this.labelCalcDiv=document.createElement("div"),document.body.appendChild(div));var ds=div.style;return ds.fontFamily=family,ds.fontStyle=fStyle,ds.fontSize=size,ds.fontWeight=weight,ds.position="absolute",ds.left="-9999px",ds.top="-9999px",ds.zIndex="-1",ds.visibility="hidden",ds.pointerEvents="none",ds.padding="0",ds.lineHeight="1","wrap"===ele.pstyle("text-wrap").value?ds.whiteSpace="pre":ds.whiteSpace="normal",div.textContent=text,cache[cacheKey]={width:Math.ceil(div.clientWidth/1),height:Math.ceil(div.clientHeight/1)}},BRp$6.calculateLabelAngle=function(ele,prefix){var rs=ele._private.rscratch,isEdge=ele.isEdge(),prefixDash=prefix?prefix+"-":"",rot=ele.pstyle(prefixDash+"text-rotation"),rotStr=rot.strValue;return"none"===rotStr?0:isEdge&&"autorotate"===rotStr?rs.labelAutoAngle:"autorotate"===rotStr?0:rot.pfValue},BRp$6.calculateLabelAngles=function(ele){var r=this,isEdge=ele.isEdge(),rs=ele._private.rscratch;rs.labelAngle=r.calculateLabelAngle(ele),isEdge&&(rs.sourceLabelAngle=r.calculateLabelAngle(ele,"source"),rs.targetLabelAngle=r.calculateLabelAngle(ele,"target"))};var BRp$7={},warnedCutRect=!1;BRp$7.getNodeShape=function(node){var shape=node.pstyle("shape").value;if("cutrectangle"===shape&&(node.width()<28||node.height()<28))return warnedCutRect||(warn("The `cutrectangle` node shape can not be used at small sizes so `rectangle` is used instead"),warnedCutRect=!0),"rectangle";if(node.isParent())return"rectangle"===shape||"roundrectangle"===shape||"cutrectangle"===shape||"barrel"===shape?shape:"rectangle";if("polygon"===shape){var points=node.pstyle("shape-polygon-points").value;return this.nodeShapes.makePolygon(points).name}return shape};var BRp$8={registerCalculationListeners:function(){var cy=this.cy,elesToUpdate=cy.collection(),r=this,enqueue=function(eles){var dirtyStyleCaches=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(elesToUpdate.merge(eles),dirtyStyleCaches)for(var i=0;i<eles.length;i++){var ele=eles[i],_p=ele._private,rstyle=_p.rstyle;rstyle.clean=!1,rstyle.cleanConnected=!1}};r.binder(cy).on("bounds.* dirty.*",(function(e){var ele=e.target;enqueue(ele)})).on("style.* background.*",(function(e){var ele=e.target;enqueue(ele,!1)}));var updateEleCalcs=function(willDraw){if(willDraw){for(var fns=r.onUpdateEleCalcsFns,i=0;i<elesToUpdate.length;i++){var ele=elesToUpdate[i],rstyle=ele._private.rstyle;ele.isNode()&&!rstyle.cleanConnected&&(enqueue(ele.connectedEdges()),rstyle.cleanConnected=!0)}if(fns)for(i=0;i<fns.length;i++){(0,fns[i])(willDraw,elesToUpdate)}r.recalculateRenderedStyle(elesToUpdate),elesToUpdate=cy.collection()}};r.flushRenderedStyleQueue=function(){updateEleCalcs(!0)},r.beforeRender(updateEleCalcs,r.beforeRenderPriorities.eleCalcs)},onUpdateEleCalcs:function(fn){(this.onUpdateEleCalcsFns=this.onUpdateEleCalcsFns||[]).push(fn)},recalculateRenderedStyle:function(eles,useCache){var edges=[],nodes=[];if(!this.destroyed){void 0===useCache&&(useCache=!0);for(var i=0;i<eles.length;i++){var rstyle=(_p=(ele=eles[i])._private).rstyle;useCache&&rstyle.clean||ele.removed()||"none"!==ele.pstyle("display").value&&("nodes"===_p.group?nodes.push(ele):edges.push(ele),rstyle.clean=!0)}for(i=0;i<nodes.length;i++){rstyle=(_p=(ele=nodes[i])._private).rstyle;var pos=ele.position();this.recalculateNodeLabelProjection(ele),rstyle.nodeX=pos.x,rstyle.nodeY=pos.y,rstyle.nodeW=ele.pstyle("width").pfValue,rstyle.nodeH=ele.pstyle("height").pfValue}this.recalculateEdgeProjections(edges);for(i=0;i<edges.length;i++){rstyle=(_p=(ele=edges[i])._private).rstyle;var ele,_p,rs=_p.rscratch;rstyle.srcX=rs.arrowStartX,rstyle.srcY=rs.arrowStartY,rstyle.tgtX=rs.arrowEndX,rstyle.tgtY=rs.arrowEndY,rstyle.midX=rs.midX,rstyle.midY=rs.midY,rstyle.labelAngle=rs.labelAngle,rstyle.sourceLabelAngle=rs.sourceLabelAngle,rstyle.targetLabelAngle=rs.targetLabelAngle}}}},BRp$9={updateCachedGrabbedEles:function(){var eles=this.cachedZSortedEles;if(eles){eles.drag=[],eles.nondrag=[];for(var grabTargets=[],i=0;i<eles.length;i++){var rs=(ele=eles[i])._private.rscratch;ele.grabbed()&&!ele.isParent()?grabTargets.push(ele):rs.inDragLayer?eles.drag.push(ele):eles.nondrag.push(ele)}for(i=0;i<grabTargets.length;i++){var ele=grabTargets[i];eles.drag.push(ele)}}},invalidateCachedZSortedEles:function(){this.cachedZSortedEles=null},getCachedZSortedEles:function(forceRecalc){if(forceRecalc||!this.cachedZSortedEles){var eles=this.cy.mutableElements().toArray();eles.sort(zIndexSort),eles.interactive=eles.filter((function(ele){return ele.interactive()})),this.cachedZSortedEles=eles,this.updateCachedGrabbedEles()}else eles=this.cachedZSortedEles;return eles}},BRp$a={};[BRp$1,BRp$2,BRp$3,BRp$4,BRp$5,BRp$6,BRp$7,BRp$8,BRp$9].forEach((function(props){extend(BRp$a,props)}));var BRp$b={getCachedImage:function(url,crossOrigin,onLoad){var imageCache=this.imageCache=this.imageCache||{},cache=imageCache[url];if(cache)return cache.image.complete||cache.image.addEventListener("load",onLoad),cache.image;var image=(cache=imageCache[url]=imageCache[url]||{}).image=new Image;image.addEventListener("load",onLoad),image.addEventListener("error",(function(){image.error=!0}));return"data:"===url.substring(0,"data:".length).toLowerCase()||(image.crossOrigin=crossOrigin),image.src=url,image}},BRp$c={registerBinding:function(target,event,handler,useCapture){var args=Array.prototype.slice.apply(arguments,[1]),b=this.binder(target);return b.on.apply(b,args)}};BRp$c.binder=function(tgt){var obj,r=this,tgtIsDom=tgt===window||tgt===document||tgt===document.body||(obj=tgt,"undefined"!=typeof HTMLElement&&obj instanceof HTMLElement);if(null==r.supportsPassiveEvents){var supportsPassive=!1;try{var opts=Object.defineProperty({},"passive",{get:function(){return supportsPassive=!0,!0}});window.addEventListener("test",null,opts)}catch(err){}r.supportsPassiveEvents=supportsPassive}var on=function(event,handler,useCapture){var args=Array.prototype.slice.call(arguments);return tgtIsDom&&r.supportsPassiveEvents&&(args[2]={capture:null!=useCapture&&useCapture,passive:!1,once:!1}),r.bindings.push({target:tgt,args:args}),(tgt.addEventListener||tgt.on).apply(tgt,args),this};return{on:on,addEventListener:on,addListener:on,bind:on}},BRp$c.nodeIsDraggable=function(node){return node&&node.isNode()&&!node.locked()&&node.grabbable()},BRp$c.nodeIsGrabbable=function(node){return this.nodeIsDraggable(node)&&node.interactive()},BRp$c.load=function(){var r=this,isSelected=function(ele){return ele.selected()},triggerEvents=function(target,names,e,position){null==target&&(target=r.cy);for(var i=0;i<names.length;i++){var name=names[i];target.emit({originalEvent:e,type:name,position:position})}},isMultSelKeyDown=function(e){return e.shiftKey||e.metaKey||e.ctrlKey},allowPanningPassthrough=function(down,downs){var allowPassthrough=!0;if(r.cy.hasCompoundNodes()&&down&&down.pannable())for(var i=0;downs&&i<downs.length;i++){if((down=downs[i]).isNode()&&down.isParent()){allowPassthrough=!1;break}}else allowPassthrough=!0;return allowPassthrough},setInDragLayer=function(ele){ele[0]._private.rscratch.inDragLayer=!0},setGrabTarget=function(ele){ele[0]._private.rscratch.isGrabTarget=!0},addToDragList=function(ele,opts){var list=opts.addToList;list.has(ele)||(list.merge(ele),function(ele){ele[0]._private.grabbed=!0}(ele))},addNodesToDrag=function(nodes,opts){opts=opts||{};var hasCompoundNodes=nodes.cy().hasCompoundNodes();opts.inDragLayer&&(nodes.forEach(setInDragLayer),nodes.neighborhood().stdFilter((function(ele){return!hasCompoundNodes||ele.isEdge()})).forEach(setInDragLayer)),opts.addToList&&nodes.forEach((function(ele){addToDragList(ele,opts)})),function(node,opts){if(node.cy().hasCompoundNodes()&&(null!=opts.inDragLayer||null!=opts.addToList)){var innerNodes=node.descendants();opts.inDragLayer&&(innerNodes.forEach(setInDragLayer),innerNodes.connectedEdges().forEach(setInDragLayer)),opts.addToList&&opts.addToList.unmerge(innerNodes)}}(nodes,opts),updateAncestorsInDragLayer(nodes,{inDragLayer:opts.inDragLayer}),r.updateCachedGrabbedEles()},addNodeToDrag=addNodesToDrag,freeDraggedElements=function(grabbedEles){grabbedEles&&(r.getCachedZSortedEles().forEach((function(ele){!function(ele){ele[0]._private.grabbed=!1}(ele),function(ele){ele[0]._private.rscratch.inDragLayer=!1}(ele),function(ele){ele[0]._private.rscratch.isGrabTarget=!1}(ele)})),r.updateCachedGrabbedEles())},updateAncestorsInDragLayer=function(node,opts){if((null!=opts.inDragLayer||null!=opts.addToList)&&node.cy().hasCompoundNodes()){var parent=node.ancestors().orphans();if(!parent.same(node)){var nodes=parent.descendants().spawnSelf().merge(parent).unmerge(node).unmerge(node.descendants()),edges=nodes.connectedEdges();opts.inDragLayer&&(edges.forEach(setInDragLayer),nodes.forEach(setInDragLayer)),opts.addToList&&nodes.forEach((function(ele){addToDragList(ele,opts)}))}}},blurActiveDomElement=function(){null!=document.activeElement&&null!=document.activeElement.blur&&document.activeElement.blur()},haveMutationsApi="undefined"!=typeof MutationObserver,haveResizeObserverApi="undefined"!=typeof ResizeObserver;haveMutationsApi?(r.removeObserver=new MutationObserver((function(mutns){for(var i=0;i<mutns.length;i++){var rNodes=mutns[i].removedNodes;if(rNodes)for(var j=0;j<rNodes.length;j++){if(rNodes[j]===r.container){r.destroy();break}}}})),r.container.parentNode&&r.removeObserver.observe(r.container.parentNode,{childList:!0})):r.registerBinding(r.container,"DOMNodeRemoved",(function(e){r.destroy()}));var onResize=util((function(){r.cy.resize()}),100);haveMutationsApi&&(r.styleObserver=new MutationObserver(onResize),r.styleObserver.observe(r.container,{attributes:!0})),r.registerBinding(window,"resize",onResize),haveResizeObserverApi&&(r.resizeObserver=new ResizeObserver(onResize),r.resizeObserver.observe(r.container));var invalidateCoords=function(){r.invalidateContainerClientCoordsCache()};!function(domEle,fn){for(;null!=domEle;)fn(domEle),domEle=domEle.parentNode}(r.container,(function(domEle){r.registerBinding(domEle,"transitionend",invalidateCoords),r.registerBinding(domEle,"animationend",invalidateCoords),r.registerBinding(domEle,"scroll",invalidateCoords)})),r.registerBinding(r.container,"contextmenu",(function(e){e.preventDefault()}));var eventInContainer=function(e){for(var containerPageCoords=r.findContainerClientCoords(),x=containerPageCoords[0],y=containerPageCoords[1],width=containerPageCoords[2],height=containerPageCoords[3],positions=e.touches?e.touches:[e],atLeastOnePosInside=!1,i=0;i<positions.length;i++){var p=positions[i];if(x<=p.clientX&&p.clientX<=x+width&&y<=p.clientY&&p.clientY<=y+height){atLeastOnePosInside=!0;break}}if(!atLeastOnePosInside)return!1;for(var container=r.container,tParent=e.target.parentNode,containerIsTarget=!1;tParent;){if(tParent===container){containerIsTarget=!0;break}tParent=tParent.parentNode}return!!containerIsTarget};r.registerBinding(r.container,"mousedown",(function(e){if(eventInContainer(e)){e.preventDefault(),blurActiveDomElement(),r.hoverData.capture=!0,r.hoverData.which=e.which;var cy=r.cy,gpos=[e.clientX,e.clientY],pos=r.projectIntoViewport(gpos[0],gpos[1]),select=r.selection,nears=r.findNearestElements(pos[0],pos[1],!0,!1),near=nears[0],draggedElements=r.dragData.possibleDragElements;r.hoverData.mdownPos=pos,r.hoverData.mdownGPos=gpos;if(3==e.which){r.hoverData.cxtStarted=!0;var cxtEvt={originalEvent:e,type:"cxttapstart",position:{x:pos[0],y:pos[1]}};near?(near.activate(),near.emit(cxtEvt),r.hoverData.down=near):cy.emit(cxtEvt),r.hoverData.downTime=(new Date).getTime(),r.hoverData.cxtDragged=!1}else if(1==e.which){if(near&&near.activate(),null!=near&&r.nodeIsGrabbable(near)){var makeEvent=function(type){return{originalEvent:e,type:type,position:{x:pos[0],y:pos[1]}}};if(setGrabTarget(near),near.selected()){draggedElements=r.dragData.possibleDragElements=cy.collection();var selectedNodes=cy.$((function(ele){return ele.isNode()&&ele.selected()&&r.nodeIsGrabbable(ele)}));addNodesToDrag(selectedNodes,{addToList:draggedElements}),near.emit(makeEvent("grabon")),selectedNodes.forEach((function(ele){ele.emit(makeEvent("grab"))}))}else draggedElements=r.dragData.possibleDragElements=cy.collection(),addNodeToDrag(near,{addToList:draggedElements}),near.emit(makeEvent("grabon")).emit(makeEvent("grab"));r.redrawHint("eles",!0),r.redrawHint("drag",!0)}r.hoverData.down=near,r.hoverData.downs=nears,r.hoverData.downTime=(new Date).getTime(),triggerEvents(near,["mousedown","tapstart","vmousedown"],e,{x:pos[0],y:pos[1]}),null==near?(select[4]=1,r.data.bgActivePosistion={x:pos[0],y:pos[1]},r.redrawHint("select",!0),r.redraw()):near.pannable()&&(select[4]=1),r.hoverData.tapholdCancelled=!1,clearTimeout(r.hoverData.tapholdTimeout),r.hoverData.tapholdTimeout=setTimeout((function(){if(!r.hoverData.tapholdCancelled){var ele=r.hoverData.down;ele?ele.emit({originalEvent:e,type:"taphold",position:{x:pos[0],y:pos[1]}}):cy.emit({originalEvent:e,type:"taphold",position:{x:pos[0],y:pos[1]}})}}),r.tapholdDuration)}select[0]=select[2]=pos[0],select[1]=select[3]=pos[1]}}),!1),r.registerBinding(window,"mousemove",(function(e){if(r.hoverData.capture||eventInContainer(e)){var preventDefault=!1,cy=r.cy,zoom=cy.zoom(),gpos=[e.clientX,e.clientY],pos=r.projectIntoViewport(gpos[0],gpos[1]),mdownPos=r.hoverData.mdownPos,mdownGPos=r.hoverData.mdownGPos,select=r.selection,near=null;r.hoverData.draggingEles||r.hoverData.dragging||r.hoverData.selecting||(near=r.findNearestElement(pos[0],pos[1],!0,!1));var isOverThresholdDrag,last=r.hoverData.last,down=r.hoverData.down,disp=[pos[0]-select[2],pos[1]-select[3]],draggedElements=r.dragData.possibleDragElements;if(mdownGPos){var dx=gpos[0]-mdownGPos[0],dx2=dx*dx,dy=gpos[1]-mdownGPos[1],dist2=dx2+dy*dy;r.hoverData.isOverThresholdDrag=isOverThresholdDrag=dist2>=r.desktopTapThreshold2}var multSelKeyDown=isMultSelKeyDown(e);isOverThresholdDrag&&(r.hoverData.tapholdCancelled=!0);preventDefault=!0,triggerEvents(near,["mousemove","vmousemove","tapdrag"],e,{x:pos[0],y:pos[1]});var goIntoBoxMode=function(){r.data.bgActivePosistion=void 0,r.hoverData.selecting||cy.emit({originalEvent:e,type:"boxstart",position:{x:pos[0],y:pos[1]}}),select[4]=1,r.hoverData.selecting=!0,r.redrawHint("select",!0),r.redraw()};if(3===r.hoverData.which){if(isOverThresholdDrag){var cxtEvt={originalEvent:e,type:"cxtdrag",position:{x:pos[0],y:pos[1]}};down?down.emit(cxtEvt):cy.emit(cxtEvt),r.hoverData.cxtDragged=!0,r.hoverData.cxtOver&&near===r.hoverData.cxtOver||(r.hoverData.cxtOver&&r.hoverData.cxtOver.emit({originalEvent:e,type:"cxtdragout",position:{x:pos[0],y:pos[1]}}),r.hoverData.cxtOver=near,near&&near.emit({originalEvent:e,type:"cxtdragover",position:{x:pos[0],y:pos[1]}}))}}else if(r.hoverData.dragging){if(preventDefault=!0,cy.panningEnabled()&&cy.userPanningEnabled()){var deltaP;if(r.hoverData.justStartedPan){var mdPos=r.hoverData.mdownPos;deltaP={x:(pos[0]-mdPos[0])*zoom,y:(pos[1]-mdPos[1])*zoom},r.hoverData.justStartedPan=!1}else deltaP={x:disp[0]*zoom,y:disp[1]*zoom};cy.panBy(deltaP),r.hoverData.dragged=!0}pos=r.projectIntoViewport(e.clientX,e.clientY)}else if(1!=select[4]||null!=down&&!down.pannable()){if(down&&down.pannable()&&down.active()&&down.unactivate(),down&&down.grabbed()||near==last||(last&&triggerEvents(last,["mouseout","tapdragout"],e,{x:pos[0],y:pos[1]}),near&&triggerEvents(near,["mouseover","tapdragover"],e,{x:pos[0],y:pos[1]}),r.hoverData.last=near),down)if(isOverThresholdDrag){if(cy.boxSelectionEnabled()&&multSelKeyDown)down&&down.grabbed()&&(freeDraggedElements(draggedElements),down.emit("freeon"),draggedElements.emit("free"),r.dragData.didDrag&&(down.emit("dragfreeon"),draggedElements.emit("dragfree"))),goIntoBoxMode();else if(down&&down.grabbed()&&r.nodeIsDraggable(down)){var justStartedDrag=!r.dragData.didDrag;justStartedDrag&&r.redrawHint("eles",!0),r.dragData.didDrag=!0;var toTrigger=cy.collection();r.hoverData.draggingEles||addNodesToDrag(draggedElements,{inDragLayer:!0});var totalShift={x:0,y:0};if(number(disp[0])&&number(disp[1])&&(totalShift.x+=disp[0],totalShift.y+=disp[1],justStartedDrag)){var dragDelta=r.hoverData.dragDelta;dragDelta&&number(dragDelta[0])&&number(dragDelta[1])&&(totalShift.x+=dragDelta[0],totalShift.y+=dragDelta[1])}for(var i=0;i<draggedElements.length;i++){var dEle=draggedElements[i];r.nodeIsDraggable(dEle)&&dEle.grabbed()&&toTrigger.merge(dEle)}r.hoverData.draggingEles=!0,toTrigger.silentShift(totalShift).emit("position drag"),r.redrawHint("drag",!0),r.redraw()}}else!function(){var dragDelta=r.hoverData.dragDelta=r.hoverData.dragDelta||[];0===dragDelta.length?(dragDelta.push(disp[0]),dragDelta.push(disp[1])):(dragDelta[0]+=disp[0],dragDelta[1]+=disp[1])}();preventDefault=!0}else if(isOverThresholdDrag){if(r.hoverData.dragging||!cy.boxSelectionEnabled()||!multSelKeyDown&&cy.panningEnabled()&&cy.userPanningEnabled()){if(!r.hoverData.selecting&&cy.panningEnabled()&&cy.userPanningEnabled()){allowPanningPassthrough(down,r.hoverData.downs)&&(r.hoverData.dragging=!0,r.hoverData.justStartedPan=!0,select[4]=0,r.data.bgActivePosistion=array2point(mdownPos),r.redrawHint("select",!0),r.redraw())}}else goIntoBoxMode();down&&down.pannable()&&down.active()&&down.unactivate()}return select[2]=pos[0],select[3]=pos[1],preventDefault?(e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),!1):void 0}}),!1),r.registerBinding(window,"mouseup",(function(e){if(r.hoverData.capture){r.hoverData.capture=!1;var cy=r.cy,pos=r.projectIntoViewport(e.clientX,e.clientY),select=r.selection,near=r.findNearestElement(pos[0],pos[1],!0,!1),draggedElements=r.dragData.possibleDragElements,down=r.hoverData.down,multSelKeyDown=isMultSelKeyDown(e);if(r.data.bgActivePosistion&&(r.redrawHint("select",!0),r.redraw()),r.hoverData.tapholdCancelled=!0,r.data.bgActivePosistion=void 0,down&&down.unactivate(),3===r.hoverData.which){var cxtEvt={originalEvent:e,type:"cxttapend",position:{x:pos[0],y:pos[1]}};if(down?down.emit(cxtEvt):cy.emit(cxtEvt),!r.hoverData.cxtDragged){var cxtTap={originalEvent:e,type:"cxttap",position:{x:pos[0],y:pos[1]}};down?down.emit(cxtTap):cy.emit(cxtTap)}r.hoverData.cxtDragged=!1,r.hoverData.which=null}else if(1===r.hoverData.which){if(triggerEvents(near,["mouseup","tapend","vmouseup"],e,{x:pos[0],y:pos[1]}),r.dragData.didDrag||r.hoverData.dragged||r.hoverData.selecting||r.hoverData.isOverThresholdDrag||triggerEvents(down,["click","tap","vclick"],e,{x:pos[0],y:pos[1]}),null!=down||r.dragData.didDrag||r.hoverData.selecting||r.hoverData.dragged||isMultSelKeyDown(e)||(cy.$(isSelected).unselect(["tapunselect"]),draggedElements.length>0&&r.redrawHint("eles",!0),r.dragData.possibleDragElements=draggedElements=cy.collection()),near!=down||r.dragData.didDrag||r.hoverData.selecting||null!=near&&near._private.selectable&&(r.hoverData.dragging||("additive"===cy.selectionType()||multSelKeyDown?near.selected()?near.unselect(["tapunselect"]):near.select(["tapselect"]):multSelKeyDown||(cy.$(isSelected).unmerge(near).unselect(["tapunselect"]),near.select(["tapselect"]))),r.redrawHint("eles",!0)),r.hoverData.selecting){var box=cy.collection(r.getAllInBox(select[0],select[1],select[2],select[3]));r.redrawHint("select",!0),box.length>0&&r.redrawHint("eles",!0),cy.emit({type:"boxend",originalEvent:e,position:{x:pos[0],y:pos[1]}});var eleWouldBeSelected=function(ele){return ele.selectable()&&!ele.selected()};"additive"===cy.selectionType()||multSelKeyDown||cy.$(isSelected).unmerge(box).unselect(),box.emit("box").stdFilter(eleWouldBeSelected).select().emit("boxselect"),r.redraw()}if(r.hoverData.dragging&&(r.hoverData.dragging=!1,r.redrawHint("select",!0),r.redrawHint("eles",!0),r.redraw()),!select[4]){r.redrawHint("drag",!0),r.redrawHint("eles",!0);var downWasGrabbed=down&&down.grabbed();freeDraggedElements(draggedElements),downWasGrabbed&&(down.emit("freeon"),draggedElements.emit("free"),r.dragData.didDrag&&(down.emit("dragfreeon"),draggedElements.emit("dragfree")))}}select[4]=0,r.hoverData.down=null,r.hoverData.cxtStarted=!1,r.hoverData.draggingEles=!1,r.hoverData.selecting=!1,r.hoverData.isOverThresholdDrag=!1,r.dragData.didDrag=!1,r.hoverData.dragged=!1,r.hoverData.dragDelta=[],r.hoverData.mdownPos=null,r.hoverData.mdownGPos=null}}),!1);var f1x1,f1y1,f2x1,f2y1,distance1,distance1Sq,center1,modelCenter1,offsetLeft,offsetTop,containerWidth,containerHeight,twoFingersStartInside;r.registerBinding(r.container,"wheel",(function(e){if(!r.scrollingPage){var diff,cy=r.cy,pos=r.projectIntoViewport(e.clientX,e.clientY),rpos=[pos[0]*cy.zoom()+cy.pan().x,pos[1]*cy.zoom()+cy.pan().y];if(r.hoverData.draggingEles||r.hoverData.dragging||r.hoverData.cxtStarted||0!==r.selection[4])e.preventDefault();else if(cy.panningEnabled()&&cy.userPanningEnabled()&&cy.zoomingEnabled()&&cy.userZoomingEnabled())e.preventDefault(),r.data.wheelZooming=!0,clearTimeout(r.data.wheelTimeout),r.data.wheelTimeout=setTimeout((function(){r.data.wheelZooming=!1,r.redrawHint("eles",!0),r.redraw()}),150),diff=null!=e.deltaY?e.deltaY/-250:null!=e.wheelDeltaY?e.wheelDeltaY/1e3:e.wheelDelta/1e3,diff*=r.wheelSensitivity,1===e.deltaMode&&(diff*=33),cy.zoom({level:cy.zoom()*Math.pow(10,diff),renderedPosition:{x:rpos[0],y:rpos[1]}})}}),!0),r.registerBinding(window,"scroll",(function(e){r.scrollingPage=!0,clearTimeout(r.scrollingPageTimeout),r.scrollingPageTimeout=setTimeout((function(){r.scrollingPage=!1}),250)}),!0),r.registerBinding(r.container,"mouseout",(function(e){var pos=r.projectIntoViewport(e.clientX,e.clientY);r.cy.emit({originalEvent:e,type:"mouseout",position:{x:pos[0],y:pos[1]}})}),!1),r.registerBinding(r.container,"mouseover",(function(e){var pos=r.projectIntoViewport(e.clientX,e.clientY);r.cy.emit({originalEvent:e,type:"mouseover",position:{x:pos[0],y:pos[1]}})}),!1);var touchstartHandler,touchmoveHandler,touchcancelHandler,touchendHandler,distance=function(x1,y1,x2,y2){return Math.sqrt((x2-x1)*(x2-x1)+(y2-y1)*(y2-y1))},distanceSq=function(x1,y1,x2,y2){return(x2-x1)*(x2-x1)+(y2-y1)*(y2-y1)};if(r.registerBinding(r.container,"touchstart",touchstartHandler=function(e){if(eventInContainer(e)){blurActiveDomElement(),r.touchData.capture=!0,r.data.bgActivePosistion=void 0;var cy=r.cy,now=r.touchData.now,earlier=r.touchData.earlier;if(e.touches[0]){var pos=r.projectIntoViewport(e.touches[0].clientX,e.touches[0].clientY);now[0]=pos[0],now[1]=pos[1]}if(e.touches[1]){pos=r.projectIntoViewport(e.touches[1].clientX,e.touches[1].clientY);now[2]=pos[0],now[3]=pos[1]}if(e.touches[2]){pos=r.projectIntoViewport(e.touches[2].clientX,e.touches[2].clientY);now[4]=pos[0],now[5]=pos[1]}if(e.touches[1]){r.touchData.singleTouchMoved=!0,freeDraggedElements(r.dragData.touchDragEles);var offsets=r.findContainerClientCoords();offsetLeft=offsets[0],offsetTop=offsets[1],containerWidth=offsets[2],containerHeight=offsets[3],f1x1=e.touches[0].clientX-offsetLeft,f1y1=e.touches[0].clientY-offsetTop,f2x1=e.touches[1].clientX-offsetLeft,f2y1=e.touches[1].clientY-offsetTop,twoFingersStartInside=0<=f1x1&&f1x1<=containerWidth&&0<=f2x1&&f2x1<=containerWidth&&0<=f1y1&&f1y1<=containerHeight&&0<=f2y1&&f2y1<=containerHeight;var pan=cy.pan(),zoom=cy.zoom();distance1=distance(f1x1,f1y1,f2x1,f2y1),distance1Sq=distanceSq(f1x1,f1y1,f2x1,f2y1),modelCenter1=[((center1=[(f1x1+f2x1)/2,(f1y1+f2y1)/2])[0]-pan.x)/zoom,(center1[1]-pan.y)/zoom];if(distance1Sq<4e4&&!e.touches[2]){var near1=r.findNearestElement(now[0],now[1],!0,!0),near2=r.findNearestElement(now[2],now[3],!0,!0);return near1&&near1.isNode()?(near1.activate().emit({originalEvent:e,type:"cxttapstart",position:{x:now[0],y:now[1]}}),r.touchData.start=near1):near2&&near2.isNode()?(near2.activate().emit({originalEvent:e,type:"cxttapstart",position:{x:now[0],y:now[1]}}),r.touchData.start=near2):cy.emit({originalEvent:e,type:"cxttapstart",position:{x:now[0],y:now[1]}}),r.touchData.start&&(r.touchData.start._private.grabbed=!1),r.touchData.cxt=!0,r.touchData.cxtDragged=!1,r.data.bgActivePosistion=void 0,void r.redraw()}}if(e.touches[2])cy.boxSelectionEnabled()&&e.preventDefault();else if(e.touches[1]);else if(e.touches[0]){var nears=r.findNearestElements(now[0],now[1],!0,!0),near=nears[0];if(null!=near&&(near.activate(),r.touchData.start=near,r.touchData.starts=nears,r.nodeIsGrabbable(near))){var draggedEles=r.dragData.touchDragEles=cy.collection(),selectedNodes=null;r.redrawHint("eles",!0),r.redrawHint("drag",!0),near.selected()?(selectedNodes=cy.$((function(ele){return ele.selected()&&r.nodeIsGrabbable(ele)})),addNodesToDrag(selectedNodes,{addToList:draggedEles})):addNodeToDrag(near,{addToList:draggedEles}),setGrabTarget(near);var makeEvent=function(type){return{originalEvent:e,type:type,position:{x:now[0],y:now[1]}}};near.emit(makeEvent("grabon")),selectedNodes?selectedNodes.forEach((function(n){n.emit(makeEvent("grab"))})):near.emit(makeEvent("grab"))}triggerEvents(near,["touchstart","tapstart","vmousedown"],e,{x:now[0],y:now[1]}),null==near&&(r.data.bgActivePosistion={x:pos[0],y:pos[1]},r.redrawHint("select",!0),r.redraw()),r.touchData.singleTouchMoved=!1,r.touchData.singleTouchStartTime=+new Date,clearTimeout(r.touchData.tapholdTimeout),r.touchData.tapholdTimeout=setTimeout((function(){!1!==r.touchData.singleTouchMoved||r.pinching||r.touchData.selecting||triggerEvents(r.touchData.start,["taphold"],e,{x:now[0],y:now[1]})}),r.tapholdDuration)}if(e.touches.length>=1){for(var sPos=r.touchData.startPosition=[],i=0;i<now.length;i++)sPos[i]=earlier[i]=now[i];var touch0=e.touches[0];r.touchData.startGPosition=[touch0.clientX,touch0.clientY]}}},!1),r.registerBinding(window,"touchmove",touchmoveHandler=function(e){var capture=r.touchData.capture;if(capture||eventInContainer(e)){var select=r.selection,cy=r.cy,now=r.touchData.now,earlier=r.touchData.earlier,zoom=cy.zoom();if(e.touches[0]){var pos=r.projectIntoViewport(e.touches[0].clientX,e.touches[0].clientY);now[0]=pos[0],now[1]=pos[1]}if(e.touches[1]){pos=r.projectIntoViewport(e.touches[1].clientX,e.touches[1].clientY);now[2]=pos[0],now[3]=pos[1]}if(e.touches[2]){pos=r.projectIntoViewport(e.touches[2].clientX,e.touches[2].clientY);now[4]=pos[0],now[5]=pos[1]}var isOverThresholdDrag,startGPos=r.touchData.startGPosition;if(capture&&e.touches[0]&&startGPos){for(var disp=[],j=0;j<now.length;j++)disp[j]=now[j]-earlier[j];var dx=e.touches[0].clientX-startGPos[0],dx2=dx*dx,dy=e.touches[0].clientY-startGPos[1];isOverThresholdDrag=dx2+dy*dy>=r.touchTapThreshold2}if(capture&&r.touchData.cxt){e.preventDefault();var f1x2=e.touches[0].clientX-offsetLeft,f1y2=e.touches[0].clientY-offsetTop,f2x2=e.touches[1].clientX-offsetLeft,f2y2=e.touches[1].clientY-offsetTop,distance2Sq=distanceSq(f1x2,f1y2,f2x2,f2y2);if(distance2Sq/distance1Sq>=2.25||distance2Sq>=22500){r.touchData.cxt=!1,r.data.bgActivePosistion=void 0,r.redrawHint("select",!0);var cxtEvt={originalEvent:e,type:"cxttapend",position:{x:now[0],y:now[1]}};r.touchData.start?(r.touchData.start.unactivate().emit(cxtEvt),r.touchData.start=null):cy.emit(cxtEvt)}}if(capture&&r.touchData.cxt){cxtEvt={originalEvent:e,type:"cxtdrag",position:{x:now[0],y:now[1]}};r.data.bgActivePosistion=void 0,r.redrawHint("select",!0),r.touchData.start?r.touchData.start.emit(cxtEvt):cy.emit(cxtEvt),r.touchData.start&&(r.touchData.start._private.grabbed=!1),r.touchData.cxtDragged=!0;var near=r.findNearestElement(now[0],now[1],!0,!0);r.touchData.cxtOver&&near===r.touchData.cxtOver||(r.touchData.cxtOver&&r.touchData.cxtOver.emit({originalEvent:e,type:"cxtdragout",position:{x:now[0],y:now[1]}}),r.touchData.cxtOver=near,near&&near.emit({originalEvent:e,type:"cxtdragover",position:{x:now[0],y:now[1]}}))}else if(capture&&e.touches[2]&&cy.boxSelectionEnabled())e.preventDefault(),r.data.bgActivePosistion=void 0,this.lastThreeTouch=+new Date,r.touchData.selecting||cy.emit({originalEvent:e,type:"boxstart",position:{x:now[0],y:now[1]}}),r.touchData.selecting=!0,r.touchData.didSelect=!0,select[4]=1,select&&0!==select.length&&void 0!==select[0]?(select[2]=(now[0]+now[2]+now[4])/3,select[3]=(now[1]+now[3]+now[5])/3):(select[0]=(now[0]+now[2]+now[4])/3,select[1]=(now[1]+now[3]+now[5])/3,select[2]=(now[0]+now[2]+now[4])/3+1,select[3]=(now[1]+now[3]+now[5])/3+1),r.redrawHint("select",!0),r.redraw();else if(capture&&e.touches[1]&&!r.touchData.didSelect&&cy.zoomingEnabled()&&cy.panningEnabled()&&cy.userZoomingEnabled()&&cy.userPanningEnabled()){if(e.preventDefault(),r.data.bgActivePosistion=void 0,r.redrawHint("select",!0),draggedEles=r.dragData.touchDragEles){r.redrawHint("drag",!0);for(var i=0;i<draggedEles.length;i++){var de_p=draggedEles[i]._private;de_p.grabbed=!1,de_p.rscratch.inDragLayer=!1}}var _start=r.touchData.start,distance2=(f1x2=e.touches[0].clientX-offsetLeft,f1y2=e.touches[0].clientY-offsetTop,f2x2=e.touches[1].clientX-offsetLeft,f2y2=e.touches[1].clientY-offsetTop,distance(f1x2,f1y2,f2x2,f2y2)),factor=distance2/distance1;if(twoFingersStartInside){var tx=(f1x2-f1x1+(f2x2-f2x1))/2,ty=(f1y2-f1y1+(f2y2-f2y1))/2,zoom1=cy.zoom(),zoom2=zoom1*factor,pan1=cy.pan(),ctrx=modelCenter1[0]*zoom1+pan1.x,ctry=modelCenter1[1]*zoom1+pan1.y,pan2={x:-zoom2/zoom1*(ctrx-pan1.x-tx)+ctrx,y:-zoom2/zoom1*(ctry-pan1.y-ty)+ctry};if(_start&&_start.active()){var draggedEles=r.dragData.touchDragEles;freeDraggedElements(draggedEles),r.redrawHint("drag",!0),r.redrawHint("eles",!0),_start.unactivate().emit("freeon"),draggedEles.emit("free"),r.dragData.didDrag&&(_start.emit("dragfreeon"),draggedEles.emit("dragfree"))}cy.viewport({zoom:zoom2,pan:pan2,cancelOnFailedZoom:!0}),distance1=distance2,f1x1=f1x2,f1y1=f1y2,f2x1=f2x2,f2y1=f2y2,r.pinching=!0}if(e.touches[0]){pos=r.projectIntoViewport(e.touches[0].clientX,e.touches[0].clientY);now[0]=pos[0],now[1]=pos[1]}if(e.touches[1]){pos=r.projectIntoViewport(e.touches[1].clientX,e.touches[1].clientY);now[2]=pos[0],now[3]=pos[1]}if(e.touches[2]){pos=r.projectIntoViewport(e.touches[2].clientX,e.touches[2].clientY);now[4]=pos[0],now[5]=pos[1]}}else if(e.touches[0]&&!r.touchData.didSelect){var start=r.touchData.start,last=r.touchData.last;if(r.hoverData.draggingEles||r.swipePanning||(near=r.findNearestElement(now[0],now[1],!0,!0)),capture&&null!=start&&e.preventDefault(),capture&&null!=start&&r.nodeIsDraggable(start))if(isOverThresholdDrag){draggedEles=r.dragData.touchDragEles;var justStartedDrag=!r.dragData.didDrag;justStartedDrag&&addNodesToDrag(draggedEles,{inDragLayer:!0}),r.dragData.didDrag=!0;var totalShift={x:0,y:0};if(number(disp[0])&&number(disp[1]))if(totalShift.x+=disp[0],totalShift.y+=disp[1],justStartedDrag)r.redrawHint("eles",!0),(dragDelta=r.touchData.dragDelta)&&number(dragDelta[0])&&number(dragDelta[1])&&(totalShift.x+=dragDelta[0],totalShift.y+=dragDelta[1]);r.hoverData.draggingEles=!0,draggedEles.silentShift(totalShift).emit("position drag"),r.redrawHint("drag",!0),r.touchData.startPosition[0]==earlier[0]&&r.touchData.startPosition[1]==earlier[1]&&r.redrawHint("eles",!0),r.redraw()}else{var dragDelta;0===(dragDelta=r.touchData.dragDelta=r.touchData.dragDelta||[]).length?(dragDelta.push(disp[0]),dragDelta.push(disp[1])):(dragDelta[0]+=disp[0],dragDelta[1]+=disp[1])}if(triggerEvents(start||near,["touchmove","tapdrag","vmousemove"],e,{x:now[0],y:now[1]}),start&&start.grabbed()||near==last||(last&&last.emit({originalEvent:e,type:"tapdragout",position:{x:now[0],y:now[1]}}),near&&near.emit({originalEvent:e,type:"tapdragover",position:{x:now[0],y:now[1]}})),r.touchData.last=near,capture)for(i=0;i<now.length;i++)now[i]&&r.touchData.startPosition[i]&&isOverThresholdDrag&&(r.touchData.singleTouchMoved=!0);if(capture&&(null==start||start.pannable())&&cy.panningEnabled()&&cy.userPanningEnabled()){allowPanningPassthrough(start,r.touchData.starts)&&(e.preventDefault(),r.data.bgActivePosistion||(r.data.bgActivePosistion=array2point(r.touchData.startPosition)),r.swipePanning?cy.panBy({x:disp[0]*zoom,y:disp[1]*zoom}):isOverThresholdDrag&&(r.swipePanning=!0,cy.panBy({x:dx*zoom,y:dy*zoom}),start&&(start.unactivate(),r.redrawHint("select",!0),r.touchData.start=null)));pos=r.projectIntoViewport(e.touches[0].clientX,e.touches[0].clientY);now[0]=pos[0],now[1]=pos[1]}}for(j=0;j<now.length;j++)earlier[j]=now[j];capture&&e.touches.length>0&&!r.hoverData.draggingEles&&!r.swipePanning&&null!=r.data.bgActivePosistion&&(r.data.bgActivePosistion=void 0,r.redrawHint("select",!0),r.redraw())}},!1),r.registerBinding(window,"touchcancel",touchcancelHandler=function(e){var start=r.touchData.start;r.touchData.capture=!1,start&&start.unactivate()}),r.registerBinding(window,"touchend",touchendHandler=function(e){var start=r.touchData.start;if(r.touchData.capture){0===e.touches.length&&(r.touchData.capture=!1),e.preventDefault();var select=r.selection;r.swipePanning=!1,r.hoverData.draggingEles=!1;var ctxTapend,cy=r.cy,zoom=cy.zoom(),now=r.touchData.now,earlier=r.touchData.earlier;if(e.touches[0]){var pos=r.projectIntoViewport(e.touches[0].clientX,e.touches[0].clientY);now[0]=pos[0],now[1]=pos[1]}if(e.touches[1]){pos=r.projectIntoViewport(e.touches[1].clientX,e.touches[1].clientY);now[2]=pos[0],now[3]=pos[1]}if(e.touches[2]){pos=r.projectIntoViewport(e.touches[2].clientX,e.touches[2].clientY);now[4]=pos[0],now[5]=pos[1]}if(start&&start.unactivate(),r.touchData.cxt){if(ctxTapend={originalEvent:e,type:"cxttapend",position:{x:now[0],y:now[1]}},start?start.emit(ctxTapend):cy.emit(ctxTapend),!r.touchData.cxtDragged){var ctxTap={originalEvent:e,type:"cxttap",position:{x:now[0],y:now[1]}};start?start.emit(ctxTap):cy.emit(ctxTap)}return r.touchData.start&&(r.touchData.start._private.grabbed=!1),r.touchData.cxt=!1,r.touchData.start=null,void r.redraw()}if(!e.touches[2]&&cy.boxSelectionEnabled()&&r.touchData.selecting){r.touchData.selecting=!1;var box=cy.collection(r.getAllInBox(select[0],select[1],select[2],select[3]));select[0]=void 0,select[1]=void 0,select[2]=void 0,select[3]=void 0,select[4]=0,r.redrawHint("select",!0),cy.emit({type:"boxend",originalEvent:e,position:{x:now[0],y:now[1]}});box.emit("box").stdFilter((function(ele){return ele.selectable()&&!ele.selected()})).select().emit("boxselect"),box.nonempty()&&r.redrawHint("eles",!0),r.redraw()}if(null!=start&&start.unactivate(),e.touches[2])r.data.bgActivePosistion=void 0,r.redrawHint("select",!0);else if(e.touches[1]);else if(e.touches[0]);else if(!e.touches[0]){r.data.bgActivePosistion=void 0,r.redrawHint("select",!0);var draggedEles=r.dragData.touchDragEles;if(null!=start){var startWasGrabbed=start._private.grabbed;freeDraggedElements(draggedEles),r.redrawHint("drag",!0),r.redrawHint("eles",!0),startWasGrabbed&&(start.emit("freeon"),draggedEles.emit("free"),r.dragData.didDrag&&(start.emit("dragfreeon"),draggedEles.emit("dragfree"))),triggerEvents(start,["touchend","tapend","vmouseup","tapdragout"],e,{x:now[0],y:now[1]}),start.unactivate(),r.touchData.start=null}else{var near=r.findNearestElement(now[0],now[1],!0,!0);triggerEvents(near,["touchend","tapend","vmouseup","tapdragout"],e,{x:now[0],y:now[1]})}var dx=r.touchData.startPosition[0]-now[0],dx2=dx*dx,dy=r.touchData.startPosition[1]-now[1],rdist2=(dx2+dy*dy)*zoom*zoom;r.touchData.singleTouchMoved||(start||cy.$(":selected").unselect(["tapunselect"]),triggerEvents(start,["tap","vclick"],e,{x:now[0],y:now[1]})),null!=start&&!r.dragData.didDrag&&start._private.selectable&&rdist2<r.touchTapThreshold2&&!r.pinching&&("single"===cy.selectionType()?(cy.$(isSelected).unmerge(start).unselect(["tapunselect"]),start.select(["tapselect"])):start.selected()?start.unselect(["tapunselect"]):start.select(["tapselect"]),r.redrawHint("eles",!0)),r.touchData.singleTouchMoved=!0}for(var j=0;j<now.length;j++)earlier[j]=now[j];r.dragData.didDrag=!1,0===e.touches.length&&(r.touchData.dragDelta=[],r.touchData.startPosition=null,r.touchData.startGPosition=null,r.touchData.didSelect=!1),e.touches.length<2&&(1===e.touches.length&&(r.touchData.startGPosition=[e.touches[0].clientX,e.touches[0].clientY]),r.pinching=!1,r.redrawHint("eles",!0),r.redraw())}},!1),"undefined"==typeof TouchEvent){var pointers=[],makeTouch=function(e){return{clientX:e.clientX,clientY:e.clientY,force:1,identifier:e.pointerId,pageX:e.pageX,pageY:e.pageY,radiusX:e.width/2,radiusY:e.height/2,screenX:e.screenX,screenY:e.screenY,target:e.target}},addPointer=function(e){pointers.push(function(e){return{event:e,touch:makeTouch(e)}}(e))},removePointer=function(e){for(var i=0;i<pointers.length;i++){if(pointers[i].event.pointerId===e.pointerId)return void pointers.splice(i,1)}},addTouchesToEvent=function(e){e.touches=pointers.map((function(p){return p.touch}))},pointerIsMouse=function(e){return"mouse"===e.pointerType||4===e.pointerType};r.registerBinding(r.container,"pointerdown",(function(e){pointerIsMouse(e)||(e.preventDefault(),addPointer(e),addTouchesToEvent(e),touchstartHandler(e))})),r.registerBinding(r.container,"pointerup",(function(e){pointerIsMouse(e)||(removePointer(e),addTouchesToEvent(e),touchendHandler(e))})),r.registerBinding(r.container,"pointercancel",(function(e){pointerIsMouse(e)||(removePointer(e),addTouchesToEvent(e),touchcancelHandler())})),r.registerBinding(r.container,"pointermove",(function(e){pointerIsMouse(e)||(e.preventDefault(),function(e){var p=pointers.filter((function(p){return p.event.pointerId===e.pointerId}))[0];p.event=e,p.touch=makeTouch(e)}(e),addTouchesToEvent(e),touchmoveHandler(e))}))}};var BRp$d={generatePolygon:function(name,points){return this.nodeShapes[name]={renderer:this,name:name,points:points,draw:function(context,centerX,centerY,width,height){this.renderer.nodeShapeImpl("polygon",context,centerX,centerY,width,height,this.points)},intersectLine:function(nodeX,nodeY,width,height,x,y,padding){return polygonIntersectLine(x,y,this.points,nodeX,nodeY,width/2,height/2,padding)},checkPoint:function(x,y,padding,width,height,centerX,centerY){return pointInsidePolygon(x,y,this.points,centerX,centerY,width,height,[0,-1],padding)}}}};BRp$d.generateEllipse=function(){return this.nodeShapes.ellipse={renderer:this,name:"ellipse",draw:function(context,centerX,centerY,width,height){this.renderer.nodeShapeImpl(this.name,context,centerX,centerY,width,height)},intersectLine:function(nodeX,nodeY,width,height,x,y,padding){return function(x,y,centerX,centerY,ellipseWradius,ellipseHradius){var dispX=centerX-x,dispY=centerY-y;dispX/=ellipseWradius,dispY/=ellipseHradius;var len=Math.sqrt(dispX*dispX+dispY*dispY),newLength=len-1;if(newLength<0)return[];var lenProportion=newLength/len;return[(centerX-x)*lenProportion+x,(centerY-y)*lenProportion+y]}(x,y,nodeX,nodeY,width/2+padding,height/2+padding)},checkPoint:function(x,y,padding,width,height,centerX,centerY){return checkInEllipse(x,y,width,height,centerX,centerY,padding)}}},BRp$d.generateRoundRectangle=function(){return this.nodeShapes["round-rectangle"]=this.nodeShapes.roundrectangle={renderer:this,name:"round-rectangle",points:generateUnitNgonPointsFitToSquare(4,0),draw:function(context,centerX,centerY,width,height){this.renderer.nodeShapeImpl(this.name,context,centerX,centerY,width,height)},intersectLine:function(nodeX,nodeY,width,height,x,y,padding){return roundRectangleIntersectLine(x,y,nodeX,nodeY,width,height,padding)},checkPoint:function(x,y,padding,width,height,centerX,centerY){var cornerRadius=getRoundRectangleRadius(width,height),diam=2*cornerRadius;return!!pointInsidePolygon(x,y,this.points,centerX,centerY,width,height-diam,[0,-1],padding)||(!!pointInsidePolygon(x,y,this.points,centerX,centerY,width-diam,height,[0,-1],padding)||(!!checkInEllipse(x,y,diam,diam,centerX-width/2+cornerRadius,centerY-height/2+cornerRadius,padding)||(!!checkInEllipse(x,y,diam,diam,centerX+width/2-cornerRadius,centerY-height/2+cornerRadius,padding)||(!!checkInEllipse(x,y,diam,diam,centerX+width/2-cornerRadius,centerY+height/2-cornerRadius,padding)||!!checkInEllipse(x,y,diam,diam,centerX-width/2+cornerRadius,centerY+height/2-cornerRadius,padding)))))}}},BRp$d.generateCutRectangle=function(){return this.nodeShapes["cut-rectangle"]=this.nodeShapes.cutrectangle={renderer:this,name:"cut-rectangle",cornerLength:8,points:generateUnitNgonPointsFitToSquare(4,0),draw:function(context,centerX,centerY,width,height){this.renderer.nodeShapeImpl(this.name,context,centerX,centerY,width,height)},generateCutTrianglePts:function(width,height,centerX,centerY){var cl=this.cornerLength,hh=height/2,hw=width/2,xBegin=centerX-hw,xEnd=centerX+hw,yBegin=centerY-hh,yEnd=centerY+hh;return{topLeft:[xBegin,yBegin+cl,xBegin+cl,yBegin,xBegin+cl,yBegin+cl],topRight:[xEnd-cl,yBegin,xEnd,yBegin+cl,xEnd-cl,yBegin+cl],bottomRight:[xEnd,yEnd-cl,xEnd-cl,yEnd,xEnd-cl,yEnd-cl],bottomLeft:[xBegin+cl,yEnd,xBegin,yEnd-cl,xBegin+cl,yEnd-cl]}},intersectLine:function(nodeX,nodeY,width,height,x,y,padding){var cPts=this.generateCutTrianglePts(width+2*padding,height+2*padding,nodeX,nodeY),pts=[].concat.apply([],[cPts.topLeft.splice(0,4),cPts.topRight.splice(0,4),cPts.bottomRight.splice(0,4),cPts.bottomLeft.splice(0,4)]);return polygonIntersectLine(x,y,pts,nodeX,nodeY)},checkPoint:function(x,y,padding,width,height,centerX,centerY){if(pointInsidePolygon(x,y,this.points,centerX,centerY,width,height-2*this.cornerLength,[0,-1],padding))return!0;if(pointInsidePolygon(x,y,this.points,centerX,centerY,width-2*this.cornerLength,height,[0,-1],padding))return!0;var cutTrianglePts=this.generateCutTrianglePts(width,height,centerX,centerY);return pointInsidePolygonPoints(x,y,cutTrianglePts.topLeft)||pointInsidePolygonPoints(x,y,cutTrianglePts.topRight)||pointInsidePolygonPoints(x,y,cutTrianglePts.bottomRight)||pointInsidePolygonPoints(x,y,cutTrianglePts.bottomLeft)}}},BRp$d.generateBarrel=function(){return this.nodeShapes.barrel={renderer:this,name:"barrel",points:generateUnitNgonPointsFitToSquare(4,0),draw:function(context,centerX,centerY,width,height){this.renderer.nodeShapeImpl(this.name,context,centerX,centerY,width,height)},intersectLine:function(nodeX,nodeY,width,height,x,y,padding){var bPts=this.generateBarrelBezierPts(width+2*padding,height+2*padding,nodeX,nodeY),approximateBarrelCurvePts=function(pts){var m0=qbezierPtAt({x:pts[0],y:pts[1]},{x:pts[2],y:pts[3]},{x:pts[4],y:pts[5]},.15),m1=qbezierPtAt({x:pts[0],y:pts[1]},{x:pts[2],y:pts[3]},{x:pts[4],y:pts[5]},.5),m2=qbezierPtAt({x:pts[0],y:pts[1]},{x:pts[2],y:pts[3]},{x:pts[4],y:pts[5]},.85);return[pts[0],pts[1],m0.x,m0.y,m1.x,m1.y,m2.x,m2.y,pts[4],pts[5]]},pts=[].concat(approximateBarrelCurvePts(bPts.topLeft),approximateBarrelCurvePts(bPts.topRight),approximateBarrelCurvePts(bPts.bottomRight),approximateBarrelCurvePts(bPts.bottomLeft));return polygonIntersectLine(x,y,pts,nodeX,nodeY)},generateBarrelBezierPts:function(width,height,centerX,centerY){var hh=height/2,hw=width/2,xBegin=centerX-hw,xEnd=centerX+hw,yBegin=centerY-hh,yEnd=centerY+hh,curveConstants=getBarrelCurveConstants(width,height),hOffset=curveConstants.heightOffset,wOffset=curveConstants.widthOffset,ctrlPtXOffset=curveConstants.ctrlPtOffsetPct*width,pts={topLeft:[xBegin,yBegin+hOffset,xBegin+ctrlPtXOffset,yBegin,xBegin+wOffset,yBegin],topRight:[xEnd-wOffset,yBegin,xEnd-ctrlPtXOffset,yBegin,xEnd,yBegin+hOffset],bottomRight:[xEnd,yEnd-hOffset,xEnd-ctrlPtXOffset,yEnd,xEnd-wOffset,yEnd],bottomLeft:[xBegin+wOffset,yEnd,xBegin+ctrlPtXOffset,yEnd,xBegin,yEnd-hOffset]};return pts.topLeft.isTop=!0,pts.topRight.isTop=!0,pts.bottomLeft.isBottom=!0,pts.bottomRight.isBottom=!0,pts},checkPoint:function(x,y,padding,width,height,centerX,centerY){var curveConstants=getBarrelCurveConstants(width,height),hOffset=curveConstants.heightOffset,wOffset=curveConstants.widthOffset;if(pointInsidePolygon(x,y,this.points,centerX,centerY,width,height-2*hOffset,[0,-1],padding))return!0;if(pointInsidePolygon(x,y,this.points,centerX,centerY,width-2*wOffset,height,[0,-1],padding))return!0;for(var barrelCurvePts=this.generateBarrelBezierPts(width,height,centerX,centerY),getCurveT=function(x,y,curvePts){var p0,p1,x0=curvePts[4],x1=curvePts[2],x2=curvePts[0],y0=curvePts[5],y2=curvePts[1],xMin=Math.min(x0,x2),xMax=Math.max(x0,x2),yMin=Math.min(y0,y2),yMax=Math.max(y0,y2);if(xMin<=x&&x<=xMax&&yMin<=y&&y<=yMax){var coeff=[(p0=x0)-2*(p1=x1)+x2,2*(p1-p0),p0],validRoots=function(a,b,c,val){var r=b*b-4*a*(c-=val);if(r<0)return[];var sqrtR=Math.sqrt(r),denom=2*a;return[(-b+sqrtR)/denom,(-b-sqrtR)/denom]}(coeff[0],coeff[1],coeff[2],x).filter((function(r){return 0<=r&&r<=1}));if(validRoots.length>0)return validRoots[0]}return null},curveRegions=Object.keys(barrelCurvePts),i=0;i<curveRegions.length;i++){var cornerPts=barrelCurvePts[curveRegions[i]],t=getCurveT(x,y,cornerPts);if(null!=t){var y0=cornerPts[5],y1=cornerPts[3],y2=cornerPts[1],bezY=qbezierAt(y0,y1,y2,t);if(cornerPts.isTop&&bezY<=y)return!0;if(cornerPts.isBottom&&y<=bezY)return!0}}return!1}}},BRp$d.generateBottomRoundrectangle=function(){return this.nodeShapes["bottom-round-rectangle"]=this.nodeShapes.bottomroundrectangle={renderer:this,name:"bottom-round-rectangle",points:generateUnitNgonPointsFitToSquare(4,0),draw:function(context,centerX,centerY,width,height){this.renderer.nodeShapeImpl(this.name,context,centerX,centerY,width,height)},intersectLine:function(nodeX,nodeY,width,height,x,y,padding){var topStartY=nodeY-(height/2+padding),topIntersections=finiteLinesIntersect(x,y,nodeX,nodeY,nodeX-(width/2+padding),topStartY,nodeX+(width/2+padding),topStartY,!1);return topIntersections.length>0?topIntersections:roundRectangleIntersectLine(x,y,nodeX,nodeY,width,height,padding)},checkPoint:function(x,y,padding,width,height,centerX,centerY){var cornerRadius=getRoundRectangleRadius(width,height),diam=2*cornerRadius;if(pointInsidePolygon(x,y,this.points,centerX,centerY,width,height-diam,[0,-1],padding))return!0;if(pointInsidePolygon(x,y,this.points,centerX,centerY,width-diam,height,[0,-1],padding))return!0;var outerWidth=width/2+2*padding,outerHeight=height/2+2*padding;return!!pointInsidePolygonPoints(x,y,[centerX-outerWidth,centerY-outerHeight,centerX-outerWidth,centerY,centerX+outerWidth,centerY,centerX+outerWidth,centerY-outerHeight])||(!!checkInEllipse(x,y,diam,diam,centerX+width/2-cornerRadius,centerY+height/2-cornerRadius,padding)||!!checkInEllipse(x,y,diam,diam,centerX-width/2+cornerRadius,centerY+height/2-cornerRadius,padding))}}},BRp$d.registerNodeShapes=function(){var nodeShapes=this.nodeShapes={},renderer=this;this.generateEllipse(),this.generatePolygon("triangle",generateUnitNgonPointsFitToSquare(3,0)),this.generatePolygon("rectangle",generateUnitNgonPointsFitToSquare(4,0)),nodeShapes.square=nodeShapes.rectangle,this.generateRoundRectangle(),this.generateCutRectangle(),this.generateBarrel(),this.generateBottomRoundrectangle(),this.generatePolygon("diamond",[0,1,1,0,0,-1,-1,0]),this.generatePolygon("pentagon",generateUnitNgonPointsFitToSquare(5,0)),this.generatePolygon("hexagon",generateUnitNgonPointsFitToSquare(6,0)),this.generatePolygon("heptagon",generateUnitNgonPointsFitToSquare(7,0)),this.generatePolygon("octagon",generateUnitNgonPointsFitToSquare(8,0));var star5Points=new Array(20),outerPoints=generateUnitNgonPoints(5,0),innerPoints=generateUnitNgonPoints(5,Math.PI/5),innerRadius=.5*(3-Math.sqrt(5));innerRadius*=1.57;for(var i=0;i<innerPoints.length/2;i++)innerPoints[2*i]*=innerRadius,innerPoints[2*i+1]*=innerRadius;for(i=0;i<5;i++)star5Points[4*i]=outerPoints[2*i],star5Points[4*i+1]=outerPoints[2*i+1],star5Points[4*i+2]=innerPoints[2*i],star5Points[4*i+3]=innerPoints[2*i+1];star5Points=fitPolygonToSquare(star5Points),this.generatePolygon("star",star5Points),this.generatePolygon("vee",[-1,-1,0,-.333,1,-1,0,1]),this.generatePolygon("rhomboid",[-1,-1,.333,-1,1,1,-.333,1]),this.nodeShapes.concavehexagon=this.generatePolygon("concave-hexagon",[-1,-.95,-.75,0,-1,.95,1,.95,.75,0,1,-.95]),this.generatePolygon("tag",[-1,-1,.25,-1,1,0,.25,1,-1,1]),nodeShapes.makePolygon=function(points){var shape,name="polygon-"+points.join("$");return(shape=this[name])?shape:renderer.generatePolygon(name,points)}};var BRp$e={timeToRender:function(){return this.redrawTotalTime/this.redrawCount},redraw:function(options){options=options||staticEmptyObject();var r=this;void 0===r.averageRedrawTime&&(r.averageRedrawTime=0),void 0===r.lastRedrawTime&&(r.lastRedrawTime=0),void 0===r.lastDrawTime&&(r.lastDrawTime=0),r.requestedFrame=!0,r.renderOptions=options},beforeRender:function(fn,priority){if(!this.destroyed){null==priority&&error("Priority is not optional for beforeRender");var cbs=this.beforeRenderCallbacks;cbs.push({fn:fn,priority:priority}),cbs.sort((function(a,b){return b.priority-a.priority}))}}},beforeRenderCallbacks=function(r,willDraw,startTime){for(var cbs=r.beforeRenderCallbacks,i=0;i<cbs.length;i++)cbs[i].fn(willDraw,startTime)};BRp$e.startRenderLoop=function(){var r=this,cy=r.cy;if(!r.renderLoopStarted){r.renderLoopStarted=!0;requestAnimationFrame((function renderFn(requestTime){if(!r.destroyed){if(cy.batching());else if(r.requestedFrame&&!r.skipFrame){beforeRenderCallbacks(r,!0,requestTime);var startTime=performanceNow();r.render(r.renderOptions);var endTime=r.lastDrawTime=performanceNow();void 0===r.averageRedrawTime&&(r.averageRedrawTime=endTime-startTime),void 0===r.redrawCount&&(r.redrawCount=0),r.redrawCount++,void 0===r.redrawTotalTime&&(r.redrawTotalTime=0);var duration=endTime-startTime;r.redrawTotalTime+=duration,r.lastRedrawTime=duration,r.averageRedrawTime=r.averageRedrawTime/2+duration/2,r.requestedFrame=!1}else beforeRenderCallbacks(r,!1,requestTime);r.skipFrame=!1,requestAnimationFrame(renderFn)}}))}};var BR=function(options){this.init(options)},BRp$f=BR.prototype;BRp$f.clientFunctions=["redrawHint","render","renderTo","matchCanvasSize","nodeShapeImpl","arrowShapeImpl"],BRp$f.init=function(options){var r=this;r.options=options,r.cy=options.cy;var ctr=r.container=options.cy.container();if(window$1){var document=window$1.document,head=document.head,className="__________cytoscape_container",stylesheetAlreadyExists=null!=document.getElementById("__________cytoscape_stylesheet");if(ctr.className.indexOf(className)<0&&(ctr.className=(ctr.className||"")+" "+className),!stylesheetAlreadyExists){var stylesheet=document.createElement("style");stylesheet.id="__________cytoscape_stylesheet",stylesheet.innerHTML="."+className+" { position: relative; }",head.insertBefore(stylesheet,head.children[0])}"static"===window$1.getComputedStyle(ctr).getPropertyValue("position")&&warn("A Cytoscape container has style position:static and so can not use UI extensions properly")}r.selection=[void 0,void 0,void 0,void 0,0],r.bezierProjPcts=[.05,.225,.4,.5,.6,.775,.95],r.hoverData={down:null,last:null,downTime:null,triggerMode:null,dragging:!1,initialPan:[null,null],capture:!1},r.dragData={possibleDragElements:[]},r.touchData={start:null,capture:!1,startPosition:[null,null,null,null,null,null],singleTouchStartTime:null,singleTouchMoved:!0,now:[null,null,null,null,null,null],earlier:[null,null,null,null,null,null]},r.redraws=0,r.showFps=options.showFps,r.debug=options.debug,r.hideEdgesOnViewport=options.hideEdgesOnViewport,r.hideLabelsOnViewport=options.hideLabelsOnViewport,r.textureOnViewport=options.textureOnViewport,r.wheelSensitivity=options.wheelSensitivity,r.motionBlurEnabled=options.motionBlur,r.forcedPixelRatio=number(options.pixelRatio)?options.pixelRatio:null,r.motionBlur=options.motionBlur,r.motionBlurOpacity=options.motionBlurOpacity,r.motionBlurTransparency=1-r.motionBlurOpacity,r.motionBlurPxRatio=1,r.mbPxRBlurry=1,r.minMbLowQualFrames=4,r.fullQualityMb=!1,r.clearedForMotionBlur=[],r.desktopTapThreshold=options.desktopTapThreshold,r.desktopTapThreshold2=options.desktopTapThreshold*options.desktopTapThreshold,r.touchTapThreshold=options.touchTapThreshold,r.touchTapThreshold2=options.touchTapThreshold*options.touchTapThreshold,r.tapholdDuration=500,r.bindings=[],r.beforeRenderCallbacks=[],r.beforeRenderPriorities={animations:400,eleCalcs:300,eleTxrDeq:200,lyrTxrDeq:150,lyrTxrSkip:100},r.registerNodeShapes(),r.registerArrowShapes(),r.registerCalculationListeners()},BRp$f.notify=function(eventName,eles){var r=this,cy=r.cy;this.destroyed||("init"!==eventName?"destroy"!==eventName?(("add"===eventName||"remove"===eventName||"move"===eventName&&cy.hasCompoundNodes()||"load"===eventName||"zorder"===eventName||"mount"===eventName)&&r.invalidateCachedZSortedEles(),"viewport"===eventName&&r.redrawHint("select",!0),"load"!==eventName&&"resize"!==eventName&&"mount"!==eventName||(r.invalidateContainerClientCoordsCache(),r.matchCanvasSize(r.container)),r.redrawHint("eles",!0),r.redrawHint("drag",!0),this.startRenderLoop(),this.redraw()):r.destroy():r.load())},BRp$f.destroy=function(){var r=this;r.destroyed=!0,r.cy.stopAnimationLoop();for(var i=0;i<r.bindings.length;i++){var b=r.bindings[i],tgt=b.target;(tgt.off||tgt.removeEventListener).apply(tgt,b.args)}if(r.bindings=[],r.beforeRenderCallbacks=[],r.onUpdateEleCalcsFns=[],r.removeObserver&&r.removeObserver.disconnect(),r.styleObserver&&r.styleObserver.disconnect(),r.resizeObserver&&r.resizeObserver.disconnect(),r.labelCalcDiv)try{document.body.removeChild(r.labelCalcDiv)}catch(e){}},BRp$f.isHeadless=function(){return!1},[BRp,BRp$a,BRp$b,BRp$c,BRp$d,BRp$e].forEach((function(props){extend(BRp$f,props)}));var defs_setupDequeueing=function(opts){return function(){var self=this,r=this.renderer;if(!self.dequeueingSetup){self.dequeueingSetup=!0;var queueRedraw=util((function(){r.redrawHint("eles",!0),r.redrawHint("drag",!0),r.redraw()}),opts.deqRedrawThreshold),priority=opts.priority||noop;r.beforeRender((function(willDraw,frameStartTime){var startTime=performanceNow(),avgRenderTime=r.averageRedrawTime,renderTime=r.lastRedrawTime,deqd=[],extent=r.cy.extent(),pixelRatio=r.getPixelRatio();for(willDraw||r.flushRenderedStyleQueue();;){var now=performanceNow(),duration=now-startTime,frameDuration=now-frameStartTime;if(renderTime<1e3/60){var timeAvailable=1e3/60-(willDraw?avgRenderTime:0);if(frameDuration>=opts.deqFastCost*timeAvailable)break}else if(willDraw){if(duration>=opts.deqCost*renderTime||duration>=opts.deqAvgCost*avgRenderTime)break}else if(frameDuration>=opts.deqNoDrawCost*(1e3/60))break;var thisDeqd=opts.deq(self,pixelRatio,extent);if(!(thisDeqd.length>0))break;for(var i=0;i<thisDeqd.length;i++)deqd.push(thisDeqd[i])}deqd.length>0&&(opts.onDeqd(self,deqd),!willDraw&&opts.shouldRedraw(self,deqd,pixelRatio,extent)&&queueRedraw())}),priority(self))}}},ElementTextureCacheLookup=function(){function ElementTextureCacheLookup(getKey){var doesEleInvalidateKey=arguments.length>1&&void 0!==arguments[1]?arguments[1]:falsify;_classCallCheck(this,ElementTextureCacheLookup),this.idsByKey=new Map$1,this.keyForId=new Map$1,this.cachesByLvl=new Map$1,this.lvls=[],this.getKey=getKey,this.doesEleInvalidateKey=doesEleInvalidateKey}return _createClass(ElementTextureCacheLookup,[{key:"getIdsFor",value:function(key){null==key&&error("Can not get id list for null key");var idsByKey=this.idsByKey,ids=this.idsByKey.get(key);return ids||(ids=new Set$1,idsByKey.set(key,ids)),ids}},{key:"addIdForKey",value:function(key,id){null!=key&&this.getIdsFor(key).add(id)}},{key:"deleteIdForKey",value:function(key,id){null!=key&&this.getIdsFor(key).delete(id)}},{key:"getNumberOfIdsForKey",value:function(key){return null==key?0:this.getIdsFor(key).size}},{key:"updateKeyMappingFor",value:function(ele){var id=ele.id(),prevKey=this.keyForId.get(id),currKey=this.getKey(ele);this.deleteIdForKey(prevKey,id),this.addIdForKey(currKey,id),this.keyForId.set(id,currKey)}},{key:"deleteKeyMappingFor",value:function(ele){var id=ele.id(),prevKey=this.keyForId.get(id);this.deleteIdForKey(prevKey,id),this.keyForId.delete(id)}},{key:"keyHasChangedFor",value:function(ele){var id=ele.id();return this.keyForId.get(id)!==this.getKey(ele)}},{key:"isInvalid",value:function(ele){return this.keyHasChangedFor(ele)||this.doesEleInvalidateKey(ele)}},{key:"getCachesAt",value:function(lvl){var cachesByLvl=this.cachesByLvl,lvls=this.lvls,caches=cachesByLvl.get(lvl);return caches||(caches=new Map$1,cachesByLvl.set(lvl,caches),lvls.push(lvl)),caches}},{key:"getCache",value:function(key,lvl){return this.getCachesAt(lvl).get(key)}},{key:"get",value:function(ele,lvl){var key=this.getKey(ele),cache=this.getCache(key,lvl);return null!=cache&&this.updateKeyMappingFor(ele),cache}},{key:"getForCachedKey",value:function(ele,lvl){var key=this.keyForId.get(ele.id());return this.getCache(key,lvl)}},{key:"hasCache",value:function(key,lvl){return this.getCachesAt(lvl).has(key)}},{key:"has",value:function(ele,lvl){var key=this.getKey(ele);return this.hasCache(key,lvl)}},{key:"setCache",value:function(key,lvl,cache){cache.key=key,this.getCachesAt(lvl).set(key,cache)}},{key:"set",value:function(ele,lvl,cache){var key=this.getKey(ele);this.setCache(key,lvl,cache),this.updateKeyMappingFor(ele)}},{key:"deleteCache",value:function(key,lvl){this.getCachesAt(lvl).delete(key)}},{key:"delete",value:function(ele,lvl){var key=this.getKey(ele);this.deleteCache(key,lvl)}},{key:"invalidateKey",value:function(key){var _this=this;this.lvls.forEach((function(lvl){return _this.deleteCache(key,lvl)}))}},{key:"invalidate",value:function(ele){var id=ele.id(),key=this.keyForId.get(id);this.deleteKeyMappingFor(ele);var entireKeyInvalidated=this.doesEleInvalidateKey(ele);return entireKeyInvalidated&&this.invalidateKey(key),entireKeyInvalidated||0===this.getNumberOfIdsForKey(key)}}]),ElementTextureCacheLookup}(),getTxrReasons={dequeue:"dequeue",downscale:"downscale",highQuality:"highQuality"},initDefaults=defaults({getKey:null,doesEleInvalidateKey:falsify,drawElement:null,getBoundingBox:null,getRotationPoint:null,getRotationOffset:null,isVisible:trueify,allowEdgeTxrCaching:!0,allowParentTxrCaching:!0}),ElementTextureCache=function(renderer,initOptions){this.renderer=renderer,this.onDequeues=[];var opts=initDefaults(initOptions);extend(this,opts),this.lookup=new ElementTextureCacheLookup(opts.getKey,opts.doesEleInvalidateKey),this.setupDequeueing()},ETCp=ElementTextureCache.prototype;ETCp.reasons=getTxrReasons,ETCp.getTextureQueue=function(txrH){return this.eleImgCaches=this.eleImgCaches||{},this.eleImgCaches[txrH]=this.eleImgCaches[txrH]||[]},ETCp.getRetiredTextureQueue=function(txrH){var rtxtrQs=this.eleImgCaches.retired=this.eleImgCaches.retired||{};return rtxtrQs[txrH]=rtxtrQs[txrH]||[]},ETCp.getElementQueue=function(){return this.eleCacheQueue=this.eleCacheQueue||new Heap((function(a,b){return b.reqs-a.reqs}))},ETCp.getElementKeyToQueue=function(){return this.eleKeyToCacheQueue=this.eleKeyToCacheQueue||{}},ETCp.getElement=function(ele,bb,pxRatio,lvl,reason){var self=this,r=this.renderer,zoom=r.cy.zoom(),lookup=this.lookup;if(0===bb.w||0===bb.h||isNaN(bb.w)||isNaN(bb.h)||!ele.visible())return null;if(!self.allowEdgeTxrCaching&&ele.isEdge()||!self.allowParentTxrCaching&&ele.isParent())return null;if(null==lvl&&(lvl=Math.ceil(log2(zoom*pxRatio))),lvl<-4)lvl=-4;else if(zoom>=7.99||lvl>3)return null;var scale=Math.pow(2,lvl),eleScaledH=bb.h*scale,eleScaledW=bb.w*scale,scaledLabelShown=r.eleTextBiggerThanMin(ele,scale);if(!this.isVisible(ele,scaledLabelShown))return null;var txrH,eleCache=lookup.get(ele,lvl);if(eleCache&&eleCache.invalidated&&(eleCache.invalidated=!1,eleCache.texture.invalidatedWidth-=eleCache.width),eleCache)return eleCache;if(txrH=eleScaledH<=25?25:eleScaledH<=50?50:50*Math.ceil(eleScaledH/50),eleScaledH>1024||eleScaledW>1024)return null;var txrQ=self.getTextureQueue(txrH),txr=txrQ[txrQ.length-2],addNewTxr=function(){return self.recycleTexture(txrH,eleScaledW)||self.addTexture(txrH,eleScaledW)};txr||(txr=txrQ[txrQ.length-1]),txr||(txr=addNewTxr()),txr.width-txr.usedWidth<eleScaledW&&(txr=addNewTxr());for(var higherCache,scalableFrom=function(otherCache){return otherCache&&otherCache.scaledLabelShown===scaledLabelShown},deqing=reason&&reason===getTxrReasons.dequeue,highQualityReq=reason&&reason===getTxrReasons.highQuality,downscaleReq=reason&&reason===getTxrReasons.downscale,l=lvl+1;l<=3;l++){var c=lookup.get(ele,l);if(c){higherCache=c;break}}var oneUpCache=higherCache&&higherCache.level===lvl+1?higherCache:null,downscale=function(){txr.context.drawImage(oneUpCache.texture.canvas,oneUpCache.x,0,oneUpCache.width,oneUpCache.height,txr.usedWidth,0,eleScaledW,eleScaledH)};if(txr.context.setTransform(1,0,0,1,0,0),txr.context.clearRect(txr.usedWidth,0,eleScaledW,txrH),scalableFrom(oneUpCache))downscale();else if(scalableFrom(higherCache)){if(!highQualityReq)return self.queueElement(ele,higherCache.level-1),higherCache;for(var _l=higherCache.level;_l>lvl;_l--)oneUpCache=self.getElement(ele,bb,pxRatio,_l,getTxrReasons.downscale);downscale()}else{var lowerCache;if(!deqing&&!highQualityReq&&!downscaleReq)for(var _l2=lvl-1;_l2>=-4;_l2--){var _c=lookup.get(ele,_l2);if(_c){lowerCache=_c;break}}if(scalableFrom(lowerCache))return self.queueElement(ele,lvl),lowerCache;txr.context.translate(txr.usedWidth,0),txr.context.scale(scale,scale),this.drawElement(txr.context,ele,bb,scaledLabelShown,!1),txr.context.scale(1/scale,1/scale),txr.context.translate(-txr.usedWidth,0)}return eleCache={x:txr.usedWidth,texture:txr,level:lvl,scale:scale,width:eleScaledW,height:eleScaledH,scaledLabelShown:scaledLabelShown},txr.usedWidth+=Math.ceil(eleScaledW+8),txr.eleCaches.push(eleCache),lookup.set(ele,lvl,eleCache),self.checkTextureFullness(txr),eleCache},ETCp.invalidateElements=function(eles){for(var i=0;i<eles.length;i++)this.invalidateElement(eles[i])},ETCp.invalidateElement=function(ele){var lookup=this.lookup,caches=[];if(lookup.isInvalid(ele)){for(var lvl=-4;lvl<=3;lvl++){var cache=lookup.getForCachedKey(ele,lvl);cache&&caches.push(cache)}if(lookup.invalidate(ele))for(var i=0;i<caches.length;i++){var _cache=caches[i],txr=_cache.texture;txr.invalidatedWidth+=_cache.width,_cache.invalidated=!0,this.checkTextureUtility(txr)}this.removeFromQueue(ele)}},ETCp.checkTextureUtility=function(txr){txr.invalidatedWidth>=.2*txr.width&&this.retireTexture(txr)},ETCp.checkTextureFullness=function(txr){var txrQ=this.getTextureQueue(txr.height);txr.usedWidth/txr.width>.8&&txr.fullnessChecks>=10?removeFromArray(txrQ,txr):txr.fullnessChecks++},ETCp.retireTexture=function(txr){var txrH=txr.height,txrQ=this.getTextureQueue(txrH),lookup=this.lookup;removeFromArray(txrQ,txr),txr.retired=!0;for(var eleCaches=txr.eleCaches,i=0;i<eleCaches.length;i++){var eleCache=eleCaches[i];lookup.deleteCache(eleCache.key,eleCache.level)}clearArray(eleCaches),this.getRetiredTextureQueue(txrH).push(txr)},ETCp.addTexture=function(txrH,minW){var txr={};return this.getTextureQueue(txrH).push(txr),txr.eleCaches=[],txr.height=txrH,txr.width=Math.max(1024,minW),txr.usedWidth=0,txr.invalidatedWidth=0,txr.fullnessChecks=0,txr.canvas=this.renderer.makeOffscreenCanvas(txr.width,txr.height),txr.context=txr.canvas.getContext("2d"),txr},ETCp.recycleTexture=function(txrH,minW){for(var txrQ=this.getTextureQueue(txrH),rtxtrQ=this.getRetiredTextureQueue(txrH),i=0;i<rtxtrQ.length;i++){var txr=rtxtrQ[i];if(txr.width>=minW)return txr.retired=!1,txr.usedWidth=0,txr.invalidatedWidth=0,txr.fullnessChecks=0,clearArray(txr.eleCaches),txr.context.setTransform(1,0,0,1,0,0),txr.context.clearRect(0,0,txr.width,txr.height),removeFromArray(rtxtrQ,txr),txrQ.push(txr),txr}},ETCp.queueElement=function(ele,lvl){var q=this.getElementQueue(),k2q=this.getElementKeyToQueue(),key=this.getKey(ele),existingReq=k2q[key];if(existingReq)existingReq.level=Math.max(existingReq.level,lvl),existingReq.eles.merge(ele),existingReq.reqs++,q.updateItem(existingReq);else{var req={eles:ele.spawn().merge(ele),level:lvl,reqs:1,key:key};q.push(req),k2q[key]=req}},ETCp.dequeue=function(pxRatio){for(var q=this.getElementQueue(),k2q=this.getElementKeyToQueue(),dequeued=[],lookup=this.lookup,i=0;i<1&&q.size()>0;i++){var req=q.pop(),key=req.key,ele=req.eles[0],cacheExists=lookup.hasCache(ele,req.level);if(k2q[key]=null,!cacheExists){dequeued.push(req);var bb=this.getBoundingBox(ele);this.getElement(ele,bb,pxRatio,req.level,getTxrReasons.dequeue)}}return dequeued},ETCp.removeFromQueue=function(ele){var q=this.getElementQueue(),k2q=this.getElementKeyToQueue(),key=this.getKey(ele),req=k2q[key];null!=req&&(1===req.eles.length?(req.reqs=MAX_INT,q.updateItem(req),q.pop(),k2q[key]=null):req.eles.unmerge(ele))},ETCp.onDequeue=function(fn){this.onDequeues.push(fn)},ETCp.offDequeue=function(fn){removeFromArray(this.onDequeues,fn)},ETCp.setupDequeueing=defs_setupDequeueing({deqRedrawThreshold:100,deqCost:.15,deqAvgCost:.1,deqNoDrawCost:.9,deqFastCost:.9,deq:function(self,pxRatio,extent){return self.dequeue(pxRatio,extent)},onDeqd:function(self,deqd){for(var i=0;i<self.onDequeues.length;i++){(0,self.onDequeues[i])(deqd)}},shouldRedraw:function(self,deqd,pxRatio,extent){for(var i=0;i<deqd.length;i++)for(var eles=deqd[i].eles,j=0;j<eles.length;j++){var bb=eles[j].boundingBox();if(boundingBoxesIntersect(bb,extent))return!0}return!1},priority:function(self){return self.renderer.beforeRenderPriorities.eleTxrDeq}});var LayeredTextureCache=function(renderer){var self=this,r=self.renderer=renderer,cy=r.cy;self.layersByLevel={},self.firstGet=!0,self.lastInvalidationTime=performanceNow()-500,self.skipping=!1,self.eleTxrDeqs=cy.collection(),self.scheduleElementRefinement=util((function(){self.refineElementTextures(self.eleTxrDeqs),self.eleTxrDeqs.unmerge(self.eleTxrDeqs)}),50),r.beforeRender((function(willDraw,now){now-self.lastInvalidationTime<=250?self.skipping=!0:self.skipping=!1}),r.beforeRenderPriorities.lyrTxrSkip);self.layersQueue=new Heap((function(a,b){return b.reqs-a.reqs})),self.setupDequeueing()},LTCp=LayeredTextureCache.prototype,layerIdPool=0,MAX_INT$1=Math.pow(2,53)-1;LTCp.makeLayer=function(bb,lvl){var scale=Math.pow(2,lvl),w=Math.ceil(bb.w*scale),h=Math.ceil(bb.h*scale),canvas=this.renderer.makeOffscreenCanvas(w,h),layer={id:layerIdPool=++layerIdPool%MAX_INT$1,bb:bb,level:lvl,width:w,height:h,canvas:canvas,context:canvas.getContext("2d"),eles:[],elesQueue:[],reqs:0},cxt=layer.context,dx=-layer.bb.x1,dy=-layer.bb.y1;return cxt.scale(scale,scale),cxt.translate(dx,dy),layer},LTCp.getLayers=function(eles,pxRatio,lvl){var self=this,zoom=self.renderer.cy.zoom(),firstGet=self.firstGet;if(self.firstGet=!1,null==lvl)if((lvl=Math.ceil(log2(zoom*pxRatio)))<-4)lvl=-4;else if(zoom>=3.99||lvl>2)return null;self.validateLayersElesOrdering(lvl,eles);var bb,tmpLayers,layersByLvl=self.layersByLevel,scale=Math.pow(2,lvl),layers=layersByLvl[lvl]=layersByLvl[lvl]||[];if(self.levelIsComplete(lvl,eles))return layers;!function(){var canUseAsTmpLvl=function(l){if(self.validateLayersElesOrdering(l,eles),self.levelIsComplete(l,eles))return tmpLayers=layersByLvl[l],!0},checkLvls=function(dir){if(!tmpLayers)for(var l=lvl+dir;-4<=l&&l<=2&&!canUseAsTmpLvl(l);l+=dir);};checkLvls(1),checkLvls(-1);for(var i=layers.length-1;i>=0;i--){var layer=layers[i];layer.invalid&&removeFromArray(layers,layer)}}();var makeLayer=function(opts){var after=(opts=opts||{}).after;if(function(){if(!bb){bb=makeBoundingBox();for(var i=0;i<eles.length;i++)bb1=bb,bb2=eles[i].boundingBox(),bb1.x1=Math.min(bb1.x1,bb2.x1),bb1.x2=Math.max(bb1.x2,bb2.x2),bb1.w=bb1.x2-bb1.x1,bb1.y1=Math.min(bb1.y1,bb2.y1),bb1.y2=Math.max(bb1.y2,bb2.y2),bb1.h=bb1.y2-bb1.y1}var bb1,bb2}(),bb.w*scale*(bb.h*scale)>16e6)return null;var layer=self.makeLayer(bb,lvl);if(null!=after){var index=layers.indexOf(after)+1;layers.splice(index,0,layer)}else(void 0===opts.insert||opts.insert)&&layers.unshift(layer);return layer};if(self.skipping&&!firstGet)return null;for(var layer=null,maxElesPerLayer=eles.length/1,allowLazyQueueing=!firstGet,i=0;i<eles.length;i++){var ele=eles[i],rs=ele._private.rscratch,caches=rs.imgLayerCaches=rs.imgLayerCaches||{},existingLayer=caches[lvl];if(existingLayer)layer=existingLayer;else{if((!layer||layer.eles.length>=maxElesPerLayer||!boundingBoxInBoundingBox(layer.bb,ele.boundingBox()))&&!(layer=makeLayer({insert:!0,after:layer})))return null;tmpLayers||allowLazyQueueing?self.queueLayer(layer,ele):self.drawEleInLayer(layer,ele,lvl,pxRatio),layer.eles.push(ele),caches[lvl]=layer}}return tmpLayers||(allowLazyQueueing?null:layers)},LTCp.getEleLevelForLayerLevel=function(lvl,pxRatio){return lvl},LTCp.drawEleInLayer=function(layer,ele,lvl,pxRatio){var r=this.renderer,context=layer.context,bb=ele.boundingBox();0!==bb.w&&0!==bb.h&&ele.visible()&&(lvl=this.getEleLevelForLayerLevel(lvl,pxRatio),r.setImgSmoothing(context,!1),r.drawCachedElement(context,ele,null,null,lvl,!0),r.setImgSmoothing(context,!0))},LTCp.levelIsComplete=function(lvl,eles){var layers=this.layersByLevel[lvl];if(!layers||0===layers.length)return!1;for(var numElesInLayers=0,i=0;i<layers.length;i++){var layer=layers[i];if(layer.reqs>0)return!1;if(layer.invalid)return!1;numElesInLayers+=layer.eles.length}return numElesInLayers===eles.length},LTCp.validateLayersElesOrdering=function(lvl,eles){var layers=this.layersByLevel[lvl];if(layers)for(var i=0;i<layers.length;i++){for(var layer=layers[i],offset=-1,j=0;j<eles.length;j++)if(layer.eles[0]===eles[j]){offset=j;break}if(offset<0)this.invalidateLayer(layer);else{var o=offset;for(j=0;j<layer.eles.length;j++)if(layer.eles[j]!==eles[o+j]){this.invalidateLayer(layer);break}}}},LTCp.updateElementsInLayers=function(eles,update){for(var isEles=element(eles[0]),i=0;i<eles.length;i++)for(var req=isEles?null:eles[i],ele=isEles?eles[i]:eles[i].ele,rs=ele._private.rscratch,caches=rs.imgLayerCaches=rs.imgLayerCaches||{},l=-4;l<=2;l++){var layer=caches[l];layer&&(req&&this.getEleLevelForLayerLevel(layer.level)!==req.level||update(layer,ele,req))}},LTCp.haveLayers=function(){for(var haveLayers=!1,l=-4;l<=2;l++){var layers=this.layersByLevel[l];if(layers&&layers.length>0){haveLayers=!0;break}}return haveLayers},LTCp.invalidateElements=function(eles){var self=this;0!==eles.length&&(self.lastInvalidationTime=performanceNow(),0!==eles.length&&self.haveLayers()&&self.updateElementsInLayers(eles,(function(layer,ele,req){self.invalidateLayer(layer)})))},LTCp.invalidateLayer=function(layer){if(this.lastInvalidationTime=performanceNow(),!layer.invalid){var lvl=layer.level,eles=layer.eles,layers=this.layersByLevel[lvl];removeFromArray(layers,layer),layer.elesQueue=[],layer.invalid=!0,layer.replacement&&(layer.replacement.invalid=!0);for(var i=0;i<eles.length;i++){var caches=eles[i]._private.rscratch.imgLayerCaches;caches&&(caches[lvl]=null)}}},LTCp.refineElementTextures=function(eles){var self=this;self.updateElementsInLayers(eles,(function(layer,ele,req){var rLyr=layer.replacement;if(rLyr||((rLyr=layer.replacement=self.makeLayer(layer.bb,layer.level)).replaces=layer,rLyr.eles=layer.eles),!rLyr.reqs)for(var i=0;i<rLyr.eles.length;i++)self.queueLayer(rLyr,rLyr.eles[i])}))},LTCp.enqueueElementRefinement=function(ele){this.eleTxrDeqs.merge(ele),this.scheduleElementRefinement()},LTCp.queueLayer=function(layer,ele){var q=this.layersQueue,elesQ=layer.elesQueue,hasId=elesQ.hasId=elesQ.hasId||{};if(!layer.replacement){if(ele){if(hasId[ele.id()])return;elesQ.push(ele),hasId[ele.id()]=!0}layer.reqs?(layer.reqs++,q.updateItem(layer)):(layer.reqs=1,q.push(layer))}},LTCp.dequeue=function(pxRatio){for(var q=this.layersQueue,deqd=[],eleDeqs=0;eleDeqs<1&&0!==q.size();){var layer=q.peek();if(layer.replacement)q.pop();else if(layer.replaces&&layer!==layer.replaces.replacement)q.pop();else if(layer.invalid)q.pop();else{var ele=layer.elesQueue.shift();ele&&(this.drawEleInLayer(layer,ele,layer.level,pxRatio),eleDeqs++),0===deqd.length&&deqd.push(!0),0===layer.elesQueue.length&&(q.pop(),layer.reqs=0,layer.replaces&&this.applyLayerReplacement(layer),this.requestRedraw())}}return deqd},LTCp.applyLayerReplacement=function(layer){var layersInLevel=this.layersByLevel[layer.level],replaced=layer.replaces,index=layersInLevel.indexOf(replaced);if(!(index<0||replaced.invalid)){layersInLevel[index]=layer;for(var i=0;i<layer.eles.length;i++){var _p=layer.eles[i]._private,cache=_p.imgLayerCaches=_p.imgLayerCaches||{};cache&&(cache[layer.level]=layer)}this.requestRedraw()}},LTCp.requestRedraw=util((function(){var r=this.renderer;r.redrawHint("eles",!0),r.redrawHint("drag",!0),r.redraw()}),100),LTCp.setupDequeueing=defs_setupDequeueing({deqRedrawThreshold:50,deqCost:.15,deqAvgCost:.1,deqNoDrawCost:.9,deqFastCost:.9,deq:function(self,pxRatio){return self.dequeue(pxRatio)},onDeqd:noop,shouldRedraw:trueify,priority:function(self){return self.renderer.beforeRenderPriorities.lyrTxrDeq}});var impl,CRp={};function polygon(context,points){for(var i=0;i<points.length;i++){var pt=points[i];context.lineTo(pt.x,pt.y)}}function triangleBackcurve(context,points,controlPoint){for(var firstPt,i=0;i<points.length;i++){var pt=points[i];0===i&&(firstPt=pt),context.lineTo(pt.x,pt.y)}context.quadraticCurveTo(controlPoint.x,controlPoint.y,firstPt.x,firstPt.y)}function triangleTee(context,trianglePoints,teePoints){context.beginPath&&context.beginPath();for(var triPts=trianglePoints,i=0;i<triPts.length;i++){var pt=triPts[i];context.lineTo(pt.x,pt.y)}var teePts=teePoints,firstTeePt=teePoints[0];context.moveTo(firstTeePt.x,firstTeePt.y);for(i=1;i<teePts.length;i++){pt=teePts[i];context.lineTo(pt.x,pt.y)}context.closePath&&context.closePath()}function circle(context,rx,ry,r){context.arc(rx,ry,r,0,2*Math.PI,!1)}CRp.arrowShapeImpl=function(name){return(impl||(impl={polygon:polygon,"triangle-backcurve":triangleBackcurve,"triangle-tee":triangleTee,"triangle-cross":triangleTee,circle:circle}))[name]};var CRp$1={drawElement:function(context,ele,shiftToOriginWithBb,showLabel,showOverlay,showOpacity){ele.isNode()?this.drawNode(context,ele,shiftToOriginWithBb,showLabel,showOverlay,showOpacity):this.drawEdge(context,ele,shiftToOriginWithBb,showLabel,showOverlay,showOpacity)},drawElementOverlay:function(context,ele){ele.isNode()?this.drawNodeOverlay(context,ele):this.drawEdgeOverlay(context,ele)},drawCachedElementPortion:function(context,ele,eleTxrCache,pxRatio,lvl,reason,getRotation,getOpacity){var r=this,bb=eleTxrCache.getBoundingBox(ele);if(0!==bb.w&&0!==bb.h){var eleCache=eleTxrCache.getElement(ele,bb,pxRatio,lvl,reason);if(null!=eleCache){var opacity=getOpacity(r,ele);if(0===opacity)return;var x,y,sx,sy,smooth,oldGlobalAlpha,theta=getRotation(r,ele),x1=bb.x1,y1=bb.y1,w=bb.w,h=bb.h;if(0!==theta){var rotPt=eleTxrCache.getRotationPoint(ele);sx=rotPt.x,sy=rotPt.y,context.translate(sx,sy),context.rotate(theta),(smooth=r.getImgSmoothing(context))||r.setImgSmoothing(context,!0);var off=eleTxrCache.getRotationOffset(ele);x=off.x,y=off.y}else x=x1,y=y1;1!==opacity&&(oldGlobalAlpha=context.globalAlpha,context.globalAlpha=oldGlobalAlpha*opacity),context.drawImage(eleCache.texture.canvas,eleCache.x,0,eleCache.width,eleCache.height,x,y,w,h),1!==opacity&&(context.globalAlpha=oldGlobalAlpha),0!==theta&&(context.rotate(-theta),context.translate(-sx,-sy),smooth||r.setImgSmoothing(context,!1))}else eleTxrCache.drawElement(context,ele)}}},getZeroRotation=function(){return 0},getLabelRotation=function(r,ele){return r.getTextAngle(ele,null)},getSourceLabelRotation=function(r,ele){return r.getTextAngle(ele,"source")},getTargetLabelRotation=function(r,ele){return r.getTextAngle(ele,"target")},getOpacity=function(r,ele){return ele.effectiveOpacity()},getTextOpacity=function(e,ele){return ele.pstyle("text-opacity").pfValue*ele.effectiveOpacity()};CRp$1.drawCachedElement=function(context,ele,pxRatio,extent,lvl,requestHighQuality){var r=this,_r$data=r.data,eleTxrCache=_r$data.eleTxrCache,lblTxrCache=_r$data.lblTxrCache,slbTxrCache=_r$data.slbTxrCache,tlbTxrCache=_r$data.tlbTxrCache,bb=ele.boundingBox(),reason=!0===requestHighQuality?eleTxrCache.reasons.highQuality:null;0!==bb.w&&0!==bb.h&&ele.visible()&&(extent&&!boundingBoxesIntersect(bb,extent)||(r.drawCachedElementPortion(context,ele,eleTxrCache,pxRatio,lvl,reason,getZeroRotation,getOpacity),r.drawCachedElementPortion(context,ele,lblTxrCache,pxRatio,lvl,reason,getLabelRotation,getTextOpacity),ele.isEdge()&&(r.drawCachedElementPortion(context,ele,slbTxrCache,pxRatio,lvl,reason,getSourceLabelRotation,getTextOpacity),r.drawCachedElementPortion(context,ele,tlbTxrCache,pxRatio,lvl,reason,getTargetLabelRotation,getTextOpacity)),r.drawElementOverlay(context,ele)))},CRp$1.drawElements=function(context,eles){for(var i=0;i<eles.length;i++){var ele=eles[i];this.drawElement(context,ele)}},CRp$1.drawCachedElements=function(context,eles,pxRatio,extent){for(var i=0;i<eles.length;i++){var ele=eles[i];this.drawCachedElement(context,ele,pxRatio,extent)}},CRp$1.drawCachedNodes=function(context,eles,pxRatio,extent){for(var i=0;i<eles.length;i++){var ele=eles[i];ele.isNode()&&this.drawCachedElement(context,ele,pxRatio,extent)}},CRp$1.drawLayeredElements=function(context,eles,pxRatio,extent){var layers=this.data.lyrTxrCache.getLayers(eles,pxRatio);if(layers)for(var i=0;i<layers.length;i++){var layer=layers[i],bb=layer.bb;0!==bb.w&&0!==bb.h&&context.drawImage(layer.canvas,bb.x1,bb.y1,bb.w,bb.h)}else this.drawCachedElements(context,eles,pxRatio,extent)};var CRp$2={drawEdge:function(context,edge,shiftToOriginWithBb){var drawLabel=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],shouldDrawOverlay=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],shouldDrawOpacity=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],r=this,rs=edge._private.rscratch;if((!shouldDrawOpacity||edge.visible())&&!rs.badLine&&null!=rs.allpts&&!isNaN(rs.allpts[0])){var bb;shiftToOriginWithBb&&(bb=shiftToOriginWithBb,context.translate(-bb.x1,-bb.y1));var opacity=shouldDrawOpacity?edge.pstyle("opacity").value:1,lineStyle=edge.pstyle("line-style").value,edgeWidth=edge.pstyle("width").pfValue,lineCap=edge.pstyle("line-cap").value,drawLine=function(){var strokeOpacity=arguments.length>0&&void 0!==arguments[0]?arguments[0]:opacity;context.lineWidth=edgeWidth,context.lineCap=lineCap,r.eleStrokeStyle(context,edge,strokeOpacity),r.drawEdgePath(edge,context,rs.allpts,lineStyle),context.lineCap="butt"},drawOverlay=function(){shouldDrawOverlay&&r.drawEdgeOverlay(context,edge)},drawArrows=function(){var arrowOpacity=arguments.length>0&&void 0!==arguments[0]?arguments[0]:opacity;r.drawArrowheads(context,edge,arrowOpacity)},drawText=function(){r.drawElementText(context,edge,null,drawLabel)};context.lineJoin="round";var ghost="yes"===edge.pstyle("ghost").value;if(ghost){var gx=edge.pstyle("ghost-offset-x").pfValue,gy=edge.pstyle("ghost-offset-y").pfValue,ghostOpacity=edge.pstyle("ghost-opacity").value,effectiveGhostOpacity=opacity*ghostOpacity;context.translate(gx,gy),drawLine(effectiveGhostOpacity),drawArrows(effectiveGhostOpacity),context.translate(-gx,-gy)}drawLine(),drawArrows(),drawOverlay(),drawText(),shiftToOriginWithBb&&context.translate(bb.x1,bb.y1)}},drawEdgeOverlay:function(context,edge){if(edge.visible()){var overlayOpacity=edge.pstyle("overlay-opacity").value;if(0!==overlayOpacity){var r=this,usePaths=r.usePaths(),rs=edge._private.rscratch,overlayWidth=2*edge.pstyle("overlay-padding").pfValue,overlayColor=edge.pstyle("overlay-color").value;context.lineWidth=overlayWidth,"self"!==rs.edgeType||usePaths?context.lineCap="round":context.lineCap="butt",r.colorStrokeStyle(context,overlayColor[0],overlayColor[1],overlayColor[2],overlayOpacity),r.drawEdgePath(edge,context,rs.allpts,"solid")}}},drawEdgePath:function(edge,context,pts,type){var path,rs=edge._private.rscratch,canvasCxt=context,pathCacheHit=!1,usePaths=this.usePaths(),lineDashPattern=edge.pstyle("line-dash-pattern").pfValue,lineDashOffset=edge.pstyle("line-dash-offset").pfValue;if(usePaths){var pathCacheKey=pts.join("$");rs.pathCacheKey&&rs.pathCacheKey===pathCacheKey?(path=context=rs.pathCache,pathCacheHit=!0):(path=context=new Path2D,rs.pathCacheKey=pathCacheKey,rs.pathCache=path)}if(canvasCxt.setLineDash)switch(type){case"dotted":canvasCxt.setLineDash([1,1]);break;case"dashed":canvasCxt.setLineDash(lineDashPattern),canvasCxt.lineDashOffset=lineDashOffset;break;case"solid":canvasCxt.setLineDash([])}if(!pathCacheHit&&!rs.badLine)switch(context.beginPath&&context.beginPath(),context.moveTo(pts[0],pts[1]),rs.edgeType){case"bezier":case"self":case"compound":case"multibezier":for(var i=2;i+3<pts.length;i+=4)context.quadraticCurveTo(pts[i],pts[i+1],pts[i+2],pts[i+3]);break;case"straight":case"segments":case"haystack":for(var _i=2;_i+1<pts.length;_i+=2)context.lineTo(pts[_i],pts[_i+1])}context=canvasCxt,usePaths?context.stroke(path):context.stroke(),context.setLineDash&&context.setLineDash([])},drawArrowheads:function(context,edge,opacity){var rs=edge._private.rscratch,isHaystack="haystack"===rs.edgeType;isHaystack||this.drawArrowhead(context,edge,"source",rs.arrowStartX,rs.arrowStartY,rs.srcArrowAngle,opacity),this.drawArrowhead(context,edge,"mid-target",rs.midX,rs.midY,rs.midtgtArrowAngle,opacity),this.drawArrowhead(context,edge,"mid-source",rs.midX,rs.midY,rs.midsrcArrowAngle,opacity),isHaystack||this.drawArrowhead(context,edge,"target",rs.arrowEndX,rs.arrowEndY,rs.tgtArrowAngle,opacity)},drawArrowhead:function(context,edge,prefix,x,y,angle,opacity){if(!(isNaN(x)||null==x||isNaN(y)||null==y||isNaN(angle)||null==angle)){var arrowShape=edge.pstyle(prefix+"-arrow-shape").value;if("none"!==arrowShape){var arrowClearFill="hollow"===edge.pstyle(prefix+"-arrow-fill").value?"both":"filled",arrowFill=edge.pstyle(prefix+"-arrow-fill").value,edgeWidth=edge.pstyle("width").pfValue,edgeOpacity=edge.pstyle("opacity").value;void 0===opacity&&(opacity=edgeOpacity);var gco=context.globalCompositeOperation;1===opacity&&"hollow"!==arrowFill||(context.globalCompositeOperation="destination-out",this.colorFillStyle(context,255,255,255,1),this.colorStrokeStyle(context,255,255,255,1),this.drawArrowShape(edge,context,arrowClearFill,edgeWidth,arrowShape,x,y,angle),context.globalCompositeOperation=gco);var color=edge.pstyle(prefix+"-arrow-color").value;this.colorFillStyle(context,color[0],color[1],color[2],opacity),this.colorStrokeStyle(context,color[0],color[1],color[2],opacity),this.drawArrowShape(edge,context,arrowFill,edgeWidth,arrowShape,x,y,angle)}}},drawArrowShape:function(edge,context,fill,edgeWidth,shape,x,y,angle){var path,r=this,usePaths=this.usePaths()&&"triangle-cross"!==shape,pathCacheHit=!1,canvasContext=context,translation={x:x,y:y},scale=edge.pstyle("arrow-scale").value,size=this.getArrowWidth(edgeWidth,scale),shapeImpl=r.arrowShapes[shape];if(usePaths){var cache=r.arrowPathCache=r.arrowPathCache||[],key=hashString(shape),cachedPath=cache[key];null!=cachedPath?(path=context=cachedPath,pathCacheHit=!0):(path=context=new Path2D,cache[key]=path)}context.beginPath&&context.beginPath(),pathCacheHit||(usePaths?shapeImpl.draw(context,1,0,{x:0,y:0},1):shapeImpl.draw(context,size,angle,translation,edgeWidth)),context.closePath&&context.closePath(),context=canvasContext,usePaths&&(context.translate(x,y),context.rotate(angle),context.scale(size,size)),"filled"!==fill&&"both"!==fill||(usePaths?context.fill(path):context.fill()),"hollow"!==fill&&"both"!==fill||(context.lineWidth=(shapeImpl.matchEdgeWidth?edgeWidth:1)/(usePaths?size:1),context.lineJoin="miter",usePaths?context.stroke(path):context.stroke()),usePaths&&(context.scale(1/size,1/size),context.rotate(-angle),context.translate(-x,-y))}},CRp$3={safeDrawImage:function(context,img,ix,iy,iw,ih,x,y,w,h){iw<=0||ih<=0||w<=0||h<=0||context.drawImage(img,ix,iy,iw,ih,x,y,w,h)},drawInscribedImage:function(context,img,node,index,nodeOpacity){var r=this,pos=node.position(),nodeX=pos.x,nodeY=pos.y,styleObj=node.cy().style(),getIndexedStyle=styleObj.getIndexedStyle.bind(styleObj),fit=getIndexedStyle(node,"background-fit","value",index),repeat=getIndexedStyle(node,"background-repeat","value",index),nodeW=node.width(),nodeH=node.height(),paddingX2=2*node.padding(),nodeTW=nodeW+("inner"===getIndexedStyle(node,"background-width-relative-to","value",index)?0:paddingX2),nodeTH=nodeH+("inner"===getIndexedStyle(node,"background-height-relative-to","value",index)?0:paddingX2),rs=node._private.rscratch,shouldClip="node"===getIndexedStyle(node,"background-clip","value",index),imgOpacity=getIndexedStyle(node,"background-image-opacity","value",index)*nodeOpacity,imgW=img.width||img.cachedW,imgH=img.height||img.cachedH;null!=imgW&&null!=imgH||(document.body.appendChild(img),imgW=img.cachedW=img.width||img.offsetWidth,imgH=img.cachedH=img.height||img.offsetHeight,document.body.removeChild(img));var w=imgW,h=imgH;if("auto"!==getIndexedStyle(node,"background-width","value",index)&&(w="%"===getIndexedStyle(node,"background-width","units",index)?getIndexedStyle(node,"background-width","pfValue",index)*nodeTW:getIndexedStyle(node,"background-width","pfValue",index)),"auto"!==getIndexedStyle(node,"background-height","value",index)&&(h="%"===getIndexedStyle(node,"background-height","units",index)?getIndexedStyle(node,"background-height","pfValue",index)*nodeTH:getIndexedStyle(node,"background-height","pfValue",index)),0!==w&&0!==h){if("contain"===fit)w*=scale=Math.min(nodeTW/w,nodeTH/h),h*=scale;else if("cover"===fit){var scale;w*=scale=Math.max(nodeTW/w,nodeTH/h),h*=scale}var x=nodeX-nodeTW/2,posXUnits=getIndexedStyle(node,"background-position-x","units",index),posXPfVal=getIndexedStyle(node,"background-position-x","pfValue",index);x+="%"===posXUnits?(nodeTW-w)*posXPfVal:posXPfVal;var offXUnits=getIndexedStyle(node,"background-offset-x","units",index),offXPfVal=getIndexedStyle(node,"background-offset-x","pfValue",index);x+="%"===offXUnits?(nodeTW-w)*offXPfVal:offXPfVal;var y=nodeY-nodeTH/2,posYUnits=getIndexedStyle(node,"background-position-y","units",index),posYPfVal=getIndexedStyle(node,"background-position-y","pfValue",index);y+="%"===posYUnits?(nodeTH-h)*posYPfVal:posYPfVal;var offYUnits=getIndexedStyle(node,"background-offset-y","units",index),offYPfVal=getIndexedStyle(node,"background-offset-y","pfValue",index);y+="%"===offYUnits?(nodeTH-h)*offYPfVal:offYPfVal,rs.pathCache&&(x-=nodeX,y-=nodeY,nodeX=0,nodeY=0);var gAlpha=context.globalAlpha;if(context.globalAlpha=imgOpacity,"no-repeat"===repeat)shouldClip&&(context.save(),rs.pathCache?context.clip(rs.pathCache):(r.nodeShapes[r.getNodeShape(node)].draw(context,nodeX,nodeY,nodeTW,nodeTH),context.clip())),r.safeDrawImage(context,img,0,0,imgW,imgH,x,y,w,h),shouldClip&&context.restore();else{var pattern=context.createPattern(img,repeat);context.fillStyle=pattern,r.nodeShapes[r.getNodeShape(node)].draw(context,nodeX,nodeY,nodeTW,nodeTH),context.translate(x,y),context.fill(),context.translate(-x,-y)}context.globalAlpha=gAlpha}}},CRp$4={};function roundRect(ctx,x,y,width,height){var radius=arguments.length>5&&void 0!==arguments[5]?arguments[5]:5;ctx.beginPath(),ctx.moveTo(x+radius,y),ctx.lineTo(x+width-radius,y),ctx.quadraticCurveTo(x+width,y,x+width,y+radius),ctx.lineTo(x+width,y+height-radius),ctx.quadraticCurveTo(x+width,y+height,x+width-radius,y+height),ctx.lineTo(x+radius,y+height),ctx.quadraticCurveTo(x,y+height,x,y+height-radius),ctx.lineTo(x,y+radius),ctx.quadraticCurveTo(x,y,x+radius,y),ctx.closePath(),ctx.fill()}CRp$4.eleTextBiggerThanMin=function(ele,scale){if(!scale){var zoom=ele.cy().zoom(),pxRatio=this.getPixelRatio(),lvl=Math.ceil(log2(zoom*pxRatio));scale=Math.pow(2,lvl)}return!(ele.pstyle("font-size").pfValue*scale<ele.pstyle("min-zoomed-font-size").pfValue)},CRp$4.drawElementText=function(context,ele,shiftToOriginWithBb,force,prefix){var useEleOpacity=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],r=this;if(null==force){if(useEleOpacity&&!r.eleTextBiggerThanMin(ele))return}else if(!1===force)return;if(ele.isNode()){var label=ele.pstyle("label");if(!label||!label.value)return;var justification=r.getLabelJustification(ele);context.textAlign=justification,context.textBaseline="bottom"}else{var _label=ele.pstyle("label"),srcLabel=ele.pstyle("source-label"),tgtLabel=ele.pstyle("target-label");if(!(_label&&_label.value||srcLabel&&srcLabel.value||tgtLabel&&tgtLabel.value))return;context.textAlign="center",context.textBaseline="bottom"}var bb,applyRotation=!shiftToOriginWithBb;shiftToOriginWithBb&&(bb=shiftToOriginWithBb,context.translate(-bb.x1,-bb.y1)),null==prefix?(r.drawText(context,ele,null,applyRotation,useEleOpacity),ele.isEdge()&&(r.drawText(context,ele,"source",applyRotation,useEleOpacity),r.drawText(context,ele,"target",applyRotation,useEleOpacity))):r.drawText(context,ele,prefix,applyRotation,useEleOpacity),shiftToOriginWithBb&&context.translate(bb.x1,bb.y1)},CRp$4.getFontCache=function(context){var cache;this.fontCaches=this.fontCaches||[];for(var i=0;i<this.fontCaches.length;i++)if((cache=this.fontCaches[i]).context===context)return cache;return cache={context:context},this.fontCaches.push(cache),cache},CRp$4.setupTextStyle=function(context,ele){var useEleOpacity=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],labelStyle=ele.pstyle("font-style").strValue,labelSize=ele.pstyle("font-size").pfValue+"px",labelFamily=ele.pstyle("font-family").strValue,labelWeight=ele.pstyle("font-weight").strValue,opacity=useEleOpacity?ele.effectiveOpacity()*ele.pstyle("text-opacity").value:1,outlineOpacity=ele.pstyle("text-outline-opacity").value*opacity,color=ele.pstyle("color").value,outlineColor=ele.pstyle("text-outline-color").value;context.font=labelStyle+" "+labelWeight+" "+labelSize+" "+labelFamily,context.lineJoin="round",this.colorFillStyle(context,color[0],color[1],color[2],opacity),this.colorStrokeStyle(context,outlineColor[0],outlineColor[1],outlineColor[2],outlineOpacity)},CRp$4.getTextAngle=function(ele,prefix){var rscratch=ele._private.rscratch,pdash=prefix?prefix+"-":"",rotation=ele.pstyle(pdash+"text-rotation"),textAngle=getPrefixedProperty(rscratch,"labelAngle",prefix);return"autorotate"===rotation.strValue?ele.isEdge()?textAngle:0:"none"===rotation.strValue?0:rotation.pfValue},CRp$4.drawText=function(context,ele,prefix){var applyRotation=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],useEleOpacity=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],_p=ele._private,rscratch=_p.rscratch,parentOpacity=useEleOpacity?ele.effectiveOpacity():1;if(!useEleOpacity||0!==parentOpacity&&0!==ele.pstyle("text-opacity").value){"main"===prefix&&(prefix=null);var orgTextX,orgTextY,textX=getPrefixedProperty(rscratch,"labelX",prefix),textY=getPrefixedProperty(rscratch,"labelY",prefix),text=this.getLabelText(ele,prefix);if(null!=text&&""!==text&&!isNaN(textX)&&!isNaN(textY)){this.setupTextStyle(context,ele,useEleOpacity);var theta,pdash=prefix?prefix+"-":"",textW=getPrefixedProperty(rscratch,"labelWidth",prefix),textH=getPrefixedProperty(rscratch,"labelHeight",prefix),marginX=ele.pstyle(pdash+"text-margin-x").pfValue,marginY=ele.pstyle(pdash+"text-margin-y").pfValue,isEdge=ele.isEdge(),halign=ele.pstyle("text-halign").value,valign=ele.pstyle("text-valign").value;switch(isEdge&&(halign="center",valign="center"),textX+=marginX,textY+=marginY,0!==(theta=applyRotation?this.getTextAngle(ele,prefix):0)&&(orgTextX=textX,orgTextY=textY,context.translate(orgTextX,orgTextY),context.rotate(theta),textX=0,textY=0),valign){case"top":break;case"center":textY+=textH/2;break;case"bottom":textY+=textH}var backgroundOpacity=ele.pstyle("text-background-opacity").value,borderOpacity=ele.pstyle("text-border-opacity").value,textBorderWidth=ele.pstyle("text-border-width").pfValue,backgroundPadding=ele.pstyle("text-background-padding").pfValue;if(backgroundOpacity>0||textBorderWidth>0&&borderOpacity>0){var bgX=textX-backgroundPadding;switch(halign){case"left":bgX-=textW;break;case"center":bgX-=textW/2}var bgY=textY-textH-backgroundPadding,bgW=textW+2*backgroundPadding,bgH=textH+2*backgroundPadding;if(backgroundOpacity>0){var textFill=context.fillStyle,textBackgroundColor=ele.pstyle("text-background-color").value;context.fillStyle="rgba("+textBackgroundColor[0]+","+textBackgroundColor[1]+","+textBackgroundColor[2]+","+backgroundOpacity*parentOpacity+")";var styleShape=ele.pstyle("text-background-shape").strValue;"roundrectangle"==styleShape?roundRect(context,bgX,bgY,bgW,bgH,2):context.fillRect(bgX,bgY,bgW,bgH),context.fillStyle=textFill}if(textBorderWidth>0&&borderOpacity>0){var textStroke=context.strokeStyle,textLineWidth=context.lineWidth,textBorderColor=ele.pstyle("text-border-color").value,textBorderStyle=ele.pstyle("text-border-style").value;if(context.strokeStyle="rgba("+textBorderColor[0]+","+textBorderColor[1]+","+textBorderColor[2]+","+borderOpacity*parentOpacity+")",context.lineWidth=textBorderWidth,context.setLineDash)switch(textBorderStyle){case"dotted":context.setLineDash([1,1]);break;case"dashed":context.setLineDash([4,2]);break;case"double":context.lineWidth=textBorderWidth/4,context.setLineDash([]);break;case"solid":context.setLineDash([])}if(context.strokeRect(bgX,bgY,bgW,bgH),"double"===textBorderStyle){var whiteWidth=textBorderWidth/2;context.strokeRect(bgX+whiteWidth,bgY+whiteWidth,bgW-2*whiteWidth,bgH-2*whiteWidth)}context.setLineDash&&context.setLineDash([]),context.lineWidth=textLineWidth,context.strokeStyle=textStroke}}var lineWidth=2*ele.pstyle("text-outline-width").pfValue;if(lineWidth>0&&(context.lineWidth=lineWidth),"wrap"===ele.pstyle("text-wrap").value){var lines=getPrefixedProperty(rscratch,"labelWrapCachedLines",prefix),lineHeight=getPrefixedProperty(rscratch,"labelLineHeight",prefix),halfTextW=textW/2,justification=this.getLabelJustification(ele);switch("auto"===justification||("left"===halign?"left"===justification?textX+=-textW:"center"===justification&&(textX+=-halfTextW):"center"===halign?"left"===justification?textX+=-halfTextW:"right"===justification&&(textX+=halfTextW):"right"===halign&&("center"===justification?textX+=halfTextW:"right"===justification&&(textX+=textW))),valign){case"top":textY-=(lines.length-1)*lineHeight;break;case"center":case"bottom":textY-=(lines.length-1)*lineHeight}for(var l=0;l<lines.length;l++)lineWidth>0&&context.strokeText(lines[l],textX,textY),context.fillText(lines[l],textX,textY),textY+=lineHeight}else lineWidth>0&&context.strokeText(text,textX,textY),context.fillText(text,textX,textY);0!==theta&&(context.rotate(-theta),context.translate(-orgTextX,-orgTextY))}}};var CRp$5={drawNode:function(context,node,shiftToOriginWithBb){var nodeWidth,nodeHeight,drawLabel=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],shouldDrawOverlay=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],shouldDrawOpacity=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],r=this,_p=node._private,rs=_p.rscratch,pos=node.position();if(number(pos.x)&&number(pos.y)&&(!shouldDrawOpacity||node.visible())){var path,bb,eleOpacity=shouldDrawOpacity?node.effectiveOpacity():1,usePaths=r.usePaths(),pathCacheHit=!1,padding=node.padding();nodeWidth=node.width()+2*padding,nodeHeight=node.height()+2*padding,shiftToOriginWithBb&&(bb=shiftToOriginWithBb,context.translate(-bb.x1,-bb.y1));for(var bgImgProp=node.pstyle("background-image"),urls=bgImgProp.value,urlDefined=new Array(urls.length),image=new Array(urls.length),numImages=0,i=0;i<urls.length;i++){var url=urls[i],defd=urlDefined[i]=null!=url&&"none"!==url;if(defd){var bgImgCrossOrigin=node.cy().style().getIndexedStyle(node,"background-image-crossorigin","value",i);numImages++,image[i]=r.getCachedImage(url,bgImgCrossOrigin,(function(){_p.backgroundTimestamp=Date.now(),node.emitAndNotify("background")}))}}var darkness=node.pstyle("background-blacken").value,borderWidth=node.pstyle("border-width").pfValue,bgOpacity=node.pstyle("background-opacity").value*eleOpacity,borderColor=node.pstyle("border-color").value,borderStyle=node.pstyle("border-style").value,borderOpacity=node.pstyle("border-opacity").value*eleOpacity;context.lineJoin="miter";var setupShapeColor=function(){var bgOpy=arguments.length>0&&void 0!==arguments[0]?arguments[0]:bgOpacity;r.eleFillStyle(context,node,bgOpy)},setupBorderColor=function(){var bdrOpy=arguments.length>0&&void 0!==arguments[0]?arguments[0]:borderOpacity;r.colorStrokeStyle(context,borderColor[0],borderColor[1],borderColor[2],bdrOpy)},styleShape=node.pstyle("shape").strValue,shapePts=node.pstyle("shape-polygon-points").pfValue;if(usePaths){context.translate(pos.x,pos.y);var pathCache=r.nodePathCache=r.nodePathCache||[],key=hashStrings("polygon"===styleShape?styleShape+","+shapePts.join(","):styleShape,""+nodeHeight,""+nodeWidth),cachedPath=pathCache[key];null!=cachedPath?(path=cachedPath,pathCacheHit=!0,rs.pathCache=path):(path=new Path2D,pathCache[key]=rs.pathCache=path)}var drawShape=function(){if(!pathCacheHit){var npos=pos;usePaths&&(npos={x:0,y:0}),r.nodeShapes[r.getNodeShape(node)].draw(path||context,npos.x,npos.y,nodeWidth,nodeHeight)}usePaths?context.fill(path):context.fill()},drawImages=function(){for(var nodeOpacity=arguments.length>0&&void 0!==arguments[0]?arguments[0]:eleOpacity,prevBging=_p.backgrounding,totalCompleted=0,_i=0;_i<image.length;_i++)urlDefined[_i]&&image[_i].complete&&!image[_i].error&&(totalCompleted++,r.drawInscribedImage(context,image[_i],node,_i,nodeOpacity));_p.backgrounding=!(totalCompleted===numImages),prevBging!==_p.backgrounding&&node.updateStyle(!1)},drawPie=function(){var redrawShape=arguments.length>0&&void 0!==arguments[0]&&arguments[0],pieOpacity=arguments.length>1&&void 0!==arguments[1]?arguments[1]:eleOpacity;r.hasPie(node)&&(r.drawPie(context,node,pieOpacity),redrawShape&&(usePaths||r.nodeShapes[r.getNodeShape(node)].draw(context,pos.x,pos.y,nodeWidth,nodeHeight)))},darken=function(){var darkenOpacity=arguments.length>0&&void 0!==arguments[0]?arguments[0]:eleOpacity,opacity=(darkness>0?darkness:-darkness)*darkenOpacity,c=darkness>0?0:255;0!==darkness&&(r.colorFillStyle(context,c,c,c,opacity),usePaths?context.fill(path):context.fill())},drawBorder=function(){if(borderWidth>0){if(context.lineWidth=borderWidth,context.lineCap="butt",context.setLineDash)switch(borderStyle){case"dotted":context.setLineDash([1,1]);break;case"dashed":context.setLineDash([4,2]);break;case"solid":case"double":context.setLineDash([])}if(usePaths?context.stroke(path):context.stroke(),"double"===borderStyle){context.lineWidth=borderWidth/3;var gco=context.globalCompositeOperation;context.globalCompositeOperation="destination-out",usePaths?context.stroke(path):context.stroke(),context.globalCompositeOperation=gco}context.setLineDash&&context.setLineDash([])}},drawOverlay=function(){shouldDrawOverlay&&r.drawNodeOverlay(context,node,pos,nodeWidth,nodeHeight)},drawText=function(){r.drawElementText(context,node,null,drawLabel)},ghost="yes"===node.pstyle("ghost").value;if(ghost){var gx=node.pstyle("ghost-offset-x").pfValue,gy=node.pstyle("ghost-offset-y").pfValue,ghostOpacity=node.pstyle("ghost-opacity").value,effGhostOpacity=ghostOpacity*eleOpacity;context.translate(gx,gy),setupShapeColor(ghostOpacity*bgOpacity),drawShape(),drawImages(effGhostOpacity),drawPie(0!==darkness||0!==borderWidth),darken(effGhostOpacity),setupBorderColor(ghostOpacity*borderOpacity),drawBorder(),context.translate(-gx,-gy)}setupShapeColor(),drawShape(),drawImages(),drawPie(0!==darkness||0!==borderWidth),darken(),setupBorderColor(),drawBorder(),usePaths&&context.translate(-pos.x,-pos.y),drawText(),drawOverlay(),shiftToOriginWithBb&&context.translate(bb.x1,bb.y1)}},drawNodeOverlay:function(context,node,pos,nodeWidth,nodeHeight){if(node.visible()){var overlayPadding=node.pstyle("overlay-padding").pfValue,overlayOpacity=node.pstyle("overlay-opacity").value,overlayColor=node.pstyle("overlay-color").value;if(overlayOpacity>0){if(pos=pos||node.position(),null==nodeWidth||null==nodeHeight){var padding=node.padding();nodeWidth=node.width()+2*padding,nodeHeight=node.height()+2*padding}this.colorFillStyle(context,overlayColor[0],overlayColor[1],overlayColor[2],overlayOpacity),this.nodeShapes.roundrectangle.draw(context,pos.x,pos.y,nodeWidth+2*overlayPadding,nodeHeight+2*overlayPadding),context.fill()}}},hasPie:function(node){return(node=node[0])._private.hasPie},drawPie:function(context,node,nodeOpacity,pos){node=node[0],pos=pos||node.position();var cyStyle=node.cy().style(),pieSize=node.pstyle("pie-size"),x=pos.x,y=pos.y,nodeW=node.width(),nodeH=node.height(),radius=Math.min(nodeW,nodeH)/2,lastPercent=0;this.usePaths()&&(x=0,y=0),"%"===pieSize.units?radius*=pieSize.pfValue:void 0!==pieSize.pfValue&&(radius=pieSize.pfValue/2);for(var i=1;i<=cyStyle.pieBackgroundN;i++){var size=node.pstyle("pie-"+i+"-background-size").value,color=node.pstyle("pie-"+i+"-background-color").value,opacity=node.pstyle("pie-"+i+"-background-opacity").value*nodeOpacity,percent=size/100;percent+lastPercent>1&&(percent=1-lastPercent);var angleStart=1.5*Math.PI+2*Math.PI*lastPercent,angleEnd=angleStart+2*Math.PI*percent;0===size||lastPercent>=1||lastPercent+percent>1||(context.beginPath(),context.moveTo(x,y),context.arc(x,y,radius,angleStart,angleEnd),context.closePath(),this.colorFillStyle(context,color[0],color[1],color[2],opacity),context.fill(),lastPercent+=percent)}}},CRp$6={};CRp$6.getPixelRatio=function(){var context=this.data.contexts[0];if(null!=this.forcedPixelRatio)return this.forcedPixelRatio;var backingStore=context.backingStorePixelRatio||context.webkitBackingStorePixelRatio||context.mozBackingStorePixelRatio||context.msBackingStorePixelRatio||context.oBackingStorePixelRatio||context.backingStorePixelRatio||1;return(window.devicePixelRatio||1)/backingStore},CRp$6.paintCache=function(context){for(var cache,caches=this.paintCaches=this.paintCaches||[],needToCreateCache=!0,i=0;i<caches.length;i++)if((cache=caches[i]).context===context){needToCreateCache=!1;break}return needToCreateCache&&(cache={context:context},caches.push(cache)),cache},CRp$6.createGradientStyleFor=function(context,shapeStyleName,ele,fill,opacity){var gradientStyle,usePaths=this.usePaths(),colors=ele.pstyle(shapeStyleName+"-gradient-stop-colors").value,positions=ele.pstyle(shapeStyleName+"-gradient-stop-positions").pfValue;if("radial-gradient"===fill)if(ele.isEdge()){var start=ele.sourceEndpoint(),end=ele.targetEndpoint(),mid=ele.midpoint(),d1=dist(start,mid),d2=dist(end,mid);gradientStyle=context.createRadialGradient(mid.x,mid.y,0,mid.x,mid.y,Math.max(d1,d2))}else{var pos=usePaths?{x:0,y:0}:ele.position(),width=ele.paddedWidth(),height=ele.paddedHeight();gradientStyle=context.createRadialGradient(pos.x,pos.y,0,pos.x,pos.y,Math.max(width,height))}else if(ele.isEdge()){var _start=ele.sourceEndpoint(),_end=ele.targetEndpoint();gradientStyle=context.createLinearGradient(_start.x,_start.y,_end.x,_end.y)}else{var _pos=usePaths?{x:0,y:0}:ele.position(),halfWidth=ele.paddedWidth()/2,halfHeight=ele.paddedHeight()/2;switch(ele.pstyle("background-gradient-direction").value){case"to-bottom":gradientStyle=context.createLinearGradient(_pos.x,_pos.y-halfHeight,_pos.x,_pos.y+halfHeight);break;case"to-top":gradientStyle=context.createLinearGradient(_pos.x,_pos.y+halfHeight,_pos.x,_pos.y-halfHeight);break;case"to-left":gradientStyle=context.createLinearGradient(_pos.x+halfWidth,_pos.y,_pos.x-halfWidth,_pos.y);break;case"to-right":gradientStyle=context.createLinearGradient(_pos.x-halfWidth,_pos.y,_pos.x+halfWidth,_pos.y);break;case"to-bottom-right":case"to-right-bottom":gradientStyle=context.createLinearGradient(_pos.x-halfWidth,_pos.y-halfHeight,_pos.x+halfWidth,_pos.y+halfHeight);break;case"to-top-right":case"to-right-top":gradientStyle=context.createLinearGradient(_pos.x-halfWidth,_pos.y+halfHeight,_pos.x+halfWidth,_pos.y-halfHeight);break;case"to-bottom-left":case"to-left-bottom":gradientStyle=context.createLinearGradient(_pos.x+halfWidth,_pos.y-halfHeight,_pos.x-halfWidth,_pos.y+halfHeight);break;case"to-top-left":case"to-left-top":gradientStyle=context.createLinearGradient(_pos.x+halfWidth,_pos.y+halfHeight,_pos.x-halfWidth,_pos.y-halfHeight)}}if(!gradientStyle)return null;for(var hasPositions=positions.length===colors.length,length=colors.length,i=0;i<length;i++)gradientStyle.addColorStop(hasPositions?positions[i]:i/(length-1),"rgba("+colors[i][0]+","+colors[i][1]+","+colors[i][2]+","+opacity+")");return gradientStyle},CRp$6.gradientFillStyle=function(context,ele,fill,opacity){var gradientStyle=this.createGradientStyleFor(context,"background",ele,fill,opacity);if(!gradientStyle)return null;context.fillStyle=gradientStyle},CRp$6.colorFillStyle=function(context,r,g,b,a){context.fillStyle="rgba("+r+","+g+","+b+","+a+")"},CRp$6.eleFillStyle=function(context,ele,opacity){var backgroundFill=ele.pstyle("background-fill").value;if("linear-gradient"===backgroundFill||"radial-gradient"===backgroundFill)this.gradientFillStyle(context,ele,backgroundFill,opacity);else{var backgroundColor=ele.pstyle("background-color").value;this.colorFillStyle(context,backgroundColor[0],backgroundColor[1],backgroundColor[2],opacity)}},CRp$6.gradientStrokeStyle=function(context,ele,fill,opacity){var gradientStyle=this.createGradientStyleFor(context,"line",ele,fill,opacity);if(!gradientStyle)return null;context.strokeStyle=gradientStyle},CRp$6.colorStrokeStyle=function(context,r,g,b,a){context.strokeStyle="rgba("+r+","+g+","+b+","+a+")"},CRp$6.eleStrokeStyle=function(context,ele,opacity){var lineFill=ele.pstyle("line-fill").value;if("linear-gradient"===lineFill||"radial-gradient"===lineFill)this.gradientStrokeStyle(context,ele,lineFill,opacity);else{var lineColor=ele.pstyle("line-color").value;this.colorStrokeStyle(context,lineColor[0],lineColor[1],lineColor[2],opacity)}},CRp$6.matchCanvasSize=function(container){var r=this,data=r.data,bb=r.findContainerClientCoords(),width=bb[2],height=bb[3],pixelRatio=r.getPixelRatio(),mbPxRatio=r.motionBlurPxRatio;container!==r.data.bufferCanvases[r.MOTIONBLUR_BUFFER_NODE]&&container!==r.data.bufferCanvases[r.MOTIONBLUR_BUFFER_DRAG]||(pixelRatio=mbPxRatio);var canvas,canvasWidth=width*pixelRatio,canvasHeight=height*pixelRatio;if(canvasWidth!==r.canvasWidth||canvasHeight!==r.canvasHeight){r.fontCaches=null;var canvasContainer=data.canvasContainer;canvasContainer.style.width=width+"px",canvasContainer.style.height=height+"px";for(var i=0;i<r.CANVAS_LAYERS;i++)(canvas=data.canvases[i]).width=canvasWidth,canvas.height=canvasHeight,canvas.style.width=width+"px",canvas.style.height=height+"px";for(i=0;i<r.BUFFER_COUNT;i++)(canvas=data.bufferCanvases[i]).width=canvasWidth,canvas.height=canvasHeight,canvas.style.width=width+"px",canvas.style.height=height+"px";r.textureMult=1,pixelRatio<=1&&(canvas=data.bufferCanvases[r.TEXTURE_BUFFER],r.textureMult=2,canvas.width=canvasWidth*r.textureMult,canvas.height=canvasHeight*r.textureMult),r.canvasWidth=canvasWidth,r.canvasHeight=canvasHeight}},CRp$6.renderTo=function(cxt,zoom,pan,pxRatio){this.render({forcedContext:cxt,forcedZoom:zoom,forcedPan:pan,drawAllLayers:!0,forcedPxRatio:pxRatio})},CRp$6.render=function(options){var forcedContext=(options=options||staticEmptyObject()).forcedContext,drawAllLayers=options.drawAllLayers,drawOnlyNodeLayer=options.drawOnlyNodeLayer,forcedZoom=options.forcedZoom,forcedPan=options.forcedPan,r=this,pixelRatio=void 0===options.forcedPxRatio?this.getPixelRatio():options.forcedPxRatio,cy=r.cy,data=r.data,needDraw=data.canvasNeedsRedraw,textureDraw=r.textureOnViewport&&!forcedContext&&(r.pinching||r.hoverData.dragging||r.swipePanning||r.data.wheelZooming),motionBlur=void 0!==options.motionBlur?options.motionBlur:r.motionBlur,mbPxRatio=r.motionBlurPxRatio,hasCompoundNodes=cy.hasCompoundNodes(),inNodeDragGesture=r.hoverData.draggingEles,inBoxSelection=!(!r.hoverData.selecting&&!r.touchData.selecting),motionBlurFadeEffect=motionBlur=motionBlur&&!forcedContext&&r.motionBlurEnabled&&!inBoxSelection;forcedContext||(r.prevPxRatio!==pixelRatio&&(r.invalidateContainerClientCoordsCache(),r.matchCanvasSize(r.container),r.redrawHint("eles",!0),r.redrawHint("drag",!0)),r.prevPxRatio=pixelRatio),!forcedContext&&r.motionBlurTimeout&&clearTimeout(r.motionBlurTimeout),motionBlur&&(null==r.mbFrames&&(r.mbFrames=0),r.mbFrames++,r.mbFrames<3&&(motionBlurFadeEffect=!1),r.mbFrames>r.minMbLowQualFrames&&(r.motionBlurPxRatio=r.mbPxRBlurry)),r.clearingMotionBlur&&(r.motionBlurPxRatio=1),r.textureDrawLastFrame&&!textureDraw&&(needDraw[r.NODE]=!0,needDraw[r.SELECT_BOX]=!0);var style=cy.style(),zoom=cy.zoom(),effectiveZoom=void 0!==forcedZoom?forcedZoom:zoom,pan=cy.pan(),effectivePan={x:pan.x,y:pan.y},vp={zoom:zoom,pan:{x:pan.x,y:pan.y}},prevVp=r.prevViewport;void 0===prevVp||vp.zoom!==prevVp.zoom||vp.pan.x!==prevVp.pan.x||vp.pan.y!==prevVp.pan.y||inNodeDragGesture&&!hasCompoundNodes||(r.motionBlurPxRatio=1),forcedPan&&(effectivePan=forcedPan),effectiveZoom*=pixelRatio,effectivePan.x*=pixelRatio,effectivePan.y*=pixelRatio;var eles=r.getCachedZSortedEles();function mbclear(context,x,y,w,h){var gco=context.globalCompositeOperation;context.globalCompositeOperation="destination-out",r.colorFillStyle(context,255,255,255,r.motionBlurTransparency),context.fillRect(x,y,w,h),context.globalCompositeOperation=gco}function setContextTransform(context,clear){var ePan,eZoom,w,h;r.clearingMotionBlur||context!==data.bufferContexts[r.MOTIONBLUR_BUFFER_NODE]&&context!==data.bufferContexts[r.MOTIONBLUR_BUFFER_DRAG]?(ePan=effectivePan,eZoom=effectiveZoom,w=r.canvasWidth,h=r.canvasHeight):(ePan={x:pan.x*mbPxRatio,y:pan.y*mbPxRatio},eZoom=zoom*mbPxRatio,w=r.canvasWidth*mbPxRatio,h=r.canvasHeight*mbPxRatio),context.setTransform(1,0,0,1,0,0),"motionBlur"===clear?mbclear(context,0,0,w,h):forcedContext||void 0!==clear&&!clear||context.clearRect(0,0,w,h),drawAllLayers||(context.translate(ePan.x,ePan.y),context.scale(eZoom,eZoom)),forcedPan&&context.translate(forcedPan.x,forcedPan.y),forcedZoom&&context.scale(forcedZoom,forcedZoom)}if(textureDraw||(r.textureDrawLastFrame=!1),textureDraw){if(r.textureDrawLastFrame=!0,!r.textureCache){r.textureCache={},r.textureCache.bb=cy.mutableElements().boundingBox(),r.textureCache.texture=r.data.bufferCanvases[r.TEXTURE_BUFFER];var cxt=r.data.bufferContexts[r.TEXTURE_BUFFER];cxt.setTransform(1,0,0,1,0,0),cxt.clearRect(0,0,r.canvasWidth*r.textureMult,r.canvasHeight*r.textureMult),r.render({forcedContext:cxt,drawOnlyNodeLayer:!0,forcedPxRatio:pixelRatio*r.textureMult}),(vp=r.textureCache.viewport={zoom:cy.zoom(),pan:cy.pan(),width:r.canvasWidth,height:r.canvasHeight}).mpan={x:(0-vp.pan.x)/vp.zoom,y:(0-vp.pan.y)/vp.zoom}}needDraw[r.DRAG]=!1,needDraw[r.NODE]=!1;var context=data.contexts[r.NODE],texture=r.textureCache.texture;vp=r.textureCache.viewport;context.setTransform(1,0,0,1,0,0),motionBlur?mbclear(context,0,0,vp.width,vp.height):context.clearRect(0,0,vp.width,vp.height);var outsideBgColor=style.core("outside-texture-bg-color").value,outsideBgOpacity=style.core("outside-texture-bg-opacity").value;r.colorFillStyle(context,outsideBgColor[0],outsideBgColor[1],outsideBgColor[2],outsideBgOpacity),context.fillRect(0,0,vp.width,vp.height);zoom=cy.zoom();setContextTransform(context,!1),context.clearRect(vp.mpan.x,vp.mpan.y,vp.width/vp.zoom/pixelRatio,vp.height/vp.zoom/pixelRatio),context.drawImage(texture,vp.mpan.x,vp.mpan.y,vp.width/vp.zoom/pixelRatio,vp.height/vp.zoom/pixelRatio)}else r.textureOnViewport&&!forcedContext&&(r.textureCache=null);var extent=cy.extent(),vpManip=r.pinching||r.hoverData.dragging||r.swipePanning||r.data.wheelZooming||r.hoverData.draggingEles||r.cy.animated(),hideEdges=r.hideEdgesOnViewport&&vpManip,needMbClear=[];if(needMbClear[r.NODE]=!needDraw[r.NODE]&&motionBlur&&!r.clearedForMotionBlur[r.NODE]||r.clearingMotionBlur,needMbClear[r.NODE]&&(r.clearedForMotionBlur[r.NODE]=!0),needMbClear[r.DRAG]=!needDraw[r.DRAG]&&motionBlur&&!r.clearedForMotionBlur[r.DRAG]||r.clearingMotionBlur,needMbClear[r.DRAG]&&(r.clearedForMotionBlur[r.DRAG]=!0),needDraw[r.NODE]||drawAllLayers||drawOnlyNodeLayer||needMbClear[r.NODE]){var useBuffer=motionBlur&&!needMbClear[r.NODE]&&1!==mbPxRatio;setContextTransform(context=forcedContext||(useBuffer?r.data.bufferContexts[r.MOTIONBLUR_BUFFER_NODE]:data.contexts[r.NODE]),motionBlur&&!useBuffer?"motionBlur":void 0),hideEdges?r.drawCachedNodes(context,eles.nondrag,pixelRatio,extent):r.drawLayeredElements(context,eles.nondrag,pixelRatio,extent),r.debug&&r.drawDebugPoints(context,eles.nondrag),drawAllLayers||motionBlur||(needDraw[r.NODE]=!1)}if(!drawOnlyNodeLayer&&(needDraw[r.DRAG]||drawAllLayers||needMbClear[r.DRAG])){useBuffer=motionBlur&&!needMbClear[r.DRAG]&&1!==mbPxRatio;setContextTransform(context=forcedContext||(useBuffer?r.data.bufferContexts[r.MOTIONBLUR_BUFFER_DRAG]:data.contexts[r.DRAG]),motionBlur&&!useBuffer?"motionBlur":void 0),hideEdges?r.drawCachedNodes(context,eles.drag,pixelRatio,extent):r.drawCachedElements(context,eles.drag,pixelRatio,extent),r.debug&&r.drawDebugPoints(context,eles.drag),drawAllLayers||motionBlur||(needDraw[r.DRAG]=!1)}if(r.showFps||!drawOnlyNodeLayer&&needDraw[r.SELECT_BOX]&&!drawAllLayers){if(setContextTransform(context=forcedContext||data.contexts[r.SELECT_BOX]),1==r.selection[4]&&(r.hoverData.selecting||r.touchData.selecting)){zoom=r.cy.zoom();var borderWidth=style.core("selection-box-border-width").value/zoom;context.lineWidth=borderWidth,context.fillStyle="rgba("+style.core("selection-box-color").value[0]+","+style.core("selection-box-color").value[1]+","+style.core("selection-box-color").value[2]+","+style.core("selection-box-opacity").value+")",context.fillRect(r.selection[0],r.selection[1],r.selection[2]-r.selection[0],r.selection[3]-r.selection[1]),borderWidth>0&&(context.strokeStyle="rgba("+style.core("selection-box-border-color").value[0]+","+style.core("selection-box-border-color").value[1]+","+style.core("selection-box-border-color").value[2]+","+style.core("selection-box-opacity").value+")",context.strokeRect(r.selection[0],r.selection[1],r.selection[2]-r.selection[0],r.selection[3]-r.selection[1]))}if(data.bgActivePosistion&&!r.hoverData.selecting){zoom=r.cy.zoom();var pos=data.bgActivePosistion;context.fillStyle="rgba("+style.core("active-bg-color").value[0]+","+style.core("active-bg-color").value[1]+","+style.core("active-bg-color").value[2]+","+style.core("active-bg-opacity").value+")",context.beginPath(),context.arc(pos.x,pos.y,style.core("active-bg-size").pfValue/zoom,0,2*Math.PI),context.fill()}var timeToRender=r.lastRedrawTime;if(r.showFps&&timeToRender){timeToRender=Math.round(timeToRender);var fps=Math.round(1e3/timeToRender);context.setTransform(1,0,0,1,0,0),context.fillStyle="rgba(255, 0, 0, 0.75)",context.strokeStyle="rgba(255, 0, 0, 0.75)",context.lineWidth=1,context.fillText("1 frame = "+timeToRender+" ms = "+fps+" fps",0,20);context.strokeRect(0,30,250,20),context.fillRect(0,30,250*Math.min(fps/60,1),20)}drawAllLayers||(needDraw[r.SELECT_BOX]=!1)}if(motionBlur&&1!==mbPxRatio){var cxtNode=data.contexts[r.NODE],txtNode=r.data.bufferCanvases[r.MOTIONBLUR_BUFFER_NODE],cxtDrag=data.contexts[r.DRAG],txtDrag=r.data.bufferCanvases[r.MOTIONBLUR_BUFFER_DRAG],drawMotionBlur=function(cxt,txt,needClear){cxt.setTransform(1,0,0,1,0,0),needClear||!motionBlurFadeEffect?cxt.clearRect(0,0,r.canvasWidth,r.canvasHeight):mbclear(cxt,0,0,r.canvasWidth,r.canvasHeight);var pxr=mbPxRatio;cxt.drawImage(txt,0,0,r.canvasWidth*pxr,r.canvasHeight*pxr,0,0,r.canvasWidth,r.canvasHeight)};(needDraw[r.NODE]||needMbClear[r.NODE])&&(drawMotionBlur(cxtNode,txtNode,needMbClear[r.NODE]),needDraw[r.NODE]=!1),(needDraw[r.DRAG]||needMbClear[r.DRAG])&&(drawMotionBlur(cxtDrag,txtDrag,needMbClear[r.DRAG]),needDraw[r.DRAG]=!1)}r.prevViewport=vp,r.clearingMotionBlur&&(r.clearingMotionBlur=!1,r.motionBlurCleared=!0,r.motionBlur=!0),motionBlur&&(r.motionBlurTimeout=setTimeout((function(){r.motionBlurTimeout=null,r.clearedForMotionBlur[r.NODE]=!1,r.clearedForMotionBlur[r.DRAG]=!1,r.motionBlur=!1,r.clearingMotionBlur=!textureDraw,r.mbFrames=0,needDraw[r.NODE]=!0,needDraw[r.DRAG]=!0,r.redraw()}),100)),forcedContext||cy.emit("render")};for(var CRp$7={drawPolygonPath:function(context,x,y,width,height,points){var halfW=width/2,halfH=height/2;context.beginPath&&context.beginPath(),context.moveTo(x+halfW*points[0],y+halfH*points[1]);for(var i=1;i<points.length/2;i++)context.lineTo(x+halfW*points[2*i],y+halfH*points[2*i+1]);context.closePath()},drawRoundRectanglePath:function(context,x,y,width,height){var halfWidth=width/2,halfHeight=height/2,cornerRadius=getRoundRectangleRadius(width,height);context.beginPath&&context.beginPath(),context.moveTo(x,y-halfHeight),context.arcTo(x+halfWidth,y-halfHeight,x+halfWidth,y,cornerRadius),context.arcTo(x+halfWidth,y+halfHeight,x,y+halfHeight,cornerRadius),context.arcTo(x-halfWidth,y+halfHeight,x-halfWidth,y,cornerRadius),context.arcTo(x-halfWidth,y-halfHeight,x,y-halfHeight,cornerRadius),context.lineTo(x,y-halfHeight),context.closePath()},drawBottomRoundRectanglePath:function(context,x,y,width,height){var halfWidth=width/2,halfHeight=height/2,cornerRadius=getRoundRectangleRadius(width,height);context.beginPath&&context.beginPath(),context.moveTo(x,y-halfHeight),context.lineTo(x+halfWidth,y-halfHeight),context.lineTo(x+halfWidth,y),context.arcTo(x+halfWidth,y+halfHeight,x,y+halfHeight,cornerRadius),context.arcTo(x-halfWidth,y+halfHeight,x-halfWidth,y,cornerRadius),context.lineTo(x-halfWidth,y-halfHeight),context.lineTo(x,y-halfHeight),context.closePath()},drawCutRectanglePath:function(context,x,y,width,height){var halfWidth=width/2,halfHeight=height/2;context.beginPath&&context.beginPath(),context.moveTo(x-halfWidth+8,y-halfHeight),context.lineTo(x+halfWidth-8,y-halfHeight),context.lineTo(x+halfWidth,y-halfHeight+8),context.lineTo(x+halfWidth,y+halfHeight-8),context.lineTo(x+halfWidth-8,y+halfHeight),context.lineTo(x-halfWidth+8,y+halfHeight),context.lineTo(x-halfWidth,y+halfHeight-8),context.lineTo(x-halfWidth,y-halfHeight+8),context.closePath()},drawBarrelPath:function(context,x,y,width,height){var halfWidth=width/2,halfHeight=height/2,xBegin=x-halfWidth,xEnd=x+halfWidth,yBegin=y-halfHeight,yEnd=y+halfHeight,barrelCurveConstants=getBarrelCurveConstants(width,height),wOffset=barrelCurveConstants.widthOffset,hOffset=barrelCurveConstants.heightOffset,ctrlPtXOffset=barrelCurveConstants.ctrlPtOffsetPct*wOffset;context.beginPath&&context.beginPath(),context.moveTo(xBegin,yBegin+hOffset),context.lineTo(xBegin,yEnd-hOffset),context.quadraticCurveTo(xBegin+ctrlPtXOffset,yEnd,xBegin+wOffset,yEnd),context.lineTo(xEnd-wOffset,yEnd),context.quadraticCurveTo(xEnd-ctrlPtXOffset,yEnd,xEnd,yEnd-hOffset),context.lineTo(xEnd,yBegin+hOffset),context.quadraticCurveTo(xEnd-ctrlPtXOffset,yBegin,xEnd-wOffset,yBegin),context.lineTo(xBegin+wOffset,yBegin),context.quadraticCurveTo(xBegin+ctrlPtXOffset,yBegin,xBegin,yBegin+hOffset),context.closePath()}},sin0=Math.sin(0),cos0=Math.cos(0),sin={},cos={},ellipseStepSize=Math.PI/40,i=0*Math.PI;i<2*Math.PI;i+=ellipseStepSize)sin[i]=Math.sin(i),cos[i]=Math.cos(i);CRp$7.drawEllipsePath=function(context,centerX,centerY,width,height){if(context.beginPath&&context.beginPath(),context.ellipse)context.ellipse(centerX,centerY,width/2,height/2,0,0,2*Math.PI);else for(var xPos,yPos,rw=width/2,rh=height/2,i=0*Math.PI;i<2*Math.PI;i+=ellipseStepSize)xPos=centerX-rw*sin[i]*sin0+rw*cos[i]*cos0,yPos=centerY+rh*cos[i]*sin0+rh*sin[i]*cos0,0===i?context.moveTo(xPos,yPos):context.lineTo(xPos,yPos);context.closePath()};var CRp$8={};function b64UriToB64(b64uri){var i=b64uri.indexOf(",");return b64uri.substr(i+1)}function output(options,canvas,mimeType){var getB64Uri=function(){return canvas.toDataURL(mimeType,options.quality)};switch(options.output){case"blob-promise":return new Promise$1((function(resolve,reject){try{canvas.toBlob((function(blob){null!=blob?resolve(blob):reject(new Error("`canvas.toBlob()` sent a null value in its callback"))}),mimeType,options.quality)}catch(err){reject(err)}}));case"blob":return function(b64,mimeType){for(var bytes=atob(b64),buff=new ArrayBuffer(bytes.length),buffUint8=new Uint8Array(buff),i=0;i<bytes.length;i++)buffUint8[i]=bytes.charCodeAt(i);return new Blob([buff],{type:mimeType})}(b64UriToB64(getB64Uri()),mimeType);case"base64":return b64UriToB64(getB64Uri());case"base64uri":default:return getB64Uri()}}CRp$8.createBuffer=function(w,h){var buffer=document.createElement("canvas");return buffer.width=w,buffer.height=h,[buffer,buffer.getContext("2d")]},CRp$8.bufferCanvasImage=function(options){var cy=this.cy,bb=cy.mutableElements().boundingBox(),ctrRect=this.findContainerClientCoords(),width=options.full?Math.ceil(bb.w):ctrRect[2],height=options.full?Math.ceil(bb.h):ctrRect[3],specdMaxDims=number(options.maxWidth)||number(options.maxHeight),pxRatio=this.getPixelRatio(),scale=1;if(void 0!==options.scale)width*=options.scale,height*=options.scale,scale=options.scale;else if(specdMaxDims){var maxScaleW=1/0,maxScaleH=1/0;number(options.maxWidth)&&(maxScaleW=scale*options.maxWidth/width),number(options.maxHeight)&&(maxScaleH=scale*options.maxHeight/height),width*=scale=Math.min(maxScaleW,maxScaleH),height*=scale}specdMaxDims||(width*=pxRatio,height*=pxRatio,scale*=pxRatio);var buffCanvas=document.createElement("canvas");buffCanvas.width=width,buffCanvas.height=height,buffCanvas.style.width=width+"px",buffCanvas.style.height=height+"px";var buffCxt=buffCanvas.getContext("2d");if(width>0&&height>0){buffCxt.clearRect(0,0,width,height),buffCxt.globalCompositeOperation="source-over";var zsortedEles=this.getCachedZSortedEles();if(options.full)buffCxt.translate(-bb.x1*scale,-bb.y1*scale),buffCxt.scale(scale,scale),this.drawElements(buffCxt,zsortedEles),buffCxt.scale(1/scale,1/scale),buffCxt.translate(bb.x1*scale,bb.y1*scale);else{var pan=cy.pan(),translation={x:pan.x*scale,y:pan.y*scale};scale*=cy.zoom(),buffCxt.translate(translation.x,translation.y),buffCxt.scale(scale,scale),this.drawElements(buffCxt,zsortedEles),buffCxt.scale(1/scale,1/scale),buffCxt.translate(-translation.x,-translation.y)}options.bg&&(buffCxt.globalCompositeOperation="destination-over",buffCxt.fillStyle=options.bg,buffCxt.rect(0,0,width,height),buffCxt.fill())}return buffCanvas},CRp$8.png=function(options){return output(options,this.bufferCanvasImage(options),"image/png")},CRp$8.jpg=function(options){return output(options,this.bufferCanvasImage(options),"image/jpeg")};var CRp$9={nodeShapeImpl:function(name,context,centerX,centerY,width,height,points){switch(name){case"ellipse":return this.drawEllipsePath(context,centerX,centerY,width,height);case"polygon":return this.drawPolygonPath(context,centerX,centerY,width,height,points);case"roundrectangle":case"round-rectangle":return this.drawRoundRectanglePath(context,centerX,centerY,width,height);case"cutrectangle":case"cut-rectangle":return this.drawCutRectanglePath(context,centerX,centerY,width,height);case"bottomroundrectangle":case"bottom-round-rectangle":return this.drawBottomRoundRectanglePath(context,centerX,centerY,width,height);case"barrel":return this.drawBarrelPath(context,centerX,centerY,width,height)}}},CR=CanvasRenderer,CRp$a=CanvasRenderer.prototype;function CanvasRenderer(options){var r=this;r.data={canvases:new Array(CRp$a.CANVAS_LAYERS),contexts:new Array(CRp$a.CANVAS_LAYERS),canvasNeedsRedraw:new Array(CRp$a.CANVAS_LAYERS),bufferCanvases:new Array(CRp$a.BUFFER_COUNT),bufferContexts:new Array(CRp$a.CANVAS_LAYERS)};r.data.canvasContainer=document.createElement("div");var containerStyle=r.data.canvasContainer.style;r.data.canvasContainer.style["-webkit-tap-highlight-color"]="rgba(0,0,0,0)",containerStyle.position="relative",containerStyle.zIndex="0",containerStyle.overflow="hidden";var container=options.cy.container();container.appendChild(r.data.canvasContainer),container.style["-webkit-tap-highlight-color"]="rgba(0,0,0,0)";var styleMap={"-webkit-user-select":"none","-moz-user-select":"-moz-none","user-select":"none","-webkit-tap-highlight-color":"rgba(0,0,0,0)","outline-style":"none"};navigator&&navigator.userAgent.match(/msie|trident|edge/i)&&(styleMap["-ms-touch-action"]="none",styleMap["touch-action"]="none");for(var i=0;i<CRp$a.CANVAS_LAYERS;i++){var canvas=r.data.canvases[i]=document.createElement("canvas");r.data.contexts[i]=canvas.getContext("2d"),Object.keys(styleMap).forEach((function(k){canvas.style[k]=styleMap[k]})),canvas.style.position="absolute",canvas.setAttribute("data-id","layer"+i),canvas.style.zIndex=String(CRp$a.CANVAS_LAYERS-i),r.data.canvasContainer.appendChild(canvas),r.data.canvasNeedsRedraw[i]=!1}r.data.topCanvas=r.data.canvases[0],r.data.canvases[CRp$a.NODE].setAttribute("data-id","layer"+CRp$a.NODE+"-node"),r.data.canvases[CRp$a.SELECT_BOX].setAttribute("data-id","layer"+CRp$a.SELECT_BOX+"-selectbox"),r.data.canvases[CRp$a.DRAG].setAttribute("data-id","layer"+CRp$a.DRAG+"-drag");for(i=0;i<CRp$a.BUFFER_COUNT;i++)r.data.bufferCanvases[i]=document.createElement("canvas"),r.data.bufferContexts[i]=r.data.bufferCanvases[i].getContext("2d"),r.data.bufferCanvases[i].style.position="absolute",r.data.bufferCanvases[i].setAttribute("data-id","buffer"+i),r.data.bufferCanvases[i].style.zIndex=String(-i-1),r.data.bufferCanvases[i].style.visibility="hidden";r.pathsEnabled=!0;var emptyBb=makeBoundingBox(),getCenterOffset=function(bb){return{x:-bb.w/2,y:-bb.h/2}},getElementBox=function(ele){return ele.boundingBox(),ele[0]._private.bodyBounds},getLabelBox=function(ele){return ele.boundingBox(),ele[0]._private.labelBounds.main||emptyBb},getSourceLabelBox=function(ele){return ele.boundingBox(),ele[0]._private.labelBounds.source||emptyBb},getTargetLabelBox=function(ele){return ele.boundingBox(),ele[0]._private.labelBounds.target||emptyBb},isLabelVisibleAtScale=function(ele,scaledLabelShown){return scaledLabelShown},addTextMargin=function(pt,ele){return{x:pt.x+ele.pstyle("text-margin-x").pfValue,y:pt.y+ele.pstyle("text-margin-y").pfValue}},getRsPt=function(ele,x,y){var rs=ele[0]._private.rscratch;return{x:rs[x],y:rs[y]}},eleTxrCache=r.data.eleTxrCache=new ElementTextureCache(r,{getKey:function(ele){return ele[0]._private.nodeKey},doesEleInvalidateKey:function(ele){var _p=ele[0]._private;return!(_p.oldBackgroundTimestamp===_p.backgroundTimestamp)},drawElement:function(context,ele,bb,scaledLabelShown,useEleOpacity){return r.drawElement(context,ele,bb,!1,!1,useEleOpacity)},getBoundingBox:getElementBox,getRotationPoint:function(ele){return{x:((bb=getElementBox(ele)).x1+bb.x2)/2,y:(bb.y1+bb.y2)/2};var bb},getRotationOffset:function(ele){return getCenterOffset(getElementBox(ele))},allowEdgeTxrCaching:!1,allowParentTxrCaching:!1}),lblTxrCache=r.data.lblTxrCache=new ElementTextureCache(r,{getKey:function(ele){return ele[0]._private.labelStyleKey},drawElement:function(context,ele,bb,scaledLabelShown,useEleOpacity){return r.drawElementText(context,ele,bb,scaledLabelShown,"main",useEleOpacity)},getBoundingBox:getLabelBox,getRotationPoint:function(ele){return addTextMargin(getRsPt(ele,"labelX","labelY"),ele)},getRotationOffset:function(ele){var bb=getLabelBox(ele),p=getCenterOffset(getLabelBox(ele));if(ele.isNode()){switch(ele.pstyle("text-halign").value){case"left":p.x=-bb.w;break;case"right":p.x=0}switch(ele.pstyle("text-valign").value){case"top":p.y=-bb.h;break;case"bottom":p.y=0}}return p},isVisible:isLabelVisibleAtScale}),slbTxrCache=r.data.slbTxrCache=new ElementTextureCache(r,{getKey:function(ele){return ele[0]._private.sourceLabelStyleKey},drawElement:function(context,ele,bb,scaledLabelShown,useEleOpacity){return r.drawElementText(context,ele,bb,scaledLabelShown,"source",useEleOpacity)},getBoundingBox:getSourceLabelBox,getRotationPoint:function(ele){return addTextMargin(getRsPt(ele,"sourceLabelX","sourceLabelY"),ele)},getRotationOffset:function(ele){return getCenterOffset(getSourceLabelBox(ele))},isVisible:isLabelVisibleAtScale}),tlbTxrCache=r.data.tlbTxrCache=new ElementTextureCache(r,{getKey:function(ele){return ele[0]._private.targetLabelStyleKey},drawElement:function(context,ele,bb,scaledLabelShown,useEleOpacity){return r.drawElementText(context,ele,bb,scaledLabelShown,"target",useEleOpacity)},getBoundingBox:getTargetLabelBox,getRotationPoint:function(ele){return addTextMargin(getRsPt(ele,"targetLabelX","targetLabelY"),ele)},getRotationOffset:function(ele){return getCenterOffset(getTargetLabelBox(ele))},isVisible:isLabelVisibleAtScale}),lyrTxrCache=r.data.lyrTxrCache=new LayeredTextureCache(r);r.onUpdateEleCalcs((function(willDraw,eles){eleTxrCache.invalidateElements(eles),lblTxrCache.invalidateElements(eles),slbTxrCache.invalidateElements(eles),tlbTxrCache.invalidateElements(eles),lyrTxrCache.invalidateElements(eles);for(var _i=0;_i<eles.length;_i++){var _p=eles[_i]._private;_p.oldBackgroundTimestamp=_p.backgroundTimestamp}}));var refineInLayers=function(reqs){for(var i=0;i<reqs.length;i++)lyrTxrCache.enqueueElementRefinement(reqs[i].ele)};eleTxrCache.onDequeue(refineInLayers),lblTxrCache.onDequeue(refineInLayers),slbTxrCache.onDequeue(refineInLayers),tlbTxrCache.onDequeue(refineInLayers)}CRp$a.CANVAS_LAYERS=3,CRp$a.SELECT_BOX=0,CRp$a.DRAG=1,CRp$a.NODE=2,CRp$a.BUFFER_COUNT=3,CRp$a.TEXTURE_BUFFER=0,CRp$a.MOTIONBLUR_BUFFER_NODE=1,CRp$a.MOTIONBLUR_BUFFER_DRAG=2,CRp$a.redrawHint=function(group,bool){var r=this;switch(group){case"eles":r.data.canvasNeedsRedraw[CRp$a.NODE]=bool;break;case"drag":r.data.canvasNeedsRedraw[CRp$a.DRAG]=bool;break;case"select":r.data.canvasNeedsRedraw[CRp$a.SELECT_BOX]=bool}};var pathsImpld="undefined"!=typeof Path2D;CRp$a.path2dEnabled=function(on){if(void 0===on)return this.pathsEnabled;this.pathsEnabled=!!on},CRp$a.usePaths=function(){return pathsImpld&&this.pathsEnabled},CRp$a.setImgSmoothing=function(context,bool){null!=context.imageSmoothingEnabled?context.imageSmoothingEnabled=bool:(context.webkitImageSmoothingEnabled=bool,context.mozImageSmoothingEnabled=bool,context.msImageSmoothingEnabled=bool)},CRp$a.getImgSmoothing=function(context){return null!=context.imageSmoothingEnabled?context.imageSmoothingEnabled:context.webkitImageSmoothingEnabled||context.mozImageSmoothingEnabled||context.msImageSmoothingEnabled},CRp$a.makeOffscreenCanvas=function(width,height){var canvas;return"undefined"!==("undefined"==typeof OffscreenCanvas?"undefined":_typeof(OffscreenCanvas))?canvas=new OffscreenCanvas(width,height):((canvas=document.createElement("canvas")).width=width,canvas.height=height),canvas},[CRp,CRp$1,CRp$2,CRp$3,CRp$4,CRp$5,CRp$6,CRp$7,CRp$8,CRp$9].forEach((function(props){extend(CRp$a,props)}));var incExts=[{type:"layout",extensions:layout},{type:"renderer",extensions:[{name:"null",impl:NullRenderer},{name:"base",impl:BR},{name:"canvas",impl:CR}]}],extensions={},modules={};function setExtension(type,name,registrant){var ext=registrant,overrideErr=function(field){error("Can not register `"+name+"` for `"+type+"` since `"+field+"` already exists in the prototype and can not be overridden")};if("core"===type){if(Core.prototype[name])return overrideErr(name);Core.prototype[name]=registrant}else if("collection"===type){if(Collection.prototype[name])return overrideErr(name);Collection.prototype[name]=registrant}else if("layout"===type){for(var Layout=function(options){this.options=options,registrant.call(this,options),plainObject(this._private)||(this._private={}),this._private.cy=options.cy,this._private.listeners=[],this.createEmitter()},layoutProto=Layout.prototype=Object.create(registrant.prototype),optLayoutFns=[],i=0;i<optLayoutFns.length;i++){var fnName=optLayoutFns[i];layoutProto[fnName]=layoutProto[fnName]||function(){return this}}layoutProto.start&&!layoutProto.run?layoutProto.run=function(){return this.start(),this}:!layoutProto.start&&layoutProto.run&&(layoutProto.start=function(){return this.run(),this});var regStop=registrant.prototype.stop;layoutProto.stop=function(){var opts=this.options;if(opts&&opts.animate){var anis=this.animations;if(anis)for(var _i=0;_i<anis.length;_i++)anis[_i].stop()}return regStop?regStop.call(this):this.emit("layoutstop"),this},layoutProto.destroy||(layoutProto.destroy=function(){return this}),layoutProto.cy=function(){return this._private.cy};var getCy=function(layout){return layout._private.cy},emitterOpts={addEventFields:function(layout,evt){evt.layout=layout,evt.cy=getCy(layout),evt.target=layout},bubble:function(){return!0},parent:function(layout){return getCy(layout)}};extend(layoutProto,{createEmitter:function(){return this._private.emitter=new Emitter(emitterOpts,this),this},emitter:function(){return this._private.emitter},on:function(evt,cb){return this.emitter().on(evt,cb),this},one:function(evt,cb){return this.emitter().one(evt,cb),this},once:function(evt,cb){return this.emitter().one(evt,cb),this},removeListener:function(evt,cb){return this.emitter().removeListener(evt,cb),this},removeAllListeners:function(){return this.emitter().removeAllListeners(),this},emit:function(evt,params){return this.emitter().emit(evt,params),this}}),define$3.eventAliasesOn(layoutProto),ext=Layout}else if("renderer"===type&&"null"!==name&&"base"!==name){var BaseRenderer=getExtension("renderer","base"),bProto=BaseRenderer.prototype,RegistrantRenderer=registrant,rProto=registrant.prototype,Renderer=function(){BaseRenderer.apply(this,arguments),RegistrantRenderer.apply(this,arguments)},proto=Renderer.prototype;for(var pName in bProto){var pVal=bProto[pName];if(null!=rProto[pName])return overrideErr(pName);proto[pName]=pVal}for(var _pName in rProto)proto[_pName]=rProto[_pName];bProto.clientFunctions.forEach((function(name){proto[name]=proto[name]||function(){error("Renderer does not implement `renderer."+name+"()` on its prototype")}})),ext=Renderer}return setMap({map:extensions,keys:[type,name],value:ext})}function getExtension(type,name){return getMap({map:extensions,keys:[type,name]})}function setModule(type,name,moduleType,moduleName,registrant){return setMap({map:modules,keys:[type,name,moduleType,moduleName],value:registrant})}function getModule(type,name,moduleType,moduleName){return getMap({map:modules,keys:[type,name,moduleType,moduleName]})}var extension=function(){return 2===arguments.length?getExtension.apply(null,arguments):3===arguments.length?setExtension.apply(null,arguments):4===arguments.length?getModule.apply(null,arguments):5===arguments.length?setModule.apply(null,arguments):void error("Invalid extension access syntax")};Core.prototype.extension=extension,incExts.forEach((function(group){group.extensions.forEach((function(ext){setExtension(group.type,ext.name,ext.impl)}))}));var Stylesheet=function Stylesheet(){if(!(this instanceof Stylesheet))return new Stylesheet;this.length=0},sheetfn=Stylesheet.prototype;sheetfn.instanceString=function(){return"stylesheet"},sheetfn.selector=function(selector){return this[this.length++]={selector:selector,properties:[]},this},sheetfn.css=function(name,value){var i=this.length-1;if(string(name))this[i].properties.push({name:name,value:value});else if(plainObject(name))for(var map=name,propNames=Object.keys(map),j=0;j<propNames.length;j++){var key=propNames[j],mapVal=map[key];if(null!=mapVal){var prop=Style.properties[key]||Style.properties[dash2camel(key)];if(null!=prop){var _name=prop.name,_value=mapVal;this[i].properties.push({name:_name,value:_value})}}}return this},sheetfn.style=sheetfn.css,sheetfn.generateStyle=function(cy){var style=new Style(cy);return this.appendToStyle(style)},sheetfn.appendToStyle=function(style){for(var i=0;i<this.length;i++){var context=this[i],selector=context.selector,props=context.properties;style.selector(selector);for(var j=0;j<props.length;j++){var prop=props[j];style.css(prop.name,prop.value)}}return style};var cytoscape=function(options){return void 0===options&&(options={}),plainObject(options)?new Core(options):string(options)?extension.apply(extension,arguments):void 0};cytoscape.use=function(ext){var args=Array.prototype.slice.call(arguments,1);return args.unshift(cytoscape),ext.apply(null,args),this},cytoscape.warnings=function(bool){return warnings(bool)},cytoscape.version="3.10.0",cytoscape.stylesheet=cytoscape.Stylesheet=Stylesheet,module.exports=cytoscape}).call(this,__webpack_require__(514).setImmediate)},function(module,exports,__webpack_require__){(function(global){var apply=Function.prototype.apply;function Timeout(id,clearFn){this._id=id,this._clearFn=clearFn}exports.setTimeout=function(){return new Timeout(apply.call(setTimeout,window,arguments),clearTimeout)},exports.setInterval=function(){return new Timeout(apply.call(setInterval,window,arguments),clearInterval)},exports.clearTimeout=exports.clearInterval=function(timeout){timeout&&timeout.close()},Timeout.prototype.unref=Timeout.prototype.ref=function(){},Timeout.prototype.close=function(){this._clearFn.call(window,this._id)},exports.enroll=function(item,msecs){clearTimeout(item._idleTimeoutId),item._idleTimeout=msecs},exports.unenroll=function(item){clearTimeout(item._idleTimeoutId),item._idleTimeout=-1},exports._unrefActive=exports.active=function(item){clearTimeout(item._idleTimeoutId);var msecs=item._idleTimeout;msecs>=0&&(item._idleTimeoutId=setTimeout((function(){item._onTimeout&&item._onTimeout()}),msecs))},__webpack_require__(515),exports.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==global&&global.setImmediate||this&&this.setImmediate,exports.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==global&&global.clearImmediate||this&&this.clearImmediate}).call(this,__webpack_require__(117))},function(module,exports,__webpack_require__){(function(global,process){!function(global,undefined){"use strict";if(!global.setImmediate){var registerImmediate,html,channel,messagePrefix,onGlobalMessage,nextHandle=1,tasksByHandle={},currentlyRunningATask=!1,doc=global.document,attachTo=Object.getPrototypeOf&&Object.getPrototypeOf(global);attachTo=attachTo&&attachTo.setTimeout?attachTo:global,"[object process]"==={}.toString.call(global.process)?registerImmediate=function(handle){process.nextTick((function(){runIfPresent(handle)}))}:!function(){if(global.postMessage&&!global.importScripts){var postMessageIsAsynchronous=!0,oldOnMessage=global.onmessage;return global.onmessage=function(){postMessageIsAsynchronous=!1},global.postMessage("","*"),global.onmessage=oldOnMessage,postMessageIsAsynchronous}}()?global.MessageChannel?((channel=new MessageChannel).port1.onmessage=function(event){runIfPresent(event.data)},registerImmediate=function(handle){channel.port2.postMessage(handle)}):doc&&"onreadystatechange"in doc.createElement("script")?(html=doc.documentElement,registerImmediate=function(handle){var script=doc.createElement("script");script.onreadystatechange=function(){runIfPresent(handle),script.onreadystatechange=null,html.removeChild(script),script=null},html.appendChild(script)}):registerImmediate=function(handle){setTimeout(runIfPresent,0,handle)}:(messagePrefix="setImmediate$"+Math.random()+"$",onGlobalMessage=function(event){event.source===global&&"string"==typeof event.data&&0===event.data.indexOf(messagePrefix)&&runIfPresent(+event.data.slice(messagePrefix.length))},global.addEventListener?global.addEventListener("message",onGlobalMessage,!1):global.attachEvent("onmessage",onGlobalMessage),registerImmediate=function(handle){global.postMessage(messagePrefix+handle,"*")}),attachTo.setImmediate=function(callback){"function"!=typeof callback&&(callback=new Function(""+callback));for(var args=new Array(arguments.length-1),i=0;i<args.length;i++)args[i]=arguments[i+1];var task={callback:callback,args:args};return tasksByHandle[nextHandle]=task,registerImmediate(nextHandle),nextHandle++},attachTo.clearImmediate=clearImmediate}function clearImmediate(handle){delete tasksByHandle[handle]}function runIfPresent(handle){if(currentlyRunningATask)setTimeout(runIfPresent,0,handle);else{var task=tasksByHandle[handle];if(task){currentlyRunningATask=!0;try{!function(task){var callback=task.callback,args=task.args;switch(args.length){case 0:callback();break;case 1:callback(args[0]);break;case 2:callback(args[0],args[1]);break;case 3:callback(args[0],args[1],args[2]);break;default:callback.apply(void 0,args)}}(task)}finally{clearImmediate(handle),currentlyRunningATask=!1}}}}}("undefined"==typeof self?void 0===global?this:global:self)}).call(this,__webpack_require__(117),__webpack_require__(233))},function(module,exports,__webpack_require__){(function(global){var reTrim=/^\s+|\s+$/g,reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsOctal=/^0o[0-7]+$/i,freeParseInt=parseInt,freeGlobal="object"==typeof global&&global&&global.Object===Object&&global,freeSelf="object"==typeof self&&self&&self.Object===Object&&self,root=freeGlobal||freeSelf||Function("return this")(),objectToString=Object.prototype.toString,nativeMax=Math.max,nativeMin=Math.min,now=function(){return root.Date.now()};function isObject(value){var type=typeof value;return!!value&&("object"==type||"function"==type)}function toNumber(value){if("number"==typeof value)return value;if(function(value){return"symbol"==typeof value||function(value){return!!value&&"object"==typeof value}(value)&&"[object Symbol]"==objectToString.call(value)}(value))return NaN;if(isObject(value)){var other="function"==typeof value.valueOf?value.valueOf():value;value=isObject(other)?other+"":other}if("string"!=typeof value)return 0===value?value:+value;value=value.replace(reTrim,"");var isBinary=reIsBinary.test(value);return isBinary||reIsOctal.test(value)?freeParseInt(value.slice(2),isBinary?2:8):reIsBadHex.test(value)?NaN:+value}module.exports=function(func,wait,options){var lastArgs,lastThis,maxWait,result,timerId,lastCallTime,lastInvokeTime=0,leading=!1,maxing=!1,trailing=!0;if("function"!=typeof func)throw new TypeError("Expected a function");function invokeFunc(time){var args=lastArgs,thisArg=lastThis;return lastArgs=lastThis=void 0,lastInvokeTime=time,result=func.apply(thisArg,args)}function leadingEdge(time){return lastInvokeTime=time,timerId=setTimeout(timerExpired,wait),leading?invokeFunc(time):result}function shouldInvoke(time){var timeSinceLastCall=time-lastCallTime;return void 0===lastCallTime||timeSinceLastCall>=wait||timeSinceLastCall<0||maxing&&time-lastInvokeTime>=maxWait}function timerExpired(){var time=now();if(shouldInvoke(time))return trailingEdge(time);timerId=setTimeout(timerExpired,function(time){var result=wait-(time-lastCallTime);return maxing?nativeMin(result,maxWait-(time-lastInvokeTime)):result}(time))}function trailingEdge(time){return timerId=void 0,trailing&&lastArgs?invokeFunc(time):(lastArgs=lastThis=void 0,result)}function debounced(){var time=now(),isInvoking=shouldInvoke(time);if(lastArgs=arguments,lastThis=this,lastCallTime=time,isInvoking){if(void 0===timerId)return leadingEdge(lastCallTime);if(maxing)return timerId=setTimeout(timerExpired,wait),invokeFunc(lastCallTime)}return void 0===timerId&&(timerId=setTimeout(timerExpired,wait)),result}return wait=toNumber(wait)||0,isObject(options)&&(leading=!!options.leading,maxWait=(maxing="maxWait"in options)?nativeMax(toNumber(options.maxWait)||0,wait):maxWait,trailing="trailing"in options?!!options.trailing:trailing),debounced.cancel=function(){void 0!==timerId&&clearTimeout(timerId),lastInvokeTime=0,lastArgs=lastCallTime=lastThis=timerId=void 0},debounced.flush=function(){return void 0===timerId?result:trailingEdge(now())},debounced}}).call(this,__webpack_require__(117))},function(module,exports,__webpack_require__){module.exports=__webpack_require__(518)},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;(function(){var Heap,defaultCmp,floor,heapify,heappop,heappush,heappushpop,heapreplace,insort,min,nlargest,nsmallest,updateItem,_siftdown,_siftup;floor=Math.floor,min=Math.min,defaultCmp=function(x,y){return x<y?-1:x>y?1:0},insort=function(a,x,lo,hi,cmp){var mid;if(null==lo&&(lo=0),null==cmp&&(cmp=defaultCmp),lo<0)throw new Error("lo must be non-negative");for(null==hi&&(hi=a.length);lo<hi;)cmp(x,a[mid=floor((lo+hi)/2)])<0?hi=mid:lo=mid+1;return[].splice.apply(a,[lo,lo-lo].concat(x)),x},heappush=function(array,item,cmp){return null==cmp&&(cmp=defaultCmp),array.push(item),_siftdown(array,0,array.length-1,cmp)},heappop=function(array,cmp){var lastelt,returnitem;return null==cmp&&(cmp=defaultCmp),lastelt=array.pop(),array.length?(returnitem=array[0],array[0]=lastelt,_siftup(array,0,cmp)):returnitem=lastelt,returnitem},heapreplace=function(array,item,cmp){var returnitem;return null==cmp&&(cmp=defaultCmp),returnitem=array[0],array[0]=item,_siftup(array,0,cmp),returnitem},heappushpop=function(array,item,cmp){var _ref;return null==cmp&&(cmp=defaultCmp),array.length&&cmp(array[0],item)<0&&(item=(_ref=[array[0],item])[0],array[0]=_ref[1],_siftup(array,0,cmp)),item},heapify=function(array,cmp){var i,_i,_len,_ref1,_results,_results1;for(null==cmp&&(cmp=defaultCmp),_results=[],_i=0,_len=(_ref1=function(){_results1=[];for(var _j=0,_ref=floor(array.length/2);0<=_ref?_j<_ref:_j>_ref;0<=_ref?_j++:_j--)_results1.push(_j);return _results1}.apply(this).reverse()).length;_i<_len;_i++)i=_ref1[_i],_results.push(_siftup(array,i,cmp));return _results},updateItem=function(array,item,cmp){var pos;if(null==cmp&&(cmp=defaultCmp),-1!==(pos=array.indexOf(item)))return _siftdown(array,0,pos,cmp),_siftup(array,pos,cmp)},nlargest=function(array,n,cmp){var elem,result,_i,_len,_ref;if(null==cmp&&(cmp=defaultCmp),!(result=array.slice(0,n)).length)return result;for(heapify(result,cmp),_i=0,_len=(_ref=array.slice(n)).length;_i<_len;_i++)elem=_ref[_i],heappushpop(result,elem,cmp);return result.sort(cmp).reverse()},nsmallest=function(array,n,cmp){var elem,los,result,_i,_j,_len,_ref,_ref1,_results;if(null==cmp&&(cmp=defaultCmp),10*n<=array.length){if(!(result=array.slice(0,n).sort(cmp)).length)return result;for(los=result[result.length-1],_i=0,_len=(_ref=array.slice(n)).length;_i<_len;_i++)cmp(elem=_ref[_i],los)<0&&(insort(result,elem,0,null,cmp),result.pop(),los=result[result.length-1]);return result}for(heapify(array,cmp),_results=[],_j=0,_ref1=min(n,array.length);0<=_ref1?_j<_ref1:_j>_ref1;0<=_ref1?++_j:--_j)_results.push(heappop(array,cmp));return _results},_siftdown=function(array,startpos,pos,cmp){var newitem,parent,parentpos;for(null==cmp&&(cmp=defaultCmp),newitem=array[pos];pos>startpos&&cmp(newitem,parent=array[parentpos=pos-1>>1])<0;)array[pos]=parent,pos=parentpos;return array[pos]=newitem},_siftup=function(array,pos,cmp){var childpos,endpos,newitem,rightpos,startpos;for(null==cmp&&(cmp=defaultCmp),endpos=array.length,startpos=pos,newitem=array[pos],childpos=2*pos+1;childpos<endpos;)(rightpos=childpos+1)<endpos&&!(cmp(array[childpos],array[rightpos])<0)&&(childpos=rightpos),array[pos]=array[childpos],childpos=2*(pos=childpos)+1;return array[pos]=newitem,_siftdown(array,startpos,pos,cmp)},Heap=function(){function Heap(cmp){this.cmp=null!=cmp?cmp:defaultCmp,this.nodes=[]}return Heap.push=heappush,Heap.pop=heappop,Heap.replace=heapreplace,Heap.pushpop=heappushpop,Heap.heapify=heapify,Heap.updateItem=updateItem,Heap.nlargest=nlargest,Heap.nsmallest=nsmallest,Heap.prototype.push=function(x){return heappush(this.nodes,x,this.cmp)},Heap.prototype.pop=function(){return heappop(this.nodes,this.cmp)},Heap.prototype.peek=function(){return this.nodes[0]},Heap.prototype.contains=function(x){return-1!==this.nodes.indexOf(x)},Heap.prototype.replace=function(x){return heapreplace(this.nodes,x,this.cmp)},Heap.prototype.pushpop=function(x){return heappushpop(this.nodes,x,this.cmp)},Heap.prototype.heapify=function(){return heapify(this.nodes,this.cmp)},Heap.prototype.updateItem=function(x){return updateItem(this.nodes,x,this.cmp)},Heap.prototype.clear=function(){return this.nodes=[]},Heap.prototype.empty=function(){return 0===this.nodes.length},Heap.prototype.size=function(){return this.nodes.length},Heap.prototype.clone=function(){var heap;return(heap=new Heap).nodes=this.nodes.slice(0),heap},Heap.prototype.toArray=function(){return this.nodes.slice(0)},Heap.prototype.insert=Heap.prototype.push,Heap.prototype.top=Heap.prototype.peek,Heap.prototype.front=Heap.prototype.peek,Heap.prototype.has=Heap.prototype.contains,Heap.prototype.copy=Heap.prototype.clone,Heap}(),__WEBPACK_AMD_DEFINE_ARRAY__=[],void 0===(__WEBPACK_AMD_DEFINE_RESULT__="function"==typeof(__WEBPACK_AMD_DEFINE_FACTORY__=function(){return Heap})?__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__):__WEBPACK_AMD_DEFINE_FACTORY__)||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)}).call(this)},function(module,exports,__webpack_require__){var factory;factory=function(__WEBPACK_EXTERNAL_MODULE_4__){return function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}return __webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.i=function(value){return value},__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{configurable:!1,enumerable:!0,get:getter})},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function(){return module.default}:function(){return module};return __webpack_require__.d(getter,"a",getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=3)}([function(module,exports,__webpack_require__){"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},defaults=__webpack_require__(2),assign=__webpack_require__(1),dagre=__webpack_require__(4);function DagreLayout(options){this.options=assign({},defaults,options)}DagreLayout.prototype.run=function(){var options=this.options,cy=options.cy,eles=options.eles,getVal=function(ele,val){return"function"==typeof val?val.apply(ele,[ele]):val},bb=options.boundingBox||{x1:0,y1:0,w:cy.width(),h:cy.height()};void 0===bb.x2&&(bb.x2=bb.x1+bb.w),void 0===bb.w&&(bb.w=bb.x2-bb.x1),void 0===bb.y2&&(bb.y2=bb.y1+bb.h),void 0===bb.h&&(bb.h=bb.y2-bb.y1);var g=new dagre.graphlib.Graph({multigraph:!0,compound:!0}),gObj={},setGObj=function(name,val){null!=val&&(gObj[name]=val)};setGObj("nodesep",options.nodeSep),setGObj("edgesep",options.edgeSep),setGObj("ranksep",options.rankSep),setGObj("rankdir",options.rankDir),setGObj("ranker",options.ranker),g.setGraph(gObj),g.setDefaultEdgeLabel((function(){return{}})),g.setDefaultNodeLabel((function(){return{}}));for(var nodes=eles.nodes(),i=0;i<nodes.length;i++){var node=nodes[i],nbb=node.layoutDimensions(options);g.setNode(node.id(),{width:nbb.w,height:nbb.h,name:node.id()})}for(var _i=0;_i<nodes.length;_i++){var _node=nodes[_i];_node.isChild()&&g.setParent(_node.id(),_node.parent().id())}for(var edges=eles.edges().stdFilter((function(edge){return!edge.source().isParent()&&!edge.target().isParent()})),_i2=0;_i2<edges.length;_i2++){var edge=edges[_i2];g.setEdge(edge.source().id(),edge.target().id(),{minlen:getVal(edge,options.minLen),weight:getVal(edge,options.edgeWeight),name:edge.id()},edge.id())}dagre.layout(g);for(var gNodeIds=g.nodes(),_i3=0;_i3<gNodeIds.length;_i3++){var id=gNodeIds[_i3],n=g.node(id);cy.getElementById(id).scratch().dagre=n}var dagreBB=void 0;return options.boundingBox?(dagreBB={x1:1/0,x2:-1/0,y1:1/0,y2:-1/0},nodes.forEach((function(node){var dModel=node.scratch().dagre;dagreBB.x1=Math.min(dagreBB.x1,dModel.x),dagreBB.x2=Math.max(dagreBB.x2,dModel.x),dagreBB.y1=Math.min(dagreBB.y1,dModel.y),dagreBB.y2=Math.max(dagreBB.y2,dModel.y)})),dagreBB.w=dagreBB.x2-dagreBB.x1,dagreBB.h=dagreBB.y2-dagreBB.y1):dagreBB=bb,nodes.layoutPositions(this,options,(function(ele){var dModel=(ele="object"===(void 0===ele?"undefined":_typeof(ele))?ele:this).scratch().dagre;return function(p){if(options.boundingBox){var xPct=0===dagreBB.w?0:(p.x-dagreBB.x1)/dagreBB.w,yPct=0===dagreBB.h?0:(p.y-dagreBB.y1)/dagreBB.h;return{x:bb.x1+xPct*bb.w,y:bb.y1+yPct*bb.h}}return p}({x:dModel.x,y:dModel.y})})),this},module.exports=DagreLayout},function(module,exports,__webpack_require__){"use strict";module.exports=null!=Object.assign?Object.assign.bind(Object):function(tgt){for(var _len=arguments.length,srcs=Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)srcs[_key-1]=arguments[_key];return srcs.forEach((function(src){Object.keys(src).forEach((function(k){return tgt[k]=src[k]}))})),tgt}},function(module,exports,__webpack_require__){"use strict";var defaults={nodeSep:void 0,edgeSep:void 0,rankSep:void 0,rankDir:void 0,ranker:void 0,minLen:function(edge){return 1},edgeWeight:function(edge){return 1},fit:!0,padding:30,spacingFactor:void 0,nodeDimensionsIncludeLabels:!1,animate:!1,animateFilter:function(node,i){return!0},animationDuration:500,animationEasing:void 0,boundingBox:void 0,transform:function(node,pos){return pos},ready:function(){},stop:function(){}};module.exports=defaults},function(module,exports,__webpack_require__){"use strict";var impl=__webpack_require__(0),register=function(cytoscape){cytoscape&&cytoscape("layout","dagre",impl)};"undefined"!=typeof cytoscape&&register(cytoscape),module.exports=register},function(module,exports){module.exports=__WEBPACK_EXTERNAL_MODULE_4__}])},module.exports=factory(__webpack_require__(520))},function(module,exports,__webpack_require__){module.exports={graphlib:__webpack_require__(113),layout:__webpack_require__(634),debug:__webpack_require__(695),util:{time:__webpack_require__(102).time,notime:__webpack_require__(102).notime},version:__webpack_require__(696)}},function(module,exports,__webpack_require__){var lib=__webpack_require__(522);module.exports={Graph:lib.Graph,json:__webpack_require__(624),alg:__webpack_require__(625),version:lib.version}},function(module,exports,__webpack_require__){module.exports={Graph:__webpack_require__(250),version:__webpack_require__(623)}},function(module,exports,__webpack_require__){var baseClone=__webpack_require__(326);module.exports=function(value){return baseClone(value,4)}},function(module,exports){module.exports=function(){this.__data__=[],this.size=0}},function(module,exports,__webpack_require__){var assocIndexOf=__webpack_require__(202),splice=Array.prototype.splice;module.exports=function(key){var data=this.__data__,index=assocIndexOf(data,key);return!(index<0)&&(index==data.length-1?data.pop():splice.call(data,index,1),--this.size,!0)}},function(module,exports,__webpack_require__){var assocIndexOf=__webpack_require__(202);module.exports=function(key){var data=this.__data__,index=assocIndexOf(data,key);return index<0?void 0:data[index][1]}},function(module,exports,__webpack_require__){var assocIndexOf=__webpack_require__(202);module.exports=function(key){return assocIndexOf(this.__data__,key)>-1}},function(module,exports,__webpack_require__){var assocIndexOf=__webpack_require__(202);module.exports=function(key,value){var data=this.__data__,index=assocIndexOf(data,key);return index<0?(++this.size,data.push([key,value])):data[index][1]=value,this}},function(module,exports,__webpack_require__){var ListCache=__webpack_require__(201);module.exports=function(){this.__data__=new ListCache,this.size=0}},function(module,exports){module.exports=function(key){var data=this.__data__,result=data.delete(key);return this.size=data.size,result}},function(module,exports){module.exports=function(key){return this.__data__.get(key)}},function(module,exports){module.exports=function(key){return this.__data__.has(key)}},function(module,exports,__webpack_require__){var ListCache=__webpack_require__(201),Map=__webpack_require__(251),MapCache=__webpack_require__(252);module.exports=function(key,value){var data=this.__data__;if(data instanceof ListCache){var pairs=data.__data__;if(!Map||pairs.length<199)return pairs.push([key,value]),this.size=++data.size,this;data=this.__data__=new MapCache(pairs)}return data.set(key,value),this.size=data.size,this}},function(module,exports,__webpack_require__){var isFunction=__webpack_require__(172),isMasked=__webpack_require__(537),isObject=__webpack_require__(109),toSource=__webpack_require__(328),reIsHostCtor=/^\[object .+?Constructor\]$/,funcProto=Function.prototype,objectProto=Object.prototype,funcToString=funcProto.toString,hasOwnProperty=objectProto.hasOwnProperty,reIsNative=RegExp("^"+funcToString.call(hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");module.exports=function(value){return!(!isObject(value)||isMasked(value))&&(isFunction(value)?reIsNative:reIsHostCtor).test(toSource(value))}},function(module,exports,__webpack_require__){var Symbol=__webpack_require__(153),objectProto=Object.prototype,hasOwnProperty=objectProto.hasOwnProperty,nativeObjectToString=objectProto.toString,symToStringTag=Symbol?Symbol.toStringTag:void 0;module.exports=function(value){var isOwn=hasOwnProperty.call(value,symToStringTag),tag=value[symToStringTag];try{value[symToStringTag]=void 0;var unmasked=!0}catch(e){}var result=nativeObjectToString.call(value);return unmasked&&(isOwn?value[symToStringTag]=tag:delete value[symToStringTag]),result}},function(module,exports){var nativeObjectToString=Object.prototype.toString;module.exports=function(value){return nativeObjectToString.call(value)}},function(module,exports,__webpack_require__){var uid,coreJsData=__webpack_require__(538),maskSrcKey=(uid=/[^.]+$/.exec(coreJsData&&coreJsData.keys&&coreJsData.keys.IE_PROTO||""))?"Symbol(src)_1."+uid:"";module.exports=function(func){return!!maskSrcKey&&maskSrcKey in func}},function(module,exports,__webpack_require__){var coreJsData=__webpack_require__(114)["__core-js_shared__"];module.exports=coreJsData},function(module,exports){module.exports=function(object,key){return null==object?void 0:object[key]}},function(module,exports,__webpack_require__){var Hash=__webpack_require__(541),ListCache=__webpack_require__(201),Map=__webpack_require__(251);module.exports=function(){this.size=0,this.__data__={hash:new Hash,map:new(Map||ListCache),string:new Hash}}},function(module,exports,__webpack_require__){var hashClear=__webpack_require__(542),hashDelete=__webpack_require__(543),hashGet=__webpack_require__(544),hashHas=__webpack_require__(545),hashSet=__webpack_require__(546);function Hash(entries){var index=-1,length=null==entries?0:entries.length;for(this.clear();++index<length;){var entry=entries[index];this.set(entry[0],entry[1])}}Hash.prototype.clear=hashClear,Hash.prototype.delete=hashDelete,Hash.prototype.get=hashGet,Hash.prototype.has=hashHas,Hash.prototype.set=hashSet,module.exports=Hash},function(module,exports,__webpack_require__){var nativeCreate=__webpack_require__(203);module.exports=function(){this.__data__=nativeCreate?nativeCreate(null):{},this.size=0}},function(module,exports){module.exports=function(key){var result=this.has(key)&&delete this.__data__[key];return this.size-=result?1:0,result}},function(module,exports,__webpack_require__){var nativeCreate=__webpack_require__(203),hasOwnProperty=Object.prototype.hasOwnProperty;module.exports=function(key){var data=this.__data__;if(nativeCreate){var result=data[key];return"__lodash_hash_undefined__"===result?void 0:result}return hasOwnProperty.call(data,key)?data[key]:void 0}},function(module,exports,__webpack_require__){var nativeCreate=__webpack_require__(203),hasOwnProperty=Object.prototype.hasOwnProperty;module.exports=function(key){var data=this.__data__;return nativeCreate?void 0!==data[key]:hasOwnProperty.call(data,key)}},function(module,exports,__webpack_require__){var nativeCreate=__webpack_require__(203);module.exports=function(key,value){var data=this.__data__;return this.size+=this.has(key)?0:1,data[key]=nativeCreate&&void 0===value?"__lodash_hash_undefined__":value,this}},function(module,exports,__webpack_require__){var getMapData=__webpack_require__(204);module.exports=function(key){var result=getMapData(this,key).delete(key);return this.size-=result?1:0,result}},function(module,exports){module.exports=function(value){var type=typeof value;return"string"==type||"number"==type||"symbol"==type||"boolean"==type?"__proto__"!==value:null===value}},function(module,exports,__webpack_require__){var getMapData=__webpack_require__(204);module.exports=function(key){return getMapData(this,key).get(key)}},function(module,exports,__webpack_require__){var getMapData=__webpack_require__(204);module.exports=function(key){return getMapData(this,key).has(key)}},function(module,exports,__webpack_require__){var getMapData=__webpack_require__(204);module.exports=function(key,value){var data=getMapData(this,key),size=data.size;return data.set(key,value),this.size+=data.size==size?0:1,this}},function(module,exports,__webpack_require__){var copyObject=__webpack_require__(173),keys=__webpack_require__(127);module.exports=function(object,source){return object&&copyObject(source,keys(source),object)}},function(module,exports){module.exports=function(n,iteratee){for(var index=-1,result=Array(n);++index<n;)result[index]=iteratee(index);return result}},function(module,exports,__webpack_require__){var baseGetTag=__webpack_require__(142),isObjectLike=__webpack_require__(120);module.exports=function(value){return isObjectLike(value)&&"[object Arguments]"==baseGetTag(value)}},function(module,exports){module.exports=function(){return!1}},function(module,exports,__webpack_require__){var baseGetTag=__webpack_require__(142),isLength=__webpack_require__(254),isObjectLike=__webpack_require__(120),typedArrayTags={};typedArrayTags["[object Float32Array]"]=typedArrayTags["[object Float64Array]"]=typedArrayTags["[object Int8Array]"]=typedArrayTags["[object Int16Array]"]=typedArrayTags["[object Int32Array]"]=typedArrayTags["[object Uint8Array]"]=typedArrayTags["[object Uint8ClampedArray]"]=typedArrayTags["[object Uint16Array]"]=typedArrayTags["[object Uint32Array]"]=!0,typedArrayTags["[object Arguments]"]=typedArrayTags["[object Array]"]=typedArrayTags["[object ArrayBuffer]"]=typedArrayTags["[object Boolean]"]=typedArrayTags["[object DataView]"]=typedArrayTags["[object Date]"]=typedArrayTags["[object Error]"]=typedArrayTags["[object Function]"]=typedArrayTags["[object Map]"]=typedArrayTags["[object Number]"]=typedArrayTags["[object Object]"]=typedArrayTags["[object RegExp]"]=typedArrayTags["[object Set]"]=typedArrayTags["[object String]"]=typedArrayTags["[object WeakMap]"]=!1,module.exports=function(value){return isObjectLike(value)&&isLength(value.length)&&!!typedArrayTags[baseGetTag(value)]}},function(module,exports,__webpack_require__){var nativeKeys=__webpack_require__(331)(Object.keys,Object);module.exports=nativeKeys},function(module,exports,__webpack_require__){var copyObject=__webpack_require__(173),keysIn=__webpack_require__(143);module.exports=function(object,source){return object&&copyObject(source,keysIn(source),object)}},function(module,exports,__webpack_require__){var isObject=__webpack_require__(109),isPrototype=__webpack_require__(209),nativeKeysIn=__webpack_require__(560),hasOwnProperty=Object.prototype.hasOwnProperty;module.exports=function(object){if(!isObject(object))return nativeKeysIn(object);var isProto=isPrototype(object),result=[];for(var key in object)("constructor"!=key||!isProto&&hasOwnProperty.call(object,key))&&result.push(key);return result}},function(module,exports){module.exports=function(object){var result=[];if(null!=object)for(var key in Object(object))result.push(key);return result}},function(module,exports,__webpack_require__){var copyObject=__webpack_require__(173),getSymbols=__webpack_require__(257);module.exports=function(source,object){return copyObject(source,getSymbols(source),object)}},function(module,exports,__webpack_require__){var copyObject=__webpack_require__(173),getSymbolsIn=__webpack_require__(336);module.exports=function(source,object){return copyObject(source,getSymbolsIn(source),object)}},function(module,exports,__webpack_require__){var baseGetAllKeys=__webpack_require__(338),getSymbolsIn=__webpack_require__(336),keysIn=__webpack_require__(143);module.exports=function(object){return baseGetAllKeys(object,keysIn,getSymbolsIn)}},function(module,exports,__webpack_require__){var DataView=__webpack_require__(141)(__webpack_require__(114),"DataView");module.exports=DataView},function(module,exports,__webpack_require__){var Promise=__webpack_require__(141)(__webpack_require__(114),"Promise");module.exports=Promise},function(module,exports,__webpack_require__){var WeakMap=__webpack_require__(141)(__webpack_require__(114),"WeakMap");module.exports=WeakMap},function(module,exports){var hasOwnProperty=Object.prototype.hasOwnProperty;module.exports=function(array){var length=array.length,result=new array.constructor(length);return length&&"string"==typeof array[0]&&hasOwnProperty.call(array,"index")&&(result.index=array.index,result.input=array.input),result}},function(module,exports,__webpack_require__){var cloneArrayBuffer=__webpack_require__(259),cloneDataView=__webpack_require__(569),cloneRegExp=__webpack_require__(570),cloneSymbol=__webpack_require__(571),cloneTypedArray=__webpack_require__(341);module.exports=function(object,tag,isDeep){var Ctor=object.constructor;switch(tag){case"[object ArrayBuffer]":return cloneArrayBuffer(object);case"[object Boolean]":case"[object Date]":return new Ctor(+object);case"[object DataView]":return cloneDataView(object,isDeep);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return cloneTypedArray(object,isDeep);case"[object Map]":return new Ctor;case"[object Number]":case"[object String]":return new Ctor(object);case"[object RegExp]":return cloneRegExp(object);case"[object Set]":return new Ctor;case"[object Symbol]":return cloneSymbol(object)}}},function(module,exports,__webpack_require__){var cloneArrayBuffer=__webpack_require__(259);module.exports=function(dataView,isDeep){var buffer=isDeep?cloneArrayBuffer(dataView.buffer):dataView.buffer;return new dataView.constructor(buffer,dataView.byteOffset,dataView.byteLength)}},function(module,exports){var reFlags=/\w*$/;module.exports=function(regexp){var result=new regexp.constructor(regexp.source,reFlags.exec(regexp));return result.lastIndex=regexp.lastIndex,result}},function(module,exports,__webpack_require__){var Symbol=__webpack_require__(153),symbolProto=Symbol?Symbol.prototype:void 0,symbolValueOf=symbolProto?symbolProto.valueOf:void 0;module.exports=function(symbol){return symbolValueOf?Object(symbolValueOf.call(symbol)):{}}},function(module,exports,__webpack_require__){var baseIsMap=__webpack_require__(573),baseUnary=__webpack_require__(208),nodeUtil=__webpack_require__(255),nodeIsMap=nodeUtil&&nodeUtil.isMap,isMap=nodeIsMap?baseUnary(nodeIsMap):baseIsMap;module.exports=isMap},function(module,exports,__webpack_require__){var getTag=__webpack_require__(155),isObjectLike=__webpack_require__(120);module.exports=function(value){return isObjectLike(value)&&"[object Map]"==getTag(value)}},function(module,exports,__webpack_require__){var baseIsSet=__webpack_require__(575),baseUnary=__webpack_require__(208),nodeUtil=__webpack_require__(255),nodeIsSet=nodeUtil&&nodeUtil.isSet,isSet=nodeIsSet?baseUnary(nodeIsSet):baseIsSet;module.exports=isSet},function(module,exports,__webpack_require__){var getTag=__webpack_require__(155),isObjectLike=__webpack_require__(120);module.exports=function(value){return isObjectLike(value)&&"[object Set]"==getTag(value)}},function(module,exports){module.exports=function(fromRight){return function(object,iteratee,keysFunc){for(var index=-1,iterable=Object(object),props=keysFunc(object),length=props.length;length--;){var key=props[fromRight?length:++index];if(!1===iteratee(iterable[key],key,iterable))break}return object}}},function(module,exports,__webpack_require__){var isArrayLike=__webpack_require__(123);module.exports=function(eachFunc,fromRight){return function(collection,iteratee){if(null==collection)return collection;if(!isArrayLike(collection))return eachFunc(collection,iteratee);for(var length=collection.length,index=fromRight?length:-1,iterable=Object(collection);(fromRight?index--:++index<length)&&!1!==iteratee(iterable[index],index,iterable););return collection}}},function(module,exports,__webpack_require__){var baseEach=__webpack_require__(211);module.exports=function(collection,predicate){var result=[];return baseEach(collection,(function(value,index,collection){predicate(value,index,collection)&&result.push(value)})),result}},function(module,exports,__webpack_require__){var baseIsMatch=__webpack_require__(580),getMatchData=__webpack_require__(588),matchesStrictComparable=__webpack_require__(353);module.exports=function(source){var matchData=getMatchData(source);return 1==matchData.length&&matchData[0][2]?matchesStrictComparable(matchData[0][0],matchData[0][1]):function(object){return object===source||baseIsMatch(object,source,matchData)}}},function(module,exports,__webpack_require__){var Stack=__webpack_require__(200),baseIsEqual=__webpack_require__(348);module.exports=function(object,source,matchData,customizer){var index=matchData.length,length=index,noCustomizer=!customizer;if(null==object)return!length;for(object=Object(object);index--;){var data=matchData[index];if(noCustomizer&&data[2]?data[1]!==object[data[0]]:!(data[0]in object))return!1}for(;++index<length;){var key=(data=matchData[index])[0],objValue=object[key],srcValue=data[1];if(noCustomizer&&data[2]){if(void 0===objValue&&!(key in object))return!1}else{var stack=new Stack;if(customizer)var result=customizer(objValue,srcValue,key,object,source,stack);if(!(void 0===result?baseIsEqual(srcValue,objValue,3,customizer,stack):result))return!1}}return!0}},function(module,exports,__webpack_require__){var Stack=__webpack_require__(200),equalArrays=__webpack_require__(349),equalByTag=__webpack_require__(585),equalObjects=__webpack_require__(587),getTag=__webpack_require__(155),isArray=__webpack_require__(80),isBuffer=__webpack_require__(154),isTypedArray=__webpack_require__(175),objectTag="[object Object]",hasOwnProperty=Object.prototype.hasOwnProperty;module.exports=function(object,other,bitmask,customizer,equalFunc,stack){var objIsArr=isArray(object),othIsArr=isArray(other),objTag=objIsArr?"[object Array]":getTag(object),othTag=othIsArr?"[object Array]":getTag(other),objIsObj=(objTag="[object Arguments]"==objTag?objectTag:objTag)==objectTag,othIsObj=(othTag="[object Arguments]"==othTag?objectTag:othTag)==objectTag,isSameTag=objTag==othTag;if(isSameTag&&isBuffer(object)){if(!isBuffer(other))return!1;objIsArr=!0,objIsObj=!1}if(isSameTag&&!objIsObj)return stack||(stack=new Stack),objIsArr||isTypedArray(object)?equalArrays(object,other,bitmask,customizer,equalFunc,stack):equalByTag(object,other,objTag,bitmask,customizer,equalFunc,stack);if(!(1&bitmask)){var objIsWrapped=objIsObj&&hasOwnProperty.call(object,"__wrapped__"),othIsWrapped=othIsObj&&hasOwnProperty.call(other,"__wrapped__");if(objIsWrapped||othIsWrapped){var objUnwrapped=objIsWrapped?object.value():object,othUnwrapped=othIsWrapped?other.value():other;return stack||(stack=new Stack),equalFunc(objUnwrapped,othUnwrapped,bitmask,customizer,stack)}}return!!isSameTag&&(stack||(stack=new Stack),equalObjects(object,other,bitmask,customizer,equalFunc,stack))}},function(module,exports){module.exports=function(value){return this.__data__.set(value,"__lodash_hash_undefined__"),this}},function(module,exports){module.exports=function(value){return this.__data__.has(value)}},function(module,exports){module.exports=function(array,predicate){for(var index=-1,length=null==array?0:array.length;++index<length;)if(predicate(array[index],index,array))return!0;return!1}},function(module,exports,__webpack_require__){var Symbol=__webpack_require__(153),Uint8Array=__webpack_require__(340),eq=__webpack_require__(152),equalArrays=__webpack_require__(349),mapToArray=__webpack_require__(586),setToArray=__webpack_require__(263),symbolProto=Symbol?Symbol.prototype:void 0,symbolValueOf=symbolProto?symbolProto.valueOf:void 0;module.exports=function(object,other,tag,bitmask,customizer,equalFunc,stack){switch(tag){case"[object DataView]":if(object.byteLength!=other.byteLength||object.byteOffset!=other.byteOffset)return!1;object=object.buffer,other=other.buffer;case"[object ArrayBuffer]":return!(object.byteLength!=other.byteLength||!equalFunc(new Uint8Array(object),new Uint8Array(other)));case"[object Boolean]":case"[object Date]":case"[object Number]":return eq(+object,+other);case"[object Error]":return object.name==other.name&&object.message==other.message;case"[object RegExp]":case"[object String]":return object==other+"";case"[object Map]":var convert=mapToArray;case"[object Set]":var isPartial=1&bitmask;if(convert||(convert=setToArray),object.size!=other.size&&!isPartial)return!1;var stacked=stack.get(object);if(stacked)return stacked==other;bitmask|=2,stack.set(object,other);var result=equalArrays(convert(object),convert(other),bitmask,customizer,equalFunc,stack);return stack.delete(object),result;case"[object Symbol]":if(symbolValueOf)return symbolValueOf.call(object)==symbolValueOf.call(other)}return!1}},function(module,exports){module.exports=function(map){var index=-1,result=Array(map.size);return map.forEach((function(value,key){result[++index]=[key,value]})),result}},function(module,exports,__webpack_require__){var getAllKeys=__webpack_require__(337),hasOwnProperty=Object.prototype.hasOwnProperty;module.exports=function(object,other,bitmask,customizer,equalFunc,stack){var isPartial=1&bitmask,objProps=getAllKeys(object),objLength=objProps.length;if(objLength!=getAllKeys(other).length&&!isPartial)return!1;for(var index=objLength;index--;){var key=objProps[index];if(!(isPartial?key in other:hasOwnProperty.call(other,key)))return!1}var objStacked=stack.get(object),othStacked=stack.get(other);if(objStacked&&othStacked)return objStacked==other&&othStacked==object;var result=!0;stack.set(object,other),stack.set(other,object);for(var skipCtor=isPartial;++index<objLength;){var objValue=object[key=objProps[index]],othValue=other[key];if(customizer)var compared=isPartial?customizer(othValue,objValue,key,other,object,stack):customizer(objValue,othValue,key,object,other,stack);if(!(void 0===compared?objValue===othValue||equalFunc(objValue,othValue,bitmask,customizer,stack):compared)){result=!1;break}skipCtor||(skipCtor="constructor"==key)}if(result&&!skipCtor){var objCtor=object.constructor,othCtor=other.constructor;objCtor==othCtor||!("constructor"in object)||!("constructor"in other)||"function"==typeof objCtor&&objCtor instanceof objCtor&&"function"==typeof othCtor&&othCtor instanceof othCtor||(result=!1)}return stack.delete(object),stack.delete(other),result}},function(module,exports,__webpack_require__){var isStrictComparable=__webpack_require__(352),keys=__webpack_require__(127);module.exports=function(object){for(var result=keys(object),length=result.length;length--;){var key=result[length],value=object[key];result[length]=[key,value,isStrictComparable(value)]}return result}},function(module,exports,__webpack_require__){var baseIsEqual=__webpack_require__(348),get=__webpack_require__(590),hasIn=__webpack_require__(355),isKey=__webpack_require__(264),isStrictComparable=__webpack_require__(352),matchesStrictComparable=__webpack_require__(353),toKey=__webpack_require__(176);module.exports=function(path,srcValue){return isKey(path)&&isStrictComparable(srcValue)?matchesStrictComparable(toKey(path),srcValue):function(object){var objValue=get(object,path);return void 0===objValue&&objValue===srcValue?hasIn(object,path):baseIsEqual(srcValue,objValue,3)}}},function(module,exports,__webpack_require__){var baseGet=__webpack_require__(212);module.exports=function(object,path,defaultValue){var result=null==object?void 0:baseGet(object,path);return void 0===result?defaultValue:result}},function(module,exports,__webpack_require__){var memoizeCapped=__webpack_require__(592),rePropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,reEscapeChar=/\\(\\)?/g,stringToPath=memoizeCapped((function(string){var result=[];return 46===string.charCodeAt(0)&&result.push(""),string.replace(rePropName,(function(match,number,quote,subString){result.push(quote?subString.replace(reEscapeChar,"$1"):number||match)})),result}));module.exports=stringToPath},function(module,exports,__webpack_require__){var memoize=__webpack_require__(593);module.exports=function(func){var result=memoize(func,(function(key){return 500===cache.size&&cache.clear(),key})),cache=result.cache;return result}},function(module,exports,__webpack_require__){var MapCache=__webpack_require__(252);function memoize(func,resolver){if("function"!=typeof func||null!=resolver&&"function"!=typeof resolver)throw new TypeError("Expected a function");var memoized=function(){var args=arguments,key=resolver?resolver.apply(this,args):args[0],cache=memoized.cache;if(cache.has(key))return cache.get(key);var result=func.apply(this,args);return memoized.cache=cache.set(key,result)||cache,result};return memoized.cache=new(memoize.Cache||MapCache),memoized}memoize.Cache=MapCache,module.exports=memoize},function(module,exports,__webpack_require__){var Symbol=__webpack_require__(153),arrayMap=__webpack_require__(214),isArray=__webpack_require__(80),isSymbol=__webpack_require__(156),symbolProto=Symbol?Symbol.prototype:void 0,symbolToString=symbolProto?symbolProto.toString:void 0;module.exports=function baseToString(value){if("string"==typeof value)return value;if(isArray(value))return arrayMap(value,baseToString)+"";if(isSymbol(value))return symbolToString?symbolToString.call(value):"";var result=value+"";return"0"==result&&1/value==-1/0?"-0":result}},function(module,exports){module.exports=function(object,key){return null!=object&&key in Object(object)}},function(module,exports,__webpack_require__){var baseProperty=__webpack_require__(357),basePropertyDeep=__webpack_require__(597),isKey=__webpack_require__(264),toKey=__webpack_require__(176);module.exports=function(path){return isKey(path)?baseProperty(toKey(path)):basePropertyDeep(path)}},function(module,exports,__webpack_require__){var baseGet=__webpack_require__(212);module.exports=function(path){return function(object){return baseGet(object,path)}}},function(module,exports){var hasOwnProperty=Object.prototype.hasOwnProperty;module.exports=function(object,key){return null!=object&&hasOwnProperty.call(object,key)}},function(module,exports,__webpack_require__){var baseKeys=__webpack_require__(256),getTag=__webpack_require__(155),isArguments=__webpack_require__(174),isArray=__webpack_require__(80),isArrayLike=__webpack_require__(123),isBuffer=__webpack_require__(154),isPrototype=__webpack_require__(209),isTypedArray=__webpack_require__(175),hasOwnProperty=Object.prototype.hasOwnProperty;module.exports=function(value){if(null==value)return!0;if(isArrayLike(value)&&(isArray(value)||"string"==typeof value||"function"==typeof value.splice||isBuffer(value)||isTypedArray(value)||isArguments(value)))return!value.length;var tag=getTag(value);if("[object Map]"==tag||"[object Set]"==tag)return!value.size;if(isPrototype(value))return!baseKeys(value).length;for(var key in value)if(hasOwnProperty.call(value,key))return!1;return!0}},function(module,exports){module.exports=function(array,iteratee,accumulator,initAccum){var index=-1,length=null==array?0:array.length;for(initAccum&&length&&(accumulator=array[++index]);++index<length;)accumulator=iteratee(accumulator,array[index],index,array);return accumulator}},function(module,exports){module.exports=function(collection,iteratee,accumulator,initAccum,eachFunc){return eachFunc(collection,(function(value,index,collection){accumulator=initAccum?(initAccum=!1,value):iteratee(accumulator,value,index,collection)})),accumulator}},function(module,exports,__webpack_require__){var baseKeys=__webpack_require__(256),getTag=__webpack_require__(155),isArrayLike=__webpack_require__(123),isString=__webpack_require__(603),stringSize=__webpack_require__(604);module.exports=function(collection){if(null==collection)return 0;if(isArrayLike(collection))return isString(collection)?stringSize(collection):collection.length;var tag=getTag(collection);return"[object Map]"==tag||"[object Set]"==tag?collection.size:baseKeys(collection).length}},function(module,exports,__webpack_require__){var baseGetTag=__webpack_require__(142),isArray=__webpack_require__(80),isObjectLike=__webpack_require__(120);module.exports=function(value){return"string"==typeof value||!isArray(value)&&isObjectLike(value)&&"[object String]"==baseGetTag(value)}},function(module,exports,__webpack_require__){var asciiSize=__webpack_require__(605),hasUnicode=__webpack_require__(606),unicodeSize=__webpack_require__(607);module.exports=function(string){return hasUnicode(string)?unicodeSize(string):asciiSize(string)}},function(module,exports,__webpack_require__){var asciiSize=__webpack_require__(357)("length");module.exports=asciiSize},function(module,exports){var reHasUnicode=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");module.exports=function(string){return reHasUnicode.test(string)}},function(module,exports){var rsAstral="[\\ud800-\\udfff]",rsCombo="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",rsFitz="\\ud83c[\\udffb-\\udfff]",rsNonAstral="[^\\ud800-\\udfff]",rsRegional="(?:\\ud83c[\\udde6-\\uddff]){2}",rsSurrPair="[\\ud800-\\udbff][\\udc00-\\udfff]",reOptMod="(?:"+rsCombo+"|"+rsFitz+")"+"?",rsSeq="[\\ufe0e\\ufe0f]?"+reOptMod+("(?:\\u200d(?:"+[rsNonAstral,rsRegional,rsSurrPair].join("|")+")[\\ufe0e\\ufe0f]?"+reOptMod+")*"),rsSymbol="(?:"+[rsNonAstral+rsCombo+"?",rsCombo,rsRegional,rsSurrPair,rsAstral].join("|")+")",reUnicode=RegExp(rsFitz+"(?="+rsFitz+")|"+rsSymbol+rsSeq,"g");module.exports=function(string){for(var result=reUnicode.lastIndex=0;reUnicode.test(string);)++result;return result}},function(module,exports,__webpack_require__){var arrayEach=__webpack_require__(253),baseCreate=__webpack_require__(343),baseForOwn=__webpack_require__(261),baseIteratee=__webpack_require__(124),getPrototype=__webpack_require__(210),isArray=__webpack_require__(80),isBuffer=__webpack_require__(154),isFunction=__webpack_require__(172),isObject=__webpack_require__(109),isTypedArray=__webpack_require__(175);module.exports=function(object,iteratee,accumulator){var isArr=isArray(object),isArrLike=isArr||isBuffer(object)||isTypedArray(object);if(iteratee=baseIteratee(iteratee,4),null==accumulator){var Ctor=object&&object.constructor;accumulator=isArrLike?isArr?new Ctor:[]:isObject(object)&&isFunction(Ctor)?baseCreate(getPrototype(object)):{}}return(isArrLike?arrayEach:baseForOwn)(object,(function(value,index,object){return iteratee(accumulator,value,index,object)})),accumulator}},function(module,exports,__webpack_require__){var baseFlatten=__webpack_require__(265),baseRest=__webpack_require__(215),baseUniq=__webpack_require__(614),isArrayLikeObject=__webpack_require__(366),union=baseRest((function(arrays){return baseUniq(baseFlatten(arrays,1,isArrayLikeObject,!0))}));module.exports=union},function(module,exports,__webpack_require__){var Symbol=__webpack_require__(153),isArguments=__webpack_require__(174),isArray=__webpack_require__(80),spreadableSymbol=Symbol?Symbol.isConcatSpreadable:void 0;module.exports=function(value){return isArray(value)||isArguments(value)||!!(spreadableSymbol&&value&&value[spreadableSymbol])}},function(module,exports){module.exports=function(func,thisArg,args){switch(args.length){case 0:return func.call(thisArg);case 1:return func.call(thisArg,args[0]);case 2:return func.call(thisArg,args[0],args[1]);case 3:return func.call(thisArg,args[0],args[1],args[2])}return func.apply(thisArg,args)}},function(module,exports,__webpack_require__){var constant=__webpack_require__(260),defineProperty=__webpack_require__(329),identity=__webpack_require__(144),baseSetToString=defineProperty?function(func,string){return defineProperty(func,"toString",{configurable:!0,enumerable:!1,value:constant(string),writable:!0})}:identity;module.exports=baseSetToString},function(module,exports){var nativeNow=Date.now;module.exports=function(func){var count=0,lastCalled=0;return function(){var stamp=nativeNow(),remaining=16-(stamp-lastCalled);if(lastCalled=stamp,remaining>0){if(++count>=800)return arguments[0]}else count=0;return func.apply(void 0,arguments)}}},function(module,exports,__webpack_require__){var SetCache=__webpack_require__(350),arrayIncludes=__webpack_require__(615),arrayIncludesWith=__webpack_require__(619),cacheHas=__webpack_require__(351),createSet=__webpack_require__(620),setToArray=__webpack_require__(263);module.exports=function(array,iteratee,comparator){var index=-1,includes=arrayIncludes,length=array.length,isCommon=!0,result=[],seen=result;if(comparator)isCommon=!1,includes=arrayIncludesWith;else if(length>=200){var set=iteratee?null:createSet(array);if(set)return setToArray(set);isCommon=!1,includes=cacheHas,seen=new SetCache}else seen=iteratee?[]:result;outer:for(;++index<length;){var value=array[index],computed=iteratee?iteratee(value):value;if(value=comparator||0!==value?value:0,isCommon&&computed==computed){for(var seenIndex=seen.length;seenIndex--;)if(seen[seenIndex]===computed)continue outer;iteratee&&seen.push(computed),result.push(value)}else includes(seen,computed,comparator)||(seen!==result&&seen.push(computed),result.push(value))}return result}},function(module,exports,__webpack_require__){var baseIndexOf=__webpack_require__(616);module.exports=function(array,value){return!!(null==array?0:array.length)&&baseIndexOf(array,value,0)>-1}},function(module,exports,__webpack_require__){var baseFindIndex=__webpack_require__(365),baseIsNaN=__webpack_require__(617),strictIndexOf=__webpack_require__(618);module.exports=function(array,value,fromIndex){return value==value?strictIndexOf(array,value,fromIndex):baseFindIndex(array,baseIsNaN,fromIndex)}},function(module,exports){module.exports=function(value){return value!=value}},function(module,exports){module.exports=function(array,value,fromIndex){for(var index=fromIndex-1,length=array.length;++index<length;)if(array[index]===value)return index;return-1}},function(module,exports){module.exports=function(array,value,comparator){for(var index=-1,length=null==array?0:array.length;++index<length;)if(comparator(value,array[index]))return!0;return!1}},function(module,exports,__webpack_require__){var Set=__webpack_require__(339),noop=__webpack_require__(621),setToArray=__webpack_require__(263),createSet=Set&&1/setToArray(new Set([,-0]))[1]==1/0?function(values){return new Set(values)}:noop;module.exports=createSet},function(module,exports){module.exports=function(){}},function(module,exports,__webpack_require__){var arrayMap=__webpack_require__(214);module.exports=function(object,props){return arrayMap(props,(function(key){return object[key]}))}},function(module,exports){module.exports="2.1.8"},function(module,exports,__webpack_require__){var _=__webpack_require__(108),Graph=__webpack_require__(250);function writeNodes(g){return _.map(g.nodes(),(function(v){var nodeValue=g.node(v),parent=g.parent(v),node={v:v};return _.isUndefined(nodeValue)||(node.value=nodeValue),_.isUndefined(parent)||(node.parent=parent),node}))}function writeEdges(g){return _.map(g.edges(),(function(e){var edgeValue=g.edge(e),edge={v:e.v,w:e.w};return _.isUndefined(e.name)||(edge.name=e.name),_.isUndefined(edgeValue)||(edge.value=edgeValue),edge}))}module.exports={write:function(g){var json={options:{directed:g.isDirected(),multigraph:g.isMultigraph(),compound:g.isCompound()},nodes:writeNodes(g),edges:writeEdges(g)};_.isUndefined(g.graph())||(json.value=_.clone(g.graph()));return json},read:function(json){var g=new Graph(json.options).setGraph(json.value);return _.each(json.nodes,(function(entry){g.setNode(entry.v,entry.value),entry.parent&&g.setParent(entry.v,entry.parent)})),_.each(json.edges,(function(entry){g.setEdge({v:entry.v,w:entry.w,name:entry.name},entry.value)})),g}}},function(module,exports,__webpack_require__){module.exports={components:__webpack_require__(626),dijkstra:__webpack_require__(368),dijkstraAll:__webpack_require__(627),findCycles:__webpack_require__(628),floydWarshall:__webpack_require__(629),isAcyclic:__webpack_require__(630),postorder:__webpack_require__(631),preorder:__webpack_require__(632),prim:__webpack_require__(633),tarjan:__webpack_require__(370),topsort:__webpack_require__(371)}},function(module,exports,__webpack_require__){var _=__webpack_require__(108);module.exports=function(g){var cmpt,visited={},cmpts=[];function dfs(v){_.has(visited,v)||(visited[v]=!0,cmpt.push(v),_.each(g.successors(v),dfs),_.each(g.predecessors(v),dfs))}return _.each(g.nodes(),(function(v){cmpt=[],dfs(v),cmpt.length&&cmpts.push(cmpt)})),cmpts}},function(module,exports,__webpack_require__){var dijkstra=__webpack_require__(368),_=__webpack_require__(108);module.exports=function(g,weightFunc,edgeFunc){return _.transform(g.nodes(),(function(acc,v){acc[v]=dijkstra(g,v,weightFunc,edgeFunc)}),{})}},function(module,exports,__webpack_require__){var _=__webpack_require__(108),tarjan=__webpack_require__(370);module.exports=function(g){return _.filter(tarjan(g),(function(cmpt){return cmpt.length>1||1===cmpt.length&&g.hasEdge(cmpt[0],cmpt[0])}))}},function(module,exports,__webpack_require__){var _=__webpack_require__(108);module.exports=function(g,weightFn,edgeFn){return function(g,weightFn,edgeFn){var results={},nodes=g.nodes();return nodes.forEach((function(v){results[v]={},results[v][v]={distance:0},nodes.forEach((function(w){v!==w&&(results[v][w]={distance:Number.POSITIVE_INFINITY})})),edgeFn(v).forEach((function(edge){var w=edge.v===v?edge.w:edge.v,d=weightFn(edge);results[v][w]={distance:d,predecessor:v}}))})),nodes.forEach((function(k){var rowK=results[k];nodes.forEach((function(i){var rowI=results[i];nodes.forEach((function(j){var ik=rowI[k],kj=rowK[j],ij=rowI[j],altDistance=ik.distance+kj.distance;altDistance<ij.distance&&(ij.distance=altDistance,ij.predecessor=kj.predecessor)}))}))})),results}(g,weightFn||DEFAULT_WEIGHT_FUNC,edgeFn||function(v){return g.outEdges(v)})};var DEFAULT_WEIGHT_FUNC=_.constant(1)},function(module,exports,__webpack_require__){var topsort=__webpack_require__(371);module.exports=function(g){try{topsort(g)}catch(e){if(e instanceof topsort.CycleException)return!1;throw e}return!0}},function(module,exports,__webpack_require__){var dfs=__webpack_require__(372);module.exports=function(g,vs){return dfs(g,vs,"post")}},function(module,exports,__webpack_require__){var dfs=__webpack_require__(372);module.exports=function(g,vs){return dfs(g,vs,"pre")}},function(module,exports,__webpack_require__){var _=__webpack_require__(108),Graph=__webpack_require__(250),PriorityQueue=__webpack_require__(369);module.exports=function(g,weightFunc){var v,result=new Graph,parents={},pq=new PriorityQueue;function updateNeighbors(edge){var w=edge.v===v?edge.w:edge.v,pri=pq.priority(w);if(void 0!==pri){var edgeWeight=weightFunc(edge);edgeWeight<pri&&(parents[w]=v,pq.decrease(w,edgeWeight))}}if(0===g.nodeCount())return result;_.each(g.nodes(),(function(v){pq.add(v,Number.POSITIVE_INFINITY),result.setNode(v)})),pq.decrease(g.nodes()[0],0);var init=!1;for(;pq.size()>0;){if(v=pq.removeMin(),_.has(parents,v))result.setEdge(v,parents[v]);else{if(init)throw new Error("Input graph is not connected: "+g);init=!0}g.nodeEdges(v).forEach(updateNeighbors)}return result}},function(module,exports,__webpack_require__){"use strict";var _=__webpack_require__(78),acyclic=__webpack_require__(674),normalize=__webpack_require__(677),rank=__webpack_require__(678),normalizeRanks=__webpack_require__(102).normalizeRanks,parentDummyChains=__webpack_require__(680),removeEmptyRanks=__webpack_require__(102).removeEmptyRanks,nestingGraph=__webpack_require__(681),addBorderSegments=__webpack_require__(682),coordinateSystem=__webpack_require__(683),order=__webpack_require__(684),position=__webpack_require__(693),util=__webpack_require__(102),Graph=__webpack_require__(113).Graph;module.exports=function(g,opts){var time=opts&&opts.debugTiming?util.time:util.notime;time("layout",(function(){var layoutGraph=time("  buildLayoutGraph",(function(){return function(inputGraph){var g=new Graph({multigraph:!0,compound:!0}),graph=canonicalize(inputGraph.graph());return g.setGraph(_.merge({},graphDefaults,selectNumberAttrs(graph,graphNumAttrs),_.pick(graph,graphAttrs))),_.forEach(inputGraph.nodes(),(function(v){var node=canonicalize(inputGraph.node(v));g.setNode(v,_.defaults(selectNumberAttrs(node,nodeNumAttrs),nodeDefaults)),g.setParent(v,inputGraph.parent(v))})),_.forEach(inputGraph.edges(),(function(e){var edge=canonicalize(inputGraph.edge(e));g.setEdge(e,_.merge({},edgeDefaults,selectNumberAttrs(edge,edgeNumAttrs),_.pick(edge,edgeAttrs)))})),g}(g)}));time("  runLayout",(function(){!function(g,time){time("    makeSpaceForEdgeLabels",(function(){!function(g){var graph=g.graph();graph.ranksep/=2,_.forEach(g.edges(),(function(e){var edge=g.edge(e);edge.minlen*=2,"c"!==edge.labelpos.toLowerCase()&&("TB"===graph.rankdir||"BT"===graph.rankdir?edge.width+=edge.labeloffset:edge.height+=edge.labeloffset)}))}(g)})),time("    removeSelfEdges",(function(){!function(g){_.forEach(g.edges(),(function(e){if(e.v===e.w){var node=g.node(e.v);node.selfEdges||(node.selfEdges=[]),node.selfEdges.push({e:e,label:g.edge(e)}),g.removeEdge(e)}}))}(g)})),time("    acyclic",(function(){acyclic.run(g)})),time("    nestingGraph.run",(function(){nestingGraph.run(g)})),time("    rank",(function(){rank(util.asNonCompoundGraph(g))})),time("    injectEdgeLabelProxies",(function(){!function(g){_.forEach(g.edges(),(function(e){var edge=g.edge(e);if(edge.width&&edge.height){var v=g.node(e.v),label={rank:(g.node(e.w).rank-v.rank)/2+v.rank,e:e};util.addDummyNode(g,"edge-proxy",label,"_ep")}}))}(g)})),time("    removeEmptyRanks",(function(){removeEmptyRanks(g)})),time("    nestingGraph.cleanup",(function(){nestingGraph.cleanup(g)})),time("    normalizeRanks",(function(){normalizeRanks(g)})),time("    assignRankMinMax",(function(){!function(g){var maxRank=0;_.forEach(g.nodes(),(function(v){var node=g.node(v);node.borderTop&&(node.minRank=g.node(node.borderTop).rank,node.maxRank=g.node(node.borderBottom).rank,maxRank=_.max(maxRank,node.maxRank))})),g.graph().maxRank=maxRank}(g)})),time("    removeEdgeLabelProxies",(function(){!function(g){_.forEach(g.nodes(),(function(v){var node=g.node(v);"edge-proxy"===node.dummy&&(g.edge(node.e).labelRank=node.rank,g.removeNode(v))}))}(g)})),time("    normalize.run",(function(){normalize.run(g)})),time("    parentDummyChains",(function(){parentDummyChains(g)})),time("    addBorderSegments",(function(){addBorderSegments(g)})),time("    order",(function(){order(g)})),time("    insertSelfEdges",(function(){!function(g){var layers=util.buildLayerMatrix(g);_.forEach(layers,(function(layer){var orderShift=0;_.forEach(layer,(function(v,i){var node=g.node(v);node.order=i+orderShift,_.forEach(node.selfEdges,(function(selfEdge){util.addDummyNode(g,"selfedge",{width:selfEdge.label.width,height:selfEdge.label.height,rank:node.rank,order:i+ ++orderShift,e:selfEdge.e,label:selfEdge.label},"_se")})),delete node.selfEdges}))}))}(g)})),time("    adjustCoordinateSystem",(function(){coordinateSystem.adjust(g)})),time("    position",(function(){position(g)})),time("    positionSelfEdges",(function(){!function(g){_.forEach(g.nodes(),(function(v){var node=g.node(v);if("selfedge"===node.dummy){var selfNode=g.node(node.e.v),x=selfNode.x+selfNode.width/2,y=selfNode.y,dx=node.x-x,dy=selfNode.height/2;g.setEdge(node.e,node.label),g.removeNode(v),node.label.points=[{x:x+2*dx/3,y:y-dy},{x:x+5*dx/6,y:y-dy},{x:x+dx,y:y},{x:x+5*dx/6,y:y+dy},{x:x+2*dx/3,y:y+dy}],node.label.x=node.x,node.label.y=node.y}}))}(g)})),time("    removeBorderNodes",(function(){!function(g){_.forEach(g.nodes(),(function(v){if(g.children(v).length){var node=g.node(v),t=g.node(node.borderTop),b=g.node(node.borderBottom),l=g.node(_.last(node.borderLeft)),r=g.node(_.last(node.borderRight));node.width=Math.abs(r.x-l.x),node.height=Math.abs(b.y-t.y),node.x=l.x+node.width/2,node.y=t.y+node.height/2}})),_.forEach(g.nodes(),(function(v){"border"===g.node(v).dummy&&g.removeNode(v)}))}(g)})),time("    normalize.undo",(function(){normalize.undo(g)})),time("    fixupEdgeLabelCoords",(function(){!function(g){_.forEach(g.edges(),(function(e){var edge=g.edge(e);if(_.has(edge,"x"))switch("l"!==edge.labelpos&&"r"!==edge.labelpos||(edge.width-=edge.labeloffset),edge.labelpos){case"l":edge.x-=edge.width/2+edge.labeloffset;break;case"r":edge.x+=edge.width/2+edge.labeloffset}}))}(g)})),time("    undoCoordinateSystem",(function(){coordinateSystem.undo(g)})),time("    translateGraph",(function(){!function(g){var minX=Number.POSITIVE_INFINITY,maxX=0,minY=Number.POSITIVE_INFINITY,maxY=0,graphLabel=g.graph(),marginX=graphLabel.marginx||0,marginY=graphLabel.marginy||0;function getExtremes(attrs){var x=attrs.x,y=attrs.y,w=attrs.width,h=attrs.height;minX=Math.min(minX,x-w/2),maxX=Math.max(maxX,x+w/2),minY=Math.min(minY,y-h/2),maxY=Math.max(maxY,y+h/2)}_.forEach(g.nodes(),(function(v){getExtremes(g.node(v))})),_.forEach(g.edges(),(function(e){var edge=g.edge(e);_.has(edge,"x")&&getExtremes(edge)})),minX-=marginX,minY-=marginY,_.forEach(g.nodes(),(function(v){var node=g.node(v);node.x-=minX,node.y-=minY})),_.forEach(g.edges(),(function(e){var edge=g.edge(e);_.forEach(edge.points,(function(p){p.x-=minX,p.y-=minY})),_.has(edge,"x")&&(edge.x-=minX),_.has(edge,"y")&&(edge.y-=minY)})),graphLabel.width=maxX-minX+marginX,graphLabel.height=maxY-minY+marginY}(g)})),time("    assignNodeIntersects",(function(){!function(g){_.forEach(g.edges(),(function(e){var p1,p2,edge=g.edge(e),nodeV=g.node(e.v),nodeW=g.node(e.w);edge.points?(p1=edge.points[0],p2=edge.points[edge.points.length-1]):(edge.points=[],p1=nodeW,p2=nodeV),edge.points.unshift(util.intersectRect(nodeV,p1)),edge.points.push(util.intersectRect(nodeW,p2))}))}(g)})),time("    reversePoints",(function(){!function(g){_.forEach(g.edges(),(function(e){var edge=g.edge(e);edge.reversed&&edge.points.reverse()}))}(g)})),time("    acyclic.undo",(function(){acyclic.undo(g)}))}(layoutGraph,time)})),time("  updateInputGraph",(function(){!function(inputGraph,layoutGraph){_.forEach(inputGraph.nodes(),(function(v){var inputLabel=inputGraph.node(v),layoutLabel=layoutGraph.node(v);inputLabel&&(inputLabel.x=layoutLabel.x,inputLabel.y=layoutLabel.y,layoutGraph.children(v).length&&(inputLabel.width=layoutLabel.width,inputLabel.height=layoutLabel.height))})),_.forEach(inputGraph.edges(),(function(e){var inputLabel=inputGraph.edge(e),layoutLabel=layoutGraph.edge(e);inputLabel.points=layoutLabel.points,_.has(layoutLabel,"x")&&(inputLabel.x=layoutLabel.x,inputLabel.y=layoutLabel.y)})),inputGraph.graph().width=layoutGraph.graph().width,inputGraph.graph().height=layoutGraph.graph().height}(g,layoutGraph)}))}))};var graphNumAttrs=["nodesep","edgesep","ranksep","marginx","marginy"],graphDefaults={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},graphAttrs=["acyclicer","ranker","rankdir","align"],nodeNumAttrs=["width","height"],nodeDefaults={width:0,height:0},edgeNumAttrs=["minlen","weight","width","height","labeloffset"],edgeDefaults={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},edgeAttrs=["labelpos"];function selectNumberAttrs(obj,attrs){return _.mapValues(_.pick(obj,attrs),Number)}function canonicalize(attrs){var newAttrs={};return _.forEach(attrs,(function(v,k){newAttrs[k.toLowerCase()]=v})),newAttrs}},function(module,exports,__webpack_require__){var baseClone=__webpack_require__(326);module.exports=function(value){return baseClone(value,5)}},function(module,exports,__webpack_require__){var baseRest=__webpack_require__(215),eq=__webpack_require__(152),isIterateeCall=__webpack_require__(216),keysIn=__webpack_require__(143),objectProto=Object.prototype,hasOwnProperty=objectProto.hasOwnProperty,defaults=baseRest((function(object,sources){object=Object(object);var index=-1,length=sources.length,guard=length>2?sources[2]:void 0;for(guard&&isIterateeCall(sources[0],sources[1],guard)&&(length=1);++index<length;)for(var source=sources[index],props=keysIn(source),propsIndex=-1,propsLength=props.length;++propsIndex<propsLength;){var key=props[propsIndex],value=object[key];(void 0===value||eq(value,objectProto[key])&&!hasOwnProperty.call(object,key))&&(object[key]=source[key])}return object}));module.exports=defaults},function(module,exports,__webpack_require__){var find=__webpack_require__(638)(__webpack_require__(639));module.exports=find},function(module,exports,__webpack_require__){var baseIteratee=__webpack_require__(124),isArrayLike=__webpack_require__(123),keys=__webpack_require__(127);module.exports=function(findIndexFunc){return function(collection,predicate,fromIndex){var iterable=Object(collection);if(!isArrayLike(collection)){var iteratee=baseIteratee(predicate,3);collection=keys(collection),predicate=function(key){return iteratee(iterable[key],key,iterable)}}var index=findIndexFunc(collection,predicate,fromIndex);return index>-1?iterable[iteratee?collection[index]:index]:void 0}}},function(module,exports,__webpack_require__){var baseFindIndex=__webpack_require__(365),baseIteratee=__webpack_require__(124),toInteger=__webpack_require__(640),nativeMax=Math.max;module.exports=function(array,predicate,fromIndex){var length=null==array?0:array.length;if(!length)return-1;var index=null==fromIndex?0:toInteger(fromIndex);return index<0&&(index=nativeMax(length+index,0)),baseFindIndex(array,baseIteratee(predicate,3),index)}},function(module,exports,__webpack_require__){var toFinite=__webpack_require__(373);module.exports=function(value){var result=toFinite(value),remainder=result%1;return result==result?remainder?result-remainder:result:0}},function(module,exports,__webpack_require__){var baseTrim=__webpack_require__(642),isObject=__webpack_require__(109),isSymbol=__webpack_require__(156),reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsOctal=/^0o[0-7]+$/i,freeParseInt=parseInt;module.exports=function(value){if("number"==typeof value)return value;if(isSymbol(value))return NaN;if(isObject(value)){var other="function"==typeof value.valueOf?value.valueOf():value;value=isObject(other)?other+"":other}if("string"!=typeof value)return 0===value?value:+value;value=baseTrim(value);var isBinary=reIsBinary.test(value);return isBinary||reIsOctal.test(value)?freeParseInt(value.slice(2),isBinary?2:8):reIsBadHex.test(value)?NaN:+value}},function(module,exports,__webpack_require__){var trimmedEndIndex=__webpack_require__(643),reTrimStart=/^\s+/;module.exports=function(string){return string?string.slice(0,trimmedEndIndex(string)+1).replace(reTrimStart,""):string}},function(module,exports){var reWhitespace=/\s/;module.exports=function(string){for(var index=string.length;index--&&reWhitespace.test(string.charAt(index)););return index}},function(module,exports,__webpack_require__){var baseFor=__webpack_require__(262),castFunction=__webpack_require__(346),keysIn=__webpack_require__(143);module.exports=function(object,iteratee){return null==object?object:baseFor(object,castFunction(iteratee),keysIn)}},function(module,exports){module.exports=function(array){var length=null==array?0:array.length;return length?array[length-1]:void 0}},function(module,exports,__webpack_require__){var baseAssignValue=__webpack_require__(206),baseForOwn=__webpack_require__(261),baseIteratee=__webpack_require__(124);module.exports=function(object,iteratee){var result={};return iteratee=baseIteratee(iteratee,3),baseForOwn(object,(function(value,key,object){baseAssignValue(result,key,iteratee(value,key,object))})),result}},function(module,exports,__webpack_require__){var baseExtremum=__webpack_require__(266),baseGt=__webpack_require__(648),identity=__webpack_require__(144);module.exports=function(array){return array&&array.length?baseExtremum(array,identity,baseGt):void 0}},function(module,exports){module.exports=function(value,other){return value>other}},function(module,exports,__webpack_require__){var baseMerge=__webpack_require__(650),merge=__webpack_require__(654)((function(object,source,srcIndex){baseMerge(object,source,srcIndex)}));module.exports=merge},function(module,exports,__webpack_require__){var Stack=__webpack_require__(200),assignMergeValue=__webpack_require__(375),baseFor=__webpack_require__(262),baseMergeDeep=__webpack_require__(651),isObject=__webpack_require__(109),keysIn=__webpack_require__(143),safeGet=__webpack_require__(376);module.exports=function baseMerge(object,source,srcIndex,customizer,stack){object!==source&&baseFor(source,(function(srcValue,key){if(stack||(stack=new Stack),isObject(srcValue))baseMergeDeep(object,source,key,srcIndex,baseMerge,customizer,stack);else{var newValue=customizer?customizer(safeGet(object,key),srcValue,key+"",object,source,stack):void 0;void 0===newValue&&(newValue=srcValue),assignMergeValue(object,key,newValue)}}),keysIn)}},function(module,exports,__webpack_require__){var assignMergeValue=__webpack_require__(375),cloneBuffer=__webpack_require__(332),cloneTypedArray=__webpack_require__(341),copyArray=__webpack_require__(333),initCloneObject=__webpack_require__(342),isArguments=__webpack_require__(174),isArray=__webpack_require__(80),isArrayLikeObject=__webpack_require__(366),isBuffer=__webpack_require__(154),isFunction=__webpack_require__(172),isObject=__webpack_require__(109),isPlainObject=__webpack_require__(652),isTypedArray=__webpack_require__(175),safeGet=__webpack_require__(376),toPlainObject=__webpack_require__(653);module.exports=function(object,source,key,srcIndex,mergeFunc,customizer,stack){var objValue=safeGet(object,key),srcValue=safeGet(source,key),stacked=stack.get(srcValue);if(stacked)assignMergeValue(object,key,stacked);else{var newValue=customizer?customizer(objValue,srcValue,key+"",object,source,stack):void 0,isCommon=void 0===newValue;if(isCommon){var isArr=isArray(srcValue),isBuff=!isArr&&isBuffer(srcValue),isTyped=!isArr&&!isBuff&&isTypedArray(srcValue);newValue=srcValue,isArr||isBuff||isTyped?isArray(objValue)?newValue=objValue:isArrayLikeObject(objValue)?newValue=copyArray(objValue):isBuff?(isCommon=!1,newValue=cloneBuffer(srcValue,!0)):isTyped?(isCommon=!1,newValue=cloneTypedArray(srcValue,!0)):newValue=[]:isPlainObject(srcValue)||isArguments(srcValue)?(newValue=objValue,isArguments(objValue)?newValue=toPlainObject(objValue):isObject(objValue)&&!isFunction(objValue)||(newValue=initCloneObject(srcValue))):isCommon=!1}isCommon&&(stack.set(srcValue,newValue),mergeFunc(newValue,srcValue,srcIndex,customizer,stack),stack.delete(srcValue)),assignMergeValue(object,key,newValue)}}},function(module,exports,__webpack_require__){var baseGetTag=__webpack_require__(142),getPrototype=__webpack_require__(210),isObjectLike=__webpack_require__(120),funcProto=Function.prototype,objectProto=Object.prototype,funcToString=funcProto.toString,hasOwnProperty=objectProto.hasOwnProperty,objectCtorString=funcToString.call(Object);module.exports=function(value){if(!isObjectLike(value)||"[object Object]"!=baseGetTag(value))return!1;var proto=getPrototype(value);if(null===proto)return!0;var Ctor=hasOwnProperty.call(proto,"constructor")&&proto.constructor;return"function"==typeof Ctor&&Ctor instanceof Ctor&&funcToString.call(Ctor)==objectCtorString}},function(module,exports,__webpack_require__){var copyObject=__webpack_require__(173),keysIn=__webpack_require__(143);module.exports=function(value){return copyObject(value,keysIn(value))}},function(module,exports,__webpack_require__){var baseRest=__webpack_require__(215),isIterateeCall=__webpack_require__(216);module.exports=function(assigner){return baseRest((function(object,sources){var index=-1,length=sources.length,customizer=length>1?sources[length-1]:void 0,guard=length>2?sources[2]:void 0;for(customizer=assigner.length>3&&"function"==typeof customizer?(length--,customizer):void 0,guard&&isIterateeCall(sources[0],sources[1],guard)&&(customizer=length<3?void 0:customizer,length=1),object=Object(object);++index<length;){var source=sources[index];source&&assigner(object,source,index,customizer)}return object}))}},function(module,exports,__webpack_require__){var baseExtremum=__webpack_require__(266),baseLt=__webpack_require__(377),identity=__webpack_require__(144);module.exports=function(array){return array&&array.length?baseExtremum(array,identity,baseLt):void 0}},function(module,exports,__webpack_require__){var baseExtremum=__webpack_require__(266),baseIteratee=__webpack_require__(124),baseLt=__webpack_require__(377);module.exports=function(array,iteratee){return array&&array.length?baseExtremum(array,baseIteratee(iteratee,2),baseLt):void 0}},function(module,exports,__webpack_require__){var root=__webpack_require__(114);module.exports=function(){return root.Date.now()}},function(module,exports,__webpack_require__){var basePick=__webpack_require__(659),pick=__webpack_require__(662)((function(object,paths){return null==object?{}:basePick(object,paths)}));module.exports=pick},function(module,exports,__webpack_require__){var basePickBy=__webpack_require__(660),hasIn=__webpack_require__(355);module.exports=function(object,paths){return basePickBy(object,paths,(function(value,path){return hasIn(object,path)}))}},function(module,exports,__webpack_require__){var baseGet=__webpack_require__(212),baseSet=__webpack_require__(661),castPath=__webpack_require__(213);module.exports=function(object,paths,predicate){for(var index=-1,length=paths.length,result={};++index<length;){var path=paths[index],value=baseGet(object,path);predicate(value,path)&&baseSet(result,castPath(path,object),value)}return result}},function(module,exports,__webpack_require__){var assignValue=__webpack_require__(205),castPath=__webpack_require__(213),isIndex=__webpack_require__(207),isObject=__webpack_require__(109),toKey=__webpack_require__(176);module.exports=function(object,path,value,customizer){if(!isObject(object))return object;for(var index=-1,length=(path=castPath(path,object)).length,lastIndex=length-1,nested=object;null!=nested&&++index<length;){var key=toKey(path[index]),newValue=value;if("__proto__"===key||"constructor"===key||"prototype"===key)return object;if(index!=lastIndex){var objValue=nested[key];void 0===(newValue=customizer?customizer(objValue,key,nested):void 0)&&(newValue=isObject(objValue)?objValue:isIndex(path[index+1])?[]:{})}assignValue(nested,key,newValue),nested=nested[key]}return object}},function(module,exports,__webpack_require__){var flatten=__webpack_require__(374),overRest=__webpack_require__(363),setToString=__webpack_require__(364);module.exports=function(func){return setToString(overRest(func,void 0,flatten),func+"")}},function(module,exports,__webpack_require__){var range=__webpack_require__(664)();module.exports=range},function(module,exports,__webpack_require__){var baseRange=__webpack_require__(665),isIterateeCall=__webpack_require__(216),toFinite=__webpack_require__(373);module.exports=function(fromRight){return function(start,end,step){return step&&"number"!=typeof step&&isIterateeCall(start,end,step)&&(end=step=void 0),start=toFinite(start),void 0===end?(end=start,start=0):end=toFinite(end),step=void 0===step?start<end?1:-1:toFinite(step),baseRange(start,end,step,fromRight)}}},function(module,exports){var nativeCeil=Math.ceil,nativeMax=Math.max;module.exports=function(start,end,step,fromRight){for(var index=-1,length=nativeMax(nativeCeil((end-start)/(step||1)),0),result=Array(length);length--;)result[fromRight?length:++index]=start,start+=step;return result}},function(module,exports,__webpack_require__){var baseFlatten=__webpack_require__(265),baseOrderBy=__webpack_require__(667),baseRest=__webpack_require__(215),isIterateeCall=__webpack_require__(216),sortBy=baseRest((function(collection,iteratees){if(null==collection)return[];var length=iteratees.length;return length>1&&isIterateeCall(collection,iteratees[0],iteratees[1])?iteratees=[]:length>2&&isIterateeCall(iteratees[0],iteratees[1],iteratees[2])&&(iteratees=[iteratees[0]]),baseOrderBy(collection,baseFlatten(iteratees,1),[])}));module.exports=sortBy},function(module,exports,__webpack_require__){var arrayMap=__webpack_require__(214),baseGet=__webpack_require__(212),baseIteratee=__webpack_require__(124),baseMap=__webpack_require__(361),baseSortBy=__webpack_require__(668),baseUnary=__webpack_require__(208),compareMultiple=__webpack_require__(669),identity=__webpack_require__(144),isArray=__webpack_require__(80);module.exports=function(collection,iteratees,orders){iteratees=iteratees.length?arrayMap(iteratees,(function(iteratee){return isArray(iteratee)?function(value){return baseGet(value,1===iteratee.length?iteratee[0]:iteratee)}:iteratee})):[identity];var index=-1;iteratees=arrayMap(iteratees,baseUnary(baseIteratee));var result=baseMap(collection,(function(value,key,collection){return{criteria:arrayMap(iteratees,(function(iteratee){return iteratee(value)})),index:++index,value:value}}));return baseSortBy(result,(function(object,other){return compareMultiple(object,other,orders)}))}},function(module,exports){module.exports=function(array,comparer){var length=array.length;for(array.sort(comparer);length--;)array[length]=array[length].value;return array}},function(module,exports,__webpack_require__){var compareAscending=__webpack_require__(670);module.exports=function(object,other,orders){for(var index=-1,objCriteria=object.criteria,othCriteria=other.criteria,length=objCriteria.length,ordersLength=orders.length;++index<length;){var result=compareAscending(objCriteria[index],othCriteria[index]);if(result)return index>=ordersLength?result:result*("desc"==orders[index]?-1:1)}return object.index-other.index}},function(module,exports,__webpack_require__){var isSymbol=__webpack_require__(156);module.exports=function(value,other){if(value!==other){var valIsDefined=void 0!==value,valIsNull=null===value,valIsReflexive=value==value,valIsSymbol=isSymbol(value),othIsDefined=void 0!==other,othIsNull=null===other,othIsReflexive=other==other,othIsSymbol=isSymbol(other);if(!othIsNull&&!othIsSymbol&&!valIsSymbol&&value>other||valIsSymbol&&othIsDefined&&othIsReflexive&&!othIsNull&&!othIsSymbol||valIsNull&&othIsDefined&&othIsReflexive||!valIsDefined&&othIsReflexive||!valIsReflexive)return 1;if(!valIsNull&&!valIsSymbol&&!othIsSymbol&&value<other||othIsSymbol&&valIsDefined&&valIsReflexive&&!valIsNull&&!valIsSymbol||othIsNull&&valIsDefined&&valIsReflexive||!othIsDefined&&valIsReflexive||!othIsReflexive)return-1}return 0}},function(module,exports,__webpack_require__){var toString=__webpack_require__(354),idCounter=0;module.exports=function(prefix){var id=++idCounter;return toString(prefix)+id}},function(module,exports,__webpack_require__){var assignValue=__webpack_require__(205),baseZipObject=__webpack_require__(673);module.exports=function(props,values){return baseZipObject(props||[],values||[],assignValue)}},function(module,exports){module.exports=function(props,values,assignFunc){for(var index=-1,length=props.length,valsLength=values.length,result={};++index<length;){var value=index<valsLength?values[index]:void 0;assignFunc(result,props[index],value)}return result}},function(module,exports,__webpack_require__){"use strict";var _=__webpack_require__(78),greedyFAS=__webpack_require__(675);module.exports={run:function(g){var fas="greedy"===g.graph().acyclicer?greedyFAS(g,function(g){return function(e){return g.edge(e).weight}}(g)):function(g){var fas=[],stack={},visited={};function dfs(v){_.has(visited,v)||(visited[v]=!0,stack[v]=!0,_.forEach(g.outEdges(v),(function(e){_.has(stack,e.w)?fas.push(e):dfs(e.w)})),delete stack[v])}return _.forEach(g.nodes(),dfs),fas}(g);_.forEach(fas,(function(e){var label=g.edge(e);g.removeEdge(e),label.forwardName=e.name,label.reversed=!0,g.setEdge(e.w,e.v,label,_.uniqueId("rev"))}))},undo:function(g){_.forEach(g.edges(),(function(e){var label=g.edge(e);if(label.reversed){g.removeEdge(e);var forwardName=label.forwardName;delete label.reversed,delete label.forwardName,g.setEdge(e.w,e.v,label,forwardName)}}))}}},function(module,exports,__webpack_require__){var _=__webpack_require__(78),Graph=__webpack_require__(113).Graph,List=__webpack_require__(676);module.exports=function(g,weightFn){if(g.nodeCount()<=1)return[];var state=function(g,weightFn){var fasGraph=new Graph,maxIn=0,maxOut=0;_.forEach(g.nodes(),(function(v){fasGraph.setNode(v,{v:v,in:0,out:0})})),_.forEach(g.edges(),(function(e){var prevWeight=fasGraph.edge(e.v,e.w)||0,weight=weightFn(e),edgeWeight=prevWeight+weight;fasGraph.setEdge(e.v,e.w,edgeWeight),maxOut=Math.max(maxOut,fasGraph.node(e.v).out+=weight),maxIn=Math.max(maxIn,fasGraph.node(e.w).in+=weight)}));var buckets=_.range(maxOut+maxIn+3).map((function(){return new List})),zeroIdx=maxIn+1;return _.forEach(fasGraph.nodes(),(function(v){assignBucket(buckets,zeroIdx,fasGraph.node(v))})),{graph:fasGraph,buckets:buckets,zeroIdx:zeroIdx}}(g,weightFn||DEFAULT_WEIGHT_FN),results=function(g,buckets,zeroIdx){var entry,results=[],sources=buckets[buckets.length-1],sinks=buckets[0];for(;g.nodeCount();){for(;entry=sinks.dequeue();)removeNode(g,buckets,zeroIdx,entry);for(;entry=sources.dequeue();)removeNode(g,buckets,zeroIdx,entry);if(g.nodeCount())for(var i=buckets.length-2;i>0;--i)if(entry=buckets[i].dequeue()){results=results.concat(removeNode(g,buckets,zeroIdx,entry,!0));break}}return results}(state.graph,state.buckets,state.zeroIdx);return _.flatten(_.map(results,(function(e){return g.outEdges(e.v,e.w)})),!0)};var DEFAULT_WEIGHT_FN=_.constant(1);function removeNode(g,buckets,zeroIdx,entry,collectPredecessors){var results=collectPredecessors?[]:void 0;return _.forEach(g.inEdges(entry.v),(function(edge){var weight=g.edge(edge),uEntry=g.node(edge.v);collectPredecessors&&results.push({v:edge.v,w:edge.w}),uEntry.out-=weight,assignBucket(buckets,zeroIdx,uEntry)})),_.forEach(g.outEdges(entry.v),(function(edge){var weight=g.edge(edge),w=edge.w,wEntry=g.node(w);wEntry.in-=weight,assignBucket(buckets,zeroIdx,wEntry)})),g.removeNode(entry.v),results}function assignBucket(buckets,zeroIdx,entry){entry.out?entry.in?buckets[entry.out-entry.in+zeroIdx].enqueue(entry):buckets[buckets.length-1].enqueue(entry):buckets[0].enqueue(entry)}},function(module,exports){function List(){var sentinel={};sentinel._next=sentinel._prev=sentinel,this._sentinel=sentinel}function unlink(entry){entry._prev._next=entry._next,entry._next._prev=entry._prev,delete entry._next,delete entry._prev}function filterOutLinks(k,v){if("_next"!==k&&"_prev"!==k)return v}module.exports=List,List.prototype.dequeue=function(){var sentinel=this._sentinel,entry=sentinel._prev;if(entry!==sentinel)return unlink(entry),entry},List.prototype.enqueue=function(entry){var sentinel=this._sentinel;entry._prev&&entry._next&&unlink(entry),entry._next=sentinel._next,sentinel._next._prev=entry,sentinel._next=entry,entry._prev=sentinel},List.prototype.toString=function(){for(var strs=[],sentinel=this._sentinel,curr=sentinel._prev;curr!==sentinel;)strs.push(JSON.stringify(curr,filterOutLinks)),curr=curr._prev;return"["+strs.join(", ")+"]"}},function(module,exports,__webpack_require__){"use strict";var _=__webpack_require__(78),util=__webpack_require__(102);module.exports={run:function(g){g.graph().dummyChains=[],_.forEach(g.edges(),(function(edge){!function(g,e){var dummy,attrs,i,v=e.v,vRank=g.node(v).rank,w=e.w,wRank=g.node(w).rank,name=e.name,edgeLabel=g.edge(e),labelRank=edgeLabel.labelRank;if(wRank===vRank+1)return;for(g.removeEdge(e),i=0,++vRank;vRank<wRank;++i,++vRank)edgeLabel.points=[],attrs={width:0,height:0,edgeLabel:edgeLabel,edgeObj:e,rank:vRank},dummy=util.addDummyNode(g,"edge",attrs,"_d"),vRank===labelRank&&(attrs.width=edgeLabel.width,attrs.height=edgeLabel.height,attrs.dummy="edge-label",attrs.labelpos=edgeLabel.labelpos),g.setEdge(v,dummy,{weight:edgeLabel.weight},name),0===i&&g.graph().dummyChains.push(dummy),v=dummy;g.setEdge(v,w,{weight:edgeLabel.weight},name)}(g,edge)}))},undo:function(g){_.forEach(g.graph().dummyChains,(function(v){var w,node=g.node(v),origLabel=node.edgeLabel;for(g.setEdge(node.edgeObj,origLabel);node.dummy;)w=g.successors(v)[0],g.removeNode(v),origLabel.points.push({x:node.x,y:node.y}),"edge-label"===node.dummy&&(origLabel.x=node.x,origLabel.y=node.y,origLabel.width=node.width,origLabel.height=node.height),v=w,node=g.node(v)}))}}},function(module,exports,__webpack_require__){"use strict";var longestPath=__webpack_require__(217).longestPath,feasibleTree=__webpack_require__(378),networkSimplex=__webpack_require__(679);module.exports=function(g){switch(g.graph().ranker){case"network-simplex":networkSimplexRanker(g);break;case"tight-tree":!function(g){longestPath(g),feasibleTree(g)}(g);break;case"longest-path":longestPathRanker(g);break;default:networkSimplexRanker(g)}};var longestPathRanker=longestPath;function networkSimplexRanker(g){networkSimplex(g)}},function(module,exports,__webpack_require__){"use strict";var _=__webpack_require__(78),feasibleTree=__webpack_require__(378),slack=__webpack_require__(217).slack,initRank=__webpack_require__(217).longestPath,preorder=__webpack_require__(113).alg.preorder,postorder=__webpack_require__(113).alg.postorder,simplify=__webpack_require__(102).simplify;function networkSimplex(g){g=simplify(g),initRank(g);var e,t=feasibleTree(g);for(initLowLimValues(t),initCutValues(t,g);e=leaveEdge(t);)exchangeEdges(t,g,e,enterEdge(t,g,e))}function initCutValues(t,g){var vs=postorder(t,t.nodes());vs=vs.slice(0,vs.length-1),_.forEach(vs,(function(v){!function(t,g,child){var parent=t.node(child).parent;t.edge(child,parent).cutvalue=calcCutValue(t,g,child)}(t,g,v)}))}function calcCutValue(t,g,child){var parent=t.node(child).parent,childIsTail=!0,graphEdge=g.edge(child,parent),cutValue=0;return graphEdge||(childIsTail=!1,graphEdge=g.edge(parent,child)),cutValue=graphEdge.weight,_.forEach(g.nodeEdges(child),(function(e){var u,v,isOutEdge=e.v===child,other=isOutEdge?e.w:e.v;if(other!==parent){var pointsToHead=isOutEdge===childIsTail,otherWeight=g.edge(e).weight;if(cutValue+=pointsToHead?otherWeight:-otherWeight,u=child,v=other,t.hasEdge(u,v)){var otherCutValue=t.edge(child,other).cutvalue;cutValue+=pointsToHead?-otherCutValue:otherCutValue}}})),cutValue}function initLowLimValues(tree,root){arguments.length<2&&(root=tree.nodes()[0]),dfsAssignLowLim(tree,{},1,root)}function dfsAssignLowLim(tree,visited,nextLim,v,parent){var low=nextLim,label=tree.node(v);return visited[v]=!0,_.forEach(tree.neighbors(v),(function(w){_.has(visited,w)||(nextLim=dfsAssignLowLim(tree,visited,nextLim,w,v))})),label.low=low,label.lim=nextLim++,parent?label.parent=parent:delete label.parent,nextLim}function leaveEdge(tree){return _.find(tree.edges(),(function(e){return tree.edge(e).cutvalue<0}))}function enterEdge(t,g,edge){var v=edge.v,w=edge.w;g.hasEdge(v,w)||(v=edge.w,w=edge.v);var vLabel=t.node(v),wLabel=t.node(w),tailLabel=vLabel,flip=!1;vLabel.lim>wLabel.lim&&(tailLabel=wLabel,flip=!0);var candidates=_.filter(g.edges(),(function(edge){return flip===isDescendant(t,t.node(edge.v),tailLabel)&&flip!==isDescendant(t,t.node(edge.w),tailLabel)}));return _.minBy(candidates,(function(edge){return slack(g,edge)}))}function exchangeEdges(t,g,e,f){var v=e.v,w=e.w;t.removeEdge(v,w),t.setEdge(f.v,f.w,{}),initLowLimValues(t),initCutValues(t,g),function(t,g){var root=_.find(t.nodes(),(function(v){return!g.node(v).parent})),vs=preorder(t,root);vs=vs.slice(1),_.forEach(vs,(function(v){var parent=t.node(v).parent,edge=g.edge(v,parent),flipped=!1;edge||(edge=g.edge(parent,v),flipped=!0),g.node(v).rank=g.node(parent).rank+(flipped?edge.minlen:-edge.minlen)}))}(t,g)}function isDescendant(tree,vLabel,rootLabel){return rootLabel.low<=vLabel.lim&&vLabel.lim<=rootLabel.lim}module.exports=networkSimplex,networkSimplex.initLowLimValues=initLowLimValues,networkSimplex.initCutValues=initCutValues,networkSimplex.calcCutValue=calcCutValue,networkSimplex.leaveEdge=leaveEdge,networkSimplex.enterEdge=enterEdge,networkSimplex.exchangeEdges=exchangeEdges},function(module,exports,__webpack_require__){var _=__webpack_require__(78);module.exports=function(g){var postorderNums=function(g){var result={},lim=0;function dfs(v){var low=lim;_.forEach(g.children(v),dfs),result[v]={low:low,lim:lim++}}return _.forEach(g.children(),dfs),result}(g);_.forEach(g.graph().dummyChains,(function(v){for(var node=g.node(v),edgeObj=node.edgeObj,pathData=function(g,postorderNums,v,w){var parent,lca,vPath=[],wPath=[],low=Math.min(postorderNums[v].low,postorderNums[w].low),lim=Math.max(postorderNums[v].lim,postorderNums[w].lim);parent=v;do{parent=g.parent(parent),vPath.push(parent)}while(parent&&(postorderNums[parent].low>low||lim>postorderNums[parent].lim));lca=parent,parent=w;for(;(parent=g.parent(parent))!==lca;)wPath.push(parent);return{path:vPath.concat(wPath.reverse()),lca:lca}}(g,postorderNums,edgeObj.v,edgeObj.w),path=pathData.path,lca=pathData.lca,pathIdx=0,pathV=path[pathIdx],ascending=!0;v!==edgeObj.w;){if(node=g.node(v),ascending){for(;(pathV=path[pathIdx])!==lca&&g.node(pathV).maxRank<node.rank;)pathIdx++;pathV===lca&&(ascending=!1)}if(!ascending){for(;pathIdx<path.length-1&&g.node(pathV=path[pathIdx+1]).minRank<=node.rank;)pathIdx++;pathV=path[pathIdx]}g.setParent(v,pathV),v=g.successors(v)[0]}}))}},function(module,exports,__webpack_require__){var _=__webpack_require__(78),util=__webpack_require__(102);module.exports={run:function(g){var root=util.addDummyNode(g,"root",{},"_root"),depths=function(g){var depths={};return _.forEach(g.children(),(function(v){!function dfs(v,depth){var children=g.children(v);children&&children.length&&_.forEach(children,(function(child){dfs(child,depth+1)}));depths[v]=depth}(v,1)})),depths}(g),height=_.max(_.values(depths))-1,nodeSep=2*height+1;g.graph().nestingRoot=root,_.forEach(g.edges(),(function(e){g.edge(e).minlen*=nodeSep}));var weight=function(g){return _.reduce(g.edges(),(function(acc,e){return acc+g.edge(e).weight}),0)}(g)+1;_.forEach(g.children(),(function(child){!function dfs(g,root,nodeSep,weight,height,depths,v){var children=g.children(v);if(!children.length)return void(v!==root&&g.setEdge(root,v,{weight:0,minlen:nodeSep}));var top=util.addBorderNode(g,"_bt"),bottom=util.addBorderNode(g,"_bb"),label=g.node(v);g.setParent(top,v),label.borderTop=top,g.setParent(bottom,v),label.borderBottom=bottom,_.forEach(children,(function(child){dfs(g,root,nodeSep,weight,height,depths,child);var childNode=g.node(child),childTop=childNode.borderTop?childNode.borderTop:child,childBottom=childNode.borderBottom?childNode.borderBottom:child,thisWeight=childNode.borderTop?weight:2*weight,minlen=childTop!==childBottom?1:height-depths[v]+1;g.setEdge(top,childTop,{weight:thisWeight,minlen:minlen,nestingEdge:!0}),g.setEdge(childBottom,bottom,{weight:thisWeight,minlen:minlen,nestingEdge:!0})})),g.parent(v)||g.setEdge(root,top,{weight:0,minlen:height+depths[v]})}(g,root,nodeSep,weight,height,depths,child)})),g.graph().nodeRankFactor=nodeSep},cleanup:function(g){var graphLabel=g.graph();g.removeNode(graphLabel.nestingRoot),delete graphLabel.nestingRoot,_.forEach(g.edges(),(function(e){g.edge(e).nestingEdge&&g.removeEdge(e)}))}}},function(module,exports,__webpack_require__){var _=__webpack_require__(78),util=__webpack_require__(102);function addBorderNode(g,prop,prefix,sg,sgNode,rank){var label={width:0,height:0,rank:rank,borderType:prop},prev=sgNode[prop][rank-1],curr=util.addDummyNode(g,"border",label,prefix);sgNode[prop][rank]=curr,g.setParent(curr,sg),prev&&g.setEdge(prev,curr,{weight:1})}module.exports=function(g){_.forEach(g.children(),(function dfs(v){var children=g.children(v),node=g.node(v);if(children.length&&_.forEach(children,dfs),_.has(node,"minRank")){node.borderLeft=[],node.borderRight=[];for(var rank=node.minRank,maxRank=node.maxRank+1;rank<maxRank;++rank)addBorderNode(g,"borderLeft","_bl",v,node,rank),addBorderNode(g,"borderRight","_br",v,node,rank)}}))}},function(module,exports,__webpack_require__){"use strict";var _=__webpack_require__(78);function swapWidthHeight(g){_.forEach(g.nodes(),(function(v){swapWidthHeightOne(g.node(v))})),_.forEach(g.edges(),(function(e){swapWidthHeightOne(g.edge(e))}))}function swapWidthHeightOne(attrs){var w=attrs.width;attrs.width=attrs.height,attrs.height=w}function reverseYOne(attrs){attrs.y=-attrs.y}function swapXYOne(attrs){var x=attrs.x;attrs.x=attrs.y,attrs.y=x}module.exports={adjust:function(g){var rankDir=g.graph().rankdir.toLowerCase();"lr"!==rankDir&&"rl"!==rankDir||swapWidthHeight(g)},undo:function(g){var rankDir=g.graph().rankdir.toLowerCase();"bt"!==rankDir&&"rl"!==rankDir||function(g){_.forEach(g.nodes(),(function(v){reverseYOne(g.node(v))})),_.forEach(g.edges(),(function(e){var edge=g.edge(e);_.forEach(edge.points,reverseYOne),_.has(edge,"y")&&reverseYOne(edge)}))}(g);"lr"!==rankDir&&"rl"!==rankDir||(!function(g){_.forEach(g.nodes(),(function(v){swapXYOne(g.node(v))})),_.forEach(g.edges(),(function(e){var edge=g.edge(e);_.forEach(edge.points,swapXYOne),_.has(edge,"x")&&swapXYOne(edge)}))}(g),swapWidthHeight(g))}}},function(module,exports,__webpack_require__){"use strict";var _=__webpack_require__(78),initOrder=__webpack_require__(685),crossCount=__webpack_require__(686),sortSubgraph=__webpack_require__(687),buildLayerGraph=__webpack_require__(691),addSubgraphConstraints=__webpack_require__(692),Graph=__webpack_require__(113).Graph,util=__webpack_require__(102);function buildLayerGraphs(g,ranks,relationship){return _.map(ranks,(function(rank){return buildLayerGraph(g,rank,relationship)}))}function sweepLayerGraphs(layerGraphs,biasRight){var cg=new Graph;_.forEach(layerGraphs,(function(lg){var root=lg.graph().root,sorted=sortSubgraph(lg,root,cg,biasRight);_.forEach(sorted.vs,(function(v,i){lg.node(v).order=i})),addSubgraphConstraints(lg,cg,sorted.vs)}))}function assignOrder(g,layering){_.forEach(layering,(function(layer){_.forEach(layer,(function(v,i){g.node(v).order=i}))}))}module.exports=function(g){var maxRank=util.maxRank(g),downLayerGraphs=buildLayerGraphs(g,_.range(1,maxRank+1),"inEdges"),upLayerGraphs=buildLayerGraphs(g,_.range(maxRank-1,-1,-1),"outEdges"),layering=initOrder(g);assignOrder(g,layering);for(var best,bestCC=Number.POSITIVE_INFINITY,i=0,lastBest=0;lastBest<4;++i,++lastBest){sweepLayerGraphs(i%2?downLayerGraphs:upLayerGraphs,i%4>=2),layering=util.buildLayerMatrix(g);var cc=crossCount(g,layering);cc<bestCC&&(lastBest=0,best=_.cloneDeep(layering),bestCC=cc)}assignOrder(g,best)}},function(module,exports,__webpack_require__){"use strict";var _=__webpack_require__(78);module.exports=function(g){var visited={},simpleNodes=_.filter(g.nodes(),(function(v){return!g.children(v).length})),maxRank=_.max(_.map(simpleNodes,(function(v){return g.node(v).rank}))),layers=_.map(_.range(maxRank+1),(function(){return[]}));var orderedVs=_.sortBy(simpleNodes,(function(v){return g.node(v).rank}));return _.forEach(orderedVs,(function dfs(v){if(_.has(visited,v))return;visited[v]=!0;var node=g.node(v);layers[node.rank].push(v),_.forEach(g.successors(v),dfs)})),layers}},function(module,exports,__webpack_require__){"use strict";var _=__webpack_require__(78);function twoLayerCrossCount(g,northLayer,southLayer){for(var southPos=_.zipObject(southLayer,_.map(southLayer,(function(v,i){return i}))),southEntries=_.flatten(_.map(northLayer,(function(v){return _.sortBy(_.map(g.outEdges(v),(function(e){return{pos:southPos[e.w],weight:g.edge(e).weight}})),"pos")})),!0),firstIndex=1;firstIndex<southLayer.length;)firstIndex<<=1;var treeSize=2*firstIndex-1;firstIndex-=1;var tree=_.map(new Array(treeSize),(function(){return 0})),cc=0;return _.forEach(southEntries.forEach((function(entry){var index=entry.pos+firstIndex;tree[index]+=entry.weight;for(var weightSum=0;index>0;)index%2&&(weightSum+=tree[index+1]),tree[index=index-1>>1]+=entry.weight;cc+=entry.weight*weightSum}))),cc}module.exports=function(g,layering){for(var cc=0,i=1;i<layering.length;++i)cc+=twoLayerCrossCount(g,layering[i-1],layering[i]);return cc}},function(module,exports,__webpack_require__){var _=__webpack_require__(78),barycenter=__webpack_require__(688),resolveConflicts=__webpack_require__(689),sort=__webpack_require__(690);module.exports=function sortSubgraph(g,v,cg,biasRight){var movable=g.children(v),node=g.node(v),bl=node?node.borderLeft:void 0,br=node?node.borderRight:void 0,subgraphs={};bl&&(movable=_.filter(movable,(function(w){return w!==bl&&w!==br})));var barycenters=barycenter(g,movable);_.forEach(barycenters,(function(entry){if(g.children(entry.v).length){var subgraphResult=sortSubgraph(g,entry.v,cg,biasRight);subgraphs[entry.v]=subgraphResult,_.has(subgraphResult,"barycenter")&&(target=entry,other=subgraphResult,_.isUndefined(target.barycenter)?(target.barycenter=other.barycenter,target.weight=other.weight):(target.barycenter=(target.barycenter*target.weight+other.barycenter*other.weight)/(target.weight+other.weight),target.weight+=other.weight))}var target,other}));var entries=resolveConflicts(barycenters,cg);!function(entries,subgraphs){_.forEach(entries,(function(entry){entry.vs=_.flatten(entry.vs.map((function(v){return subgraphs[v]?subgraphs[v].vs:v})),!0)}))}(entries,subgraphs);var result=sort(entries,biasRight);if(bl&&(result.vs=_.flatten([bl,result.vs,br],!0),g.predecessors(bl).length)){var blPred=g.node(g.predecessors(bl)[0]),brPred=g.node(g.predecessors(br)[0]);_.has(result,"barycenter")||(result.barycenter=0,result.weight=0),result.barycenter=(result.barycenter*result.weight+blPred.order+brPred.order)/(result.weight+2),result.weight+=2}return result}},function(module,exports,__webpack_require__){var _=__webpack_require__(78);module.exports=function(g,movable){return _.map(movable,(function(v){var inV=g.inEdges(v);if(inV.length){var result=_.reduce(inV,(function(acc,e){var edge=g.edge(e),nodeU=g.node(e.v);return{sum:acc.sum+edge.weight*nodeU.order,weight:acc.weight+edge.weight}}),{sum:0,weight:0});return{v:v,barycenter:result.sum/result.weight,weight:result.weight}}return{v:v}}))}},function(module,exports,__webpack_require__){"use strict";var _=__webpack_require__(78);module.exports=function(entries,cg){var mappedEntries={};return _.forEach(entries,(function(entry,i){var tmp=mappedEntries[entry.v]={indegree:0,in:[],out:[],vs:[entry.v],i:i};_.isUndefined(entry.barycenter)||(tmp.barycenter=entry.barycenter,tmp.weight=entry.weight)})),_.forEach(cg.edges(),(function(e){var entryV=mappedEntries[e.v],entryW=mappedEntries[e.w];_.isUndefined(entryV)||_.isUndefined(entryW)||(entryW.indegree++,entryV.out.push(mappedEntries[e.w]))})),function(sourceSet){var entries=[];function handleIn(vEntry){return function(uEntry){uEntry.merged||(_.isUndefined(uEntry.barycenter)||_.isUndefined(vEntry.barycenter)||uEntry.barycenter>=vEntry.barycenter)&&function(target,source){var sum=0,weight=0;target.weight&&(sum+=target.barycenter*target.weight,weight+=target.weight);source.weight&&(sum+=source.barycenter*source.weight,weight+=source.weight);target.vs=source.vs.concat(target.vs),target.barycenter=sum/weight,target.weight=weight,target.i=Math.min(source.i,target.i),source.merged=!0}(vEntry,uEntry)}}function handleOut(vEntry){return function(wEntry){wEntry.in.push(vEntry),0==--wEntry.indegree&&sourceSet.push(wEntry)}}for(;sourceSet.length;){var entry=sourceSet.pop();entries.push(entry),_.forEach(entry.in.reverse(),handleIn(entry)),_.forEach(entry.out,handleOut(entry))}return _.map(_.filter(entries,(function(entry){return!entry.merged})),(function(entry){return _.pick(entry,["vs","i","barycenter","weight"])}))}(_.filter(mappedEntries,(function(entry){return!entry.indegree})))}},function(module,exports,__webpack_require__){var _=__webpack_require__(78),util=__webpack_require__(102);function consumeUnsortable(vs,unsortable,index){for(var last;unsortable.length&&(last=_.last(unsortable)).i<=index;)unsortable.pop(),vs.push(last.vs),index++;return index}module.exports=function(entries,biasRight){var parts=util.partition(entries,(function(entry){return _.has(entry,"barycenter")})),sortable=parts.lhs,unsortable=_.sortBy(parts.rhs,(function(entry){return-entry.i})),vs=[],sum=0,weight=0,vsIndex=0;sortable.sort((bias=!!biasRight,function(entryV,entryW){return entryV.barycenter<entryW.barycenter?-1:entryV.barycenter>entryW.barycenter?1:bias?entryW.i-entryV.i:entryV.i-entryW.i})),vsIndex=consumeUnsortable(vs,unsortable,vsIndex),_.forEach(sortable,(function(entry){vsIndex+=entry.vs.length,vs.push(entry.vs),sum+=entry.barycenter*entry.weight,weight+=entry.weight,vsIndex=consumeUnsortable(vs,unsortable,vsIndex)}));var bias;var result={vs:_.flatten(vs,!0)};weight&&(result.barycenter=sum/weight,result.weight=weight);return result}},function(module,exports,__webpack_require__){var _=__webpack_require__(78),Graph=__webpack_require__(113).Graph;module.exports=function(g,rank,relationship){var root=function(g){var v;for(;g.hasNode(v=_.uniqueId("_root")););return v}(g),result=new Graph({compound:!0}).setGraph({root:root}).setDefaultNodeLabel((function(v){return g.node(v)}));return _.forEach(g.nodes(),(function(v){var node=g.node(v),parent=g.parent(v);(node.rank===rank||node.minRank<=rank&&rank<=node.maxRank)&&(result.setNode(v),result.setParent(v,parent||root),_.forEach(g[relationship](v),(function(e){var u=e.v===v?e.w:e.v,edge=result.edge(u,v),weight=_.isUndefined(edge)?0:edge.weight;result.setEdge(u,v,{weight:g.edge(e).weight+weight})})),_.has(node,"minRank")&&result.setNode(v,{borderLeft:node.borderLeft[rank],borderRight:node.borderRight[rank]}))})),result}},function(module,exports,__webpack_require__){var _=__webpack_require__(78);module.exports=function(g,cg,vs){var rootPrev,prev={};_.forEach(vs,(function(v){for(var parent,prevChild,child=g.parent(v);child;){if((parent=g.parent(child))?(prevChild=prev[parent],prev[parent]=child):(prevChild=rootPrev,rootPrev=child),prevChild&&prevChild!==child)return void cg.setEdge(prevChild,child);child=parent}}))}},function(module,exports,__webpack_require__){"use strict";var _=__webpack_require__(78),util=__webpack_require__(102),positionX=__webpack_require__(694).positionX;module.exports=function(g){(function(g){var layering=util.buildLayerMatrix(g),rankSep=g.graph().ranksep,prevY=0;_.forEach(layering,(function(layer){var maxHeight=_.max(_.map(layer,(function(v){return g.node(v).height})));_.forEach(layer,(function(v){g.node(v).y=prevY+maxHeight/2})),prevY+=maxHeight+rankSep}))})(g=util.asNonCompoundGraph(g)),_.forEach(positionX(g),(function(x,v){g.node(v).x=x}))}},function(module,exports,__webpack_require__){"use strict";var _=__webpack_require__(78),Graph=__webpack_require__(113).Graph,util=__webpack_require__(102);function findType1Conflicts(g,layering){var conflicts={};return _.reduce(layering,(function(prevLayer,layer){var k0=0,scanPos=0,prevLayerLength=prevLayer.length,lastNode=_.last(layer);return _.forEach(layer,(function(v,i){var w=function(g,v){if(g.node(v).dummy)return _.find(g.predecessors(v),(function(u){return g.node(u).dummy}))}(g,v),k1=w?g.node(w).order:prevLayerLength;(w||v===lastNode)&&(_.forEach(layer.slice(scanPos,i+1),(function(scanNode){_.forEach(g.predecessors(scanNode),(function(u){var uLabel=g.node(u),uPos=uLabel.order;!(uPos<k0||k1<uPos)||uLabel.dummy&&g.node(scanNode).dummy||addConflict(conflicts,u,scanNode)}))})),scanPos=i+1,k0=k1)})),layer})),conflicts}function findType2Conflicts(g,layering){var conflicts={};function scan(south,southPos,southEnd,prevNorthBorder,nextNorthBorder){var v;_.forEach(_.range(southPos,southEnd),(function(i){v=south[i],g.node(v).dummy&&_.forEach(g.predecessors(v),(function(u){var uNode=g.node(u);uNode.dummy&&(uNode.order<prevNorthBorder||uNode.order>nextNorthBorder)&&addConflict(conflicts,u,v)}))}))}return _.reduce(layering,(function(north,south){var nextNorthPos,prevNorthPos=-1,southPos=0;return _.forEach(south,(function(v,southLookahead){if("border"===g.node(v).dummy){var predecessors=g.predecessors(v);predecessors.length&&(nextNorthPos=g.node(predecessors[0]).order,scan(south,southPos,southLookahead,prevNorthPos,nextNorthPos),southPos=southLookahead,prevNorthPos=nextNorthPos)}scan(south,southPos,south.length,nextNorthPos,north.length)})),south})),conflicts}function addConflict(conflicts,v,w){if(v>w){var tmp=v;v=w,w=tmp}var conflictsV=conflicts[v];conflictsV||(conflicts[v]=conflictsV={}),conflictsV[w]=!0}function hasConflict(conflicts,v,w){if(v>w){var tmp=v;v=w,w=tmp}return _.has(conflicts[v],w)}function verticalAlignment(g,layering,conflicts,neighborFn){var root={},align={},pos={};return _.forEach(layering,(function(layer){_.forEach(layer,(function(v,order){root[v]=v,align[v]=v,pos[v]=order}))})),_.forEach(layering,(function(layer){var prevIdx=-1;_.forEach(layer,(function(v){var ws=neighborFn(v);if(ws.length)for(var mp=((ws=_.sortBy(ws,(function(w){return pos[w]}))).length-1)/2,i=Math.floor(mp),il=Math.ceil(mp);i<=il;++i){var w=ws[i];align[v]===v&&prevIdx<pos[w]&&!hasConflict(conflicts,v,w)&&(align[w]=v,align[v]=root[v]=root[w],prevIdx=pos[w])}}))})),{root:root,align:align}}function horizontalCompaction(g,layering,root,align,reverseSep){var xs={},blockG=function(g,layering,root,reverseSep){var blockGraph=new Graph,graphLabel=g.graph(),sepFn=function(nodeSep,edgeSep,reverseSep){return function(g,v,w){var delta,vLabel=g.node(v),wLabel=g.node(w),sum=0;if(sum+=vLabel.width/2,_.has(vLabel,"labelpos"))switch(vLabel.labelpos.toLowerCase()){case"l":delta=-vLabel.width/2;break;case"r":delta=vLabel.width/2}if(delta&&(sum+=reverseSep?delta:-delta),delta=0,sum+=(vLabel.dummy?edgeSep:nodeSep)/2,sum+=(wLabel.dummy?edgeSep:nodeSep)/2,sum+=wLabel.width/2,_.has(wLabel,"labelpos"))switch(wLabel.labelpos.toLowerCase()){case"l":delta=wLabel.width/2;break;case"r":delta=-wLabel.width/2}return delta&&(sum+=reverseSep?delta:-delta),delta=0,sum}}(graphLabel.nodesep,graphLabel.edgesep,reverseSep);return _.forEach(layering,(function(layer){var u;_.forEach(layer,(function(v){var vRoot=root[v];if(blockGraph.setNode(vRoot),u){var uRoot=root[u],prevMax=blockGraph.edge(uRoot,vRoot);blockGraph.setEdge(uRoot,vRoot,Math.max(sepFn(g,v,u),prevMax||0))}u=v}))})),blockGraph}(g,layering,root,reverseSep),borderType=reverseSep?"borderLeft":"borderRight";function iterate(setXsFunc,nextNodesFunc){for(var stack=blockG.nodes(),elem=stack.pop(),visited={};elem;)visited[elem]?setXsFunc(elem):(visited[elem]=!0,stack.push(elem),stack=stack.concat(nextNodesFunc(elem))),elem=stack.pop()}return iterate((function(elem){xs[elem]=blockG.inEdges(elem).reduce((function(acc,e){return Math.max(acc,xs[e.v]+blockG.edge(e))}),0)}),blockG.predecessors.bind(blockG)),iterate((function(elem){var min=blockG.outEdges(elem).reduce((function(acc,e){return Math.min(acc,xs[e.w]-blockG.edge(e))}),Number.POSITIVE_INFINITY),node=g.node(elem);min!==Number.POSITIVE_INFINITY&&node.borderType!==borderType&&(xs[elem]=Math.max(xs[elem],min))}),blockG.successors.bind(blockG)),_.forEach(align,(function(v){xs[v]=xs[root[v]]})),xs}function findSmallestWidthAlignment(g,xss){return _.minBy(_.values(xss),(function(xs){var max=Number.NEGATIVE_INFINITY,min=Number.POSITIVE_INFINITY;return _.forIn(xs,(function(x,v){var halfWidth=function(g,v){return g.node(v).width}(g,v)/2;max=Math.max(x+halfWidth,max),min=Math.min(x-halfWidth,min)})),max-min}))}function alignCoordinates(xss,alignTo){var alignToVals=_.values(alignTo),alignToMin=_.min(alignToVals),alignToMax=_.max(alignToVals);_.forEach(["u","d"],(function(vert){_.forEach(["l","r"],(function(horiz){var delta,alignment=vert+horiz,xs=xss[alignment];if(xs!==alignTo){var xsVals=_.values(xs);(delta="l"===horiz?alignToMin-_.min(xsVals):alignToMax-_.max(xsVals))&&(xss[alignment]=_.mapValues(xs,(function(x){return x+delta})))}}))}))}function balance(xss,align){return _.mapValues(xss.ul,(function(ignore,v){if(align)return xss[align.toLowerCase()][v];var xs=_.sortBy(_.map(xss,v));return(xs[1]+xs[2])/2}))}module.exports={positionX:function(g){var adjustedLayering,layering=util.buildLayerMatrix(g),conflicts=_.merge(findType1Conflicts(g,layering),findType2Conflicts(g,layering)),xss={};_.forEach(["u","d"],(function(vert){adjustedLayering="u"===vert?layering:_.values(layering).reverse(),_.forEach(["l","r"],(function(horiz){"r"===horiz&&(adjustedLayering=_.map(adjustedLayering,(function(inner){return _.values(inner).reverse()})));var neighborFn=("u"===vert?g.predecessors:g.successors).bind(g),align=verticalAlignment(g,adjustedLayering,conflicts,neighborFn),xs=horizontalCompaction(g,adjustedLayering,align.root,align.align,"r"===horiz);"r"===horiz&&(xs=_.mapValues(xs,(function(x){return-x}))),xss[vert+horiz]=xs}))}));var smallestWidth=findSmallestWidthAlignment(g,xss);return alignCoordinates(xss,smallestWidth),balance(xss,g.graph().align)},findType1Conflicts:findType1Conflicts,findType2Conflicts:findType2Conflicts,addConflict:addConflict,hasConflict:hasConflict,verticalAlignment:verticalAlignment,horizontalCompaction:horizontalCompaction,alignCoordinates:alignCoordinates,findSmallestWidthAlignment:findSmallestWidthAlignment,balance:balance}},function(module,exports,__webpack_require__){var _=__webpack_require__(78),util=__webpack_require__(102),Graph=__webpack_require__(113).Graph;module.exports={debugOrdering:function(g){var layerMatrix=util.buildLayerMatrix(g),h=new Graph({compound:!0,multigraph:!0}).setGraph({});return _.forEach(g.nodes(),(function(v){h.setNode(v,{label:v}),h.setParent(v,"layer"+g.node(v).rank)})),_.forEach(g.edges(),(function(e){h.setEdge(e.v,e.w,{},e.name)})),_.forEach(layerMatrix,(function(layer,i){var layerV="layer"+i;h.setNode(layerV,{rank:"same"}),_.reduce(layer,(function(u,v){return h.setEdge(u,v,{style:"invis"}),v}))})),h}}},function(module,exports){module.exports="0.8.5"},function(module,exports){module.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMiIgaGVpZ2h0PSIzMiIgdmlld0JveD0iMCAwIDMyIDMyIiBmaWxsPSIjMzQzNzQxIj4KICA8cGF0aCBkPSJNNi45OTk4NSAxNnY1LjAwMDJIOS4wMzc5QzkuMDEyOCAyMS4zMzAxIDkgMjEuNjYzNiA5IDIyYzAgLjMzNjQuMDEyOC42Njk5LjAzNzkuOTk5OEg2Ljk5OTg1VjI4aC0xLjk5OTd2LTUuMDAwMkgwdi0xLjk5OTZoNS4wMDAxNVYxNmgxLjk5OTd6bTAtMTZ2NS4wMDAxNUgxMnYxLjk5OTdINi45OTk4NVYxMmgtMS45OTk3VjYuOTk5ODVIMHYtMS45OTk3aDUuMDAwMTVWMGgxLjk5OTd6TTIyLjk5OTggMHY1LjAwMDE1SDI4djEuOTk5N2gtNS4wMDAyVjkuMDM3OUMyMi42Njk5IDkuMDEyOCAyMi4zMzY0IDkgMjIgOWMtLjMzNjQgMC0uNjY5OS4wMTI4LS45OTk4LjAzNzlWNi45OTk4NUgxNnYtMS45OTk3aDUuMDAwMlYwaDEuOTk5NnoiIC8+CiAgICA8cGF0aAogICAgICBmaWxsPSIjMDE3RDczIgogICAgICBkPSJNMjIgMTBjMy4wNzM0IDAgNS44NzcgMS4xNTU0IDggMy4wNTU2djMuMjUyNWMtLjMxNS0uNDQyNy0uNjY4Mi0uODYxMy0xLjA1NzUtMS4yNTA2LTEuODQxMy0xLjg0MTMtNC4zMzg2LTIuODc1Ny02Ljk0MjUtMi44NzU3LTUuNDIyNCAwLTkuODE4MiA0LjM5NTgtOS44MTgyIDkuODE4MiAwIDMuMzAwMSAxLjYyODIgNi4yMTk5IDQuMTI1MSA4aC0zLjI1MTNDMTEuMTU1NCAyNy44NzcgMTAgMjUuMDczNCAxMCAyMmMwLTYuNjI3NCA1LjM3MjYtMTIgMTItMTJ6bS45OTk4IDh2My4wMDAySDI2djEuOTk5NmgtMy4wMDAyVjI2aC0xLjk5OTZ2LTMuMDAwMkgxOHYtMS45OTk2aDMuMDAwMlYxOGgxLjk5OTZ6IgogICAgLz4KPC9zdmc+Cg=="},function(module,exports){module.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMiIgaGVpZ2h0PSIzMiIgdmlld0JveD0iMCAwIDMyIDMyIiBmaWxsPSIjMzQzNzQxIj4KICAgIDxwYXRoIGQ9Ik0yIDEydjZoNnYySDB2LThoMnptMTggMHY4aC04di0yaDZ2LTZoMnpNOCAwdjJIMnY2SDBWMGg4em0xMiAwdjhoLTJWMmgtNlYwaDh6IiAvPgogICAgPHBhdGgKICAgICAgZmlsbD0iIzAxN0Q3MyIKICAgICAgZD0iTTE2IDI0YzIuMjA5MSAwIDQgMS43OTA5IDQgNCAwIDIuMjA5MS0xLjc5MDkgNC00IDQtMi4yMDkxIDAtNC0xLjc5MDktNC00IDAtMi4yMDkxIDEuNzkwOS00IDQtNHptMTIgMGMyLjIwOTEgMCA0IDEuNzkwOSA0IDQgMCAyLjIwOTEtMS43OTA5IDQtNCA0LTIuMjA5MSAwLTQtMS43OTA5LTQtNCAwLTIuMjA5MSAxLjc5MDktNCA0LTR6bS0xMiAxLjc1Yy0xLjI0MjYgMC0yLjI1IDEuMDA3NC0yLjI1IDIuMjVzMS4wMDc0IDIuMjUgMi4yNSAyLjI1IDIuMjUtMS4wMDc0IDIuMjUtMi4yNS0xLjAwNzQtMi4yNS0yLjI1LTIuMjV6bTEyIDBjLTEuMjQyNiAwLTIuMjUgMS4wMDc0LTIuMjUgMi4yNXMxLjAwNzQgMi4yNSAyLjI1IDIuMjUgMi4yNS0xLjAwNzQgMi4yNS0yLjI1LTEuMDA3NC0yLjI1LTIuMjUtMi4yNXpNMjggMTJjMi4yMDkxIDAgNCAxLjc5MDkgNCA0IDAgMi4yMDkxLTEuNzkwOSA0LTQgNC0yLjIwOTEgMC00LTEuNzkwOS00LTQgMC0yLjIwOTEgMS43OTA5LTQgNC00em0wIDEuNzVjLTEuMjQyNiAwLTIuMjUgMS4wMDc0LTIuMjUgMi4yNXMxLjAwNzQgMi4yNSAyLjI1IDIuMjUgMi4yNS0xLjAwNzQgMi4yNS0yLjI1LTEuMDA3NC0yLjI1LTIuMjUtMi4yNXpNMTAgNmMyLjIwOTEgMCA0IDEuNzkwODYgNCA0IDAgMi4yMDkxLTEuNzkwOSA0LTQgNC0yLjIwOTE0IDAtNC0xLjc5MDktNC00IDAtMi4yMDkxNCAxLjc5MDg2LTQgNC00em0wIDEuNzVjLTEuMjQyNjQgMC0yLjI1IDEuMDA3MzYtMi4yNSAyLjI1IDAgMS4yNDI2IDEuMDA3MzYgMi4yNSAyLjI1IDIuMjUgMS4yNDI2IDAgMi4yNS0xLjAwNzQgMi4yNS0yLjI1IDAtMS4yNDI2NC0xLjAwNzQtMi4yNS0yLjI1LTIuMjV6IgogICAgLz4KPC9zdmc+Cg=="},function(module,exports){module.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMiIgaGVpZ2h0PSIzMiIgdmlld0JveD0iMCAwIDMyIDMyIiBmaWxsPSIjMzQzNzQxIj4KICA8cGF0aCBkPSJNMjQgMGM0LjQxODMgMCA4IDMuNTgxNzIgOCA4IDAgMi4xMjE3LS44NDI5IDQuMTU2Ni0yLjM0MzEgNS42NTY5QzI4LjE1NjYgMTUuMTU3MSAyNi4xMjE3IDE2IDI0IDE2Yy0xLjg0ODcgMC0zLjU1MDktLjYyNzEtNC45MDU2LTEuNjgwMWwtNC43NzQ1IDQuNzc0NUMxNS4zNzI5IDIwLjQ0OTEgMTYgMjIuMTUxMyAxNiAyNGMwIDIuMTIxNy0uODQyOSA0LjE1NjYtMi4zNDMxIDUuNjU2OUMxMi4xNTY2IDMxLjE1NzEgMTAuMTIxNyAzMiA4IDMyYy00LjQxODI4IDAtOC0zLjU4MTctOC04czMuNTgxNzItOCA4LThjMS44NDg3MiAwIDMuNTUxLjYyNzEgNC45MDU3IDEuNjgwMmw0Ljc3NDUtNC43NzQ1QzE2LjYyNzEgMTEuNTUxIDE2IDkuODQ4NzIgMTYgOGMwLTQuNDE4MjggMy41ODE3LTggOC04ek04IDE4Yy0zLjMxMzcxIDAtNiAyLjY4NjMtNiA2czIuNjg2MjkgNiA2IDZjMy4zMTM3IDAgNi0yLjY4NjMgNi02IDAtMS41OTEzLS42MzIxLTMuMTE3NC0xLjc1NzQtNC4yNDI2QzExLjExNzQgMTguNjMyMSA5LjU5MTMgMTggOCAxOHpNMjQgMmMtMy4zMTM3IDAtNiAyLjY4NjI5LTYgNiAwIDMuMzEzNyAyLjY4NjMgNiA2IDZzNi0yLjY4NjMgNi02YzAtMS41OTEzLS42MzIxLTMuMTE3NDItMS43NTc0LTQuMjQyNjRDMjcuMTE3NCAyLjYzMjE0IDI1LjU5MTMgMiAyNCAyeiIvPgogIDxwYXRoIGZpbGw9IiMwMTdENzMiICBkPSJNMzIgMjB2MTJIMjBWMjBoMTJ6bS0yIDJoLTh2OGg4di04ek0xMiAwdjEySDBWMGgxMnptLTIgMkgydjhoOFYyeiIvPgo8L3N2Zz4K"},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var tslib_1=__webpack_require__(35),react_1=__webpack_require__(14),useRafState_1=tslib_1.__importDefault(__webpack_require__(701)),util_1=__webpack_require__(703);exports.default=function(initialWidth,initialHeight){void 0===initialWidth&&(initialWidth=1/0),void 0===initialHeight&&(initialHeight=1/0);var _a=useRafState_1.default({width:util_1.isClient?window.innerWidth:initialWidth,height:util_1.isClient?window.innerHeight:initialHeight}),state=_a[0],setState=_a[1];return react_1.useEffect((function(){if(util_1.isClient){var handler_1=function(){setState({width:window.innerWidth,height:window.innerHeight})};return window.addEventListener("resize",handler_1),function(){window.removeEventListener("resize",handler_1)}}}),[]),state}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var tslib_1=__webpack_require__(35),react_1=__webpack_require__(14),useUnmount_1=tslib_1.__importDefault(__webpack_require__(702));exports.default=function(initialState){var frame=react_1.useRef(0),_a=react_1.useState(initialState),state=_a[0],setState=_a[1],setRafState=react_1.useCallback((function(value){cancelAnimationFrame(frame.current),frame.current=requestAnimationFrame((function(){setState(value)}))}),[]);return useUnmount_1.default((function(){cancelAnimationFrame(frame.current)})),[state,setRafState]}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var tslib_1=__webpack_require__(35),react_1=__webpack_require__(14),useEffectOnce_1=tslib_1.__importDefault(__webpack_require__(267));exports.default=function(fn){var fnRef=react_1.useRef(fn);fnRef.current=fn,useEffectOnce_1.default((function(){return function(){return fnRef.current()}}))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isDeepEqual=exports.off=exports.on=exports.isClient=void 0;var react_1=__webpack_require__(35).__importDefault(__webpack_require__(704));exports.isClient="object"==typeof window,exports.on=function(obj){for(var args=[],_i=1;_i<arguments.length;_i++)args[_i-1]=arguments[_i];return obj.addEventListener.apply(obj,args)},exports.off=function(obj){for(var args=[],_i=1;_i<arguments.length;_i++)args[_i-1]=arguments[_i];return obj.removeEventListener.apply(obj,args)},exports.isDeepEqual=react_1.default},function(module,exports,__webpack_require__){"use strict";module.exports=function equal(a,b){if(a===b)return!0;if(a&&b&&"object"==typeof a&&"object"==typeof b){if(a.constructor!==b.constructor)return!1;var length,i,keys;if(Array.isArray(a)){if((length=a.length)!=b.length)return!1;for(i=length;0!=i--;)if(!equal(a[i],b[i]))return!1;return!0}if(a.constructor===RegExp)return a.source===b.source&&a.flags===b.flags;if(a.valueOf!==Object.prototype.valueOf)return a.valueOf()===b.valueOf();if(a.toString!==Object.prototype.toString)return a.toString()===b.toString();if((length=(keys=Object.keys(a)).length)!==Object.keys(b).length)return!1;for(i=length;0!=i--;)if(!Object.prototype.hasOwnProperty.call(b,keys[i]))return!1;for(i=length;0!=i--;){var key=keys[i];if(("_owner"!==key||!a.$$typeof)&&!equal(a[key],b[key]))return!1}return!0}return a!=a&&b!=b}},function(module,exports,__webpack_require__){switch(window.__kbnThemeTag__){case"v7dark":return __webpack_require__(706);case"v7light":return __webpack_require__(708);case"v8dark":return __webpack_require__(710);case"v8light":return __webpack_require__(712)}},function(module,exports,__webpack_require__){var api=__webpack_require__(65),content=__webpack_require__(707);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){(exports=__webpack_require__(66)(!1)).push([module.i,".mlScatterplotMatrix{overflow-x:auto}.mlScatterplotMatrix .vega-bind span{font-size:12px;padding:0 4px}\n",""]),module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(65),content=__webpack_require__(709);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){(exports=__webpack_require__(66)(!1)).push([module.i,".mlScatterplotMatrix{overflow-x:auto}.mlScatterplotMatrix .vega-bind span{font-size:12px;padding:0 4px}\n",""]),module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(65),content=__webpack_require__(711);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){(exports=__webpack_require__(66)(!1)).push([module.i,".mlScatterplotMatrix{overflow-x:auto}.mlScatterplotMatrix .vega-bind span{font-size:12px;padding:0 4px}\n",""]),module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(65),content=__webpack_require__(713);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){(exports=__webpack_require__(66)(!1)).push([module.i,".mlScatterplotMatrix{overflow-x:auto}.mlScatterplotMatrix .vega-bind span{font-size:12px;padding:0 4px}\n",""]),module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(65),content=__webpack_require__(715);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){(exports=__webpack_require__(66)(!1)).push([module.i,".mlExpandableSection{padding:0 8px 8px 8px}.mlExpandableSection-contentPadding{padding:8px}[id^='echTooltipPortal']{z-index:9000 !important}\n",""]),module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(65),content=__webpack_require__(717);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){(exports=__webpack_require__(66)(!1)).push([module.i,".mlExpandableSection{padding:0 8px 8px 8px}.mlExpandableSection-contentPadding{padding:8px}[id^='echTooltipPortal']{z-index:9000 !important}\n",""]),module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(65),content=__webpack_require__(719);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){(exports=__webpack_require__(66)(!1)).push([module.i,".mlExpandableSection{padding:0 8px 8px 8px}.mlExpandableSection-contentPadding{padding:8px}[id^='echTooltipPortal']{z-index:9000 !important}\n",""]),module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(65),content=__webpack_require__(721);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){(exports=__webpack_require__(66)(!1)).push([module.i,".mlExpandableSection{padding:0 8px 8px 8px}.mlExpandableSection-contentPadding{padding:8px}[id^='echTooltipPortal']{z-index:9000 !important}\n",""]),module.exports=exports},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var react_1=__webpack_require__(14),useFirstMountState_1=__webpack_require__(723);exports.default=function(effect,deps){var isFirstMount=useFirstMountState_1.useFirstMountState();react_1.useEffect((function(){if(!isFirstMount)return effect()}),deps)}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.useFirstMountState=void 0;var react_1=__webpack_require__(14);exports.useFirstMountState=function(){var isFirst=react_1.useRef(!0);return isFirst.current?(isFirst.current=!1,!0):isFirst.current}},function(module,exports,__webpack_require__){switch(window.__kbnThemeTag__){case"v7dark":return __webpack_require__(725);case"v7light":return __webpack_require__(727);case"v8dark":return __webpack_require__(729);case"v8light":return __webpack_require__(731)}},function(module,exports,__webpack_require__){var api=__webpack_require__(65),content=__webpack_require__(726);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){(exports=__webpack_require__(66)(!1)).push([module.i,".mlDataFrameAnalyticsClassification{width:100%}.mlDataFrameAnalyticsClassification__evaluateSectionContent{padding:0 5%}.mlDataFrameAnalyticsClassification__evaluateSectionContent:after{content:'';display:table;clear:both}.mlDataFrameAnalyticsClassification__actualLabel{float:left;width:80px;padding-top:64px}.mlDataFrameAnalyticsClassification__dataGridMinWidth{float:left;min-width:480px;width:calc(100% - 80px)}.mlDataFrameAnalyticsClassification__dataGridMinWidth .euiDataGridRowCell--boolean{text-transform:none}\n",""]),module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(65),content=__webpack_require__(728);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){(exports=__webpack_require__(66)(!1)).push([module.i,".mlDataFrameAnalyticsClassification{width:100%}.mlDataFrameAnalyticsClassification__evaluateSectionContent{padding:0 5%}.mlDataFrameAnalyticsClassification__evaluateSectionContent:after{content:'';display:table;clear:both}.mlDataFrameAnalyticsClassification__actualLabel{float:left;width:80px;padding-top:64px}.mlDataFrameAnalyticsClassification__dataGridMinWidth{float:left;min-width:480px;width:calc(100% - 80px)}.mlDataFrameAnalyticsClassification__dataGridMinWidth .euiDataGridRowCell--boolean{text-transform:none}\n",""]),module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(65),content=__webpack_require__(730);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){(exports=__webpack_require__(66)(!1)).push([module.i,".mlDataFrameAnalyticsClassification{width:100%}.mlDataFrameAnalyticsClassification__evaluateSectionContent{padding:0 5%}.mlDataFrameAnalyticsClassification__evaluateSectionContent:after{content:'';display:table;clear:both}.mlDataFrameAnalyticsClassification__actualLabel{float:left;width:80px;padding-top:64px}.mlDataFrameAnalyticsClassification__dataGridMinWidth{float:left;min-width:480px;width:calc(100% - 80px)}.mlDataFrameAnalyticsClassification__dataGridMinWidth .euiDataGridRowCell--boolean{text-transform:none}\n",""]),module.exports=exports},function(module,exports,__webpack_require__){var api=__webpack_require__(65),content=__webpack_require__(732);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},function(module,exports,__webpack_require__){(exports=__webpack_require__(66)(!1)).push([module.i,".mlDataFrameAnalyticsClassification{width:100%}.mlDataFrameAnalyticsClassification__evaluateSectionContent{padding:0 5%}.mlDataFrameAnalyticsClassification__evaluateSectionContent:after{content:'';display:table;clear:both}.mlDataFrameAnalyticsClassification__actualLabel{float:left;width:80px;padding-top:64px}.mlDataFrameAnalyticsClassification__dataGridMinWidth{float:left;min-width:480px;width:calc(100% - 80px)}.mlDataFrameAnalyticsClassification__dataGridMinWidth .euiDataGridRowCell--boolean{text-transform:none}\n",""]),module.exports=exports},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var react_1=__webpack_require__(14);exports.default=function(state){var ref=react_1.useRef();return react_1.useEffect((function(){ref.current=state})),ref.current}}])]);