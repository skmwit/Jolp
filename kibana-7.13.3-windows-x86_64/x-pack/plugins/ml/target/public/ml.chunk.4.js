/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.ml_bundle_jsonpfunction=window.ml_bundle_jsonpfunction||[]).push([[4],{110:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"k",(function(){return common.i})),__webpack_require__.d(__webpack_exports__,"i",(function(){return common.g})),__webpack_require__.d(__webpack_exports__,"j",(function(){return common.h})),__webpack_require__.d(__webpack_exports__,"m",(function(){return common.k})),__webpack_require__.d(__webpack_exports__,"h",(function(){return common.f})),__webpack_require__.d(__webpack_exports__,"o",(function(){return common.n})),__webpack_require__.d(__webpack_exports__,"p",(function(){return common.o})),__webpack_require__.d(__webpack_exports__,"r",(function(){return common.p})),__webpack_require__.d(__webpack_exports__,"n",(function(){return common.l})),__webpack_require__.d(__webpack_exports__,"l",(function(){return use_column_chart.a})),__webpack_require__.d(__webpack_exports__,"q",(function(){return useDataGrid})),__webpack_require__.d(__webpack_exports__,"a",(function(){return DataGrid})),__webpack_require__.d(__webpack_exports__,"b",(function(){return types.DataGridItem})),__webpack_require__.d(__webpack_exports__,"c",(function(){return types.EsSorting})),__webpack_require__.d(__webpack_exports__,"d",(function(){return types.RenderCellValue})),__webpack_require__.d(__webpack_exports__,"e",(function(){return types.RowCountRelation})),__webpack_require__.d(__webpack_exports__,"f",(function(){return types.UseDataGridReturnType})),__webpack_require__.d(__webpack_exports__,"g",(function(){return types.UseIndexDataReturnType}));var common=__webpack_require__(91),use_column_chart=__webpack_require__(235),external_kbnSharedDeps_React_=__webpack_require__(14),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),es_client=__webpack_require__(11),data_frame_analytics_common=__webpack_require__(71),column_chart=__webpack_require__(239);const useDataGrid=(columns,defaultPageSize=5,defaultVisibleColumnsCount=common.b,defaultVisibleColumnsFilter)=>{const defaultPagination={pageIndex:0,pageSize:defaultPageSize},[ccsWarning,setCcsWarning]=Object(external_kbnSharedDeps_React_.useState)(!1),[noDataMessage,setNoDataMessage]=Object(external_kbnSharedDeps_React_.useState)(""),[errorMessage,setErrorMessage]=Object(external_kbnSharedDeps_React_.useState)(""),[status,setStatus]=Object(external_kbnSharedDeps_React_.useState)(data_frame_analytics_common.i.UNUSED),[rowCount,setRowCount]=Object(external_kbnSharedDeps_React_.useState)(0),[rowCountRelation,setRowCountRelation]=Object(external_kbnSharedDeps_React_.useState)(void 0),[columnCharts,setColumnCharts]=Object(external_kbnSharedDeps_React_.useState)([]),[tableItems,setTableItems]=Object(external_kbnSharedDeps_React_.useState)([]),[pagination,setPagination]=Object(external_kbnSharedDeps_React_.useState)(defaultPagination),[sortingColumns,setSortingColumns]=Object(external_kbnSharedDeps_React_.useState)([]),[chartsVisible,setChartsVisible]=Object(external_kbnSharedDeps_React_.useState)(void 0),onChangeItemsPerPage=Object(external_kbnSharedDeps_React_.useCallback)(pageSize=>{setPagination(p=>({pageIndex:Math.floor(p.pageSize*p.pageIndex/pageSize),pageSize:pageSize}))},[]),onChangePage=Object(external_kbnSharedDeps_React_.useCallback)(pageIndex=>setPagination(p=>({...p,pageIndex:pageIndex})),[]),[visibleColumns,setVisibleColumns]=Object(external_kbnSharedDeps_React_.useState)([]),columnIds=columns.map(c=>c.id),defaultVisibleColumns=(void 0!==defaultVisibleColumnsFilter?columnIds.filter(defaultVisibleColumnsFilter):columnIds).splice(0,defaultVisibleColumnsCount);Object(external_kbnSharedDeps_React_.useEffect)(()=>{setVisibleColumns(defaultVisibleColumns)},[defaultVisibleColumns.join()]);const[invalidSortingColumnns,setInvalidSortingColumnns]=Object(external_kbnSharedDeps_React_.useState)([]),onSort=Object(external_kbnSharedDeps_React_.useCallback)(sc=>{const updatedInvalidSortingColumnns=sc.reduce((arr,current)=>{const columnType=columns.find(dgc=>dgc.id===current.id);return"json"===(null==columnType?void 0:columnType.schema)&&arr.push(current.id),arr},[]);setInvalidSortingColumnns(updatedInvalidSortingColumnns),0===updatedInvalidSortingColumnns.length&&setSortingColumns(sc)},[columns]),columnsWithCharts=Object(external_kbnSharedDeps_React_.useMemo)(()=>columns.map((c,index)=>{const chartData=columnCharts.find(cd=>cd.id===c.id);return{...c,display:void 0!==chartData&&!0===chartsVisible?external_kbnSharedDeps_React_default.a.createElement(column_chart.a,{chartData:chartData,columnType:c,dataTestSubj:"mlDataGridChart-"+c.id}):void 0}}).sort((a,b)=>-1===visibleColumns.indexOf(a.id)&&visibleColumns.indexOf(b.id)>-1?1:-1===visibleColumns.indexOf(b.id)&&visibleColumns.indexOf(a.id)>-1?-1:-1===visibleColumns.indexOf(a.id)&&-1===visibleColumns.indexOf(b.id)?a.id.localeCompare(b.id):visibleColumns.indexOf(a.id)-visibleColumns.indexOf(b.id)),[columns,columnCharts,chartsVisible,JSON.stringify(visibleColumns)]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{void 0===chartsVisible&&rowCount>0&&void 0!==rowCountRelation&&setChartsVisible(rowCount<=common.a&&rowCountRelation!==es_client.a.GTE)},[chartsVisible,rowCount,rowCountRelation]),{ccsWarning:ccsWarning,chartsVisible:chartsVisible,chartsButtonVisible:!0,columnsWithCharts:columnsWithCharts,errorMessage:errorMessage,invalidSortingColumnns:invalidSortingColumnns,noDataMessage:noDataMessage,onChangeItemsPerPage:onChangeItemsPerPage,onChangePage:onChangePage,onSort:onSort,pagination:pagination,resetPagination:()=>setPagination(defaultPagination),rowCount:rowCount,rowCountRelation:rowCountRelation,setColumnCharts:setColumnCharts,setCcsWarning:setCcsWarning,setErrorMessage:setErrorMessage,setNoDataMessage:setNoDataMessage,setPagination:setPagination,setRowCount:setRowCount,setRowCountRelation:setRowCountRelation,setSortingColumns:setSortingColumns,setStatus:setStatus,setTableItems:setTableItems,setVisibleColumns:setVisibleColumns,sortingColumns:sortingColumns,status:status,tableItems:tableItems,toggleChartVisibility:()=>{void 0!==chartsVisible&&setChartsVisible(!chartsVisible)},visibleColumns:visibleColumns}};var external_kbnSharedDeps_Lodash_=__webpack_require__(7),external_kbnSharedDeps_KbnI18n_=__webpack_require__(2),external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(40),external_kbnSharedDeps_ElasticEui_=__webpack_require__(39),field_histograms=__webpack_require__(240),d3=__webpack_require__(105),d3_default=__webpack_require__.n(d3),feature_importance=__webpack_require__(190);const decisionPathFeatureOtherTitle=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.decisionPathFeatureOtherTitle",{defaultMessage:"other"}),isDecisionPathData=decisionPathData=>Array.isArray(decisionPathData)&&decisionPathData.length>0&&3===decisionPathData[0].length,getStringBasedClassName=v=>null==v?"":"boolean"==typeof v?v?"True":"False":"number"==typeof v?v.toString():v,useDecisionPathData=({baseline:baseline,featureImportance:featureImportance,predictedValue:predictedValue,predictedProbability:predictedProbability})=>({decisionPathData:Object(external_kbnSharedDeps_React_.useMemo)(()=>{if(void 0!==baseline)return Object(feature_importance.c)(baseline)?buildRegressionDecisionPathData({baseline:baseline.baseline,featureImportance:featureImportance,predictedValue:predictedValue}):Object(feature_importance.a)(baseline)?buildClassificationDecisionPathData({baselines:baseline.classes,featureImportance:featureImportance,currentClass:predictedValue,predictedProbability:predictedProbability}):void 0},[baseline,featureImportance,predictedValue])}),buildRegressionDecisionPathData=({baseline:baseline,featureImportance:featureImportance,predictedValue:predictedValue})=>{const mappedFeatureImportance=featureImportance.map(d=>({...d,absImportance:Math.abs(d.importance)}));if(baseline&&void 0!==predictedValue&&Number.isFinite(predictedValue)){const adjustedImportance=predictedValue-mappedFeatureImportance.reduce((accumulator,currentValue)=>accumulator+currentValue.importance,0)-baseline;mappedFeatureImportance.push({feature_name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.decisionPathFeatureBaselineTitle",{defaultMessage:"baseline"}),importance:baseline,absImportance:-1}),Math.abs(adjustedImportance)>1e-5&&mappedFeatureImportance.push({feature_name:decisionPathFeatureOtherTitle,importance:adjustedImportance,absImportance:0})}const filteredFeatureImportance=mappedFeatureImportance.filter(f=>void 0!==f),finalResult=filteredFeatureImportance.sort((a,b)=>b.absImportance-a.absImportance).map(d=>[d.feature_name,d.importance,NaN]);let cumulativeSum=0;for(let i=filteredFeatureImportance.length-1;i>=0;i--)cumulativeSum+=finalResult[i][1],finalResult[i][2]=cumulativeSum;return finalResult},addAdjustedProbability=({predictedProbability:predictedProbability,decisionPlotData:decisionPlotData})=>{if(predictedProbability&&decisionPlotData.length>0){const adjustedResidualImportance=predictedProbability-decisionPlotData[0][2];Math.abs(adjustedResidualImportance)>1e-5&&(decisionPlotData.forEach(row=>row[2]=row[2]+adjustedResidualImportance),decisionPlotData.push([decisionPathFeatureOtherTitle,adjustedResidualImportance,decisionPlotData[decisionPlotData.length-1][2]-adjustedResidualImportance]))}return decisionPlotData},computeMultiClassImportanceDenominator=({baselines:baselines,featureImportance:featureImportance})=>{let denominator=0;for(let x=0;x<baselines.length;x++){let featureImportanceOfClassX=0;for(let i=0;i<featureImportance.length;i++){const feature=featureImportance[i],classFeatureImportance=Array.isArray(feature.classes)?feature.classes.find(c=>getStringBasedClassName(c.class_name)===getStringBasedClassName(baselines[x].class_name)):feature;classFeatureImportance&&void 0!==classFeatureImportance.importance&&"number"==typeof classFeatureImportance.importance&&(featureImportanceOfClassX+=classFeatureImportance.importance)}denominator+=Math.exp(baselines[x].baseline+featureImportanceOfClassX)}return denominator},buildClassificationDecisionPathData=({baselines:baselines,featureImportance:featureImportance,currentClass:currentClass,predictedProbability:predictedProbability})=>{if(void 0===currentClass||!(Array.isArray(baselines)&&baselines.length>=2))return[];const mappedFeatureImportance=featureImportance.map(feature=>{const classFeatureImportance=Array.isArray(feature.classes)?feature.classes.find(c=>getStringBasedClassName(c.class_name)===getStringBasedClassName(currentClass)):feature;if(classFeatureImportance&&"number"==typeof classFeatureImportance.importance)return{feature_name:feature.feature_name,importance:classFeatureImportance.importance,absImportance:Math.abs(classFeatureImportance.importance)}}),baselineClass=baselines.find(bl=>getStringBasedClassName(bl.class_name)===getStringBasedClassName(currentClass)),startingBaseline=null!=baselineClass&&baselineClass.baseline?null==baselineClass?void 0:baselineClass.baseline:0,decisionPlotData=mappedFeatureImportance.filter(f=>void 0!==f).sort((a,b)=>b.absImportance-a.absImportance).map(d=>[d.feature_name,d.importance,NaN]);return 2===baselines.length?(({decisionPlotData:decisionPlotData,startingBaseline:startingBaseline,predictedProbability:predictedProbability})=>{const finalResult=decisionPlotData;let logOddSoFar=startingBaseline;for(let i=finalResult.length-1;i>=0;i--){logOddSoFar+=finalResult[i][1];const predictionProbabilitySoFar=Math.exp(logOddSoFar)/(Math.exp(logOddSoFar)+1);finalResult[i][2]=predictionProbabilitySoFar}return addAdjustedProbability({predictedProbability:predictedProbability,decisionPlotData:finalResult})})({startingBaseline:startingBaseline,decisionPlotData:decisionPlotData,predictedProbability:predictedProbability}):(({baselines:baselines,decisionPlotData:decisionPlotData,startingBaseline:startingBaseline,featureImportance:featureImportance,predictedProbability:predictedProbability})=>{const denominator=computeMultiClassImportanceDenominator({baselines:baselines,featureImportance:featureImportance}),baseline=startingBaseline;let featureImportanceRunningSum=0;for(let i=decisionPlotData.length-1;i>=0;i--){featureImportanceRunningSum+=decisionPlotData[i][1];const numerator=Math.exp(baseline+featureImportanceRunningSum);decisionPlotData[i][2]=numerator/denominator}return addAdjustedProbability({predictedProbability:predictedProbability,decisionPlotData:decisionPlotData})})({baselines:baselines,decisionPlotData:decisionPlotData,startingBaseline:startingBaseline,featureImportance:featureImportance,predictedProbability:predictedProbability})};var external_kbnSharedDeps_ElasticCharts_=__webpack_require__(43),external_kbnSharedDeps_Theme_euiLightVars_=__webpack_require__(50),external_kbnSharedDeps_Theme_euiLightVars_default=__webpack_require__.n(external_kbnSharedDeps_Theme_euiLightVars_),format_value=__webpack_require__(122);const{euiColorFullShade:euiColorFullShade,euiColorMediumShade:euiColorMediumShade}=external_kbnSharedDeps_Theme_euiLightVars_default.a,baselineStyle={line:{strokeWidth:1,stroke:euiColorFullShade,opacity:.75},details:{fontFamily:"Arial",fontSize:10,fontStyle:"bold",fill:euiColorMediumShade,padding:0}},theme={axes:{axisLine:{stroke:euiColorMediumShade},tickLabel:{fontSize:10,fill:euiColorMediumShade},tickLine:{stroke:euiColorMediumShade},gridLine:{horizontal:{dash:[1,2]},vertical:{strokeWidth:0}}}},AnnotationBaselineMarker=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{type:"dot",size:"m"}),DecisionPathChart=({decisionPathData:decisionPathData,predictionFieldName:predictionFieldName,minDomain:minDomain,maxDomain:maxDomain,baseline:baseline})=>{const regressionBaselineData=Object(external_kbnSharedDeps_React_.useMemo)(()=>baseline&&Object(feature_importance.c)(baseline)?[{dataValue:baseline.baseline,header:Object(format_value.a)(baseline.baseline,"").toString(),details:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.explorationResults.decisionPathBaselineText",{defaultMessage:"baseline (average of predictions for all data points in the training data set)"})}]:void 0,[baseline]),xAxisLabel=regressionBaselineData?external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.explorationResults.decisionPathLinePredictionTitle",{defaultMessage:"Prediction"}):external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.explorationResults.decisionPathLinePredictionProbabilityTitle",{defaultMessage:"Prediction probability"}),tickFormatter=Object(external_kbnSharedDeps_React_.useCallback)(d=>Object(format_value.a)(d,"").toString(),[]);return external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":"mlDFADecisionPathChart"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_.Chart,{size:{height:125+10*decisionPathData.length}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_.Settings,{theme:theme,rotation:90}),regressionBaselineData&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_.LineAnnotation,{id:"xpack.ml.dataframe.analytics.explorationResults.decisionPathBaseline",domainType:external_kbnSharedDeps_ElasticCharts_.AnnotationDomainType.YDomain,dataValues:regressionBaselineData,style:baselineStyle,marker:AnnotationBaselineMarker}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_.Axis,{id:"xpack.ml.dataframe.analytics.explorationResults.decisionPathXAxis",tickFormat:tickFormatter,title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.explorationResults.decisionPathXAxisTitle",{defaultMessage:"{xAxisLabel} for '{predictionFieldName}'",values:{predictionFieldName:predictionFieldName,xAxisLabel:xAxisLabel}}),showGridLines:!1,position:external_kbnSharedDeps_ElasticCharts_.Position.Top,showOverlappingTicks:!0,domain:minDomain&&maxDomain?{min:minDomain,max:maxDomain}:void 0}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_.Axis,{showGridLines:!0,id:"left",position:external_kbnSharedDeps_ElasticCharts_.Position.Left}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_.LineSeries,{id:"xpack.ml.dataframe.analytics.explorationResults.decisionPathLine",name:xAxisLabel,xScaleType:external_kbnSharedDeps_ElasticCharts_.ScaleType.Ordinal,yScaleType:external_kbnSharedDeps_ElasticCharts_.ScaleType.Linear,xAccessor:0,yAccessors:[2],data:decisionPathData})))},MissingDecisionPathCallout=()=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{color:"warning"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataframe.analytics.explorationResults.regressionDecisionPathDataMissingCallout",defaultMessage:"No decision path data available."})),RegressionDecisionPath=({baseline:baseline,featureImportance:featureImportance,predictedValue:predictedValue,predictionFieldName:predictionFieldName})=>{const{decisionPathData:decisionPathData}=useDecisionPathData({baseline:baseline,featureImportance:featureImportance,predictedValue:predictedValue}),domain=Object(external_kbnSharedDeps_React_.useMemo)(()=>{let maxDomain,minDomain;if(decisionPathData&&isDecisionPathData(decisionPathData)){const[min,max]=d3_default.a.extent(decisionPathData,d=>d[2]);maxDomain=max,minDomain=min;const buffer=.1*Math.abs(maxDomain-minDomain);maxDomain=("number"==typeof baseline?Math.max(maxDomain,baseline):maxDomain)+buffer,minDomain=("number"==typeof baseline?Math.min(minDomain,baseline):minDomain)-buffer}return{maxDomain:maxDomain,minDomain:minDomain}},[decisionPathData,baseline]);return decisionPathData?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,void 0===baseline&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{size:"s",heading:"p",title:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataframe.analytics.explorationResults.missingBaselineCallout",defaultMessage:"Unable to calculate baseline value, which might result in a shifted decision path."}),color:"warning",iconType:"alert"}),external_kbnSharedDeps_React_default.a.createElement(DecisionPathChart,{decisionPathData:decisionPathData,predictionFieldName:predictionFieldName,minDomain:domain.minDomain,maxDomain:domain.maxDomain,baseline:baseline})):external_kbnSharedDeps_React_default.a.createElement(MissingDecisionPathCallout,null)},DecisionPathJSONViewer=({featureImportance:featureImportance})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCodeBlock,{isCopyable:!0},JSON.stringify(featureImportance)),ClassificationDecisionPath=({featureImportance:featureImportance,predictedValue:predictedValue,topClasses:topClasses,predictionFieldName:predictionFieldName,predictedProbability:predictedProbability,baseline:baseline})=>{const[currentClass,setCurrentClass]=Object(external_kbnSharedDeps_React_.useState)(getStringBasedClassName(topClasses[0].class_name)),{decisionPathData:decisionPathData}=useDecisionPathData({baseline:baseline,featureImportance:featureImportance,predictedValue:currentClass,predictedProbability:predictedProbability}),options=Object(external_kbnSharedDeps_React_.useMemo)(()=>{const predictionValueStr=getStringBasedClassName(predictedValue);return Array.isArray(topClasses)?topClasses.map(c=>{const className=getStringBasedClassName(c.class_name);return{value:className,inputDisplay:className===predictionValueStr?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHealth,{color:"success",style:{lineHeight:"inherit"}},className):className}}):void 0},[topClasses,predictedValue]),domain=Object(external_kbnSharedDeps_React_.useMemo)(()=>{let maxDomain,minDomain;if(decisionPathData&&isDecisionPathData(decisionPathData)){const[min,max]=d3_default.a.extent(decisionPathData,d=>d[2]),buffer=.1*Math.abs(max-min);maxDomain=max+buffer,minDomain=min-buffer}return{maxDomain:maxDomain,minDomain:minDomain}},[decisionPathData]);return decisionPathData?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"xs"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"xxxs"},external_kbnSharedDeps_React_default.a.createElement("span",null,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.explorationResults.classificationDecisionPathClassNameTitle",{defaultMessage:"Class name"}))),void 0!==options&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSuperSelect,{"data-test-subj":"mlDFADecisionPathClassNameSelect",compressed:!0,options:options,valueOfSelected:currentClass,onChange:setCurrentClass}),external_kbnSharedDeps_React_default.a.createElement(DecisionPathChart,{decisionPathData:decisionPathData,predictionFieldName:predictionFieldName,minDomain:domain.minDomain,maxDomain:domain.maxDomain})):external_kbnSharedDeps_React_default.a.createElement(MissingDecisionPathCallout,null)};var DECISION_PATH_TABS,kibana=__webpack_require__(63);!function(DECISION_PATH_TABS){DECISION_PATH_TABS.CHART="decision_path_chart",DECISION_PATH_TABS.JSON="decision_path_json"}(DECISION_PATH_TABS||(DECISION_PATH_TABS={}));const DecisionPathPopover=({baseline:baseline,featureImportance:featureImportance,predictedValue:predictedValue,topClasses:topClasses,analysisType:analysisType,predictionFieldName:predictionFieldName,predictedProbability:predictedProbability})=>{const[selectedTabId,setSelectedTabId]=Object(external_kbnSharedDeps_React_.useState)(DECISION_PATH_TABS.CHART),{services:{docLinks:docLinks}}=Object(kibana.b)(),docLink=docLinks.links.ml.featureImportance;if(featureImportance.length<2)return external_kbnSharedDeps_React_default.a.createElement(DecisionPathJSONViewer,{featureImportance:featureImportance});const tabs=[{id:DECISION_PATH_TABS.CHART,name:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataframe.analytics.explorationResults.decisionPathPlotTab",defaultMessage:"Decision plot"})},{id:DECISION_PATH_TABS.JSON,name:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataframe.analytics.explorationResults.decisionPathJSONTab",defaultMessage:"JSON"})}];return external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":"mlDFADecisionPathPopover"},external_kbnSharedDeps_React_default.a.createElement("div",{style:{display:"flex",width:300}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTabs,{size:"s"},tabs.map(tab=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTab,{"data-test-subj":"mlDFADecisionPathPopoverTab-"+tab.id,isSelected:tab.id===selectedTabId,onClick:()=>setSelectedTabId(tab.id),key:tab.id},tab.name)))),selectedTabId===DECISION_PATH_TABS.CHART&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs",color:"subdued",style:{paddingTop:5}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataframe.analytics.explorationResults.decisionPathPlotHelpText",defaultMessage:"SHAP decision plots use {linkedFeatureImportanceValues} to show how models arrive at the predicted value for '{predictionFieldName}'.",values:{predictionFieldName:predictionFieldName,linkedFeatureImportanceValues:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{href:docLink,target:"_blank"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataframe.analytics.explorationResults.linkedFeatureImportanceValues",defaultMessage:"feature importance values"}))}})),analysisType===data_frame_analytics_common.a.CLASSIFICATION&&Object(feature_importance.a)(baseline)&&external_kbnSharedDeps_React_default.a.createElement(ClassificationDecisionPath,{featureImportance:featureImportance,topClasses:topClasses,predictedValue:getStringBasedClassName(predictedValue),predictedProbability:predictedProbability,predictionFieldName:predictionFieldName,baseline:baseline}),analysisType===data_frame_analytics_common.a.REGRESSION&&Object(feature_importance.c)(baseline)&&void 0!==predictedValue&&external_kbnSharedDeps_React_default.a.createElement(RegressionDecisionPath,{featureImportance:featureImportance,baseline:baseline,predictedValue:"string"==typeof predictedValue?parseFloat(predictedValue):predictedValue,predictionFieldName:predictionFieldName})),selectedTabId===DECISION_PATH_TABS.JSON&&external_kbnSharedDeps_React_default.a.createElement(DecisionPathJSONViewer,{featureImportance:featureImportance}))};var object_utils=__webpack_require__(4),data_frame_analytics=__webpack_require__(79);__webpack_require__(444);const DataGridTitle=({title:title})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"xs"},external_kbnSharedDeps_React_default.a.createElement("span",null,title));function isWithHeader(arg){return"string"==typeof(null==arg?void 0:arg.title)&&""!==(null==arg?void 0:arg.title)}const DataGrid=Object(external_kbnSharedDeps_React_.memo)(props=>{const{baseline:baseline,chartsVisible:chartsVisible,chartsButtonVisible:chartsButtonVisible,ccsWarning:ccsWarning,columnsWithCharts:columnsWithCharts,dataTestSubj:dataTestSubj,errorMessage:errorMessage,invalidSortingColumnns:invalidSortingColumnns,noDataMessage:noDataMessage,onChangeItemsPerPage:onChangeItemsPerPage,onChangePage:onChangePage,onSort:onSort,pagination:pagination,setVisibleColumns:setVisibleColumns,renderCellValue:renderCellValue,rowCount:rowCount,sortingColumns:sortingColumns,status:status,tableItems:data,toastNotifications:toastNotifications,toggleChartVisibility:toggleChartVisibility,visibleColumns:visibleColumns,predictionFieldName:predictionFieldName,resultsField:resultsField,analysisType:analysisType}=props,columnsWithChartsActionized=columnsWithCharts.map(d=>(!0===chartsVisible&&(d.actions=!1),d)),popOverContent=Object(external_kbnSharedDeps_React_.useMemo)(()=>analysisType===data_frame_analytics_common.a.REGRESSION||analysisType===data_frame_analytics_common.a.CLASSIFICATION||analysisType===data_frame_analytics_common.a.OUTLIER_DETECTION?{featureImportance:({children:children})=>{var _children$props;const rowIndex=null==children||null===(_children$props=children.props)||void 0===_children$props?void 0:_children$props.visibleRowIndex,row=data[rowIndex];if(!row)return external_kbnSharedDeps_React_default.a.createElement("div",null);const mlResultsField=null!=resultsField?resultsField:data_frame_analytics.d;let predictedValue,predictedProbability,topClasses=[];void 0!==predictionFieldName&&row&&void 0!==row[`${mlResultsField}.${predictionFieldName}`]&&(predictedValue=row[`${mlResultsField}.${predictionFieldName}`],topClasses=Object(common.m)(row,mlResultsField),predictedProbability=row[mlResultsField+".prediction_probability"]);const isClassTypeBoolean=topClasses.reduce((p,c)=>"boolean"==typeof c.class_name||p,!1),parsedFIArray=Object(common.j)(row,mlResultsField,isClassTypeBoolean);return external_kbnSharedDeps_React_default.a.createElement(DecisionPathPopover,{analysisType:analysisType,predictedValue:predictedValue,predictedProbability:predictedProbability,baseline:baseline,featureImportance:parsedFIArray,topClasses:topClasses,predictionFieldName:predictionFieldName?predictionFieldName.replace("_prediction",""):void 0})},featureInfluence:({cellContentsElement:cellContentsElement})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCodeBlock,{isCopyable:!0},cellContentsElement.textContent)}:void 0,[baseline,data]);Object(external_kbnSharedDeps_React_.useEffect)(()=>{invalidSortingColumnns.length>0&&invalidSortingColumnns.forEach(columnId=>{toastNotifications.addDanger(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataGrid.invalidSortingColumnError",{defaultMessage:"The column '{columnId}' cannot be used for sorting.",values:{columnId:columnId}}))})},[invalidSortingColumnns,toastNotifications]);const wrapperEl=Object(external_kbnSharedDeps_React_.useRef)(null);if(status===data_frame_analytics_common.i.LOADED&&0===data.length)return external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":dataTestSubj+" empty"},isWithHeader(props)&&external_kbnSharedDeps_React_default.a.createElement(DataGridTitle,{title:props.title}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataGrid.IndexNoDataCalloutTitle",{defaultMessage:"Empty index query result."}),color:"primary"},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataGrid.IndexNoDataCalloutBody",{defaultMessage:"The query for the index returned no results. Please make sure you have sufficient permissions, the index contains documents and your query is not too restrictive."}))));if(""!==noDataMessage)return external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":dataTestSubj+" empty"},isWithHeader(props)&&external_kbnSharedDeps_React_default.a.createElement(DataGridTitle,{title:props.title}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataGrid.dataGridNoDataCalloutTitle",{defaultMessage:"Index preview not available"}),color:"primary"},external_kbnSharedDeps_React_default.a.createElement("p",null,noDataMessage)));let errorCallout;status===data_frame_analytics_common.i.ERROR&&(errorCallout=errorMessage&&!errorMessage.includes("failed to create query")?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.exploration.querySyntaxError",{defaultMessage:"An error occurred loading the index data. Please ensure your query syntax is valid."}),color:"danger",iconType:"cross"},external_kbnSharedDeps_React_default.a.createElement("p",null,errorMessage)):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataGrid.indexDataError",{defaultMessage:"An error occurred loading the index data."}),color:"danger",iconType:"cross"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCodeBlock,{language:"json",fontSize:"s",paddingSize:"s",isCopyable:!0},errorMessage)));return external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":`${dataTestSubj} ${status===data_frame_analytics_common.i.ERROR?"error":"loaded"}`,ref:wrapperEl},isWithHeader(props)&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(DataGridTitle,{title:props.title})),props.copyToClipboard&&props.copyToClipboardDescription&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCopy,{beforeMessage:props.copyToClipboardDescription,textToCopy:props.copyToClipboard},copy=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{onClick:copy,iconType:"copyClipboard","aria-label":props.copyToClipboardDescription})))),void 0!==errorCallout&&external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":dataTestSubj+" error"},errorCallout,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"})),ccsWarning&&external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":dataTestSubj+" ccsWarning"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataGrid.CcsWarningCalloutTitle",{defaultMessage:"Cross-cluster search returned no fields data."}),color:"warning"},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataGrid.CcsWarningCalloutBody",{defaultMessage:"There was an issue retrieving data for the index pattern. Source preview in combination with cross-cluster search is only supported for versions 7.10 and above. You may still configure and create the transform."}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiMutationObserver,{observerOptions:{subtree:!0,attributes:!0,childList:!0},onMutation:()=>{if(null!==wrapperEl.current){const els=wrapperEl.current.querySelectorAll(".euiDataGrid__virtualized");for(const el of Array.from(els))Object(object_utils.b)(el)&&Object(object_utils.b)(el.style)&&"auto"!==el.style.height&&(el.style.height="auto")}}},mutationRef=>external_kbnSharedDeps_React_default.a.createElement("div",{className:"mlDataGrid",ref:mutationRef},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiDataGrid,{"aria-label":isWithHeader(props)?props.title:"",columns:columnsWithChartsActionized.map(c=>(c.initialWidth=165,c)),columnVisibility:{visibleColumns:visibleColumns,setVisibleColumns:setVisibleColumns},gridStyle:common.d,rowCount:rowCount,renderCellValue:renderCellValue,sorting:{columns:sortingColumns,onSort:onSort},toolbarVisibility:{...common.e,...chartsButtonVisible?{additionalControls:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{content:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataGrid.histogramButtonToolTipContent",{defaultMessage:"Queries run to fetch histogram chart data will use a sample size per shard of {samplerShardSize} documents.",values:{samplerShardSize:field_histograms.a}})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{"aria-pressed":!0===chartsVisible,className:"euiDataGrid__controlBtn"+(!0===chartsVisible?" euiDataGrid__controlBtn--active":""),"data-test-subj":dataTestSubj+"HistogramButton",size:"xs",iconType:"visBarVertical",color:"text",onClick:toggleChartVisibility,disabled:void 0===chartsVisible},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.dataGrid.histogramButtonText",defaultMessage:"Histogram charts"})))}:{}},popoverContents:popOverContent,pagination:{...pagination,pageSizeOptions:[5,10,25],onChangeItemsPerPage:onChangeItemsPerPage,onChangePage:onChangePage}}))))},(prevProps,nextProps)=>Object(external_kbnSharedDeps_Lodash_.isEqual)(pickProps(prevProps),pickProps(nextProps)));function pickProps(props){return[props.columnsWithCharts,props.dataTestSubj,props.errorMessage,props.invalidSortingColumnns,props.noDataMessage,props.pagination,props.rowCount,props.sortingColumns,props.status,props.tableItems,props.visibleColumns,...isWithHeader(props)?[props.copyToClipboard,props.copyToClipboardDescription,props.title]:[]]}var types=__webpack_require__(135)},116:function(module,exports){},131:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return newJobCapsServiceAnalytics}));var _src_plugins_data_public__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(41),_new_job_capabilities__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(309),_ml_api_service__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(64);class NewJobCapsServiceAnalytics extends _new_job_capabilities__WEBPACK_IMPORTED_MODULE_1__.a{async initializeFromIndexPattern(indexPattern){try{const allFields=function(resp,indexPatternTitle){const results=resp[indexPatternTitle],fields=[],nestedFields={};return void 0!==results&&(results.fields.forEach(field=>{field.type===_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_0__.ES_FIELD_TYPES.NESTED&&void 0===nestedFields[field.name]&&(nestedFields[field.name]=!0,fields.push(field))}),Object.keys(nestedFields).length>0?results.fields.forEach(field=>{if(field.type!==_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_0__.ES_FIELD_TYPES.NESTED){const rootOfField=field.name.split(".").shift();rootOfField&&void 0===nestedFields[rootOfField]&&fields.push(field)}}):fields.push(...results.fields)),fields}(await _ml_api_service__WEBPACK_IMPORTED_MODULE_2__.ml.dataFrameAnalytics.newJobCapsAnalytics(indexPattern.title,"rollup"===indexPattern.type),indexPattern.title),{fieldsPreferringKeyword:fieldsPreferringKeyword}=Object(_new_job_capabilities__WEBPACK_IMPORTED_MODULE_1__.b)(allFields);this._fields=fieldsPreferringKeyword}catch(error){console.error("Unable to load analytics index fields",error)}}}const newJobCapsServiceAnalytics=new NewJobCapsServiceAnalytics},134:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var tslib_1=__webpack_require__(35),react_1=__webpack_require__(14),useIsomorphicLayoutEffect_1=tslib_1.__importDefault(__webpack_require__(434));exports.default=function(observable$,initialValue){var _a=react_1.useState(initialValue),value=_a[0],update=_a[1];return useIsomorphicLayoutEffect_1.default((function(){var s=observable$.subscribe(update);return function(){return s.unsubscribe()}}),[observable$]),value}},135:function(module,exports){},147:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return FEATURE_IMPORTANCE})),__webpack_require__.d(__webpack_exports__,"b",(function(){return FEATURE_INFLUENCE})),__webpack_require__.d(__webpack_exports__,"d",(function(){return TOP_CLASSES})),__webpack_require__.d(__webpack_exports__,"c",(function(){return OUTLIER_SCORE}));const FEATURE_IMPORTANCE="feature_importance",FEATURE_INFLUENCE="feature_influence",TOP_CLASSES="top_classes",OUTLIER_SCORE="outlier_score"},164:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return isGetDataFrameAnalyticsStatsResponseOk})),__webpack_require__.d(__webpack_exports__,"a",(function(){return getAnalyticsFactory}));var _kbn_i18n__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2),_services_ml_api_service__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(64),_common__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(71),_components_analytics_list_common__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(93),_common_constants_data_frame_analytics__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(79);const isGetDataFrameAnalyticsStatsResponseOk=arg=>({}.hasOwnProperty.call(arg,"count")&&{}.hasOwnProperty.call(arg,"data_frame_analytics")&&Array.isArray(arg.data_frame_analytics));function getAnalyticsJobsStats(analyticsStats){const resultStats=analyticsStats.data_frame_analytics.reduce((acc,{state:state})=>(Object(_components_analytics_list_common__WEBPACK_IMPORTED_MODULE_3__.f)(state)?acc.failed.value=++acc.failed.value:Object(_components_analytics_list_common__WEBPACK_IMPORTED_MODULE_3__.g)(state)?acc.started.value=++acc.started.value:Object(_components_analytics_list_common__WEBPACK_IMPORTED_MODULE_3__.i)(state)&&(acc.stopped.value=++acc.stopped.value),acc),{total:{label:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.ml.overview.statsBar.totalAnalyticsLabel",{defaultMessage:"Total analytics jobs"}),value:0,show:!0},started:{label:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.ml.overview.statsBar.runningAnalyticsLabel",{defaultMessage:"Running"}),value:0,show:!0},stopped:{label:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.ml.overview.statsBar.stoppedAnalyticsLabel",{defaultMessage:"Stopped"}),value:0,show:!0},failed:{label:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.ml.overview.statsBar.failedAnalyticsLabel",{defaultMessage:"Failed"}),value:0,show:!1}});return resultStats.failed.show=resultStats.failed.value>0,resultStats.total.value=analyticsStats.count,resultStats}const getAnalyticsFactory=(setAnalytics,setAnalyticsStats,setErrorMessage,setIsInitialized,setJobsAwaitingNodeCount,blockRefresh,isManagementTable)=>{let concurrentLoads=0;const getAnalytics=async(forceRefresh=!1)=>{if(!0===forceRefresh||!1===blockRefresh){if(_common__WEBPACK_IMPORTED_MODULE_2__.G.next(_common__WEBPACK_IMPORTED_MODULE_2__.n.LOADING),concurrentLoads++,concurrentLoads>1)return;try{const analyticsConfigs=await _services_ml_api_service__WEBPACK_IMPORTED_MODULE_1__.ml.dataFrameAnalytics.getDataFrameAnalytics(),analyticsStats=await _services_ml_api_service__WEBPACK_IMPORTED_MODULE_1__.ml.dataFrameAnalytics.getDataFrameAnalyticsStats();let spaces={};if(isManagementTable){const allSpaces=await _services_ml_api_service__WEBPACK_IMPORTED_MODULE_1__.ml.savedObjects.jobsSpaces();spaces=allSpaces["data-frame-analytics"]}const analyticsStatsResult=isGetDataFrameAnalyticsStatsResponseOk(analyticsStats)?getAnalyticsJobsStats(analyticsStats):void 0;let jobsAwaitingNodeCount=0;const tableRows=analyticsConfigs.data_frame_analytics.reduce((reducedtableRows,config)=>{var _spaces$config$id;const stats=isGetDataFrameAnalyticsStatsResponseOk(analyticsStats)?analyticsStats.data_frame_analytics.find(d=>config.id===d.id):void 0;return Object(_components_analytics_list_common__WEBPACK_IMPORTED_MODULE_3__.h)(stats)?(stats.state===_common_constants_data_frame_analytics__WEBPACK_IMPORTED_MODULE_4__.c.STARTING&&void 0===stats.node&&jobsAwaitingNodeCount++,reducedtableRows.push({checkpointing:{},config:config,id:config.id,job_type:Object(_common__WEBPACK_IMPORTED_MODULE_2__.t)(config.analysis),mode:_components_analytics_list_common__WEBPACK_IMPORTED_MODULE_3__.a.BATCH,state:stats.state,stats:stats,spaceIds:null!==(_spaces$config$id=spaces[config.id])&&void 0!==_spaces$config$id?_spaces$config$id:[]}),reducedtableRows):reducedtableRows},[]);setAnalytics(tableRows),setAnalyticsStats(analyticsStatsResult),setErrorMessage(void 0),setIsInitialized(!0),setJobsAwaitingNodeCount(jobsAwaitingNodeCount),_common__WEBPACK_IMPORTED_MODULE_2__.G.next(_common__WEBPACK_IMPORTED_MODULE_2__.n.IDLE)}catch(e){_common__WEBPACK_IMPORTED_MODULE_2__.G.next(_common__WEBPACK_IMPORTED_MODULE_2__.n.ERROR),_common__WEBPACK_IMPORTED_MODULE_2__.G.next(_common__WEBPACK_IMPORTED_MODULE_2__.n.IDLE),setAnalytics([]),setAnalyticsStats(void 0),setErrorMessage(e),setIsInitialized(!0)}if(concurrentLoads--,concurrentLoads>0)return concurrentLoads=0,void getAnalytics(!0)}};return getAnalytics}},190:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return isClassificationTotalFeatureImportance})),__webpack_require__.d(__webpack_exports__,"d",(function(){return isRegressionTotalFeatureImportance})),__webpack_require__.d(__webpack_exports__,"a",(function(){return isClassificationFeatureImportanceBaseline})),__webpack_require__.d(__webpack_exports__,"c",(function(){return isRegressionFeatureImportanceBaseline}));var _util_object_utils__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(4);function isClassificationTotalFeatureImportance(summary){return void 0!==summary.classes}function isRegressionTotalFeatureImportance(summary){return void 0!==summary.importance}function isClassificationFeatureImportanceBaseline(baselineData){return Object(_util_object_utils__WEBPACK_IMPORTED_MODULE_0__.b)(baselineData,["classes"])&&Array.isArray(baselineData.classes)}function isRegressionFeatureImportanceBaseline(baselineData){return Object(_util_object_utils__WEBPACK_IMPORTED_MODULE_0__.b)(baselineData,["baseline"])}},230:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return apmUserMlCapabilities})),__webpack_require__.d(__webpack_exports__,"f",(function(){return userMlCapabilities})),__webpack_require__.d(__webpack_exports__,"a",(function(){return adminMlCapabilities})),__webpack_require__.d(__webpack_exports__,"c",(function(){return basicLicenseMlCapabilities})),__webpack_require__.d(__webpack_exports__,"d",(function(){return getDefaultCapabilities})),__webpack_require__.d(__webpack_exports__,"e",(function(){return getPluginPrivileges}));var _constants_app__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(5),_saved_objects__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(298),_constants_alerts__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(146);const apmUserMlCapabilities={canGetJobs:!1,canAccessML:!1},userMlCapabilities={canAccessML:!1,canGetJobs:!1,canGetDatafeeds:!1,canGetCalendars:!1,canFindFileStructure:!1,canGetDataFrameAnalytics:!1,canGetAnnotations:!1,canCreateAnnotation:!1,canDeleteAnnotation:!1,canUseMlAlerts:!1},adminMlCapabilities={canCreateJob:!1,canDeleteJob:!1,canOpenJob:!1,canCloseJob:!1,canUpdateJob:!1,canForecastJob:!1,canCreateDatafeed:!1,canDeleteDatafeed:!1,canStartStopDatafeed:!1,canUpdateDatafeed:!1,canPreviewDatafeed:!1,canGetFilters:!1,canCreateCalendar:!1,canDeleteCalendar:!1,canCreateFilter:!1,canDeleteFilter:!1,canCreateDataFrameAnalytics:!1,canDeleteDataFrameAnalytics:!1,canStartStopDataFrameAnalytics:!1,canCreateMlAlerts:!1,canUseMlAlerts:!1},basicLicenseMlCapabilities=["canAccessML","canFindFileStructure"];function getDefaultCapabilities(){return{...userMlCapabilities,...adminMlCapabilities}}function getPluginPrivileges(){const apmUserMlCapabilitiesKeys=Object.keys(apmUserMlCapabilities),userMlCapabilitiesKeys=Object.keys(userMlCapabilities),allMlCapabilitiesKeys=[...Object.keys(adminMlCapabilities),...userMlCapabilitiesKeys],savedObjects=["index-pattern","dashboard","search","visualization",_saved_objects__WEBPACK_IMPORTED_MODULE_1__.a],privilege={app:[_constants_app__WEBPACK_IMPORTED_MODULE_0__.e,"kibana"],excludeFromBasePrivileges:!0,management:{insightsAndAlerting:["jobsListLink"]},catalogue:[_constants_app__WEBPACK_IMPORTED_MODULE_0__.e]};return{admin:{...privilege,api:["fileUpload:import","fileUpload:analyzeFile",...allMlCapabilitiesKeys.map(k=>"ml:"+k)],catalogue:[_constants_app__WEBPACK_IMPORTED_MODULE_0__.e,_constants_app__WEBPACK_IMPORTED_MODULE_0__.e+"_file_data_visualizer"],ui:allMlCapabilitiesKeys,savedObject:{all:savedObjects,read:savedObjects},alerting:{all:Object.values(_constants_alerts__WEBPACK_IMPORTED_MODULE_2__.b),read:[]}},user:{...privilege,api:["fileUpload:analyzeFile",...userMlCapabilitiesKeys.map(k=>"ml:"+k)],catalogue:[_constants_app__WEBPACK_IMPORTED_MODULE_0__.e],management:{insightsAndAlerting:[]},ui:userMlCapabilitiesKeys,savedObject:{all:[],read:savedObjects},alerting:{all:[],read:Object.values(_constants_alerts__WEBPACK_IMPORTED_MODULE_2__.b)}},apmUser:{excludeFromBasePrivileges:!0,app:[],catalogue:[],savedObject:{all:[],read:[_saved_objects__WEBPACK_IMPORTED_MODULE_1__.a]},api:apmUserMlCapabilitiesKeys.map(k=>"ml:"+k),ui:apmUserMlCapabilitiesKeys}}}},231:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return getMetricChangeDescription}));var _kbn_i18n__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2);function getMetricChangeDescription(actualProp,typicalProp){if(void 0===actualProp||void 0===typicalProp)return{iconType:"empty",message:""};let message,iconType="alert",actual=0,typical=0;if(Array.isArray(actualProp)){if(1!==actualProp.length)return{iconType:"alert",message:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.ml.formatters.metricChangeDescription.unusualValuesDescription",{defaultMessage:"Unusual values"})};actual=actualProp[0]}else actual=actualProp;if(Array.isArray(typicalProp)?1===typicalProp.length&&(typical=typicalProp[0]):typical=typicalProp,actual===typical)message=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.ml.formatters.metricChangeDescription.actualSameAsTypicalDescription",{defaultMessage:"actual same as typical"});else{const isHigher=actual>typical;if(iconType=isHigher?"sortUp":"sortDown",0!==typical&&0!==actual){const factor=isHigher?actual/typical:typical/actual;message=factor>1.5?factor<=100?isHigher?_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.ml.formatters.metricChangeDescription.moreThanOneAndHalfxHigherDescription",{defaultMessage:"{factor}x higher",values:{factor:Math.round(factor)}}):_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.ml.formatters.metricChangeDescription.moreThanOneAndHalfxLowerDescription",{defaultMessage:"{factor}x lower",values:{factor:Math.round(factor)}}):isHigher?_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.ml.formatters.metricChangeDescription.moreThan100xHigherDescription",{defaultMessage:"More than 100x higher"}):_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.ml.formatters.metricChangeDescription.moreThan100xLowerDescription",{defaultMessage:"More than 100x lower"}):factor>=1.05?isHigher?_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.ml.formatters.metricChangeDescription.moreThanOneAndFiveHundredthsxHigherDescription",{defaultMessage:"{factor}x higher",values:{factor:factor.toPrecision(2)}}):_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.ml.formatters.metricChangeDescription.moreThanOneAndFiveHundredthsxLowerDescription",{defaultMessage:"{factor}x lower",values:{factor:factor.toPrecision(2)}}):isHigher?_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.ml.formatters.metricChangeDescription.unusuallyHighDescription",{defaultMessage:"Unusually high"}):_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.ml.formatters.metricChangeDescription.unusuallyLowDescription",{defaultMessage:"Unusually low"})}else message=0===actual?_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.ml.formatters.metricChangeDescription.unexpectedZeroValueDescription",{defaultMessage:"Unexpected zero value"}):_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.ml.formatters.metricChangeDescription.unexpectedNonZeroValueDescription",{defaultMessage:"Unexpected non-zero value"})}return{iconType:iconType,message:message}}},235:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return getFieldType})),__webpack_require__.d(__webpack_exports__,"b",(function(){return useColumnChart}));var moment__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(15),moment__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_0__),rxjs__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(23),react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(14),react__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_2__),react_use_lib_useObservable__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(134),react_use_lib_useObservable__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(react_use_lib_useObservable__WEBPACK_IMPORTED_MODULE_3__),_elastic_eui__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(39),_kbn_i18n__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(2),_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(41),_common_types_field_histograms__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(33),_common__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(91);const hoveredRow$=new rxjs__WEBPACK_IMPORTED_MODULE_1__.BehaviorSubject(null),BAR_COLOR=Object(_elastic_eui__WEBPACK_IMPORTED_MODULE_4__.euiPaletteColorBlind)()[0],BAR_COLOR_BLUR=Object(_elastic_eui__WEBPACK_IMPORTED_MODULE_4__.euiPaletteColorBlind)({rotations:2})[10],getFieldType=schema=>{if(schema===_common__WEBPACK_IMPORTED_MODULE_8__.c)return;let fieldType;switch(schema){case"datetime":fieldType=_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_6__.KBN_FIELD_TYPES.DATE;break;case"numeric":fieldType=_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_6__.KBN_FIELD_TYPES.NUMBER;break;case"boolean":fieldType=_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_6__.KBN_FIELD_TYPES.BOOLEAN;break;case"json":fieldType=_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_6__.KBN_FIELD_TYPES.OBJECT;break;default:fieldType=_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_6__.KBN_FIELD_TYPES.STRING}return fieldType},getLegendText=(chartData,maxChartColumns=20)=>{if("unsupported"===chartData.type)return _kbn_i18n__WEBPACK_IMPORTED_MODULE_5__.i18n.translate("xpack.ml.dataGridChart.histogramNotAvailable",{defaultMessage:"Chart not supported."});if(0===chartData.data.length)return _kbn_i18n__WEBPACK_IMPORTED_MODULE_5__.i18n.translate("xpack.ml.dataGridChart.notEnoughData",{defaultMessage:"0 documents contain field."});if("boolean"===chartData.type)return react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("table",{className:"mlDataGridChart__legendBoolean"},react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("tbody",null,react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("tr",null,void 0!==chartData.data[0]&&react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("td",null,chartData.data[0].key_as_string),void 0!==chartData.data[1]&&react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("td",null,chartData.data[1].key_as_string))));if(Object(_common_types_field_histograms__WEBPACK_IMPORTED_MODULE_7__.c)(chartData)&&chartData.cardinality<=maxChartColumns)return _kbn_i18n__WEBPACK_IMPORTED_MODULE_5__.i18n.translate("xpack.ml.dataGridChart.singleCategoryLegend",{defaultMessage:"{cardinality, plural, one {# category} other {# categories}}",values:{cardinality:chartData.cardinality}});if(Object(_common_types_field_histograms__WEBPACK_IMPORTED_MODULE_7__.c)(chartData)&&chartData.cardinality>maxChartColumns)return _kbn_i18n__WEBPACK_IMPORTED_MODULE_5__.i18n.translate("xpack.ml.dataGridChart.topCategoriesLegend",{defaultMessage:"top {maxChartColumns} of {cardinality} categories",values:{cardinality:chartData.cardinality,maxChartColumns:maxChartColumns}});if(Object(_common_types_field_histograms__WEBPACK_IMPORTED_MODULE_7__.b)(chartData)){const fromValue=Math.round(100*chartData.stats[0])/100,toValue=Math.round(100*chartData.stats[1])/100;return fromValue!==toValue?`${fromValue} - ${toValue}`:""+fromValue}return""},useColumnChart=(chartData,columnType,maxChartColumns)=>{const fieldType=getFieldType(columnType.schema),hoveredRow=react_use_lib_useObservable__WEBPACK_IMPORTED_MODULE_3___default()(hoveredRow$),xScaleType=(kbnFieldType=>{switch(kbnFieldType){case _src_plugins_data_public__WEBPACK_IMPORTED_MODULE_6__.KBN_FIELD_TYPES.BOOLEAN:case _src_plugins_data_public__WEBPACK_IMPORTED_MODULE_6__.KBN_FIELD_TYPES.IP:case _src_plugins_data_public__WEBPACK_IMPORTED_MODULE_6__.KBN_FIELD_TYPES.STRING:return"ordinal";case _src_plugins_data_public__WEBPACK_IMPORTED_MODULE_6__.KBN_FIELD_TYPES.DATE:return"time";case _src_plugins_data_public__WEBPACK_IMPORTED_MODULE_6__.KBN_FIELD_TYPES.NUMBER:return"linear"}})(fieldType),getColor=d=>null==hoveredRow||Object(_common_types_field_histograms__WEBPACK_IMPORTED_MODULE_7__.c)(chartData)&&"ordinal"===xScaleType&&hoveredRow._source[columnType.id]===d.key||Object(_common_types_field_histograms__WEBPACK_IMPORTED_MODULE_7__.b)(chartData)&&"linear"===xScaleType&&hoveredRow._source[columnType.id]>=+d.key&&hoveredRow._source[columnType.id]<+d.key+chartData.interval||Object(_common_types_field_histograms__WEBPACK_IMPORTED_MODULE_7__.b)(chartData)&&"time"===xScaleType&&1e3*moment__WEBPACK_IMPORTED_MODULE_0___default()(hoveredRow._source[columnType.id]).unix()>=+d.key&&1e3*moment__WEBPACK_IMPORTED_MODULE_0___default()(hoveredRow._source[columnType.id]).unix()<+d.key+chartData.interval?BAR_COLOR:BAR_COLOR_BLUR;let data=[];return Object(_common_types_field_histograms__WEBPACK_IMPORTED_MODULE_7__.c)(chartData)?data=chartData.data.map(d=>{var _d$key_as_string;return{...d,key_as_string:null!==(_d$key_as_string=d.key_as_string)&&void 0!==_d$key_as_string?_d$key_as_string:d.key,color:getColor(d)}}):Object(_common_types_field_histograms__WEBPACK_IMPORTED_MODULE_7__.b)(chartData)&&(data=chartData.data.map(d=>({...d,key_as_string:d.key_as_string||d.key,color:getColor(d)}))),{data:data,legendText:getLegendText(chartData,maxChartColumns),xScaleType:xScaleType}}},236:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return getScatterplotMatrixLegendType}));var _analytics__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(67),_components_vega_chart_common__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(237);const getScatterplotMatrixLegendType=jobType=>{switch(jobType){case _analytics__WEBPACK_IMPORTED_MODULE_0__.b.CLASSIFICATION:return _components_vega_chart_common__WEBPACK_IMPORTED_MODULE_1__.a.NOMINAL;case _analytics__WEBPACK_IMPORTED_MODULE_0__.b.REGRESSION:return _components_vega_chart_common__WEBPACK_IMPORTED_MODULE_1__.a.QUANTITATIVE;default:return}}},237:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return LEGEND_TYPES}));const LEGEND_TYPES={NOMINAL:"nominal",QUANTITATIVE:"quantitative"}},238:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return useTrainedModelsApiService}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(14),_index__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(64),_contexts_kibana__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(63);function useTrainedModelsApiService(){const{services:{mlServices:{httpService:httpService}}}=Object(_contexts_kibana__WEBPACK_IMPORTED_MODULE_2__.b)();return Object(react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(()=>function(httpService){const apiBasePath=Object(_index__WEBPACK_IMPORTED_MODULE_1__.basePath)();return{getTrainedModels(modelId,params){let model=null!=modelId?modelId:"";return Array.isArray(modelId)&&(model=modelId.join(",")),httpService.http({path:`${apiBasePath}/trained_models${model&&"/"+model}`,method:"GET",...params?{query:params}:{}})},getTrainedModelStats(modelId,params){let model=null!=modelId?modelId:"_all";return Array.isArray(modelId)&&(model=modelId.join(",")),httpService.http({path:`${apiBasePath}/trained_models/${model}/_stats`,method:"GET"})},getTrainedModelPipelines(modelId){let model=modelId;return Array.isArray(modelId)&&(model=modelId.join(",")),httpService.http({path:`${apiBasePath}/trained_models/${model}/pipelines`,method:"GET"})},deleteTrainedModel:modelId=>httpService.http({path:`${apiBasePath}/trained_models/${modelId}`,method:"DELETE"})}}(httpService),[httpService])}},239:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return ColumnChart}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(14),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),classnames__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(189),classnames__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_1__),_elastic_charts__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(43),_common_types_field_histograms__WEBPACK_IMPORTED_MODULE_4__=(__webpack_require__(435),__webpack_require__(33)),_use_column_chart__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(235);const columnChartTheme={background:{color:"transparent"},chartMargins:{left:0,right:0,top:0,bottom:1},chartPaddings:{left:0,right:0,top:0,bottom:0},scales:{barsPadding:.1}},ColumnChart=({chartData:chartData,columnType:columnType,dataTestSubj:dataTestSubj,hideLabel:hideLabel,maxChartColumns:maxChartColumns})=>{const{data:data,legendText:legendText,xScaleType:xScaleType}=Object(_use_column_chart__WEBPACK_IMPORTED_MODULE_5__.b)(chartData,columnType,maxChartColumns);return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{"data-test-subj":dataTestSubj},!Object(_common_types_field_histograms__WEBPACK_IMPORTED_MODULE_4__.d)(chartData)&&data.length>0&&react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{className:"mlDataGridChart__histogram","data-test-subj":dataTestSubj+"-histogram"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_charts__WEBPACK_IMPORTED_MODULE_2__.Chart,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_charts__WEBPACK_IMPORTED_MODULE_2__.Settings,{theme:columnChartTheme}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_charts__WEBPACK_IMPORTED_MODULE_2__.BarSeries,{id:"histogram",name:"count",xScaleType:xScaleType,yScaleType:"linear",xAccessor:"key_as_string",yAccessors:["doc_count"],styleAccessor:d=>d.datum.color,data:data}))),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{className:classnames__WEBPACK_IMPORTED_MODULE_1___default()("mlDataGridChart__legend",{"mlDataGridChart__legend--numeric":"number"===columnType.schema}),"data-test-subj":dataTestSubj+"-legend"},legendText),!hideLabel&&react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{"data-test-subj":dataTestSubj+"-id"},columnType.id))}},240:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return DEFAULT_SAMPLER_SHARD_SIZE}));const DEFAULT_SAMPLER_SHARD_SIZE=5e3},298:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return ML_SAVED_OBJECT_TYPE}));const ML_SAVED_OBJECT_TYPE="ml-job"},309:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return processTextAndKeywordFields})),__webpack_require__.d(__webpack_exports__,"a",(function(){return NewJobCapabilitiesServiceBase}));var _src_plugins_data_public__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(41);function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function processTextAndKeywordFields(fields){const keywordIds=fields.filter(f=>f.type===_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_0__.ES_FIELD_TYPES.KEYWORD).map(f=>f.id),textIds=fields.filter(f=>f.type===_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_0__.ES_FIELD_TYPES.TEXT).map(f=>f.id);return{fieldsPreferringKeyword:fields.filter(f=>f.type!==_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_0__.ES_FIELD_TYPES.TEXT||f.type===_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_0__.ES_FIELD_TYPES.TEXT&&!1===keywordIds.includes(f.id+".keyword")),fieldsPreferringText:fields.filter(f=>f.type!==_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_0__.ES_FIELD_TYPES.KEYWORD||f.type===_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_0__.ES_FIELD_TYPES.KEYWORD&&!1===textIds.includes(f.id.replace(/\.keyword$/,"")))}}class NewJobCapabilitiesServiceBase{constructor(){_defineProperty(this,"_fields",void 0),_defineProperty(this,"_aggs",void 0),this._fields=[],this._aggs=[]}get fields(){return this._fields}get aggs(){return this._aggs}get newJobCaps(){return{fields:this._fields,aggs:this._aggs}}getFieldById(id){const field=this._fields.find(f=>f.id===id);return void 0===field?null:field}getAggById(id){const agg=this._aggs.find(f=>f.id===id);return void 0===agg?null:agg}}},434:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var react_1=__webpack_require__(14),useIsomorphicLayoutEffect="undefined"!=typeof window?react_1.useLayoutEffect:react_1.useEffect;exports.default=useIsomorphicLayoutEffect},435:function(module,exports,__webpack_require__){switch(window.__kbnThemeTag__){case"v7dark":return __webpack_require__(436);case"v7light":return __webpack_require__(438);case"v8dark":return __webpack_require__(440);case"v8light":return __webpack_require__(442)}},436:function(module,exports,__webpack_require__){var api=__webpack_require__(65),content=__webpack_require__(437);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},437:function(module,exports,__webpack_require__){(exports=__webpack_require__(66)(!1)).push([module.i,".mlDataGridChart__histogram{width:100%;height:72px}.mlDataGridChart__legend{max-width:100%;overflow:hidden !important;text-overflow:ellipsis !important;white-space:nowrap !important;word-wrap:normal !important;font-size:12px;font-size:.75rem;line-height:1.5;color:#535966;display:block;overflow-x:hidden;margin:4px 0 0 0;font-style:italic;font-weight:normal;text-align:left}.mlDataGridChart__legend--numeric{text-align:right}.mlDataGridChart__legendBoolean{width:100%;min-width:112px}.mlDataGridChart__legendBoolean td{text-align:center}.mlDataGrid .euiDataGridHeaderCell__content{margin-top:auto}\n",""]),module.exports=exports},438:function(module,exports,__webpack_require__){var api=__webpack_require__(65),content=__webpack_require__(439);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},439:function(module,exports,__webpack_require__){(exports=__webpack_require__(66)(!1)).push([module.i,".mlDataGridChart__histogram{width:100%;height:72px}.mlDataGridChart__legend{max-width:100%;overflow:hidden !important;text-overflow:ellipsis !important;white-space:nowrap !important;word-wrap:normal !important;font-size:12px;font-size:.75rem;line-height:1.5;color:#98A2B3;display:block;overflow-x:hidden;margin:4px 0 0 0;font-style:italic;font-weight:normal;text-align:left}.mlDataGridChart__legend--numeric{text-align:right}.mlDataGridChart__legendBoolean{width:100%;min-width:112px}.mlDataGridChart__legendBoolean td{text-align:center}.mlDataGrid .euiDataGridHeaderCell__content{margin-top:auto}\n",""]),module.exports=exports},440:function(module,exports,__webpack_require__){var api=__webpack_require__(65),content=__webpack_require__(441);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},441:function(module,exports,__webpack_require__){(exports=__webpack_require__(66)(!1)).push([module.i,".mlDataGridChart__histogram{width:100%;height:72px}.mlDataGridChart__legend{max-width:100%;overflow:hidden !important;text-overflow:ellipsis !important;white-space:nowrap !important;word-wrap:normal !important;font-size:12px;font-size:.85714rem;line-height:1.14286rem;color:#535966;display:block;overflow-x:hidden;margin:4px 0 0 0;font-style:italic;font-weight:normal;text-align:left}.mlDataGridChart__legend--numeric{text-align:right}.mlDataGridChart__legendBoolean{width:100%;min-width:112px}.mlDataGridChart__legendBoolean td{text-align:center}.mlDataGrid .euiDataGridHeaderCell__content{margin-top:auto}\n",""]),module.exports=exports},442:function(module,exports,__webpack_require__){var api=__webpack_require__(65),content=__webpack_require__(443);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},443:function(module,exports,__webpack_require__){(exports=__webpack_require__(66)(!1)).push([module.i,".mlDataGridChart__histogram{width:100%;height:72px}.mlDataGridChart__legend{max-width:100%;overflow:hidden !important;text-overflow:ellipsis !important;white-space:nowrap !important;word-wrap:normal !important;font-size:12px;font-size:.85714rem;line-height:1.14286rem;color:#98A2B3;display:block;overflow-x:hidden;margin:4px 0 0 0;font-style:italic;font-weight:normal;text-align:left}.mlDataGridChart__legend--numeric{text-align:right}.mlDataGridChart__legendBoolean{width:100%;min-width:112px}.mlDataGridChart__legendBoolean td{text-align:center}.mlDataGrid .euiDataGridHeaderCell__content{margin-top:auto}\n",""]),module.exports=exports},444:function(module,exports,__webpack_require__){switch(window.__kbnThemeTag__){case"v7dark":return __webpack_require__(445);case"v7light":return __webpack_require__(447);case"v8dark":return __webpack_require__(449);case"v8light":return __webpack_require__(451)}},445:function(module,exports,__webpack_require__){var api=__webpack_require__(65),content=__webpack_require__(446);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},446:function(module,exports,__webpack_require__){(exports=__webpack_require__(66)(!1)).push([module.i,".mlDataGrid .euiDataGridRowCell--boolean{text-transform:none}\n",""]),module.exports=exports},447:function(module,exports,__webpack_require__){var api=__webpack_require__(65),content=__webpack_require__(448);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},448:function(module,exports,__webpack_require__){(exports=__webpack_require__(66)(!1)).push([module.i,".mlDataGrid .euiDataGridRowCell--boolean{text-transform:none}\n",""]),module.exports=exports},449:function(module,exports,__webpack_require__){var api=__webpack_require__(65),content=__webpack_require__(450);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},450:function(module,exports,__webpack_require__){(exports=__webpack_require__(66)(!1)).push([module.i,".mlDataGrid .euiDataGridRowCell--boolean{text-transform:none}\n",""]),module.exports=exports},451:function(module,exports,__webpack_require__){var api=__webpack_require__(65),content=__webpack_require__(452);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},452:function(module,exports,__webpack_require__){(exports=__webpack_require__(66)(!1)).push([module.i,".mlDataGrid .euiDataGridRowCell--boolean{text-transform:none}\n",""]),module.exports=exports},67:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return ANALYSIS_ADVANCED_FIELDS})),__webpack_require__.d(__webpack_exports__,"h",(function(){return OUTLIER_ANALYSIS_METHOD})),__webpack_require__.d(__webpack_exports__,"l",(function(){return SEARCH_SIZE})),__webpack_require__.d(__webpack_exports__,"o",(function(){return TRAINING_PERCENT_MIN})),__webpack_require__.d(__webpack_exports__,"n",(function(){return TRAINING_PERCENT_MAX})),__webpack_require__.d(__webpack_exports__,"g",(function(){return NUM_TOP_FEATURE_IMPORTANCE_VALUES_MIN})),__webpack_require__.d(__webpack_exports__,"q",(function(){return defaultSearchQuery})),__webpack_require__.d(__webpack_exports__,"s",(function(){return getDefaultTrainingFilterQuery})),__webpack_require__.d(__webpack_exports__,"e",(function(){return INDEX_STATUS})),__webpack_require__.d(__webpack_exports__,"y",(function(){return getTrainingPercent})),__webpack_require__.d(__webpack_exports__,"u",(function(){return getNumTopClasses})),__webpack_require__.d(__webpack_exports__,"v",(function(){return getNumTopFeatureImportanceValues})),__webpack_require__.d(__webpack_exports__,"F",(function(){return isResultsSearchBoolQuery})),__webpack_require__.d(__webpack_exports__,"E",(function(){return isRegressionEvaluateResponse})),__webpack_require__.d(__webpack_exports__,"B",(function(){return isClassificationEvaluateResponse})),__webpack_require__.d(__webpack_exports__,"i",(function(){return REFRESH_ANALYTICS_LIST_STATE})),__webpack_require__.d(__webpack_exports__,"I",(function(){return refreshAnalyticsList$})),__webpack_require__.d(__webpack_exports__,"J",(function(){return useRefreshAnalyticsList})),__webpack_require__.d(__webpack_exports__,"c",(function(){return EMPTY_STAT})),__webpack_require__.d(__webpack_exports__,"z",(function(){return getValuesFromResponse})),__webpack_require__.d(__webpack_exports__,"j",(function(){return REGRESSION_STATS})),__webpack_require__.d(__webpack_exports__,"H",(function(){return loadEvalData})),__webpack_require__.d(__webpack_exports__,"G",(function(){return loadDocsCount}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(14),rxjs__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(23),rxjs_operators__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(25),lodash__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(7),_services_ml_api_service__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(64),_common_util_errors__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(24),_common_util_analytics_utils__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(97);__webpack_require__.d(__webpack_exports__,"C",(function(){return _common_util_analytics_utils__WEBPACK_IMPORTED_MODULE_6__.g})),__webpack_require__.d(__webpack_exports__,"D",(function(){return _common_util_analytics_utils__WEBPACK_IMPORTED_MODULE_6__.h})),__webpack_require__.d(__webpack_exports__,"A",(function(){return _common_util_analytics_utils__WEBPACK_IMPORTED_MODULE_6__.f})),__webpack_require__.d(__webpack_exports__,"x",(function(){return _common_util_analytics_utils__WEBPACK_IMPORTED_MODULE_6__.e})),__webpack_require__.d(__webpack_exports__,"t",(function(){return _common_util_analytics_utils__WEBPACK_IMPORTED_MODULE_6__.c})),__webpack_require__.d(__webpack_exports__,"w",(function(){return _common_util_analytics_utils__WEBPACK_IMPORTED_MODULE_6__.d}));var _common_constants_data_frame_analytics__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(79);let ANALYSIS_ADVANCED_FIELDS,OUTLIER_ANALYSIS_METHOD;__webpack_require__.d(__webpack_exports__,"b",(function(){return _common_constants_data_frame_analytics__WEBPACK_IMPORTED_MODULE_7__.a})),__webpack_require__.d(__webpack_exports__,"r",(function(){return _common_util_analytics_utils__WEBPACK_IMPORTED_MODULE_6__.a})),function(ANALYSIS_ADVANCED_FIELDS){ANALYSIS_ADVANCED_FIELDS.ALPHA="alpha",ANALYSIS_ADVANCED_FIELDS.ETA="eta",ANALYSIS_ADVANCED_FIELDS.ETA_GROWTH_RATE_PER_TREE="eta_growth_rate_per_tree",ANALYSIS_ADVANCED_FIELDS.DOWNSAMPLE_FACTOR="downsample_factor",ANALYSIS_ADVANCED_FIELDS.FEATURE_BAG_FRACTION="feature_bag_fraction",ANALYSIS_ADVANCED_FIELDS.FEATURE_INFLUENCE_THRESHOLD="feature_influence_threshold",ANALYSIS_ADVANCED_FIELDS.GAMMA="gamma",ANALYSIS_ADVANCED_FIELDS.LAMBDA="lambda",ANALYSIS_ADVANCED_FIELDS.MAX_TREES="max_trees",ANALYSIS_ADVANCED_FIELDS.MAX_OPTIMIZATION_ROUNDS_PER_HYPERPARAMETER="max_optimization_rounds_per_hyperparameter",ANALYSIS_ADVANCED_FIELDS.METHOD="method",ANALYSIS_ADVANCED_FIELDS.N_NEIGHBORS="n_neighbors",ANALYSIS_ADVANCED_FIELDS.NUM_TOP_CLASSES="num_top_classes",ANALYSIS_ADVANCED_FIELDS.NUM_TOP_FEATURE_IMPORTANCE_VALUES="num_top_feature_importance_values",ANALYSIS_ADVANCED_FIELDS.OUTLIER_FRACTION="outlier_fraction",ANALYSIS_ADVANCED_FIELDS.RANDOMIZE_SEED="randomize_seed",ANALYSIS_ADVANCED_FIELDS.SOFT_TREE_DEPTH_LIMIT="soft_tree_depth_limit",ANALYSIS_ADVANCED_FIELDS.SOFT_TREE_DEPTH_TOLERANCE="soft_tree_depth_tolerance"}(ANALYSIS_ADVANCED_FIELDS||(ANALYSIS_ADVANCED_FIELDS={})),function(OUTLIER_ANALYSIS_METHOD){OUTLIER_ANALYSIS_METHOD.LOF="lof",OUTLIER_ANALYSIS_METHOD.LDOF="ldof",OUTLIER_ANALYSIS_METHOD.DISTANCE_KTH_NN="distance_kth_nn",OUTLIER_ANALYSIS_METHOD.DISTANCE_KNN="distance_knn"}(OUTLIER_ANALYSIS_METHOD||(OUTLIER_ANALYSIS_METHOD={}));const SEARCH_SIZE=1e3,TRAINING_PERCENT_MIN=1,TRAINING_PERCENT_MAX=100,NUM_TOP_FEATURE_IMPORTANCE_VALUES_MIN=0,defaultSearchQuery={match_all:{}},getDefaultTrainingFilterQuery=(resultsField,isTraining)=>({bool:{minimum_should_match:1,should:[{match:{[resultsField+".is_training"]:isTraining}}]}});let INDEX_STATUS;!function(INDEX_STATUS){INDEX_STATUS[INDEX_STATUS.UNUSED=0]="UNUSED",INDEX_STATUS[INDEX_STATUS.LOADING=1]="LOADING",INDEX_STATUS[INDEX_STATUS.LOADED=2]="LOADED",INDEX_STATUS[INDEX_STATUS.ERROR=3]="ERROR"}(INDEX_STATUS||(INDEX_STATUS={}));const getTrainingPercent=analysis=>{let trainingPercent;return Object(_common_util_analytics_utils__WEBPACK_IMPORTED_MODULE_6__.h)(analysis)&&(trainingPercent=analysis.regression.training_percent),Object(_common_util_analytics_utils__WEBPACK_IMPORTED_MODULE_6__.f)(analysis)&&(trainingPercent=analysis.classification.training_percent),trainingPercent},getNumTopClasses=analysis=>{let numTopClasses;return Object(_common_util_analytics_utils__WEBPACK_IMPORTED_MODULE_6__.f)(analysis)&&void 0!==analysis.classification.num_top_classes&&(numTopClasses=analysis.classification.num_top_classes),numTopClasses},getNumTopFeatureImportanceValues=analysis=>{let numTopFeatureImportanceValues;return Object(_common_util_analytics_utils__WEBPACK_IMPORTED_MODULE_6__.h)(analysis)&&void 0!==analysis.regression.num_top_feature_importance_values?numTopFeatureImportanceValues=analysis.regression.num_top_feature_importance_values:Object(_common_util_analytics_utils__WEBPACK_IMPORTED_MODULE_6__.f)(analysis)&&void 0!==analysis.classification.num_top_feature_importance_values&&(numTopFeatureImportanceValues=analysis.classification.num_top_feature_importance_values),numTopFeatureImportanceValues},isResultsSearchBoolQuery=arg=>{if(void 0===arg)return!1;const keys=Object.keys(arg);return 1===keys.length&&"bool"===keys[0]},isRegressionEvaluateResponse=arg=>{var _arg$regression,_arg$regression2;const keys=Object.keys(arg);return 1===keys.length&&keys[0]===_common_constants_data_frame_analytics__WEBPACK_IMPORTED_MODULE_7__.a.REGRESSION&&void 0!==(null==arg||null===(_arg$regression=arg.regression)||void 0===_arg$regression?void 0:_arg$regression.mse)&&void 0!==(null==arg||null===(_arg$regression2=arg.regression)||void 0===_arg$regression2?void 0:_arg$regression2.r_squared)},isClassificationEvaluateResponse=arg=>{var _arg$classification,_arg$classification2;const keys=Object.keys(arg);return 1===keys.length&&keys[0]===_common_constants_data_frame_analytics__WEBPACK_IMPORTED_MODULE_7__.a.CLASSIFICATION&&(void 0!==(null==arg||null===(_arg$classification=arg.classification)||void 0===_arg$classification?void 0:_arg$classification.multiclass_confusion_matrix)||void 0!==(null==arg||null===(_arg$classification2=arg.classification)||void 0===_arg$classification2?void 0:_arg$classification2.auc_roc))};let REFRESH_ANALYTICS_LIST_STATE;!function(REFRESH_ANALYTICS_LIST_STATE){REFRESH_ANALYTICS_LIST_STATE.ERROR="error",REFRESH_ANALYTICS_LIST_STATE.IDLE="idle",REFRESH_ANALYTICS_LIST_STATE.LOADING="loading",REFRESH_ANALYTICS_LIST_STATE.REFRESH="refresh"}(REFRESH_ANALYTICS_LIST_STATE||(REFRESH_ANALYTICS_LIST_STATE={}));const refreshAnalyticsList$=new rxjs__WEBPACK_IMPORTED_MODULE_1__.BehaviorSubject(REFRESH_ANALYTICS_LIST_STATE.IDLE),useRefreshAnalyticsList=(callback={},isManagementTable=!1)=>(Object(react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>{const distinct$=refreshAnalyticsList$.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_2__.distinctUntilChanged)()),subscriptions=[];return"function"==typeof callback.onRefresh&&(isManagementTable&&callback.onRefresh(),subscriptions.push(distinct$.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_2__.filter)(state=>state===REFRESH_ANALYTICS_LIST_STATE.REFRESH)).subscribe(()=>{"function"==typeof callback.onRefresh&&callback.onRefresh()}))),"function"==typeof callback.isLoading&&subscriptions.push(distinct$.subscribe(state=>"function"==typeof callback.isLoading&&callback.isLoading(state===REFRESH_ANALYTICS_LIST_STATE.LOADING))),()=>{subscriptions.map(sub=>sub.unsubscribe())}},[callback.onRefresh]),{refresh:()=>{refreshAnalyticsList$.next(REFRESH_ANALYTICS_LIST_STATE.REFRESH),refreshAnalyticsList$.next(REFRESH_ANALYTICS_LIST_STATE.LOADING)}}),EMPTY_STAT="--";function getValuesFromResponse(response){const results={mse:EMPTY_STAT,msle:EMPTY_STAT,huber:EMPTY_STAT,r_squared:EMPTY_STAT};if(null!=response&&response.regression)for(const statType in response.regression)if(response.regression.hasOwnProperty(statType)){var _response$regression;let currentStatValue=null===(_response$regression=response.regression[statType])||void 0===_response$regression?void 0:_response$regression.value;currentStatValue&&Number.isFinite(currentStatValue)&&(currentStatValue=Number(currentStatValue.toPrecision(3))),results[statType]=currentStatValue}return results}function getEvalQueryBody({resultsField:resultsField,isTraining:isTraining,searchQuery:searchQuery,ignoreDefaultQuery:ignoreDefaultQuery}){let query;const trainingQuery={term:{[resultsField+".is_training"]:{value:isTraining}}},searchQueryClone=Object(lodash__WEBPACK_IMPORTED_MODULE_3__.cloneDeep)(searchQuery);return isResultsSearchBoolQuery(searchQueryClone)?(void 0===searchQueryClone.bool.must&&(searchQueryClone.bool.must=[]),void 0!==isTraining&&searchQueryClone.bool.must.push(trainingQuery),query=searchQueryClone):(arg=>{if(void 0===arg)return!1;const keys=Object.keys(arg);return 1===keys.length&&"query_string"===keys[0]})(searchQueryClone)?(query={bool:{must:[searchQueryClone]}},void 0!==isTraining&&query.bool.must.push(trainingQuery)):query={bool:{must:void 0!==isTraining?[trainingQuery]:[]}},query}let REGRESSION_STATS;!function(REGRESSION_STATS){REGRESSION_STATS.MSE="mse",REGRESSION_STATS.MSLE="msle",REGRESSION_STATS.R_SQUARED="rSquared",REGRESSION_STATS.HUBER="huber"}(REGRESSION_STATS||(REGRESSION_STATS={}));const loadEvalData=async({isTraining:isTraining,index:index,dependentVariable:dependentVariable,resultsField:resultsField,predictionFieldName:predictionFieldName,searchQuery:searchQuery,ignoreDefaultQuery:ignoreDefaultQuery,jobType:jobType,requiresKeyword:requiresKeyword,rocCurveClassName:rocCurveClassName,includeMulticlassConfusionMatrix:includeMulticlassConfusionMatrix=!0})=>{const results={success:!1,eval:null,error:null};let predictedField=`${resultsField}.${predictionFieldName||dependentVariable+"_prediction"}`;jobType===_common_constants_data_frame_analytics__WEBPACK_IMPORTED_MODULE_7__.a.CLASSIFICATION&&!0===requiresKeyword&&(predictedField+=".keyword");const metrics={classification:{accuracy:{},recall:{},...includeMulticlassConfusionMatrix?{multiclass_confusion_matrix:{}}:{},...void 0!==rocCurveClassName?{auc_roc:{include_curve:!0,class_name:rocCurveClassName}}:{}},regression:{r_squared:{},mse:{},msle:{},huber:{}}},config={index:index,query:getEvalQueryBody({resultsField:resultsField,isTraining:isTraining,searchQuery:searchQuery,ignoreDefaultQuery:ignoreDefaultQuery}),evaluation:{[jobType]:{actual_field:dependentVariable,predicted_field:predictedField,...jobType===_common_constants_data_frame_analytics__WEBPACK_IMPORTED_MODULE_7__.a.CLASSIFICATION?{top_classes_field:resultsField+".top_classes"}:{},metrics:metrics[jobType]}}};try{const evalResult=await _services_ml_api_service__WEBPACK_IMPORTED_MODULE_4__.ml.dataFrameAnalytics.evaluateDataFrameAnalytics(config);return results.success=!0,results.eval=evalResult,results}catch(e){return results.error=Object(_common_util_errors__WEBPACK_IMPORTED_MODULE_5__.i)(e),results}},loadDocsCount=async({ignoreDefaultQuery:ignoreDefaultQuery=!0,isTraining:isTraining,searchQuery:searchQuery,resultsField:resultsField,destIndex:destIndex})=>{const query=getEvalQueryBody({resultsField:resultsField,isTraining:isTraining,ignoreDefaultQuery:ignoreDefaultQuery,searchQuery:searchQuery});try{const body={track_total_hits:!0,query:query},resp=await _services_ml_api_service__WEBPACK_IMPORTED_MODULE_4__.ml.esSearch({index:destIndex,size:0,body:body}),docsCount=resp.hits.total&&resp.hits.total.value;return{docsCount:docsCount,success:void 0!==docsCount}}catch(e){return{docsCount:null,success:!1}}}},71:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"t",(function(){return analytics.r})),__webpack_require__.d(__webpack_exports__,"w",(function(){return analytics.t})),__webpack_require__.d(__webpack_exports__,"A",(function(){return analytics.x})),__webpack_require__.d(__webpack_exports__,"v",(function(){return analytics.s})),__webpack_require__.d(__webpack_exports__,"D",(function(){return analytics.C})),__webpack_require__.d(__webpack_exports__,"G",(function(){return analytics.I})),__webpack_require__.d(__webpack_exports__,"I",(function(){return analytics.J})),__webpack_require__.d(__webpack_exports__,"r",(function(){return analytics.UpdateDataFrameAnalyticsConfig})),__webpack_require__.d(__webpack_exports__,"k",(function(){return analytics.IndexPattern})),__webpack_require__.d(__webpack_exports__,"n",(function(){return analytics.i})),__webpack_require__.d(__webpack_exports__,"m",(function(){return analytics.h})),__webpack_require__.d(__webpack_exports__,"o",(function(){return analytics.RegressionEvaluateResponse})),__webpack_require__.d(__webpack_exports__,"C",(function(){return analytics.z})),__webpack_require__.d(__webpack_exports__,"F",(function(){return analytics.H})),__webpack_require__.d(__webpack_exports__,"E",(function(){return analytics.G})),__webpack_require__.d(__webpack_exports__,"h",(function(){return analytics.Eval})),__webpack_require__.d(__webpack_exports__,"z",(function(){return analytics.w})),__webpack_require__.d(__webpack_exports__,"i",(function(){return analytics.e})),__webpack_require__.d(__webpack_exports__,"p",(function(){return analytics.l})),__webpack_require__.d(__webpack_exports__,"s",(function(){return analytics.q})),__webpack_require__.d(__webpack_exports__,"q",(function(){return analytics.SearchQuery})),__webpack_require__.d(__webpack_exports__,"a",(function(){return analytics.b})),__webpack_require__.d(__webpack_exports__,"u",(function(){return common_fields.j})),__webpack_require__.d(__webpack_exports__,"H",(function(){return common_fields.l})),__webpack_require__.d(__webpack_exports__,"g",(function(){return common_fields.EsId})),__webpack_require__.d(__webpack_exports__,"d",(function(){return common_fields.EsDoc})),__webpack_require__.d(__webpack_exports__,"e",(function(){return common_fields.EsDocSource})),__webpack_require__.d(__webpack_exports__,"f",(function(){return common_fields.EsFieldName})),__webpack_require__.d(__webpack_exports__,"l",(function(){return common_fields.g})),__webpack_require__.d(__webpack_exports__,"x",(function(){return getIndexData})),__webpack_require__.d(__webpack_exports__,"y",(function(){return getIndexFields})),__webpack_require__.d(__webpack_exports__,"B",(function(){return get_scatterplot_matrix_legend_type.a})),__webpack_require__.d(__webpack_exports__,"J",(function(){return useResultsViewConfig})),__webpack_require__.d(__webpack_exports__,"b",(function(){return data_frame_analytics.DataFrameAnalyticsConfig})),__webpack_require__.d(__webpack_exports__,"c",(function(){return data_frame_analytics.DataFrameAnalyticsId})),__webpack_require__.d(__webpack_exports__,"j",(function(){return data_frame_analytics.IndexName}));var analytics=__webpack_require__(67),common_fields=__webpack_require__(86),errors=__webpack_require__(24),data_grid=__webpack_require__(110),ml_api_service=__webpack_require__(64);const getIndexData=async(jobConfig,dataGrid,searchQuery,options)=>{if(void 0!==jobConfig){const{pagination:pagination,setErrorMessage:setErrorMessage,setRowCount:setRowCount,setRowCountRelation:setRowCountRelation,setStatus:setStatus,setTableItems:setTableItems,sortingColumns:sortingColumns}=dataGrid;setErrorMessage(""),setStatus(analytics.e.LOADING);try{const sort=sortingColumns.map(column=>{const{id:id}=column;return column.id=Object(common_fields.k)(id)?id+".keyword":id,column}).reduce((s,column)=>(s[column.id]={order:column.direction},s),{}),{pageIndex:pageIndex,pageSize:pageSize}=pagination,resp=await ml_api_service.ml.esSearch({index:jobConfig.dest.index,body:{fields:["*"],_source:!1,query:searchQuery,from:pageIndex*pageSize,size:pageSize,...Object.keys(sort).length>0?{sort:sort}:{}}});options.didCancel||(setRowCount("number"==typeof resp.hits.total?resp.hits.total:resp.hits.total.value),setRowCountRelation("number"==typeof resp.hits.total?"eq":resp.hits.total.relation),setTableItems(resp.hits.hits.map(d=>{var _d$fields;return Object(data_grid.n)(null!==(_d$fields=d.fields)&&void 0!==_d$fields?_d$fields:{},key=>key.startsWith(jobConfig.dest.results_field+".feature_importance"))})),setStatus(analytics.e.LOADED))}catch(e){setErrorMessage(Object(errors.i)(e)),setStatus(analytics.e.ERROR)}}};var new_job_capabilities_service_analytics=__webpack_require__(131);const getIndexFields=(jobConfig,needsDestIndexFields)=>{const{fields:fields}=new_job_capabilities_service_analytics.a;if(void 0!==jobConfig){const{selectedFields:defaultSelected,docFields:docFields}=Object(common_fields.j)(fields,jobConfig,needsDestIndexFields),types={},allFields=[];return docFields.forEach(field=>{types[field.id]=field.type,allFields.push(field.id)}),{defaultSelectedFields:defaultSelected.map(field=>field.id),fieldTypes:types,tableFields:allFields}}return{defaultSelectedFields:[],fieldTypes:{},tableFields:[]}};var get_scatterplot_matrix_legend_type=__webpack_require__(236),external_kbnSharedDeps_React_=__webpack_require__(14),external_kbnSharedDeps_KbnI18n_=__webpack_require__(2),index_utils=__webpack_require__(82),ml=__webpack_require__(85),get_analytics=__webpack_require__(164),trained_models=__webpack_require__(238),toast_notification_service=__webpack_require__(73),analytics_utils=__webpack_require__(97);const useResultsViewConfig=jobId=>{const mlContext=Object(ml.b)(),trainedModelsApiService=Object(trained_models.a)(),[indexPattern,setIndexPattern]=Object(external_kbnSharedDeps_React_.useState)(void 0),[indexPatternErrorMessage,setIndexPatternErrorMessage]=Object(external_kbnSharedDeps_React_.useState)(void 0),[isInitialized,setIsInitialized]=Object(external_kbnSharedDeps_React_.useState)(!1),[needsDestIndexPattern,setNeedsDestIndexPattern]=Object(external_kbnSharedDeps_React_.useState)(!1),[isLoadingJobConfig,setIsLoadingJobConfig]=Object(external_kbnSharedDeps_React_.useState)(!1),[jobConfig,setJobConfig]=Object(external_kbnSharedDeps_React_.useState)(void 0),[jobCapsServiceErrorMessage,setJobCapsServiceErrorMessage]=Object(external_kbnSharedDeps_React_.useState)(void 0),[jobConfigErrorMessage,setJobConfigErrorMessage]=Object(external_kbnSharedDeps_React_.useState)(void 0),[jobStatus,setJobStatus]=Object(external_kbnSharedDeps_React_.useState)(void 0),[totalFeatureImportance,setTotalFeatureImportance]=Object(external_kbnSharedDeps_React_.useState)(void 0);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{!async function(){setIsLoadingJobConfig(!1);try{const analyticsConfigs=await ml_api_service.ml.dataFrameAnalytics.getDataFrameAnalytics(jobId),analyticsStats=await ml_api_service.ml.dataFrameAnalytics.getDataFrameAnalyticsStats(jobId),stats=Object(get_analytics.b)(analyticsStats)?analyticsStats.data_frame_analytics[0]:void 0;if(void 0!==stats&&stats.state&&setJobStatus(stats.state),Array.isArray(analyticsConfigs.data_frame_analytics)&&analyticsConfigs.data_frame_analytics.length>0){const jobConfigUpdate=analyticsConfigs.data_frame_analytics[0];if(Object(analytics_utils.f)(jobConfigUpdate.analysis)||Object(analytics_utils.h)(jobConfigUpdate.analysis))try{var _inferenceModel$metad;const inferenceModel=(await trainedModelsApiService.getTrainedModels(jobId+"*",{include:"total_feature_importance"})).find(model=>{var _model$metadata,_model$metadata$analy;return(null===(_model$metadata=model.metadata)||void 0===_model$metadata||null===(_model$metadata$analy=_model$metadata.analytics_config)||void 0===_model$metadata$analy?void 0:_model$metadata$analy.id)===jobId});var _inferenceModel$metad2;if(!0===Array.isArray(null==inferenceModel||null===(_inferenceModel$metad=inferenceModel.metadata)||void 0===_inferenceModel$metad?void 0:_inferenceModel$metad.total_feature_importance))setTotalFeatureImportance(null==inferenceModel||null===(_inferenceModel$metad2=inferenceModel.metadata)||void 0===_inferenceModel$metad2?void 0:_inferenceModel$metad2.total_feature_importance)}catch(e){Object(toast_notification_service.a)().displayErrorToast(e)}try{const destIndex=Array.isArray(jobConfigUpdate.dest.index)?jobConfigUpdate.dest.index[0]:jobConfigUpdate.dest.index,destIndexPatternId=Object(index_utils.c)(destIndex)||destIndex;let indexP;try{indexP=await mlContext.indexPatterns.get(destIndexPatternId),await mlContext.indexPatterns.refreshFields(indexP)}catch(e){indexP=void 0}if(void 0===indexP){setNeedsDestIndexPattern(!0);const sourceIndex=jobConfigUpdate.source.index[0],sourceIndexPatternId=Object(index_utils.c)(sourceIndex)||sourceIndex;try{indexP=await mlContext.indexPatterns.get(sourceIndexPatternId)}catch(e){indexP=void 0}}void 0!==indexP?(await new_job_capabilities_service_analytics.a.initializeFromIndexPattern(indexP),setJobConfig(analyticsConfigs.data_frame_analytics[0]),setIndexPattern(indexP),setIsInitialized(!0),setIsLoadingJobConfig(!1)):setIndexPatternErrorMessage(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.dataframe.analytics.results.indexPatternsMissingErrorMessage",{defaultMessage:"To view this page, a Kibana index pattern is necessary for either the destination or source index of this analytics job."}))}catch(e){setJobCapsServiceErrorMessage(Object(errors.i)(e)),setIsLoadingJobConfig(!1)}}}catch(e){setJobConfigErrorMessage(Object(errors.i)(e)),setIsLoadingJobConfig(!1)}}()},[]),{indexPattern:indexPattern,indexPatternErrorMessage:indexPatternErrorMessage,isInitialized:isInitialized,isLoadingJobConfig:isLoadingJobConfig,jobCapsServiceErrorMessage:jobCapsServiceErrorMessage,jobConfig:jobConfig,jobConfigErrorMessage:jobConfigErrorMessage,jobStatus:jobStatus,needsDestIndexPattern:needsDestIndexPattern,totalFeatureImportance:totalFeatureImportance}};var data_frame_analytics=__webpack_require__(116)},79:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return ANALYSIS_CONFIG_TYPE})),__webpack_require__.d(__webpack_exports__,"c",(function(){return DATA_FRAME_TASK_STATE})),__webpack_require__.d(__webpack_exports__,"d",(function(){return DEFAULT_RESULTS_FIELD})),__webpack_require__.d(__webpack_exports__,"e",(function(){return JOB_MAP_NODE_TYPES})),__webpack_require__.d(__webpack_exports__,"b",(function(){return BUILT_IN_MODEL_TAG}));const ANALYSIS_CONFIG_TYPE={OUTLIER_DETECTION:"outlier_detection",REGRESSION:"regression",CLASSIFICATION:"classification"},DATA_FRAME_TASK_STATE={ANALYZING:"analyzing",FAILED:"failed",REINDEXING:"reindexing",STARTED:"started",STARTING:"starting",STOPPED:"stopped"},DEFAULT_RESULTS_FIELD="ml",JOB_MAP_NODE_TYPES={ANALYTICS:"analytics",TRANSFORM:"transform",INDEX:"index",TRAINED_MODEL:"trainedModel"},BUILT_IN_MODEL_TAG="prepackaged"},85:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return MlContext})),__webpack_require__.d(__webpack_exports__,"b",(function(){return useMlContext}));var external_kbnSharedDeps_React_=__webpack_require__(14);const MlContext=__webpack_require__.n(external_kbnSharedDeps_React_).a.createContext({}),useMlContext=()=>{const context=Object(external_kbnSharedDeps_React_.useContext)(MlContext);if(void 0===context.combinedQuery||void 0===context.currentIndexPattern||void 0===context.currentSavedSearch||void 0===context.indexPatterns||void 0===context.kibanaConfig)throw new Error("required attribute is undefined");return context}},86:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"g",(function(){return MAX_COLUMNS})),__webpack_require__.d(__webpack_exports__,"a",(function(){return BASIC_NUMERICAL_TYPES})),__webpack_require__.d(__webpack_exports__,"b",(function(){return EXTENDED_NUMERICAL_TYPES})),__webpack_require__.d(__webpack_exports__,"h",(function(){return ML__ID_COPY})),__webpack_require__.d(__webpack_exports__,"i",(function(){return ML__INCREMENTAL_ID})),__webpack_require__.d(__webpack_exports__,"k",(function(){return isKeywordAndTextType})),__webpack_require__.d(__webpack_exports__,"l",(function(){return sortExplorationResultsFields})),__webpack_require__.d(__webpack_exports__,"j",(function(){return getDefaultFieldsFromJobCaps}));var _analytics__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(67),_common_util_analytics_utils__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(97),_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(41),_services_new_job_capabilities_new_job_capabilities_service_analytics__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(131),_constants__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(147);const MAX_COLUMNS=10,BASIC_NUMERICAL_TYPES=new Set([_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_2__.ES_FIELD_TYPES.UNSIGNED_LONG,_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_2__.ES_FIELD_TYPES.LONG,_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_2__.ES_FIELD_TYPES.INTEGER,_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_2__.ES_FIELD_TYPES.SHORT,_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_2__.ES_FIELD_TYPES.BYTE]),EXTENDED_NUMERICAL_TYPES=new Set([_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_2__.ES_FIELD_TYPES.DOUBLE,_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_2__.ES_FIELD_TYPES.FLOAT,_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_2__.ES_FIELD_TYPES.HALF_FLOAT,_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_2__.ES_FIELD_TYPES.SCALED_FLOAT]),ML__ID_COPY="ml__id_copy",ML__INCREMENTAL_ID="ml__incremental_id",isKeywordAndTextType=fieldName=>{var _fields$find;const{fields:fields}=_services_new_job_capabilities_new_job_capabilities_service_analytics__WEBPACK_IMPORTED_MODULE_3__.a,fieldType=null===(_fields$find=fields.find(field=>field.name===fieldName))||void 0===_fields$find?void 0:_fields$find.type;let isBothTypes=!1;if(void 0!==fieldType&&fieldType===_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_2__.ES_FIELD_TYPES.KEYWORD){const field=_services_new_job_capabilities_new_job_capabilities_service_analytics__WEBPACK_IMPORTED_MODULE_3__.a.getFieldById(fieldName.replace(/\.keyword$/,""));isBothTypes=null!==field&&field.type===_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_2__.ES_FIELD_TYPES.TEXT}else if(void 0!==fieldType&&fieldType===_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_2__.ES_FIELD_TYPES.TEXT){const field=_services_new_job_capabilities_new_job_capabilities_service_analytics__WEBPACK_IMPORTED_MODULE_3__.a.getFieldById(fieldName+".keyword");isBothTypes=null!==field&&field.type===_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_2__.ES_FIELD_TYPES.KEYWORD}return isBothTypes},sortExplorationResultsFields=(a,b,jobConfig)=>{const resultsField=jobConfig.dest.results_field;if(Object(_common_util_analytics_utils__WEBPACK_IMPORTED_MODULE_1__.g)(jobConfig.analysis)){if(a===`${resultsField}.${_constants__WEBPACK_IMPORTED_MODULE_4__.c}`)return-1;if(b===`${resultsField}.${_constants__WEBPACK_IMPORTED_MODULE_4__.c}`)return 1}if(Object(_common_util_analytics_utils__WEBPACK_IMPORTED_MODULE_1__.f)(jobConfig.analysis)||Object(_common_util_analytics_utils__WEBPACK_IMPORTED_MODULE_1__.h)(jobConfig.analysis)){const dependentVariable=Object(_common_util_analytics_utils__WEBPACK_IMPORTED_MODULE_1__.c)(jobConfig.analysis),predictedField=Object(_common_util_analytics_utils__WEBPACK_IMPORTED_MODULE_1__.d)(resultsField,jobConfig.analysis,!0);if(a===resultsField+".is_training")return-1;if(b===resultsField+".is_training")return 1;if(a===predictedField)return-1;if(b===predictedField)return 1;if(a===dependentVariable||a===dependentVariable.replace(/\.keyword$/,""))return-1;if(b===dependentVariable||b===dependentVariable.replace(/\.keyword$/,""))return 1;if(a===resultsField+".prediction_probability")return-1;if(b===resultsField+".prediction_probability")return 1}const typeofA=typeof a,typeofB=typeof b,tokensA=a.split("."),prefixA=tokensA[0],tokensB=b.split("."),prefixB=tokensB[0];return prefixA===resultsField&&tokensA.length>1&&prefixB!==resultsField?(tokensA.shift(),tokensA.shift(),tokensA.join(".")===b?1:tokensA.join(".").localeCompare(b)):prefixB===resultsField&&tokensB.length>1&&prefixA!==resultsField?(tokensB.shift(),tokensB.shift(),tokensB.join(".")===a?-1:a.localeCompare(tokensB.join("."))):"string"!==typeofA&&"string"===typeofB?1:"string"===typeofA&&"string"!==typeofB?-1:a.localeCompare(b)},getDefaultFieldsFromJobCaps=(fields,jobConfig,needsDestIndexFields)=>{const fieldsObj={selectedFields:[],docFields:[]};if(0===fields.length)return fieldsObj;const resultsField=jobConfig.dest.results_field,allFields=[];let type,predictedField;if(Object(_common_util_analytics_utils__WEBPACK_IMPORTED_MODULE_1__.g)(jobConfig.analysis)&&(fields=jobConfig.analysis.outlier_detection.compute_feature_influence?fields.filter(field=>!field.name.includes(`${resultsField}.${_constants__WEBPACK_IMPORTED_MODULE_4__.b}.`)):fields.filter(field=>!field.name.includes(`${resultsField}.${_constants__WEBPACK_IMPORTED_MODULE_4__.b}`)),!0===needsDestIndexFields&&allFields.push({id:`${resultsField}.${_constants__WEBPACK_IMPORTED_MODULE_4__.c}`,name:`${resultsField}.${_constants__WEBPACK_IMPORTED_MODULE_4__.c}`,type:_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_2__.KBN_FIELD_TYPES.NUMBER})),Object(_common_util_analytics_utils__WEBPACK_IMPORTED_MODULE_1__.f)(jobConfig.analysis)||Object(_common_util_analytics_utils__WEBPACK_IMPORTED_MODULE_1__.h)(jobConfig.analysis)){var _newJobCapsServiceAna;const dependentVariable=Object(_common_util_analytics_utils__WEBPACK_IMPORTED_MODULE_1__.c)(jobConfig.analysis);type=null===(_newJobCapsServiceAna=_services_new_job_capabilities_new_job_capabilities_service_analytics__WEBPACK_IMPORTED_MODULE_3__.a.getFieldById(dependentVariable))||void 0===_newJobCapsServiceAna?void 0:_newJobCapsServiceAna.type;const predictionFieldName=Object(_common_util_analytics_utils__WEBPACK_IMPORTED_MODULE_1__.e)(jobConfig.analysis),numTopFeatureImportanceValues=Object(_analytics__WEBPACK_IMPORTED_MODULE_0__.v)(jobConfig.analysis),numTopClasses=Object(_analytics__WEBPACK_IMPORTED_MODULE_0__.u)(jobConfig.analysis),defaultPredictionField=dependentVariable+"_prediction";predictedField=`${resultsField}.${predictionFieldName||defaultPredictionField}`,fields=0===(null!=numTopFeatureImportanceValues?numTopFeatureImportanceValues:0)?fields.filter(field=>!field.name.includes(`${resultsField}.${_constants__WEBPACK_IMPORTED_MODULE_4__.a}`)):fields.filter(field=>!field.name.includes(`${resultsField}.${_constants__WEBPACK_IMPORTED_MODULE_4__.a}.`)),fields=0===(null!=numTopClasses?numTopClasses:0)?fields.filter(field=>!field.name.includes(`${resultsField}.${_constants__WEBPACK_IMPORTED_MODULE_4__.d}`)):fields.filter(field=>!field.name.includes(`${resultsField}.${_constants__WEBPACK_IMPORTED_MODULE_4__.d}.`)),!0===needsDestIndexFields&&allFields.push({id:resultsField+".is_training",name:resultsField+".is_training",type:_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_2__.ES_FIELD_TYPES.BOOLEAN},{id:predictedField,name:predictedField,type:type})}allFields.push(...fields),allFields.sort(({name:a},{name:b})=>sortExplorationResultsFields(a,b,jobConfig));let selectedFields=allFields.filter(field=>field.name===predictedField||!field.name.includes(".keyword"));return selectedFields.length>8&&(selectedFields=selectedFields.slice(0,8)),{selectedFields:selectedFields,docFields:allFields,depVarType:type}}},91:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return INIT_MAX_COLUMNS})),__webpack_require__.d(__webpack_exports__,"a",(function(){return COLUMN_CHART_DEFAULT_VISIBILITY_ROWS_THRESHOLED})),__webpack_require__.d(__webpack_exports__,"d",(function(){return euiDataGridStyle})),__webpack_require__.d(__webpack_exports__,"e",(function(){return euiDataGridToolbarSettings})),__webpack_require__.d(__webpack_exports__,"k",(function(){return getFieldsFromKibanaIndexPattern})),__webpack_require__.d(__webpack_exports__,"f",(function(){return getCombinedRuntimeMappings})),__webpack_require__.d(__webpack_exports__,"i",(function(){return getDataGridSchemasFromFieldTypes})),__webpack_require__.d(__webpack_exports__,"c",(function(){return NON_AGGREGATABLE})),__webpack_require__.d(__webpack_exports__,"g",(function(){return getDataGridSchemaFromESFieldType})),__webpack_require__.d(__webpack_exports__,"h",(function(){return getDataGridSchemaFromKibanaFieldType})),__webpack_require__.d(__webpack_exports__,"j",(function(){return getFeatureImportance})),__webpack_require__.d(__webpack_exports__,"m",(function(){return getTopClasses})),__webpack_require__.d(__webpack_exports__,"p",(function(){return useRenderCellValue})),__webpack_require__.d(__webpack_exports__,"n",(function(){return multiColumnSortFactory})),__webpack_require__.d(__webpack_exports__,"o",(function(){return showDataGridColumnChartErrorMessageToast})),__webpack_require__.d(__webpack_exports__,"l",(function(){return getProcessedFields}));var moment_timezone__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(48),moment_timezone__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(moment_timezone__WEBPACK_IMPORTED_MODULE_0__),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(14),_kbn_i18n__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(2),_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(41),_common_constants_data_frame_analytics__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(79),_common_util_errors__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(24),_data_frame_analytics_common_fields__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(86),_data_frame_analytics_common_constants__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(147),_common_util_date_utils__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(72),_util_object_utils__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(232),_services_field_format_service__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(132),_common_util_runtime_field_utils__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(18);const INIT_MAX_COLUMNS=10,COLUMN_CHART_DEFAULT_VISIBILITY_ROWS_THRESHOLED=1e4,euiDataGridStyle={border:"all",fontSize:"s",cellPadding:"s",stripes:!1,rowHover:"none",header:"shade"},euiDataGridToolbarSettings={showColumnSelector:!0,showStyleSelector:!1,showSortSelector:!0,showFullScreenSelector:!1},getFieldsFromKibanaIndexPattern=indexPattern=>{const allFields=indexPattern.fields.map(f=>f.name);return allFields.filter(f=>{if(indexPattern.metaFields.includes(f))return!1;const fieldParts=f.split(".");return"keyword"!==fieldParts.pop()||!allFields.includes(fieldParts.join("."))})};function getCombinedRuntimeMappings(indexPattern,runtimeMappings){let combinedRuntimeMappings={};if(indexPattern){const computedFields=null==indexPattern?void 0:indexPattern.getComputedFields();if(void 0!==(null==computedFields?void 0:computedFields.runtimeFields)){const indexPatternRuntimeMappings=computedFields.runtimeFields;Object(_common_util_runtime_field_utils__WEBPACK_IMPORTED_MODULE_11__.b)(indexPatternRuntimeMappings)&&(combinedRuntimeMappings={...combinedRuntimeMappings,...indexPatternRuntimeMappings})}}if(Object(_common_util_runtime_field_utils__WEBPACK_IMPORTED_MODULE_11__.b)(runtimeMappings)&&(combinedRuntimeMappings={...combinedRuntimeMappings,...runtimeMappings}),Object(_common_util_runtime_field_utils__WEBPACK_IMPORTED_MODULE_11__.b)(combinedRuntimeMappings))return combinedRuntimeMappings}const getDataGridSchemasFromFieldTypes=(fieldTypes,resultsField)=>Object.keys(fieldTypes).map(field=>{let schema;const type=fieldTypes[field];switch(void 0!==type&&(_data_frame_analytics_common_fields__WEBPACK_IMPORTED_MODULE_6__.a.has(type)||_data_frame_analytics_common_fields__WEBPACK_IMPORTED_MODULE_6__.b.has(type))&&(schema="numeric"),type){case"date":schema="datetime";break;case"nested":case"geo_point":schema="json";break;case"boolean":schema="boolean";break;case"text":schema=NON_AGGREGATABLE}return field===`${resultsField}.${_data_frame_analytics_common_constants__WEBPACK_IMPORTED_MODULE_7__.c}`&&(schema="numeric"),field.includes(`${resultsField}.${_data_frame_analytics_common_constants__WEBPACK_IMPORTED_MODULE_7__.d}`)&&(schema="json"),field.includes(`${resultsField}.${_data_frame_analytics_common_constants__WEBPACK_IMPORTED_MODULE_7__.a}`)&&(schema="featureImportance"),field===`${resultsField}.${_data_frame_analytics_common_constants__WEBPACK_IMPORTED_MODULE_7__.b}`&&(schema="featureInfluence"),{id:field,schema:schema,isSortable:!0}}),NON_AGGREGATABLE="non-aggregatable",getDataGridSchemaFromESFieldType=fieldType=>{let schema;switch(fieldType){case _src_plugins_data_public__WEBPACK_IMPORTED_MODULE_3__.ES_FIELD_TYPES.GEO_POINT:case _src_plugins_data_public__WEBPACK_IMPORTED_MODULE_3__.ES_FIELD_TYPES.GEO_SHAPE:schema="json";break;case _src_plugins_data_public__WEBPACK_IMPORTED_MODULE_3__.ES_FIELD_TYPES.BOOLEAN:schema="boolean";break;case _src_plugins_data_public__WEBPACK_IMPORTED_MODULE_3__.ES_FIELD_TYPES.DATE:case _src_plugins_data_public__WEBPACK_IMPORTED_MODULE_3__.ES_FIELD_TYPES.DATE_NANOS:schema="datetime";break;case _src_plugins_data_public__WEBPACK_IMPORTED_MODULE_3__.ES_FIELD_TYPES.BYTE:case _src_plugins_data_public__WEBPACK_IMPORTED_MODULE_3__.ES_FIELD_TYPES.DOUBLE:case _src_plugins_data_public__WEBPACK_IMPORTED_MODULE_3__.ES_FIELD_TYPES.FLOAT:case _src_plugins_data_public__WEBPACK_IMPORTED_MODULE_3__.ES_FIELD_TYPES.HALF_FLOAT:case _src_plugins_data_public__WEBPACK_IMPORTED_MODULE_3__.ES_FIELD_TYPES.INTEGER:case _src_plugins_data_public__WEBPACK_IMPORTED_MODULE_3__.ES_FIELD_TYPES.LONG:case _src_plugins_data_public__WEBPACK_IMPORTED_MODULE_3__.ES_FIELD_TYPES.SCALED_FLOAT:case _src_plugins_data_public__WEBPACK_IMPORTED_MODULE_3__.ES_FIELD_TYPES.SHORT:schema="numeric";break;case _src_plugins_data_public__WEBPACK_IMPORTED_MODULE_3__.ES_FIELD_TYPES.KEYWORD:case _src_plugins_data_public__WEBPACK_IMPORTED_MODULE_3__.ES_FIELD_TYPES.TEXT:}return schema},getDataGridSchemaFromKibanaFieldType=field=>{let schema;switch(null==field?void 0:field.type){case _src_plugins_data_public__WEBPACK_IMPORTED_MODULE_3__.KBN_FIELD_TYPES.BOOLEAN:schema="boolean";break;case _src_plugins_data_public__WEBPACK_IMPORTED_MODULE_3__.KBN_FIELD_TYPES.DATE:schema="datetime";break;case _src_plugins_data_public__WEBPACK_IMPORTED_MODULE_3__.KBN_FIELD_TYPES.GEO_POINT:case _src_plugins_data_public__WEBPACK_IMPORTED_MODULE_3__.KBN_FIELD_TYPES.GEO_SHAPE:schema="json";break;case _src_plugins_data_public__WEBPACK_IMPORTED_MODULE_3__.KBN_FIELD_TYPES.NUMBER:schema="numeric";break;case _src_plugins_data_public__WEBPACK_IMPORTED_MODULE_3__.KBN_FIELD_TYPES.NESTED:schema="json"}return void 0===schema&&!1===(null==field?void 0:field.aggregatable)?NON_AGGREGATABLE:schema},getClassName=(className,isClassTypeBoolean)=>isClassTypeBoolean?"true"===className:className,getFeatureImportance=(row,mlResultsField,isClassTypeBoolean=!1)=>{const featureImportance=row[mlResultsField+".feature_importance"];return void 0===featureImportance?[]:featureImportance.map(fi=>({feature_name:Array.isArray(fi.feature_name)?fi.feature_name[0]:fi.feature_name,classes:Array.isArray(fi.classes)?fi.classes.map(c=>{const processedClass=getProcessedFields(c);return{importance:processedClass.importance,class_name:getClassName(processedClass.class_name,isClassTypeBoolean)}}):fi.classes,importance:Array.isArray(fi.importance)?fi.importance[0]:fi.importance}))},getTopClasses=(row,mlResultsField)=>{const topClasses=row[mlResultsField+".top_classes"];return void 0===topClasses?[]:topClasses.map(tc=>getProcessedFields(tc))},useRenderCellValue=(indexPattern,pagination,tableItems,resultsField,cellPropsCallback)=>Object(react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(()=>({rowIndex:rowIndex,columnId:columnId,setCellProps:setCellProps})=>{const adjustedRowIndex=rowIndex-pagination.pageIndex*pagination.pageSize,fullItem=tableItems[adjustedRowIndex];if(void 0===fullItem)return null;if(void 0===indexPattern)return null;let format;void 0!==indexPattern&&(format=_services_field_format_service__WEBPACK_IMPORTED_MODULE_10__.a.getFieldFormatFromIndexPattern(indexPattern,columnId,""));const cellValue=function(cId){if(tableItems.hasOwnProperty(adjustedRowIndex)){const item=tableItems[adjustedRowIndex];return item.hasOwnProperty(cId)?item[cId]:cId===resultsField+".feature_importance"?getFeatureImportance(fullItem,null!=resultsField?resultsField:_common_constants_data_frame_analytics__WEBPACK_IMPORTED_MODULE_4__.d):cId===resultsField+".top_classes"?getTopClasses(fullItem,null!=resultsField?resultsField:_common_constants_data_frame_analytics__WEBPACK_IMPORTED_MODULE_4__.d):Object(_util_object_utils__WEBPACK_IMPORTED_MODULE_9__.a)(tableItems[adjustedRowIndex],cId,null)}return null}(columnId);if(Object(react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{"function"==typeof cellPropsCallback&&cellPropsCallback(columnId,cellValue,fullItem,setCellProps)},[columnId,cellValue]),"object"==typeof cellValue&&null!==cellValue)return JSON.stringify(cellValue);if(null==cellValue)return null;if(void 0!==format)return format.convert(cellValue,"text");if("string"==typeof cellValue||null===cellValue)return cellValue;const field=indexPattern.fields.getByName(columnId);return(null==field?void 0:field.type)===_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_3__.KBN_FIELD_TYPES.DATE?Object(_common_util_date_utils__WEBPACK_IMPORTED_MODULE_8__.c)(1e3*moment_timezone__WEBPACK_IMPORTED_MODULE_0___default()(cellValue).unix()):"boolean"==typeof cellValue?cellValue?"true":"false":cellValue},[null==indexPattern?void 0:indexPattern.fields,pagination.pageIndex,pagination.pageSize,tableItems]),multiColumnSortFactory=sortingColumns=>{const isString=arg=>"string"==typeof arg,sortFn=(a,b,sortingColumnIndex=0)=>{const sort=sortingColumns[sortingColumnIndex],aValue=Object(_util_object_utils__WEBPACK_IMPORTED_MODULE_9__.a)(a,sort.id,null),bValue=Object(_util_object_utils__WEBPACK_IMPORTED_MODULE_9__.a)(b,sort.id,null);if("number"==typeof aValue&&"number"==typeof bValue){if(aValue<bValue)return"asc"===sort.direction?-1:1;if(aValue>bValue)return"asc"===sort.direction?1:-1}if(isString(aValue)&&isString(bValue)){if(-1===aValue.localeCompare(bValue))return"asc"===sort.direction?-1:1;if(1===aValue.localeCompare(bValue))return"asc"===sort.direction?1:-1}return sortingColumnIndex+1<sortingColumns.length?sortFn(a,b,sortingColumnIndex+1):0};return sortFn},showDataGridColumnChartErrorMessageToast=(e,toastNotifications)=>{const error=Object(_common_util_errors__WEBPACK_IMPORTED_MODULE_5__.i)(e);toastNotifications.addDanger(_kbn_i18n__WEBPACK_IMPORTED_MODULE_2__.i18n.translate("xpack.ml.dataGrid.columnChart.ErrorMessageToast",{defaultMessage:"An error occurred fetching the histogram charts data: {error}",values:{error:""!==error?error:e}}))},getProcessedFields=(originalObj,omitBy)=>{const obj={...originalObj};for(const key of Object.keys(obj))void 0===omitBy?Array.isArray(obj[key])&&1===obj[key].length&&(obj[key]=obj[key][0]):!1===omitBy(key)&&Array.isArray(obj[key])&&1===obj[key].length&&(obj[key]=obj[key][0]);return obj}},93:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return DATA_FRAME_MODE})),__webpack_require__.d(__webpack_exports__,"f",(function(){return isDataFrameAnalyticsFailed})),__webpack_require__.d(__webpack_exports__,"g",(function(){return isDataFrameAnalyticsRunning})),__webpack_require__.d(__webpack_exports__,"i",(function(){return isDataFrameAnalyticsStopped})),__webpack_require__.d(__webpack_exports__,"h",(function(){return isDataFrameAnalyticsStats})),__webpack_require__.d(__webpack_exports__,"d",(function(){return getDataFrameAnalyticsProgressPhase})),__webpack_require__.d(__webpack_exports__,"c",(function(){return DataFrameAnalyticsListColumn})),__webpack_require__.d(__webpack_exports__,"e",(function(){return isCompletedAnalyticsJob}));__webpack_require__(39);var _common_constants_data_frame_analytics__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(79);__webpack_require__.d(__webpack_exports__,"b",(function(){return _common_constants_data_frame_analytics__WEBPACK_IMPORTED_MODULE_1__.c}));__webpack_require__(116);let DATA_FRAME_MODE;function isDataFrameAnalyticsFailed(state){return state===_common_constants_data_frame_analytics__WEBPACK_IMPORTED_MODULE_1__.c.FAILED}function isDataFrameAnalyticsRunning(state){return state===_common_constants_data_frame_analytics__WEBPACK_IMPORTED_MODULE_1__.c.ANALYZING||state===_common_constants_data_frame_analytics__WEBPACK_IMPORTED_MODULE_1__.c.REINDEXING||state===_common_constants_data_frame_analytics__WEBPACK_IMPORTED_MODULE_1__.c.STARTED||state===_common_constants_data_frame_analytics__WEBPACK_IMPORTED_MODULE_1__.c.STARTING}function isDataFrameAnalyticsStopped(state){return state===_common_constants_data_frame_analytics__WEBPACK_IMPORTED_MODULE_1__.c.STOPPED}function isDataFrameAnalyticsStats(arg){return"object"==typeof arg&&null!==arg&&{}.hasOwnProperty.call(arg,"state")&&Object.values(_common_constants_data_frame_analytics__WEBPACK_IMPORTED_MODULE_1__.c).includes(arg.state)&&{}.hasOwnProperty.call(arg,"progress")&&Array.isArray(arg.progress)}function getDataFrameAnalyticsProgressPhase(stats){let phase=0,progress=0;for(const progressPhase of stats.progress)if(phase++,progress=progressPhase.progress_percent,progressPhase.progress_percent<100)break;return{currentPhase:phase,progress:progress,totalPhases:stats.progress.length}}!function(DATA_FRAME_MODE){DATA_FRAME_MODE.BATCH="batch",DATA_FRAME_MODE.CONTINUOUS="continuous"}(DATA_FRAME_MODE||(DATA_FRAME_MODE={}));const DataFrameAnalyticsListColumn={configDestIndex:"config.dest.index",configSourceIndex:"config.source.index",configCreateTime:"config.create_time",description:"config.description",id:"id",memoryStatus:"stats.memory_usage.status"};function isCompletedAnalyticsJob(stats){const progress=function(stats){if(isDataFrameAnalyticsStats(stats))return Math.round(stats.progress.reduce((p,c)=>p+c.progress_percent,0)/stats.progress.length)}(stats);return stats.state===_common_constants_data_frame_analytics__WEBPACK_IMPORTED_MODULE_1__.c.STOPPED&&100===progress}},97:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"g",(function(){return isOutlierAnalysis})),__webpack_require__.d(__webpack_exports__,"h",(function(){return isRegressionAnalysis})),__webpack_require__.d(__webpack_exports__,"f",(function(){return isClassificationAnalysis})),__webpack_require__.d(__webpack_exports__,"c",(function(){return getDependentVar})),__webpack_require__.d(__webpack_exports__,"e",(function(){return getPredictionFieldName})),__webpack_require__.d(__webpack_exports__,"b",(function(){return getDefaultPredictionFieldName})),__webpack_require__.d(__webpack_exports__,"d",(function(){return getPredictedFieldName})),__webpack_require__.d(__webpack_exports__,"a",(function(){return getAnalysisType}));var _constants_data_frame_analytics__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(79);const isOutlierAnalysis=arg=>{if("object"!=typeof arg||null===arg)return!1;const keys=Object.keys(arg);return 1===keys.length&&keys[0]===_constants_data_frame_analytics__WEBPACK_IMPORTED_MODULE_0__.a.OUTLIER_DETECTION},isRegressionAnalysis=arg=>{if("object"!=typeof arg||null===arg)return!1;const keys=Object.keys(arg);return 1===keys.length&&keys[0]===_constants_data_frame_analytics__WEBPACK_IMPORTED_MODULE_0__.a.REGRESSION},isClassificationAnalysis=arg=>{if("object"!=typeof arg||null===arg)return!1;const keys=Object.keys(arg);return 1===keys.length&&keys[0]===_constants_data_frame_analytics__WEBPACK_IMPORTED_MODULE_0__.a.CLASSIFICATION},getDependentVar=analysis=>{let depVar="";return isRegressionAnalysis(analysis)&&(depVar=analysis.regression.dependent_variable),isClassificationAnalysis(analysis)&&(depVar=analysis.classification.dependent_variable),depVar},getPredictionFieldName=analysis=>{let predictionFieldName;return isRegressionAnalysis(analysis)&&void 0!==analysis.regression.prediction_field_name?predictionFieldName=analysis.regression.prediction_field_name:isClassificationAnalysis(analysis)&&void 0!==analysis.classification.prediction_field_name&&(predictionFieldName=analysis.classification.prediction_field_name),predictionFieldName},getDefaultPredictionFieldName=analysis=>getDependentVar(analysis)+"_prediction",getPredictedFieldName=(resultsField,analysis,forSort)=>{const predictionFieldName=getPredictionFieldName(analysis);return`${resultsField}.${predictionFieldName||getDefaultPredictionFieldName(analysis)}`},getAnalysisType=analysis=>{const keys=Object.keys(analysis||{});return 1===keys.length?keys[0]:"unknown"}}}]);