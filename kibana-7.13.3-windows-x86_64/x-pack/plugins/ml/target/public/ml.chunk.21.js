/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.ml_bundle_jsonpfunction=window.ml_bundle_jsonpfunction||[]).push([[21],{882:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"OverviewPage",(function(){return OverviewPage}));var external_kbnSharedDeps_React_=__webpack_require__(14),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),external_kbnSharedDeps_ElasticEui_=__webpack_require__(39),check_capabilities=__webpack_require__(68),check_ml_nodes=__webpack_require__(83),navigation_menu=__webpack_require__(100),external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(40),kibana=__webpack_require__(63);const OverviewSideBar=({createAnomalyDetectionJobDisabled:createAnomalyDetectionJobDisabled})=>{const{services:{docLinks:docLinks,http:{basePath:basePath}}}=Object(kibana.b)(),docsLink=docLinks.links.ml.guide,transformsLink=basePath.get()+"/app/management/data/transform";return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"m"},external_kbnSharedDeps_React_default.a.createElement("h1",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.overview.gettingStartedSectionTitle",defaultMessage:"Getting started"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{className:"mlOverview__sidebar"},external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.overview.gettingStartedSectionText",defaultMessage:"Welcome to Machine Learning. Get started by reviewing our {docs} or creating a new job. We recommend using {transforms} to create feature indices for analytics jobs.",values:{docs:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{href:docsLink,target:"blank"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.overview.gettingStartedSectionDocs",defaultMessage:"documentation"})),transforms:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{href:transformsLink,target:"blank"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.overview.gettingStartedSectionTransforms",defaultMessage:"Elasticsearch's transforms"}))}})),external_kbnSharedDeps_React_default.a.createElement("h2",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.overview.feedbackSectionTitle",defaultMessage:"Feedback"})),external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.overview.feedbackSectionText",defaultMessage:"If you have input or suggestions regarding your experience, please submit {feedbackLink}.",values:{feedbackLink:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{href:"https://www.elastic.co/community/",target:"blank"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.overview.feedbackSectionLink",defaultMessage:"feedback online"}))}}))))};var external_kbnSharedDeps_KbnI18n_=__webpack_require__(2),external_kbnSharedDeps_Moment_=__webpack_require__(15),external_kbnSharedDeps_Moment_default=__webpack_require__.n(external_kbnSharedDeps_Moment_),date_utils=__webpack_require__(72),use_create_ad_links=__webpack_require__(242);const ExplorerLink=({jobsList:jobsList})=>{const openJobsInAnomalyExplorerText=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.overview.anomalyDetection.resultActions.openJobsInAnomalyExplorerText",{defaultMessage:"Open {jobsCount, plural, one {{jobId}} other {# jobs}} in Anomaly Explorer",values:{jobsCount:jobsList.length,jobId:jobsList[0]&&jobsList[0].id}}),{createLinkWithUserDefaults:createLinkWithUserDefaults}=Object(use_create_ad_links.a)();return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{position:"bottom",content:openJobsInAnomalyExplorerText},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{href:createLinkWithUserDefaults("explorer",jobsList),color:"text",size:"xs",iconType:"visTable","aria-label":openJobsInAnomalyExplorerText,className:"results-button","data-test-subj":"openOverviewJobsInAnomalyExplorer"},external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.overview.anomalyDetection.viewActionName",{defaultMessage:"View"})))};var states=__webpack_require__(106);function getJobsFromGroup(group,jobs){return group.jobIds.map(jobId=>jobs[jobId]).filter(id=>void 0!==id)}var stats_bar=__webpack_require__(183),job_selector_badge=__webpack_require__(227),string_utils=__webpack_require__(89),anomaly_utils=__webpack_require__(6);let AnomalyDetectionListColumns;!function(AnomalyDetectionListColumns){AnomalyDetectionListColumns.id="id",AnomalyDetectionListColumns.maxAnomalyScore="max_anomaly_score",AnomalyDetectionListColumns.jobIds="jobIds",AnomalyDetectionListColumns.latestTimestamp="latest_timestamp",AnomalyDetectionListColumns.docsProcessed="docs_processed",AnomalyDetectionListColumns.jobsInGroup="jobs_in_group"}(AnomalyDetectionListColumns||(AnomalyDetectionListColumns={}));const AnomalyDetectionTable=({items:items,jobsList:jobsList,statsBarData:statsBarData})=>{const groupsList=Object.values(items),[pageIndex,setPageIndex]=Object(external_kbnSharedDeps_React_.useState)(0),[pageSize,setPageSize]=Object(external_kbnSharedDeps_React_.useState)(10),[sortField,setSortField]=Object(external_kbnSharedDeps_React_.useState)(AnomalyDetectionListColumns.id),[sortDirection,setSortDirection]=Object(external_kbnSharedDeps_React_.useState)("asc"),columns=[{field:AnomalyDetectionListColumns.id,name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.overview.anomalyDetection.tableId",{defaultMessage:"Group ID"}),render:id=>external_kbnSharedDeps_React_default.a.createElement(job_selector_badge.a,{id:id,isGroup:"ungrouped"!==id}),sortable:!0,truncateText:!0,width:"20%"},{field:AnomalyDetectionListColumns.maxAnomalyScore,name:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{content:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.overview.anomalyDetection.tableMaxScoreTooltip",{defaultMessage:"Maximum score across all jobs in the group over its most recent 24 hour period"})},external_kbnSharedDeps_React_default.a.createElement("span",null,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.overview.anomalyDetection.tableMaxScore",{defaultMessage:"Max anomaly score"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{size:"s",color:"subdued",type:"questionInCircle",className:"eui-alignTop"}))),sortable:!0,render:score=>{if(void 0===score)return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingSpinner,null);if(null===score)return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{content:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.overview.anomalyDetection.tableMaxScoreErrorTooltip",{defaultMessage:"There was a problem loading the maximum anomaly score"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{type:"alert"}));if(0===score)return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHealth,{color:"transparent",compressed:"true"},score);{const color=Object(anomaly_utils.j)(score);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiHealth,{color:color,compressed:"true"},Object(anomaly_utils.g)(score))}},truncateText:!0,width:"150px"},{field:AnomalyDetectionListColumns.jobsInGroup,name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.overview.anomalyDetection.tableNumJobs",{defaultMessage:"Jobs in group"}),sortable:!0,truncateText:!0,width:"100px"},{field:AnomalyDetectionListColumns.latestTimestamp,name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.overview.anomalyDetection.tableLatestTimestamp",{defaultMessage:"Latest timestamp"}),dataType:"date",render:time=>Object(date_utils.c)(time),textOnly:!0,truncateText:!0,sortable:!0,width:"20%"},{field:AnomalyDetectionListColumns.docsProcessed,name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.overview.anomalyDetection.tableDocsProcessed",{defaultMessage:"Docs processed"}),render:docs=>Object(string_utils.g)(docs),textOnly:!0,sortable:!0,width:"20%"},{name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.overview.anomalyDetection.tableActionLabel",{defaultMessage:"Actions"}),render:group=>external_kbnSharedDeps_React_default.a.createElement(ExplorerLink,{jobsList:getJobsFromGroup(group,jobsList)}),width:"100px",align:"right"}],pagination={initialPageIndex:pageIndex,initialPageSize:pageSize,totalItemCount:groupsList.length,pageSizeOptions:[10,20,50],hidePerPageOptions:!1},sorting={sort:{field:sortField,direction:sortDirection}};return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"m"},external_kbnSharedDeps_React_default.a.createElement("h3",null,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.overview.anomalyDetection.panelTitle",{defaultMessage:"Anomaly Detection"})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,className:"mlOverviewPanel__statsBar"},external_kbnSharedDeps_React_default.a.createElement(stats_bar.a,{stats:statsBarData,dataTestSub:"mlOverviewJobStatsBar"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiInMemoryTable,{allowNeutralSort:!1,className:"mlAnomalyDetectionTable",columns:columns,hasActions:!1,isExpandable:!1,isSelectable:!1,items:groupsList,itemId:AnomalyDetectionListColumns.id,onTableChange:({page:page={index:0,size:10},sort:sort={field:AnomalyDetectionListColumns.id,direction:"asc"}})=>{const{index:index,size:size}=page;setPageIndex(index),setPageSize(size);const{field:field,direction:direction}=sort;setSortField(field),setSortDirection(direction)},pagination:pagination,sorting:sorting,"data-test-subj":"mlOverviewTableAnomalyDetection"}))};var ml_api_service=__webpack_require__(64),ml_url_generator=__webpack_require__(0);const AnomalyDetectionPanel=({jobCreationDisabled:jobCreationDisabled,setLazyJobCount:setLazyJobCount})=>{const{services:{notifications:notifications}}=Object(kibana.b)(),mlUrlGenerator=Object(kibana.d)(),navigateToPath=Object(kibana.e)(),[isLoading,setIsLoading]=Object(external_kbnSharedDeps_React_.useState)(!1),[groups,setGroups]=Object(external_kbnSharedDeps_React_.useState)({}),[groupsCount,setGroupsCount]=Object(external_kbnSharedDeps_React_.useState)(0),[jobsList,setJobsList]=Object(external_kbnSharedDeps_React_.useState)([]),[statsBarData,setStatsBarData]=Object(external_kbnSharedDeps_React_.useState)(void 0),[errorMessage,setErrorMessage]=Object(external_kbnSharedDeps_React_.useState)(void 0),loadJobs=async()=>{setIsLoading(!0);let lazyJobCount=0;try{const jobsSummaryList=(await ml_api_service.ml.jobs.jobsSummary([])).map(job=>(job.latestTimestampSortValue=job.latestTimestampMs||0,job.awaitingNodeAssignment&&lazyJobCount++,job)),{groups:jobsGroups,count:count}=function(jobs){const groups={ungrouped:{id:"ungrouped",jobIds:[],docs_processed:0,latest_timestamp:0,max_anomaly_score:null,jobs_in_group:0}};jobs.forEach(job=>{job.groups.length>0?job.groups.forEach(g=>{void 0===groups[g]?groups[g]={id:g,jobIds:[job.id],docs_processed:job.processed_record_count,latest_timestamp:job.latestTimestampMs,max_anomaly_score:null,jobs_in_group:1}:(groups[g].jobIds.push(job.id),groups[g].docs_processed+=job.processed_record_count,groups[g].jobs_in_group++,(void 0===groups[g].latest_timestamp||job.latestTimestampMs&&job.latestTimestampMs>groups[g].latest_timestamp)&&(groups[g].latest_timestamp=job.latestTimestampMs))}):(groups.ungrouped.jobIds.push(job.id),groups.ungrouped.docs_processed+=job.processed_record_count,groups.ungrouped.jobs_in_group++,job.latestTimestampMs&&job.latestTimestampMs>groups.ungrouped.latest_timestamp&&(groups.ungrouped.latest_timestamp=job.latestTimestampMs))}),0===groups.ungrouped.jobIds.length&&delete groups.ungrouped;const count=Object.values(groups).length;return{groups:groups,count:count}}(jobsSummaryList),jobsWithTimerange=function(jobsList){const jobs={};return jobsList.forEach(job=>{if(void 0===jobs[job.id]&&void 0!==job.earliestTimestampMs){const{earliestTimestampMs:earliestTimestampMs,latestResultsTimestampMs:latestResultsTimestampMs}=job;jobs[job.id]={id:job.id,earliestTimestampMs:earliestTimestampMs,latestResultsTimestampMs:latestResultsTimestampMs}}}),jobs}(jobsSummaryList),stats=function(jobsList){const jobStats={activeNodes:{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.overviewJobsList.statsBar.activeMLNodesLabel",{defaultMessage:"Active ML nodes"}),value:0,show:!0},total:{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.overviewJobsList.statsBar.totalJobsLabel",{defaultMessage:"Total jobs"}),value:0,show:!0},open:{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.overviewJobsList.statsBar.openJobsLabel",{defaultMessage:"Open jobs"}),value:0,show:!0},closed:{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.overviewJobsList.statsBar.closedJobsLabel",{defaultMessage:"Closed jobs"}),value:0,show:!0},failed:{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.overviewJobsList.statsBar.failedJobsLabel",{defaultMessage:"Failed jobs"}),value:0,show:!1},activeDatafeeds:{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.jobsList.statsBar.activeDatafeedsLabel",{defaultMessage:"Active datafeeds"}),value:0,show:!0}};if(void 0===jobsList)return jobStats;const mlNodes={};let failedJobs=0;return jobsList.forEach(job=>{job.jobState===states.c.OPENED?jobStats.open.value++:job.jobState===states.c.CLOSED?jobStats.closed.value++:job.jobState===states.c.FAILED&&failedJobs++,job.hasDatafeed&&job.datafeedState===states.a.STARTED&&jobStats.activeDatafeeds.value++,void 0!==job.nodeName&&(mlNodes[job.nodeName]={})}),jobStats.total.value=jobsList.length,failedJobs?(jobStats.failed.value=failedJobs,jobStats.failed.show=!0):jobStats.failed.show=!1,jobStats.activeNodes.value=Object.keys(mlNodes).length,jobStats}(jobsSummaryList);setIsLoading(!1),setErrorMessage(void 0),setStatsBarData(stats),setGroupsCount(count),setGroups(jobsGroups),setJobsList(jobsWithTimerange),loadMaxAnomalyScores(jobsGroups),setLazyJobCount(lazyJobCount)}catch(e){setErrorMessage(void 0!==e.message?e.message:JSON.stringify(e)),setIsLoading(!1)}},loadMaxAnomalyScores=async groupsObject=>{const groupsList=Object.values(groupsObject),scores=function(groups){const anomalyScores={};return groups.forEach(group=>{anomalyScores[group.id]={maxScore:0}}),anomalyScores}(groupsList);try{const promises=groupsList.filter(group=>group.jobIds.length>0).map((group,i)=>{scores[group.id].index=i;const latestTimestamp=group.latest_timestamp,twentyFourHoursAgo=external_kbnSharedDeps_Moment_default()(latestTimestamp).subtract(24,"hours").valueOf();return ml_api_service.ml.results.getMaxAnomalyScore(group.jobIds,twentyFourHoursAgo,latestTimestamp)}),results=await Promise.all(promises),tempGroups={...groupsObject};Object.keys(scores).forEach(groupId=>{const resultsIndex=scores[groupId]&&scores[groupId].index,{maxScore:maxScore}=void 0!==resultsIndex&&results[resultsIndex];tempGroups[groupId].max_anomaly_score=maxScore}),setGroups(tempGroups)}catch(e){const{toasts:toasts}=notifications;toasts.addDanger(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.overview.anomalyDetection.errorWithFetchingAnomalyScoreNotificationErrorMessage",{defaultMessage:"An error occurred fetching anomaly scores: {error}",values:{error:void 0!==e.message?e.message:JSON.stringify(e)}}))}};Object(external_kbnSharedDeps_React_.useEffect)(()=>{loadJobs()},[]);const errorDisplay=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.overview.anomalyDetection.errorPromptTitle",{defaultMessage:"An error occurred getting the anomaly detection jobs list."}),color:"danger",iconType:"alert"},external_kbnSharedDeps_React_default.a.createElement("pre",null,errorMessage))),panelClass=isLoading?"mlOverviewPanel__isLoading":"mlOverviewPanel";return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPanel,{className:panelClass},void 0!==errorMessage&&errorDisplay,isLoading&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingSpinner,{className:"mlOverviewPanel__spinner",size:"xl"}),!1===isLoading&&void 0===errorMessage&&0===groupsCount&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiEmptyPrompt,{iconType:"createSingleMetricJob",title:external_kbnSharedDeps_React_default.a.createElement("h2",null,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.overview.anomalyDetection.createFirstJobMessage",{defaultMessage:"Create your first anomaly detection job"})),body:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.overview.anomalyDetection.emptyPromptText",{defaultMessage:"Anomaly detection enables you to find unusual behavior in time series data. Start automatically spotting the anomalies hiding in your data and resolve issues faster."}))),actions:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{color:"primary",onClick:async()=>{const path=await mlUrlGenerator.createUrl({page:ml_url_generator.b.ANOMALY_DETECTION_CREATE_JOB_SELECT_INDEX});await navigateToPath(path,!0)},fill:!0,iconType:"plusInCircle",isDisabled:jobCreationDisabled,"data-test-subj":"mlOverviewCreateADJobButton"},external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.overview.anomalyDetection.createJobButtonText",{defaultMessage:"Create job"}))}),!1===isLoading&&void 0===errorMessage&&groupsCount>0&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(AnomalyDetectionTable,{items:groups,jobsList:jobsList,statsBarData:statsBarData}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement("div",{className:"mlOverviewPanel__buttons"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{size:"s",onClick:()=>{loadJobs()},className:"mlOverviewPanel__refreshButton"},external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.overview.anomalyDetection.refreshJobsButtonText",{defaultMessage:"Refresh"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{size:"s",fill:!0,onClick:async()=>{const path=await mlUrlGenerator.createUrl({page:ml_url_generator.b.ANOMALY_DETECTION_JOBS_MANAGE});await navigateToPath(path,!0)}},external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.overview.anomalyDetection.manageJobsButtonText",{defaultMessage:"Manage jobs"})))))};var common_analytics=__webpack_require__(67),common=__webpack_require__(93),use_columns=__webpack_require__(283),get_view_link_status=__webpack_require__(199);const ViewLink=({item:item})=>{const{disabled:disabled,tooltipContent:tooltipContent}=Object(get_view_link_status.a)(item),viewJobResultsButtonText=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.overview.analytics.resultActions.openJobText",{defaultMessage:"View job results"}),tooltipText=!1===disabled?viewJobResultsButtonText:tooltipContent,analysisType=Object(external_kbnSharedDeps_React_.useMemo)(()=>Object(common_analytics.r)(item.config.analysis),[item]),viewAnalyticsResultsLink=Object(kibana.c)({page:ml_url_generator.b.DATA_FRAME_ANALYTICS_EXPLORATION,pageState:{jobId:item.id,analysisType:analysisType}});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{position:"bottom",content:tooltipText},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{href:viewAnalyticsResultsLink,color:"text",size:"xs",iconType:"visTable","aria-label":viewJobResultsButtonText,className:"results-button","data-test-subj":"mlOverviewAnalyticsJobViewButton",isDisabled:disabled},external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.overview.analytics.viewActionName",{defaultMessage:"View"})))},AnalyticsTable=({items:items})=>{const[pageIndex,setPageIndex]=Object(external_kbnSharedDeps_React_.useState)(0),[pageSize,setPageSize]=Object(external_kbnSharedDeps_React_.useState)(10),[sortField,setSortField]=Object(external_kbnSharedDeps_React_.useState)(common.c.id),[sortDirection,setSortDirection]=Object(external_kbnSharedDeps_React_.useState)("asc"),columns=[{field:common.c.id,name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.overview.analyticsList.id",{defaultMessage:"ID"}),sortable:!0,truncateText:!0,width:"20%"},{name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.overview.analyticsList.type",{defaultMessage:"Type"}),sortable:item=>Object(common_analytics.r)(item.config.analysis),truncateText:!0,render:item=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBadge,{color:"hollow"},Object(common_analytics.r)(item.config.analysis)),width:"150px"},{name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.overview.analyticsList.status",{defaultMessage:"Status"}),sortable:item=>item.stats.state,truncateText:!0,render:item=>Object(use_columns.b)(item.stats.state,item.stats.failure_reason),width:"100px"},use_columns.c,{field:common.c.configCreateTime,name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.overview.analyticsList.reatedTimeColumnName",{defaultMessage:"Creation time"}),dataType:"date",render:time=>Object(date_utils.c)(time),textOnly:!0,truncateText:!0,sortable:!0,width:"20%"},{name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.overview.analyticsList.tableActionLabel",{defaultMessage:"Actions"}),actions:[{render:item=>external_kbnSharedDeps_React_default.a.createElement(ViewLink,{item:item})}],width:"100px"}],pagination={initialPageIndex:pageIndex,initialPageSize:pageSize,totalItemCount:items.length,pageSizeOptions:[10,20,50],hidePerPageOptions:!1},sorting={sort:{field:sortField,direction:sortDirection}};return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiInMemoryTable,{allowNeutralSort:!1,className:"mlAnalyticsTable",columns:columns,hasActions:!1,isExpandable:!1,isSelectable:!1,items:items,itemId:common.c.id,onTableChange:({page:page={index:0,size:10},sort:sort={field:common.c.id,direction:"asc"}})=>{const{index:index,size:size}=page;setPageIndex(index),setPageSize(size);const{field:field,direction:direction}=sort;setSortField(field),setSortDirection(direction)},pagination:pagination,sorting:sorting,"data-test-subj":"mlOverviewTableAnalytics"})};var analytics_service=__webpack_require__(182),source_selection=__webpack_require__(417);const AnalyticsPanel=({jobCreationDisabled:jobCreationDisabled,setLazyJobCount:setLazyJobCount})=>{const[analytics,setAnalytics]=Object(external_kbnSharedDeps_React_.useState)([]),[analyticsStats,setAnalyticsStats]=Object(external_kbnSharedDeps_React_.useState)(void 0),[errorMessage,setErrorMessage]=Object(external_kbnSharedDeps_React_.useState)(void 0),[isInitialized,setIsInitialized]=Object(external_kbnSharedDeps_React_.useState)(!1),[isSourceIndexModalVisible,setIsSourceIndexModalVisible]=Object(external_kbnSharedDeps_React_.useState)(!1),mlUrlGenerator=Object(kibana.d)(),navigateToPath=Object(kibana.e)(),getAnalytics=Object(analytics_service.d)(setAnalytics,setAnalyticsStats,setErrorMessage,setIsInitialized,setLazyJobCount,!1,!1);Object(external_kbnSharedDeps_React_.useEffect)(()=>{getAnalytics(!0)},[]);const errorDisplay=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.overview.analyticsList.errorPromptTitle",{defaultMessage:"An error occurred getting the data frame analytics list."}),color:"danger",iconType:"alert"},external_kbnSharedDeps_React_default.a.createElement("pre",null,errorMessage&&void 0!==errorMessage.message?errorMessage.message:JSON.stringify(errorMessage))),panelClass=!1===isInitialized?"mlOverviewPanel__isLoading":"mlOverviewPanel";return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPanel,{className:panelClass},void 0!==errorMessage&&errorDisplay,!1===isInitialized&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingSpinner,{className:"mlOverviewPanel__spinner",size:"xl"}),void 0===errorMessage&&!0===isInitialized&&0===analytics.length&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiEmptyPrompt,{iconType:"createAdvancedJob",title:external_kbnSharedDeps_React_default.a.createElement("h2",null,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.overview.analyticsList.createFirstJobMessage",{defaultMessage:"Create your first data frame analytics job"})),body:external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.overview.analyticsList.emptyPromptText",{defaultMessage:"Data frame analytics enables you to perform outlier detection, regression, or classification analysis on your data and annotates it with the results. The job puts the annotated data and a copy of the source data in a new index."})),actions:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{onClick:()=>setIsSourceIndexModalVisible(!0),color:"primary",fill:!0,iconType:"plusInCircle",isDisabled:jobCreationDisabled,"data-test-subj":"mlOverviewCreateDFAJobButton"},external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.overview.analyticsList.createJobButtonText",{defaultMessage:"Create job"}))}),!0===isInitialized&&analytics.length>0&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"m"},external_kbnSharedDeps_React_default.a.createElement("h3",null,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.overview.analyticsList.PanelTitle",{defaultMessage:"Analytics"})))),void 0!==analyticsStats&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,className:"mlOverviewPanel__statsBar"},external_kbnSharedDeps_React_default.a.createElement(stats_bar.a,{stats:analyticsStats,dataTestSub:"mlOverviewAnalyticsStatsBar"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),external_kbnSharedDeps_React_default.a.createElement(AnalyticsTable,{items:analytics}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement("div",{className:"mlOverviewPanel__buttons"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{size:"s",onClick:()=>{getAnalytics(!0)},className:"mlOverviewPanel__refreshButton"},external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.overview.analyticsList.refreshJobsButtonText",{defaultMessage:"Refresh"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{size:"s",fill:!0,onClick:async()=>{const path=await mlUrlGenerator.createUrl({page:ml_url_generator.b.DATA_FRAME_ANALYTICS_JOBS_MANAGE});await navigateToPath(path,!0)}},external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.overview.analyticsList.manageJobsButtonText",{defaultMessage:"Manage jobs"})))),!0===isSourceIndexModalVisible&&external_kbnSharedDeps_React_default.a.createElement(source_selection.a,{onClose:()=>setIsSourceIndexModalVisible(!1)}))},OverviewContent=({createAnomalyDetectionJobDisabled:createAnomalyDetectionJobDisabled,createAnalyticsJobDisabled:createAnalyticsJobDisabled,setAdLazyJobCount:setAdLazyJobCount,setDfaLazyJobCount:setDfaLazyJobCount})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:3},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{direction:"column"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(AnomalyDetectionPanel,{jobCreationDisabled:createAnomalyDetectionJobDisabled,setLazyJobCount:setAdLazyJobCount})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(AnalyticsPanel,{jobCreationDisabled:createAnalyticsJobDisabled,setLazyJobCount:setDfaLazyJobCount}))));var node_available_warning=__webpack_require__(291),jobs_awaiting_node_warning=__webpack_require__(162),saved_objects_warning=__webpack_require__(292),upgrade=__webpack_require__(293),help_menu=__webpack_require__(104);const OverviewPage=()=>{const disableCreateAnomalyDetectionJob=!Object(check_capabilities.e)("canCreateJob")||!Object(check_ml_nodes.e)(),disableCreateAnalyticsButton=!Object(check_ml_nodes.e)()||!Object(check_capabilities.e)("canCreateDataFrameAnalytics")||!Object(check_capabilities.e)("canStartStopDataFrameAnalytics"),{services:{docLinks:docLinks}}=Object(kibana.b)(),helpLink=docLinks.links.ml.guide,[adLazyJobCount,setAdLazyJobCount]=Object(external_kbnSharedDeps_React_.useState)(0),[dfaLazyJobCount,setDfaLazyJobCount]=Object(external_kbnSharedDeps_React_.useState)(0);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(navigation_menu.a,{tabId:"overview"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPage,{"data-test-subj":"mlPageOverview"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPageBody,null,external_kbnSharedDeps_React_default.a.createElement(node_available_warning.a,null),external_kbnSharedDeps_React_default.a.createElement(jobs_awaiting_node_warning.a,{jobCount:adLazyJobCount+dfaLazyJobCount}),external_kbnSharedDeps_React_default.a.createElement(saved_objects_warning.a,null),external_kbnSharedDeps_React_default.a.createElement(upgrade.a,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(OverviewSideBar,{createAnomalyDetectionJobDisabled:disableCreateAnomalyDetectionJob}),external_kbnSharedDeps_React_default.a.createElement(OverviewContent,{createAnomalyDetectionJobDisabled:disableCreateAnomalyDetectionJob,createAnalyticsJobDisabled:disableCreateAnalyticsButton,setAdLazyJobCount:setAdLazyJobCount,setDfaLazyJobCount:setDfaLazyJobCount})))),external_kbnSharedDeps_React_default.a.createElement(help_menu.a,{docLink:helpLink}))};__webpack_exports__.default=OverviewPage}}]);