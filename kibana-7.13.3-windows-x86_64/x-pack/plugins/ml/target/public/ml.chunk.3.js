/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.ml_bundle_jsonpfunction=window.ml_bundle_jsonpfunction||[]).push([[3],{101:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return ANNOTATIONS_TABLE_DEFAULT_QUERY_SIZE})),__webpack_require__.d(__webpack_exports__,"b",(function(){return ANOMALIES_TABLE_DEFAULT_QUERY_SIZE})),__webpack_require__.d(__webpack_exports__,"c",(function(){return SEARCH_QUERY_LANGUAGE}));const ANNOTATIONS_TABLE_DEFAULT_QUERY_SIZE=500,ANOMALIES_TABLE_DEFAULT_QUERY_SIZE=500,SEARCH_QUERY_LANGUAGE={KUERY:"kuery",LUCENE:"lucene"}},121:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return SEVERITY_OPTIONS})),__webpack_require__.d(__webpack_exports__,"d",(function(){return optionValueToThreshold})),__webpack_require__.d(__webpack_exports__,"e",(function(){return useTableSeverity})),__webpack_require__.d(__webpack_exports__,"b",(function(){return SelectSeverity})),__webpack_require__.d(__webpack_exports__,"c",(function(){return SelectSeverityUI}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(14),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),_kbn_i18n__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(2),_kbn_i18n_react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(40),_elastic_eui__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(39),_common_util_anomaly_utils__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(6),_util_url_state__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(77),_common__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(16);const warningLabel=_kbn_i18n__WEBPACK_IMPORTED_MODULE_1__.i18n.translate("xpack.ml.controls.selectSeverity.warningLabel",{defaultMessage:"warning"}),minorLabel=_kbn_i18n__WEBPACK_IMPORTED_MODULE_1__.i18n.translate("xpack.ml.controls.selectSeverity.minorLabel",{defaultMessage:"minor"}),majorLabel=_kbn_i18n__WEBPACK_IMPORTED_MODULE_1__.i18n.translate("xpack.ml.controls.selectSeverity.majorLabel",{defaultMessage:"major"}),criticalLabel=_kbn_i18n__WEBPACK_IMPORTED_MODULE_1__.i18n.translate("xpack.ml.controls.selectSeverity.criticalLabel",{defaultMessage:"critical"}),optionsMap={[warningLabel]:_common__WEBPACK_IMPORTED_MODULE_6__.ANOMALY_THRESHOLD.LOW,[minorLabel]:_common__WEBPACK_IMPORTED_MODULE_6__.ANOMALY_THRESHOLD.MINOR,[majorLabel]:_common__WEBPACK_IMPORTED_MODULE_6__.ANOMALY_THRESHOLD.MAJOR,[criticalLabel]:_common__WEBPACK_IMPORTED_MODULE_6__.ANOMALY_THRESHOLD.CRITICAL},SEVERITY_OPTIONS=[{val:_common__WEBPACK_IMPORTED_MODULE_6__.ANOMALY_THRESHOLD.LOW,display:warningLabel,color:Object(_common_util_anomaly_utils__WEBPACK_IMPORTED_MODULE_4__.j)(_common__WEBPACK_IMPORTED_MODULE_6__.ANOMALY_THRESHOLD.LOW)},{val:_common__WEBPACK_IMPORTED_MODULE_6__.ANOMALY_THRESHOLD.MINOR,display:minorLabel,color:Object(_common_util_anomaly_utils__WEBPACK_IMPORTED_MODULE_4__.j)(_common__WEBPACK_IMPORTED_MODULE_6__.ANOMALY_THRESHOLD.MINOR)},{val:_common__WEBPACK_IMPORTED_MODULE_6__.ANOMALY_THRESHOLD.MAJOR,display:majorLabel,color:Object(_common_util_anomaly_utils__WEBPACK_IMPORTED_MODULE_4__.j)(_common__WEBPACK_IMPORTED_MODULE_6__.ANOMALY_THRESHOLD.MAJOR)},{val:_common__WEBPACK_IMPORTED_MODULE_6__.ANOMALY_THRESHOLD.CRITICAL,display:criticalLabel,color:Object(_common_util_anomaly_utils__WEBPACK_IMPORTED_MODULE_4__.j)(_common__WEBPACK_IMPORTED_MODULE_6__.ANOMALY_THRESHOLD.CRITICAL)}];function optionValueToThreshold(value){let threshold=SEVERITY_OPTIONS.find(opt=>opt.val===value);return void 0===threshold&&(threshold=SEVERITY_OPTIONS[0]),threshold}const TABLE_SEVERITY_DEFAULT=SEVERITY_OPTIONS[0],useTableSeverity=()=>Object(_util_url_state__WEBPACK_IMPORTED_MODULE_5__.b)("mlSelectSeverity",TABLE_SEVERITY_DEFAULT),SelectSeverity=({classNames:classNames}={classNames:""})=>{const[severity,setSeverity]=useTableSeverity();return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(SelectSeverityUI,{severity:severity,onChange:setSeverity})},SelectSeverityUI=({classNames:classNames="",severity:severity,onChange:onChange})=>react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_3__.EuiSuperSelect,{"data-test-subj":"mlAnomalySeverityThresholdControls",className:classNames,hasDividers:!0,options:SEVERITY_OPTIONS.map(({color:color,display:display,val:val})=>({value:display,inputDisplay:react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0__.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_3__.EuiHealth,{color:color,style:{lineHeight:"inherit"}},display)),dropdownDisplay:react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0__.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_3__.EuiHealth,{color:color,style:{lineHeight:"inherit"}},display),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_3__.EuiSpacer,{size:"xs"}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_3__.EuiText,{size:"xs",color:"subdued"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("p",{className:"euiTextColor--subdued"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_kbn_i18n_react__WEBPACK_IMPORTED_MODULE_2__.FormattedMessage,{id:"xpack.ml.controls.selectSeverity.scoreDetailsDescription",defaultMessage:"score {value} and above",values:{value:val}}))))})),valueOfSelected:severity.display,onChange:valueDisplay=>{onChange(optionValueToThreshold(optionsMap[valueDisplay]))}})},137:function(module,__webpack_exports__,__webpack_require__){"use strict";let ANNOTATION_TYPE;__webpack_require__.d(__webpack_exports__,"d",(function(){return ANNOTATION_TYPE})),__webpack_require__.d(__webpack_exports__,"c",(function(){return ANNOTATION_MAX_LENGTH_CHARS})),__webpack_require__.d(__webpack_exports__,"b",(function(){return ANNOTATION_EVENT_USER})),__webpack_require__.d(__webpack_exports__,"a",(function(){return ANNOTATION_EVENT_DELAYED_DATA})),function(ANNOTATION_TYPE){ANNOTATION_TYPE.ANNOTATION="annotation",ANNOTATION_TYPE.COMMENT="comment"}(ANNOTATION_TYPE||(ANNOTATION_TYPE={}));const ANNOTATION_MAX_LENGTH_CHARS=1e3,ANNOTATION_EVENT_USER="user",ANNOTATION_EVENT_DELAYED_DATA="delayed_data"},194:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return addItemToRecentlyAccessed}));var _kbn_i18n__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2),_dependency_cache__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(22);function addItemToRecentlyAccessed(page,itemId,url,recentlyAccessedService){let pageLabel="",id="ml-job-"+itemId;switch(page){case"explorer":pageLabel=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.ml.anomalyExplorerPageLabel",{defaultMessage:"Anomaly Explorer"});break;case"timeseriesexplorer":pageLabel=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.ml.singleMetricViewerPageLabel",{defaultMessage:"Single Metric Viewer"});break;case"jobs/new_job/datavisualizer":pageLabel=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.ml.dataVisualizerPageLabel",{defaultMessage:"Data Visualizer"}),id="ml-datavisualizer-"+itemId;break;default:return void console.error("addItemToRecentlyAccessed - No page specified")}url=url.startsWith("/")?"/app/ml"+url:`/app/ml/${page}/${url}`;(null!=recentlyAccessedService?recentlyAccessedService:Object(_dependency_cache__WEBPACK_IMPORTED_MODULE_1__.g)()).add(url,`ML - ${itemId} - ${pageLabel}`,id)}},268:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return LoadingIndicator}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(14),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),_elastic_eui__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(39);const LoadingIndicator=({height:height,label:label})=>(height=height?+height:100,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{className:"ml-loading-indicator",style:{height:height+"px"},"data-test-subj":"mlLoadingIndicator"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__.EuiLoadingChart,{size:"xl",mono:!0}),label&&react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__.EuiSpacer,{size:"s"}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",null,label))))},382:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__(270);var _chart_tooltip__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(271);__webpack_require__.d(__webpack_exports__,"a",(function(){return _chart_tooltip__WEBPACK_IMPORTED_MODULE_1__.b}))},411:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return ExplorerChartsContainer}));__webpack_require__(779);var external_kbnSharedDeps_React_=__webpack_require__(14),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),external_kbnSharedDeps_ElasticEui_=__webpack_require__(39),chart_utils=__webpack_require__(157),external_kbnSharedDeps_KbnI18n_=__webpack_require__(2),d3=__webpack_require__(105),d3_default=__webpack_require__.n(d3),external_kbnSharedDeps_Jquery_=__webpack_require__(59),external_kbnSharedDeps_Jquery_default=__webpack_require__.n(external_kbnSharedDeps_Jquery_),external_kbnSharedDeps_Moment_=__webpack_require__(15),external_kbnSharedDeps_Moment_default=__webpack_require__.n(external_kbnSharedDeps_Moment_),date_utils=__webpack_require__(72),format_value=__webpack_require__(122),anomaly_utils=__webpack_require__(6),loading_indicator=__webpack_require__(268),field_format_service=__webpack_require__(132),explorer_constants=__webpack_require__(75);class explorer_chart_distribution_ExplorerChartDistribution extends external_kbnSharedDeps_React_default.a.Component{componentDidMount(){this.renderChart()}componentDidUpdate(){this.renderChart()}renderChart(){const{tooManyBuckets:tooManyBuckets,tooltipService:tooltipService,timeBuckets:timeBuckets,showSelectedInterval:showSelectedInterval}=this.props,element=this.rootNode,config=this.props.seriesConfig,severity=this.props.severity;if(void 0===config||!1===Array.isArray(config.chartData))return;const fieldFormat=field_format_service.a.getFieldFormat(config.jobId,config.detectorIndex);let vizWidth=0;const chartType=Object(chart_utils.i)(config),margin={top:10,right:0,bottom:30,left:0};chartType===explorer_constants.b.POPULATION_DISTRIBUTION&&(margin.left=60);let lineChartGroup,lineChartXScale=null,lineChartYScale=null,lineChartValuesLine=null;const CHART_Y_ATTRIBUTE=chartType===explorer_constants.b.EVENT_DISTRIBUTION?"entity":"value";let highlight=config.chartData.find(d=>void 0!==d.anomalyScore);highlight=highlight&&highlight.entity;const filteredChartData=function({chartData:chartData,functionDescription:functionDescription}){const $el=external_kbnSharedDeps_Jquery_default()(".ml-explorer-chart"),chartElement=d3_default.a.select(element).select(".content-wrapper");chartElement.select("svg").remove();const svgWidth=$el.width(),svgHeight=170+margin.top+margin.bottom,svg=chartElement.append("svg").classed("ml-explorer-chart-svg",!0).attr("width",svgWidth).attr("height",svgHeight),scaleCategories=d3_default.a.nest().key(d=>d.entity).entries(chartData).sort((a,b)=>b.values.length-a.values.length).filter((d,i)=>chartType!==explorer_constants.b.EVENT_DISTRIBUTION||(i<30||d.key===highlight)).map(d=>d.key);if(chartData=chartData.filter(d=>scaleCategories.includes(d.entity)),chartType===explorer_constants.b.POPULATION_DISTRIBUTION){const focusData=chartData.filter(d=>d.entity===highlight),{min:yScaleDomainMin,max:yScaleDomainMax}=Object(chart_utils.e)(focusData,functionDescription);chartData=chartData.filter(d=>d.value<=yScaleDomainMax),lineChartYScale=d3_default.a.scale.linear().range([170,0]).domain([yScaleDomainMin<0?yScaleDomainMin:0,yScaleDomainMax]).nice()}else{if(chartType!==explorer_constants.b.EVENT_DISTRIBUTION)throw`chartType '${chartType}' not supported`;{const rowMargin=5;lineChartYScale=d3_default.a.scale.ordinal().rangePoints([rowMargin,170-rowMargin]).domain(scaleCategories)}}const yAxis=d3_default.a.svg.axis().scale(lineChartYScale).orient("left").innerTickSize(0).outerTickSize(0).tickPadding(10);let maxYAxisLabelWidth=0;const tempLabelText=svg.append("g").attr("class","temp-axis-label tick"),tempLabelTextData=chartType===explorer_constants.b.POPULATION_DISTRIBUTION?lineChartYScale.ticks():scaleCategories;tempLabelText.selectAll("text.temp.axis").data(tempLabelTextData).enter().append("text").text(d=>void 0!==fieldFormat?fieldFormat.convert(d,"text"):chartType===explorer_constants.b.POPULATION_DISTRIBUTION?lineChartYScale.tickFormat()(d):d).each((function(){maxYAxisLabelWidth=Math.max(this.getBBox().width+yAxis.tickPadding(),maxYAxisLabelWidth)})).remove(),d3_default.a.select(".temp-axis-label").remove(),(chartType===explorer_constants.b.POPULATION_DISTRIBUTION||chartType===explorer_constants.b.EVENT_DISTRIBUTION&&scaleCategories.length<=10)&&(margin.left=Math.max(maxYAxisLabelWidth,40));return vizWidth=svgWidth-margin.left-margin.right,lineChartXScale=d3_default.a.time.scale().range([0,vizWidth]).domain([config.plotEarliest,config.plotLatest]),lineChartValuesLine=d3_default.a.svg.line().x(d=>lineChartXScale(d.date)).y(d=>lineChartYScale(d[CHART_Y_ATTRIBUTE])).defined(d=>null!==d.value),lineChartGroup=svg.append("g").attr("class","line-chart").attr("transform","translate("+margin.left+","+margin.top+")"),chartData}(config);var data;data=filteredChartData,lineChartGroup.append("rect").attr("x",0).attr("y",0).attr("height",170).attr("width",vizWidth).style("stroke","#cccccc").style("fill","none").style("stroke-width",1),function(){const bounds={min:external_kbnSharedDeps_Moment_default()(config.plotEarliest),max:external_kbnSharedDeps_Moment_default()(config.plotLatest)};timeBuckets.setBounds(bounds),timeBuckets.setInterval("auto");const xAxisTickFormat=timeBuckets.getScaledDateFormat(),tickValuesStart=Math.max(config.selectedEarliest,config.plotEarliest),interval=config.selectedLatest-config.selectedEarliest+1,tickValues=Object(chart_utils.k)(tickValuesStart,interval,config.plotEarliest,config.plotLatest),xAxis=d3_default.a.svg.axis().scale(lineChartXScale).orient("bottom").innerTickSize(-170).outerTickSize(0).tickPadding(10).tickFormat(d=>external_kbnSharedDeps_Moment_default()(d).format(xAxisTickFormat));!1===tooManyBuckets?xAxis.tickValues(tickValues):xAxis.ticks(Object(chart_utils.m)(vizWidth,xAxisTickFormat));const yAxis=d3_default.a.svg.axis().scale(lineChartYScale).orient("left").innerTickSize(0).outerTickSize(0).tickPadding(10);void 0!==fieldFormat&&yAxis.tickFormat(d=>fieldFormat.convert(d,"text"));const axes=lineChartGroup.append("g"),gAxis=axes.append("g").attr("class","x axis").attr("transform","translate(0,170)").call(xAxis);axes.append("g").attr("class","y axis").call(yAxis),chartType===explorer_constants.b.EVENT_DISTRIBUTION&&axes.select(".y").selectAll("text").each((function(d){d3_default.a.select(this).classed("ml-explorer-chart-axis-emphasis",d===highlight)})),!1===tooManyBuckets&&Object(chart_utils.n)(gAxis,tickValuesStart,interval,vizWidth)}(),function(){if(!1===showSelectedInterval)return;const rectStart=Math.max(config.selectedEarliest,config.plotEarliest),rectEnd=Math.min(config.selectedLatest,config.plotLatest),rectWidth=lineChartXScale(rectEnd)-lineChartXScale(rectStart);lineChartGroup.append("rect").attr("class","selected-interval").attr("x",lineChartXScale(new Date(rectStart))+2).attr("y",2).attr("rx",3).attr("ry",3).attr("width",rectWidth-4).attr("height",166)}(),function(dotsData,rareChartGroup,rareChartValuesLine,radius=1.5){const dots=(rareChartGroup.select(".values-dots").empty()?rareChartGroup.append("g").classed("values-dots",!0):rareChartGroup.select(".values-dots")).selectAll("circle").data(dotsData);dots.enter().append("circle").classed("values-dots-circle",!0).classed("values-dots-circle-blur",d=>d.entity!==highlight).attr("r",d=>d.entity===highlight?1.5*radius:radius),dots.attr("cx",rareChartValuesLine.x()).attr("cy",rareChartValuesLine.y()),dots.exit().remove()}(data,lineChartGroup,lineChartValuesLine),function(data){const dots=lineChartGroup.append("g").attr("class","chart-markers").selectAll(".metric-value").data(data.filter(d=>null!==d.value));dots.exit().remove(),dots.enter().append("circle").attr("r",7).on("mouseover",(function(d){!function(marker,circle){const tooltipData=[{label:Object(date_utils.b)(marker.date)}],seriesKey=config.detectorLabel;if(void 0!==marker.entity&&tooltipData.push({label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.explorer.distributionChart.entityLabel",{defaultMessage:"entity"}),value:marker.entity,seriesIdentifier:{key:seriesKey},valueAccessor:"entity"}),void 0!==marker.anomalyScore){const score=parseInt(marker.anomalyScore),displayScore=Object(anomaly_utils.g)(score);tooltipData.push({label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.explorer.distributionChart.anomalyScoreLabel",{defaultMessage:"anomaly score"}),value:displayScore,color:Object(anomaly_utils.j)(score),seriesIdentifier:{key:seriesKey},valueAccessor:"anomaly_score"}),chartType!==explorer_constants.b.EVENT_DISTRIBUTION&&(tooltipData.push({label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.explorer.distributionChart.valueLabel",{defaultMessage:"value"}),value:Object(format_value.b)(marker.value,config.functionDescription,fieldFormat),seriesIdentifier:{key:seriesKey},valueAccessor:"value"}),void 0!==marker.numberOfCauses&&1!==marker.numberOfCauses||tooltipData.push({label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.explorer.distributionChart.typicalLabel",{defaultMessage:"typical"}),value:Object(format_value.b)(marker.typical,config.functionDescription,fieldFormat),seriesIdentifier:{key:seriesKey},valueAccessor:"typical"}),void 0!==marker.byFieldName&&void 0!==marker.numberOfCauses&&tooltipData.push({label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.explorer.distributionChart.unusualByFieldValuesLabel",{defaultMessage:"{ numberOfCauses, plural, one {# unusual {byFieldName} value} other {#{plusSign} unusual {byFieldName} values}}",values:{numberOfCauses:marker.numberOfCauses,byFieldName:marker.byFieldName,plusSign:marker.numberOfCauses<10?"":"+"}}),seriesIdentifier:{key:seriesKey},valueAccessor:"numberOfCauses"}))}else chartType!==explorer_constants.b.EVENT_DISTRIBUTION&&tooltipData.push({label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.explorer.distributionChart.valueWithoutAnomalyScoreLabel",{defaultMessage:"value"}),value:Object(format_value.b)(marker.value,config.functionDescription,fieldFormat),seriesIdentifier:{key:seriesKey},valueAccessor:"value"});void 0!==marker.scheduledEvents&&marker.scheduledEvents.forEach((scheduledEvent,i)=>{tooltipData.push({label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.scheduledEventsLabel",{defaultMessage:"scheduled event{counter}",values:{counter:marker.scheduledEvents.length>1?" #"+(i+1):""}}),value:scheduledEvent,seriesIdentifier:{key:seriesKey},valueAccessor:"scheduled_events_"+(i+1)})}),tooltipService.show(tooltipData,circle,{x:21,y:14})}(d,this)})).on("mouseout",()=>tooltipService.hide()),dots.attr("cx",d=>lineChartXScale(d.date)).attr("cy",d=>lineChartYScale(d[CHART_Y_ATTRIBUTE])).attr("class",d=>{let markerClass="metric-value";return void 0!==d.anomalyScore&&Number(d.anomalyScore)>=severity&&(markerClass+=" anomaly-marker ",markerClass+=Object(anomaly_utils.l)(d.anomalyScore).id),markerClass});const scheduledEventMarkers=lineChartGroup.select(".chart-markers").selectAll(".scheduled-event-marker").data(data.filter(d=>void 0!==d.scheduledEvents));scheduledEventMarkers.exit().remove(),scheduledEventMarkers.enter().append("rect").attr("width",14).attr("height",5).attr("class","scheduled-event-marker").attr("rx",1).attr("ry",1),scheduledEventMarkers.attr("x",d=>lineChartXScale(d.date)-7).attr("y",d=>lineChartYScale(d[CHART_Y_ATTRIBUTE])-2.5)}(data)}shouldComponentUpdate(){return!0}setRef(componentNode){this.rootNode=componentNode}render(){const{seriesConfig:seriesConfig}=this.props;if(void 0===seriesConfig)return null;const isLoading=seriesConfig.loading;return external_kbnSharedDeps_React_default.a.createElement("div",{className:"ml-explorer-chart",ref:this.setRef.bind(this)},isLoading&&external_kbnSharedDeps_React_default.a.createElement(loading_indicator.a,{height:215}),!isLoading&&external_kbnSharedDeps_React_default.a.createElement("div",{className:"content-wrapper"}))}}class explorer_chart_single_metric_ExplorerChartSingleMetric extends external_kbnSharedDeps_React_default.a.Component{componentDidMount(){this.renderChart()}componentDidUpdate(){this.renderChart()}renderChart(){const{tooManyBuckets:tooManyBuckets,tooltipService:tooltipService,timeBuckets:timeBuckets,showSelectedInterval:showSelectedInterval}=this.props,element=this.rootNode,config=this.props.seriesConfig,severity=this.props.severity;if(void 0===config||!1===Array.isArray(config.chartData))return;const fieldFormat=field_format_service.a.getFieldFormat(config.jobId,config.detectorIndex);let vizWidth=0;const margin={top:10,right:0,bottom:30,left:60};let lineChartGroup,lineChartXScale=null,lineChartYScale=null,lineChartValuesLine=null;var data;function showLineChartTooltip(marker,circle){const tooltipData=[{label:Object(date_utils.b)(marker.date)}],seriesKey=config.detectorLabel;if(void 0!==marker.anomalyScore){const score=parseInt(marker.anomalyScore);tooltipData.push({label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.explorer.singleMetricChart.anomalyScoreLabel",{defaultMessage:"anomaly score"}),value:Object(anomaly_utils.g)(score),color:Object(anomaly_utils.j)(score),seriesIdentifier:{key:seriesKey},valueAccessor:"anomaly_score"}),!0===Object(chart_utils.p)(marker)&&tooltipData.push({label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.explorer.singleMetricChart.multiBucketImpactLabel",{defaultMessage:"multi-bucket impact"}),value:Object(anomaly_utils.h)(marker.multiBucketImpact),seriesIdentifier:{key:seriesKey},valueAccessor:"multi_bucket_impact"}),void 0!==marker.actual&&"rare"!==config.functionDescription?(tooltipData.push({label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.explorer.singleMetricChart.actualLabel",{defaultMessage:"actual"}),value:Object(format_value.b)(marker.actual,config.functionDescription,fieldFormat),seriesIdentifier:{key:seriesKey},valueAccessor:"actual"}),tooltipData.push({label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.explorer.singleMetricChart.typicalLabel",{defaultMessage:"typical"}),value:Object(format_value.b)(marker.typical,config.functionDescription,fieldFormat),seriesIdentifier:{key:seriesKey},valueAccessor:"typical"})):(tooltipData.push({label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.explorer.singleMetricChart.valueLabel",{defaultMessage:"value"}),value:Object(format_value.b)(marker.value,config.functionDescription,fieldFormat),seriesIdentifier:{key:seriesKey},valueAccessor:"value"}),void 0!==marker.byFieldName&&void 0!==marker.numberOfCauses&&tooltipData.push({label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.explorer.distributionChart.unusualByFieldValuesLabel",{defaultMessage:"{ numberOfCauses, plural, one {# unusual {byFieldName} value} other {#{plusSign} unusual {byFieldName} values}}",values:{numberOfCauses:marker.numberOfCauses,byFieldName:marker.byFieldName,plusSign:marker.numberOfCauses<10?"":"+"}}),seriesIdentifier:{key:seriesKey},valueAccessor:"numberOfCauses"}))}else tooltipData.push({label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.explorer.singleMetricChart.valueWithoutAnomalyScoreLabel",{defaultMessage:"value"}),value:Object(format_value.b)(marker.value,config.functionDescription,fieldFormat),seriesIdentifier:{key:seriesKey},valueAccessor:"value"});void 0!==marker.scheduledEvents&&tooltipData.push({label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.explorer.singleMetricChart.scheduledEventsLabel",{defaultMessage:"Scheduled events"}),value:marker.scheduledEvents,seriesIdentifier:{key:seriesKey},valueAccessor:"scheduledEvents"}),tooltipService.show(tooltipData,circle,{x:3*chart_utils.b,y:2*chart_utils.b})}!function(chartLimits){const $el=external_kbnSharedDeps_Jquery_default()(".ml-explorer-chart"),chartElement=d3_default.a.select(element).select(".ml-explorer-chart-content-wrapper");chartElement.select("svg").remove();const svgWidth=$el.width(),svgHeight=170+margin.top+margin.bottom,svg=chartElement.append("svg").classed("ml-explorer-chart-svg",!0).attr("width",svgWidth).attr("height",svgHeight);lineChartYScale=d3_default.a.scale.linear().range([170,0]).domain([chartLimits.min,chartLimits.max]).nice();const yAxis=d3_default.a.svg.axis().scale(lineChartYScale).orient("left").innerTickSize(0).outerTickSize(0).tickPadding(10);let maxYAxisLabelWidth=0;svg.append("g").attr("class","temp-axis-label tick").selectAll("text.temp.axis").data(lineChartYScale.ticks()).enter().append("text").text(d=>void 0!==fieldFormat?fieldFormat.convert(d,"text"):lineChartYScale.tickFormat()(d)).each((function(){maxYAxisLabelWidth=Math.max(this.getBBox().width+yAxis.tickPadding(),maxYAxisLabelWidth)})).remove(),d3_default.a.select(".temp-axis-label").remove(),margin.left=Math.max(maxYAxisLabelWidth,40),vizWidth=svgWidth-margin.left-margin.right,lineChartXScale=d3_default.a.time.scale().range([0,vizWidth]).domain([config.plotEarliest,config.plotLatest]),lineChartValuesLine=d3_default.a.svg.line().x(d=>lineChartXScale(d.date)).y(d=>lineChartYScale(d.value)).defined(d=>null!==d.value),lineChartGroup=svg.append("g").attr("class","line-chart").attr("transform","translate("+margin.left+","+margin.top+")")}(config.chartLimits),data=config.chartData,lineChartGroup.append("rect").attr("x",0).attr("y",0).attr("height",170).attr("width",vizWidth).style("stroke","#cccccc").style("fill","none").style("stroke-width",1),function(){const bounds={min:external_kbnSharedDeps_Moment_default()(config.plotEarliest),max:external_kbnSharedDeps_Moment_default()(config.plotLatest)};timeBuckets.setBounds(bounds),timeBuckets.setInterval("auto");const xAxisTickFormat=timeBuckets.getScaledDateFormat(),tickValuesStart=Math.max(config.selectedEarliest,config.plotEarliest),interval=config.selectedLatest-config.selectedEarliest+1,tickValues=Object(chart_utils.k)(tickValuesStart,interval,config.plotEarliest,config.plotLatest),xAxis=d3_default.a.svg.axis().scale(lineChartXScale).orient("bottom").innerTickSize(-170).outerTickSize(0).tickPadding(10).tickFormat(d=>external_kbnSharedDeps_Moment_default()(d).format(xAxisTickFormat));!1===tooManyBuckets?xAxis.tickValues(tickValues):xAxis.ticks(Object(chart_utils.m)(vizWidth,xAxisTickFormat));const yAxis=d3_default.a.svg.axis().scale(lineChartYScale).orient("left").innerTickSize(0).outerTickSize(0).tickPadding(10);void 0!==fieldFormat&&yAxis.tickFormat(d=>fieldFormat.convert(d,"text"));const axes=lineChartGroup.append("g"),gAxis=axes.append("g").attr("class","x axis").attr("transform","translate(0,170)").call(xAxis);axes.append("g").attr("class","y axis").call(yAxis),!1===tooManyBuckets&&Object(chart_utils.n)(gAxis,tickValuesStart,interval,vizWidth)}(),function(){if(!1===showSelectedInterval)return;const rectStart=Math.max(config.selectedEarliest,config.plotEarliest),rectEnd=Math.min(config.selectedLatest,config.plotLatest),rectWidth=lineChartXScale(rectEnd)-lineChartXScale(rectStart);lineChartGroup.append("rect").attr("class","selected-interval").attr("x",lineChartXScale(new Date(rectStart))+2).attr("y",2).attr("rx",3).attr("ry",3).attr("width",rectWidth-4).attr("height",166)}(),function(data){lineChartGroup.append("path").attr("class","values-line").attr("d",lineChartValuesLine(data))}(data),Object(chart_utils.g)(data,lineChartGroup,lineChartValuesLine),function(data){const dots=lineChartGroup.append("g").attr("class","chart-markers").selectAll(".metric-value").data(data.filter(d=>(null!==d.value||"number"==typeof d.anomalyScore)&&!Object(chart_utils.o)(d)));dots.exit().remove(),dots.enter().append("circle").attr("r",chart_utils.b).on("mouseover",(function(d){showLineChartTooltip(d,this)})).on("mouseout",()=>tooltipService.hide());const isAnomalyVisible=d=>void 0!==d.anomalyScore&&Number(d.anomalyScore)>=severity;dots.attr("cx",d=>lineChartXScale(d.date)).attr("cy",d=>lineChartYScale(d.value)).attr("class",d=>{let markerClass="metric-value";return isAnomalyVisible(d)&&(markerClass+=" anomaly-marker "+Object(anomaly_utils.l)(d.anomalyScore).id),markerClass});const multiBucketMarkers=lineChartGroup.select(".chart-markers").selectAll(".multi-bucket").data(data.filter(d=>isAnomalyVisible(d)&&!0===Object(chart_utils.o)(d)));multiBucketMarkers.exit().remove(),multiBucketMarkers.enter().append("path").attr("d",d3_default.a.svg.symbol().size(chart_utils.c).type("cross")).attr("transform",d=>`translate(${lineChartXScale(d.date)}, ${lineChartYScale(d.value)})`).attr("class",d=>"anomaly-marker multi-bucket "+Object(anomaly_utils.l)(d.anomalyScore).id).on("mouseover",(function(d){showLineChartTooltip(d,this)})).on("mouseout",()=>tooltipService.hide());const scheduledEventMarkers=lineChartGroup.select(".chart-markers").selectAll(".scheduled-event-marker").data(data.filter(d=>void 0!==d.scheduledEvents));scheduledEventMarkers.exit().remove(),scheduledEventMarkers.enter().append("rect").attr("width",2*chart_utils.b).attr("height",chart_utils.d).attr("class","scheduled-event-marker").attr("rx",1).attr("ry",1),scheduledEventMarkers.attr("x",d=>lineChartXScale(d.date)-chart_utils.b).attr("y",d=>lineChartYScale(d.value)-chart_utils.d/2)}(data)}shouldComponentUpdate(){return!0}setRef(componentNode){this.rootNode=componentNode}render(){const{seriesConfig:seriesConfig}=this.props;if(void 0===seriesConfig)return null;const isLoading=seriesConfig.loading;return external_kbnSharedDeps_React_default.a.createElement("div",{className:"ml-explorer-chart",ref:this.setRef.bind(this)},isLoading&&external_kbnSharedDeps_React_default.a.createElement(loading_indicator.a,{height:215}),!isLoading&&external_kbnSharedDeps_React_default.a.createElement("div",{className:"ml-explorer-chart-content-wrapper"}))}}__webpack_require__(788);function ExplorerChartLabelBadge({entity:entity}){return external_kbnSharedDeps_React_default.a.createElement("span",{className:"ml-explorer-chart-label-badge"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBadge,{color:"hollow",className:"ml-reset-font-weight"},entity.fieldName," ",external_kbnSharedDeps_React_default.a.createElement("strong",null,entity.fieldValue)))}__webpack_require__(797);const CHART_DESCRIPTION={[explorer_constants.b.EVENT_DISTRIBUTION]:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.explorer.charts.infoTooltip.chartEventDistributionDescription",{defaultMessage:"The gray dots depict the approximate distribution of occurrences over time for a sample of {byFieldValuesParam} with more frequent event types at the top and rarer ones at the bottom.",values:{byFieldValuesParam:"by_field_values"}}),[explorer_constants.b.POPULATION_DISTRIBUTION]:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.explorer.charts.infoTooltip.chartPopulationDistributionDescription",{defaultMessage:"The gray dots depict the approximate distribution of values over time for a sample of {overFieldValuesParam}.",values:{overFieldValuesParam:"over_field_values"}})};function TooltipDefinitionList({toolTipData:toolTipData}){return external_kbnSharedDeps_React_default.a.createElement("dl",{className:"mlDescriptionList"},toolTipData.map(({title:title,description:description})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,{key:`${title} ${description}`},external_kbnSharedDeps_React_default.a.createElement("dt",{className:"mlDescriptionList__title"},title),external_kbnSharedDeps_React_default.a.createElement("dd",{className:"mlDescriptionList__description"},description))))}const ExplorerChartInfoTooltip=({jobId:jobId,aggregationInterval:aggregationInterval,chartFunction:chartFunction,chartType:chartType,entityFields:entityFields=[]})=>{const chartDescription=CHART_DESCRIPTION[chartType],toolTipData=[{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.explorer.charts.infoTooltip.jobIdTitle",{defaultMessage:"job ID"}),description:jobId},{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.explorer.charts.infoTooltip.aggregationIntervalTitle",{defaultMessage:"aggregation interval"}),description:aggregationInterval},{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.explorer.charts.infoTooltip.chartFunctionTitle",{defaultMessage:"chart function"}),description:chartFunction}];return entityFields.forEach(entityField=>{toolTipData.push({title:entityField.fieldName,description:entityField.fieldValue})}),external_kbnSharedDeps_React_default.a.createElement("div",{className:"ml-explorer-chart-info-tooltip"},external_kbnSharedDeps_React_default.a.createElement(TooltipDefinitionList,{toolTipData:toolTipData}),chartDescription&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"s"}),external_kbnSharedDeps_React_default.a.createElement("div",{className:"ml-explorer-chart-description"},chartDescription)))};var external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(40);__webpack_require__(806);const EntityFilter=({onFilter:onFilter,influencerFieldName:influencerFieldName,influencerFieldValue:influencerFieldValue})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{content:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.entityFilter.addFilterTooltip",defaultMessage:"Add filter"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{size:"s",className:"filter-button",onClick:()=>onFilter({influencerFieldName:influencerFieldName,influencerFieldValue:influencerFieldValue,action:anomaly_utils.a.ADD}),iconType:"plusInCircle","aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.entityFilter.addFilterAriaLabel",{defaultMessage:"Add filter for {influencerFieldName} {influencerFieldValue}",values:{influencerFieldName:influencerFieldName,influencerFieldValue:influencerFieldValue}})})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{content:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.entityFilter.removeFilterTooltip",defaultMessage:"Remove filter"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{size:"s",className:"filter-button",onClick:()=>onFilter({influencerFieldName:influencerFieldName,influencerFieldValue:influencerFieldValue,action:anomaly_utils.a.REMOVE}),iconType:"minusInCircle","aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.entityFilter.removeFilterAriaLabel",{defaultMessage:"Remove filter for {influencerFieldName} {influencerFieldValue}",values:{influencerFieldName:influencerFieldName,influencerFieldValue:influencerFieldValue}})})));function ExplorerChartLabel({detectorLabel:detectorLabel,entityFields:entityFields,infoTooltip:infoTooltip,wrapLabel:wrapLabel=!1,onSelectEntity:onSelectEntity}){const labelSeparator=!0===wrapLabel||0===entityFields.length||0===detectorLabel.length?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null," "):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null," – "),applyFilter=Object(external_kbnSharedDeps_React_.useCallback)(({influencerFieldName:influencerFieldName,influencerFieldValue:influencerFieldValue,action:action})=>onSelectEntity(influencerFieldName,influencerFieldValue,action),[onSelectEntity]),entityFieldBadges=entityFields.map(entity=>{const key=`${infoTooltip.chartFunction}-${entity.fieldName}-${entity.fieldType}-${entity.fieldValue}`;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Fragment,{key:"badge-wrapper-"+key},external_kbnSharedDeps_React_default.a.createElement(ExplorerChartLabelBadge,{entity:entity}),void 0!==onSelectEntity&&external_kbnSharedDeps_React_default.a.createElement(EntityFilter,{onFilter:applyFilter,influencerFieldName:entity.fieldName,influencerFieldValue:entity.fieldValue}))}),infoIcon=external_kbnSharedDeps_React_default.a.createElement("span",{className:"ml-explorer-chart-info-icon"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIconTip,{className:"ml-explorer-chart-eui-icon-tip",content:external_kbnSharedDeps_React_default.a.createElement(ExplorerChartInfoTooltip,infoTooltip),position:"top",size:"s"}));return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement("span",{className:"ml-explorer-chart-label"},external_kbnSharedDeps_React_default.a.createElement("span",{className:"ml-explorer-chart-label-detector"},detectorLabel,labelSeparator),wrapLabel&&infoIcon,!wrapLabel&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,entityFieldBadges," ",infoIcon)),wrapLabel&&external_kbnSharedDeps_React_default.a.createElement("span",{className:"ml-explorer-chart-label-badges"},entityFieldBadges))}var chart_tooltip=__webpack_require__(382),public_=__webpack_require__(42),aggregation_types=__webpack_require__(81);const ExplorerChartsErrorCallOuts=({errorMessagesByType:errorMessagesByType})=>{if(!errorMessagesByType||0===Object.keys(errorMessagesByType).length)return null;const content=Object.keys(errorMessagesByType).map(errorType=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{color:"warning",size:"s",key:errorType},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.explorerCharts.errorCallOutMessage",defaultMessage:"You can't view anomaly charts for {jobs} because {reason}.",values:{jobs:[...errorMessagesByType[errorType]].join(", "),reason:errorType}})));return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,content,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}))};var recently_accessed=__webpack_require__(194),constants_=__webpack_require__(58),common=__webpack_require__(16);const SEVERITY_COLOR_RAMP=[{stop:common.ANOMALY_THRESHOLD.LOW,color:common.SEVERITY_COLORS.WARNING},{stop:common.ANOMALY_THRESHOLD.MINOR,color:common.SEVERITY_COLORS.MINOR},{stop:common.ANOMALY_THRESHOLD.MAJOR,color:common.SEVERITY_COLORS.MAJOR},{stop:common.ANOMALY_THRESHOLD.CRITICAL,color:common.SEVERITY_COLORS.CRITICAL}];function getAnomalyFeatures(anomalies,type){const anomalyFeatures=[];for(let i=0;i<anomalies.length;i++){var _anomaly$causes$;const anomaly=anomalies[i],geoResults=anomaly.geo_results||(null==anomaly?void 0:anomaly.causes)&&(null==anomaly||null===(_anomaly$causes$=anomaly.causes[0])||void 0===_anomaly$causes$?void 0:_anomaly$causes$.geo_results),coordinateStr=geoResults&&geoResults[type];if(void 0!==coordinateStr){const coordinates=coordinateStr.split(",").map(point=>Number(point)).reverse();anomalyFeatures.push({type:"Feature",geometry:{type:"Point",coordinates:coordinates},properties:{record_score:Math.floor(anomaly.record_score),[type]:coordinates.map(point=>point.toFixed(2))}})}}return anomalyFeatures}const getMLAnomaliesTypicalLayer=anomalies=>({id:"anomalies_typical_layer",label:"Typical",sourceDescriptor:{id:"b7486535-171b-4d3b-bb2e-33c1a0a2854e",type:"GEOJSON_FILE",__featureCollection:{features:getAnomalyFeatures(anomalies,"typical_point"),type:"FeatureCollection"}},visible:!0,style:{type:"VECTOR",properties:{fillColor:{type:"STATIC",options:{color:"#98A2B2"}},lineColor:{type:"STATIC",options:{color:"#fff"}},lineWidth:{type:"STATIC",options:{size:2}},iconSize:{type:"STATIC",options:{size:6}}}},type:"VECTOR"});var ml_embedded_map=__webpack_require__(422);function EmbeddedMapComponentWrapper({seriesConfig:seriesConfig}){const[layerList,setLayerList]=Object(external_kbnSharedDeps_React_.useState)([]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{var anomalies;seriesConfig.mapData&&seriesConfig.mapData.length>0&&setLayerList([(anomalies=seriesConfig.mapData,{id:"anomalies_actual_layer",label:"Actual",sourceDescriptor:{id:"b7486535-171b-4d3b-bb2e-33c1a0a2854d",type:"GEOJSON_FILE",__fields:[{name:"record_score",type:"number"}],__featureCollection:{features:getAnomalyFeatures(anomalies,"actual_point"),type:"FeatureCollection"}},visible:!0,style:{type:"VECTOR",properties:{fillColor:{type:constants_.STYLE_TYPE.DYNAMIC,options:{customColorRamp:SEVERITY_COLOR_RAMP,field:{name:"record_score",origin:constants_.FIELD_ORIGIN.SOURCE},useCustomColorRamp:!0}},lineColor:{type:"STATIC",options:{color:"#fff"}},lineWidth:{type:"STATIC",options:{size:2}},iconSize:{type:"STATIC",options:{size:6}}}},type:"VECTOR"}),getMLAnomaliesTypicalLayer(seriesConfig.mapData)])},[seriesConfig]),external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":"xpack.ml.explorer.embeddedMap",style:{width:"100%",height:300}},external_kbnSharedDeps_React_default.a.createElement(ml_embedded_map.a,{layerList:layerList}))}const textTooManyBuckets=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.explorer.charts.tooManyBucketsDescription",{defaultMessage:"This selection contains too many buckets to be displayed. You should shorten the time range of the view or narrow the selection in the timeline."}),textViewButton=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.explorer.charts.openInSingleMetricViewerButtonLabel",{defaultMessage:"Open in Single Metric Viewer"}),mapsPluginMessage=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.explorer.charts.mapsPluginMissingMessage",{defaultMessage:"maps or embeddable start plugin not found"});function getChartId(series){const{jobId:jobId,detectorLabel:detectorLabel,entityFields:entityFields}=series;return`${jobId}_${detectorLabel}_${entityFields.map(ef=>`${ef.fieldName}/${ef.fieldValue}`).join(",")}`}function ExplorerChartContainer({series:series,severity:severity,tooManyBuckets:tooManyBuckets,wrapLabel:wrapLabel,mlUrlGenerator:mlUrlGenerator,basePath:basePath,timeBuckets:timeBuckets,timefilter:timefilter,onSelectEntity:onSelectEntity,recentlyAccessed:recentlyAccessed,tooManyBucketsCalloutMsg:tooManyBucketsCalloutMsg,showSelectedInterval:showSelectedInterval}){const[explorerSeriesLink,setExplorerSeriesLink]=Object(external_kbnSharedDeps_React_.useState)("");Object(external_kbnSharedDeps_React_.useEffect)(()=>{let isCancelled=!1;return(async()=>{if(!isCancelled&&series.functionDescription!==aggregation_types.b.LAT_LONG){const singleMetricViewerLink=await Object(chart_utils.j)(mlUrlGenerator,series,timefilter);setExplorerSeriesLink(singleMetricViewerLink)}})(),()=>{isCancelled=!0}},[mlUrlGenerator,series]);const addToRecentlyAccessed=Object(external_kbnSharedDeps_React_.useCallback)(()=>{recentlyAccessed&&Object(recently_accessed.a)("timeseriesexplorer",series.jobId,explorerSeriesLink,recentlyAccessed)},[explorerSeriesLink,recentlyAccessed]),{detectorLabel:detectorLabel,entityFields:entityFields}=series,chartType=Object(chart_utils.i)(series);let DetectorLabel=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,detectorLabel);if(chartType===explorer_constants.b.EVENT_DISTRIBUTION){const byField=series.entityFields.find(d=>"by"===d.fieldType);void 0!==byField&&(DetectorLabel=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.explorer.charts.detectorLabel",defaultMessage:'{detectorLabel}{br}y-axis event distribution split by "{fieldName}"',values:{detectorLabel:detectorLabel,br:external_kbnSharedDeps_React_default.a.createElement("br",null),fieldName:byField.fieldName}})),wrapLabel=!0)}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceBetween"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(ExplorerChartLabel,{detectorLabel:DetectorLabel,entityFields:entityFields,infoTooltip:{...series.infoTooltip,chartType:chartType},wrapLabel:wrapLabel,onSelectEntity:onSelectEntity})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement("div",{className:"ml-explorer-chart-icons"},tooManyBuckets&&external_kbnSharedDeps_React_default.a.createElement("span",{className:"ml-explorer-chart-icon"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIconTip,{content:null!=tooManyBucketsCalloutMsg?tooManyBucketsCalloutMsg:textTooManyBuckets,position:"top",size:"s",type:"alert",color:"warning"})),explorerSeriesLink&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiToolTip,{position:"top",content:textViewButton},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{iconSide:"right",iconType:"visLine",size:"xs",href:`${basePath}/app/ml${explorerSeriesLink}`,onClick:addToRecentlyAccessed},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.ml.explorer.charts.viewLabel",defaultMessage:"View"})))))),chartType===explorer_constants.b.GEO_MAP?external_kbnSharedDeps_React_default.a.createElement(chart_tooltip.a,null,tooltipService=>external_kbnSharedDeps_React_default.a.createElement(EmbeddedMapComponentWrapper,{seriesConfig:series,tooltipService:tooltipService})):chartType===explorer_constants.b.EVENT_DISTRIBUTION||chartType===explorer_constants.b.POPULATION_DISTRIBUTION?external_kbnSharedDeps_React_default.a.createElement(chart_tooltip.a,null,tooltipService=>external_kbnSharedDeps_React_default.a.createElement(explorer_chart_distribution_ExplorerChartDistribution,{timeBuckets:timeBuckets,tooManyBuckets:tooManyBuckets,seriesConfig:series,severity:severity,tooltipService:tooltipService,showSelectedInterval:showSelectedInterval})):chartType===explorer_constants.b.SINGLE_METRIC?external_kbnSharedDeps_React_default.a.createElement(chart_tooltip.a,null,tooltipService=>external_kbnSharedDeps_React_default.a.createElement(explorer_chart_single_metric_ExplorerChartSingleMetric,{timeBuckets:timeBuckets,tooManyBuckets:tooManyBuckets,seriesConfig:series,severity:severity,tooltipService:tooltipService,showSelectedInterval:showSelectedInterval})):void 0)}const ExplorerChartsContainer=Object(public_.withKibana)(({chartsPerRow:chartsPerRow,seriesToPlot:seriesToPlot,severity:severity,tooManyBuckets:tooManyBuckets,kibana:kibana,errorMessages:errorMessages,mlUrlGenerator:mlUrlGenerator,timeBuckets:timeBuckets,timefilter:timefilter,onSelectEntity:onSelectEntity,tooManyBucketsCalloutMsg:tooManyBucketsCalloutMsg,showSelectedInterval:showSelectedInterval})=>{const{services:{chrome:{recentlyAccessed:recentlyAccessed},http:{basePath:basePath},embeddable:embeddablePlugin,maps:mapsPlugin}}=kibana;let seriesToPlotFiltered;embeddablePlugin&&mapsPlugin||(seriesToPlotFiltered=[],seriesToPlot.forEach(series=>{"lat_long"===series.functionDescription?void 0===errorMessages[mapsPluginMessage]?errorMessages[mapsPluginMessage]=new Set([series.jobId]):errorMessages[mapsPluginMessage].add(series.jobId):seriesToPlotFiltered.push(series)}));const seriesToUse=void 0!==seriesToPlotFiltered?seriesToPlotFiltered:seriesToPlot,chartsWidth=1===chartsPerRow?"calc(100% - 20px)":"auto",chartsColumns=1===chartsPerRow?0:chartsPerRow,wrapLabel=seriesToUse.some(series=>Object(chart_utils.l)(series));return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(ExplorerChartsErrorCallOuts,{errorMessagesByType:errorMessages}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGrid,{columns:chartsColumns,"data-test-subj":"mlExplorerChartsContainer"},seriesToUse.length>0&&seriesToUse.map(series=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{key:getChartId(series),className:"ml-explorer-chart-container",style:{minWidth:chartsWidth}},external_kbnSharedDeps_React_default.a.createElement(ExplorerChartContainer,{series:series,severity:severity,tooManyBuckets:tooManyBuckets,wrapLabel:wrapLabel,mlUrlGenerator:mlUrlGenerator,basePath:basePath.get(),timeBuckets:timeBuckets,timefilter:timefilter,onSelectEntity:onSelectEntity,recentlyAccessed:recentlyAccessed,tooManyBucketsCalloutMsg:tooManyBucketsCalloutMsg,showSelectedInterval:showSelectedInterval})))))})},422:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return MlEmbeddedMapComponent}));var external_kbnSharedDeps_React_=__webpack_require__(14),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),external_kbnSharedDeps_ElasticEui_=__webpack_require__(39),constants_=__webpack_require__(58),public_=__webpack_require__(61),embeddable_public_=__webpack_require__(45),kibana=__webpack_require__(63);function MlEmbeddedMapComponent({layerList:layerList,mapEmbeddableInput:mapEmbeddableInput,renderTooltipContent:renderTooltipContent}){const[embeddable,setEmbeddable]=Object(external_kbnSharedDeps_React_.useState)(),embeddableRoot=Object(external_kbnSharedDeps_React_.useRef)(null),baseLayers=Object(external_kbnSharedDeps_React_.useRef)(),{services:{embeddable:embeddablePlugin,maps:mapsPlugin}}=Object(kibana.b)(),factory=embeddablePlugin?embeddablePlugin.getEmbeddableFactory(public_.MAP_SAVED_OBJECT_TYPE):void 0;return Object(external_kbnSharedDeps_React_.useEffect)(()=>{!async function(){embeddable&&!Object(embeddable_public_.isErrorEmbeddable)(embeddable)&&Array.isArray(layerList)&&Array.isArray(baseLayers.current)&&embeddable.setLayerList([...baseLayers.current,...layerList])}()},[embeddable,layerList]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{!async function(){if(!factory)return void console.error("Map embeddable not found.");const input={id:Object(external_kbnSharedDeps_ElasticEui_.htmlIdGenerator)()(),attributes:{title:""},filters:[],hidePanelTitles:!0,refreshConfig:{value:0,pause:!1},viewMode:embeddable_public_.ViewMode.VIEW,isLayerTOCOpen:!1,hideFilterActions:!0,mapSettings:{disableInteractive:!1,hideToolbarOverlay:!1,hideLayerControl:!1,hideViewControl:!1,initialLocation:constants_.INITIAL_LOCATION.AUTO_FIT_TO_BOUNDS,autoFitToDataBounds:!0}},embeddableObject=await factory.create(input);if(embeddableObject&&!Object(embeddable_public_.isErrorEmbeddable)(embeddableObject)){const basemapLayerDescriptor=mapsPlugin?await mapsPlugin.createLayerDescriptors.createBasemapLayerDescriptor():null;basemapLayerDescriptor&&(baseLayers.current=[basemapLayerDescriptor],await embeddableObject.setLayerList(baseLayers.current))}setEmbeddable(embeddableObject)}()},[]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{embeddable&&!Object(embeddable_public_.isErrorEmbeddable)(embeddable)&&void 0!==mapEmbeddableInput&&embeddable.updateInput(mapEmbeddableInput)},[embeddable,mapEmbeddableInput]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{embeddable&&!Object(embeddable_public_.isErrorEmbeddable)(embeddable)&&void 0!==renderTooltipContent&&embeddable.setRenderTooltipContent(renderTooltipContent)},[embeddable,renderTooltipContent]),Object(external_kbnSharedDeps_React_.useEffect)(()=>{embeddableRoot.current&&embeddable&&embeddable.render(embeddableRoot.current)},[embeddable,embeddableRoot]),embeddablePlugin?mapsPlugin?external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":"mlEmbeddedMapContent",className:"mlEmbeddedMapContent",ref:embeddableRoot}):(console.error("Maps start plugin not found"),null):(console.error("Embeddable start plugin not found"),null)}},779:function(module,exports,__webpack_require__){switch(window.__kbnThemeTag__){case"v7dark":return __webpack_require__(780);case"v7light":return __webpack_require__(782);case"v8dark":return __webpack_require__(784);case"v8light":return __webpack_require__(786)}},780:function(module,exports,__webpack_require__){var api=__webpack_require__(65),content=__webpack_require__(781);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},781:function(module,exports,__webpack_require__){(exports=__webpack_require__(66)(!1)).push([module.i,'.ml-explorer-chart-eui-icon-tip{max-width:none}.ml-explorer-chart-label-badges{margin-top:4px;display:flex;align-items:center}.ml-reset-font-weight{font-weight:normal}.ml-explorer-chart-container{overflow:hidden}.ml-explorer-chart-container .ml-explorer-chart-svg{font-size:12px;font-family:"Inter UI",-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol"}.ml-explorer-chart-container .ml-explorer-chart-svg .line-chart rect{fill:#1D1E24;opacity:1}.ml-explorer-chart-container .ml-explorer-chart-svg .line-chart rect.selected-interval{fill:rgba(200,200,200,0.1);stroke:#98A2B3;stroke-width:2px;stroke-opacity:.8}.ml-explorer-chart-container .ml-explorer-chart-svg .line-chart rect.scheduled-event-marker{stroke-width:1px;stroke:#98A2B3;fill:#343741;pointer-events:none}.ml-explorer-chart-container .axis path,.ml-explorer-chart-container .axis line{fill:none;stroke:#343741;shape-rendering:crispEdges}.ml-explorer-chart-container .axis .tick line.ml-tick-emphasis{stroke:rgba(0,0,0,0.2)}.ml-explorer-chart-container .axis text{fill:#98A2B3}.ml-explorer-chart-container .axis .tick line{stroke:#343741;stroke-width:1px}.ml-explorer-chart-container .values-line{fill:none;stroke:#1BA9F5;stroke-width:2}.ml-explorer-chart-container .values-dots circle,.ml-explorer-chart-container .values-dots-circle{fill:#1BA9F5;stroke-width:0}.ml-explorer-chart-container .values-dots circle.values-dots-circle-blur{fill:#535966}.ml-explorer-chart-container .metric-value{opacity:1;fill:transparent;stroke:#1BA9F5;stroke-width:0}.ml-explorer-chart-container .anomaly-marker{stroke-width:1px;stroke:#535966}.ml-explorer-chart-container .anomaly-marker:hover{stroke-width:6px;stroke:#1BA9F5}.ml-explorer-chart-container .anomaly-marker.critical{fill:#FE5050}.ml-explorer-chart-container .anomaly-marker.major{fill:#FBA740}.ml-explorer-chart-container .anomaly-marker.minor{fill:#FDEC25}.ml-explorer-chart-container .anomaly-marker.warning{fill:#8BC8FB}.ml-explorer-chart-container .anomaly-marker.low{fill:#D2E9F7}.ml-explorer-chart-container .metric-value:hover,.ml-explorer-chart-container .anomaly-marker:hover{stroke-width:6px;stroke-opacity:.65}.ml-explorer-chart{overflow:hidden}.ml-explorer-chart-content-wrapper{height:215px}.ml-explorer-chart-axis-emphasis{font-weight:bold}.explorer-charts ml-explorer-charts-container .row{padding:10px}.explorer-charts ml-explorer-charts-container label{font-size:12px}.explorer-charts ml-explorer-charts-container select{font-size:14px;font-style:400}.explorer-charts ml-explorer-charts-container .chart-controls label{padding:0 0 10px 0}.explorer-charts ml-explorer-charts-container .no-results-item{text-align:center;padding-top:10px}.explorer-charts ml-explorer-charts-container .ml-anomaly-interim-result{font-style:italic;padding-bottom:3px}.explorer-charts ml-explorer-charts-container .ml-tablerow-expanded{width:100%;padding:5px 20px;overflow:hidden;font-size:12px}.explorer-charts ml-explorer-charts-container .ml-tablerow-expanded td{padding:0 0 2px 0}.explorer-charts ml-explorer-charts-container .ml-tablerow-expanded table tr>td:first-child{padding-left:2px;vertical-align:top}.explorer-charts ml-explorer-charts-container .ml-tablerow-expanded td:first-child{width:140px}.explorer-charts ml-explorer-charts-container .ml-tablerow-expanded td:nth-child(2){padding-left:5px}.ml-explorer-chart-icons{float:right;padding-left:5px;margin:2px -8px 0 0}\n',""]),module.exports=exports},782:function(module,exports,__webpack_require__){var api=__webpack_require__(65),content=__webpack_require__(783);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},783:function(module,exports,__webpack_require__){(exports=__webpack_require__(66)(!1)).push([module.i,'.ml-explorer-chart-eui-icon-tip{max-width:none}.ml-explorer-chart-label-badges{margin-top:4px;display:flex;align-items:center}.ml-reset-font-weight{font-weight:normal}.ml-explorer-chart-container{overflow:hidden}.ml-explorer-chart-container .ml-explorer-chart-svg{font-size:12px;font-family:"Inter UI",-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol"}.ml-explorer-chart-container .ml-explorer-chart-svg .line-chart rect{fill:#fff;opacity:1}.ml-explorer-chart-container .ml-explorer-chart-svg .line-chart rect.selected-interval{fill:rgba(200,200,200,0.1);stroke:#69707D;stroke-width:2px;stroke-opacity:.8}.ml-explorer-chart-container .ml-explorer-chart-svg .line-chart rect.scheduled-event-marker{stroke-width:1px;stroke:#69707D;fill:#D3DAE6;pointer-events:none}.ml-explorer-chart-container .axis path,.ml-explorer-chart-container .axis line{fill:none;stroke:#D3DAE6;shape-rendering:crispEdges}.ml-explorer-chart-container .axis .tick line.ml-tick-emphasis{stroke:rgba(0,0,0,0.2)}.ml-explorer-chart-container .axis text{fill:#69707D}.ml-explorer-chart-container .axis .tick line{stroke:#D3DAE6;stroke-width:1px}.ml-explorer-chart-container .values-line{fill:none;stroke:#006BB4;stroke-width:2}.ml-explorer-chart-container .values-dots circle,.ml-explorer-chart-container .values-dots-circle{fill:#006BB4;stroke-width:0}.ml-explorer-chart-container .values-dots circle.values-dots-circle-blur{fill:#98A2B3}.ml-explorer-chart-container .metric-value{opacity:1;fill:transparent;stroke:#006BB4;stroke-width:0}.ml-explorer-chart-container .anomaly-marker{stroke-width:1px;stroke:#98A2B3}.ml-explorer-chart-container .anomaly-marker:hover{stroke-width:6px;stroke:#006BB4}.ml-explorer-chart-container .anomaly-marker.critical{fill:#FE5050}.ml-explorer-chart-container .anomaly-marker.major{fill:#FBA740}.ml-explorer-chart-container .anomaly-marker.minor{fill:#FDEC25}.ml-explorer-chart-container .anomaly-marker.warning{fill:#8BC8FB}.ml-explorer-chart-container .anomaly-marker.low{fill:#D2E9F7}.ml-explorer-chart-container .metric-value:hover,.ml-explorer-chart-container .anomaly-marker:hover{stroke-width:6px;stroke-opacity:.65}.ml-explorer-chart{overflow:hidden}.ml-explorer-chart-content-wrapper{height:215px}.ml-explorer-chart-axis-emphasis{font-weight:bold}.explorer-charts ml-explorer-charts-container .row{padding:10px}.explorer-charts ml-explorer-charts-container label{font-size:12px}.explorer-charts ml-explorer-charts-container select{font-size:14px;font-style:400}.explorer-charts ml-explorer-charts-container .chart-controls label{padding:0 0 10px 0}.explorer-charts ml-explorer-charts-container .no-results-item{text-align:center;padding-top:10px}.explorer-charts ml-explorer-charts-container .ml-anomaly-interim-result{font-style:italic;padding-bottom:3px}.explorer-charts ml-explorer-charts-container .ml-tablerow-expanded{width:100%;padding:5px 20px;overflow:hidden;font-size:12px}.explorer-charts ml-explorer-charts-container .ml-tablerow-expanded td{padding:0 0 2px 0}.explorer-charts ml-explorer-charts-container .ml-tablerow-expanded table tr>td:first-child{padding-left:2px;vertical-align:top}.explorer-charts ml-explorer-charts-container .ml-tablerow-expanded td:first-child{width:140px}.explorer-charts ml-explorer-charts-container .ml-tablerow-expanded td:nth-child(2){padding-left:5px}.ml-explorer-chart-icons{float:right;padding-left:5px;margin:2px -8px 0 0}\n',""]),module.exports=exports},784:function(module,exports,__webpack_require__){var api=__webpack_require__(65),content=__webpack_require__(785);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},785:function(module,exports,__webpack_require__){(exports=__webpack_require__(66)(!1)).push([module.i,'.ml-explorer-chart-eui-icon-tip{max-width:none}.ml-explorer-chart-label-badges{margin-top:4px;display:flex;align-items:center}.ml-reset-font-weight{font-weight:normal}.ml-explorer-chart-container{overflow:hidden}.ml-explorer-chart-container .ml-explorer-chart-svg{font-size:12px;font-family:"Inter",-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol"}.ml-explorer-chart-container .ml-explorer-chart-svg .line-chart rect{fill:#1D1E24;opacity:1}.ml-explorer-chart-container .ml-explorer-chart-svg .line-chart rect.selected-interval{fill:rgba(200,200,200,0.1);stroke:#98A2B3;stroke-width:2px;stroke-opacity:.8}.ml-explorer-chart-container .ml-explorer-chart-svg .line-chart rect.scheduled-event-marker{stroke-width:1px;stroke:#98A2B3;fill:#343741;pointer-events:none}.ml-explorer-chart-container .axis path,.ml-explorer-chart-container .axis line{fill:none;stroke:#343741;shape-rendering:crispEdges}.ml-explorer-chart-container .axis .tick line.ml-tick-emphasis{stroke:rgba(0,0,0,0.2)}.ml-explorer-chart-container .axis text{fill:#98A2B3}.ml-explorer-chart-container .axis .tick line{stroke:#343741;stroke-width:1px}.ml-explorer-chart-container .values-line{fill:none;stroke:#36A2EF;stroke-width:2}.ml-explorer-chart-container .values-dots circle,.ml-explorer-chart-container .values-dots-circle{fill:#36A2EF;stroke-width:0}.ml-explorer-chart-container .values-dots circle.values-dots-circle-blur{fill:#535966}.ml-explorer-chart-container .metric-value{opacity:1;fill:transparent;stroke:#36A2EF;stroke-width:0}.ml-explorer-chart-container .anomaly-marker{stroke-width:1px;stroke:#535966}.ml-explorer-chart-container .anomaly-marker:hover{stroke-width:6px;stroke:#36A2EF}.ml-explorer-chart-container .anomaly-marker.critical{fill:#FE5050}.ml-explorer-chart-container .anomaly-marker.major{fill:#FBA740}.ml-explorer-chart-container .anomaly-marker.minor{fill:#FDEC25}.ml-explorer-chart-container .anomaly-marker.warning{fill:#8BC8FB}.ml-explorer-chart-container .anomaly-marker.low{fill:#D2E9F7}.ml-explorer-chart-container .metric-value:hover,.ml-explorer-chart-container .anomaly-marker:hover{stroke-width:6px;stroke-opacity:.65}.ml-explorer-chart{overflow:hidden}.ml-explorer-chart-content-wrapper{height:215px}.ml-explorer-chart-axis-emphasis{font-weight:bold}.explorer-charts ml-explorer-charts-container .row{padding:10px}.explorer-charts ml-explorer-charts-container label{font-size:12px}.explorer-charts ml-explorer-charts-container select{font-size:14px;font-style:400}.explorer-charts ml-explorer-charts-container .chart-controls label{padding:0 0 10px 0}.explorer-charts ml-explorer-charts-container .no-results-item{text-align:center;padding-top:10px}.explorer-charts ml-explorer-charts-container .ml-anomaly-interim-result{font-style:italic;padding-bottom:3px}.explorer-charts ml-explorer-charts-container .ml-tablerow-expanded{width:100%;padding:5px 20px;overflow:hidden;font-size:12px}.explorer-charts ml-explorer-charts-container .ml-tablerow-expanded td{padding:0 0 2px 0}.explorer-charts ml-explorer-charts-container .ml-tablerow-expanded table tr>td:first-child{padding-left:2px;vertical-align:top}.explorer-charts ml-explorer-charts-container .ml-tablerow-expanded td:first-child{width:140px}.explorer-charts ml-explorer-charts-container .ml-tablerow-expanded td:nth-child(2){padding-left:5px}.ml-explorer-chart-icons{float:right;padding-left:5px;margin:2px -8px 0 0}\n',""]),module.exports=exports},786:function(module,exports,__webpack_require__){var api=__webpack_require__(65),content=__webpack_require__(787);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},787:function(module,exports,__webpack_require__){(exports=__webpack_require__(66)(!1)).push([module.i,'.ml-explorer-chart-eui-icon-tip{max-width:none}.ml-explorer-chart-label-badges{margin-top:4px;display:flex;align-items:center}.ml-reset-font-weight{font-weight:normal}.ml-explorer-chart-container{overflow:hidden}.ml-explorer-chart-container .ml-explorer-chart-svg{font-size:12px;font-family:"Inter",-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol"}.ml-explorer-chart-container .ml-explorer-chart-svg .line-chart rect{fill:#fff;opacity:1}.ml-explorer-chart-container .ml-explorer-chart-svg .line-chart rect.selected-interval{fill:rgba(200,200,200,0.1);stroke:#69707D;stroke-width:2px;stroke-opacity:.8}.ml-explorer-chart-container .ml-explorer-chart-svg .line-chart rect.scheduled-event-marker{stroke-width:1px;stroke:#69707D;fill:#D3DAE6;pointer-events:none}.ml-explorer-chart-container .axis path,.ml-explorer-chart-container .axis line{fill:none;stroke:#D3DAE6;shape-rendering:crispEdges}.ml-explorer-chart-container .axis .tick line.ml-tick-emphasis{stroke:rgba(0,0,0,0.2)}.ml-explorer-chart-container .axis text{fill:#69707D}.ml-explorer-chart-container .axis .tick line{stroke:#D3DAE6;stroke-width:1px}.ml-explorer-chart-container .values-line{fill:none;stroke:#07C;stroke-width:2}.ml-explorer-chart-container .values-dots circle,.ml-explorer-chart-container .values-dots-circle{fill:#07C;stroke-width:0}.ml-explorer-chart-container .values-dots circle.values-dots-circle-blur{fill:#98A2B3}.ml-explorer-chart-container .metric-value{opacity:1;fill:transparent;stroke:#07C;stroke-width:0}.ml-explorer-chart-container .anomaly-marker{stroke-width:1px;stroke:#98A2B3}.ml-explorer-chart-container .anomaly-marker:hover{stroke-width:6px;stroke:#07C}.ml-explorer-chart-container .anomaly-marker.critical{fill:#FE5050}.ml-explorer-chart-container .anomaly-marker.major{fill:#FBA740}.ml-explorer-chart-container .anomaly-marker.minor{fill:#FDEC25}.ml-explorer-chart-container .anomaly-marker.warning{fill:#8BC8FB}.ml-explorer-chart-container .anomaly-marker.low{fill:#D2E9F7}.ml-explorer-chart-container .metric-value:hover,.ml-explorer-chart-container .anomaly-marker:hover{stroke-width:6px;stroke-opacity:.65}.ml-explorer-chart{overflow:hidden}.ml-explorer-chart-content-wrapper{height:215px}.ml-explorer-chart-axis-emphasis{font-weight:bold}.explorer-charts ml-explorer-charts-container .row{padding:10px}.explorer-charts ml-explorer-charts-container label{font-size:12px}.explorer-charts ml-explorer-charts-container select{font-size:14px;font-style:400}.explorer-charts ml-explorer-charts-container .chart-controls label{padding:0 0 10px 0}.explorer-charts ml-explorer-charts-container .no-results-item{text-align:center;padding-top:10px}.explorer-charts ml-explorer-charts-container .ml-anomaly-interim-result{font-style:italic;padding-bottom:3px}.explorer-charts ml-explorer-charts-container .ml-tablerow-expanded{width:100%;padding:5px 20px;overflow:hidden;font-size:12px}.explorer-charts ml-explorer-charts-container .ml-tablerow-expanded td{padding:0 0 2px 0}.explorer-charts ml-explorer-charts-container .ml-tablerow-expanded table tr>td:first-child{padding-left:2px;vertical-align:top}.explorer-charts ml-explorer-charts-container .ml-tablerow-expanded td:first-child{width:140px}.explorer-charts ml-explorer-charts-container .ml-tablerow-expanded td:nth-child(2){padding-left:5px}.ml-explorer-chart-icons{float:right;padding-left:5px;margin:2px -8px 0 0}\n',""]),module.exports=exports},788:function(module,exports,__webpack_require__){switch(window.__kbnThemeTag__){case"v7dark":return __webpack_require__(789);case"v7light":return __webpack_require__(791);case"v8dark":return __webpack_require__(793);case"v8light":return __webpack_require__(795)}},789:function(module,exports,__webpack_require__){var api=__webpack_require__(65),content=__webpack_require__(790);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},790:function(module,exports,__webpack_require__){(exports=__webpack_require__(66)(!1)).push([module.i,".ml-explorer-chart-eui-icon-tip{max-width:none}.ml-explorer-chart-label-badges{margin-top:4px;display:flex;align-items:center}\n",""]),module.exports=exports},791:function(module,exports,__webpack_require__){var api=__webpack_require__(65),content=__webpack_require__(792);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},792:function(module,exports,__webpack_require__){(exports=__webpack_require__(66)(!1)).push([module.i,".ml-explorer-chart-eui-icon-tip{max-width:none}.ml-explorer-chart-label-badges{margin-top:4px;display:flex;align-items:center}\n",""]),module.exports=exports},793:function(module,exports,__webpack_require__){var api=__webpack_require__(65),content=__webpack_require__(794);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},794:function(module,exports,__webpack_require__){(exports=__webpack_require__(66)(!1)).push([module.i,".ml-explorer-chart-eui-icon-tip{max-width:none}.ml-explorer-chart-label-badges{margin-top:4px;display:flex;align-items:center}\n",""]),module.exports=exports},795:function(module,exports,__webpack_require__){var api=__webpack_require__(65),content=__webpack_require__(796);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},796:function(module,exports,__webpack_require__){(exports=__webpack_require__(66)(!1)).push([module.i,".ml-explorer-chart-eui-icon-tip{max-width:none}.ml-explorer-chart-label-badges{margin-top:4px;display:flex;align-items:center}\n",""]),module.exports=exports},797:function(module,exports,__webpack_require__){switch(window.__kbnThemeTag__){case"v7dark":return __webpack_require__(798);case"v7light":return __webpack_require__(800);case"v8dark":return __webpack_require__(802);case"v8light":return __webpack_require__(804)}},798:function(module,exports,__webpack_require__){var api=__webpack_require__(65),content=__webpack_require__(799);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},799:function(module,exports,__webpack_require__){(exports=__webpack_require__(66)(!1)).push([module.i,".ml-explorer-chart-info-tooltip{max-width:384px}.ml-explorer-chart-description{font-size:12px;font-style:italic}.ml-explorer-chart-info-tooltip .mlDescriptionList>*{margin-top:4px}.ml-explorer-chart-info-tooltip .mlDescriptionList{display:grid;grid-template-columns:max-content auto}.ml-explorer-chart-info-tooltip .mlDescriptionList .mlDescriptionList__title{color:#fff;font-size:12px;font-weight:normal;white-space:nowrap;grid-column-start:1}.ml-explorer-chart-info-tooltip .mlDescriptionList .mlDescriptionList__description{color:#fff;font-size:12px;font-weight:bold;padding-left:8px;max-width:256px;grid-column-start:2}\n",""]),module.exports=exports},800:function(module,exports,__webpack_require__){var api=__webpack_require__(65),content=__webpack_require__(801);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},801:function(module,exports,__webpack_require__){(exports=__webpack_require__(66)(!1)).push([module.i,".ml-explorer-chart-info-tooltip{max-width:384px}.ml-explorer-chart-description{font-size:12px;font-style:italic}.ml-explorer-chart-info-tooltip .mlDescriptionList>*{margin-top:4px}.ml-explorer-chart-info-tooltip .mlDescriptionList{display:grid;grid-template-columns:max-content auto}.ml-explorer-chart-info-tooltip .mlDescriptionList .mlDescriptionList__title{color:#fff;font-size:12px;font-weight:normal;white-space:nowrap;grid-column-start:1}.ml-explorer-chart-info-tooltip .mlDescriptionList .mlDescriptionList__description{color:#fff;font-size:12px;font-weight:bold;padding-left:8px;max-width:256px;grid-column-start:2}\n",""]),module.exports=exports},802:function(module,exports,__webpack_require__){var api=__webpack_require__(65),content=__webpack_require__(803);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},803:function(module,exports,__webpack_require__){(exports=__webpack_require__(66)(!1)).push([module.i,".ml-explorer-chart-info-tooltip{max-width:384px}.ml-explorer-chart-description{font-size:12px;font-style:italic}.ml-explorer-chart-info-tooltip .mlDescriptionList>*{margin-top:4px}.ml-explorer-chart-info-tooltip .mlDescriptionList{display:grid;grid-template-columns:max-content auto}.ml-explorer-chart-info-tooltip .mlDescriptionList .mlDescriptionList__title{color:#fff;font-size:12px;font-weight:normal;white-space:nowrap;grid-column-start:1}.ml-explorer-chart-info-tooltip .mlDescriptionList .mlDescriptionList__description{color:#fff;font-size:12px;font-weight:bold;padding-left:8px;max-width:256px;grid-column-start:2}\n",""]),module.exports=exports},804:function(module,exports,__webpack_require__){var api=__webpack_require__(65),content=__webpack_require__(805);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},805:function(module,exports,__webpack_require__){(exports=__webpack_require__(66)(!1)).push([module.i,".ml-explorer-chart-info-tooltip{max-width:384px}.ml-explorer-chart-description{font-size:12px;font-style:italic}.ml-explorer-chart-info-tooltip .mlDescriptionList>*{margin-top:4px}.ml-explorer-chart-info-tooltip .mlDescriptionList{display:grid;grid-template-columns:max-content auto}.ml-explorer-chart-info-tooltip .mlDescriptionList .mlDescriptionList__title{color:#fff;font-size:12px;font-weight:normal;white-space:nowrap;grid-column-start:1}.ml-explorer-chart-info-tooltip .mlDescriptionList .mlDescriptionList__description{color:#fff;font-size:12px;font-weight:bold;padding-left:8px;max-width:256px;grid-column-start:2}\n",""]),module.exports=exports},806:function(module,exports,__webpack_require__){switch(window.__kbnThemeTag__){case"v7dark":return __webpack_require__(807);case"v7light":return __webpack_require__(809);case"v8dark":return __webpack_require__(811);case"v8light":return __webpack_require__(813)}},807:function(module,exports,__webpack_require__){var api=__webpack_require__(65),content=__webpack_require__(808);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},808:function(module,exports,__webpack_require__){(exports=__webpack_require__(66)(!1)).push([module.i,".filter-button{opacity:.5;width:16px;height:16px;transform:translateY(-1px)}.filter-button .euiIcon{width:12px;height:12px}.filter-button:hover{opacity:1}\n",""]),module.exports=exports},809:function(module,exports,__webpack_require__){var api=__webpack_require__(65),content=__webpack_require__(810);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},810:function(module,exports,__webpack_require__){(exports=__webpack_require__(66)(!1)).push([module.i,".filter-button{opacity:.5;width:16px;height:16px;transform:translateY(-1px)}.filter-button .euiIcon{width:12px;height:12px}.filter-button:hover{opacity:1}\n",""]),module.exports=exports},811:function(module,exports,__webpack_require__){var api=__webpack_require__(65),content=__webpack_require__(812);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},812:function(module,exports,__webpack_require__){(exports=__webpack_require__(66)(!1)).push([module.i,".filter-button{opacity:.5;width:16px;height:16px;transform:translateY(-1px)}.filter-button .euiIcon{width:12px;height:12px}.filter-button:hover{opacity:1}\n",""]),module.exports=exports},813:function(module,exports,__webpack_require__){var api=__webpack_require__(65),content=__webpack_require__(814);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},814:function(module,exports,__webpack_require__){(exports=__webpack_require__(66)(!1)).push([module.i,".filter-button{opacity:.5;width:16px;height:16px;transform:translateY(-1px)}.filter-button .euiIcon{width:12px;height:12px}.filter-button:hover{opacity:1}\n",""]),module.exports=exports},90:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"c",(function(){return getTimeBucketsFromCache})),__webpack_require__.d(__webpack_exports__,"a",(function(){return TimeBuckets})),__webpack_require__.d(__webpack_exports__,"b",(function(){return getBoundsRoundedToInterval}));var external_kbnSharedDeps_Lodash_=__webpack_require__(7),external_kbnSharedDeps_Moment_=__webpack_require__(15),external_kbnSharedDeps_Moment_default=__webpack_require__.n(external_kbnSharedDeps_Moment_),datemath_target=__webpack_require__(30),target_default=__webpack_require__.n(datemath_target);const{duration:d}=external_kbnSharedDeps_Moment_default.a;var parse_interval=__webpack_require__(26),dependency_cache=__webpack_require__(22),public_=__webpack_require__(41);const unitsDesc=target_default.a.unitsDesc,timeUnitsMaxSupportedIndex=unitsDesc.indexOf("w"),calcAuto=function(){const revRoundingRules=[[d(500,"ms"),d(100,"ms")],[d(5,"second"),d(1,"second")],[d(10,"second"),d(5,"second")],[d(15,"second"),d(10,"second")],[d(30,"second"),d(15,"second")],[d(1,"minute"),d(30,"second")],[d(5,"minute"),d(1,"minute")],[d(10,"minute"),d(5,"minute")],[d(15,"minute"),d(10,"minute")],[d(30,"minute"),d(10,"minute")],[d(1,"hour"),d(30,"minute")],[d(2,"hour"),d(1,"hour")],[d(4,"hour"),d(2,"hour")],[d(6,"hour"),d(4,"hour")],[d(8,"hour"),d(6,"hour")],[d(12,"hour"),d(8,"hour")],[d(24,"hour"),d(12,"hour")],[d(2,"d"),d(1,"d")],[d(4,"d"),d(2,"d")],[d(1,"week"),d(4,"d")],[d(1,"month"),d(1,"week")],[d(1,"year"),d(1,"month")],[1/0,d(1,"year")]].slice(0).reverse();function find(rules,check,last){return function(buckets,duration){const interval=function(buckets,duration){const target=duration/buckets;let lastResp;for(let i=0;i<rules.length;i++){const rule=rules[i],resp=check(rule[0],rule[1],target);if(null==resp){if(!last)continue;if(lastResp)return lastResp;break}if(!last)return resp;lastResp=resp}const ms=Math.max(Math.floor(target),1);return external_kbnSharedDeps_Moment_default.a.duration(ms,"ms")}(buckets,duration);if(interval)return external_kbnSharedDeps_Moment_default.a.duration(interval._data)}}return{near:find(revRoundingRules,(function(upperBound,lowerBound,target){if(upperBound>target){if(upperBound===1/0)return lowerBound;const boundMs=upperBound.asMilliseconds(),intervalMs=lowerBound.asMilliseconds();return Math.abs(boundMs-target)<=Math.abs(intervalMs)?upperBound:lowerBound}}),!0),lessThan:find(revRoundingRules,(function(upperBound,lowerBound,target){if(lowerBound<target)return upperBound!==1/0?upperBound:lowerBound})),atLeast:find(revRoundingRules,(function(upperBound,lowerBound,target){if(lowerBound<=target)return lowerBound}))}}();function getTimeBucketsFromCache(){const uiSettings=Object(dependency_cache.k)();return new TimeBuckets({[public_.UI_SETTINGS.HISTOGRAM_MAX_BARS]:uiSettings.get(public_.UI_SETTINGS.HISTOGRAM_MAX_BARS),[public_.UI_SETTINGS.HISTOGRAM_BAR_TARGET]:uiSettings.get(public_.UI_SETTINGS.HISTOGRAM_BAR_TARGET),dateFormat:uiSettings.get("dateFormat"),"dateFormat:scaled":uiSettings.get("dateFormat:scaled")})}function TimeBuckets(timeBucketsConfig){this._timeBucketsConfig=timeBucketsConfig,this.barTarget=this._timeBucketsConfig[public_.UI_SETTINGS.HISTOGRAM_BAR_TARGET],this.maxBars=this._timeBucketsConfig[public_.UI_SETTINGS.HISTOGRAM_MAX_BARS]}function decorateInterval(interval,originalDuration){const esInterval=function(duration){for(let i=0;i<unitsDesc.length;i++){const unit=unitsDesc[i],val=duration.as(unit);if(val>=1&&Math.floor(val)===val){if(i<=timeUnitsMaxSupportedIndex)continue;return{value:val,unit:unit,expression:val+unit}}}const ms=duration.as("ms");return{value:ms,unit:"ms",expression:ms+"ms"}}(interval);interval.esValue=esInterval.value,interval.esUnit=esInterval.unit,interval.expression=esInterval.expression,interval.overflow=originalDuration>interval&&external_kbnSharedDeps_Moment_default.a.duration(interval-originalDuration);const prettyUnits=external_kbnSharedDeps_Moment_default.a.normalizeUnits(esInterval.unit);return 1===esInterval.value?interval.description=prettyUnits:interval.description=`${esInterval.value} ${prettyUnits}s`,interval}function isValidMoment(m){return m&&"isValid"in m&&m.isValid()}function getBoundsRoundedToInterval(bounds,interval,inclusiveEnd=!1){const intervalMs=interval.asMilliseconds(),adjustedMinMs=Math.floor(bounds.min.valueOf()/intervalMs)*intervalMs;let adjustedMaxMs=Math.ceil(bounds.max.valueOf()/intervalMs)*intervalMs;return!1===inclusiveEnd&&(adjustedMaxMs-=1),{min:external_kbnSharedDeps_Moment_default()(adjustedMinMs),max:external_kbnSharedDeps_Moment_default()(adjustedMaxMs)}}TimeBuckets.prototype.setBarTarget=function(bt){this.barTarget=bt},TimeBuckets.prototype.setMaxBars=function(mb){this.maxBars=mb},TimeBuckets.prototype.setBounds=function(input){if(!input)return this.clearBounds();let bounds;bounds=Object(external_kbnSharedDeps_Lodash_.isPlainObject)(input)?[input.min,input.max]:Array.isArray(input)?input:[];const moments=Object(external_kbnSharedDeps_Lodash_.sortBy)(bounds.map(Object(external_kbnSharedDeps_Lodash_.ary)(external_kbnSharedDeps_Moment_default.a,1)),Number);if(!(2===moments.length&&moments.every(isValidMoment)))throw this.clearBounds(),new Error("invalid bounds set: "+input);if(this._lb=moments.shift(),this._ub=moments.pop(),this.getDuration().asSeconds()<0)throw new TypeError("Intervals must be positive")},TimeBuckets.prototype.clearBounds=function(){this._lb=this._ub=null},TimeBuckets.prototype.hasBounds=function(){return isValidMoment(this._ub)&&isValidMoment(this._lb)},TimeBuckets.prototype.getBounds=function(){if(this.hasBounds())return{min:this._lb,max:this._ub}},TimeBuckets.prototype.getDuration=function(){if(this.hasBounds())return external_kbnSharedDeps_Moment_default.a.duration(this._ub-this._lb,"ms")},TimeBuckets.prototype.setInterval=function(input){this.originalInterval=input;let interval=input;if(interval&&"auto"!==interval){if(Object(external_kbnSharedDeps_Lodash_.isString)(interval)&&(input=interval,interval=Object(parse_interval.a)(interval),0==+interval&&(interval=null)),!external_kbnSharedDeps_Moment_default.a.isDuration(interval))throw new TypeError('"'+input+'" is not a valid interval.');this._i=interval}else this._i="auto"},TimeBuckets.prototype.getInterval=function(){const self=this,duration=self.getDuration();return decorateInterval(function(interval){if(!self.hasBounds())return interval;const maxLength=self.maxBars;let scaled;if(!(duration/interval>maxLength))return interval;scaled=calcAuto.lessThan(maxLength,duration);return+scaled==+interval?interval:(decorateInterval(interval,duration),Object(external_kbnSharedDeps_Lodash_.assign)(scaled,{preScaled:interval,scale:interval/scaled,scaled:!0}))}(function(){const interval=self._i;return external_kbnSharedDeps_Moment_default.a.isDuration(interval)?interval:calcAuto.near(self.barTarget,duration)}()),duration)},TimeBuckets.prototype.getIntervalToNearestMultiple=function(divisorSecs){const interval=this.getInterval(),intervalSecs=interval.asSeconds(),remainder=intervalSecs%divisorSecs;if(0===remainder)return interval;let nearestMultiple=remainder>divisorSecs/2?intervalSecs+divisorSecs-remainder:intervalSecs-remainder;nearestMultiple=0===nearestMultiple?divisorSecs:nearestMultiple;const nearestMultipleInt=external_kbnSharedDeps_Moment_default.a.duration(nearestMultiple,"seconds");decorateInterval(nearestMultipleInt,this.getDuration());const preScaled=interval.preScaled;return void 0!==preScaled&&preScaled<nearestMultipleInt&&(nearestMultipleInt.preScaled=preScaled,nearestMultipleInt.scale=preScaled/nearestMultipleInt,nearestMultipleInt.scaled=!0),nearestMultipleInt},TimeBuckets.prototype.getScaledDateFormat=function(){const interval=this.getInterval(),rules=this._timeBucketsConfig["dateFormat:scaled"];for(let i=rules.length-1;i>=0;i--){const rule=rules[i];if(!rule[0]||interval>=external_kbnSharedDeps_Moment_default.a.duration(rule[0]))return rule[1]}return this._timeBucketsConfig.dateFormat},TimeBuckets.prototype.getScaledDateFormatter=function(){return new(Object(dependency_cache.c)().getType(public_.FIELD_FORMAT_IDS.DATE))({pattern:this.getScaledDateFormat()},this._timeBucketsConfig)}},99:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return createJobs})),__webpack_require__.d(__webpack_exports__,"d",(function(){return getClearedSelectedAnomaliesState})),__webpack_require__.d(__webpack_exports__,"f",(function(){return getDefaultSwimlaneData})),__webpack_require__.d(__webpack_exports__,"p",(function(){return loadFilteredTopInfluencers})),__webpack_require__.d(__webpack_exports__,"g",(function(){return getInfluencers})),__webpack_require__.d(__webpack_exports__,"e",(function(){return getDateFormatTz})),__webpack_require__.d(__webpack_exports__,"k",(function(){return getSelectionTimeRange})),__webpack_require__.d(__webpack_exports__,"i",(function(){return getSelectionInfluencers})),__webpack_require__.d(__webpack_exports__,"j",(function(){return getSelectionJobIds})),__webpack_require__.d(__webpack_exports__,"l",(function(){return getSwimlaneBucketInterval})),__webpack_require__.d(__webpack_exports__,"m",(function(){return getViewBySwimlaneOptions})),__webpack_require__.d(__webpack_exports__,"q",(function(){return loadOverallAnnotations})),__webpack_require__.d(__webpack_exports__,"n",(function(){return loadAnnotationsTableData})),__webpack_require__.d(__webpack_exports__,"o",(function(){return loadAnomaliesTableData})),__webpack_require__.d(__webpack_exports__,"r",(function(){return loadTopInfluencers})),__webpack_require__.d(__webpack_exports__,"c",(function(){return escapeParens})),__webpack_require__.d(__webpack_exports__,"b",(function(){return escapeDoubleQuotes})),__webpack_require__.d(__webpack_exports__,"h",(function(){return getQueryPattern})),__webpack_require__.d(__webpack_exports__,"s",(function(){return removeFilterFromQueryString}));var lodash__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(7),moment_timezone__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(48),moment_timezone__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(moment_timezone__WEBPACK_IMPORTED_MODULE_1__),_common_constants_search__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(101),_common_util_anomaly_utils__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(6),_common_util_errors__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(24),_common_util_job_utils__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(69),_common_util_parse_interval__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(26),_services_ml_api_service__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(64),_services_job_service__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(70),_util_time_buckets__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(90),_util_dependency_cache__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(22),_explorer_constants__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(75),_common_constants_annotations__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(137);function createJobs(jobs){return jobs.map(job=>{const bucketSpan=Object(_common_util_parse_interval__WEBPACK_IMPORTED_MODULE_6__.a)(job.analysis_config.bucket_span);return{id:job.job_id,selected:!1,bucketSpanSeconds:bucketSpan.asSeconds()}})}function getClearedSelectedAnomaliesState(){return{selectedCells:void 0,viewByLoadedForTimeFormatted:null,swimlaneLimit:void 0}}function getDefaultSwimlaneData(){return{fieldName:"",laneLabels:[],points:[],interval:3600}}async function loadFilteredTopInfluencers(mlResultsService,jobIds,earliestMs,latestMs,records,influencers,noInfluencersConfigured,influencersFilterQuery){const recordInfluencersByName={};influencers.forEach(influencer=>{const fieldName=influencer.fieldName;void 0===recordInfluencersByName[influencer.fieldName]&&(recordInfluencersByName[influencer.fieldName]=[]),recordInfluencersByName[fieldName].push(influencer.fieldValue)}),records.forEach(record=>{(record.influencers||[]).forEach(influencer=>{const fieldName=influencer.influencer_field_name,fieldValues=influencer.influencer_field_values;void 0===recordInfluencersByName[fieldName]&&(recordInfluencersByName[fieldName]=[]),recordInfluencersByName[fieldName].push(...fieldValues)})});const uniqValuesByName={};Object.keys(recordInfluencersByName).forEach(fieldName=>{const fieldValues=recordInfluencersByName[fieldName];uniqValuesByName[fieldName]=Object(lodash__WEBPACK_IMPORTED_MODULE_0__.uniq)(fieldValues)});const filterInfluencers=[];return Object.keys(uniqValuesByName).forEach(fieldName=>{void 0!==influencers.find(influencer=>influencer.fieldName===fieldName)?filterInfluencers.push(...influencers):uniqValuesByName[fieldName].forEach(fieldValue=>{filterInfluencers.push({fieldName:fieldName,fieldValue:fieldValue})})}),await loadTopInfluencers(mlResultsService,jobIds,earliestMs,latestMs,filterInfluencers,noInfluencersConfigured,influencersFilterQuery)}function getInfluencers(selectedJobs=[]){const influencers=[];return selectedJobs.forEach(selectedJob=>{const job=_services_job_service__WEBPACK_IMPORTED_MODULE_8__.a.getJob(selectedJob.id);void 0!==job&&job.analysis_config&&job.analysis_config.influencers&&influencers.push(...job.analysis_config.influencers)}),influencers}function getDateFormatTz(){const tzConfig=Object(_util_dependency_cache__WEBPACK_IMPORTED_MODULE_10__.k)().get("dateFormat:tz");return"Browser"!==tzConfig?tzConfig:moment_timezone__WEBPACK_IMPORTED_MODULE_1___default.a.tz.guess()}function getSelectionTimeRange(selectedCells,interval,bounds){let earliestMs=bounds.min.valueOf(),latestMs=bounds.max.valueOf();return void 0!==selectedCells&&void 0!==selectedCells.times&&(earliestMs=void 0!==selectedCells.times[0]?1e3*selectedCells.times[0]:bounds.min.valueOf(),latestMs=bounds.max.valueOf(),void 0!==selectedCells.times[1]&&(latestMs=1e3*selectedCells.times[1]-1)),{earliestMs:earliestMs,latestMs:latestMs}}function getSelectionInfluencers(selectedCells,fieldName){return void 0!==selectedCells&&selectedCells.type!==_explorer_constants__WEBPACK_IMPORTED_MODULE_11__.h.OVERALL&&void 0!==selectedCells.viewByFieldName&&selectedCells.viewByFieldName!==_explorer_constants__WEBPACK_IMPORTED_MODULE_11__.j?selectedCells.lanes.map(laneLabel=>({fieldName:fieldName,fieldValue:laneLabel})):[]}function getSelectionJobIds(selectedCells,selectedJobs){return void 0!==selectedCells&&selectedCells.type!==_explorer_constants__WEBPACK_IMPORTED_MODULE_11__.h.OVERALL&&void 0!==selectedCells.viewByFieldName&&selectedCells.viewByFieldName===_explorer_constants__WEBPACK_IMPORTED_MODULE_11__.j?selectedCells.lanes:selectedJobs.map(d=>d.id)}function getSwimlaneBucketInterval(selectedJobs,swimlaneContainerWidth){const bounds=Object(_util_dependency_cache__WEBPACK_IMPORTED_MODULE_10__.i)().getActiveBounds(),buckets=Object(_util_time_buckets__WEBPACK_IMPORTED_MODULE_9__.c)();buckets.setInterval("auto"),buckets.setBounds(bounds);const intervalSeconds=buckets.getInterval().asSeconds(),timerangeSeconds=(bounds.max.valueOf()-bounds.min.valueOf())/1e3,numBuckets=parseInt(timerangeSeconds/intervalSeconds);Math.floor(swimlaneContainerWidth/numBuckets*100)/100<8&&buckets.setInterval(2*intervalSeconds+"s");const maxBucketSpanSeconds=selectedJobs.reduce((memo,job)=>Math.max(memo,job.bucketSpanSeconds),0);return maxBucketSpanSeconds>intervalSeconds&&(buckets.setInterval(maxBucketSpanSeconds+"s"),buckets.setBounds(bounds)),buckets.getInterval()}function getViewBySwimlaneOptions({currentViewBySwimlaneFieldName:currentViewBySwimlaneFieldName,filterActive:filterActive,filteredFields:filteredFields,isAndOperator:isAndOperator,selectedCells:selectedCells,selectedJobs:selectedJobs}){const selectedJobIds=selectedJobs.map(d=>d.id),viewByOptions=Object(lodash__WEBPACK_IMPORTED_MODULE_0__.sortBy)(Object(lodash__WEBPACK_IMPORTED_MODULE_0__.uniq)(_services_job_service__WEBPACK_IMPORTED_MODULE_8__.a.jobs.reduce((reducedViewByOptions,job)=>selectedJobIds.some(jobId=>jobId===job.job_id)?reducedViewByOptions.concat(job.analysis_config.influencers||[]):reducedViewByOptions,[])),fieldName=>fieldName.toLowerCase());viewByOptions.push(_explorer_constants__WEBPACK_IMPORTED_MODULE_11__.j);let viewBySwimlaneOptions=viewByOptions,viewBySwimlaneFieldName=void 0;if(-1!==viewBySwimlaneOptions.indexOf(currentViewBySwimlaneFieldName))viewBySwimlaneFieldName=currentViewBySwimlaneFieldName;else if(selectedJobIds.length>1)viewBySwimlaneFieldName=_explorer_constants__WEBPACK_IMPORTED_MODULE_11__.j;else if(_services_job_service__WEBPACK_IMPORTED_MODULE_8__.a.jobs.length>0&&selectedJobIds.length>0){const firstSelectedJob=_services_job_service__WEBPACK_IMPORTED_MODULE_8__.a.jobs.find(job=>job.job_id===selectedJobIds[0]),firstJobInfluencers=firstSelectedJob.analysis_config.influencers||[];firstSelectedJob.analysis_config.detectors.forEach(detector=>void 0!==detector.partition_field_name&&-1!==firstJobInfluencers.indexOf(detector.partition_field_name)?(viewBySwimlaneFieldName=detector.partition_field_name,!1):void 0!==detector.over_field_name&&-1!==firstJobInfluencers.indexOf(detector.over_field_name)?(viewBySwimlaneFieldName=detector.over_field_name,!1):void 0!==detector.by_field_name&&void 0===detector.over_field_name&&-1!==firstJobInfluencers.indexOf(detector.by_field_name)?(viewBySwimlaneFieldName=detector.by_field_name,!1):void 0),void 0===viewBySwimlaneFieldName&&(viewBySwimlaneFieldName=firstJobInfluencers.length>0?firstJobInfluencers[0]:viewBySwimlaneOptions.length>0?viewBySwimlaneOptions[0]:void 0)}if(!0===filterActive&&!0===isAndOperator&&null===selectedCells)viewBySwimlaneOptions=[_explorer_constants__WEBPACK_IMPORTED_MODULE_11__.j];else if(!0===filterActive&&Array.isArray(viewBySwimlaneOptions)&&Array.isArray(filteredFields)){const filteredOptions=viewBySwimlaneOptions.filter(option=>filteredFields.includes(option)||option===_explorer_constants__WEBPACK_IMPORTED_MODULE_11__.j||selectedCells&&selectedCells.viewByFieldName===option);filteredOptions.length>1&&(viewBySwimlaneOptions=filteredOptions)}return{viewBySwimlaneFieldName:viewBySwimlaneFieldName,viewBySwimlaneOptions:viewBySwimlaneOptions}}function loadOverallAnnotations(selectedJobs,interval,bounds){const jobIds=selectedJobs.map(d=>d.id),timeRange=getSelectionTimeRange(void 0,0,bounds);return new Promise(resolve=>{_services_ml_api_service__WEBPACK_IMPORTED_MODULE_7__.ml.annotations.getAnnotations$({jobIds:jobIds,earliestMs:timeRange.earliestMs,latestMs:timeRange.latestMs,maxAnnotations:_common_constants_search__WEBPACK_IMPORTED_MODULE_2__.a}).toPromise().then(resp=>{if(void 0!==resp.error||void 0===resp.annotations){const errorMessage=Object(_common_util_errors__WEBPACK_IMPORTED_MODULE_4__.i)(resp.error);return resolve({annotationsData:[],error:""!==errorMessage?errorMessage:void 0})}const annotationsData=[];return jobIds.forEach(jobId=>{const jobAnnotations=resp.annotations[jobId];void 0!==jobAnnotations&&annotationsData.push(...jobAnnotations)}),resolve({annotationsData:annotationsData.sort((a,b)=>a.timestamp-b.timestamp).map((d,i)=>(d.key=(i+1).toString(),d))})}).catch(resp=>{const errorMessage=Object(_common_util_errors__WEBPACK_IMPORTED_MODULE_4__.i)(resp);return resolve({annotationsData:[],error:""!==errorMessage?errorMessage:void 0})})})}function loadAnnotationsTableData(selectedCells,selectedJobs,interval,bounds){const jobIds=void 0!==selectedCells&&selectedCells.viewByFieldName===_explorer_constants__WEBPACK_IMPORTED_MODULE_11__.j?selectedCells.lanes:selectedJobs.map(d=>d.id),timeRange=getSelectionTimeRange(selectedCells,0,bounds);return new Promise(resolve=>{_services_ml_api_service__WEBPACK_IMPORTED_MODULE_7__.ml.annotations.getAnnotations$({jobIds:jobIds,earliestMs:timeRange.earliestMs,latestMs:timeRange.latestMs,maxAnnotations:_common_constants_search__WEBPACK_IMPORTED_MODULE_2__.a,fields:[{field:"event",missing:_common_constants_annotations__WEBPACK_IMPORTED_MODULE_12__.b}]}).toPromise().then(resp=>{if(void 0!==resp.error||void 0===resp.annotations){const errorMessage=Object(_common_util_errors__WEBPACK_IMPORTED_MODULE_4__.i)(resp.error);return resolve({annotationsData:[],aggregations:{},error:""!==errorMessage?errorMessage:void 0})}const annotationsData=[];return jobIds.forEach(jobId=>{const jobAnnotations=resp.annotations[jobId];void 0!==jobAnnotations&&annotationsData.push(...jobAnnotations)}),resolve({annotationsData:annotationsData.sort((a,b)=>a.timestamp-b.timestamp).map((d,i)=>(d.key=(i+1).toString(),d)),aggregations:resp.aggregations})}).catch(resp=>{const errorMessage=Object(_common_util_errors__WEBPACK_IMPORTED_MODULE_4__.i)(resp);return resolve({annotationsData:[],aggregations:{},error:""!==errorMessage?errorMessage:void 0})})})}async function loadAnomaliesTableData(selectedCells,selectedJobs,dateFormatTz,interval,bounds,fieldName,tableInterval,tableSeverity,influencersFilterQuery){const jobIds=getSelectionJobIds(selectedCells,selectedJobs),influencers=getSelectionInfluencers(selectedCells,fieldName),timeRange=getSelectionTimeRange(selectedCells,0,bounds);return new Promise((resolve,reject)=>{_services_ml_api_service__WEBPACK_IMPORTED_MODULE_7__.ml.results.getAnomaliesTableData(jobIds,[],influencers,tableInterval,tableSeverity,timeRange.earliestMs,timeRange.latestMs,dateFormatTz,_common_constants_search__WEBPACK_IMPORTED_MODULE_2__.b,_explorer_constants__WEBPACK_IMPORTED_MODULE_11__.e,influencersFilterQuery).toPromise().then(resp=>{const anomalies=resp.anomalies,detectorsByJob=_services_job_service__WEBPACK_IMPORTED_MODULE_8__.a.detectorsByJob;anomalies.forEach(anomaly=>{const jobId=anomaly.jobId,detector=Object(lodash__WEBPACK_IMPORTED_MODULE_0__.get)(detectorsByJob,[jobId,anomaly.detectorIndex]);anomaly.detector=Object(lodash__WEBPACK_IMPORTED_MODULE_0__.get)(detector,["detector_description"],anomaly.source.function_description),void 0!==detector&&void 0!==detector.custom_rules&&(anomaly.rulesLength=detector.custom_rules.length);const job=_services_job_service__WEBPACK_IMPORTED_MODULE_8__.a.getJob(jobId);let isChartable=Object(_common_util_job_utils__WEBPACK_IMPORTED_MODULE_5__.n)(job,anomaly.detectorIndex);if(!1===isChartable&&Object(_common_util_job_utils__WEBPACK_IMPORTED_MODULE_5__.l)(job,anomaly.detectorIndex)){const entityFields=Object(_common_util_anomaly_utils__WEBPACK_IMPORTED_MODULE_3__.d)(anomaly.source);isChartable=Object(_common_util_job_utils__WEBPACK_IMPORTED_MODULE_5__.m)(job,anomaly.detectorIndex,entityFields)}anomaly.isTimeSeriesViewRecord=isChartable,void 0!==_services_job_service__WEBPACK_IMPORTED_MODULE_8__.a.customUrlsByJob[jobId]&&(anomaly.customUrls=_services_job_service__WEBPACK_IMPORTED_MODULE_8__.a.customUrlsByJob[jobId])}),resolve({anomalies:anomalies,interval:resp.interval,examplesByJobId:resp.examplesByJobId,showViewSeriesLink:!0,jobIds:jobIds})}).catch(resp=>{console.log("Explorer - error loading data for anomalies table:",resp),reject()})})}async function loadTopInfluencers(mlResultsService,selectedJobIds,earliestMs,latestMs,influencers=[],noInfluencersConfigured,influencersFilterQuery){return new Promise(resolve=>{!0!==noInfluencersConfigured?mlResultsService.getTopInfluencers(selectedJobIds,earliestMs,latestMs,_explorer_constants__WEBPACK_IMPORTED_MODULE_11__.f,10,1,influencers,influencersFilterQuery).then(resp=>{resolve(resp.influencers)}):resolve({})})}function escapeRegExp(string){return string.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function escapeParens(string){return string.replace(/[()]/g,"\\$&")}function escapeDoubleQuotes(string){return string.replace(/[\\"]/g,"\\$&")}function getQueryPattern(fieldName,fieldValue){const sanitizedFieldName=escapeRegExp(fieldName),sanitizedFieldValue=escapeRegExp(fieldValue);return new RegExp(`(${sanitizedFieldName})\\s?:\\s?(")?(${sanitizedFieldValue})(")?`,"i")}function removeFilterFromQueryString(currentQueryString,fieldName,fieldValue){let newQueryString="";const queryPattern=getQueryPattern(fieldName,fieldValue);newQueryString=currentQueryString.replace(queryPattern,"");return newQueryString=newQueryString.replace(/\s+(and|or)\s+(and|or)\s+/gi," $1 "),newQueryString=newQueryString.replace(/\s(and|or)\s*$/gi,""),newQueryString=newQueryString.replace(/^\s*(and|or)\s/gi,""),newQueryString}}}]);