/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.ml_bundle_jsonpfunction=window.ml_bundle_jsonpfunction||[]).push([[19],{158:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return EmbeddableLoading}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(14),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),_elastic_eui__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(39);const EmbeddableLoading=()=>react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__.EuiText,{textAlign:"center"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__.EuiSpacer,{size:"l"}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__.EuiLoadingSpinner,{size:"l"}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__.EuiSpacer,{size:"l"}))},289:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"getDefaultExplorerChartsPanelTitle",(function(){return getDefaultExplorerChartsPanelTitle})),__webpack_require__.d(__webpack_exports__,"AnomalyChartsEmbeddable",(function(){return anomaly_charts_embeddable_AnomalyChartsEmbeddable}));var external_kbnSharedDeps_React_=__webpack_require__(14),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),external_kbnSharedDeps_ReactDom_=__webpack_require__(46),external_kbnSharedDeps_ReactDom_default=__webpack_require__.n(external_kbnSharedDeps_ReactDom_),external_kbnSharedDeps_KbnI18n_=__webpack_require__(2),external_kbnSharedDeps_Rxjs_=__webpack_require__(23),public_=__webpack_require__(42),embeddable_public_=__webpack_require__(45);const EmbeddableAnomalyChartsContainer=external_kbnSharedDeps_React_default.a.lazy(()=>Promise.all([__webpack_require__.e(0),__webpack_require__.e(1),__webpack_require__.e(3),__webpack_require__.e(17)]).then(__webpack_require__.bind(null,884)));var embeddables=__webpack_require__(103),embeddable_loading_fallback=__webpack_require__(158);function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}const getDefaultExplorerChartsPanelTitle=jobIds=>external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.ml.anomalyChartsEmbeddable.title",{defaultMessage:"ML anomaly charts for {jobIds}",values:{jobIds:jobIds.join(", ")}});class anomaly_charts_embeddable_AnomalyChartsEmbeddable extends embeddable_public_.Embeddable{constructor(initialInput,services,parent){super(initialInput,{defaultTitle:initialInput.title},parent),this.services=services,_defineProperty(this,"node",void 0),_defineProperty(this,"reload$",new external_kbnSharedDeps_Rxjs_.Subject),_defineProperty(this,"type",embeddables.a),this.initializeOutput(initialInput)}async initializeOutput(initialInput){const{anomalyExplorerService:anomalyExplorerService}=this.services[2],{jobIds:jobIds}=initialInput;try{const jobs=await anomalyExplorerService.getCombinedJobs(jobIds),indexPatternsService=this.services[1].data.indexPatterns,indices=new Set(jobs.map(j=>j.datafeed_config.indices).flat()),indexPatterns={};for(const indexName of indices){const indexPattern=(await indexPatternsService.find(`"${indexName}"`)).find(obj=>obj.title.toLowerCase()===indexName.toLowerCase());void 0!==indexPattern&&(indexPatterns[indexPattern.id]=indexPattern)}this.updateOutput({...this.getOutput(),indexPatterns:Object.values(indexPatterns)})}catch(e){console.error("Unable to load index patterns for "+jobIds,e)}}render(node){super.render(node),this.node=node;const I18nContext=this.services[0].i18n.Context;external_kbnSharedDeps_ReactDom_default.a.render(external_kbnSharedDeps_React_default.a.createElement(I18nContext,null,external_kbnSharedDeps_React_default.a.createElement(public_.KibanaContextProvider,{services:{...this.services[0]}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_.Suspense,{fallback:external_kbnSharedDeps_React_default.a.createElement(embeddable_loading_fallback.a,null)},external_kbnSharedDeps_React_default.a.createElement(EmbeddableAnomalyChartsContainer,{id:this.input.id,embeddableContext:this,embeddableInput:this.getInput$(),services:this.services,refresh:this.reload$.asObservable(),onInputChange:this.updateInput.bind(this),onOutputChange:this.updateOutput.bind(this)})))),node)}destroy(){super.destroy(),this.node&&external_kbnSharedDeps_ReactDom_default.a.unmountComponentAtNode(this.node)}reload(){this.reload$.next()}supportedTriggers(){return[]}}}}]);