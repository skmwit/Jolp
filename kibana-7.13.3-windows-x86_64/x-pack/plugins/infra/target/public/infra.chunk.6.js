/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.infra_bundle_jsonpfunction=window.infra_bundle_jsonpfunction||[]).push([[6],{118:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return MetricsAndGroupByToolbarItems}));var external_kbnSharedDeps_React_=__webpack_require__(2),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),external_kbnSharedDeps_ElasticEui_=__webpack_require__(10),snapshot_metric_i18n=__webpack_require__(165),external_kbnSharedDeps_KbnI18n_=__webpack_require__(1),common_=__webpack_require__(13),dropdown_button=__webpack_require__(127);const LABELS={name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.infra.waffle.sortNameLabel",{defaultMessage:"Name"}),value:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.infra.waffle.sort.valueLabel",{defaultMessage:"Metric value"})},WaffleSortControls=({sort:sort,onChange:onChange})=>{const[isOpen,setIsOpen]=Object(external_kbnSharedDeps_React_.useState)(!1),showPopover=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setIsOpen(!0)},[setIsOpen]),closePopover=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setIsOpen(!1)},[setIsOpen]),label=LABELS[sort.by],button=external_kbnSharedDeps_React_default.a.createElement(dropdown_button.a,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.infra.waffle.sortLabel",{defaultMessage:"Sort by"}),onClick:showPopover},label),selectName=Object(external_kbnSharedDeps_React_.useCallback)(()=>{onChange({...sort,by:"name"}),closePopover()},[closePopover,onChange,sort]),selectValue=Object(external_kbnSharedDeps_React_.useCallback)(()=>{onChange({...sort,by:"value"}),closePopover()},[closePopover,onChange,sort]),toggleSort=Object(external_kbnSharedDeps_React_.useCallback)(()=>{onChange({...sort,direction:"asc"===sort.direction?"desc":"asc"})},[sort,onChange]),panels=Object(external_kbnSharedDeps_React_.useMemo)(()=>[{id:0,title:"",items:[{name:LABELS.name,icon:"name"===sort.by?"check":"empty",onClick:selectName},{name:LABELS.value,icon:"value"===sort.by?"check":"empty",onClick:selectValue}]}],[sort.by,selectName,selectValue]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopover,{isOpen:isOpen,id:"sortPopover",button:button,anchorPosition:"downLeft",panelPaddingSize:"none",closePopover:closePopover},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenu,{initialPanelId:0,panels:panels}),external_kbnSharedDeps_React_default.a.createElement(SwitchContainer,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSwitch,{compressed:!0,label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.infra.waffle.sortDirectionLabel",{defaultMessage:"Reverse direction"}),checked:"desc"===sort.direction,onChange:toggleSort})))},SwitchContainer=Object(common_.withTheme)(({children:children,theme:theme})=>external_kbnSharedDeps_React_default.a.createElement("div",{style:{padding:null==theme?void 0:theme.eui.paddingSizes.m,borderTop:"1px solid "+(null==theme?void 0:theme.eui.euiBorderColor)}},children));var get_custom_metric_label=__webpack_require__(126),snapshot_api=__webpack_require__(87),uuid=__webpack_require__(37),uuid_default=__webpack_require__.n(uuid),external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(14);const AGGREGATION_LABELS={avg:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.infra.waffle.customMetrics.aggregationLables.avg",{defaultMessage:"Average"}),max:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.infra.waffle.customMetrics.aggregationLables.max",{defaultMessage:"Max"}),min:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.infra.waffle.customMetrics.aggregationLables.min",{defaultMessage:"Min"}),rate:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.infra.waffle.customMetrics.aggregationLables.rate",{defaultMessage:"Rate"})},CustomMetricForm=Object(common_.withTheme)(({theme:theme,onCancel:onCancel,fields:fields,onChange:onChange,metric:metric})=>{const[label,setLabel]=Object(external_kbnSharedDeps_React_.useState)(metric?metric.label:void 0),[aggregation,setAggregation]=Object(external_kbnSharedDeps_React_.useState)(metric?metric.aggregation:"avg"),[field,setField]=Object(external_kbnSharedDeps_React_.useState)(metric?metric.field:void 0),handleSubmit=Object(external_kbnSharedDeps_React_.useCallback)(()=>{if(metric&&aggregation&&field)onChange({...metric,label:label,aggregation:aggregation,field:field});else if(aggregation&&field){const newMetric={type:"custom",id:uuid_default.a.v1(),label:label,aggregation:aggregation,field:field};onChange(newMetric)}},[metric,aggregation,field,onChange,label]),handleLabelChange=Object(external_kbnSharedDeps_React_.useCallback)(e=>{setLabel(e.target.value)},[setLabel]),handleFieldChange=Object(external_kbnSharedDeps_React_.useCallback)(selectedOptions=>{setField(selectedOptions[0].label)},[setField]),handleAggregationChange=Object(external_kbnSharedDeps_React_.useCallback)(e=>{const value=e.target.value,aggValue=snapshot_api.c.is(value)?value:"avg";setAggregation(aggValue)},[setAggregation]),fieldOptions=fields.filter(f=>f.aggregatable&&"number"===f.type&&!(field&&field===f.name)).map(f=>({label:f.name})),aggregationOptions=snapshot_api.b.map(k=>({text:AGGREGATION_LABELS[k],value:k})),isSubmitDisabled=!field||!aggregation,title=metric?external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.infra.waffle.customMetricPanelLabel.edit",{defaultMessage:"Edit custom metric"}):external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.infra.waffle.customMetricPanelLabel.add",{defaultMessage:"Add custom metric"}),titleAriaLabel=metric?external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.infra.waffle.customMetricPanelLabel.editAriaLabel",{defaultMessage:"Back to custom metrics edit mode"}):external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.infra.waffle.customMetricPanelLabel.addAriaLabel",{defaultMessage:"Back to metric picker"});return external_kbnSharedDeps_React_default.a.createElement("div",{style:{width:685}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiForm,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopoverTitle,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{iconType:"arrowLeft",onClick:onCancel,color:"text",size:"xs",flush:"left",style:{fontWeight:700,textTransform:"uppercase"},"aria-label":titleAriaLabel},title)),external_kbnSharedDeps_React_default.a.createElement("div",{style:{padding:null==theme?void 0:theme.eui.paddingSizes.m,borderBottom:`${null==theme?void 0:theme.eui.euiBorderWidthThin} solid ${null==theme?void 0:theme.eui.euiBorderColor}`}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.infra.waffle.customMetrics.metricLabel",{defaultMessage:"Metric"}),display:"rowCompressed",fullWidth:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSelect,{onChange:handleAggregationChange,value:aggregation,options:aggregationOptions,fullWidth:!0})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{color:"subdued"},external_kbnSharedDeps_React_default.a.createElement("span",null,"of"))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiComboBox,{fullWidth:!0,placeholder:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.infra.waffle.customMetrics.fieldPlaceholder",{defaultMessage:"Select a field"}),singleSelection:{asPlainText:!0},selectedOptions:field?[{label:field}]:[],options:fieldOptions,onChange:handleFieldChange,isClearable:!1})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.infra.waffle.customMetrics.labelLabel",{defaultMessage:"Label (optional)"}),display:"rowCompressed",fullWidth:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldText,{name:"label",placeholder:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.infra.waffle.customMetrics.labelPlaceholder",{defaultMessage:'Choose a name to appear in the "Metric" dropdown'}),value:label,fullWidth:!0,onChange:handleLabelChange}))),external_kbnSharedDeps_React_default.a.createElement("div",{style:{padding:null==theme?void 0:theme.eui.paddingSizes.m,textAlign:"right"}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{onClick:onCancel,size:"s",style:{paddingRight:null==theme?void 0:theme.eui.paddingSizes.xl}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.infra.waffle.customMetrics.cancelLabel",defaultMessage:"Cancel"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{type:"submit",size:"s",fill:!0,onClick:handleSubmit,disabled:isSubmitDisabled},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.infra.waffle.customMetrics.submitLabel",defaultMessage:"Save"})))))});var types=__webpack_require__(83);const MetricsContextMenu=({onClose:onClose,onChange:onChange,metric:metric,options:options,customMetrics:customMetrics})=>{const id=snapshot_api.d.is(metric)&&metric.id?metric.id:metric.type,handleClick=Object(external_kbnSharedDeps_React_.useCallback)(val=>{if(types.f.is(val))onChange({type:val});else{const selectedMetric=customMetrics.find(m=>m.id===val);selectedMetric&&onChange(selectedMetric)}onClose()},[customMetrics,onChange,onClose]),panels=[{id:0,title:"",items:[...options.map(o=>{const icon=o.value===id?"check":"empty";return{name:o.text,onClick:()=>handleClick(o.value),icon:icon}}),...customMetrics.map(m=>{const icon=m.id===id?"check":"empty";return{name:Object(get_custom_metric_label.a)(m),onClick:()=>handleClick(m.id),icon:icon}})]}];return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenu,{initialPanelId:0,panels:panels})},ModeSwitcher=Object(common_.withTheme)(({onSave:onSave,onEditCancel:onEditCancel,onEdit:onEdit,onAdd:onAdd,mode:mode,customMetrics:customMetrics,theme:theme})=>["editMetric","addMetric"].includes(mode)?null:external_kbnSharedDeps_React_default.a.createElement("div",{style:{borderTop:`${null==theme?void 0:theme.eui.euiBorderWidthThin} solid ${null==theme?void 0:theme.eui.euiBorderColor}`,padding:12}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceBetween"},"edit"===mode?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{size:"s",flush:"left",onClick:onEditCancel,"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.infra.waffle.customMetrics.modeSwitcher.cancelAriaLabel",{defaultMessage:"Cancel edit mode"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.infra.waffle.customMetrics.modeSwitcher.cancel",defaultMessage:"Cancel"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{onClick:onSave,size:"s",fill:!0,"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.infra.waffle.customMetrics.modeSwitcher.saveButtonAriaLabel",{defaultMessage:"Save changes to custom metrics"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.infra.waffle.customMetrics.modeSwitcher.saveButton",defaultMessage:"Save"})))):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{size:"s",flush:"left",onClick:onEdit,disabled:0===customMetrics.length,"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.infra.waffle.customMetrics.modeSwitcher.editAriaLabel",{defaultMessage:"Edit custom metrics"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.infra.waffle.customMetrics.modeSwitcher.edit",defaultMessage:"Edit"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{onClick:onAdd,size:"s",flush:"right","aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.infra.waffle.customMetrics.modeSwitcher.addMetricAriaLabel",{defaultMessage:"Add custom metric"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.infra.waffle.customMetrics.modeSwitcher.addMetric",defaultMessage:"Add metric"}))))))),MetricsEditMode=Object(common_.withTheme)(({theme:theme,customMetrics:customMetrics,options:options,onEdit:onEdit,onDelete:onDelete})=>external_kbnSharedDeps_React_default.a.createElement("div",{style:{width:256}},options.map(option=>external_kbnSharedDeps_React_default.a.createElement("div",{key:option.value,style:{padding:"14px 14px 13px 36px"}},external_kbnSharedDeps_React_default.a.createElement("span",{style:{color:null==theme?void 0:theme.eui.euiButtonColorDisabled}},option.text))),customMetrics.map(metric=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{key:metric.id,alignItems:"center",gutterSize:"none",style:{padding:"10px 0px 9px"}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,style:{width:36}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{iconType:"pencil",onClick:()=>onEdit(metric),"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.infra.waffle.customMetrics.editMode.editButtonAriaLabel",{defaultMessage:"Edit custom metric for {name}",values:{name:Object(get_custom_metric_label.a)(metric)}})})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:1,style:{overflow:"hidden"}},Object(get_custom_metric_label.a)(metric)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1,style:{width:36,textAlign:"right"}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{iconType:"trash",color:"danger",onClick:()=>onDelete(metric),"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.infra.waffle.customMetrics.editMode.deleteAriaLabel",{defaultMessage:"Delete custom metric for {name}",values:{name:Object(get_custom_metric_label.a)(metric)}})})))))),WaffleMetricControls=({fields:fields,onChange:onChange,onChangeCustomMetrics:onChangeCustomMetrics,metric:metric,options:options,customMetrics:customMetrics})=>{var _options$find;const[isPopoverOpen,setPopoverState]=Object(external_kbnSharedDeps_React_.useState)(!1),[mode,setMode]=Object(external_kbnSharedDeps_React_.useState)("pick"),[editModeCustomMetrics,setEditModeCustomMetrics]=Object(external_kbnSharedDeps_React_.useState)([]),[editCustomMetric,setEditCustomMetric]=Object(external_kbnSharedDeps_React_.useState)(),handleClose=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setPopoverState(!1)},[setPopoverState]),handleToggle=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setPopoverState(!isPopoverOpen)},[isPopoverOpen]),handleCustomMetric=Object(external_kbnSharedDeps_React_.useCallback)(newMetric=>{onChangeCustomMetrics([...customMetrics,newMetric]),onChange(newMetric),setMode("pick")},[customMetrics,onChange,onChangeCustomMetrics,setMode]),setModeToEdit=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setMode("edit"),setEditModeCustomMetrics(customMetrics)},[customMetrics]),setModeToAdd=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setMode("addMetric")},[setMode]),setModeToPick=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setMode("pick"),setEditModeCustomMetrics([])},[setMode]),handleDeleteCustomMetric=Object(external_kbnSharedDeps_React_.useCallback)(m=>{snapshot_api.d.is(metric)&&m.id===metric.id&&onChange({type:options[0].value});const newMetrics=editModeCustomMetrics.filter(v=>v.id!==m.id);setEditModeCustomMetrics(newMetrics)},[editModeCustomMetrics,metric,onChange,options]),handleEditCustomMetric=Object(external_kbnSharedDeps_React_.useCallback)(currentMetric=>{const newMetrics=customMetrics.map(m=>m.id===currentMetric.id&&currentMetric||m);onChangeCustomMetrics(newMetrics),setModeToPick(),setEditCustomMetric(void 0),setEditModeCustomMetrics([])},[customMetrics,onChangeCustomMetrics,setModeToPick]),handleSelectMetricToEdit=Object(external_kbnSharedDeps_React_.useCallback)(currentMetric=>{setEditCustomMetric(currentMetric),setMode("editMetric")},[setMode,setEditCustomMetric]),handleSaveEdit=Object(external_kbnSharedDeps_React_.useCallback)(()=>{onChangeCustomMetrics(editModeCustomMetrics),setMode("pick")},[editModeCustomMetrics,onChangeCustomMetrics]);if(!options.length||!metric.type)throw Error(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.infra.waffle.unableToSelectMetricErrorTitle",{defaultMessage:"Unable to select options or value for metric."}));const id=snapshot_api.d.is(metric)&&metric.id?metric.id:metric.type,currentLabel=snapshot_api.d.is(metric)?Object(get_custom_metric_label.a)(metric):null===(_options$find=options.find(o=>o.value===id))||void 0===_options$find?void 0:_options$find.text;if(!currentLabel)return null;const button=external_kbnSharedDeps_React_default.a.createElement(dropdown_button.a,{onClick:handleToggle,label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.infra.waffle.metriclabel",{defaultMessage:"Metric"})},currentLabel);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopover,{isOpen:isPopoverOpen,id:"metricsPanel",button:button,anchorPosition:"downLeft",panelPaddingSize:"none",closePopover:handleClose},"pick"===mode?external_kbnSharedDeps_React_default.a.createElement(MetricsContextMenu,{onChange:onChange,onClose:handleClose,metric:metric,customMetrics:customMetrics,options:options}):null,"addMetric"===mode?external_kbnSharedDeps_React_default.a.createElement(CustomMetricForm,{fields:fields,customMetrics:customMetrics,onChange:handleCustomMetric,onCancel:setModeToPick}):null,"editMetric"===mode?external_kbnSharedDeps_React_default.a.createElement(CustomMetricForm,{metric:editCustomMetric,fields:fields,customMetrics:customMetrics,onChange:handleEditCustomMetric,onCancel:setModeToEdit}):null,"edit"===mode?external_kbnSharedDeps_React_default.a.createElement(MetricsEditMode,{customMetrics:editModeCustomMetrics,options:options,onEdit:handleSelectMetricToEdit,onDelete:handleDeleteCustomMetric}):null,external_kbnSharedDeps_React_default.a.createElement(ModeSwitcher,{onEditCancel:setModeToPick,onEdit:setModeToEdit,onAdd:setModeToAdd,mode:mode,onSave:handleSaveEdit,customMetrics:customMetrics})))};function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}const initialState={selectedOptions:[]};class custom_field_panel_CustomFieldPanel extends external_kbnSharedDeps_React_default.a.PureComponent{constructor(...args){super(...args),_defineProperty(this,"state",initialState),_defineProperty(this,"handleSubmit",()=>{this.props.onSubmit(this.state.selectedOptions[0].label)}),_defineProperty(this,"handleFieldSelection",selectedOptions=>{this.setState({selectedOptions:selectedOptions})})}render(){const{fields:fields,currentOptions:currentOptions}=this.props,options=fields.filter(f=>f.aggregatable&&"string"===f.type&&!(currentOptions&&currentOptions.some(o=>o.field===f.name))).map(f=>({label:f.name})),isSubmitDisabled=!this.state.selectedOptions.length;return external_kbnSharedDeps_React_default.a.createElement("div",{style:{padding:16}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiForm,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.infra.waffle.customGroupByFieldLabel",{defaultMessage:"Field"}),helpText:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.infra.waffle.customGroupByHelpText",{defaultMessage:"This is the field used for the terms aggregation"}),display:"rowCompressed",fullWidth:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiComboBox,{placeholder:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.infra.waffle.customGroupByDropdownPlacehoder",{defaultMessage:"Select one"}),singleSelection:{asPlainText:!0},selectedOptions:this.state.selectedOptions,options:options,onChange:this.handleFieldSelection,fullWidth:!0,isClearable:!1})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{disabled:isSubmitDisabled,type:"submit",size:"s",fill:!0,onClick:this.handleSubmit},"Add")))}}function waffle_group_by_controls_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}_defineProperty(custom_field_panel_CustomFieldPanel,"displayName","CustomFieldPanel");const waffle_group_by_controls_initialState={isPopoverOpen:!1};class waffle_group_by_controls_WaffleGroupByControls extends external_kbnSharedDeps_React_default.a.PureComponent{constructor(...args){super(...args),waffle_group_by_controls_defineProperty(this,"state",waffle_group_by_controls_initialState),waffle_group_by_controls_defineProperty(this,"handleRemove",field=>()=>{const{groupBy:groupBy}=this.props;this.props.onChange(groupBy.filter(g=>g.field!==field));const options=this.props.customOptions.filter(g=>g.field!==field);this.props.onChangeCustomOptions(options),setTimeout(()=>this.handleClose())}),waffle_group_by_controls_defineProperty(this,"handleClose",()=>{this.setState({isPopoverOpen:!1})}),waffle_group_by_controls_defineProperty(this,"handleToggle",()=>{this.setState(state=>({isPopoverOpen:!state.isPopoverOpen}))}),waffle_group_by_controls_defineProperty(this,"handleCustomField",field=>{const options=[...this.props.customOptions,{text:field,field:field}];this.props.onChangeCustomOptions(options);this.handleClick(field)()}),waffle_group_by_controls_defineProperty(this,"handleClick",field=>()=>{const{groupBy:groupBy}=this.props;groupBy.some(g=>g.field===field)?this.handleRemove(field)():this.props.groupBy.length<2&&this.props.onChange([...groupBy,{field:field}]),this.handleClose()})}render(){const{nodeType:nodeType,groupBy:groupBy}=this.props,customOptions=this.props.customOptions.map(option=>({...option,toolTipContent:option.text})),options=this.props.options.concat(customOptions);if(!options.length)throw Error(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.infra.waffle.unableToSelectGroupErrorMessage",{defaultMessage:"Unable to select group by options for {nodeType}",values:{nodeType:nodeType}}));const isMaxGroupingsSelected=groupBy.length>=2,maxGroupByTooltip=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.infra.waffle.maxGroupByTooltip",{defaultMessage:"Only two groupings can be selected at a time"}),panels=[{id:"firstPanel",title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.infra.waffle.selectTwoGroupingsTitle",{defaultMessage:"Select up to two groupings"}),items:[{name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.infra.waffle.customGroupByOptionName",{defaultMessage:"Custom field"}),disabled:isMaxGroupingsSelected,toolTipContent:isMaxGroupingsSelected?maxGroupByTooltip:null,icon:"empty",panel:"customPanel"},...options.map(o=>{const icon=groupBy.some(g=>g.field===o.field)?"check":"empty",panel={name:o.text,onClick:this.handleClick(o.field),icon:icon};return o.toolTipContent&&(panel.toolTipContent=o.toolTipContent),isMaxGroupingsSelected&&"empty"===icon&&(panel.toolTipContent=maxGroupByTooltip,panel.disabled=!0),panel})]},{id:"customPanel",title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.infra.waffle.customGroupByPanelTitle",{defaultMessage:"Group By Custom Field"}),width:685,content:external_kbnSharedDeps_React_default.a.createElement(custom_field_panel_CustomFieldPanel,{currentOptions:this.props.customOptions,onSubmit:this.handleCustomField,fields:this.props.fields})}],buttonBody=groupBy.length>0?groupBy.map(g=>options.find(o=>o.field===g.field)).filter(o=>null!=o).map(o=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiBadge,{color:"hollow",key:o&&o.field},o&&o.text)):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.infra.waffle.groupByAllTitle",defaultMessage:"All"}),button=external_kbnSharedDeps_React_default.a.createElement(dropdown_button.a,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.infra.waffle.groupByLabel",{defaultMessage:"Group by"}),onClick:this.handleToggle},buttonBody);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopover,{isOpen:this.state.isPopoverOpen,id:"groupByPanel",button:button,panelPaddingSize:"none",closePopover:this.handleClose},external_kbnSharedDeps_React_default.a.createElement(StyledContextMenu,{initialPanelId:"firstPanel",panels:panels}))}}waffle_group_by_controls_defineProperty(waffle_group_by_controls_WaffleGroupByControls,"displayName","WaffleGroupByControls");const StyledContextMenu=Object(common_.euiStyled)(external_kbnSharedDeps_ElasticEui_.EuiContextMenu)`
  width: 320px;
  & .euiContextMenuItem__text {
    overflow: hidden;
    text-overflow: ellipsis;
  }
`;var toolbar_wrapper=__webpack_require__(300);const MetricsAndGroupByToolbarItems=props=>{const metricOptions=Object(external_kbnSharedDeps_React_.useMemo)(()=>props.metricTypes.map(snapshot_metric_i18n.a).filter(v=>v),[props.metricTypes]),groupByOptions=Object(external_kbnSharedDeps_React_.useMemo)(()=>props.groupByFields.map(toolbar_wrapper.b),[props.groupByFields]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(WaffleMetricControls,{fields:props.createDerivedIndexPattern("metrics").fields,options:metricOptions,metric:props.metric,onChange:props.changeMetric,onChangeCustomMetrics:props.changeCustomMetrics,customMetrics:props.customMetrics})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(waffle_group_by_controls_WaffleGroupByControls,{options:groupByOptions,groupBy:props.groupBy,nodeType:props.nodeType,onChange:props.changeGroupBy,fields:props.createDerivedIndexPattern("metrics").fields,onChangeCustomOptions:props.changeCustomOptions,customOptions:props.customOptions})),"map"===props.view&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(WaffleSortControls,{sort:props.sort,onChange:props.changeSort})))}},126:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return getCustomMetricLabel}));var _kbn_i18n__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1);const getCustomMetricLabel=metric=>{const METRIC_LABELS={avg:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.infra.waffle.aggregationNames.avg",{defaultMessage:"Avg of {field}",values:{field:metric.field}}),max:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.infra.waffle.aggregationNames.max",{defaultMessage:"Max of {field}",values:{field:metric.field}}),min:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.infra.waffle.aggregationNames.min",{defaultMessage:"Min of {field}",values:{field:metric.field}}),rate:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.infra.waffle.aggregationNames.rate",{defaultMessage:"Rate of {field}",values:{field:metric.field}})};return metric.label?metric.label:METRIC_LABELS[metric.aggregation]}},127:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return DropdownButton}));var _elastic_eui__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(10),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(2),react__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__),_src_plugins_kibana_react_common__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(13);const DropdownButton=Object(_src_plugins_kibana_react_common__WEBPACK_IMPORTED_MODULE_2__.withTheme)(({onClick:onClick,label:label,theme:theme,children:children})=>react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_0__.EuiFlexGroup,{alignItems:"center",gutterSize:"none",style:{border:null==theme?void 0:theme.eui.euiFormInputGroupBorder,boxShadow:`0px 3px 2px ${null==theme?void 0:theme.eui.euiTableActionsBorderColor}, 0px 1px 1px ${null==theme?void 0:theme.eui.euiTableActionsBorderColor}`}},react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_0__.EuiFlexItem,{grow:!1,style:{padding:12,background:null==theme?void 0:theme.eui.euiFormInputGroupLabelBackground,fontSize:"0.75em",fontWeight:600,color:null==theme?void 0:theme.eui.euiTitleColor}},label),react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_0__.EuiFlexItem,{grow:!1},react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_0__.EuiButtonEmpty,{color:"text",iconType:"arrowDown",onClick:onClick,iconSide:"right",size:"xs"},children))))},163:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return useSnapshot}));var fp_ts_lib_Either__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(17),fp_ts_lib_function__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(18),fp_ts_lib_pipeable__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(25),react__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(2),_common_runtime_types__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(15),_hooks_use_http_request__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(102),_common_http_api_snapshot_api__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(87);function useSnapshot(filterQuery,metrics,groupBy,nodeType,sourceId,currentTime,accountId,region,sendRequestImmediatly=!0,timerange){timerange=timerange||{interval:"1m",to:currentTime,from:currentTime-12e5,lookbackSize:5};const{error:error,loading:loading,response:response,makeRequest:makeRequest}=Object(_hooks_use_http_request__WEBPACK_IMPORTED_MODULE_5__.a)("/api/metrics/snapshot","POST",JSON.stringify({metrics:metrics,groupBy:groupBy,nodeType:nodeType,timerange:timerange,filterQuery:filterQuery,sourceId:sourceId,accountId:accountId,region:region,includeTimeseries:!0}),response=>Object(fp_ts_lib_pipeable__WEBPACK_IMPORTED_MODULE_2__.pipe)(_common_http_api_snapshot_api__WEBPACK_IMPORTED_MODULE_6__.g.decode(response),Object(fp_ts_lib_Either__WEBPACK_IMPORTED_MODULE_0__.fold)(Object(_common_runtime_types__WEBPACK_IMPORTED_MODULE_4__.c)(_common_runtime_types__WEBPACK_IMPORTED_MODULE_4__.a),fp_ts_lib_function__WEBPACK_IMPORTED_MODULE_1__.identity)));return Object(react__WEBPACK_IMPORTED_MODULE_3__.useEffect)(()=>{(async()=>{sendRequestImmediatly&&await makeRequest()})()},[makeRequest,sendRequestImmediatly]),{error:error&&error.message||null,loading:loading,nodes:response?response.nodes:[],interval:response?response.interval:"60s",reload:makeRequest}}},164:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return createInventoryMetricFormatter}));var lodash__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(24),_lib_lib__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(32),_common_http_api_snapshot_api__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(87),_metrics_explorer_components_helpers_create_formatter_for_metric__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(138),_common_formatters__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(33);const METRIC_FORMATTERS={count:{formatter:_lib_lib__WEBPACK_IMPORTED_MODULE_1__.b.number,template:"{{value}}"},cpu:{formatter:_lib_lib__WEBPACK_IMPORTED_MODULE_1__.b.percent,template:"{{value}}"},memory:{formatter:_lib_lib__WEBPACK_IMPORTED_MODULE_1__.b.percent,template:"{{value}}"},rx:{formatter:_lib_lib__WEBPACK_IMPORTED_MODULE_1__.b.bits,template:"{{value}}/s"},tx:{formatter:_lib_lib__WEBPACK_IMPORTED_MODULE_1__.b.bits,template:"{{value}}/s"},logRate:{formatter:_lib_lib__WEBPACK_IMPORTED_MODULE_1__.b.abbreviatedNumber,template:"{{value}}/s"},diskIOReadBytes:{formatter:_lib_lib__WEBPACK_IMPORTED_MODULE_1__.b.bytes,template:"{{value}}/s"},diskIOWriteBytes:{formatter:_lib_lib__WEBPACK_IMPORTED_MODULE_1__.b.bytes,template:"{{value}}/s"},s3BucketSize:{formatter:_lib_lib__WEBPACK_IMPORTED_MODULE_1__.b.bytes,template:"{{value}}"},s3TotalRequests:{formatter:_lib_lib__WEBPACK_IMPORTED_MODULE_1__.b.abbreviatedNumber,template:"{{value}}"},s3NumberOfObjects:{formatter:_lib_lib__WEBPACK_IMPORTED_MODULE_1__.b.abbreviatedNumber,template:"{{value}}"},s3UploadBytes:{formatter:_lib_lib__WEBPACK_IMPORTED_MODULE_1__.b.bytes,template:"{{value}}"},s3DownloadBytes:{formatter:_lib_lib__WEBPACK_IMPORTED_MODULE_1__.b.bytes,template:"{{value}}"},sqsOldestMessage:{formatter:_lib_lib__WEBPACK_IMPORTED_MODULE_1__.b.number,template:"{{value}} seconds"},rdsLatency:{formatter:_lib_lib__WEBPACK_IMPORTED_MODULE_1__.b.number,template:"{{value}} ms"}},createInventoryMetricFormatter=metric=>val=>{if(_common_http_api_snapshot_api__WEBPACK_IMPORTED_MODULE_2__.d.is(metric)){return Object(_metrics_explorer_components_helpers_create_formatter_for_metric__WEBPACK_IMPORTED_MODULE_3__.a)(metric)(val)}const metricFormatter=Object(lodash__WEBPACK_IMPORTED_MODULE_0__.get)(METRIC_FORMATTERS,metric.type,METRIC_FORMATTERS.count);if(null==val)return"";return Object(_common_formatters__WEBPACK_IMPORTED_MODULE_4__.b)(metricFormatter.formatter,metricFormatter.template)(val)}},165:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return toMetricOpt}));var _kbn_i18n__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1),lodash__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(24);const TranslationsLowercase={CPUUsage:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.infra.waffle.metricOptions.cpuUsageText",{defaultMessage:"CPU usage"}),MemoryUsage:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.infra.waffle.metricOptions.memoryUsageText",{defaultMessage:"memory usage"}),InboundTraffic:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.infra.waffle.metricOptions.inboundTrafficText",{defaultMessage:"inbound traffic"}),OutboundTraffic:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.infra.waffle.metricOptions.outboundTrafficText",{defaultMessage:"outbound traffic"}),LogRate:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.infra.waffle.metricOptions.hostLogRateText",{defaultMessage:"log rate"}),Load:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.infra.waffle.metricOptions.loadText",{defaultMessage:"load"}),Count:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.infra.waffle.metricOptions.countText",{defaultMessage:"count"}),DiskIOReadBytes:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.infra.waffle.metricOptions.diskIOReadBytes",{defaultMessage:"disk reads"}),DiskIOWriteBytes:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.infra.waffle.metricOptions.diskIOWriteBytes",{defaultMessage:"disk writes"}),s3BucketSize:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.infra.waffle.metricOptions.s3BucketSize",{defaultMessage:"bucket size"}),s3TotalRequests:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.infra.waffle.metricOptions.s3TotalRequests",{defaultMessage:"total requests"}),s3NumberOfObjects:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.infra.waffle.metricOptions.s3NumberOfObjects",{defaultMessage:"number of objects"}),s3DownloadBytes:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.infra.waffle.metricOptions.s3DownloadBytes",{defaultMessage:"downloads (bytes)"}),s3UploadBytes:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.infra.waffle.metricOptions.s3UploadBytes",{defaultMessage:"uploads (bytes)"}),rdsConnections:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.infra.waffle.metricOptions.rdsConnections",{defaultMessage:"connections"}),rdsQueriesExecuted:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.infra.waffle.metricOptions.rdsQueriesExecuted",{defaultMessage:"queries executed"}),rdsActiveTransactions:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.infra.waffle.metricOptions.rdsActiveTransactions",{defaultMessage:"active transactions"}),rdsLatency:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.infra.waffle.metricOptions.rdsLatency",{defaultMessage:"latency"}),sqsMessagesVisible:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.infra.waffle.metricOptions.sqsMessagesVisible",{defaultMessage:"messages available"}),sqsMessagesDelayed:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.infra.waffle.metricOptions.sqsMessagesDelayed",{defaultMessage:"messages delayed"}),sqsMessagesSent:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.infra.waffle.metricOptions.sqsMessagesSent",{defaultMessage:"messages added"}),sqsMessagesEmpty:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.infra.waffle.metricOptions.sqsMessagesEmpty",{defaultMessage:"messages returned empty"}),sqsOldestMessage:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.infra.waffle.metricOptions.sqsOldestMessage",{defaultMessage:"oldest message"})},Translations=Object(lodash__WEBPACK_IMPORTED_MODULE_1__.mapValues)(TranslationsLowercase,translation=>`${translation[0].toUpperCase()}${translation.slice(1)}`),toMetricOpt=metric=>{switch(metric){case"cpu":return{text:Translations.CPUUsage,textLC:TranslationsLowercase.CPUUsage,value:"cpu"};case"memory":return{text:Translations.MemoryUsage,textLC:TranslationsLowercase.MemoryUsage,value:"memory"};case"rx":return{text:Translations.InboundTraffic,textLC:TranslationsLowercase.InboundTraffic,value:"rx"};case"tx":return{text:Translations.OutboundTraffic,textLC:TranslationsLowercase.OutboundTraffic,value:"tx"};case"logRate":return{text:Translations.LogRate,textLC:TranslationsLowercase.LogRate,value:"logRate"};case"load":return{text:Translations.Load,textLC:TranslationsLowercase.Load,value:"load"};case"count":return{text:Translations.Count,textLC:TranslationsLowercase.Count,value:"count"};case"diskIOReadBytes":return{text:Translations.DiskIOReadBytes,textLC:TranslationsLowercase.DiskIOReadBytes,value:"diskIOReadBytes"};case"diskIOWriteBytes":return{text:Translations.DiskIOWriteBytes,textLC:TranslationsLowercase.DiskIOWriteBytes,value:"diskIOWriteBytes"};case"s3BucketSize":return{text:Translations.s3BucketSize,textLC:TranslationsLowercase.s3BucketSize,value:"s3BucketSize"};case"s3TotalRequests":return{text:Translations.s3TotalRequests,textLC:TranslationsLowercase.s3TotalRequests,value:"s3TotalRequests"};case"s3NumberOfObjects":return{text:Translations.s3NumberOfObjects,textLC:TranslationsLowercase.s3NumberOfObjects,value:"s3NumberOfObjects"};case"s3DownloadBytes":return{text:Translations.s3DownloadBytes,textLC:TranslationsLowercase.s3DownloadBytes,value:"s3DownloadBytes"};case"s3UploadBytes":return{text:Translations.s3UploadBytes,textLC:TranslationsLowercase.s3UploadBytes,value:"s3UploadBytes"};case"rdsConnections":return{text:Translations.rdsConnections,textLC:TranslationsLowercase.rdsConnections,value:"rdsConnections"};case"rdsQueriesExecuted":return{text:Translations.rdsQueriesExecuted,textLC:TranslationsLowercase.rdsQueriesExecuted,value:"rdsQueriesExecuted"};case"rdsActiveTransactions":return{text:Translations.rdsActiveTransactions,textLC:TranslationsLowercase.rdsActiveTransactions,value:"rdsActiveTransactions"};case"rdsLatency":return{text:Translations.rdsLatency,textLC:TranslationsLowercase.rdsLatency,value:"rdsLatency"};case"sqsMessagesVisible":return{text:Translations.sqsMessagesVisible,textLC:TranslationsLowercase.sqsMessagesVisible,value:"sqsMessagesVisible"};case"sqsMessagesDelayed":return{text:Translations.sqsMessagesDelayed,textLC:TranslationsLowercase.sqsMessagesDelayed,value:"sqsMessagesDelayed"};case"sqsMessagesSent":return{text:Translations.sqsMessagesSent,textLC:TranslationsLowercase.sqsMessagesSent,value:"sqsMessagesSent"};case"sqsMessagesEmpty":return{text:Translations.sqsMessagesEmpty,textLC:TranslationsLowercase.sqsMessagesEmpty,value:"sqsMessagesEmpty"};case"sqsOldestMessage":return{text:Translations.sqsOldestMessage,textLC:TranslationsLowercase.sqsOldestMessage,value:"sqsOldestMessage"}}}},170:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return CloudToolbarItems}));var external_kbnSharedDeps_React_=__webpack_require__(2),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),external_kbnSharedDeps_ElasticEui_=__webpack_require__(10),external_kbnSharedDeps_KbnI18n_=__webpack_require__(1),dropdown_button=__webpack_require__(127);const WaffleAccountsControls=props=>{const{accountId:accountId,options:options}=props,[isOpen,setIsOpen]=Object(external_kbnSharedDeps_React_.useState)(!1),showPopover=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setIsOpen(!0)},[setIsOpen]),closePopover=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setIsOpen(!1)},[setIsOpen]),currentLabel=options.find(o=>o.value===accountId),changeAccount=Object(external_kbnSharedDeps_React_.useCallback)(val=>{accountId===val?props.changeAccount(""):props.changeAccount(val),closePopover()},[accountId,closePopover,props]),panels=Object(external_kbnSharedDeps_React_.useMemo)(()=>[{id:0,title:"",items:options.map(o=>{const icon=o.value===accountId?"check":"empty";return{name:o.name,onClick:()=>changeAccount(o.value),icon:icon}})}],[options,accountId,changeAccount]),button=external_kbnSharedDeps_React_default.a.createElement(dropdown_button.a,{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.infra.waffle.accountLabel",{defaultMessage:"Account"}),onClick:showPopover},currentLabel?currentLabel.name:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.infra.waffle.accountAllTitle",{defaultMessage:"All"}));return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopover,{isOpen:isOpen,id:"accontPopOver",button:button,anchorPosition:"downLeft",panelPaddingSize:"none",closePopover:closePopover},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenu,{initialPanelId:0,panels:panels}))},WaffleRegionControls=props=>{const{region:region,options:options}=props,[isOpen,setIsOpen]=Object(external_kbnSharedDeps_React_.useState)(!1),showPopover=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setIsOpen(!0)},[setIsOpen]),closePopover=Object(external_kbnSharedDeps_React_.useCallback)(()=>{setIsOpen(!1)},[setIsOpen]),currentLabel=options.find(o=>region===o),changeRegion=Object(external_kbnSharedDeps_React_.useCallback)(val=>{region===val?props.changeRegion(""):props.changeRegion(val),closePopover()},[region,closePopover,props]),panels=Object(external_kbnSharedDeps_React_.useMemo)(()=>[{id:0,title:"",items:options.map(o=>({name:o,onClick:()=>changeRegion(o),icon:o===region?"check":"empty"}))}],[changeRegion,options,region]),button=external_kbnSharedDeps_React_default.a.createElement(dropdown_button.a,{onClick:showPopover,label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.infra.waffle.regionLabel",{defaultMessage:"Region"})},currentLabel||external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.infra.waffle.region",{defaultMessage:"All"}));return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopover,{isOpen:isOpen,id:"regionPanel",button:button,anchorPosition:"downLeft",panelPaddingSize:"none",closePopover:closePopover},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenu,{initialPanelId:0,panels:panels}))},CloudToolbarItems=props=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,props.accounts.length>0&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(WaffleAccountsControls,{changeAccount:props.changeAccount,accountId:props.accountId,options:props.accounts})),props.regions.length>0&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(WaffleRegionControls,{changeRegion:props.changeRegion,region:props.region,options:props.regions})))},282:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return fieldToName}));var _kbn_i18n__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1);const availabilityZoneName=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.infra.groupByDisplayNames.availabilityZone",{defaultMessage:"Availability zone"}),machineTypeName=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.infra.groupByDisplayNames.machineType",{defaultMessage:"Machine type"}),fieldToName=field=>({"kubernetes.namespace":_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.infra.groupByDisplayNames.kubernetesNamespace",{defaultMessage:"Namespace"}),"kubernetes.node.name":_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.infra.groupByDisplayNames.kubernetesNodeName",{defaultMessage:"Node"}),"host.name":_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.infra.groupByDisplayNames.hostName",{defaultMessage:"Host"}),"cloud.availability_zone":availabilityZoneName,"cloud.machine.type":machineTypeName,"cloud.project.id":_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.infra.groupByDisplayNames.projectID",{defaultMessage:"Project ID"}),"cloud.provider":_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.infra.groupByDisplayNames.provider",{defaultMessage:"Cloud provider"}),"service.type":_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.infra.groupByDisplayNames.serviceType",{defaultMessage:"Service type"}),"aws.cloud.availability_zone":availabilityZoneName,"aws.cloud.machine.type":machineTypeName,"aws.tags":_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.infra.groupByDisplayNames.tags",{defaultMessage:"Tags"}),"aws.ec2.instance.image.id":_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.infra.groupByDisplayNames.image",{defaultMessage:"Image"}),"aws.ec2.instance.state.name":_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.infra.groupByDisplayNames.state.name",{defaultMessage:"State"}),"cloud.region":_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.infra.groupByDisplayNames.cloud.region",{defaultMessage:"Region"}),"aws.rds.db_instance.class":_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.infra.groupByDisplayNames.rds.db_instance.class",{defaultMessage:"Instance Class"}),"aws.rds.db_instance.status":_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.infra.groupByDisplayNames.rds.db_instance.status",{defaultMessage:"Status"})}[field]||field)},283:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return hostMetricTypes})),__webpack_require__.d(__webpack_exports__,"a",(function(){return HostToolbarItems}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),_shared_components_metrics_and_groupby_toolbar_items__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(118);function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const hostMetricTypes=["cpu","memory","load","rx","tx","logRate"],hostGroupByFields=["cloud.availability_zone","cloud.machine.type","cloud.project.id","cloud.provider","service.type"],HostToolbarItems=props=>react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_shared_components_metrics_and_groupby_toolbar_items__WEBPACK_IMPORTED_MODULE_1__.a,_extends({},props,{metricTypes:hostMetricTypes,groupByFields:hostGroupByFields}))},284:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return containerMetricTypes})),__webpack_require__.d(__webpack_exports__,"a",(function(){return ContainerToolbarItems}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),_shared_components_metrics_and_groupby_toolbar_items__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(118);function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const containerMetricTypes=["cpu","memory","rx","tx"],containerGroupByFields=["host.name","cloud.availability_zone","cloud.machine.type","cloud.project.id","cloud.provider","service.type"],ContainerToolbarItems=props=>react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_shared_components_metrics_and_groupby_toolbar_items__WEBPACK_IMPORTED_MODULE_1__.a,_extends({},props,{metricTypes:containerMetricTypes,groupByFields:containerGroupByFields}))},285:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return podMetricTypes})),__webpack_require__.d(__webpack_exports__,"a",(function(){return PodToolbarItems}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),_shared_components_metrics_and_groupby_toolbar_items__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(118);function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const podMetricTypes=["cpu","memory","rx","tx"],podGroupByFields=["kubernetes.namespace","kubernetes.node.name","service.type"],PodToolbarItems=props=>react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_shared_components_metrics_and_groupby_toolbar_items__WEBPACK_IMPORTED_MODULE_1__.a,_extends({},props,{metricTypes:podMetricTypes,groupByFields:podGroupByFields}))},286:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return ec2MetricTypes})),__webpack_require__.d(__webpack_exports__,"a",(function(){return AwsEC2ToolbarItems}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),_shared_components_metrics_and_groupby_toolbar_items__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(118),_shared_components_cloud_toolbar_items__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(170);function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const ec2MetricTypes=["cpu","rx","tx","diskIOReadBytes","diskIOWriteBytes"],ec2groupByFields=["cloud.availability_zone","cloud.machine.type","aws.ec2.instance.image.id","aws.ec2.instance.state.name"],AwsEC2ToolbarItems=props=>react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_shared_components_cloud_toolbar_items__WEBPACK_IMPORTED_MODULE_2__.a,props),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_shared_components_metrics_and_groupby_toolbar_items__WEBPACK_IMPORTED_MODULE_1__.a,_extends({},props,{metricTypes:ec2MetricTypes,groupByFields:ec2groupByFields})))},287:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return s3MetricTypes})),__webpack_require__.d(__webpack_exports__,"a",(function(){return AwsS3ToolbarItems}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),_shared_components_metrics_and_groupby_toolbar_items__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(118),_shared_components_cloud_toolbar_items__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(170);function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const s3MetricTypes=["s3BucketSize","s3NumberOfObjects","s3TotalRequests","s3DownloadBytes","s3UploadBytes"],s3GroupByFields=["cloud.region"],AwsS3ToolbarItems=props=>react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_shared_components_cloud_toolbar_items__WEBPACK_IMPORTED_MODULE_2__.a,props),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_shared_components_metrics_and_groupby_toolbar_items__WEBPACK_IMPORTED_MODULE_1__.a,_extends({},props,{metricTypes:s3MetricTypes,groupByFields:s3GroupByFields})))},288:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return rdsMetricTypes})),__webpack_require__.d(__webpack_exports__,"a",(function(){return AwsRDSToolbarItems}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),_shared_components_metrics_and_groupby_toolbar_items__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(118),_shared_components_cloud_toolbar_items__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(170);function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const rdsMetricTypes=["cpu","rdsConnections","rdsQueriesExecuted","rdsActiveTransactions","rdsLatency"],rdsGroupByFields=["cloud.availability_zone","aws.rds.db_instance.class","aws.rds.db_instance.status"],AwsRDSToolbarItems=props=>react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_shared_components_cloud_toolbar_items__WEBPACK_IMPORTED_MODULE_2__.a,props),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_shared_components_metrics_and_groupby_toolbar_items__WEBPACK_IMPORTED_MODULE_1__.a,_extends({},props,{metricTypes:rdsMetricTypes,groupByFields:rdsGroupByFields})))},289:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return sqsMetricTypes})),__webpack_require__.d(__webpack_exports__,"a",(function(){return AwsSQSToolbarItems}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),_shared_components_metrics_and_groupby_toolbar_items__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(118),_shared_components_cloud_toolbar_items__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(170);function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const sqsMetricTypes=["sqsMessagesVisible","sqsMessagesDelayed","sqsMessagesSent","sqsMessagesEmpty","sqsOldestMessage"],sqsGroupByFields=["cloud.region"],AwsSQSToolbarItems=props=>react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_shared_components_cloud_toolbar_items__WEBPACK_IMPORTED_MODULE_2__.a,props),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_shared_components_metrics_and_groupby_toolbar_items__WEBPACK_IMPORTED_MODULE_1__.a,_extends({},props,{metricTypes:sqsMetricTypes,groupByFields:sqsGroupByFields})))},300:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return ToolbarWrapper})),__webpack_require__.d(__webpack_exports__,"b",(function(){return toGroupByOpt}));var external_kbnSharedDeps_React_=__webpack_require__(2),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),external_kbnSharedDeps_ElasticEui_=__webpack_require__(10),field_to_display_name=__webpack_require__(282),metrics_source=__webpack_require__(82),use_waffle_options=__webpack_require__(94),external_kbnSharedDeps_KbnI18n_=__webpack_require__(1),inventory_models=__webpack_require__(88),dropdown_button=__webpack_require__(127);const getDisplayNameForType=type=>Object(inventory_models.b)(type).displayName,WaffleInventorySwitcher=()=>{const{changeNodeType:changeNodeType,changeGroupBy:changeGroupBy,changeMetric:changeMetric,changeAccount:changeAccount,changeRegion:changeRegion,changeCustomMetrics:changeCustomMetrics,nodeType:nodeType}=Object(use_waffle_options.d)(),[isOpen,setIsOpen]=Object(external_kbnSharedDeps_React_.useState)(!1),closePopover=Object(external_kbnSharedDeps_React_.useCallback)(()=>setIsOpen(!1),[]),openPopover=Object(external_kbnSharedDeps_React_.useCallback)(()=>setIsOpen(!0),[]),goToNodeType=Object(external_kbnSharedDeps_React_.useCallback)(targetNodeType=>{closePopover(),changeNodeType(targetNodeType),changeGroupBy([]),changeCustomMetrics([]),changeAccount(""),changeRegion("");const inventoryModel=Object(inventory_models.b)(targetNodeType);changeMetric({type:inventoryModel.metrics.defaultSnapshot})},[closePopover,changeNodeType,changeGroupBy,changeCustomMetrics,changeAccount,changeRegion,changeMetric]),goToHost=Object(external_kbnSharedDeps_React_.useCallback)(()=>goToNodeType("host"),[goToNodeType]),goToK8=Object(external_kbnSharedDeps_React_.useCallback)(()=>goToNodeType("pod"),[goToNodeType]),goToDocker=Object(external_kbnSharedDeps_React_.useCallback)(()=>goToNodeType("container"),[goToNodeType]),goToAwsEC2=Object(external_kbnSharedDeps_React_.useCallback)(()=>goToNodeType("awsEC2"),[goToNodeType]),goToAwsS3=Object(external_kbnSharedDeps_React_.useCallback)(()=>goToNodeType("awsS3"),[goToNodeType]),goToAwsRDS=Object(external_kbnSharedDeps_React_.useCallback)(()=>goToNodeType("awsRDS"),[goToNodeType]),goToAwsSQS=Object(external_kbnSharedDeps_React_.useCallback)(()=>goToNodeType("awsSQS"),[goToNodeType]),panels=Object(external_kbnSharedDeps_React_.useMemo)(()=>[{id:"firstPanel",items:[{name:getDisplayNameForType("host"),onClick:goToHost},{name:getDisplayNameForType("pod"),onClick:goToK8},{name:getDisplayNameForType("container"),onClick:goToDocker},{name:"AWS",panel:"awsPanel"}]},{id:"awsPanel",title:"AWS",items:[{name:getDisplayNameForType("awsEC2"),onClick:goToAwsEC2},{name:getDisplayNameForType("awsS3"),onClick:goToAwsS3},{name:getDisplayNameForType("awsRDS"),onClick:goToAwsRDS},{name:getDisplayNameForType("awsSQS"),onClick:goToAwsSQS}]}],[goToAwsEC2,goToAwsRDS,goToAwsS3,goToAwsSQS,goToDocker,goToHost,goToK8]),selectedText=Object(external_kbnSharedDeps_React_.useMemo)(()=>getDisplayNameForType(nodeType),[nodeType]),button=external_kbnSharedDeps_React_default.a.createElement(dropdown_button.a,{onClick:openPopover,label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.infra.waffle.showLabel",{defaultMessage:"Show"})},selectedText);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopover,{id:"contextMenu",button:button,isOpen:isOpen,closePopover:closePopover,panelPaddingSize:"none",anchorPosition:"downLeft"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiContextMenu,{initialPanelId:"firstPanel",panels:panels}))},ToolbarWrapper=props=>{const{changeMetric:changeMetric,changeGroupBy:changeGroupBy,changeCustomOptions:changeCustomOptions,changeAccount:changeAccount,changeRegion:changeRegion,changeSort:changeSort,customOptions:customOptions,groupBy:groupBy,metric:metric,nodeType:nodeType,accountId:accountId,view:view,region:region,legend:legend,sort:sort,customMetrics:customMetrics,changeCustomMetrics:changeCustomMetrics}=Object(use_waffle_options.d)(),{createDerivedIndexPattern:createDerivedIndexPattern}=Object(metrics_source.b)();return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{responsive:!1,wrap:!0,gutterSize:"m"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(WaffleInventorySwitcher,null)),props.children({createDerivedIndexPattern:createDerivedIndexPattern,changeMetric:changeMetric,changeGroupBy:changeGroupBy,changeAccount:changeAccount,changeRegion:changeRegion,changeCustomOptions:changeCustomOptions,changeSort:changeSort,customOptions:customOptions,groupBy:groupBy,sort:sort,view:view,metric:metric,nodeType:nodeType,region:region,accountId:accountId,legend:legend,customMetrics:customMetrics,changeCustomMetrics:changeCustomMetrics}))},toGroupByOpt=field=>({text:Object(field_to_display_name.a)(field),field:field})},82:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return Source})),__webpack_require__.d(__webpack_exports__,"b",(function(){return useSourceContext}));var constate_cjs=__webpack_require__(78),constate_cjs_default=__webpack_require__.n(constate_cjs),external_kbnSharedDeps_React_=__webpack_require__(2),use_tracked_promise=__webpack_require__(79),public_=__webpack_require__(3);const pickIndexPattern=(source,type)=>source?"metrics"===type?source.configuration.metricAlias:""+source.configuration.metricAlias:"unknown-index",DEPENDENCY_ERROR_MESSAGE="Failed to load source: No fetch client available.",Source=constate_cjs_default()(({sourceId:sourceId})=>{var _kibana$services$http;const fetchService=null===(_kibana$services$http=Object(public_.useKibana)().services.http)||void 0===_kibana$services$http?void 0:_kibana$services$http.fetch,API_URL="/api/metrics/source/"+sourceId,[source,setSource]=Object(external_kbnSharedDeps_React_.useState)(void 0),[loadSourceRequest,loadSource]=Object(use_tracked_promise.c)({cancelPreviousOn:"resolution",createPromise:async()=>{if(!fetchService)throw new Error(DEPENDENCY_ERROR_MESSAGE);return await fetchService(""+API_URL,{method:"GET"})},onResolve:response=>{setSource(response.source)}},[fetchService,sourceId]),[createSourceConfigurationRequest,createSourceConfiguration]=Object(use_tracked_promise.c)({createPromise:async sourceProperties=>{if(!fetchService)throw new Error(DEPENDENCY_ERROR_MESSAGE);return await fetchService(API_URL,{method:"PATCH",body:JSON.stringify(sourceProperties)})},onResolve:response=>{response&&setSource(response.source)}},[fetchService,sourceId]),[updateSourceConfigurationRequest,updateSourceConfiguration]=Object(use_tracked_promise.c)({createPromise:async sourceProperties=>{if(!fetchService)throw new Error(DEPENDENCY_ERROR_MESSAGE);return await fetchService(API_URL,{method:"PATCH",body:JSON.stringify(sourceProperties)})},onResolve:response=>{response&&setSource(response.source)}},[fetchService,sourceId]),isLoading=Object(external_kbnSharedDeps_React_.useMemo)(()=>[loadSourceRequest.state,createSourceConfigurationRequest.state,updateSourceConfigurationRequest.state].some(state=>"pending"===state),[loadSourceRequest.state,createSourceConfigurationRequest.state,updateSourceConfigurationRequest.state]),isUninitialized=Object(external_kbnSharedDeps_React_.useMemo)(()=>"uninitialized"===loadSourceRequest.state,[loadSourceRequest.state]),sourceExists=Object(external_kbnSharedDeps_React_.useMemo)(()=>source?!!source.version:void 0,[source]),metricIndicesExist=Object(external_kbnSharedDeps_React_.useMemo)(()=>source&&source.status&&source.status.metricIndicesExist,[source]);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{loadSource()},[loadSource,sourceId]),{createSourceConfiguration:createSourceConfiguration,createDerivedIndexPattern:type=>({fields:null!=source&&source.status?source.status.indexFields:[],title:pickIndexPattern(source,type)}),isLoading:isLoading,isLoadingSource:"pending"===loadSourceRequest.state,isUninitialized:isUninitialized,hasFailedLoadingSource:"rejected"===loadSourceRequest.state,loadSource:loadSource,loadSourceFailureMessage:"rejected"===loadSourceRequest.state?""+loadSourceRequest.value:void 0,metricIndicesExist:metricIndicesExist,source:source,sourceExists:sourceExists,sourceId:sourceId,updateSourceConfiguration:updateSourceConfiguration,version:source&&source.version?source.version:void 0}}),[SourceProvider,useSourceContext]=Source},94:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return DEFAULT_LEGEND})),__webpack_require__.d(__webpack_exports__,"b",(function(){return DEFAULT_WAFFLE_OPTIONS_STATE})),__webpack_require__.d(__webpack_exports__,"c",(function(){return WaffleOptionsProvider})),__webpack_require__.d(__webpack_exports__,"d",(function(){return useWaffleOptionsContext}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2),io_ts__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(0),fp_ts_lib_pipeable__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(25),fp_ts_lib_Either__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(17),fp_ts_lib_function__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(18),constate__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(78),constate__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(constate__WEBPACK_IMPORTED_MODULE_5__),_alerting_use_alert_prefill__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(128),_lib_lib__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(32),_common_http_api_snapshot_api__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(87),_utils_use_url_state__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(99),_common_inventory_models_types__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(83);const DEFAULT_LEGEND={palette:"cool",steps:10,reverseColors:!1},DEFAULT_WAFFLE_OPTIONS_STATE={metric:{type:"cpu"},groupBy:[],nodeType:"host",view:"map",customOptions:[],boundsOverride:{max:1,min:0},autoBounds:!0,accountId:"",region:"",customMetrics:[],legend:DEFAULT_LEGEND,source:"default",sort:{by:"name",direction:"desc"}},WaffleLegendOptionsRT=io_ts__WEBPACK_IMPORTED_MODULE_1__.type({palette:_lib_lib__WEBPACK_IMPORTED_MODULE_7__.d,steps:io_ts__WEBPACK_IMPORTED_MODULE_1__.number,reverseColors:io_ts__WEBPACK_IMPORTED_MODULE_1__.boolean}),WaffleSortOptionRT=io_ts__WEBPACK_IMPORTED_MODULE_1__.type({by:io_ts__WEBPACK_IMPORTED_MODULE_1__.keyof({name:null,value:null}),direction:io_ts__WEBPACK_IMPORTED_MODULE_1__.keyof({asc:null,desc:null})}),WaffleOptionsStateRT=io_ts__WEBPACK_IMPORTED_MODULE_1__.intersection([io_ts__WEBPACK_IMPORTED_MODULE_1__.type({metric:_common_http_api_snapshot_api__WEBPACK_IMPORTED_MODULE_8__.f,groupBy:_common_http_api_snapshot_api__WEBPACK_IMPORTED_MODULE_8__.e,nodeType:_common_inventory_models_types__WEBPACK_IMPORTED_MODULE_10__.c,view:io_ts__WEBPACK_IMPORTED_MODULE_1__.string,customOptions:io_ts__WEBPACK_IMPORTED_MODULE_1__.array(io_ts__WEBPACK_IMPORTED_MODULE_1__.type({text:io_ts__WEBPACK_IMPORTED_MODULE_1__.string,field:io_ts__WEBPACK_IMPORTED_MODULE_1__.string})),boundsOverride:io_ts__WEBPACK_IMPORTED_MODULE_1__.type({min:io_ts__WEBPACK_IMPORTED_MODULE_1__.number,max:io_ts__WEBPACK_IMPORTED_MODULE_1__.number}),autoBounds:io_ts__WEBPACK_IMPORTED_MODULE_1__.boolean,accountId:io_ts__WEBPACK_IMPORTED_MODULE_1__.string,region:io_ts__WEBPACK_IMPORTED_MODULE_1__.string,customMetrics:io_ts__WEBPACK_IMPORTED_MODULE_1__.array(_common_http_api_snapshot_api__WEBPACK_IMPORTED_MODULE_8__.d),sort:WaffleSortOptionRT}),io_ts__WEBPACK_IMPORTED_MODULE_1__.partial({source:io_ts__WEBPACK_IMPORTED_MODULE_1__.string,legend:WaffleLegendOptionsRT})]),encodeUrlState=state=>WaffleOptionsStateRT.encode(state),decodeUrlState=value=>{const state=Object(fp_ts_lib_pipeable__WEBPACK_IMPORTED_MODULE_2__.pipe)(WaffleOptionsStateRT.decode(value),Object(fp_ts_lib_Either__WEBPACK_IMPORTED_MODULE_3__.fold)(Object(fp_ts_lib_function__WEBPACK_IMPORTED_MODULE_4__.constant)(void 0),fp_ts_lib_function__WEBPACK_IMPORTED_MODULE_4__.identity));return state&&(state.source="url"),state},WaffleOptions=constate__WEBPACK_IMPORTED_MODULE_5___default()(()=>{const[urlState,setUrlState]=Object(_utils_use_url_state__WEBPACK_IMPORTED_MODULE_9__.b)({defaultState:DEFAULT_WAFFLE_OPTIONS_STATE,decodeUrlState:decodeUrlState,encodeUrlState:encodeUrlState,urlStateKey:"waffleOptions"}),[state,setState]=Object(react__WEBPACK_IMPORTED_MODULE_0__.useState)(urlState);Object(react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>setUrlState(state),[setUrlState,state]);const changeMetric=Object(react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(metric=>setState(previous=>({...previous,metric:metric})),[setState]),changeGroupBy=Object(react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(groupBy=>setState(previous=>({...previous,groupBy:groupBy})),[setState]),changeNodeType=Object(react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(nodeType=>setState(previous=>({...previous,nodeType:nodeType})),[setState]),changeView=Object(react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(view=>setState(previous=>({...previous,view:view})),[setState]),changeCustomOptions=Object(react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(customOptions=>setState(previous=>({...previous,customOptions:customOptions})),[setState]),changeAutoBounds=Object(react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(autoBounds=>setState(previous=>({...previous,autoBounds:autoBounds})),[setState]),changeBoundsOverride=Object(react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(boundsOverride=>setState(previous=>({...previous,boundsOverride:boundsOverride})),[setState]),changeAccount=Object(react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(accountId=>setState(previous=>({...previous,accountId:accountId})),[setState]),changeRegion=Object(react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(region=>setState(previous=>({...previous,region:region})),[setState]),changeCustomMetrics=Object(react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(customMetrics=>{setState(previous=>({...previous,customMetrics:customMetrics}))},[setState]),changeLegend=Object(react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(legend=>{setState(previous=>({...previous,legend:legend}))},[setState]),changeSort=Object(react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(sort=>{setState(previous=>({...previous,sort:sort}))},[setState]),{inventoryPrefill:inventoryPrefill}=Object(_alerting_use_alert_prefill__WEBPACK_IMPORTED_MODULE_6__.b)();return Object(react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>{const{setNodeType:setNodeType,setMetric:setMetric,setCustomMetrics:setCustomMetrics}=inventoryPrefill;setNodeType(state.nodeType),setMetric(state.metric),setCustomMetrics(state.customMetrics)},[state,inventoryPrefill]),{...DEFAULT_WAFFLE_OPTIONS_STATE,...state,changeMetric:changeMetric,changeGroupBy:changeGroupBy,changeNodeType:changeNodeType,changeView:changeView,changeCustomOptions:changeCustomOptions,changeAutoBounds:changeAutoBounds,changeBoundsOverride:changeBoundsOverride,changeAccount:changeAccount,changeRegion:changeRegion,changeCustomMetrics:changeCustomMetrics,changeLegend:changeLegend,changeSort:changeSort,setWaffleOptionsState:setState}}),[WaffleOptionsProvider,useWaffleOptionsContext]=WaffleOptions}}]);