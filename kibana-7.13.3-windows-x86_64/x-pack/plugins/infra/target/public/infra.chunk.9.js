/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.infra_bundle_jsonpfunction=window.infra_bundle_jsonpfunction||[]).push([[9],{107:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var react_1=__webpack_require__(2);exports.default=function(effect){react_1.useEffect(effect,[])}},123:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return MetricsAPISeriesRT}));var io_ts__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0),_inventory_models_types__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(83),_metrics_explorer__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(98);const MetricsAPITimerangeRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.type({field:io_ts__WEBPACK_IMPORTED_MODULE_0__.string,from:io_ts__WEBPACK_IMPORTED_MODULE_0__.number,to:io_ts__WEBPACK_IMPORTED_MODULE_0__.number,interval:io_ts__WEBPACK_IMPORTED_MODULE_0__.string}),groupByRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.union([io_ts__WEBPACK_IMPORTED_MODULE_0__.string,io_ts__WEBPACK_IMPORTED_MODULE_0__.null,io_ts__WEBPACK_IMPORTED_MODULE_0__[void 0]]),MetricsAPIMetricRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.type({id:io_ts__WEBPACK_IMPORTED_MODULE_0__.string,aggregations:_inventory_models_types__WEBPACK_IMPORTED_MODULE_1__.d}),MetricsAPIPageInfoRT=(io_ts__WEBPACK_IMPORTED_MODULE_0__.intersection([io_ts__WEBPACK_IMPORTED_MODULE_0__.type({timerange:MetricsAPITimerangeRT,indexPattern:io_ts__WEBPACK_IMPORTED_MODULE_0__.string,metrics:io_ts__WEBPACK_IMPORTED_MODULE_0__.array(MetricsAPIMetricRT)}),io_ts__WEBPACK_IMPORTED_MODULE_0__.partial({groupBy:io_ts__WEBPACK_IMPORTED_MODULE_0__.array(groupByRT),modules:io_ts__WEBPACK_IMPORTED_MODULE_0__.array(io_ts__WEBPACK_IMPORTED_MODULE_0__.string),afterKey:io_ts__WEBPACK_IMPORTED_MODULE_0__.union([io_ts__WEBPACK_IMPORTED_MODULE_0__.null,_metrics_explorer__WEBPACK_IMPORTED_MODULE_2__.b]),limit:io_ts__WEBPACK_IMPORTED_MODULE_0__.union([io_ts__WEBPACK_IMPORTED_MODULE_0__.number,io_ts__WEBPACK_IMPORTED_MODULE_0__.null,io_ts__WEBPACK_IMPORTED_MODULE_0__[void 0]]),filters:io_ts__WEBPACK_IMPORTED_MODULE_0__.array(io_ts__WEBPACK_IMPORTED_MODULE_0__.object),dropLastBucket:io_ts__WEBPACK_IMPORTED_MODULE_0__.boolean,alignDataToEnd:io_ts__WEBPACK_IMPORTED_MODULE_0__.boolean})]),io_ts__WEBPACK_IMPORTED_MODULE_0__.type({afterKey:io_ts__WEBPACK_IMPORTED_MODULE_0__.union([io_ts__WEBPACK_IMPORTED_MODULE_0__.null,_metrics_explorer__WEBPACK_IMPORTED_MODULE_2__.b,io_ts__WEBPACK_IMPORTED_MODULE_0__[void 0]]),interval:io_ts__WEBPACK_IMPORTED_MODULE_0__.number})),MetricsAPIColumnTypeRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.keyof({date:null,number:null,string:null}),MetricsAPIColumnRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.type({name:io_ts__WEBPACK_IMPORTED_MODULE_0__.string,type:MetricsAPIColumnTypeRT}),MetricsAPIRowRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.intersection([io_ts__WEBPACK_IMPORTED_MODULE_0__.type({timestamp:io_ts__WEBPACK_IMPORTED_MODULE_0__.number}),io_ts__WEBPACK_IMPORTED_MODULE_0__.record(io_ts__WEBPACK_IMPORTED_MODULE_0__.string,io_ts__WEBPACK_IMPORTED_MODULE_0__.union([io_ts__WEBPACK_IMPORTED_MODULE_0__.string,io_ts__WEBPACK_IMPORTED_MODULE_0__.number,io_ts__WEBPACK_IMPORTED_MODULE_0__.null,io_ts__WEBPACK_IMPORTED_MODULE_0__[void 0],io_ts__WEBPACK_IMPORTED_MODULE_0__.array(io_ts__WEBPACK_IMPORTED_MODULE_0__.object)]))]),MetricsAPISeriesRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.intersection([io_ts__WEBPACK_IMPORTED_MODULE_0__.type({id:io_ts__WEBPACK_IMPORTED_MODULE_0__.string,columns:io_ts__WEBPACK_IMPORTED_MODULE_0__.array(MetricsAPIColumnRT),rows:io_ts__WEBPACK_IMPORTED_MODULE_0__.array(MetricsAPIRowRT)}),io_ts__WEBPACK_IMPORTED_MODULE_0__.partial({keys:io_ts__WEBPACK_IMPORTED_MODULE_0__.array(io_ts__WEBPACK_IMPORTED_MODULE_0__.string)})]);io_ts__WEBPACK_IMPORTED_MODULE_0__.type({series:io_ts__WEBPACK_IMPORTED_MODULE_0__.array(MetricsAPISeriesRT),info:MetricsAPIPageInfoRT})},130:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"c",(function(){return logEntryContextRT})),__webpack_require__.d(__webpack_exports__,"e",(function(){return logEntryFieldRT})),__webpack_require__.d(__webpack_exports__,"f",(function(){return logEntryRT})),__webpack_require__.d(__webpack_exports__,"d",(function(){return logEntryCursorRT})),__webpack_require__.d(__webpack_exports__,"b",(function(){return logEntryBeforeCursorRT})),__webpack_require__.d(__webpack_exports__,"a",(function(){return logEntryAfterCursorRT}));var lib=__webpack_require__(0),typed_json=__webpack_require__(136);__webpack_require__(15);const logEntryCursorRT=lib.type({time:lib.number,tiebreaker:lib.number}),logEntryBeforeCursorRT=lib.type({before:lib.union([logEntryCursorRT,lib.literal("last")])}),logEntryAfterCursorRT=lib.type({after:lib.union([logEntryCursorRT,lib.literal("first")])}),logMessageConstantPartRT=(lib.type({center:logEntryCursorRT}),lib.type({constant:lib.string})),logMessageFieldPartRT=lib.type({field:lib.string,value:typed_json.a,highlights:lib.array(lib.string)}),logMessagePartRT=lib.union([logMessageConstantPartRT,logMessageFieldPartRT]),logTimestampColumnRT=lib.type({columnId:lib.string,timestamp:lib.number}),logFieldColumnRT=lib.type({columnId:lib.string,field:lib.string,value:typed_json.a,highlights:lib.array(lib.string)}),logMessageColumnRT=lib.type({columnId:lib.string,message:lib.array(logMessagePartRT)}),logColumnRT=lib.union([logTimestampColumnRT,logFieldColumnRT,logMessageColumnRT]),logEntryContextRT=lib.union([lib.type({}),lib.type({"container.id":lib.string}),lib.type({"host.name":lib.string,"log.file.path":lib.string})]),logEntryFieldRT=lib.type({field:lib.string,value:typed_json.a}),logEntryRT=lib.type({id:lib.string,index:lib.string,cursor:logEntryCursorRT,columns:lib.array(logColumnRT),context:logEntryContextRT})},136:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"c",(function(){return jsonScalarRT})),__webpack_require__.d(__webpack_exports__,"a",(function(){return jsonArrayRT})),__webpack_require__.d(__webpack_exports__,"b",(function(){return jsonObjectRT}));var io_ts__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0);__webpack_require__(64);const jsonScalarRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.union([io_ts__WEBPACK_IMPORTED_MODULE_0__.null,io_ts__WEBPACK_IMPORTED_MODULE_0__.boolean,io_ts__WEBPACK_IMPORTED_MODULE_0__.number,io_ts__WEBPACK_IMPORTED_MODULE_0__.string]),jsonValueRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.recursion("JsonValue",()=>io_ts__WEBPACK_IMPORTED_MODULE_0__.union([jsonScalarRT,jsonArrayRT,jsonObjectRT])),jsonArrayRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.recursion("JsonArray",()=>io_ts__WEBPACK_IMPORTED_MODULE_0__.array(jsonValueRT)),jsonObjectRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.recursion("JsonObject",()=>io_ts__WEBPACK_IMPORTED_MODULE_0__.record(io_ts__WEBPACK_IMPORTED_MODULE_0__.string,jsonValueRT))},139:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"i",(function(){return tooltipProps})),__webpack_require__.d(__webpack_exports__,"d",(function(){return NUM_BUCKETS})),__webpack_require__.d(__webpack_exports__,"f",(function(){return TIME_LABELS})),__webpack_require__.d(__webpack_exports__,"j",(function(){return useDateFormatter})),__webpack_require__.d(__webpack_exports__,"k",(function(){return yAxisFormatter})),__webpack_require__.d(__webpack_exports__,"h",(function(){return getDomain})),__webpack_require__.d(__webpack_exports__,"g",(function(){return getChartTheme})),__webpack_require__.d(__webpack_exports__,"a",(function(){return ChartContainer})),__webpack_require__.d(__webpack_exports__,"e",(function(){return NoDataState})),__webpack_require__.d(__webpack_exports__,"c",(function(){return LoadingState})),__webpack_require__.d(__webpack_exports__,"b",(function(){return ErrorState}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),_elastic_charts__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(61),lodash__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(24),moment__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(50),moment__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_3__),_kbn_i18n__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(1),_elastic_eui__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(10),_kbn_i18n_react__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(14),_common_formatters_number__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(9);const tooltipProps={headerFormatter:tooltipValue=>moment__WEBPACK_IMPORTED_MODULE_3___default()(tooltipValue.value).format("Y-MM-DD HH:mm:ss")},NUM_BUCKETS=20,TIME_LABELS={s:_kbn_i18n__WEBPACK_IMPORTED_MODULE_4__.i18n.translate("xpack.infra.alerts.timeLabels.seconds",{defaultMessage:"seconds"}),m:_kbn_i18n__WEBPACK_IMPORTED_MODULE_4__.i18n.translate("xpack.infra.alerts.timeLabels.minutes",{defaultMessage:"minutes"}),h:_kbn_i18n__WEBPACK_IMPORTED_MODULE_4__.i18n.translate("xpack.infra.alerts.timeLabels.hours",{defaultMessage:"hours"}),d:_kbn_i18n__WEBPACK_IMPORTED_MODULE_4__.i18n.translate("xpack.infra.alerts.timeLabels.days",{defaultMessage:"days"})},useDateFormatter=(xMin,xMax)=>Object(react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(()=>"number"==typeof xMin&&"number"==typeof xMax?Object(_elastic_charts__WEBPACK_IMPORTED_MODULE_1__.niceTimeFormatter)([xMin,xMax]):value=>""+value,[xMin,xMax]),yAxisFormatter=_common_formatters_number__WEBPACK_IMPORTED_MODULE_7__.a,getDomain=(series,stacked=!1)=>{let min=null,max=null;const valuesByTimestamp=series.reduce((acc,serie)=>(serie.points.forEach(point=>{const valuesForTimestamp=acc[point.timestamp]||[];acc[point.timestamp]=[...valuesForTimestamp,point.value]}),acc),{});Object.values(valuesByTimestamp).forEach(results=>{const maxResult=stacked?Object(lodash__WEBPACK_IMPORTED_MODULE_2__.sum)(results):Object(lodash__WEBPACK_IMPORTED_MODULE_2__.max)(results),minResult=Object(lodash__WEBPACK_IMPORTED_MODULE_2__.min)(results);maxResult&&(!max||maxResult>max)&&(max=maxResult),minResult&&(!min||minResult<min)&&(min=minResult)});const timestampValues=Object.keys(valuesByTimestamp).map(Number),minTimestamp=Object(lodash__WEBPACK_IMPORTED_MODULE_2__.min)(timestampValues)||0,maxTimestamp=Object(lodash__WEBPACK_IMPORTED_MODULE_2__.max)(timestampValues)||0;return{yMin:min||0,yMax:max||0,xMin:minTimestamp,xMax:maxTimestamp}},getChartTheme=isDarkMode=>isDarkMode?_elastic_charts__WEBPACK_IMPORTED_MODULE_1__.DARK_THEME:_elastic_charts__WEBPACK_IMPORTED_MODULE_1__.LIGHT_THEME,EmptyContainer=({children:children})=>react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{style:{width:"100%",height:150,display:"flex",justifyContent:"center",alignItems:"center"}},children),ChartContainer=({children:children})=>react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",{style:{width:"100%",height:150}},children),NoDataState=()=>react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(EmptyContainer,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_5__.EuiText,{color:"subdued","data-test-subj":"noChartData"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_kbn_i18n_react__WEBPACK_IMPORTED_MODULE_6__.FormattedMessage,{id:"xpack.infra.alerts.charts.noDataMessage",defaultMessage:"No chart data available"}))),LoadingState=()=>react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(EmptyContainer,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_5__.EuiText,{color:"subdued","data-test-subj":"loadingData"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_kbn_i18n_react__WEBPACK_IMPORTED_MODULE_6__.FormattedMessage,{id:"xpack.infra.alerts.charts.loadingMessage",defaultMessage:"Loading"}))),ErrorState=()=>react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(EmptyContainer,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_5__.EuiText,{color:"subdued","data-test-subj":"chartErrorState"},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_kbn_i18n_react__WEBPACK_IMPORTED_MODULE_6__.FormattedMessage,{id:"xpack.infra.alerts.charts.errorMessage",defaultMessage:"Uh oh, something went wrong"})))},562:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"ExpressionEditor",(function(){return ExpressionEditor})),__webpack_require__.d(__webpack_exports__,"SourceStatusWrapper",(function(){return SourceStatusWrapper})),__webpack_require__.d(__webpack_exports__,"Editor",(function(){return Editor})),__webpack_require__.d(__webpack_exports__,"ExpressionLike",(function(){return ExpressionLike}));var external_kbnSharedDeps_ElasticEui_=__webpack_require__(10),external_kbnSharedDeps_KbnI18n_=__webpack_require__(1),external_kbnSharedDeps_React_=__webpack_require__(2),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),useMount=__webpack_require__(97),useMount_default=__webpack_require__.n(useMount),public_=__webpack_require__(3),triggersActionsUi_public_=__webpack_require__(68),types=__webpack_require__(6),runtime_types=__webpack_require__(15),log_source=__webpack_require__(84),source_id=__webpack_require__(172);const GroupBySelector=({onChange:onChange,fields:fields,selectedGroups:selectedGroups=[],label:label,placeholder:placeholder})=>{const handleChange=Object(external_kbnSharedDeps_React_.useCallback)(selectedOptions=>{const groupBy=selectedOptions.map(option=>option.label);onChange(groupBy)},[onChange]),formattedSelectedGroups=Object(external_kbnSharedDeps_React_.useMemo)(()=>selectedGroups.map(group=>({label:group})),[selectedGroups]),options=Object(external_kbnSharedDeps_React_.useMemo)(()=>fields.filter(field=>field.aggregatable).map(field=>({label:field.name})),[fields]);return external_kbnSharedDeps_React_default.a.createElement("div",{style:{minWidth:"300px"}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiComboBox,{placeholder:placeholder,"aria-label":label,fullWidth:!0,singleSelection:!1,selectedOptions:formattedSelectedGroups,options:options,onChange:handleChange,isClearable:!0}))},DEFAULT_GROUP_BY_LABEL=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.infra.alerting.alertFlyout.groupByLabel",{defaultMessage:"Group By"}),EVERYTHING_PLACEHOLDER=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.infra.alerting.alertFlyout.groupBy.placeholder",{defaultMessage:"Nothing (ungrouped)"}),GroupByExpression=({selectedGroups:selectedGroups=[],fields:fields,label:label,onChange:onChange})=>{const[isPopoverOpen,setIsPopoverOpen]=Object(external_kbnSharedDeps_React_.useState)(!1),expressionValue=Object(external_kbnSharedDeps_React_.useMemo)(()=>selectedGroups.length>0?selectedGroups.join(", "):EVERYTHING_PLACEHOLDER,[selectedGroups]),labelProp=null!=label?label:DEFAULT_GROUP_BY_LABEL;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopover,{id:"groupByExpression",button:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiExpression,{description:labelProp,uppercase:!0,value:expressionValue,isActive:isPopoverOpen,onClick:()=>setIsPopoverOpen(!0)}),isOpen:isPopoverOpen,closePopover:()=>setIsPopoverOpen(!1),ownFocus:!0,panelPaddingSize:"s",anchorPosition:"downLeft"},external_kbnSharedDeps_React_default.a.createElement("div",{style:{zIndex:11e3}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopoverTitle,null,labelProp),external_kbnSharedDeps_React_default.a.createElement(GroupBySelector,{selectedGroups:selectedGroups,onChange:onChange,fields:fields,label:labelProp,placeholder:EVERYTHING_PLACEHOLDER})))))};var validation=__webpack_require__(44),external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(14),external_kbnSharedDeps_Lodash_=__webpack_require__(24);const firstCriterionFieldPrefix=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.infra.logs.alertFlyout.firstCriterionFieldPrefix",{defaultMessage:"with"}),successiveCriterionFieldPrefix=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.infra.logs.alertFlyout.successiveCriterionFieldPrefix",{defaultMessage:"and"}),criterionFieldTitle=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.infra.logs.alertFlyout.criterionFieldTitle",{defaultMessage:"Field"}),criterionComparatorValueTitle=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.infra.logs.alertFlyout.criterionComparatorValueTitle",{defaultMessage:"Comparison : Value"}),getCompatibleComparatorsForField=fieldInfo=>"number"===(null==fieldInfo?void 0:fieldInfo.type)?[{value:types.a.GT,text:types.b[types.a.GT]},{value:types.a.GT_OR_EQ,text:types.b[types.a.GT_OR_EQ]},{value:types.a.LT,text:types.b[types.a.LT]},{value:types.a.LT_OR_EQ,text:types.b[types.a.LT_OR_EQ]},{value:types.a.EQ,text:types.b[types.a.EQ+":number"]},{value:types.a.NOT_EQ,text:types.b[types.a.NOT_EQ+":number"]}]:null!=fieldInfo&&fieldInfo.aggregatable?[{value:types.a.EQ,text:types.b[types.a.EQ]},{value:types.a.NOT_EQ,text:types.b[types.a.NOT_EQ]}]:[{value:types.a.MATCH,text:types.b[types.a.MATCH]},{value:types.a.NOT_MATCH,text:types.b[types.a.NOT_MATCH]},{value:types.a.MATCH_PHRASE,text:types.b[types.a.MATCH_PHRASE]},{value:types.a.NOT_MATCH_PHRASE,text:types.b[types.a.NOT_MATCH_PHRASE]}],getFieldInfo=(fields,fieldName)=>fields.find(field=>field.name===fieldName),Criterion=({idx:idx,fields:fields,criterion:criterion,updateCriterion:updateCriterion,removeCriterion:removeCriterion,canDelete:canDelete,errors:errors})=>{var _criterion$field,_criterion$field2,_ref,_ComparatorToi18nMap$;const[isFieldPopoverOpen,setIsFieldPopoverOpen]=Object(external_kbnSharedDeps_React_.useState)(!1),[isComparatorPopoverOpen,setIsComparatorPopoverOpen]=Object(external_kbnSharedDeps_React_.useState)(!1),fieldOptions=Object(external_kbnSharedDeps_React_.useMemo)(()=>fields.map(field=>({value:field.name,text:field.name})),[fields]),fieldInfo=Object(external_kbnSharedDeps_React_.useMemo)(()=>criterion.field?getFieldInfo(fields,criterion.field):void 0,[fields,criterion]),compatibleComparatorOptions=Object(external_kbnSharedDeps_React_.useMemo)(()=>getCompatibleComparatorsForField(fieldInfo),[fieldInfo]),handleFieldChange=Object(external_kbnSharedDeps_React_.useCallback)(e=>{const fieldName=e.target.value,nextFieldInfo=getFieldInfo(fields,fieldName);if((null==fieldInfo?void 0:fieldInfo.type)!==(null==nextFieldInfo?void 0:nextFieldInfo.type)||(null==fieldInfo?void 0:fieldInfo.aggregatable)!==(null==nextFieldInfo?void 0:nextFieldInfo.aggregatable)){const compatibleComparators=getCompatibleComparatorsForField(nextFieldInfo);updateCriterion(idx,{field:fieldName,comparator:compatibleComparators[0].value,value:void 0})}else updateCriterion(idx,{field:fieldName})},[fieldInfo,fields,idx,updateCriterion]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopover,{id:"criterion-field",button:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiExpression,{description:0===idx?firstCriterionFieldPrefix:successiveCriterionFieldPrefix,uppercase:!0,value:null!==(_criterion$field=criterion.field)&&void 0!==_criterion$field?_criterion$field:"a chosen field",isActive:isFieldPopoverOpen,color:0===errors.field.length?"secondary":"danger",onClick:e=>{e.stopPropagation(),setIsFieldPopoverOpen(!0)}}),isOpen:isFieldPopoverOpen,closePopover:()=>setIsFieldPopoverOpen(!1),ownFocus:!0,panelPaddingSize:"s",anchorPosition:"downLeft"},external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopoverTitle,null,criterionFieldTitle),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{isInvalid:errors.field.length>0,error:errors.field},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSelect,{compressed:!0,hasNoInitialSelection:null==criterion.field,value:null!==(_criterion$field2=criterion.field)&&void 0!==_criterion$field2?_criterion$field2:"",onChange:handleFieldChange,options:fieldOptions}))))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopover,{id:"criterion-comparator-value",button:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiExpression,{description:criterion.comparator&&null!==(_ref=null!==(_ComparatorToi18nMap$=types.b[`${criterion.comparator}:${null==fieldInfo?void 0:fieldInfo.type}`])&&void 0!==_ComparatorToi18nMap$?_ComparatorToi18nMap$:types.b[criterion.comparator])&&void 0!==_ref?_ref:"",uppercase:!0,value:criterion.value,isActive:isComparatorPopoverOpen,color:0===errors.comparator.length&&0===errors.value.length?"secondary":"danger",onClick:e=>{e.stopPropagation(),setIsComparatorPopoverOpen(!0)}}),isOpen:isComparatorPopoverOpen,closePopover:()=>setIsComparatorPopoverOpen(!1),ownFocus:!0,panelPaddingSize:"s",anchorPosition:"downLeft"},external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopoverTitle,null,criterionComparatorValueTitle),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"l"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{isInvalid:errors.comparator.length>0,error:errors.comparator},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSelect,{compressed:!0,hasNoInitialSelection:null==criterion.comparator,value:criterion.comparator,onChange:e=>updateCriterion(idx,{comparator:e.target.value}),options:compatibleComparatorOptions}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{isInvalid:errors.value.length>0,error:errors.value},"number"===(null==fieldInfo?void 0:fieldInfo.type)?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldNumber,{compressed:!0,value:criterion.value,onChange:e=>{const number=parseFloat(e.target.value);updateCriterion(idx,{value:Object(external_kbnSharedDeps_Lodash_.isNumber)(number)&&Object(external_kbnSharedDeps_Lodash_.isFinite)(number)?number:void 0})}}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldText,{compressed:!0,value:criterion.value,onChange:e=>updateCriterion(idx,{value:e.target.value})}))))))))),canDelete&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonIcon,{"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.infra.logs.alertFlyout.removeCondition",{defaultMessage:"Remove condition"}),color:"danger",iconType:"trash",onClick:e=>{e.stopPropagation(),removeCriterion(idx)}})))};var useDebounce=__webpack_require__(224),useDebounce_default=__webpack_require__.n(useDebounce),external_kbnSharedDeps_ElasticCharts_=__webpack_require__(61),criterion_preview_chart=__webpack_require__(139),color_palette=__webpack_require__(86),log_alerts=__webpack_require__(215),use_tracked_promise=__webpack_require__(79),http_api=__webpack_require__(89);const callGetChartPreviewDataAPI=async(sourceId,fetch,alertParams,buckets)=>{const response=await fetch(http_api.a,{method:"POST",body:JSON.stringify(http_api.l.encode({data:{sourceId:sourceId,alertParams:alertParams,buckets:buckets}}))});return Object(runtime_types.b)(http_api.m)(response)},CriterionPreview=({alertParams:alertParams,chartCriterion:chartCriterion,sourceId:sourceId,showThreshold:showThreshold})=>{const chartAlertParams=Object(external_kbnSharedDeps_React_.useMemo)(()=>{const{field:field,comparator:comparator,value:value}=chartCriterion,params={criteria:field&&comparator&&value?[{field:field,comparator:comparator,value:value}]:[],timeSize:alertParams.timeSize,timeUnit:alertParams.timeUnit,groupBy:alertParams.groupBy};try{return Object(runtime_types.b)(log_alerts.b)(params)}catch(error){return null}},[alertParams.timeSize,alertParams.timeUnit,alertParams.groupBy,chartCriterion]);return null===chartAlertParams||0===chartAlertParams.criteria.length?null:external_kbnSharedDeps_React_default.a.createElement(CriterionPreviewChart,{buckets:chartAlertParams.groupBy&&0!==chartAlertParams.groupBy.length?criterion_preview_chart.d/4:criterion_preview_chart.d,sourceId:sourceId,threshold:alertParams.count,chartAlertParams:chartAlertParams,showThreshold:showThreshold})},CriterionPreviewChart=({buckets:buckets,sourceId:sourceId,threshold:threshold,chartAlertParams:chartAlertParams,showThreshold:showThreshold})=>{const{uiSettings:uiSettings}=Object(public_.useKibana)().services,isDarkMode=(null==uiSettings?void 0:uiSettings.get("theme:darkMode"))||!1,{getChartPreviewData:getChartPreviewData,isLoading:isLoading,hasError:hasError,chartPreviewData:series}=(({sourceId:sourceId,alertParams:alertParams,buckets:buckets})=>{const{http:http}=Object(public_.useKibana)().services,[chartPreviewData,setChartPreviewData]=Object(external_kbnSharedDeps_React_.useState)([]),[hasError,setHasError]=Object(external_kbnSharedDeps_React_.useState)(!1),[getChartPreviewDataRequest,getChartPreviewData]=Object(use_tracked_promise.c)({cancelPreviousOn:"creation",createPromise:async()=>(setHasError(!1),await callGetChartPreviewDataAPI(sourceId,http.fetch,alertParams,buckets)),onResolve:({data:{series:series}})=>{setHasError(!1),setChartPreviewData(series)},onReject:error=>{setHasError(!0)}},[sourceId,http,alertParams,buckets]);return{chartPreviewData:chartPreviewData,hasError:hasError,isLoading:Object(external_kbnSharedDeps_React_.useMemo)(()=>"pending"===getChartPreviewDataRequest.state,[getChartPreviewDataRequest.state]),getChartPreviewData:getChartPreviewData}})({sourceId:sourceId,alertParams:chartAlertParams,buckets:buckets});useDebounce_default()(()=>{getChartPreviewData()},500,[getChartPreviewData]);const{timeSize:timeSize,timeUnit:timeUnit,groupBy:groupBy}=chartAlertParams,isGrouped=!!(groupBy&&groupBy.length>0),isAbove=!!(showThreshold&&threshold&&threshold.comparator)&&[types.a.GT,types.a.GT_OR_EQ].includes(threshold.comparator),isBelow=!!(showThreshold&&threshold&&threshold.comparator)&&[types.a.LT,types.a.LT_OR_EQ].includes(threshold.comparator),filteredSeries=Object(external_kbnSharedDeps_React_.useMemo)(()=>{if(!isGrouped)return series;const sortedByMax=series.sort((a,b)=>{const aMax=Math.max(...a.points.map(point=>point.value));return Math.max(...b.points.map(point=>point.value))-aMax});return(!isAbove&&!isBelow||isAbove?sortedByMax:sortedByMax.reverse()).slice(0,5)},[series,isGrouped,isAbove,isBelow]),barSeries=Object(external_kbnSharedDeps_React_.useMemo)(()=>filteredSeries.reduce((acc,serie)=>[...acc,...serie.points.reduce((pointAcc,point)=>[...pointAcc,{...point,groupBy:serie.id}],[])],[]),[filteredSeries]),lookback=timeSize*buckets,hasData=series.length>0,{yMin:yMin,yMax:yMax,xMin:xMin,xMax:xMax}=Object(criterion_preview_chart.h)(filteredSeries,!1),chartDomain={max:showThreshold&&threshold&&threshold.value?1.1*Math.max(yMax,threshold.value):1.1*yMax,min:showThreshold&&threshold&&threshold.value?Math.min(yMin,threshold.value):yMin};showThreshold&&threshold&&threshold.value&&chartDomain.min===threshold.value&&(chartDomain.min=.9*chartDomain.min);const groupByLabel=groupBy&&groupBy.length>0?groupBy.join(", "):null,dateFormatter=Object(criterion_preview_chart.j)(xMin,xMax),timeLabel=criterion_preview_chart.f[timeUnit];return isLoading?external_kbnSharedDeps_React_default.a.createElement(criterion_preview_chart.c,null):hasError?external_kbnSharedDeps_React_default.a.createElement(criterion_preview_chart.b,null):hasData?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(criterion_preview_chart.a,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_.Chart,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_.BarSeries,{id:"criterion-preview",xScaleType:external_kbnSharedDeps_ElasticCharts_.ScaleType.Linear,yScaleType:external_kbnSharedDeps_ElasticCharts_.ScaleType.Linear,xAccessor:"timestamp",yAccessors:["value"],splitSeriesAccessors:["groupBy"],stackAccessors:void 0,data:barSeries,barSeriesStyle:{rectBorder:{stroke:isGrouped?void 0:Object(color_palette.b)(color_palette.a.color0),strokeWidth:1,visible:!0},rect:{opacity:1}},color:isGrouped?void 0:Object(color_palette.b)(color_palette.a.color0)}),showThreshold&&threshold&&threshold.value?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_.LineAnnotation,{id:"threshold-line",domainType:external_kbnSharedDeps_ElasticCharts_.AnnotationDomainType.YDomain,dataValues:[{dataValue:threshold.value}],style:{line:{strokeWidth:2,stroke:Object(color_palette.b)(color_palette.a.color1),opacity:1}}}):null,showThreshold&&threshold&&threshold.value&&isBelow?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_.RectAnnotation,{id:"below-threshold",style:{fill:Object(color_palette.b)(color_palette.a.color1),opacity:.3},dataValues:[{coordinates:{x0:xMin,x1:xMax,y0:chartDomain.min,y1:threshold.value}}]}):null,showThreshold&&threshold&&threshold.value&&isAbove?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_.RectAnnotation,{id:"above-threshold",style:{fill:Object(color_palette.b)(color_palette.a.color1),opacity:.3},dataValues:[{coordinates:{x0:xMin,x1:xMax,y0:threshold.value,y1:chartDomain.max}}]}):null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_.Axis,{id:"timestamp",position:external_kbnSharedDeps_ElasticCharts_.Position.Bottom,showOverlappingTicks:!0,tickFormat:dateFormatter}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_.Axis,{id:"values",position:external_kbnSharedDeps_ElasticCharts_.Position.Left,tickFormat:criterion_preview_chart.k,domain:chartDomain}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticCharts_.Settings,{tooltip:criterion_preview_chart.i,theme:Object(criterion_preview_chart.g)(isDarkMode)}))),external_kbnSharedDeps_React_default.a.createElement("div",{style:{textAlign:"center"}},null!=groupByLabel?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs",color:"subdued"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.infra.logs.alerts.dataTimeRangeLabelWithGrouping",defaultMessage:"Last {lookback} {timeLabel} of data, grouped by {groupByLabel} (showing {displayedGroups}/{totalGroups} groups)",values:{groupByLabel:groupByLabel,timeLabel:timeLabel,lookback:lookback,displayedGroups:filteredSeries.length,totalGroups:series.length}})):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiText,{size:"xs",color:"subdued"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.infra.logs.alerts.dataTimeRangeLabel",defaultMessage:"Last {lookback} {timeLabel} of data",values:{timeLabel:timeLabel,lookback:lookback}})))):external_kbnSharedDeps_React_default.a.createElement(criterion_preview_chart.e,null)};function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const QueryAText=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.infra.logs.alerting.threshold.ratioCriteriaQueryAText",{defaultMessage:"Query A"}),QueryBText=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.infra.logs.alerting.threshold.ratioCriteriaQueryBText",{defaultMessage:"Query B"}),Criteria=props=>{const{criteria:criteria,errors:errors}=props;return criteria&&0!==criteria.length?Object(types.h)(criteria)?external_kbnSharedDeps_React_default.a.createElement(RatioCriteria,_extends({},props,{criteria:criteria,errors:errors})):external_kbnSharedDeps_React_default.a.createElement(CountCriteria,_extends({},props,{criteria:criteria,errors:errors})):null},CriteriaWrapper=props=>{const{updateCriterion:updateCriterion,removeCriterion:removeCriterion,addCriterion:addCriterion,criteria:criteria,fields:fields,errors:errors,alertParams:alertParams,sourceId:sourceId,isRatio:isRatio=!1}=props;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!0},criteria.map((criterion,idx)=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiAccordion,{id:"criterion-"+idx,buttonContent:external_kbnSharedDeps_React_default.a.createElement(Criterion,{idx:idx,fields:fields,criterion:criterion,updateCriterion:updateCriterion,removeCriterion:removeCriterion,canDelete:criteria.length>1,errors:errors[idx]}),key:idx,arrowDisplay:"right"},external_kbnSharedDeps_React_default.a.createElement(CriterionPreview,{alertParams:alertParams,chartCriterion:criterion,sourceId:sourceId,showThreshold:!isRatio}))),external_kbnSharedDeps_React_default.a.createElement(AddCriterionButton,{addCriterion:addCriterion})))},RatioCriteria=props=>{const{criteria:criteria,defaultCriterion:defaultCriterion,errors:errors,updateCriteria:updateCriteria}=props,handleUpdateNumeratorCriteria=Object(external_kbnSharedDeps_React_.useCallback)(criteriaParam=>{const nextCriteria=[criteriaParam,Object(types.e)(criteria)];updateCriteria(nextCriteria)},[updateCriteria,criteria]),handleUpdateDenominatorCriteria=Object(external_kbnSharedDeps_React_.useCallback)(criteriaParam=>{const nextCriteria=[Object(types.f)(criteria),criteriaParam];updateCriteria(nextCriteria)},[updateCriteria,criteria]),{updateCriterion:updateNumeratorCriterion,addCriterion:addNumeratorCriterion,removeCriterion:removeNumeratorCriterion}=useCriteriaState(Object(types.f)(criteria),defaultCriterion,handleUpdateNumeratorCriteria),{updateCriterion:updateDenominatorCriterion,addCriterion:addDenominatorCriterion,removeCriterion:removeDenominatorCriterion}=useCriteriaState(Object(types.e)(criteria),defaultCriterion,handleUpdateDenominatorCriteria);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"xxl"}),external_kbnSharedDeps_React_default.a.createElement(ExpressionLike,{text:QueryAText}),external_kbnSharedDeps_React_default.a.createElement(CriteriaWrapper,_extends({},props,{criteria:Object(types.f)(criteria),updateCriterion:updateNumeratorCriterion,addCriterion:addNumeratorCriterion,removeCriterion:removeNumeratorCriterion,errors:errors[0],isRatio:!0})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(ExpressionLike,{text:QueryBText}),external_kbnSharedDeps_React_default.a.createElement(CriteriaWrapper,_extends({},props,{criteria:Object(types.e)(criteria),updateCriterion:updateDenominatorCriterion,addCriterion:addDenominatorCriterion,removeCriterion:removeDenominatorCriterion,errors:errors[1],isRatio:!0})))},CountCriteria=props=>{const{criteria:criteria,defaultCriterion:defaultCriterion,updateCriteria:updateCriteria,errors:errors}=props,{updateCriterion:updateCriterion,addCriterion:addCriterion,removeCriterion:removeCriterion}=useCriteriaState(criteria,defaultCriterion,updateCriteria);return external_kbnSharedDeps_React_default.a.createElement(CriteriaWrapper,_extends({},props,{updateCriterion:updateCriterion,addCriterion:addCriterion,removeCriterion:removeCriterion,errors:errors[0]}))},useCriteriaState=(criteria,defaultCriterion,onUpdateCriteria)=>({updateCriterion:Object(external_kbnSharedDeps_React_.useCallback)((idx,criterionParams)=>{const nextCriteria=criteria.map((criterion,index)=>idx===index?{...criterion,...criterionParams}:criterion);onUpdateCriteria(nextCriteria)},[criteria,onUpdateCriteria]),addCriterion:Object(external_kbnSharedDeps_React_.useCallback)(()=>{const nextCriteria=[...criteria,defaultCriterion];onUpdateCriteria(nextCriteria)},[criteria,defaultCriterion,onUpdateCriteria]),removeCriterion:Object(external_kbnSharedDeps_React_.useCallback)(idx=>{const nextCriteria=criteria.filter((_criterion,index)=>index!==idx);onUpdateCriteria(nextCriteria)},[criteria,onUpdateCriteria])}),AddCriterionButton=({addCriterion:addCriterion})=>external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{color:"primary",iconSide:"left",flush:"left",iconType:"plusInCircleFilled",onClick:addCriterion},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.infra.logs.alertFlyout.addCondition",defaultMessage:"Add condition"}))),thresholdPrefix=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.infra.logs.alertFlyout.thresholdPrefix",{defaultMessage:"is"}),popoverTitle=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.infra.logs.alertFlyout.thresholdPopoverTitle",{defaultMessage:"Threshold"}),Threshold=({comparator:comparator,value:value,updateThreshold:updateThreshold,errors:errors})=>{const[isThresholdPopoverOpen,setThresholdPopoverOpenState]=Object(external_kbnSharedDeps_React_.useState)(!1);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopover,{id:"threshold",button:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiExpression,{description:thresholdPrefix,uppercase:!0,value:`${comparator?types.b[comparator]:""} ${value||""}`,isActive:isThresholdPopoverOpen,onClick:()=>setThresholdPopoverOpenState(!0)}),isOpen:isThresholdPopoverOpen,closePopover:()=>setThresholdPopoverOpenState(!1),ownFocus:!0,panelPaddingSize:"s",anchorPosition:"downLeft"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopoverTitle,null,popoverTitle),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSelect,{compressed:!0,value:comparator,onChange:e=>updateThreshold({comparator:e.target.value}),options:[{value:types.a.LT,text:types.b[types.a.LT]},{value:types.a.LT_OR_EQ,text:types.b[types.a.LT_OR_EQ]},{value:types.a.GT,text:types.b[types.a.GT]},{value:types.a.GT_OR_EQ,text:types.b[types.a.GT_OR_EQ]}]}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{isInvalid:errors.value.length>0,error:errors.value},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldNumber,{compressed:!0,value:value,onChange:e=>{const number=parseFloat(e.target.value);updateThreshold({value:Object(external_kbnSharedDeps_Lodash_.isNumber)(number)&&Object(external_kbnSharedDeps_Lodash_.isFinite)(number)?number:void 0})}}))))))))},typePrefix=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.infra.logs.alertFlyout.thresholdTypePrefix",{defaultMessage:"when the"}),countSuffix=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.infra.logs.alertFlyout.thresholdTypeCountSuffix",{defaultMessage:"of log entries"}),ratioSuffix=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.infra.logs.alertFlyout.thresholdTypeRatioSuffix",{defaultMessage:"of Query A to Query B"}),countI18n=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.infra.logs.alertFlyout.thresholdTypeCount",{defaultMessage:"count"}),ratioI18n=external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.infra.logs.alertFlyout.thresholdTypeRatio",{defaultMessage:"ratio"}),TypeSwitcher=({criteria:criteria,updateType:updateType})=>{const[isThresholdTypePopoverOpen,setThresholdTypePopoverOpenState]=Object(external_kbnSharedDeps_React_.useState)(!1),thresholdType=(criteria=>Object(types.h)(criteria)?"ratio":"count")(criteria);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiPopover,{id:"thresholdType",button:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiExpression,{description:typePrefix,uppercase:!0,value:"ratio"===thresholdType?ratioI18n:countI18n,isActive:isThresholdTypePopoverOpen,onClick:()=>setThresholdTypePopoverOpenState(!0)}),external_kbnSharedDeps_React_default.a.createElement(ExpressionLike,{text:"ratio"===thresholdType?ratioSuffix.toUpperCase():countSuffix.toUpperCase()})),isOpen:isThresholdTypePopoverOpen,closePopover:()=>setThresholdTypePopoverOpenState(!1),ownFocus:!0,panelPaddingSize:"s",anchorPosition:"downLeft"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSelect,{compressed:!0,value:thresholdType,onChange:e=>updateType("ratio"===thresholdType?"count":"ratio"),options:[{value:"ratio",text:ratioI18n},{value:"count",text:countI18n}]}))))))},DEFAULT_BASE_EXPRESSION={timeSize:5,timeUnit:"m"},createDefaultCriterion=(availableFields,value)=>availableFields.some(availableField=>"log.level"===availableField.name)?{field:"log.level",comparator:types.a.EQ,value:value}:{field:void 0,comparator:void 0,value:void 0},ExpressionEditor=props=>{var _props$metadata$isInt,_props$metadata;const isInternal=null!==(_props$metadata$isInt=null===(_props$metadata=props.metadata)||void 0===_props$metadata?void 0:_props$metadata.isInternal)&&void 0!==_props$metadata$isInt&&_props$metadata$isInt,[sourceId]=Object(source_id.b)(),{http:http}=Object(public_.useKibana)().services;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,isInternal?external_kbnSharedDeps_React_default.a.createElement(SourceStatusWrapper,props,external_kbnSharedDeps_React_default.a.createElement(Editor,props)):external_kbnSharedDeps_React_default.a.createElement(log_source.a,{sourceId:sourceId,fetch:http.fetch,indexPatternsService:props.data.indexPatterns},external_kbnSharedDeps_React_default.a.createElement(SourceStatusWrapper,props,external_kbnSharedDeps_React_default.a.createElement(Editor,props))))},SourceStatusWrapper=({children:children})=>{const{initialize:initialize,loadSource:loadSource,isLoadingSourceConfiguration:isLoadingSourceConfiguration,hasFailedLoadingSource:hasFailedLoadingSource,isUninitialized:isUninitialized}=Object(log_source.c)();return useMount_default()(()=>{initialize()}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,isLoadingSourceConfiguration||isUninitialized?external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLoadingSpinner,{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"})):hasFailedLoadingSource?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.infra.logs.alertFlyout.sourceStatusError",{defaultMessage:"Sorry, there was a problem loading field information"}),color:"danger",iconType:"alert"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{onClick:loadSource,iconType:"refresh"},external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.infra.logs.alertFlyout.sourceStatusErrorTryAgain",{defaultMessage:"Try again"}))):children)},Editor=props=>{var _alertParams$count,_alertParams$count2;const{setAlertParams:setAlertParams,alertParams:alertParams,errors:errors}=props,[hasSetDefaults,setHasSetDefaults]=Object(external_kbnSharedDeps_React_.useState)(!1),{sourceId:sourceId,resolvedSourceConfiguration:resolvedSourceConfiguration}=Object(log_source.c)(),{criteria:criteriaErrors,threshold:thresholdErrors,timeSizeUnit:timeSizeUnitErrors,timeWindowSize:timeWindowSizeErrors}=Object(external_kbnSharedDeps_React_.useMemo)(()=>Object(runtime_types.b)(validation.a)(errors),[errors]),supportedFields=Object(external_kbnSharedDeps_React_.useMemo)(()=>null!=resolvedSourceConfiguration&&resolvedSourceConfiguration.fields?resolvedSourceConfiguration.fields.filter(field=>("string"===field.type||"number"===field.type)&&field.searchable):[],[resolvedSourceConfiguration]),groupByFields=Object(external_kbnSharedDeps_React_.useMemo)(()=>null!=resolvedSourceConfiguration&&resolvedSourceConfiguration.fields?resolvedSourceConfiguration.fields.filter(field=>"string"===field.type&&field.aggregatable):[],[resolvedSourceConfiguration]),updateThreshold=Object(external_kbnSharedDeps_React_.useCallback)(thresholdParams=>{const nextThresholdParams={...alertParams.count,...thresholdParams};setAlertParams("count",nextThresholdParams)},[alertParams.count,setAlertParams]),updateCriteria=Object(external_kbnSharedDeps_React_.useCallback)(criteria=>{setAlertParams("criteria",criteria)},[setAlertParams]),updateTimeSize=Object(external_kbnSharedDeps_React_.useCallback)(ts=>{setAlertParams("timeSize",ts)},[setAlertParams]),updateTimeUnit=Object(external_kbnSharedDeps_React_.useCallback)(tu=>{types.j.is(tu)&&setAlertParams("timeUnit",tu)},[setAlertParams]),updateGroupBy=Object(external_kbnSharedDeps_React_.useCallback)(groups=>{setAlertParams("groupBy",groups)},[setAlertParams]),defaultCountAlertParams=Object(external_kbnSharedDeps_React_.useMemo)(()=>{return availableFields=supportedFields,{...DEFAULT_BASE_EXPRESSION,count:{value:75,comparator:types.a.GT},criteria:[createDefaultCriterion(availableFields,"error")]};var availableFields},[supportedFields]),updateType=Object(external_kbnSharedDeps_React_.useCallback)(type=>{const defaults="count"===type?defaultCountAlertParams:(availableFields=supportedFields,{...DEFAULT_BASE_EXPRESSION,count:{value:2,comparator:types.a.GT},criteria:[[createDefaultCriterion(availableFields,"error")],[createDefaultCriterion(availableFields,"warning")]]});var availableFields;setAlertParams("count",defaults.count),setAlertParams("criteria",defaults.criteria)},[defaultCountAlertParams,setAlertParams,supportedFields]);if(useMount_default()(()=>{const newAlertParams={...defaultCountAlertParams,...alertParams};for(const[key,value]of Object.entries(newAlertParams))setAlertParams(key,value);setHasSetDefaults(!0)}),!hasSetDefaults)return null;const criteriaComponent=alertParams.criteria?external_kbnSharedDeps_React_default.a.createElement(Criteria,{fields:supportedFields,criteria:alertParams.criteria,defaultCriterion:defaultCountAlertParams.criteria[0],errors:criteriaErrors,alertParams:alertParams,sourceId:sourceId,updateCriteria:updateCriteria}):null;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(TypeSwitcher,{criteria:alertParams.criteria||[],updateType:updateType}),alertParams.criteria&&!Object(types.h)(alertParams.criteria)&&criteriaComponent,external_kbnSharedDeps_React_default.a.createElement(Threshold,{comparator:null===(_alertParams$count=alertParams.count)||void 0===_alertParams$count?void 0:_alertParams$count.comparator,value:null===(_alertParams$count2=alertParams.count)||void 0===_alertParams$count2?void 0:_alertParams$count2.value,updateThreshold:updateThreshold,errors:thresholdErrors}),external_kbnSharedDeps_React_default.a.createElement(triggersActionsUi_public_.ForLastExpression,{timeWindowSize:alertParams.timeSize,timeWindowUnit:alertParams.timeUnit,onChangeWindowSize:updateTimeSize,onChangeWindowUnit:updateTimeUnit,errors:{timeWindowSize:timeWindowSizeErrors,timeSizeUnit:timeSizeUnitErrors}}),external_kbnSharedDeps_React_default.a.createElement(GroupByExpression,{selectedGroups:alertParams.groupBy,onChange:updateGroupBy,fields:groupByFields}),alertParams.criteria&&Object(types.h)(alertParams.criteria)&&criteriaComponent,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"}))};__webpack_exports__.default=ExpressionEditor;const ExpressionLike=({text:text})=>external_kbnSharedDeps_React_default.a.createElement("div",{className:"euiExpression euiExpression-isUppercase euiExpression--secondary"},external_kbnSharedDeps_React_default.a.createElement("span",{className:"euiExpression__description"},text))},78:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var React=__webpack_require__(2);function createUseContext(context){return function(){var value=React.useContext(context);return value}}exports.default=function(useValue){for(var _len=arguments.length,splitValues=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)splitValues[_key-1]=arguments[_key];var Context=React.createContext("_NP_"),Provider=function(props){var value=useValue(props),createMemoDeps=splitValues[0],deps=createMemoDeps&&createMemoDeps(value);var memoizedValue=Array.isArray(deps)?React.useMemo((function(){return value}),deps):value;return React.createElement(Context.Provider,{value:memoizedValue},props.children)},useContext=createUseContext(Context);useContext.Context=Context,useContext.Provider=Provider;var tuple=[];if(splitValues.length){var contexts=[],SplitProvider=function(props){for(var value=useValue(props),children=props.children,i=0;i<contexts.length;i+=1){var context=contexts[i],splitValue=splitValues[i];children=React.createElement(context.Provider,{value:splitValue(value)},children)}return children};0,tuple.push(SplitProvider);for(var i=0;i<splitValues.length;i+=1){var context=React.createContext("_NP_");contexts.push(context),tuple.push(createUseContext(context))}}else tuple.push(Provider,createUseContext(Context));for(var _i=0;_i<tuple.length;_i+=1)useContext[_i]=tuple[_i];return"function"==typeof Symbol&&Symbol.iterator&&(useContext[Symbol.iterator]=function(){return tuple[Symbol.iterator]()}),useContext}},79:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"c",(function(){return useTrackedPromise})),__webpack_require__.d(__webpack_exports__,"b",(function(){return isRejectedPromiseState})),__webpack_require__.d(__webpack_exports__,"a",(function(){return CanceledPromiseError}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2),react_use_lib_useMountedState__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(96),react_use_lib_useMountedState__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(react_use_lib_useMountedState__WEBPACK_IMPORTED_MODULE_1__);const useTrackedPromise=({createPromise:createPromise,onResolve:onResolve=noOp,onReject:onReject=noOp,cancelPreviousOn:cancelPreviousOn="never",triggerOrThrow:triggerOrThrow="whenMounted"},dependencies)=>{const isComponentMounted=react_use_lib_useMountedState__WEBPACK_IMPORTED_MODULE_1___default()(),shouldTriggerOrThrow=Object(react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(()=>{switch(triggerOrThrow){case"always":return!0;case"whenMounted":return isComponentMounted()}},[isComponentMounted,triggerOrThrow]),pendingPromises=Object(react__WEBPACK_IMPORTED_MODULE_0__.useRef)([]),[promiseState,setPromiseState]=Object(react__WEBPACK_IMPORTED_MODULE_0__.useState)({state:"uninitialized"}),execute=Object(react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(()=>(...args)=>{let rejectCancellationPromise;const cancellationPromise=new Promise((_,reject)=>{rejectCancellationPromise=reject}),previousPendingPromises=pendingPromises.current,cancelPreviousPendingPromises=()=>{previousPendingPromises.forEach(promise=>promise.cancel())},newPromise=createPromise(...args),newCancelablePromise=Promise.race([newPromise,cancellationPromise]);setPromiseState({state:"pending",promise:newCancelablePromise}),"creation"===cancelPreviousOn&&cancelPreviousPendingPromises();const newPendingPromise={cancel:()=>{rejectCancellationPromise(new CanceledPromiseError)},cancelSilently:()=>{rejectCancellationPromise(new SilentCanceledPromiseError)},promise:newCancelablePromise.then(value=>(setPromiseState(previousPromiseState=>"pending"===previousPromiseState.state&&previousPromiseState.promise===newCancelablePromise?{state:"resolved",promise:newPendingPromise.promise,value:value}:previousPromiseState),["settlement","resolution"].includes(cancelPreviousOn)&&cancelPreviousPendingPromises(),pendingPromises.current=pendingPromises.current.filter(pendingPromise=>pendingPromise.promise!==newPendingPromise.promise),onResolve&&shouldTriggerOrThrow()&&onResolve(value),value),value=>{if(value instanceof SilentCanceledPromiseError||setPromiseState(previousPromiseState=>"pending"===previousPromiseState.state&&previousPromiseState.promise===newCancelablePromise?{state:"rejected",promise:newCancelablePromise,value:value}:previousPromiseState),["settlement","rejection"].includes(cancelPreviousOn)&&cancelPreviousPendingPromises(),pendingPromises.current=pendingPromises.current.filter(pendingPromise=>pendingPromise.promise!==newPendingPromise.promise),shouldTriggerOrThrow())throw onReject&&onReject(value),value})};return pendingPromises.current=[...pendingPromises.current,newPendingPromise],newPendingPromise.promise.catch(noOp),newPendingPromise.promise},dependencies);return Object(react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>()=>{pendingPromises.current.forEach(promise=>promise.cancelSilently())},[]),[promiseState,execute]},isRejectedPromiseState=promiseState=>"rejected"===promiseState.state;class CanceledPromiseError extends Error{constructor(message){var obj,key,value;super(message),value=!0,(key="isCanceled")in(obj=this)?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,Object.setPrototypeOf(this,new.target.prototype)}}class SilentCanceledPromiseError extends CanceledPromiseError{}const noOp=()=>{}},83:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"c",(function(){return ItemTypeRT})),__webpack_require__.d(__webpack_exports__,"b",(function(){return InventoryVisTypeRT})),__webpack_require__.d(__webpack_exports__,"a",(function(){return InventoryMetricRT})),__webpack_require__.d(__webpack_exports__,"d",(function(){return MetricsUIAggregationRT})),__webpack_require__.d(__webpack_exports__,"e",(function(){return SnapshotMetricTypeKeys})),__webpack_require__.d(__webpack_exports__,"f",(function(){return SnapshotMetricTypeRT}));var io_ts__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0);const ItemTypeRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.keyof({host:null,pod:null,container:null,awsEC2:null,awsS3:null,awsSQS:null,awsRDS:null}),InventoryVisTypeRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.keyof({line:null,area:null,bar:null}),InventoryMetricRT=(io_ts__WEBPACK_IMPORTED_MODULE_0__.keyof({abbreviatedNumber:null,bits:null,bytes:null,number:null,percent:null,highPercision:null}),io_ts__WEBPACK_IMPORTED_MODULE_0__.keyof({hostSystemOverview:null,hostCpuUsage:null,hostFilesystem:null,hostK8sOverview:null,hostK8sCpuCap:null,hostK8sDiskCap:null,hostK8sMemoryCap:null,hostK8sPodCap:null,hostLoad:null,hostMemoryUsage:null,hostNetworkTraffic:null,hostDockerOverview:null,hostDockerInfo:null,hostDockerTop5ByCpu:null,hostDockerTop5ByMemory:null,podOverview:null,podCpuUsage:null,podMemoryUsage:null,podLogUsage:null,podNetworkTraffic:null,containerOverview:null,containerCpuKernel:null,containerCpuUsage:null,containerDiskIOOps:null,containerDiskIOBytes:null,containerMemory:null,containerNetworkTraffic:null,nginxHits:null,nginxRequestRate:null,nginxActiveConnections:null,nginxRequestsPerConnection:null,awsOverview:null,awsCpuUtilization:null,awsNetworkBytes:null,awsNetworkPackets:null,awsDiskioBytes:null,awsDiskioOps:null,awsEC2CpuUtilization:null,awsEC2NetworkTraffic:null,awsEC2DiskIOBytes:null,awsS3TotalRequests:null,awsS3NumberOfObjects:null,awsS3BucketSize:null,awsS3DownloadBytes:null,awsS3UploadBytes:null,awsRDSCpuTotal:null,awsRDSConnections:null,awsRDSQueriesExecuted:null,awsRDSActiveTransactions:null,awsRDSLatency:null,awsSQSMessagesVisible:null,awsSQSMessagesDelayed:null,awsSQSMessagesSent:null,awsSQSMessagesEmpty:null,awsSQSOldestMessage:null,custom:null})),TSVBMetricTypeRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.keyof({avg:null,max:null,min:null,calculation:null,cardinality:null,series_agg:null,positive_only:null,derivative:null,count:null,sum:null,cumulative_sum:null}),TSVBMetricModelCountRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.type({id:io_ts__WEBPACK_IMPORTED_MODULE_0__.string,type:io_ts__WEBPACK_IMPORTED_MODULE_0__.literal("count")}),TSVBMetricModelBasicMetricRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.intersection([io_ts__WEBPACK_IMPORTED_MODULE_0__.type({id:io_ts__WEBPACK_IMPORTED_MODULE_0__.string,type:TSVBMetricTypeRT}),io_ts__WEBPACK_IMPORTED_MODULE_0__.partial({field:io_ts__WEBPACK_IMPORTED_MODULE_0__.string})]),TSVBMetricModelVariableRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.type({field:io_ts__WEBPACK_IMPORTED_MODULE_0__.string,id:io_ts__WEBPACK_IMPORTED_MODULE_0__.string,name:io_ts__WEBPACK_IMPORTED_MODULE_0__.string}),TSVBMetricModelBucketScriptRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.type({id:io_ts__WEBPACK_IMPORTED_MODULE_0__.string,script:io_ts__WEBPACK_IMPORTED_MODULE_0__.string,type:io_ts__WEBPACK_IMPORTED_MODULE_0__.literal("calculation"),variables:io_ts__WEBPACK_IMPORTED_MODULE_0__.array(TSVBMetricModelVariableRT)}),TSVBMetricModelDerivativeRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.type({id:io_ts__WEBPACK_IMPORTED_MODULE_0__.string,field:io_ts__WEBPACK_IMPORTED_MODULE_0__.string,unit:io_ts__WEBPACK_IMPORTED_MODULE_0__.string,type:io_ts__WEBPACK_IMPORTED_MODULE_0__.literal("derivative")}),TSVBMetricModelSeriesAggRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.type({id:io_ts__WEBPACK_IMPORTED_MODULE_0__.string,function:io_ts__WEBPACK_IMPORTED_MODULE_0__.string,type:io_ts__WEBPACK_IMPORTED_MODULE_0__.literal("series_agg")}),TSVBPercentileItemRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.type({id:io_ts__WEBPACK_IMPORTED_MODULE_0__.string,value:io_ts__WEBPACK_IMPORTED_MODULE_0__.number}),TSVBMetricModePercentileAggRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.intersection([io_ts__WEBPACK_IMPORTED_MODULE_0__.type({id:io_ts__WEBPACK_IMPORTED_MODULE_0__.string,type:io_ts__WEBPACK_IMPORTED_MODULE_0__.literal("percentile"),percentiles:io_ts__WEBPACK_IMPORTED_MODULE_0__.array(TSVBPercentileItemRT)}),io_ts__WEBPACK_IMPORTED_MODULE_0__.partial({field:io_ts__WEBPACK_IMPORTED_MODULE_0__.string})]),TSVBMetricRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.union([TSVBMetricModelCountRT,TSVBMetricModelBasicMetricRT,TSVBMetricModelBucketScriptRT,TSVBMetricModelDerivativeRT,TSVBMetricModePercentileAggRT,TSVBMetricModelSeriesAggRT]),TSVBSeriesRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.intersection([io_ts__WEBPACK_IMPORTED_MODULE_0__.type({id:io_ts__WEBPACK_IMPORTED_MODULE_0__.string,metrics:io_ts__WEBPACK_IMPORTED_MODULE_0__.array(TSVBMetricRT),split_mode:io_ts__WEBPACK_IMPORTED_MODULE_0__.string}),io_ts__WEBPACK_IMPORTED_MODULE_0__.partial({terms_field:io_ts__WEBPACK_IMPORTED_MODULE_0__.string,terms_size:io_ts__WEBPACK_IMPORTED_MODULE_0__.number,terms_order_by:io_ts__WEBPACK_IMPORTED_MODULE_0__.string,filter:io_ts__WEBPACK_IMPORTED_MODULE_0__.type({query:io_ts__WEBPACK_IMPORTED_MODULE_0__.string,language:io_ts__WEBPACK_IMPORTED_MODULE_0__.keyof({lucene:null,kuery:null})})})]),ESBasicMetricAggRT=(io_ts__WEBPACK_IMPORTED_MODULE_0__.intersection([io_ts__WEBPACK_IMPORTED_MODULE_0__.type({id:InventoryMetricRT,requires:io_ts__WEBPACK_IMPORTED_MODULE_0__.array(io_ts__WEBPACK_IMPORTED_MODULE_0__.string),index_pattern:io_ts__WEBPACK_IMPORTED_MODULE_0__.union([io_ts__WEBPACK_IMPORTED_MODULE_0__.string,io_ts__WEBPACK_IMPORTED_MODULE_0__.array(io_ts__WEBPACK_IMPORTED_MODULE_0__.string)]),interval:io_ts__WEBPACK_IMPORTED_MODULE_0__.string,time_field:io_ts__WEBPACK_IMPORTED_MODULE_0__.string,type:io_ts__WEBPACK_IMPORTED_MODULE_0__.string,series:io_ts__WEBPACK_IMPORTED_MODULE_0__.array(TSVBSeriesRT)}),io_ts__WEBPACK_IMPORTED_MODULE_0__.partial({filter:io_ts__WEBPACK_IMPORTED_MODULE_0__.string,map_field_to:io_ts__WEBPACK_IMPORTED_MODULE_0__.string,id_type:io_ts__WEBPACK_IMPORTED_MODULE_0__.keyof({cloud:null,node:null}),drop_last_bucket:io_ts__WEBPACK_IMPORTED_MODULE_0__.boolean})]),io_ts__WEBPACK_IMPORTED_MODULE_0__.record(io_ts__WEBPACK_IMPORTED_MODULE_0__.string,io_ts__WEBPACK_IMPORTED_MODULE_0__.union([io_ts__WEBPACK_IMPORTED_MODULE_0__[void 0],io_ts__WEBPACK_IMPORTED_MODULE_0__.type({field:io_ts__WEBPACK_IMPORTED_MODULE_0__.string})]))),ESPercentileAggRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.type({percentiles:io_ts__WEBPACK_IMPORTED_MODULE_0__.type({field:io_ts__WEBPACK_IMPORTED_MODULE_0__.string,percents:io_ts__WEBPACK_IMPORTED_MODULE_0__.array(io_ts__WEBPACK_IMPORTED_MODULE_0__.number)})}),ESCaridnalityAggRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.type({cardinality:io_ts__WEBPACK_IMPORTED_MODULE_0__.partial({field:io_ts__WEBPACK_IMPORTED_MODULE_0__.string,script:io_ts__WEBPACK_IMPORTED_MODULE_0__.string})}),ESBucketScriptAggRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.type({bucket_script:io_ts__WEBPACK_IMPORTED_MODULE_0__.intersection([io_ts__WEBPACK_IMPORTED_MODULE_0__.type({buckets_path:io_ts__WEBPACK_IMPORTED_MODULE_0__.record(io_ts__WEBPACK_IMPORTED_MODULE_0__.string,io_ts__WEBPACK_IMPORTED_MODULE_0__.union([io_ts__WEBPACK_IMPORTED_MODULE_0__[void 0],io_ts__WEBPACK_IMPORTED_MODULE_0__.string])),script:io_ts__WEBPACK_IMPORTED_MODULE_0__.type({source:io_ts__WEBPACK_IMPORTED_MODULE_0__.string,lang:io_ts__WEBPACK_IMPORTED_MODULE_0__.keyof({painless:null,expression:null})})}),io_ts__WEBPACK_IMPORTED_MODULE_0__.partial({gap_policy:io_ts__WEBPACK_IMPORTED_MODULE_0__.keyof({skip:null,insert_zeros:null})})])}),ESCumulativeSumAggRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.type({cumulative_sum:io_ts__WEBPACK_IMPORTED_MODULE_0__.type({buckets_path:io_ts__WEBPACK_IMPORTED_MODULE_0__.string})}),ESDerivativeAggRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.type({derivative:io_ts__WEBPACK_IMPORTED_MODULE_0__.type({buckets_path:io_ts__WEBPACK_IMPORTED_MODULE_0__.string,gap_policy:io_ts__WEBPACK_IMPORTED_MODULE_0__.keyof({skip:null,insert_zeros:null}),unit:io_ts__WEBPACK_IMPORTED_MODULE_0__.string})}),ESSumBucketAggRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.type({sum_bucket:io_ts__WEBPACK_IMPORTED_MODULE_0__.type({buckets_path:io_ts__WEBPACK_IMPORTED_MODULE_0__.string})}),ESTopMetricsAggRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.type({top_metrics:io_ts__WEBPACK_IMPORTED_MODULE_0__.type({metrics:io_ts__WEBPACK_IMPORTED_MODULE_0__.union([io_ts__WEBPACK_IMPORTED_MODULE_0__.array(io_ts__WEBPACK_IMPORTED_MODULE_0__.type({field:io_ts__WEBPACK_IMPORTED_MODULE_0__.string})),io_ts__WEBPACK_IMPORTED_MODULE_0__.type({field:io_ts__WEBPACK_IMPORTED_MODULE_0__.string})])})}),ESTermsWithAggregationRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.recursion("SnapshotModelRT",()=>io_ts__WEBPACK_IMPORTED_MODULE_0__.type({terms:io_ts__WEBPACK_IMPORTED_MODULE_0__.type({field:io_ts__WEBPACK_IMPORTED_MODULE_0__.string}),aggregations:MetricsUIAggregationRT})),ESAggregationRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.union([ESBasicMetricAggRT,ESPercentileAggRT,ESBucketScriptAggRT,ESCumulativeSumAggRT,ESDerivativeAggRT,ESSumBucketAggRT,ESTermsWithAggregationRT,ESCaridnalityAggRT,ESTopMetricsAggRT]),MetricsUIAggregationRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.record(io_ts__WEBPACK_IMPORTED_MODULE_0__.string,ESAggregationRT),SnapshotMetricTypeKeys={count:null,cpu:null,load:null,memory:null,tx:null,rx:null,logRate:null,diskIOReadBytes:null,diskIOWriteBytes:null,s3TotalRequests:null,s3NumberOfObjects:null,s3BucketSize:null,s3DownloadBytes:null,s3UploadBytes:null,rdsConnections:null,rdsQueriesExecuted:null,rdsActiveTransactions:null,rdsLatency:null,sqsMessagesVisible:null,sqsMessagesDelayed:null,sqsMessagesSent:null,sqsMessagesEmpty:null,sqsOldestMessage:null,custom:null},SnapshotMetricTypeRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.keyof(SnapshotMetricTypeKeys)},84:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return useLogSource})),__webpack_require__.d(__webpack_exports__,"a",(function(){return LogSourceProvider})),__webpack_require__.d(__webpack_exports__,"c",(function(){return useLogSourceContext}));var constate_cjs=__webpack_require__(78),constate_cjs_default=__webpack_require__.n(constate_cjs),external_kbnSharedDeps_React_=__webpack_require__(2),log_sources=__webpack_require__(11),common_log_sources=__webpack_require__(5),use_tracked_promise=__webpack_require__(79),fetch_log_source_configuration=__webpack_require__(38),fetch_log_source_status=__webpack_require__(39),runtime_types=__webpack_require__(15);const useLogSource=({sourceId:sourceId,fetch:fetch,indexPatternsService:indexPatternsService})=>{const[sourceConfiguration,setSourceConfiguration]=Object(external_kbnSharedDeps_React_.useState)(void 0),[resolvedSourceConfiguration,setResolvedSourceConfiguration]=Object(external_kbnSharedDeps_React_.useState)(void 0),[sourceStatus,setSourceStatus]=Object(external_kbnSharedDeps_React_.useState)(void 0),[loadSourceConfigurationRequest,loadSourceConfiguration]=Object(use_tracked_promise.c)({cancelPreviousOn:"resolution",createPromise:async()=>(await Object(fetch_log_source_configuration.a)(sourceId,fetch)).data,onResolve:setSourceConfiguration},[sourceId,fetch,indexPatternsService]),[resolveSourceConfigurationRequest,resolveSourceConfiguration]=Object(use_tracked_promise.c)({cancelPreviousOn:"resolution",createPromise:async unresolvedSourceConfiguration=>await Object(common_log_sources.h)(unresolvedSourceConfiguration,indexPatternsService),onResolve:setResolvedSourceConfiguration},[indexPatternsService]),[updateSourceConfigurationRequest,updateSourceConfiguration]=Object(use_tracked_promise.c)({cancelPreviousOn:"resolution",createPromise:async patchedProperties=>(await(async(sourceId,patchedProperties,fetch)=>{const response=await fetch(Object(log_sources.a)(sourceId),{method:"PATCH",body:JSON.stringify(log_sources.e.encode({data:patchedProperties}))}).catch(error=>{throw new common_log_sources.c(`Failed to update log source configuration "${sourceId}": ${error}`,error)});return Object(runtime_types.b)(log_sources.f,message=>new common_log_sources.c(`Failed to decode log source configuration "${sourceId}": ${message}`))(response)})(sourceId,patchedProperties,fetch)).data,onResolve:setSourceConfiguration},[sourceId,fetch,indexPatternsService]),[loadSourceStatusRequest,loadSourceStatus]=Object(use_tracked_promise.c)({cancelPreviousOn:"resolution",createPromise:async()=>await Object(fetch_log_source_status.a)(sourceId,fetch),onResolve:({data:data})=>setSourceStatus(data)},[sourceId,fetch]),derivedIndexPattern=Object(external_kbnSharedDeps_React_.useMemo)(()=>{var _resolvedSourceConfig,_resolvedSourceConfig2;return{fields:null!==(_resolvedSourceConfig=null==resolvedSourceConfiguration?void 0:resolvedSourceConfiguration.fields)&&void 0!==_resolvedSourceConfig?_resolvedSourceConfig:[],title:null!==(_resolvedSourceConfig2=null==resolvedSourceConfiguration?void 0:resolvedSourceConfiguration.indices)&&void 0!==_resolvedSourceConfig2?_resolvedSourceConfig2:"unknown"}},[resolvedSourceConfiguration]),isLoadingSourceConfiguration="pending"===loadSourceConfigurationRequest.state,isResolvingSourceConfiguration="pending"===resolveSourceConfigurationRequest.state,isLoadingSourceStatus="pending"===loadSourceStatusRequest.state,isUpdatingSourceConfiguration="pending"===updateSourceConfigurationRequest.state,isLoading=isLoadingSourceConfiguration||isResolvingSourceConfiguration||isLoadingSourceStatus||isUpdatingSourceConfiguration,isUninitialized="uninitialized"===loadSourceConfigurationRequest.state||"uninitialized"===resolveSourceConfigurationRequest.state||"uninitialized"===loadSourceStatusRequest.state,hasFailedLoadingSource="rejected"===loadSourceConfigurationRequest.state,hasFailedResolvingSource="rejected"===resolveSourceConfigurationRequest.state,hasFailedLoadingSourceStatus="rejected"===loadSourceStatusRequest.state,latestLoadSourceFailures=[loadSourceConfigurationRequest,resolveSourceConfigurationRequest,loadSourceStatusRequest].filter(use_tracked_promise.b).map(({value:value})=>value instanceof Error?value:new Error(""+value)),hasFailedLoading=latestLoadSourceFailures.length>0,loadSource=Object(external_kbnSharedDeps_React_.useCallback)(async()=>{const loadSourceConfigurationPromise=loadSourceConfiguration(),loadSourceStatusPromise=loadSourceStatus(),resolveSourceConfigurationPromise=resolveSourceConfiguration((await loadSourceConfigurationPromise).configuration);return await Promise.all([loadSourceConfigurationPromise,resolveSourceConfigurationPromise,loadSourceStatusPromise])},[loadSourceConfiguration,loadSourceStatus,resolveSourceConfiguration]),updateSource=Object(external_kbnSharedDeps_React_.useCallback)(async patchedProperties=>{const updatedSourceConfiguration=await updateSourceConfiguration(patchedProperties),resolveSourceConfigurationPromise=resolveSourceConfiguration(updatedSourceConfiguration.configuration),loadSourceStatusPromise=loadSourceStatus();return await Promise.all([updatedSourceConfiguration,resolveSourceConfigurationPromise,loadSourceStatusPromise])},[loadSourceStatus,resolveSourceConfiguration,updateSourceConfiguration]),initialize=Object(external_kbnSharedDeps_React_.useCallback)(async()=>{if(isUninitialized)return await loadSource()},[isUninitialized,loadSource]);return{sourceId:sourceId,initialize:initialize,isUninitialized:isUninitialized,derivedIndexPattern:derivedIndexPattern,hasFailedLoading:hasFailedLoading,hasFailedLoadingSource:hasFailedLoadingSource,hasFailedLoadingSourceStatus:hasFailedLoadingSourceStatus,hasFailedResolvingSource:hasFailedResolvingSource,latestLoadSourceFailures:latestLoadSourceFailures,isLoading:isLoading,isLoadingSourceConfiguration:isLoadingSourceConfiguration,isLoadingSourceStatus:isLoadingSourceStatus,isResolvingSourceConfiguration:isResolvingSourceConfiguration,sourceStatus:sourceStatus,loadSourceStatus:loadSourceStatus,loadSource:loadSource,sourceConfiguration:sourceConfiguration,updateSource:updateSource,resolvedSourceConfiguration:resolvedSourceConfiguration}},[LogSourceProvider,useLogSourceContext]=constate_cjs_default()(useLogSource)},86:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return Color})),__webpack_require__.d(__webpack_exports__,"b",(function(){return colorTransformer}));__webpack_require__(24);var _elastic_eui__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(10);let Color;!function(Color){Color.color0="color0",Color.color1="color1",Color.color2="color2",Color.color3="color3",Color.color4="color4",Color.color5="color5",Color.color6="color6",Color.color7="color7",Color.color8="color8",Color.color9="color9"}(Color||(Color={}));const euiPalette=Object(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__.euiPaletteColorBlind)(),defaultPalette={[Color.color0]:euiPalette[1],[Color.color1]:euiPalette[2],[Color.color2]:euiPalette[0],[Color.color3]:euiPalette[3],[Color.color4]:euiPalette[4],[Color.color5]:euiPalette[5],[Color.color6]:euiPalette[6],[Color.color7]:euiPalette[7],[Color.color8]:euiPalette[8],[Color.color9]:euiPalette[9]},colorTransformer=(palette=defaultPalette,color=>palette[color]);var palette},87:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"g",(function(){return SnapshotNodeResponseRT})),__webpack_require__.d(__webpack_exports__,"a",(function(){return InfraTimerangeInputRT})),__webpack_require__.d(__webpack_exports__,"e",(function(){return SnapshotGroupByRT})),__webpack_require__.d(__webpack_exports__,"b",(function(){return SNAPSHOT_CUSTOM_AGGREGATIONS})),__webpack_require__.d(__webpack_exports__,"c",(function(){return SnapshotCustomAggregationRT})),__webpack_require__.d(__webpack_exports__,"d",(function(){return SnapshotCustomMetricInputRT})),__webpack_require__.d(__webpack_exports__,"f",(function(){return SnapshotMetricInputRT}));var io_ts__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0),_inventory_models_types__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(83),_metrics_api__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(123);const SnapshotNodePathRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.intersection([io_ts__WEBPACK_IMPORTED_MODULE_0__.type({value:io_ts__WEBPACK_IMPORTED_MODULE_0__.string,label:io_ts__WEBPACK_IMPORTED_MODULE_0__.string}),io_ts__WEBPACK_IMPORTED_MODULE_0__.partial({ip:io_ts__WEBPACK_IMPORTED_MODULE_0__.union([io_ts__WEBPACK_IMPORTED_MODULE_0__.string,io_ts__WEBPACK_IMPORTED_MODULE_0__.null])})]),SnapshotNodeMetricOptionalRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.partial({value:io_ts__WEBPACK_IMPORTED_MODULE_0__.union([io_ts__WEBPACK_IMPORTED_MODULE_0__.number,io_ts__WEBPACK_IMPORTED_MODULE_0__.null]),avg:io_ts__WEBPACK_IMPORTED_MODULE_0__.union([io_ts__WEBPACK_IMPORTED_MODULE_0__.number,io_ts__WEBPACK_IMPORTED_MODULE_0__.null]),max:io_ts__WEBPACK_IMPORTED_MODULE_0__.union([io_ts__WEBPACK_IMPORTED_MODULE_0__.number,io_ts__WEBPACK_IMPORTED_MODULE_0__.null]),timeseries:_metrics_api__WEBPACK_IMPORTED_MODULE_2__.a}),SnapshotNodeMetricRequiredRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.type({name:io_ts__WEBPACK_IMPORTED_MODULE_0__.union([_inventory_models_types__WEBPACK_IMPORTED_MODULE_1__.f,io_ts__WEBPACK_IMPORTED_MODULE_0__.string])}),SnapshotNodeMetricRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.intersection([SnapshotNodeMetricRequiredRT,SnapshotNodeMetricOptionalRT]),SnapshotNodeRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.type({metrics:io_ts__WEBPACK_IMPORTED_MODULE_0__.array(SnapshotNodeMetricRT),path:io_ts__WEBPACK_IMPORTED_MODULE_0__.array(SnapshotNodePathRT),name:io_ts__WEBPACK_IMPORTED_MODULE_0__.string}),SnapshotNodeResponseRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.type({nodes:io_ts__WEBPACK_IMPORTED_MODULE_0__.array(SnapshotNodeRT),interval:io_ts__WEBPACK_IMPORTED_MODULE_0__.string}),InfraTimerangeInputRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.intersection([io_ts__WEBPACK_IMPORTED_MODULE_0__.type({interval:io_ts__WEBPACK_IMPORTED_MODULE_0__.string,to:io_ts__WEBPACK_IMPORTED_MODULE_0__.number,from:io_ts__WEBPACK_IMPORTED_MODULE_0__.number}),io_ts__WEBPACK_IMPORTED_MODULE_0__.partial({lookbackSize:io_ts__WEBPACK_IMPORTED_MODULE_0__.number,ignoreLookback:io_ts__WEBPACK_IMPORTED_MODULE_0__.boolean,forceInterval:io_ts__WEBPACK_IMPORTED_MODULE_0__.boolean})]),SnapshotGroupByRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.array(io_ts__WEBPACK_IMPORTED_MODULE_0__.partial({label:io_ts__WEBPACK_IMPORTED_MODULE_0__.union([io_ts__WEBPACK_IMPORTED_MODULE_0__.string,io_ts__WEBPACK_IMPORTED_MODULE_0__.null]),field:io_ts__WEBPACK_IMPORTED_MODULE_0__.union([io_ts__WEBPACK_IMPORTED_MODULE_0__.string,io_ts__WEBPACK_IMPORTED_MODULE_0__.null])})),SnapshotNamedMetricInputRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.type({type:_inventory_models_types__WEBPACK_IMPORTED_MODULE_1__.f}),SNAPSHOT_CUSTOM_AGGREGATIONS=["avg","max","min","rate"],snapshotCustomAggregationKeys=SNAPSHOT_CUSTOM_AGGREGATIONS.reduce((acc,agg)=>({...acc,[agg]:null}),{}),SnapshotCustomAggregationRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.keyof(snapshotCustomAggregationKeys),SnapshotCustomMetricInputRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.intersection([io_ts__WEBPACK_IMPORTED_MODULE_0__.type({type:io_ts__WEBPACK_IMPORTED_MODULE_0__.literal("custom"),field:io_ts__WEBPACK_IMPORTED_MODULE_0__.string,aggregation:SnapshotCustomAggregationRT,id:io_ts__WEBPACK_IMPORTED_MODULE_0__.string}),io_ts__WEBPACK_IMPORTED_MODULE_0__.partial({label:io_ts__WEBPACK_IMPORTED_MODULE_0__.string})]),SnapshotMetricInputRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.union([SnapshotNamedMetricInputRT,SnapshotCustomMetricInputRT]);io_ts__WEBPACK_IMPORTED_MODULE_0__.intersection([io_ts__WEBPACK_IMPORTED_MODULE_0__.type({timerange:InfraTimerangeInputRT,metrics:io_ts__WEBPACK_IMPORTED_MODULE_0__.array(SnapshotMetricInputRT),groupBy:io_ts__WEBPACK_IMPORTED_MODULE_0__.union([SnapshotGroupByRT,io_ts__WEBPACK_IMPORTED_MODULE_0__.null]),nodeType:_inventory_models_types__WEBPACK_IMPORTED_MODULE_1__.c,sourceId:io_ts__WEBPACK_IMPORTED_MODULE_0__.string}),io_ts__WEBPACK_IMPORTED_MODULE_0__.partial({accountId:io_ts__WEBPACK_IMPORTED_MODULE_0__.string,region:io_ts__WEBPACK_IMPORTED_MODULE_0__.string,filterQuery:io_ts__WEBPACK_IMPORTED_MODULE_0__.union([io_ts__WEBPACK_IMPORTED_MODULE_0__.string,io_ts__WEBPACK_IMPORTED_MODULE_0__.null]),includeTimeseries:io_ts__WEBPACK_IMPORTED_MODULE_0__.boolean,overrideCompositeSize:io_ts__WEBPACK_IMPORTED_MODULE_0__.number})])},96:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var react_1=__webpack_require__(2);exports.default=function(){var mountedRef=react_1.useRef(!1),get=react_1.useCallback((function(){return mountedRef.current}),[]);return react_1.useEffect((function(){return mountedRef.current=!0,function(){mountedRef.current=!1}})),get}},97:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var useEffectOnce_1=__webpack_require__(49).__importDefault(__webpack_require__(107));exports.default=function(fn){useEffectOnce_1.default((function(){fn()}))}},98:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return METRIC_EXPLORER_AGGREGATIONS})),__webpack_require__.d(__webpack_exports__,"c",(function(){return metricsExplorerAggregationRT})),__webpack_require__.d(__webpack_exports__,"d",(function(){return metricsExplorerMetricRT})),__webpack_require__.d(__webpack_exports__,"b",(function(){return afterKeyObjectRT})),__webpack_require__.d(__webpack_exports__,"e",(function(){return metricsExplorerResponseRT}));var io_ts__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0);const METRIC_EXPLORER_AGGREGATIONS=["avg","max","min","cardinality","rate","count","sum","p95","p99"],metricsExplorerAggregationKeys=METRIC_EXPLORER_AGGREGATIONS.reduce((acc,agg)=>({...acc,[agg]:null}),{}),metricsExplorerAggregationRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.keyof(metricsExplorerAggregationKeys),metricsExplorerMetricRequiredFieldsRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.type({aggregation:metricsExplorerAggregationRT}),metricsExplorerMetricOptionalFieldsRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.partial({field:io_ts__WEBPACK_IMPORTED_MODULE_0__.union([io_ts__WEBPACK_IMPORTED_MODULE_0__.string,io_ts__WEBPACK_IMPORTED_MODULE_0__[void 0]])}),metricsExplorerMetricRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.intersection([metricsExplorerMetricRequiredFieldsRT,metricsExplorerMetricOptionalFieldsRT]),timeRangeRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.type({field:io_ts__WEBPACK_IMPORTED_MODULE_0__.string,from:io_ts__WEBPACK_IMPORTED_MODULE_0__.number,to:io_ts__WEBPACK_IMPORTED_MODULE_0__.number,interval:io_ts__WEBPACK_IMPORTED_MODULE_0__.string}),metricsExplorerRequestBodyRequiredFieldsRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.type({timerange:timeRangeRT,indexPattern:io_ts__WEBPACK_IMPORTED_MODULE_0__.string,metrics:io_ts__WEBPACK_IMPORTED_MODULE_0__.array(metricsExplorerMetricRT)}),groupByRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.union([io_ts__WEBPACK_IMPORTED_MODULE_0__.string,io_ts__WEBPACK_IMPORTED_MODULE_0__.null,io_ts__WEBPACK_IMPORTED_MODULE_0__[void 0]]),afterKeyObjectRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.record(io_ts__WEBPACK_IMPORTED_MODULE_0__.string,io_ts__WEBPACK_IMPORTED_MODULE_0__.union([io_ts__WEBPACK_IMPORTED_MODULE_0__.string,io_ts__WEBPACK_IMPORTED_MODULE_0__.null])),metricsExplorerRequestBodyOptionalFieldsRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.partial({groupBy:io_ts__WEBPACK_IMPORTED_MODULE_0__.union([groupByRT,io_ts__WEBPACK_IMPORTED_MODULE_0__.array(groupByRT)]),afterKey:io_ts__WEBPACK_IMPORTED_MODULE_0__.union([io_ts__WEBPACK_IMPORTED_MODULE_0__.string,io_ts__WEBPACK_IMPORTED_MODULE_0__.null,io_ts__WEBPACK_IMPORTED_MODULE_0__[void 0],afterKeyObjectRT]),limit:io_ts__WEBPACK_IMPORTED_MODULE_0__.union([io_ts__WEBPACK_IMPORTED_MODULE_0__.number,io_ts__WEBPACK_IMPORTED_MODULE_0__.null,io_ts__WEBPACK_IMPORTED_MODULE_0__[void 0]]),filterQuery:io_ts__WEBPACK_IMPORTED_MODULE_0__.union([io_ts__WEBPACK_IMPORTED_MODULE_0__.string,io_ts__WEBPACK_IMPORTED_MODULE_0__.null,io_ts__WEBPACK_IMPORTED_MODULE_0__[void 0]]),forceInterval:io_ts__WEBPACK_IMPORTED_MODULE_0__.boolean,dropLastBucket:io_ts__WEBPACK_IMPORTED_MODULE_0__.boolean}),metricsExplorerPageInfoRT=(io_ts__WEBPACK_IMPORTED_MODULE_0__.intersection([metricsExplorerRequestBodyRequiredFieldsRT,metricsExplorerRequestBodyOptionalFieldsRT]),io_ts__WEBPACK_IMPORTED_MODULE_0__.type({total:io_ts__WEBPACK_IMPORTED_MODULE_0__.number,afterKey:io_ts__WEBPACK_IMPORTED_MODULE_0__.union([io_ts__WEBPACK_IMPORTED_MODULE_0__.string,io_ts__WEBPACK_IMPORTED_MODULE_0__.null,afterKeyObjectRT])})),metricsExplorerColumnTypeRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.keyof({date:null,number:null,string:null}),metricsExplorerColumnRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.type({name:io_ts__WEBPACK_IMPORTED_MODULE_0__.string,type:metricsExplorerColumnTypeRT}),metricsExplorerRowRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.intersection([io_ts__WEBPACK_IMPORTED_MODULE_0__.type({timestamp:io_ts__WEBPACK_IMPORTED_MODULE_0__.number}),io_ts__WEBPACK_IMPORTED_MODULE_0__.record(io_ts__WEBPACK_IMPORTED_MODULE_0__.string,io_ts__WEBPACK_IMPORTED_MODULE_0__.union([io_ts__WEBPACK_IMPORTED_MODULE_0__.string,io_ts__WEBPACK_IMPORTED_MODULE_0__.number,io_ts__WEBPACK_IMPORTED_MODULE_0__.null,io_ts__WEBPACK_IMPORTED_MODULE_0__[void 0],io_ts__WEBPACK_IMPORTED_MODULE_0__.array(io_ts__WEBPACK_IMPORTED_MODULE_0__.object)]))]),metricsExplorerSeriesRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.intersection([io_ts__WEBPACK_IMPORTED_MODULE_0__.type({id:io_ts__WEBPACK_IMPORTED_MODULE_0__.string,columns:io_ts__WEBPACK_IMPORTED_MODULE_0__.array(metricsExplorerColumnRT),rows:io_ts__WEBPACK_IMPORTED_MODULE_0__.array(metricsExplorerRowRT)}),io_ts__WEBPACK_IMPORTED_MODULE_0__.partial({keys:io_ts__WEBPACK_IMPORTED_MODULE_0__.array(io_ts__WEBPACK_IMPORTED_MODULE_0__.string)})]),metricsExplorerResponseRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.type({series:io_ts__WEBPACK_IMPORTED_MODULE_0__.array(metricsExplorerSeriesRT),pageInfo:metricsExplorerPageInfoRT})},99:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return useUrlState})),__webpack_require__.d(__webpack_exports__,"a",(function(){return replaceStateKeyInQueryString}));var query_string__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(35),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(2),rison_node__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(26),react_router_dom__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(62),_src_plugins_kibana_utils_public__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(34);const useUrlState=({defaultState:defaultState,decodeUrlState:decodeUrlState,encodeUrlState:encodeUrlState,urlStateKey:urlStateKey,writeDefaultState:writeDefaultState=!1})=>{const history=Object(react_router_dom__WEBPACK_IMPORTED_MODULE_3__.useHistory)(),queryString=null!=history&&history.location?getQueryStringFromLocation(history.location):"",urlStateString=Object(react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(()=>{if(queryString)return getParamFromQueryString(queryString,urlStateKey)},[queryString,urlStateKey]),decodedState=Object(react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(()=>decodeUrlState(decodeRisonUrlState(urlStateString)),[decodeUrlState,urlStateString]),state=Object(react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(()=>void 0!==decodedState?decodedState:defaultState,[defaultState,decodedState]),setState=Object(react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(newState=>{if(!history||!history.location)return;const currentLocation=history.location,newLocation=replaceQueryStringInLocation(currentLocation,replaceStateKeyInQueryString(urlStateKey,void 0!==newState?encodeUrlState(newState):void 0)(getQueryStringFromLocation(currentLocation)));newLocation!==currentLocation&&history.replace(newLocation)},[encodeUrlState,history,urlStateKey]),[shouldInitialize,setShouldInitialize]=Object(react__WEBPACK_IMPORTED_MODULE_1__.useState)(writeDefaultState&&void 0===decodedState);return Object(react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{shouldInitialize&&(setShouldInitialize(!1),setState(defaultState))},[shouldInitialize,setState,defaultState]),[state,setState]},decodeRisonUrlState=value=>{try{return value?Object(rison_node__WEBPACK_IMPORTED_MODULE_2__.decode)(value):void 0}catch(error){if(error instanceof Error&&error.message.startsWith("rison decoder error"))return{};throw error}},getQueryStringFromLocation=location=>location.search.substring(1),getParamFromQueryString=(queryString,key)=>{const queryParam=Object(query_string__WEBPACK_IMPORTED_MODULE_0__.parse)(queryString,{sort:!1})[key];return Array.isArray(queryParam)?queryParam[0]:queryParam},replaceStateKeyInQueryString=(stateKey,urlState)=>queryString=>{const previousQueryValues=Object(query_string__WEBPACK_IMPORTED_MODULE_0__.parse)(queryString,{sort:!1}),newValue=void 0===urlState?previousQueryValues:{...previousQueryValues,[stateKey]:(state=urlState,Object(rison_node__WEBPACK_IMPORTED_MODULE_2__.encode)(state))};var state;return Object(query_string__WEBPACK_IMPORTED_MODULE_0__.stringify)(_src_plugins_kibana_utils_public__WEBPACK_IMPORTED_MODULE_4__.url.encodeQuery(newValue),{sort:!1,encode:!1})},replaceQueryStringInLocation=(location,queryString)=>queryString===getQueryStringFromLocation(location)?location:{...location,search:"?"+queryString}}}]);