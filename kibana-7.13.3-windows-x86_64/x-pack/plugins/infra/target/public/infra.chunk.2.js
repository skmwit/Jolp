/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.infra_bundle_jsonpfunction=window.infra_bundle_jsonpfunction||[]).push([[2],{102:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return useHTTPRequest}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),_kbn_i18n__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1),_utils_use_tracked_promise__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(79),_src_plugins_kibana_react_public__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(3);function useHTTPRequest(pathname,method,body,decode=(response=>response),fetch,toastDanger){var _kibana$services$http;const kibana=Object(_src_plugins_kibana_react_public__WEBPACK_IMPORTED_MODULE_3__.useKibana)(),fetchService=fetch||(null===(_kibana$services$http=kibana.services.http)||void 0===_kibana$services$http?void 0:_kibana$services$http.fetch),toast=toastDanger||kibana.notifications.toasts.danger,[response,setResponse]=Object(react__WEBPACK_IMPORTED_MODULE_0__.useState)(null),[error,setError]=Object(react__WEBPACK_IMPORTED_MODULE_0__.useState)(null),[request,makeRequest]=Object(_utils_use_tracked_promise__WEBPACK_IMPORTED_MODULE_2__.c)({cancelPreviousOn:"resolution",createPromise:()=>{if(!fetchService)throw new Error("HTTP service is unavailable");return fetchService(pathname,{method:method,body:body})},onResolve:resp=>setResponse(decode(resp)),onReject:e=>{var _err$response,_err$response2,_err$response3,_err$body,_err$body2;const err=e;e&&e instanceof _utils_use_tracked_promise__WEBPACK_IMPORTED_MODULE_2__.a||(setError(err),toast({toastLifeTimeMs:3e3,title:_kbn_i18n__WEBPACK_IMPORTED_MODULE_1__.i18n.translate("xpack.infra.useHTTPRequest.error.title",{defaultMessage:"Error while fetching resource"}),body:react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div",null,err.response?react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("h5",null,_kbn_i18n__WEBPACK_IMPORTED_MODULE_1__.i18n.translate("xpack.infra.useHTTPRequest.error.status",{defaultMessage:"Error"})),null===(_err$response=err.response)||void 0===_err$response?void 0:_err$response.statusText," (",null===(_err$response2=err.response)||void 0===_err$response2?void 0:_err$response2.status,")",react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("h5",null,_kbn_i18n__WEBPACK_IMPORTED_MODULE_1__.i18n.translate("xpack.infra.useHTTPRequest.error.url",{defaultMessage:"URL"})),null===(_err$response3=err.response)||void 0===_err$response3?void 0:_err$response3.url,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("h5",null,_kbn_i18n__WEBPACK_IMPORTED_MODULE_1__.i18n.translate("xpack.infra.useHTTPRequest.error.body.message",{defaultMessage:"Message"})),(null===(_err$body=err.body)||void 0===_err$body?void 0:_err$body.message)||err.message):react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("h5",null,(null===(_err$body2=err.body)||void 0===_err$body2?void 0:_err$body2.message)||err.message))}))}},[pathname,body,method,fetch,toast]),loading=Object(react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(()=>"resolved"===request.state&&null===response||"pending"===request.state,[request.state,response]);return{response:response,error:error,loading:loading,makeRequest:makeRequest}}},117:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return convertKueryToElasticSearchQuery}));var _src_plugins_data_public__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(63);const convertKueryToElasticSearchQuery=(kueryExpression,indexPattern)=>{try{return kueryExpression?JSON.stringify(_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_0__.esKuery.toElasticsearchQuery(_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_0__.esKuery.fromKueryExpression(kueryExpression),indexPattern)):""}catch(err){return""}}},124:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return MetricExplorerSeriesChart}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),_elastic_charts__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(61),_common_color_palette__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(86),_helpers_create_metric_label__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(277),_hooks_use_metrics_explorer_options__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(93),_helpers_get_metric_id__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(161);const MetricExplorerSeriesChart=props=>_hooks_use_metrics_explorer_options__WEBPACK_IMPORTED_MODULE_4__.b.bar===props.type?react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(MetricsExplorerBarChart,props):react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(MetricsExplorerAreaChart,props),MetricsExplorerAreaChart=({metric:metric,id:id,series:series,type:type,stack:stack,opacity:opacity})=>{const color=metric.color&&Object(_common_color_palette__WEBPACK_IMPORTED_MODULE_2__.b)(metric.color)||Object(_common_color_palette__WEBPACK_IMPORTED_MODULE_2__.b)(_common_color_palette__WEBPACK_IMPORTED_MODULE_2__.a.color0),yAccessors=Array.isArray(id)?id.map(i=>Object(_helpers_get_metric_id__WEBPACK_IMPORTED_MODULE_5__.a)(metric,i)).slice(id.length-1,id.length):[Object(_helpers_get_metric_id__WEBPACK_IMPORTED_MODULE_5__.a)(metric,id)],y0Accessors=Array.isArray(id)&&id.length>1?id.map(i=>Object(_helpers_get_metric_id__WEBPACK_IMPORTED_MODULE_5__.a)(metric,i)).slice(0,1):void 0,chartId=`series-${series.id}-${yAccessors.join("-")}`,seriesAreaStyle={line:{strokeWidth:2,visible:!0},area:{opacity:opacity||.5,visible:type===_hooks_use_metrics_explorer_options__WEBPACK_IMPORTED_MODULE_4__.b.area}};return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_charts__WEBPACK_IMPORTED_MODULE_1__.AreaSeries,{id:chartId,key:chartId,name:Object(_helpers_create_metric_label__WEBPACK_IMPORTED_MODULE_3__.a)(metric),xScaleType:_elastic_charts__WEBPACK_IMPORTED_MODULE_1__.ScaleType.Time,yScaleType:_elastic_charts__WEBPACK_IMPORTED_MODULE_1__.ScaleType.Linear,xAccessor:"timestamp",yAccessors:yAccessors,y0Accessors:y0Accessors,data:series.rows,stackAccessors:stack?["timestamp"]:void 0,areaSeriesStyle:seriesAreaStyle,color:color})},MetricsExplorerBarChart=({metric:metric,id:id,series:series,stack:stack})=>{const color=metric.color&&Object(_common_color_palette__WEBPACK_IMPORTED_MODULE_2__.b)(metric.color)||Object(_common_color_palette__WEBPACK_IMPORTED_MODULE_2__.b)(_common_color_palette__WEBPACK_IMPORTED_MODULE_2__.a.color0),yAccessors=Array.isArray(id)?id.map(i=>Object(_helpers_get_metric_id__WEBPACK_IMPORTED_MODULE_5__.a)(metric,i)).slice(id.length-1,id.length):[Object(_helpers_get_metric_id__WEBPACK_IMPORTED_MODULE_5__.a)(metric,id)],chartId=`series-${series.id}-${yAccessors.join("-")}`,seriesBarStyle={rectBorder:{stroke:color,strokeWidth:1,visible:!0},rect:{opacity:1}};return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_charts__WEBPACK_IMPORTED_MODULE_1__.BarSeries,{id:chartId,key:chartId,name:Object(_helpers_create_metric_label__WEBPACK_IMPORTED_MODULE_3__.a)(metric),xScaleType:_elastic_charts__WEBPACK_IMPORTED_MODULE_1__.ScaleType.Time,yScaleType:_elastic_charts__WEBPACK_IMPORTED_MODULE_1__.ScaleType.Linear,xAccessor:"timestamp",yAccessors:yAccessors,data:series.rows,stackAccessors:stack?["timestamp"]:void 0,barSeriesStyle:seriesBarStyle,color:color})}},125:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return calculateDomain}));var lodash__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(24),_get_metric_id__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(161);const getMin=values=>{const minValue=Object(lodash__WEBPACK_IMPORTED_MODULE_0__.min)(values);return Object(lodash__WEBPACK_IMPORTED_MODULE_0__.isNumber)(minValue)&&Number.isFinite(minValue)?minValue:void 0},getMax=values=>{const maxValue=Object(lodash__WEBPACK_IMPORTED_MODULE_0__.max)(values);return Object(lodash__WEBPACK_IMPORTED_MODULE_0__.isNumber)(maxValue)&&Number.isFinite(maxValue)?maxValue:void 0},calculateDomain=(series,metrics,stacked=!1)=>{const values=series.rows.reduce((acc,row)=>{const rowValues=metrics.map((m,index)=>row[Object(_get_metric_id__WEBPACK_IMPORTED_MODULE_1__.a)(m,index)]||null).filter(v=>Object(lodash__WEBPACK_IMPORTED_MODULE_0__.isNumber)(v)),minValue=getMin(rowValues),maxValue=stacked?1.1*Object(lodash__WEBPACK_IMPORTED_MODULE_0__.sum)(rowValues):getMax(rowValues);return acc.concat([minValue||null,maxValue||null])},[]).filter(v=>Object(lodash__WEBPACK_IMPORTED_MODULE_0__.isNumber)(v));return{min:getMin(values)||0,max:getMax(values)||0}}},128:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return AlertPrefillProvider})),__webpack_require__.d(__webpack_exports__,"b",(function(){return useAlertPrefillContext}));var constate_cjs=__webpack_require__(78),constate_cjs_default=__webpack_require__.n(constate_cjs),external_kbnSharedDeps_Lodash_=__webpack_require__(24),external_kbnSharedDeps_React_=__webpack_require__(2);const[AlertPrefillProvider,useAlertPrefillContext]=constate_cjs_default()(()=>({metricThresholdPrefill:(()=>{const[prefillOptionsState,setPrefillOptionsState]=Object(external_kbnSharedDeps_React_.useState)({groupBy:void 0,filterQuery:void 0,metrics:[]}),{groupBy:groupBy,filterQuery:filterQuery,metrics:metrics}=prefillOptionsState;return{groupBy:groupBy,filterQuery:filterQuery,metrics:metrics,setPrefillOptions(newState){Object(external_kbnSharedDeps_Lodash_.isEqual)(newState,prefillOptionsState)||setPrefillOptionsState(newState)}}})(),inventoryPrefill:(()=>{const[nodeType,setNodeType]=Object(external_kbnSharedDeps_React_.useState)("host"),[filterQuery,setFilterQuery]=Object(external_kbnSharedDeps_React_.useState)(),[metric,setMetric]=Object(external_kbnSharedDeps_React_.useState)({type:"cpu"}),[customMetrics,setCustomMetrics]=Object(external_kbnSharedDeps_React_.useState)([]);return{nodeType:nodeType,filterQuery:filterQuery,metric:metric,customMetrics:customMetrics,setNodeType:setNodeType,setFilterQuery:setFilterQuery,setMetric:setMetric,setCustomMetrics:setCustomMetrics}})()}))},131:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"e",(function(){return METRIC_THRESHOLD_ALERT_TYPE_ID})),__webpack_require__.d(__webpack_exports__,"d",(function(){return METRIC_INVENTORY_THRESHOLD_ALERT_TYPE_ID})),__webpack_require__.d(__webpack_exports__,"b",(function(){return Comparator})),__webpack_require__.d(__webpack_exports__,"a",(function(){return Aggregators})),__webpack_require__.d(__webpack_exports__,"c",(function(){return INFRA_ALERT_PREVIEW_PATH}));var lib=__webpack_require__(0),types=__webpack_require__(83);const METRIC_THRESHOLD_ALERT_TYPE_ID="metrics.alert.threshold",METRIC_INVENTORY_THRESHOLD_ALERT_TYPE_ID="metrics.alert.inventory.threshold";let Comparator,Aggregators;!function(Comparator){Comparator.GT=">",Comparator.LT="<",Comparator.GT_OR_EQ=">=",Comparator.LT_OR_EQ="<=",Comparator.BETWEEN="between",Comparator.OUTSIDE_RANGE="outside"}(Comparator||(Comparator={})),function(Aggregators){Aggregators.COUNT="count",Aggregators.AVERAGE="avg",Aggregators.SUM="sum",Aggregators.MIN="min",Aggregators.MAX="max",Aggregators.RATE="rate",Aggregators.CARDINALITY="cardinality",Aggregators.P95="p95",Aggregators.P99="p99"}(Aggregators||(Aggregators={}));const metricAnomalyNodeTypeRT=lib.union([lib.literal("hosts"),lib.literal("k8s")]),metricAnomalyMetricRT=lib.union([lib.literal("memory_usage"),lib.literal("network_in"),lib.literal("network_out")]),metricAnomalyInfluencerFilterRT=lib.type({fieldName:lib.string,fieldValue:lib.string}),baseAlertRequestParamsRT=lib.intersection([lib.partial({filterQuery:lib.union([lib.string,lib[void 0]]),sourceId:lib.string}),lib.type({lookback:lib.union([lib.literal("ms"),lib.literal("s"),lib.literal("m"),lib.literal("h"),lib.literal("d"),lib.literal("w"),lib.literal("M"),lib.literal("y")]),alertInterval:lib.string,alertThrottle:lib.string,alertOnNoData:lib.boolean,alertNotifyWhen:lib.string})]),metricThresholdAlertPreviewRequestParamsRT=lib.intersection([baseAlertRequestParamsRT,lib.partial({groupBy:lib.union([lib.string,lib.array(lib.string),lib[void 0]])}),lib.type({alertType:lib.literal(METRIC_THRESHOLD_ALERT_TYPE_ID),criteria:lib.array(lib.any)})]),inventoryAlertPreviewRequestParamsRT=lib.intersection([baseAlertRequestParamsRT,lib.type({nodeType:types.c,alertType:lib.literal(METRIC_INVENTORY_THRESHOLD_ALERT_TYPE_ID),criteria:lib.array(lib.any)})]),metricAnomalyAlertPreviewRequestParamsRT=lib.intersection([baseAlertRequestParamsRT,lib.type({nodeType:metricAnomalyNodeTypeRT,metric:metricAnomalyMetricRT,threshold:lib.number,alertType:lib.literal("metrics.alert.anomaly"),spaceId:lib.string}),lib.partial({influencerFilter:metricAnomalyInfluencerFilterRT})]),INFRA_ALERT_PREVIEW_PATH=(lib.union([metricThresholdAlertPreviewRequestParamsRT,inventoryAlertPreviewRequestParamsRT,metricAnomalyAlertPreviewRequestParamsRT]),lib.type({numberOfGroups:lib.number,resultTotals:lib.intersection([lib.type({fired:lib.number,noData:lib.number,error:lib.number,notifications:lib.number}),lib.partial({warning:lib.number})])}),"/api/infra/alerting/preview")},138:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return createFormatterForMetric}));var _common_formatters__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(33),_lib_lib__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(32),_metric_to_format__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(276);const createFormatterForMetric=metric=>{if(metric&&metric.field){const format=Object(_metric_to_format__WEBPACK_IMPORTED_MODULE_2__.a)(metric);return format===_lib_lib__WEBPACK_IMPORTED_MODULE_1__.b.bits&&"rate"===metric.aggregation?Object(_common_formatters__WEBPACK_IMPORTED_MODULE_0__.b)(_lib_lib__WEBPACK_IMPORTED_MODULE_1__.b.bits,"{{value}}/s"):Object(_common_formatters__WEBPACK_IMPORTED_MODULE_0__.b)(format)}return Object(_common_formatters__WEBPACK_IMPORTED_MODULE_0__.b)(_lib_lib__WEBPACK_IMPORTED_MODULE_1__.b.number)}},141:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return useSourceViaHttp}));var external_kbnSharedDeps_React_=__webpack_require__(2),Either=__webpack_require__(17),lib_function=__webpack_require__(18),pipeable=__webpack_require__(25),constate_cjs=__webpack_require__(78),constate_cjs_default=__webpack_require__.n(constate_cjs),lib=__webpack_require__(0),external_kbnSharedDeps_Lodash_=__webpack_require__(24),external_kbnSharedDeps_Moment_=__webpack_require__(50),external_kbnSharedDeps_Moment_default=__webpack_require__.n(external_kbnSharedDeps_Moment_),log_sources=__webpack_require__(5);const TimestampFromString=new lib.Type("TimestampFromString",input=>"number"==typeof input,(input,context)=>Object(pipeable.pipe)(lib.string.validate(input,context),Object(Either.chain)(stringInput=>{const momentValue=external_kbnSharedDeps_Moment_default()(stringInput);return momentValue.isValid()?lib.success(momentValue.valueOf()):lib.failure(stringInput,context)})),output=>new Date(output).toISOString()),SourceConfigurationTimestampColumnRuntimeType=(lib.type({sources:lib.type({default:lib.partial({logAlias:lib.string,metricAlias:lib.string,fields:lib.partial({timestamp:lib.string,message:lib.array(lib.string),tiebreaker:lib.string,host:lib.string,container:lib.string,pod:lib.string})})})}),lib.type({timestampColumn:lib.type({id:lib.string})})),SourceConfigurationMessageColumnRuntimeType=lib.type({messageColumn:lib.type({id:lib.string})}),SourceConfigurationFieldColumnRuntimeType=lib.type({fieldColumn:lib.type({id:lib.string,field:lib.string})}),SourceConfigurationColumnRuntimeType=lib.union([SourceConfigurationTimestampColumnRuntimeType,SourceConfigurationMessageColumnRuntimeType,SourceConfigurationFieldColumnRuntimeType]),SourceConfigurationFieldsRT=lib.type({container:lib.string,host:lib.string,pod:lib.string,tiebreaker:lib.string,timestamp:lib.string,message:lib.array(lib.string)}),SourceConfigurationRT=lib.type({name:lib.string,description:lib.string,metricAlias:lib.string,logIndices:log_sources.g,inventoryDefaultView:lib.string,metricsExplorerDefaultView:lib.string,fields:SourceConfigurationFieldsRT,logColumns:lib.array(SourceConfigurationColumnRuntimeType),anomalyThreshold:lib.number}),SavedSourceConfigurationFieldsRuntimeType=lib.partial(Object(external_kbnSharedDeps_Lodash_.omit)(SourceConfigurationFieldsRT.props,["message"])),SavedSourceConfigurationRuntimeType=lib.intersection([lib.partial(Object(external_kbnSharedDeps_Lodash_.omit)(SourceConfigurationRT.props,["fields"])),lib.partial({fields:SavedSourceConfigurationFieldsRuntimeType})]),StaticSourceConfigurationFieldsRuntimeType=lib.partial(SourceConfigurationFieldsRT.props),SourceConfigurationRuntimeType=(lib.partial({...SourceConfigurationRT.props,fields:StaticSourceConfigurationFieldsRuntimeType}),lib.type({...SourceConfigurationRT.props,fields:SourceConfigurationFieldsRT,logColumns:lib.array(SourceConfigurationColumnRuntimeType)})),SourceStatusFieldRuntimeType=lib.type({name:lib.string,type:lib.string,searchable:lib.boolean,aggregatable:lib.boolean,displayable:lib.boolean}),SourceStatusRuntimeType=lib.type({logIndicesExist:lib.boolean,metricIndicesExist:lib.boolean,indexFields:lib.array(SourceStatusFieldRuntimeType)}),SourceRuntimeType=lib.intersection([lib.type({id:lib.string,origin:lib.keyof({fallback:null,internal:null,stored:null}),configuration:SourceConfigurationRuntimeType}),lib.partial({version:lib.string,updatedAt:lib.number,status:SourceStatusRuntimeType})]),metricsSourceConfigurationPropertiesRT=(lib.type({source:SourceRuntimeType}),lib.intersection([lib.type({id:lib.string,attributes:SavedSourceConfigurationRuntimeType}),lib.partial({version:lib.string,updated_at:TimestampFromString})]),lib.strict({name:SourceConfigurationRT.props.name,description:SourceConfigurationRT.props.description,metricAlias:SourceConfigurationRT.props.metricAlias,inventoryDefaultView:SourceConfigurationRT.props.inventoryDefaultView,metricsExplorerDefaultView:SourceConfigurationRT.props.metricsExplorerDefaultView,fields:lib.strict(Object(external_kbnSharedDeps_Lodash_.omit)(SourceConfigurationRT.props.fields.props,"message")),anomalyThreshold:lib.number})),metricsSourceConfigurationOriginRT=(lib.partial({...metricsSourceConfigurationPropertiesRT.type.props,fields:lib.partial({...metricsSourceConfigurationPropertiesRT.type.props.fields.type.props})}),lib.keyof({fallback:null,internal:null,stored:null})),metricsSourceStatusRT=lib.strict({metricIndicesExist:SourceStatusRuntimeType.props.metricIndicesExist,indexFields:SourceStatusRuntimeType.props.indexFields}),metricsSourceConfigurationRT=lib.exact(lib.intersection([lib.type({id:lib.string,origin:metricsSourceConfigurationOriginRT,configuration:metricsSourceConfigurationPropertiesRT}),lib.partial({updatedAt:lib.number,version:lib.string,status:metricsSourceStatusRT})])),metricsSourceConfigurationResponseRT=lib.type({source:metricsSourceConfigurationRT});var use_http_request=__webpack_require__(102),runtime_types=__webpack_require__(15);const pickIndexPattern=(source,type)=>source?"metrics"===type?source.configuration.metricAlias:""+source.configuration.metricAlias:"unknown-index",useSourceViaHttp=({sourceId:sourceId="default",fetch:fetch,toastWarning:toastWarning})=>{const{error:error,loading:loading,response:response,makeRequest:makeRequest}=Object(use_http_request.a)("/api/metrics/source/"+sourceId,"GET",null,response=>Object(pipeable.pipe)(metricsSourceConfigurationResponseRT.decode(response),Object(Either.fold)(Object(runtime_types.c)(runtime_types.a),lib_function.identity)),fetch,toastWarning);Object(external_kbnSharedDeps_React_.useEffect)(()=>{(async()=>{await makeRequest()})()},[makeRequest]);return{createDerivedIndexPattern:Object(external_kbnSharedDeps_React_.useCallback)(()=>({fields:null!=response&&response.source.status?response.source.status.indexFields:[],title:pickIndexPattern(null==response?void 0:response.source,"metrics")}),[response]),source:Object(external_kbnSharedDeps_React_.useMemo)(()=>response?response.source:null,[response]),loading:loading,error:error}},SourceViaHttp=constate_cjs_default()(useSourceViaHttp),[SourceViaHttpProvider,useSourceViaHttpContext]=SourceViaHttp},161:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return getMetricId}));const getMetricId=(metric,index)=>"metric_"+index},162:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return MetricsExplorerKueryBar}));var _kbn_i18n__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(2),react__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__),_containers_with_kuery_autocompletion__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(278),_components_autocomplete_field__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(298),_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(63);const MetricsExplorerKueryBar=({derivedIndexPattern:derivedIndexPattern,onSubmit:onSubmit,onChange:onChange,value:value,placeholder:placeholder,curryLoadSuggestions:curryLoadSuggestions=defaultCurryLoadSuggestions})=>{const[draftQuery,setDraftQuery]=Object(react__WEBPACK_IMPORTED_MODULE_1__.useState)(value||""),[isValid,setValidation]=Object(react__WEBPACK_IMPORTED_MODULE_1__.useState)(!0);Object(react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{value&&setDraftQuery(value)},[value]);const handleChange=query=>{setValidation(function(query){try{_src_plugins_data_public__WEBPACK_IMPORTED_MODULE_4__.esKuery.fromKueryExpression(query)}catch(err){return!1}return!0}(query)),setDraftQuery(query),onChange&&onChange(query)},filteredDerivedIndexPattern={...derivedIndexPattern,fields:derivedIndexPattern.fields},defaultPlaceholder=_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__.i18n.translate("xpack.infra.homePage.toolbar.kqlSearchFieldPlaceholder",{defaultMessage:"Search for infrastructure dataâ€¦ (e.g. host.name:host-1)"});return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_containers_with_kuery_autocompletion__WEBPACK_IMPORTED_MODULE_2__.a,{indexPattern:filteredDerivedIndexPattern},({isLoadingSuggestions:isLoadingSuggestions,loadSuggestions:loadSuggestions,suggestions:suggestions})=>react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_components_autocomplete_field__WEBPACK_IMPORTED_MODULE_3__.a,{"aria-label":placeholder,isLoadingSuggestions:isLoadingSuggestions,isValid:isValid,loadSuggestions:curryLoadSuggestions(loadSuggestions),onChange:handleChange,onSubmit:onSubmit,placeholder:placeholder||defaultPlaceholder,suggestions:suggestions,value:draftQuery}))},defaultCurryLoadSuggestions=loadSuggestions=>(...args)=>loadSuggestions(...args)},206:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return getIntervalInSeconds}));const INTERVAL_STRING_RE=new RegExp("^([0-9\\.]*)\\s*("+["y","M","w","d","h","m","s","ms"].join("|")+")$"),units={ms:.001,s:1,m:60,h:3600,d:86400,w:604800,M:2592e3,y:30758400},getIntervalInSeconds=interval=>{const matches=interval.match(INTERVAL_STRING_RE);if(matches)return parseFloat(matches[1])*units[matches[2]];throw new Error("Invalid interval string format.")}},276:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return metricToFormat}));var lodash__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(24),_lib_lib__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(32);const metricToFormat=metric=>{if(metric&&metric.field){const suffix=Object(lodash__WEBPACK_IMPORTED_MODULE_0__.last)(metric.field.split(/\./));if("pct"===suffix)return _lib_lib__WEBPACK_IMPORTED_MODULE_1__.b.percent;if("bytes"===suffix&&"rate"===metric.aggregation)return _lib_lib__WEBPACK_IMPORTED_MODULE_1__.b.bits;if("bytes"===suffix)return _lib_lib__WEBPACK_IMPORTED_MODULE_1__.b.bytes}return _lib_lib__WEBPACK_IMPORTED_MODULE_1__.b.number}},277:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return createMetricLabel}));const createMetricLabel=metric=>metric.label?metric.label:`${metric.aggregation}(${metric.field||""})`},278:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return WithKueryAutocompletion}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),_src_plugins_kibana_react_public__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(3);function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class WithKueryAutocompletionComponent extends react__WEBPACK_IMPORTED_MODULE_0___default.a.Component{constructor(...args){super(...args),_defineProperty(this,"state",{currentRequest:null,suggestions:[]}),_defineProperty(this,"loadSuggestions",async(expression,cursorPosition,maxSuggestions,transformSuggestions)=>{var _this$props$kibana$se;const{indexPattern:indexPattern}=this.props;if(!(null===(_this$props$kibana$se=this.props.kibana.services.data)||void 0===_this$props$kibana$se?void 0:_this$props$kibana$se.autocomplete.hasQuerySuggestions("kuery")))return;this.setState({currentRequest:{expression:expression,cursorPosition:cursorPosition},suggestions:[]});const suggestions=await this.props.kibana.services.data.autocomplete.getQuerySuggestions({language:"kuery",query:expression,selectionStart:cursorPosition,selectionEnd:cursorPosition,indexPatterns:[indexPattern],boolFilter:[]})||[],transformedSuggestions=transformSuggestions?transformSuggestions(suggestions):suggestions;this.setState(state=>state.currentRequest&&state.currentRequest.expression!==expression&&state.currentRequest.cursorPosition!==cursorPosition?state:{...state,currentRequest:null,suggestions:maxSuggestions?transformedSuggestions.slice(0,maxSuggestions):transformedSuggestions})})}render(){const{currentRequest:currentRequest,suggestions:suggestions}=this.state;return this.props.children({isLoadingSuggestions:null!==currentRequest,loadSuggestions:this.loadSuggestions,suggestions:suggestions})}}const WithKueryAutocompletion=Object(_src_plugins_kibana_react_public__WEBPACK_IMPORTED_MODULE_1__.withKibana)(WithKueryAutocompletionComponent)},298:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return autocomplete_field_AutocompleteField}));var external_kbnSharedDeps_ElasticEui_=__webpack_require__(10),external_kbnSharedDeps_React_=__webpack_require__(2),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),common_=__webpack_require__(13);__webpack_require__(24);function composeStateUpdaters(...updaters){return(state,props)=>updaters.reduce((currentState,updater)=>updater(currentState,props)||currentState,state)}var lib=__webpack_require__(111),public_=__webpack_require__(63);const SuggestionItem=props=>{const{isSelected:isSelected,onClick:onClick,onMouseEnter:onMouseEnter,suggestion:suggestion}=props;return external_kbnSharedDeps_React_default.a.createElement(SuggestionItemContainer,{isSelected:isSelected,onClick:onClick,onMouseEnter:onMouseEnter},external_kbnSharedDeps_React_default.a.createElement(SuggestionItemIconField,{suggestionType:suggestion.type},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiIcon,{type:getEuiIconType(suggestion.type)})),external_kbnSharedDeps_React_default.a.createElement(SuggestionItemTextField,null,suggestion.text),external_kbnSharedDeps_React_default.a.createElement(SuggestionItemDescriptionField,null,suggestion.description))};SuggestionItem.defaultProps={isSelected:!1};const SuggestionItemContainer=common_.euiStyled.div`
  display: flex;
  flex-direction: row;
  font-size: ${props=>props.theme.eui.euiFontSizeS};
  height: ${props=>props.theme.eui.euiSizeXL};
  white-space: nowrap;
  background-color: ${props=>props.isSelected?props.theme.eui.euiColorLightestShade:"transparent"};
`,SuggestionItemField=common_.euiStyled.div`
  align-items: center;
  cursor: pointer;
  display: flex;
  flex-direction: row;
  height: ${props=>props.theme.eui.euiSizeXL};
  padding: ${props=>props.theme.eui.euiSizeXS};
`,SuggestionItemIconField=Object(common_.euiStyled)(SuggestionItemField)`
  background-color: ${props=>Object(lib.transparentize)(.9,getEuiIconColor(props.theme,props.suggestionType))};
  color: ${props=>getEuiIconColor(props.theme,props.suggestionType)};
  flex: 0 0 auto;
  justify-content: center;
  width: ${props=>props.theme.eui.euiSizeXL};
`,SuggestionItemTextField=Object(common_.euiStyled)(SuggestionItemField)`
  flex: 2 0 0;
  font-family: ${props=>props.theme.eui.euiCodeFontFamily};
`,SuggestionItemDescriptionField=Object(common_.euiStyled)(SuggestionItemField)`
  flex: 3 0 0;

  p {
    display: inline;

    span {
      font-family: ${props=>props.theme.eui.euiCodeFontFamily};
    }
  }
`,getEuiIconType=suggestionType=>{switch(suggestionType){case public_.QuerySuggestionTypes.Field:return"kqlField";case public_.QuerySuggestionTypes.Value:return"kqlValue";case public_.QuerySuggestionTypes.RecentSearch:return"search";case public_.QuerySuggestionTypes.Conjunction:return"kqlSelector";case public_.QuerySuggestionTypes.Operator:return"kqlOperand";default:return"empty"}},getEuiIconColor=(theme,suggestionType)=>{switch(suggestionType){case public_.QuerySuggestionTypes.Field:return null==theme?void 0:theme.eui.euiColorVis7;case public_.QuerySuggestionTypes.Value:return null==theme?void 0:theme.eui.euiColorVis0;case public_.QuerySuggestionTypes.Operator:return null==theme?void 0:theme.eui.euiColorVis1;case public_.QuerySuggestionTypes.Conjunction:return null==theme?void 0:theme.eui.euiColorVis2;case public_.QuerySuggestionTypes.RecentSearch:default:return null==theme?void 0:theme.eui.euiColorMediumShade}};function autocomplete_field_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}class autocomplete_field_AutocompleteField extends external_kbnSharedDeps_React_default.a.Component{constructor(...args){super(...args),autocomplete_field_defineProperty(this,"state",{areSuggestionsVisible:!1,isFocused:!1,selectedIndex:null}),autocomplete_field_defineProperty(this,"inputElement",null),autocomplete_field_defineProperty(this,"handleChangeInputRef",element=>{this.inputElement=element}),autocomplete_field_defineProperty(this,"handleChange",evt=>{this.changeValue(evt.currentTarget.value)}),autocomplete_field_defineProperty(this,"handleKeyDown",evt=>{const{suggestions:suggestions}=this.props;switch(evt.key){case"ArrowUp":evt.preventDefault(),suggestions.length>0&&this.setState(composeStateUpdaters(withSuggestionsVisible,withPreviousSuggestionSelected));break;case"ArrowDown":evt.preventDefault(),suggestions.length>0?this.setState(composeStateUpdaters(withSuggestionsVisible,withNextSuggestionSelected)):this.updateSuggestions();break;case"Enter":evt.preventDefault(),null!==this.state.selectedIndex?this.applySelectedSuggestion():this.submit();break;case"Escape":evt.preventDefault(),this.setState(withSuggestionsHidden)}}),autocomplete_field_defineProperty(this,"handleKeyUp",evt=>{switch(evt.key){case"ArrowLeft":case"ArrowRight":case"Home":case"End":this.updateSuggestions()}}),autocomplete_field_defineProperty(this,"handleFocus",()=>{this.setState(composeStateUpdaters(withSuggestionsVisible,withFocused))}),autocomplete_field_defineProperty(this,"handleBlur",()=>{this.setState(composeStateUpdaters(withSuggestionsHidden,withUnfocused))}),autocomplete_field_defineProperty(this,"selectSuggestionAt",index=>()=>{this.setState(withSuggestionAtIndexSelected(index))}),autocomplete_field_defineProperty(this,"applySelectedSuggestion",()=>{null!==this.state.selectedIndex&&this.applySuggestionAt(this.state.selectedIndex)()}),autocomplete_field_defineProperty(this,"applySuggestionAt",index=>()=>{const{value:value,suggestions:suggestions}=this.props,selectedSuggestion=suggestions[index];if(!selectedSuggestion)return;const newValue=value.substr(0,selectedSuggestion.start)+selectedSuggestion.text+value.substr(selectedSuggestion.end);this.setState(withSuggestionsHidden),this.changeValue(newValue),this.focusInputElement()}),autocomplete_field_defineProperty(this,"changeValue",value=>{const{onChange:onChange}=this.props;onChange&&onChange(value)}),autocomplete_field_defineProperty(this,"focusInputElement",()=>{this.inputElement&&this.inputElement.focus()}),autocomplete_field_defineProperty(this,"showSuggestions",()=>{this.setState(withSuggestionsVisible)}),autocomplete_field_defineProperty(this,"submit",()=>{const{isValid:isValid,onSubmit:onSubmit,value:value}=this.props;isValid&&onSubmit&&onSubmit(value),this.setState(withSuggestionsHidden)}),autocomplete_field_defineProperty(this,"updateSuggestions",()=>{const inputCursorPosition=this.inputElement&&this.inputElement.selectionStart||0;this.props.loadSuggestions(this.props.value,inputCursorPosition,200)})}render(){const{suggestions:suggestions,isLoadingSuggestions:isLoadingSuggestions,isValid:isValid,placeholder:placeholder,value:value,disabled:disabled,"aria-label":ariaLabel}=this.props,{areSuggestionsVisible:areSuggestionsVisible,selectedIndex:selectedIndex}=this.state;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiOutsideClickDetector,{onOutsideClick:this.handleBlur},external_kbnSharedDeps_React_default.a.createElement(AutocompleteContainer,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFieldSearch,{fullWidth:!0,disabled:disabled,inputRef:this.handleChangeInputRef,isLoading:isLoadingSuggestions,isInvalid:!isValid,onChange:this.handleChange,onFocus:this.handleFocus,onKeyDown:this.handleKeyDown,onKeyUp:this.handleKeyUp,onSearch:this.submit,placeholder:placeholder,value:value,"aria-label":ariaLabel}),areSuggestionsVisible&&!isLoadingSuggestions&&suggestions.length>0?external_kbnSharedDeps_React_default.a.createElement(SuggestionsPanel,null,suggestions.map((suggestion,suggestionIndex)=>external_kbnSharedDeps_React_default.a.createElement(SuggestionItem,{key:suggestion.text,suggestion:suggestion,isSelected:suggestionIndex===selectedIndex,onMouseEnter:this.selectSuggestionAt(suggestionIndex),onClick:this.applySuggestionAt(suggestionIndex)}))):null))}componentDidMount(){this.inputElement&&this.props.autoFocus&&this.inputElement.focus()}componentDidUpdate(prevProps){const hasNewValue=prevProps.value!==this.props.value,hasNewSuggestions=prevProps.suggestions!==this.props.suggestions;hasNewValue&&this.updateSuggestions(),hasNewValue&&""===this.props.value&&this.submit(),hasNewSuggestions&&this.state.isFocused&&this.showSuggestions()}}const withPreviousSuggestionSelected=(state,props)=>({...state,selectedIndex:0===props.suggestions.length?null:null!==state.selectedIndex?(state.selectedIndex+props.suggestions.length-1)%props.suggestions.length:Math.max(props.suggestions.length-1,0)}),withNextSuggestionSelected=(state,props)=>({...state,selectedIndex:0===props.suggestions.length?null:null!==state.selectedIndex?(state.selectedIndex+1)%props.suggestions.length:0}),withSuggestionAtIndexSelected=suggestionIndex=>(state,props)=>({...state,selectedIndex:0===props.suggestions.length?null:suggestionIndex>=0&&suggestionIndex<props.suggestions.length?suggestionIndex:0}),withSuggestionsVisible=state=>({...state,areSuggestionsVisible:!0}),withSuggestionsHidden=state=>({...state,areSuggestionsVisible:!1,selectedIndex:null}),withFocused=state=>({...state,isFocused:!0}),withUnfocused=state=>({...state,isFocused:!1}),AutocompleteContainer=common_.euiStyled.div`
  position: relative;
`,SuggestionsPanel=Object(common_.euiStyled)(external_kbnSharedDeps_ElasticEui_.EuiPanel).attrs(()=>({paddingSize:"none",hasShadow:!0}))`
  position: absolute;
  width: 100%;
  margin-top: 2px;
  overflow-x: hidden;
  overflow-y: scroll;
  z-index: ${props=>props.theme.eui.euiZLevel1};
  max-height: 322px;
`},86:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return Color})),__webpack_require__.d(__webpack_exports__,"b",(function(){return colorTransformer}));__webpack_require__(24);var _elastic_eui__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(10);let Color;!function(Color){Color.color0="color0",Color.color1="color1",Color.color2="color2",Color.color3="color3",Color.color4="color4",Color.color5="color5",Color.color6="color6",Color.color7="color7",Color.color8="color8",Color.color9="color9"}(Color||(Color={}));const euiPalette=Object(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__.euiPaletteColorBlind)(),defaultPalette={[Color.color0]:euiPalette[1],[Color.color1]:euiPalette[2],[Color.color2]:euiPalette[0],[Color.color3]:euiPalette[3],[Color.color4]:euiPalette[4],[Color.color5]:euiPalette[5],[Color.color6]:euiPalette[6],[Color.color7]:euiPalette[7],[Color.color8]:euiPalette[8],[Color.color9]:euiPalette[9]},colorTransformer=(palette=defaultPalette,color=>palette[color]);var palette},93:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return MetricsExplorerChartType})),__webpack_require__.d(__webpack_exports__,"d",(function(){return MetricsExplorerYAxisMode})),__webpack_require__.d(__webpack_exports__,"f",(function(){return metricsExplorerChartOptionsRT})),__webpack_require__.d(__webpack_exports__,"e",(function(){return metricExplorerOptionsRT})),__webpack_require__.d(__webpack_exports__,"g",(function(){return metricsExplorerTimeOptionsRT})),__webpack_require__.d(__webpack_exports__,"a",(function(){return DEFAULT_METRICS_EXPLORER_VIEW_STATE})),__webpack_require__.d(__webpack_exports__,"c",(function(){return MetricsExplorerOptionsContainer}));var io_ts__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0),lodash__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(24),constate__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(78),constate__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(constate__WEBPACK_IMPORTED_MODULE_2__),react__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(2),_alerting_use_alert_prefill__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(128),_common_color_palette__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(86),_common_http_api_metrics_explorer__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(98),_hooks_use_kibana_timefilter_time__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(133);const metricsExplorerOptionsMetricRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.intersection([_common_http_api_metrics_explorer__WEBPACK_IMPORTED_MODULE_6__.d,io_ts__WEBPACK_IMPORTED_MODULE_0__.partial({rate:io_ts__WEBPACK_IMPORTED_MODULE_0__.boolean,color:io_ts__WEBPACK_IMPORTED_MODULE_0__.keyof(Object.fromEntries(Object(lodash__WEBPACK_IMPORTED_MODULE_1__.values)(_common_color_palette__WEBPACK_IMPORTED_MODULE_5__.a).map(c=>[c,null]))),label:io_ts__WEBPACK_IMPORTED_MODULE_0__.string})]);let MetricsExplorerChartType,MetricsExplorerYAxisMode;!function(MetricsExplorerChartType){MetricsExplorerChartType.line="line",MetricsExplorerChartType.area="area",MetricsExplorerChartType.bar="bar"}(MetricsExplorerChartType||(MetricsExplorerChartType={})),function(MetricsExplorerYAxisMode){MetricsExplorerYAxisMode.fromZero="fromZero",MetricsExplorerYAxisMode.auto="auto"}(MetricsExplorerYAxisMode||(MetricsExplorerYAxisMode={}));const metricsExplorerChartOptionsRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.type({yAxisMode:io_ts__WEBPACK_IMPORTED_MODULE_0__.keyof(Object.fromEntries(Object(lodash__WEBPACK_IMPORTED_MODULE_1__.values)(MetricsExplorerYAxisMode).map(v=>[v,null]))),type:io_ts__WEBPACK_IMPORTED_MODULE_0__.keyof(Object.fromEntries(Object(lodash__WEBPACK_IMPORTED_MODULE_1__.values)(MetricsExplorerChartType).map(v=>[v,null]))),stack:io_ts__WEBPACK_IMPORTED_MODULE_0__.boolean}),metricExplorerOptionsRequiredRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.type({aggregation:io_ts__WEBPACK_IMPORTED_MODULE_0__.string,metrics:io_ts__WEBPACK_IMPORTED_MODULE_0__.array(metricsExplorerOptionsMetricRT)}),metricExplorerOptionsOptionalRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.partial({limit:io_ts__WEBPACK_IMPORTED_MODULE_0__.number,groupBy:io_ts__WEBPACK_IMPORTED_MODULE_0__.union([io_ts__WEBPACK_IMPORTED_MODULE_0__.string,io_ts__WEBPACK_IMPORTED_MODULE_0__.array(io_ts__WEBPACK_IMPORTED_MODULE_0__.string)]),filterQuery:io_ts__WEBPACK_IMPORTED_MODULE_0__.string,source:io_ts__WEBPACK_IMPORTED_MODULE_0__.string,forceInterval:io_ts__WEBPACK_IMPORTED_MODULE_0__.boolean,dropLastBucket:io_ts__WEBPACK_IMPORTED_MODULE_0__.boolean}),metricExplorerOptionsRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.intersection([metricExplorerOptionsRequiredRT,metricExplorerOptionsOptionalRT]),metricsExplorerTimeOptionsRT=io_ts__WEBPACK_IMPORTED_MODULE_0__.type({from:io_ts__WEBPACK_IMPORTED_MODULE_0__.string,to:io_ts__WEBPACK_IMPORTED_MODULE_0__.string,interval:io_ts__WEBPACK_IMPORTED_MODULE_0__.string}),DEFAULT_TIMERANGE={from:"now-1h",to:"now",interval:">=10s"},DEFAULT_CHART_OPTIONS={type:MetricsExplorerChartType.line,yAxisMode:MetricsExplorerYAxisMode.fromZero,stack:!1},DEFAULT_OPTIONS={aggregation:"avg",metrics:[{aggregation:"avg",field:"system.cpu.user.pct",color:_common_color_palette__WEBPACK_IMPORTED_MODULE_5__.a.color0},{aggregation:"avg",field:"kubernetes.pod.cpu.usage.node.pct",color:_common_color_palette__WEBPACK_IMPORTED_MODULE_5__.a.color1},{aggregation:"avg",field:"docker.cpu.total.pct",color:_common_color_palette__WEBPACK_IMPORTED_MODULE_5__.a.color2}],source:"default"},DEFAULT_METRICS_EXPLORER_VIEW_STATE={options:DEFAULT_OPTIONS,chartOptions:DEFAULT_CHART_OPTIONS,currentTimerange:DEFAULT_TIMERANGE};function useStateWithLocalStorage(key,defaultState){const storageState=localStorage.getItem(key),[state,setState]=Object(react__WEBPACK_IMPORTED_MODULE_3__.useState)(function(value,defaultValue){if(!value)return defaultValue;try{return JSON.parse(value)}catch(e){return defaultValue}}(storageState,defaultState));return Object(react__WEBPACK_IMPORTED_MODULE_3__.useEffect)(()=>{localStorage.setItem(key,JSON.stringify(state))},[key,state]),[state,setState]}const MetricsExplorerOptionsContainer=constate__WEBPACK_IMPORTED_MODULE_2___default()(()=>{const TIME_DEFAULTS={from:"now-1h",to:"now"},[getTime]=Object(_hooks_use_kibana_timefilter_time__WEBPACK_IMPORTED_MODULE_7__.a)(TIME_DEFAULTS),{from:from,to:to}=getTime(),defaultTimeRange={from:from,to:to,interval:DEFAULT_TIMERANGE.interval},[options,setOptions]=useStateWithLocalStorage("MetricsExplorerOptions",DEFAULT_OPTIONS),[currentTimerange,setTimeRange]=Object(react__WEBPACK_IMPORTED_MODULE_3__.useState)(defaultTimeRange);Object(_hooks_use_kibana_timefilter_time__WEBPACK_IMPORTED_MODULE_7__.b)(TIME_DEFAULTS,{from:currentTimerange.from,to:currentTimerange.to});const[chartOptions,setChartOptions]=useStateWithLocalStorage("MetricsExplorerChartOptions",DEFAULT_CHART_OPTIONS),[isAutoReloading,setAutoReloading]=Object(react__WEBPACK_IMPORTED_MODULE_3__.useState)(!1),{metricThresholdPrefill:metricThresholdPrefill}=Object(_alerting_use_alert_prefill__WEBPACK_IMPORTED_MODULE_4__.b)(),prefillContext=Object(react__WEBPACK_IMPORTED_MODULE_3__.useMemo)(()=>metricThresholdPrefill,[metricThresholdPrefill]);return Object(react__WEBPACK_IMPORTED_MODULE_3__.useEffect)(()=>{if(prefillContext){const{setPrefillOptions:setPrefillOptions}=prefillContext,{metrics:metrics,groupBy:groupBy,filterQuery:filterQuery}=options;setPrefillOptions({metrics:metrics,groupBy:groupBy,filterQuery:filterQuery})}},[options,prefillContext]),{defaultViewState:{options:DEFAULT_OPTIONS,chartOptions:DEFAULT_CHART_OPTIONS,currentTimerange:defaultTimeRange},options:options,chartOptions:chartOptions,setChartOptions:setChartOptions,currentTimerange:currentTimerange,isAutoReloading:isAutoReloading,setOptions:setOptions,setTimeRange:setTimeRange,startAutoReload:()=>setAutoReloading(!0),stopAutoReload:()=>setAutoReloading(!1)}})}}]);