/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */!function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}__webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{enumerable:!0,get:getter})},__webpack_require__.r=function(exports){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(exports,"__esModule",{value:!0})},__webpack_require__.t=function(value,mode){if(1&mode&&(value=__webpack_require__(value)),8&mode)return value;if(4&mode&&"object"==typeof value&&value&&value.__esModule)return value;var ns=Object.create(null);if(__webpack_require__.r(ns),Object.defineProperty(ns,"default",{enumerable:!0,value:value}),2&mode&&"string"!=typeof value)for(var key in value)__webpack_require__.d(ns,key,function(key){return value[key]}.bind(null,key));return ns},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function(){return module.default}:function(){return module};return __webpack_require__.d(getter,"a",getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=13)}([function(module,exports){module.exports=__kbnSharedDeps__.React},function(module,exports){module.exports=__kbnSharedDeps__.ElasticEui},function(module,exports){module.exports=__kbnSharedDeps__.KbnI18n},function(module,__webpack_exports__,__webpack_require__){"use strict";var _src_plugins_es_ui_shared_static_forms_hook_form_lib__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(4);__webpack_require__.d(__webpack_exports__,"h",(function(){return _src_plugins_es_ui_shared_static_forms_hook_form_lib__WEBPACK_IMPORTED_MODULE_0__.useForm})),__webpack_require__.d(__webpack_exports__,"i",(function(){return _src_plugins_es_ui_shared_static_forms_hook_form_lib__WEBPACK_IMPORTED_MODULE_0__.useFormData})),__webpack_require__.d(__webpack_exports__,"b",(function(){return _src_plugins_es_ui_shared_static_forms_hook_form_lib__WEBPACK_IMPORTED_MODULE_0__.Form})),__webpack_require__.d(__webpack_exports__,"d",(function(){return _src_plugins_es_ui_shared_static_forms_hook_form_lib__WEBPACK_IMPORTED_MODULE_0__.UseField}));var _src_plugins_es_ui_shared_static_forms_helpers__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(10);__webpack_require__.d(__webpack_exports__,"f",(function(){return _src_plugins_es_ui_shared_static_forms_helpers__WEBPACK_IMPORTED_MODULE_1__.fieldValidators}));var _src_plugins_es_ui_shared_static_forms_components__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(11);__webpack_require__.d(__webpack_exports__,"c",(function(){return _src_plugins_es_ui_shared_static_forms_components__WEBPACK_IMPORTED_MODULE_2__.TextField}));var _src_plugins_kibana_react_public__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(7);__webpack_require__.d(__webpack_exports__,"a",(function(){return _src_plugins_kibana_react_public__WEBPACK_IMPORTED_MODULE_3__.CodeEditor})),__webpack_require__.d(__webpack_exports__,"g",(function(){return _src_plugins_kibana_react_public__WEBPACK_IMPORTED_MODULE_3__.toMountPoint})),__webpack_require__.d(__webpack_exports__,"e",(function(){return _src_plugins_kibana_react_public__WEBPACK_IMPORTED_MODULE_3__.createKibanaReactContext}))},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/esUiShared/static/forms/hook_form_lib");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return RUNTIME_FIELD_OPTIONS}));const RUNTIME_FIELD_OPTIONS=[{label:"Keyword",value:"keyword"},{label:"Long",value:"long"},{label:"Double",value:"double"},{label:"Date",value:"date"},{label:"IP",value:"ip"},{label:"Boolean",value:"boolean"}]},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"RuntimeFieldForm",(function(){return RuntimeFieldForm})),__webpack_require__.d(__webpack_exports__,"RuntimeFieldFormState",(function(){})),__webpack_require__.d(__webpack_exports__,"RuntimeFieldEditor",(function(){return RuntimeFieldEditor})),__webpack_require__.d(__webpack_exports__,"RuntimeFieldEditorFlyoutContent",(function(){return RuntimeFieldEditorFlyoutContent})),__webpack_require__.d(__webpack_exports__,"RuntimeFieldEditorFlyoutContentProps",(function(){}));var external_kbnSharedDeps_React_=__webpack_require__(0),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),external_kbnSharedDeps_KbnI18n_=__webpack_require__(2),external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(12),external_kbnSharedDeps_KbnMonaco_=__webpack_require__(9),external_kbnSharedDeps_ElasticEui_=__webpack_require__(1),shared_imports=__webpack_require__(3),constants=__webpack_require__(5);const{emptyField:emptyField}=shared_imports.f,schema={name:{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.runtimeFields.form.nameLabel",{defaultMessage:"Name"}),validations:[{validator:emptyField(external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.runtimeFields.form.validations.nameIsRequiredErrorMessage",{defaultMessage:"Give a name to the field."}))}]},type:{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.runtimeFields.form.runtimeTypeLabel",{defaultMessage:"Type"}),defaultValue:"keyword",deserializer:fieldType=>{var _RUNTIME_FIELD_OPTION;if(!fieldType)return[];const label=null===(_RUNTIME_FIELD_OPTION=constants.a.find(({value:value})=>value===fieldType))||void 0===_RUNTIME_FIELD_OPTION?void 0:_RUNTIME_FIELD_OPTION.label;return[{label:null!=label?label:fieldType,value:fieldType}]},serializer:value=>value[0].value},script:{source:{label:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.runtimeFields.form.defineFieldLabel",{defaultMessage:"Define script (optional)"})}}},createNameNotAllowedValidator=namesNotAllowed=>({value:value})=>{if(namesNotAllowed.includes(value))return{message:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.runtimeFields.runtimeFieldsEditor.existRuntimeFieldNamesValidationErrorMessage",{defaultMessage:"There is already a field with this name."})}},mapReturnTypeToPainlessContext=runtimeType=>{switch(runtimeType){case"keyword":return"string_script_field_script_field";case"long":return"long_script_field_script_field";case"double":return"double_script_field_script_field";case"date":return"date_script_field";case"ip":return"ip_script_field_script_field";case"boolean":return"boolean_script_field_script_field";default:return"string_script_field_script_field"}},RuntimeFieldFormComp=({defaultValue:defaultValue,onChange:onChange,links:links,ctx:{namesNotAllowed:namesNotAllowed,existingConcreteFields:existingConcreteFields=[]}={}})=>{const typeFieldConfig=schema.type,[painlessContext,setPainlessContext]=Object(external_kbnSharedDeps_React_.useState)(mapReturnTypeToPainlessContext(typeFieldConfig.defaultValue)),{form:form}=Object(shared_imports.h)({defaultValue:defaultValue,schema:schema}),{submit:submit,isValid:isFormValid,isSubmitted:isSubmitted}=form,[{name:name}]=Object(shared_imports.i)({form:form,watch:"name"}),nameFieldConfig=((namesNotAllowed,defaultValue)=>{var _nameFieldConfig$vali;const nameFieldConfig=schema.name;return namesNotAllowed?{...nameFieldConfig,validations:[...null!==(_nameFieldConfig$vali=nameFieldConfig.validations)&&void 0!==_nameFieldConfig$vali?_nameFieldConfig$vali:[],{validator:createNameNotAllowedValidator(namesNotAllowed.filter(name=>name!==(null==defaultValue?void 0:defaultValue.name)))}]}:nameFieldConfig})(namesNotAllowed,defaultValue),onTypeChange=Object(external_kbnSharedDeps_React_.useCallback)(newType=>{setPainlessContext(mapReturnTypeToPainlessContext(newType[0].value))},[]),suggestionProvider=external_kbnSharedDeps_KbnMonaco_.PainlessLang.getSuggestionProvider(painlessContext,existingConcreteFields);return Object(external_kbnSharedDeps_React_.useEffect)(()=>{onChange&&onChange({isValid:isFormValid,isSubmitted:isSubmitted,submit:submit})},[onChange,isFormValid,isSubmitted,submit]),external_kbnSharedDeps_React_default.a.createElement(shared_imports.b,{form:form,className:"runtimeFieldEditor_form"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(shared_imports.d,{path:"name",config:nameFieldConfig,component:shared_imports.c,"data-test-subj":"nameField",componentProps:{euiFieldProps:{"aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.runtimeFields.form.nameAriaLabel",{defaultMessage:"Name field"})}}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,null,external_kbnSharedDeps_React_default.a.createElement(shared_imports.d,{path:"type",onChange:onTypeChange},({label:label,value:value,setValue:setValue})=>void 0===value?null:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:label,fullWidth:!0},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiComboBox,{placeholder:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.runtimeFields.form.runtimeType.placeholderLabel",{defaultMessage:"Select a type"}),singleSelection:{asPlainText:!0},options:constants.a,selectedOptions:value,onChange:newValue=>{0!==newValue.length&&setValue(newValue)},isClearable:!1,"data-test-subj":"typeField","aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.runtimeFields.form.typeSelectAriaLabel",{defaultMessage:"Type select"}),fullWidth:!0})))))),existingConcreteFields.find(field=>field.name===name)&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.runtimeFields.form.fieldShadowingCalloutTitle",{defaultMessage:"Field shadowing"}),color:"warning",iconType:"pin",size:"s","data-test-subj":"shadowingFieldCallout"},external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.runtimeFields.form.fieldShadowingCalloutDescription",{defaultMessage:"This field shares the name of a mapped field. Values for this field will be returned in search results."})))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"l"}),external_kbnSharedDeps_React_default.a.createElement(shared_imports.d,{path:"script.source"},({value:value,setValue:setValue,label:label,isValid:isValid,getErrorsMessages:getErrorsMessages})=>external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFormRow,{label:label,error:getErrorsMessages(),isInvalid:!isValid,helpText:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_.FormattedMessage,{id:"xpack.runtimeFields.form.source.scriptFieldHelpText",defaultMessage:"Runtime fields without a script retrieve values from a field with the same name in {source}. If a field with the same name doesn’t exist, no values return when a search request includes the runtime field. {learnMoreLink}",values:{learnMoreLink:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiLink,{href:links.runtimePainless,target:"_blank",external:!0,"data-test-subj":"painlessSyntaxLearnMoreLink"},external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.runtimeFields.form.script.learnMoreLinkText",{defaultMessage:"Learn about script syntax."})),source:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCode,null,"_source")}}),fullWidth:!0},external_kbnSharedDeps_React_default.a.createElement(shared_imports.a,{languageId:external_kbnSharedDeps_KbnMonaco_.PainlessLang.ID,suggestionProvider:suggestionProvider,width:"100%",height:"300px",value:value,onChange:setValue,options:{fontSize:12,minimap:{enabled:!1},scrollBeyondLastLine:!1,wordWrap:"on",wrappingIndent:"indent",automaticLayout:!0,suggest:{snippetsPreventQuickSuggestions:!1}},"data-test-subj":"scriptField","aria-label":external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.runtimeFields.form.scriptEditorAriaLabel",{defaultMessage:"Script editor"})}))))},RuntimeFieldForm=external_kbnSharedDeps_React_default.a.memo(RuntimeFieldFormComp),RuntimeFieldEditor=({defaultValue:defaultValue,onChange:onChange,docLinks:docLinks,ctx:ctx})=>{const links=(({links:links})=>({runtimePainless:""+links.runtimeFields.mapping,painlessSyntax:""+links.scriptedFields.painlessLangSpec}))(docLinks);return external_kbnSharedDeps_React_default.a.createElement(RuntimeFieldForm,{links:links,defaultValue:defaultValue,onChange:onChange,ctx:ctx})},RuntimeFieldEditorFlyoutContent=({onSave:onSave,onCancel:onCancel,docLinks:docLinks,defaultValue:field,ctx:ctx})=>{const i18nTexts=(field=>({flyoutTitle:field?external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.runtimeFields.editor.flyoutEditFieldTitle",{defaultMessage:"Edit {fieldName} field",values:{fieldName:field.name}}):external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.runtimeFields.editor.flyoutDefaultTitle",{defaultMessage:"Create new field"}),closeButtonLabel:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.runtimeFields.editor.flyoutCloseButtonLabel",{defaultMessage:"Close"}),saveButtonLabel:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.runtimeFields.editor.flyoutSaveButtonLabel",{defaultMessage:"Save"}),formErrorsCalloutTitle:external_kbnSharedDeps_KbnI18n_.i18n.translate("xpack.runtimeFields.editor.validationErrorTitle",{defaultMessage:"Fix errors in form before continuing."})}))(field),[formState,setFormState]=Object(external_kbnSharedDeps_React_.useState)({isSubmitted:!1,isValid:!!field||void 0,submit:field?async()=>({isValid:!0,data:field}):async()=>({isValid:!1,data:{}})}),{submit:submit,isValid:isFormValid,isSubmitted:isSubmitted}=formState,onSaveField=Object(external_kbnSharedDeps_React_.useCallback)(async()=>{const{isValid:isValid,data:data}=await submit();isValid&&onSave(data)},[submit,onSave]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyoutHeader,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiTitle,{size:"m","data-test-subj":"flyoutTitle"},external_kbnSharedDeps_React_default.a.createElement("h2",{id:"runtimeFieldEditorEditTitle"},i18nTexts.flyoutTitle))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyoutBody,null,external_kbnSharedDeps_React_default.a.createElement(RuntimeFieldEditor,{docLinks:docLinks,defaultValue:field,onChange:setFormState,ctx:ctx})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlyoutFooter,null,isSubmitted&&!isFormValid&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_default.a.Fragment,null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiCallOut,{title:i18nTexts.formErrorsCalloutTitle,color:"danger",iconType:"cross","data-test-subj":"formError"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiSpacer,{size:"m"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButtonEmpty,{iconType:"cross",flush:"left",onClick:()=>onCancel(),"data-test-subj":"closeFlyoutButton"},i18nTexts.closeButtonLabel)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiFlexItem,{grow:!1},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_.EuiButton,{color:"primary",onClick:()=>onSaveField(),"data-test-subj":"saveFieldButton",disabled:isSubmitted&&!isFormValid,fill:!0},i18nTexts.saveButtonLabel)))))}},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/kibanaReact/public");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,exports){},function(module,exports){module.exports=__kbnSharedDeps__.KbnMonaco},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/esUiShared/static/forms/helpers");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);var ns=__kbnBundles__.get("plugin/esUiShared/static/forms/components");Object.defineProperties(__webpack_exports__,Object.getOwnPropertyDescriptors(ns))},function(module,exports){module.exports=__kbnSharedDeps__.KbnI18nReact},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__(14);__kbnBundles__.define("plugin/runtimeFields/public",__webpack_require__,15)},function(module,exports,__webpack_require__){__webpack_require__.p=window.__kbnPublicPath__.runtimeFields},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"RuntimeFieldEditorFlyoutContent",(function(){return components.RuntimeFieldEditorFlyoutContent})),__webpack_require__.d(__webpack_exports__,"RuntimeFieldEditorFlyoutContentProps",(function(){return components.RuntimeFieldEditorFlyoutContentProps})),__webpack_require__.d(__webpack_exports__,"RuntimeFieldEditor",(function(){return components.RuntimeFieldEditor})),__webpack_require__.d(__webpack_exports__,"RuntimeFieldFormState",(function(){return components.RuntimeFieldFormState})),__webpack_require__.d(__webpack_exports__,"RUNTIME_FIELD_OPTIONS",(function(){return constants.a})),__webpack_require__.d(__webpack_exports__,"RuntimeField",(function(){return types.RuntimeField})),__webpack_require__.d(__webpack_exports__,"RuntimeType",(function(){return types.RuntimeType})),__webpack_require__.d(__webpack_exports__,"RuntimeFieldsSetup",(function(){return types.PluginSetup})),__webpack_require__.d(__webpack_exports__,"plugin",(function(){return public_plugin}));var external_kbnSharedDeps_React_=__webpack_require__(0),external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_),shared_imports=__webpack_require__(3);class plugin_RuntimeFieldsPlugin{setup(core,plugins){return{loadEditor:(coreSetup=core,async()=>{const{RuntimeFieldEditorFlyoutContent:RuntimeFieldEditorFlyoutContent}=await Promise.resolve().then(__webpack_require__.bind(null,6)),[core]=await coreSetup.getStartServices(),{uiSettings:uiSettings,overlays:overlays,docLinks:docLinks}=core,{Provider:KibanaReactContextProvider}=Object(shared_imports.e)({uiSettings:uiSettings});let overlayRef=null;return{openEditor:({onSave:onSave,defaultValue:defaultValue,ctx:ctx})=>{const closeEditor=()=>{overlayRef&&(overlayRef.close(),overlayRef=null)};return overlayRef=overlays.openFlyout(Object(shared_imports.g)(external_kbnSharedDeps_React_default.a.createElement(KibanaReactContextProvider,null,external_kbnSharedDeps_React_default.a.createElement(RuntimeFieldEditorFlyoutContent,{onSave:field=>{closeEditor(),onSave(field)},onCancel:()=>{var _overlayRef;return null===(_overlayRef=overlayRef)||void 0===_overlayRef?void 0:_overlayRef.close()},docLinks:docLinks,defaultValue:defaultValue,ctx:ctx})))),closeEditor}}})};var coreSetup}start(core,plugins){return{}}stop(){return{}}}var components=__webpack_require__(6),constants=__webpack_require__(5),types=__webpack_require__(8);function public_plugin(){return new plugin_RuntimeFieldsPlugin}}]);