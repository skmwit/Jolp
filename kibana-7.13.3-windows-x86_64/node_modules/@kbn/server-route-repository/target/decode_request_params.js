"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.decodeRequestParams = void 0;
const tslib_1 = require("tslib");
const lodash_1 = require("lodash");
const Either_1 = require("fp-ts/lib/Either");
const PathReporter_1 = require("io-ts/lib/PathReporter");
const boom_1 = tslib_1.__importDefault(require("@hapi/boom"));
const io_ts_utils_1 = require("@kbn/io-ts-utils");
function decodeRequestParams(params, paramsRt) {
    const paramMap = lodash_1.omitBy({
        path: params.params,
        body: params.body,
        query: params.query,
    }, (val) => val === null || val === undefined || (lodash_1.isPlainObject(val) && lodash_1.isEmpty(val)));
    // decode = validate
    const result = io_ts_utils_1.strictKeysRt(paramsRt).decode(paramMap);
    if (Either_1.isLeft(result)) {
        throw boom_1.default.badRequest(PathReporter_1.PathReporter.report(result)[0]);
    }
    return result.right;
}
exports.decodeRequestParams = decodeRequestParams;
//# sourceMappingURL=decode_request_params.js.map